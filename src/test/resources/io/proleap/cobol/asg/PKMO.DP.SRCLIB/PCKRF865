000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.             PCKRF865.                                00030000
000400 AUTHOR.                 LYNN MCADAMS.                            00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            MARCH, 2001.                             00060000
000700 DATE-COMPILED.                                                   00070000
000800                                                                  00080000
000900******************************************************************00090000
001000* THIS PROGRAM DISPLAYS THE BARCODE ENTRY SCREEN ON THE LRT       00100000
001100* (LASER RADIO TERMINAL) THAT WAS SCANNED ON THE MASTER CONTAINER 00110000
001200* ID SCREEN (PCKRF864).                                           00120000
001300*                                                                 00130000
001400* THIS SCREEN WILL ACCEPT THE ENTRY OF EITHER A CHILD CARTON WHEN 00140000
001500* CHILD CARTONS ARE ADDED TO A MASTER CONTAINER - OR - A MASTER   00150000
001600* CONTAINER ID IF IT IS TO BE ADDED TO THE MASTER CONTAINER THAT  00160000
001700* IS CURRENTLY BEING WORKED ON.                                   00170000
001800*                                                                 00180000
001900* ENTERING A VALID PRINTER ID AND PRESSING F5-REPRINT WILL        00190000
002000* PRINT THE MASTER CARTON LABEL.                                  00200000
002100******************************************************************00210000
002200*                                                                 00220000
002300*                                                                 00230000
002400 ENVIRONMENT DIVISION.                                            00240000
002500 DATA DIVISION.                                                   00250000
002600 WORKING-STORAGE SECTION.                                         00260000
002700*                                                                 00270000
002800*                                                                 00280000
002900 01  DK-DB2-KEYS.                                                 00290000
003000     05  DK-CARTON                       PIC  S9(18)V COMP-3.     00300000
003100     05  DK-CHILD-CARTON                 PIC  S9(18)V COMP-3.     00310000
003200     05  DK-MASTER-CARTON                PIC  S9(18)V COMP-3.     00320000
003300     05  DK-BARCODE-NBR                  PIC  X(22) VALUE SPACES. 00330000
003400     05  DK-STORE-NBR                    PIC  S9(04) COMP.        00340000
003500     05  DK-SHIPT-UNT-ID                 PIC  S9(18)V COMP-3.     00350000
003600*** PK 11/11/13 BEGIN                                             00360000
003700     05  DK-SHIPMENT-ID                  PIC  S9(18)V COMP-3.     00370000
003800     05  DK-INTGRTN-HAZ-CDE        PIC X(08) VALUE 'HZLBLAPP'.    00380000
003801     05  DK-APPL-NAME              PIC X(11) VALUE 'MASTERCHILD'. 00380100
003802     05  DK-HAZDS-IND              PIC X(01) VALUE 'Y'.           00380200
003803     05  DK-SYS-MSTHAZ-CDE         PIC X(06) VALUE 'MSTHAZ'.      00380300
003804     05  DK-FUNC-PRC-STAT-CDE      PIC X(02) VALUE 'AC'.          00380400
003805     05  DK-INTFC-SYS-CDE          PIC X(03) VALUE 'KHL'.         00380500
003806     05  DK-HAZ-OPER-UNT-ID        PIC S9(04) COMP VALUE +0.      00380600
003807*** PK 11/11/13 END                                               00380700
003808                                                                  00380800
003809* PROGRAM CONSTANTS                                               00380900
003810 01  PC-PROGRAM-CONSTANTS.                                        00381000
003820     05  PC-TRANID                       PIC  X(04)  VALUE 'E865'.00382000
003830     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     00383000
003840                                                     COMP SYNC.   00384000
003850     05  PC-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00385000
003860                                                     COMP SYNC.   00386000
003870     05  PC-RECEIVE-LENGTH               PIC S9(04)  VALUE +1     00387000
003880                                                     COMP SYNC.   00388000
003890     05  PC-ACTIVE                       PIC  X(01)  VALUE 'A'.   00389000
003900     05  PC-MASTER-CONTAINER             PIC  X(20)               00390000
004000                                   VALUE '* MASTER CONTAINER *'.  00400000
004100     05  PC-OPER-UNT-ID                  PIC S9(04)  VALUE +0     00410000
004200                                                     COMP.        00420000
004300     05  PC-0-9                          PIC  9(01)  VALUE 0.     00430000
004400     05  PC-1                            PIC  X(01)  VALUE '1'.   00440000
004500     05  PC-0                            PIC  X(01)  VALUE '0'.   00450000
004600     05  PC-00                           PIC  X(02)  VALUE '00'.  00460000
004700     05  PC-4                            PIC  X(01)  VALUE '4'.   00470000
004800     05  PC-41                           PIC  X(02)  VALUE '41'.  00480000
004900* JAK 09/2009 WR37075 ADD 1 LINE                                  00490000
005000     05  PC-42                           PIC  X(02)  VALUE '42'.  00500000
005100     05  PC-01                           PIC  X(02)  VALUE '01'.  00510000
005200     05  PC-18                           PIC S9(04)  VALUE 18     00520000
005300                                                     COMP SYNC.   00530000
005400     05  PC-20                           PIC S9(04)  VALUE 20     00540000
005500                                                     COMP SYNC.   00550000
005600     05  PC-49                           PIC  X(02)  VALUE '49'.  00560000
005700     05  PC-50                           PIC  X(02)  VALUE '50'.  00570000
005800     05  PC-95                           PIC  X(02)  VALUE '95'.  00580000
005900     05  PC-A                            PIC  X(01)  VALUE 'A'.   00590000
006000     05  PC-MGMX                         PIC  X(04)  VALUE 'MGMX'.00600000
006100     05  PC-UG                           PIC  X(02)  VALUE 'UG'.  00610000
006200     05  PC-Y                            PIC  X(01)  VALUE 'Y'.   00620000
006300     05  PC-90                           PIC  X(02)  VALUE '90'.  00630000
006400                                                                  00640000
006500     05  PC-CURRENT-PROGRAM-NAME    PIC X(08) VALUE 'PCKRF865'.   00650000
006600     05  PC-MANIFEST-MENU-PGM       PIC X(08) VALUE 'PCKRF850'.   00660000
006700     05  PC-DC-RF-APPL-PGM          PIC X(08) VALUE 'MPKCS027'.   00670000
006800     05  PC-ERROR-SCREEN-PGM        PIC X(08) VALUE 'PCKRF852'.   00680000
006900     05  PC-MASTER-CONTAINER-PGM    PIC X(08) VALUE 'PCKRF864'.   00690000
007000     05  PC-BARCODE-ENTRY-PGM       PIC X(08) VALUE 'PCKRF865'.   00700000
007100     05  PC-CARTON-FUNC-PGM         PIC X(08) VALUE 'PCKRF884'.   00710000
007200     05  PC-PRTR-VALIDATION-PGM     PIC X(08) VALUE 'DPKCS060'.   00720000
007300     05  PC-REPORT-PGM-1            PIC X(08) VALUE 'PCKCS126'.   00730000
007400                                                                  00740000
007500* ERROR MESSAGES                                                  00750000
007600     05  PC-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00760000
007700                                           'UNRECOGNIZED PF KEY'. 00770000
007800     05  PC-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00780000
007900                                           'ENTER THROUGH MENU '. 00790000
008000     05  PC-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               00800000
008100                                           'TRANS NOT AVAILABLE'. 00810000
008200     05  PC-PLS-ENT-FLD-MSG         PIC X(19) VALUE               00820000
008300                                           'PLEASE ENTER FIELD '. 00830000
008400     05  PC-MUST-BE-NUM-MSG         PIC X(19) VALUE               00840000
008500                                           'MUST BE NUMERIC    '. 00850000
008600     05  PC-MUST-BE-GT-0-MSG        PIC X(19) VALUE               00860000
008700                                           'MUST BE > ZERO     '. 00870000
008800     05  PC-FIRST-1-NOT-0-MSG       PIC X(19) VALUE               00880000
008900                                           'FIRST DIGIT NOT 0  '. 00890000
009000     05  PC-TOO-MANY-DIGITS         PIC X(19) VALUE               00900000
009100                                           'TOO MANY DIGITS    '. 00910000
009200     05  PC-MORE-DIGITS-REQD        PIC X(19) VALUE               00920000
009300                                           'MORE DIGITS REQUIRD'. 00930000
009400     05  PC-MUST-BE-MERCHANDISE-CTN PIC X(19) VALUE               00940000
009500                                           'MUST BE MRCHDSE CTN'. 00950000
009600     05  PC-MUST-BE-KOHLS-BARCODE   PIC X(19) VALUE               00960000
009700                                           'MUST BE KOHLS BRCDE'. 00970000
009800     05  PC-REMOVED-FROM-MASTER     PIC X(19) VALUE               00980000
009900                                           'REMOVED FROM MASTER'. 00990000
010000     05  PC-REASSIGNED-TO-MASTER    PIC X(19) VALUE               01000000
010100                                           'REASSIGNED TO MSTR '. 01010000
010200     05  PC-ADDED-TO-MASTER         PIC X(19) VALUE               01020000
010300                                           'ADDED TO MASTER    '. 01030000
010400     05  PC-INVALID-PRINTER-ID      PIC X(19) VALUE               01040000
010500                                           'INVALID PRINTER ID '. 01050000
010600     05  PC-LABEL-PRINTED           PIC X(19) VALUE               01060000
010700                                           'LABEL PRINTED      '. 01070000
010800     05  PC-LABEL-PRINT-FAIL        PIC X(19) VALUE               01080000
010900                                           'LABEL PRINT FAILED '. 01090000
011000     05  PC-CARTON-INACTIVATED      PIC X(19) VALUE               01100000
011100                                           'CARTON INACTIVATED '. 01110000
011200     05  PC-CICS-ABEND-MSG          PIC  X(19)  VALUE             01120000
011300                                           'CICS ABEND -CALL DP'. 01130000
011400     05  PC-CARTON-STATUS-ERROR     PIC  X(19)  VALUE             01140000
011500                                           'CARTON STATUS ERROR'. 01150000
011600     05  PC-DATABASE-ERROR          PIC  X(19)  VALUE             01160000
011700                                           'DATABASE ER-CALL DP'. 01170000
011800     05  PC-DATABASE-BUSY           PIC  X(19)  VALUE             01180000
011900                                           'DB BUSY - TRY AGAIN'. 01190000
012000     05  PC-SHIPPING                PIC X(08) VALUE 'SHIPPING'.   01200000
012100                                                                  01210000
012200     05  PC-INVALID-MST-TYPE        PIC  X(19).                   01220000
012300     05  PC-INVALID-MST-TYPE-R REDEFINES PC-INVALID-MST-TYPE.     01230000
012400         10 PC-INVALID-TYPE-TEXT    PIC  X(7).                    01240000
012500         10 PC-INVALID-TYPE-N       PIC  X(12).                   01250000
012600                                                                  01260000
012700* PROGRAM SWITCHES                                                01270000
012800 01  PS-PROGRAM-SWITCHES.                                         01280000
012900     05  PS-ERROR-SW                     PIC  X(01)  VALUE 'N'.   01290000
013000         88  PS-ERROR-YES                            VALUE 'Y'.   01300000
013100         88  PS-ERROR-NO                             VALUE 'N'.   01310000
013200     05  PS-END-OF-CURSOR-SW             PIC  X(01)  VALUE 'N'.   01320000
013300         88  PS-END-OF-CURSOR                        VALUE 'Y'.   01330000
013400         88  PS-NOT-END-OF-CURSOR                    VALUE 'N'.   01340000
013500     05  PS-VALID-INPUT-SW               PIC  X(01)  VALUE 'Y'.   01350000
013600         88  PS-VALID-INPUT                          VALUE 'Y'.   01360000
013700         88  PS-INVALID-INPUT                        VALUE 'N'.   01370000
013800     05  PS-NOT-FOUND-SW                 PIC  X(01)  VALUE 'Y'.   01380000
013900         88  PS-FOUND                                VALUE 'Y'.   01390000
014000         88  PS-NOT-FOUND                            VALUE 'N'.   01400000
014100     05  PS-MASTER-CTN-IND               PIC  X(01)  VALUE 'Y'.   01410000
014200         88  PS-MASTER-CTN                           VALUE 'Y'.   01420000
014300         88  PS-NOT-MASTER-CTN                       VALUE 'N'.   01430000
014400     05  PS-CHILD-CTN-IND                PIC  X(01)  VALUE 'Y'.   01440000
014500         88  PS-CHILD-CTN                            VALUE 'Y'.   01450000
014600         88  PS-NOT-CHILD-CTN                        VALUE 'N'.   01460000
014700     05  PS-SCANNED-DATA-IND             PIC  X(01)  VALUE 'Y'.   01470000
014800         88  PS-NOT-SCANNED-DATA                     VALUE 'N'.   01480000
014900         88  PS-SCANNED-DATA                         VALUE 'Y'.   01490000
015000     05  PS-CARTON-EXISTS-SW             PIC  X(01)  VALUE 'Y'.   01500000
015100         88  PS-CARTON-EXISTS                        VALUE 'Y'.   01510000
015200         88  PS-CARTON-DOESNT-EXIST                  VALUE 'N'.   01520000
015300     05  PS-BARCODE-SW                   PIC  X(01)  VALUE 'Y'.   01530000
015400         88  PS-BARCODE-EXISTS                       VALUE 'Y'.   01540000
015500         88  PS-BARCODE-DOESNT-EXIST                 VALUE 'N'.   01550000
015600     05  PS-PRINTER-ID-SW                PIC  X(01)  VALUE 'Y'.   01560000
015700         88  PS-VALID-PRINTER-ID                     VALUE 'Y'.   01570000
015800         88  PS-INVALID-PRINTER-ID                   VALUE 'N'.   01580000
015900     05  PS-STORE-NBR-SW                 PIC  X(01)  VALUE 'Y'.   01590000
016000         88  PS-VALID-STORE-NBR                      VALUE 'Y'.   01600000
016100         88  PS-INVALID-STORE-NBR                    VALUE 'N'.   01610000
016200     05  PS-UPDATE-COMMIT-SW             PIC X      VALUE 'N'.    01620000
016300         88  PS-UPDATE-COMMIT                       VALUE 'Y'.    01630000
016400         88  PS-UPDATE-ROLLBACK                     VALUE 'N'.    01640000
016500*** PK 11/11/13 BEGIN                                             01650000
016600     05  PS-HAZ-FACILITY-SW              PIC  X(01)  VALUE 'N'.   01660000
016700         88  PS-HAZ-FACILITY-YES                     VALUE 'Y'.   01670000
016800         88  PS-HAZ-FACILITY-NO                      VALUE 'N'.   01680000
016810*** PK 11/11/13 END                                               01681000
016820*                                                                 01682000
016830 01  PV-LOG-MSG.                                                  01683000
016840     05  FILLER                       PIC X(12) VALUE             01684000
016850         ' E865 ERROR '.                                          01685000
016860     05  FILLER                       PIC X(09) VALUE             01686000
016870         'SQLCODE= '.                                             01687000
016880     05  PV-SQLCODE                   PIC -9(03).                 01688000
016890     05  FILLER                       PIC X(06) VALUE             01689000
016900         ' ERR= '.                                                01690000
017000     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       01700000
017100     05  FILLER                       PIC X(07) VALUE             01710000
017200         ' SML= '.                                                01720000
017300     05  PV-DISPLAY-SML               PIC X(12) VALUE ZEROS.      01730000
017400                                                                  01740000
017500     05  PV-CARTON-MSG.                                           01750000
017600         10  FILLER                   PIC X(01) VALUE SPACE.      01760000
017700         10  FILLER                   PIC X(08) VALUE 'PCKRF881'. 01770000
017800         10  FILLER                   PIC X(01) VALUE '-'.        01780000
017900         10  PV-CTN-PARA              PIC X(04) VALUE SPACES.     01790000
018000         10  FILLER                   PIC X(05) VALUE ' REC='.    01800000
018100         10  PV-CTN-RET-CDE           PIC X(02) VALUE SPACES.     01810000
018200         10  FILLER                   PIC X(10)                   01820000
018300                             VALUE ' CTN STAT='.                  01830000
018400         10  PV-CTN-STATUS            PIC X(02) VALUE SPACES.     01840000
018500         10  FILLER                   PIC X(01) VALUE '/'.        01850000
018600         10  PV-CTN-STAT-DESC         PIC X(19) VALUE SPACES.     01860000
018700         10  FILLER                   PIC X(05) VALUE ' SER='.    01870000
018800         10  PV-CTN-TRLR-SERIAL       PIC 9(09) VALUE ZEROES.     01880000
018900         10  FILLER                   PIC X(06) VALUE ' TRIP='.   01890000
019000         10  PV-CTN-TRIP              PIC 9(09) VALUE ZEROES.     01900000
019100         10  FILLER                   PIC X(06) VALUE ' STAT='.   01910000
019200         10  PV-CTN-TRIP-STAT         PIC X(02) VALUE SPACES.     01920000
019300         10  FILLER                   PIC X(06) VALUE ' USER='.   01930000
019400         10  PV-CTN-STAT-USERID       PIC X(08) VALUE SPACES.     01940000
019500                                                                  01950000
019600 01  PV-NULL-INDICATORS.                                          01960000
019700     05  PV-CHD-MST-SHPT-ID-NULL   PIC S9(04)     VALUE +0        01970000
019800                                                     COMP SYNC.   01980000
019900     05 PV-CHD-SHPT-UNT-ID-NULL    PIC S9(04)     VALUE +0        01990000
020000                                                     COMP SYNC.   02000000
020100* PROGRAM VARIABLES                                               02010000
020101 01  PV-PROGRAM-VARIABLES.                                        02010100
020102     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02010200
020103                                                     COMP SYNC.   02010300
020104     05  PV-CICS-MSG-AREA.                                        02010400
020105         10  PV-CICS-MSG-AREA1           PIC  X(80)  VALUE SPACE. 02010500
020106         10  PV-CICS-MSG-AREA2           PIC  X(80)  VALUE SPACE. 02010600
020107         10  PV-CICS-MSG-AREA3           PIC  X(80)  VALUE SPACE. 02010700
020108         10  PV-CICS-MSG-AREA4           PIC  X(80)  VALUE SPACE. 02010800
020109         10  PV-CICS-MSG-AREA5           PIC  X(80)  VALUE SPACE. 02010900
020110         10  PV-CICS-MSG-AREA6           PIC  X(80)  VALUE SPACE. 02011000
020120     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 02012000
020130                                                                  02013000
020140     05  PV-EAI-WK-AREA-DESC             PIC X(12) VALUE SPACES.  02014000
020150                                                                  02015000
020160     05  PV-RECEIVE-DATA                 PIC  X(01)  VALUE SPACE. 02016000
020170     05  PV-CICS-RESPONSE                PIC S9(09)  VALUE ZEROS  02017000
020180                                                     COMP SYNC.   02018000
020190     05  PV-CURRENT-TIMESTAMP            PIC X(26).               02019000
020200     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 02020000
020300     05  PV-RECORD-COUNT                 PIC S9(09)  VALUE ZEROS  02030000
020400                                                     COMP SYNC.   02040000
020500     05  PV-SUCRDV-SHIPT-UNT-ID          PIC  S9(18)V COMP-3.     02050000
020600     05  PV-COUNT-IND                    PIC S9(04)  VALUE ZEROS  02060000
020700                                                     COMP SYNC.   02070000
020800     05  PV-SELECT-COUNTER               PIC S9(04)  VALUE ZEROS  02080000
020900                                                     COMP SYNC.   02090000
021000     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  02100000
021100                                                     COMP SYNC.   02110000
021200     05  PV-MULTI-LINE-COUNT             PIC S9(04)  VALUE ZEROS  02120000
021300                                                     COMP SYNC.   02130000
021400     05  PV-ODDS-SUM                     PIC  9(04)  VALUE ZEROS. 02140000
021500     05  PV-EVENS-SUM                    PIC  9(04)  VALUE ZEROS. 02150000
021600     05  PV-TOTAL                        PIC  9(04).              02160000
021700     05  FILLER REDEFINES PV-TOTAL.                               02170000
021800         10  FILLER                      PIC  9(03).              02180000
021900         10  PV-TOTAL-LAST-DIGIT         PIC  9(01).              02190000
022000     05  PV-MST-TOTAL-CARTONS            PIC  9(05).              02200000
022100     05  PV-MST-TOTAL-UNITS              PIC  9(07).              02210000
022200     05  PV-DISPLAY-SEQ-NBR              PIC  S9(9).              02220000
022300     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    02230000
022400                                                     COMP SYNC.   02240000
022500     05  PV-CTN-X                        PIC  X(18).              02250000
022600     05  PV-CTN-N REDEFINES PV-CTN-X PIC 9(18).                   02260000
022700     05  PV-CTN-1-18 REDEFINES PV-CTN-X.                          02270000
022800         10  PV-CTN-9-1                  PIC  9(01).              02280000
022900         10  PV-CTN-9-2                  PIC  9(01).              02290000
023000         10  PV-CTN-9-3                  PIC  9(01).              02300000
023100         10  PV-CTN-9-4                  PIC  9(01).              02310000
023200         10  PV-CTN-9-5                  PIC  9(01).              02320000
023300         10  PV-CTN-9-6                  PIC  9(01).              02330000
023400         10  PV-CTN-9-7                  PIC  9(01).              02340000
023500         10  PV-CTN-9-8                  PIC  9(01).              02350000
023600         10  PV-CTN-9-9                  PIC  9(01).              02360000
023700         10  PV-CTN-9-10                 PIC  9(01).              02370000
023800         10  PV-CTN-9-11                 PIC  9(01).              02380000
023900         10  PV-CTN-9-12                 PIC  9(01).              02390000
024000         10  PV-CTN-9-13                 PIC  9(01).              02400000
024100         10  PV-CTN-9-14                 PIC  9(01).              02410000
024200         10  PV-CTN-9-15                 PIC  9(01).              02420000
024300         10  PV-CTN-9-16                 PIC  9(01).              02430000
024400         10  PV-CTN-9-17                 PIC  9(01).              02440000
024500         10  PV-CTN-9-18                 PIC  9(01).              02450000
024600                                                                  02460000
024700     05  PV-MANIFEST-NBR                 PIC 9(08).               02470000
024800     05  PV-MANIFEST-NBR-R REDEFINES PV-MANIFEST-NBR.             02480000
024900         10  PV-MANF-9-11                PIC  9(01).              02490000
025000         10  PV-MANF-9-12                PIC  9(01).              02500000
025100         10  PV-MANF-9-13                PIC  9(01).              02510000
025200         10  PV-MANF-9-14                PIC  9(01).              02520000
025300         10  PV-MANF-9-15                PIC  9(01).              02530000
025400         10  PV-MANF-9-16                PIC  9(01).              02540000
025500         10  PV-MANF-9-17                PIC  9(01).              02550000
025600         10  PV-MANF-9-18                PIC  9(01).              02560000
025700                                                                  02570000
025710     05  PV-OPER-UNT-ID-X                PIC X(03).               02571000
025720     05  PV-OPER-UNT-ID  REDEFINES PV-OPER-UNT-ID-X               02572000
025730                                         PIC 9(03).               02573000
025740     05  PV-PRINTER-ID                   PIC  X(03) VALUE SPACES. 02574000
025750                                                                  02575000
025760     05  PV-PROGRAM-DATA.                                         02576000
025761         10  PV-STORE                    PIC  X(04)  VALUE SPACE. 02576100
025762         10  PV-STORE-N REDEFINES PV-STORE PIC 9(04).             02576200
025763         10  PV-STORE-NUMBER             PIC  ZZZ9.               02576300
025764                                                                  02576400
025765         10  PV-CARTONS-IN-MASTER        PIC S9(09)   VALUE +0    02576500
025766                                                      COMP-3.     02576600
025767         10  PV-CHILDRN-IN-MASTER        PIC S9(09)   VALUE +0    02576700
025768                                                      COMP-3.     02576800
025769                                                                  02576900
025770         10  PV-STR-NAME-CHAR10-ABBR     PIC  X(10).              02577000
025771         10  PV-DC-5-CHAR-ABBR           PIC  X(05) VALUE SPACES. 02577100
025772         10  PV-DC-5-CHAR-ABBR-R REDEFINES PV-DC-5-CHAR-ABBR.     02577200
025773             15 FILLER                   PIC  X(03).              02577300
025774             15 PV-2-DIGIT-DC-ABBR       PIC  X(02).              02577400
025775                                                                  02577500
025776         10  PV-CTN.                                              02577600
025777             15  PV-CTN-FIRST-DIGIT      PIC  X(01).              02577700
025778             15  PV-CTN-LAST-17          PIC  X(17).              02577800
025779             15  PV-CTN-FILLER           PIC  X(02).              02577900
025780         10  FILLER REDEFINES PV-CTN.                             02578000
025790             15  PV-CTN-FIRST-2-DIGIT    PIC  X(02).              02579000
025800             15  FILLER                  PIC  X(16).              02580000
025900             15  FILLER                  PIC  X(02).              02590000
026000         10  FILLER REDEFINES PV-CTN.                             02600000
026100             15  PV-CTN-SCAN-00          PIC  X(02).              02610000
026200             15  PV-CTN-SCAN-THIRD-DGT   PIC  X(01).              02620000
026300             15  PV-CTN-SCAN-LAST-17     PIC  X(17).              02630000
026400         10  FILLER REDEFINES PV-CTN.                             02640000
026500             15  PV-CTN-SCAN-00          PIC  X(02).              02650000
026600             15  PV-CTN-SCAN-3RD-4TH-DGT PIC  X(02).              02660000
026700             15  FILLER                  PIC  X(16).              02670000
026800         10  FILLER REDEFINES PV-CTN.                             02680000
026900             15  PV-CTN-SCAN-00          PIC  X(02).              02690000
027000             15  PV-CTN-SCAN-LAST-18 PIC      X(18).              02700000
027100         10  PV-CTN-BREAKDOWN            PIC  X(20).              02710000
027200         10  PV-CTN-R REDEFINES PV-CTN-BREAKDOWN.                 02720000
027300             15  PV-CTN-00               PIC  X(02).              02730000
027400             15  PV-CTN-LAST-18          PIC  X(18).              02740000
027500                                                                  02750000
027600                                                                  02760000
027700         10  PV-ORGN-OPER-UNT-ID         PIC  S9(4) COMP.         02770000
027800         10  PV-DEST-OPER-UNT-ID         PIC  S9(4) COMP.         02780000
027900         10  PV-CART-SRC-CDE             PIC  X(3).               02790000
028000         10  PV-SHIPT-UNT-ID             PIC  S9(18)V  COMP-3.    02800000
028100         10  PV-MSTR-CART-IND            PIC  X(1).               02810000
028200         10  PV-PRNT-CART-ID             PIC  S9(18)V COMP-3.     02820000
028201*** PK 11/11/13 BEGIN                                             02820100
028202         10  PV-SYS-TRAIL-CODE           PIC  X(3).               02820200
028203         10  PV-LABEL-DESGNTN            PIC  X(3).               02820300
028204         10  PV-SYS-TRAIL-NLIND          PIC S9(04)  VALUE ZEROS  02820400
028205                                              COMP SYNC.          02820500
028206         10  PV-LABEL-DESG-NLIND         PIC S9(04)  VALUE ZEROS  02820600
028207                                              COMP SYNC.          02820700
028208*** PK 11/11/13 END                                               02820800
028209                                                                  02820900
028210* COMMAREA LAYOUT                                                 02821000
028220 01  CA-COMMAREA.                                                 02822000
028230     COPY PCWS033.                                                02823000
028240                                                                  02824000
028250* COMMAREA FOR PCKUT713 - CARTON STATUS MODULE                    02825000
028260     COPY PCWS046.                                                02826000
028270                                                                  02827000
028280* MAP LAYOUT                                                      02828000
028290     COPY PCKM865.                                                02829000
028300                                                                  02830000
028400* HELP SCREEN COMMAREA                                            02840000
028500     COPY PCWS192.                                                02850000
028600                                                                  02860000
028700* HELP SCREEN WORK AREA                                           02870000
028800     COPY PCWS188.                                                02880000
028900                                                                  02890000
029000*  SENDING/RECEIVING AREA FOR THE                                 02900000
029100*  PRINTER VALIDATION ROUTINE (DPKCS060)                          02910000
029200     COPY DPWS072.                                                02920000
029300                                                                  02930000
029400* SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100)  02940000
029500     COPY DPWS010I.                                               02950000
029600                                                                  02960000
029700* LABEL COMMUNICATION AREA USING SOCKETS - PCKCS707               02970000
029800     COPY PCWS140.                                                02980000
029900                                                                  02990000
030000* COMMUNICATION AREA FOR CALLING PROGRAM DLKCS410                 03000000
030100     COPY DLWS001.                                                03010000
030200                                                                  03020000
030300* COMMUNICATION AREA FOR CALLING PROGRAM DLKCS410                 03030000
030400     COPY DLWS011.                                                03040000
030500                                                                  03050000
030600* COMMUNICATION AREA FOR CALLING PROGRAM DLKCS410                 03060000
030700     COPY DLWS016.                                                03070000
030800                                                                  03080000
030900                                                                  03090000
030910* COMMUNICATION AREA FOR CALLING PROGRAM XLKUP033                 03091000
030920     COPY XLWS072.                                                03092000
030930                                                                  03093000
030940* COMMUNICATION AREA FOR CALLING PROGRAM XLKUP033                 03094000
030950     COPY PCWS242.                                                03095000
030960                                                                  03096000
030970* LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.                03097000
030980     COPY DPWS013.                                                03098000
030990                                                                  03099000
031000* KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST    03100000
031100     COPY DPWS015.                                                03110000
031200                                                                  03120000
031300* KOHL'S STANDARD ATTENTION IDENTIFIER LIST                       03130000
031400     COPY DFHAID.                                                 03140000
031500                                                                  03150000
031600* DB2 AREA FOR THE SHIPMENT UNIT TABLE                            03160000
031700     EXEC SQL                                                     03170000
031800          INCLUDE SUT00024                                        03180000
031900     END-EXEC.                                                    03190000
032000                                                                  03200000
032100* SUT_OTBND_LOC                                                   03210000
032200     EXEC SQL                                                     03220000
032300          INCLUDE SUT00027                                        03230000
032301     END-EXEC.                                                    03230100
032302                                                                  03230200
032303* DB2 AREA FOR THE CONTAINER SHIPMENT UNIT TABLE                  03230300
032304     EXEC SQL                                                     03230400
032305          INCLUDE SUT00099                                        03230500
032306     END-EXEC.                                                    03230600
032307                                                                  03230700
032308* DB2 AREA FOR THE SU-CARTON DIVERT TO OUTBOUND TRIP ASSOC TABLE  03230800
032309     EXEC SQL                                                     03230900
032310          INCLUDE TSUCDOT                                         03231000
032320     END-EXEC.                                                    03232000
032330                                                                  03233000
032340* DB2 AREA FOR THE SU - OUTBOUND TRAILER TRIP TABLE               03234000
032350     EXEC SQL                                                     03235000
032360          INCLUDE TSUOBTR                                         03236000
032370     END-EXEC.                                                    03237000
032380                                                                  03238000
032390* DB2 AREA FOR THE CN - TRAILER DEFINITION TABLE                  03239000
032400     EXEC SQL                                                     03240000
032500          INCLUDE TCNTRID                                         03250000
032600     END-EXEC.                                                    03260000
032700                                                                  03270000
032800*                                                                 03280000
032900* DCLGEN FOR THE LOGISTICS DOMAIN LOCATION MASTER TABLE           03290000
033000*                                                                 03300000
033100     EXEC SQL                                                     03310000
033200         INCLUDE XLT00010                                         03320000
033300     END-EXEC.                                                    03330000
033400                                                                  03340000
033500*  CARTON DIVERT TABLE.                                           03350000
033600                                                                  03360000
033700     EXEC SQL                                                     03370000
033800         INCLUDE TSUCRDV                                          03380000
033900     END-EXEC.                                                    03390000
034000*** PK 11/11/13 BEGIN                                             03400000
034100                                                                  03410000
034200*  XLT_HAZDS_MTRL_SKU - HAZARDOUS MATERIAL SKU ATTRIBUTE       *  03420000
034300     EXEC SQL                                                     03430000
034400          INCLUDE XLT00042                                        03440000
034500     END-EXEC.                                                    03450000
034600                                                                  03460000
034700*  WST_INTGRTN_TYP                                                03470000
034800     EXEC SQL                                                     03480000
034900          INCLUDE WST00008                                        03490000
035000     END-EXEC.                                                    03500000
035100                                                                  03510000
035200* WST_ATTR_DEFN                                                   03520000
035300     EXEC SQL                                                     03530000
035400          INCLUDE WST00009                                        03540000
035500     END-EXEC.                                                    03550000
035600                                                                  03560000
035700* WST_ATTR_ELEM                                                   03570000
035800     EXEC SQL                                                     03580000
035900          INCLUDE WST00010                                        03590000
036000     END-EXEC.                                                    03600000
036100                                                                  03610000
036200* XLT_SKU                                                         03620000
036300     EXEC SQL                                                     03630000
036400          INCLUDE XLT00003                                        03640000
036500     END-EXEC.                                                    03650000
036600                                                                  03660000
036700* XLT_UPC                                                         03670000
036800     EXEC SQL                                                     03680000
036900          INCLUDE XLT00006                                        03690000
037000     END-EXEC.                                                    03700000
037100* SUT_OTBND_UPC                                                   03710000
037200     EXEC SQL                                                     03720000
037300          INCLUDE SUT00028                                        03730000
037400     END-EXEC.                                                    03740000
037500* PARAMETER TABLE                                                 03750000
037600     EXEC SQL                                                     03760000
037700          INCLUDE TKRPRPM                                         03770000
037800     END-EXEC.                                                    03780000
037900*** PK 11/11/13 END                                               03790000
038000                                                                  03800000
038100* COMMUNICATIONS AREA FOR DB2                                     03810000
038200     EXEC SQL                                                     03820000
038300         INCLUDE SQLCA                                            03830000
038400     END-EXEC.                                                    03840000
038500*                                                                 03850000
038600*                                                                 03860000
038700 LINKAGE SECTION.                                                 03870000
038800 01  DFHCOMMAREA.                                                 03880000
038900     05  FILLER                       OCCURS 1 TO 4072 TIMES      03890000
038910                                      DEPENDING ON EIBCALEN.      03891000
038911         10  FILLER                   PIC X.                      03891100
038912*                                                                 03891200
038913*                                                                 03891300
038914 PROCEDURE DIVISION.                                              03891400
038915 0000-PROGRAM-MAINLINE.                                           03891500
038916                                                                  03891600
038917     INITIALIZE CA-COMMAREA                                       03891700
038918     MOVE DFHCOMMAREA TO CA-COMMAREA                              03891800
038919                                                                  03891900
038920*** PK 11/11/13 BEGIN                                             03892000
038930     PERFORM 1400-CHK-WTHR-HAZFACLTY                              03893000
038940*** PK 11/11/13 BEGIN                                             03894000
038950                                                                  03895000
038960     EVALUATE TRUE                                                03896000
038961         WHEN EIBCALEN = ZERO                                     03896100
038962              MOVE PC-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA   03896200
038963              PERFORM 8110-RETURN                                 03896300
038964                                                                  03896400
038965         WHEN EIBTRNID = 'Z278'                                   03896500
038966              MOVE DFHCOMMAREA         TO PC192-COMMAREA          03896600
038967              MOVE PC192-HOST-SAVE-AREA                           03896700
038968                                       TO CA-COMMAREA             03896800
038969              SET PC033-PROCESS-SCREEN TO TRUE                    03896900
038970              MOVE PC192-HOST-SAVE-MAP TO PC865AO                 03897000
038971              MOVE -1                  TO ABRCDEL                 03897100
038972                                                                  03897200
038973             IF PC033-NEW-VERSION                                 03897300
038974               IF (AMSGLNO = SPACES OR                            03897400
038975                  AMSGLNO = LOW-VALUES)                           03897500
038976                EVALUATE PC033-MASTER-TYPE-SELECTION              03897600
038977                  WHEN 'FJ '                                      03897700
038978                    MOVE 'FINE JEWELRY' TO PV-EAI-WK-AREA-DESC    03897800
038979                  WHEN 'BJ '                                      03897900
038980                    MOVE 'BULK JEWELRY' TO PV-EAI-WK-AREA-DESC    03898000
038990                  WHEN 'PJ '                                      03899000
039000                    MOVE 'PBS JEWELRY ' TO PV-EAI-WK-AREA-DESC    03900000
039100                  WHEN 'NCL'                                      03910000
039200                    MOVE 'LRGE NON-CON' TO PV-EAI-WK-AREA-DESC    03920000
039300                  WHEN 'NCS'                                      03930000
039400                    MOVE 'SML NON-CON ' TO PV-EAI-WK-AREA-DESC    03940000
039500                  WHEN 'O  '                                      03950000
039600                    MOVE 'OTHER       ' TO PV-EAI-WK-AREA-DESC    03960000
039700                  END-EVALUATE                                    03970000
039800                                                                  03980000
039900                 MOVE 'TYPE = ' TO PC-INVALID-TYPE-TEXT           03990000
040000                 MOVE PV-EAI-WK-AREA-DESC                         04000000
040100                     TO PC-INVALID-TYPE-N                         04010000
040200                 MOVE PC-INVALID-MST-TYPE TO AMSGLNO              04020000
040300                END-IF                                            04030000
040400             END-IF                                               04040000
040500              PERFORM 8000-SEND-MAP                               04050000
040501              PERFORM 8100-RETURN-TRANID                          04050100
040502                                                                  04050200
040503         WHEN EIBAID = DFHCLEAR                                   04050300
040504         WHEN PC033-INITIALIZE-SCREEN                             04050400
040505            SET PC033-PROCESS-SCREEN TO TRUE                      04050500
040506            PERFORM 1000-INITIALIZE                               04050600
040507            MOVE PC-CURRENT-PROGRAM-NAME                          04050700
040508                               TO PC033-LAST-PROGRAM              04050800
040509            MOVE -1       TO ABRCDEL                              04050900
040510                                                                  04051000
040520             IF PC033-NEW-VERSION                                 04052000
040530             IF (AMSGLNO = SPACES OR                              04053000
040540                AMSGLNO = LOW-VALUES)                             04054000
040550              EVALUATE PC033-MASTER-TYPE-SELECTION                04055000
040560                WHEN 'FJ '                                        04056000
040570                  MOVE 'FINE JEWELRY' TO PV-EAI-WK-AREA-DESC      04057000
040580                WHEN 'BJ '                                        04058000
040590                  MOVE 'BULK JEWELRY' TO PV-EAI-WK-AREA-DESC      04059000
040600                WHEN 'PJ '                                        04060000
040700                  MOVE 'PBS JEWELRY ' TO PV-EAI-WK-AREA-DESC      04070000
040800                WHEN 'NCL'                                        04080000
040900                  MOVE 'LRGE NON-CON' TO PV-EAI-WK-AREA-DESC      04090000
041000                WHEN 'NCS'                                        04100000
041100                  MOVE 'SML NON-CON ' TO PV-EAI-WK-AREA-DESC      04110000
041200                WHEN 'O  '                                        04120000
041300                  MOVE 'OTHER       ' TO PV-EAI-WK-AREA-DESC      04130000
041400                END-EVALUATE                                      04140000
041500                                                                  04150000
041600               MOVE 'TYPE = ' TO PC-INVALID-TYPE-TEXT             04160000
041700               MOVE PV-EAI-WK-AREA-DESC                           04170000
041800                   TO PC-INVALID-TYPE-N                           04180000
041900               MOVE PC-INVALID-MST-TYPE TO AMSGLNO                04190000
042000             END-IF                                               04200000
042100             END-IF                                               04210000
042200                                                                  04220000
042300            PERFORM 8000-SEND-MAP                                 04230000
042400            PERFORM 8100-RETURN-TRANID                            04240000
042500                                                                  04250000
042501         WHEN EIBAID = DFHENTER                                   04250100
042502             IF PC033-ROOT-PROGRAM = PC-ERROR-SCREEN-PGM          04250200
042503                MOVE PC-CURRENT-PROGRAM-NAME TO                   04250300
042504                                     PV-TRANSFER-PROGRAM          04250400
042505                                     PC033-ROOT-PROGRAM           04250500
042506                PERFORM 4000-XCTL-TO-SELECTED-PROGRAM             04250600
042507             ELSE                                                 04250700
042508                 CONTINUE                                         04250800
042509             END-IF                                               04250900
042510             PERFORM 2000-PROCESS-SCREEN-FIELDS                   04251000
042511                                                                  04251100
042512         WHEN EIBAID = DFHPF1                                     04251200
042513             PERFORM 8020-RECEIVE-MAP                             04251300
042514             MOVE PC865AO             TO PC192-HOST-SAVE-MAP      04251400
042515             PERFORM 1200-HELP-SCREEN                             04251500
042516                                                                  04251600
042517         WHEN EIBAID = DFHPF3                                     04251700
042518              INITIALIZE PC033-CARTON                             04251800
042519              INITIALIZE PC033-STR-NBR                            04251900
042520              INITIALIZE PC033-SML-PRTR-ID                        04252000
042521                                                                  04252100
042522              MOVE PC-MASTER-CONTAINER-PGM TO                     04252200
042523                          PV-TRANSFER-PROGRAM                     04252300
042524              MOVE PC-CURRENT-PROGRAM-NAME TO                     04252400
042525                          PC033-LAST-PROGRAM                      04252500
042526              PERFORM 4000-XCTL-TO-SELECTED-PROGRAM               04252600
042527                                                                  04252700
042528         WHEN EIBAID = DFHPF5                                     04252800
042529              PERFORM 2000-PROCESS-SCREEN-FIELDS                  04252900
042530                                                                  04253000
042540         WHEN OTHER                                               04254000
042550              MOVE PC-UNRECOGNIZED-PF-KEY-MSG TO AMSGLNO          04255000
042560              PERFORM 8010-SEND-DATA-ONLY                         04256000
042570              PERFORM 8100-RETURN-TRANID                          04257000
042580     END-EVALUATE.                                                04258000
042590                                                                  04259000
042600     GOBACK.                                                      04260000
042700*                                                                 04270000
042800*                                                                 04280000
042900 1000-INITIALIZE.                                                 04290000
043000     EVALUATE TRUE                                                04300000
043100        WHEN PC033-LAST-PROGRAM = PC-BARCODE-ENTRY-PGM            04310000
043200             INITIALIZE PV-PROGRAM-DATA                           04320000
043300             MOVE PC033-CHILD-CARTON     TO ABRCDEO               04330000
043400             MOVE PC033-MASTER-CARTON    TO PC033-CARTON          04340000
043500             MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA               04350000
043600             MOVE -1                     TO ABRCDEL               04360000
043700             MOVE SPACES                 TO PC033-SML-PRTR-ID     04370000
043800                                                                  04380000
043900        WHEN PC033-LAST-PROGRAM = PC-MANIFEST-MENU-PGM OR         04390000
044000             PC033-LAST-PROGRAM = PC-CARTON-FUNC-PGM OR           04400000
044100             PC033-LAST-PROGRAM = PC-MASTER-CONTAINER-PGM         04410000
044200             INITIALIZE PV-PROGRAM-DATA                           04420000
044300             MOVE SPACES            TO  ABRCDEO                   04430000
044400             MOVE -1                TO  ABRCDEL                   04440000
044500                                                                  04450000
044600        WHEN PC033-LAST-PROGRAM = PC-ERROR-SCREEN-PGM             04460000
044700             IF PC033-PGM-MSG-NBR = 10 AND PC033-F4-KEY           04470000
044800                MOVE PC033-CARTON         TO DK-CARTON            04480000
044900                                                                  04490000
045000                IF PC033-BARCODE-EXISTS                           04500000
045100                   MOVE PC033-BRCDE-NBR     TO DK-BARCODE-NBR     04510000
045200                   MOVE PC033-SHIPT-UNT-ID  TO DK-CHILD-CARTON    04520000
045300                ELSE                                              04530000
045400                   MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON    04540000
045500                END-IF                                            04550000
045600                PERFORM 3100-REMOVE-CHLD-FROM-MSTR                04560000
045700                MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA            04570000
045800                MOVE -1                     TO ABRCDEL            04580000
045900                MOVE PC033-CHILD-CARTON     TO ABRCDEO            04590000
046000             END-IF                                               04600000
046100                                                                  04610000
046200             IF PC033-PGM-MSG-NBR = 12 AND PC033-F4-KEY           04620000
046300                MOVE PC033-CARTON         TO DK-CARTON            04630000
046400                                                                  04640000
046500                IF PC033-BARCODE-EXISTS                           04650000
046600                   MOVE PC033-BRCDE-NBR     TO DK-BARCODE-NBR     04660000
046700                   MOVE PC033-SHIPT-UNT-ID  TO DK-CHILD-CARTON    04670000
046800                ELSE                                              04680000
046900                   MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON    04690000
047000                END-IF                                            04700000
047100                MOVE PC033-MASTER-CARTON  TO DK-MASTER-CARTON     04710000
047200                PERFORM 2252-CHK-IF-STORE-MATCH                   04720000
047300                IF PS-ERROR-NO                                    04730000
047400                   PERFORM 3300-REASSIGN-TO-MSTR                  04740000
047500                   MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA         04750000
047600                   MOVE -1                   TO ABRCDEL           04760000
047700                   MOVE PC033-CHILD-CARTON   TO ABRCDEO           04770000
047800                END-IF                                            04780000
047900             END-IF                                               04790000
048000                                                                  04800000
048100             IF PC033-PGM-MSG-NBR = 13 AND PC033-F2-KEY           04810000
048200                MOVE PC033-CARTON         TO DK-CARTON            04820000
048300                                                                  04830000
048400                IF PC033-BARCODE-EXISTS                           04840000
048500                   MOVE PC033-BRCDE-NBR     TO DK-BARCODE-NBR     04850000
048600                   MOVE PC033-SHIPT-UNT-ID  TO DK-CHILD-CARTON    04860000
048700                ELSE                                              04870000
048800                   MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON    04880000
048900                END-IF                                            04890000
049000                                                                  04900000
049100                PERFORM 2252-CHK-IF-STORE-MATCH                   04910000
049200                IF PS-ERROR-NO                                    04920000
049300                   PERFORM 3400-ADD-MSTR-TO-MSTR                  04930000
049400                   MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA         04940000
049500                   MOVE -1                   TO ABRCDEL           04950000
049600                   MOVE PC033-CHILD-CARTON   TO ABRCDEO           04960000
049700                END-IF                                            04970000
049800             END-IF                                               04980000
049900                                                                  04990000
050000             IF PC033-PGM-MSG-NBR = 19 AND PC033-F4-KEY           05000000
050100                MOVE PC033-CARTON         TO DK-CARTON            05010000
050200                                                                  05020000
050300                IF PC033-BARCODE-EXISTS                           05030000
050400                   MOVE PC033-BRCDE-NBR     TO DK-BARCODE-NBR     05040000
050500                   MOVE PC033-SHIPT-UNT-ID  TO DK-CHILD-CARTON    05050000
050600                ELSE                                              05060000
050700                   MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON    05070000
050800                END-IF                                            05080000
050900                PERFORM 3200-REMOVE-MSTR-FROM-MSTR                05090000
051000                MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA            05100000
051100                MOVE -1                   TO ABRCDEL              05110000
051200                MOVE PC033-CHILD-CARTON   TO ABRCDEO              05120000
051300             END-IF                                               05130000
051400                                                                  05140002
051500             IF PC033-PGM-MSG-NBR = 33 AND PC033-F2-KEY           05150000
051600                MOVE PC033-CARTON         TO DK-CARTON            05160000
051700                IF PC033-BARCODE-EXISTS                           05170000
051800                   MOVE PC033-SHIPT-UNT-ID  TO DK-SHIPT-UNT-ID    05180000
051900                      PERFORM 3510-ADD-CHILD-TO-MSTR              05190000
052000                      MOVE DK-SHIPT-UNT-ID                        05200000
052100                                      TO PV-SUCRDV-SHIPT-UNT-ID   05210000
052200                ELSE                                              05220000
052300                   MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON    05230000
052400                      PERFORM 3500-ADD-CHILD-TO-MSTR              05240000
052500                      MOVE DK-CHILD-CARTON                        05250000
052600                                      TO PV-SUCRDV-SHIPT-UNT-ID   05260000
052700                END-IF                                            05270000
052800                PERFORM 3600-INACT-DIVERTER-CTN                   05280000
052900                MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA            05290000
053000                MOVE -1                   TO ABRCDEL              05300000
053100                MOVE PC033-CHILD-CARTON   TO ABRCDEO              05310000
053200             END-IF                                               05320000
053400                                                                  05340000
053401** RPK 7/29/21 - START                                            05340102
053410             IF PC033-PGM-MSG-NBR = 34 AND PC033-F4-KEY           05341002
053420                MOVE PC033-CARTON         TO DK-CARTON            05342002
053430                                                                  05343002
053440                IF PC033-BARCODE-EXISTS                           05344002
053450                   MOVE PC033-BRCDE-NBR     TO DK-BARCODE-NBR     05345002
053460                   MOVE PC033-SHIPT-UNT-ID  TO DK-CHILD-CARTON    05346002
053470                ELSE                                              05347002
053480                   MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON    05348002
053490                END-IF                                            05349002
053491                MOVE PC033-MASTER-CARTON  TO DK-MASTER-CARTON     05349102
053492                PERFORM 2252-CHK-IF-STORE-MATCH                   05349202
053493                IF PS-ERROR-NO                                    05349305
053495                   PERFORM 3200-REMOVE-MSTR-FROM-MSTR             05349502
053496                   MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA         05349602
053497                   MOVE -1                   TO ABRCDEL           05349702
053498                   MOVE PC033-CHILD-CARTON   TO ABRCDEO           05349802
053499                END-IF                                            05349902
053500                IF PS-ERROR-NO                                    05350004
053501                   MOVE PC033-MASTER-CARTON TO DK-CARTON          05350105
053502                   PERFORM 3400-ADD-MSTR-TO-MSTR                  05350204
053503                   MOVE DP015-UNP-ALP-NOR-MDT  TO ABRCDEA         05350304
053504                   MOVE -1                   TO ABRCDEL           05350404
053505                   MOVE PC033-CHILD-CARTON   TO ABRCDEO           05350504
053506                END-IF                                            05350604
053507             END-IF                                               05350702
053508** RPK 7/29/21 - END                                              05350806
053509                                                                  05350902
053510        WHEN OTHER                                                05351000
053600                MOVE DP015-PRO-NOR-OFF TO  ACARTNA                05360000
053700                MOVE -1                TO  ACARTNL                05370000
053800                COMPUTE PV-CTN-N     = PC033-CARTON * 1           05380000
053900                MOVE PV-CTN-N          TO  ACARTNO                05390000
054000     END-EVALUATE.                                                05400000
054100                                                                  05410000
054200     MOVE PC033-MASTER-CARTON     TO ACARTNO                      05420000
054300                                     DK-CARTON                    05430000
054400     MOVE DP015-HL-OFF            TO ACARTNH                      05440000
054500     MOVE DP015-PRO-NOR-MDT       TO ACARTNA                      05450000
054600                                                                  05460000
054700     MOVE PC033-STR-NBR           TO PV-STORE-N                   05470000
054800     MOVE PV-STORE-N              TO PV-STORE-NUMBER              05480000
054900     MOVE PV-STORE-NUMBER         TO ASTRO                        05490000
055000                                                                  05500000
055100     PERFORM 2259-SELECT-OTBND-CART                               05510000
055200     IF SUT00024-SHIPT-UNT-ID = SUT00024-PRNT-CART-ID             05520000
055300        PERFORM 2261-GET-CTNS-IN-MASTER                           05530000
055400        MOVE PV-CARTONS-IN-MASTER    TO ACTNMSTRO                 05540000
055500                                        PC033-CTNS-IN-MASTER      05550000
055600     ELSE                                                         05560000
055700        PERFORM 2262-COUNT-CHILDREN-OF-MASTER                     05570000
055800        MOVE PV-CHILDRN-IN-MASTER    TO ACTNMSTRO                 05580000
055900                                        PC033-CTNS-IN-MASTER      05590000
056000     END-IF                                                       05600000
056100                                                                  05610000
056200     MOVE PC033-SML-PRTR-ID       TO APRTRO.                      05620000
056300                                                                  05630000
056400     MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM.          05640000
056500*                                                                 05650000
056600*                                                                 05660000
056700 1200-HELP-SCREEN.                                                05670000
056800     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      05680000
056900     MOVE 'PCKRF865'                  TO PC192-PROGRAM-NAME       05690000
057000     COPY PCPD188.                                                05700000
057100     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      05710000
057200     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     05720000
057300     PERFORM 8220-XCTL-TO-HELP.                                   05730000
057400*                                                                 05740000
057500*** PK 11/11/13 BEGIN                                             05750000
057600*----------------------------------------------------------------*05760000
057700* CHECK WHETHER DC IS CAPABLE OF HANDLING HAZMAT ITEMS           *05770000
057800*----------------------------------------------------------------*05780000
057900 1400-CHK-WTHR-HAZFACLTY.                                         05790000
058000                                                                  05800000
058100     MOVE PC033-OPER-UNT-ID TO  DK-HAZ-OPER-UNT-ID.               05810000
058200                                                                  05820000
058300     EXEC SQL                                                     05830000
058400          SELECT  FUNC_TXT                                        05840000
058500            INTO :KRPRPM-FUNC-TXT                                 05850000
058600            FROM  TKRPRPM                                         05860000
058700           WHERE  LOC_ID            = :DK-HAZ-OPER-UNT-ID         05870000
058800             AND  INTFC_SYS_CDE     = :DK-INTFC-SYS-CDE           05880000
058900             AND  SYS_PRC_FUNC_CDE  = :DK-SYS-MSTHAZ-CDE          05890000
059000             AND  FUNC_PRC_STAT_CDE = :DK-FUNC-PRC-STAT-CDE       05900000
059100             AND  FUNC_BEG_TMST    <=  CURRENT TIMESTAMP          05910000
059200             AND  FUNC_END_TMST    >=  CURRENT TIMESTAMP          05920000
059300     END-EXEC.                                                    05930000
059400                                                                  05940000
059500     EVALUATE TRUE                                                05950000
059600         WHEN SQLCODE = +0                                        05960000
059700              IF  KRPRPM-FUNC-TXT  = 'Y'                          05970000
059800                  SET  PS-HAZ-FACILITY-YES  TO  TRUE              05980000
059900              ELSE                                                05990000
060000                  SET  PS-HAZ-FACILITY-NO   TO  TRUE              06000000
060100              END-IF                                              06010000
060200         WHEN SQLCODE = +100                                      06020000
060300              SET  PS-HAZ-FACILITY-NO       TO  TRUE              06030000
060400         WHEN SQLCODE = -904                                      06040000
060500         WHEN SQLCODE = -913                                      06050000
060600         WHEN SQLCODE = -911                                      06060000
060700             MOVE 23                  TO PV-ERROR-NBR             06070000
060800             PERFORM 9903-WRITE-CICS-LOG                          06080000
060900             PERFORM 9000-SOFT-ABORT                              06090000
061000         WHEN SQLWARN0 NOT = SPACES                               06100000
061100         WHEN SQLCODE NOT EQUAL ZERO                              06110000
061200             MOVE '1400-CHK-WTHR-HAZFACLTY'                       06120000
061300                             TO DP013-PARAGRAPH                   06130000
061400             MOVE 'PCKRF865 - CHK WHTR HAZ FACLTY'                06140000
061500                             TO DP013-MESSAGE-TEXT(1)             06150000
061600             MOVE SQLCA      TO DP013-SQLCA                       06160000
061700             MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME(1)           06170000
061800             SET DP013-DB2-ABEND                                  06180000
061900                             TO TRUE                              06190000
062000             SET DP013-ROLLBACK                                   06200000
062100                             TO TRUE                              06210000
062200             SET DP013-XCTL-DISPLAY-RESTART                       06220000
062300                             TO TRUE                              06230000
062400             PERFORM DP014-0000-PROCESS-ABEND                     06240000
062500     END-EVALUATE.                                                06250000
062600*** PK 11/11/13 END                                               06260000
062700*                                                                 06270000
062800 2000-PROCESS-SCREEN-FIELDS.                                      06280000
062900     PERFORM 8020-RECEIVE-MAP.                                    06290000
063000     PERFORM 2100-EDIT-INPUT.                                     06300000
063100                                                                  06310000
063200*    IF PS-VALID-INPUT                                            06320000
063300*        SET PS-ERROR-NO              TO TRUE                     06330000
063400*    ELSE                                                         06340000
063500         MOVE -1                      TO ABRCDEL                  06350000
063600         PERFORM 8010-SEND-DATA-ONLY                              06360000
063700         PERFORM 8100-RETURN-TRANID.                              06370000
063800*    END-IF.                                                      06380000
063900*                                                                 06390000
064000*                                                                 06400000
064100 2100-EDIT-INPUT.                                                 06410000
064110     PERFORM 2210-INITIALIZE-ATTRIBUTES.                          06411000
064111     PERFORM 2230-EDIT-CTN.                                       06411100
064112                                                                  06411200
064113     EVALUATE TRUE                                                06411300
064114        WHEN PS-VALID-INPUT AND EIBAID = DFHPF5                   06411400
064115           EVALUATE TRUE                                          06411500
064116             WHEN PC033-CHILD-CARTON > ZEROS                      06411600
064117                  IF PC033-SML-PRTR-ID = SPACES                   06411700
064118                     MOVE DP015-UNP-ALP-BRT-MDT  TO APRTRA        06411800
064119                     MOVE -1                     TO APRTRL        06411900
064120                     MOVE SPACES                 TO APRTRO        06412000
064121                     MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO       06412100
064122                     PERFORM 8010-SEND-DATA-ONLY                  06412200
064123                     PERFORM 8100-RETURN-TRANID                   06412300
064124                  ELSE                                            06412400
064125                     IF PC033-SML-PRTR-ID > SPACES                06412500
064126                        MOVE PC033-SML-PRTR-ID TO PV-PRINTER-ID   06412600
064127                        PERFORM 3010-VALIDATE-PRINTER             06412700
064128                           MOVE DP072-PRTR-IP-ADDRESS             06412800
064129                                    TO PC140-SML-IP-ADDRESS       06412900
064130                           MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE    06413000
064131                                    TO PC140-SML-OS-RLSE-CDE      06413100
064132                           MOVE DP072-PRTR-DATA-XFER-MODE-ID      06413200
064133                                    TO PC140-SML-XFER-MODE-ID     06413300
064134                           MOVE DP072-XMIT-INTFC-CDE              06413400
064135                                    TO PC140-XMIT-INTFC-CDE       06413500
064136                           MOVE DP072-PRTR-TYP-CDE                06413600
064137                                    TO PC140-SML-PRTR-TYPE        06413700
064138                           MOVE DP072-PRTR-OPER-UNT-ID            06413800
064139                                    TO PC-OPER-UNT-ID             06413900
064140                        IF PS-VALID-PRINTER-ID                    06414000
064141                           MOVE DP015-UNP-ALP-NOR-MDT             06414100
064142                                                   TO APRTRA      06414200
064143                           MOVE -1                 TO APRTRL      06414300
064144*GET UPC # FROM PC033-CARTON                                      06414400
064145                           MOVE PC033-CARTON TO PV-CTN-N          06414500
064146                           MOVE PV-CTN-N TO PV-CTN                06414600
064147                                                                  06414700
064148                           MOVE PV-CTN TO PV-CTN-X                06414800
064149                           MOVE PV-CTN-9-11 TO PV-MANF-9-11       06414900
064150                           MOVE PV-CTN-9-12 TO PV-MANF-9-12       06415000
064160                           MOVE PV-CTN-9-13 TO PV-MANF-9-13       06416000
064170                           MOVE PV-CTN-9-14 TO PV-MANF-9-14       06417000
064180                           MOVE PV-CTN-9-15 TO PV-MANF-9-15       06418000
064190                           MOVE PV-CTN-9-16 TO PV-MANF-9-16       06419000
064200                           MOVE PV-CTN-9-17 TO PV-MANF-9-17       06420000
064300                           MOVE PV-CTN-9-18 TO PV-MANF-9-18       06430000
064400                                                                  06440000
064500                           PERFORM 4500-SETUP-COM-LABEL           06450000
064600                           PERFORM 8010-SEND-DATA-ONLY            06460000
064700                           PERFORM 8100-RETURN-TRANID             06470000
064800                        ELSE                                      06480000
064900                           MOVE DP015-UNP-ALP-BRT-MDT             06490000
065000                                              TO APRTRA           06500000
065100                           MOVE -1            TO APRTRL           06510000
065200                           MOVE PV-PRINTER-ID TO APRTRO           06520000
065300                           MOVE PC-INVALID-PRINTER-ID             06530000
065400                                              TO AMSGLNO          06540000
065500                           PERFORM 8010-SEND-DATA-ONLY            06550000
065600                           PERFORM 8100-RETURN-TRANID             06560000
065700                        END-IF                                    06570000
065800                     END-IF                                       06580000
065900                  END-IF                                          06590000
066000             WHEN PC033-CHILD-CARTON = ZEROS                      06600000
066100                  IF PC033-SML-PRTR-ID = SPACES                   06610000
066200                     MOVE DP015-UNP-ALP-BRT-MDT  TO APRTRA        06620000
066300                     MOVE -1                     TO APRTRL        06630000
066400                     MOVE SPACES                 TO APRTRO        06640000
066500                     MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO       06650000
066600                     PERFORM 8010-SEND-DATA-ONLY                  06660000
066700                     PERFORM 8100-RETURN-TRANID                   06670000
066800                  ELSE                                            06680000
066900                     IF PC033-SML-PRTR-ID > SPACES                06690000
067000                        MOVE PC033-SML-PRTR-ID TO PV-PRINTER-ID   06700000
067100                        PERFORM 3010-VALIDATE-PRINTER             06710000
067200                           MOVE DP072-PRTR-IP-ADDRESS             06720000
067300                                    TO PC140-SML-IP-ADDRESS       06730000
067400                           MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE    06740000
067500                                    TO PC140-SML-OS-RLSE-CDE      06750000
067600                           MOVE DP072-PRTR-DATA-XFER-MODE-ID      06760000
067700                                    TO PC140-SML-XFER-MODE-ID     06770000
067800                           MOVE DP072-XMIT-INTFC-CDE              06780000
067900                                    TO PC140-XMIT-INTFC-CDE       06790000
068000                           MOVE DP072-PRTR-TYP-CDE                06800000
068100                                    TO PC140-SML-PRTR-TYPE        06810000
068200                           MOVE DP072-PRTR-OPER-UNT-ID            06820000
068300                                    TO PC-OPER-UNT-ID             06830000
068400                        IF PS-VALID-PRINTER-ID                    06840000
068500                           MOVE DP015-UNP-ALP-NOR-MDT             06850000
068600                                                   TO APRTRA      06860000
068700                           MOVE -1                 TO APRTRL      06870000
068800*GET UPC # FROM PC033-CARTON                                      06880000
068900                           MOVE PC033-CARTON TO PV-CTN-N          06890000
069000                           MOVE PV-CTN-N TO PV-CTN                06900000
069100                                                                  06910000
069200                           MOVE PV-CTN TO PV-CTN-X                06920000
069300                           MOVE PV-CTN-9-11 TO PV-MANF-9-11       06930000
069400                           MOVE PV-CTN-9-12 TO PV-MANF-9-12       06940000
069500                           MOVE PV-CTN-9-13 TO PV-MANF-9-13       06950000
069600                           MOVE PV-CTN-9-14 TO PV-MANF-9-14       06960000
069700                           MOVE PV-CTN-9-15 TO PV-MANF-9-15       06970000
069800                           MOVE PV-CTN-9-16 TO PV-MANF-9-16       06980000
069900                           MOVE PV-CTN-9-17 TO PV-MANF-9-17       06990000
070000                           MOVE PV-CTN-9-18 TO PV-MANF-9-18       07000000
070100                                                                  07010000
070200                           PERFORM 4500-SETUP-COM-LABEL           07020000
070300                           PERFORM 8010-SEND-DATA-ONLY            07030000
070400                           PERFORM 8100-RETURN-TRANID             07040000
070500                        ELSE                                      07050000
070600                           MOVE DP015-UNP-ALP-BRT-MDT             07060000
070700                                              TO APRTRA           07070000
070800                           MOVE -1            TO APRTRL           07080000
070900                           MOVE PV-PRINTER-ID TO APRTRO           07090000
071000                           MOVE PC-INVALID-PRINTER-ID             07100000
071100                                              TO AMSGLNO          07110000
071200                           PERFORM 8010-SEND-DATA-ONLY            07120000
071300                           PERFORM 8100-RETURN-TRANID             07130000
071400                        END-IF                                    07140000
071500                     END-IF                                       07150000
071600                  END-IF                                          07160000
071700           END-EVALUATE                                           07170000
071800                                                                  07180000
071900        WHEN PS-VALID-INPUT AND PS-CARTON-EXISTS                  07190000
072000           AND EIBAID = DFHENTER                                  07200000
072100           EVALUATE TRUE                                          07210000
072200              WHEN PC033-CHILD-CARTON > ZEROS                     07220000
072400                   IF PC033-CARTON NOT = PC033-MASTER-CARTON      07240000
072500                       MOVE PC033-MASTER-CARTON TO PC033-CARTON   07250000
072600                   END-IF                                         07260000
072700** RPK 7/29/21 - START                                            07270000
072710                   IF PC033-CHILD-CARTON = PC033-MASTER-CARTON    07271000
072720                      SET PS-ERROR-YES     TO TRUE                07272000
072730                      MOVE SPACES          TO PC033-SQLCA         07273000
072740                      SET PC033-INITIALIZE-SCREEN TO TRUE         07274000
072750                      MOVE 15              TO PC033-PGM-MSG-NBR   07275000
072760                      PERFORM 8210-XCTL-ERROR-SCREEN              07276000
072770                   END-IF                                         07277000
072780** RPK 7/29/21 - END                                              07278000
072800                   MOVE PC033-CARTON       TO DK-CARTON           07280000
072900                   MOVE PC033-CHILD-CARTON TO DK-CHILD-CARTON     07290000
073000*MESSAGE 16                                                       07300000
073100                   PERFORM 3000-DETERMINE-LAST-ACTIVITY           07310000
073200                                                                  07320000
073300*MESSAGE 10                                                       07330000
073400                   PERFORM 2257-CHK-IF-ASSIGNED-TO-MSTR           07340000
073500*MESSAGE 12 AND MESSAGE 34                                        07350002
073600                   PERFORM 2258-CHK-IF-ASGN-TO-DIFF-MSTR          07360000
073700*MESSAGE 15                                                       07370000
073800                   IF PC033-CARTON = PC033-CHILD-CARTON           07380000
073900                      PERFORM 2256-CHK-IF-SAME-MASTER             07390000
074000                   END-IF                                         07400000
074100*MESSAGE 11                                                       07410000
074200                   PERFORM 2252-CHK-IF-STORE-MATCH                07420000
074300                   IF PS-ERROR-NO AND PC033-BARCODE-EXISTS        07430000
074400*** PK 11/11/13 BEGIN                                             07440000
074500                      IF PS-HAZ-FACILITY-YES                      07450000
074600                         MOVE DK-SHIPT-UNT-ID TO DK-SHIPMENT-ID   07460000
074700                         PERFORM 2263-CHK-IF-HAZMAT               07470000
074800                      END-IF                                      07480000
074900*** PK 11/11/13 END                                               07490000
075000                         PERFORM 3510-ADD-CHILD-TO-MSTR           07500000
075100                         MOVE DK-SHIPT-UNT-ID                     07510000
075200                                         TO PV-SUCRDV-SHIPT-UNT-ID07520000
075201                   ELSE                                           07520100
075202*** PK 11/11/13 BEGIN                                             07520200
075203                      IF PS-HAZ-FACILITY-YES                      07520300
075204                         MOVE DK-CHILD-CARTON TO DK-SHIPMENT-ID   07520400
075205                         PERFORM 2263-CHK-IF-HAZMAT               07520500
075206                      END-IF                                      07520600
075207*** PK 11/11/13 END                                               07520700
075208                         PERFORM 3500-ADD-CHILD-TO-MSTR           07520800
075209                         MOVE DK-CHILD-CARTON                     07520900
075210                                         TO PV-SUCRDV-SHIPT-UNT-ID07521000
075220                   END-IF                                         07522000
075230                   PERFORM 3600-INACT-DIVERTER-CTN                07523000
075240           END-EVALUATE                                           07524000
075250     END-EVALUATE.                                                07525000
075260*                                                                 07526000
075270*                                                                 07527000
075280 2110-RECEIVE-SCREEN-FIELDS.                                      07528000
075290     IF  ABRCDEL > ZERO                                           07529000
075300         MOVE ABRCDEI TO PV-CTN                                   07530000
075400     ELSE                                                         07540000
075500         IF ABRCDEA = DP015-ERASE-EOF                             07550000
075600             MOVE SPACES TO PV-CTN                                07560000
075700         END-IF                                                   07570000
075800     END-IF.                                                      07580000
075900                                                                  07590000
076000     IF  APRTRL > ZERO                                            07600000
076100         MOVE APRTRI TO PV-PRINTER-ID                             07610000
076200                        PC033-SML-PRTR-ID                         07620000
076300     ELSE                                                         07630000
076400         IF APRTRA = DP015-ERASE-EOF                              07640000
076500             MOVE SPACES TO PV-PRINTER-ID                         07650000
076600         END-IF                                                   07660000
076700     END-IF.                                                      07670000
076800*                                                                 07680000
076900*                                                                 07690000
077000 2200-CHECK-TABLES.                                               07700000
077100     PERFORM 2250-SELECT-OTBND-CART.                              07710000
077200                                                                  07720000
077300     IF PS-CARTON-EXISTS                                          07730000
077400        MOVE PC033-CARTON       TO DK-CARTON                      07740000
077500        MOVE PC033-CHILD-CARTON TO DK-CHILD-CARTON                07750000
077600     ELSE                                                         07760000
077700        IF PS-CARTON-DOESNT-EXIST                                 07770000
077800           SET PS-INVALID-INPUT TO TRUE                           07780000
077900           MOVE SQLCA             TO PC033-SQLCA                  07790000
078000           SET PC033-INITIALIZE-SCREEN TO TRUE                    07800000
078100           MOVE 21                TO PC033-PGM-MSG-NBR            07810000
078200           PERFORM 8210-XCTL-ERROR-SCREEN                         07820000
078300        END-IF                                                    07830000
078400     END-IF.                                                      07840000
078500*                                                                 07850000
078600*                                                                 07860000
078700 2210-INITIALIZE-ATTRIBUTES.                                      07870000
078800     MOVE DP015-UNP-ALP-NOR-MDT      TO ABRCDEA.                  07880000
078900     MOVE DP015-UNP-ALP-NOR-MDT      TO APRTRA.                   07890000
079000                                                                  07900000
079100     MOVE PV-CTN           TO ABRCDEO.                            07910000
079200     MOVE SPACES           TO AMSGLNO.                            07920000
079300*                                                                 07930000
079400*                                                                 07940000
079500 2230-EDIT-CTN.                                                   07950000
079600     MOVE 0 TO PV-CHAR-COUNT.                                     07960000
079700     INSPECT PV-CTN TALLYING PV-CHAR-COUNT FOR CHARACTERS         07970000
079800                 BEFORE INITIAL SPACE.                            07980000
079900                                                                  07990000
080000     EVALUATE TRUE                                                08000000
080100         WHEN PV-CTN = SPACES OR LOW-VALUES AND                   08010000
080200             EIBAID = DFHENTER                                    08020000
080300             IF PC033-SML-PRTR-ID > SPACES                        08030000
080400                SET PS-VALID-INPUT       TO TRUE                  08040000
080500             ELSE                                                 08050000
080600                SET PS-INVALID-INPUT        TO TRUE               08060000
080700                MOVE DP015-UNP-ALP-BRT-MDT  TO ABRCDEA            08070000
080800                MOVE -1                     TO ABRCDEL            08080000
080900                MOVE PC-PLS-ENT-FLD-MSG     TO AMSGLNO            08090000
081000             END-IF                                               08100000
081100                                                                  08110000
081200         WHEN PV-CTN = SPACES OR LOW-VALUES AND                   08120000
081300             EIBAID = DFHPF5                                      08130000
081400             SET PS-VALID-INPUT          TO TRUE                  08140000
081500                                                                  08150000
081600         WHEN PV-CHAR-COUNT = PC-18 AND                           08160000
081700*** 11/08/07 (PV-CTN-FIRST-DIGIT NOT = PC-4)                      08170000
081800* JAK 09/2009 WR37075 START                                       08180000
081900*            (PV-CTN-FIRST-2-DIGIT NOT = PC-41)                   08190000
082000             (PV-CTN-FIRST-2-DIGIT NOT = PC-41) AND               08200000
082100             (PV-CTN-FIRST-2-DIGIT NOT = PC-42)                   08210000
082200* JAK 09/2009 WR37075 END                                         08220000
082300             SET PS-INVALID-INPUT        TO TRUE                  08230000
082400             MOVE DP015-UNP-ALP-BRT-MDT  TO ABRCDEA               08240000
082500             MOVE -1                     TO ABRCDEL               08250000
082600             MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             08260000
082700                                                                  08270000
082800         WHEN PV-CHAR-COUNT = PC-20 AND                           08280000
082900            ((PV-CTN-FIRST-DIGIT NOT = PC-0) AND                  08290000
083000*** 11/08/07 (PV-CTN-SCAN-THIRD-DGT NOT = PC-4))                  08300000
083100* JAK 09/2009 WR37075 START                                       08310000
083200*            (PV-CTN-SCAN-3RD-4TH-DGT NOT = PC-41))               08320000
083300             (PV-CTN-SCAN-3RD-4TH-DGT NOT = PC-41) AND            08330000
083400             (PV-CTN-SCAN-3RD-4TH-DGT NOT = PC-42))               08340000
083500* JAK 09/2009 WR37075 END                                         08350000
083600             SET PS-INVALID-INPUT        TO TRUE                  08360000
083700             MOVE DP015-UNP-ALP-BRT-MDT  TO ABRCDEA               08370000
083800             MOVE -1                     TO ABRCDEL               08380000
083900             MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             08390000
084000                                                                  08400000
084100         WHEN PV-CHAR-COUNT = PC-20 AND                           08410000
084200            ((PV-CTN-FIRST-DIGIT = PC-0) AND                      08420000
084300*** 11/08/07 (PV-CTN-SCAN-THIRD-DGT NOT = PC-4))                  08430000
084301* JAK 09/2009 WR37075 START                                       08430100
084302*            (PV-CTN-SCAN-3RD-4TH-DGT NOT = PC-41))               08430200
084303             (PV-CTN-SCAN-3RD-4TH-DGT NOT = PC-41) AND            08430300
084304             (PV-CTN-SCAN-3RD-4TH-DGT NOT = PC-42))               08430400
084305* JAK 09/2009 WR37075 END                                         08430500
084306             SET PS-INVALID-INPUT        TO TRUE                  08430600
084307             MOVE DP015-UNP-ALP-BRT-MDT  TO ABRCDEA               08430700
084308             MOVE -1                     TO ABRCDEL               08430800
084309             MOVE PC-MUST-BE-KOHLS-BARCODE TO AMSGLNO             08430900
084310                                                                  08431000
084320         WHEN PV-CHAR-COUNT < PC-18                               08432000
084330             SET PS-INVALID-INPUT        TO TRUE                  08433000
084340             MOVE DP015-UNP-ALP-BRT-MDT  TO ABRCDEA               08434000
084350             MOVE -1                     TO ABRCDEL               08435000
084360             MOVE PC-MORE-DIGITS-REQD    TO AMSGLNO               08436000
084370         WHEN OTHER                                               08437000
084380             SET DP010I-NEGATIVE-NOT-ALLOWED                      08438000
084390                 PS-NOT-SCANNED-DATA TO TRUE                      08439000
084400             IF PV-CHAR-COUNT = PC-18                             08440000
084500                 MOVE PV-CTN-LAST-17  TO DP010I-UNEDITED-FIELD    08450000
084600             ELSE                                                 08460000
084700                 IF PV-CHAR-COUNT < PC-18                         08470000
084800                     MOVE PV-CTN      TO DP010I-UNEDITED-FIELD    08480000
084900                 ELSE                                             08490000
085000                     MOVE PV-CTN-SCAN-LAST-17                     08500000
085100                                      TO DP010I-UNEDITED-FIELD    08510000
085200                     SET PS-SCANNED-DATA TO TRUE                  08520000
085300                 END-IF                                           08530000
085400             END-IF                                               08540000
085500             MOVE 17     TO DP010I-MAXIMUM-DIGITS                 08550000
085600             MOVE 0      TO DP010I-MAXIMUM-DECIMALS               08560000
085700                                                                  08570000
085810             CALL DP010I-NUMERIC-EDIT-ROUTINE                     08581007
085820                         USING DP010I-NUMERIC-EDIT-AREA           08582007
085900             IF  DP010I-ERROR-DETECTED                            08590000
086000                 SET PS-INVALID-INPUT        TO TRUE              08600000
086100                 MOVE DP015-UNP-ALP-BRT-MDT  TO ABRCDEA           08610000
086200                 MOVE -1                     TO ABRCDEL           08620000
086300                 MOVE PC-MUST-BE-NUM-MSG     TO AMSGLNO           08630000
086400             ELSE                                                 08640000
086500                 IF DP010I-NUMERIC-FIELD = ZEROES                 08650000
086600                     SET PS-INVALID-INPUT        TO TRUE          08660000
086700                     MOVE DP015-UNP-ALP-BRT-MDT  TO ABRCDEA       08670000
086800                     MOVE -1                     TO ABRCDEL       08680000
086900                     MOVE PC-MUST-BE-GT-0-MSG    TO AMSGLNO       08690000
087000                 ELSE                                             08700000
087100                      COMPUTE PC033-CHILD-CARTON ROUNDED =        08710000
087200                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         08720000
087300                      COMPUTE PV-CTN-N          ROUNDED =         08730000
087400                        DP010I-NUM-FIELD-17-DIG-0-DEC * 1         08740000
087500                       EVALUATE TRUE                              08750000
087600                          WHEN PV-CHAR-COUNT = PC-20              08760000
087700*** 11/08/07                 IF PV-CTN-SCAN-THIRD-DGT = PC-4      08770000
087800* JAK 09/2009 WR37075 START                                       08780000
087900*                            IF PV-CTN-SCAN-3RD-4TH-DGT = PC-41   08790000
088000                             IF PV-CTN-SCAN-3RD-4TH-DGT = PC-41 OR08800000
088100                                PV-CTN-SCAN-3RD-4TH-DGT = PC-42   08810000
088200* JAK 09/2009 WR37075 END                                         08820000
088300                                MOVE PV-CTN TO DK-BARCODE-NBR     08830000
088400                                MOVE PV-CTN-SCAN-LAST-18 TO       08840000
088500                                               PV-CTN-N           08850000
088600                                               PC033-CHILD-CARTON 08860000
088700                             END-IF                               08870000
088800                          WHEN PV-CHAR-COUNT = PC-18              08880000
088900*** 11/08/07                 IF PV-CTN-FIRST-DIGIT = PC-4         08890000
089000* JAK 09/2009 WR37075 START                                       08900000
089100*                            IF PV-CTN-FIRST-2-DIGIT = PC-41      08910000
089200                             IF PV-CTN-FIRST-2-DIGIT = PC-41 OR   08920000
089300                                PV-CTN-FIRST-2-DIGIT = PC-42      08930000
089400* JAK 09/2009 WR37075 END                                         08940000
089500                                MOVE PV-CTN       TO PV-CTN-N     08950000
089600                                MOVE PV-CTN-N TO                  08960000
089700                                          PC033-CHILD-CARTON      08970000
089800                             END-IF                               08980000
089900                          END-EVALUATE                            08990000
090000                     MOVE PV-CTN-N                TO ABRCDEO      09000000
090100                     PERFORM 2200-CHECK-TABLES                    09010000
090200                 END-IF                                           09020000
090300             END-IF                                               09030000
090400     END-EVALUATE.                                                09040000
090500                                                                  09050000
090600     EVALUATE TRUE                                                09060000
090700        WHEN PV-CHAR-COUNT = PC-18                                09070000
090800           MOVE PV-CTN-N     TO DK-CHILD-CARTON                   09080000
090900                                                                  09090000
091000        WHEN PV-CHAR-COUNT = PC-20                                09100000
091100           MOVE PV-CTN       TO DK-BARCODE-NBR                    09110000
091200        WHEN OTHER                                                09120000
091300           CONTINUE                                               09130000
091400     END-EVALUATE.                                                09140000
091500                                                                  09150000
091600*                                                                 09160000
091700 2235-CALL-ASGMT-SEQ.                                             09170000
091800***************************************************************** 09180000
091900* -- CALL DLKUP001 - SECURE THE REQUIRED NUMBER OF SEQUENCE       09190000
092000*                    NUMBERS.                                     09200000
092100***************************************************************** 09210000
092200                                                                  09220000
092300     SET PS-UPDATE-COMMIT TO TRUE.                                09230000
092400                                                                  09240000
092500*  PREPARE TO CALL DLKUP001                                       09250000
092600      INITIALIZE DL001-ASGMT-COMMAREA.                            09260000
092700                                                                  09270000
092800      MOVE PC033-ASGMT-STRT-DTE   TO                              09280000
092900                                 DL001-KEY-START-DTE.             09290000
093000      MOVE PC033-ASGMT-NBR-TXT    TO                              09300000
093100                                 DL001-KEY-NBR-TXT.               09310000
093200      MOVE PC033-ASGMT-NBR-SEQ-NBR TO                             09320000
093300                                 DL001-KEY-NBR-SEQ-NBR.           09330000
093400      PERFORM 4800-CALL-DLKUP001.                                 09340000
093500                                                                  09350000
093600      IF PS-UPDATE-ROLLBACK                                       09360000
093700        PERFORM 9000-SOFT-ABORT.                                  09370000
093800*                                                                 09380000
093900 2240-VALIDATE-STORE.                                             09390000
094000     MOVE PV-STORE-N TO DK-STORE-NBR                              09400000
094100                                                                  09410000
094200     EXEC SQL                                                     09420000
094300        SELECT LOC_NBR                                            09430000
094400              ,LOC_10_ABBR_NM                                     09440000
094500         INTO   :XLT00010-LOC-NBR                                 09450000
094600               ,:XLT00010-LOC-10-ABBR-NM                          09460000
094700         FROM XLT_LOC                                             09470000
094800        WHERE LOC_NBR = :DK-STORE-NBR                             09480000
094900     END-EXEC                                                     09490000
095000     EVALUATE TRUE                                                09500000
095100         WHEN SQLCODE = ZERO                                      09510000
095200             SET PS-VALID-STORE-NBR   TO TRUE                     09520000
095300             MOVE XLT00010-LOC-NBR    TO PV-STORE-N               09530000
095400             MOVE XLT00010-LOC-10-ABBR-NM                         09540000
095500                                      TO PV-STR-NAME-CHAR10-ABBR  09550000
095600             MOVE -1                  TO APRTRL                   09560000
095700         WHEN SQLCODE = +100                                      09570000
095800             SET PS-INVALID-STORE-NBR TO TRUE                     09580000
095900             SET PS-ERROR-YES         TO TRUE                     09590000
096000         WHEN SQLCODE = -904                                      09600000
096100         WHEN SQLCODE = -913                                      09610000
096200         WHEN SQLCODE = -911                                      09620000
096300             MOVE 1                   TO PV-ERROR-NBR             09630000
096400             PERFORM 9903-WRITE-CICS-LOG                          09640000
096500             PERFORM 9000-SOFT-ABORT                              09650000
096600         WHEN SQLWARN0 NOT = SPACES                               09660000
096700         WHEN SQLCODE NOT EQUAL ZERO                              09670000
096800             MOVE '2240-VALIDATE-STORE'                           09680000
096900                             TO DP013-PARAGRAPH                   09690000
097000             MOVE 'PCKRF865 - VALIDATE STORE NBR'                 09700000
097100                             TO DP013-MESSAGE-TEXT(1)             09710000
097200             MOVE PV-STORE-N                                      09720000
097300                             TO DP013-MESSAGE-TEXT(2)             09730000
097400             MOVE SQLCA      TO DP013-SQLCA                       09740000
097500             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           09750000
097600             SET DP013-DB2-ABEND                                  09760000
097700                             TO TRUE                              09770000
097800             SET DP013-ROLLBACK                                   09780000
097900                             TO TRUE                              09790000
098000             SET DP013-XCTL-DISPLAY-RESTART                       09800000
098100                             TO TRUE                              09810000
098200             PERFORM DP014-0000-PROCESS-ABEND                     09820000
098300     END-EVALUATE.                                                09830000
098400*                                                                 09840000
098500*                                                                 09850000
098600*NOTE:  MERCHANDISE CARTONS - HIER_LVL_CDE=0                      09860000
098700*FIRST CHECK TO SEE IF SHIPT-UNT-ID IS ON SUT_OTBND_CART.         09870000
098800*IF NOT, CHECK TO SEE IF IT IS ON ORIG_SHIPT_UNT_ID               09880000
098900 2250-SELECT-OTBND-CART.                                          09890000
099000     MOVE PV-CTN-N      TO DK-CHILD-CARTON                        09900000
099100                           PC033-CHILD-CARTON                     09910000
099200     EXEC SQL                                                     09920000
099300         SELECT  ORGN_LOC_NBR                                     09930000
099400                ,DEST_LOC_NBR                                     09940000
099500                ,CART_SRC_CDE                                     09950000
099600                ,SHIPT_UNT_ID                                     09960000
099700                ,MSTR_CART_IND                                    09970000
099800                ,PRNT_CART_ID                                     09980000
099900                ,ACTV_IND                                         09990000
100000         INTO    :SUT00024-ORGN-LOC-NBR                           10000000
100100                ,:SUT00024-DEST-LOC-NBR                           10010000
100200                ,:SUT00024-CART-SRC-CDE                           10020000
100300                ,:SUT00024-SHIPT-UNT-ID                           10030000
100400                ,:SUT00024-MSTR-CART-IND                          10040000
100500                ,:SUT00024-PRNT-CART-ID                           10050000
100600                ,:SUT00024-ACTV-IND                               10060000
100700         FROM   SUT_OTBND_CART                                    10070000
100800         WHERE  SHIPT_UNT_ID   = :DK-CHILD-CARTON                 10080000
100900     END-EXEC.                                                    10090000
101000     EVALUATE TRUE                                                10100000
101100         WHEN SQLCODE = ZERO                                      10110000
101200            SET PS-CARTON-EXISTS TO TRUE                          10120000
101300            SET PC033-BARCODE-DOESNT-EXIST TO TRUE                10130000
101400                                                                  10140000
101500            IF SUT00024-ACTV-IND = 'N'                            10150000
101600               MOVE PC-CARTON-INACTIVATED TO AMSGLNO              10160000
101700               MOVE DP015-UNP-ALP-BRT-MDT                         10170000
101800                                       TO ACARTNL                 10180000
101900               MOVE -1                 TO ACARTNL                 10190000
102000               PERFORM 8000-SEND-MAP                              10200000
102100               PERFORM 8100-RETURN-TRANID                         10210000
102200            END-IF                                                10220000
102300                                                                  10230000
102400            EVALUATE TRUE                                         10240000
102500              WHEN SUT00024-MSTR-CART-IND = 'Y'                   10250000
102600                PERFORM 2260-SELECT-OTBND-CART                    10260000
102700            END-EVALUATE                                          10270000
102800                                                                  10280000
102900            EVALUATE TRUE                                         10290000
103000              WHEN SUT00024-MSTR-CART-IND = 'Y'                   10300000
103100                   AND EIBAID = DFHPF5                            10310000
103200                     IF PC033-SML-PRTR-ID > SPACES                10320000
103300                        MOVE PC033-SML-PRTR-ID TO PV-PRINTER-ID   10330000
103400                        PERFORM 3010-VALIDATE-PRINTER             10340000
103500                           MOVE DP072-PRTR-IP-ADDRESS             10350000
103600                                    TO PC140-SML-IP-ADDRESS       10360000
103700                           MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE    10370000
103800                                    TO PC140-SML-OS-RLSE-CDE      10380000
103900                           MOVE DP072-PRTR-DATA-XFER-MODE-ID      10390000
104000                                    TO PC140-SML-XFER-MODE-ID     10400000
104100                           MOVE DP072-XMIT-INTFC-CDE              10410000
104200                                    TO PC140-XMIT-INTFC-CDE       10420000
104300                           MOVE DP072-PRTR-TYP-CDE                10430000
104400                                    TO PC140-SML-PRTR-TYPE        10440000
104500                           MOVE DP072-PRTR-OPER-UNT-ID            10450000
104600                                    TO PC-OPER-UNT-ID             10460000
104700                        IF PS-VALID-PRINTER-ID                    10470000
104800                           MOVE DP015-UNP-ALP-NOR-MDT             10480000
104900                                                   TO APRTRA      10490000
105000                           MOVE -1                 TO APRTRL      10500000
105100*GET UPC # FROM PC033-CARTON                                      10510000
105200                           MOVE PC033-CARTON TO PV-CTN-N          10520000
105300                           MOVE PV-CTN-N TO PV-CTN                10530000
105400                                                                  10540000
105500                           MOVE PV-CTN TO PV-CTN-X                10550000
105600                           MOVE PV-CTN-9-11 TO PV-MANF-9-11       10560000
105700                           MOVE PV-CTN-9-12 TO PV-MANF-9-12       10570000
105800                           MOVE PV-CTN-9-13 TO PV-MANF-9-13       10580000
105900                           MOVE PV-CTN-9-14 TO PV-MANF-9-14       10590000
106000                           MOVE PV-CTN-9-15 TO PV-MANF-9-15       10600000
106100                           MOVE PV-CTN-9-16 TO PV-MANF-9-16       10610000
106200                           MOVE PV-CTN-9-17 TO PV-MANF-9-17       10620000
106300                           MOVE PV-CTN-9-18 TO PV-MANF-9-18       10630000
106400                                                                  10640000
106500                           PERFORM 4500-SETUP-COM-LABEL           10650000
106600                           PERFORM 8010-SEND-DATA-ONLY            10660000
106700                           PERFORM 8100-RETURN-TRANID             10670000
106800                        ELSE                                      10680000
106900                           MOVE DP015-UNP-ALP-BRT-MDT             10690000
107000                                              TO APRTRA           10700000
107100                           MOVE -1            TO APRTRL           10710000
107200                           MOVE PV-PRINTER-ID TO APRTRO           10720000
107300                           MOVE PC-INVALID-PRINTER-ID             10730000
107400                                              TO AMSGLNO          10740000
107500                           PERFORM 8010-SEND-DATA-ONLY            10750000
107600                           PERFORM 8100-RETURN-TRANID             10760000
107700                        END-IF                                    10770000
107800                     END-IF                                       10780000
107900*MESSAGE 13                                                       10790000
108000              WHEN SUT00024-MSTR-CART-IND = 'Y'                   10800000
108100                AND PC033-CARTON NOT = PC033-CHILD-CARTON         10810000
108200                AND SUT00024-SHIPT-UNT-ID =                       10820000
108300                                      SUT00024-PRNT-CART-ID       10830000
108400                SET PS-MASTER-CTN TO TRUE                         10840000
108500                SET PS-INVALID-INPUT     TO TRUE                  10850000
108600                MOVE SQLCA               TO PC033-SQLCA           10860000
108700                SET PC033-INITIALIZE-SCREEN TO TRUE               10870000
108800                MOVE 13                  TO PC033-PGM-MSG-NBR     10880000
108900                PERFORM 8210-XCTL-ERROR-SCREEN                    10890000
109000                                                                  10900000
109100*MESSAGE 19                                                       10910000
109200              WHEN SUT00024-MSTR-CART-IND = 'Y'                   10920000
109300                AND PC033-CARTON NOT = PC033-CHILD-CARTON         10930000
109400                AND SUT00024-SHIPT-UNT-ID NOT =                   10940000
109500                                      SUT00024-PRNT-CART-ID       10950000
109600                AND PC033-CARTON =                                10960000
109700                            SUT00024-PRNT-CART-ID                 10970000
109800                SET PS-MASTER-CTN TO TRUE                         10980000
109900                SET PS-INVALID-INPUT     TO TRUE                  10990000
110000                MOVE SQLCA               TO PC033-SQLCA           11000000
110100                SET PC033-INITIALIZE-SCREEN TO TRUE               11010000
110200                MOVE 19                  TO PC033-PGM-MSG-NBR     11020000
110300                PERFORM 8210-XCTL-ERROR-SCREEN                    11030000
110400                                                                  11040000
110500              WHEN SUT00024-MSTR-CART-IND = 'N'                   11050000
110600                   SET PS-CHILD-CTN TO TRUE                       11060000
110700            END-EVALUATE                                          11070000
110800                                                                  11080000
110900         WHEN SQLCODE = +100                                      11090000
111000              PERFORM  2251-SELECT-OTBND-CART                     11100000
111100         WHEN SQLCODE = -904                                      11110000
111200         WHEN SQLCODE = -913                                      11120000
111300         WHEN SQLCODE = -911                                      11130000
111400             MOVE 2                   TO PV-ERROR-NBR             11140000
111500             PERFORM 9903-WRITE-CICS-LOG                          11150000
111600             PERFORM 9000-SOFT-ABORT                              11160000
111700         WHEN SQLWARN0 NOT = SPACES                               11170000
111800         WHEN SQLCODE NOT EQUAL ZERO                              11180000
111900             MOVE '2250-SELECT-OTBND-CART'                        11190000
112000                             TO DP013-PARAGRAPH                   11200000
112100             MOVE 'PCKRF865 - SELECT SUT_OTBND_CART'              11210000
112200                             TO DP013-MESSAGE-TEXT(1)             11220000
112300             MOVE SUT00024-SHIPT-UNT-ID                           11230000
112400                             TO DP013-MESSAGE-TEXT(2)             11240000
112500             MOVE SQLCA      TO DP013-SQLCA                       11250000
112600             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           11260000
112700             SET DP013-DB2-ABEND                                  11270000
112800                             TO TRUE                              11280000
112900             SET DP013-ROLLBACK                                   11290000
113000                             TO TRUE                              11300000
113100             SET DP013-XCTL-DISPLAY-RESTART                       11310000
113200                             TO TRUE                              11320000
113300             PERFORM DP014-0000-PROCESS-ABEND                     11330000
113400     END-EVALUATE.                                                11340000
113500*                                                                 11350000
113600*                                                                 11360000
113700 2251-SELECT-OTBND-CART.                                          11370000
113800                                                                  11380000
113900     EXEC SQL                                                     11390000
114000         SELECT  ORGN_LOC_NBR                                     11400000
114100                ,DEST_LOC_NBR                                     11410000
114200                ,CART_SRC_CDE                                     11420000
114300                ,SHIPT_UNT_ID                                     11430000
114400                ,MSTR_CART_IND                                    11440000
114500                ,PRNT_CART_ID                                     11450000
114600                ,ORIG_CART_ID                                     11460000
114700                ,ACTV_IND                                         11470000
114800         INTO    :SUT00024-ORGN-LOC-NBR                           11480000
114900                ,:SUT00024-DEST-LOC-NBR                           11490000
115000                ,:SUT00024-CART-SRC-CDE                           11500000
115100                ,:SUT00024-SHIPT-UNT-ID                           11510000
115200                ,:SUT00024-MSTR-CART-IND                          11520000
115300                ,:SUT00024-PRNT-CART-ID                           11530000
115400                ,:SUT00024-ORIG-CART-ID                           11540000
115500                ,:SUT00024-ACTV-IND                               11550000
115600         FROM   SUT_OTBND_CART                                    11560000
115700         WHERE  ORIG_CART_ID   = :DK-CHILD-CARTON                 11570000
115800     END-EXEC.                                                    11580000
115900     EVALUATE TRUE                                                11590000
116000         WHEN SQLCODE = ZERO                                      11600000
116100            SET PS-CARTON-EXISTS TO TRUE                          11610000
116200            SET PC033-BARCODE-DOESNT-EXIST TO TRUE                11620000
116300            MOVE SUT00024-ORIG-CART-ID TO DK-SHIPT-UNT-ID         11630000
116400                                       SUT00024-SHIPT-UNT-ID      11640000
116500                                         PC033-SHIPT-UNT-ID       11650000
116600                                                                  11660000
116700            IF SUT00024-ACTV-IND = 'N'                            11670000
116800               MOVE PC-CARTON-INACTIVATED TO AMSGLNO              11680000
116900               MOVE DP015-UNP-ALP-BRT-MDT                         11690000
117000                                       TO ACARTNL                 11700000
117100               MOVE -1                 TO ACARTNL                 11710000
117200               PERFORM 8000-SEND-MAP                              11720000
117300               PERFORM 8100-RETURN-TRANID                         11730000
117400            END-IF                                                11740000
117500                                                                  11750000
117600            EVALUATE TRUE                                         11760000
117700              WHEN SUT00024-MSTR-CART-IND = 'Y'                   11770000
117800                PERFORM 2260-SELECT-OTBND-CART                    11780000
117900            END-EVALUATE                                          11790000
118000                                                                  11800000
118100            EVALUATE TRUE                                         11810000
118200              WHEN SUT00024-MSTR-CART-IND = 'Y'                   11820000
118300                   AND EIBAID = DFHPF5                            11830000
118400                     IF PC033-SML-PRTR-ID > SPACES                11840000
118500                        MOVE PC033-SML-PRTR-ID TO PV-PRINTER-ID   11850000
118600                        PERFORM 3010-VALIDATE-PRINTER             11860000
118700                           MOVE DP072-PRTR-IP-ADDRESS             11870000
118800                                    TO PC140-SML-IP-ADDRESS       11880000
118900                           MOVE DP072-PRTR-CLUSTER-OS-RLSE-CDE    11890000
119000                                    TO PC140-SML-OS-RLSE-CDE      11900000
119100                           MOVE DP072-PRTR-DATA-XFER-MODE-ID      11910000
119200                                    TO PC140-SML-XFER-MODE-ID     11920000
119300                           MOVE DP072-XMIT-INTFC-CDE              11930000
119400                                    TO PC140-XMIT-INTFC-CDE       11940000
119500                           MOVE DP072-PRTR-TYP-CDE                11950000
119600                                    TO PC140-SML-PRTR-TYPE        11960000
119700                           MOVE DP072-PRTR-OPER-UNT-ID            11970000
119800                                    TO PC-OPER-UNT-ID             11980000
119900                        IF PS-VALID-PRINTER-ID                    11990000
120000                           MOVE DP015-UNP-ALP-NOR-MDT             12000000
120100                                                   TO APRTRA      12010000
120200                           MOVE -1                 TO APRTRL      12020000
120300*GET UPC # FROM PC033-CARTON                                      12030000
120400                           MOVE PC033-CARTON TO PV-CTN-N          12040000
120500                           MOVE PV-CTN-N TO PV-CTN                12050000
120600                                                                  12060000
120700                           MOVE PV-CTN TO PV-CTN-X                12070000
120800                           MOVE PV-CTN-9-11 TO PV-MANF-9-11       12080000
120900                           MOVE PV-CTN-9-12 TO PV-MANF-9-12       12090000
121000                           MOVE PV-CTN-9-13 TO PV-MANF-9-13       12100000
121100                           MOVE PV-CTN-9-14 TO PV-MANF-9-14       12110000
121200                           MOVE PV-CTN-9-15 TO PV-MANF-9-15       12120000
121300                           MOVE PV-CTN-9-16 TO PV-MANF-9-16       12130000
121400                           MOVE PV-CTN-9-17 TO PV-MANF-9-17       12140000
121500                           MOVE PV-CTN-9-18 TO PV-MANF-9-18       12150000
121600                                                                  12160000
121700                           PERFORM 4500-SETUP-COM-LABEL           12170000
121800                           PERFORM 8010-SEND-DATA-ONLY            12180000
121900                           PERFORM 8100-RETURN-TRANID             12190000
122000                        ELSE                                      12200000
122100                           MOVE DP015-UNP-ALP-BRT-MDT             12210000
122200                                              TO APRTRA           12220000
122300                           MOVE -1            TO APRTRL           12230000
122400                           MOVE PV-PRINTER-ID TO APRTRO           12240000
122500                           MOVE PC-INVALID-PRINTER-ID             12250000
122600                                              TO AMSGLNO          12260000
122700                           PERFORM 8010-SEND-DATA-ONLY            12270000
122800                           PERFORM 8100-RETURN-TRANID             12280000
122900                        END-IF                                    12290000
123000                     END-IF                                       12300000
123100*MESSAGE 13                                                       12310000
123200              WHEN SUT00024-MSTR-CART-IND = 'Y'                   12320000
123300                AND PC033-CARTON NOT = PC033-CHILD-CARTON         12330000
123400                AND SUT00024-SHIPT-UNT-ID =                       12340000
123500                                      SUT00024-PRNT-CART-ID       12350000
123600                SET PS-MASTER-CTN TO TRUE                         12360000
123700                SET PS-INVALID-INPUT     TO TRUE                  12370000
123800                MOVE SQLCA               TO PC033-SQLCA           12380000
123900                SET PC033-INITIALIZE-SCREEN TO TRUE               12390000
124000                MOVE 13                  TO PC033-PGM-MSG-NBR     12400000
124100                PERFORM 8210-XCTL-ERROR-SCREEN                    12410000
124200                                                                  12420000
124300*MESSAGE 19                                                       12430000
124400              WHEN SUT00024-MSTR-CART-IND = 'Y'                   12440000
124500                AND PC033-CARTON NOT = PC033-CHILD-CARTON         12450000
124600                AND SUT00024-SHIPT-UNT-ID NOT =                   12460000
124700                                      SUT00024-PRNT-CART-ID       12470000
124800                SET PS-MASTER-CTN TO TRUE                         12480000
124900                SET PS-INVALID-INPUT     TO TRUE                  12490000
125000                MOVE SQLCA               TO PC033-SQLCA           12500000
125100                SET PC033-INITIALIZE-SCREEN TO TRUE               12510000
125200                MOVE 19                  TO PC033-PGM-MSG-NBR     12520000
125300                PERFORM 8210-XCTL-ERROR-SCREEN                    12530000
125400                                                                  12540000
125500              WHEN SUT00024-MSTR-CART-IND = 'N'                   12550000
125600                   SET PS-CHILD-CTN TO TRUE                       12560000
125700            END-EVALUATE                                          12570000
125800                                                                  12580000
125900         WHEN SQLCODE = +100                                      12590000
126000              SET PS-CARTON-DOESNT-EXIST TO TRUE                  12600000
126100              SET PS-INVALID-INPUT       TO TRUE                  12610000
126200         WHEN SQLCODE = -904                                      12620000
126300         WHEN SQLCODE = -913                                      12630000
126400         WHEN SQLCODE = -911                                      12640000
126500             MOVE 2                   TO PV-ERROR-NBR             12650000
126600             PERFORM 9903-WRITE-CICS-LOG                          12660000
126700             PERFORM 9000-SOFT-ABORT                              12670000
126800         WHEN SQLWARN0 NOT = SPACES                               12680000
126900         WHEN SQLCODE NOT EQUAL ZERO                              12690000
127000             MOVE '2251-SELECT-OTBND-CART'                        12700000
127100                             TO DP013-PARAGRAPH                   12710000
127200             MOVE 'PCKRF865 - SELECT SUT_OTBND_CART'              12720000
127300                             TO DP013-MESSAGE-TEXT(1)             12730000
127400             MOVE SUT00024-SHIPT-UNT-ID                           12740000
127500                             TO DP013-MESSAGE-TEXT(2)             12750000
127600             MOVE SQLCA      TO DP013-SQLCA                       12760000
127700             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           12770000
127800             SET DP013-DB2-ABEND                                  12780000
127900                             TO TRUE                              12790000
128000             SET DP013-ROLLBACK                                   12800000
128100                             TO TRUE                              12810000
128200             SET DP013-XCTL-DISPLAY-RESTART                       12820000
128300                             TO TRUE                              12830000
128400             PERFORM DP014-0000-PROCESS-ABEND                     12840000
128500     END-EVALUATE.                                                12850000
128600*                                                                 12860000
128700*CHECK TO MAKE SURE CHILD STORE DEST MATCHES MASTER CONTAINER     12870000
128800*STORE DEST.                                                      12880000
128900 2252-CHK-IF-STORE-MATCH.                                         12890000
129000                                                                  12900000
129100     MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON.                 12910000
129200     EXEC SQL                                                     12920000
129300         SELECT  DEST_LOC_NBR                                     12930000
129400         INTO    :SUT00024-DEST-LOC-NBR                           12940000
129500         FROM   SUT_OTBND_CART                                    12950000
129600         WHERE  SHIPT_UNT_ID   = :DK-CHILD-CARTON                 12960000
129700     END-EXEC.                                                    12970000
129800                                                                  12980000
129900     EVALUATE TRUE                                                12990000
130000         WHEN SQLCODE = ZERO                                      13000000
130100             IF PC033-STR-NBR NOT =                               13010000
130200                          SUT00024-DEST-LOC-NBR                   13020000
130300                SET PS-ERROR-YES         TO TRUE                  13030000
130400                MOVE SQLCA               TO PC033-SQLCA           13040000
130500                SET PC033-INITIALIZE-SCREEN TO TRUE               13050000
130600                MOVE 11                  TO PC033-PGM-MSG-NBR     13060000
130700                PERFORM 8210-XCTL-ERROR-SCREEN                    13070000
130800             END-IF                                               13080000
130900         WHEN SQLCODE = +100                                      13090000
131000             SET PS-ERROR-NO          TO TRUE                     13100000
131100      WHEN SQLCODE = -904                                         13110000
131200      WHEN SQLCODE = -913                                         13120000
131300      WHEN SQLCODE = -911                                         13130000
131400          MOVE 5                   TO PV-ERROR-NBR                13140000
131500          PERFORM 9903-WRITE-CICS-LOG                             13150000
131600          PERFORM 9000-SOFT-ABORT                                 13160000
131700         WHEN SQLWARN0 NOT = SPACES                               13170000
131800         WHEN SQLCODE NOT EQUAL ZERO                              13180000
131900             MOVE '2252-CHK-IF-STORE-MATCH'                       13190000
132000                             TO DP013-PARAGRAPH                   13200000
132100             MOVE 'PCKRF865 - CHECK IF STORE MATCH'               13210000
132200                             TO DP013-MESSAGE-TEXT(1)             13220000
132300             MOVE SUT00024-SHIPT-UNT-ID                           13230000
132400                             TO DP013-MESSAGE-TEXT(2)             13240000
132500             MOVE SQLCA      TO DP013-SQLCA                       13250000
132600             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           13260000
132700             SET DP013-DB2-ABEND                                  13270000
132800                             TO TRUE                              13280000
132900             SET DP013-ROLLBACK                                   13290000
133000                             TO TRUE                              13300000
133100             SET DP013-XCTL-DISPLAY-RESTART                       13310000
133200                             TO TRUE                              13320000
133300             PERFORM DP014-0000-PROCESS-ABEND                     13330000
133400     END-EVALUATE.                                                13340000
133500*                                                                 13350000
133600*                                                                 13360000
133700*GET DEST STORE FOR MASTER CARTON ID                              13370000
133800 2253-GET-DEST-STORE.                                             13380000
133900     MOVE PC033-CARTON  TO DK-CARTON                              13390000
134000     EXEC SQL                                                     13400000
134100         SELECT  ORGN_LOC_NBR                                     13410000
134200                ,DEST_LOC_NBR                                     13420000
134300         INTO    :SUT00024-ORGN-LOC-NBR                           13430000
134400                ,:SUT00024-DEST-LOC-NBR                           13440000
134500         FROM   SUT_OTBND_CART                                    13450000
134600         WHERE  SHIPT_UNT_ID   = :DK-CARTON                       13460000
134700     END-EXEC.                                                    13470000
134800     EVALUATE TRUE                                                13480000
134900         WHEN SQLCODE = ZERO                                      13490000
135000             IF SUT00024-DEST-LOC-NBR = 0                         13500000
135100                   MOVE SUT00024-ORGN-LOC-NBR TO                  13510000
135200                                        SUT00024-DEST-LOC-NBR     13520000
135300                                        PV-STORE-N                13530000
135400                                        PC033-STR-NBR             13540000
135500             ELSE                                                 13550000
135600                   MOVE SUT00024-DEST-LOC-NBR TO PV-STORE-N       13560000
135700                                                 PC033-STR-NBR    13570000
135800             END-IF                                               13580000
135900         WHEN SQLCODE = +100                                      13590000
136000             CONTINUE                                             13600000
136100         WHEN SQLCODE = -904                                      13610000
136200         WHEN SQLCODE = -913                                      13620000
136300         WHEN SQLCODE = -911                                      13630000
136400             MOVE 6                   TO PV-ERROR-NBR             13640000
136500             PERFORM 9903-WRITE-CICS-LOG                          13650000
136600             PERFORM 9000-SOFT-ABORT                              13660000
136700         WHEN SQLWARN0 NOT = SPACES                               13670000
136800         WHEN SQLCODE NOT EQUAL ZERO                              13680000
136900             MOVE '2253-GET-DEST-STORE'                           13690000
137000                             TO DP013-PARAGRAPH                   13700000
137100             MOVE 'PCKRF865 - GET DEST STORE FOR CTN'             13710000
137200                             TO DP013-MESSAGE-TEXT(1)             13720000
137300             MOVE SUT00024-SHIPT-UNT-ID                           13730000
137400                             TO DP013-MESSAGE-TEXT(2)             13740000
137500             MOVE SQLCA      TO DP013-SQLCA                       13750000
137600             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           13760000
137700             SET DP013-DB2-ABEND                                  13770000
137800                             TO TRUE                              13780000
137900             SET DP013-ROLLBACK                                   13790000
138000                             TO TRUE                              13800000
138100             SET DP013-XCTL-DISPLAY-RESTART                       13810000
138200                             TO TRUE                              13820000
138300             PERFORM DP014-0000-PROCESS-ABEND                     13830000
138400     END-EVALUATE.                                                13840000
138500*                                                                 13850000
138600*                                                                 13860000
138700 2254-GET-DC-LOCATION.                                            13870000
138800     EXEC SQL                                                     13880000
138900          SELECT LOC_5_ABBR_NM                                    13890000
139000          INTO  :PV-DC-5-CHAR-ABBR                                13900000
139100          FROM   XLT_LOC                                          13910000
139200          WHERE  LOC_TYP_CDE = 'DC'                               13920000
139300          AND    LOC_NBR   = :PC-OPER-UNT-ID                      13930000
139400     END-EXEC.                                                    13940000
139500                                                                  13950000
139600     EVALUATE TRUE                                                13960000
139700         WHEN SQLCODE = ZERO                                      13970000
139800              MOVE  PV-2-DIGIT-DC-ABBR  TO  PC140-CRA-DC-ID       13980000
139900              MOVE  PC-OPER-UNT-ID      TO  PC140-CRA-OPER-UNT-ID 13990000
140000         WHEN SQLCODE = +100                                      14000000
140100              MOVE  PC-90   TO  PC140-CRA-DC-ID                   14010000
140200                                PC140-CRA-OPER-UNT-ID             14020000
140300         WHEN SQLCODE = -904                                      14030000
140400         WHEN SQLCODE = -913                                      14040000
140500         WHEN SQLCODE = -911                                      14050000
140600             MOVE 7                   TO PV-ERROR-NBR             14060000
140700             PERFORM 9903-WRITE-CICS-LOG                          14070000
140800             PERFORM 9000-SOFT-ABORT                              14080000
140900         WHEN SQLWARN0 NOT = SPACES                               14090000
141000         WHEN SQLCODE NOT EQUAL ZERO                              14100000
141100             MOVE '2254-GET-DC-LOCATION'                          14110000
141200                             TO DP013-PARAGRAPH                   14120000
141300             MOVE 'PCKRF865 - GET DC LOCATION'                    14130000
141400                             TO DP013-MESSAGE-TEXT(1)             14140000
141500             MOVE SQLCA      TO DP013-SQLCA                       14150000
141600             MOVE 'XLT_LOC'  TO DP013-DB2-TABLE-NAME(1)           14160000
141700             SET DP013-DB2-ABEND                                  14170000
141800                             TO TRUE                              14180000
141900             SET DP013-ROLLBACK                                   14190000
142000                             TO TRUE                              14200000
142100             SET DP013-XCTL-DISPLAY-RESTART                       14210000
142200                             TO TRUE                              14220000
142300             PERFORM DP014-0000-PROCESS-ABEND                     14230000
142400     END-EVALUATE.                                                14240000
142500*                                                                 14250000
142600*                                                                 14260000
142700 2256-CHK-IF-SAME-MASTER.                                         14270000
142800     EXEC SQL                                                     14280000
142900        SELECT SHIPT_UNT_ID                                       14290000
143000          INTO :SUT00024-SHIPT-UNT-ID                             14300000
143100          FROM SUT_OTBND_CART                                     14310000
143200         WHERE SHIPT_UNT_ID = :DK-CARTON                          14320000
143300           AND SHIPT_UNT_ID = PRNT_CART_ID                        14330000
143400           AND MSTR_CART_IND = 'Y'                                14340000
143500     END-EXEC.                                                    14350000
143600     EVALUATE TRUE                                                14360000
143700         WHEN SQLCODE = ZERO                                      14370000
143800             SET PS-ERROR-YES         TO TRUE                     14380000
143900             MOVE SQLCA               TO PC033-SQLCA              14390000
144000             SET PC033-INITIALIZE-SCREEN TO TRUE                  14400000
144100             MOVE 15                  TO PC033-PGM-MSG-NBR        14410000
144200             PERFORM 8210-XCTL-ERROR-SCREEN                       14420000
144300         WHEN SQLCODE = +100                                      14430000
144400             SET PS-ERROR-NO          TO TRUE                     14440000
144500         WHEN SQLCODE = -904                                      14450000
144600         WHEN SQLCODE = -913                                      14460000
144700         WHEN SQLCODE = -911                                      14470000
144800             MOVE 8                   TO PV-ERROR-NBR             14480000
144900             PERFORM 9903-WRITE-CICS-LOG                          14490000
145000             PERFORM 9000-SOFT-ABORT                              14500000
145100         WHEN SQLWARN0 NOT = SPACES                               14510000
145200         WHEN SQLCODE NOT EQUAL ZERO                              14520000
145300             MOVE '2256-CHK-IF-SAME-MASTER'                       14530000
145400                             TO DP013-PARAGRAPH                   14540000
145500             MOVE 'PCKRF865 - CHECK IF SAME MASTER'               14550000
145600                             TO DP013-MESSAGE-TEXT(1)             14560000
145700             MOVE SUT00024-SHIPT-UNT-ID                           14570000
145800                             TO DP013-MESSAGE-TEXT(2)             14580000
145900             MOVE SQLCA      TO DP013-SQLCA                       14590000
146000             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           14600000
146100             SET DP013-DB2-ABEND                                  14610000
146200                             TO TRUE                              14620000
146300             SET DP013-ROLLBACK                                   14630000
146400                             TO TRUE                              14640000
146500             SET DP013-XCTL-DISPLAY-RESTART                       14650000
146600                             TO TRUE                              14660000
146700             PERFORM DP014-0000-PROCESS-ABEND                     14670000
146800     END-EVALUATE.                                                14680000
146900*                                                                 14690000
147000*                                                                 14700000
147100 2257-CHK-IF-ASSIGNED-TO-MSTR.                                    14710000
147200     IF PC033-BARCODE-EXISTS                                      14720000
147300        MOVE PC033-SHIPT-UNT-ID  TO DK-CHILD-CARTON               14730000
147400     ELSE                                                         14740000
147500        MOVE PC033-CHILD-CARTON  TO DK-CHILD-CARTON               14750000
147600     END-IF                                                       14760000
147700                                                                  14770000
147800     EXEC SQL                                                     14780000
147900        SELECT SHIPT_UNT_ID                                       14790000
148000              ,PRNT_CART_ID                                       14800000
148100              ,MSTR_CART_IND                                      14810000
148200          INTO :SUT00024-SHIPT-UNT-ID                             14820000
148300              ,:SUT00024-PRNT-CART-ID                             14830000
148400              ,:SUT00024-MSTR-CART-IND                            14840000
148500         FROM  SUT_OTBND_CART                                     14850000
148600        WHERE SHIPT_UNT_ID = :DK-CHILD-CARTON                     14860000
148700     END-EXEC.                                                    14870000
148800     EVALUATE TRUE                                                14880000
148900         WHEN SQLCODE = ZERO                                      14890000
149000             IF PC033-CARTON = SUT00024-PRNT-CART-ID              14900000
149100                AND SUT00024-MSTR-CART-IND = 'N'                  14910000
149200                SET PS-ERROR-YES         TO TRUE                  14920000
149300                MOVE SQLCA               TO PC033-SQLCA           14930000
149400                SET PC033-INITIALIZE-SCREEN TO TRUE               14940000
149500                MOVE 10                  TO PC033-PGM-MSG-NBR     14950000
149600                PERFORM 8210-XCTL-ERROR-SCREEN                    14960000
149700             END-IF                                               14970000
149800         WHEN SQLCODE = +100                                      14980000
149900             SET PS-ERROR-NO          TO TRUE                     14990000
150000         WHEN SQLCODE = -904                                      15000000
150100         WHEN SQLCODE = -913                                      15010000
150200         WHEN SQLCODE = -911                                      15020000
150300             MOVE 9                   TO PV-ERROR-NBR             15030000
150400             PERFORM 9903-WRITE-CICS-LOG                          15040000
150500             PERFORM 9000-SOFT-ABORT                              15050000
150600         WHEN SQLWARN0 NOT = SPACES                               15060000
150700         WHEN SQLCODE NOT EQUAL ZERO                              15070000
150800             MOVE '2257-CHK-IF-ASSIGNED-TO-MSTR'                  15080000
150900                             TO DP013-PARAGRAPH                   15090000
151000             MOVE 'PCKRF865 - CHK IF ASSIGNED TO MSTR'            15100000
151100                             TO DP013-MESSAGE-TEXT(1)             15110000
151200             MOVE SUT00024-SHIPT-UNT-ID                           15120000
151300                             TO DP013-MESSAGE-TEXT(2)             15130000
151400             MOVE SQLCA      TO DP013-SQLCA                       15140000
151500             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           15150000
151600             SET DP013-DB2-ABEND                                  15160000
151700                             TO TRUE                              15170000
151800             SET DP013-ROLLBACK                                   15180000
151900                             TO TRUE                              15190000
152000             SET DP013-XCTL-DISPLAY-RESTART                       15200000
152100                             TO TRUE                              15210000
152200             PERFORM DP014-0000-PROCESS-ABEND                     15220000
152300     END-EVALUATE.                                                15230000
152400*                                                                 15240000
152500*                                                                 15250000
152600 2258-CHK-IF-ASGN-TO-DIFF-MSTR.                                   15260000
152700     EXEC SQL                                                     15270000
152800        SELECT SHIPT_UNT_ID                                       15280000
152900              ,PRNT_CART_ID                                       15290000
153000              ,MSTR_CART_IND                                      15300000
153100          INTO :SUT00024-SHIPT-UNT-ID                             15310000
153200              ,:SUT00024-PRNT-CART-ID                             15320000
153300              ,:SUT00024-MSTR-CART-IND                            15330000
153400         FROM  SUT_OTBND_CART                                     15340000
153500        WHERE SHIPT_UNT_ID = :DK-CHILD-CARTON                     15350000
153600     END-EXEC.                                                    15360000
153700     EVALUATE TRUE                                                15370000
153800         WHEN SQLCODE = ZERO                                      15380000
153801** RPK 7/29/21 - START                                            15380102
153802            IF SUT00024-SHIPT-UNT-ID                              15380201
153803                                 NOT = SUT00024-PRNT-CART-ID      15380301
153804               AND PC033-CARTON  NOT = SUT00024-PRNT-CART-ID      15380401
153810               IF SUT00024-MSTR-CART-IND = 'Y'                    15381001
153811                  SET PS-ERROR-YES         TO TRUE                15381101
153812                  MOVE SQLCA               TO PC033-SQLCA         15381201
153813                  SET PC033-INITIALIZE-SCREEN TO TRUE             15381301
153814                  MOVE 34                  TO PC033-PGM-MSG-NBR   15381401
153815                  MOVE SUT00024-PRNT-CART-ID TO PC033-CARTON      15381501
153816                  PERFORM 8210-XCTL-ERROR-SCREEN                  15381601
153820               ELSE                                               15382001
154200                  SET PS-ERROR-YES         TO TRUE                15420001
154300                  MOVE SQLCA               TO PC033-SQLCA         15430001
154400                  SET PC033-INITIALIZE-SCREEN TO TRUE             15440001
154500                  MOVE 12                  TO PC033-PGM-MSG-NBR   15450001
154600                  MOVE SUT00024-PRNT-CART-ID TO PC033-CARTON      15460001
154700                  PERFORM 8210-XCTL-ERROR-SCREEN                  15470001
154800               END-IF                                             15480001
154810            END-IF                                                15481001
154820** RPK 7/29/21 - END                                              15482006
154900         WHEN SQLCODE = +100                                      15490000
155000             SET PS-ERROR-NO          TO TRUE                     15500000
155100         WHEN SQLCODE = -904                                      15510000
155200         WHEN SQLCODE = -913                                      15520000
155300         WHEN SQLCODE = -911                                      15530000
155400             MOVE 10                  TO PV-ERROR-NBR             15540000
155500             PERFORM 9903-WRITE-CICS-LOG                          15550000
155600             PERFORM 9000-SOFT-ABORT                              15560000
155700         WHEN SQLWARN0 NOT = SPACES                               15570000
155800         WHEN SQLCODE NOT EQUAL ZERO                              15580000
155900             MOVE '2258-CHK-IF-ASGN-TO-DIFF-MSTR'                 15590000
156000                             TO DP013-PARAGRAPH                   15600000
156100             MOVE 'PCKRF865 - CHK IF ASGN TO DIFF MSTR'           15610000
156200                             TO DP013-MESSAGE-TEXT(1)             15620000
156300             MOVE SUT00024-SHIPT-UNT-ID                           15630000
156400                             TO DP013-MESSAGE-TEXT(2)             15640000
156500             MOVE SQLCA      TO DP013-SQLCA                       15650000
156600             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           15660000
156700             SET DP013-DB2-ABEND                                  15670000
156800                             TO TRUE                              15680000
156900             SET DP013-ROLLBACK                                   15690000
157000                             TO TRUE                              15700000
157100             SET DP013-XCTL-DISPLAY-RESTART                       15710000
157200                             TO TRUE                              15720000
157300             PERFORM DP014-0000-PROCESS-ABEND                     15730000
157400     END-EVALUATE.                                                15740000
157500*                                                                 15750000
157600*                                                                 15760000
157700 2259-SELECT-OTBND-CART.                                          15770000
157800                                                                  15780000
157900     EXEC SQL                                                     15790000
158000         SELECT  ORGN_LOC_NBR                                     15800000
158100                ,DEST_LOC_NBR                                     15810000
158200                ,CART_SRC_CDE                                     15820000
158300                ,SHIPT_UNT_ID                                     15830000
158400                ,MSTR_CART_IND                                    15840000
158500                ,PRNT_CART_ID                                     15850000
158600         INTO    :SUT00024-ORGN-LOC-NBR                           15860000
158700                ,:SUT00024-DEST-LOC-NBR                           15870000
158800                ,:SUT00024-CART-SRC-CDE                           15880000
158900                ,:SUT00024-SHIPT-UNT-ID                           15890000
159000                ,:SUT00024-MSTR-CART-IND                          15900000
159100                ,:SUT00024-PRNT-CART-ID                           15910000
159200         FROM   SUT_OTBND_CART                                    15920000
159300         WHERE  SHIPT_UNT_ID   = :DK-CARTON                       15930000
159400     END-EXEC.                                                    15940000
159500     EVALUATE TRUE                                                15950000
159600         WHEN SQLCODE = ZERO                                      15960000
159700              CONTINUE                                            15970000
159800         WHEN SQLCODE = +100                                      15980000
159900              PERFORM 2251-SELECT-OTBND-CART                      15990000
160000         WHEN SQLCODE = -904                                      16000000
160100         WHEN SQLCODE = -913                                      16010000
160200         WHEN SQLCODE = -911                                      16020000
160300             MOVE 11                  TO PV-ERROR-NBR             16030000
160400             PERFORM 9903-WRITE-CICS-LOG                          16040000
160500             PERFORM 9000-SOFT-ABORT                              16050000
160600         WHEN SQLWARN0 NOT = SPACES                               16060000
160700         WHEN SQLCODE NOT EQUAL ZERO                              16070000
160800             MOVE '2259-SELECT-OTBND-CART'                        16080000
160900                             TO DP013-PARAGRAPH                   16090000
161000             MOVE 'PCKRF865 - SELECT SUT_OTBND_CART'              16100000
161100                             TO DP013-MESSAGE-TEXT(1)             16110000
161200             MOVE SUT00024-SHIPT-UNT-ID                           16120000
161210                             TO DP013-MESSAGE-TEXT(2)             16121000
161220             MOVE SQLCA      TO DP013-SQLCA                       16122000
161230             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           16123000
161231             SET DP013-DB2-ABEND                                  16123100
161232                             TO TRUE                              16123200
161233             SET DP013-ROLLBACK                                   16123300
161234                             TO TRUE                              16123400
161235             SET DP013-XCTL-DISPLAY-RESTART                       16123500
161236                             TO TRUE                              16123600
161237             PERFORM DP014-0000-PROCESS-ABEND                     16123700
161238     END-EVALUATE.                                                16123800
161239*                                                                 16123900
161240*                                                                 16124000
161241 2260-SELECT-OTBND-CART.                                          16124100
161242     MOVE PC033-CARTON  TO DK-MASTER-CARTON                       16124200
161243     EXEC SQL                                                     16124300
161244         SELECT  ORGN_LOC_NBR                                     16124400
161245                ,DEST_LOC_NBR                                     16124500
161246                ,CART_SRC_CDE                                     16124600
161247                ,SHIPT_UNT_ID                                     16124700
161248                ,MSTR_CART_IND                                    16124800
161249                ,PRNT_CART_ID                                     16124900
161250         INTO    :PV-ORGN-OPER-UNT-ID                             16125000
161251                ,:PV-DEST-OPER-UNT-ID                             16125100
161252                ,:PV-CART-SRC-CDE                                 16125200
161253                ,:PV-SHIPT-UNT-ID                                 16125300
161254                ,:PV-MSTR-CART-IND                                16125400
161255                ,:PV-PRNT-CART-ID                                 16125500
161256         FROM   SUT_OTBND_CART                                    16125600
161257         WHERE  SHIPT_UNT_ID   = :DK-MASTER-CARTON                16125700
161258     END-EXEC.                                                    16125800
161259     EVALUATE TRUE                                                16125900
161260         WHEN SQLCODE = ZERO                                      16126000
161261            EVALUATE TRUE                                         16126100
161262*MESSAGE 26                                                       16126200
161263              WHEN PC033-CARTON NOT = PV-PRNT-CART-ID             16126300
161264                AND PV-PRNT-CART-ID = PC033-CHILD-CARTON          16126400
161265                SET PS-INVALID-INPUT     TO TRUE                  16126500
161266                MOVE SQLCA               TO PC033-SQLCA           16126600
161267                SET PC033-INITIALIZE-SCREEN TO TRUE               16126700
161268                MOVE 26         TO PC033-PGM-MSG-NBR              16126800
161269                PERFORM 8210-XCTL-ERROR-SCREEN                    16126900
161270              WHEN OTHER                                          16127000
161271                CONTINUE                                          16127100
161272            END-EVALUATE                                          16127200
161273                                                                  16127300
161274         WHEN SQLCODE = +100                                      16127400
161275              CONTINUE                                            16127500
161276         WHEN SQLCODE = -904                                      16127600
161277         WHEN SQLCODE = -913                                      16127700
161278         WHEN SQLCODE = -911                                      16127800
161279             MOVE 12                  TO PV-ERROR-NBR             16127900
161280             PERFORM 9903-WRITE-CICS-LOG                          16128000
161281             PERFORM 9000-SOFT-ABORT                              16128100
161282         WHEN SQLWARN0 NOT = SPACES                               16128200
161283         WHEN SQLCODE NOT EQUAL ZERO                              16128300
161284             MOVE '2260-SELECT-OTBND-CART'                        16128400
161285                             TO DP013-PARAGRAPH                   16128500
161286             MOVE 'PCKRF865 - SELECT SUT_OTBND_CART'              16128600
161287                             TO DP013-MESSAGE-TEXT(1)             16128700
161288             MOVE PV-SHIPT-UNT-ID                                 16128800
161289                             TO DP013-MESSAGE-TEXT(2)             16128900
161290             MOVE SQLCA      TO DP013-SQLCA                       16129000
161291             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           16129100
161292             SET DP013-DB2-ABEND                                  16129200
161293                             TO TRUE                              16129300
161294             SET DP013-ROLLBACK                                   16129400
161295                             TO TRUE                              16129500
161296             SET DP013-XCTL-DISPLAY-RESTART                       16129600
161297                             TO TRUE                              16129700
161298             PERFORM DP014-0000-PROCESS-ABEND                     16129800
161299     END-EVALUATE.                                                16129900
161300*                                                                 16130000
161301*                                                                 16130100
161302*COUNTS ONLY CHILD CARTONS IN MASTER                              16130200
161303 2261-GET-CTNS-IN-MASTER.                                         16130300
161304     EXEC SQL                                                     16130400
161305         SELECT COUNT(*)                                          16130500
161306         INTO   :PV-CARTONS-IN-MASTER                             16130600
161307         FROM   SUT_OTBND_CART A                                  16130700
161308               ,SUT_OTBND_CART B                                  16130800
161309         WHERE  A.PRNT_CART_ID = :DK-CARTON                       16130900
161310           AND  B.PRNT_CART_ID = A.SHIPT_UNT_ID                   16131000
161311           AND  B.MSTR_CART_IND = 'N'                             16131100
161312     END-EXEC.                                                    16131200
161313                                                                  16131300
161314     EVALUATE TRUE                                                16131400
161315         WHEN SQLCODE = ZERO                                      16131500
161316             CONTINUE                                             16131600
161317         WHEN SQLCODE = -904                                      16131700
161318         WHEN SQLCODE = -913                                      16131800
161319         WHEN SQLCODE = -911                                      16131900
161320             MOVE 13                  TO PV-ERROR-NBR             16132000
161321             PERFORM 9903-WRITE-CICS-LOG                          16132100
161322             PERFORM 9000-SOFT-ABORT                              16132200
161323         WHEN SQLWARN0 NOT = SPACES                               16132300
161324         WHEN SQLCODE NOT EQUAL ZERO                              16132400
161325             MOVE '2261-GET-CTNS-IN-MASTER'                       16132500
161326                             TO DP013-PARAGRAPH                   16132600
161327             MOVE 'PCKRF865 - GET CTNS IN MASTER'                 16132700
161328                             TO DP013-MESSAGE-TEXT(1)             16132800
161329             MOVE SUT00024-SHIPT-UNT-ID                           16132900
161330                             TO DP013-MESSAGE-TEXT(2)             16133000
161331             MOVE SQLCA      TO DP013-SQLCA                       16133100
161332             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           16133200
161333             SET DP013-DB2-ABEND                                  16133300
161334                             TO TRUE                              16133400
161335             SET DP013-ROLLBACK                                   16133500
161336                             TO TRUE                              16133600
161337             SET DP013-XCTL-DISPLAY-RESTART                       16133700
161338                             TO TRUE                              16133800
161339             PERFORM DP014-0000-PROCESS-ABEND                     16133900
161340     END-EVALUATE.                                                16134000
161341*                                                                 16134100
161342*                                                                 16134200
161343 2262-COUNT-CHILDREN-OF-MASTER.                                   16134300
161344     EXEC SQL                                                     16134400
161345         SELECT COUNT(*)                                          16134500
161346         INTO   :PV-CHILDRN-IN-MASTER                             16134600
161347         FROM   SUT_OTBND_CART                                    16134700
161348         WHERE  PRNT_CART_ID = :DK-CARTON                         16134800
161349           AND  MSTR_CART_IND = 'N'                               16134900
161350     END-EXEC.                                                    16135000
161351                                                                  16135100
161352     EVALUATE TRUE                                                16135200
161353         WHEN SQLCODE = ZERO                                      16135300
161354             CONTINUE                                             16135400
161355         WHEN SQLCODE = -904                                      16135500
161356         WHEN SQLCODE = -913                                      16135600
161357         WHEN SQLCODE = -911                                      16135700
161358             MOVE 14                  TO PV-ERROR-NBR             16135800
161359             PERFORM 9903-WRITE-CICS-LOG                          16135900
161360             PERFORM 9000-SOFT-ABORT                              16136000
161361         WHEN SQLWARN0 NOT = SPACES                               16136100
161362         WHEN SQLCODE NOT EQUAL ZERO                              16136200
161363             MOVE '2262-COUNT-CHILDREN-OF-MASTER'                 16136300
161364                             TO DP013-PARAGRAPH                   16136400
161365             MOVE 'PCKRF865 - COUNT CHILDREN OF MASTER'           16136500
161366                             TO DP013-MESSAGE-TEXT(1)             16136600
161367             MOVE SUT00024-SHIPT-UNT-ID                           16136700
161368                             TO DP013-MESSAGE-TEXT(2)             16136800
161369             MOVE SQLCA      TO DP013-SQLCA                       16136900
161370             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           16137000
161371             SET DP013-DB2-ABEND                                  16137100
161372                             TO TRUE                              16137200
161373             SET DP013-ROLLBACK                                   16137300
161374                             TO TRUE                              16137400
161375             SET DP013-XCTL-DISPLAY-RESTART                       16137500
161376                             TO TRUE                              16137600
161377             PERFORM DP014-0000-PROCESS-ABEND                     16137700
161378     END-EVALUATE.                                                16137800
161379*                                                                 16137900
161380*                                                                 16138000
161390*** PK 11/11/13 BEGIN                                             16139000
161400** CHECKS WHETHER THE ITEM IS HAZMAT            **                16140000
161500 2263-CHK-IF-HAZMAT.                                              16150000
161600                                                                  16160000
161700     EXEC SQL                                                     16170000
161800          SELECT                                                  16180000
161900             MAX(F.SYS_TRLG_CDE)                                  16190000
162000           , MAX(E.ATTR_ELEM_TXT)                                 16200000
162100          INTO                                                    16210000
162200             :PV-SYS-TRAIL-CODE :PV-SYS-TRAIL-NLIND               16220000
162300           , :PV-LABEL-DESGNTN  :PV-LABEL-DESG-NLIND              16230000
162400          FROM                                                    16240000
162500             WST_INTGRTN_TYP    A                                 16250000
162600           , WST_ATTR_DEFN      B                                 16260000
162700           , WST_ATTR_ELEM      C                                 16270000
162800           , WST_ATTR_ELEM      D                                 16280000
162900           , WST_ATTR_ELEM      E                                 16290000
163000           , XLT_HAZDS_MTRL_SKU F                                 16300000
163100           , XLT_UPC            G                                 16310000
163200           , XLT_SKU            H                                 16320000
163300           , SUT_OTBND_UPC      I                                 16330000
163400          WHERE                                                   16340000
163500               A.INTGRTN_TYP_CDE     = :DK-INTGRTN-HAZ-CDE        16350000
163600           AND A.INTGRTN_TYP_CDE     = B.INTGRTN_TYP_CDE          16360000
163700           AND B.ATTR_DEFN_SEQ_NBR   = 1                          16370000
163800           AND B.INTGRTN_TYP_CDE     = C.INTGRTN_TYP_CDE          16380000
163900           AND C.ATTR_DEFN_SEQ_NBR   = 1                          16390000
164000           AND B.INTGRTN_TYP_CDE     = D.INTGRTN_TYP_CDE          16400000
164100           AND D.ATTR_DEFN_SEQ_NBR   = 2                          16410000
164200           AND B.INTGRTN_TYP_CDE     = E.INTGRTN_TYP_CDE          16420000
164300           AND E.ATTR_DEFN_SEQ_NBR   = 3                          16430000
164400           AND C.ATTR_ELEM_SEQ_NBR   = D.ATTR_ELEM_SEQ_NBR        16440000
164500           AND C.ATTR_ELEM_SEQ_NBR   = E.ATTR_ELEM_SEQ_NBR        16450000
164600           AND C.ATTR_ELEM_TXT       = F.SYS_TRLG_CDE             16460000
164700           AND D.ATTR_ELEM_TXT       = :DK-APPL-NAME              16470000
164800           AND F.HAZDS_IND           = :DK-HAZDS-IND              16480000
164900           AND G.UPC_NBR             = I.UPC_NBR                  16490000
165000           AND G.INTR_UPC_ID         = H.INTR_UPC_ID              16500000
165100           AND F.SKU_NBR             = H.SKU_NBR                  16510000
165200           AND I.SHIPT_UNT_ID        = :DK-SHIPMENT-ID            16520000
165300     END-EXEC.                                                    16530000
165400                                                                  16540000
165500     EVALUATE TRUE                                                16550000
165600         WHEN SQLCODE = ZERO                                      16560000
165700          IF PV-SYS-TRAIL-NLIND NOT EQUAL -1 AND                  16570000
165800             PV-LABEL-DESG-NLIND NOT EQUAL TO -1                  16580000
165900           IF PV-SYS-TRAIL-CODE   NOT = SPACES AND                16590000
166000              PV-LABEL-DESGNTN    NOT = SPACES                    16600000
166100                STRING 'LABEL DESG :- ' PV-LABEL-DESGNTN          16610000
166200                DELIMITED BY SIZE INTO PC033-MESSAGE-TEXT(1)      16620000
166300                MOVE SQLCA               TO PC033-SQLCA           16630000
166400                SET PC033-INITIALIZE-SCREEN TO TRUE               16640000
166500                MOVE 33                  TO PC033-PGM-MSG-NBR     16650000
166600                PERFORM 8210-XCTL-ERROR-SCREEN                    16660000
166700           ELSE                                                   16670000
166800           IF PV-SYS-TRAIL-CODE   NOT = SPACES AND                16680000
166900              PV-LABEL-DESGNTN        = SPACES                    16690000
167000                MOVE '    NO LABEL DESG' TO PC033-MESSAGE-TEXT(1) 16700000
167100                MOVE SQLCA               TO PC033-SQLCA           16710000
167200                SET PC033-INITIALIZE-SCREEN TO TRUE               16720000
167300                MOVE 33                  TO PC033-PGM-MSG-NBR     16730000
167400                PERFORM 8210-XCTL-ERROR-SCREEN                    16740000
167500           END-IF                                                 16750000
167600           END-IF                                                 16760000
167700          END-IF                                                  16770000
167800         WHEN SQLCODE = +100                                      16780000
167900             CONTINUE                                             16790000
168000         WHEN SQLCODE = -904                                      16800000
168100         WHEN SQLCODE = -913                                      16810000
168200         WHEN SQLCODE = -911                                      16820000
168300          MOVE  22                 TO PV-ERROR-NBR                16830000
168400          PERFORM 9903-WRITE-CICS-LOG                             16840000
168500          PERFORM 9000-SOFT-ABORT                                 16850000
168600         WHEN SQLWARN0 NOT = SPACES                               16860000
168700         WHEN SQLCODE NOT EQUAL ZERO                              16870000
168800             MOVE '2263-CHK-IF-HAZMAT'                            16880000
168900                             TO DP013-PARAGRAPH                   16890000
169000             MOVE 'PCKRF865 - CHECK IF HAZMAT'                    16900000
169100                             TO DP013-MESSAGE-TEXT(1)             16910000
169200             MOVE SUT00024-SHIPT-UNT-ID                           16920000
169300                             TO DP013-MESSAGE-TEXT(2)             16930000
169400             MOVE SQLCA      TO DP013-SQLCA                       16940000
169500             MOVE 'WST_INTGRTN_TYP' TO DP013-DB2-TABLE-NAME (1)   16950000
169600             MOVE 'WST_ATTR_DEFN'   TO DP013-DB2-TABLE-NAME (2)   16960000
169700             MOVE 'WST_ATTR_ELEM'   TO DP013-DB2-TABLE-NAME (3)   16970000
169800             MOVE 'XLT_HAZDS_MTRL_SKU'                            16980000
169900                                    TO DP013-DB2-TABLE-NAME (4)   16990000
170000             MOVE 'XLT_SKU'         TO DP013-DB2-TABLE-NAME (5)   17000000
170100             SET DP013-DB2-ABEND                                  17010000
170200                             TO TRUE                              17020000
170300             SET DP013-ROLLBACK                                   17030000
170400                             TO TRUE                              17040000
170500             SET DP013-XCTL-DISPLAY-RESTART                       17050000
170600                             TO TRUE                              17060000
170700             PERFORM DP014-0000-PROCESS-ABEND                     17070000
170800     END-EVALUATE.                                                17080000
170900*** PK 11/11/13 END                                               17090000
171000*                                                                 17100000
171001*                                                                 17100100
171002*LMM                                                              17100200
171003*-----------------------------------------------------------------17100300
171004* DETERMINE LAST ACTIVITY FOR CARTON (CHECK IN REVERSE ORDER)     17100400
171005*-----------------------------------------------------------------17100500
171006 3000-DETERMINE-LAST-ACTIVITY.                                    17100600
171007                                                                  17100700
171008     INITIALIZE  PC046-COMMAREA-REC.                              17100800
171009     SET   PC046-FROM-CRTN-STAT  TO  TRUE.                        17100900
171010     MOVE  SUT00024-SHIPT-UNT-ID TO  PC046-CARTON-ID.             17101000
171011                                                                  17101100
171012                                                                  17101200
171013     CALL PC046-CARTON-STATUS-MODULE                              17101300
171014             USING DFHEIBLK                                       17101400
171015             PC046-COMMAREA                                       17101500
171016             PC046-COMMAREA-REC                                   17101600
171017     END-CALL                                                     17101700
171018                                                                  17101800
171019     PERFORM 3005-VALIDATE-STATUS-CALL.                           17101900
171020                                                                  17102000
171021*----------------------------------------------------------------*17102100
171022* CHECK RETURN CODE FROM CRTN STATUS PROGRAM TO SEE IF SUCCESSFUL*17102200
171023*----------------------------------------------------------------*17102300
171024 3005-VALIDATE-STATUS-CALL.                                       17102400
171025                                                                  17102500
171026     IF  PC046-ERROR                                              17102600
171027         SET  PS-ERROR-YES           TO  TRUE                     17102700
171028         MOVE PC-CICS-ABEND-MSG      TO  AMSGLNO                  17102800
171029                                                                  17102900
171030     ELSE                                                         17103000
171031     IF  PC046-INVALID-SQL                                        17103100
171032         SET  PS-ERROR-YES           TO  TRUE                     17103200
171033         MOVE PC-DATABASE-ERROR      TO  AMSGLNO                  17103300
171034         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       17103400
171035                                                                  17103500
171036     ELSE                                                         17103600
171037     IF  PC046-DATABASE-BUSY                                      17103700
171038         SET  PS-ERROR-YES           TO  TRUE                     17103800
171039         MOVE PC-DATABASE-BUSY       TO  AMSGLNO                  17103900
171040         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       17104000
171041                                                                  17104100
171042     ELSE                                                         17104200
171043     IF  PC046-CRTN-STAT-ERROR                                    17104300
171044         SET  PS-ERROR-YES           TO  TRUE                     17104400
171045         MOVE PC-CARTON-STATUS-ERROR TO  AMSGLNO                  17104500
171046                                                                  17104600
171047     ELSE                                                         17104700
171048     IF  PC046-SUCCESSFUL                                         17104800
171049         MOVE  PC046-OTBD-TRIP-ID    TO  PC033-OTBD-TRIP-ID       17104900
171050         MOVE  PC046-TRLR-ID         TO  PC033-VEH-NBR            17105000
171051         MOVE  PC046-SCAC            TO  PC033-OWNER-SCAC-ID      17105100
171052         IF PC033-OTBD-TRIP-ID  > SPACES AND                      17105200
171053            PC033-VEH-NBR       > SPACES AND                      17105300
171054            PC033-OWNER-SCAC-ID > SPACES AND                      17105400
171055            NOT PC046-SCANNED-OFF-TRLR                            17105500
171056*                                                                 17105600
171057* IF CARTON IS MANIFESTED TO A SHUTTLE TRAILER, INSERT A          17105700
171058* SCAN OFF ROW AND ALLOW THE CARTON TO BE ATTACHED TO THE         17105800
171059* MASTER CONTAINER                                                17105900
171060* 'DS' - DC SHUTTLE TRAILER    'ST' - DC STORAGE TRAILER          17106000
171061*                                                                 17106100
171062            IF  PC046-DOOR-TYP-CDE  = 'DS'  OR                    17106200
171063                PC046-DOOR-TYP-CDE  = 'ST'                        17106300
171064                PERFORM 3425-INS-SCAN-OFF                         17106400
171065                SET  PC046-SCANNED-OFF-TRLR  TO  TRUE             17106500
171066            ELSE                                                  17106600
171067*                                                                 17106700
171068               MOVE SQLCA               TO PC033-SQLCA            17106800
171069               SET PC033-INITIALIZE-SCREEN TO TRUE                17106900
171070               MOVE 16                   TO PC033-PGM-MSG-NBR     17107000
171071               PERFORM 8210-XCTL-ERROR-SCREEN                     17107100
171072            END-IF                                                17107200
171073         ELSE                                                     17107300
171074            CONTINUE                                              17107400
171075         END-IF                                                   17107500
171076     ELSE                                                         17107600
171077         SET  PS-ERROR-YES           TO  TRUE                     17107700
171078         MOVE  PC-CICS-ABEND-MSG     TO  AMSGLNO                  17107800
171079         PERFORM 9904-WRITE-CRTN-MODULE-MSG                       17107900
171080                                                                  17108000
171081     END-IF                                                       17108100
171082     END-IF                                                       17108200
171083     END-IF                                                       17108300
171084     END-IF                                                       17108400
171085     END-IF.                                                      17108500
171086*                                                                 17108600
171087*                                                                 17108700
171088******************************************************************17108800
171089* VALIDATE PRINTER ID                                             17108900
171090* CALLS DPKCS060 TO VALIDATE THE PRINTER ID                       17109000
171091******************************************************************17109100
171092 3010-VALIDATE-PRINTER.                                           17109200
171093                                                                  17109300
171094     MOVE PV-PRINTER-ID      TO  DP072-PRINTER-ID.                17109400
171095     MOVE PC-REPORT-PGM-1    TO  DP072-RPT-PGM-NME.               17109500
171096     MOVE PC-01              TO  DP072-RPT-PGM-TYP-ID.            17109600
171097     MOVE PC033-OPER-UNT-ID  TO  DP072-ORIGIN-OPER-UNT-ID.        17109700
171098     MOVE PC033-OPER-UNT-ID  TO  DP072-OPER-UNT-ID.               17109800
171099     MOVE 1                  TO  DP072-ORIGIN-FCLTY-ID            17109900
171100                                 DP072-FCLTY-ID.                  17110000
171101     SET DP072-VALIDATE      TO  TRUE.                            17110100
171102                                                                  17110200
171103     EXEC CICS                                                    17110300
171104          LINK PROGRAM  (PC-PRTR-VALIDATION-PGM)                  17110400
171105               COMMAREA (DP072-COMM-AREA)                         17110500
171106               RESP     (PV-CICS-RESPONSE)                        17110600
171107     END-EXEC                                                     17110700
171108                                                                  17110800
171109     EVALUATE TRUE                                                17110900
171110         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17111000
171111              PERFORM 3020-VALIDATE-PRINTER-ID-SML                17111100
171112              IF PS-VALID-PRINTER-ID                              17111200
171113                  SET PS-VALID-INPUT         TO TRUE              17111300
171114                  MOVE PV-PRINTER-ID         TO PC033-SML-PRTR-ID 17111400
171115              END-IF                                              17111500
171116         WHEN OTHER                                               17111600
171117             SET PS-INVALID-PRINTER-ID  TO  TRUE                  17111700
171118     END-EVALUATE.                                                17111800
171119*                                                                 17111900
171120*                                                                 17112000
171121*  VALIDATE THE PRINTER NUMBER ENTERED ON THE SCREEN TO ENSURE    17112100
171122*  THIS IS A VALID PRINTER AND THAT SHIPPING MANIFEST LABELS      17112200
171123*  CAN BE PRINTED ON THIS PRINTER.                                17112300
171124*  SHIPPING MANIFEST LABELS CAN BE PRINTED ON THIS PRINTER IF     17112400
171125*  CLUSTR-OS-RLSE-CDE ON TPRTRCL IS NOT EQUAL TO 'MGMX' AND       17112500
171126*  PRTR-TRK-STAT-CDE ON TPRTRTK = 'A'.                            17112600
171127*                                                                 17112700
171128 3020-VALIDATE-PRINTER-ID-SML.                                    17112800
171129                                                                  17112900
171130     IF  DP072-PRTR-CLUSTER-OS-RLSE-CDE  =  PC-MGMX               17113000
171140         SET  PS-INVALID-PRINTER-ID   TO TRUE                     17114000
171150     END-IF.                                                      17115000
171160                                                                  17116000
171170     IF  DP072-PRTR-PRTR-TRK-STAT-CDE    =  PC-A                  17117000
171180         SET  PS-VALID-PRINTER-ID     TO TRUE                     17118000
171190     ELSE                                                         17119000
171200         SET  PS-INVALID-PRINTER-ID   TO TRUE                     17120000
171300     END-IF.                                                      17130000
171400*                                                                 17140000
171500*                                                                 17150000
171600 3100-REMOVE-CHLD-FROM-MSTR.                                      17160000
171700     EXEC SQL                                                     17170000
171800          UPDATE SUT_OTBND_CART                                   17180000
171900          SET                                                     17190000
172000              PRNT_CART_ID = :DK-CHILD-CARTON                     17200000
172100        WHERE SHIPT_UNT_ID      = :DK-CHILD-CARTON                17210000
172200          AND PRNT_CART_ID = :DK-CARTON                           17220000
172300          AND MSTR_CART_IND     = 'N'                             17230000
172400     END-EXEC.                                                    17240000
172500     EVALUATE TRUE                                                17250000
172600         WHEN SQLCODE = ZERO                                      17260000
172700             PERFORM 2259-SELECT-OTBND-CART                       17270000
172800             IF SUT00024-SHIPT-UNT-ID = SUT00024-PRNT-CART-ID     17280000
172900                PERFORM 2261-GET-CTNS-IN-MASTER                   17290000
173000                MOVE PV-CARTONS-IN-MASTER TO                      17300000
173100                                          ACTNMSTRO               17310000
173200                                          PC033-CTNS-IN-MASTER    17320000
173300             ELSE                                                 17330000
173400                PERFORM 2262-COUNT-CHILDREN-OF-MASTER             17340000
173500                MOVE PV-CHILDRN-IN-MASTER TO                      17350000
173600                                          ACTNMSTRO               17360000
173700                                          PC033-CTNS-IN-MASTER    17370000
173800             END-IF                                               17380000
173900             MOVE PC-REMOVED-FROM-MASTER TO AMSGLNO               17390000
174000         WHEN SQLCODE = -904                                      17400000
174100         WHEN SQLCODE = -913                                      17410000
174200         WHEN SQLCODE = -911                                      17420000
174300             MOVE 15                  TO PV-ERROR-NBR             17430000
174400             PERFORM 9903-WRITE-CICS-LOG                          17440000
174500             PERFORM 9000-SOFT-ABORT                              17450000
174600         WHEN SQLWARN0 NOT = SPACES                               17460000
174700         WHEN SQLCODE NOT EQUAL ZERO                              17470000
174800             MOVE '3100-REMOVE-CHLD-FROM-MSTR'                    17480000
174900                             TO DP013-PARAGRAPH                   17490000
175000             MOVE 'PCKRF865 - REMOVE CHLD FROM MSTR'              17500000
175100                             TO DP013-MESSAGE-TEXT(1)             17510000
175200             MOVE SUT00024-SHIPT-UNT-ID                           17520000
175300                             TO DP013-MESSAGE-TEXT(2)             17530000
175400             MOVE SQLCA      TO DP013-SQLCA                       17540000
175500             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           17550000
175600             SET DP013-DB2-ABEND                                  17560000
175700                             TO TRUE                              17570000
175800             SET DP013-ROLLBACK                                   17580000
175900                             TO TRUE                              17590000
176000             SET DP013-XCTL-DISPLAY-RESTART                       17600000
176100                             TO TRUE                              17610000
176200             PERFORM DP014-0000-PROCESS-ABEND                     17620000
176300     END-EVALUATE.                                                17630000
176400*                                                                 17640000
176500***************************************************************** 17650000
176600* POPULATE HOST VARIABLES IN SUT_MSTR_SHIPT_CNT                   17660000
176700* FOR REMOVE-CHILD-FROM-MASTER                                    17670000
176800***************************************************************** 17680000
176900                                                                  17690000
177000     IF PC033-NEW-VERSION                                         17700000
177100       SET PS-UPDATE-COMMIT TO TRUE                               17710000
177200       MOVE 'RCM' TO SUT00099-ACTN-TYP-CDE                        17720000
177300       MOVE 'SU' TO SUT00099-CHLD-SHIPT-TYP-CDE                   17730000
177400       INITIALIZE PC242-DTL-TXT-AREA                              17740000
177500       SET PC242-RMVE-CHILD-FROM-MASTER TO TRUE                   17750000
177600       MOVE +1 TO PV-CHD-SHPT-UNT-ID-NULL                         17760000
177700       MOVE DK-CHILD-CARTON TO SUT00099-CHLD-SHIPT-UNT-ID         17770000
177800       MOVE -1 TO PV-CHD-MST-SHPT-ID-NULL                         17780000
177900       PERFORM 3410-CONT-SHIPT-CNT                                17790000
178000     END-IF.                                                      17800000
178100                                                                  17810000
178200 3200-REMOVE-MSTR-FROM-MSTR.                                      17820000
178300     EXEC SQL                                                     17830000
178400          UPDATE SUT_OTBND_CART                                   17840000
178500          SET                                                     17850000
178600              PRNT_CART_ID = :DK-CHILD-CARTON                     17860000
178700        WHERE SHIPT_UNT_ID      = :DK-CHILD-CARTON                17870000
178800          AND PRNT_CART_ID = :DK-CARTON                           17880000
178900          AND MSTR_CART_IND     = 'Y'                             17890000
179000     END-EXEC.                                                    17900000
179100     EVALUATE TRUE                                                17910000
179200         WHEN SQLCODE = ZERO                                      17920000
179300             PERFORM 2259-SELECT-OTBND-CART                       17930000
179400             IF SUT00024-SHIPT-UNT-ID = SUT00024-PRNT-CART-ID     17940000
179500                PERFORM 2261-GET-CTNS-IN-MASTER                   17950000
179600                MOVE PV-CARTONS-IN-MASTER TO                      17960000
179700                                          ACTNMSTRO               17970000
179800                                          PC033-CTNS-IN-MASTER    17980000
179900             ELSE                                                 17990000
180000                PERFORM 2262-COUNT-CHILDREN-OF-MASTER             18000000
180100                MOVE PV-CHILDRN-IN-MASTER TO                      18010000
180200                                          ACTNMSTRO               18020000
180300                                          PC033-CTNS-IN-MASTER    18030000
180400             END-IF                                               18040000
180500             MOVE PC-REMOVED-FROM-MASTER TO AMSGLNO               18050000
180600         WHEN SQLCODE = -904                                      18060000
180700         WHEN SQLCODE = -913                                      18070000
180800         WHEN SQLCODE = -911                                      18080000
180900             MOVE 16                  TO PV-ERROR-NBR             18090000
181000             PERFORM 9903-WRITE-CICS-LOG                          18100000
181100             PERFORM 9000-SOFT-ABORT                              18110000
181200         WHEN SQLWARN0 NOT = SPACES                               18120000
181300         WHEN SQLCODE NOT EQUAL ZERO                              18130000
181400             MOVE '3200-REMOVE-MSTR-FROM-MSTR'                    18140000
181500                             TO DP013-PARAGRAPH                   18150000
181600             MOVE 'PCKRF865 - REMOVE MSTR FROM MSTR'              18160000
181700                             TO DP013-MESSAGE-TEXT(1)             18170000
181800             MOVE SUT00024-SHIPT-UNT-ID                           18180000
181900                             TO DP013-MESSAGE-TEXT(2)             18190000
182000             MOVE SQLCA      TO DP013-SQLCA                       18200000
182100             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           18210000
182200             SET DP013-DB2-ABEND                                  18220000
182300                             TO TRUE                              18230000
182400             SET DP013-ROLLBACK                                   18240000
182500                             TO TRUE                              18250000
182600             SET DP013-XCTL-DISPLAY-RESTART                       18260000
182700                             TO TRUE                              18270000
182800             PERFORM DP014-0000-PROCESS-ABEND                     18280000
182900     END-EVALUATE.                                                18290000
183000*                                                                 18300000
183100***************************************************************** 18310000
183200* POPULATE HOST VARIABLES IN SUT_MSTR_SHIPT_CNT                   18320000
183300* FOR REMOVE-MSTR-FROM-MSTR                                       18330000
183400***************************************************************** 18340000
183500                                                                  18350000
183600     IF PC033-NEW-VERSION                                         18360000
183700       MOVE 'RMM' TO SUT00099-ACTN-TYP-CDE                        18370000
183800       MOVE 'MS' TO SUT00099-CHLD-SHIPT-TYP-CDE                   18380000
183900       MOVE +1 TO PV-CHD-MST-SHPT-ID-NULL                         18390000
184000       MOVE DK-CHILD-CARTON TO SUT00099-CHLD-MSTR-SHIPT-ID        18400000
184100       MOVE -1 TO PV-CHD-SHPT-UNT-ID-NULL                         18410000
184200       INITIALIZE PC242-DTL-TXT-AREA                              18420000
184300       SET PC242-RMVE-MASTER-FROM-MASTER TO TRUE                  18430000
184400       PERFORM 3410-CONT-SHIPT-CNT                                18440000
184500     END-IF.                                                      18450000
184600*                                                                 18460000
184700 3300-REASSIGN-TO-MSTR.                                           18470000
184800     EXEC SQL                                                     18480000
184900          UPDATE SUT_OTBND_CART                                   18490000
185000          SET                                                     18500000
185100              PRNT_CART_ID = :DK-MASTER-CARTON                    18510000
185200        WHERE SHIPT_UNT_ID      = :DK-CHILD-CARTON                18520000
185300          AND PRNT_CART_ID = :DK-CARTON                           18530000
185400*         AND MSTR_CART_IND     = 'N'                             18540000
185500     END-EXEC.                                                    18550000
185600     EVALUATE TRUE                                                18560000
185700         WHEN SQLCODE = ZERO                                      18570000
185800             PERFORM 2259-SELECT-OTBND-CART                       18580000
185900             IF SUT00024-SHIPT-UNT-ID = SUT00024-PRNT-CART-ID     18590000
186000                PERFORM 2261-GET-CTNS-IN-MASTER                   18600000
186100                MOVE PV-CARTONS-IN-MASTER TO                      18610000
186200                                          ACTNMSTRO               18620000
186300                                          PC033-CTNS-IN-MASTER    18630000
186400             ELSE                                                 18640000
186500                PERFORM 2262-COUNT-CHILDREN-OF-MASTER             18650000
186600                MOVE PV-CHILDRN-IN-MASTER TO                      18660000
186700                                          ACTNMSTRO               18670000
186800                                          PC033-CTNS-IN-MASTER    18680000
186900             END-IF                                               18690000
187000             MOVE PC-REASSIGNED-TO-MASTER TO AMSGLNO              18700000
187100         WHEN SQLCODE = -904                                      18710000
187200         WHEN SQLCODE = -913                                      18720000
187300         WHEN SQLCODE = -911                                      18730000
187400             MOVE 17                  TO PV-ERROR-NBR             18740000
187500             PERFORM 9903-WRITE-CICS-LOG                          18750000
187600             PERFORM 9000-SOFT-ABORT                              18760000
187700         WHEN SQLWARN0 NOT = SPACES                               18770000
187800         WHEN SQLCODE NOT EQUAL ZERO                              18780000
187900             MOVE '3300-REASSIGN-TO-MSTR'                         18790000
188000                             TO DP013-PARAGRAPH                   18800000
188100             MOVE 'PCKRF865 - REASSIGN TO MSTR'                   18810000
188200                             TO DP013-MESSAGE-TEXT(1)             18820000
188300             MOVE SUT00024-SHIPT-UNT-ID                           18830000
188400                             TO DP013-MESSAGE-TEXT(2)             18840000
188500             MOVE SQLCA      TO DP013-SQLCA                       18850000
188600             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           18860000
188700             SET DP013-DB2-ABEND                                  18870000
188800                             TO TRUE                              18880000
188900             SET DP013-ROLLBACK                                   18890000
189000                             TO TRUE                              18900000
189100             SET DP013-XCTL-DISPLAY-RESTART                       18910000
189200                             TO TRUE                              18920000
189300             PERFORM DP014-0000-PROCESS-ABEND                     18930000
189400     END-EVALUATE.                                                18940000
189500                                                                  18950000
189600***************************************************************** 18960000
189700* POPULATE HOST VARIABLES IN SUT_MSTR_SHIPT_CNT                   18970000
189800* FOR REASSIGN TO MASTER                                          18980000
189900***************************************************************** 18990000
190000                                                                  19000000
190100     IF PC033-NEW-VERSION                                         19010000
190200       MOVE 'RTM' TO SUT00099-ACTN-TYP-CDE                        19020000
190300       MOVE 'SU' TO SUT00099-CHLD-SHIPT-TYP-CDE                   19030000
190400       INITIALIZE PC242-DTL-TXT-AREA                              19040000
190500       SET PC242-REASSIGN-TO-MASTER TO TRUE                       19050000
190600                                                                  19060000
190700       MOVE +1 TO PV-CHD-SHPT-UNT-ID-NULL                         19070000
190800       MOVE DK-CHILD-CARTON     TO SUT00099-CHLD-SHIPT-UNT-ID     19080000
190900       MOVE -1 TO PV-CHD-MST-SHPT-ID-NULL                         19090000
191000       PERFORM 3410-CONT-SHIPT-CNT                                19100000
191100     END-IF.                                                      19110000
191200*                                                                 19120000
191300 3400-ADD-MSTR-TO-MSTR.                                           19130000
191400     EXEC SQL                                                     19140000
191500          UPDATE SUT_OTBND_CART                                   19150000
191600          SET                                                     19160000
191700              PRNT_CART_ID = :DK-CARTON                           19170000
191800        WHERE SHIPT_UNT_ID      = :DK-CHILD-CARTON                19180000
191900          AND PRNT_CART_ID = :DK-CHILD-CARTON                     19190000
192000          AND MSTR_CART_IND     = 'Y'                             19200000
192100     END-EXEC.                                                    19210000
192200     EVALUATE TRUE                                                19220000
192300         WHEN SQLCODE = ZERO                                      19230000
192400             PERFORM 2259-SELECT-OTBND-CART                       19240000
192500             IF SUT00024-SHIPT-UNT-ID = SUT00024-PRNT-CART-ID     19250000
192600                PERFORM 2261-GET-CTNS-IN-MASTER                   19260000
192700                MOVE PV-CARTONS-IN-MASTER TO                      19270000
192800                                          ACTNMSTRO               19280000
192900                                          PC033-CTNS-IN-MASTER    19290000
193000             ELSE                                                 19300000
193100                PERFORM 2262-COUNT-CHILDREN-OF-MASTER             19310000
193200                MOVE PV-CHILDRN-IN-MASTER TO                      19320000
193300                                          ACTNMSTRO               19330000
193400                                          PC033-CTNS-IN-MASTER    19340000
193500             END-IF                                               19350000
193600             MOVE PC-ADDED-TO-MASTER TO AMSGLNO                   19360000
193700         WHEN SQLCODE = -904                                      19370000
193800         WHEN SQLCODE = -913                                      19380000
193900         WHEN SQLCODE = -911                                      19390000
194000             MOVE 18                  TO PV-ERROR-NBR             19400000
194100             PERFORM 9903-WRITE-CICS-LOG                          19410000
194200             PERFORM 9000-SOFT-ABORT                              19420000
194300         WHEN SQLWARN0 NOT = SPACES                               19430000
194400         WHEN SQLCODE NOT EQUAL ZERO                              19440000
194500             MOVE '3400-ADD-MSTR-TO-MSTR'                         19450000
194600                             TO DP013-PARAGRAPH                   19460000
194700             MOVE 'PCKRF865 - ADD MSTR TO MSTR'                   19470000
194800                             TO DP013-MESSAGE-TEXT(1)             19480000
194900             MOVE SUT00024-SHIPT-UNT-ID                           19490000
195000                             TO DP013-MESSAGE-TEXT(2)             19500000
195100             MOVE SQLCA      TO DP013-SQLCA                       19510000
195200             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           19520000
195300             SET DP013-DB2-ABEND                                  19530000
195400                             TO TRUE                              19540000
195500             SET DP013-ROLLBACK                                   19550000
195600                             TO TRUE                              19560000
195700             SET DP013-XCTL-DISPLAY-RESTART                       19570000
195800                             TO TRUE                              19580000
195900             PERFORM DP014-0000-PROCESS-ABEND                     19590000
196000     END-EVALUATE.                                                19600000
196100                                                                  19610000
196200***************************************************************** 19620000
196300* POPULATE HOST VARIABLES FOR SUT00099                            19630000
196400*                                                                 19640000
196500***************************************************************** 19650000
196600                                                                  19660000
196700     IF PC033-NEW-VERSION                                         19670000
196800       MOVE 'AMM' TO SUT00099-ACTN-TYP-CDE                        19680000
196900       MOVE 'MS' TO SUT00099-CHLD-SHIPT-TYP-CDE                   19690000
197000       INITIALIZE PC242-DTL-TXT-AREA                              19700000
197100       SET PC242-ADD-MASTER-TO-MASTER TO TRUE                     19710000
197200       MOVE +1 TO PV-CHD-MST-SHPT-ID-NULL                         19720000
197300       MOVE DK-CHILD-CARTON TO SUT00099-CHLD-MSTR-SHIPT-ID        19730000
197400       MOVE -1 TO PV-CHD-SHPT-UNT-ID-NULL                         19740000
197500       PERFORM 3410-CONT-SHIPT-CNT                                19750000
197600     END-IF.                                                      19760000
197700*                                                                 19770000
197800***************************************************************** 19780000
197900* THIS PARAGRAPH WILL BE  EXECUTED FOR EACH BUSINESS EVENTS.      19790000
198000* IT WILL BE CALLED FROM THE FOLLOWING PARAGRAPHS:                19800000
198100*                                                                 19810000
198200* 3100-REMOVE-CHILD-FROM-MSTR                                     19820000
198300* 3200-REMOVE-MSTR-FROM-MSTR                                      19830000
198400* 3300-REASSIGN-TO-MSTR                                           19840000
198500* 3400-ADD-MSTR-TO-MSTR                                           19850000
198600* 3500-ADD-CHILD-TO-MSTR                                          19860000
198700* 3510-ADD-CHILD-TO-MSTR                                          19870000
198800*                                                                 19880000
198900* IF THERE IS A FAILURE AT ANY POINT IT WILL DO A                 19890000
199000* SYNCPOINT ROLLBACK.                                             19900000
199100* THIS PARAGRAPH WILL DO THE FOLLOWING THINGS:                    19910000
199200*                                                                 19920000
199300* -- INSERT INTO CONTAINER SHIPMENT UNIT TABLE.                   19930000
199400*                                                                 19940000
199500* -- CALL XLKUP033 - WRITE DATA TO THE EAI EXPORT TABLES IF       19950000
199600*                                                                 19960000
199700***************************************************************** 19970000
199800 3410-CONT-SHIPT-CNT.                                             19980000
199900                                                                  19990000
200000     MOVE PC033-CARTON TO SUT00099-MSTR-SHIPT-UNT-ID.             20000000
200100*                                                                 20010000
200200     MOVE PC033-USER-ID TO SUT00099-CRE-BY-USR-ID.                20020000
200300*                                                                 20030000
200400     SET PS-UPDATE-COMMIT TO TRUE.                                20040000
200500*                                                                 20050000
200600     IF NOT PC242-REASSIGN-TO-MASTER                              20060000
200700       PERFORM 3422-SEL-CART-SHIPT-CNT.                           20070000
200800                                                                  20080000
200900     IF PS-UPDATE-ROLLBACK                                        20090000
201000        PERFORM 9000-SOFT-ABORT.                                  20100000
201100                                                                  20110000
201200     IF PC242-REASSIGN-TO-MASTER                                  20120000
201300        PERFORM 3421-INS-CART-SHIPT-CNT                           20130000
201400     ELSE                                                         20140000
201500        PERFORM 3420-INS-CART-SHIPT-CNT.                          20150000
201600                                                                  20160000
201700     IF PS-UPDATE-COMMIT                                          20170000
201800        PERFORM 9010-COMMIT-POINT                                 20180000
201900     ELSE                                                         20190000
202000        PERFORM 9000-SOFT-ABORT.                                  20200000
202100*                                                                 20210000
202200***************************************************************** 20220000
202300* 3420-INS-CART-SHIPT-UNT                                         20230000
202400***************************************************************** 20240000
202500 3420-INS-CART-SHIPT-CNT.                                         20250000
202600     EXEC SQL                                                     20260000
202700         INSERT INTO SUT_MSTR_SHIPT_CNT                           20270000
202800               (MSTR_SHIPT_UNT_ID,                                20280000
202900                CRE_TMST,                                         20290000
203000                ACTN_TYP_CDE,                                     20300000
203010                CHLD_SHIPT_TYP_CDE,                               20301000
203020                CRE_BY_USR_ID,                                    20302000
203030                CHLD_MSTR_SHIPT_ID,                               20303000
203040                CHLD_SHIPT_UNT_ID)                                20304000
203050         VALUES                                                   20305000
203051               (:DK-CARTON,                                       20305100
203052                CURRENT TIMESTAMP,                                20305200
203053                :SUT00099-ACTN-TYP-CDE,                           20305300
203054                :SUT00099-CHLD-SHIPT-TYP-CDE,                     20305400
203055                :SUT00099-CRE-BY-USR-ID,                          20305500
203056                :SUT00099-CHLD-MSTR-SHIPT-ID                      20305600
203057                        :PV-CHD-MST-SHPT-ID-NULL,                 20305700
203058                :SUT00099-CHLD-SHIPT-UNT-ID                       20305800
203059                        :PV-CHD-SHPT-UNT-ID-NULL)                 20305900
203060     END-EXEC.                                                    20306000
203061                                                                  20306100
203062     EVALUATE TRUE                                                20306200
203063         WHEN SQLCODE = ZERO                                      20306300
203064             CONTINUE                                             20306400
203065         WHEN SQLCODE = -904                                      20306500
203066         WHEN SQLCODE = -913                                      20306600
203067         WHEN SQLCODE = -911                                      20306700
203068             MOVE 8                   TO PV-ERROR-NBR             20306800
203069             SET PS-UPDATE-ROLLBACK TO TRUE                       20306900
203070             PERFORM 9903-WRITE-CICS-LOG                          20307000
203071             PERFORM 9000-SOFT-ABORT                              20307100
203072         WHEN SQLWARN0 NOT = SPACES                               20307200
203073         WHEN SQLCODE NOT EQUAL ZERO                              20307300
203074             SET PS-UPDATE-ROLLBACK TO TRUE                       20307400
203075             MOVE 7                   TO PV-ERROR-NBR             20307500
203076                                         PC033-ERROR-NBR          20307600
203077             PERFORM 9903-WRITE-CICS-LOG                          20307700
203078             MOVE '3420-INS-CART-SHIPT-CNT'                       20307800
203079                                      TO PC033-PARAGRAPH          20307900
203080             MOVE 'PCKRF865 - INSERT CARTON SHIPPING UNIT'        20308000
203081                                      TO PC033-MESSAGE-TEXT(1)    20308100
203082             MOVE SUT00024-SHIPT-UNT-ID                           20308200
203083                                      TO PC033-MESSAGE-TEXT(2)    20308300
203084             MOVE SQLCA               TO PC033-SQLCA              20308400
203085             MOVE 'SUT00099'          TO PC033-DB2-TABLE-NAME(1)  20308500
203086             SET PC033-ABEND          TO TRUE                     20308600
203087             MOVE 99                  TO PC033-PGM-MSG-NBR        20308700
203088             PERFORM 8210-XCTL-ERROR-SCREEN                       20308800
203089     END-EVALUATE.                                                20308900
203090*                                                                 20309000
203091*                                                                 20309100
203092***************************************************************** 20309200
203093* 3421-INS-CART-SHIPT-UNT                                         20309300
203094***************************************************************** 20309400
203095 3421-INS-CART-SHIPT-CNT.                                         20309500
203096     EXEC SQL                                                     20309600
203097         INSERT INTO SUT_MSTR_SHIPT_CNT                           20309700
203098               (MSTR_SHIPT_UNT_ID,                                20309800
203099                CRE_TMST,                                         20309900
203100                ACTN_TYP_CDE,                                     20310000
203101                CHLD_SHIPT_TYP_CDE,                               20310100
203102                CRE_BY_USR_ID,                                    20310200
203103                CHLD_MSTR_SHIPT_ID,                               20310300
203104                CHLD_SHIPT_UNT_ID)                                20310400
203105         VALUES                                                   20310500
203106               (:DK-MASTER-CARTON,                                20310600
203107                CURRENT TIMESTAMP,                                20310700
203108                :SUT00099-ACTN-TYP-CDE,                           20310800
203109                :SUT00099-CHLD-SHIPT-TYP-CDE,                     20310900
203110                :SUT00099-CRE-BY-USR-ID,                          20311000
203120                :SUT00099-CHLD-MSTR-SHIPT-ID                      20312000
203121                        :PV-CHD-MST-SHPT-ID-NULL,                 20312100
203122                :SUT00099-CHLD-SHIPT-UNT-ID                       20312200
203123                        :PV-CHD-SHPT-UNT-ID-NULL)                 20312300
203124     END-EXEC.                                                    20312400
203125                                                                  20312500
203126     EVALUATE TRUE                                                20312600
203127         WHEN SQLCODE = ZERO                                      20312700
203128             CONTINUE                                             20312800
203129         WHEN SQLCODE = -904                                      20312900
203130         WHEN SQLCODE = -913                                      20313000
203131         WHEN SQLCODE = -911                                      20313100
203132             MOVE 8                   TO PV-ERROR-NBR             20313200
203133             SET PS-UPDATE-ROLLBACK TO TRUE                       20313300
203134             PERFORM 9903-WRITE-CICS-LOG                          20313400
203135             PERFORM 9000-SOFT-ABORT                              20313500
203136         WHEN SQLWARN0 NOT = SPACES                               20313600
203137         WHEN SQLCODE NOT EQUAL ZERO                              20313700
203138             SET PS-UPDATE-ROLLBACK TO TRUE                       20313800
203139             MOVE 7                   TO PV-ERROR-NBR             20313900
203140                                         PC033-ERROR-NBR          20314000
203141             PERFORM 9903-WRITE-CICS-LOG                          20314100
203142             MOVE '3421-INS-CART-SHIPT-CNT'                       20314200
203143                                      TO PC033-PARAGRAPH          20314300
203144             MOVE 'PCKRF865 - INSERT CARTON SHIPPING UNIT'        20314400
203145                                      TO PC033-MESSAGE-TEXT(1)    20314500
203146             MOVE SUT00024-SHIPT-UNT-ID                           20314600
203147                                      TO PC033-MESSAGE-TEXT(2)    20314700
203148             MOVE SQLCA               TO PC033-SQLCA              20314800
203149             MOVE 'SUT00099'          TO PC033-DB2-TABLE-NAME(1)  20314900
203150             SET PC033-ABEND          TO TRUE                     20315000
203151             MOVE 99                  TO PC033-PGM-MSG-NBR        20315100
203152             PERFORM 8210-XCTL-ERROR-SCREEN                       20315200
203153     END-EVALUATE.                                                20315300
203154*                                                                 20315400
203155 3422-SEL-CART-SHIPT-CNT.                                         20315500
203156                                                                  20315600
203157     EXEC SQL                                                     20315700
203158        SELECT MSTR_SHIPT_UNT_ID                                  20315800
203159          INTO :SUT00099-MSTR-SHIPT-UNT-ID                        20315900
203160         FROM  SUT_MSTR_SHIPT_CNT                                 20316000
203170                                                                  20317000
203180        WHERE CRE_BY_USR_ID = :PC033-USER-ID                      20318000
203190          AND ACTN_TYP_CDE IN ('RCM', 'RMM', 'RTM')               20319000
203200          AND (CHLD_SHIPT_UNT_ID = :DK-CHILD-CARTON  OR           20320000
203201              CHLD_MSTR_SHIPT_ID = :DK-CHILD-CARTON)              20320100
203202     END-EXEC.                                                    20320200
203203     EVALUATE TRUE                                                20320300
203204         WHEN SQLCODE = ZERO                                      20320400
203205         WHEN SQLCODE = -811                                      20320500
203206              CONTINUE                                            20320600
203207         WHEN SQLCODE = +100                                      20320700
203208             PERFORM 3440-CALL-XLKUP033                           20320800
203209         WHEN SQLCODE = -904                                      20320900
203210         WHEN SQLCODE = -913                                      20321000
203220         WHEN SQLCODE = -911                                      20322000
203221             MOVE  9   TO PV-ERROR-NBR                            20322100
203222             PERFORM 9903-WRITE-CICS-LOG                          20322200
203223             PERFORM 9000-SOFT-ABORT                              20322300
203224         WHEN SQLWARN0 NOT = SPACES                               20322400
203225         WHEN SQLCODE NOT EQUAL ZERO                              20322500
203226             MOVE '3422-SEL-CART-SHIPT-CNT'                       20322600
203227                             TO DP013-PARAGRAPH                   20322700
203228             MOVE 'PCKRF865 - -SEL-CART-SHIPT-UNT'                20322800
203229                             TO DP013-MESSAGE-TEXT(1)             20322900
203230             MOVE SUT00099-CHLD-SHIPT-UNT-ID                      20323000
203231                             TO DP013-MESSAGE-TEXT(2)             20323100
203232             MOVE SQLCA      TO DP013-SQLCA                       20323200
203233             MOVE 'SUT00099' TO DP013-DB2-TABLE-NAME(1)           20323300
203234             SET DP013-DB2-ABEND                                  20323400
203235                             TO TRUE                              20323500
203236             SET DP013-ROLLBACK                                   20323600
203237                             TO TRUE                              20323700
203238             SET DP013-XCTL-DISPLAY-RESTART                       20323800
203239                             TO TRUE                              20323900
203240             PERFORM DP014-0000-PROCESS-ABEND                     20324000
203241     END-EVALUATE.                                                20324100
203242                                                                  20324200
203243                                                                  20324300
203244                                                                  20324400
203245***************************************************************** 20324500
203246* 3425-INS-SCAN-OFF.                                              20324600
203247***************************************************************** 20324700
203248 3425-INS-SCAN-OFF.                                               20324800
203249                                                                  20324900
203250     IF PC046-SCANNED-ONTO-TRLR                                   20325000
203251        PERFORM 3426-INACTIVATE-SHON                              20325100
203252     ELSE                                                         20325200
203253        PERFORM 3427-INACTIVATE-DIVERT                            20325300
203254     END-IF.                                                      20325400
203255                                                                  20325500
203256     MOVE PC046-CARTON-ID      TO  SUT00027-SHIPT-UNT-ID          20325600
203257     MOVE PC033-OPER-UNT-ID    TO  SUT00027-LOC-NBR               20325700
203258     MOVE 'SHOF'               TO  SUT00027-SCN-CDE               20325800
203259     MOVE PC033-USER-ID        TO  SUT00027-CRE-USR-ID            20325900
203260     MOVE PC046-OTBD-TRIP-ID   TO  SUT00027-OTBND-TRIP-ID         20326000
203261     MOVE 'I'                  TO  SUT00027-ACTV-CDE              20326100
203262                                                                  20326200
203263                                                                  20326300
203264     EXEC SQL                                                     20326400
203265         INSERT INTO SUT_OTBND_LOC                                20326500
203266         (                                                        20326600
203267              SHIPT_UNT_ID                                        20326700
203268              , LOC_NBR                                           20326800
203269              , SCN_CDE                                           20326900
203270              , CRE_USR_ID                                        20327000
203271              , CRE_TMST                                          20327100
203272              , OTBND_TRIP_ID                                     20327200
203273              , ACTV_CDE                                          20327300
203274              , INBD_TRIP_ID                                      20327400
203275         )                                                        20327500
203276         VALUES                                                   20327600
203277         (                                                        20327700
203278                 :SUT00027-SHIPT-UNT-ID                           20327800
203279               , :SUT00027-LOC-NBR                                20327900
203280               , :SUT00027-SCN-CDE                                20328000
203281               , :SUT00027-CRE-USR-ID                             20328100
203282               , CURRENT TIMESTAMP                                20328200
203283               , :SUT00027-OTBND-TRIP-ID                          20328300
203284               , :SUT00027-ACTV-CDE                               20328400
203285               , 0                                                20328500
203286           )                                                      20328600
203287     END-EXEC.                                                    20328700
203288                                                                  20328800
203289     EVALUATE TRUE                                                20328900
203290         WHEN SQLCODE = ZERO                                      20329000
203291             CONTINUE                                             20329100
203292         WHEN SQLCODE = -904                                      20329200
203293         WHEN SQLCODE = -913                                      20329300
203294         WHEN SQLCODE = -911                                      20329400
203295             MOVE 8                   TO PV-ERROR-NBR             20329500
203296             SET PS-UPDATE-ROLLBACK TO TRUE                       20329600
203297             PERFORM 9903-WRITE-CICS-LOG                          20329700
203298             PERFORM 9000-SOFT-ABORT                              20329800
203299         WHEN SQLWARN0 NOT = SPACES                               20329900
203300         WHEN SQLCODE NOT EQUAL ZERO                              20330000
203301             SET PS-UPDATE-ROLLBACK TO TRUE                       20330100
203302             MOVE 7                   TO PV-ERROR-NBR             20330200
203303                                         PC033-ERROR-NBR          20330300
203304             PERFORM 9903-WRITE-CICS-LOG                          20330400
203305             MOVE '3425-INS-SCAN-OFF'                             20330500
203306                                      TO PC033-PARAGRAPH          20330600
203307             MOVE 'PCKRF865 - INSERT CARTON SCAN OFF'             20330700
203308                                      TO PC033-MESSAGE-TEXT(1)    20330800
203309             MOVE SUT00027-SHIPT-UNT-ID                           20330900
203310                                      TO PC033-MESSAGE-TEXT(2)    20331000
203311             MOVE SQLCA               TO PC033-SQLCA              20331100
203312             MOVE 'SUT00027'          TO PC033-DB2-TABLE-NAME(1)  20331200
203313             SET PC033-ABEND          TO TRUE                     20331300
203314             MOVE 99                  TO PC033-PGM-MSG-NBR        20331400
203315             PERFORM 8210-XCTL-ERROR-SCREEN                       20331500
203316     END-EVALUATE.                                                20331600
203317                                                                  20331700
203318                                                                  20331800
203319***************************************************************** 20331900
203320* 3426-INACTIVATE-SHON                                            20332000
203321***************************************************************** 20332100
203322 3426-INACTIVATE-SHON.                                            20332200
203323                                                                  20332300
203324     MOVE PC046-CARTON-ID      TO  SUT00027-SHIPT-UNT-ID          20332400
203325     MOVE 'SHOF'               TO  SUT00027-SCN-CDE               20332500
203326                                                                  20332600
203327                                                                  20332700
203328     EXEC SQL                                                     20332800
203329         UPDATE SUT_OTBND_LOC                                     20332900
203330            SET  ACTV_CDE      =  'I'                             20333000
203340          WHERE  SHIPT_UNT_ID  =  :SUT00027-SHIPT-UNT-ID          20334000
203350            AND  SCN_CDE       =  'SHON'                          20335000
203360     END-EXEC.                                                    20336000
203361                                                                  20336100
203362     EVALUATE TRUE                                                20336200
203363         WHEN SQLCODE = ZERO                                      20336300
203364             CONTINUE                                             20336400
203365         WHEN SQLCODE = -904                                      20336500
203366         WHEN SQLCODE = -913                                      20336600
203367         WHEN SQLCODE = -911                                      20336700
203368             MOVE 8                   TO PV-ERROR-NBR             20336800
203369             SET PS-UPDATE-ROLLBACK TO TRUE                       20336900
203370             PERFORM 9903-WRITE-CICS-LOG                          20337000
203371             PERFORM 9000-SOFT-ABORT                              20337100
203372         WHEN SQLWARN0 NOT = SPACES                               20337200
203373         WHEN SQLCODE NOT EQUAL ZERO                              20337300
203374             SET PS-UPDATE-ROLLBACK TO TRUE                       20337400
203375             MOVE 7                   TO PV-ERROR-NBR             20337500
203376                                         PC033-ERROR-NBR          20337600
203377             PERFORM 9903-WRITE-CICS-LOG                          20337700
203378             MOVE '3426-INACTIVATE-SHON'                          20337800
203379                                      TO PC033-PARAGRAPH          20337900
203380             MOVE 'PCKRF865 - INACTIVATE SCAN ON    '             20338000
203381                                      TO PC033-MESSAGE-TEXT(1)    20338100
203382             MOVE SUT00027-SHIPT-UNT-ID                           20338200
203383                                      TO PC033-MESSAGE-TEXT(2)    20338300
203384             MOVE SQLCA               TO PC033-SQLCA              20338400
203385             MOVE 'SUT00027'          TO PC033-DB2-TABLE-NAME(1)  20338500
203386             SET PC033-ABEND          TO TRUE                     20338600
203387             MOVE 99                  TO PC033-PGM-MSG-NBR        20338700
203388             PERFORM 8210-XCTL-ERROR-SCREEN                       20338800
203389     END-EVALUATE.                                                20338900
203390                                                                  20339000
203391                                                                  20339100
203392***************************************************************** 20339200
203393* 3427-INACTIVATE-DIVERT                                          20339300
203394***************************************************************** 20339400
203395 3427-INACTIVATE-DIVERT.                                          20339500
203396                                                                  20339600
203397     MOVE PC046-CARTON-ID      TO  SUCRDV-SHIPT-UNT-ID            20339700
203398     MOVE PC033-USER-ID        TO  SUCRDV-NACTV-USR-ID            20339800
203399                                                                  20339900
203400     EXEC SQL                                                     20340000
203410         UPDATE TSUCRDV                                           20341000
203411            SET  ACTV_CDE      =  'I'                             20341100
203412              ,  NACTV_USR_ID  =  :SUCRDV-NACTV-USR-ID            20341200
203413          WHERE  SHIPT_UNT_ID  =  :SUCRDV-SHIPT-UNT-ID            20341300
203414     END-EXEC.                                                    20341400
203415                                                                  20341500
203416     EVALUATE TRUE                                                20341600
203417         WHEN SQLCODE = ZERO                                      20341700
203418             CONTINUE                                             20341800
203419         WHEN SQLCODE = -904                                      20341900
203420         WHEN SQLCODE = -913                                      20342000
203421         WHEN SQLCODE = -911                                      20342100
203422             MOVE 8                   TO PV-ERROR-NBR             20342200
203423             SET PS-UPDATE-ROLLBACK TO TRUE                       20342300
203424             PERFORM 9903-WRITE-CICS-LOG                          20342400
203425             PERFORM 9000-SOFT-ABORT                              20342500
203426         WHEN SQLWARN0 NOT = SPACES                               20342600
203427         WHEN SQLCODE NOT EQUAL ZERO                              20342700
203428             SET PS-UPDATE-ROLLBACK TO TRUE                       20342800
203429             MOVE 7                   TO PV-ERROR-NBR             20342900
203430                                         PC033-ERROR-NBR          20343000
203431             PERFORM 9903-WRITE-CICS-LOG                          20343100
203432             MOVE '3427-INACTIVATE-DIVERT'                        20343200
203433                                      TO PC033-PARAGRAPH          20343300
203434             MOVE 'PCKRF865 - INACTIVATE DIVERT     '             20343400
203435                                      TO PC033-MESSAGE-TEXT(1)    20343500
203436             MOVE SUCRDV-SHIPT-UNT-ID                             20343600
203437                                      TO PC033-MESSAGE-TEXT(2)    20343700
203438             MOVE SQLCA               TO PC033-SQLCA              20343800
203439             MOVE 'TSUCRDV'           TO PC033-DB2-TABLE-NAME(1)  20343900
203440             SET PC033-ABEND          TO TRUE                     20344000
203441             MOVE 99                  TO PC033-PGM-MSG-NBR        20344100
203442             PERFORM 8210-XCTL-ERROR-SCREEN                       20344200
203443     END-EVALUATE.                                                20344300
203444                                                                  20344400
203445                                                                  20344500
203446****************************************************************  20344600
203447* 3435-FORMAT-ERROR-MESSAGE                                    *  20344700
203448*                                                              *  20344800
203449****************************************************************  20344900
203450 3435-FORMAT-ERROR-MESSAGE.                                       20345000
203451                                                                  20345100
203452     MOVE DL016-ASGMT-SQLCODE    TO PV-SQLCODE.                   20345200
203453     MOVE PC033-OPER-UNT-ID      TO PV-OPER-UNT-ID-X.             20345300
203454                                                                  20345400
203455     INITIALIZE PV-CICS-MSG-AREA2.                                20345500
203456     STRING ' PCKRF865-3435- '                                    20345600
203457             PV-OPER-UNT-ID-X  '-'                                20345700
203458             PV-MESSAGE-AREA                                      20345800
203459            ' SQLCODE=' PV-SQLCODE                                20345900
203460             DELIMITED BY SIZE                                    20346000
203461             INTO PV-CICS-MSG-AREA2.                              20346100
203462     PERFORM 9903-WRITE-CICS-LOG.                                 20346200
203463                                                                  20346300
203464     INITIALIZE PV-CICS-MSG-AREA2.                                20346400
203465     STRING ' PCKRF865-' DL016-USER-PGM                           20346500
203466            ' -- ' DL016-CALL-MOD-FAIL-SQL-PARA                   20346600
203467            ' -- ' DL016-CALL-MOD-FAIL-NM                         20346700
203468            ' -- ' DL016-CALL-MOD-FAIL-ERR-CDE                    20346800
203469             DELIMITED BY SIZE                                    20346900
203470             INTO PV-CICS-MSG-AREA2.                              20347000
203471     PERFORM 9903-WRITE-CICS-LOG.                                 20347100
203472                                                                  20347200
203473****************************************************************  20347300
203474*    FORMAT BUSINESS EVENTS (PALLET MANUAL) OR (CARTON MANUAL) *  20347400
203475*    BOTH EVENTS GO TO THE PCT00011 AND PCT00012 BUSINESS      *  20347500
203476*    EVENT TABLES.                                             *  20347600
203477*                                                              *  20347700
203478****************************************************************  20347800
203479 3440-CALL-XLKUP033.                                              20347900
203480                                                                  20348000
203481     PERFORM 2235-CALL-ASGMT-SEQ.                                 20348100
203482                                                                  20348200
203483     INITIALIZE XL072-EAI-EXPORT-COMMAREA.                        20348300
203484                                                                  20348400
203485     MOVE PC033-USER-ID     TO XL072-CRE-BY-USR-ID.               20348500
203486     MOVE PC-CURRENT-PROGRAM-NAME TO XL072-CRE-PGM-NM.            20348600
203487     PERFORM 8400-GET-TIMESTAMP.                                  20348700
203488     MOVE PV-CURRENT-TIMESTAMP TO XL072-EVNT-KY-1-TMST.           20348800
203489                                                                  20348900
203490     IF PC242-ADD-CHILD-TO-MASTER                                 20349000
203491                                                                  20349100
203492       MOVE 'ADD CHILD TO MASTER'                                 20349200
203493                         TO XL072-EVNT-OBJ-ACTN-TXT               20349300
203494                                                                  20349400
203495       MOVE PC033-ASGMT-STRT-DTE                                  20349500
203496                         TO PC242-AO-ASGMT-STRT-DTE               20349600
203497       MOVE PC033-ASGMT-NBR-TXT                                   20349700
203498                           TO PC242-AO-ASGMT-NBR-TXT              20349800
203499       MOVE PC033-ASGMT-NBR-SEQ-NBR                               20349900
203500                           TO PC242-AO-ASGMT-NBR-SEQ-NBR          20350000
203501       MOVE DL001-SEQ-START-NBR                                   20350100
203502                           TO PC242-AO-ASGMT-SEQ-DTL-NBR.         20350200
203503                                                                  20350300
203504     IF PC242-ADD-MASTER-TO-MASTER                                20350400
203505                                                                  20350500
203506     MOVE 'ADD MASTER TO MASTER'                                  20350600
203507                         TO XL072-EVNT-OBJ-ACTN-TXT               20350700
203508                                                                  20350800
203509     MOVE PC033-ASGMT-STRT-DTE                                    20350900
203510                         TO PC242-AP-ASGMT-STRT-DTE               20351000
203511     MOVE PC033-ASGMT-NBR-TXT                                     20351100
203512                         TO PC242-AP-ASGMT-NBR-TXT                20351200
203513     MOVE PC033-ASGMT-NBR-SEQ-NBR                                 20351300
203514                         TO PC242-AP-ASGMT-NBR-SEQ-NBR            20351400
203515     MOVE DL001-SEQ-START-NBR                                     20351500
203516                         TO PC242-AP-ASGMT-SEQ-DTL-NBR.           20351600
203517                                                                  20351700
203518     IF PC242-RMVE-CHILD-FROM-MASTER                              20351800
203519                                                                  20351900
203520     MOVE 'REMOVE CHILD FROM MASTER'                              20352000
203521                         TO XL072-EVNT-OBJ-ACTN-TXT               20352100
203522                                                                  20352200
203523     MOVE PC033-ASGMT-STRT-DTE                                    20352300
203524                         TO PC242-AQ-ASGMT-STRT-DTE               20352400
203525     MOVE PC033-ASGMT-NBR-TXT                                     20352500
203526                         TO PC242-AQ-ASGMT-NBR-TXT                20352600
203527     MOVE PC033-ASGMT-NBR-SEQ-NBR                                 20352700
203528                         TO PC242-AQ-ASGMT-NBR-SEQ-NBR            20352800
203529     MOVE DL001-SEQ-START-NBR                                     20352900
203530                         TO PC242-AQ-ASGMT-SEQ-DTL-NBR.           20353000
203531                                                                  20353100
203532     IF PC242-RMVE-MASTER-FROM-MASTER                             20353200
203533                                                                  20353300
203534     MOVE 'REMOVE MASTER FROM MASTER'                             20353400
203535                         TO XL072-EVNT-OBJ-ACTN-TXT               20353500
203536                                                                  20353600
203537     MOVE PC033-ASGMT-STRT-DTE                                    20353700
203538                         TO PC242-AR-ASGMT-STRT-DTE               20353800
203539     MOVE PC033-ASGMT-NBR-TXT                                     20353900
203540                         TO PC242-AR-ASGMT-NBR-TXT                20354000
203541     MOVE PC033-ASGMT-NBR-SEQ-NBR                                 20354100
203542                         TO PC242-AR-ASGMT-NBR-SEQ-NBR            20354200
203543     MOVE DL001-SEQ-START-NBR                                     20354300
203544                         TO PC242-AR-ASGMT-SEQ-DTL-NBR.           20354400
203545                                                                  20354500
203546     IF PC242-REASSIGN-TO-MASTER                                  20354600
203547                                                                  20354700
203548     MOVE 'REASSIGN TO MASTER'                                    20354800
203549                         TO XL072-EVNT-OBJ-ACTN-TXT               20354900
203550                                                                  20355000
203551     MOVE PC033-ASGMT-STRT-DTE                                    20355100
203552                         TO PC242-AS-ASGMT-STRT-DTE               20355200
203553     MOVE PC033-ASGMT-NBR-TXT                                     20355300
203554                         TO PC242-AS-ASGMT-NBR-TXT                20355400
203555     MOVE PC033-ASGMT-NBR-SEQ-NBR                                 20355500
203556                         TO PC242-AS-ASGMT-NBR-SEQ-NBR            20355600
203557     MOVE DL001-SEQ-START-NBR                                     20355700
203558                         TO PC242-AS-ASGMT-SEQ-DTL-NBR.           20355800
203559                                                                  20355900
203560     SET  XL072-PCWS242-COPYBOOK   TO TRUE.                       20356000
203561     SET  XL072-COMMIT-UPDATE      TO TRUE.                       20356100
203562     MOVE PC242-DTL-TXT-AREA       TO XL072-DTL-TXT.              20356200
203563                                                                  20356300
203564     SET  XL072-PC-APP-ID   TO TRUE.                              20356400
203565     MOVE PC-SHIPPING       TO XL072-EVNT-OBJ-TXT.                20356500
203566                                                                  20356600
203567     CALL XL072-USER-PGM USING DFHEIBLK                           20356700
203568                              XL072-COMMAREA                      20356800
203569                              XL072-EAI-EXPORT-COMMAREA.          20356900
203570                                                                  20357000
203571     EVALUATE TRUE                                                20357100
203572         WHEN XL072-SUCCESSFUL                                    20357200
203573              CONTINUE                                            20357300
203574         WHEN OTHER                                               20357400
203575              SET PS-UPDATE-ROLLBACK TO TRUE                      20357500
203576              MOVE PC033-OPER-UNT-ID TO  PV-OPER-UNT-ID-X         20357600
203577              MOVE PC033-ASGMT-NBR-SEQ-NBR TO PV-DISPLAY-SEQ-NBR  20357700
203578              MOVE XL072-EAI-DB-SQLCODE                           20357800
203579                                     TO  PV-SQLCODE               20357900
203580              INITIALIZE PV-CICS-MSG-AREA2                        20358000
203581              STRING ' PCKRF865-3440- '                           20358100
203582                      PV-OPER-UNT-ID-X  '-'                       20358200
203583                      PC033-ASGMT-STRT-DTE  ' - '                 20358300
203584                      PC033-ASGMT-NBR-TXT   ' - '                 20358400
203585                      PV-DISPLAY-SEQ-NBR ' - '                    20358500
203586                      PC033-USER-ID ' - '                         20358600
203587                     'SQLCODE=' PV-SQLCODE                        20358700
203588                     ' - RETURN CODE=' XL072-RETURN-CODE          20358800
203589                                                DELIMITED BY SIZE 20358900
203590                                           INTO PV-CICS-MSG-AREA2 20359000
203591               MOVE LENGTH OF PV-CICS-MSG-AREA2                   20359100
203592                                           TO PV-COMMAREA-LENGTH  20359200
203593               PERFORM 9903-WRITE-CICS-LOG                        20359300
203594                                                                  20359400
203595              INITIALIZE PV-CICS-MSG-AREA2                        20359500
203596              STRING ' PCKRF865-' XL072-USER-PGM                  20359600
203597                      ' -- ' XL072-SQL-ERROR-PARA                 20359700
203598                      ' -- ' XL072-CALL-MOD-FAIL-NM               20359800
203599                      ' -- ' XL072-CALL-MOD-FAIL-ERR-CDE          20359900
203600                                                DELIMITED BY SIZE 20360000
203601                                           INTO PV-CICS-MSG-AREA2 20360100
203602               MOVE LENGTH OF PV-CICS-MSG-AREA2                   20360200
203603                                             TO PV-COMMAREA-LENGTH20360300
203604               PERFORM 9903-WRITE-CICS-LOG                        20360400
203605                                                                  20360500
203606              INITIALIZE PV-CICS-MSG-AREA2                        20360600
203607              STRING ' PCKRF865-' XL072-USER-PGM                  20360700
203608                      ' -- ' XL072-SQLCA                          20360800
203609                                                DELIMITED BY SIZE 20360900
203610                                           INTO PV-CICS-MSG-AREA2 20361000
203611               MOVE LENGTH OF PV-CICS-MSG-AREA2                   20361100
203612                                           TO PV-COMMAREA-LENGTH  20361200
203613               PERFORM 9903-WRITE-CICS-LOG                        20361300
203614                                                                  20361400
203615               MOVE 4                   TO PV-ERROR-NBR           20361500
203616                                           PC033-ERROR-NBR        20361600
203617               PERFORM 9903-WRITE-CICS-LOG                        20361700
203618               MOVE '3445-CALL-XLKUP033'                          20361800
203619                                        TO PC033-PARAGRAPH        20361900
203620               MOVE 'PCKRF865 - CALL XLKUP033 ERROR'              20362000
203621                                        TO PC033-MESSAGE-TEXT(1)  20362100
203622               MOVE SQLCA               TO PC033-SQLCA            20362200
203623               SET PC033-ABEND          TO TRUE                   20362300
203624               MOVE 99                  TO PC033-PGM-MSG-NBR      20362400
203625               PERFORM 8210-XCTL-ERROR-SCREEN                     20362500
203626                                                                  20362600
203627     END-EVALUATE.                                                20362700
203628                                                                  20362800
203629*                                                                 20362900
203630 3500-ADD-CHILD-TO-MSTR.                                          20363000
203631     EXEC SQL                                                     20363100
203632          UPDATE SUT_OTBND_CART                                   20363200
203633          SET                                                     20363300
203634              PRNT_CART_ID = :DK-CARTON                           20363400
203635        WHERE SHIPT_UNT_ID      = :DK-CHILD-CARTON                20363500
203636          AND MSTR_CART_IND     = 'N'                             20363600
203637     END-EXEC.                                                    20363700
203638     EVALUATE TRUE                                                20363800
203639         WHEN SQLCODE = ZERO                                      20363900
203640             PERFORM 2259-SELECT-OTBND-CART                       20364000
203641             IF SUT00024-SHIPT-UNT-ID = SUT00024-PRNT-CART-ID     20364100
203642                PERFORM 2261-GET-CTNS-IN-MASTER                   20364200
203643                MOVE PV-CARTONS-IN-MASTER TO                      20364300
203644                                          ACTNMSTRO               20364400
203645                                          PC033-CTNS-IN-MASTER    20364500
203646             ELSE                                                 20364600
203647                PERFORM 2262-COUNT-CHILDREN-OF-MASTER             20364700
203648                MOVE PV-CHILDRN-IN-MASTER TO                      20364800
203649                                          ACTNMSTRO               20364900
203650                                          PC033-CTNS-IN-MASTER    20365000
203651             END-IF                                               20365100
203652             MOVE DP015-UNP-ALP-NOR-MDT   TO ABRCDEA              20365200
203653             MOVE PC-ADDED-TO-MASTER TO AMSGLNO                   20365300
203654         WHEN SQLCODE = -904                                      20365400
203655         WHEN SQLCODE = -913                                      20365500
203656         WHEN SQLCODE = -911                                      20365600
203657             MOVE 19                  TO PV-ERROR-NBR             20365700
203658             PERFORM 9903-WRITE-CICS-LOG                          20365800
203659             PERFORM 9000-SOFT-ABORT                              20365900
203660         WHEN SQLWARN0 NOT = SPACES                               20366000
203661         WHEN SQLCODE NOT EQUAL ZERO                              20366100
203662             MOVE '3500-ADD-CHILD-TO-MSTR'                        20366200
203663                             TO DP013-PARAGRAPH                   20366300
203664             MOVE 'PCKRF865 - ADD CHILD TO MSTR'                  20366400
203665                             TO DP013-MESSAGE-TEXT(1)             20366500
203666             MOVE SUT00024-SHIPT-UNT-ID                           20366600
203667                             TO DP013-MESSAGE-TEXT(2)             20366700
203668             MOVE SQLCA      TO DP013-SQLCA                       20366800
203669             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           20366900
203670             SET DP013-DB2-ABEND                                  20367000
203671                             TO TRUE                              20367100
203672             SET DP013-ROLLBACK                                   20367200
203673                             TO TRUE                              20367300
203674             SET DP013-XCTL-DISPLAY-RESTART                       20367400
203675                             TO TRUE                              20367500
203676             PERFORM DP014-0000-PROCESS-ABEND                     20367600
203677     END-EVALUATE.                                                20367700
203678*                                                                 20367800
203679***************************************************************** 20367900
203680* POPULATE HOST VARIABLES IN SUT_MSTR_SHIPT_CNT                   20368000
203681* FOR ADD CHILD TO MASTER                                         20368100
203682***************************************************************** 20368200
203683                                                                  20368300
203684     IF PC033-NEW-VERSION                                         20368400
203685       MOVE 'ACM' TO SUT00099-ACTN-TYP-CDE                        20368500
203686       MOVE 'SU' TO SUT00099-CHLD-SHIPT-TYP-CDE                   20368600
203687       INITIALIZE PC242-DTL-TXT-AREA                              20368700
203688       SET PC242-ADD-CHILD-TO-MASTER TO TRUE                      20368800
203689       MOVE +1 TO PV-CHD-SHPT-UNT-ID-NULL                         20368900
203690       MOVE DK-CHILD-CARTON TO SUT00099-CHLD-SHIPT-UNT-ID         20369000
203691       MOVE -1 TO PV-CHD-MST-SHPT-ID-NULL                         20369100
203692       PERFORM 3410-CONT-SHIPT-CNT                                20369200
203693     END-IF.                                                      20369300
203694*                                                                 20369400
203695 3510-ADD-CHILD-TO-MSTR.                                          20369500
203696     EXEC SQL                                                     20369600
203697          UPDATE SUT_OTBND_CART                                   20369700
203698          SET                                                     20369800
203699              PRNT_CART_ID = :DK-CARTON                           20369900
203700        WHERE SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID                20370000
203701          AND MSTR_CART_IND     = 'N'                             20370100
203702     END-EXEC.                                                    20370200
203703     EVALUATE TRUE                                                20370300
203704         WHEN SQLCODE = ZERO                                      20370400
203705             PERFORM 2259-SELECT-OTBND-CART                       20370500
203706             IF SUT00024-SHIPT-UNT-ID = SUT00024-PRNT-CART-ID     20370600
203707                PERFORM 2261-GET-CTNS-IN-MASTER                   20370700
203708                MOVE PV-CARTONS-IN-MASTER TO                      20370800
203709                                          ACTNMSTRO               20370900
203710                                          PC033-CTNS-IN-MASTER    20371000
203711             ELSE                                                 20371100
203712                PERFORM 2262-COUNT-CHILDREN-OF-MASTER             20371200
203713                MOVE PV-CHILDRN-IN-MASTER TO                      20371300
203714                                          ACTNMSTRO               20371400
203715                                          PC033-CTNS-IN-MASTER    20371500
203716             END-IF                                               20371600
203717             MOVE DP015-UNP-ALP-NOR-MDT   TO ABRCDEA              20371700
203718             MOVE PC-ADDED-TO-MASTER TO AMSGLNO                   20371800
203719         WHEN SQLCODE = -904                                      20371900
203720         WHEN SQLCODE = -913                                      20372000
203721         WHEN SQLCODE = -911                                      20372100
203722             MOVE 20                  TO PV-ERROR-NBR             20372200
203723             PERFORM 9903-WRITE-CICS-LOG                          20372300
203724             PERFORM 9000-SOFT-ABORT                              20372400
203725         WHEN SQLWARN0 NOT = SPACES                               20372500
203726         WHEN SQLCODE NOT EQUAL ZERO                              20372600
203727             MOVE '3510-ADD-CHILD-TO-MSTR'                        20372700
203728                             TO DP013-PARAGRAPH                   20372800
203729             MOVE 'PCKRF865 - ADD CHILD TO MSTR'                  20372900
203730                             TO DP013-MESSAGE-TEXT(1)             20373000
203731             MOVE SUT00024-SHIPT-UNT-ID                           20373100
203732                             TO DP013-MESSAGE-TEXT(2)             20373200
203733             MOVE SQLCA      TO DP013-SQLCA                       20373300
203734             MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME(1)           20373400
203735             SET DP013-DB2-ABEND                                  20373500
203736                             TO TRUE                              20373600
203737             SET DP013-ROLLBACK                                   20373700
203738                             TO TRUE                              20373800
203739             SET DP013-XCTL-DISPLAY-RESTART                       20373900
203740                             TO TRUE                              20374000
203741             PERFORM DP014-0000-PROCESS-ABEND                     20374100
203742     END-EVALUATE.                                                20374200
203743*                                                                 20374300
203744***************************************************************** 20374400
203745* POPULATE HOST VARIABLES IN SUT_MSTR_SHIPT_CNT                   20374500
203746* FOR ADD CHILD TO MASTER                                         20374600
203747***************************************************************** 20374700
203748                                                                  20374800
203749     IF PC033-NEW-VERSION                                         20374900
203750       MOVE 'ACM' TO SUT00099-ACTN-TYP-CDE                        20375000
203751       MOVE 'SU' TO SUT00099-CHLD-SHIPT-TYP-CDE                   20375100
203752       INITIALIZE PC242-DTL-TXT-AREA                              20375200
203753       SET PC242-ADD-CHILD-TO-MASTER TO TRUE                      20375300
203754       MOVE +1 TO PV-CHD-SHPT-UNT-ID-NULL                         20375400
203755       MOVE DK-CHILD-CARTON TO SUT00099-CHLD-SHIPT-UNT-ID         20375500
203756       MOVE -1 TO PV-CHD-MST-SHPT-ID-NULL                         20375600
203757       PERFORM 3410-CONT-SHIPT-CNT                                20375700
203758     END-IF.                                                      20375800
203759                                                                  20375900
203760 3600-INACT-DIVERTER-CTN.                                         20376000
203761                                                                  20376100
203762     EXEC SQL                                                     20376200
203763         UPDATE TSUCRDV                                           20376300
203764             SET ACTV_CDE          = 'I'                          20376400
203765             ,   NACTV_USR_ID      = :PC033-USER-ID               20376500
203766         WHERE                                                    20376600
203767             SHIPT_UNT_ID          = :PV-SUCRDV-SHIPT-UNT-ID      20376700
203768     END-EXEC.                                                    20376800
203769                                                                  20376900
203770     EVALUATE TRUE                                                20377000
203780         WHEN SQLCODE = ZERO                                      20378000
203790         WHEN SQLCODE = +100                                      20379000
203800             CONTINUE                                             20380000
203900         WHEN SQLCODE = -904                                      20390000
204000         WHEN SQLCODE = -913                                      20400000
204100         WHEN SQLCODE = -911                                      20410000
204200             MOVE 21                  TO PV-ERROR-NBR             20420000
204300             PERFORM 9903-WRITE-CICS-LOG                          20430000
204400             PERFORM 9000-SOFT-ABORT                              20440000
204500         WHEN SQLWARN0 NOT = SPACES                               20450000
204600         WHEN SQLCODE NOT EQUAL ZERO                              20460000
204700             MOVE '3600-INACT-DIVERTER-CTN'                       20470000
204800                                      TO DP013-PARAGRAPH          20480000
204900             MOVE 'PCKRF865 - UPDATE TSUCRDV ROW'                 20490000
205000                                      TO DP013-MESSAGE-TEXT(1)    20500000
205100             MOVE SQLCA               TO DP013-SQLCA              20510000
205200             MOVE 'TSUCRDV'           TO DP013-DB2-TABLE-NAME(1)  20520000
205300             SET DP013-DB2-ABEND                                  20530000
205400                             TO TRUE                              20540000
205500             SET DP013-ROLLBACK                                   20550000
205600                             TO TRUE                              20560000
205700             SET DP013-XCTL-DISPLAY-RESTART                       20570000
205800                             TO TRUE                              20580000
205900             PERFORM DP014-0000-PROCESS-ABEND                     20590000
206000     END-EVALUATE.                                                20600000
206100                                                                  20610000
206200*                                                                 20620000
206300 4000-XCTL-TO-SELECTED-PROGRAM.                                   20630000
206400     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     20640000
206500     MOVE PC-CURRENT-PROGRAM-NAME TO PC033-LAST-PROGRAM.          20650000
206600                                                                  20660000
206700     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             20670000
206800     EXEC CICS                                                    20680000
206900         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    20690000
207000               COMMAREA  (CA-COMMAREA)                            20700000
207100               LENGTH    (PC-COMMAREA-LENGTH)                     20710000
207200               RESP      (PV-CICS-RESPONSE)                       20720000
207300     END-EXEC.                                                    20730000
207400     EVALUATE TRUE                                                20740000
207500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 20750000
207600             CONTINUE                                             20760000
207700         WHEN OTHER                                               20770000
207800             MOVE '4000-XCTL-TO-SELECTED-PROGRAM'                 20780000
207900                 TO DP013-PARAGRAPH                               20790000
208000             MOVE 'UNABLE TO XCTL TO PROGRAM: '                   20800000
208100                 TO DP013-MESSAGE-TEXT (1)                        20810000
208200             MOVE PV-TRANSFER-PROGRAM                             20820000
208300                 TO DP013-MESSAGE-TEXT (2)                        20830000
208400             SET DP013-CICS-ABEND  TO TRUE                        20840000
208500             SET DP013-NO-ROLLBACK TO TRUE                        20850000
208600             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               20860000
208700             MOVE PC-TRANS-UNAVAILABLE-MSG TO AMSGLNO             20870000
208800             SET PC033-PROCESS-SCREEN TO TRUE                     20880000
208900             PERFORM 8000-SEND-MAP                                20890000
209000             PERFORM 8100-RETURN-TRANID                           20900000
209100     END-EVALUATE.                                                20910000
209200*                                                                 20920000
209300*                                                                 20930000
209400 4500-SETUP-COM-LABEL.                                            20940000
209500                                                                  20950000
209600     PERFORM 2253-GET-DEST-STORE.                                 20960000
209700     PERFORM 2240-VALIDATE-STORE.                                 20970000
209800     PERFORM 2254-GET-DC-LOCATION.                                20980000
209900                                                                  20990000
210000     SET PC140-COMMON-MFST-LBL-NBR TO TRUE.                       21000000
210100                                                                  21010000
210200     SET PC140-SML-REPRINT         TO TRUE.                       21020000
210300                                                                  21030000
210400     MOVE PC-Y                     TO PC140-CRA-DC-SSCC-18-IND.   21040000
210500                                                                  21050000
210600     MOVE PV-STR-NAME-CHAR10-ABBR  TO PC140-SML-STR-NAME.         21060000
210700     MOVE PC-MASTER-CONTAINER      TO PC140-SML-ZNE-LINE-1.       21070000
210800     MOVE SPACES                   TO PC140-SML-ZNE-LINE-2        21080000
210900                                      PC140-SML-ZNE-LINE-3.       21090000
211000                                                                  21100000
211100     MOVE PC-00                    TO PC140-SML-DIVERT-PFX.       21110000
211200     MOVE PV-STORE                 TO PC140-SML-STR-NBR.          21120000
211300     MOVE PC033-OPER-UNT-ID        TO PC140-SML-ORIGIN-DC.        21130000
211400     MOVE PV-MANIFEST-NBR          TO PC140-SML-STRT-MFST-NBR.    21140000
211500                                                                  21150000
211600     MOVE 'MC-'                    TO PC140-SML-TYPE.             21160000
211700     MOVE PV-PRINTER-ID            TO PC140-SML-PRTR-ID.          21170000
211800     MOVE PC-1                     TO PC140-SML-TOT-CART.         21180000
211900                                                                  21190000
212000     PERFORM 4600-PRINT-SML-LABEL.                                21200000
212100*                                                                 21210000
212200*                                                                 21220000
212300 4600-PRINT-SML-LABEL.                                            21230000
212400                                                                  21240000
212500     MOVE PC033-USER-ID          TO PC140-CRA-USERID.             21250000
212600     MOVE 400                    TO PC-COMMAREA-LENGTH.           21260000
212700                                                                  21270000
212800     EXEC CICS                                                    21280000
212900          LINK PROGRAM  ('PCKCS707')                              21290000
213000               COMMAREA (PC140-LABELMST)                          21300000
213100               LENGTH   (PC-COMMAREA-LENGTH)                      21310000
213200               RESP     (PV-CICS-RESPONSE)                        21320000
213300     END-EXEC.                                                    21330000
213400                                                                  21340000
213500     EVALUATE TRUE                                                21350000
213600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 21360000
213700              CONTINUE                                            21370000
213800         WHEN OTHER                                               21380000
213900              PERFORM DP014-0000-PROCESS-ABEND                    21390000
214000     END-EVALUATE.                                                21400000
214100     IF PC140-CRA-SOCKET-COMM-ERROR                               21410000
214200         SET PS-ERROR-YES        TO TRUE                          21420000
214300         MOVE PC-LABEL-PRINT-FAIL TO AMSGLNO                      21430000
214400         MOVE DP015-UNP-ALP-BRT-MDT                               21440000
214500                                 TO APRTRA                        21450000
214600         MOVE -1                 TO APRTRL                        21460000
214700     ELSE                                                         21470000
214800     IF PC140-CRA-INVALID-PRT-FMT                                 21480000
214900         SET PS-ERROR-YES        TO TRUE                          21490000
215000         MOVE DP015-UNP-ALP-BRT-MDT                               21500000
215100                                 TO APRTRA                        21510000
215200         MOVE -1                 TO APRTRL                        21520000
215300*        MOVE PC140-CRA-RET-CDE      TO PM-RET-CDE                21530000
215400*        MOVE PC140-CRA-RET-MSG      TO PM-RET-MSG                21540000
215500     ELSE                                                         21550000
215600         MOVE PC-LABEL-PRINTED   TO AMSGLNO                       21560000
215700         MOVE -1                 TO APRTRL                        21570000
215800     END-IF.                                                      21580000
215900*                                                                 21590000
216000*                                                                 21600000
216100****************************************************************  21610000
216200*    SECURE THE REQUIRED NUMBER OF SEQUENCE NUMBERS.           *  21620000
216300*                                                              *  21630000
216400****************************************************************  21640000
216500 4800-CALL-DLKUP001.                                              21650000
216600                                                                  21660000
216700     SET DL001-BY-ASGMT-KEY                                       21670000
216800         DL001-COMMIT-UPDATE                                      21680000
216900         DL001-FIND-NEXT-ASGMT    TO TRUE.                        21690000
217000                                                                  21700000
217100     MOVE +1 TO DL001-NBR-OF-NBRS-NEED-QTY.                       21710000
217200                                                                  21720000
217300     MOVE PC-CURRENT-PROGRAM-NAME TO DL001-ORIG-CALLING-PGM-NM.   21730000
217400                                                                  21740000
217500     CALL DL001-USER-PGM USING DFHEIBLK                           21750000
217600                              DL001-COMMAREA                      21760000
217700                              DL001-ASGMT-COMMAREA.               21770000
217800                                                                  21780000
217900     EVALUATE TRUE                                                21790000
218000         WHEN DL001-SUCCESSFUL                                    21800000
218100              IF DL001-ASGMT-NEXT-USED                            21810000
218200                 MOVE DL001-NXT-START-DTE                         21820000
218300                               TO PC033-ASGMT-STRT-DTE            21830000
218400                 MOVE DL001-NXT-NBR-TXT                           21840000
218500                               TO PC033-ASGMT-NBR-TXT             21850000
218600                 MOVE DL001-NXT-NBR-SEQ-NBR                       21860000
218700                               TO PC033-ASGMT-NBR-SEQ-NBR         21870000
218800              END-IF                                              21880000
218900                                                                  21890000
219000         WHEN DL001-ASGMT-CLOSED-RETURN                           21900000
219100              CONTINUE                                            21910000
219200                                                                  21920000
219300         WHEN OTHER                                               21930000
219400              SET PS-UPDATE-ROLLBACK TO TRUE                      21940000
219500              MOVE DL001-ASGMT-SQLCODE TO  PV-SQLCODE             21950000
219600              INITIALIZE PV-CICS-MSG-AREA2                        21960000
219700              STRING ' PCKRF865-4800- '                           21970000
219800                     'SQLCODE=' PV-SQLCODE                        21980000
219900                     ' - RETURN CODE=' DL001-RETURN-CODE          21990000
220000                      DELIMITED BY SIZE                           22000000
220100                      INTO PV-CICS-MSG-AREA2                      22010000
220200               MOVE LENGTH OF PV-CICS-MSG-AREA2                   22020000
220300                                             TO PV-COMMAREA-LENGTH22030000
220400               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             22040000
220500                                                                  22050000
220600               INITIALIZE PV-CICS-MSG-AREA2                       22060000
220700               STRING ' PCKRF865-' DL001-USER-PGM                 22070000
220800                      ' -- ' DL001-SQL-ERROR-PARA                 22080000
220900                      ' -- ' DL001-CALL-MOD-FAIL-NM               22090000
221000                      ' -- ' DL001-CALL-MOD-FAIL-ERR-CDE          22100000
221100                       DELIMITED BY SIZE                          22110000
221200                       INTO PV-CICS-MSG-AREA2                     22120000
221300               MOVE LENGTH OF PV-CICS-MSG-AREA2                   22130000
221400                                             TO PV-COMMAREA-LENGTH22140000
221500               PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG             22150000
221600                                                                  22160000
221700     END-EVALUATE.                                                22170000
221800*                                                                 22180000
221801 8000-SEND-MAP.                                                   22180100
221802                                                                  22180200
221803     EXEC CICS                                                    22180300
221804         SEND MAP       ('PC865A')                                22180400
221805              MAPSET    ('PCKM865')                               22180500
221806              ERASE                                               22180600
221807              CURSOR                                              22180700
221808              RESP      (PV-CICS-RESPONSE)                        22180800
221809     END-EXEC.                                                    22180900
221810     EVALUATE TRUE                                                22181000
221811         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22181100
221812             CONTINUE                                             22181200
221813         WHEN OTHER                                               22181300
221814             MOVE '8000-SEND-MAP'      TO DP013-PARAGRAPH         22181400
221815             MOVE 'UNABLE TO SEND MAP' TO DP013-MESSAGE-TEXT (1)  22181500
221816             SET DP013-CICS-ABEND      TO TRUE                    22181600
221817             SET DP013-NO-ROLLBACK     TO TRUE                    22181700
221818             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22181800
221819     END-EVALUATE.                                                22181900
221820*                                                                 22182000
221821*                                                                 22182100
221822 8010-SEND-DATA-ONLY.                                             22182200
221823     EXEC CICS                                                    22182300
221824         SEND MAP       ('PC865A')                                22182400
221825              MAPSET    ('PCKM865')                               22182500
221826              CURSOR                                              22182600
221827              DATAONLY                                            22182700
221828              RESP      (PV-CICS-RESPONSE)                        22182800
221829     END-EXEC.                                                    22182900
221830     EVALUATE TRUE                                                22183000
221831         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22183100
221832             CONTINUE                                             22183200
221833         WHEN OTHER                                               22183300
221834             MOVE '8010-SEND-DATA-ONLY' TO DP013-PARAGRAPH        22183400
221835             MOVE 'UNABLE TO SEND DATA' TO DP013-MESSAGE-TEXT (1) 22183500
221836             SET DP013-CICS-ABEND       TO TRUE                   22183600
221837             SET DP013-NO-ROLLBACK      TO TRUE                   22183700
221838             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22183800
221839     END-EVALUATE.                                                22183900
221840*                                                                 22184000
221841*                                                                 22184100
221842 8020-RECEIVE-MAP.                                                22184200
221843     EXEC CICS                                                    22184300
221844         RECEIVE MAP    ('PC865A')                                22184400
221845                 MAPSET ('PCKM865')                               22184500
221846                 RESP   (PV-CICS-RESPONSE)                        22184600
221847     END-EXEC.                                                    22184700
221848     EVALUATE TRUE                                                22184800
221849         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22184900
221850             PERFORM 2110-RECEIVE-SCREEN-FIELDS                   22185000
221851         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                22185100
221852             CONTINUE                                             22185200
221853         WHEN OTHER                                               22185300
221854            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       22185400
221855            MOVE 'UNABLE TO RECEIVE MAP' TO DP013-MESSAGE-TEXT (1)22185500
221856            SET DP013-LOGIC-ABEND        TO TRUE                  22185600
221857            SET DP013-NO-ROLLBACK        TO TRUE                  22185700
221858            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                22185800
221859     END-EVALUATE.                                                22185900
221860*                                                                 22186000
221870*                                                                 22187000
221880 8100-RETURN-TRANID.                                              22188000
221890     MOVE LENGTH OF CA-COMMAREA TO PC-COMMAREA-LENGTH             22189000
221900     EXEC CICS                                                    22190000
222000         RETURN TRANSID  (PC-TRANID)                              22200000
222100                COMMAREA (CA-COMMAREA)                            22210000
222200                LENGTH   (PC-COMMAREA-LENGTH)                     22220000
222300                RESP     (PV-CICS-RESPONSE)                       22230000
222400     END-EXEC.                                                    22240000
222500     EVALUATE TRUE                                                22250000
222600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22260000
222700             CONTINUE                                             22270000
222800         WHEN OTHER                                               22280000
222900             MOVE '8100-RETURN-TRANID'  TO DP013-PARAGRAPH        22290000
223000             MOVE 'UNABLE TO RETURN TO TRANID'                    22300000
223100                 TO DP013-MESSAGE-TEXT (1)                        22310000
223200             SET DP013-CICS-ABEND       TO TRUE                   22320000
223300             SET DP013-NO-ROLLBACK      TO TRUE                   22330000
223400             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22340000
223500     END-EVALUATE.                                                22350000
223600*                                                                 22360000
223700*                                                                 22370000
223800 8110-RETURN.                                                     22380000
223900     EXEC CICS                                                    22390000
224000         SEND FROM (PV-MESSAGE-AREA)                              22400000
224100              LENGTH (19)                                         22410000
224200              ERASE                                               22420000
224300     END-EXEC.                                                    22430000
224400     EXEC CICS                                                    22440000
224500         RETURN                                                   22450000
224600     END-EXEC.                                                    22460000
224700*                                                                 22470000
224800*                                                                 22480000
224900 8210-XCTL-ERROR-SCREEN.                                          22490000
225000     IF NOT PC033-ABEND                                           22500000
225100         SET PC033-INITIALIZE-SCREEN  TO TRUE                     22510000
225200     END-IF                                                       22520000
225300     MOVE DFHEIBLK                    TO PC033-DFHEIBLK.          22530000
225400     MOVE PC-CURRENT-PROGRAM-NAME     TO PC033-LAST-PROGRAM.      22540000
225500     MOVE LENGTH OF CA-COMMAREA       TO PC-COMMAREA-LENGTH       22550000
225600     MOVE 'PCKRF852'                  TO PV-TRANSFER-PROGRAM      22560000
225700     IF PC033-PGM-MSG-NBR = ZERO                                  22570000
225800         MOVE 3                       TO PC033-PGM-MSG-NBR        22580000
225900     END-IF                                                       22590000
226000                                                                  22600000
226100     EXEC CICS                                                    22610000
226200         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    22620000
226300               COMMAREA  (CA-COMMAREA)                            22630000
226400               LENGTH    (PC-COMMAREA-LENGTH)                     22640000
226500               RESP      (PV-CICS-RESPONSE)                       22650000
226600     END-EXEC.                                                    22660000
226700     EVALUATE TRUE                                                22670000
226800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22680000
226900             CONTINUE                                             22690000
227000         WHEN OTHER                                               22700000
227100             MOVE '8200-XCTL'                                     22710000
227200                                      TO DP013-PARAGRAPH          22720000
227300             MOVE 'PCKRF865 - UNABLE TO XCTL TO PROGRAM: '        22730000
227400                                      TO DP013-MESSAGE-TEXT (1)   22740000
227500             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   22750000
227600             SET DP013-CICS-ABEND                                 22760000
227700                 DP013-ROLLBACK       TO TRUE                     22770000
227800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               22780000
227900             MOVE PC-TRANS-UNAVAILABLE-MSG                        22790000
228000                                      TO AMSGLNO                  22800000
228100             SET PC033-PROCESS-SCREEN TO TRUE                     22810000
228200             MOVE -1                  TO ABRCDEL                  22820000
228300             PERFORM 8000-SEND-MAP                                22830000
228400             PERFORM 8100-RETURN-TRANID                           22840000
228500     END-EVALUATE.                                                22850000
228600*                                                                 22860000
228700*                                                                 22870000
228800 8220-XCTL-TO-HELP.                                               22880000
228900     MOVE LENGTH OF PC192-COMMAREA    TO PC-COMMAREA-LENGTH       22890000
229000                                                                  22900000
229100     EXEC CICS                                                    22910000
229200         XCTL                                                     22920000
229300             PROGRAM   (PV-TRANSFER-PROGRAM)                      22930000
229400             COMMAREA  (PC192-COMMAREA)                           22940000
229500             LENGTH    (PC-COMMAREA-LENGTH)                       22950000
229600             RESP      (PV-CICS-RESPONSE)                         22960000
229700     END-EXEC.                                                    22970000
229800     EVALUATE TRUE                                                22980000
229900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 22990000
230000              CONTINUE                                            23000000
230100         WHEN OTHER                                               23010000
230200             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          23020000
230300             MOVE 'PCKRF865 - UNABLE TO XCTL TO PROGRAM: '        23030000
230400                                      TO DP013-MESSAGE-TEXT (1)   23040000
230500             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   23050000
230600             SET DP013-CICS-ABEND                                 23060000
230700                 DP013-ROLLBACK       TO TRUE                     23070000
230800             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               23080000
230900             MOVE PC-TRANS-UNAVAILABLE-MSG                        23090000
231000                                      TO AMSGLNO                  23100000
231100             SET PC033-PROCESS-SCREEN TO TRUE                     23110000
231200             MOVE -1                  TO ABRCDEL                  23120000
231300             PERFORM 8000-SEND-MAP                                23130000
231400             PERFORM 8100-RETURN-TRANID                           23140000
231500     END-EVALUATE.                                                23150000
231600*                                                                 23160000
231700                                                                  23170000
231800 8400-GET-TIMESTAMP.                                              23180000
231900                                                                  23190000
232000     EXEC SQL                                                     23200000
232100                                                                  23210000
232200         SET :PV-CURRENT-TIMESTAMP  = CURRENT TIMESTAMP           23220000
232300                                                                  23230000
232400     END-EXEC.                                                    23240000
232500                                                                  23250000
232600     EVALUATE SQLCODE                                             23260000
232700         WHEN 0                                                   23270000
232800              CONTINUE                                            23280000
232900         WHEN OTHER                                               23290000
233000             MOVE '8400-GET-TIMESTAMP' TO DP013-PARAGRAPH         23300000
233100             MOVE 'UNABLE TO GET TIMESTAMP'                       23310000
233200                   TO DP013-MESSAGE-TEXT (1)                      23320000
233300             SET DP013-CICS-ABEND       TO TRUE                   23330000
233400             SET DP013-NO-ROLLBACK      TO TRUE                   23340000
233500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               23350000
233600     END-EVALUATE.                                                23360000
233700                                                                  23370000
233701*                                                                 23370100
233702*                                                                 23370200
233703 9000-SOFT-ABORT.                                                 23370300
233704                                                                  23370400
233705     EXEC CICS                                                    23370500
233706         SYNCPOINT ROLLBACK                                       23370600
233707     END-EXEC                                                     23370700
233708                                                                  23370800
233709     MOVE 4                           TO PC033-PGM-MSG-NBR        23370900
233710     MOVE SQLCODE                     TO PC033-SQLCODE            23371000
233711     PERFORM 8210-XCTL-ERROR-SCREEN.                              23371100
233712                                                                  23371200
233713*                                                                 23371300
233714 9010-COMMIT-POINT.                                               23371400
233715                                                                  23371500
233716     EXEC CICS                                                    23371600
233717         SYNCPOINT                                                23371700
233718     END-EXEC.                                                    23371800
233719*                                                                 23371900
233720 9903-WRITE-CICS-LOG.                                             23372000
233721                                                                  23372100
233722     MOVE SQLCODE                     TO PV-SQLCODE               23372200
233723     MOVE PC033-CARTON                TO PV-DISPLAY-SML           23372300
233724                                                                  23372400
233725     EXEC CICS                                                    23372500
233726         WRITEQ TD                                                23372600
233727             QUEUE  ('CSSL')                                      23372700
233728             FROM   (PV-LOG-MSG)                                  23372800
233729             RESP   (PV-CICS-RESPONSE)                            23372900
233730     END-EXEC.                                                    23373000
233740                                                                  23374000
233750                                                                  23375000
233760 9904-WRITE-CRTN-MODULE-MSG.                                      23376000
233770                                                                  23377000
233780     MOVE '3000'                      TO  PV-CTN-PARA             23378000
233790     MOVE PC046-CRA-RET-CDE           TO  PV-CTN-RET-CDE          23379000
233800     MOVE PC046-CRTN-STATUS           TO  PV-CTN-STATUS           23380000
233900     MOVE PC046-CRTN-STAT-DESC        TO  PV-CTN-STAT-DESC        23390000
234000     MOVE PC046-TRLR-SRL              TO  PV-CTN-TRLR-SERIAL      23400000
234100     MOVE PC046-OTBD-TRIP-ID          TO  PV-CTN-TRIP             23410000
234200     MOVE PC046-TRIP-STATUS           TO  PV-CTN-TRIP-STAT        23420000
234300     MOVE PC046-STATUS-USERID         TO  PV-CTN-STAT-USERID      23430000
234400                                                                  23440000
234500     EXEC CICS                                                    23450000
234600         WRITEQ TD                                                23460000
234700             QUEUE  ('CSSL')                                      23470000
234800             FROM   (PV-CARTON-MSG)                               23480000
234900             RESP   (PV-CICS-RESPONSE)                            23490000
235000     END-EXEC.                                                    23500000
235100                                                                  23510000
235200     EXEC CICS                                                    23520000
235300         WRITEQ TD                                                23530000
235400             QUEUE  ('CSSL')                                      23540000
235500             FROM   (PC046-CRA-RET-MSG)                           23550000
235600             RESP   (PV-CICS-RESPONSE)                            23560000
235700     END-EXEC.                                                    23570000
235800*                                                                 23580000
235900 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  23590000
236000     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              23600000
236100     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             23610000
236200     INITIALIZE DP013-SRC-TASK-NUMBER                             23620000
236300                DP013-STACK.                                      23630000
236400     SET DP013-LINK-RETURN TO TRUE.                               23640000
236500                                                                  23650000
236600     EXEC CICS                                                    23660000
236700         LINK                                                     23670000
236800             PROGRAM   (DP013-NAME)                               23680000
236900             COMMAREA  (DP013-PARAMETERS)                         23690000
237000             LENGTH    (DP013-LENGTH)                             23700000
237100     END-EXEC.                                                    23710000
237200                                                                  23720000
237300* ABEND PROCESSOR MODULE                                          23730000
237400     COPY DPPD014.                                                23740000
