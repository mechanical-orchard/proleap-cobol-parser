000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.             CEKCS609.                                00020000
000300 AUTHOR.                 BUDDY BARNES.                            00030000
000400 INSTALLATION.           KOHLS.                                   00040000
000500 DATE-WRITTEN.           JAN, 2000.                               00050000
000600 DATE-COMPILED.                                                   00060000
000700                                                                  00070000
000800******************************************************************00080000
000900* THIS PROGRAM PRODUCES A COMMON WORKSHEET USED TO DO THE         00090000
001000* PHYSICAL PICKING OF MERCHANDISE OUT OF CENTRAL STOCK.  THIS     00100000
001100* WORKSHEET WILL REPLACE THE FOLLOWING THREE TYPES OF CENTRAL     00110000
001200* STOCK PULL REQUESTS:                                            00120000
001300*     - CENTRAL STOCK DISTRIBUTION REQUEST FOR MANUAL ORDER       00130000
001400*     - INFOREM SYSTEM REQUESTS                                   00140000
001500*     - ADAM SYSTEM ALLOCATION CS PULL WORKSHEET                  00150000
001600*                                                                 00160000
001700* THIS PROGRAM WILL LINK TO THE DYNAMIC REPORT SYSTEM(DRS) TO     00170000
001800* DO THE ACUTAL PRINTING OF THE WORKSHEET.                        00180000
001900*                                                                 00190000
002000*            * * *   I M P O R T A N T   * * *                    00200000
002100* IN ADDITION, THIS PROGRAM USES AN 'AFP' PAGEDEF AND FORMDEF.    00210000
002200* BECAUSE OF THIS, ANY CHANGES MADE TO THE PHYSICAL PRINTING OF   00220000
002300* THE WORKSHEET SHOULD BE VERIFIED SO THAT FIELDS PRINT WHERE     00230000
002400* THEY ARE SUPPOSED TO, MOST IMPORTANTLY THE BARCODE FIELD.  ANY  00240000
002500* CHANGES MADE MAY REQUIRE CHANGES TO THE PAGEDEF OR FORMDEF      00250000
002600* (KHTR10).                                                       00260000
002610*---------------------------------------------------------------* 00261099
002620*                                                               * 00262099
002630* CHANGE HISTORY:                                               * 00263099
002640* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES         * 00264099
002650* ------- ---------- ----------- -------------------------------- 00265099
002660* WR38216 04-26-2010 C. TWIEHAUS  EFC1-2 TRANSFERS - recompiled   00266099
002661*                                 for copybook CEWS004 change     00266199
002670*---------------------------------------------------------------* 00267099
002700******************************************************************00270000
002800                                                                  00280000
002900******************************************************************00290000
003000 ENVIRONMENT DIVISION.                                            00300000
003100******************************************************************00310000
003200******************************************************************00320000
003300 DATA DIVISION.                                                   00330000
003400******************************************************************00340000
003500******************************************************************00350000
003600 WORKING-STORAGE SECTION.                                         00360000
003700******************************************************************00370000
003800                                                                  00380000
003900******************************************************************00390000
004000*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00400000
004100******************************************************************00410000
004200     COPY DPWS013.                                                00420000
004300                                                                  00430000
004400******************************************************************00440000
004500*  LAYOUT FOR THE STANDARD KOHLS COMMUNCATIONS AREA               00450000
004600******************************************************************00460000
004700     COPY DPWS020.                                                00470000
004800                                                                  00480000
004900******************************************************************00490000
005000*  RECORD LAYOUT FOR THE CENTRAL STOCK COMMAREA.                * 00500000
005100******************************************************************00510000
005200     COPY CEWS004.                                                00520000
005300                                                                  00530099
005400******************************************************************00540000
005500*  RECORD LAYOUT FOR logistics domain item access module        * 00550000
005600*****************************************************WR/IR# 230ZZ*00560099
005700     COPY XLWS001.                                                00570099
006500                                                                  00650000
006501******************************************************************00650199
006502*  RECORD LAYOUT FOR STORE DOMAIN MODULE                        * 00650200
006503*****************************************************WR/IR# 230ZZ*00650399
006504     COPY XLWS071.                                                00650499
006505                                                                  00650500
006600******************************************************************00660000
006700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE FASHION SALES      00670000
006800*  SKU TABLE.                  WR/IR# 230ZZ                       00680099
006900******************************************************************00690000
007000*    EXEC SQL                                                     00700000
007100*         INCLUDE TSK                                             00710000
007200*    END-EXEC.                                                    00720000
007300*                                                                 00730000
007400******************************************************************00740000
007500*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE EXTERNAL ENTITY    00750000
007600*  NAME TABLE.                                                    00760000
007700******************************************************************00770000
007800     EXEC SQL                                                     00780000
007900          INCLUDE TENTNME                                         00790000
008000     END-EXEC.                                                    00800000
008100                                                                  00810000
008200******************************************************************00820000
008300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CENTRAL STOCK      00830000
008400*  PULL REQUEST TABLE.                                            00840000
008500******************************************************************00850000
008600     EXEC SQL                                                     00860000
008700          INCLUDE TCEPLRQ                                         00870000
008800     END-EXEC.                                                    00880000
008900                                                                  00890000
009000******************************************************************00900000
009100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CENTRAL STOCK      00910000
009200*  PULL REQUEST LOCATION ITEM.                                    00920000
009300******************************************************************00930000
009400     EXEC SQL                                                     00940000
009500         INCLUDE TCEPLIT                                          00950000
009600     END-EXEC.                                                    00960000
009700                                                                  00970000
009800******************************************************************00980000
009900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CENTRAL STOCK      00990000
010000*  PULL REQUEST STATUS.                                           01000000
010100******************************************************************01010000
010200     EXEC SQL                                                     01020000
010300         INCLUDE TCEPLST                                          01030000
010400     END-EXEC.                                                    01040000
010500                                                                  01050000
010600******************************************************************01060000
010700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CENTRAL STOCK      01070000
010800*  PULL REQUEST ITEM STORE.                                       01080000
010900******************************************************************01090000
011000     EXEC SQL                                                     01100000
011100         INCLUDE TCEPLDS                                          01110000
011200     END-EXEC.                                                    01120000
011300                                                                  01130000
011400******************************************************************01140000
011500*  COMMUNICATIONS AREA FOR DB2                                    01150000
011600******************************************************************01160000
011700     EXEC SQL                                                     01170000
011800         INCLUDE SQLCA                                            01180000
011900     END-EXEC.                                                    01190000
012000                                                                  01200000
012100 01  DK-DB2-KEYS.                                                 01210000
012200     05  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    01220000
012300                                                    COMP.         01230000
012400     05  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    01240000
012500                                                    COMP.         01250000
012600     05  DK-STAT-CDE                    PIC  X(02)  VALUE SPACES. 01260000
012800                                                                  01280000
012900 01  RL1-REPRINT-LINE-1.                                          01290000
013000     05  FILLER                          PIC X(19)   VALUE        01300000
013100         'R E P R I N T  **  '.                                   01310000
013200     05  FILLER                          PIC X(19)   VALUE        01320000
013300         'R E P R I N T  **  '.                                   01330000
013400     05  FILLER                          PIC X(19)   VALUE        01340000
013500         'R E P R I N T  **  '.                                   01350000
013600     05  FILLER                          PIC X(19)   VALUE        01360000
013700         'R E P R I N T  **  '.                                   01370000
013800     05  FILLER                          PIC X(19)   VALUE        01380000
013900         'R E P R I N T  **  '.                                   01390000
014000     05  FILLER                          PIC X(19)   VALUE        01400000
014100         'R E P R I N T  **  '.                                   01410000
014200     05  FILLER                          PIC X(18)   VALUE        01420000
014300         'R E P R I N T  ** '.                                    01430000
014400                                                                  01440000
014500 01  HL1-HEADING-LINE-1.                                          01450000
014600     05  FILLER                          PIC  X(01)  VALUE SPACE. 01460000
014700     05  HL1-PULL-STATUS                 PIC  X(21)  VALUE SPACE. 01470000
014800     05  FILLER                          PIC  X(27)  VALUE SPACE. 01480000
014900     05  FILLER                          PIC  X(34)  VALUE        01490000
015000         'CENTRAL STOCK ALLOCATION WORKSHEET'.                    01500000
015100     05  FILLER                          PIC  X(49)  VALUE SPACE. 01510000
015200                                                                  01520000
015300 01  HL2-HEADING-LINE-2.                                          01530000
015400     05  FILLER                          PIC  X(01)  VALUE SPACE. 01540000
015500     05  FILLER                          PIC  X(07)  VALUE        01550000
015600         'VENDOR:'.                                               01560000
015700     05  FILLER                          PIC  X(01)  VALUE SPACE. 01570000
015800     05  HL2-VENDOR                      PIC  X(30)  VALUE SPACE. 01580000
015900     05  FILLER                          PIC  X(93)  VALUE SPACE. 01590000
016000                                                                  01600000
016100 01  HL3-HEADING-LINE-3.                                          01610000
016200     05  FILLER                          PIC  X(01)  VALUE SPACE. 01620000
016300     05  FILLER                          PIC  X(25)  VALUE        01630000
016400         'SKU NUMBER .............:'.                             01640000
016500     05  FILLER                          PIC  X(02)  VALUE SPACE. 01650000
016600*    REMOVED DEPT/CLASS                             WR/IR# 230ZZ *01660099
016700*    05  HL3-DEPT-NBR                    PIC  X(03)  VALUE SPACE. 01670099
016800*    05  FILLER                          PIC  X(01)  VALUE '-'.   01680000
016900*    05  HL3-CLASS-NBR                   PIC  X(02)  VALUE SPACE. 01690000
017000*    05  FILLER                          PIC  X(01)  VALUE '-'.   01700000
017100     05  HL3-SEQ-NBR                     PIC  X(08)  VALUE SPACE. 01710000
017200*    05  FILLER                          PIC  X(09)  VALUE SPACE. 01720000
017300     05  FILLER                          PIC  X(11)  VALUE SPACE. 01730099
017400     05  FILLER                          PIC  X(25)  VALUE        01740000
017500         'CS PULL NUMBER - LINE ..:'.                             01750000
017600     05  FILLER                          PIC  X(02)  VALUE SPACE. 01760000
017700     05  HL3-PULL-NUMBER                 PIC  9(05)  VALUE ZEROS. 01770000
017800     05  FILLER                          PIC  X(01)  VALUE '-'.   01780000
017900     05  HL3-LINE-NUMBER                 PIC  9(03)  VALUE ZEROS. 01790000
018000     05  FILLER                          PIC  X(12)  VALUE SPACE. 01800000
018100     05  FILLER                          PIC  X(18)  VALUE        01810000
018200         'CS REF NUMBER ...:'.                                    01820000
018300     05  FILLER                          PIC  X(02)  VALUE SPACE. 01830000
018400     05  HL3-REF-NUMBER                  PIC  X(15)  VALUE SPACE. 01840000
018500     05  FILLER                          PIC  X(02)  VALUE SPACE. 01850000
018600                                                                  01860000
018700 01  HL4-HEADING-LINE-4.                                          01870000
018800     05  FILLER                          PIC  X(01)  VALUE SPACE. 01880000
018900     05  FILLER                          PIC  X(25)  VALUE        01890000
019000         'SKU DESCRIPTION ........:'.                             01900000
019100     05  FILLER                          PIC  X(02)  VALUE SPACE. 01910000
019200     05  HL4-SKU-DESC                    PIC  X(15)  VALUE SPACE. 01920000
019300     05  FILLER                          PIC  X(04)  VALUE SPACE. 01930000
019400     05  FILLER                          PIC  X(25)  VALUE        01940000
019500         'CS PULL CREATE DATE ....:'.                             01950000
019600     05  FILLER                          PIC  X(02)  VALUE SPACE. 01960000
019700     05  HL4-PULL-TIMESTAMP              PIC  X(10)  VALUE SPACE. 01970000
019800     05  FILLER                          PIC  X(11)  VALUE SPACE. 01980000
019900     05  FILLER                          PIC  X(18)  VALUE        01990000
020000         'CS PULL SRC CD ..:'.                                    02000000
020100     05  FILLER                          PIC  X(02)  VALUE SPACE. 02010000
020200     05  HL4-PULL-SRC-CD                 PIC  X(10)  VALUE SPACE. 02020000
020300     05  FILLER                          PIC  X(07)  VALUE SPACE. 02030000
020400                                                                  02040000
020500 01  HL5-HEADING-LINE-5.                                          02050000
020600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02060000
020700     05  FILLER                          PIC  X(25)  VALUE        02070000
020800         'SKU STYLE ..............:'.                             02080000
020900     05  FILLER                          PIC  X(02)  VALUE SPACE. 02090000
021000     05  HL5-SKU-STYLE                   PIC  X(15)  VALUE SPACE. 02100000
021100     05  FILLER                          PIC  X(04)  VALUE SPACE. 02110000
021200     05  FILLER                          PIC  X(25)  VALUE        02120000
021300         'CS PULL CREATE USER ....:'.                             02130000
021400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02140000
021500     05  HL5-PULL-USER                   PIC  X(08)  VALUE SPACE. 02150000
021600     05  FILLER                          PIC  X(13)  VALUE SPACE. 02160000
021700     05  FILLER                          PIC  X(18)  VALUE        02170000
021800         'CS REQ PULL UNITS:'.                                    02180000
021900     05  FILLER                          PIC  X(02)  VALUE SPACE. 02190000
022000     05  HL5-PULL-TOTAL                  PIC  Z(10)  VALUE ZEROS. 02200000
022100     05  FILLER                          PIC  X(07)  VALUE SPACE. 02210000
022200                                                                  02220000
022300 01  HL6-HEADING-LINE-6.                                          02230000
022400     05  FILLER                          PIC  X(01)  VALUE SPACE. 02240000
022500     05  FILLER                          PIC  X(25)  VALUE        02250000
022600         'SKU RETAIL .............:'.                             02260000
022700     05  FILLER                          PIC  X(02)  VALUE SPACE. 02270000
022800     05  HL6-RETAIL                      PIC  $$,$$$.$$.          02280000
022900     05  FILLER                          PIC  X(10)  VALUE SPACE. 02290000
023000     05  FILLER                          PIC  X(25)  VALUE        02300000
023100         'CS LOCATION ............:'.                             02310000
023200     05  FILLER                          PIC  X(02)  VALUE SPACE. 02320000
023300     05  HL6-LOCATION                    PIC  X(20)  VALUE SPACE. 02330000
023400*JPL 2/28 - added sku qty per carton.                             02340000
023500     05  FILLER                          PIC  X(01)  VALUE SPACE. 02350000
023600     05  FILLER                          PIC  X(19)  VALUE        02360000
023700         'SKU QTY PER CARTON:'.                                   02370000
023800     05  FILLER                          PIC  X(01)  VALUE SPACE. 02380000
023900     05  HL6-SKU-QTY                     PIC  Z(10)  VALUE ZEROS. 02390000
024000     05  FILLER                          PIC  X(07)  VALUE SPACE. 02400000
024100                                                                  02410000
024200*JPL 2/28 - added solid line for detail.                          02420000
024300 01  DL-DETAIL-SOLIDLINE.                                         02430000
024400     05  FILLER                          PIC  X(01)  VALUE SPACE. 02440000
024500     05  FILLER                          PIC  X(124) VALUE        02450000
024600                                                     ALL '_'.     02460000
024700     05  FILLER                          PIC  X(07)  VALUE SPACE. 02470000
024800                                                                  02480000
024900 01  DH1-DETAIL-HEADING-LINE-1.                                   02490000
025000     05  FILLER                          PIC  X(01)  VALUE '|'.   02500000
025100     05  FILLER                          PIC  X(17)  VALUE        02510000
025200         ' STORE     QTY  |'.                                     02520000
025300     05  FILLER                          PIC  X(01)  VALUE SPACE. 02530000
025400     05  FILLER                          PIC  X(17)  VALUE        02540000
025500         ' STORE     QTY  |'.                                     02550000
025600     05  FILLER                          PIC  X(01)  VALUE SPACE. 02560000
025700     05  FILLER                          PIC  X(17)  VALUE        02570000
025800         ' STORE     QTY  |'.                                     02580000
025900     05  FILLER                          PIC  X(01)  VALUE SPACE. 02590000
026000     05  FILLER                          PIC  X(17)  VALUE        02600000
026100         ' STORE     QTY  |'.                                     02610000
026200     05  FILLER                          PIC  X(01)  VALUE SPACE. 02620000
026300     05  FILLER                          PIC  X(17)  VALUE        02630000
026400         ' STORE     QTY  |'.                                     02640000
026500     05  FILLER                          PIC  X(01)  VALUE SPACE. 02650000
026600     05  FILLER                          PIC  X(17)  VALUE        02660000
026700         ' STORE     QTY  |'.                                     02670000
026800     05  FILLER                          PIC  X(01)  VALUE SPACE. 02680000
026900     05  FILLER                          PIC  X(17)  VALUE        02690000
027000         ' STORE     QTY  |'.                                     02700000
027100     05  FILLER                          PIC  X(05)  VALUE SPACE. 02710000
027200                                                                  02720000
027300 01  DL-DETAIL-LINE.                                              02730000
027400     05  FILLER                          PIC  X(01)  VALUE '|'.   02740000
027500     05  DL-DTL-LNE-AREA                 OCCURS 7 TIMES           02750000
027600                                            INDEXED BY            02760000
027700                                            DL-DTL-LNE-IDX.       02770000
027800         10  DL-STR-NBR                  PIC  ZZZZ.               02780000
027900         10  FILLER                      PIC  X(01)  VALUE SPACE. 02790000
028000         10  DL-ARROWS                   PIC  X(04).              02800000
028100         10  FILLER                      PIC  X(01)  VALUE SPACE. 02810000
028200         10  DL-QTY                      PIC  ZZZZZ.              02820000
028300         10  FILLER                      PIC  X(01)  VALUE SPACE. 02830000
028400         10  DL-BAR-LINE                 PIC  X(01).              02840000
028500         10  FILLER                      PIC  X(01)  VALUE SPACE. 02850000
028600     05  FILLER                          PIC  X(05)  VALUE SPACE. 02860000
028700                                                                  02870000
028800 01  DL-DETAIL-UNDERLINE.                                         02880000
028900     05  FILLER                          PIC  X(01)  VALUE '|'.   02890000
029000     05  FILLER                          PIC  X(016)              02900000
029100                                            VALUE ALL '_'.        02910000
029200     05  FILLER                          PIC  X(01)  VALUE '|'.   02920000
029300     05  FILLER                          PIC  X(017)              02930000
029400                                            VALUE ALL '_'.        02940000
029500     05  FILLER                          PIC  X(01)  VALUE '|'.   02950000
029600     05  FILLER                          PIC  X(017)              02960000
029700                                            VALUE ALL '_'.        02970000
029800     05  FILLER                          PIC  X(01)  VALUE '|'.   02980000
029900     05  FILLER                          PIC  X(017)              02990000
030000                                            VALUE ALL '_'.        03000000
030100     05  FILLER                          PIC  X(01)  VALUE '|'.   03010000
030200     05  FILLER                          PIC  X(017)              03020000
030300                                            VALUE ALL '_'.        03030000
030400     05  FILLER                          PIC  X(01)  VALUE '|'.   03040000
030500     05  FILLER                          PIC  X(017)              03050000
030600                                            VALUE ALL '_'.        03060000
030700     05  FILLER                          PIC  X(01)  VALUE '|'.   03070000
030800     05  FILLER                          PIC  X(017)              03080000
030900                                            VALUE ALL '_'.        03090000
031000     05  FILLER                          PIC  X(01)  VALUE '|'.   03100000
031100     05  FILLER                          PIC  X(06)  VALUE SPACE. 03110000
031200                                                                  03120000
031300 01  FL-FOOTER-LINE-HR.                                           03130000
031400     05  FILLER                          PIC  X(56)  VALUE SPACE. 03140000
031500     05  FILLER                          PIC  X(56)  VALUE SPACE. 03150000
031600***  05  FL-PULL-NUMBER-HR               PIC  X(09)  VALUE SPACE. 03160000
031700***  05  FILLER                          PIC  X(11)  VALUE SPACE. 03170000
031800     05  FL-PULL-NUMBER-HR               PIC  X(07)  VALUE SPACE. 03180000
031900     05  FILLER                          PIC  X(13)  VALUE SPACE. 03190000
032000                                                                  03200000
032100******************************************************************03210000
032200*             * * *    I M P O R T A N T   * * *                  03220000
032300*  BE VERY CAREFUL THAT ANY CHANGES MADE TO THE PHYSICAL PRINTING 03230000
032400*  OF THE REPORT  DO NOT AFFECT WHERE THE FOLLOWING LINE PRINTS.  03240000
032500*  THE PRINT LINE MUST BE IN A SPECIFIC PLACE IN THE OUTPUT IN    03250000
032600*  ORDER FOR THE BARCODE TO PRINT.                                03260000
032700******************************************************************03270000
032800 01  FL-FOOTER-LINE-BC.                                           03280000
032900     05  FILLER                          PIC  X(51)  VALUE SPACE. 03290000
033000***  05  FL-PULL-NUMBER                  PIC  X(11)  VALUE SPACE. 03300000
033100***  05  FILLER                          PIC  X(06)  VALUE SPACE. 03310000
033200***  05  FL-PULL-NUMBER                  PIC  X(09)  VALUE SPACE. 03320000
033300***  05  FILLER                          PIC  X(08)  VALUE SPACE. 03330000
033400     05  FL-PULL-NUMBER                  PIC  X(06)  VALUE SPACE. 03340000
033500     05  FILLER                          PIC  X(11)  VALUE SPACE. 03350000
033600     05  FILLER                          PIC  X(09)  VALUE SPACE. 03360000
033700     05  FILLER                          PIC  X(55)  VALUE SPACE. 03370000
033800                                                                  03380000
033900 01  FL-FOOTER-LINE-1.                                            03390000
034000     05  FILLER                          PIC  X(01)  VALUE SPACE. 03400000
034100     05  FILLER                          PIC  X(05)  VALUE        03410000
034200         'NAME '.                                                 03420000
034300     05  FILLER                          PIC  X(30)               03430000
034400                                            VALUE ALL '_'.        03440000
034500     05  FILLER                          PIC  X(02)  VALUE SPACE. 03450000
034600     05  FILLER                          PIC  X(05)  VALUE        03460000
034700         'DATE '.                                                 03470000
034800     05  FILLER                          PIC  X(15)               03480000
034900                                            VALUE ALL '_'.        03490000
035000     05  FILLER                          PIC  X(10)  VALUE SPACE. 03500000
035100     05  FILLER                          PIC  X(23)  VALUE        03510000
035200         'TOTAL STORES FOR PULL :'.                               03520000
035300     05  FILLER                          PIC  X(02)  VALUE SPACE. 03530000
035400     05  FL1-TOTAL-STORES                PIC  Z(04).              03540000
035500     05  FILLER                          PIC  X(35)  VALUE SPACE. 03550000
035600                                                                  03560000
035700 01  FL-FOOTER-LINE-2.                                            03570000
035800     05  FILLER                          PIC  X(68)  VALUE SPACE. 03580000
035900     05  FILLER                          PIC  X(23)  VALUE        03590000
036000         'TOTAL STORE DIST UNITS:'.                               03600000
036100     05  FILLER                          PIC  X(02)  VALUE SPACE. 03610000
036200     05  FL2-TOTAL-DIST-UNITS            PIC  Z(04).              03620000
036300     05  FILLER                          PIC  X(35)  VALUE SPACE. 03630000
036400                                                                  03640000
036500 01  FL-FOOTER-LINE-3.                                            03650000
036600     05  FILLER                          PIC  X(68)  VALUE SPACE. 03660000
036700     05  FILLER                          PIC  X(05)  VALUE        03670000
036800         'PAGE '.                                                 03680000
036900     05  FL3-CUR-PAGE                    PIC  Z(02).              03690000
037000     05  FILLER                          PIC  X(04)  VALUE        03700000
037100         ' OF '.                                                  03710000
037200     05  FL3-TOT-PAGE                    PIC  Z(02).              03720000
037300     05  FILLER                          PIC  X(41)  VALUE SPACE. 03730000
037400                                                                  03740000
037500 01  DL-BLANK-LINE.                                               03750000
037600     05  FILLER                          PIC  X(132) VALUE SPACE. 03760000
037700                                                                  03770000
037800 01  PC-PROGRAM-CONSTANTS.                                        03780000
037900     05  PC-CEKCS600                     PIC  X(08)  VALUE        03790000
038000                                                     'CEKCS600'.  03800000
038100     05  PC-CEKCS601                     PIC  X(08)  VALUE        03810000
038200                                                     'CEKCS601'.  03820000
038300     05  PC-CEKCS602                     PIC  X(08)  VALUE        03830000
038400                                                     'CEKCS602'.  03840000
038500     05  PC-CEKCS604                     PIC  X(08)  VALUE        03850000
038600                                                     'CEKCS604'.  03860000
038700     05  PC-CEKCS611                     PIC  X(08)  VALUE        03870000
038800                                                     'CEKCS611'.  03880000
038900     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        03890000
039000                                                     'CEKCS609'.  03900000
039100     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     03910000
039200                                                     COMP SYNC.   03920000
039300     05  PC-PUT                          PIC  X(03)  VALUE 'PUT'. 03930000
039400     05  PC-INIT                         PIC  X(04) VALUE 'INIT'. 03940000
039500     05  PC-TERM                         PIC  X(04) VALUE 'TERM'. 03950000
039600     05  PC-OUTP                         PIC  X(04) VALUE 'OUTP'. 03960000
039700     05  PC-PAGEDEF-FORMDEF              PIC  X(06) VALUE         03970000
039800                                              'KHTR10'.           03980000
039900     05  PC-TOP-OF-PAGE                  PIC  X(01)  VALUE '1'.   03990000
040000     05  PC-SINGLE-SPACE                 PIC  X(01)  VALUE ' '.   04000000
040100                                                                  04010000
040200***  05  PC-START-CHAR                   PIC X(01) VALUE '‡'.     04020000
040300***  05  PC-START-VALUE                  PIC 9(03) VALUE 103.     04030000
040400     05  PC-START-CHAR                   PIC X(01) VALUE ''.     04040000
040500     05  PC-START-VALUE                  PIC 9(03) VALUE 105.     04050000
040600     05  PC-STOP-CHAR                    PIC X(01) VALUE ''.     04060000
040700                                                                  04070000
040800 01  PS-PROGRAM-SWITCHES.                                         04080000
040900     05  PS-REPRINT-SW                   PIC  X(01)  VALUE 'N'.   04090000
041000         88  PS-REPRINT                              VALUE 'Y'.   04100000
041100     05  PS-ERROR-PRINT-SW               PIC  X(01)  VALUE 'N'.   04110000
041200         88  PS-ERROR-PRINT                          VALUE 'Y'.   04120000
041300     05  PS-CHECK-DIGIT                  PIC  X(01)  VALUE 'N'.   04130000
041400         88  PS-CHECK-DIGIT-NOT-FOUND                VALUE 'Y'.   04140000
041500     05  PS-UPDATES-ERROR-SW             PIC  X(01)  VALUE 'N'.   04150000
041600         88  PS-UPDATE-ERROR                         VALUE 'Y'.   04160000
041700         88  PS-UPDATE-NO-ERROR                      VALUE 'N'.   04170000
041800     05  PS-TOP-OF-PAGE-SET-SW           PIC  X(01)  VALUE 'Y'.   04180000
041900         88  PS-TOP-OF-PAGE-SET                      VALUE 'Y'.   04190000
042000         88  PS-TOP-OF-PAGE-NOT-SET                  VALUE 'N'.   04200000
042100     05  PS-TCEPLIT-CURSOR-SW            PIC  X(01)  VALUE 'N'.   04210000
042200         88  PS-EOF-TCEPLIT-CSR                      VALUE 'Y'.   04220000
042300     05  PS-TCEPLDS-CURSOR-SW            PIC  X(01)  VALUE 'N'.   04230000
042400         88  PS-NOT-EOF-TCEPLDS-CSR                  VALUE 'N'.   04240000
042500         88  PS-EOF-TCEPLDS-CSR                      VALUE 'Y'.   04250000
042600                                                                  04260000
042700 01  PS-PROGRAM-SUBSCRIPTS.                                       04270000
042800     05  PS-DTL-LNE-SUB                  PIC S9(04)  VALUE +0     04280000
042900                                                     COMP SYNC.   04290000
043000                                                                  04300000
043100 01  PV-PROGRAM-VARIABLES.                                        04310000
043200     05  PV-TABLE-STORE-COUNT            PIC S9(05)  VALUE ZERO   04320000
043300                                                     COMP-3.      04330000
043400     05  PV-TOTAL-DIST-UNITS             PIC S9(05)  VALUE ZERO   04340000
043500                                                     COMP-3.      04350000
043600     05  PV-STRS-PER-PAGE                PIC S9(04)  VALUE +154   04360000
043700                                                     COMP SYNC.   04370000
043800     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  04380000
043900                                                     COMP SYNC.   04390000
044000     05  PV-RETRY-COUNTER                PIC S9(04)  VALUE ZERO   04400000
044100                                                     COMP SYNC.   04410000
044200     05  PV-COUNT                        PIC S9(09)  VALUE ZERO   04420000
044300                                                     COMP-3.      04430000
044400     05  PV-REC-TMST.                                             04440000
044500         10  PV-REC-YYYY                 PIC  X(04).              04450000
044600         10  FILLER                      PIC  X(01).              04460000
044700         10  PV-REC-MM                   PIC  X(02).              04470000
044800         10  FILLER                      PIC  X(01).              04480000
044900         10  PV-REC-DD                   PIC  X(02).              04490000
045000     05  PV-R-DATE.                                               04500000
045100         10  PV-R-MM                     PIC  X(02).              04510000
045200         10  FILLER                      PIC  X(01)  VALUE '-'.   04520000
045300         10  PV-R-DD                     PIC  X(02).              04530000
045400         10  FILLER                      PIC  X(01)  VALUE '-'.   04540000
045500         10  PV-R-YYYY                   PIC  X(04).              04550000
045600***  05  PV-PULL-NUMBER.                                          04560000
045700***      10  FILLER                      PIC  9(04)  VALUE ZERO.  04570000
045800***      10  PV-PULL-NUMBER-5-9          PIC  9(05)  VALUE ZERO.  04580000
045900     05  PV-PULL-NUMBER.                                          04590000
046000         10  FILLER                      PIC  9(04)  VALUE ZERO.  04600000
046100         10  PV-PULL-NUMBER-5-9.                                  04610000
046200             15  PV-PULL-NUMBER-5-6      PIC  9(02)  VALUE ZERO.  04620000
046300             15  PV-PULL-NUMBER-7-9      PIC  9(03)  VALUE ZERO.  04630000
046400     05  PV-TEMP-SEQ-NBR                 PIC  9(08)  VALUE ZEROS. 04640000
046500     05  PV-LINE-NUMBER                  PIC  9(04)  VALUE ZEROS. 04650000
046600     05  FILLER  REDEFINES  PV-LINE-NUMBER.                       04660000
046700         10  FILLER                      PIC  9(01).              04670000
046800         10  PV-LINE-NUMBER-2-4          PIC  9(03).              04680000
046900***  05  PV-BARCODE.                                              04690000
047000***      10  PV-BARCODE-PULL-NUMBER      PIC  X(05)  VALUE SPACE. 04700000
047100***      10  PV-BARCODE-LINE-NUMBER      PIC  X(03)  VALUE SPACE. 04710000
047200***  05  PV-BARCODE.                                              04720000
047300***      10  PV-BARCODE-PULL-NUMBER      PIC  X(03)  VALUE SPACE. 04730000
047400***      10  PV-BARCODE-LINE-NUMBER      PIC  X(03)  VALUE SPACE. 04740000
047500     05  PV-BARCODE                      PIC X(04).               04750000
047600***                                                               04760000
047700***                                                               04770000
047800     05  PV-TEST-BARCODE                 PIC X(06)   VALUE        04780000
047900       'm'.                                                  04790000
048000*    05  PV-TEST-BARCODE                 PIC X(07)   VALUE        04800000
048100*      ':n'.                                                 04810000
048200***                                                               04820000
048300***                                                               04830000
048400***                                                               04840000
048500     05  PV-DISP-LINE-NUMBER             PIC  9(04)  VALUE ZEROS. 04850000
048600     05  FILLER  REDEFINES  PV-DISP-LINE-NUMBER.                  04860000
048700         10  FILLER                      PIC  9(01).              04870000
048800         10  PV-DISP-LINE-NUMBER-2-4     PIC  9(03).              04880000
048900     05  PV-ENT-ID                       PIC  9(09)  VALUE ZERO.  04890000
049000     05  PV-ITEM-NUMBER                  PIC  9(15)  VALUE ZERO.  04900000
049400     05  PV-NULL-IND-1                   PIC S9(04)  VALUE +0     04940000
049500                                                     COMP.        04950000
049600     05  PV-NULL-IND-2                   PIC S9(04)  VALUE +0     04960000
049700                                                     COMP.        04970000
049800     05  PV-LINE-COUNT                   PIC  9(02)  VALUE ZEROS. 04980000
049900*jpl 05  PV-LINES-PER-PAGE               PIC  9(02)  VALUE 58.    04990000
050000     05  PV-LINES-PER-PAGE               PIC  9(02)  VALUE 60.    05000000
050100     05  PV-BLANK-LINES                  PIC  9(02)  VALUE ZEROS. 05010000
050200     05  PV-CURRENT-PAGE                 PIC  9(02)  VALUE ZEROS. 05020000
050300     05  PV-TOTAL-PAGES                  PIC  9(02)  VALUE ZEROS. 05030000
050400     05  PV-CICS-RESP                    PIC S9(8)   VALUE ZERO   05040000
050500                                                     COMP SYNC.   05050000
050600     05  PV-RETRY-COUNT                  PIC  S9(4)  VALUE ZERO   05060000
050700                                                     COMP SYNC.   05070000
050800     05  PV-CURRENT-DATE-X.                                       05080000
050900         10  PV-CURRENT-CENTURY-YEAR     PIC  9(04)  VALUE ZEROS. 05090000
051000         10  FILLER                      PIC  X(01)  VALUE '-'.   05100000
051100         10  PV-CURRENT-MONTH            PIC  9(02)  VALUE ZEROS. 05110000
051200         10  FILLER                      PIC  X(01)  VALUE '-'.   05120000
051300         10  PV-CURRENT-DAY              PIC  9(02)  VALUE ZEROS. 05130000
051400     05  PV-CURRENT-DATE  REDEFINES  PV-CURRENT-DATE-X            05140000
051500                                         PIC  X(10).              05150000
051600     05  PV-DRS-ABEND-DISPLAY-LINE1.                              05160000
051700         10  FILLER                      PIC  X(14)  VALUE        05170000
051800             'DRRB ID = DRRB'.                                    05180000
051900         10  FILLER                      PIC  X(02)  VALUE SPACE. 05190000
052000         10  FILLER                      PIC  X(12)  VALUE        05200000
052100             'DRRB FUNC = '.                                      05210000
052200         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 05220000
052300         10  FILLER                      PIC  X(02)  VALUE SPACE. 05230000
052400         10  FILLER                      PIC  X(11)  VALUE        05240000
052500             'DRRB RID = '.                                       05250000
052600         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 05260000
052700         10  FILLER                      PIC  X(02)  VALUE SPACE. 05270000
052800         10  FILLER                      PIC  X(15)  VALUE        05280000
052900             'DRRB OPTIONS = '.                                   05290000
053000         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 05300000
053100     05  PV-DRS-ABEND-DISPLAY-LINE2.                              05310000
053200         10  FILLER                      PIC  X(10)  VALUE        05320000
053300             'DRRB RC = '.                                        05330000
053400         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 05340000
053500         10  FILLER                      PIC  X(02)  VALUE SPACE. 05350000
053600         10  FILLER                      PIC  X(18)  VALUE        05360000
053700             'DRRB ATTR-ERROR = '.                                05370000
053800         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 05380000
053900         10  FILLER                      PIC  X(02)  VALUE SPACE. 05390000
054000         10  FILLER                      PIC  X(12)  VALUE        05400000
054100             'DRRB DRDC = '.                                      05410000
054200         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 05420000
054300         10  FILLER                      PIC  X(02)  VALUE SPACE. 05430000
054400         10  FILLER                      PIC  X(13)  VALUE        05440000
054500             'DRRB LINES = '.                                     05450000
054600         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 05460000
054700                                                                  05470000
054800     05  PV-CHECK-DIGIT                  PIC  X(01).              05480000
054900     05  PV-QUOTIENT                     PIC  9(05)  VALUE ZERO.  05490000
055000     05  PV-REMAINDER                    PIC  9(03)  VALUE ZERO.  05500000
055100     05  PV-ACCUM-TOTAL                  PIC  9(07)  VALUE ZERO.  05510000
055200     05  PV-ENTRY-TOTAL                  PIC  9(07)  VALUE ZERO.  05520000
055300     05  PV-NBR-OF-CHARS                 PIC  9(02)  VALUE 4.     05530000
055400***  05  PV-NBR-OF-CHARS                 PIC  9(02)  VALUE 8.     05540000
055500***  05  PV-NBR-OF-CHARS                 PIC  9(02)  VALUE 8.     05550000
055600     05  PV-ENTRY                        PIC  9(02)  VALUE ZERO.  05560000
055700     05  PV-IN-DATA.                                              05570000
055800         10  PV-IN-CHAR    OCCURS 04 TIMES INDEXED BY IN-INDX     05580000
055900                                         PIC X(01).               05590000
056000***  05  PV-IN-DATA.                                              05600000
056100***      10  PV-IN-CHAR    OCCURS 06 TIMES INDEXED BY IN-INDX     05610000
056200***                                      PIC X(01).               05620000
056300***  05  PV-IN-DATA.                                              05630000
056400***      10  PV-IN-CHAR    OCCURS 08 TIMES INDEXED BY IN-INDX     05640000
056500***                                      PIC X(01).               05650000
056600                                                                  05660000
056700 01  ST-SYSTEM-TIME-DATE-AREA.                                    05670000
056800     05  ST-ABSTIME                      PIC S9(15)  VALUE ZERO   05680000
056900                                                     COMP-3.      05690000
057000     05  ST-SYSTEM-TIME.                                          05700000
057100         10  ST-HHMMSS-FORMAT            PIC  X(08)  VALUE SPACE. 05710000
057200         10  FILLER  REDEFINES  ST-HHMMSS-FORMAT.                 05720000
057300             15  ST-SYSTEM-HOUR          PIC  X(02).              05730000
057400             15  FILLER                  PIC  X(01).              05740000
057500             15  ST-SYSTEM-MINUTE        PIC  X(02).              05750000
057600             15  FILLER                  PIC  X(01).              05760000
057700             15  ST-SYSTEM-SECOND        PIC  X(02).              05770000
057800     05  SD-SYSTEM-DATE.                                          05780000
057900         10  SD-MMDDYY-FORMAT            PIC  X(08)  VALUE SPACE. 05790000
058000         10  FILLER  REDEFINES  SD-MMDDYY-FORMAT.                 05800000
058100             15  SD-SYSTEM-MONTH         PIC  X(02).              05810000
058200             15  FILLER                  PIC  X(01).              05820000
058300             15  SD-SYSTEM-DAY           PIC  X(02).              05830000
058400             15  FILLER                  PIC  X(01).              05840000
058500             15  SD-SYSTEM-YEAR          PIC  X(02).              05850000
058600         10  FILLER                      PIC  X(02)  VALUE SPACE. 05860000
058700     05  FILLER  REDEFINES  SD-SYSTEM-DATE.                       05870000
058800         10  FILLER                      PIC  X(06).              05880000
058900         10  SD-SYSTEM-CENTURY-YEAR      PIC  9(04).              05890000
059000     05  SD-YYYY-FORMAT                  PIC S9(09)  VALUE +0     05900000
059100                                                     COMP.        05910000
059200                                                                  05920000
059300 01  STORE-DISTRIBUTION-TABLE.                                    05930000
059400     05  ST-STORE-ENTRY                  OCCURS 9999              05940000
059500                                         ASCENDING KEY IS         05950000
059600                                            ST-STR-NBR            05960000
059700                                         INDEXED BY ST-STR-IDX.   05970000
059800         10  ST-STR-NBR                  PIC 9(04).               05980000
059900         10  ST-PULL-QTY                 PIC 9(05).               05990000
060000                                                                  06000000
060100******************************************************************06010000
060200*  THE PROGRAM TABLE CONTAINS 107 ENTRIES. EACH ENTRY CONTAINS    06020000
060300*  A CODE VALUE FROM 000 TO 106 AND THE EBCDIC HEX VALUE THAT     06030000
060400*  CORRESPONDS TO THAT CODE VALUE.                                06040000
060500******************************************************************06050000
060600 01  PT-PROGRAM-TABLE.                                            06060000
060700     05                                  PIC X(40)   VALUE        06070000
060800         '000 001!002"003#004$005%006&007''008(009)'.             06080000
060900     05                                  PIC X(40)   VALUE        06090000
061000         '010*011+012,013-014.015/0160017101820193'.              06100000
061100     05                                  PIC X(40)   VALUE        06110000
061200         '020402150226023702480259026:027;028<029='.              06120000
061300     05                                  PIC X(40)   VALUE        06130000
061400         '030>031?032@033A034B035C036D037E038F039G'.              06140000
061500     05                                  PIC X(40)   VALUE        06150000
061600         '040H041I042J043K044L045M046N047O048P049Q'.              06160000
061700     05                                  PIC X(40)   VALUE        06170000
061800         '050R051S052T053U054V055W056X057Y058Z059['.              06180000
061900     05                                  PIC X(40)   VALUE        06190000
062000         '060\061]062^063_064`065a066b067c068d069e'.              06200000
062100     05                                  PIC X(40)   VALUE        06210000
062200         '070f071g072h073i074j075k076l077m078n079o'.              06220000
062300     05                                  PIC X(40)   VALUE        06230000
062400         '080p081q082r083s084t085u086v087w088x089y'.              06240000
062500     05                                  PIC X(40)   VALUE        06250000
062600         '090z091{092|093}094~095096€097098099'.              06260000
062700     05                                  PIC X(28)   VALUE        06270000
062800         '100101…102103‡104ˆ105106'.                          06280000
062900 01  PT-PROGRAM-TABLE-REDEF REDEFINES PT-PROGRAM-TABLE.           06290000
063000     05  PT-ENTRY          OCCURS 107 TIMES INDEXED BY PT-INDX.   06300000
063100         10  PT-VALUE                    PIC 9(03).               06310000
063200         10  PT-CHAR                     PIC X(01).               06320000
063300                                                                  06330000
063400******************************************************************06340000
063500*  WORKING STORAGE LAYOUT FOR STANDARD KOHLS PRINT HEADINGS       06350000
063600******************************************************************06360000
063700     COPY DPWS132.                                                06370000
063800                                                                  06380000
063900******************************************************************06390000
064000*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            06400000
064100******************************************************************06410000
064200     COPY DRRD003.                                                06420000
064300                                                                  06430000
064400******************************************************************06440000
064500*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) OUTPUT BLOCK        06450000
064600******************************************************************06460000
064700     COPY DRRD005.                                                06470000
064800                                                                  06480000
064900******************************************************************06490000
065000*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) INIT BLOCK          06500000
065100******************************************************************06510000
065200     COPY DRRD006.                                                06520000
065300                                                                  06530000
065400*---------------------------------------------------------------* 06540000
065500*    LINE ITEM CURSOR                                           * 06550000
065600*---------------------------------------------------------------* 06560000
065700     EXEC SQL                                                     06570000
065800          DECLARE LINE-ITEM-CSR CURSOR FOR                        06580000
065900              SELECT  PL_LNE_NBR                                  06590000
066000                     ,ITM_NBR                                     06600000
066100                     ,PL_REQ_QTY                                  06610000
066200                     ,ACTL_PL_QTY                                 06620000
066300                     ,STAT_CDE                                    06630000
066400                     ,UNT_RTL_AMT                                 06640000
066500                FROM  TCEPLIT                                     06650000
066600               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          06660000
066700                 AND  PL_LNE_NBR      >= :DK-LINE-NUMBER          06670000
066800                 AND  STAT_CDE    NOT IN ('PD', 'DS')             06680000
066900            ORDER BY  PL_LNE_NBR                                  06690000
067000     END-EXEC.                                                    06700000
067100                                                                  06710000
067200*---------------------------------------------------------------* 06720000
067300*    LINE ITEM DISTRIBUTION CURSOR                              * 06730000
067400*---------------------------------------------------------------* 06740000
067500     EXEC SQL                                                     06750000
067600          DECLARE LINE-ITEM-DSTR-CSR CURSOR FOR                   06760000
067700              SELECT  STR_NBR                                     06770000
067800                     ,REQ_ORD_QTY                                 06780000
067900                     ,ACTL_DISTRB_QTY                             06790000
068000                FROM  TCEPLDS                                     06800000
068100               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          06810000
068200                 AND  PL_LNE_NBR       = :DK-LINE-NUMBER          06820000
068300            ORDER BY  STR_NBR                                     06830000
068400     END-EXEC.                                                    06840000
068500                                                                  06850000
068600******************************************************************06860000
068700 LINKAGE SECTION.                                                 06870000
068800******************************************************************06880000
068900 01  DFHCOMMAREA.                                                 06890000
069000     05  FILLER                       OCCURS 1 TO 600 TIMES       06900000
069100                                      DEPENDING ON EIBCALEN.      06910000
069200         10  FILLER                   PIC X.                      06920000
069300                                                                  06930000
069400 PROCEDURE DIVISION.                                              06940000
069500     PERFORM 0100-INITIALIZE.                                     06950000
069600     PERFORM 0200-INITIALIZE-PRTR.                                06960000
069700                                                                  06970000
069800     IF CE004-FROM-STARTED-TASK                                   06980000
069900         MOVE 'CEKCS611'          TO CE004-USER-ID                06990000
070000     END-IF.                                                      07000000
070100     MOVE CE004-PULL-NBR          TO DK-PULL-NUMBER               07010000
070200                                     PV-PULL-NUMBER.              07020000
070300     MOVE CE004-LINE-NBR          TO DK-LINE-NUMBER               07030000
070400                                     PV-LINE-NUMBER.              07040000
070500                                                                  07050000
070600     PERFORM 3500-GET-STORE-INFORMATION.                          07060000
070700     PERFORM 4000-SELECT-TCEPLRQ.                                 07070000
070800     PERFORM 4010-OPEN-CURSOR-TCEPLIT.                            07080000
070900     PERFORM 4030-FETCH-CURSOR-TCEPLIT                            07090000
071000         UNTIL  PS-EOF-TCEPLIT-CSR.                               07100000
071100     PERFORM 4020-CLOSE-CURSOR-TCEPLIT.                           07110000
071200                                                                  07120000
071300     IF CEPLRQ-STAT-CDE = 'NW'                                    07130000
071400         MOVE 'IP'                TO DK-STAT-CDE                  07140000
071500         MOVE 0                   TO DK-LINE-NUMBER               07150000
071600         MOVE 0                   TO PV-LINE-NUMBER               07160000
071700         PERFORM 4060-INSERT-TCEPLST                              07170000
071800         MOVE 'IP'                TO DK-STAT-CDE                  07180000
071900         PERFORM 4070-UPDATE-TCEPLRQ                              07190000
072000     END-IF.                                                      07200000
072100                                                                  07210000
072200     IF PS-UPDATE-NO-ERROR                                        07220000
072300         EXEC CICS SYNCPOINT                                      07230000
072400         END-EXEC                                                 07240000
072500         SET CE004-PRT-SUCCESSFUL     TO TRUE                     07250000
072600     ELSE                                                         07260000
072700         EXEC CICS SYNCPOINT ROLLBACK                             07270000
072800         END-EXEC                                                 07280000
072900         SET CE004-PRT-INVALID        TO TRUE                     07290000
073000     END-IF.                                                      07300000
073100                                                                  07310000
073200     MOVE 'TERM'                  TO DRS01-DRRB-FUNC.             07320000
073300     PERFORM 8000-LINK-TO-DRS.                                    07330000
073400                                                                  07340000
073500     MOVE CE004-COMMAREA-REC      TO DFHCOMMAREA.                 07350000
073600                                                                  07360000
073700 0000-GOBACK.                                                     07370000
073800     GOBACK.                                                      07380000
073900                                                                  07390000
074000 0100-INITIALIZE.                                                 07400000
074100     MOVE DFHCOMMAREA             TO CE004-COMMAREA-REC.          07410000
074200     IF EIBCALEN = 0                                              07420000
074300         EXEC CICS RETRIEVE                                       07430000
074400                   INTO     (CE004-COMMAREA-REC)                  07440000
074500                   RESP     (PV-CICS-RESPONSE)                    07450000
074600         END-EXEC                                                 07460000
074700                                                                  07470000
074800         EVALUATE TRUE                                            07480000
074900             WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)             07490000
075000                 CONTINUE                                         07500000
075100             WHEN OTHER                                           07510000
075200                 MOVE '0100-INITIALIZE'                           07520000
075300                                  TO DP013-PARAGRAPH              07530000
075400                 MOVE 'RETRIEVE AS STARTED TASK FROM CEKCS611'    07540000
075500                                  TO DP013-MESSAGE-TEXT(1)        07550000
075600                 SET DP013-LINK-RETURN                            07560000
075700                     DP013-CICS-ABEND                             07570000
075800                     DP013-NO-ROLLBACK TO TRUE                    07580000
075900                 PERFORM DP013-0000-PROCESS-ABEND                 07590000
076000         END-EVALUATE                                             07600000
076100     END-IF.                                                      07610000
076200                                                                  07620000
076300* SETUP DATE AND TIME FOR REPORT HEADERS                          07630000
076400     EXEC CICS                                                    07640000
076500         ASKTIME ABSTIME (ST-ABSTIME)                             07650000
076600     END-EXEC.                                                    07660000
076700     EXEC CICS                                                    07670000
076800         FORMATTIME ABSTIME  (ST-ABSTIME)                         07680000
076900                    MMDDYY   (SD-MMDDYY-FORMAT)                   07690000
077000                    DATESEP                                       07700000
077100                    TIME     (ST-HHMMSS-FORMAT)                   07710000
077200                    TIMESEP                                       07720000
077300     END-EXEC.                                                    07730000
077400     EXEC CICS                                                    07740000
077500         FORMATTIME ABSTIME  (ST-ABSTIME)                         07750000
077600                       YEAR  (SD-YYYY-FORMAT)                     07760000
077700     END-EXEC.                                                    07770000
077800     MOVE SD-YYYY-FORMAT          TO PV-CURRENT-CENTURY-YEAR.     07780000
077900     MOVE SD-SYSTEM-MONTH         TO PV-CURRENT-MONTH.            07790000
078000     MOVE SD-SYSTEM-DAY           TO PV-CURRENT-DAY.              07800000
078100                                                                  07810000
078200*----------------------------------------------------------------*07820000
078300* INITIALIZE PRINTER TO DRS.                                      07830000
078400*----------------------------------------------------------------*07840000
078500 0200-INITIALIZE-PRTR.                                            07850000
078600     MOVE PC-OUTP                 TO DRS05-DRRB-FUNC.             07860000
078700     MOVE 'ADD'                   TO DRS05-DROB-FUNCTION.         07870000
078800     MOVE 'CEPLDROB'              TO DRS05-DROB-OUTPUT-ID.        07880000
078900     MOVE PC-PAGEDEF-FORMDEF      TO DRS05-DROB-FORMDEF           07890000
079000                                     DRS05-DROB-PAGEDEF.          07900000
079100     MOVE 'A'                     TO DRS05-DROB-CLASS             07910000
079200                                     DRS06-DRIB-CLASS.            07920000
079300     MOVE 'N'                     TO DRS06-DRIB-HOLD.             07930000
079400     MOVE CE004-CS-PRINTER-ID     TO DRS06-DRIB-DEST.             07940000
079500     MOVE CE004-CS-PRINTER-ID     TO DRS05-DROB-DESTINATION.      07950000
079600     PERFORM 8050-LINK-TO-DRS.                                    07960000
079700                                                                  07970000
079800     MOVE 'CEPLDROB'              TO DRS06-DRIB-OUTPUT-STMT-NAME. 07980000
079900     MOVE 'Y'                     TO DRS06-DRIB-EXTN-IND.         07990000
080000     MOVE PC-INIT                 TO DRS01-DRRB-FUNC.             08000000
080100     MOVE DRS06-DRIB-HEADER       TO DRS01-COMM-DRIB-HDR.         08010000
080200     MOVE DRS06-DRIB-ATTRIB       TO DRS01-COMM-DRIB-AT1.         08020000
080300     MOVE '0200-INIT-PRINTER'     TO DP013-PARAGRAPH.             08030000
080400     PERFORM 8000-LINK-TO-DRS.                                    08040000
080500                                                                  08050000
080600     MOVE PC-PUT                  TO DRS01-DRRB-FUNC.             08060000
085600                                                                  08560000
085700                                                                  08570099
085800****************************************************************  08580099
085900*    THIS PARAGRAPH RETRIEVES THE STORE INFORMATION.           *  08590099
086000*                                                              *  08600099
086100****************************************************************  08610099
086200 3500-GET-STORE-INFORMATION.                                      08620099
086300                                                                  08630099
086400     INITIALIZE XL071-COMMAREA.                                   08640099
086500     MOVE CE004-CS-LOCATION TO XL071-LOCATION-NUMBER.             08650099
086600                                                                  08660099
086700     CALL XL071-LOCATION-MODULE USING                             08670099
086800                                DFHEIBLK                          08680099
086900                                XL071-COMMAREA                    08690099
087000                                XL071-COMMAREA-REC.               08700099
087100                                                                  08710099
087200     EVALUATE TRUE                                                08720099
087300         WHEN XL071-NO-ERRORS                                     08730099
087400              CONTINUE                                            08740099
087500                                                                  08750099
087600         WHEN XL071-LOC-NOT-FOUND                                 08760099
087700                 STRING '** UNKNOWN ** - '                        08770099
087800                        XL071-LOCATION-NUMBER  DELIMITED BY SIZE  08780099
087900                                      INTO XL071-LOC-NM           08790099
088000                                                                  08800099
088100         WHEN OTHER                                               08810099
088200              MOVE '3500-GET-STORE-INFORMATION'                   08820099
088300                                  TO DP013-PARAGRAPH              08830099
088400              MOVE 'VERIFY LOCATION IS CENTRAL STOCK'             08840099
088500                                  TO DP013-MESSAGE-TEXT (1)       08850099
088600              STRING ' LOCATION - '                               08860099
088700                      XL071-LOCATION-NUMBER                       08870099
088800                      DELIMITED BY SIZE                           08880099
088900                      INTO DP013-MESSAGE-TEXT (2)                 08890099
089000              MOVE XL071-SQLCODE TO SQLCODE                       08900099
089100              MOVE XL071-SQLCA   TO DP013-SQLCA                   08910099
089200              MOVE 'XLT_LOC ' TO DP013-DB2-TABLE-NAME (1)         08920099
089300              SET DP013-DB2-ABEND                                 08930099
089400                  DP013-XCTL-DISPLAY-RESTART TO TRUE              08940099
089500              PERFORM DP013-0000-PROCESS-ABEND                    08950099
089600                                                                  08960099
089700     END-EVALUATE.                                                08970099
089701                                                                  08970199
089702                                                                  08970200
089703*----------------------------------------------------------------*08970300
089704* SELECT FROM TCEPLRQ.                                           *08970400
089705*----------------------------------------------------------------*08970500
089706 4000-SELECT-TCEPLRQ.                                             08970600
089707     PERFORM                                                      08970700
089708         WITH TEST AFTER                                          08970800
089709         VARYING PV-RETRY-COUNTER                                 08970900
089710         FROM 1 BY 1                                              08971000
089711         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               08971100
089712                   OR (SQLCODE = ZERO OR SQLCODE = +100))         08971200
089713                                                                  08971300
089714         EXEC SQL SELECT                                          08971400
089715                    SRC_REF_NBR                                   08971500
089716                   ,SRC_TYP_CDE                                   08971600
089717                   ,STAT_CDE                                      08971700
089718                 INTO :CEPLRQ-SRC-REF-NBR                         08971800
089719                   ,  :CEPLRQ-SRC-TYP-CDE                         08971900
089720                   ,  :CEPLRQ-STAT-CDE                            08972000
089721                 FROM TCEPLRQ                                     08972100
089722             WHERE CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER            08972200
089723         END-EXEC                                                 08972300
089724                                                                  08972400
089725         EVALUATE TRUE                                            08972500
089800             WHEN SQLCODE = ZERO                                  08980000
089900             WHEN SQLCODE = -911                                  08990000
090000             WHEN SQLCODE = -913                                  09000000
090100                 CONTINUE                                         09010000
090200             WHEN SQLCODE = +100                                  09020000
090300                 MOVE '* UNKNOWN *'   TO CEPLRQ-SRC-REF-NBR       09030000
090400             WHEN SQLWARN0 NOT = SPACES                           09040000
090500             WHEN SQLCODE < +0                                    09050000
090600             WHEN SQLCODE > +0                                    09060000
090700             MOVE '4000-SELECT-TCEPLRQ'                           09070000
090800                                  TO DP013-PARAGRAPH              09080000
090900             STRING 'SELECT FROM TCEPLRQ FOR PULL NBR = '         09090000
091000                                  DELIMITED BY SIZE               09100000
091100                    PV-PULL-NUMBER                                09110000
091200                                  DELIMITED BY SIZE               09120000
091300                                INTO DP013-MESSAGE-TEXT (1)       09130000
091400             MOVE SQLCA           TO DP013-SQLCA                  09140000
091500             MOVE 'TCEPLRQ'       TO DP013-DB2-TABLE-NAME (1)     09150000
091600             SET DP013-DB2-ABEND                                  09160000
091700                 DP013-XCTL-DISPLAY-RESTART TO TRUE               09170000
091800             PERFORM DP013-0000-PROCESS-ABEND                     09180000
091900         END-EVALUATE                                             09190000
092000     END-PERFORM.                                                 09200000
092100                                                                  09210000
092200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09220000
092300         MOVE '4000-SELECT-TCEPLRQ'                               09230000
092400                                  TO DP013-PARAGRAPH              09240000
092500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     09250000
092600                                  TO DP013-MESSAGE-TEXT (1)       09260000
092700         STRING 'SELECT FROM TCEPLRQ FOR PULL NBR = '             09270000
092800                                  DELIMITED BY SIZE               09280000
092900                PV-PULL-NUMBER                                    09290000
093000                                  DELIMITED BY SIZE               09300000
093100                                INTO DP013-MESSAGE-TEXT (2)       09310000
093200         MOVE SQLCA               TO DP013-SQLCA                  09320000
093300         MOVE 'TCEPLRQ '          TO DP013-DB2-TABLE-NAME (1)     09330000
093400         SET DP013-DB2-ABEND                                      09340000
093500             DP013-XCTL-DISPLAY-RESTART                           09350000
093600                                  TO TRUE                         09360000
093700         PERFORM DP013-0000-PROCESS-ABEND                         09370000
093800     END-IF.                                                      09380000
093900                                                                  09390000
094000*----------------------------------------------------------------*09400000
094100* OPEN THE TCEPLIT  CURSOR.                                      *09410000
094200*----------------------------------------------------------------*09420000
094300 4010-OPEN-CURSOR-TCEPLIT.                                        09430000
094400     PERFORM                                                      09440000
094500         WITH TEST AFTER                                          09450000
094600         VARYING PV-RETRY-COUNTER                                 09460000
094700         FROM 1 BY 1                                              09470000
094800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09480000
094900                   OR (SQLCODE = ZERO))                           09490000
095000                                                                  09500000
095100         EXEC SQL                                                 09510000
095200              OPEN LINE-ITEM-CSR                                  09520000
095300         END-EXEC                                                 09530000
095400                                                                  09540000
095500         EVALUATE TRUE                                            09550000
095600             WHEN SQLCODE = ZERO                                  09560000
095700             WHEN SQLCODE = -904                                  09570000
095800             WHEN SQLCODE = -913                                  09580000
095900                 CONTINUE                                         09590000
096000             WHEN SQLWARN0 NOT = SPACES                           09600000
096100             WHEN SQLCODE < ZERO                                  09610000
096200             WHEN SQLCODE > ZERO                                  09620000
096300                 MOVE '4010-OPEN-CURSOR'                          09630000
096400                                  TO DP013-PARAGRAPH              09640000
096500                 MOVE 'OPEN TCEPLIT CURSOR - '                    09650000
096600                                  TO DP013-MESSAGE-TEXT (1)       09660000
096700                 STRING 'OPEN ON TCEPLIT CSR FOR PULL NBR = '     09670000
096800                                  DELIMITED BY SIZE               09680000
096900                        PV-PULL-NUMBER                            09690000
097000                                  DELIMITED BY SIZE               09700000
097100                        ' LINE NBR = '                            09710000
097200                                  DELIMITED BY SIZE               09720000
097300                        PV-LINE-NUMBER                            09730000
097400                                  DELIMITED BY SIZE               09740000
097500                                INTO DP013-MESSAGE-TEXT (2)       09750000
097600                 MOVE SQLCA       TO DP013-SQLCA                  09760000
097700                 MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)     09770000
097800                 SET DP013-DB2-ABEND                              09780000
097900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           09790000
098000                 PERFORM DP013-0000-PROCESS-ABEND                 09800000
098100         END-EVALUATE                                             09810000
098200     END-PERFORM                                                  09820000
098300                                                                  09830000
098400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09840000
098500         MOVE '4010-OPEN-CURSOR'  TO DP013-PARAGRAPH              09850000
098600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   09860000
098700                                  TO DP013-MESSAGE-TEXT (1)       09870000
098800                 STRING 'OPEN ON TCEPLIT CSR FOR PULL NBR = '     09880000
098900                                  DELIMITED BY SIZE               09890000
099000                        PV-PULL-NUMBER                            09900000
099100                                  DELIMITED BY SIZE               09910000
099200                        ' LINE NBR = '                            09920000
099300                                  DELIMITED BY SIZE               09930000
099400                        PV-LINE-NUMBER                            09940000
099500                                  DELIMITED BY SIZE               09950000
099600                                INTO DP013-MESSAGE-TEXT (2)       09960000
099700         MOVE SQLCA               TO DP013-SQLCA                  09970000
099800         MOVE 'TCEPLIT '          TO DP013-DB2-TABLE-NAME (1)     09980000
099900         SET DP013-DB2-ABEND                                      09990000
100000             DP013-XCTL-DISPLAY-RESTART                           10000000
100100                                  TO TRUE                         10010000
100200         PERFORM DP013-0000-PROCESS-ABEND                         10020000
100300     END-IF.                                                      10030000
100400                                                                  10040000
100500*----------------------------------------------------------------*10050000
100600* CLOSE THE TCEPLIT  CURSOR.                                     *10060000
100700*----------------------------------------------------------------*10070000
100800 4020-CLOSE-CURSOR-TCEPLIT.                                       10080000
100900     EXEC SQL                                                     10090000
101000          CLOSE LINE-ITEM-CSR                                     10100000
101100     END-EXEC.                                                    10110000
101200                                                                  10120000
101300     EVALUATE TRUE                                                10130000
101400         WHEN SQLCODE = ZERO                                      10140000
101500             CONTINUE                                             10150000
101600         WHEN SQLWARN0 NOT = SPACES                               10160000
101700         WHEN SQLCODE < ZERO                                      10170000
101800         WHEN SQLCODE > ZERO                                      10180000
101900             MOVE '4020-CLOSE-CURSOR'                             10190000
102000                                  TO DP013-PARAGRAPH              10200000
102100             MOVE 'CLOSE TCEPLIT CURSOR '                         10210000
102200                                  TO DP013-MESSAGE-TEXT (1)       10220000
102300             STRING 'CLOSE ON TCEPLIT CURSOR FOR PULL NBR = '     10230000
102400                                  DELIMITED BY SIZE               10240000
102500                    PV-PULL-NUMBER                                10250000
102600                                  DELIMITED BY SIZE               10260000
102700                    ' LINE NBR = '                                10270000
102800                                  DELIMITED BY SIZE               10280000
102900                    PV-LINE-NUMBER                                10290000
103000                                  DELIMITED BY SIZE               10300000
103100                                INTO DP013-MESSAGE-TEXT (2)       10310000
103200             MOVE SQLCA           TO DP013-SQLCA                  10320000
103300             MOVE 'TCEPLIT '      TO DP013-DB2-TABLE-NAME (1)     10330000
103400             SET DP013-DB2-ABEND                                  10340000
103500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10350000
103600             PERFORM DP013-0000-PROCESS-ABEND                     10360000
103700     END-EVALUATE.                                                10370000
103800                                                                  10380000
103900*----------------------------------------------------------------*10390000
104000*    FETCH THE TCEPLIT CURSOR.                                   *10400000
104100*----------------------------------------------------------------*10410000
104200 4030-FETCH-CURSOR-TCEPLIT.                                       10420000
104300     INITIALIZE STORE-DISTRIBUTION-TABLE.                         10430000
104400     SET PS-NOT-EOF-TCEPLDS-CSR    TO TRUE.                       10440000
104500                                                                  10450000
104600     EXEC SQL                                                     10460000
104700          FETCH LINE-ITEM-CSR                                     10470000
104800           INTO  :CEPLIT-PL-LNE-NBR                               10480000
104900               , :CEPLIT-ITM-NBR                                  10490000
105000               , :CEPLIT-PL-REQ-QTY                               10500000
105100               , :CEPLIT-ACTL-PL-QTY :PV-NULL-IND-2               10510000
105200               , :CEPLIT-STAT-CDE                                 10520000
105300               , :CEPLIT-UNT-RTL-AMT                              10530000
105400     END-EXEC.                                                    10540000
105500                                                                  10550000
105600     EVALUATE TRUE                                                10560000
105700         WHEN SQLCODE = ZERO                                      10570000
105800              MOVE 0                    TO PV-CURRENT-PAGE        10580000
105900*             PERFORM 4200-SELECT-TSK                             10590000
106000              PERFORM 4200-CALL-CICS-API-ARCH                     10600000
106100              MOVE  CEPLIT-PL-LNE-NBR   TO DK-LINE-NUMBER         10610000
106200              MOVE  CEPLIT-PL-LNE-NBR   TO PV-LINE-NUMBER         10620000
106300              MOVE  CEPLIT-PL-LNE-NBR   TO PV-DISP-LINE-NUMBER    10630000
106400              PERFORM 4300-SELECT-TENTNME                         10640000
106500              PERFORM 4035-PRINT-REPORT                           10650000
106600         WHEN SQLCODE = +100                                      10660000
106700              MOVE ZEROS                TO CEPLIT-ITM-NBR         10670000
106800              MOVE '**'                 TO CEPLIT-STAT-CDE        10680000
106900              MOVE ZEROS                TO CEPLIT-UNT-RTL-AMT     10690000
107000              MOVE  ZEROES              TO DK-LINE-NUMBER         10700000
107100              MOVE  ZEROES              TO PV-LINE-NUMBER         10710000
107200              SET PS-EOF-TCEPLIT-CSR    TO TRUE                   10720000
107300         WHEN SQLWARN0 NOT = SPACE                                10730000
107400         WHEN SQLCODE NOT = ZERO                                  10740000
107500              MOVE '4030-FETCH-CURSOR'                            10750000
107600                                  TO DP013-PARAGRAPH              10760000
107700              MOVE 'FETCH TCEPLIT CURSOR'                         10770000
107800                                  TO DP013-MESSAGE-TEXT (1)       10780000
107900              STRING 'FETCH ON TCEPLIT CURSOR FOR PULL NBR = '    10790000
108000                                  DELIMITED BY SIZE               10800000
108100                     PV-PULL-NUMBER                               10810000
108200                                  DELIMITED BY SIZE               10820000
108300                    ' LINE NBR = '                                10830000
108400                                  DELIMITED BY SIZE               10840000
108500                     PV-LINE-NUMBER                               10850000
108600                                  DELIMITED BY SIZE               10860000
108700                                INTO DP013-MESSAGE-TEXT (2)       10870000
108800              MOVE SQLCA          TO DP013-SQLCA                  10880000
108900              SET DP013-DB2-ABEND                                 10890000
109000                                  TO TRUE                         10900000
109100              PERFORM DP013-0000-PROCESS-ABEND                    10910000
109200     END-EVALUATE.                                                10920000
109300                                                                  10930000
109400     IF CE004-LINE-NBR > 0                                        10940000
109500         SET PS-EOF-TCEPLIT-CSR          TO TRUE                  10950000
109600     END-IF.                                                      10960000
109700                                                                  10970000
109800*----------------------------------------------------------------*10980000
109900*  PRINT PULL REQUEST REPORT                                     *10990000
110000*----------------------------------------------------------------*11000000
110100 4035-PRINT-REPORT.                                               11010000
110200         PERFORM 4100-SELECT-TCEPLST-FOR-CREATE                   11020000
110300         PERFORM 4150-SELECT-TCEPLST-FOR-REPRNT                   11030000
110400         IF PV-COUNT > 0                                          11040000
110500             SET PS-REPRINT           TO TRUE                     11050000
110600         END-IF                                                   11060000
110700         PERFORM 7000-FORMAT-HEADER-LINES                         11070000
110800         MOVE 0                   TO PV-TABLE-STORE-COUNT         11080000
110900         MOVE 0                   TO PV-TOTAL-DIST-UNITS          11090000
111000         PERFORM 5010-OPEN-CURSOR-TCEPLDS                         11100000
111100         PERFORM 5030-FETCH-CURSOR-TCEPLDS                        11110000
111200             UNTIL  PS-EOF-TCEPLDS-CSR                            11120000
111300         PERFORM 5020-CLOSE-CURSOR-TCEPLDS                        11130000
111400         COMPUTE PV-TOTAL-PAGES ROUNDED =                         11140000
111500             (PV-TABLE-STORE-COUNT / PV-STRS-PER-PAGE) + .5       11150000
111600         SET ST-STR-IDX TO 1                                      11160000
111700         SET DL-DTL-LNE-IDX TO 1                                  11170000
111800         MOVE 1 TO PS-DTL-LNE-SUB                                 11180000
111900*jpl 3/3 - added following line for initialization.               11190000
112000         INITIALIZE DL-DETAIL-LINE                                11200000
112100         PERFORM 6000-FORMAT-DETAIL-LINES                         11210000
112200             UNTIL ST-STR-IDX > PV-TABLE-STORE-COUNT              11220000
112300         IF DL-DTL-LNE-IDX > 1                                    11230000
112400             ADD 2 TO PV-LINE-COUNT                               11240000
112500             MOVE DL-DETAIL-LINE         TO DRS01-COMM-DATA       11250000
112600             MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL        11260000
112700             PERFORM 8000-LINK-TO-DRS                             11270000
112800             MOVE DL-DETAIL-UNDERLINE    TO DRS01-COMM-DATA       11280000
112900             MOVE PC-SINGLE-SPACE        TO DRS01-COMM-CTL        11290000
113000             PERFORM 8000-LINK-TO-DRS                             11300000
113100         END-IF                                                   11310000
113200         COMPUTE PV-BLANK-LINES =                                 11320000
113300                              PV-LINES-PER-PAGE - PV-LINE-COUNT   11330000
113400         MOVE DL-BLANK-LINE              TO DRS01-COMM-DATA       11340000
113500         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11350000
113600         PERFORM 8000-LINK-TO-DRS PV-BLANK-LINES TIMES            11360000
113700                                                                  11370000
113800***      STRING PV-PULL-NUMBER-5-9 DELIMITED BY SIZE              11380000
113900***      STRING PV-PULL-NUMBER-7-9 DELIMITED BY SIZE              11390000
114000***             '-'                DELIMITED BY SIZE              11400000
114100***             PV-DISP-LINE-NUMBER-2-4 DELIMITED BY SIZE         11410000
114200***                                    INTO FL-PULL-NUMBER-HR     11420000
114300         MOVE FL-FOOTER-LINE-HR          TO DRS01-COMM-DATA       11430000
114400         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11440000
114500         PERFORM 8000-LINK-TO-DRS                                 11450000
114600                                                                  11460000
114700*jpl     MOVE DL-BLANK-LINE              TO DRS01-COMM-DATA       11470000
114800*jpl     MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11480000
114900*jpl     PERFORM 8000-LINK-TO-DRS                                 11490000
115000                                                                  11500000
115100***      MOVE PV-PULL-NUMBER-5-9     TO PV-BARCODE-PULL-NUMBER    11510000
115200***      MOVE PV-PULL-NUMBER-7-9     TO PV-BARCODE-PULL-NUMBER    11520000
115300***      MOVE PV-LINE-NUMBER-2-4     TO PV-BARCODE-LINE-NUMBER    11530000
115400***      MOVE '2222'                 TO PV-BARCODE                11540000
115500***      MOVE PV-BARCODE             TO PV-IN-DATA                11550000
115600***      PERFORM 4500-CALC-CHECK-DIGIT                            11560000
115700***                                                               11570000
115800***      STRING PC-START-CHAR      DELIMITED BY SIZE              11580000
115900***             PV-BARCODE         DELIMITED BY SIZE              11590000
116000***             PV-CHECK-DIGIT     DELIMITED BY SIZE              11600000
116100***             PC-STOP-CHAR       DELIMITED BY SIZE              11610000
116200***                                    INTO FL-PULL-NUMBER        11620000
116300***                                                               11630000
116400***      MOVE PV-TEST-BARCODE            TO FL-PULL-NUMBER        11640000
116500***                                                               11650000
116600         MOVE FL-FOOTER-LINE-BC          TO DRS01-COMM-DATA       11660000
116700         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11670000
116800         PERFORM 8000-LINK-TO-DRS                                 11680000
116900                                                                  11690000
117000*jpl     MOVE DL-BLANK-LINE              TO DRS01-COMM-DATA       11700000
117100*jpl     MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11710000
117200*jpl     PERFORM 8000-LINK-TO-DRS                                 11720000
117300                                                                  11730000
117400         MOVE PV-TABLE-STORE-COUNT       TO FL1-TOTAL-STORES      11740000
117500         MOVE FL-FOOTER-LINE-1           TO DRS01-COMM-DATA       11750000
117600         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11760000
117700         PERFORM 8000-LINK-TO-DRS                                 11770000
117800                                                                  11780000
117900         MOVE PV-TOTAL-DIST-UNITS        TO FL2-TOTAL-DIST-UNITS  11790000
118000         MOVE FL-FOOTER-LINE-2           TO DRS01-COMM-DATA       11800000
118100         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11810000
118200         PERFORM 8000-LINK-TO-DRS                                 11820000
118300                                                                  11830000
118400         MOVE PV-CURRENT-PAGE            TO FL3-CUR-PAGE          11840000
118500         MOVE PV-TOTAL-PAGES             TO FL3-TOT-PAGE          11850000
118600         MOVE FL-FOOTER-LINE-3           TO DRS01-COMM-DATA       11860000
118700         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        11870000
118800         PERFORM 8000-LINK-TO-DRS                                 11880000
118900                                                                  11890000
119000         IF CEPLIT-STAT-CDE = 'NW'                                11900000
119100             MOVE 'IP'                   TO DK-STAT-CDE           11910000
119200             PERFORM 4050-UPDATE-TCEPLIT                          11920000
119300             MOVE 'PR'                   TO DK-STAT-CDE           11930000
119400             PERFORM 4060-INSERT-TCEPLST                          11940000
119500         ELSE                                                     11950000
119600             MOVE 'PR'                   TO DK-STAT-CDE           11960000
119700             PERFORM 4060-INSERT-TCEPLST                          11970000
119800         END-IF.                                                  11980000
119900                                                                  11990000
120000*----------------------------------------------------------------*12000000
120100* UPDATE TO TCEPLIT.                                             *12010000
120200*----------------------------------------------------------------*12020000
120300 4050-UPDATE-TCEPLIT.                                             12030000
120400     PERFORM                                                      12040000
120500         WITH TEST AFTER                                          12050000
120600         VARYING PV-RETRY-COUNTER                                 12060000
120700         FROM 1 BY 1                                              12070000
120800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12080000
120900                   OR (SQLCODE = ZERO OR SQLCODE = +100))         12090000
121000                                                                  12100000
121100         EXEC SQL                                                 12110000
121200              UPDATE TCEPLIT                                      12120000
121300                 SET                                              12130000
121400                     STAT_CDE          = :DK-STAT-CDE             12140000
121500               WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER          12150000
121600                 AND PL_LNE_NBR        = :DK-LINE-NUMBER          12160000
121700         END-EXEC                                                 12170000
121800                                                                  12180000
121900         EVALUATE TRUE                                            12190000
122000             WHEN SQLCODE = ZERO                                  12200000
122100             WHEN SQLCODE = -911                                  12210000
122200             WHEN SQLCODE = -913                                  12220000
122300                 CONTINUE                                         12230000
122400             WHEN SQLCODE = +100                                  12240000
122500                 SET PS-UPDATE-ERROR      TO TRUE                 12250000
122600             WHEN SQLWARN0 NOT = SPACES                           12260000
122700             WHEN SQLCODE < +0                                    12270000
122800             WHEN SQLCODE > +0                                    12280000
122900             MOVE '4050-UPDATE-TCEPLIT'                           12290000
123000                                  TO DP013-PARAGRAPH              12300000
123100             MOVE 'UPDATE FOR TCEPLIT'                            12310000
123200                                  TO DP013-MESSAGE-TEXT(1)        12320000
123300             STRING 'UPDATE ON TCEPLIT FOR PULL NBR = '           12330000
123400                                  DELIMITED BY SIZE               12340000
123500                     PV-PULL-NUMBER                               12350000
123600                                  DELIMITED BY SIZE               12360000
123700                    ' LINE NBR = '                                12370000
123800                                  DELIMITED BY SIZE               12380000
123900                     PV-LINE-NUMBER                               12390000
124000                                  DELIMITED BY SIZE               12400000
124100                                INTO DP013-MESSAGE-TEXT (2)       12410000
124200             MOVE SQLCA           TO DP013-SQLCA                  12420000
124300             MOVE 'TCEPLIT'       TO DP013-DB2-TABLE-NAME (1)     12430000
124400             SET DP013-DB2-ABEND                                  12440000
124500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               12450000
124600             PERFORM DP013-0000-PROCESS-ABEND                     12460000
124700         END-EVALUATE                                             12470000
124800     END-PERFORM.                                                 12480000
124900                                                                  12490000
125000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12500000
125100         MOVE '4050-UPDATE-TCEPLIT'                               12510000
125200                                  TO DP013-PARAGRAPH              12520000
125300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     12530000
125400                                  TO DP013-MESSAGE-TEXT (1)       12540000
125500         STRING 'UPDATE ON TCEPLIT FOR PULL NBR = '               12550000
125600                                  DELIMITED BY SIZE               12560000
125700                 PV-PULL-NUMBER                                   12570000
125800                                  DELIMITED BY SIZE               12580000
125900                 ' LINE NBR = '                                   12590000
126000                                  DELIMITED BY SIZE               12600000
126100                 PV-LINE-NUMBER                                   12610000
126200                                  DELIMITED BY SIZE               12620000
126300                                INTO DP013-MESSAGE-TEXT (2)       12630000
126400         MOVE SQLCA               TO DP013-SQLCA                  12640000
126500         MOVE 'TCEPLIT '          TO DP013-DB2-TABLE-NAME (1)     12650000
126600         SET DP013-DB2-ABEND                                      12660000
126700             DP013-XCTL-DISPLAY-RESTART                           12670000
126800                                  TO TRUE                         12680000
126900         PERFORM DP013-0000-PROCESS-ABEND                         12690000
127000     END-IF.                                                      12700000
127100                                                                  12710000
127200*----------------------------------------------------------------*12720000
127300* INSERT ROW INTO TCEPLST                                        *12730000
127400*----------------------------------------------------------------*12740000
127500 4060-INSERT-TCEPLST.                                             12750000
127600     PERFORM                                                      12760000
127700         WITH TEST AFTER                                          12770000
127800         VARYING PV-RETRY-COUNTER                                 12780000
127900         FROM 1 BY 1                                              12790000
128000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               12800000
128100                   OR (SQLCODE = ZERO OR SQLCODE = -803))         12810000
128200                                                                  12820000
128300         EXEC SQL                                                 12830000
128400            INSERT                                                12840000
128500              INTO  TCEPLST                                       12850000
128600                   (CNSTK_REQ_PL_NBR                              12860000
128700                   ,PL_LNE_NBR                                    12870000
128800                   ,CRE_TMST                                      12880000
128900                   ,STAT_CDE                                      12890000
129000                   ,CRE_BY_USR_ID)                                12900000
129100            VALUES                                                12910000
129200                  (:DK-PULL-NUMBER                                12920000
129300                  ,:DK-LINE-NUMBER                                12930000
129400                  , CURRENT TIMESTAMP                             12940000
129500                  ,:DK-STAT-CDE                                   12950000
129600                  ,:CE004-USER-ID)                                12960000
129700         END-EXEC                                                 12970000
129800                                                                  12980000
129900         EVALUATE TRUE                                            12990000
130000             WHEN SQLCODE = ZERO                                  13000000
130100             WHEN SQLCODE = -911                                  13010000
130200             WHEN SQLCODE = -913                                  13020000
130300             WHEN SQLCODE = -803                                  13030000
130400                 CONTINUE                                         13040000
130500             WHEN SQLWARN0 NOT = SPACES                           13050000
130600             WHEN SQLCODE < +0                                    13060000
130700             WHEN SQLCODE > +0                                    13070000
130800             MOVE '4060-INSERT-TCEPLST'                           13080000
130900                                  TO DP013-PARAGRAPH              13090000
131000             MOVE 'INSERT FOR TCEPLST'                            13100000
131100                                  TO DP013-MESSAGE-TEXT(1)        13110000
131200             STRING 'INSERT TO TCEPLST FOR PULL NBR = '           13120000
131300                                  DELIMITED BY SIZE               13130000
131400                     PV-PULL-NUMBER                               13140000
131500                                  DELIMITED BY SIZE               13150000
131600                    ' LINE NBR = '                                13160000
131700                                  DELIMITED BY SIZE               13170000
131800                     PV-LINE-NUMBER                               13180000
131900                                  DELIMITED BY SIZE               13190000
132000                    ' STAT CODE = '                               13200000
132100                                  DELIMITED BY SIZE               13210000
132200                     DK-STAT-CDE                                  13220000
132300                                  DELIMITED BY SIZE               13230000
132400                                INTO DP013-MESSAGE-TEXT (2)       13240000
132500             MOVE SQLCA           TO DP013-SQLCA                  13250000
132600             MOVE 'TCEPLST'       TO DP013-DB2-TABLE-NAME (1)     13260000
132700             SET DP013-DB2-ABEND                                  13270000
132800                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13280000
132900             PERFORM DP013-0000-PROCESS-ABEND                     13290000
133000         END-EVALUATE                                             13300000
133100     END-PERFORM.                                                 13310000
133200                                                                  13320000
133300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        13330000
133400         MOVE '4060-INSERT-TCEPLST'                               13340000
133500                                  TO DP013-PARAGRAPH              13350000
133600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT'     13360000
133700                                  TO DP013-MESSAGE-TEXT (1)       13370000
133800         STRING 'INSERT TO TCEPLST FOR PULL NBR = '               13380000
133900                                  DELIMITED BY SIZE               13390000
134000                 PV-PULL-NUMBER                                   13400000
134100                                  DELIMITED BY SIZE               13410000
134200                ' LINE NBR = '                                    13420000
134300                                  DELIMITED BY SIZE               13430000
134400                 PV-LINE-NUMBER                                   13440000
134500                                  DELIMITED BY SIZE               13450000
134600                ' STAT CODE = '                                   13460000
134700                                  DELIMITED BY SIZE               13470000
134800                 DK-STAT-CDE                                      13480000
134900                                  DELIMITED BY SIZE               13490000
135000                                INTO DP013-MESSAGE-TEXT (2)       13500000
135100         MOVE SQLCA               TO DP013-SQLCA                  13510000
135200         MOVE 'TCEPLST '          TO DP013-DB2-TABLE-NAME (1)     13520000
135300         SET DP013-DB2-ABEND                                      13530000
135400             DP013-XCTL-DISPLAY-RESTART                           13540000
135500                                  TO TRUE                         13550000
135600         PERFORM DP013-0000-PROCESS-ABEND                         13560000
135700     END-IF.                                                      13570000
135800                                                                  13580000
135900*----------------------------------------------------------------*13590000
136000* UPDATE TO TCEPLRQ.                                             *13600000
136100*----------------------------------------------------------------*13610000
136200 4070-UPDATE-TCEPLRQ.                                             13620000
136300     PERFORM                                                      13630000
136400         WITH TEST AFTER                                          13640000
136500         VARYING PV-RETRY-COUNTER                                 13650000
136600         FROM 1 BY 1                                              13660000
136700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13670000
136800                   OR (SQLCODE = ZERO OR SQLCODE = +100))         13680000
136900                                                                  13690000
137000         EXEC SQL                                                 13700000
137100              UPDATE TCEPLRQ                                      13710000
137200                 SET                                              13720000
137300                     STAT_CDE          = :DK-STAT-CDE             13730000
137400               WHERE CNSTK_REQ_PL_NBR  = :DK-PULL-NUMBER          13740000
137500         END-EXEC                                                 13750000
137600                                                                  13760000
137700         EVALUATE TRUE                                            13770000
137800             WHEN SQLCODE = ZERO                                  13780000
137900             WHEN SQLCODE = -911                                  13790000
138000             WHEN SQLCODE = -913                                  13800000
138100                 CONTINUE                                         13810000
138200             WHEN SQLCODE = +100                                  13820000
138300                 SET PS-UPDATE-ERROR      TO TRUE                 13830000
138400             WHEN SQLWARN0 NOT = SPACES                           13840000
138500             WHEN SQLCODE < +0                                    13850000
138600             WHEN SQLCODE > +0                                    13860000
138700             MOVE '4070-UPDATE-TCEPLRQ'                           13870000
138800                                  TO DP013-PARAGRAPH              13880000
138900             MOVE 'UPDATE FOR TCEPLRQ'                            13890000
139000                                  TO DP013-MESSAGE-TEXT(1)        13900000
139100             STRING 'UPDATE TO TCEPLRQ FOR PULL NBR = '           13910000
139200                                  DELIMITED BY SIZE               13920000
139300                     PV-PULL-NUMBER                               13930000
139400                                  DELIMITED BY SIZE               13940000
139500                                INTO DP013-MESSAGE-TEXT (2)       13950000
139600             MOVE SQLCA           TO DP013-SQLCA                  13960000
139700             MOVE 'TCEPLRQ'       TO DP013-DB2-TABLE-NAME (1)     13970000
139800             SET DP013-DB2-ABEND                                  13980000
139900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               13990000
140000             PERFORM DP013-0000-PROCESS-ABEND                     14000000
140100         END-EVALUATE                                             14010000
140200     END-PERFORM.                                                 14020000
140300                                                                  14030000
140400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14040000
140500         MOVE '4070-UPDATE-TCEPLRQ'                               14050000
140600                                  TO DP013-PARAGRAPH              14060000
140700         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     14070000
140800                                  TO DP013-MESSAGE-TEXT (1)       14080000
140900         STRING 'UPDATE TO TCEPLRQ FOR PULL NBR = '               14090000
141000                                  DELIMITED BY SIZE               14100000
141100                 PV-PULL-NUMBER                                   14110000
141200                                  DELIMITED BY SIZE               14120000
141300                                INTO DP013-MESSAGE-TEXT (2)       14130000
141400         MOVE SQLCA               TO DP013-SQLCA                  14140000
141500         MOVE 'TCEPLRQ '          TO DP013-DB2-TABLE-NAME (1)     14150000
141600         SET DP013-DB2-ABEND                                      14160000
141700             DP013-XCTL-DISPLAY-RESTART                           14170000
141800                                  TO TRUE                         14180000
141900         PERFORM DP013-0000-PROCESS-ABEND                         14190000
142000     END-IF.                                                      14200000
142100                                                                  14210000
142200*----------------------------------------------------------------*14220000
142300* SELECT FROM TCEPLST (TO GET CREATE USER AND TIMESTAMP)         *14230000
142400*----------------------------------------------------------------*14240000
142500 4100-SELECT-TCEPLST-FOR-CREATE.                                  14250000
142600     PERFORM                                                      14260000
142700         WITH TEST AFTER                                          14270000
142800         VARYING PV-RETRY-COUNTER                                 14280000
142900         FROM 1 BY 1                                              14290000
143000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14300000
143100                   OR (SQLCODE = ZERO OR SQLCODE = +100))         14310000
143200                                                                  14320000
143300         EXEC SQL SELECT                                          14330000
143400                    CRE_TMST                                      14340000
143500                   ,CRE_BY_USR_ID                                 14350000
143600                 INTO :CEPLST-CRE-TMST                            14360000
143700                   ,  :CEPLST-CRE-BY-USR-ID                       14370000
143800                 FROM TCEPLST                                     14380000
143900             WHERE CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER            14390000
144000               AND PL_LNE_NBR       =  :DK-LINE-NUMBER            14400000
144100               AND STAT_CDE         =  'NW'                       14410000
144200         END-EXEC                                                 14420000
144300                                                                  14430000
144400         EVALUATE TRUE                                            14440000
144500             WHEN SQLCODE = ZERO                                  14450000
144600             WHEN SQLCODE = -911                                  14460000
144700             WHEN SQLCODE = -913                                  14470000
144800                 CONTINUE                                         14480000
144900             WHEN SQLCODE = +100                                  14490000
145000                 MOVE '* UNKNOWN*'       TO CEPLST-CRE-TMST       14500000
145100                 MOVE '*UNKNWN*'         TO CEPLST-CRE-BY-USR-ID  14510000
145200             WHEN SQLWARN0 NOT = SPACES                           14520000
145300             WHEN SQLCODE < +0                                    14530000
145400             WHEN SQLCODE > +0                                    14540000
145500             MOVE '4100-SELECT-TCEPLST'                           14550000
145600                                  TO DP013-PARAGRAPH              14560000
145700             MOVE 'SELECT FOR TCEPLST FOR CREATE'                 14570000
145800                                  TO DP013-MESSAGE-TEXT(1)        14580000
145900             STRING 'SELECT ON TCEPLST FOR PULL NBR = '           14590000
146000                                  DELIMITED BY SIZE               14600000
146100                     PV-PULL-NUMBER                               14610000
146200                                  DELIMITED BY SIZE               14620000
146300                    ' LINE NBR = '                                14630000
146400                                  DELIMITED BY SIZE               14640000
146500                     PV-LINE-NUMBER                               14650000
146600                                  DELIMITED BY SIZE               14660000
146700                    ' STAT CODE = NW'                             14670000
146800                                  DELIMITED BY SIZE               14680000
146900                                INTO DP013-MESSAGE-TEXT (2)       14690000
147000             MOVE SQLCA           TO DP013-SQLCA                  14700000
147100             MOVE 'TCEPLST'       TO DP013-DB2-TABLE-NAME (1)     14710000
147200             SET DP013-DB2-ABEND                                  14720000
147300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               14730000
147400             PERFORM DP013-0000-PROCESS-ABEND                     14740000
147500         END-EVALUATE                                             14750000
147600     END-PERFORM.                                                 14760000
147700                                                                  14770000
147800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14780000
147900         MOVE '4100-SELECT-TCEPLST'                               14790000
148000                                  TO DP013-PARAGRAPH              14800000
148100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     14810000
148200                                  TO DP013-MESSAGE-TEXT (1)       14820000
148300         STRING 'SELECT ON TCEPLST FOR PULL NBR = '               14830000
148400                                  DELIMITED BY SIZE               14840000
148500                 PV-PULL-NUMBER                                   14850000
148600                                  DELIMITED BY SIZE               14860000
148700                ' LINE NBR = '                                    14870000
148800                                  DELIMITED BY SIZE               14880000
148900                 PV-LINE-NUMBER                                   14890000
149000                                  DELIMITED BY SIZE               14900000
149100                ' STAT CODE = NW'                                 14910000
149200                                  DELIMITED BY SIZE               14920000
149300                                INTO DP013-MESSAGE-TEXT (2)       14930000
149400         MOVE SQLCA               TO DP013-SQLCA                  14940000
149500         MOVE 'TCEPLST '          TO DP013-DB2-TABLE-NAME (1)     14950000
149600         SET DP013-DB2-ABEND                                      14960000
149700             DP013-XCTL-DISPLAY-RESTART                           14970000
149800                                  TO TRUE                         14980000
149900         PERFORM DP013-0000-PROCESS-ABEND                         14990000
150000     END-IF.                                                      15000000
150100                                                                  15010000
150200*----------------------------------------------------------------*15020000
150300* SELECT FROM TCEPLST (TO SEE IF REPRINT MESSAGE SHOULD PRINT -  *15030000
150400*                      REPRINT MESSAGE IS ONLY PRINTED IF THERE  *15040000
150500*                      IS AT LEAST ONE ROW WITH A STATUS OF 'PR')*15050000
150600*----------------------------------------------------------------*15060000
150700 4150-SELECT-TCEPLST-FOR-REPRNT.                                  15070000
150800     PERFORM                                                      15080000
150900         WITH TEST AFTER                                          15090000
151000         VARYING PV-RETRY-COUNTER                                 15100000
151100         FROM 1 BY 1                                              15110000
151200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15120000
151300                   OR (SQLCODE = ZERO OR SQLCODE = +100))         15130000
151400                                                                  15140000
151500         EXEC SQL SELECT COUNT(*)                                 15150000
151600                 INTO :PV-COUNT                                   15160000
151700                 FROM TCEPLST                                     15170000
151800             WHERE CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER            15180000
151900               AND PL_LNE_NBR       =  :DK-LINE-NUMBER            15190000
152000               AND STAT_CDE         =  'PR'                       15200000
152100         END-EXEC                                                 15210000
152200                                                                  15220000
152300         EVALUATE TRUE                                            15230000
152400             WHEN SQLCODE = ZERO                                  15240000
152500             WHEN SQLCODE = -911                                  15250000
152600             WHEN SQLCODE = -913                                  15260000
152700             WHEN SQLCODE = +100                                  15270000
152800                 CONTINUE                                         15280000
152900             WHEN SQLWARN0 NOT = SPACES                           15290000
153000             WHEN SQLCODE < +0                                    15300000
153100             WHEN SQLCODE > +0                                    15310000
153200             MOVE '4150-SELECT-TCEPLST'                           15320000
153300                                  TO DP013-PARAGRAPH              15330000
153400             MOVE 'SELECT FOR TCEPLST FOR REPRINT'                15340000
153500                                  TO DP013-MESSAGE-TEXT(1)        15350000
153600             STRING 'SELECT ON TCEPLST FOR PULL NBR = '           15360000
153700                                  DELIMITED BY SIZE               15370000
153800                     PV-PULL-NUMBER                               15380000
153900                                  DELIMITED BY SIZE               15390000
154000                    ' LINE NBR = '                                15400000
154100                                  DELIMITED BY SIZE               15410000
154200                     PV-LINE-NUMBER                               15420000
154300                                  DELIMITED BY SIZE               15430000
154400                    ' STAT CODE = PR'                             15440000
154500                                  DELIMITED BY SIZE               15450000
154600                                INTO DP013-MESSAGE-TEXT (2)       15460000
154700             MOVE SQLCA           TO DP013-SQLCA                  15470000
154800             MOVE 'TCEPLST'       TO DP013-DB2-TABLE-NAME (1)     15480000
154900             SET DP013-DB2-ABEND                                  15490000
155000                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15500000
155100             PERFORM DP013-0000-PROCESS-ABEND                     15510000
155200         END-EVALUATE                                             15520000
155300     END-PERFORM.                                                 15530000
155400                                                                  15540000
155500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15550000
155600         MOVE '4150-SELECT-TCEPLST'                               15560000
155700                                  TO DP013-PARAGRAPH              15570000
155800         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     15580000
155900                                  TO DP013-MESSAGE-TEXT (1)       15590000
156000         STRING 'SELECT ON TCEPLST FOR PULL NBR = '               15600000
156100                                  DELIMITED BY SIZE               15610000
156200                 PV-PULL-NUMBER                                   15620000
156300                                  DELIMITED BY SIZE               15630000
156400                ' LINE NBR = '                                    15640000
156500                                  DELIMITED BY SIZE               15650000
156600                 PV-LINE-NUMBER                                   15660000
156700                                  DELIMITED BY SIZE               15670000
156800                ' STAT CODE = PR'                                 15680000
156900                                  DELIMITED BY SIZE               15690000
157000                                INTO DP013-MESSAGE-TEXT (2)       15700000
157100         MOVE SQLCA               TO DP013-SQLCA                  15710000
157200         MOVE 'TCEPLST '          TO DP013-DB2-TABLE-NAME (1)     15720000
157300         SET DP013-DB2-ABEND                                      15730000
157400             DP013-XCTL-DISPLAY-RESTART                           15740000
157500                                  TO TRUE                         15750000
157600         PERFORM DP013-0000-PROCESS-ABEND                         15760000
157700     END-IF.                                                      15770000
157800                                                                  15780000
157900*----------------------------------------------------------------*15790000
158000* SELECT FROM LOGISTICS DOMAIN ITEM ACCESS MODULE                *15800000
158100*----------------------------------------------------------------*15810000
158200*4200-SELECT-TSK.                      WR/IR# 230ZZ              *15820099
158300 4200-CALL-CICS-API-ARCH.                                         15830000
158400                                                                  15840000
158500     MOVE CEPLIT-ITM-NBR                   TO                     15850000
158600                                         XL001-KEY-ITM-NBR.       15860000
158700                                                                  15870000
158800         SET  XL001-BY-ITEM                                       15880000
158900              XL001-SELECT-SKU                                    15890000
159000              XL001-SELECT-VND-STYL   TO TRUE                     15900000
159100                                                                  15910000
159200         CALL XL001-VSM-PGM USING  DFHEIBLK                       15920000
159300                                   XL001-COMMAREA                 15930000
159400                                   XL001-ITEM-COMMAREA            15940000
159500                                                                  15950000
159600         EVALUATE TRUE                                            15960000
159700             WHEN XL001-SKU-SQLCODE = ZERO                        15970000
159800                 MOVE XL001-SKU-NBR     TO PV-TEMP-SEQ-NBR        15980000
159900                 PERFORM 4210-SELECT-VND-STYL                     15990000
160000                                                                  16000000
160100             WHEN XL001-SKU-CONTENTION                            16010099
160200                 CONTINUE                                         16020000
160300                                                                  16030000
160400             WHEN XL001-SKU-SQLCODE = +100                        16040000
160500                 MOVE '** UNKNOWN **'    TO XL001-VS-NBR          16050000
160600                 MOVE ZEROES             TO XL001-ENT-ID          16060000
160700                 MOVE '** UNKNOWN **'    TO XL001-SKU-DESC        16070000
160800                 MOVE 0                  TO XL001-OUTR-PACK-QTY   16080000
160900                                                                  16090000
161000             WHEN OTHER                                           16100000
161100                 MOVE '4200-CALL-CICS-API-ARCH'                   16110000
161200                                      TO DP013-PARAGRAPH          16120000
161300                 MOVE 'SELECT FOR SKU    '                        16130000
161400                                      TO DP013-MESSAGE-TEXT(1)    16140000
161500                 STRING 'SELECT ON SKU FOR ITEM NBR = '           16150000
161600                                      DELIMITED BY SIZE           16160000
161700                         PV-ITEM-NUMBER                           16170000
161800                                      DELIMITED BY SIZE           16180000
161900                                    INTO DP013-MESSAGE-TEXT (2)   16190000
162000                 MOVE XL001-SQLCA     TO DP013-SQLCA              16200099
162100                 MOVE 'XLV_SKU'       TO DP013-DB2-TABLE-NAME (1) 16210000
162200                 SET DP013-DB2-ABEND                              16220000
162300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16230000
162400                 PERFORM DP013-0000-PROCESS-ABEND                 16240000
162500         END-EVALUATE.                                            16250099
162600*                                                                 16260000
162700*----------------------------------------------------------------*16270000
162800* SELECT FROM XLV_VND_STYL VIEW.                                 *16280000
162900*----------------------------------------------------------------*16290000
163000 4210-SELECT-VND-STYL.                                            16300000
163100                                                                  16310000
163200     EVALUATE TRUE                                                16320000
163300         WHEN XL001-VND-STYL-SQLCODE = ZERO                       16330000
163400             CONTINUE                                             16340000
163500                                                                  16350000
163600         WHEN XL001-VND-STYL-CONTENTION                           16360099
163700             CONTINUE                                             16370000
163800                                                                  16380000
163900         WHEN XL001-VND-STYL-SQLCODE = +100                       16390000
164000             MOVE '** UNKNOWN **'    TO XL001-VS-NBR              16400000
164100             MOVE ZEROES             TO XL001-ENT-ID              16410000
164200                                                                  16420000
164300         WHEN OTHER                                               16430000
164400             MOVE '4210-SELECT-VND-STYL'                          16440000
164500                                  TO DP013-PARAGRAPH              16450000
164600             MOVE 'SELECT FOR VND_STYL'                           16460000
164700                                  TO DP013-MESSAGE-TEXT(1)        16470000
164800             STRING 'SELECT ON SKU FOR ITEM NBR = '               16480000
164900                                  DELIMITED BY SIZE               16490000
165000                     PV-ITEM-NUMBER                               16500000
165100                                  DELIMITED BY SIZE               16510000
165200                                INTO DP013-MESSAGE-TEXT (2)       16520000
165300             MOVE XL001-SQLCA     TO DP013-SQLCA                  16530099
165400             MOVE 'XLV_VND_STYL'  TO DP013-DB2-TABLE-NAME (1)     16540000
165500             SET DP013-DB2-ABEND                                  16550000
165600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               16560000
165700             PERFORM DP013-0000-PROCESS-ABEND                     16570000
165800      END-EVALUATE.                                               16580000
165900                                                                  16590000
166000*----------------------------------------------------------------*16600000
166100* SELECT FROM TENTNME.                   WR/IR# 230ZZ            *16610099
166200*----------------------------------------------------------------*16620000
166300 4300-SELECT-TENTNME.                                             16630000
166400*    MOVE TSK-ENT-ID                   TO PV-ENT-ID.              16640000
166500     MOVE XL001-ENT-ID                 TO PV-ENT-ID.              16650000
166600                                                                  16660000
166700     PERFORM                                                      16670000
166800         WITH TEST AFTER                                          16680000
166900         VARYING PV-RETRY-COUNTER                                 16690000
167000         FROM 1 BY 1                                              16700000
167100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               16710000
167200                   OR (SQLCODE = ZERO OR SQLCODE = +100))         16720000
167300                                                                  16730000
167400         EXEC SQL                                                 16740000
167500             SELECT ENT_NAME_DESC                                 16750000
167600                 INTO :ENTNME-ENT-NAME-DESC                       16760000
167700                 FROM TENTNME                                     16770000
167800*            WHERE ENT_ID           =  :TSK-ENT-ID                16780000
167900             WHERE ENT_ID           =  :XL001-ENT-ID              16790000
168000               AND TYPE_CDE         =  '01'                       16800000
168100         END-EXEC                                                 16810000
168200                                                                  16820000
168300         EVALUATE TRUE                                            16830000
168400             WHEN SQLCODE = ZERO                                  16840000
168500             WHEN SQLCODE = -911                                  16850000
168600             WHEN SQLCODE = -913                                  16860000
168700                 CONTINUE                                         16870000
168800             WHEN SQLCODE = +100                                  16880000
168900                 MOVE '** UNKNOWN **'    TO ENTNME-ENT-NAME-DESC  16890000
169000             WHEN SQLWARN0 NOT = SPACES                           16900000
169100             WHEN SQLCODE < +0                                    16910000
169200             WHEN SQLCODE > +0                                    16920000
169300             MOVE '4300-SELECT-TENTNME'                           16930000
169400                                  TO DP013-PARAGRAPH              16940000
169500             MOVE 'SELECT FOR TENTNME'                            16950000
169600                                  TO DP013-MESSAGE-TEXT(1)        16960000
169700             STRING 'SELECT ON TENTNME FOR VENDOR ENT ID = '      16970000
169800                                  DELIMITED BY SIZE               16980000
169900                     PV-ENT-ID                                    16990000
170000                                  DELIMITED BY SIZE               17000000
170100                                INTO DP013-MESSAGE-TEXT (2)       17010000
170200             MOVE SQLCA           TO DP013-SQLCA                  17020000
170300             MOVE 'TENTNME'       TO DP013-DB2-TABLE-NAME (1)     17030000
170400             SET DP013-DB2-ABEND                                  17040000
170500                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17050000
170600             PERFORM DP013-0000-PROCESS-ABEND                     17060000
170700         END-EVALUATE                                             17070000
170800     END-PERFORM.                                                 17080000
170900                                                                  17090000
171000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17100000
171100         MOVE '4300-SELECT-TENTNME'                               17110000
171200                                  TO DP013-PARAGRAPH              17120000
171300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     17130000
171400                                  TO DP013-MESSAGE-TEXT (1)       17140000
171500         STRING 'SELECT ON TENTNME FOR VENDOR ENT ID = '          17150000
171600                                  DELIMITED BY SIZE               17160000
171700                 PV-ENT-ID                                        17170000
171800                                  DELIMITED BY SIZE               17180000
171900                                INTO DP013-MESSAGE-TEXT (2)       17190000
172000         MOVE SQLCA               TO DP013-SQLCA                  17200000
172100         MOVE 'TENTNME '          TO DP013-DB2-TABLE-NAME (1)     17210000
172200         SET DP013-DB2-ABEND                                      17220000
172300             DP013-XCTL-DISPLAY-RESTART                           17230000
172400                                  TO TRUE                         17240000
172500         PERFORM DP013-0000-PROCESS-ABEND                         17250000
172600     END-IF.                                                      17260000
172700                                                                  17270000
172800*----------------------------------------------------------------*17280000
172900* CALC THE CODE 128 CHECK DIGIT.                                 *17290000
173000*----------------------------------------------------------------*17300000
173100 4500-CALC-CHECK-DIGIT.                                           17310000
173200     MOVE PC-START-VALUE               TO PV-ACCUM-TOTAL.         17320000
173300                                                                  17330000
173400     PERFORM                                                      17340000
173500       VARYING IN-INDX                                            17350000
173600         FROM 1 BY 1 UNTIL                                        17360000
173700         IN-INDX > PV-NBR-OF-CHARS                                17370000
173800           SET PT-INDX                 TO 1                       17380000
173900           SEARCH PT-ENTRY                                        17390000
174000             VARYING PT-INDX                                      17400000
174100               AT END                                             17410000
174200                   MOVE SPACE          TO PV-CHECK-DIGIT          17420000
174300               WHEN PV-IN-CHAR (IN-INDX) = PT-CHAR (PT-INDX)      17430000
174400                   SET PV-ENTRY        TO IN-INDX                 17440000
174500                   COMPUTE PV-ENTRY-TOTAL = PV-ENTRY *            17450000
174600                              PT-VALUE (PT-INDX)                  17460000
174700                   ADD PV-ENTRY-TOTAL  TO PV-ACCUM-TOTAL          17470000
174800           END-SEARCH                                             17480000
174900     END-PERFORM.                                                 17490000
175000                                                                  17500000
175100     DIVIDE PV-ACCUM-TOTAL BY 103                                 17510000
175200       GIVING PV-QUOTIENT  REMAINDER  PV-REMAINDER.               17520000
175300     SET PT-INDX                       TO 1.                      17530000
175400     SEARCH PT-ENTRY                                              17540000
175500       VARYING PT-INDX                                            17550000
175600         AT END                                                   17560000
175700             SET PS-CHECK-DIGIT-NOT-FOUND TO TRUE                 17570000
175800         WHEN PV-REMAINDER = PT-VALUE (PT-INDX)                   17580000
175900             MOVE PT-CHAR (PT-INDX)    TO PV-CHECK-DIGIT          17590000
176000     END-SEARCH.                                                  17600000
176100                                                                  17610000
176200*----------------------------------------------------------------*17620000
176300* OPEN THE TCEPLDS  CURSOR.                                      *17630000
176400*----------------------------------------------------------------*17640000
176500 5010-OPEN-CURSOR-TCEPLDS.                                        17650000
176600     PERFORM                                                      17660000
176700         WITH TEST AFTER                                          17670000
176800         VARYING PV-RETRY-COUNTER                                 17680000
176900         FROM 1 BY 1                                              17690000
177000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17700000
177100                   OR (SQLCODE = ZERO))                           17710000
177200                                                                  17720000
177300         MOVE 'CURSOR:  TCEPLDS-CSR'                              17730000
177400                                  TO DP013-MESSAGE-TEXT (2)       17740000
177500         EXEC SQL                                                 17750000
177600              OPEN LINE-ITEM-DSTR-CSR                             17760000
177700         END-EXEC                                                 17770000
177800                                                                  17780000
177900         EVALUATE TRUE                                            17790000
178000             WHEN SQLCODE = ZERO                                  17800000
178100             WHEN SQLCODE = -904                                  17810000
178200             WHEN SQLCODE = -913                                  17820000
178300                 CONTINUE                                         17830000
178400             WHEN SQLWARN0 NOT = SPACES                           17840000
178500             WHEN SQLCODE < ZERO                                  17850000
178600             WHEN SQLCODE > ZERO                                  17860000
178700                 MOVE '5010-OPEN-CURSOR'                          17870000
178800                                  TO DP013-PARAGRAPH              17880000
178900                 MOVE 'OPEN TCEPLDS CURSOR - '                    17890000
179000                                  TO DP013-MESSAGE-TEXT (1)       17900000
179100                 STRING 'OPEN ON TCEPLDS CSR FOR PULL NBR = '     17910000
179200                                  DELIMITED BY SIZE               17920000
179300                        PV-PULL-NUMBER                            17930000
179400                                  DELIMITED BY SIZE               17940000
179500                        ' LINE NBR = '                            17950000
179600                                  DELIMITED BY SIZE               17960000
179700                        PV-LINE-NUMBER                            17970000
179800                                  DELIMITED BY SIZE               17980000
179900                                INTO DP013-MESSAGE-TEXT (2)       17990000
180000                 MOVE SQLCA       TO DP013-SQLCA                  18000000
180100                 MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (1)     18010000
180200                 SET DP013-DB2-ABEND                              18020000
180300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           18030000
180400                 PERFORM DP013-0000-PROCESS-ABEND                 18040000
180500         END-EVALUATE                                             18050000
180600     END-PERFORM.                                                 18060000
180700                                                                  18070000
180800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        18080000
180900         MOVE '5010-OPEN-CURSOR'  TO DP013-PARAGRAPH              18090000
181000         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   18100000
181100                                  TO DP013-MESSAGE-TEXT (1)       18110000
181200         STRING 'OPEN ON TCEPLDS CSR FOR PULL NBR = '             18120000
181300                                  DELIMITED BY SIZE               18130000
181400                PV-PULL-NUMBER                                    18140000
181500                                  DELIMITED BY SIZE               18150000
181600                ' LINE NBR = '                                    18160000
181700                                  DELIMITED BY SIZE               18170000
181800                PV-LINE-NUMBER                                    18180000
181900                                  DELIMITED BY SIZE               18190000
182000                                INTO DP013-MESSAGE-TEXT (2)       18200000
182100         MOVE SQLCA               TO DP013-SQLCA                  18210000
182200         MOVE 'TCEPLDS '          TO DP013-DB2-TABLE-NAME (1)     18220000
182300         SET DP013-DB2-ABEND                                      18230000
182400             DP013-XCTL-DISPLAY-RESTART                           18240000
182500                                  TO TRUE                         18250000
182600         PERFORM DP013-0000-PROCESS-ABEND                         18260000
182700     END-IF.                                                      18270000
182800                                                                  18280000
182900*----------------------------------------------------------------*18290000
183000* CLOSE THE TCEPLDS  CURSOR.                                     *18300000
183100*----------------------------------------------------------------*18310000
183200 5020-CLOSE-CURSOR-TCEPLDS.                                       18320000
183300     EXEC SQL                                                     18330000
183400         CLOSE LINE-ITEM-DSTR-CSR                                 18340000
183500     END-EXEC.                                                    18350000
183600                                                                  18360000
183700     EVALUATE TRUE                                                18370000
183800         WHEN SQLCODE = ZERO                                      18380000
183900             CONTINUE                                             18390000
184000         WHEN SQLWARN0 NOT = SPACES                               18400000
184100         WHEN SQLCODE < ZERO                                      18410000
184200         WHEN SQLCODE > ZERO                                      18420000
184300             MOVE '5020-CLOSE-CURSOR'                             18430000
184400                                  TO DP013-PARAGRAPH              18440000
184500             MOVE 'CLOSE TCEPLDS CURSOR '                         18450000
184600                                  TO DP013-MESSAGE-TEXT (1)       18460000
184700             STRING 'CLOSE ON TCEPLDS CSR FOR PULL NBR = '        18470000
184800                                  DELIMITED BY SIZE               18480000
184900                    PV-PULL-NUMBER                                18490000
185000                                  DELIMITED BY SIZE               18500000
185100                    ' LINE NBR = '                                18510000
185200                                  DELIMITED BY SIZE               18520000
185300                    PV-LINE-NUMBER                                18530000
185400                                  DELIMITED BY SIZE               18540000
185500                                INTO DP013-MESSAGE-TEXT (2)       18550000
185600             MOVE SQLCA           TO DP013-SQLCA                  18560000
185700             MOVE 'TCEPLDS '      TO DP013-DB2-TABLE-NAME (1)     18570000
185800             SET DP013-DB2-ABEND                                  18580000
185900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18590000
186000             PERFORM DP013-0000-PROCESS-ABEND                     18600000
186100     END-EVALUATE.                                                18610000
186200                                                                  18620000
186300*----------------------------------------------------------------*18630000
186400*    FETCH THE TCEPLDS CURSOR.                                   *18640000
186500*----------------------------------------------------------------*18650000
186600 5030-FETCH-CURSOR-TCEPLDS.                                       18660000
186700     EXEC SQL                                                     18670000
186800          FETCH LINE-ITEM-DSTR-CSR                                18680000
186900           INTO  :CEPLDS-STR-NBR                                  18690000
187000               , :CEPLDS-REQ-ORD-QTY                              18700000
187100               , :CEPLDS-ACTL-DISTRB-QTY :PV-NULL-IND-1           18710000
187200     END-EXEC.                                                    18720000
187300                                                                  18730000
187400     EVALUATE TRUE                                                18740000
187500         WHEN SQLCODE = ZERO                                      18750000
187600              ADD +1              TO PV-TABLE-STORE-COUNT         18760000
187700              SET ST-STR-IDX      TO PV-TABLE-STORE-COUNT         18770000
187800              PERFORM 5500-SAVE-QTYS                              18780000
187900         WHEN SQLCODE = +100                                      18790000
188000              SET PS-EOF-TCEPLDS-CSR                              18800000
188100                                  TO TRUE                         18810000
188200         WHEN SQLWARN0 NOT = SPACE                                18820000
188300         WHEN SQLCODE NOT = ZERO                                  18830000
188400              MOVE '5030-FETCH-CURSOR'                            18840000
188500                                  TO DP013-PARAGRAPH              18850000
188600              MOVE 'FETCH TCEPLDS CURSOR'                         18860000
188700                                  TO DP013-MESSAGE-TEXT (1)       18870000
188800              STRING 'FETCH ON TCEPLDS CSR FOR PULL NBR = '       18880000
188900                                  DELIMITED BY SIZE               18890000
189000                     PV-PULL-NUMBER                               18900000
189100                                  DELIMITED BY SIZE               18910000
189200                     ' LINE NBR = '                               18920000
189300                                  DELIMITED BY SIZE               18930000
189400                     PV-LINE-NUMBER                               18940000
189500                                  DELIMITED BY SIZE               18950000
189600                                INTO DP013-MESSAGE-TEXT (2)       18960000
189700              MOVE SQLCA          TO DP013-SQLCA                  18970000
189800              SET DP013-DB2-ABEND                                 18980000
189900                                  TO TRUE                         18990000
190000              PERFORM DP013-0000-PROCESS-ABEND                    19000000
190100     END-EVALUATE.                                                19010000
190200                                                                  19020000
190300*----------------------------------------------------------------*19030000
190400*    SAVE STORE QTYS TO TABLE.                                   *19040000
190500*----------------------------------------------------------------*19050000
190600 5500-SAVE-QTYS.                                                  19060000
190700     MOVE CEPLDS-STR-NBR          TO ST-STR-NBR(ST-STR-IDX).      19070000
190800     IF PV-NULL-IND-1 < +0                                        19080000
190900         MOVE CEPLDS-REQ-ORD-QTY                                  19090000
191000                                  TO ST-PULL-QTY(ST-STR-IDX)      19100000
191100     ELSE                                                         19110000
191200         MOVE CEPLDS-ACTL-DISTRB-QTY                              19120000
191300                                  TO ST-PULL-QTY(ST-STR-IDX)      19130000
191400     END-IF.                                                      19140000
191500     ADD ST-PULL-QTY(ST-STR-IDX)  TO PV-TOTAL-DIST-UNITS.         19150000
191600                                                                  19160000
191700*----------------------------------------------------------------*19170000
191800*    PRINT DETAIL LINES                                          *19180000
191900*----------------------------------------------------------------*19190000
192000 6000-FORMAT-DETAIL-LINES.                                        19200000
192100     MOVE ST-STR-NBR(ST-STR-IDX)  TO DL-STR-NBR(DL-DTL-LNE-IDX).  19210000
192200     MOVE '===>'                  TO DL-ARROWS(DL-DTL-LNE-IDX).   19220000
192300     MOVE ST-PULL-QTY(ST-STR-IDX)                                 19230000
192400                                  TO DL-QTY(DL-DTL-LNE-IDX).      19240000
192500     MOVE '|'                     TO DL-BAR-LINE(DL-DTL-LNE-IDX). 19250000
192600                                                                  19260000
192700     IF PS-DTL-LNE-SUB > PV-STRS-PER-PAGE                         19270000
192800         COMPUTE PV-BLANK-LINES =                                 19280000
192900                              PV-LINES-PER-PAGE - PV-LINE-COUNT   19290000
193000         MOVE DL-BLANK-LINE           TO DRS01-COMM-DATA          19300000
193100         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           19310000
193200         PERFORM 8000-LINK-TO-DRS PV-BLANK-LINES TIMES            19320000
193300                                                                  19330000
193400***      STRING PV-PULL-NUMBER-5-9 DELIMITED BY SIZE              19340000
193500***      STRING PV-PULL-NUMBER-7-9 DELIMITED BY SIZE              19350000
193600***             '-'                DELIMITED BY SIZE              19360000
193700***             PV-DISP-LINE-NUMBER-2-4 DELIMITED BY SIZE         19370000
193800***                                    INTO FL-PULL-NUMBER-HR     19380000
193900         MOVE FL-FOOTER-LINE-HR          TO DRS01-COMM-DATA       19390000
194000         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        19400000
194100         PERFORM 8000-LINK-TO-DRS                                 19410000
194200                                                                  19420000
194300*jpl     MOVE DL-BLANK-LINE              TO DRS01-COMM-DATA       19430000
194400*jpl     MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        19440000
194500*jpl     PERFORM 8000-LINK-TO-DRS                                 19450000
194600                                                                  19460000
194700***      MOVE PV-PULL-NUMBER-5-9     TO PV-BARCODE-PULL-NUMBER    19470000
194800***      MOVE PV-PULL-NUMBER-7-9     TO PV-BARCODE-PULL-NUMBER    19480000
194900***      MOVE PV-LINE-NUMBER-2-4     TO PV-BARCODE-LINE-NUMBER    19490000
195000***      MOVE '2222'                 TO PV-BARCODE                19500000
195100***      MOVE PV-BARCODE             TO PV-IN-DATA                19510000
195200***      PERFORM 4500-CALC-CHECK-DIGIT                            19520000
195300***                                                               19530000
195400***      STRING PC-START-CHAR      DELIMITED BY SIZE              19540000
195500***             PV-BARCODE         DELIMITED BY SIZE              19550000
195600***             PV-CHECK-DIGIT     DELIMITED BY SIZE              19560000
195700***             PC-STOP-CHAR       DELIMITED BY SIZE              19570000
195800***                                    INTO FL-PULL-NUMBER        19580000
195900***                                                               19590000
196000***      MOVE PV-TEST-BARCODE            TO FL-PULL-NUMBER        19600000
196100***                                                               19610000
196200         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        19620000
196300         MOVE FL-FOOTER-LINE-BC          TO DRS01-COMM-DATA       19630000
196400         PERFORM 8000-LINK-TO-DRS                                 19640000
196500                                                                  19650000
196600*jpl     MOVE DL-BLANK-LINE           TO DRS01-COMM-DATA          19660000
196700*jpl     MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           19670000
196800*jpl     PERFORM 8000-LINK-TO-DRS                                 19680000
196900                                                                  19690000
197000         MOVE PV-TABLE-STORE-COUNT    TO FL1-TOTAL-STORES         19700000
197100         MOVE FL-FOOTER-LINE-1        TO DRS01-COMM-DATA          19710000
197200         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           19720000
197300         PERFORM 8000-LINK-TO-DRS                                 19730000
197400                                                                  19740000
197500         MOVE PV-TOTAL-DIST-UNITS        TO FL2-TOTAL-DIST-UNITS  19750000
197600         MOVE FL-FOOTER-LINE-2           TO DRS01-COMM-DATA       19760000
197700         MOVE PC-SINGLE-SPACE            TO DRS01-COMM-CTL        19770000
197800         PERFORM 8000-LINK-TO-DRS                                 19780000
197900                                                                  19790000
198000         MOVE PV-CURRENT-PAGE         TO FL3-CUR-PAGE             19800000
198100         MOVE PV-TOTAL-PAGES          TO FL3-TOT-PAGE             19810000
198200         MOVE FL-FOOTER-LINE-3        TO DRS01-COMM-DATA          19820000
198300         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           19830000
198400         PERFORM 8000-LINK-TO-DRS                                 19840000
198500                                                                  19850000
198600         PERFORM 7000-FORMAT-HEADER-LINES                         19860000
198700         MOVE 1 TO PS-DTL-LNE-SUB                                 19870000
198800     END-IF.                                                      19880000
198900                                                                  19890000
199000     IF DL-DTL-LNE-IDX = 7                                        19900000
199100         MOVE DL-DETAIL-LINE          TO DRS01-COMM-DATA          19910000
199200         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           19920000
199300         PERFORM 8000-LINK-TO-DRS                                 19930000
199400                                                                  19940000
199500         INITIALIZE DL-DETAIL-LINE                                19950000
199600         MOVE DL-DETAIL-UNDERLINE     TO DRS01-COMM-DATA          19960000
199700         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           19970000
199800         PERFORM 8000-LINK-TO-DRS                                 19980000
199900                                                                  19990000
200000         SET DL-DTL-LNE-IDX TO 1                                  20000000
200100         ADD 2 TO PV-LINE-COUNT                                   20010000
200200     ELSE                                                         20020000
200300         SET DL-DTL-LNE-IDX UP BY 1                               20030000
200400     END-IF.                                                      20040000
200500                                                                  20050000
200600     SET ST-STR-IDX UP BY 1.                                      20060000
200700     ADD 1 TO PS-DTL-LNE-SUB.                                     20070000
200800                                                                  20080000
200900*----------------------------------------------------------------*20090000
201000*  WRITE THE DATA TO THE HEADING LINES VIA DRS.                   20100000
201100*----------------------------------------------------------------*20110000
201200 7000-FORMAT-HEADER-LINES.                                        20120000
201300     INITIALIZE DRS01-COMM-DATA.                                  20130000
201400     MOVE PC-PUT                      TO DRS01-DRRB-FUNC.         20140000
201500     ADD 1  TO  PV-CURRENT-PAGE.                                  20150000
201600     SET PS-TOP-OF-PAGE-SET TO TRUE.                              20160000
201700                                                                  20170000
201800     IF PS-REPRINT                                                20180000
201900         MOVE RL1-REPRINT-LINE-1      TO DRS01-COMM-DATA          20190000
202000         MOVE PC-TOP-OF-PAGE          TO DRS01-COMM-CTL           20200000
202100         SET PS-TOP-OF-PAGE-NOT-SET   TO TRUE                     20210000
202200         PERFORM 8000-LINK-TO-DRS                                 20220000
202300     END-IF.                                                      20230000
202400                                                                  20240000
202500     IF PS-TOP-OF-PAGE-SET                                        20250000
202600         SET PS-TOP-OF-PAGE-NOT-SET   TO TRUE                     20260000
202700         MOVE PC-TOP-OF-PAGE          TO DRS01-COMM-CTL           20270000
202800     ELSE                                                         20280000
202900         MOVE DL-BLANK-LINE           TO DRS01-COMM-DATA          20290000
203000         MOVE PC-SINGLE-SPACE         TO DRS01-COMM-CTL           20300000
203100         PERFORM 8000-LINK-TO-DRS                                 20310000
203200     END-IF.                                                      20320000
203300                                                                  20330000
203400     MOVE PV-CURRENT-MONTH            TO DP132-RUN-MONTH.         20340000
203500     MOVE PV-CURRENT-DAY              TO DP132-RUN-DAY.           20350000
203600     MOVE PV-CURRENT-CENTURY-YEAR     TO DP132-RUN-YEAR.          20360000
203700     MOVE ST-SYSTEM-HOUR              TO DP132-RUN-HOUR.          20370000
203800     MOVE ST-SYSTEM-MINUTE            TO DP132-RUN-MINUTE.        20380000
203900     MOVE PC-CURRENT-PROGRAM-NAME     TO DP132-PROGRAM-NAME.      20390000
204000     MOVE 1                           TO DP132-REPORT-NUMBER.     20400000
204100     MOVE PV-CURRENT-PAGE             TO DP132-PAGE-NUMBER.       20410000
204200     MOVE DP132-STANDRD-HEADER-132-COLS                           20420000
204300                                      TO DRS01-COMM-DATA.         20430000
204400     PERFORM 8000-LINK-TO-DRS.                                    20440000
204500                                                                  20450000
204600     IF CEPLIT-STAT-CDE = 'NW'                                    20460000
204700         STRING '***  '               DELIMITED BY SIZE           20470000
204800                'NEW PULL'            DELIMITED BY SIZE           20480000
204900                '  ***'               DELIMITED BY SIZE           20490000
205000                                    INTO HL1-PULL-STATUS          20500000
205100     ELSE                                                         20510000
205200     IF CEPLIT-STAT-CDE = 'CA'                                    20520000
205300         STRING '***  '               DELIMITED BY SIZE           20530000
205400                'CANCELLED'           DELIMITED BY SIZE           20540000
205500                '  ***'               DELIMITED BY SIZE           20550000
205600                                    INTO HL1-PULL-STATUS          20560000
205700     ELSE                                                         20570000
205800     IF CEPLIT-STAT-CDE = 'IP'                                    20580000
205900         STRING '***  '               DELIMITED BY SIZE           20590000
206000                'IN PROCESS'          DELIMITED BY SIZE           20600000
206100                '  ***'               DELIMITED BY SIZE           20610000
206200                                    INTO HL1-PULL-STATUS          20620000
206300     ELSE                                                         20630000
206400     IF CEPLIT-STAT-CDE = 'DS'                                    20640000
206500         STRING '***  '               DELIMITED BY SIZE           20650000
206600                'DISTRIBUTED'         DELIMITED BY SIZE           20660000
206700                '  ***'               DELIMITED BY SIZE           20670000
206800                                    INTO HL1-PULL-STATUS          20680000
206900     ELSE                                                         20690000
207000     IF CEPLIT-STAT-CDE = 'PD'                                    20700000
207100         STRING '***  '               DELIMITED BY SIZE           20710000
207200                'POSTED'              DELIMITED BY SIZE           20720000
207300                '  ***'               DELIMITED BY SIZE           20730000
207400                                    INTO HL1-PULL-STATUS          20740000
207500     ELSE                                                         20750000
207600     IF CEPLIT-STAT-CDE = 'PR'                                    20760000
207700         STRING '***  '               DELIMITED BY SIZE           20770000
207800                'PRINTED'             DELIMITED BY SIZE           20780000
207900                '  ***'               DELIMITED BY SIZE           20790000
208000                                    INTO HL1-PULL-STATUS          20800000
208100     ELSE                                                         20810000
208200         STRING '***  '               DELIMITED BY SIZE           20820000
208300                'NEW PULL'            DELIMITED BY SIZE           20830000
208400                '  ***'               DELIMITED BY SIZE           20840000
208500                                    INTO HL1-PULL-STATUS          20850000
208600     END-IF.                                                      20860000
208700                                                                  20870000
208800     MOVE DL-BLANK-LINE               TO DRS01-COMM-DATA.         20880000
208900     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          20890000
209000     PERFORM 8000-LINK-TO-DRS.                                    20900000
209100                                                                  20910000
209200     MOVE HL1-HEADING-LINE-1          TO DRS01-COMM-DATA.         20920000
209300     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          20930000
209400     PERFORM 8000-LINK-TO-DRS.                                    20940000
209500                                                                  20950000
209600     MOVE DL-BLANK-LINE               TO DRS01-COMM-DATA.         20960000
209700     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          20970000
209800     PERFORM 8000-LINK-TO-DRS.                                    20980000
209900                                                                  20990000
210000     MOVE ENTNME-ENT-NAME-DESC        TO HL2-VENDOR.              21000000
210100     MOVE HL2-HEADING-LINE-2          TO DRS01-COMM-DATA.         21010000
210200     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21020000
210300     PERFORM 8000-LINK-TO-DRS.                                    21030000
210400                                                                  21040000
210500*    MOVE TSK-MERCH-DEPT-NMBR         TO HL3-DEPT-NBR.            21050000
210600*    MOVE TSK-MERCH-CLASS-NMBR        TO HL3-CLASS-NBR.           21060000
210700*    MOVE TSK-SEQ-NMBR                TO HL3-SEQ-NBR.             21070000
210800     MOVE PV-TEMP-SEQ-NBR             TO HL3-SEQ-NBR.             21080000
210900     MOVE CE004-PULL-NBR              TO HL3-PULL-NUMBER.         21090000
211000     MOVE PV-DISP-LINE-NUMBER-2-4     TO HL3-LINE-NUMBER.         21100000
211100     MOVE CEPLRQ-SRC-REF-NBR          TO HL3-REF-NUMBER.          21110000
211200     MOVE HL3-HEADING-LINE-3          TO DRS01-COMM-DATA.         21120000
211300     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21130000
211400     PERFORM 8000-LINK-TO-DRS.                                    21140000
211500                                                                  21150000
211600*    MOVE TSK-SKU-DESC                TO HL4-SKU-DESC.            21160000
211700     MOVE XL001-SKU-DESC              TO HL4-SKU-DESC.            21170000
211800     IF CEPLST-CRE-TMST(1:10) = '* UNKNOWN*'                      21180000
211900         MOVE CEPLST-CRE-TMST(1:10)   TO HL4-PULL-TIMESTAMP       21190000
212000     ELSE                                                         21200000
212100         MOVE CEPLST-CRE-TMST(1:10)   TO PV-REC-TMST              21210000
212200         MOVE PV-REC-YYYY             TO PV-R-YYYY                21220000
212300         MOVE PV-REC-MM               TO PV-R-MM                  21230000
212400         MOVE PV-REC-DD               TO PV-R-DD                  21240000
212500         MOVE PV-R-DATE               TO HL4-PULL-TIMESTAMP       21250000
212600     END-IF.                                                      21260000
212700                                                                  21270000
001900* 04/26/2010 CT started added 'XF'                                21271099
212800     IF CEPLRQ-SRC-TYP-CDE = 'MA'                                 21280000
212900         MOVE 'ADAM'                    TO HL4-PULL-SRC-CD        21290099
213000     ELSE                                                         21300000
213100       IF CEPLRQ-SRC-TYP-CDE = 'MR'                               21310099
213200           MOVE 'INFOREM'               TO HL4-PULL-SRC-CD        21320099
213210       ELSE                                                       21321099
213220         IF CEPLRQ-SRC-TYP-CDE = 'UC'                             21322099
213230             MOVE 'MANUAL'              TO HL4-PULL-SRC-CD        21323099
213240         ELSE                                                     21324099
213250           IF CEPLRQ-SRC-TYP-CDE = 'XF'                           21325099
213260               MOVE 'WMXFR'             TO HL4-PULL-SRC-CD        21326099
213500           END-IF                                                 21350099
213510         END-IF                                                   21351099
213511       END-IF                                                     21351199
213520     END-IF.                                                      21352099
001900* 04/26/2010 CT ended                                             21353099
213600                                                                  21360000
213700     MOVE HL4-HEADING-LINE-4          TO DRS01-COMM-DATA.         21370000
213800     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21380000
213900     PERFORM 8000-LINK-TO-DRS.                                    21390000
214000                                                                  21400000
214100*    MOVE TSK-VENDOR-STYLE-CODE       TO HL5-SKU-STYLE.           21410000
214200     MOVE XL001-VS-NBR                TO HL5-SKU-STYLE.           21420000
214300     MOVE CEPLST-CRE-BY-USR-ID        TO HL5-PULL-USER.           21430000
214400     IF PV-NULL-IND-2 < +0                                        21440000
214500         MOVE CEPLIT-PL-REQ-QTY       TO HL5-PULL-TOTAL           21450000
214600     ELSE                                                         21460000
214700         MOVE CEPLIT-ACTL-PL-QTY      TO HL5-PULL-TOTAL           21470000
214800     END-IF.                                                      21480000
214900     MOVE HL5-HEADING-LINE-5          TO DRS01-COMM-DATA.         21490000
215000     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21500000
215100     PERFORM 8000-LINK-TO-DRS.                                    21510000
215200                                                                  21520000
215300     MOVE CEPLIT-UNT-RTL-AMT          TO HL6-RETAIL.              21530000
215400     MOVE XL071-LOC-NM                TO HL6-LOCATION.            21540000
215500*    MOVE TSK-VEND-OUTR-PACK-QTY      TO HL6-SKU-QTY.             21550000
215600     MOVE XL001-OUTR-PACK-QTY         TO HL6-SKU-QTY.             21560000
215700     MOVE HL6-HEADING-LINE-6          TO DRS01-COMM-DATA.         21570000
215800     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21580000
215900     PERFORM 8000-LINK-TO-DRS.                                    21590000
216000                                                                  21600000
216100     MOVE DL-BLANK-LINE               TO DRS01-COMM-DATA.         21610000
216200     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21620000
216300     PERFORM 8000-LINK-TO-DRS.                                    21630000
216400*JPL 2/28 - added second blank line.                              21640000
216500     MOVE DL-BLANK-LINE               TO DRS01-COMM-DATA.         21650000
216600     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21660000
216700     PERFORM 8000-LINK-TO-DRS.                                    21670000
216800                                                                  21680000
216900*JPL 2/28 - added solid line to top of detail.                    21690000
217000     MOVE DL-DETAIL-SOLIDLINE         TO DRS01-COMM-DATA.         21700000
217100     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21710000
217200     PERFORM 8000-LINK-TO-DRS.                                    21720000
217300                                                                  21730000
217400     MOVE DH1-DETAIL-HEADING-LINE-1   TO DRS01-COMM-DATA.         21740000
217500     MOVE PC-SINGLE-SPACE             TO DRS01-COMM-CTL.          21750000
217600     PERFORM 8000-LINK-TO-DRS.                                    21760000
217700                                                                  21770000
217800*JPL 2/28 - increased line counts to accommodate added lines.     21780000
217900     IF PS-REPRINT                                                21790000
218000***      MOVE 13                      TO PV-LINE-COUNT            21800000
218100         MOVE 15                      TO PV-LINE-COUNT            21810000
218200     ELSE                                                         21820000
218300***      MOVE 11                      TO PV-LINE-COUNT            21830000
218400         MOVE 13                      TO PV-LINE-COUNT            21840000
218500     END-IF.                                                      21850000
218600                                                                  21860000
218700*----------------------------------------------------------------*21870000
218800* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     21880000
218900*----------------------------------------------------------------*21890000
219000 8000-LINK-TO-DRS.                                                21900000
219100                                                                  21910000
219200*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        21920000
219300*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          21930000
219400*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              21940000
219500                                                                  21950000
219600     EXEC CICS                                                    21960000
219700         LINK                                                     21970000
219800             PROGRAM   ('DRS1INTC')                               21980000
219900             COMMAREA  (DRS01-COMMAREA)                           21990000
220000     END-EXEC.                                                    22000000
220100                                                                  22010000
220200     EVALUATE TRUE                                                22020000
220300         WHEN DRS01-DRRB-RC = ZERO                                22030000
220400             CONTINUE                                             22040000
220500         WHEN OTHER                                               22050000
220600             MOVE '8000-LINK-TO-DRS'      TO DP013-PARAGRAPH      22060000
220700             SET DP013-OTHER-ABEND        TO TRUE                 22070000
220800             MOVE DRS01-DRRB-FUNC         TO PV-DRS-DRRB-FUNC     22080000
220900             MOVE DRS01-DRRB-RID          TO PV-DRS-DRRB-RID      22090000
221000             MOVE DRS01-DRRD-OPTIONS      TO PV-DRS-DRRB-OPTIONS  22100000
221100             MOVE DRS01-DRRB-RC           TO PV-DRS-DRRB-RC       22110000
221200             MOVE DRS01-DRRB-ATTR-ERROR   TO PV-DRS-ATTR-ERROR    22120000
221300             MOVE DRS01-DRRB-DRDC         TO PV-DRS-DRRB-DRDC     22130000
221400             MOVE DRS01-DRRB01-LINES      TO PV-DRS-DRRB-LINES    22140000
221500             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      22150000
221600                                       TO DP013-MESSAGE-TEXT (1)  22160000
221700             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      22170000
221800                                       TO DP013-MESSAGE-TEXT (2)  22180000
221900             SET DP013-LINK-RETURN     TO TRUE                    22190000
222000             PERFORM DP013-0000-PROCESS-ABEND                     22200000
222100             GO TO 0000-GOBACK                                    22210000
222200     END-EVALUATE.                                                22220000
222300                                                                  22230000
222400*----------------------------------------------------------------*22240000
222500* THIS MODULE EXECUTES A LINK TO DRS USING COMMAREA 5 WHICH IS    22250000
222600* THE COMBINED DRS REQUEST BLOCK AND OUTPUT BLOCK FOR THE         22260000
222700* CREATION OF OUTPUT JCL STATEMENTS. THESE JCL STATEMENTS ALLOW   22270000
222800* REFERENCING OF PAGEDEF AND FORMDEF STATEMENTS FOR PRINTING AFP  22280000
222900* DOCUMENTS VIA DRS.                                              22290000
223000*----------------------------------------------------------------*22300000
223100 8050-LINK-TO-DRS.                                                22310000
223200                                                                  22320000
223300*  CAUTION:  ANY NON-BLANK CHARACTER IN PRINT POSITION 132        22330000
223400*            WILL CAUSE DOUBLE-SPACING REGARDLESS OF THE          22340000
223500*            CONTENTS OF CARRIAGE CONTROL CHARACTER.              22350000
223600     EXEC CICS                                                    22360000
223700         LINK                                                     22370000
223800             PROGRAM   ('DRS1INTC')                               22380000
223900             COMMAREA  (DRS05-COMMAREA)                           22390000
224000     END-EXEC.                                                    22400000
224100                                                                  22410000
224200     EVALUATE TRUE                                                22420000
224300         WHEN DRS01-DRRB-RC = ZERO                                22430000
224400             CONTINUE                                             22440000
224500         WHEN OTHER                                               22450000
224600             MOVE '8050-LINK-TO-DRS'                              22460000
224700                                     TO DP013-PARAGRAPH           22470000
224800             SET DP013-OTHER-ABEND   TO TRUE                      22480000
224900             MOVE DRS05-DRRB-FUNC    TO PV-DRS-DRRB-FUNC          22490000
225000             MOVE DRS05-DRRB-RID     TO PV-DRS-DRRB-RID           22500000
225100             MOVE DRS05-DRRD-OPTIONS TO PV-DRS-DRRB-OPTIONS       22510000
225200             MOVE DRS05-DRRB-RC      TO PV-DRS-DRRB-RC            22520000
225300             MOVE DRS05-DRRB-ATTR-ERROR                           22530000
225400                                     TO PV-DRS-ATTR-ERROR         22540000
225500             MOVE DRS05-DRRB-DRDC    TO PV-DRS-DRRB-DRDC          22550000
225600             MOVE DRS05-DRRB01-LINES TO PV-DRS-DRRB-LINES         22560000
225700             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      22570000
225800                                     TO DP013-MESSAGE-TEXT (1)    22580000
225900             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      22590000
226000                                     TO DP013-MESSAGE-TEXT (2)    22600000
226100             SET DP013-LINK-RETURN   TO TRUE                      22610000
226200             PERFORM DP013-0000-PROCESS-ABEND                     22620000
226300             GO TO 0000-GOBACK                                    22630000
226400     END-EVALUATE.                                                22640000
226500                                                                  22650000
226600     COPY DPPD013.                                                22660000
