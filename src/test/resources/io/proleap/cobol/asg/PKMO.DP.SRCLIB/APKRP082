000100*-----------------------*                                         00010027
000200 IDENTIFICATION DIVISION.                                         00020027
000300*-----------------------*                                         00030027
000400 PROGRAM-ID.     APKRP082.                                        00040027
000500 AUTHOR.         CHRIS KUNSTMANN IBS.                             00050027
000600 DATE-WRITTEN.   08/03/1998.                                      00060027
000700 DATE-COMPILED.                                                   00070027
000800*---------------------------------------------------------------* 00080027
000900*    COBOL II / DB2                                             * 00090038
001000*                                                               * 00100027
001100*      IMPORT PO COST VARIANCE BY DEPT. REPORT PROGRAM.         * 00110027
001200*                                                               * 00120027
001300* THE PURPOSE OF THIS PROGRAM IS TO PRODUCE A REPORT OF IMPORT  * 00130027
001400* PO'S WITH COST VARIANCE INFORMATION BY DEPARTMENT NUMBER.     * 00140027
001500* THE REPORT LAYOUT AND PROCESSING IS SIMILIAR TO APKRP081,     * 00150038
001600* WITH DEPARTMENT TOTALS AND GRAND TOTALS.                      * 00160038
001700*                                                               * 00170038
001800*  IF THE REPORT LINE SEQUENCE ASSIGNED IN APKUT080 IS CHANGED, * 00180038
001900* LOGIC IN B200-PROCESS-IMPORT-FILE WILL BE IMPACTED.           * 00190038
002000*---------------------------------------------------------------* 00200027
002100*                                                               * 00210027
002200* DB2 TABLES:                                                   * 00220027
002300*  1. IMPORT FREE ON BOARD TABLE           (TIMFOB)             * 00230027
002400*  2. MERCHANDISE AREA TABLE               (TMDSEAR)            * 00240027
002500*                                                               * 00250027
002600* INPUT:                                                        * 00260027
002700*                                                               * 00270027
002800*  1. IMPORT PO COST VARIANCE REPORT DATA  (APRD036)            * 00280027
002900*                                                               * 00290027
003000* OUTPUT:                                                       * 00300027
003100*                                                               * 00310027
003200*  1. IMPORT PO COST VARIANCE REPORT BY DEPARTMENT              * 00320027
003300*                                                               * 00330027
003400*---------------------------------------------------------------* 00340027
003500*   CHANGES:                                                    * 00350027
003600*   8/03/98   CHRIS KUNSTMANN, IBS.      WR4164                 * 00360027
003700*       INITIAL VERSION.                                        * 00370027
003800*                                                               * 00380060
003900* 12/08/1999 JILL JUEL                       WR/IR #: WR6041    * 00390061
004000*            - MODIFIED THE CHECK ON THE DATE ROUTINE TO        * 00400061
004100*              CONFORM WITH Y2K STANDARDS BY ADDING             * 00410061
004200*              DPG54-WARNING-ERROR.                             * 00420061
004300*                                                               * 00430062
004400* 12/08/1999 MIKE BESKE                      WR/IR #: WR20529   * 00440062
004500*            - CHANGED THE CODE AP036-RPT-LINE-SEQ TO CHECK FOR * 00450062
004600*              VALUES = TO M1 AND N1 INSTEAD OF L1 AND M1 RE-   * 00460062
004700*              SPECTIVELY.  THIS WAS DUE TO THE ADDITION OF A   * 00470062
004800*              NEW CHARGE CODE: ROY (ROYALTY).  THESE VALUES FOR* 00480062
004900*              AP036-RPT-LINE-SEQ ARE ASSIGNED IN APKUT080.     * 00490062
005000*                                                               * 00500027
005001* 05/08/2000 W A EHMKE                       WR/IR #: WR20557   * 00500169
005002*            - CHANGED THE CODE TO MOVE AP036-EST-UNT-COST &    * 00500269
005003*              AP036-INV-UNT-COST THE D2 FIELDS.  ADD THESE     * 00500369
005004*              VALUES TO PV-VARIABLES FOR PROCESSING AT TOTAL   * 00500469
005005*              TIME.                                            * 00500569
005006*              PROCESS NEW TOTALS TO THE D3 LINE.               * 00500669
005010*                                                               * 00501069
005020* 04/23/2001 KEVIN CATLIN                    WR/IR #: 21976     * 00502076
005030*            ADDED DETAIL LINE FOR 'TOTAL PAY RELEASED/POSTED'. * 00503073
005040*            THIS LINE WILL PRINT AFTER 'FINAL REPORT TOTALS'   * 00504073
005050*            AND BEFORE 'END OF REPORT'.                        * 00505073
005080*                                                               * 00508070
005090* 08/08/2002 COLBY HANGER EXPENSE PROCESSING.  RECOMPILE FROM   * 00509080
005091*            PRODUCTION TO INCORPORATE COPYBOOK CHANGES.        * 00509177
005092*        BY: KEVIN CATLIN                   WR#: 23254          * 00509279
005093*                                                               * 00509381
005094* 11/04/2002 COLBY DATING PROCESS.  ADDED NEW HEADING FOR NEW   * 00509483
005095*            REPORT TYPE OF AUTO JOURNALIZE.  LOGIC MODIFIED IN * 00509581
005096*            PARAGRAPH B100 TO LOAD THIS NEW HEADING.           * 00509681
005097*        BY: KEVIN CATLIN                   WR#: 23750          * 00509781
005098*                                                               * 00509884
005103* DATE  03/16/2009                                              * 00510386
005104*     CHANGE MADE: RECOMPILE FOR ADDITION OF DMA-NBR TO APRD036 * 00510485
005105*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR31546         * 00510585
005110*---------------------------------------------------------------* 00511027
005200                                                                  00520027
005300 ENVIRONMENT DIVISION.                                            00530027
005400 CONFIGURATION SECTION.                                           00540027
005500 SOURCE-COMPUTER.    IBM-3090.                                    00550027
005600 OBJECT-COMPUTER.    IBM-3090.                                    00560027
005700                                                                  00570027
005800 INPUT-OUTPUT SECTION.                                            00580027
005900 FILE-CONTROL.                                                    00590027
006000                                                                  00600027
006100     SELECT IMPORT-REPORT-FILE   ASSIGN TO UT-S-INP01.            00610027
006200     SELECT REPORT-FILE          ASSIGN TO UT-S-RPT01.            00620027
006300                                                                  00630027
006400                                                                  00640027
006500 DATA DIVISION.                                                   00650027
006600 FILE SECTION.                                                    00660027
006700                                                                  00670027
006800 FD  IMPORT-REPORT-FILE                                           00680027
006900     RECORDING MODE IS F                                          00690027
007000     LABEL RECORDS ARE STANDARD                                   00700027
007100     BLOCK CONTAINS 0 RECORDS                                     00710027
007200     DATA RECORD IS IMPORT-REPORT-REC.                            00720027
007300 01  IMPORT-REPORT-REC           PIC  X(170).                     00730040
007400                                                                  00740027
007500 FD  REPORT-FILE                                                  00750027
007600     RECORDING MODE IS F                                          00760027
007700     LABEL RECORDS ARE STANDARD                                   00770027
007800     BLOCK CONTAINS 0 RECORDS                                     00780027
007900     DATA RECORD IS REPORT-REC.                                   00790027
008000 01  REPORT-REC                  PIC  X(200).                     00800040
008100                                                                  00810027
008200                                                                  00820027
008300 WORKING-STORAGE SECTION.                                         00830027
008400 01  PROGRAM-CONSTANTS.                                           00840027
008500     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKRP082'. 00850027
008600     05  PC-DASH-LIT             PIC  X(30)     VALUE             00860040
008700         '------------------------------'.                        00870027
008800     05  PC-PO-PER-PAGE-MAX      PIC S999       VALUE +2.         00880027
008900     05  PC-RCVING-HEADING.                                       00890049
009000         10  FILLER              PIC  X(45)     VALUE             00900049
009100         'IMPORT PURCHASE ORDERS WITH VERIFIED RECEIPTS'.         00910049
009200         10  FILLER              PIC  X(14)     VALUE             00920049
009300         ' BY DEPARTMENT'.                                        00930049
009400     05  PC-POSTING-HEADING.                                      00940049
009500         10  FILLER              PIC  X(45)     VALUE             00950049
009600         '   IMPORT PURCHASE ORDERS POSTED TO JOURNAL B'.         00960049
009700         10  FILLER              PIC  X(14)     VALUE             00970049
009800         'Y DEPARTMENT  '.                                        00980048
009910     05  PC-AUTOJRNL-HEADING.                                     00991081
009920         10  FILLER              PIC  X(45)     VALUE             00992081
009930         ' IMPORT POS RELEASED FOR AUTO JOURNALIZATION '.         00993081
009940         10  FILLER              PIC  X(14)     VALUE             00994081
009950         'BY DEPARTMENT '.                                        00995081
009960                                                                  00996081
010000 01  PROGRAM-VARIABLES.                                           01000027
010100     05  PV-CURRENT-DATE.                                         01010027
010200         10  PV-CURRENT-YEAR     PIC  9(02)     VALUE ZEROS.      01020027
010300         10  PV-CURRENT-MONTH    PIC  9(02)     VALUE ZEROS.      01030027
010400         10  PV-CURRENT-DAY      PIC  9(02)     VALUE ZEROS.      01040027
010500     05  PV-CURRENT-TIME.                                         01050027
010600         10  PV-CURRENT-HOUR     PIC  9(02)     VALUE ZEROES.     01060027
010700         10  PV-CURRENT-MINUTE   PIC  9(02)     VALUE ZEROES.     01070027
010800         10  FILLER              PIC  9(02)     VALUE ZEROES.     01080027
010900     05  PV-DB2-DATE             PIC  X(10)     VALUE SPACES.     01090027
011000     05  PV-DISPLAY-DATE         PIC  X(10)     VALUE SPACES.     01100027
011100                                                                  01110027
011200* USED FOR PO LEVEL PROCESSING                                    01120027
011300     05  PV-PO-NBR               PIC  X(09)     VALUE SPACES.     01130027
011400     05  PV-PO-NBR-N             REDEFINES      PV-PO-NBR         01140027
011500                                 PIC  9(09).                      01150027
011600     05  PV-FOB-CDE              PIC  X(03)     VALUE SPACES.     01160027
011700     05  PV-FOB-NAME             PIC  X(30)     VALUE SPACES.     01170027
011800     05  PV-DEPT-NBR             PIC  X(03)     VALUE SPACES.     01180027
011900     05  PV-DEPT-DESC            PIC  X(25)     VALUE SPACES.     01190027
012000                                                                  01200027
012100     05  PV-PO-UNT-QTY           PIC S9(9)      VALUE ZEROES.     01210027
012200     05  PV-RCV-UNT-QTY          PIC S9(9)      VALUE ZEROES.     01220027
012300     05  PV-INV-UNT-QTY          PIC S9(9)      VALUE ZEROES.     01230027
012400     05  PV-INV-RCV-QTY          PIC S9(9)      VALUE ZEROES.     01240027
012500     05  PV-RCV-VAR-PCT          PIC S999V99999 VALUE ZEROES.     01250027
012600     05  PV-INV-QTY-VAR-PCT      PIC S999V99999 VALUE ZEROES.     01260027
012700     05  PV-INV-RCV-VAR-PCT      PIC S999V99999 VALUE ZEROES.     01270027
012710     05  PV-EST-UNT-COST        PIC S999V9999   VALUE ZEROES.     01271063
012720     05  PV-INV-UNT-COST        PIC S999V9999   VALUE ZEROES.     01272063
012800                                                                  01280027
012900     05  PV-PO-EST-VAR-AMT       PIC S9(11)V99  VALUE ZEROES.     01290027
013000     05  PV-INV-RCV-VAR-AMT      PIC S9(11)V99  VALUE ZEROES.     01300027
013100     05  PV-LC-INV-RCV-AMT       PIC S9(11)V99  VALUE ZEROES.     01310027
013200     05  PV-PO-INV-COST-AMT      PIC S9(11)V99  VALUE ZEROES.     01320027
013300     05  PV-PO-INV-RCV-AMT       PIC S9(11)V99  VALUE ZEROES.     01330027
013400                                                                  01340027
013500* USED FOR DEPARTMENT LEVEL PROCESSING                            01350027
013600     05  PV-HLD-PO-COST-AMT      PIC S9(11)V99  VALUE ZEROES.     01360027
013700     05  PV-HLD-EST-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     01370027
013800     05  PV-HLD-PO-EST-VAR-AMT   PIC S9(11)V99  VALUE ZEROES.     01380027
013900     05  PV-HLD-RCV-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     01390027
014000     05  PV-HLD-INV-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     01400027
014100     05  PV-HLD-INV-RCV-VAR-AMT  PIC S9(11)V99  VALUE ZEROES.     01410027
014200     05  PV-DEPT-TOTAL-COMP.                                      01420027
014300         10  FILLER              PIC X(13)      VALUE             01430027
014400             '  DEPARTMENT '.                                     01440027
014500         10  PV-DEPT-TOTAL-NBR   PIC X(3)       VALUE SPACES.     01450027
014600         10  FILLER              PIC X(14)      VALUE             01460027
014700             ' TOTALS       '.                                    01470027
014800                                                                  01480027
014900     05  PV-DEPARTMENT-TOTALS    COMP-3.                          01490027
015000         10  PV-DPT-PO-COST-AMT  PIC S9(11)V99  VALUE ZEROES.     01500027
015100         10  PV-DPT-EST-COST-AMT PIC S9(11)V99  VALUE ZEROES.     01510027
015200         10  PV-DPT-PO-EST-COST-AMT                               01520027
015300                                 PIC S9(11)V99  VALUE ZEROES.     01530027
015400         10  PV-DPT-RCV-COST-AMT PIC S9(11)V99  VALUE ZEROES.     01540027
015500         10  PV-DPT-INV-COST-AMT PIC S9(11)V99  VALUE ZEROES.     01550027
015600         10  PV-DPT-INV-RCV-COST-AMT                              01560027
015700                                 PIC S9(11)V99  VALUE ZEROES.     01570027
015800                                                                  01580027
015900* USED FOR FINAL REPORT PROCESSING                                01590027
016000     05  PV-TOT-PO-COST-AMT      PIC S9(11)V99  VALUE ZEROES.     01600027
016100     05  PV-TOT-EST-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     01610027
016200     05  PV-TOT-PO-EST-COST-AMT  PIC S9(11)V99  VALUE ZEROES.     01620027
016300     05  PV-TOT-RCV-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     01630027
016400     05  PV-TOT-INV-COST-AMT     PIC S9(11)V99  VALUE ZEROES.     01640027
016500     05  PV-TOT-INV-RCV-COST-AMT PIC S9(11)V99  VALUE ZEROES.     01650027
016600                                                                  01660027
016700 01  PV-PROCESS-COUNTERS.                                         01670027
016800     05  PV-RETRY-COUNTER        PIC S9(4) COMP VALUE ZEROES.     01680038
016900     05  PV-READ-COUNT           PIC  9(08)     VALUE ZEROES.     01690027
017000     05  PV-PO-READ-COUNT        PIC  9(08)     VALUE ZEROES.     01700027
017100     05  PV-PO-PRINTED-COUNT     PIC  9(08)     VALUE ZEROES.     01710027
017200                                                                  01720027
017300 01  PV-REPORT-CONTROLS.                                          01730027
017400     05  PV-LINE-SKIP            PIC S999       VALUE ZEROES.     01740027
017500     05  PV-PO-PER-PAGE          PIC S999       VALUE +999.       01750027
017600     05  PV-PAGE-COUNT           PIC S9(05)     VALUE ZEROES.     01760027
017700                                                                  01770027
017800 01  PROGRAM-SWITCHES.                                            01780027
017900     05  PS-PO-EOF-SW            PIC  X         VALUE 'N'.        01790027
018000         88  PS-PO-NOT-EOF                      VALUE 'N'.        01800036
018100         88  PS-PO-EOF                          VALUE 'Y'.        01810036
018200                                                                  01820027
018300*----------------------------------------------------------------*01830027
018400*  INPUT RECORD LAYOUT                                            01840027
018500*----------------------------------------------------------------*01850027
018600     COPY APRD036.                                                01860084
018700                                                                  01870027
018800*----------------------------------------------------------------*01880027
018900* WORKING STORAGE FOR DATE ROUTINE                                01890027
019000*----------------------------------------------------------------*01900027
019100     COPY DPWS500.                                                01910084
019200                                                                  01920027
019300*----------------------------------------------------------------*01930027
019400*  STANDARD HEADER LAYOUT                                         01940027
019500*----------------------------------------------------------------*01950027
019600     COPY DPWS200O.                                               01960084
019700                                                                  01970027
019800*----------------------------------------------------------------*01980027
019900*  REPORT LAYOUT                                                  01990027
020000*----------------------------------------------------------------*02000027
020100                                                                  02010027
020200 01  H2-HEADER2.                                                  02020048
020300     05  FILLER                  PIC  X(71)     VALUE SPACES.     02030048
020400     05  H2-TITLE                PIC  X(59)     VALUE SPACES.     02040048
020500*    05  FILLER                  PIC  X(49)     VALUE             02050048
020600*        'IMPORT PURCHASE ORDER COST VARIANCE BY DEPARTMENT'.     02060048
020700     05  FILLER                  PIC  X(70)     VALUE SPACES.     02070048
020800                                                                  02080027
020900 01 H3-HEADER3.                                                   02090027
021000     05  FILLER                  PIC   X(8)     VALUE '  DEPT: '. 02100027
021100     05  H3-DEPT-NUMBER          PIC   XXX      VALUE SPACES.     02110027
021200     05  FILLER                  PIC   XXX      VALUE SPACES.     02120027
021300     05  H3-DEPT-NAME            PIC   X(25)    VALUE SPACES.     02130027
021400     05  FILLER                  PIC   X(15)    VALUE SPACES.     02140027
021500     05  FILLER                  PIC   X(13)    VALUE             02150027
021600         'VENDOR NAME: '.                                         02160027
021700     05  H3-VENDOR-NAME          PIC   X(30)    VALUE SPACES.     02170027
021800     05  FILLER                  PIC   X(09)    VALUE SPACES.     02180027
021900     05  FILLER                  PIC   X(15)    VALUE             02190027
022000         'VENDOR NUMBER: '.                                       02200027
022100     05  H3-VENDOR-NUMBER        PIC   X(9)     VALUE SPACES.     02210027
022200     05  FILLER                  PIC   X(10)    VALUE SPACES.     02220027
022300     05  FILLER                  PIC   X(15)    VALUE             02230027
022400         '1ST  VERIFIED: '.                                       02240027
022500     05  H3-1ST-VERIFIED         PIC   X(10)    VALUE SPACES.     02250027
022600     05  FILLER                  PIC   X(09)    VALUE SPACES.     02260027
022700     05  FILLER                  PIC   X(12)    VALUE             02270027
022800         '% RECEIVED: '.                                          02280027
022900     05  H3-PCT-RECEIVED         PIC   ZZ9.99   VALUE ZEROES.     02290027
023000     05  FILLER                  PIC   X        VALUE '%'.        02300027
023100     05  FILLER                  PIC   X(07)    VALUE SPACES.     02310027
023200                                                                  02320027
023300 01 H4-HEADER4.                                                   02330027
023400     05  FILLER                  PIC   X(14)    VALUE             02340027
023500         '  PO NUMBER : '.                                        02350027
023600     05  H4-PO-NUMBER            PIC   Z(9)     VALUE SPACES.     02360027
023700     05  FILLER                  PIC   X(07)    VALUE SPACES.     02370027
023800     05  FILLER                  PIC   X(11)    VALUE             02380027
023900         'PO STATUS: '.                                           02390027
024000     05  H4-PO-STATUS            PIC   XX       VALUE SPACES.     02400027
024100     05  FILLER                  PIC   X(11)    VALUE SPACES.     02410027
024200     05  FILLER                  PIC   X(13)    VALUE             02420027
024300         'FOB POINT  : '.                                         02430027
024400     05  H4-FOB-POINT            PIC   X(30)    VALUE SPACES.     02440027
024500     05  FILLER                  PIC   X(09)    VALUE SPACES.     02450027
024600     05  FILLER                  PIC   X(15)    VALUE             02460027
024700         '1ST INVOICED : '.                                       02470027
024800     05  H4-1ST-INVOICED         PIC   X(10)    VALUE SPACES.     02480027
024900     05  FILLER                  PIC   X(09)    VALUE SPACES.     02490027
025000     05  FILLER                  PIC   X(15)    VALUE             02500027
025100         'LAST VERIFIED: '.                                       02510027
025200     05  H4-LAST-VERIFIED        PIC   X(10)    VALUE SPACES.     02520034
025300     05  FILLER                  PIC   X(09)    VALUE SPACES.     02530027
025400     05  FILLER                  PIC   X(12)    VALUE             02540027
025500         'OTB PERIOD: '.                                          02550027
025600     05  H4-OTB-PERIOD.                                           02560052
025700         10  H4-OTB-MONTH        PIC   X(03)    VALUE SPACES.     02570053
025800         10  H4-OTB-COMMA        PIC   X(02)    VALUE ', '.       02580052
025900         10  H4-OTB-YEAR         PIC   X(04)    VALUE SPACES.     02590052
026000     05  FILLER                  PIC   X(05)    VALUE SPACES.     02600027
026100                                                                  02610027
026200 01 H5-HEADER5.                                                   02620027
026300     05  FILLER                  PIC   X(38)    VALUE SPACES.     02630027
026400     05  FILLER                  PIC   X(8)     VALUE             02640027
026500         'PURCHASE'.                                              02650027
026600     05  FILLER                  PIC   X(11)    VALUE SPACES.     02660027
026700     05  FILLER                  PIC   X(9)     VALUE             02670027
026800         'ESTIMATED'.                                             02680027
026900     05  FILLER                  PIC   X(8)     VALUE SPACES.     02690030
027000     05  FILLER                  PIC   X(8)     VALUE 'COST PER'. 02700029
027100     05  FILLER                  PIC   X(08)    VALUE SPACES.     02710030
027200     05  FILLER                  PIC   X(6)     VALUE 'PO VS.'.   02720027
027300     05  FILLER                  PIC   X(12)    VALUE SPACES.     02730027
027400     05  FILLER                  PIC   X(8)     VALUE             02740027
027500         'VERIFIED'.                                              02750027
027600     05  FILLER                  PIC   X(28)    VALUE SPACES.     02760030
027700     05  FILLER                  PIC   X(08)    VALUE             02770027
027800         'COST PER'.                                              02780027
027900     05  FILLER                  PIC   X(04)    VALUE SPACES.     02790030
028000     05  FILLER                  PIC   X(03)    VALUE 'PCT'.      02800027
028100     05  FILLER                  PIC   X(07)    VALUE SPACES.     02810027
028200     05  FILLER                  PIC   X(03)    VALUE 'PCT'.      02820027
028300     05  FILLER                  PIC   X(09)    VALUE SPACES.     02830027
028400     05  FILLER                  PIC   X(11)    VALUE             02840027
028500         'INVOICED VS'.                                           02850027
028600     05  FILLER                  PIC   X(07)    VALUE SPACES.     02860027
028700     05  FILLER                  PIC   X(03)    VALUE 'PCT'.      02870027
028800     05  FILLER                  PIC   X(03)    VALUE SPACES.     02880027
028900                                                                  02890027
029000 01  H6-HEADER6.                                                  02900027
029100     05  FILLER                  PIC   X(26)    VALUE             02910027
029200         '     COMPONENT DESCRIPTION'.                            02920027
029300     05  FILLER                  PIC   X(13)    VALUE SPACES.     02930027
029400     05  FILLER                  PIC   X(05)    VALUE 'ORDER'.    02940027
029500     05  FILLER                  PIC   X(12)    VALUE SPACES.     02950027
029600     05  FILLER                  PIC   X(11)    VALUE             02960027
029700         'LANDED COST'.                                           02970027
029800     05  FILLER                  PIC   X(09)    VALUE SPACES.     02980030
029900     05  FILLER                  PIC   X(04)    VALUE 'UNIT'.     02990029
030000     05  FILLER                  PIC   X(11)    VALUE SPACES.     03000030
030100     05  FILLER                  PIC   X(03)    VALUE 'ELC'.      03010027
030200     05  FILLER                  PIC   X(14)    VALUE SPACES.     03020027
030300     05  FILLER                  PIC   X(08)    VALUE 'RECEIPTS'. 03030027
030400     05  FILLER                  PIC   X(12)    VALUE SPACES.     03040027
030500     05  FILLER                  PIC   X(08)    VALUE 'INVOICED'. 03050027
030600     05  FILLER                  PIC   X(10)    VALUE SPACES.     03060030
030700     05  FILLER                  PIC   X(04)    VALUE 'UNIT'.     03070027
030800     05  FILLER                  PIC   X(05)    VALUE SPACES.     03080030
030900     05  FILLER                  PIC   X(05)    VALUE 'TO FC'.    03090027
031000     05  FILLER                  PIC   X(05)    VALUE SPACES.     03100027
031100     05  FILLER                  PIC   X(05)    VALUE 'TO LC'.    03110027
031200     05  FILLER                  PIC   X(09)    VALUE SPACES.     03120027
031300     05  FILLER                  PIC   X(08)    VALUE 'VERIFIED'. 03130027
031400     05  FILLER                  PIC   X(09)    VALUE SPACES.     03140027
031500     05  FILLER                  PIC   X(03)    VALUE 'VAR'.      03150027
031600     05  FILLER                  PIC   X(01)    VALUE SPACES.     03160027
031700                                                                  03170027
031800 01  H7-DASHLINE.                                                 03180027
031900     05  FILLER                  PIC   X(01)    VALUE SPACES.     03190027
032000     05  H7-DASH1                PIC   X(30)    VALUE             03200027
032100         '------------------------------'.                        03210027
032200     05  FILLER                  PIC   X(02)    VALUE SPACES.     03220027
032300     05  H7-DASH2                PIC   X(18)    VALUE             03230027
032400         '------------------'.                                    03240027
032500     05  FILLER                  PIC   X(02)    VALUE SPACES.     03250027
032600     05  H7-DASH3                PIC   X(18)    VALUE             03260027
032700         '------------------'.                                    03270027
032800     05  FILLER                  PIC   X(02)    VALUE SPACES.     03280027
032900     05  H7-DASH4                PIC   X(09)    VALUE             03290027
033000         '---------'.                                             03300027
033100     05  FILLER                  PIC   X(01)    VALUE SPACES.     03310027
033200     05  H7-DASH5                PIC   X(18)    VALUE             03320027
033300         '------------------'.                                    03330027
033400     05  FILLER                  PIC   X(02)    VALUE SPACES.     03340027
033500     05  H7-DASH6                PIC   X(18)    VALUE             03350027
033600         '------------------'.                                    03360027
033700     05  FILLER                  PIC   X(02)    VALUE SPACES.     03370027
033800     05  FILLER                  PIC   X(18)    VALUE             03380027
033900         '------------------'.                                    03390027
034000     05  FILLER                  PIC   X(02)    VALUE SPACES.     03400027
034100     05  H7-DASH7                PIC   X(09)    VALUE             03410027
034200         '---------'.                                             03420027
034300     05  FILLER                  PIC   X(02)    VALUE SPACES.     03430027
034400     05  H7-DASH8                PIC   X(08)    VALUE             03440027
034500         '--------'.                                              03450027
034600     05  FILLER                  PIC   X(02)    VALUE SPACES.     03460027
034700     05  H7-DASH9                PIC   X(08)    VALUE             03470027
034800         '--------'.                                              03480027
034900     05  FILLER                  PIC   X(01)    VALUE SPACES.     03490027
035000     05  FILLER                  PIC   X(18)    VALUE             03500027
035100         '------------------'.                                    03510027
035200     05  FILLER                  PIC   X(01)    VALUE SPACES.     03520027
035300     05  H7-DASH10               PIC   X(08)    VALUE             03530027
035400         '--------'.                                              03540027
035500                                                                  03550027
035600 01 D1-DETAIL1.                                                   03560027
035700     05  FILLER                  PIC   X(7)     VALUE ' UNITS'.   03570027
035800     05  FILLER                  PIC   X(30)    VALUE SPACES.     03580027
035900     05  D1-PO-UNITS             PIC   ZZZ,ZZZ,ZZ9                03590027
036000                                                VALUE ZEROES.     03600027
036100     05  FILLER                  PIC   X(9)     VALUE SPACES.     03610027
036200     05  D1-ELC-UNITS            PIC   ZZZ,ZZZ,ZZ9                03620027
036300                                                VALUE ZEROES.     03630027
036400     05  FILLER                  PIC   X(39)    VALUE SPACES.     03640027
036500     05  D1-RCV-UNITS            PIC   ZZZ,ZZZ,ZZ9                03650027
036600                                                VALUE ZEROES.     03660027
036700     05  FILLER                  PIC   X(9)     VALUE SPACES.     03670027
036800     05  D1-INV-UNITS            PIC   ZZZ,ZZZ,ZZ9                03680027
036900                                                VALUE ZEROES.     03690027
037000     05  FILLER                  PIC   X(39)    VALUE SPACES.     03700027
037100     05  D1-RCV-VAR-UNITS        PIC   ---,---,--9                03710044
037200                                                VALUE ZEROES.     03720027
037300     05  FILLER                  PIC   X(4)     VALUE SPACES.     03730027
037400     05  D1-PCT-VAR              PIC   ---9.99  VALUE ZEROES.     03740027
037500     05  FILLER                  PIC   X        VALUE '%'.        03750027
037600                                                                  03760027
037700 01  D2-DETAIL2.                                                  03770027
037800     05  FILLER                  PIC   X        VALUE SPACES.     03780027
037900     05  D2-COMPNT-DESC          PIC   X(30)    VALUE SPACES.     03790027
038000     05  FILLER                  PIC   XX       VALUE SPACES.     03800027
038100     05  D2-PO-COST-ALPHA        PIC   X(18)    VALUE SPACES.     03810027
038200     05  D2-PO-COST-EDIT         REDEFINES      D2-PO-COST-ALPHA. 03820027
038300         10  D2-PO-COST          PIC   --,---,---,--9.99.         03830027
038400         10  D2-PO-COST-RP       PIC   X.                         03840027
038500     05  FILLER                  PIC   XX       VALUE SPACES.     03850027
038600     05  D2-EST-COST-ALPHA       PIC   X(18)    VALUE SPACES.     03860027
038700     05  D2-EST-COST-EDIT        REDEFINES      D2-EST-COST-ALPHA.03870027
038800         10  D2-EST-COST         PIC   --,---,---,--9.99.         03880027
038900         10  D2-EST-COST-RP      PIC   X.                         03890027
039000     05  FILLER                  PIC   XX       VALUE SPACES.     03900027
039100     05  D2-EST-COST-UNIT-ALPHA  PIC   X(09)    VALUE SPACES.     03910027
039200     05  D2-EST-COST-UNIT-EDIT   REDEFINES D2-EST-COST-UNIT-ALPHA.03920027
039300         10  D2-EST-COST-UNIT    PIC   --9.9999.                  03930027
039400         10  D2-EST-COST-UNIT-RP PIC   X.                         03940027
039500     05  FILLER                  PIC   X        VALUE SPACES.     03950027
039600     05  D2-PO-EST-VAR-ALPHA     PIC   X(18)    VALUE SPACES.     03960027
039700     05  D2-PO-EST-VAR-EDIT      REDEFINES    D2-PO-EST-VAR-ALPHA.03970027
039800         10  D2-PO-EST-VAR       PIC   --,---,---,--9.99.         03980027
039900         10  D2-PO-EST-VAR-RP    PIC   X.                         03990027
040000     05  FILLER                  PIC   XX       VALUE SPACES.     04000027
040100     05  D2-RCV-COST-ALPHA       PIC   X(18)    VALUE SPACES.     04010027
040200     05  D2-RCV-COST-EDIT        REDEFINES      D2-RCV-COST-ALPHA.04020027
040300         10  D2-RCV-COST         PIC   --,---,---,--9.99.         04030027
040400         10  D2-RCV-COST-RP      PIC   X.                         04040027
040500     05  FILLER                  PIC   XX       VALUE SPACES.     04050027
040600     05  D2-INV-COST             PIC   --,---,---,--9.99          04060027
040700                                                VALUE ZEROES.     04070027
040800     05  D2-INV-COST-RP          PIC   X        VALUE SPACES.     04080027
040900     05  FILLER                  PIC   XX       VALUE SPACES.     04090027
041000     05  D2-INV-COST-UNIT-ALPHA  PIC   X(9)     VALUE SPACES.     04100027
041100     05  D2-INV-COST-UNIT-EDIT   REDEFINES D2-INV-COST-UNIT-ALPHA.04110027
041200         10  D2-INV-COST-UNIT    PIC   --9.9999.                  04120027
041300         10  D2-INV-COST-UNIT-RP PIC   X.                         04130027
041400     05  FILLER                  PIC   XX       VALUE SPACES.     04140027
041500     05  D2-PCT-TO-FC-ALPHA      PIC   X(8)     VALUE SPACES.     04150027
041600     05  D2-PCT-TO-FC-EDIT       REDEFINES     D2-PCT-TO-FC-ALPHA.04160027
041700         10  D2-PCT-TO-FC        PIC   -9.9999.                   04170027
041800         10  D2-PCT-TO-FC-RP     PIC   X.                         04180027
041900     05  FILLER                  PIC   XX       VALUE SPACES.     04190027
042000     05  D2-PCT-TO-LC-ALPHA      PIC   X(8)     VALUE SPACES.     04200027
042100     05  D2-PCT-TO-LC-EDIT       REDEFINES     D2-PCT-TO-LC-ALPHA.04210027
042200         10  D2-PCT-TO-LC        PIC   -9.9999.                   04220027
042300         10  D2-PCT-TO-LC-RP     PIC   X.                         04230027
042400     05  FILLER                  PIC   X        VALUE SPACES.     04240027
042500     05  D2-INV-RCV-VAR          PIC   --,---,---,--9.99          04250027
042600                                                VALUE ZEROES.     04260027
042700     05  D2-INV-RCV-VAR-RP       PIC   X        VALUE SPACES.     04270027
042800     05  FILLER                  PIC   X        VALUE SPACES.     04280027
042900     05  D2-PCT-VAR-ALPHA        PIC   X(8)     VALUE SPACES.     04290027
043000     05  D2-PCT-VAR-EDIT         REDEFINES      D2-PCT-VAR-ALPHA. 04300027
043100         10  D2-PCT-VAR          PIC   ---9.99.                   04310027
043200         10  D2-PCT-VAR-SYMBOL   PIC   X.                         04320027
043300                                                                  04330027
043400 01  D3-DETAIL3.                                                  04340027
043500     05  FILLER                  PIC   X        VALUE SPACES.     04350027
043600     05  D3-COMPNT-DESC          PIC   X(30)    VALUE SPACES.     04360027
043700*    05  FILLER                  PIC   X(92)    VALUE SPACES.     04370063
043710     05  FILLER                  PIC   X(41)    VALUE SPACES.     04371063
043720     05  D3-EST-UNT-COST         PIC   --9.9999 VALUE ZEROES.     04372063
043730     05  D3-EST-UNT-COST-RP      PIC   X(1)    VALUE SPACES.      04373064
043740     05  FILLER                  PIC   X(42)    VALUE SPACES.     04374063
043800     05  D3-INV-COST             PIC   --,---,---,--9.99          04380027
043900                                                VALUE ZEROES.     04390027
044000     05  D3-INV-COST-RP          PIC   X        VALUE SPACES.     04400027
044100*    05  FILLER                  PIC   X(32)    VALUE SPACES.     04410063
044110     05  FILLER                  PIC   X(01)    VALUE SPACES.     04411063
044120     05  D3-INV-UNT-COST         PIC   --9.9999 VALUE SPACES.     04412063
044130     05  D3-INV-UNT-COST-RP      PIC   X(01)    VALUE SPACES.     04413064
044140     05  FILLER                  PIC   X(22)    VALUE SPACES.     04414068
044200     05  D3-INV-RCV-VAR          PIC   --,---,---,--9.99          04420027
044300                                                VALUE ZEROES.     04430027
044400     05  D3-INV-RCV-VAR-RP       PIC   X        VALUE SPACES.     04440027
044500     05  FILLER                  PIC   X(09)    VALUE SPACES.     04450027
044600                                                                  04460027
044710 01  D4-DETAIL4.                                                  04471071
044720     05  FILLER                  PIC   X        VALUE SPACES.     04472071
044730     05  D4-COMPNT-DESC          PIC   X(30)    VALUE SPACES.     04473071
044740     05  FILLER                  PIC   X(9)     VALUE SPACES.     04474076
044750     05  D4-TOT-PAY-RLSE-POST    PIC   ZZ,ZZZ,ZZ9                 04475071
044751                                                VALUE ZEROES.     04475171
044790     05  FILLER                  PIC   X(150)   VALUE SPACES.     04479076
044791                                                                  04479171
044792                                                                  04479271
044800*     FINAL TOTAL HEADINGS.                                       04480027
044900 01 T1-HEADER1.                                                   04490027
045000     05  FILLER                  PIC   X(38)    VALUE SPACES.     04500027
045100     05  FILLER                  PIC   X(8)     VALUE             04510027
045200         'PURCHASE'.                                              04520027
045300     05  FILLER                  PIC   X(11)    VALUE SPACES.     04530027
045400     05  FILLER                  PIC   X(9)     VALUE             04540027
045500         'ESTIMATED'.                                             04550027
045600     05  FILLER                  PIC   X(24)    VALUE SPACES.     04560027
045700     05  FILLER                  PIC   X(6)     VALUE 'PO VS.'.   04570027
045800     05  FILLER                  PIC   X(12)    VALUE SPACES.     04580027
045900     05  FILLER                  PIC   X(8)     VALUE             04590027
046000         'VERIFIED'.                                              04600027
046100     05  FILLER                  PIC   X(35)    VALUE SPACES.     04610027
046200     05  FILLER                  PIC   X(27)    VALUE SPACES.     04620027
046300     05  FILLER                  PIC   X(11)    VALUE             04630027
046400         'INVOICED VS'.                                           04640027
046500     05  FILLER                  PIC   X(13)    VALUE SPACES.     04650027
046600                                                                  04660027
046700 01  T2-HEADER2.                                                  04670027
046800     05  FILLER                  PIC   X(39)    VALUE SPACES.     04680027
046900     05  FILLER                  PIC   X(05)    VALUE 'ORDER'.    04690027
047000     05  FILLER                  PIC   X(12)    VALUE SPACES.     04700027
047100     05  FILLER                  PIC   X(11)    VALUE             04710027
047200         'LANDED COST'.                                           04720027
047300     05  FILLER                  PIC   X(24)    VALUE SPACES.     04730027
047400     05  FILLER                  PIC   X(03)    VALUE 'ELC'.      04740027
047500     05  FILLER                  PIC   X(14)    VALUE SPACES.     04750027
047600     05  FILLER                  PIC   X(08)    VALUE 'RECEIPTS'. 04760027
047700     05  FILLER                  PIC   X(12)    VALUE SPACES.     04770027
047800     05  FILLER                  PIC   X(08)    VALUE 'INVOICED'. 04780027
047900     05  FILLER                  PIC   X(43)    VALUE SPACES.     04790027
048000     05  FILLER                  PIC   X(08)    VALUE 'VERIFIED'. 04800027
048100     05  FILLER                  PIC   X(13)    VALUE SPACES.     04810027
048200                                                                  04820027
048300 01  END-OF-REPORT.                                               04830027
048400     05  FILLER                  PIC  X(81)   VALUE SPACES.       04840027
048500     05  FILLER                  PIC  X(37)   VALUE               04850027
048600         '**********  END OF REPORT  **********'.                 04860027
048700     05  FILLER                  PIC  X(82)   VALUE SPACES.       04870027
048800                                                                  04880027
048900*-----------------------------------------------------------      04890038
049000*    SQL COMMUNICATIONS AREA DCLGEN                               04900027
049100*-----------------------------------------------------------      04910038
049200     EXEC SQL                                                     04920027
049300         INCLUDE SQLCA                                            04930027
049400     END-EXEC.                                                    04940027
049500                                                                  04950038
049600*-----------------------------------------------------------      04960027
049700*    TIMFOB DCLGEN                                                04970027
049800*-----------------------------------------------------------      04980027
049900     EXEC SQL                                                     04990027
050000         INCLUDE TIMFOB                                           05000027
050100     END-EXEC.                                                    05010027
050200                                                                  05020038
050300*-----------------------------------------------------------      05030027
050400*    TMDSEAR DCLGEN                                               05040027
050500*-----------------------------------------------------------      05050027
050600     EXEC SQL                                                     05060027
050700         INCLUDE TMDSEAR                                          05070027
050800     END-EXEC.                                                    05080027
050900                                                                  05090038
051000*-----------------------------------------------------------      05100027
051100*  ABEND DATA AREAS                                               05110027
051200*-----------------------------------------------------------      05120027
051300 01  ABEND-CODE                  PIC S9(4)      VALUE ZEROES      05130027
051400                                 COMP           SYNC.             05140027
051500                                                                  05150027
051600     88  AC-ANY-ERROR                           VALUE +4001       05160027
051700                                                THRU  +4019.      05170027
051800     88  AC-INVALID-KEY-WRITE                   VALUE +4001.      05180027
051900     88  AC-INVALID-KEY-READ                    VALUE +4002.      05190027
052000     88  AC-INVALID-CONTROL-CARD                VALUE +4003.      05200027
052100     88  AC-TABLE-OVERFLOW                      VALUE +4004.      05210027
052200     88  AC-OPEN-FILE-ERROR                     VALUE +4005.      05220027
052300     88  AC-CLOSE-FILE-ERROR                    VALUE +4006.      05230027
052400     88  AC-SEQUENCE-ERROR                      VALUE +4007.      05240027
052500     88  AC-INVALID-DATA                        VALUE +4008.      05250027
052600     88  AC-INVALID-KEYPUNCH                    VALUE +4009.      05260027
052900     88  AC-INTERNAL-SORT-ERROR                 VALUE +4012.      05290027
053000     88  AC-DB2-ERROR                           VALUE +4013.      05300027
053100     88  AC-DPWS500-DATE-ERROR                  VALUE +4019.      05310027
053200                                                                  05320027
053300                                                                  05330027
053400 01  ABEND-AREAS.                                                 05340027
053500     05  AA-ABEND-LIT            PIC  X(40)  VALUE                05350027
053600             '*****       ABEND'.                                 05360027
053700     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                05370027
053800             '*****   PROGRAM: APKRP082'.                         05380027
053900     05  AA-PARAGRAPH-LIT.                                        05390027
054000         10  FILLER              PIC  X(17)  VALUE                05400027
054100             '***** PARAGRAPH: '.                                 05410027
054200         10  AA-PARAGRAPH-NAME   PIC  X(35)  VALUE SPACES.        05420027
054300     05  AA-MESSAGE-LINE.                                         05430027
054400         10  FILLER              PIC  X(06)  VALUE '*****'.       05440027
054500         10  AA-MESSAGE.                                          05450027
054600             15 AA-MESS-1        PIC  X(30)  VALUE SPACES.        05460027
054700             15 AA-MESS-2        PIC  X(97)  VALUE SPACES.        05470027
054800     05  AA-DB2-ERROR-LIT        PIC  X(40)  VALUE                05480027
054900             '*****    DB2 ERROR'.                                05490027
055000     05  AA-DB2-OPERATION-LIT.                                    05500027
055100         10  FILLER              PIC  X(17)  VALUE                05510027
055200             '***** OPERATION: '.                                 05520027
055300         10  AA-DB2-OPERATION.                                    05530027
055400             15  AA-DB2-OP-1     PIC  X(25)  VALUE SPACES.        05540027
055500             15  AA-DB2-OP-2     PIC  X(25)  VALUE SPACES.        05550027
055600     05  AA-DB2-TABLE-1          PIC  X(08)  VALUE SPACES.        05560027
055700     05  AA-DB2-TABLE-2          PIC  X(08)  VALUE SPACES.        05570027
055800     05  AA-DB2-TABLE-3          PIC  X(08)  VALUE SPACES.        05580027
055900                                                                  05590027
056000*-----------------------------------------------------------      05600027
056100*  SQLCA FORMATTED MESSAGE AREA                                   05610027
056200*-----------------------------------------------------------      05620027
056300     COPY DPWS004.                                                05630027
056400                                                                  05640027
056500 01  FILLER                      PIC  X(25)  VALUE                05650027
056600     '** END OF APKRP082 W/S **'.                                 05660027
056700                                                                  05670027
056800 PROCEDURE DIVISION.                                              05680027
056900 A100-MAIN.                                                       05690027
057000                                                                  05700027
057100     PERFORM B100-INITIALIZE.                                     05710027
057200                                                                  05720027
057300     PERFORM B200-PROCESS-IMPORT-FILE                             05730027
057400         UNTIL PS-PO-EOF.                                         05740027
057500                                                                  05750027
057600     PERFORM B300-END-OF-PROGRAM.                                 05760027
057700                                                                  05770027
057800     GOBACK.                                                      05780027
057900                                                                  05790027
058000                                                                  05800027
058100 B100-INITIALIZE.                                                 05810038
058200*----------------------------------------------------------------*05820027
058300*    INITIALIZATION PROCESSING                                   *05830027
058400*                                                                *05840038
058500*    - OPEN FILES.                                               *05850038
058600*    - FORMAT PAGE HEADINGS.                                     *05860038
058700*    - READ INPUT FILE.                                          *05870038
058800*    - PROCESS HEADER RECORD DATA.                               *05880038
058900*----------------------------------------------------------------*05890027
059000                                                                  05900027
059100     OPEN INPUT  IMPORT-REPORT-FILE                               05910027
059200          OUTPUT REPORT-FILE.                                     05920027
059300                                                                  05930027
059400*    - FORMAT PAGE HEADINGS.                                     *05940038
059500     ACCEPT PV-CURRENT-DATE FROM DATE.                            05950027
059600     MOVE PV-CURRENT-MONTH       TO DP200O-RUN-MONTH.             05960027
059700     MOVE PV-CURRENT-DAY         TO DP200O-RUN-DAY.               05970027
059800     MOVE PV-CURRENT-YEAR        TO DP200O-RUN-YEAR.              05980027
059900                                                                  05990027
060000     ACCEPT PV-CURRENT-TIME FROM TIME.                            06000027
060100     MOVE PV-CURRENT-HOUR        TO DP200O-RUN-HOUR.              06010027
060200     MOVE PV-CURRENT-MINUTE      TO DP200O-RUN-MINUTE.            06020027
060300     MOVE PC-PROGRAM-NAME        TO DP200O-PROGRAM-NAME.          06030027
060400     MOVE 1                      TO DP200O-REPORT-NUMBER.         06040027
060500                                                                  06050027
060600*    - READ INPUT FILE.                                          *06060038
060700     PERFORM R100-READ-INPUT.                                     06070027
060800     IF PS-PO-EOF                                                 06080027
060900         DISPLAY ' NO RECORDS TO PROCESS. EMPTY INPUT DATASET'    06090027
061000     END-IF                                                       06100027
061100     .                                                            06110027
061200                                                                  06120048
061300     IF AP036-POSTING-RPT                                         06130048
061400         MOVE PC-POSTING-HEADING TO H2-TITLE                      06140048
061500     ELSE                                                         06150048
061510         IF AP036-AUTO-JRNLD-RPT                                  06151081
061520             MOVE PC-AUTOJRNL-HEADING TO H2-TITLE                 06152081
061530         ELSE                                                     06153081
061600             MOVE PC-RCVING-HEADING  TO H2-TITLE                  06160081
061700         END-IF                                                   06170081
061710     END-IF.                                                      06171081
061800                                                                  06180027
061900*    - PROCESS HEADER RECORD DATA.                               *06190038
062000     IF PS-PO-NOT-EOF                                             06200036
062100         PERFORM C100-PROCESS-HEADER                              06210036
062200     END-IF                                                       06220036
062300     .                                                            06230036
062400                                                                  06240027
062500                                                                  06250027
062600 B200-PROCESS-IMPORT-FILE.                                        06260038
062700*----------------------------------------------------------------*06270027
062800*    PROCESS IMPORT FILE.                                        *06280038
062900*                                                                *06290038
063000*    - IF A PO HEADER RECORD IS READ;                            *06300038
063100*      - IF NEW DEPT, PROCESS DEPT TOTALS, FORCE A PAGE BREAK    *06310038
063200*         FOR THE NEXT PO, AND PROCESS THE NEW PO HEADER DATA.   *06320038
063300*      - IF NEW PO, ACCUMULATE PO TOTAL DATA FOR DEPT., PRINT    *06330038
063400*         BLANK LINE FOR SPACING BETWEEN POS, AND PROCESS THE    *06340038
063500*         NEW PO HEADER DATA.                                    *06350038
063600*    - IF A PO DETAIL RECORD IS READ, PROCESS DETAIL DATA        *06360038
063700*       DEPENDING ON RPT LINE SEQ AND PRINT THE DETAIL LINE.     *06370038
063800*    - READ THE IMPORT FILE.                                     *06380038
063900*----------------------------------------------------------------*06390027
064000                                                                  06400027
064100*    - IF A PO HEADER RECORD IS READ;                            *06410038
064200     IF AP036-HEADER                                              06420038
064300*    - IF NEW DEPT, PROCESS DEPT TOTALS, FORCE A PAGE BREAK      *06430038
064400*       FOR THE NEXT PO, AND PROCESS THE NEW PO HEADER DATA.     *06440038
064500         IF AP036-DEPT-NBR NOT = PV-DEPT-NBR                      06450038
064600             PERFORM D100-PROCESS-DEPT-TOTALS                     06460038
064700                                                                  06470027
064800             MOVE PC-PO-PER-PAGE-MAX                              06480038
064900                                 TO PV-PO-PER-PAGE                06490038
065000             PERFORM C100-PROCESS-HEADER                          06500038
065100         END-IF                                                   06510038
065200                                                                  06520027
065300*    - IF NEW PO, ACCUMULATE PO TOTAL DATA FOR DEPT., PRINT      *06530038
065400*       BLANK LINE FOR SPACING BETWEEN POS, AND PROCESS THE      *06540038
065500*       NEW PO HEADER DATA.                                      *06550038
065600         IF AP036-PO-NBR NOT = PV-PO-NBR                          06560038
065700             ADD PV-HLD-PO-COST-AMT                               06570027
065800                                 TO PV-DPT-PO-COST-AMT            06580027
065900             ADD PV-HLD-EST-COST-AMT                              06590027
066000                                 TO PV-DPT-EST-COST-AMT           06600027
066100             ADD PV-HLD-PO-EST-VAR-AMT                            06610027
066200                                 TO PV-DPT-PO-EST-COST-AMT        06620027
066300             ADD PV-HLD-RCV-COST-AMT                              06630027
066400                                 TO PV-DPT-RCV-COST-AMT           06640027
066500             ADD PV-HLD-INV-COST-AMT                              06650027
066600                                 TO PV-DPT-INV-COST-AMT           06660027
066700             ADD PV-HLD-INV-RCV-VAR-AMT                           06670027
066800                                 TO PV-DPT-INV-RCV-COST-AMT       06680027
066900             MOVE SPACES         TO REPORT-REC                    06690027
067000             MOVE +4             TO PV-LINE-SKIP                  06700027
067100             PERFORM W300-PRINT-DETAIL                            06710027
067200             PERFORM C100-PROCESS-HEADER                          06720027
067300         END-IF                                                   06730027
067400     END-IF.                                                      06740027
067500                                                                  06750027
067600*    - IF A PO DETAIL RECORD IS READ, PROCESS DETAIL DATA        *06760038
067700*       DEPENDING ON RPT LINE SEQ AND PRINT THE DETAIL LINE.     *06770038
067800     IF AP036-DETAIL                                              06780027
067900         MOVE AP036-COMPONENT-DESC                                06790027
068000                                 TO D2-COMPNT-DESC                06800027
068100         IF AP036-RPT-LINE-SEQ = 'M1'                             06810059
068200*                                  'LANDED COST    '              06820027
068300             PERFORM C250-PROCESS-TOTAL-LC                        06830027
068400         ELSE                                                     06840027
068500             IF AP036-RPT-LINE-SEQ = 'N1'                         06850059
068600*                                  'LANDED COST LOAD - INTERNAL'  06860027
068700                 PERFORM C300-PROCESS-LCL                         06870027
068800             ELSE                                                 06880027
068900                 PERFORM C200-PROCESS-COMPONENTS                  06890027
069000             END-IF                                               06900027
069100         END-IF                                                   06910027
069200         PERFORM W300-PRINT-DETAIL                                06920027
069300     END-IF.                                                      06930027
069400                                                                  06940027
069500     PERFORM R100-READ-INPUT.                                     06950027
069600                                                                  06960027
069700                                                                  06970027
069800 B300-END-OF-PROGRAM.                                             06980038
069900*----------------------------------------------------------------*06990027
070000*    END OF PROGRAM PROCESSING                                   *07000038
070100*                                                                *07010038
070200*    - PROCESS DEPT TOTALS HERE.                                 *07020038
070300*----------------------------------------------------------------*07030027
070400                                                                  07040027
070500     IF PV-READ-COUNT > ZEROES                                    07050037
070600*  PROCESS DEPT TOTALS HERE.                                      07060027
070700         PERFORM D100-PROCESS-DEPT-TOTALS                         07070037
070800         PERFORM D200-PROCESS-FINAL-TOTALS                        07080037
070900     END-IF.                                                      07090037
071000                                                                  07100027
071100     WRITE REPORT-REC FROM END-OF-REPORT AFTER 2.                 07110027
071200                                                                  07120027
071300     DISPLAY '** END OF APKRP082 PROCESSING **'.                  07130027
071400     DISPLAY '** PO''S READ             = ' PV-PO-READ-COUNT.     07140027
071500     DISPLAY '** TOTAL RECORDS READ    = ' PV-READ-COUNT.         07150027
071600     DISPLAY ' ' .                                                07160027
071700     DISPLAY '** PO''S PRINTED          = ' PV-PO-PRINTED-COUNT.  07170027
071800                                                                  07180027
071900     CLOSE IMPORT-REPORT-FILE                                     07190027
072000           REPORT-FILE.                                           07200027
072100                                                                  07210027
072200                                                                  07220027
072300 C100-PROCESS-HEADER.                                             07230027
072400*----------------------------------------------------------------*07240027
072500*    PROCESS HEADER RECORD.                                      *07250038
072600*                                                                *07260038
072700*    - SET UP SAVED FIELDS FOR THE NEW PO.                       *07270038
072800*    - GET DB2 DATA FOR REPORT.                                  *07280038
072900*    - FORMAT HEADER DATA TO THE REPORT HEADINGS, DETAIL LINES.  *07290038
073000*----------------------------------------------------------------*07300027
073100                                                                  07310027
073200     MOVE AP036-PO-NBR           TO PV-PO-NBR.                    07320027
073300     MOVE AP036-FOB-CDE          TO PV-FOB-CDE.                   07330027
073400     MOVE AP036-DEPT-NBR         TO PV-DEPT-NBR.                  07340027
073500                                                                  07350038
073600*    - GET DB2 DATA FOR REPORT.                                  *07360038
073700     PERFORM S100-GET-FOB-NAME.                                   07370027
073800     PERFORM S200-GET-DEPT-DESC.                                  07380027
073900                                                                  07390038
074000*    - FORMAT HEADER DATA TO THE REPORT HEADINGS, DETAIL LINES.  *07400038
074100     PERFORM F100-FORMAT-HEADER.                                  07410027
074200                                                                  07420027
074300                                                                  07430027
074400 C200-PROCESS-COMPONENTS.                                         07440038
074500*----------------------------------------------------------------*07450027
074600*    PROCESS DETAIL DATA (COMPONENTS).                           *07460038
074700*                                                                *07470038
074800*    - FORMAT DATA TO DETAIL REPORT LINE.                        *07480038
074900*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *07490038
075000*       COMPUTE VARIANCES AND ACCUMULATE FOR THE LANDED COST     *07500038
075100*       TOTAL.                                                   *07510038
075200*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *07520038
075300*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *07530038
075400*----------------------------------------------------------------*07540027
075500                                                                  07550027
075600*    - FORMAT DATA TO DETAIL REPORT LINE.                        *07560038
075700*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *07570038
075800*       COMPUTE VARIANCES AND ACCUMULATE FOR THE LANDED COST     *07580038
075900*       TOTAL.                                                   *07590038
076000     IF AP036-PO-COST-AMT = ZEROES                                07600027
076100         MOVE SPACES             TO D2-PO-COST-ALPHA              07610027
076200     ELSE                                                         07620027
076300         MOVE AP036-PO-COST-AMT  TO D2-PO-COST                    07630027
076400         IF AP036-PO-COST-AMT < ZERO                              07640027
076500             INSPECT D2-PO-COST                                   07650027
076600               REPLACING ALL '-' BY '('                           07660027
076700             MOVE ')'            TO D2-PO-COST-RP                 07670027
076800         ELSE                                                     07680027
076900             MOVE ' '            TO D2-PO-COST-RP                 07690027
077000         END-IF                                                   07700027
077100     END-IF.                                                      07710027
077200                                                                  07720027
077300     MOVE AP036-EST-COST-AMT     TO D2-EST-COST.                  07730027
077400     IF AP036-EST-COST-AMT < ZERO                                 07740027
077500         INSPECT D2-EST-COST                                      07750027
077600           REPLACING ALL '-' BY '('                               07760027
077700         MOVE ')'                TO D2-EST-COST-RP                07770027
077800     ELSE                                                         07780027
077900         MOVE ' '                TO D2-EST-COST-RP                07790027
078000     END-IF.                                                      07800027
078100                                                                  07810027
078200     MOVE AP036-EST-UNT-COST     TO D2-EST-COST-UNIT.             07820027
078300     IF AP036-EST-UNT-COST < ZERO                                 07830027
078400         INSPECT D2-EST-COST-UNIT                                 07840027
078500           REPLACING ALL '-' BY '('                               07850027
078600         MOVE ')'                TO D2-EST-COST-UNIT-RP           07860027
078700     ELSE                                                         07870027
078800         MOVE ' '                TO D2-EST-COST-UNIT-RP           07880027
078900     END-IF.                                                      07890027
079000                                                                  07900027
079100     IF AP036-PO-COST-AMT > ZEROES                                07910027
079200         COMPUTE PV-PO-EST-VAR-AMT =                              07920027
079300            ( AP036-PO-COST-AMT - AP036-EST-COST-AMT )            07930027
079400         MOVE PV-PO-EST-VAR-AMT TO D2-PO-EST-VAR                  07940027
079500         IF PV-PO-EST-VAR-AMT < ZERO                              07950027
079600             INSPECT D2-PO-EST-VAR                                07960027
079700               REPLACING ALL '-' BY '('                           07970027
079800             MOVE ')'            TO D2-PO-EST-VAR-RP              07980027
079900         ELSE                                                     07990027
080000             MOVE ' '            TO D2-PO-EST-VAR-RP              08000027
080100         END-IF                                                   08010027
080200     ELSE                                                         08020027
080300         MOVE SPACES             TO D2-PO-EST-VAR-ALPHA           08030027
080400     END-IF.                                                      08040027
080500                                                                  08050027
080600     MOVE AP036-RCV-COST-AMT     TO D2-RCV-COST.                  08060027
080700     IF AP036-RCV-COST-AMT < ZERO                                 08070027
080800         INSPECT D2-RCV-COST                                      08080027
080900           REPLACING ALL '-' BY '('                               08090027
081000         MOVE ')'                TO D2-RCV-COST-RP                08100027
081100     ELSE                                                         08110027
081200         MOVE ' '                TO D2-RCV-COST-RP                08120027
081300     END-IF.                                                      08130027
081400                                                                  08140027
081500     MOVE AP036-INV-COST-AMT     TO D2-INV-COST.                  08150027
081600     IF AP036-INV-COST-AMT < ZERO                                 08160027
081700         INSPECT D2-INV-COST                                      08170027
081800           REPLACING ALL '-' BY '('                               08180027
081900         MOVE ')'                TO D2-INV-COST-RP                08190027
082000     ELSE                                                         08200027
082100         MOVE ' '                TO D2-INV-COST-RP                08210027
082200     END-IF.                                                      08220027
082300                                                                  08230027
082400     MOVE AP036-INV-UNT-COST     TO D2-INV-COST-UNIT.             08240027
082500     IF AP036-INV-UNT-COST < ZERO                                 08250027
082600         INSPECT D2-INV-COST-UNIT                                 08260027
082700           REPLACING ALL '-' BY '('                               08270027
082800         MOVE ')'                TO D2-INV-COST-UNIT-RP           08280027
082900     ELSE                                                         08290027
083000         MOVE ' '                TO D2-INV-COST-UNIT-RP           08300027
083100     END-IF.                                                      08310027
083200                                                                  08320027
083300     MOVE AP036-INV-PCT-TO-FC    TO D2-PCT-TO-FC.                 08330027
083400     IF AP036-INV-PCT-TO-FC < ZERO                                08340027
083500     INSPECT D2-PCT-TO-FC                                         08350027
083600           REPLACING ALL '-' BY '('                               08360027
083700         MOVE ')'                TO D2-PCT-TO-FC-RP               08370027
083800     ELSE                                                         08380027
083900         MOVE ' '                TO D2-PCT-TO-FC-RP               08390027
084000     END-IF.                                                      08400027
084100                                                                  08410027
084200     MOVE AP036-INV-PCT-TO-LC    TO D2-PCT-TO-LC.                 08420027
084300     IF AP036-INV-PCT-TO-LC < ZERO                                08430027
084400         INSPECT D2-PCT-TO-LC                                     08440027
084500           REPLACING ALL '-' BY '('                               08450027
084600         MOVE ')'                TO D2-PCT-TO-LC-RP               08460027
084700     ELSE                                                         08470027
084800         MOVE ' '                TO D2-PCT-TO-LC-RP               08480027
084900     END-IF.                                                      08490027
085000                                                                  08500027
085100     COMPUTE PV-INV-RCV-VAR-AMT =                                 08510027
085200        ( AP036-INV-COST-AMT - AP036-RCV-COST-AMT ).              08520027
085300     ADD PV-INV-RCV-VAR-AMT      TO PV-LC-INV-RCV-AMT.            08530027
085400     MOVE PV-INV-RCV-VAR-AMT     TO D2-INV-RCV-VAR.               08540027
085500     IF PV-INV-RCV-VAR-AMT < ZERO                                 08550027
085600         INSPECT D2-INV-RCV-VAR                                   08560027
085700           REPLACING ALL '-' BY '('                               08570027
085800         MOVE ')'                TO D2-INV-RCV-VAR-RP             08580027
085900     ELSE                                                         08590027
086000         MOVE ' '                TO D2-INV-RCV-VAR-RP             08600027
086100     END-IF.                                                      08610027
086200                                                                  08620027
086300     IF AP036-INV-COST-AMT NOT = ZEROES                           08630047
086400         COMPUTE PV-INV-RCV-VAR-PCT = ( ( PV-INV-RCV-VAR-AMT      08640027
086500            / AP036-INV-COST-AMT ) * 100 ) + .005                 08650027
086600     ELSE                                                         08660027
086700         IF PV-INV-RCV-VAR-AMT = ZEROES                           08670047
086800             MOVE ZEROES         TO PV-INV-RCV-VAR-PCT            08680047
086900         ELSE                                                     08690047
087000             IF PV-INV-RCV-VAR-AMT < ZEROES                       08700047
087100                 MOVE -100.00000 TO PV-INV-RCV-VAR-PCT            08710047
087200             ELSE                                                 08720047
087300                 MOVE 100.00000  TO PV-INV-RCV-VAR-PCT            08730047
087400             END-IF                                               08740047
087500         END-IF                                                   08750047
087600     END-IF.                                                      08760045
087700     MOVE PV-INV-RCV-VAR-PCT     TO D2-PCT-VAR.                   08770027
087800     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            08780027
087900                                                                  08790027
088000*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *08800038
088100*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *08810038
088200     MOVE D2-DETAIL2             TO REPORT-REC.                   08820027
088300     MOVE +1                     TO PV-LINE-SKIP.                 08830027
088400                                                                  08840027
088500                                                                  08850027
088600 C250-PROCESS-TOTAL-LC.                                           08860027
088700*----------------------------------------------------------------*08870027
088800*    PROCESS THE 'TOT' RECORD (LANDED COST).                     *08880041
088900*                                                                *08890039
089000*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *08900039
089100*    - FORMAT DATA TO DETAIL REPORT LINE.                        *08910039
089200*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *08920039
089300*    - COMPUTE ESTIMATED LANDED COST VARIANCE.                   *08930039
089400*    - COMPUTE INVOICE RECEIVING VARIANCE PERCENT.               *08940039
089500*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *08950039
089600*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *08960039
089700*----------------------------------------------------------------*08970027
089800                                                                  08980027
089900*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *08990039
090000     MOVE SPACES                 TO                               09000063
090100             H7-DASH6   H7-DASH2    H7-DASH8   H7-DASH9           09010027
090200                                    H7-DASH5   H7-DASH10.         09020027
090300     MOVE H7-DASHLINE            TO REPORT-REC.                   09030027
090400     MOVE +1                     TO PV-LINE-SKIP.                 09040027
090500     PERFORM W300-PRINT-DETAIL.                                   09050027
090600                                                                  09060027
090700*    - FORMAT DATA TO DETAIL REPORT LINE.                        *09070039
090800*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *09080039
090900     IF AP036-PO-COST-AMT = ZEROES                                09090027
091000         MOVE SPACES             TO D2-PO-COST-ALPHA              09100027
091100     ELSE                                                         09110027
091200         MOVE AP036-PO-COST-AMT  TO D2-PO-COST                    09120027
091300                                    PV-HLD-PO-COST-AMT            09130027
091400         IF AP036-PO-COST-AMT < ZERO                              09140027
091500             INSPECT D2-PO-COST                                   09150027
091600               REPLACING ALL '-' BY '('                           09160027
091700             MOVE ')'            TO D2-PO-COST-RP                 09170027
091800         ELSE                                                     09180027
091900             MOVE ' '            TO D2-PO-COST-RP                 09190027
092000         END-IF                                                   09200027
092100     END-IF.                                                      09210027
092200     MOVE AP036-EST-COST-AMT     TO D2-EST-COST                   09220027
092300                                    PV-HLD-EST-COST-AMT.          09230027
092400     IF AP036-EST-COST-AMT < ZERO                                 09240027
092500         INSPECT D2-EST-COST                                      09250027
092600           REPLACING ALL '-' BY '('                               09260027
092700         MOVE ')'                TO D2-EST-COST-RP                09270027
092800     ELSE                                                         09280027
092900         MOVE ' '                TO D2-EST-COST-RP                09290027
093000     END-IF.                                                      09300027
093100                                                                  09310027
093200     MOVE SPACES                 TO D2-EST-COST-UNIT-ALPHA.       09320027
093300                                                                  09330027
093331     MOVE AP036-EST-UNT-COST     TO D2-EST-COST-UNIT.             09333165
093332     ADD  AP036-EST-UNT-COST     TO PV-EST-UNT-COST.              09333263
093340     IF AP036-EST-UNT-COST  < ZERO                                09334065
093350         INSPECT D2-EST-COST-UNIT                                 09335066
093360           REPLACING ALL  '-'  BY '('                             09336063
093370         MOVE  ')'               TO D2-EST-COST-UNIT-RP           09337065
093380     ELSE                                                         09338063
093390         MOVE  ' '               TO D2-EST-COST-UNIT-RP           09339065
093391     END-IF.                                                      09339163
093392                                                                  09339263
093400*    - COMPUTE ESTIMATED LANDED COST VARIANCE.                   *09340039
093500     IF AP036-PO-COST-AMT > ZEROES                                09350027
093600         COMPUTE PV-PO-EST-VAR-AMT =                              09360027
093700            ( AP036-PO-COST-AMT - AP036-EST-COST-AMT )            09370027
093800         MOVE PV-PO-EST-VAR-AMT TO D2-PO-EST-VAR                  09380027
093900                                   PV-HLD-PO-EST-VAR-AMT          09390027
094000         IF PV-PO-EST-VAR-AMT < ZERO                              09400027
094100             INSPECT D2-PO-EST-VAR                                09410027
094200               REPLACING ALL '-' BY '('                           09420027
094300             MOVE ')'            TO D2-PO-EST-VAR-RP              09430027
094400         ELSE                                                     09440027
094500             MOVE ' '            TO D2-PO-EST-VAR-RP              09450027
094600         END-IF                                                   09460027
094700     ELSE                                                         09470027
094800         MOVE SPACES             TO D2-PO-EST-VAR-ALPHA           09480027
094900     END-IF.                                                      09490027
095000                                                                  09500027
095100     MOVE AP036-RCV-COST-AMT     TO D2-RCV-COST                   09510027
095200                                    PV-HLD-RCV-COST-AMT           09520027
095300     IF AP036-RCV-COST-AMT < ZERO                                 09530027
095400         INSPECT D2-RCV-COST                                      09540027
095500           REPLACING ALL '-' BY '('                               09550027
095600         MOVE ')'                TO D2-RCV-COST-RP                09560027
095700     ELSE                                                         09570027
095800         MOVE ' '                TO D2-RCV-COST-RP                09580027
095900     END-IF.                                                      09590027
096000     MOVE AP036-INV-COST-AMT     TO D2-INV-COST                   09600027
096100                                    PV-PO-INV-COST-AMT            09610027
096200                                    PV-HLD-INV-COST-AMT.          09620027
096300     IF AP036-INV-COST-AMT < ZERO                                 09630027
096400         INSPECT D2-INV-COST                                      09640027
096500           REPLACING ALL '-' BY '('                               09650027
096600         MOVE ')'                TO D2-INV-COST-RP                09660027
096700     ELSE                                                         09670027
096800         MOVE ' '                TO D2-INV-COST-RP                09680027
096900     END-IF.                                                      09690027
097000                                                                  09700027
097001     MOVE SPACES                 TO D2-INV-COST-UNIT-ALPHA.       09700164
097002                                                                  09700264
097030     MOVE AP036-INV-UNT-COST     TO D2-INV-COST-UNIT.             09703064
097040     ADD  AP036-INV-UNT-COST     TO PV-INV-UNT-COST.              09704064
097050     IF AP036-INV-UNT-COST  < ZERO                                09705063
097060         INSPECT D2-INV-COST-UNIT                                 09706067
097070           REPLACING ALL  '-'  BY '('                             09707063
097080         MOVE  ')'               TO D2-INV-COST-UNIT-RP           09708064
097090     ELSE                                                         09709063
097091         MOVE  ' '               TO D2-INV-COST-UNIT-RP           09709164
097092     END-IF.                                                      09709263
097093                                                                  09709363
097100*    MOVE SPACES                 TO D2-INV-COST-UNIT-ALPHA        09710064
097110                                                                  09711064
097200     MOVE SPACES                 TO D2-PCT-TO-FC-ALPHA            09720064
097300                                    D2-PCT-TO-LC-ALPHA.           09730027
097400                                                                  09740027
097500     MOVE PV-LC-INV-RCV-AMT      TO D2-INV-RCV-VAR                09750027
097600                                    PV-PO-INV-RCV-AMT             09760027
097700                                    PV-HLD-INV-RCV-VAR-AMT.       09770027
097800     IF PV-LC-INV-RCV-AMT < ZERO                                  09780027
097900         INSPECT D2-INV-RCV-VAR                                   09790027
098000           REPLACING ALL '-' BY '('                               09800027
098100         MOVE ')'                TO D2-INV-RCV-VAR-RP             09810027
098200     ELSE                                                         09820027
098300         MOVE ' '                TO D2-INV-RCV-VAR-RP             09830027
098400     END-IF.                                                      09840027
098500                                                                  09850027
098600*    - COMPUTE INVOICE RECEIVING VARIANCE PERCENT.               *09860039
098700     IF AP036-INV-COST-AMT NOT = ZEROES                           09870047
098800         COMPUTE PV-INV-RCV-VAR-PCT = ( ( PV-LC-INV-RCV-AMT       09880027
098900            / AP036-INV-COST-AMT ) * 100 ) + .005                 09890027
099000     ELSE                                                         09900045
099100         IF PV-LC-INV-RCV-AMT = ZEROES                            09910047
099200             MOVE ZEROES         TO PV-INV-RCV-VAR-PCT            09920047
099300         ELSE                                                     09930047
099400             IF PV-LC-INV-RCV-AMT < ZEROES                        09940047
099500                 MOVE -100.00000 TO PV-INV-RCV-VAR-PCT            09950047
099600             ELSE                                                 09960047
099700                 MOVE 100.00000  TO PV-INV-RCV-VAR-PCT            09970047
099800             END-IF                                               09980047
099900         END-IF                                                   09990047
100000     END-IF.                                                      10000045
100100     MOVE PV-INV-RCV-VAR-PCT     TO D2-PCT-VAR.                   10010027
100200     MOVE '%'                    TO D2-PCT-VAR-SYMBOL.            10020027
100300                                                                  10030027
100400*    - MOVE THE DETAIL LINE TO THE REPORT RECORD.                *10040039
100500*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *10050039
100600     MOVE D2-DETAIL2             TO REPORT-REC.                   10060027
100700     MOVE +1                     TO PV-LINE-SKIP.                 10070027
100800                                                                  10080027
100900     MOVE ZEROES                 TO PV-LC-INV-RCV-AMT.            10090027
101000                                                                  10100027
101100                                                                  10110027
101200 C300-PROCESS-LCL.                                                10120027
101300*----------------------------------------------------------------*10130027
101400*    PROCESS THE LCL RECORD HERE                                 *10140041
101500*                                                                *10150039
101600*    - FORMAT DATA TO DETAIL REPORT LINE.                        *10160039
101700*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10170039
101800*    - MOVE THE DETAIL LINE TO THE REPORT RECORD AND PRINT.      *10180039
101900*                                                                *10190039
102000*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *10200039
102100*                                                                *10210039
102200*    - FORMAT PO TOTAL DATA TO DETAIL REPORT LINE.               *10220039
102300*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10230039
102400*    - COMPUTE INVOICE COST AND INVOICE RECEIVING VARIANCE.      *10240039
102500*    - MOVE THE TOTAL LINE TO THE REPORT RECORD.                 *10250039
102600*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *10260039
102700*----------------------------------------------------------------*10270027
102800                                                                  10280027
102900*    - FORMAT DATA TO DETAIL REPORT LINE.                        *10290039
103000*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10300039
103100     MOVE SPACES                 TO D2-PO-COST-ALPHA              10310027
103200                                    D2-EST-COST-ALPHA             10320027
103300                                    D2-EST-COST-UNIT-ALPHA        10330027
103400                                    D2-PO-EST-VAR-ALPHA           10340027
103500                                    D2-RCV-COST-ALPHA             10350027
103600                                    D2-INV-COST-UNIT-ALPHA        10360027
103700                                    D2-PCT-TO-FC-ALPHA            10370027
103800                                    D2-PCT-VAR-ALPHA.             10380027
103900                                                                  10390027
104000     MOVE AP036-INV-COST-AMT     TO D2-INV-COST                   10400027
104100                                    D2-INV-RCV-VAR.               10410027
104200     IF AP036-INV-COST-AMT < ZERO                                 10420027
104300         INSPECT D2-INV-COST                                      10430027
104400           REPLACING ALL '-' BY '('                               10440027
104500         INSPECT D2-INV-RCV-VAR                                   10450027
104600           REPLACING ALL '-' BY '('                               10460027
104700         MOVE ')'                TO D2-INV-COST-RP                10470027
104800                                    D2-INV-RCV-VAR-RP             10480027
104900     ELSE                                                         10490027
105000         MOVE ' '                TO D2-INV-COST-RP                10500027
105100                                    D2-INV-RCV-VAR-RP             10510027
105200     END-IF.                                                      10520027
105300                                                                  10530027
105400     MOVE AP036-INV-PCT-TO-LC    TO D2-PCT-TO-LC.                 10540027
105500     IF AP036-INV-PCT-TO-LC < ZERO                                10550027
105600         INSPECT D2-PCT-TO-LC                                     10560027
105700           REPLACING ALL '-' BY '('                               10570027
105800         MOVE ')'                TO D2-PCT-TO-LC-RP               10580027
105900     ELSE                                                         10590027
106000         MOVE ' '                TO D2-PCT-TO-LC-RP               10600027
106100     END-IF.                                                      10610027
106200                                                                  10620027
106300*    - MOVE THE DETAIL LINE TO THE REPORT RECORD AND PRINT.      *10630039
106400     MOVE D2-DETAIL2             TO REPORT-REC.                   10640027
106500     MOVE +2                     TO PV-LINE-SKIP.                 10650027
106600     PERFORM W300-PRINT-DETAIL.                                   10660027
106700                                                                  10670027
106800*    - FORMAT AND PRINT DASHLINE FOR REPORT.                     *10680039
106900     MOVE SPACES                 TO H7-DASH1                      10690027
107000         H7-DASH3                                                 10700027
107100              H7-DASH2   H7-DASH4   H7-DASH5   H7-DASH6           10710027
107200              H7-DASH7   H7-DASH8   H7-DASH9   H7-DASH10          10720027
107300     MOVE H7-DASHLINE            TO REPORT-REC.                   10730027
107400     MOVE +1                     TO PV-LINE-SKIP.                 10740027
107500     PERFORM W300-PRINT-DETAIL.                                   10750027
107600                                                                  10760027
107700                                                                  10770027
107800*    - FORMAT PO TOTAL DATA TO DETAIL REPORT LINE.               *10780039
107900*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *10790039
108000     MOVE SPACES                 TO D3-COMPNT-DESC.               10800027
108100     MOVE 'TOTAL PO COST '       TO D3-COMPNT-DESC.               10810027
108200                                                                  10820027
108210     MOVE PV-EST-UNT-COST        TO D3-EST-UNT-COST.              10821064
108220     IF PV-EST-UNT-COST  < ZERO                                   10822064
108230         INSPECT D3-EST-UNT-COST                                  10823064
108240             REPLACING ALL '-'  BY '('                            10824064
108250             MOVE  ')'           TO D3-EST-UNT-COST-RP            10825064
108260     ELSE                                                         10826064
108270             MOVE  ' '           TO D3-EST-UNT-COST-RP            10827064
108280     END-IF.                                                      10828064
108290                                                                  10829064
108300*    - COMPUTE INVOICE COST AND INVOICE RECEIVING VARIANCE.      *10830039
108400     COMPUTE PV-PO-INV-COST-AMT =                                 10840027
108500         ( PV-PO-INV-COST-AMT + AP036-INV-COST-AMT ).             10850027
108600     MOVE PV-PO-INV-COST-AMT     TO D3-INV-COST                   10860027
108700                                    PV-HLD-INV-COST-AMT.          10870027
108800     IF PV-PO-INV-COST-AMT < ZERO                                 10880027
108900         INSPECT D3-INV-COST                                      10890027
109000           REPLACING ALL '-' BY '('                               10900027
109100         MOVE ')'                TO D3-INV-COST-RP                10910027
109200     ELSE                                                         10920027
109300         MOVE ' '                TO D3-INV-COST-RP                10930027
109400     END-IF.                                                      10940027
109500                                                                  10950027
109520     MOVE PV-INV-UNT-COST        TO D3-INV-UNT-COST.              10952064
109530     IF PV-INV-UNT-COST  < ZERO                                   10953064
109540         INSPECT D3-EST-UNT-COST                                  10954064
109550             REPLACING ALL '-'  BY '('                            10955064
109560             MOVE  ')'           TO D3-INV-UNT-COST-RP            10956064
109570     ELSE                                                         10957064
109580             MOVE  ' '           TO D3-INV-UNT-COST-RP            10958064
109590     END-IF.                                                      10959064
109591                                                                  10959164
109600     COMPUTE PV-PO-INV-RCV-AMT =                                  10960027
109700         ( PV-PO-INV-RCV-AMT + AP036-INV-COST-AMT )               10970027
109800     MOVE PV-PO-INV-RCV-AMT      TO D3-INV-RCV-VAR                10980027
109900                                    PV-HLD-INV-RCV-VAR-AMT        10990027
110000     IF PV-PO-INV-RCV-AMT < ZERO                                  11000027
110100         INSPECT D3-INV-RCV-VAR                                   11010027
110200           REPLACING ALL '-' BY '('                               11020027
110300         MOVE ')'                TO D3-INV-RCV-VAR-RP             11030027
110400     ELSE                                                         11040027
110500         MOVE ' '                TO D3-INV-RCV-VAR-RP             11050027
110600     END-IF.                                                      11060027
110700                                                                  11070027
110800*    - MOVE THE TOTAL LINE TO THE REPORT RECORD.                 *11080039
110900*       THIS LINE WILL BE PRINTED IN B200- PARAGRAPH.            *11090039
111000     MOVE D3-DETAIL3             TO REPORT-REC.                   11100027
111100     MOVE +2                     TO PV-LINE-SKIP.                 11110027
111200                                                                  11120027
111300     INITIALIZE  PV-EST-UNT-COST                                  11130064
111301                 PV-INV-UNT-COST.                                 11130164
111310                                                                  11131064
111320                                                                  11132064
111330                                                                  11133064
111400 D100-PROCESS-DEPT-TOTALS.                                        11140027
111500*----------------------------------------------------------------*11150027
111600*    PROCESSING DEPARTMENT TOTALS.                               *11160039
111700*                                                                *11170039
111800*    - ACCUMULATE LAST POS TOTALS TO THE DEPT TOTAL FIELDS.      *11180039
111900*    - FORMAT DATA TO DETAIL REPORT LINE.                        *11190039
112000*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *11200039
112100*    - PRINT DEPT TOTALS.                                        *11210039
112200*    - ACCUMULATE REPORT TOTALS FROM DEPT TOTALS.                *11220039
112300*----------------------------------------------------------------*11230027
112400                                                                  11240027
112500*    - ACCUMULATE DEPT TOTALS FROM LAST PO.                      *11250039
112600     ADD PV-HLD-PO-COST-AMT      TO PV-DPT-PO-COST-AMT.           11260027
112700     ADD PV-HLD-EST-COST-AMT     TO PV-DPT-EST-COST-AMT.          11270027
112800     ADD PV-HLD-PO-EST-VAR-AMT   TO PV-DPT-PO-EST-COST-AMT.       11280027
112900     ADD PV-HLD-RCV-COST-AMT     TO PV-DPT-RCV-COST-AMT.          11290027
113000     ADD PV-HLD-INV-COST-AMT     TO PV-DPT-INV-COST-AMT.          11300027
113100     ADD PV-HLD-INV-RCV-VAR-AMT  TO PV-DPT-INV-RCV-COST-AMT.      11310027
113200                                                                  11320027
113300     MOVE SPACES                 TO D2-DETAIL2.                   11330027
113400                                                                  11340027
113500*    - FORMAT DATA TO DETAIL REPORT LINE.                        *11350039
113600*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *11360039
113700     MOVE PV-DEPT-NBR            TO PV-DEPT-TOTAL-NBR.            11370027
113800     MOVE PV-DEPT-TOTAL-COMP     TO D2-COMPNT-DESC.               11380027
113900                                                                  11390027
114000     MOVE PV-DPT-PO-COST-AMT     TO D2-PO-COST.                   11400027
114100     IF PV-DPT-PO-COST-AMT < ZERO                                 11410027
114200         INSPECT D2-PO-COST                                       11420027
114300           REPLACING ALL '-' BY '('                               11430027
114400         MOVE ')'                TO D2-PO-COST-RP                 11440027
114500     ELSE                                                         11450027
114600         MOVE ' '                TO D2-PO-COST-RP                 11460027
114700     END-IF.                                                      11470027
114800                                                                  11480027
114900     MOVE PV-DPT-EST-COST-AMT    TO D2-EST-COST.                  11490027
115000     IF PV-DPT-EST-COST-AMT < ZERO                                11500027
115100         INSPECT D2-EST-COST                                      11510027
115200           REPLACING ALL '-' BY '('                               11520027
115300         MOVE ')'                TO D2-EST-COST-RP                11530027
115400     ELSE                                                         11540027
115500         MOVE ' '                TO D2-EST-COST-RP                11550027
115600     END-IF.                                                      11560027
115700                                                                  11570027
115800     MOVE PV-DPT-PO-EST-COST-AMT TO D2-PO-EST-VAR.                11580027
115900     IF PV-DPT-PO-EST-COST-AMT < ZERO                             11590027
116000         INSPECT D2-PO-EST-VAR                                    11600027
116100           REPLACING ALL '-' BY '('                               11610027
116200         MOVE ')'                TO D2-PO-EST-VAR-RP              11620027
116300     ELSE                                                         11630027
116400         MOVE ' '                TO D2-PO-EST-VAR-RP              11640027
116500     END-IF.                                                      11650027
116600                                                                  11660027
116700     MOVE PV-DPT-RCV-COST-AMT    TO D2-RCV-COST.                  11670027
116800     IF PV-DPT-RCV-COST-AMT < ZERO                                11680027
116900         INSPECT D2-RCV-COST                                      11690027
117000           REPLACING ALL '-' BY '('                               11700027
117100         MOVE ')'                TO D2-RCV-COST-RP                11710027
117200     ELSE                                                         11720027
117300         MOVE ' '                TO D2-RCV-COST-RP                11730027
117400     END-IF.                                                      11740027
117500                                                                  11750027
117600     MOVE PV-DPT-INV-COST-AMT    TO D2-INV-COST.                  11760027
117700     IF PV-DPT-INV-COST-AMT < ZERO                                11770027
117800         INSPECT D2-INV-COST                                      11780027
117900           REPLACING ALL '-' BY '('                               11790027
118000         MOVE ')'                TO D2-INV-COST-RP                11800027
118100     ELSE                                                         11810027
118200         MOVE ' '                TO D2-INV-COST-RP                11820027
118300     END-IF.                                                      11830027
118400                                                                  11840027
118500     MOVE PV-DPT-INV-RCV-COST-AMT                                 11850027
118600                                 TO D2-INV-RCV-VAR.               11860027
118700     IF PV-DPT-INV-RCV-COST-AMT < ZERO                            11870027
118800         INSPECT D2-INV-RCV-VAR                                   11880027
118900           REPLACING ALL '-' BY '('                               11890027
119000         MOVE ')'                TO D2-INV-RCV-VAR-RP             11900027
119100     ELSE                                                         11910027
119200         MOVE ' '                TO D2-INV-RCV-VAR-RP             11920027
119300     END-IF.                                                      11930027
119400                                                                  11940027
119500*    - PRINT DEPT TOTALS.                                        *11950039
119600     MOVE D2-DETAIL2             TO REPORT-REC.                   11960027
119700     MOVE +2                     TO PV-LINE-SKIP.                 11970027
119800     PERFORM W300-PRINT-DETAIL.                                   11980027
119900                                                                  11990027
120000*    - ACCUMULATE REPORT TOTALS FROM DEPT TOTALS.                *12000039
120100     ADD PV-DPT-PO-COST-AMT      TO PV-TOT-PO-COST-AMT.           12010027
120200     ADD PV-DPT-EST-COST-AMT     TO PV-TOT-EST-COST-AMT.          12020027
120300     ADD PV-DPT-PO-EST-COST-AMT  TO PV-TOT-PO-EST-COST-AMT.       12030027
120400     ADD PV-DPT-RCV-COST-AMT     TO PV-TOT-RCV-COST-AMT.          12040027
120500     ADD PV-DPT-INV-COST-AMT     TO PV-TOT-INV-COST-AMT.          12050027
120600     ADD PV-DPT-INV-RCV-COST-AMT TO PV-TOT-INV-RCV-COST-AMT.      12060027
120700                                                                  12070027
120800     INITIALIZE PV-DEPARTMENT-TOTALS                              12080027
120900     .                                                            12090027
121000                                                                  12100027
121100                                                                  12110027
121200 D200-PROCESS-FINAL-TOTALS.                                       12120027
121300*----------------------------------------------------------------*12130027
121400*    PROCESSING FINAL TOTALS.                                    *12140039
121500*                                                                *12150039
121600*    - FORMAT DATA TO DETAIL REPORT LINE.                        *12160039
121700*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *12170039
121800*    - WRITE PAGE HEADINGS.                                      *12180039
121900*    - FORMAT DASHLINE AND PRINT.                                *12190042
122000*    - PRINT REPORT TOTALS.                                      *12200042
122100*----------------------------------------------------------------*12210027
122200                                                                  12220027
122300*    - FORMAT DATA TO DETAIL REPORT LINE.                        *12230039
122400*       NEGATIVE NUMBERS WILL BE DISPLAYED WITHIN PARENS.        *12240039
122500     MOVE SPACES                 TO D2-DETAIL2.                   12250027
122600     MOVE '  FINAL REPORT TOTALS         '                        12260027
122700                                 TO D2-COMPNT-DESC.               12270027
122800                                                                  12280027
122900     MOVE PV-TOT-PO-COST-AMT     TO D2-PO-COST.                   12290027
123000     IF PV-TOT-PO-COST-AMT < ZERO                                 12300027
123100         INSPECT D2-PO-COST                                       12310027
123200           REPLACING ALL '-' BY '('                               12320027
123300         MOVE ')'                TO D2-PO-COST-RP                 12330027
123400     ELSE                                                         12340027
123500         MOVE ' '                TO D2-PO-COST-RP                 12350027
123600     END-IF.                                                      12360027
123700                                                                  12370027
123800     MOVE PV-TOT-EST-COST-AMT    TO D2-EST-COST.                  12380027
123900     IF PV-TOT-EST-COST-AMT < ZERO                                12390027
124000         INSPECT D2-EST-COST                                      12400027
124100           REPLACING ALL '-' BY '('                               12410027
124200         MOVE ')'                TO D2-EST-COST-RP                12420027
124300     ELSE                                                         12430027
124400         MOVE ' '                TO D2-EST-COST-RP                12440027
124500     END-IF.                                                      12450027
124600                                                                  12460027
124700     MOVE PV-TOT-PO-EST-COST-AMT TO D2-PO-EST-VAR.                12470027
124800     IF PV-TOT-PO-EST-COST-AMT < ZERO                             12480027
124900         INSPECT D2-PO-EST-VAR                                    12490027
125000           REPLACING ALL '-' BY '('                               12500027
125100         MOVE ')'                TO D2-PO-EST-VAR-RP              12510027
125200     ELSE                                                         12520027
125300         MOVE ' '                TO D2-PO-EST-VAR-RP              12530027
125400     END-IF.                                                      12540027
125500                                                                  12550027
125600     MOVE PV-TOT-RCV-COST-AMT    TO D2-RCV-COST.                  12560027
125700     IF PV-TOT-RCV-COST-AMT < ZERO                                12570027
125800         INSPECT D2-RCV-COST                                      12580027
125900           REPLACING ALL '-' BY '('                               12590027
126000         MOVE ')'                TO D2-RCV-COST-RP                12600027
126100     ELSE                                                         12610027
126200         MOVE ' '                TO D2-RCV-COST-RP                12620027
126300     END-IF.                                                      12630027
126400                                                                  12640027
126500     MOVE PV-TOT-INV-COST-AMT    TO D2-INV-COST.                  12650027
126600     IF PV-TOT-INV-COST-AMT < ZERO                                12660027
126700         INSPECT D2-INV-COST                                      12670027
126800           REPLACING ALL '-' BY '('                               12680027
126900         MOVE ')'                TO D2-INV-COST-RP                12690027
127000     ELSE                                                         12700027
127100         MOVE ' '                TO D2-INV-COST-RP                12710027
127200     END-IF.                                                      12720027
127300                                                                  12730027
127400     MOVE PV-TOT-INV-RCV-COST-AMT                                 12740027
127500                                 TO D2-INV-RCV-VAR.               12750027
127600     IF PV-TOT-INV-RCV-COST-AMT < ZERO                            12760027
127700         INSPECT D2-INV-RCV-VAR                                   12770027
127800           REPLACING ALL '-' BY '('                               12780027
127900         MOVE ')'                TO D2-INV-RCV-VAR-RP             12790027
128000     ELSE                                                         12800027
128100         MOVE ' '                TO D2-INV-RCV-VAR-RP             12810027
128200     END-IF.                                                      12820027
128300                                                                  12830027
128400*    - WRITE PAGE HEADINGS.                                      *12840039
128500     PERFORM W100-WRITE-HEADINGS.                                 12850027
128600                                                                  12860027
128700     WRITE REPORT-REC FROM T1-HEADER1                             12870027
128800       AFTER ADVANCING +3 LINES.                                  12880027
128900     WRITE REPORT-REC FROM T2-HEADER2                             12890027
129000       AFTER ADVANCING +1 LINES.                                  12900027
129100                                                                  12910027
129200*    - FORMAT DASHLINE AND PRINT.                                 12920039
129300     MOVE SPACES                 TO H7-DASH1   H7-DASH4           12930027
129400                                    H7-DASH7   H7-DASH8           12940027
129500                                    H7-DASH9   H7-DASH10.         12950027
129600     MOVE PC-DASH-LIT            TO H7-DASH2   H7-DASH3           12960027
129700                                    H7-DASH5   H7-DASH6.          12970027
129800     WRITE REPORT-REC FROM H7-DASHLINE                            12980027
129900       AFTER ADVANCING +1 LINES.                                  12990027
130000                                                                  13000027
130100*    - PRINT REPORT TOTALS.                                       13010039
130200     MOVE D2-DETAIL2             TO REPORT-REC.                   13020027
130300     MOVE +4                     TO PV-LINE-SKIP.                 13030027
130400     PERFORM W300-PRINT-DETAIL.                                   13040071
130500                                                                  13050071
130510     MOVE SPACES                 TO D4-DETAIL4.                   13051071
130520     MOVE '  TOTAL PAY RELEASED/POSTED   '                        13052071
130530                                 TO D4-COMPNT-DESC.               13053071
130540     MOVE PV-PO-READ-COUNT       TO D4-TOT-PAY-RLSE-POST.         13054071
130541     MOVE D4-DETAIL4             TO REPORT-REC.                   13054175
130550     MOVE +4                     TO PV-LINE-SKIP.                 13055074
130560     PERFORM W300-PRINT-DETAIL.                                   13056071
130600                                                                  13060027
130700                                                                  13070027
130800 F100-FORMAT-HEADER.                                              13080027
130900*----------------------------------------------------------------*13090027
131000*    FORMAT HEADER DATA TO THE REPORT HEADINGS, DETAIL LINES.    *13100039
131100*                                                                *13110039
131200*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *13120039
131300*    - FORMAT HEADER DATA TO REPORT HEADING LINES.               *13130039
131400*    - FORMAT HEADER DATA TO DETAIL LINES.                       *13140039
131500*    - WRITE PO HEADINGS.                                        *13150039
131600*----------------------------------------------------------------*13160027
131700                                                                  13170027
131800*    - WRITE PAGE HEADINGS, IF PAGE IS FULL.                     *13180039
131900     IF PV-PO-PER-PAGE NOT < PC-PO-PER-PAGE-MAX                   13190027
132000         PERFORM W100-WRITE-HEADINGS                              13200027
132100     END-IF.                                                      13210027
132200     ADD +1                      TO PV-PO-PER-PAGE                13220027
132300                                    PV-PO-PRINTED-COUNT.          13230027
132400                                                                  13240027
132500*    - FORMAT HEADER DATA TO REPORT HEADING LINES.               *13250039
132600     MOVE AP036-VENDOR-NAME      TO H3-VENDOR-NAME.               13260027
132700     MOVE AP036-VENDOR-NBR       TO H3-VENDOR-NUMBER.             13270027
132800     MOVE PV-DEPT-NBR            TO H3-DEPT-NUMBER.               13280027
132900     MOVE PV-DEPT-DESC           TO H3-DEPT-NAME.                 13290027
133000                                                                  13300027
133100     MOVE AP036-1ST-VERFYD-DTE   TO PV-DB2-DATE.                  13310027
133200     PERFORM F120-REFORMAT-DATE.                                  13320027
133300     MOVE PV-DISPLAY-DATE        TO H3-1ST-VERIFIED.              13330027
133400                                                                  13340031
133500     MOVE AP036-LAST-VERFYD-DTE  TO PV-DB2-DATE.                  13350034
133600     PERFORM F120-REFORMAT-DATE.                                  13360034
133700     MOVE PV-DISPLAY-DATE        TO H4-LAST-VERIFIED.             13370034
133800                                                                  13380027
133900     IF AP036-PO-UNT-QTY > ZEROES                                 13390027
134000         COMPUTE PV-RCV-VAR-PCT = ( ( AP036-RCV-UNT-QTY /         13400027
134100                          AP036-PO-UNT-QTY ) * 100 ) + .005       13410027
134200     ELSE                                                         13420027
134300         MOVE ZEROES             TO PV-RCV-VAR-PCT                13430027
134400     END-IF.                                                      13440027
134500     MOVE PV-RCV-VAR-PCT         TO H3-PCT-RECEIVED.              13450027
134600                                                                  13460027
134700     MOVE PV-PO-NBR-N            TO H4-PO-NUMBER.                 13470027
134800     MOVE AP036-PO-STATUS-CDE    TO H4-PO-STATUS.                 13480027
134900     MOVE PV-FOB-NAME            TO H4-FOB-POINT.                 13490027
135000                                                                  13500027
135100     IF AP036-1ST-INVC-DTE = SPACES                               13510051
135200         MOVE SPACES             TO H4-1ST-INVOICED               13520051
135300     ELSE                                                         13530051
135400         MOVE AP036-1ST-INVC-DTE TO PV-DB2-DATE                   13540051
135500         PERFORM F120-REFORMAT-DATE                               13550051
135600         MOVE PV-DISPLAY-DATE    TO H4-1ST-INVOICED               13560051
135700     END-IF.                                                      13570051
135800                                                                  13580027
135900     IF AP036-OTB-PER-NBR NOT = SPACES                            13590027
136000         PERFORM F150-PROCESS-OTB-PER                             13600027
136100     ELSE                                                         13610027
136200         MOVE SPACES             TO H4-OTB-MONTH                  13620027
136300              H4-OTB-COMMA          H4-OTB-YEAR                   13630053
136400     END-IF.                                                      13640027
136500                                                                  13650027
136600*    - FORMAT HEADER DATA TO DETAIL LINES.                       *13660039
136700     MOVE AP036-PO-UNT-QTY       TO D1-PO-UNITS                   13670027
136800                                    D1-ELC-UNITS                  13680027
136900                                    PV-PO-UNT-QTY.                13690027
137000     MOVE AP036-RCV-UNT-QTY      TO D1-RCV-UNITS                  13700027
137100                                    PV-RCV-UNT-QTY.               13710027
137200     MOVE AP036-INV-UNT-QTY      TO D1-INV-UNITS                  13720027
137300                                    PV-INV-UNT-QTY.               13730027
137400                                                                  13740027
137500     COMPUTE PV-INV-RCV-QTY =                                     13750027
137600        ( AP036-INV-UNT-QTY - AP036-RCV-UNT-QTY ).                13760027
137700     MOVE PV-INV-RCV-QTY         TO D1-RCV-VAR-UNITS.             13770027
137800                                                                  13780027
137900     IF AP036-INV-UNT-QTY NOT = ZEROES                            13790047
138000         COMPUTE PV-INV-QTY-VAR-PCT = ( ( PV-INV-RCV-QTY          13800027
138100            / AP036-INV-UNT-QTY ) * 100 ) + .005                  13810027
138200     ELSE                                                         13820027
138300         IF PV-INV-RCV-QTY = ZEROES                               13830047
138400             MOVE ZEROES         TO PV-INV-QTY-VAR-PCT            13840047
138500         ELSE                                                     13850047
138600             IF PV-INV-RCV-QTY < ZEROES                           13860047
138700                 MOVE -100.00000 TO PV-INV-QTY-VAR-PCT            13870047
138800             ELSE                                                 13880047
138900                 MOVE 100.00000  TO PV-INV-QTY-VAR-PCT            13890047
139000             END-IF                                               13900047
139100         END-IF                                                   13910047
139200     END-IF.                                                      13920046
139300     MOVE PV-INV-QTY-VAR-PCT     TO D1-PCT-VAR.                   13930027
139400                                                                  13940027
139500     MOVE PC-DASH-LIT            TO H7-DASH1                      13950027
139600         H7-DASH3                                                 13960027
139700              H7-DASH2   H7-DASH4   H7-DASH5   H7-DASH6           13970027
139800              H7-DASH7   H7-DASH8   H7-DASH9   H7-DASH10          13980027
139900                                                                  13990027
140000*    - WRITE PO HEADINGS.                                        *14000039
140100     PERFORM W200-WRITE-DETAIL-HEADINGS.                          14010027
140200                                                                  14020027
140300                                                                  14030027
140400 F120-REFORMAT-DATE.                                              14040027
140500*----------------------------------------------------------------*14050027
140600*    FORMAT DB2 DATE AS MM/DD/CCYY WITH CALENDAR ROUTINE.        *14060039
140700*----------------------------------------------------------------*14070027
140800                                                                  14080027
140900     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         14090027
141000     ACCEPT DPG51-SYSTEM-DATE       FROM DATE.                    14100027
141100                                                                  14110027
141200     SET DPG52-LK-DTE-ISO-FMT                                     14120027
141300         DPG51-FISCAL-JAN-DEC-F2                                  14130057
141400         DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   14140027
141500     MOVE PV-DB2-DATE            TO DPG52-LK-DATE-INPUT.          14150027
141600                                                                  14160027
141700     CALL DP500-KOHLS-CALENDAR-ROUTINE                            14170027
141800         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               14180027
141900                                                                  14190027
142000     IF (DPG54-SEVERE-ERROR OR                                    14200027
142100         DPG54-WARNING-ERROR)                                     14210058
142200         DISPLAY 'PO NUMBER WITH BAD DATA = ' PV-PO-NBR-N         14220054
142300         DISPLAY 'PV-DB2-DATE  = ' PV-DB2-DATE                    14230027
142400         MOVE 'F120-REFORMAT-DATE   ' TO  AA-PARAGRAPH-NAME       14240027
142500         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE'              14250027
142600                                  TO AA-MESSAGE                   14260027
142700         SET AC-DPWS500-DATE-ERROR  TO TRUE                       14270027
142800         PERFORM Z999-ABEND                                       14280027
142900     ELSE                                                         14290027
143000         MOVE DPG55-GREG-CC-DATE-FMT                              14300027
143100                                 TO PV-DISPLAY-DATE               14310027
143200     END-IF.                                                      14320027
143300                                                                  14330027
143400                                                                  14340027
143500 F150-PROCESS-OTB-PER.                                            14350027
143600*----------------------------------------------------------------*14360027
143700*    USING THE CALENDAR ROUTINE TO GET THE 3-CHARACTER           *14370027
143800*    ABREVIATION.                                                *14380027
143900*----------------------------------------------------------------*14390027
144000                                                                  14400027
144100     INITIALIZE DPG51, DPG52, DPG53, DPG54, DPG55, DPG56.         14410027
144200     ACCEPT DPG51-SYSTEM-DATE       FROM DATE.                    14420027
144300                                                                  14430027
144400     SET DPG52-LK-DTE-FISC-PRD-CC      TO TRUE.                   14440027
144500     SET DPG51-FISCAL-JAN-DEC-F2       TO TRUE.                   14450055
144600     SET DPG51-DO-NOT-INCR-DECR-DATE   TO TRUE.                   14460027
144700                                                                  14470027
144800     MOVE AP036-OTB-PER-NBR      TO DPG52-LK-DATE-INPUT.          14480027
144900                                                                  14490027
145000     CALL DP500-KOHLS-CALENDAR-ROUTINE                            14500027
145100         USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.               14510027
145200                                                                  14520027
145300     IF (DPG54-SEVERE-ERROR OR                                    14530027
145400         DPG54-WARNING-ERROR)                                     14540058
145500         DISPLAY 'PO NUMBER WITH BAD DATA = ' PV-PO-NBR-N         14550054
145600         DISPLAY 'AP036-OTB-PER-NBR = ' AP036-OTB-PER-NBR         14560027
145700         MOVE 'F150-PROCESS-OTB-PER ' TO  AA-PARAGRAPH-NAME       14570027
145800         MOVE 'BAD DATE CONVERSION FOR CURRENT DATE'              14580027
145900                                    TO AA-MESSAGE                 14590027
146000         SET AC-DPWS500-DATE-ERROR  TO TRUE                       14600027
146100         PERFORM Z999-ABEND                                       14610027
146200     ELSE                                                         14620027
146300         MOVE DPG56-FISCAL-PERIOD-NAME-ABBR3                      14630027
146400                                 TO H4-OTB-MONTH                  14640027
146500         MOVE ', '               TO H4-OTB-COMMA                  14650053
146600         MOVE AP036-OTB-PER-NBR  TO H4-OTB-YEAR                   14660027
146700     END-IF.                                                      14670027
146800                                                                  14680027
146900                                                                  14690027
147000 R100-READ-INPUT.                                                 14700027
147100*----------------------------------------------------------------*14710027
147200*    READ IMPORT FILE.                                           *14720042
147300*----------------------------------------------------------------*14730027
147400                                                                  14740027
147500     READ IMPORT-REPORT-FILE INTO AP036-IMPORT-REPORT-RECORD      14750035
147600         AT END                                                   14760027
147700             SET PS-PO-EOF TO TRUE.                               14770027
147800                                                                  14780027
147900     IF PS-PO-NOT-EOF                                             14790036
148000         ADD 1                   TO PV-READ-COUNT                 14800027
148100         IF AP036-HEADER                                          14810027
148200             ADD 1               TO PV-PO-READ-COUNT              14820027
148300         END-IF                                                   14830027
148400     END-IF                                                       14840027
148500     .                                                            14850027
148600                                                                  14860027
148700                                                                  14870027
148800 S100-GET-FOB-NAME.                                               14880027
148900*----------------------------------------------------------------*14890027
149000*   RETRIEVES THE FOB NAME FOR THE PO BEING PROCESSED             14900027
149100*----------------------------------------------------------------*14910027
149200                                                                  14920027
149300     INITIALIZE  DCLTIMFOB.                                       14930027
149400                                                                  14940027
149500     PERFORM WITH TEST AFTER                                      14950027
149600             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 14960027
149700             UNTIL   PV-RETRY-COUNTER > 3  OR                     14970027
149800                     SQLCODE = ZERO OR                            14980027
149900                     SQLCODE = +100                               14990027
150000                                                                  15000027
150100         EXEC SQL                                                 15010027
150200             SELECT FOB_CTY_NM                                    15020027
150300             INTO   :IMFOB-FOB-CTY-NM                             15030027
150400             FROM   TIMFOB                                        15040027
150500             WHERE  FOB_CDE    =  :PV-FOB-CDE                     15050027
150600         END-EXEC                                                 15060027
150700                                                                  15070027
150800         EVALUATE TRUE                                            15080027
150900           WHEN SQLCODE = ZERO                                    15090027
151000             MOVE IMFOB-FOB-CTY-NM TO PV-FOB-NAME                 15100027
151100                                                                  15110027
151200           WHEN SQLCODE = +100                                    15120027
151300             MOVE 'NO CITY NAME FOUND '                           15130027
151400                                 TO PV-FOB-NAME                   15140027
151500                                                                  15150027
151600           WHEN SQLWARN0 NOT = SPACES                             15160027
151700           WHEN SQLCODE NOT  = ZERO                               15170027
151800             DISPLAY 'PO NUMBER: ' PV-PO-NBR-N                    15180054
151900             DISPLAY 'FOB CODE: ' PV-FOB-CDE                      15190027
152000             MOVE 'S100-GET-FOB-NAME'                             15200027
152100                                 TO AA-PARAGRAPH-NAME             15210027
152200             MOVE 'UNSUCCESSFUL SELECT'                           15220027
152300                                 TO AA-DB2-OPERATION              15230027
152400             MOVE 'TIMFOB'       TO AA-DB2-TABLE-1                15240027
152500             INITIALIZE             AA-DB2-TABLE-2                15250027
152600                                    AA-DB2-TABLE-3                15260027
152700             PERFORM Z999-DB2-ABEND                               15270027
152800         END-EVALUATE                                             15280027
152900     END-PERFORM.                                                 15290027
153000                                                                  15300027
153100     IF PV-RETRY-COUNTER > 3                                      15310027
153200         MOVE 'S100-GET-FOB-NAME'                                 15320027
153300                                 TO AA-PARAGRAPH-NAME             15330027
153400         MOVE 'MAX RETRIES EXCEEDED ON SELECT IMFOB'              15340027
153500                                 TO AA-DB2-OPERATION              15350027
153600         PERFORM Z999-DB2-ABEND                                   15360027
153700     END-IF.                                                      15370027
153800                                                                  15380027
153900                                                                  15390027
154000 S200-GET-DEPT-DESC.                                              15400027
154100*----------------------------------------------------------------*15410027
154200*   RETRIEVES THE DEPT NAME FOR THE PO BEING PROCESSED            15420027
154300*----------------------------------------------------------------*15430027
154400                                                                  15440027
154500     INITIALIZE DCLTMDSEAR.                                       15450027
154600                                                                  15460027
154700     PERFORM WITH TEST AFTER                                      15470027
154800             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 15480027
154900             UNTIL   PV-RETRY-COUNTER > 3  OR                     15490027
155000                     SQLCODE = ZERO OR                            15500027
155100                     SQLCODE = +100                               15510027
155200                                                                  15520027
155300         EXEC SQL                                                 15530027
155400             SELECT MDSEAR_DESC                                   15540027
155500             INTO   :MDSEAR-DESC                                  15550027
155600             FROM   TMDSEAR                                       15560027
155700             WHERE  DEPT_NBR   =  :PV-DEPT-NBR                    15570027
155800             AND   MDSELV_CDE   = 'DPT'                           15580027
155900             AND   STRT_DTE    <= CURRENT DATE                    15590027
156000             AND   END_DTE     >= CURRENT DATE                    15600027
156100         END-EXEC                                                 15610027
156200                                                                  15620027
156300         EVALUATE TRUE                                            15630027
156400           WHEN SQLCODE = ZERO                                    15640027
156500             MOVE MDSEAR-DESC    TO PV-DEPT-DESC                  15650027
156600                                                                  15660027
156700           WHEN SQLCODE = +100                                    15670027
156800             MOVE 'NO DEPT DESC FOUND '                           15680027
156900                                 TO PV-DEPT-DESC                  15690027
157000                                                                  15700027
157100           WHEN SQLWARN0 NOT = SPACES                             15710027
157200           WHEN SQLCODE NOT  = ZERO                               15720027
157300             DISPLAY 'PO NUMBER: ' PV-PO-NBR-N                    15730054
157400             DISPLAY 'DEPT NBR: ' PV-DEPT-NBR                     15740027
157500             MOVE 'S200-GET-DEPT-DESC'                            15750027
157600                                 TO AA-PARAGRAPH-NAME             15760027
157700             MOVE 'UNSUCCESSFUL SELECT'                           15770027
157800                                 TO AA-DB2-OPERATION              15780027
157900             MOVE 'TMDSEAR'      TO AA-DB2-TABLE-1                15790027
158000             INITIALIZE             AA-DB2-TABLE-2                15800027
158100                                    AA-DB2-TABLE-3                15810027
158200             PERFORM Z999-DB2-ABEND                               15820027
158300         END-EVALUATE                                             15830027
158400     END-PERFORM.                                                 15840027
158500                                                                  15850027
158600     IF PV-RETRY-COUNTER > 3                                      15860027
158700         MOVE 'S200-GET-DEPT-DESC            '                    15870027
158800                                 TO AA-PARAGRAPH-NAME             15880027
158900         MOVE 'MAX RETRIES EXCEEDED ON SELECT MDSEAR'             15890027
159000                                 TO AA-DB2-OPERATION              15900027
159100         PERFORM Z999-DB2-ABEND                                   15910027
159200     END-IF.                                                      15920027
159300                                                                  15930027
159400                                                                  15940027
159500 W100-WRITE-HEADINGS.                                             15950027
159600*----------------------------------------------------------------*15960027
159700*  WRITE PAGE HEADING LINES.                                      15970039
159800*----------------------------------------------------------------*15980027
159900                                                                  15990027
160000     ADD +1                      TO PV-PAGE-COUNT.                16000027
160100     MOVE PV-PAGE-COUNT          TO DP200O-PAGE-NUMBER            16010027
160200                                                                  16020027
160300* HEADING LINE 1 (STANDARD)                                       16030027
160400     WRITE REPORT-REC FROM DP200O-STANDRD-HEADER-200-COLS         16040027
160500       AFTER ADVANCING PAGE.                                      16050027
160600                                                                  16060027
160700     WRITE REPORT-REC FROM H2-HEADER2                             16070027
160800       AFTER ADVANCING +1 LINES.                                  16080027
160900     MOVE ZEROES                 TO PV-PO-PER-PAGE.               16090027
161000                                                                  16100027
161100                                                                  16110027
161200 W200-WRITE-DETAIL-HEADINGS.                                      16120027
161300*----------------------------------------------------------------*16130027
161400*  WRITE PO DETAIL HEADINGS.                                     *16140039
161500*                                                                *16150039
161600*    - WRITE PO HEADINGS.                                        *16160039
161700*    - WRITE FIRST DETAIL LINE WITH HEADER RECORD DATA.          *16170039
161800*----------------------------------------------------------------*16180027
161900                                                                  16190027
162000*    - WRITE PO HEADINGS.                                        *16200039
162100     WRITE REPORT-REC FROM H3-HEADER3                             16210027
162200       AFTER ADVANCING +2 LINES.                                  16220027
162300     WRITE REPORT-REC FROM H4-HEADER4                             16230027
162400       AFTER ADVANCING +1 LINES.                                  16240027
162500                                                                  16250027
162600     WRITE REPORT-REC FROM H5-HEADER5                             16260027
162700       AFTER ADVANCING +3 LINES.                                  16270027
162800     WRITE REPORT-REC FROM H6-HEADER6                             16280027
162900       AFTER ADVANCING +1 LINES.                                  16290027
163000     WRITE REPORT-REC FROM H7-DASHLINE                            16300027
163100       AFTER ADVANCING +1 LINES.                                  16310027
163200                                                                  16320027
163300*    - WRITE FIRST DETAIL LINE WITH HEADER RECORD DATA.          *16330039
163400     WRITE REPORT-REC FROM D1-DETAIL1                             16340027
163500       AFTER ADVANCING +2 LINES.                                  16350027
163600                                                                  16360027
163700     MOVE SPACES                 TO H7-DASH1.                     16370027
163800     WRITE REPORT-REC FROM H7-DASHLINE                            16380027
163900       AFTER ADVANCING +2 LINES.                                  16390027
164000                                                                  16400027
164100                                                                  16410027
164200 W300-PRINT-DETAIL.                                               16420027
164300*----------------------------------------------------------------*16430027
164400*  PRINTS PO DETAIL LINES.                                        16440039
164500*----------------------------------------------------------------*16450027
164600                                                                  16460027
164700     WRITE REPORT-REC                                             16470027
164800       AFTER ADVANCING PV-LINE-SKIP LINES.                        16480027
164900                                                                  16490027
165000     INITIALIZE REPORT-REC.                                       16500027
165100                                                                  16510027
165200                                                                  16520027
165300 Z999-DB2-ABEND.                                                  16530027
165400*----------------------------------------------------------------*16540027
165500*    ABEND ROUTINE                                               *16550027
165600*----------------------------------------------------------------*16560027
165700                                                                  16570027
165800     CLOSE IMPORT-REPORT-FILE                                     16580027
165900           REPORT-FILE.                                           16590027
166000     DISPLAY AA-ABEND-LIT.                                        16600027
166100     DISPLAY AA-MESSAGE-LINE.                                     16610027
166200     DISPLAY AA-DB2-ERROR-LIT.                                    16620027
166300     DISPLAY AA-PROGRAM-LIT.                                      16630027
166400     DISPLAY AA-PARAGRAPH-LIT.                                    16640027
166500     DISPLAY AA-DB2-OPERATION-LIT.                                16650027
166600     DISPLAY AA-DB2-TABLE-1.                                      16660027
166700     DISPLAY AA-DB2-TABLE-2.                                      16670027
166800     DISPLAY AA-DB2-TABLE-3.                                      16680027
166900     SET AC-DB2-ERROR TO TRUE.                                    16690027
167000                                                                  16700027
167100     COPY DPPD004.                                                16710027
167200                                                                  16720027
167300     CALL 'ILBOABN0' USING ABEND-CODE.                            16730027
167400                                                                  16740027
167500                                                                  16750027
167600 Z999-ABEND.                                                      16760027
167700*----------------------------------------------------------------*16770027
167800*    ABEND ROUTINE                                               *16780027
167900*----------------------------------------------------------------*16790027
168000                                                                  16800039
168100     CLOSE IMPORT-REPORT-FILE                                     16810027
168200           REPORT-FILE.                                           16820027
168300     DISPLAY AA-ABEND-LIT.                                        16830027
168400     DISPLAY AA-PROGRAM-LIT.                                      16840027
168500     DISPLAY AA-PARAGRAPH-LIT.                                    16850027
168600     DISPLAY AA-MESSAGE-LINE.                                     16860027
168700                                                                  16870027
168800     CALL 'ILBOABN0' USING ABEND-CODE.                            16880027
