000100 IDENTIFICATION DIVISION.                                         00010077
000200 PROGRAM-ID.    POKCS028.                                         00020077
000300 AUTHOR.        TOM RUSKA. G&R.                                   00030077
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040077
000500 DATE-WRITTEN.  08-26-93.                                         00050077
000600 DATE-COMPILED.                                                   00060077
000700*----------------------------------------------------------------*00070077
000800*    W028 - PURCHASE ORDER INQUIRY CRITERIA SPEC                 *00080077
000900*                                                                *00090077
001000*    THIS PROGRAM ALLOWS THE USER TO ENTER DATA TO BE USED BY    *00100077
001100*    SUBSEQUENT PROGRAMS TO CREATE A LIST OR TO BRING UP A       *00110077
001200*    DETAIL SCREEN. ALL OTHER EDITS ARE DONE IN THE DESTINATION  *00120077
001300*    PROGRAMS WHEN THE 'GO-TO' TYPE FUNCTION IS USED.            *00130077
001400*----------------------------------------------------------------*00140077
      *   WR5916 - CHANGED 10/14/99 - SUE BARTELT - TKMA537            *00150077
      *   PROGRAM CHANGED TO INCLUDE GROUP CODE.  CHANGES MADE TO      *00160077
      *   2110-PREPARE-INTER-APPL-COMM, 2200-MOVE-SCREEN-TO-COMMAREA,  *00170077
      *   3000-EDIT-DATA-IN-COMMAREA, 3100-RESET-ATTRIBUTES,           *00180077
      *   4400-MOVE-COMMAREA-TO-SCREEN.                                *00190077
      *   ALSO REDEFINED ASC-CL-NBR SO THAT IT CAN BE 2 SEPERATE FIELDS*00200077
      *----------------------------------------------------------------*00210077
      *   WR4960 - CHANGED 3/30/00 - SUE BARTELT - TKMA537             *00220077
      *   PROGRAM CHANGED BY ADDING CODE FOR NEW F KEY. F13=PACKSUM    *00230077
      *   GOES TO POLPKINS (POKCS108).  CHANGED PARA 2100.             *00240077
      *----------------------------------------------------------------*00250077
W24803*   WR24803 - CHANGED 05/05/03 - LAXMAN BOLINENI, IGSI  -TK21263 *00260077
W24803*   PROGRAM CHANGED TO INCLUDE 2 DIGIT MAJOR CLASS AND TO REPLACE*00270077
W24803*   ALL THE REFERENCES OF 3 DIGIT SEQUENCE NUMBER WITH 8 DIGIT   *00280077
W24803*   SEQUENCE NUMBER.                                             *00290077
W24803*   THE PROGRAM WAS RECOMPILED TO BRING THE NEW VERSION OF       *00300077
W24803*   COPYBOOK POWS017.                                             00310077
W24803*----------------------------------------------------------------*00320077
C98147*   CHG0098147 -      10/20/14 - JOHN SELWITSCHKA - TKMAB17      *00330077
C98147*   EXPANDED PO NUMBER TO 8 DIGITS.                              *00340077
C98147*----------------------------------------------------------------*00350077
263126*   CHANGED 10/27/2021    BY JIM HUNTER      WR: CHG0263126       00360077
263126*   CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE   00370077
263126*   MAKING THE CALL DYNAMIC VS STATIC.                            00380077
263126*----------------------------------------------------------------*00390077
CICS  *   CHANGED 11/10/2022    BY BARB SCHULTZ    WR: CHG0278485       00391079
CICS  *                                                                 00392078
CICS  *   ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL    00393078
CICS  *   DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.     00393178
CICS  *----------------------------------------------------------------*00394078
001500                                                                  00400077
001600 ENVIRONMENT DIVISION.                                            00410077
001700 DATA DIVISION.                                                   00420077
001800/                                                                 00430077
001900 WORKING-STORAGE SECTION.                                         00440077
002000                                                                  00450077
002100 01  PC-PROGRAM-CONSTANTS.                                        00460077
002200     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE  'PO028A  '. 00470077
002300     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE  'POKM028 '. 00480077
002400     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE  'POKCS028'. 00490077
002500     05  PC-MAX-RETRIES            PIC  9(01)  VALUE  3.          00500077
002600     05  PC-TSYMSG-NUMBERS.                                       00510077
002700         10  PC-TSYMSG-00005       PIC  9(05)  VALUE  00005.      00520077
002800         10  PC-TSYMSG-00007       PIC  9(05)  VALUE  00007.      00530077
002900         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00540077
003000         10  PC-TSYMSG-00009       PIC  9(05)  VALUE  00009.      00550077
003100         10  PC-TSYMSG-00098       PIC  9(05)  VALUE  00098.      00560077
003200         10  PC-TSYMSG-00143       PIC  9(05)  VALUE  00143.      00570077
003300         10  PC-TSYMSG-00148       PIC  9(05)  VALUE  00148.      00580077
003400         10  PC-TSYMSG-00587       PIC  9(05)  VALUE  00587.      00590077
003500         10  PC-TSYMSG-00639       PIC  9(05)  VALUE  00639.      00600077
003600         10  PC-TSYMSG-00640       PIC  9(05)  VALUE  00640.      00610077
W24803         10  PC-TSYMSG-01922       PIC  9(05)  VALUE  01922.      00620077
               10  PC-TSYMSG-02182       PIC  9(05)  VALUE  02182.      00630077
W24803         10  PC-TSYMSG-03081       PIC  9(05)  VALUE  03081.      00640077
003700                                                                  00650077
003800 01  PV-PROGRAM-VARIABLES.                                        00660077
003900     05  PV-RETRY-COUNTER          PIC  9(03)  VALUE  0           00670077
004000                                               COMP-3.            00680077
004100     05  PV-DB2-COUNT              PIC S9(09)  VALUE +0           00690077
004200                                               COMP-3.            00700077
004300     05  PV-DONT-SHIP-DATE         PIC X(10) VALUE SPACES.        00710077
004400     05  PV-AD-DATE                PIC X(10) VALUE SPACES.        00720077
W24803     05  PV-MAJ-CLASS              PIC 9(04).                     00730077
004500                                                                  00740077
004600 01  PS-PROGRAM-SWITCHES.                                         00750077
004700     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        00760077
004800         88  PS-ERROR                          VALUE  'Y'.        00770077
004900         88  PS-NO-ERROR                       VALUE  'N'.        00780077
005000*----------------------------------------------------------------*00790077
005100*    MAP LAYOUT                                                  *00800077
005200*----------------------------------------------------------------*00810077
005300     COPY POKM028.                                                00820077
005400/                                                                 00830077
005500*----------------------------------------------------------------*00840077
005600*    ATTRIBUTE SETTINGS COPYBOOK.                                *00850077
005700*----------------------------------------------------------------*00860077
005800     COPY DPWS015.                                                00870077
005900/                                                                 00880077
006000*----------------------------------------------------------------*00890077
006100*    FUNCTION KEYS COPYBOOK                                      *00900077
006200*----------------------------------------------------------------*00910077
006300     COPY DPWS016.                                                00920077
006400/                                                                 00930077
006500******************************************************************00940077
006600** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **00950077
006700** SUB-ROUTINE (DPKUT100).                                      **00960077
006800******************************************************************00970077
006900     COPY DPWS010I.                                               00980077
007000/                                                                 00990077
007100*----------------------------------------------------------------*01000077
007200*  WORK AREA PASSED IN CALL TO DPKUT500                          *01010077
007300*----------------------------------------------------------------*01020077
007400     COPY DPWS500.                                                01030077
007500/                                                                 01040077
007600******************************************************************01050077
CICS  * PARAMETERS FOR THE CALLING THE CICS ARCHITECTURE API.         **01060078
007900******************************************************************01080077
008000     COPY DPWS030.                                                01090077
CICS       COPY DPWS930.                                                01091078
008100/                                                                 01100077
008200***************************************************************** 01110077
008300*    STANDARD COMMAREA.                                           01120077
008400***************************************************************** 01130077
008500                                                                  01140077
008600     COPY DPWS020.                                                01150077
008700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01160077
008800                                                                  01170077
008900***************************************************************** 01180077
009000*    INTER-APPLICATION COMMAREA.                                  01190077
009100***************************************************************** 01200077
009200                                                                  01210077
009300         10  INTER-APPL-COMM-AREA PIC X(200).                     01220077
009400     COPY POWS017.                                                01230077
009500***************************************************************** 01240077
009600*    SPECIFIC COMMMAREA FOR POKCS028.                             01250077
009700***************************************************************** 01260077
009800         10  ASC-SPECIFIC-COMMAREA.                               01270077
C98147             15  ASC-PO-NBR                PIC X(08).             01280077
010000             15  ASC-PO-NBR-N REDEFINES ASC-PO-NBR                01290077
C98147                                           PIC 9(08).             01300077
010200             15  ASC-IMPRT-AGNT-PO-NBR     PIC X(08).             01310077
010300             15  ASC-IMPRT-AGNT-PO-NBR-N REDEFINES                01320077
010400                 ASC-IMPRT-AGNT-PO-NBR     PIC 9(08).             01330077
010500             15  ASC-DEPT-NBR              PIC X(3).              01340077
010600             15  ASC-DEPT-NBR-N REDEFINES ASC-DEPT-NBR            01350077
010700                                           PIC 9(3).              01360077
010800             15  ASC-STATUS-GRP            PIC X(3).              01370077
010900             15  ASC-STATUS-CDE            PIC X(2).              01380077
W24803             15  ASC-MAJ-CL-NBR            PIC X(2).              01390077
W24803             15  ASC-MAJ-CL-NBR-N REDEFINES ASC-MAJ-CL-NBR        01400077
W24803                                           PIC 9(2).              01410077
011000             15  ASC-CL-NBR.                                      01420077
                       20  ASC-CL-NBR1           PIC X(1).              01430077
                       20  ASC-CL-NBR2           PIC X(1).              01440077
011100             15  ASC-CL-NBR-N REDEFINES ASC-CL-NBR.               01450077
                       20  ASC-CL-NBR-N1         PIC 9(1).              01460077
                       20  ASC-CL-NBR-N2         PIC 9(1).              01470077
011300             15  ASC-PO-TYP-CDE            PIC X(2).              01480077
011400             15  ASC-PO-TYP-DESC           PIC X(20).             01490077
W24803             15  ASC-SKU-NBR               PIC X(8).              01500077
W24803             15  ASC-SKU-NBR-N REDEFINES ASC-SKU-NBR              01510077
W24803                                           PIC 9(8).              01520077
011800             15  ASC-STR-NBR               PIC X(4).              01530077
011900             15  ASC-STR-NBR-N REDEFINES ASC-STR-NBR              01540077
012000                                           PIC 9(4).              01550077
012100             15  ASC-ENT-NAME-DESC         PIC X(30).             01560077
012200             15  ASC-VEND-STYL-NME         PIC X(20).             01570077
012300             15  ASC-AD-EVNT-DTE           PIC X(08).             01580077
012400             15  ASC-AD-EVNT-DTE-ISO       PIC X(10).             01590077
012500             15  ASC-EDI-IND               PIC X(01).             01600077
012700             15  ASC-OTB-PER-NBR-BEG       PIC X(06).             01610077
012800             15  ASC-OTB-PER-NBR-BEG-N REDEFINES                  01620077
012900                 ASC-OTB-PER-NBR-BEG       PIC 9(06).             01630077
013000             15  ASC-OTB-PER-NBR-END       PIC X(06).             01640077
013100             15  ASC-OTB-PER-NBR-END-N REDEFINES                  01650077
013200                 ASC-OTB-PER-NBR-END       PIC 9(06).             01660077
013300             15  ASC-PACK-BY-STORE-IND     PIC X(01).             01670077
013400             15  ASC-DONT-SHIP-BEF-DTE-B   PIC X(08).             01680077
013500             15  ASC-DONT-SHIP-BEF-DTE-B-ISO                      01690077
013600                                           PIC X(10).             01700077
013700             15  ASC-DONT-SHIP-BEF-DTE-E   PIC X(08).             01710077
013800             15  ASC-DONT-SHIP-BEF-DTE-E-ISO                      01720077
013900                                           PIC X(10).             01730077
014000             15  ASC-PRE-TICKET-IND        PIC X(01).             01740077
014100             15  ASC-NEW-STORE-IND         PIC X(01).             01750077
014200             15  ASC-PIC-AD-IND            PIC X(01).             01760077
014300             15  ASC-DIR-STORE-IND         PIC X(01).             01770077
                   15  ASC-GROUP-CODE            PIC X(03).             01780077
W24803         10  FILLER                        PIC X(2679).           01790077
014400/                                                                 01800077
014500*----------------------------------------------------------------*01810077
014600*    ABEND PROCESSING COPYBOOK.                                  *01820077
014700*----------------------------------------------------------------*01830077
014800     COPY DPWS013.                                                01840077
014900/                                                                 01850077
015000*----------------------------------------------------------------*01860077
015100*    DB2 AREA FOR THE PO TYPE CODE TABLE                         *01870077
015200*----------------------------------------------------------------*01880077
015300     EXEC SQL                                                     01890077
015400         INCLUDE TPOTYCD                                          01900077
015500     END-EXEC.                                                    01910077
015600/                                                                 01920077
W24803*----------------------------------------------------------------*01930077
W24803*    DB2 AREA FOR SKU NUMBER                                      01940077
W24803*----------------------------------------------------------------*01950077
W24803     EXEC SQL                                                     01960077
W24803         INCLUDE XLT00003                                         01970077
W24803     END-EXEC.                                                    01980077
W24803/                                                                 01990077
015700*----------------------------------------------------------------*02000077
015800*    DB2 AREA FOR COMMUNICATIONS                                 *02010077
015900*----------------------------------------------------------------*02020077
016000     EXEC SQL                                                     02030077
016100         INCLUDE SQLCA                                            02040077
016200     END-EXEC.                                                    02050077
016300/                                                                 02060077
016400 LINKAGE SECTION.                                                 02070077
016500                                                                  02080077
016600 01  DFHCOMMAREA.                                                 02090077
016700     05  FILLER                         OCCURS  1 TO 4072 TIMES   02100077
016800                                        DEPENDING ON EIBCALEN.    02110077
016900         10  FILLER                     PIC X.                    02120077
017000/                                                                 02130077
017100 PROCEDURE DIVISION.                                              02140077
017200                                                                  02150077
017300***************************************************************** 02160077
017400** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02170077
017500** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02180077
017600** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02190077
017700**                                                             ** 02200077
017800** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02210077
017900** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 02220077
018000***************************************************************** 02230077
018100                                                                  02240077
018200 0000-MAIN-MODULE.                                                02250077
018300                                                                  02260077
018400     INITIALIZE DP030-CICS-API-FIELDS.                            02270077
018500     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         02280077
018600     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            02290077
018700     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           02300077
018800     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         02310077
018900     MOVE LENGTH OF PO028AI      TO DP030-MAP-LENGTH (1).         02320077
019000     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       02330077
019100                                                                  02340077
019200     PERFORM 0001-CALL-CICS-ARCH-API.                             02350077
019300     PERFORM 1000-CONTROL-PROCESSING                              02360077
019400                                                                  02370077
019500     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       02380077
019600     PERFORM 0001-CALL-CICS-ARCH-API.                             02390077
019700                                                                  02400077
019800                                                                  02410077
019900 0001-CALL-CICS-ARCH-API.                                         02420077
020000                                                                  02430077
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      02440078
020200                                    DFHCOMMAREA                   02450078
020300                                    DP030-CICS-API-FIELDS         02460078
020400                                    DP020-STANDARD-COMMAREA       02470078
020500                                    PO028AI.                      02480078
020600                                                                  02490077
020700     IF  DP030-RC-CALL-SUCCESSFUL                                 02500077
020800         CONTINUE                                                 02510077
020900     ELSE                                                         02520077
021000         SET DP013-NO-ROLLBACK                                    02530077
021100             DP013-XCTL-DISPLAY-RESTART                           02540077
021200             DP013-CICS-ABEND    TO TRUE                          02550077
CICS           MOVE '0001-CALL-CICS-ARCH-API'                           02560078
021400                                 TO DP013-PARAGRAPH               02570077
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02580078
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02590078
021700         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        02600077
021800         PERFORM DP013-0000-PROCESS-ABEND                         02610077
021900     END-IF.                                                      02620077
022000/                                                                 02630077
022100*----------------------------------------------------------------*02640077
022200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02650077
022300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02660077
022400*----------------------------------------------------------------*02670077
022500                                                                  02680077
022600 1000-CONTROL-PROCESSING.                                         02690077
022700                                                                  02700077
022800     EVALUATE TRUE                                                02710077
022900         WHEN DP020-NEXT-ACT-INITIAL                              02720077
023000             INITIALIZE ASC-SPECIFIC-COMMAREA                     02730077
023100             PERFORM 4000-BUILD-INITIAL-PANEL                     02740077
023200                                                                  02750077
023300         WHEN DP020-NEXT-ACT-READ-MAP                             02760077
023400             PERFORM 2000-FKEY-PROCESSING                         02770077
023500                                                                  02780077
023600         WHEN DP020-NEXT-ACT-RETURN                               02790077
023700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 02800077
023800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   02810077
023900                                                                  02820077
024000         WHEN OTHER                                               02830077
024100             SET DP013-LOGIC-ABEND                                02840077
024200                 DP013-NO-ROLLBACK                                02850077
024300                                 TO TRUE                          02860077
024400             MOVE '1000-CONTROL-PROCESSING'                       02870077
024500                                 TO  DP013-PARAGRAPH              02880077
024600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   02890077
024700                                 TO  DP013-MESSAGE-TEXT(1)        02900077
024800             MOVE DP020-NEXT-APPL-ACTIVITY                        02910077
024900                                 TO DP013-MESSAGE-TEXT(2)         02920077
025000             PERFORM DP013-0000-PROCESS-ABEND                     02930077
025100     END-EVALUATE.                                                02940077
025200/                                                                 02950077
025300*----------------------------------------------------------------*02960077
025400* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02970077
025500* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02980077
025600* EDITS.                                                         *02990077
025700*----------------------------------------------------------------*03000077
025800                                                                  03010077
025900 2000-FKEY-PROCESSING.                                            03020077
026000                                                                  03030077
026100     EVALUATE TRUE                                                03040077
026200                                                                  03050077
026300         WHEN DP020-SRC-AID = DP016-CLEAR                         03060077
026400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03070077
026500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03080077
026600                                                                  03090077
026700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     03100077
026800             INITIALIZE ASC-SPECIFIC-COMMAREA                     03110077
026900             PERFORM 4000-BUILD-INITIAL-PANEL                     03120077
027000             PERFORM 3100-RESET-ATTRIBUTES                        03130077
027100                                                                  03140077
027200         WHEN OTHER                                               03150077
027300             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 03160077
027400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03170077
027500             IF  PS-NO-ERROR                                      03180077
027600                 SET DP030-CONTINUE-GO                            03190077
027700                                 TO TRUE                          03200077
027800                 PERFORM 2100-CHECK-FUNCTION-KEY                  03210077
027900             ELSE                                                 03220077
028000                 SET DP030-OVERRIDE-GO                            03230077
028100                                 TO TRUE                          03240077
028200             END-IF                                               03250077
028300     END-EVALUATE.                                                03260077
028400/                                                                 03270077
028500******************************************************************03280077
028600** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03290077
028700** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03300077
028800** FROM THE CICS ARCHITECTURE API.                              **03310077
028900******************************************************************03320077
029000                                                                  03330077
029100 2100-CHECK-FUNCTION-KEY.                                         03340077
029200                                                                  03350077
029300     EVALUATE TRUE                                                03360077
029400         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 03370077
029500             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03380077
029600                                                                  03390077
029400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03400077
029500             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03410077
                                                                        03420077
029400         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              03430077
029500             PERFORM 2110-PREPARE-INTER-APPL-COMM                 03440077
                                                                        03450077
029700         WHEN DP020-SRC-AID = DP016-ENTER                         03460077
029800             CONTINUE                                             03470077
029900                                                                  03480077
030000         WHEN OTHER                                               03490077
030100             SET DP013-NO-ROLLBACK                                03500077
030200                 DP013-XCTL-DISPLAY-RESTART                       03510077
030300                 DP013-CICS-ABEND                                 03520077
030400                                 TO TRUE                          03530077
030500             MOVE '2100-CHECK-FUNCTION-KEY'                       03540077
030600                                 TO DP013-PARAGRAPH               03550077
030700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      03560077
030800                                 TO DP013-MESSAGE-TEXT (1)        03570077
030900             PERFORM DP013-0000-PROCESS-ABEND                     03580077
031000     END-EVALUATE.                                                03590077
031100/                                                                 03600077
031200******************************************************************03610077
031300** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **03620077
031400** INTER-APPLICATION COMMAREA.                                  **03630077
031500******************************************************************03640077
031600                                                                  03650077
031700 2110-PREPARE-INTER-APPL-COMM.                                    03660077
031800                                                                  03670077
031900     MOVE ASC-PO-NBR             TO PO017-PO-NBR.                 03680077
032000     MOVE ASC-IMPRT-AGNT-PO-NBR  TO PO017-IMPRT-AGNT-PO-NBR.      03690077
032100     MOVE ASC-DEPT-NBR           TO PO017-DEPT-NBR.               03700077
032200     MOVE ASC-STATUS-GRP         TO PO017-STATUS-GRP.             03710077
032300     MOVE ASC-STATUS-CDE         TO PO017-STATUS-CDE.             03720077
032400     MOVE ASC-CL-NBR             TO PO017-CL-NBR.                 03730077
W24803     IF ASC-MAJ-CL-NBR > SPACES                                   03740077
W24803       MOVE ASC-MAJ-CL-NBR-N     TO PV-MAJ-CLASS                  03750077
W24803       MOVE PV-MAJ-CLASS         TO PO017-MAJ-CL-NBR              03760077
W24803     ELSE                                                         03770077
W24803       MOVE ZEROS                TO PO017-MAJ-CL-NBR              03780077
W24803     END-IF.                                                      03790077
032500     MOVE ASC-PO-TYP-CDE         TO PO017-PO-TYP-CDE.             03800077
W24803     MOVE ASC-SKU-NBR            TO PO017-SKU-NBR                 03810077
032700     MOVE ASC-STR-NBR-N          TO PO017-STR-NBR.                03820077
032800     MOVE ASC-ENT-NAME-DESC      TO PO017-ENT-NAME-DESC.          03830077
032900     MOVE ASC-VEND-STYL-NME      TO PO017-VEND-STYL-NME.          03840077
033000     MOVE ASC-AD-EVNT-DTE        TO PO017-AD-EVNT-DTE.            03850077
033100     MOVE ASC-AD-EVNT-DTE-ISO    TO PO017-AD-EVNT-DTE-ISO.        03860077
033200     MOVE ASC-EDI-IND            TO PO017-EDI-IND.                03870077
033400     MOVE ASC-OTB-PER-NBR-BEG(3:4)    TO PO017-OTB-PER-NBR-BEG.   03880077
033600     MOVE ASC-OTB-PER-NBR-END(3:4)    TO PO017-OTB-PER-NBR-END.   03890077
033700     MOVE ASC-PACK-BY-STORE-IND  TO PO017-PACK-BY-STORE-IND.      03900077
033800     MOVE ASC-DONT-SHIP-BEF-DTE-B                                 03910077
033900                                 TO PO017-DONT-SHIP-BEF-DTE-B.    03920077
034000     MOVE ASC-DONT-SHIP-BEF-DTE-B-ISO                             03930077
034100                              TO PO017-DONT-SHIP-BEF-DTE-B-ISO.   03940077
034200     MOVE ASC-DONT-SHIP-BEF-DTE-E                                 03950077
034300                                 TO PO017-DONT-SHIP-BEF-DTE-E.    03960077
034400     MOVE ASC-DONT-SHIP-BEF-DTE-E-ISO                             03970077
034500                              TO PO017-DONT-SHIP-BEF-DTE-E-ISO.   03980077
034600     MOVE ASC-PRE-TICKET-IND     TO PO017-PRE-TICKET-IND.         03990077
034700                                                                  04000077
034800     MOVE ASC-NEW-STORE-IND      TO PO017-NEW-STR-IND.            04010077
034900                                                                  04020077
035000     MOVE ASC-PIC-AD-IND         TO PO017-PIC-AD-IND.             04030077
035100                                                                  04040077
035200     MOVE ASC-DIR-STORE-IND      TO PO017-DIR-STORE-IND.          04050077
           MOVE ASC-GROUP-CODE         TO PO017-GROUP-CODE.             04060077
035300/                                                                 04070077
035400*----------------------------------------------------------------*04080077
035500* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*04090077
035600* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *04100077
035700* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *04110077
035800*----------------------------------------------------------------*04120077
035900                                                                  04130077
036000 2200-MOVE-SCREEN-TO-COMMAREA.                                    04140077
036100                                                                  04150077
036200     IF  APONUML > ZERO                                           04160077
036300         MOVE APONUMI              TO ASC-PO-NBR                  04170077
036400     ELSE                                                         04180077
036500         IF  APONUMF = DP015-ERASE-EOF                            04190077
036600             MOVE SPACE            TO ASC-PO-NBR                  04200077
036700         END-IF                                                   04210077
036800     END-IF.                                                      04220077
036900                                                                  04230077
037000     IF  ADEPTL > ZERO                                            04240077
037100         MOVE ADEPTI               TO ASC-DEPT-NBR                04250077
037200     ELSE                                                         04260077
037300         IF  ADEPTF = DP015-ERASE-EOF                             04270077
037400             MOVE SPACE            TO ASC-DEPT-NBR                04280077
037500         END-IF                                                   04290077
037600     END-IF.                                                      04300077
037700                                                                  04310077
037800     IF  ASTGRPL > ZERO                                           04320077
037900         MOVE ASTGRPI              TO ASC-STATUS-GRP              04330077
038000     ELSE                                                         04340077
038100         IF  ASTGRPF = DP015-ERASE-EOF                            04350077
038200             MOVE SPACE            TO ASC-STATUS-GRP              04360077
038300         END-IF                                                   04370077
038400     END-IF.                                                      04380077
038500                                                                  04390077
038600     IF  ASC1L > ZERO                                             04400077
038700         MOVE ASC1I                TO ASC-STATUS-CDE              04410077
038800     ELSE                                                         04420077
038900         IF  ASC1F = DP015-ERASE-EOF                              04430077
039000             MOVE SPACE            TO ASC-STATUS-CDE              04440077
039100         END-IF                                                   04450077
039200     END-IF.                                                      04460077
039300                                                                  04470077
W24803     IF  AMCLL > ZERO                                             04480077
W24803         MOVE AMCLI                  TO ASC-MAJ-CL-NBR            04490077
W24803     ELSE                                                         04500077
W24803         IF  AMCLF  = DP015-ERASE-EOF                             04510077
W24803         MOVE SPACE                  TO ASC-MAJ-CL-NBR            04520077
W24803         END-IF                                                   04530077
W24803     END-IF.                                                      04540077
W24803                                                                  04550077
039400     IF  ACLASSL > ZERO                                           04560077
039500         MOVE ACLASSI                TO ASC-CL-NBR                04570077
039600     ELSE                                                         04580077
039700         IF  ACLASSF  = DP015-ERASE-EOF                           04590077
039800             MOVE SPACE             TO ASC-CL-NBR                 04600077
039900         END-IF                                                   04610077
040000     END-IF.                                                      04620077
040100                                                                  04630077
040200     IF  APOTYPEL > ZERO                                          04640077
040300         MOVE APOTYPEI             TO ASC-PO-TYP-CDE              04650077
040400     ELSE                                                         04660077
040500         IF  APOTYPEF = DP015-ERASE-EOF                           04670077
040600             MOVE SPACE            TO ASC-PO-TYP-CDE              04680077
040700         END-IF                                                   04690077
040800     END-IF.                                                      04700077
040900                                                                  04710077
041000     IF ASKUL > ZERO                                              04720077
W24803         MOVE ASKUI                TO ASC-SKU-NBR                 04730077
041200     ELSE                                                         04740077
041300         IF ASKUF = DP015-ERASE-EOF                               04750077
W24803             MOVE SPACE            TO ASC-SKU-NBR                 04760077
041500         END-IF                                                   04770077
041600     END-IF.                                                      04780077
041700                                                                  04790077
041800     IF ASTOREL > ZERO                                            04800077
041900         MOVE ASTOREI              TO ASC-STR-NBR                 04810077
042000     ELSE                                                         04820077
042100         IF ASTOREF = DP015-ERASE-EOF                             04830077
042200             MOVE SPACE            TO ASC-STR-NBR                 04840077
042300         END-IF                                                   04850077
042400     END-IF.                                                      04860077
042500                                                                  04870077
042600     IF  AIPONUML > ZERO                                          04880077
042700         MOVE AIPONUMI             TO ASC-IMPRT-AGNT-PO-NBR       04890077
042800     ELSE                                                         04900077
042900         IF  AIPONUMF = DP015-ERASE-EOF                           04910077
043000             MOVE SPACE            TO ASC-IMPRT-AGNT-PO-NBR       04920077
043100         END-IF                                                   04930077
043200     END-IF.                                                      04940077
043300                                                                  04950077
043400     IF AVENDNML > ZERO                                           04960077
043500         MOVE AVENDNMI             TO ASC-ENT-NAME-DESC           04970077
043600     ELSE                                                         04980077
043700         IF AVENDNMF = DP015-ERASE-EOF                            04990077
043800             MOVE SPACE            TO ASC-ENT-NAME-DESC           05000077
043900         END-IF                                                   05010077
044000     END-IF.                                                      05020077
044100                                                                  05030077
044200     IF ASTYLEL > ZERO                                            05040077
044300         MOVE ASTYLEI              TO ASC-VEND-STYL-NME           05050077
044400     ELSE                                                         05060077
044500         IF ASTYLEF = DP015-ERASE-EOF                             05070077
044600             MOVE SPACE            TO ASC-VEND-STYL-NME           05080077
044700         END-IF                                                   05090077
044800     END-IF.                                                      05100077
044900                                                                  05110077
044200     IF AGRPCDL > ZERO                                            05120077
044300         MOVE AGRPCDI              TO ASC-GROUP-CODE              05130077
044400     ELSE                                                         05140077
044500         IF AGRPCDF = DP015-ERASE-EOF                             05150077
044600             MOVE SPACE            TO ASC-GROUP-CODE              05160077
044700         END-IF                                                   05170077
044800     END-IF.                                                      05180077
                                                                        05190077
045000     IF ADDATEL > ZERO                                            05200077
045100         MOVE ADDATEI              TO ASC-AD-EVNT-DTE             05210077
045200     ELSE                                                         05220077
045300         IF ADDATEF = DP015-ERASE-EOF                             05230077
045400             MOVE SPACE            TO ASC-AD-EVNT-DTE             05240077
045500                                      ASC-AD-EVNT-DTE-ISO         05250077
045600         END-IF                                                   05260077
045700     END-IF.                                                      05270077
045800                                                                  05280077
045900     IF AEDIL > ZERO                                              05290077
046000         MOVE AEDII                TO ASC-EDI-IND                 05300077
046100     ELSE                                                         05310077
046200         IF AEDIF = DP015-ERASE-EOF                               05320077
046300             MOVE SPACE            TO ASC-EDI-IND                 05330077
046400         END-IF                                                   05340077
046500     END-IF.                                                      05350077
046600                                                                  05360077
046700     IF AOTBBEGL > ZERO                                           05370077
046800         IF AOTBBEGI(3:2) > 80                                    05380077
046900            MOVE '19' TO ASC-OTB-PER-NBR-BEG(1:2)                 05390077
047000         ELSE                                                     05400077
047100            MOVE '20' TO ASC-OTB-PER-NBR-BEG(1:2)                 05410077
047200         END-IF                                                   05420077
047300         MOVE AOTBBEGI(3:2) TO ASC-OTB-PER-NBR-BEG(3:2)           05430077
047400         MOVE AOTBBEGI(1:2) TO ASC-OTB-PER-NBR-BEG(5:2)           05440077
047800     ELSE                                                         05450077
047900         IF AOTBBEGF = DP015-ERASE-EOF                            05460077
048000             MOVE SPACE            TO ASC-OTB-PER-NBR-BEG         05470077
048100         END-IF                                                   05480077
048200     END-IF.                                                      05490077
048300                                                                  05500077
048400     IF AOTBENDL > ZERO                                           05510077
048500         IF AOTBENDI(3:2) > 80                                    05520077
048600            MOVE '19' TO ASC-OTB-PER-NBR-END(1:2)                 05530077
048700         ELSE                                                     05540077
048800            MOVE '20' TO ASC-OTB-PER-NBR-END(1:2)                 05550077
048900         END-IF                                                   05560077
049000         MOVE AOTBENDI(3:2) TO ASC-OTB-PER-NBR-END(3:2)           05570077
049100         MOVE AOTBENDI(1:2) TO ASC-OTB-PER-NBR-END(5:2)           05580077
049500     ELSE                                                         05590077
049600         IF AOTBENDF = DP015-ERASE-EOF                            05600077
049700             MOVE SPACE            TO ASC-OTB-PER-NBR-END         05610077
049800         END-IF                                                   05620077
049900     END-IF.                                                      05630077
050000                                                                  05640077
050100     IF APCKSTL > ZERO                                            05650077
050200         MOVE APCKSTI              TO ASC-PACK-BY-STORE-IND       05660077
050300     ELSE                                                         05670077
050400         IF APCKSTF = DP015-ERASE-EOF                             05680077
050500             MOVE SPACE            TO ASC-PACK-BY-STORE-IND       05690077
050600         END-IF                                                   05700077
050700     END-IF.                                                      05710077
050800                                                                  05720077
050900     IF ASHPBEGL > ZERO                                           05730077
051000         MOVE ASHPBEGI             TO ASC-DONT-SHIP-BEF-DTE-B     05740077
051100     ELSE                                                         05750077
051200         IF ASHPBEGF = DP015-ERASE-EOF                            05760077
051300             MOVE SPACE            TO ASC-DONT-SHIP-BEF-DTE-B     05770077
051400                                      ASC-DONT-SHIP-BEF-DTE-B-ISO 05780077
051500         END-IF                                                   05790077
051600     END-IF.                                                      05800077
051700                                                                  05810077
051800     IF ASHPENDL > ZERO                                           05820077
051900         MOVE ASHPENDI             TO ASC-DONT-SHIP-BEF-DTE-E     05830077
052000     ELSE                                                         05840077
052100         IF ASHPENDF = DP015-ERASE-EOF                            05850077
052200             MOVE SPACE            TO ASC-DONT-SHIP-BEF-DTE-E     05860077
052300                                      ASC-DONT-SHIP-BEF-DTE-E-ISO 05870077
052400         END-IF                                                   05880077
052500     END-IF.                                                      05890077
052600                                                                  05900077
052700     IF APRETICL > ZERO                                           05910077
052800         MOVE APRETICI             TO ASC-PRE-TICKET-IND          05920077
052900     ELSE                                                         05930077
053000         IF APRETICF = DP015-ERASE-EOF                            05940077
053100             MOVE SPACE            TO ASC-PRE-TICKET-IND          05950077
053200         END-IF                                                   05960077
053300     END-IF.                                                      05970077
053400                                                                  05980077
053500     IF ANEWSTRL > ZERO                                           05990077
053600         MOVE ANEWSTRI             TO ASC-NEW-STORE-IND           06000077
053700     ELSE                                                         06010077
053800         IF ANEWSTRF = DP015-ERASE-EOF                            06020077
053900             MOVE SPACE            TO ASC-NEW-STORE-IND           06030077
054000         END-IF                                                   06040077
054100     END-IF.                                                      06050077
054200                                                                  06060077
054300     IF APICADL > ZERO                                            06070077
054400         MOVE APICADI              TO ASC-PIC-AD-IND              06080077
054500     ELSE                                                         06090077
054600         IF APICADF = DP015-ERASE-EOF                             06100077
054700             MOVE SPACE            TO ASC-PIC-AD-IND              06110077
054800         END-IF                                                   06120077
054900     END-IF.                                                      06130077
055000                                                                  06140077
055100     IF ADIRSTRL > ZERO                                           06150077
055200         MOVE ADIRSTRI             TO ASC-DIR-STORE-IND           06160077
055300     ELSE                                                         06170077
055400         IF ADIRSTRF = DP015-ERASE-EOF                            06180077
055500             MOVE SPACE            TO ASC-DIR-STORE-IND           06190077
055600         END-IF                                                   06200077
055700     END-IF.                                                      06210077
055800/                                                                 06220077
055900*----------------------------------------------------------------*06230077
056000* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *06240077
056100* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *06250077
056200* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*06260077
056300* IN THE DESTINATION PROGRAM, NOT HERE.                          *06270077
056400*----------------------------------------------------------------*06280077
056500                                                                  06290077
056600 3000-EDIT-DATA-IN-COMMAREA.                                      06300077
056700                                                                  06310077
056800     PERFORM 3100-RESET-ATTRIBUTES.                               06320077
056900                                                                  06330077
057000     IF  ASC-DIR-STORE-IND > SPACES                               06340077
               IF ASC-GROUP-CODE = SPACES                               06350077
                  CONTINUE                                              06360077
               ELSE                                                     06370077
                  SET PS-ERROR           TO TRUE                        06380077
                  SET DP020-MSG-FATAL    TO TRUE                        06390077
                  MOVE PC-TSYMSG-02182   TO DP020-MSG-NUMBER            06400077
      *           MOVE 'GROUP CODE CANNOT BE ENTERED WITH DIR STORE IND'06410077
      *                                  TO DP020-MSG-TEXT              06420077
                  MOVE DP015-UNP-ALP-BRT-OFF                            06430077
                                         TO AGRPCDA                     06440077
                  MOVE DP015-RED         TO AGRPCDC                     06450077
                  MOVE DP015-REVERSE     TO AGRPCDH                     06460077
                  MOVE -1                TO AGRPCDL                     06470077
                  SET DP030-SET-CURSOR-APPL-1                           06480077
                                         TO TRUE                        06490077
               END-IF                                                   06500077
                                                                        06510077
057100         IF  ASC-DIR-STORE-IND > SPACES                           06520077
057100             IF  ASC-DIR-STORE-IND = 'Y' OR 'N'                   06530077
057200                 CONTINUE                                         06540077
057300             ELSE                                                 06550077
057400                 SET PS-ERROR          TO TRUE                    06560077
057500                 SET DP020-MSG-FATAL   TO TRUE                    06570077
057600                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        06580077
057700                 MOVE DP015-UNP-ALP-BRT-OFF                       06590077
057800                                       TO ADIRSTRA                06600077
057900                 MOVE DP015-RED        TO ADIRSTRC                06610077
058000                 MOVE DP015-REVERSE    TO ADIRSTRH                06620077
058100                 MOVE -1               TO ADIRSTRL                06630077
058200                 SET DP030-SET-CURSOR-APPL-1                      06640077
058300                                       TO TRUE                    06650077
058400             END-IF                                               06660077
058500         END-IF                                                   06670077
           END-IF.                                                      06680077
058600                                                                  06690077
058700     IF  ASC-PIC-AD-IND > SPACES                                  06700077
058800         IF  ASC-PIC-AD-IND = 'Y' OR 'N'                          06710077
058900             CONTINUE                                             06720077
059000         ELSE                                                     06730077
059100             SET PS-ERROR          TO TRUE                        06740077
059200             SET DP020-MSG-FATAL   TO TRUE                        06750077
059300             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            06760077
059400             MOVE DP015-UNP-ALP-BRT-OFF                           06770077
059500                                   TO APICADA                     06780077
059600             MOVE DP015-RED        TO APICADC                     06790077
059700             MOVE DP015-REVERSE    TO APICADH                     06800077
059800             MOVE -1               TO APICADL                     06810077
059900             SET DP030-SET-CURSOR-APPL-1                          06820077
060000                                   TO TRUE                        06830077
060100         END-IF                                                   06840077
060200     END-IF.                                                      06850077
060300                                                                  06860077
060400     IF  ASC-PRE-TICKET-IND > SPACES                              06870077
               IF ASC-GROUP-CODE = SPACES                               06880077
                  CONTINUE                                              06890077
               ELSE                                                     06900077
                  SET PS-ERROR           TO TRUE                        06910077
                  SET DP020-MSG-FATAL    TO TRUE                        06920077
                  MOVE PC-TSYMSG-02182   TO DP020-MSG-NUMBER            06930077
      *           MOVE 'GROUP CODE CANNOT BE ENTERED WITH PRETICKET IND'06940077
      *                                  TO DP020-MSG-TEXT              06950077
                  MOVE DP015-UNP-ALP-BRT-OFF                            06960077
                                         TO AGRPCDA                     06970077
                  MOVE DP015-RED         TO AGRPCDC                     06980077
                  MOVE DP015-REVERSE     TO AGRPCDH                     06990077
                  MOVE -1                TO AGRPCDL                     07000077
                  SET DP030-SET-CURSOR-APPL-1                           07010077
                                         TO TRUE                        07020077
               END-IF                                                   07030077
                                                                        07040077
060500         IF  ASC-PRE-TICKET-IND > SPACES                          07050077
060500             IF  ASC-PRE-TICKET-IND = 'Y' OR 'N'                  07060077
060600                 CONTINUE                                         07070077
060700             ELSE                                                 07080077
060800                 SET PS-ERROR          TO TRUE                    07090077
060900                 SET DP020-MSG-FATAL   TO TRUE                    07100077
061000                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        07110077
061100                 MOVE DP015-UNP-ALP-BRT-OFF                       07120077
061200                                       TO APRETICA                07130077
061300                 MOVE DP015-RED        TO APRETICC                07140077
061400                 MOVE DP015-REVERSE    TO APRETICH                07150077
061500                 MOVE -1               TO APRETICL                07160077
061600                 SET DP030-SET-CURSOR-APPL-1                      07170077
061700                                   TO TRUE                        07180077
061800             END-IF                                               07190077
               END-IF                                                   07200077
061900     END-IF.                                                      07210077
062000                                                                  07220077
062100     IF  ASC-PACK-BY-STORE-IND > SPACES                           07230077
               IF ASC-GROUP-CODE = SPACES                               07240077
                  CONTINUE                                              07250077
               ELSE                                                     07260077
                  SET PS-ERROR           TO TRUE                        07270077
                  SET DP020-MSG-FATAL    TO TRUE                        07280077
                  MOVE PC-TSYMSG-02182   TO DP020-MSG-NUMBER            07290077
      *           MOVE 'GROUP CODE CANNOT BE ENTERED WITH PACK BY STORE 07300077
      *                'IND'             TO DP020-MSG-TEXT              07310077
                  MOVE DP015-UNP-ALP-BRT-OFF                            07320077
                                         TO AGRPCDA                     07330077
                  MOVE DP015-RED         TO AGRPCDC                     07340077
                  MOVE DP015-REVERSE     TO AGRPCDH                     07350077
                  MOVE -1                TO AGRPCDL                     07360077
                  SET DP030-SET-CURSOR-APPL-1                           07370077
                                         TO TRUE                        07380077
               END-IF                                                   07390077
062200         IF  ASC-PACK-BY-STORE-IND > SPACES                       07400077
062200             IF  ASC-PACK-BY-STORE-IND = 'Y' OR 'N'               07410077
062300                 CONTINUE                                         07420077
062400             ELSE                                                 07430077
062500                 SET PS-ERROR          TO TRUE                    07440077
062600                 SET DP020-MSG-FATAL   TO TRUE                    07450077
062700                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        07460077
062800                 MOVE DP015-UNP-ALP-BRT-OFF                       07470077
062900                                       TO APCKSTA                 07480077
063000                 MOVE DP015-RED        TO APCKSTC                 07490077
063100                 MOVE DP015-REVERSE    TO APCKSTH                 07500077
063200                 MOVE -1               TO APCKSTL                 07510077
063300                 SET DP030-SET-CURSOR-APPL-1                      07520077
063400                                       TO TRUE                    07530077
063500             END-IF                                               07540077
               END-IF                                                   07550077
063600     END-IF.                                                      07560077
063700                                                                  07570077
063800     IF  ASC-EDI-IND > SPACES                                     07580077
               IF ASC-GROUP-CODE = SPACES                               07590077
                  CONTINUE                                              07600077
               ELSE                                                     07610077
                  SET PS-ERROR           TO TRUE                        07620077
                  SET DP020-MSG-FATAL    TO TRUE                        07630077
                  MOVE PC-TSYMSG-02182   TO DP020-MSG-NUMBER            07640077
      *           MOVE 'GROUP CODE CANNOT BE ENTERED WITH EDI IND'      07650077
      *                                  TO DP020-MSG-TEXT              07660077
                  MOVE DP015-UNP-ALP-BRT-OFF                            07670077
                                         TO AGRPCDA                     07680077
                  MOVE DP015-RED         TO AGRPCDC                     07690077
                  MOVE DP015-REVERSE     TO AGRPCDH                     07700077
                  MOVE -1                TO AGRPCDL                     07710077
                  SET DP030-SET-CURSOR-APPL-1                           07720077
                                         TO TRUE                        07730077
               END-IF                                                   07740077
063900         IF  ASC-EDI-IND  = SPACES                                07750077
063900             IF  ASC-EDI-IND  = 'Y' OR 'N'                        07760077
064000                 CONTINUE                                         07770077
064100             ELSE                                                 07780077
064200                 SET PS-ERROR          TO TRUE                    07790077
064300                 SET DP020-MSG-FATAL   TO TRUE                    07800077
064400                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        07810077
064500                 MOVE DP015-UNP-ALP-BRT-OFF                       07820077
064600                                       TO AEDIA                   07830077
064700                 MOVE DP015-RED        TO AEDIC                   07840077
064800                 MOVE DP015-REVERSE    TO AEDIH                   07850077
064900                 MOVE -1               TO AEDIL                   07860077
065000                 SET DP030-SET-CURSOR-APPL-1                      07870077
065100                                       TO TRUE                    07880077
065200             END-IF                                               07890077
               END-IF                                                   07900077
065300     END-IF.                                                      07910077
065400                                                                  07920077
065500     IF ASC-DONT-SHIP-BEF-DTE-E > SPACES                          07930077
065600        INITIALIZE DPG51                                          07940077
065700        SET DPG51-ACTUAL-CALENDAR-ONLY                            07950077
065800                                 TO TRUE                          07960077
065900        SET DPG51-DO-NOT-INCR-DECR-DATE                           07970077
066000                                 TO TRUE                          07980077
066100        MOVE ZERO                TO TALLY                         07990077
066200        INSPECT ASC-DONT-SHIP-BEF-DTE-E                           08000077
066300                TALLYING TALLY FOR ALL '/'                        08010077
066400        IF TALLY > 1                                              08020077
066500*               'MM/DD/YY'                                        08030077
066600           SET DPG52-LK-DTE-GREG-CC-FMT                           08040077
066700                                  TO TRUE                         08050077
066800           IF ASC-DONT-SHIP-BEF-DTE-E(7:2) > 80                   08060077
066900              MOVE '19' TO PV-DONT-SHIP-DATE(7:2)                 08070077
067000           ELSE                                                   08080077
067100              MOVE '20' TO PV-DONT-SHIP-DATE(7:2)                 08090077
067200           END-IF                                                 08100077
067300           MOVE ASC-DONT-SHIP-BEF-DTE-E(1:6)                      08110077
067400                         TO PV-DONT-SHIP-DATE(1:6)                08120077
067500           MOVE ASC-DONT-SHIP-BEF-DTE-E(7:2)                      08130077
067600                        TO PV-DONT-SHIP-DATE(9:2)                 08140077
067700        ELSE                                                      08150077
067800*               'MMDDYY  '                                        08160077
067900           SET DPG52-LK-DTE-GREG-CC  TO TRUE                      08170077
068000           IF ASC-DONT-SHIP-BEF-DTE-E(5:2) > 80                   08180077
068100              MOVE '19' TO PV-DONT-SHIP-DATE(5:2)                 08190077
068200            ELSE                                                  08200077
068300              MOVE '20' TO PV-DONT-SHIP-DATE(5:2)                 08210077
068400            END-IF                                                08220077
068500            MOVE ASC-DONT-SHIP-BEF-DTE-E(1:2)                     08230077
068600                      TO PV-DONT-SHIP-DATE(1:2)                   08240077
068700            MOVE ASC-DONT-SHIP-BEF-DTE-E(3:2)                     08250077
068800                      TO PV-DONT-SHIP-DATE(3:2)                   08260077
068900            MOVE ASC-DONT-SHIP-BEF-DTE-E(5:2)                     08270077
069000                      TO PV-DONT-SHIP-DATE(7:2)                   08280077
069100            MOVE SPACES TO PV-DONT-SHIP-DATE(9:2)                 08290077
069200        END-IF                                                    08300077
069400        MOVE PV-DONT-SHIP-DATE TO DPG52-LK-DATE-INPUT             08310077
069600        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   08320077
069700                  DPG51 DPG52 DPG53 DPG54 DPG55 DPG56             08330077
069800        IF (DPG54-DATE-INVALID                                    08340077
069900        OR  DPG54-SEVERE-ERROR)                                   08350077
070000            SET PS-ERROR                                          08360077
070100                DP020-MSG-FATAL   TO TRUE                         08370077
070200*        ---- INVALID DATE ----                                   08380077
070300            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             08390077
070400            MOVE DP015-UNP-ALP-BRT-MDT                            08400077
070500                                  TO ASHPENDA                     08410077
070600            MOVE DP015-RED        TO ASHPENDC                     08420077
070700            MOVE DP015-REVERSE    TO ASHPENDH                     08430077
070800            MOVE -1               TO ASHPENDL                     08440077
070900            SET DP030-SET-CURSOR-APPL-1                           08450077
071000                                  TO TRUE                         08460077
071100        ELSE                                                      08470077
071200            MOVE DPG55-GREG-DATE-FMT                              08480077
071300                                  TO ASC-DONT-SHIP-BEF-DTE-E      08490077
071400            MOVE DPG55-DB2-ISO-DATE-FMT                           08500077
071500                                  TO ASC-DONT-SHIP-BEF-DTE-E-ISO  08510077
071600        END-IF                                                    08520077
071700     END-IF.                                                      08530077
071800                                                                  08540077
071900     IF ASC-DONT-SHIP-BEF-DTE-B > SPACES                          08550077
072000        INITIALIZE DPG51 DPG52                                    08560077
072100        SET DPG51-ACTUAL-CALENDAR-ONLY                            08570077
072200                                 TO TRUE                          08580077
072300        SET DPG51-DO-NOT-INCR-DECR-DATE                           08590077
072400                                 TO TRUE                          08600077
072500        MOVE ZERO                TO TALLY                         08610077
072600        INSPECT ASC-DONT-SHIP-BEF-DTE-B                           08620077
072700                TALLYING TALLY FOR ALL '/'                        08630077
072800        IF TALLY > 1                                              08640077
072900*               'MM/DD/YY'                                        08650077
073000           SET DPG52-LK-DTE-GREG-CC-FMT                           08660077
073100                                  TO TRUE                         08670077
073200           IF ASC-DONT-SHIP-BEF-DTE-B(7:2) > 80                   08680077
073300              MOVE '19' TO PV-DONT-SHIP-DATE(7:2)                 08690077
073400           ELSE                                                   08700077
073500              MOVE '20' TO PV-DONT-SHIP-DATE(7:2)                 08710077
073600           END-IF                                                 08720077
073700           MOVE ASC-DONT-SHIP-BEF-DTE-B(1:6)                      08730077
073800                         TO PV-DONT-SHIP-DATE(1:6)                08740077
073900           MOVE ASC-DONT-SHIP-BEF-DTE-B(7:2)                      08750077
074000                         TO PV-DONT-SHIP-DATE(9:2)                08760077
074100        ELSE                                                      08770077
074200*               'MMDDYY  '                                        08780077
074300           SET DPG52-LK-DTE-GREG-CC  TO TRUE                      08790077
074400           IF ASC-DONT-SHIP-BEF-DTE-B(5:2) > 80                   08800077
074500              MOVE '19' TO PV-DONT-SHIP-DATE(5:2)                 08810077
074600           ELSE                                                   08820077
074700              MOVE '20' TO PV-DONT-SHIP-DATE(5:2)                 08830077
074800           END-IF                                                 08840077
074900           MOVE ASC-DONT-SHIP-BEF-DTE-B(1:2)                      08850077
075000                      TO PV-DONT-SHIP-DATE(1:2)                   08860077
075100           MOVE ASC-DONT-SHIP-BEF-DTE-B(3:2)                      08870077
075200                      TO PV-DONT-SHIP-DATE(3:2)                   08880077
075300           MOVE ASC-DONT-SHIP-BEF-DTE-B(5:2)                      08890077
075400                      TO PV-DONT-SHIP-DATE(7:2)                   08900077
075500           MOVE SPACES TO PV-DONT-SHIP-DATE(9:2)                  08910077
075600        END-IF                                                    08920077
075610                                                                  08930077
075700        INITIALIZE DPG53 DPG54 DPG55 DPG56                        08940077
075800        MOVE PV-DONT-SHIP-DATE       TO DPG52-LK-DATE-INPUT       08950077
075900                                                                  08960077
075901        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   08970077
075910                        DPG51 DPG52 DPG53 DPG54 DPG55 DPG56       08980077
076000        IF (DPG54-DATE-INVALID                                    08990077
076100        OR  DPG54-SEVERE-ERROR)                                   09000077
076200            SET PS-ERROR                                          09010077
076300                DP020-MSG-FATAL   TO TRUE                         09020077
076400*        ---- INVALID DATE ----                                   09030077
076500            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             09040077
076600            MOVE DP015-UNP-ALP-BRT-MDT                            09050077
076700                                  TO ASHPBEGA                     09060077
076800            MOVE DP015-RED        TO ASHPBEGC                     09070077
076900            MOVE DP015-REVERSE    TO ASHPBEGH                     09080077
077000            MOVE -1               TO ASHPBEGL                     09090077
077100            SET DP030-SET-CURSOR-APPL-1                           09100077
077200                                  TO TRUE                         09110077
077300        ELSE                                                      09120077
077400            MOVE DPG55-GREG-DATE-FMT                              09130077
077500                                  TO ASC-DONT-SHIP-BEF-DTE-B      09140077
077600            MOVE DPG55-DB2-ISO-DATE-FMT                           09150077
077700                                  TO ASC-DONT-SHIP-BEF-DTE-B-ISO  09160077
077800        END-IF                                                    09170077
077900     END-IF.                                                      09180077
078000                                                                  09190077
078100     IF  ASC-DONT-SHIP-BEF-DTE-B-ISO > SPACES                     09200077
078200     AND ASC-DONT-SHIP-BEF-DTE-E-ISO > SPACES                     09210077
078300         IF  ASC-DONT-SHIP-BEF-DTE-B-ISO >                        09220077
078400                                       ASC-DONT-SHIP-BEF-DTE-E-ISO09230077
078500             SET PS-ERROR                                         09240077
078600                 DP020-MSG-FATAL  TO TRUE                         09250077
078700             MOVE PC-TSYMSG-00143 TO DP020-MSG-NUMBER             09260077
078800             MOVE DP015-UNP-ALP-BRT-MDT                           09270077
078900                                  TO ASHPENDA                     09280077
079000             MOVE DP015-RED       TO ASHPENDC                     09290077
079100             MOVE DP015-REVERSE   TO ASHPENDH                     09300077
079200             MOVE -1              TO ASHPENDL                     09310077
079300             SET DP030-SET-CURSOR-APPL-1                          09320077
079400                                  TO TRUE                         09330077
079500         END-IF                                                   09340077
079600     END-IF.                                                      09350077
079700                                                                  09360077
079800     IF  ASC-IMPRT-AGNT-PO-NBR > SPACES                           09370077
079900         MOVE ASC-IMPRT-AGNT-PO-NBR                               09380077
080000                                   TO DP010I-UNEDITED-FIELD       09390077
080100         MOVE LENGTH OF ASC-IMPRT-AGNT-PO-NBR                     09400077
080200                                   TO DP010I-MAXIMUM-DIGITS       09410077
080300         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     09420077
080400         SET DP010I-NEGATIVE-NOT-ALLOWED                          09430077
080500                                   TO TRUE                        09440077
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         09450077
263126              USING DP010I-NUMERIC-EDIT-AREA                      09460077
080700         IF  DP010I-ERROR-DETECTED                                09470077
080800             SET PS-ERROR                                         09480077
080900                 DP020-MSG-FATAL   TO TRUE                        09490077
081000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            09500077
081100             MOVE DP015-UNP-ALP-BRT-OFF                           09510077
081200                                   TO AIPONUMA                    09520077
081300             MOVE DP015-RED        TO AIPONUMC                    09530077
081400             MOVE DP015-REVERSE    TO AIPONUMH                    09540077
081500             MOVE -1               TO AIPONUML                    09550077
081600             SET DP030-SET-CURSOR-APPL-1                          09560077
081700                                   TO TRUE                        09570077
081800         ELSE                                                     09580077
081900             MOVE DP010I-NUMERIC-FIELD                            09590077
082000                                   TO ASC-IMPRT-AGNT-PO-NBR-N     09600077
082100         END-IF                                                   09610077
082200     END-IF.                                                      09620077
082300                                                                  09630077
082400     IF  ASC-NEW-STORE-IND > SPACES                               09640077
               IF ASC-GROUP-CODE = SPACES                               09650077
                  CONTINUE                                              09660077
               ELSE                                                     09670077
                  SET PS-ERROR           TO TRUE                        09680077
                  SET DP020-MSG-FATAL    TO TRUE                        09690077
                  MOVE PC-TSYMSG-02182   TO DP020-MSG-NUMBER            09700077
      *           MOVE 'GROUP CODE CANNOT BE ENTERED WITH NEW STORE IND'09710077
      *                                  TO DP020-MSG-TEXT              09720077
                  MOVE DP015-UNP-ALP-BRT-OFF                            09730077
                                         TO AGRPCDA                     09740077
                  MOVE DP015-RED         TO AGRPCDC                     09750077
                  MOVE DP015-REVERSE     TO AGRPCDH                     09760077
                  MOVE -1                TO AGRPCDL                     09770077
                  SET DP030-SET-CURSOR-APPL-1                           09780077
                                         TO TRUE                        09790077
               END-IF                                                   09800077
082500         IF  ASC-NEW-STORE-IND = SPACES                           09810077
082500             IF  ASC-NEW-STORE-IND = 'Y' OR 'N'                   09820077
082600                 CONTINUE                                         09830077
082700             ELSE                                                 09840077
082800                 SET PS-ERROR          TO TRUE                    09850077
082900                 SET DP020-MSG-FATAL   TO TRUE                    09860077
083000                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        09870077
083100                 MOVE DP015-UNP-ALP-BRT-OFF                       09880077
083200                                       TO ANEWSTRA                09890077
083300                 MOVE DP015-RED        TO ANEWSTRC                09900077
083400                 MOVE DP015-REVERSE    TO ANEWSTRH                09910077
083500                 MOVE -1               TO ANEWSTRL                09920077
083600                 SET DP030-SET-CURSOR-APPL-1                      09930077
083700                                       TO TRUE                    09940077
083800             END-IF                                               09950077
               END-IF                                                   09960077
083900     END-IF.                                                      09970077
084000                                                                  09980077
084100     IF  ASC-OTB-PER-NBR-END > SPACES                             09990077
084300         IF  ASC-OTB-PER-NBR-END(5:2) < '01'                      10000077
084500         OR  ASC-OTB-PER-NBR-END(5:2) > '12'                      10010077
084600             SET PS-ERROR                                         10020077
084700                 DP020-MSG-FATAL                                  10030077
084800                 DP030-SET-CURSOR-APPL-1 TO TRUE                  10040077
084900             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      10050077
085000             MOVE -1                     TO AOTBENDL              10060077
085100             MOVE DP015-UNP-ALP-BRT-MDT  TO AOTBENDA              10070077
085200             MOVE DP015-RED              TO AOTBENDC              10080077
085300             MOVE DP015-REVERSE          TO AOTBENDH              10090077
085400         END-IF                                                   10100077
085500     END-IF.                                                      10110077
085600                                                                  10120077
085700     IF  ASC-OTB-PER-NBR-BEG > SPACES                             10130077
085900         IF  ASC-OTB-PER-NBR-BEG(5:2) < '01'                      10140077
086100         OR  ASC-OTB-PER-NBR-BEG(5:2) > '12'                      10150077
086200             SET PS-ERROR                                         10160077
086300                 DP020-MSG-FATAL                                  10170077
086400                 DP030-SET-CURSOR-APPL-1 TO TRUE                  10180077
086500             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      10190077
086600             MOVE -1                     TO AOTBBEGL              10200077
086700             MOVE DP015-UNP-ALP-BRT-MDT  TO AOTBBEGA              10210077
086800             MOVE DP015-RED              TO AOTBBEGC              10220077
086900             MOVE DP015-REVERSE          TO AOTBBEGH              10230077
087000         END-IF                                                   10240077
087100     END-IF.                                                      10250077
087200                                                                  10260077
087300     IF  ASC-OTB-PER-NBR-BEG > SPACES                             10270077
087400     AND ASC-OTB-PER-NBR-END > SPACES                             10280077
087500         IF  ASC-OTB-PER-NBR-BEG-N > ASC-OTB-PER-NBR-END-N        10290077
087600             SET PS-ERROR                                         10300077
087700                 DP020-MSG-FATAL  TO TRUE                         10310077
087800             MOVE PC-TSYMSG-00143 TO DP020-MSG-NUMBER             10320077
087900             MOVE DP015-UNP-ALP-BRT-MDT                           10330077
088000                                  TO AOTBENDA                     10340077
088100             MOVE DP015-RED       TO AOTBENDC                     10350077
088200             MOVE DP015-REVERSE   TO AOTBENDH                     10360077
088300             MOVE -1              TO AOTBENDL                     10370077
088400             SET DP030-SET-CURSOR-APPL-1                          10380077
088500                                  TO TRUE                         10390077
088600         END-IF                                                   10400077
088700     END-IF.                                                      10410077
088800                                                                  10420077
088900     IF  ASC-PO-TYP-CDE > SPACES                                  10430077
089000*        PERFORM 3010-VALIDATE-PO-TYPE-CODE                       10440077
089100         IF  SQLCODE = +100                                       10450077
089200             SET PS-ERROR          TO TRUE                        10460077
089300             SET DP020-MSG-FATAL   TO TRUE                        10470077
089400             MOVE PC-TSYMSG-00587  TO DP020-MSG-NUMBER            10480077
089500             MOVE DP015-UNP-ALP-BRT-OFF                           10490077
089600                                   TO APOTYPEA                    10500077
089700             MOVE DP015-RED        TO APOTYPEC                    10510077
089800             MOVE DP015-REVERSE    TO APOTYPEH                    10520077
089900             MOVE -1               TO APOTYPEL                    10530077
090000             SET DP030-SET-CURSOR-APPL-1                          10540077
090100                                   TO TRUE                        10550077
090200         END-IF                                                   10560077
090300     END-IF.                                                      10570077
090400                                                                  10580077
090500     IF ASC-AD-EVNT-DTE > SPACES                                  10590077
090600        INITIALIZE DPG51                                          10600077
090700        SET DPG51-ACTUAL-CALENDAR-ONLY                            10610077
090800                                 TO TRUE                          10620077
090900        SET DPG51-DO-NOT-INCR-DECR-DATE                           10630077
091000                                 TO TRUE                          10640077
091100        MOVE ZERO                TO TALLY                         10650077
091200        INSPECT ASC-AD-EVNT-DTE                                   10660077
091300                TALLYING TALLY FOR ALL '/'                        10670077
091400        IF TALLY > 1                                              10680077
091500*               'MM/DD/YY'                                        10690077
091600           SET DPG52-LK-DTE-GREG-CC-FMT                           10700077
091700                                  TO TRUE                         10710077
091800           IF ASC-AD-EVNT-DTE(7:2) > 80                           10720077
091900              MOVE '19' TO PV-AD-DATE(7:2)                        10730077
092000           ELSE                                                   10740077
092100              MOVE '20' TO PV-AD-DATE(7:2)                        10750077
092200           END-IF                                                 10760077
092300           MOVE ASC-AD-EVNT-DTE(1:6) TO PV-AD-DATE(1:6)           10770077
092400           MOVE ASC-AD-EVNT-DTE(7:2) TO PV-AD-DATE(9:2)           10780077
092500        ELSE                                                      10790077
092600*               'MMDDYY  '                                        10800077
092700           SET DPG52-LK-DTE-GREG-CC TO TRUE                       10810077
092800           IF ASC-AD-EVNT-DTE(5:2) > 80                           10820077
092900              MOVE '19' TO PV-AD-DATE(5:2)                        10830077
093000           ELSE                                                   10840077
093100              MOVE '20' TO PV-AD-DATE(5:2)                        10850077
093200           END-IF                                                 10860077
093300           MOVE ASC-AD-EVNT-DTE(1:2) TO PV-AD-DATE(1:2)           10870077
093400           MOVE ASC-AD-EVNT-DTE(3:2) TO PV-AD-DATE(3:2)           10880077
093500           MOVE ASC-AD-EVNT-DTE(5:2) TO PV-AD-DATE(7:2)           10890077
093600           MOVE SPACES               TO PV-AD-DATE(9:2)           10900077
093700        END-IF                                                    10910077
093900        MOVE PV-AD-DATE           TO DPG52-LK-DATE-INPUT          10920077
094100        CALL DP500-KOHLS-CALENDAR-ROUTINE USING                   10930077
094200                   DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            10940077
094300        IF (DPG54-DATE-INVALID                                    10950077
094400        OR  DPG54-SEVERE-ERROR)                                   10960077
094500            SET PS-ERROR                                          10970077
094600                DP020-MSG-FATAL   TO TRUE                         10980077
094700*        ---- INVALID DATE ----                                   10990077
094800            MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER             11000077
094900            MOVE DP015-UNP-ALP-BRT-MDT                            11010077
095000                                  TO ADDATEA                      11020077
095100            MOVE DP015-RED        TO ADDATEC                      11030077
095200            MOVE DP015-REVERSE    TO ADDATEH                      11040077
095300            MOVE -1               TO ADDATEL                      11050077
095400            SET DP030-SET-CURSOR-APPL-1                           11060077
095500                                  TO TRUE                         11070077
095600        ELSE                                                      11080077
095700            MOVE DPG55-GREG-DATE-FMT                              11090077
095800                                  TO ASC-AD-EVNT-DTE              11100077
095900            MOVE DPG55-DB2-ISO-DATE-FMT                           11110077
096000                                  TO ASC-AD-EVNT-DTE-ISO          11120077
096100        END-IF                                                    11130077
096200     END-IF.                                                      11140077
096300                                                                  11150077
096400     IF  ASC-STR-NBR > SPACES                                     11160077
               IF ASC-GROUP-CODE = SPACES                               11170077
                  CONTINUE                                              11180077
               ELSE                                                     11190077
                  SET PS-ERROR           TO TRUE                        11200077
                  SET DP020-MSG-FATAL    TO TRUE                        11210077
                  MOVE PC-TSYMSG-02182   TO DP020-MSG-NUMBER            11220077
      *           MOVE 'GROUP CODE CANNOT BE ENTERED WITH STORE NBR IND'11230077
      *                                  TO DP020-MSG-TEXT              11240077
                  MOVE DP015-UNP-ALP-BRT-OFF                            11250077
                                         TO AGRPCDA                     11260077
                  MOVE DP015-RED         TO AGRPCDC                     11270077
                  MOVE DP015-REVERSE     TO AGRPCDH                     11280077
                  MOVE -1                TO AGRPCDL                     11290077
                  SET DP030-SET-CURSOR-APPL-1                           11300077
                                         TO TRUE                        11310077
               END-IF                                                   11320077
                                                                        11330077
               IF  ASC-STR-NBR > SPACES                                 11340077
096500             MOVE ASC-STR-NBR          TO DP010I-UNEDITED-FIELD   11350077
096600             MOVE LENGTH OF ASC-STR-NBR                           11360077
096700                                       TO DP010I-MAXIMUM-DIGITS   11370077
096800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 11380077
096900             SET DP010I-NEGATIVE-NOT-ALLOWED                      11390077
097000                                       TO TRUE                    11400077
263126             CALL DP010I-NUMERIC-EDIT-ROUTINE                     11410077
263126                  USING DP010I-NUMERIC-EDIT-AREA                  11420077
097200             IF  DP010I-ERROR-DETECTED                            11430077
097300                 SET PS-ERROR                                     11440077
097400                     DP020-MSG-FATAL   TO TRUE                    11450077
097500                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        11460077
097600                 MOVE DP015-UNP-ALP-BRT-OFF                       11470077
097700                                       TO ASTOREA                 11480077
097800                 MOVE DP015-RED        TO ASTOREC                 11490077
097900                 MOVE DP015-REVERSE    TO ASTOREH                 11500077
098000                 MOVE -1               TO ASTOREL                 11510077
098100                 SET DP030-SET-CURSOR-APPL-1                      11520077
098200                                       TO TRUE                    11530077
098300             ELSE                                                 11540077
098400                 MOVE DP010I-NUMERIC-FIELD                        11550077
098500                                       TO ASC-STR-NBR-N           11560077
098600             END-IF                                               11570077
               END-IF                                                   11580077
098700     END-IF.                                                      11590077
098800                                                                  11600077
098900     IF  ASC-STATUS-GRP > SPACES                                  11610077
099000         IF ASC-STATUS-GRP = 'WKS' OR 'ACT' OR 'CMP' OR 'BTH'     11620077
099100             CONTINUE                                             11630077
099200         ELSE                                                     11640077
099300             SET PS-ERROR          TO TRUE                        11650077
099400             SET DP020-MSG-FATAL   TO TRUE                        11660077
099500             MOVE PC-TSYMSG-00639  TO DP020-MSG-NUMBER            11670077
099600             MOVE DP015-UNP-ALP-BRT-OFF                           11680077
099700                                   TO ASTGRPA                     11690077
099800             MOVE DP015-RED        TO ASTGRPC                     11700077
099900             MOVE DP015-REVERSE    TO ASTGRPH                     11710077
100000             MOVE -1               TO ASTGRPL                     11720077
100100             SET DP030-SET-CURSOR-APPL-1                          11730077
100200                                   TO TRUE                        11740077
100300         END-IF                                                   11750077
100400     END-IF.                                                      11760077
100500                                                                  11770077
100600     IF  ASC-STATUS-GRP > SPACES                                  11780077
100700         IF ASC-STATUS-CDE > SPACES                               11790077
100800             SET PS-ERROR          TO TRUE                        11800077
100900             SET DP020-MSG-FATAL   TO TRUE                        11810077
101000             MOVE PC-TSYMSG-00640  TO DP020-MSG-NUMBER            11820077
101100             MOVE DP015-UNP-ALP-BRT-OFF                           11830077
101200                                   TO ASC1A                       11840077
101300             MOVE DP015-RED        TO ASC1C                       11850077
101400             MOVE DP015-REVERSE    TO ASC1H                       11860077
101500             MOVE -1               TO ASC1L                       11870077
101600             SET DP030-SET-CURSOR-APPL-1                          11880077
101700                                   TO TRUE                        11890077
101800         END-IF                                                   11900077
101900     END-IF.                                                      11910077
102000                                                                  11920077
W24803     EVALUATE TRUE                                                11930077
W24803     WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)                  11940077
W24803         IF  ASC-SKU-NBR > SPACES                                 11950077
                   IF ASC-GROUP-CODE = SPACES                           11960077
                       CONTINUE                                         11970077
               ELSE                                                     11980077
100800             SET PS-ERROR          TO TRUE                        11990077
100900             SET DP020-MSG-FATAL   TO TRUE                        12000077
101000             MOVE PC-TSYMSG-02182  TO DP020-MSG-NUMBER            12010077
      *            MOVE 'GROUP CODE CANNOT BE ENTERED WITH SKU SEQ NBR' 12020077
      *                                  TO DP020-MSG-TEXT              12030077
101100             MOVE DP015-UNP-ALP-BRT-OFF                           12040077
101200                                   TO AGRPCDA                     12050077
101300             MOVE DP015-RED        TO AGRPCDC                     12060077
101400             MOVE DP015-REVERSE    TO AGRPCDH                     12070077
101500             MOVE -1               TO AGRPCDL                     12080077
101600             SET DP030-SET-CURSOR-APPL-1                          12090077
101700                                   TO TRUE                        12100077
W24803           END-IF                                                 12110077
101800         END-IF                                                   12120077
W24803     END-EVALUATE.                                                12130077
W24803*                                                                 12140077
W24803     IF  ASC-SKU-NBR > SPACES                                     12150077
W24803        MOVE ASC-SKU-NBR          TO DP010I-UNEDITED-FIELD        12160077
W24803        MOVE LENGTH OF ASC-SKU-NBR                                12170077
W24803                                  TO DP010I-MAXIMUM-DIGITS        12180077
102500        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      12190077
102600        SET DP010I-NEGATIVE-NOT-ALLOWED                           12200077
102700                                  TO TRUE                         12210077
263126        CALL DP010I-NUMERIC-EDIT-ROUTINE                          12220077
263126             USING DP010I-NUMERIC-EDIT-AREA                       12230077
102900        IF  DP010I-ERROR-DETECTED                                 12240077
103000          SET PS-ERROR                                            12250077
103100              DP020-MSG-FATAL   TO TRUE                           12260077
103200          MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER               12270077
103300          MOVE DP015-UNP-ALP-BRT-OFF                              12280077
103400                                TO ASKUA                          12290077
103500          MOVE DP015-RED        TO ASKUC                          12300077
103600          MOVE DP015-REVERSE    TO ASKUH                          12310077
103700          MOVE -1               TO ASKUL                          12320077
103800          SET DP030-SET-CURSOR-APPL-1                             12330077
103900                                TO TRUE                           12340077
104000        ELSE                                                      12350077
104100          MOVE DP010I-NUMERIC-FIELD                               12360077
W24803                                TO ASC-SKU-NBR-N                  12370077
104300        END-IF                                                    12380077
W24803     END-IF.                                                      12390077
W24803*                                                                 12400077
W24803     IF  ASC-SKU-NBR > SPACES                                     12410077
W24803       IF  ASC-SKU-NBR (6:3) = '000'                              12420077
W24803         OR ASC-SKU-NBR (6:3) = '999'                             12430077
W24803         SET PS-ERROR                                             12440077
W24803             DP020-MSG-FATAL        TO TRUE                       12450077
W24803         MOVE PC-TSYMSG-03081       TO DP020-MSG-NUMBER           12460077
W24803         MOVE DP015-UNP-ALP-BRT-OFF TO ASKUA                      12470077
W24803         MOVE DP015-RED             TO ASKUC                      12480077
W24803         MOVE DP015-REVERSE         TO ASKUH                      12490077
W24803         MOVE -1                    TO ASKUL                      12500077
W24803         SET DP030-SET-CURSOR-APPL-1                              12510077
W24803                                    TO TRUE                       12520077
W24803       ELSE                                                       12530077
W24803         PERFORM 3020-VALIDATE-SKU                                12540077
W24803         IF PV-DB2-COUNT = +0                                     12550077
W24803           SET PS-ERROR                                           12560077
W24803               DP020-MSG-FATAL        TO TRUE                     12570077
W24803           MOVE PC-TSYMSG-01922       TO DP020-MSG-NUMBER         12580077
W24803           MOVE DP015-UNP-ALP-BRT-OFF TO ASKUA                    12590077
W24803           MOVE DP015-RED             TO ASKUC                    12600077
W24803           MOVE DP015-REVERSE         TO ASKUH                    12610077
W24803           MOVE -1                    TO ASKUL                    12620077
W24803           SET DP030-SET-CURSOR-APPL-1                            12630077
W24803                                      TO TRUE                     12640077
W24803         END-IF                                                   12650077
W24803       END-IF                                                     12660077
W24803     END-IF                                                       12670077
104500                                                                  12680077
104600     IF  ASC-CL-NBR1 > SPACES                                     12690077
104700         MOVE ASC-CL-NBR1           TO DP010I-UNEDITED-FIELD      12700077
104800         MOVE LENGTH OF ASC-CL-NBR1 TO DP010I-MAXIMUM-DIGITS      12710077
104900         MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS    12720077
105000         SET DP010I-NEGATIVE-NOT-ALLOWED                          12730077
105100                                    TO TRUE                       12740077
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12750077
263126              USING DP010I-NUMERIC-EDIT-AREA                      12760077
105300         IF  DP010I-ERROR-DETECTED                                12770077
105400             SET PS-ERROR                                         12780077
105500                 DP020-MSG-FATAL    TO TRUE                       12790077
105600             MOVE PC-TSYMSG-00008   TO DP020-MSG-NUMBER           12800077
105700             MOVE DP015-UNP-ALP-BRT-OFF                           12810077
105800                                    TO ACLASSA                    12820077
105900             MOVE DP015-RED         TO ACLASSC                    12830077
106000             MOVE DP015-REVERSE     TO ACLASSH                    12840077
106100             MOVE -1                TO ACLASSL                    12850077
106200             SET DP030-SET-CURSOR-APPL-1                          12860077
106300                                    TO TRUE                       12870077
106400         END-IF                                                   12880077
106500     END-IF.                                                      12890077
106600                                                                  12900077
104600     IF  ASC-CL-NBR2 > SPACES                                     12910077
104700         MOVE ASC-CL-NBR2           TO DP010I-UNEDITED-FIELD      12920077
104800         MOVE LENGTH OF ASC-CL-NBR2 TO DP010I-MAXIMUM-DIGITS      12930077
104900         MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS    12940077
105000         SET DP010I-NEGATIVE-NOT-ALLOWED                          12950077
105100                                    TO TRUE                       12960077
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12970077
263126              USING DP010I-NUMERIC-EDIT-AREA                      12980077
105300         IF  DP010I-ERROR-DETECTED                                12990077
105400             SET PS-ERROR                                         13000077
105500                 DP020-MSG-FATAL    TO TRUE                       13010077
105600             MOVE PC-TSYMSG-00008   TO DP020-MSG-NUMBER           13020077
105700             MOVE DP015-UNP-ALP-BRT-OFF                           13030077
105800                                    TO ACLASSA                    13040077
105900             MOVE DP015-RED         TO ACLASSC                    13050077
106000             MOVE DP015-REVERSE     TO ACLASSH                    13060077
106100             MOVE -1                TO ACLASSL                    13070077
106200             SET DP030-SET-CURSOR-APPL-1                          13080077
106300                                    TO TRUE                       13090077
106400         END-IF                                                   13100077
106500     END-IF.                                                      13110077
                                                                        13120077
W24803     IF  ASC-MAJ-CL-NBR > SPACES                                  13130077
W24803         MOVE ASC-MAJ-CL-NBR       TO DP010I-UNEDITED-FIELD       13140077
W24803         MOVE LENGTH OF ASC-MAJ-CL-NBR                            13150077
W24803                                    TO DP010I-MAXIMUM-DIGITS      13160077
W24803         MOVE ZERO                  TO DP010I-MAXIMUM-DECIMALS    13170077
W24803         SET DP010I-NEGATIVE-NOT-ALLOWED                          13180077
W24803                                    TO TRUE                       13190077
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13200077
263126              USING DP010I-NUMERIC-EDIT-AREA                      13210077
W24803         IF  DP010I-ERROR-DETECTED                                13220077
W24803             SET PS-ERROR                                         13230077
W24803                 DP020-MSG-FATAL    TO TRUE                       13240077
W24803             MOVE PC-TSYMSG-00008   TO DP020-MSG-NUMBER           13250077
W24803             MOVE DP015-UNP-ALP-BRT-OFF                           13260077
W24803                                    TO AMCLA                      13270077
W24803             MOVE DP015-RED         TO AMCLC                      13280077
W24803             MOVE DP015-REVERSE     TO AMCLH                      13290077
W24803             MOVE -1                TO AMCLL                      13300077
W24803             SET DP030-SET-CURSOR-APPL-1                          13310077
W24803                                    TO TRUE                       13320077
W24803         END-IF                                                   13330077
W24803     END-IF.                                                      13340077
W24803                                                                  13350077
106700     IF  ASC-DEPT-NBR > SPACES                                    13360077
106800         MOVE ASC-DEPT-NBR         TO DP010I-UNEDITED-FIELD       13370077
106900         MOVE LENGTH OF ASC-DEPT-NBR                              13380077
107000                                   TO DP010I-MAXIMUM-DIGITS       13390077
107100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     13400077
107200         SET DP010I-NEGATIVE-NOT-ALLOWED                          13410077
107300                                   TO TRUE                        13420077
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13430077
263126              USING DP010I-NUMERIC-EDIT-AREA                      13440077
107500         IF  DP010I-ERROR-DETECTED                                13450077
107600             SET PS-ERROR                                         13460077
107700                 DP020-MSG-FATAL   TO TRUE                        13470077
107800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13480077
107900             MOVE DP015-UNP-ALP-BRT-OFF                           13490077
108000                                   TO ADEPTA                      13500077
108100             MOVE DP015-RED        TO ADEPTC                      13510077
108200             MOVE DP015-REVERSE    TO ADEPTH                      13520077
108300             MOVE -1               TO ADEPTL                      13530077
108400             SET DP030-SET-CURSOR-APPL-1                          13540077
108500                                   TO TRUE                        13550077
108600         ELSE                                                     13560077
108700             MOVE DP010I-NUMERIC-FIELD                            13570077
108800                                   TO ASC-DEPT-NBR-N              13580077
108900         END-IF                                                   13590077
109000     END-IF.                                                      13600077
109100                                                                  13610077
109200     IF  ASC-PO-NBR > SPACES                                      13620077
109300         MOVE ASC-PO-NBR           TO DP010I-UNEDITED-FIELD       13630077
109400         MOVE LENGTH OF ASC-PO-NBR TO DP010I-MAXIMUM-DIGITS       13640077
109500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     13650077
109600         SET DP010I-NEGATIVE-NOT-ALLOWED                          13660077
109700                                   TO TRUE                        13670077
263126         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13680077
263126              USING DP010I-NUMERIC-EDIT-AREA                      13690077
109900         IF  DP010I-ERROR-DETECTED                                13700077
110000             SET PS-ERROR                                         13710077
110100                 DP020-MSG-FATAL   TO TRUE                        13720077
110200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13730077
110300             MOVE DP015-UNP-ALP-BRT-OFF                           13740077
110400                                   TO APONUMA                     13750077
110500             MOVE DP015-RED        TO APONUMC                     13760077
110600             MOVE DP015-REVERSE    TO APONUMH                     13770077
110700             MOVE -1               TO APONUML                     13780077
110800             SET DP030-SET-CURSOR-APPL-1                          13790077
110900                                   TO TRUE                        13800077
111000         ELSE                                                     13810077
111100             MOVE DP010I-NUMERIC-FIELD                            13820077
111200                                   TO ASC-PO-NBR-N                13830077
111300         END-IF                                                   13840077
111400     END-IF.                                                      13850077
111500                                                                  13860077
111600     IF  PS-NO-ERROR                                              13870077
111700         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     13880077
111800         MOVE -1                 TO APONUML                       13890077
111900         SET DP030-SET-CURSOR-APPL-1                              13900077
112000                                 TO TRUE                          13910077
112100     END-IF.                                                      13920077
112200/                                                                 13930077
112300*----------------------------------------------------------------*13940077
112400*    VALIDATE THE PURCHASE ORDER TYPE CODE                       *13950077
112500*----------------------------------------------------------------*13960077
112600 3010-VALIDATE-PO-TYPE-CODE.                                      13970077
112700                                                                  13980077
112800     PERFORM                                                      13990077
112900         WITH TEST AFTER                                          14000077
113000         VARYING PV-RETRY-COUNTER                                 14010077
113100         FROM 1 BY 1                                              14020077
113200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14030077
113300             OR (SQLCODE = +0)                                    14040077
113400             OR (SQLCODE = +100))                                 14050077
113500                                                                  14060077
113600         EXEC SQL                                                 14070077
113700              SELECT PO_TYP_DESC                                  14080077
113800                INTO :POTYCD-PO-TYP-DESC                          14090077
113900                FROM TPOTYCD                                      14100077
114000               WHERE PO_VARIETY_CDE = 'T'                         14110077
114100                 AND PO_TYP_CDE     = :ASC-PO-TYP-CDE             14120077
114200         END-EXEC                                                 14130077
114300                                                                  14140077
114400         EVALUATE TRUE                                            14150077
114500             WHEN SQLCODE = +0                                    14160077
114600                  MOVE POTYCD-PO-TYP-DESC                         14170077
114700                                  TO ASC-PO-TYP-DESC              14180077
114800*                                    ADESCO                       14190077
114900                                                                  14200077
115000             WHEN SQLCODE = +100                                  14210077
115100                  MOVE SPACES     TO ASC-PO-TYP-DESC              14220077
115200*                                    ADESCO                       14230077
115300                                                                  14240077
115400             WHEN SQLCODE = -904                                  14250077
115500             WHEN SQLCODE = -913                                  14260077
115600                  CONTINUE                                        14270077
115700                                                                  14280077
115800             WHEN SQLWARN0 NOT = SPACES                           14290077
115900             WHEN SQLCODE < +0                                    14300077
116000             WHEN SQLCODE > +0                                    14310077
116100                  MOVE '3010-VALIDATE-PO-TYPE-CODE'               14320077
116200                                  TO DP013-PARAGRAPH              14330077
116300                  MOVE 'UNSUCCESSFUL ON SELECT PO TYPE'           14340077
116400                                  TO DP013-MESSAGE-TEXT (1)       14350077
116500                  MOVE SQLCA      TO DP013-SQLCA                  14360077
116600                  MOVE 'TPOTYCD ' TO DP013-DB2-TABLE-NAME (1)     14370077
116700                  SET DP013-DB2-ABEND                             14380077
116800                      DP013-XCTL-DISPLAY-RESTART                  14390077
116900                                  TO TRUE                         14400077
117000                  PERFORM DP013-0000-PROCESS-ABEND                14410077
117100         END-EVALUATE                                             14420077
117200     END-PERFORM.                                                 14430077
117300                                                                  14440077
117400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14450077
117500         MOVE '3010-VALIDATE-PO-TYPE-CODE'                        14460077
117600                                  TO DP013-PARAGRAPH              14470077
117700         MOVE 'MAX RETRIES EXCEEDED ON SELECT PO TYPE'            14480077
117800                                  TO DP013-MESSAGE-TEXT (1)       14490077
117900         MOVE SQLCA               TO DP013-SQLCA                  14500077
118000         MOVE 'TPOTYCD '          TO DP013-DB2-TABLE-NAME (1)     14510077
118100         SET DP013-DB2-ABEND                                      14520077
118200             DP013-XCTL-DISPLAY-RESTART                           14530077
118300                                  TO TRUE                         14540077
118400         PERFORM DP013-0000-PROCESS-ABEND                         14550077
118500     END-IF.                                                      14560077
118600/                                                                 14570077
W24803*----------------------------------------------------------------*14580077
W24803*    VALIDATE THE SKU NUMBER                                     *14590077
W24803*----------------------------------------------------------------*14600077
W24803 3020-VALIDATE-SKU.                                               14610077
W24803*                                                                 14620077
W24803     MOVE +0            TO PV-DB2-COUNT                           14630077
W24803     MOVE ASC-SKU-NBR-N TO XLT00003-SKU-NBR                       14640077
W24803*                                                                 14650077
W24803     PERFORM                                                      14660077
W24803         WITH TEST AFTER                                          14670077
W24803         VARYING PV-RETRY-COUNTER                                 14680077
W24803         FROM 1 BY 1                                              14690077
W24803         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14700077
W24803             OR (SQLCODE = +0)                                    14710077
W24803             OR (SQLCODE = +100))                                 14720077
W24803                                                                  14730077
W24803         EXEC SQL                                                 14740077
W24803              SELECT COUNT (*)                                    14750077
W24803                INTO :PV-DB2-COUNT                                14760077
W24803                FROM XLT_SKU                                      14770077
W24803               WHERE SKU_NBR = :XLT00003-SKU-NBR                  14780077
W24803         END-EXEC                                                 14790077
W24803                                                                  14800077
W24803         EVALUATE TRUE                                            14810077
W24803             WHEN SQLCODE = +0                                    14820077
W24803                  CONTINUE                                        14830077
W24803             WHEN SQLCODE = +100                                  14840077
W24803                  CONTINUE                                        14850077
W24803             WHEN SQLCODE = -904                                  14860077
W24803             WHEN SQLCODE = -913                                  14870077
W24803                  CONTINUE                                        14880077
W24803             WHEN SQLWARN0 NOT = SPACES                           14890077
W24803             WHEN SQLCODE < +0                                    14900077
W24803             WHEN SQLCODE > +0                                    14910077
W24803                  MOVE '3020-VALIDATE-SKU'                        14920077
W24803                                  TO DP013-PARAGRAPH              14930077
W24803                  MOVE 'UNSUCCESSFUL COUNT ON SKU'                14940077
W24803                                  TO DP013-MESSAGE-TEXT (1)       14950077
W24803                  MOVE SQLCA      TO DP013-SQLCA                  14960077
W24803                  MOVE 'XLT_SKU ' TO DP013-DB2-TABLE-NAME (1)     14970077
W24803                  SET DP013-DB2-ABEND                             14980077
W24803                      DP013-XCTL-DISPLAY-RESTART                  14990077
W24803                                  TO TRUE                         15000077
W24803                  PERFORM DP013-0000-PROCESS-ABEND                15010077
W24803         END-EVALUATE                                             15020077
W24803     END-PERFORM.                                                 15030077
W24803                                                                  15040077
W24803     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15050077
W24803         MOVE '3020-VALIDATE-SKU'                                 15060077
W24803                                  TO DP013-PARAGRAPH              15070077
W24803         MOVE 'MAX RETRIES EXCEEDED ON COUNT ON SKU'              15080077
W24803                                  TO DP013-MESSAGE-TEXT (1)       15090077
W24803         MOVE SQLCA               TO DP013-SQLCA                  15100077
W24803         MOVE 'XLT_SKU '          TO DP013-DB2-TABLE-NAME (1)     15110077
W24803         SET DP013-DB2-ABEND                                      15120077
W24803             DP013-XCTL-DISPLAY-RESTART                           15130077
W24803                                  TO TRUE                         15140077
W24803         PERFORM DP013-0000-PROCESS-ABEND                         15150077
W24803     END-IF.                                                      15160077
W24803/                                                                 15170077
118700*----------------------------------------------------------------*15180077
118800*  MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE  *15190077
118900*  MAP.                                                          *15200077
119000*----------------------------------------------------------------*15210077
119100                                                                  15220077
119200 3100-RESET-ATTRIBUTES.                                           15230077
119300                                                                  15240077
119400     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTGRPA                     15250077
119500                                      ASC1A                       15260077
119600                                      APOTYPEA                    15270077
119700                                      ASKUA                       15280077
119800                                      ASTOREA                     15290077
119900                                      AVENDNMA                    15300077
120000                                      ASTYLEA                     15310077
120100                                      ADDATEA                     15320077
120200                                      AEDIA                       15330077
120300                                      APCKSTA                     15340077
120400                                      ASHPBEGA                    15350077
120500                                      ASHPENDA                    15360077
120600                                      APRETICA                    15370077
120700                                      APONUMA                     15380077
120800                                      AIPONUMA                    15390077
120900                                      ADEPTA                      15400077
121000                                      ACLASSA                     15410077
W24803                                      AMCLA                       15420077
121100                                      AOTBBEGA                    15430077
121200                                      AOTBENDA                    15440077
121300                                      ANEWSTRA                    15450077
121400                                      APICADA                     15460077
121500                                      ADIRSTRA                    15470077
                                            AGRPCDA.                    15480077
121600                                                                  15490077
121700     MOVE DP015-GREEN              TO APONUMC                     15500077
121800                                      AIPONUMC                    15510077
121900                                      ADEPTC                      15520077
122000                                      ASTGRPC                     15530077
122100                                      ASC1C                       15540077
122200                                      ACLASSC                     15550077
W24803                                      AMCLC                       15560077
122300                                      APOTYPEC                    15570077
122400                                      ASKUC                       15580077
122500                                      ASTOREC                     15590077
122600                                      AVENDNMC                    15600077
122700                                      ASTYLEC                     15610077
122800                                      ADDATEC                     15620077
122900                                      AEDIC                       15630077
123000                                      AOTBBEGC                    15640077
123100                                      AOTBENDC                    15650077
123200                                      APCKSTC                     15660077
123300                                      ASHPBEGC                    15670077
123400                                      ASHPENDC                    15680077
123500                                      APRETICC                    15690077
123600                                      ANEWSTRC                    15700077
123700                                      APICADC                     15710077
123800                                      ADIRSTRC                    15720077
                                            AGRPCDC.                    15730077
123900                                                                  15740077
124000     MOVE DP015-UNDERLINE          TO APONUMH                     15750077
124100                                      AIPONUMH                    15760077
124200                                      ADEPTH                      15770077
124300                                      ASTGRPH                     15780077
124400                                      ASC1H                       15790077
124500                                      ACLASSH                     15800077
W24803                                      AMCLH                       15810077
124600                                      APOTYPEH                    15820077
124700                                      ASKUH                       15830077
124800                                      ASTOREH                     15840077
124900                                      AVENDNMH                    15850077
125000                                      ASTYLEH                     15860077
125100                                      ADDATEH                     15870077
125200                                      AEDIH                       15880077
125300                                      AOTBBEGH                    15890077
125400                                      AOTBENDH                    15900077
125500                                      APCKSTH                     15910077
125600                                      ASHPBEGH                    15920077
125700                                      ASHPENDH                    15930077
125800                                      APRETICH                    15940077
125900                                      ANEWSTRH                    15950077
126000                                      APICADH                     15960077
126100                                      ADIRSTRH                    15970077
                                            AGRPCDH.                    15980077
126200/                                                                 15990077
126300*----------------------------------------------------------------*16000077
126400*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *16010077
126500*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *16020077
126600*  IT HERE.                                                      *16030077
126700*----------------------------------------------------------------*16040077
126800                                                                  16050077
126900 4000-BUILD-INITIAL-PANEL.                                        16060077
127000                                                                  16070077
127100     SET DP030-SET-CURSOR-APPL-1 TO TRUE                          16080077
127200     MOVE -1                     TO APONUML.                      16090077
127300     MOVE 'ACT'                  TO ASTGRPO                       16100077
127400                                    ASC-STATUS-GRP.               16110077
127500                                                                  16120077
127600/                                                                 16130077
127700*----------------------------------------------------------------*16140077
127800*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *16150077
127900*----------------------------------------------------------------*16160077
128000                                                                  16170077
128100 4400-MOVE-COMMAREA-TO-SCREEN.                                    16180077
128200                                                                  16190077
128300     MOVE ASC-PO-NBR             TO APONUMO.                      16200077
128400     MOVE ASC-IMPRT-AGNT-PO-NBR  TO AIPONUMO.                     16210077
128500     MOVE ASC-DEPT-NBR           TO ADEPTO.                       16220077
128600     MOVE ASC-STATUS-GRP         TO ASTGRPO.                      16230077
128700     MOVE ASC-STATUS-CDE         TO ASC1O.                        16240077
128800     MOVE ASC-CL-NBR             TO ACLASSO.                      16250077
W24803     MOVE ASC-MAJ-CL-NBR         TO AMCLO.                        16260077
128900     MOVE ASC-PO-TYP-CDE         TO APOTYPEO.                     16270077
129000*    MOVE ASC-PO-TYP-DESC        TO ADESCO.                       16280077
W24803     MOVE ASC-SKU-NBR            TO ASKUO.                        16290077
129200     MOVE ASC-STR-NBR            TO ASTOREO.                      16300077
129300     MOVE ASC-ENT-NAME-DESC      TO AVENDNMO.                     16310077
129400     MOVE ASC-VEND-STYL-NME      TO ASTYLEO.                      16320077
129500     MOVE ASC-AD-EVNT-DTE        TO ADDATEO.                      16330077
129600     MOVE ASC-EDI-IND            TO AEDIO.                        16340077
129800     STRING ASC-OTB-PER-NBR-BEG(5:2) DELIMITED BY SIZE            16350077
130000            ASC-OTB-PER-NBR-BEG(3:2) DELIMITED BY SIZE            16360077
130100                               INTO AOTBBEGO.                     16370077
130300     STRING ASC-OTB-PER-NBR-END(5:2) DELIMITED BY SIZE            16380077
130500            ASC-OTB-PER-NBR-END(3:2) DELIMITED BY SIZE            16390077
130600                               INTO AOTBENDO.                     16400077
130700     MOVE ASC-PACK-BY-STORE-IND  TO APCKSTO.                      16410077
130800     MOVE ASC-DONT-SHIP-BEF-DTE-B                                 16420077
130900                                 TO ASHPBEGO.                     16430077
131000     MOVE ASC-DONT-SHIP-BEF-DTE-E                                 16440077
131100                                 TO ASHPENDO.                     16450077
131200     MOVE ASC-PRE-TICKET-IND     TO APRETICO.                     16460077
131300                                                                  16470077
131400     MOVE ASC-NEW-STORE-IND      TO ANEWSTRO.                     16480077
131500                                                                  16490077
131600     MOVE ASC-PIC-AD-IND         TO APICADO.                      16500077
131700                                                                  16510077
131800     MOVE ASC-DIR-STORE-IND      TO ADIRSTRO.                     16520077
                                                                        16530077
           MOVE ASC-GROUP-CODE         TO AGRPCDO.                      16540077
131900/                                                                 16550077
132000*----------------------------------------------------------------*16560077
132100*    ABEND PROCESSOR MODULE                                      *16570077
132200*----------------------------------------------------------------*16580077
132300     COPY DPPD013.                                                16590077
