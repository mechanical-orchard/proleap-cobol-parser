000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             CNKRF230.                                00050000
000600 AUTHOR.                 LARRY SCHLEICHER.                        00060000
000700 INSTALLATION.           KOHLS.                                   00070000
000800 DATE-WRITTEN            MARCH, 2001.                             00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200* THIS PROGRAM DISPLAYS A SCREEN ON THE LRT (LASER RADIO TERMINAL)00120000
001300* WHICH IS USED TO ENTER THE DC NUMBER, MESSAGE SEQ NUMBER, CARTON00130000
001400* ID AND DIVERT NUMBER.  THIS DATA WILL BE FORMATTED AND PASSED   00140000
001500* TO THE SUKCS557 PROGRAM (S557 TRAN CODE).                       00150000
001600******************************************************************00160000
001700                                                                  00170000
001800******************************************************************00180000
001900* 7/16/2000 GB *CHANGE TO PROGRAM TO CORRECTLY POPULATE BRCDE AND 00190000
002000* SHIPT-ID ON TSUCDRV DEPENDING ON 18 OR 20 DIGIT CRTN ID ENTERED 00200000
002100* CHANGE TO 5600-POPULATE-FIELDS.                                 00210000
002200* ALSO CODE TO POPULATE NEW TABLE FIELD  SUCRDV-DEST-OPER-UNT-ID  00220000
002300******************************************************************00230000
263455* CHANGED 11/03/2021    BY JIM HUNTER      WR: CHG0263455         00231003
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00232003
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00233003
263455******************************************************************00234003
002400                                                                  00240000
002500******************************************************************00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700******************************************************************00270000
002800                                                                  00280000
002900******************************************************************00290000
003000 DATA DIVISION.                                                   00300000
003100******************************************************************00310000
003200                                                                  00320000
003300******************************************************************00330000
003400 WORKING-STORAGE SECTION.                                         00340000
003500******************************************************************00350000
003600 01  CA-COMMAREA.                                                 00360000
003700    05  CA-PROG-COMMAREA.                                         00370000
003800        10 CA-HOLD-SOCKET-ID             PIC 9(04) BINARY.        00380000
003900        10 CA-DC-NUMBER                  PIC 9(04).               00390000
004000        10 CA-MESSAGE-SEQ-NUMBER         PIC 9(08).               00400000
004100        10 CA-BAR-CODE                   PIC X(22).               00410000
004200        10 CA-DIVERT-NUMBER              PIC 9(09).               00420000
004300        10 CA-DOOR-NUMBER                PIC X(04).               00430000
004400        10 CA-RETURN-MSG                 PIC X(19).               00440000
004500        10 CA-DOOR-ID                    PIC X(04).               00450000
004600        10 CA-RETURN-ERROR-IND           PIC X(01) VALUE 'N'.     00460000
004700           88  CA-RETURN-ERROR                     VALUE 'Y'.     00470000
004800           88  CA-NO-RETURN-ERROR                  VALUE 'N'.     00480000
004900        10 CA-DOOR-ID-ENTERED-IND        PIC X(01) VALUE 'N'.     00490000
005000           88  CA-DOOR-ID-ENTERED                  VALUE 'Y'.     00500000
005100           88  CA-NO-DOOR-ID-ENTERED               VALUE 'N'.     00510000
005200                                                                  00520000
005300 01  DK-DB2-KEYS.                                                 00530000
005400     05  DK-SHIPT-UNT-ID                 PIC S9(18)V COMP-3       00540000
005500                                                    VALUE ZERO.   00550000
005600     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00560000
005700     05  DK-AUDIT-CNTL-NBR               PIC S9(09) COMP.         00570000
005800     05  DK-SHIP-UNIT-NBR                PIC S9(18) COMP-3.       00580000
005900     05  DK-GROUP-CODE                   PIC  X(03).              00590000
006000     05  DK-GROUP-SEQ-NBR                PIC S9(04) COMP.         00600000
006100     05  DK-STR-NBR                      PIC S9(04) COMP.         00610000
006200     05  DK-SKU-DEPT                     PIC  X(03).              00620000
006300     05  DK-SKU-CLASS                    PIC  X(02).              00630000
006400     05  DK-SKU-SEQ                      PIC  X(03).              00640000
006500     05  DK-DOOR-NUMBER                  PIC X(04).               00650000
006600*                                                                 00660000
006700 01  PC-PROGRAM-CONSTANTS.                                        00670000
006800     05  PC-TIMER-ACCUM                  PIC  9(3)   VALUE 0.     00680000
006900     05  PC-0                            PIC  X(01)  VALUE '0'.   00690000
007000     05  PC-4                            PIC  X(01)  VALUE '4'.   00700000
007100     05  PC-18                           PIC S9(04)  VALUE 18     00710000
007200                                                     COMP SYNC.   00720000
007300     05  PC-20                           PIC S9(04)  VALUE 20     00730000
007400                                                     COMP SYNC.   00740000
007500     05  PC-BUFFER-LENGTH                PIC 9(03)   VALUE 57.    00750000
007600     05  PC-TRAN-ID-LENGTH               PIC 9(03)   VALUE 50.    00760000
007700     05  PC-SHUTDOWN-HOW                 PIC 9(8)  VALUE 2 BINARY.00770000
007800     05  PC-FCNTL-CMD                    PIC 9(8)  VALUE 4 BINARY.00780000
007900     05  PC-FCNTL-REQARG                 PIC 9(8)  VALUE 0 BINARY.00790000
008000     05  PC-RETURN-PGM                   PIC  X(08)  VALUE        00800000
008100         'RCKCS270'.                                              00810000
008200     05  PC-DIVERT-PGM                   PIC  X(08)  VALUE        00820000
008300         'SUKCS557'.                                              00830000
008400     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00840000
008500         'CNKRF230'.                                              00850000
008600     05  PC-CURRENT-TRANID               PIC  X(04)  VALUE 'Y230'.00860000
008700     05  PC-S557-TRAN-ID                 PIC  X(50)  VALUE 'S557'.00870000
008800     05  PC-CONFIRMATION-MSG             PIC X(40)                00880000
008900      VALUE IS 'CONFIRMS S557 CICS TCPIP INTERFACE START'.        00890000
009000     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        00900000
009100         'TRANS NOT AVAILABLE'.                                   00910000
009200     05  PC-DC-NOT-NUMERIC               PIC  X(19)  VALUE        00920000
009300         'DC IS NOT NUMERIC  '.                                   00930000
009400     05  PC-NOT-VALID-DC                 PIC  X(19)  VALUE        00940000
009500         'NOT A VALID DC     '.                                   00950000
009600     05  PC-SEQ-NBR-NOT-NUMERIC          PIC  X(19)  VALUE        00960000
009700         'SEQ NBR NOT NUMERIC'.                                   00970000
009800     05  PC-CARTON-NOT-NUMERIC           PIC  X(19)  VALUE        00980000
009900         'CARTON NOT NUMERIC '.                                   00990000
010000     05  PC-CARTON-NBR-REQD              PIC  X(19)  VALUE        01000000
010100         'CARTON NBR REQUIRED'.                                   01010000
010200     05  PC-FIRST-1-NOT-0-MSG            PIC  X(19)  VALUE        01020000
010300         'FIRST DIGIT NOT 0  '.                                   01030000
010400     05  PC-MORE-DIGITS-REQD             PIC  X(19)  VALUE        01040000
010500         'MORE DIGITS REQUIRD'.                                   01050000
010600     05  PC-MUST-BE-GT-0-MSG             PIC  X(19)  VALUE        01060000
010700         'MUST BE > ZERO     '.                                   01070000
010800     05  PC-DIVERT-NOT-NUMERIC           PIC  X(19)  VALUE        01080000
010900         'DIVERT NOT NUMERIC '.                                   01090000
011000     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        01100000
011100         'UNRECOGNIZED PF KEY'.                                   01110000
011200     05  PC-BAD-RESPONSE-ON-RECEIVE      PIC  X(19)  VALUE        01120000
011300         'BAD RESP ON RECEIVE'.                                   01130000
011400     05  PC-BAD-RESPONSE-ON-SEND         PIC  X(19)  VALUE        01140000
011500         'BAD RESPONS ON SEND'.                                   01150000
011600     05  PC-BAD-RESPONSE-ON-CONNECT      PIC  X(19)  VALUE        01160000
011700         'BAD RESP ON CONNECT'.                                   01170000
011800     05  PC-ENTER-PF-3                   PIC  X(19)  VALUE        01180000
011900         'ENTER    F3-END    '.                                   01190000
012000     05  PC-SEQ-NBR-EQUAL-ZERO           PIC  X(19)  VALUE        01200000
012100         'SEQ NBR MUST BE > 0'.                                   01210000
012200     05  PC-DIVERT-EQUAL-ZERO            PIC  X(19)  VALUE        01220000
012300         'DIVERT MUST BE > 0 '.                                   01230000
012400     05  PC-NO-DOOR-FOR-STR              PIC  X(19)  VALUE        01240000
012500         'NO DOOR FOR STORE  '.                                   01250000
012600     05  PC-INVALID-CARTON-ID            PIC  X(19)  VALUE        01260000
012700         'INVALID CARTON ID  '.                                   01270000
012800     05  PC-INVALID-DOOR-TYPE            PIC  X(19)  VALUE        01280000
012900         'INVALID DOOR TYPE  '.                                   01290000
013000     05  PC-CARTON-ADDED                 PIC  X(19)  VALUE        01300000
013100         'CARTON ADDED       '.                                   01310000
013200                                                                  01320000
013300 01  PC-ADDRESSES.                                                01330000
013400     05  PC-IP-ADDRESS            PIC X(15)   VALUE               01340000
013500                            '128.009.111.249'.                    01350000
013600     05  PC-PORT-NBR-DEC          PIC X(4)    VALUE '1993'.       01360000
013700     05  PC-PORT-NBR-HEX          PIC X(2)    VALUE X'07C9'.      01370000
013800     05  PC-PORT-NBR REDEFINES PC-PORT-NBR-HEX                    01380000
013900                                  PIC 9(4) COMP.                  01390000
014000                                                                  01400000
014100 01  PS-PROGRAM-SWITCHES.                                         01410000
014200     05  PS-SHPUNT-FOUND-SW              PIC X(01)   VALUE 'N'.   01420000
014300         88  PS-SHPUNT-FOUND-YES                     VALUE 'Y'.   01430000
014400         88  PS-SHPUNT-FOUND-NO                      VALUE 'N'.   01440000
014500     05  PS-CHILD-SW                     PIC X(01)   VALUE 'N'.   01450000
014600         88  PS-ALL-CHILD                            VALUE 'N'.   01460000
014700         88  PS-END-OF-CHILD                         VALUE 'Y'.   01470000
014800     05  PS-DC-FOUND-SW                  PIC  X(01)  VALUE 'N'.   01480000
014900         88  PS-DC-NOT-FOUND                         VALUE 'N'.   01490000
015000         88  PS-DC-FOUND                             VALUE 'Y'.   01500000
015100     05  PS-DOOR-FOUND-SW                PIC  X(01)  VALUE 'N'.   01510000
015200         88  PS-DOOR-NOT-FOUND                       VALUE 'N'.   01520000
015300         88  PS-DOOR-FOUND                           VALUE 'Y'.   01530000
015400     05  PS-SOCKET-ERROR-SW              PIC  X(01)  VALUE 'N'.   01540000
015500         88  PS-SOCKET-ERROR                         VALUE 'Y'.   01550000
015600         88  PS-NO-SOCKET-ERROR                      VALUE 'N'.   01560000
015700     05  PS-NO-STOR-SHUTTLE-DOOR-SW      PIC  X(01)  VALUE 'N'.   01570000
015800         88  PS-NO-STOR-SHUTTLE-DOOR-FOUND           VALUE 'N'.   01580000
015900         88  PS-STOR-SHUTTLE-DOOR-FOUND              VALUE 'Y'.   01590000
016000                                                                  01600000
016100 01  PV-PROGRAM-VARIABLES.                                        01610000
016200     05  PV-ACTV-IND                     PIC  X(01).              01620000
016300     05  PV-SUT00024-SHIPT-UNT-ID        PIC S9(18)V COMP-3       01630000
016400                                                    VALUE ZERO.   01640000
016500     05  PV-NEXT-SHIPT-UNT-ID            PIC S9(18)V COMP-3       01650000
016600                                                    VALUE ZERO.   01660000
016700     05  PV-DISP-SHIPT-UNT-ID            PIC S9(18).              01670000
016800     05  PV-DISPLAY-SQLCODE              PIC S9(09).              01680000
016900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE ZERO   01690000
017000                                                     COMP SYNC.   01700000
017100     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  01710000
017200                                                     COMP SYNC.   01720000
017300     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 01730000
017400     05  PV-CHAR-COUNT                   PIC S9(04)  VALUE ZEROS  01740000
017500                                                     COMP SYNC.   01750000
017600     05  PV-DC-X                         PIC  X(04)  VALUE SPACE. 01760000
017700     05  PV-DC-NUMERIC                   PIC  9(04).              01770000
017800     05  PV-DC-ALPHA REDEFINES PV-DC-NUMERIC                      01780000
017900                                         PIC  X(04).              01790000
018000     05  PV-SEQ-NUMERIC                  PIC  9(08).              01800000
018100     05  PV-SEQ-ALPHA REDEFINES PV-SEQ-NUMERIC                    01810000
018200                                         PIC  X(08).              01820000
018300     05  PV-DIVERT-NUMERIC               PIC  9(04).              01830000
018400     05  PV-DIVERT-ALPHA REDEFINES PV-DIVERT-NUMERIC              01840000
018500                                         PIC  X(04).              01850000
018600     05  PV-SEQ-X                        PIC  X(08)  VALUE SPACE. 01860000
018700     05  PV-CTN-X.                                                01870000
018800         10  PV-CTN-FIRST-DIGIT          PIC  X(01).              01880000
018900         10  PV-CTN-LAST-17              PIC  X(17).              01890000
019000         10  PV-CTN-FILLER               PIC  X(02).              01900000
019100     05  FILLER REDEFINES PV-CTN-X.                               01910000
019200         10  PV-CTN-SCAN-00              PIC X(02).               01920000
019300         10  PV-CTN-SCAN-THIRD-DGT       PIC X(01).               01930000
019400         10  PV-CTN-SCAN-LAST-17         PIC X(17).               01940000
019500     05  FILLER REDEFINES PV-CTN-X.                               01950000
019600         10  PV-CTN-SCAN-00              PIC  X(02).              01960000
019700         10  PV-CTN-SCAN-LAST-18         PIC  X(18).              01970000
019800     05  FILLER REDEFINES PV-CTN-X.                               01980000
019900         10  PV-CTN-SCAN-FILLER-1        PIC  X(05).              01990000
020000         10  PV-CTN-SCAN-STORE           PIC  X(04).              02000000
020100         10  PV-CTN-SCAN-FILLER-1        PIC  X(11).              02010000
020200     05  FILLER REDEFINES PV-CTN-X.                               02020000
020300         10  PV-CTN-FILLER-1             PIC  X(03).              02030000
020400         10  PV-CTN-STORE                PIC  X(04).              02040000
020500         10  PV-CTN-FILLER-1             PIC  X(13).              02050000
020600     05  PV-CTN-N                        PIC  9(18).              02060000
020700     05  PV-DIV-X                        PIC  X(04)  VALUE SPACE. 02070000
020800     05  PV-DOOR-X                       PIC  X(04)  VALUE SPACE. 02080000
020900     05  PV-LOG-MSG-AREA                 PIC  X(80)  VALUE SPACES.02090000
021000     05  PV-IP-ADDRESS.                                           02100000
021100         10  PV-IP-ADDR-NUM1             PIC 9(03).               02110000
021200             88  PV-IP-ADDR-NUM1-VALID              VALUE 1 THRU  02120000
021300                                                          255.    02130000
021400         10  PV-IP-ADDR-DOT1             PIC X(01).               02140000
021500             88  PV-IP-ADDR-DOT1-VALID              VALUE '.'.    02150000
021600         10  PV-IP-ADDR-NUM2             PIC 9(03).               02160000
021700             88  PV-IP-ADDR-NUM2-VALID              VALUE 1 THRU  02170000
021800                                                          255.    02180000
021900         10  PV-IP-ADDR-DOT2             PIC X(01).               02190000
022000             88  PV-IP-ADDR-DOT2-VALID              VALUE '.'.    02200000
022100         10  PV-IP-ADDR-NUM3             PIC 9(03).               02210000
022200             88  PV-IP-ADDR-NUM3-VALID              VALUE 1 THRU  02220000
022300                                                          255.    02230000
022400         10  PV-IP-ADDR-DOT3             PIC X(01).               02240000
022500             88  PV-IP-ADDR-DOT3-VALID              VALUE '.'.    02250000
022600         10  PV-IP-ADDR-NUM4             PIC 9(03).               02260000
022700             88  PV-IP-ADDR-NUM4-VALID              VALUE 1 THRU  02270000
022800                                                          255.    02280000
022900     05  PV-DATE-TIME.                                            02290000
023000         10  PV-DATE                    PIC X(08).                02300000
023100         10  PV-TIME                    PIC X(06).                02310000
023200         10  PV-DATE-FILLER             PIC X(07).                02320000
023300                                                                  02330000
023400     05  PV-HEX-FIELD.                                            02340000
023500         10  PV-HEX-FIELD-1              PIC X(01).               02350000
023600         10  PV-HEX-FIELD-2              PIC X(01).               02360000
023700         10  PV-HEX-FIELD-3              PIC X(01).               02370000
023800         10  PV-HEX-FIELD-4              PIC X(01).               02380000
023900     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               02390000
024000                                         PIC 9(08)  COMP.         02400000
024100     05  PV-HEX-NUMERIC                  PIC 9(04) BINARY.        02410000
024200     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    02420000
024300         10  PV-HEX-CHAR-1               PIC X(01).               02430000
024400         10  PV-HEX-CHAR-2               PIC X(01).               02440000
024500     05  PV-CONTAINER-ID.                                         02450000
024600         10  PV-CONTAINER-00             PIC X(02).               02460000
024700         10  PV-SHIPT-UNT-ID             PIC 9(18).               02470000
024800         10  PV-CONTAINER-SPACES         PIC X(02).               02480000
024900     05  PV-CONTAINER-ID-18.                                      02490000
025000         10  PV-SHIPT-UNT-ID-18          PIC 9(18).               02500000
025100         10  FILLER                      PIC X(04).               02510000
025200     05  PV-BARCODE-20.                                           02520000
025300         10  FILLER                      PIC X(02) VALUE '00'.    02530000
025400         10  PV-BRCDE-NBR-18             PIC X(18) VALUE SPACE.   02540000
025500                                                                  02550000
025600 01  RECV-REQUEST-RECV                 PIC 9(8)  VALUE 0 BINARY.  02560000
025700 01  RECV-REQUEST-REMAINING            PIC 9(8)  VALUE 0 BINARY.  02570000
025800 01  RECV-BUFFER.                                                 02580000
025900     05  RECV-BUFFER-TOTAL             PIC X(40) VALUE SPACES.    02590000
026000     05  RECV-BUFFER-BYTE REDEFINES RECV-BUFFER-TOTAL             02600000
026100                                       PIC X OCCURS 40 TIMES.     02610000
026200 01  SEND-REQUEST-SENT                 PIC 9(8)  VALUE 0 BINARY.  02620000
026300 01  SEND-REQUEST-REMAINING            PIC 9(8)  VALUE 0 BINARY.  02630000
026400 01  SEND-BUFFER.                                                 02640000
026500     05  SEND-BUFFER-TOTAL             PIC X(057) VALUE SPACES.   02650000
026600     05  SEND-BUFFER-BYTE REDEFINES SEND-BUFFER-TOTAL             02660000
026700                                       PIC X OCCURS 57 TIMES.     02670000
026800*                                                                 02680000
026900 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  02690000
027000     05  TS-INFO-QUEUE-NAME.                                      02700000
027100         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 02710000
027200         10  FILLER                      PIC  X(04)  VALUE 'INFO'.02720000
027300                                                                  02730000
027400******************************************************************02740000
027500*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      02750000
027600******************************************************************02760000
027700     COPY DFHAID.                                                 02770000
027800                                                                  02780000
027900******************************************************************02790000
028000*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                02800000
028100******************************************************************02810000
028200     COPY DPWS013.                                                02820000
028300                                                                  02830000
028400******************************************************************02840000
028500*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 02850000
028600*****************************************************************.02860000
028700     COPY DPWS010I.                                               02870000
028800                                                                  02880000
028900******************************************************************02890000
029000*  GENERATED DSECT FOR THE CNKM230 MAPSET                         02900000
029100******************************************************************02910000
029200     COPY CNKM230.                                                02920000
029300                                                                  02930000
029400******************************************************************02940000
029500*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   02950000
029600******************************************************************02960000
029700     COPY DPWS015.                                                02970000
029800                                                                  02980000
029900******************************************************************02990000
030000*  COPY BOOK CONTAINING ERROR/WARNING/INFORMATIONAL MESSAGES      03000000
030100*  TO BE DISPLAYED ON THE LRT                                     03010000
030200******************************************************************03020000
030300     COPY SUWS005.                                                03030000
030400                                                                  03040000
030500******************************************************************03050000
030600* HELP SCREEN COMMAREA                                            03060000
030700******************************************************************03070000
030800     COPY PCWS192.                                                03080000
030900******************************************************************03090000
031000* HELP SCREEN WORK AREA                                           03100000
031100******************************************************************03110000
031200     COPY PCWS188.                                                03120000
031300                                                                  03130000
031400******************************************************************03140000
031500* CONVEYOR DIVERT TRANSACTION LAYOUT                              03150000
031600******************************************************************03160000
031700     COPY SURD014.                                                03170000
031800                                                                  03180000
031900******************************************************************03190000
032000*SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS-EZASOKET *03200000
032100******************************************************************03210000
032200     COPY DPWS081.                                                03220000
032300                                                                  03230000
032400******************************************************************03240000
032500*    DB2 AREA FOR THE LOGISTICS DOMAIN LOCATION MASTER TABLE      03250000
032600******************************************************************03260000
032700                                                                  03270000
032800     EXEC SQL                                                     03280000
032900         INCLUDE XLT00010                                         03290000
033000     END-EXEC.                                                    03300000
033100                                                                  03310000
033200******************************************************************03320000
033300*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE CONTAINER DIVERT   03330000
033400*  TABLE                                                          03340000
033500******************************************************************03350000
033600     EXEC SQL                                                     03360000
033700         INCLUDE TSUCRDV                                          03370000
033800     END-EXEC.                                                    03380000
033900                                                                  03390000
033910*                                                                 03391000
033920*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03392000
033930*  TABLE                                                          03393000
033940     EXEC SQL                                                     03394000
033950         INCLUDE SUT00024                                         03395000
033960     END-EXEC.                                                    03396000
033970                                                                  03397000
033980******************************************************************03398000
033990*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE DOOR-TO-STORE      03399000
034000*  TABLE                                                          03400000
034100******************************************************************03410000
034200     EXEC SQL                                                     03420000
034300         INCLUDE TCNDRST                                          03430000
034400     END-EXEC.                                                    03440000
034500                                                                  03450000
034600******************************************************************03460000
034700*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE DC DOOR TABLE      03470000
034800******************************************************************03480000
034900     EXEC SQL                                                     03490000
035000         INCLUDE TCNDCDR                                          03500000
035100     END-EXEC.                                                    03510000
035200                                                                  03520000
035300                                                                  03530000
035400     EXEC SQL DECLARE CHILD-CSR CURSOR FOR                        03540000
035500         SELECT UNT1.SHIPT_UNT_ID                                 03550000
035600            ,   UNT1.DEST_LOC_NBR                                 03560000
035700         FROM   SUT_OTBND_CART UNT1                               03570000
035800         WHERE  UNT1.PRNT_CART_ID      = :DK-SHIPT-UNT-ID         03580000
035900          AND   UNT1.SHIPT_UNT_ID     <> :DK-SHIPT-UNT-ID         03590000
036000          AND   UNT1.ACTV_IND          = 'Y'                      03600000
036100          AND   UNT1.MSTR_CART_IND     = 'N'                      03610000
036200     END-EXEC.                                                    03620000
036300                                                                  03630000
036400******************************************************************03640000
036500*  COMMUNICATIONS AREA FOR DB2                                    03650000
036600******************************************************************03660000
036700     EXEC SQL                                                     03670000
036800         INCLUDE SQLCA                                            03680000
036900     END-EXEC.                                                    03690000
037000                                                                  03700000
037100******************************************************************03710000
037200******************************************************************03720000
037300 LINKAGE SECTION.                                                 03730000
037400******************************************************************03740000
037500 01  DFHCOMMAREA.                                                 03750000
037600     05  FILLER                         OCCURS  1 TO 4072 TIMES   03760000
037700                                        DEPENDING ON EIBCALEN.    03770000
037800         10  FILLER                     PIC X.                    03780000
037900                                                                  03790000
038000                                                                  03800000
038100******************************************************************03810000
038200 PROCEDURE DIVISION.                                              03820000
038300******************************************************************03830000
038400 0000-PROGRAM-MAINLINE.                                           03840000
038500     IF EIBTRNID = 'Z278'                                         03850000
038600         MOVE DFHCOMMAREA            TO PC192-COMMAREA            03860000
038700         MOVE PC192-HOST-SAVE-AREA   TO CA-COMMAREA               03870000
038800     ELSE                                                         03880000
038900         MOVE DFHCOMMAREA            TO CA-COMMAREA               03890000
039000     END-IF.                                                      03900000
039100     MOVE LOW-VALUES   TO  CNK230AI.                              03910002
039200                                                                  03920000
039300     EVALUATE TRUE                                                03930000
039400         WHEN EIBCALEN = ZERO                                     03940000
039500         WHEN EIBAID = DFHCLEAR                                   03950000
039600             INITIALIZE CA-PROG-COMMAREA                          03960000
039700             MOVE PC-ENTER-PF-3    TO  AMSGLNO                    03970000
039800             MOVE -1               TO  ADCL                       03980000
039900             PERFORM 8000-SEND-MAP                                03990000
040000             PERFORM 8200-RETURN-TRANID                           04000000
040100                                                                  04010000
040200                                                                  04020000
040300*            RETURN TO PREVIOUS SCREEN                            04030000
040400         WHEN EIBAID = DFHPF3                                     04040000
040500             MOVE PC-RETURN-PGM         TO  PV-TRANSFER-PROGRAM   04050000
040600             PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                04060000
040700                                                                  04070000
040800         WHEN EIBAID = DFHPF1                                     04080000
040900              PERFORM 1800-HELP-SCREEN                            04090000
041000                                                                  04100000
041100         WHEN EIBAID = DFHENTER                                   04110000
041200             PERFORM 1200-RECEIVE-MAP                             04120000
041300             IF CA-NO-RETURN-ERROR                                04130000
041400                 MOVE SPACES TO AMSGLNO                           04140000
041500             END-IF                                               04150000
041600             PERFORM 1300-VALIDATE-DC                             04160000
041700             PERFORM 1400-VALIDATE-DOOR                           04170000
041800             PERFORM 1500-VALIDATE-CARTON                         04180000
041900             PERFORM 8250-SELECT-TSHPUNT                          04190000
042000                                                                  04200000
042100             IF PS-SHPUNT-FOUND-YES AND                           04210000
042200                SUT00024-CART-SRC-CDE = 'MST' AND                 04220001
042210                CNDCDR-DOOR-TYP-CDE NOT = 'DS' AND                04221001
042220                CNDCDR-DOOR-TYP-CDE NOT = 'ST'                    04222001
042300***       INACTIVATE MST RECORD - SHPUNT                          04230000
042400                 MOVE SUT00024-PRNT-CART-ID                       04240000
042500                                  TO PV-NEXT-SHIPT-UNT-ID         04250000
042600                 MOVE 'N'         TO PV-ACTV-IND                  04260000
042700                 PERFORM 8210-UPDATE-SHPUNT                       04270000
042800                 PERFORM 8230-INACT-TSUCRDV                       04280000
042900***       INSERT NEW INACTIVE RECORD - SUCRDV                     04290000
043000                 PERFORM 5600-POPULATE-FIELDS                     04300000
043100                 MOVE 'I'         TO  SUCRDV-ACTV-CDE             04310000
043200                 PERFORM 3000-INSERT-TSUCRDV                      04320000
043300****      SELECT ALL CHILDREN SHPUNT                              04330000
043400                 MOVE 'A'         TO  SUCRDV-ACTV-CDE             04340000
043500                 MOVE 'Y'         TO PV-ACTV-IND                  04350000
043600                 PERFORM 8300-PROCESS-CHILDREN                    04360000
043700****      INSERT ACTIVE DIVERT FOR EACH CHILD - SUCRDV            04370000
043800****      INACTIVATE CHILDREN AND SET NEXT_SHIPT_UNT_ID           04380000
043900****            TO ZERO - SHPUNT                                  04390000
044000****      INACTIVATE PARENT - SHPUNT                              04400000
044100             ELSE                                                 04410000
044200                 PERFORM 5600-POPULATE-FIELDS                     04420000
044300                 PERFORM 3000-INSERT-TSUCRDV                      04430000
044400             END-IF                                               04440000
044500                                                                  04450000
044600                                                                  04460000
044700*            PERFORM 5600-POPULATE-FIELDS                         04470000
044800*            PERFORM 3000-INSERT-TSUCRDV                          04480000
044900             SET CA-NO-RETURN-ERROR TO TRUE                       04490000
045000             MOVE PC-CARTON-ADDED   TO AMSGLNO                    04500000
045100                                                                  04510000
045200         WHEN OTHER                                               04520000
045300             PERFORM 1200-RECEIVE-MAP                             04530000
045400             IF CA-NO-RETURN-ERROR                                04540000
045500                 MOVE SPACES TO AMSGLNO                           04550000
045600             END-IF                                               04560000
045700             PERFORM 1300-VALIDATE-DC                             04570000
045800             PERFORM 1400-VALIDATE-DOOR                           04580000
045900             PERFORM 1500-VALIDATE-CARTON                         04590000
046000             MOVE PC-UNRECOGNIZED-PF-KEY-MSG  TO  AMSGLNO         04600000
046100             SET CA-RETURN-ERROR   TO TRUE                        04610000
046200                                                                  04620000
046300     END-EVALUATE.                                                04630000
046400                                                                  04640000
046500     IF AMSGLNO = SPACES                                          04650000
046600         SET CA-NO-RETURN-ERROR TO TRUE                           04660000
046700         MOVE PC-ENTER-PF-3    TO  AMSGLNO                        04670000
046800     END-IF.                                                      04680000
046900     PERFORM 8100-SEND-DATA-ONLY.                                 04690000
047000     PERFORM 8200-RETURN-TRANID.                                  04700000
047100                                                                  04710000
047200     GOBACK.                                                      04720000
047300*                                                                 04730000
047400*                                                                 04740000
047500 1200-RECEIVE-MAP.                                                04750000
047600     EXEC CICS                                                    04760000
047700         RECEIVE                                                  04770000
047800             MAP     ('CNK230A')                                  04780002
047900             MAPSET  ('CNKM230')                                  04790000
048000             RESP    (PV-CICS-RESPONSE)                           04800000
048100     END-EXEC.                                                    04810000
048200                                                                  04820000
048300     EVALUATE TRUE                                                04830000
048400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 04840000
048500              PERFORM 1210-RECEIVE-SCREEN-FIELDS                  04850000
048600         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                04860000
048700              CONTINUE                                            04870000
048800         WHEN OTHER                                               04880000
048900              MOVE '1200-RECEIVE-MAP'                             04890000
049000                                     TO DP013-PARAGRAPH           04900000
049100              MOVE 'UNABLE TO RECEIVE MAP'                        04910000
049200                                     TO DP013-MESSAGE-TEXT (1)    04920000
049300              SET DP013-LOGIC-ABEND  TO TRUE                      04930000
049400              SET DP013-NO-ROLLBACK  TO TRUE                      04940000
049500              PERFORM 9999-WRITE-CICS-LOG-MSG                     04950000
049600     END-EVALUATE.                                                04960000
049700*                                                                 04970000
049800 1210-RECEIVE-SCREEN-FIELDS.                                      04980000
049900*                                                                 04990000
050000     IF  ADCL     > ZERO                                          05000000
050100         MOVE ADCI                   TO PV-DC-X                   05010000
050200     ELSE IF  ADCF     = DP015-ERASE-EOF                          05020000
050300         MOVE SPACES                 TO PV-DC-X                   05030000
050400                                        ADCO                      05040000
050500     END-IF.                                                      05050000
050600*                                                                 05060000
050700     IF  ACTNL    > ZERO                                          05070000
050800         MOVE ACTNI                  TO PV-CTN-X                  05080000
050900*    ELSE IF  ACTNF    = DP015-ERASE-EOF                          05090000
051000     ELSE                                                         05100000
051100         MOVE SPACES                 TO PV-CTN-X                  05110000
051200                                        ACTNO                     05120000
051300     END-IF.                                                      05130000
051400*                                                                 05140000
051500     IF  ADOORL   > ZERO                                          05150000
051600         MOVE ADOORI                 TO PV-DOOR-X                 05160000
051700                                        CA-DOOR-ID                05170000
051800     ELSE                                                         05180000
051900         IF  ADOORF   = DP015-ERASE-EOF                           05190000
052000             MOVE SPACES                 TO PV-DOOR-X             05200000
052100                                            ADOORO                05210000
052200                                            CA-DOOR-ID            05220000
052300         ELSE                                                     05230000
052400             MOVE CA-DOOR-ID         TO PV-DOOR-X                 05240000
052500         END-IF                                                   05250000
052600     END-IF.                                                      05260000
052700*                                                                 05270000
052800**************************************************************    05280000
052900* VALIDATE THE DC NUMBER ENTERED                             *    05290000
053000**************************************************************    05300000
053100 1300-VALIDATE-DC.                                                05310000
053200                                                                  05320000
053300     IF PV-DC-X > SPACES                                          05330000
053400         MOVE PV-DC-X                TO DP010I-UNEDITED-FIELD     05340000
053500     ELSE                                                         05350000
053600         MOVE CA-DC-NUMBER           TO DP010I-UNEDITED-FIELD     05360000
053700     END-IF.                                                      05370000
053800     MOVE 4                      TO DP010I-MAXIMUM-DIGITS.        05380000
053900     MOVE 0                      TO DP010I-MAXIMUM-DECIMALS.      05390000
054000     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     05400000
054100                                                                  05410000
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             05421003
263455          USING DP010I-NUMERIC-EDIT-AREA.                         05422003
054300                                                                  05430000
054400     IF  DP010I-ERROR-DETECTED                                    05440000
054500         SET CA-RETURN-ERROR   TO TRUE                            05450000
054600         MOVE PC-DC-NOT-NUMERIC      TO AMSGLNO                   05460000
054700         MOVE -1                     TO ADCL                      05470000
054800         PERFORM 8100-SEND-DATA-ONLY                              05480000
054900         PERFORM 8200-RETURN-TRANID                               05490000
055000     ELSE                                                         05500000
055100         MOVE DP010I-NUMERIC-FIELD   TO CA-DC-NUMBER              05510000
055200                                        PV-DC-NUMERIC             05520000
055300         MOVE PV-DC-ALPHA            TO ADCO                      05530000
055400     END-IF                                                       05540000
055500                                                                  05550000
055600     MOVE CA-DC-NUMBER               TO DK-OPER-UNT-ID.           05560000
055700     PERFORM 1350-SELECT-DC.                                      05570000
055800     IF PS-DC-NOT-FOUND                                           05580000
055900         SET CA-RETURN-ERROR   TO TRUE                            05590000
056000         MOVE PC-NOT-VALID-DC        TO AMSGLNO                   05600000
056100         MOVE -1                     TO ADCL                      05610000
056200         PERFORM 8100-SEND-DATA-ONLY                              05620000
056300         PERFORM 8200-RETURN-TRANID                               05630000
056400     ELSE                                                         05640000
056500         MOVE -1                     TO ACTNL                     05650000
056600     END-IF.                                                      05660000
056700                                                                  05670000
056800******************************************************************05680000
056900* 1350-SELECT-DC                                                  05690000
057000******************************************************************05700000
057100 1350-SELECT-DC.                                                  05710000
057200                                                                  05720000
057300     EXEC SQL                                                     05730000
057400         SELECT  LOC_NBR                                          05740000
057500         INTO   :XLT00010-LOC-NBR                                 05750000
057600         FROM    XLT_LOC                                          05760000
057700         WHERE   LOC_NBR = :DK-OPER-UNT-ID                        05770000
057800           AND   LOC_TYP_CDE = 'DC'                               05780000
057900     END-EXEC.                                                    05790000
058000                                                                  05800000
058100     EVALUATE TRUE                                                05810000
058200         WHEN SQLCODE = ZERO                                      05820000
058300             SET PS-DC-FOUND         TO TRUE                      05830000
058400                                                                  05840000
058500         WHEN SQLCODE = +100                                      05850000
058600             SET PS-DC-NOT-FOUND     TO TRUE                      05860000
058700                                                                  05870000
058800         WHEN SQLWARN0 NOT = SPACES                               05880000
058900         WHEN SQLCODE < ZERO                                      05890000
059000         WHEN SQLCODE > ZERO                                      05900000
059100             MOVE '1350-SELECT-DC'                                05910000
059200                                   TO DP013-PARAGRAPH             05920000
059300             MOVE 'SELECT OF DC  ' TO DP013-MESSAGE-TEXT (1)      05930000
059400             MOVE DK-OPER-UNT-ID   TO DP013-MESSAGE-TEXT (2)      05940000
059500             MOVE SQLCA            TO DP013-SQLCA                 05950000
059600             MOVE 'XLT_LOC'        TO DP013-DB2-TABLE-NAME (1)    05960000
059700             SET DP013-DB2-ABEND   TO TRUE                        05970000
059800             SET DP013-NO-ROLLBACK TO TRUE                        05980000
059900             PERFORM 9999-WRITE-CICS-LOG-MSG                      05990000
060000             SET CA-RETURN-ERROR   TO TRUE                        06000000
060100             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               06010000
060200             MOVE -1                     TO ADCL                  06020000
060300             PERFORM 8100-SEND-DATA-ONLY                          06030000
060400             PERFORM 8200-RETURN-TRANID                           06040000
060500     END-EVALUATE.                                                06050000
060600                                                                  06060000
060700*                                                                 06070000
060800**************************************************************    06080000
060900* VALIDATE THE DOOR NUMBER ENTERED                           *    06090000
061000**************************************************************    06100000
061100 1400-VALIDATE-DOOR.                                              06110000
061200                                                                  06120000
061300     IF PV-DOOR-X > SPACES                                        06130000
061400         SET CA-DOOR-ID-ENTERED TO TRUE                           06140000
061500         PERFORM 1450-VALIDATE-DOOR                               06150000
061600         IF PS-NO-STOR-SHUTTLE-DOOR-FOUND                         06160000
061700             SET CA-RETURN-ERROR   TO TRUE                        06170000
061800             MOVE PC-INVALID-DOOR-TYPE   TO AMSGLNO               06180000
061900             MOVE -1                     TO ADOORL                06190000
062000             PERFORM 8100-SEND-DATA-ONLY                          06200000
062100             PERFORM 8200-RETURN-TRANID                           06210000
062200         ELSE                                                     06220000
062300             MOVE -1                     TO ACTNL                 06230000
062400         END-IF                                                   06240000
062500     ELSE                                                         06250000
062600         SET PS-NO-STOR-SHUTTLE-DOOR-FOUND TO TRUE                06260000
062700         SET CA-NO-DOOR-ID-ENTERED TO TRUE                        06270000
062800     END-IF.                                                      06280000
062900                                                                  06290000
063000                                                                  06300000
063100 1450-VALIDATE-DOOR.                                              06310000
063200                                                                  06320000
063300     EXEC SQL                                                     06330000
063400         SELECT  DOOR_ID                                          06340000
063410              ,  DOOR_TYP_CDE                                     06341001
063500              ,  DIVERT_NBR                                       06350000
063600              ,  DIVERT_LOC_ID                                    06360000
063700         INTO   :CNDCDR-DOOR-ID                                   06370000
063710              , :CNDCDR-DOOR-TYP-CDE                              06371001
063800              , :CNDCDR-DIVERT-NBR                                06380000
063900              , :CNDCDR-DIVERT-LOC-ID                             06390000
064000         FROM    TCNDCDR                                          06400000
064100         WHERE   OPER_UNT_ID   = :DK-OPER-UNT-ID                  06410000
064200           AND   DOOR_ID       = :PV-DOOR-X                       06420000
064300           AND   DOOR_TYP_CDE  IN ('DS', 'ST','SH')               06430000
064400     END-EXEC.                                                    06440000
064500                                                                  06450000
064600     EVALUATE TRUE                                                06460000
064700         WHEN SQLCODE = ZERO                                      06470000
064800             SET PS-STOR-SHUTTLE-DOOR-FOUND    TO TRUE            06480000
064900                                                                  06490000
065000         WHEN SQLCODE = +100                                      06500000
065100             SET PS-NO-STOR-SHUTTLE-DOOR-FOUND TO TRUE            06510000
065200                                                                  06520000
065300         WHEN SQLWARN0 NOT = SPACES                               06530000
065400         WHEN SQLCODE < ZERO                                      06540000
065500         WHEN SQLCODE > ZERO                                      06550000
065600             MOVE '1450-VALIDATE-DOOR'                            06560000
065700                                   TO DP013-PARAGRAPH             06570000
065800             MOVE PV-DOOR-X        TO DP013-MESSAGE-TEXT (1)      06580000
065900             MOVE SQLCA            TO DP013-SQLCA                 06590000
066000             MOVE 'TCNDCDR'        TO DP013-DB2-TABLE-NAME (1)    06600000
066100             SET DP013-DB2-ABEND   TO TRUE                        06610000
066200             SET DP013-NO-ROLLBACK TO TRUE                        06620000
066300             PERFORM 9999-WRITE-CICS-LOG-MSG                      06630000
066400             SET CA-RETURN-ERROR   TO TRUE                        06640000
066500             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               06650000
066600             MOVE -1                     TO ADCL                  06660000
066700             PERFORM 8100-SEND-DATA-ONLY                          06670000
066800             PERFORM 8200-RETURN-TRANID                           06680000
066900     END-EVALUATE.                                                06690000
067000                                                                  06700000
067100 1500-VALIDATE-CARTON.                                            06710000
067200                                                                  06720000
067300*    IF PV-CTN-X = SPACES                                         06730000
067400*        MOVE CA-BAR-CODE                  TO PV-CTN-X            06740000
067500*    END-IF.                                                      06750000
067600*    EDIT THE CARTON NUMBER -- FIRST DETERMINE IF THE NUMBER OF   06760000
067700*    CHARCTERS ENTERED WAS CORRECT                                06770000
067800     MOVE 0 TO PV-CHAR-COUNT                                      06780000
067900     INSPECT PV-CTN-X TALLYING PV-CHAR-COUNT FOR CHARACTERS       06790000
068000                    BEFORE INITIAL SPACE                          06800000
068100     EVALUATE TRUE                                                06810000
068200       WHEN PV-CTN-X = SPACES                                     06820000
068300           MOVE -1                     TO ACTNL                   06830000
068400           MOVE PC-CARTON-NBR-REQD     TO AMSGLNO                 06840000
068500           SET CA-RETURN-ERROR   TO TRUE                          06850000
068600           PERFORM 8100-SEND-DATA-ONLY                            06860000
068700           PERFORM 8200-RETURN-TRANID                             06870000
068800       WHEN PV-CHAR-COUNT = PC-18 AND                             06880000
068900          ((PV-CTN-FIRST-DIGIT NOT = PC-0) AND                    06890000
069000           (PV-CTN-FIRST-DIGIT NOT = PC-4))                       06900000
069100           MOVE -1                     TO ACTNL                   06910000
069200           MOVE PC-FIRST-1-NOT-0-MSG   TO AMSGLNO                 06920000
069300           SET CA-RETURN-ERROR   TO TRUE                          06930000
069400           PERFORM 8100-SEND-DATA-ONLY                            06940000
069500           PERFORM 8200-RETURN-TRANID                             06950000
069600       WHEN PV-CHAR-COUNT < PC-18                                 06960000
069700           MOVE -1                     TO ACTNL                   06970000
069800           MOVE PC-MORE-DIGITS-REQD    TO AMSGLNO                 06980000
069900           SET CA-RETURN-ERROR   TO TRUE                          06990000
070000           PERFORM 8100-SEND-DATA-ONLY                            07000000
070100           PERFORM 8200-RETURN-TRANID                             07010000
070200     END-EVALUATE.                                                07020000
070300                                                                  07030000
070400*    THE DETERMINE IF THE NUMBER WAS NUMERIC                      07040000
070500     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE.                     07050000
070600                                                                  07060000
070700     IF PV-CHAR-COUNT = PC-18                                     07070000
070800        MOVE PV-CTN-LAST-17          TO DP010I-UNEDITED-FIELD     07080000
070900     ELSE                                                         07090000
071000         IF PV-CHAR-COUNT < PC-18                                 07100000
071100            MOVE PV-CTN-X            TO DP010I-UNEDITED-FIELD     07110000
071200         ELSE                                                     07120000
071300            MOVE PV-CTN-SCAN-LAST-17 TO DP010I-UNEDITED-FIELD     07130000
071400         END-IF                                                   07140000
071500     END-IF                                                       07150000
071600                                                                  07160000
071700     MOVE 17                     TO DP010I-MAXIMUM-DIGITS         07170000
071800     MOVE 0                      TO DP010I-MAXIMUM-DECIMALS       07180000
071900                                                                  07190000
263455     CALL DP010I-NUMERIC-EDIT-ROUTINE                             07201003
263455          USING DP010I-NUMERIC-EDIT-AREA                          07202003
072100                                                                  07210000
072200     IF  DP010I-ERROR-DETECTED                                    07220000
072300         MOVE -1                     TO ACTNL                     07230000
072400         MOVE PC-CARTON-NOT-NUMERIC  TO AMSGLNO                   07240000
072500         SET CA-RETURN-ERROR   TO TRUE                            07250000
072600         PERFORM 8100-SEND-DATA-ONLY                              07260000
072700         PERFORM 8200-RETURN-TRANID                               07270000
072800     ELSE                                                         07280000
072900         IF DP010I-NUMERIC-FIELD = ZEROES                         07290000
073000             MOVE -1                  TO ACTNL                    07300000
073100             MOVE PC-MUST-BE-GT-0-MSG TO AMSGLNO                  07310000
073200             SET CA-RETURN-ERROR   TO TRUE                        07320000
073300             PERFORM 8100-SEND-DATA-ONLY                          07330000
073400             PERFORM 8200-RETURN-TRANID                           07340000
073500         ELSE                                                     07350000
073600             COMPUTE PV-CTN-N          ROUNDED =                  07360000
073700                  DP010I-NUM-FIELD-17-DIG-0-DEC * 1               07370000
073800                                                                  07380000
073900             EVALUATE TRUE                                        07390000
074000               WHEN PV-CHAR-COUNT = PC-20                         07400000
074100                  IF PV-CTN-SCAN-THIRD-DGT  = PC-4                07410000
074200                     MOVE PV-CTN-SCAN-LAST-18 TO                  07420000
074300                                        PV-CTN-N                  07430000
074400                     MOVE PV-CTN-SCAN-STORE   TO DK-STR-NBR       07440000
074500                  END-IF                                          07450000
074600               WHEN PV-CHAR-COUNT = PC-18                         07460000
074700                  IF PV-CTN-FIRST-DIGIT  = PC-4                   07470000
074800                     MOVE PV-CTN-X TO PV-CTN-N                    07480000
074900                     MOVE PV-CTN-STORE        TO DK-STR-NBR       07490000
075000                  END-IF                                          07500000
075100             END-EVALUATE                                         07510000
075200             MOVE PV-CTN-X               TO ACTNO                 07520000
075300                                            CA-BAR-CODE           07530000
075400         END-IF                                                   07540000
075500     END-IF.                                                      07550000
075600                                                                  07560000
075700     IF PS-NO-STOR-SHUTTLE-DOOR-FOUND                             07570000
075800         PERFORM 3200-SELECT-DOOR                                 07580000
075900         IF PS-DOOR-NOT-FOUND                                     07590000
076000             MOVE -1                     TO ACTNL                 07600000
076100             MOVE PC-NO-DOOR-FOR-STR     TO AMSGLNO               07610000
076200             SET CA-RETURN-ERROR   TO TRUE                        07620000
076300             PERFORM 8100-SEND-DATA-ONLY                          07630000
076400             PERFORM 8200-RETURN-TRANID                           07640000
076500         ELSE                                                     07650000
076600             MOVE CNDCDR-DOOR-ID             TO CA-DOOR-ID        07660000
076700             MOVE CNDCDR-DIVERT-NBR          TO CA-DIVERT-NUMBER  07670000
076800             MOVE CNDCDR-DIVERT-LOC-ID       TO CA-DOOR-NUMBER    07680000
076900         END-IF                                                   07690000
077000     ELSE                                                         07700000
077100         MOVE CNDCDR-DOOR-ID             TO CA-DOOR-ID            07710000
077200         MOVE CNDCDR-DIVERT-NBR          TO CA-DIVERT-NUMBER      07720000
077300         MOVE CNDCDR-DIVERT-LOC-ID       TO CA-DOOR-NUMBER        07730000
077400     END-IF.                                                      07740000
077500                                                                  07750000
077600                                                                  07760000
077700*                                                                 07770000
077800 1800-HELP-SCREEN.                                                07780000
077900     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      07790000
078000     MOVE 'CNKRF230'                  TO PC192-PROGRAM-NAME       07800000
078100     COPY PCPD188.                                                07810000
078200     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      07820000
078300     PERFORM 2200-XCTL-TO-HELP.                                   07830000
078400                                                                  07840000
078500                                                                  07850000
078600***************************************************************** 07860000
078700*   2100-XCTL-TO-SELECTED-PROGRAM.                              * 07870000
078800* TRANSFER CONTROL TO ANOTHER PROGRAM                           * 07880000
078900***************************************************************** 07890000
079000 2100-XCTL-TO-SELECTED-PROGRAM.                                   07900000
079100     MOVE LENGTH OF CA-COMMAREA    TO  PV-COMMAREA-LENGTH.        07910000
079200***  MOVE PC-CURRENT-PROGRAM-NAME  TO  CA-LAST-PROGRAM.           07920000
079300                                                                  07930000
079400     EXEC CICS                                                    07940000
079500         XCTL                                                     07950000
079600             PROGRAM   (PV-TRANSFER-PROGRAM)                      07960000
079700             COMMAREA  (CA-COMMAREA)                              07970000
079800             LENGTH    (PV-COMMAREA-LENGTH)                       07980000
079900             RESP      (PV-CICS-RESPONSE)                         07990000
080000     END-EXEC.                                                    08000000
080100                                                                  08010000
080200     EVALUATE TRUE                                                08020000
080300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08030000
080400              CONTINUE                                            08040000
080500         WHEN OTHER                                               08050000
080600              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                08060000
080700                                     TO DP013-PARAGRAPH           08070000
080800              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       08080000
080900                                     TO DP013-MESSAGE-TEXT (1)    08090000
081000              MOVE PV-TRANSFER-PROGRAM                            08100000
081100                                     TO DP013-MESSAGE-TEXT (2)    08110000
081200              SET DP013-CICS-ABEND   TO TRUE                      08120000
081300              SET DP013-NO-ROLLBACK  TO TRUE                      08130000
081400              PERFORM 9999-WRITE-CICS-LOG-MSG                     08140000
081500              MOVE PM-TRANS-NOT-AVAILABLE-MSG                     08150000
081600                                     TO AMSGLNO                   08160000
081700              SET CA-RETURN-ERROR   TO TRUE                       08170000
081800              PERFORM 8100-SEND-DATA-ONLY                         08180000
081900              PERFORM 8200-RETURN-TRANID                          08190000
082000     END-EVALUATE.                                                08200000
082100                                                                  08210000
082200 2200-XCTL-TO-HELP.                                               08220000
082300                                                                  08230000
082400     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH.      08240000
082500     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA.    08250000
082600                                                                  08260000
082700     EXEC CICS                                                    08270000
082800         XCTL                                                     08280000
082900             PROGRAM   (PV-TRANSFER-PROGRAM)                      08290000
083000             COMMAREA  (PC192-COMMAREA)                           08300000
083100             LENGTH    (PV-COMMAREA-LENGTH)                       08310000
083200             RESP      (PV-CICS-RESPONSE)                         08320000
083300     END-EXEC.                                                    08330000
083400                                                                  08340000
083500     EVALUATE TRUE                                                08350000
083600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08360000
083700              CONTINUE                                            08370000
083800         WHEN OTHER                                               08380000
083900              MOVE '2200-XCTL-TO-HELP'                            08390000
084000                                     TO DP013-PARAGRAPH           08400000
084100              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       08410000
084200                                     TO DP013-MESSAGE-TEXT (1)    08420000
084300              MOVE PV-TRANSFER-PROGRAM                            08430000
084400                                     TO DP013-MESSAGE-TEXT (2)    08440000
084500              SET DP013-CICS-ABEND   TO TRUE                      08450000
084600              SET DP013-NO-ROLLBACK  TO TRUE                      08460000
084700              PERFORM 9999-WRITE-CICS-LOG-MSG                     08470000
084800              MOVE PC-TRANS-UNAVAILABLE-MSG                       08480000
084900                                     TO AMSGLNO                   08490000
085000              SET CA-RETURN-ERROR   TO TRUE                       08500000
085100              PERFORM 8100-SEND-DATA-ONLY                         08510000
085200              PERFORM 8200-RETURN-TRANID                          08520000
085300     END-EVALUATE.                                                08530000
085400*                                                                 08540000
085500*----------------------------------------------------------------*08550000
085600*    INSERT A ROW INTO THE TSUCRDV TABLE                          08560000
085700*----------------------------------------------------------------*08570000
085800 3000-INSERT-TSUCRDV.                                             08580000
085900                                                                  08590000
086000     EXEC SQL                                                     08600000
086100          INSERT INTO TSUCRDV                                     08610000
086200                 (OPER_UNT_ID                                     08620000
086300               ,  DIVERT_NBR                                      08630000
086400               ,  DIVERT_LOC_ID                                   08640000
086500               ,  DIVERT_TMST                                     08650000
086600               ,  BRCDE_NBR                                       08660000
086700               ,  PRC_RSN_CDE                                     08670000
086800               ,  SHIPT_UNT_ID                                    08680000
086900               ,  BTCH_NBR                                        08690000
087000               ,  BTCH_RVSN_NBR                                   08700000
087100               ,  ACTV_CDE                                        08710000
087200               ,  NACTV_USR_ID                                    08720000
087300               ,  DOOR_ID                                         08730000
087400               ,  DEST_OPER_UNT_ID)                               08740000
087500          VALUES (                                                08750000
087600                  :SUCRDV-OPER-UNT-ID                             08760000
087700               ,  :SUCRDV-DIVERT-NBR                              08770000
087800               ,  :SUCRDV-DIVERT-LOC-ID                           08780000
087900               ,  CURRENT TIMESTAMP                               08790000
088000               ,  :SUCRDV-BRCDE-NBR                               08800000
088100               ,  :SUCRDV-PRC-RSN-CDE                             08810000
088200               ,  :SUCRDV-SHIPT-UNT-ID                            08820000
088300               ,  :SUCRDV-BTCH-NBR                                08830000
088400               ,  :SUCRDV-BTCH-RVSN-NBR                           08840000
088500               ,  :SUCRDV-ACTV-CDE                                08850000
088600               ,  :SUCRDV-NACTV-USR-ID                            08860000
088700               ,  :SUCRDV-DOOR-ID                                 08870000
088800               ,  :SUCRDV-DEST-OPER-UNT-ID)                       08880000
088900     END-EXEC.                                                    08890000
089000                                                                  08900000
089100     EVALUATE TRUE                                                08910000
089200         WHEN SQLCODE = +0                                        08920000
089300              CONTINUE                                            08930000
089400                                                                  08940000
089500         WHEN SQLWARN0 NOT = SPACES                               08950000
089600         WHEN SQLCODE < +0                                        08960000
089700         WHEN SQLCODE > +0                                        08970000
089800              MOVE '3000-INSERT-TSUCRDV'                          08980000
089900                              TO DP013-PARAGRAPH                  08990000
090000              MOVE 'UNSUCCESSFUL INSERT ON TSUCRDV  '             09000000
090100                              TO DP013-MESSAGE-TEXT (1)           09010000
090200              MOVE SQLCA      TO DP013-SQLCA                      09020000
090300              MOVE 'TSUCRDV ' TO DP013-DB2-TABLE-NAME (1)         09030000
090400              SET DP013-DB2-ABEND                                 09040000
090500                  DP013-ROLLBACK       TO TRUE                    09050000
090600              PERFORM 9999-WRITE-CICS-LOG-MSG                     09060000
090700     END-EVALUATE.                                                09070000
090800                                                                  09080000
090900                                                                  09090000
091000 3200-SELECT-DOOR.                                                09100000
091100                                                                  09110000
091200     EXEC SQL                                                     09120000
091300         SELECT  B.DOOR_ID                                        09130000
091400              ,  B.DIVERT_NBR                                     09140000
091500              ,  B.DIVERT_LOC_ID                                  09150000
091600         INTO   :CNDCDR-DOOR-ID                                   09160000
091700              , :CNDCDR-DIVERT-NBR                                09170000
091800              , :CNDCDR-DIVERT-LOC-ID                             09180000
091900         FROM    TCNDRST A                                        09190000
092000               , TCNDCDR B                                        09200000
092100         WHERE   A.OPER_UNT_ID   = :DK-OPER-UNT-ID                09210000
092200           AND   A.OPER_UNT_ID   = B.OPER_UNT_ID                  09220000
092300           AND   A.STR_NBR       = :DK-STR-NBR                    09230000
092400           AND   A.DOOR_ID       = B.DOOR_ID                      09240000
092500           AND   B.DOOR_TYP_CDE  = 'SH'                           09250000
092600           AND   A.STRT_TMST     <= CURRENT TIMESTAMP             09260000
092700           AND   A.END_TMST      >= CURRENT TIMESTAMP             09270000
092800     END-EXEC.                                                    09280000
092900                                                                  09290000
093000     EVALUATE TRUE                                                09300000
093100         WHEN SQLCODE = ZERO                                      09310000
093200         WHEN SQLCODE = -811                                      09320000
093300             SET PS-DOOR-FOUND       TO TRUE                      09330000
093400                                                                  09340000
093500         WHEN SQLCODE = +100                                      09350000
093600             SET PS-DOOR-NOT-FOUND   TO TRUE                      09360000
093700                                                                  09370000
093800         WHEN SQLWARN0 NOT = SPACES                               09380000
093900         WHEN SQLCODE < ZERO                                      09390000
094000         WHEN SQLCODE > ZERO                                      09400000
094100             MOVE '3200-SELECT-DOOR'                              09410000
094200                                   TO DP013-PARAGRAPH             09420000
094300             MOVE DK-OPER-UNT-ID   TO DP013-MESSAGE-TEXT (1)      09430000
094400             MOVE DK-DOOR-NUMBER   TO DP013-MESSAGE-TEXT (2)      09440000
094500             MOVE SQLCA            TO DP013-SQLCA                 09450000
094600             MOVE 'TCNDRST'        TO DP013-DB2-TABLE-NAME (1)    09460000
094700             MOVE 'TCNDCDR'        TO DP013-DB2-TABLE-NAME (2)    09470000
094800             SET DP013-DB2-ABEND   TO TRUE                        09480000
094900             SET DP013-NO-ROLLBACK TO TRUE                        09490000
095000             PERFORM 9999-WRITE-CICS-LOG-MSG                      09500000
095100             SET CA-RETURN-ERROR   TO TRUE                        09510000
095200             MOVE PM-DB2-FATAL-ERROR-MSG TO AMSGLNO               09520000
095300             MOVE -1                     TO ADCL                  09530000
095400             PERFORM 8100-SEND-DATA-ONLY                          09540000
095500             PERFORM 8200-RETURN-TRANID                           09550000
095600     END-EVALUATE.                                                09560000
095700                                                                  09570000
095800 5600-POPULATE-FIELDS.                                            09580000
095900     INITIALIZE DCLTSUCRDV.                                       09590000
096000     MOVE CA-DC-NUMBER             TO  SUCRDV-OPER-UNT-ID         09600000
096100     MOVE CA-DIVERT-NUMBER         TO  SUCRDV-DIVERT-NBR.         09610000
096200     MOVE CA-DOOR-NUMBER           TO  SUCRDV-DIVERT-LOC-ID.      09620000
096300*GB 7/16/01 BEG                                                   09630000
096400     IF PV-CHAR-COUNT  =   PC-18                                  09640000
096500        MOVE CA-BAR-CODE           TO  PV-BRCDE-NBR-18            09650000
096600                                       PV-CONTAINER-ID-18         09660000
096700        MOVE PV-BARCODE-20         TO  SUCRDV-BRCDE-NBR           09670000
096800*                                                                 09680000
096900        MOVE PV-SHIPT-UNT-ID-18    TO  SUCRDV-SHIPT-UNT-ID        09690000
097000     ELSE                                                         09700000
097100        MOVE CA-BAR-CODE           TO  SUCRDV-BRCDE-NBR           09710000
097200                                       PV-CONTAINER-ID            09720000
097300        MOVE PV-SHIPT-UNT-ID       TO  SUCRDV-SHIPT-UNT-ID        09730000
097400     END-IF                                                       09740000
097500                                                                  09750000
097600     MOVE SUCRDV-BRCDE-NBR(6:4)    TO  SUCRDV-DEST-OPER-UNT-ID.   09760000
097700*GB 7/16/01 END                                                   09770000
097800                                                                  09780000
097900     MOVE 'A'                      TO  SUCRDV-ACTV-CDE.           09790000
098000     MOVE CA-DOOR-ID               TO  SUCRDV-DOOR-ID.            09800000
098100     IF CA-NO-DOOR-ID-ENTERED                                     09810000
098200         MOVE SPACES               TO  CA-DOOR-ID                 09820000
098300     END-IF.                                                      09830000
098400                                                                  09840000
098500                                                                  09850000
098600******************************************************************09860000
098700*  8000-SEND-MAP                                                 *09870000
098800*  SEND THE REFRESHED MAP IMAGE TO THE SCREEN                    *09880000
098900******************************************************************09890000
099000 8000-SEND-MAP.                                                   09900000
099100     EXEC CICS                                                    09910000
099200         SEND                                                     09920000
099300             MAP     ('CNK230A')                                  09930002
099400             MAPSET  ('CNKM230')                                  09940000
099500             ERASE                                                09950000
099600             CURSOR                                               09960000
099700             RESP    (PV-CICS-RESPONSE)                           09970000
099800     END-EXEC.                                                    09980000
099900                                                                  09990000
100000     EVALUATE TRUE                                                10000000
100100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10010000
100200             CONTINUE                                             10020000
100300         WHEN OTHER                                               10030000
100400             MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH            10040000
100500             MOVE 'UNABLE TO SEND MAP'                            10050000
100600                                    TO DP013-MESSAGE-TEXT (1)     10060000
100700             SET DP013-CICS-ABEND   TO TRUE                       10070000
100800             SET DP013-NO-ROLLBACK  TO TRUE                       10080000
100900             PERFORM 9999-WRITE-CICS-LOG-MSG                      10090000
101000     END-EVALUATE.                                                10100000
101100*                                                                 10110000
101200 8100-SEND-DATA-ONLY.                                             10120000
101300                                                                  10130000
101400     EXEC CICS                                                    10140000
101500         SEND                                                     10150000
101600             MAP       ('CNK230A')                                10160002
101700             MAPSET    ('CNKM230')                                10170000
101800             CURSOR                                               10180000
101900             DATAONLY                                             10190000
102000             RESP      (PV-CICS-RESPONSE)                         10200000
102100     END-EXEC.                                                    10210000
102200                                                                  10220000
102300     EVALUATE TRUE                                                10230000
102400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10240000
102500             CONTINUE                                             10250000
102600         WHEN OTHER                                               10260000
102700             MOVE '8100-SEND-DATA-ONLY'                           10270000
102800                                    TO DP013-PARAGRAPH            10280000
102900             MOVE 'UNABLE TO SEND DATA'                           10290000
103000                                    TO DP013-MESSAGE-TEXT (1)     10300000
103100             SET DP013-CICS-ABEND   TO TRUE                       10310000
103200             SET DP013-NO-ROLLBACK  TO TRUE                       10320000
103300             PERFORM 9999-WRITE-CICS-LOG-MSG                      10330000
103400     END-EVALUATE.                                                10340000
103500*                                                                 10350000
103600 8200-RETURN-TRANID.                                              10360000
103700     MOVE LENGTH OF CA-COMMAREA  TO  PV-COMMAREA-LENGTH.          10370000
103800                                                                  10380000
103900     EXEC CICS                                                    10390000
104000         RETURN                                                   10400000
104100             TRANSID   (PC-CURRENT-TRANID)                        10410000
104200             COMMAREA  (CA-COMMAREA)                              10420000
104300             LENGTH    (PV-COMMAREA-LENGTH)                       10430000
104400             RESP      (PV-CICS-RESPONSE)                         10440000
104500     END-EXEC.                                                    10450000
104600                                                                  10460000
104700     EVALUATE TRUE                                                10470000
104800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10480000
104900             CONTINUE                                             10490000
105000         WHEN OTHER                                               10500000
105100             MOVE '8200-RETURN-TRANID'                            10510000
105200                                    TO DP013-PARAGRAPH            10520000
105300             MOVE 'UNABLE TO RETURN TO TRANID'                    10530000
105400                                    TO DP013-MESSAGE-TEXT (1)     10540000
105500             SET DP013-CICS-ABEND   TO TRUE                       10550000
105600             SET DP013-NO-ROLLBACK  TO TRUE                       10560000
105700             PERFORM 9999-WRITE-CICS-LOG-MSG                      10570000
105800     END-EVALUATE.                                                10580000
105900*                                                                 10590000
106000                                                                  10600000
106100 8210-UPDATE-SHPUNT.                                              10610000
106200                                                                  10620000
106300     EXEC SQL                                                     10630000
106400         UPDATE SUT_OTBND_CART                                    10640000
106500             SET ACTV_IND      = :PV-ACTV-IND                     10650000
106600         ,   PRNT_CART_ID = :PV-NEXT-SHIPT-UNT-ID                 10660000
106700         WHERE                                                    10670000
106800             SHIPT_UNT_ID = :SUT00024-SHIPT-UNT-ID                10680000
106900     END-EXEC.                                                    10690000
107000                                                                  10700000
107100     EVALUATE TRUE                                                10710000
107200         WHEN SQLCODE = ZERO                                      10720000
107300             CONTINUE                                             10730000
107400         WHEN SQLWARN0 NOT = SPACES                               10740000
107500         WHEN SQLCODE NOT EQUAL ZERO                              10750000
107600             MOVE '8210-UPDATE-SHPUNT'                            10760000
107700                              TO DP013-PARAGRAPH                  10770000
107800             MOVE 'SUKCS557 - UPDATE TSHPUNT ROW'                 10780000
107900                              TO DP013-MESSAGE-TEXT (1)           10790000
108000              MOVE PV-NEXT-SHIPT-UNT-ID                           10800000
108100                              TO PV-DISP-SHIPT-UNT-ID             10810000
108200              MOVE PV-DISP-SHIPT-UNT-ID                           10820000
108300                              TO DP013-MESSAGE-TEXT (2)           10830000
108400              MOVE SQLCA      TO DP013-SQLCA                      10840000
108500              MOVE SQLCODE    TO PV-DISPLAY-SQLCODE               10850000
108600              MOVE PV-DISPLAY-SQLCODE                             10860000
108700                              TO DP013-MESSAGE-TEXT (3)           10870000
108800              MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)         10880000
108900              SET DP013-DB2-ABEND                                 10890000
109000                  DP013-ROLLBACK       TO TRUE                    10900000
109100              PERFORM 9999-WRITE-CICS-LOG-MSG                     10910000
109200     END-EVALUATE.                                                10920000
109300                                                                  10930000
109400                                                                  10940000
109500 8230-INACT-TSUCRDV.                                              10950000
109600                                                                  10960000
109700     EXEC SQL                                                     10970000
109800         UPDATE TSUCRDV                                           10980000
109900             SET ACTV_CDE          = 'I'                          10990000
110000         WHERE                                                    11000000
110100             SHIPT_UNT_ID = :SUT00024-SHIPT-UNT-ID                11010000
110200     END-EXEC.                                                    11020000
110300                                                                  11030000
110400     EVALUATE TRUE                                                11040000
110500         WHEN SQLCODE = ZERO                                      11050000
110600         WHEN SQLCODE = +100                                      11060000
110700             CONTINUE                                             11070000
110800         WHEN SQLWARN0 NOT = SPACES                               11080000
110900         WHEN SQLCODE NOT EQUAL ZERO                              11090000
111000             MOVE '8230-INACT-TSUCRDV'                            11100000
111100                              TO DP013-PARAGRAPH                  11110000
111200             MOVE 'SUKCS557 - UPDATE TSUCRDV ROW'                 11120000
111300                              TO DP013-MESSAGE-TEXT (1)           11130000
111400              MOVE SUT00024-SHIPT-UNT-ID                          11140000
111500                              TO PV-DISP-SHIPT-UNT-ID             11150000
111600              MOVE PV-DISP-SHIPT-UNT-ID                           11160000
111700                              TO DP013-MESSAGE-TEXT (2)           11170000
111800              MOVE SQLCODE    TO PV-DISPLAY-SQLCODE               11180000
111900              MOVE PV-DISPLAY-SQLCODE                             11190000
112000                              TO DP013-MESSAGE-TEXT (3)           11200000
112100              MOVE SQLCA      TO DP013-SQLCA                      11210000
112200              MOVE 'TSUCRDV ' TO DP013-DB2-TABLE-NAME (1)         11220000
112300              SET DP013-DB2-ABEND                                 11230000
112400                  DP013-ROLLBACK       TO TRUE                    11240000
112500              PERFORM 9999-WRITE-CICS-LOG-MSG                     11250000
112600     END-EVALUATE.                                                11260000
112700                                                                  11270000
112800 8250-SELECT-TSHPUNT.                                             11280000
112900                                                                  11290000
113000     MOVE '8250-SELECT-TSHPUNT'                                   11300000
113100                                 TO DP013-PARAGRAPH.              11310000
113200     MOVE PV-CTN-N                    TO DK-SHIPT-UNT-ID.         11320000
113300                                                                  11330000
113400     EXEC SQL                                                     11340000
113500         SELECT                                                   11350000
113600              SHIPT_UNT_ID                                        11360000
113700         ,    ORGN_LOC_NBR                                        11370000
113800         ,    DEST_LOC_NBR                                        11380000
113900         ,    CART_SRC_CDE                                        11390000
114000         ,    MSTR_CART_IND                                       11400000
114100         ,    PRNT_CART_ID                                        11410000
114110         ,    ORIG_CART_ID                                        11411000
114120         ,    ACTV_IND                                            11412000
114130         ,    CRE_DTE                                             11413000
114140         ,    CRE_TM                                              11414000
114150         ,    CRE_USR_ID                                          11415000
114160         ,    CRE_PGM_NM                                          11416000
114170         ,    CART_RVSN_NBR                                       11417000
114180         ,    CART_TYP_CDE                                        11418000
114190         ,    LBL_PRT_SEQ_NBR                                     11419000
114200           INTO                                                   11420000
114201             :SUT00024-SHIPT-UNT-ID                               11420100
114202         ,   :SUT00024-ORGN-LOC-NBR                               11420200
114203         ,   :SUT00024-DEST-LOC-NBR                               11420300
114204         ,   :SUT00024-CART-SRC-CDE                               11420400
114205         ,   :SUT00024-MSTR-CART-IND                              11420500
114206         ,   :SUT00024-PRNT-CART-ID                               11420600
114207         ,   :SUT00024-ORIG-CART-ID                               11420700
114208         ,   :SUT00024-ACTV-IND                                   11420800
114209         ,   :SUT00024-CRE-DTE                                    11420900
114210         ,   :SUT00024-CRE-TM                                     11421000
114211         ,   :SUT00024-CRE-USR-ID                                 11421100
114212         ,   :SUT00024-CRE-PGM-NM                                 11421200
114213         ,   :SUT00024-CART-RVSN-NBR                              11421300
114214         ,   :SUT00024-CART-TYP-CDE                               11421400
114215         ,   :SUT00024-LBL-PRT-SEQ-NBR                            11421500
114216           FROM SUT_OTBND_CART                                    11421600
114217         WHERE                                                    11421700
114218             SHIPT_UNT_ID = :DK-SHIPT-UNT-ID                      11421800
114219     END-EXEC.                                                    11421900
114220                                                                  11422000
114230     EVALUATE TRUE                                                11423000
114240         WHEN SQLCODE = ZERO                                      11424000
114250              SET PS-SHPUNT-FOUND-YES TO TRUE                     11425000
114260         WHEN SQLCODE = +100                                      11426000
114270              SET PS-SHPUNT-FOUND-NO  TO TRUE                     11427000
114280         WHEN SQLWARN0 NOT = SPACE                                11428000
114290         WHEN SQLCODE  NOT = ZERO                                 11429000
114300              MOVE '8250-SELECT-TSHPUNT'                          11430000
114400                              TO DP013-PARAGRAPH                  11440000
114500              MOVE 'UNSUCCESSFUL SELECT ON TSHPUNT  '             11450000
114600                              TO DP013-MESSAGE-TEXT (1)           11460000
114700              MOVE PV-SHIPT-UNT-ID                                11470000
114800                              TO DP013-MESSAGE-TEXT (2)           11480000
114900              MOVE SQLCA      TO DP013-SQLCA                      11490000
115000              MOVE SQLCODE      TO PV-DISPLAY-SQLCODE             11500000
115100              MOVE PV-DISPLAY-SQLCODE                             11510000
115200                              TO DP013-MESSAGE-TEXT (3)           11520000
115300              MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)         11530000
115400              SET DP013-DB2-ABEND                                 11540000
115500                  DP013-ROLLBACK       TO TRUE                    11550000
115600              PERFORM 9999-WRITE-CICS-LOG-MSG                     11560000
115700     END-EVALUATE.                                                11570000
115800*                                                                 11580000
115900                                                                  11590000
116000 8300-PROCESS-CHILDREN.                                           11600000
116100     PERFORM 8400-OPEN-CHILD-CSR.                                 11610000
116200     PERFORM 8500-FETCH-CHILD-CSR.                                11620000
116300     PERFORM 5600-POPULATE-FIELDS.                                11630000
116400     PERFORM UNTIL PS-END-OF-CHILD                                11640000
116500         MOVE PV-SUT00024-SHIPT-UNT-ID TO  SUCRDV-SHIPT-UNT-ID    11650000
116600                                           PV-SHIPT-UNT-ID        11660000
116700         MOVE '00'                     TO PV-CONTAINER-00         11670000
116800         MOVE SPACES                   TO PV-CONTAINER-SPACES     11680000
116900         MOVE PV-CONTAINER-ID          TO SUCRDV-BRCDE-NBR        11690000
117000         PERFORM 3000-INSERT-TSUCRDV                              11700000
117100         MOVE 0                        TO PV-NEXT-SHIPT-UNT-ID    11710000
117200         MOVE PV-SUT00024-SHIPT-UNT-ID TO SUT00024-SHIPT-UNT-ID   11720000
117300         PERFORM 8210-UPDATE-SHPUNT                               11730000
117400         PERFORM 8500-FETCH-CHILD-CSR                             11740000
117500     END-PERFORM.                                                 11750000
117600     PERFORM 8600-CLOSE-CHILD-CSR.                                11760000
117700                                                                  11770000
117800 8400-OPEN-CHILD-CSR.                                             11780000
117900                                                                  11790000
118000     EXEC SQL                                                     11800000
118100         OPEN CHILD-CSR                                           11810000
118200     END-EXEC.                                                    11820000
118300                                                                  11830000
118400     EVALUATE TRUE                                                11840000
118500         WHEN SQLCODE = ZERO                                      11850000
118600             SET PS-ALL-CHILD         TO TRUE                     11860000
118700         WHEN SQLWARN0 NOT = SPACES                               11870000
118800         WHEN SQLCODE NOT EQUAL ZERO                              11880000
118900             MOVE '8400-OPEN-CHILD-CSR'                           11890000
119000                              TO DP013-PARAGRAPH                  11900000
119100             MOVE 'SUKCS557 - FIND ALL CHILDREN'                  11910000
119200                              TO DP013-MESSAGE-TEXT (1)           11920000
119300              MOVE DK-SHIPT-UNT-ID                                11930000
119400                              TO PV-DISP-SHIPT-UNT-ID             11940000
119500              MOVE PV-DISP-SHIPT-UNT-ID                           11950000
119600                              TO DP013-MESSAGE-TEXT (2)           11960000
119700              MOVE SQLCA      TO DP013-SQLCA                      11970000
119800              MOVE SQLCODE    TO PV-DISPLAY-SQLCODE               11980000
119900              MOVE PV-DISPLAY-SQLCODE                             11990000
120000                              TO DP013-MESSAGE-TEXT (3)           12000000
120100              MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)         12010000
120200              SET DP013-DB2-ABEND                                 12020000
120300                  DP013-ROLLBACK       TO TRUE                    12030000
120400              PERFORM 9999-WRITE-CICS-LOG-MSG                     12040000
120500     END-EVALUATE.                                                12050000
120600                                                                  12060000
120700 8500-FETCH-CHILD-CSR.                                            12070000
120800                                                                  12080000
120900     EXEC SQL                                                     12090000
121000         FETCH CHILD-CSR                                          12100000
121100         INTO                                                     12110000
121200             :PV-SUT00024-SHIPT-UNT-ID                            12120000
121300          ,  :SUT00024-DEST-LOC-NBR                               12130000
121400     END-EXEC.                                                    12140000
121500                                                                  12150000
121600     EVALUATE TRUE                                                12160000
121700         WHEN SQLCODE = ZERO                                      12170000
121800             CONTINUE                                             12180000
121900         WHEN SQLCODE = +100                                      12190000
122000             SET PS-END-OF-CHILD      TO TRUE                     12200000
122100         WHEN SQLWARN0 NOT = SPACES                               12210000
122200         WHEN SQLCODE NOT EQUAL ZERO                              12220000
122300             MOVE '8500-FETCH-CHILD-CSR'                          12230000
122400                              TO DP013-PARAGRAPH                  12240000
122500             MOVE 'SUKCS557 - FETCH A CHILD'                      12250000
122600                              TO DP013-MESSAGE-TEXT (1)           12260000
122700              MOVE DK-SHIPT-UNT-ID                                12270000
122800                              TO PV-DISP-SHIPT-UNT-ID             12280000
122900              MOVE PV-DISP-SHIPT-UNT-ID                           12290000
123000                              TO DP013-MESSAGE-TEXT (2)           12300000
123100              MOVE SQLCA      TO DP013-SQLCA                      12310000
123200              MOVE SQLCODE    TO PV-DISPLAY-SQLCODE               12320000
123300              MOVE PV-DISPLAY-SQLCODE                             12330000
123400                              TO DP013-MESSAGE-TEXT (3)           12340000
123500              MOVE 'SUT00024' TO DP013-DB2-TABLE-NAME (1)         12350000
123600              SET DP013-DB2-ABEND                                 12360000
123700                  DP013-ROLLBACK       TO TRUE                    12370000
123800              PERFORM 9999-WRITE-CICS-LOG-MSG                     12380000
123900     END-EVALUATE.                                                12390000
124000                                                                  12400000
124100                                                                  12410000
124200 8600-CLOSE-CHILD-CSR.                                            12420000
124300                                                                  12430000
124400     EXEC SQL                                                     12440000
124500         CLOSE CHILD-CSR                                          12450000
124600     END-EXEC.                                                    12460000
124700                                                                  12470000
124800     EVALUATE TRUE                                                12480000
124900         WHEN SQLCODE = ZERO                                      12490000
125000             CONTINUE                                             12500000
125100         WHEN SQLWARN0 NOT = SPACES                               12510000
125200         WHEN SQLCODE NOT EQUAL ZERO                              12520000
125300             MOVE '8600-CLOSE-CHILD-CSR'                          12530000
125400                              TO DP013-PARAGRAPH                  12540000
125500             MOVE 'SUKCS557 - CLOSE CHILD CURSOR'                 12550000
125600                              TO DP013-MESSAGE-TEXT (1)           12560000
125700             MOVE DK-SHIPT-UNT-ID                                 12570000
125800                              TO PV-DISP-SHIPT-UNT-ID             12580000
125900             MOVE PV-DISP-SHIPT-UNT-ID                            12590000
126000                              TO DP013-MESSAGE-TEXT (2)           12600000
126100             MOVE SQLCA       TO DP013-SQLCA                      12610000
126200             MOVE SQLCODE    TO PV-DISPLAY-SQLCODE                12620000
126300             MOVE PV-DISPLAY-SQLCODE                              12630000
126400                              TO DP013-MESSAGE-TEXT (3)           12640000
126500             MOVE 'SUT00024'  TO DP013-DB2-TABLE-NAME (1)         12650000
126600             SET DP013-DB2-ABEND                                  12660000
126700                 DP013-ROLLBACK       TO TRUE                     12670000
126800              PERFORM 9999-WRITE-CICS-LOG-MSG                     12680000
126900     END-EVALUATE.                                                12690000
127000                                                                  12700000
127100 9999-WRITE-CICS-LOG-MSG.                                         12710000
127200     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            12720000
127300     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           12730000
127400     INITIALIZE DP013-SRC-TASK-NUMBER                             12740000
127500                DP013-STACK.                                      12750000
127600     SET DP013-LINK-RETURN           TO TRUE.                     12760000
127700                                                                  12770000
127800     EXEC CICS                                                    12780000
127900         LINK                                                     12790000
128000             PROGRAM   (DP013-NAME)                               12800000
128100             COMMAREA  (DP013-PARAMETERS)                         12810000
128200             LENGTH    (DP013-LENGTH)                             12820000
128300     END-EXEC.                                                    12830000
128400                                                                  12840000
128500*-----------------------------------------------------*           12850000
128600* WRITE TO SYSOUT                                                 12860000
128700*-----------------------------------------------------*           12870000
128800 9990-WRITE-LOG.                                                  12880000
128900                                                                  12890000
129000     DISPLAY PV-LOG-MSG-AREA.                                     12900000
129100*----------------------------------------------------------------*12910000
129200*    ABEND PROCESSOR MODULE                                      *12920000
129300*----------------------------------------------------------------*12930000
129400                                                                  12940000
129500     COPY DPPD014.                                                12950000
129600                                                                  12960000
