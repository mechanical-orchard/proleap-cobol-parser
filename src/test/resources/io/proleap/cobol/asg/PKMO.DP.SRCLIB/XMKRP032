000200 IDENTIFICATION DIVISION.                                         00010000
000300 PROGRAM-ID.         XMKRP032.                                    00020000
000400 AUTHOR.             BOB MCASEY.                                  00030000
000500 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000600 DATE-WRITTEN.       02-10-2003.                                  00050000
000700 DATE-COMPILED.                                                   00060000
000800*                                                                 00070000
000900******************************************************************00080000
001000*  COMPARES DATA FROM DOMAIN TABLES AND RMS DISTRICT              00090000
001100*  FOR THE XMT_DIST.                                              00100000
001200******************************************************************00110000
      *---------------------------------------------------------------* 00120003
      *    WR/PITS#     DATE        DESCRIPTION                       * 00130003
      *    --------   ----------   ---------------------------------  * 00140003
      *    WR24442    08/20/2003   INITIAL CREATION.                  * 00150003
      *---------------------------------------------------------------* 00160003
001300                                                                  00170000
001400 ENVIRONMENT DIVISION.                                            00180000
001500                                                                  00190000
001600 CONFIGURATION SECTION.                                           00200000
001700                                                                  00210000
001800 SOURCE-COMPUTER.    IBM-3090.                                    00220000
001900 OBJECT-COMPUTER.    IBM-3090.                                    00230000
002000                                                                  00240000
002100 INPUT-OUTPUT SECTION.                                            00250000
002200                                                                  00260000
002300 FILE-CONTROL.                                                    00270000
002400                                                                  00280000
002500     SELECT XMT-INPUT-FILE       ASSIGN TO INP01.                 00290000
002600     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00300000
002700     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00310000
002800                                                                  00320000
002900 DATA DIVISION.                                                   00330000
003000                                                                  00340000
003100 FILE SECTION.                                                    00350000
003200                                                                  00360000
003300 FD  RMS-INPUT-FILE                                               00370000
003400     RECORDING MODE IS F                                          00380000
003500     BLOCK CONTAINS 0 RECORDS                                     00390000
003600     LABEL RECORDS ARE OMITTED.                                   00400000
003700 01  RMS-INPUT-RECORD                    PIC  X(62).              00410000
003800                                                                  00420000
003900 FD  XMT-INPUT-FILE                                               00430000
004000     RECORDING MODE IS F                                          00440000
004100     BLOCK CONTAINS 0 RECORDS                                     00450000
004200     LABEL RECORDS ARE OMITTED.                                   00460000
004300 01  XMT-INPUT-RECORD                    PIC  X(62).              00470000
004400                                                                  00480000
004500 FD  ERROR-REPORT                                                 00490000
004600     RECORDING MODE IS F                                          00500000
004700     BLOCK CONTAINS 0 RECORDS                                     00510000
004800     LABEL RECORDS ARE OMITTED.                                   00520000
004900 01  ERR-RPT-LINE                        PIC  X(200).             00530000
005000                                                                  00540000
005100 WORKING-STORAGE SECTION.                                         00550000
005200                                                                  00560000
006100                                                                  00570000
006200 01 PC-PROGRAM-CONSTANTS.                                         00580000
006300     05 PC-PGM-NAME           PIC X(08)  VALUE 'XMKRP032'.        00590000
006400                                                                  00600000
006500 01 PV-PROGRAM-VARIABLES.                                         00610000
006600     05 PV-XMT-KEY.                                               00620000
006700        10 PV-XMT-DIST-NBR       PIC 9(04).                       00630000
006710     05 PV-XMT-DIST-REGN-NBR     PIC 9(04).                       00640000
006800     05 PV-XMT-DIST-NM           PIC X(20) VALUE SPACE.           00650000
006900     05 PV-XMT-DIST-MGR-NM       PIC X(32) VALUE SPACE.           00660000
007000                                                                  00670000
007100     05 PV-RMS-KEY.                                               00680000
007200         10 PV-RMS-DIST-NBR       PIC 9(04).                      00690000
007210     05 PV-RMS-DIST-REGN-NBR      PIC 9(04).                      00700000
007300     05 PV-RMS-DIST-NM            PIC X(20) VALUE SPACE.          00710000
007400     05 PV-RMS-DIST-MGR-NM        PIC X(32) VALUE SPACE.          00720000
007500                                                                  00730000
007600     05 PV-PAGE-CNT               PIC S9(05)  VALUE ZERO.         00740000
007700     05 PV-LINE-CNT               PIC S9(04)  COMP VALUE ZERO.    00750000
007800     05 PV-MAX-LINES              PIC S9(04)  COMP VALUE +71.     00760000
007900                                                                  00770000
008000     05 PV-DISPLAY-CNT            PIC ZZZZ9.                      00780000
008100     05 PV-NBR-ERRORS             PIC S9(04)  COMP                00790000
008200                                                VALUE ZERO.       00800000
008300     05 PV-DATE-YYMMDD.                                           00810000
008400          10 PV-YYMMDD-YY       PIC X(02)  VALUE SPACE.           00820000
008500          10 PV-YYMMDD-MM       PIC X(02)  VALUE SPACE.           00830000
008600          10 PV-YYMMDD-DD       PIC X(02)  VALUE SPACE.           00840000
008700     05 PV-TIME-HHMMSS.                                           00850000
008800          10 PV-HHMMSS-HH       PIC X(02)  VALUE SPACE.           00860000
008900          10 PV-HHMMSS-MM       PIC X(02)  VALUE SPACE.           00870000
009000          10 PV-HHMMSS-SS       PIC X(02)  VALUE SPACE.           00880000
009100     05 PV-MESSAGE              PIC X(58)  VALUE SPACE.           00890000
009200                                                                  00900000
009300 01 RPT-TOTAL-LINE.                                               00910000
009400     05 FILLER     PIC  X(23) VALUE                               00920000
009500                         'TOTAL NUMBER OF ERRORS '.               00930000
009600     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00940000
009700                                                                  00950000
009800 01 RPT-END-OF-REPORT-LINE.                                       00960000
009900     05 FILLER     PIC  X(21) VALUE                               00970000
010000                            '*** END OF REPORT ***'.              00980000
010100 01 PA-PROGRAM-ACCUMULATORS.                                      00990000
010200     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              01000000
010300     05 PA-XMT-RECS-READ       PIC 9(13) VALUE ZERO.              01010000
010400     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              01020000
010500                                                                  01030000
010600 01 PS-PROGRAM-SWITCHES.                                          01040000
010700     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01050000
010800         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           01060000
010900         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           01070000
011000     05 PS-MORE-XMT-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           01080000
011100         88 PS-MORE-XMT-INPUT-RECS           VALUE 'Y'.           01090000
011200         88 PS-END-OF-XMT-INPUT-RECS         VALUE 'N'.           01100000
011300     05 PS-RMS-OR-XMT-ERR        PIC X(01)   VALUE '0'.           01110000
011400         88 PS-RMS-ERROR                     VALUE '1'.           01120000
011500         88 PS-XMT-ERROR                     VALUE '2'.           01130000
011600         88 PS-DATA-ERROR                    VALUE '3'.           01140000
011700                                                                  01150000
011800 01 RPT-REPORT-HEADING.                                           01160000
011900     05 FILLER     PIC  X(84)    VALUE SPACES.                    01170000
012000     05 FILLER     PIC  X(37)    VALUE                            01180000
012100         'XM DISTRICT DATA INTEGRITY ERRORS'.                     01190000
012200                                                                  01200000
012300 01 RPT-COL-HEADING-1.                                            01210000
012400     05 FILLER     PIC  X(01) VALUE SPACE.                        01220000
012500     05 FILLER     PIC  X(01) VALUE ALL '-'.                      01230000
012600     05 FILLER     PIC  X(03) VALUE 'KEY'.                        01240000
012700     05 FILLER     PIC  X(01) VALUE ALL '-'.                      01250000
012800                                                                  01260000
012900 01 RPT-COL-HEADING-2.                                            01270000
013000     05 FILLER     PIC  X(23) VALUE SPACE.                        01280000
013300     05 FILLER     PIC  X(34) VALUE 'XM DOMAIN'.                  01290001
013400     05 FILLER     PIC  X(24) VALUE SPACE.                        01300000
013500     05 FILLER     PIC  X(41) VALUE                               01310001
013500       'RETEK MANAMGMENT SYSTEM - RMS'.                           01320001
013800                                                                  01330000
013900 01 RPT-COL-HEADING-3.                                            01340000
014000     05 FILLER     PIC  X(01) VALUE SPACE.                        01350000
014010     05 FILLER     PIC  X(04) VALUE 'DIST'.                       01360000
014020     05 FILLER     PIC  X(04) VALUE SPACE.                        01370000
014021     05 FILLER     PIC  X(04) VALUE 'REGN'.                       01380000
014030     05 FILLER     PIC  X(02) VALUE SPACE.                        01390000
014040     05 FILLER     PIC  X(04) VALUE 'DIST'.                       01400000
014050     05 FILLER     PIC  X(18) VALUE SPACE.                        01410000
014100     05 FILLER     PIC  X(04) VALUE 'DIST'.                       01420000
014200     05 FILLER     PIC  X(30) VALUE SPACE.                        01430000
014300     05 FILLER     PIC  X(04) VALUE 'REGN'.                       01440000
014400     05 FILLER     PIC  X(02) VALUE SPACE.                        01450000
014500     05 FILLER     PIC  X(04) VALUE 'DIST'.                       01460000
014600     05 FILLER     PIC  X(18) VALUE SPACE.                        01470000
014700     05 FILLER     PIC  X(04) VALUE 'DIST'.                       01480000
014800                                                                  01490000
014900 01 RPT-COL-HEADING-4.                                            01500000
015010     05 FILLER     PIC  X(01) VALUE SPACE.                        01510000
015020     05 FILLER     PIC  X(04) VALUE '_NBR'.                       01520000
015030     05 FILLER     PIC  X(04) VALUE SPACE.                        01530000
015040     05 FILLER     PIC  X(04) VALUE '_NBR'.                       01540000
015050     05 FILLER     PIC  X(02) VALUE SPACE.                        01550000
015060     05 FILLER     PIC  X(03) VALUE '_NM'.                        01560000
015070     05 FILLER     PIC  X(19) VALUE SPACE.                        01570000
015080     05 FILLER     PIC  X(07) VALUE '_MGR_NM'.                    01580000
015090     05 FILLER     PIC  X(27) VALUE SPACE.                        01590000
015091     05 FILLER     PIC  X(04) VALUE '_NBR'.                       01600000
015092     05 FILLER     PIC  X(02) VALUE SPACE.                        01610000
015093     05 FILLER     PIC  X(03) VALUE '_NM'.                        01620000
015094     05 FILLER     PIC  X(19) VALUE SPACE.                        01630000
015095     05 FILLER     PIC  X(07) VALUE '_MGR_NM'.                    01640000
015096     05 FILLER     PIC  X(27) VALUE SPACE.                        01650000
015097     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    01660000
015100                                                                  01670000
015110 01 RPT-COL-HEADING-5.                                            01680000
015120     05 FILLER     PIC X(175) VALUE ALL '-'.                      01690000
015130                                                                  01700000
015200 01 DL-DETAIL-LINE.                                               01710000
015300     05 FILLER                PIC  X(01) VALUE SPACE.             01720000
015400     05 DL-DIST-NBR           PIC  X(04) VALUE SPACE.             01730000
015500     05 FILLER                PIC  X(04) VALUE SPACE.             01740000
015600     05 DL-XMT-DIST-REGN-NBR  PIC  X(04) VALUE SPACE.             01750000
015700     05 FILLER                PIC  X(02) VALUE SPACE.             01760000
015800     05 DL-XMT-DIST-NM        PIC  X(20) VALUE SPACE.             01770000
015900     05 FILLER                PIC  X(02) VALUE SPACE.             01780000
016000     05 DL-XMT-DIST-MGR-NM    PIC  X(32) VALUE SPACE.             01790000
016100     05 FILLER                PIC  X(02) VALUE SPACE.             01800000
016200     05 DL-RMS-DIST-REGN-NBR  PIC  X(04) VALUE SPACE.             01810000
016300     05 FILLER                PIC  X(02) VALUE SPACE.             01820000
016400     05 DL-RMS-DIST-NM        PIC  X(20) VALUE SPACE.             01830000
016410     05 FILLER                PIC  X(02) VALUE SPACE.             01840000
016420     05 DL-RMS-DIST-MGR-NM    PIC  X(32) VALUE SPACE.             01850000
016430     05 FILLER                PIC  X(02) VALUE SPACE.             01860000
016440     05 DL-MESSAGE            PIC  X(53) VALUE SPACE.             01870000
016500                                                                  01880000
005700 01 XMT-REC.                                                      01890000
005800     05 XMT-DIST-NBR          PIC S9(04)  COMP-3.                 01900000
005820     05 XMT-DIST-REGN-NBR     PIC S9(04)  COMP-3.                 01910000
005900     05 XMT-DIST-NM           PIC X(20) VALUE SPACE.              01920000
006000     05 XMT-DIST-MGR-NM       PIC X(32) VALUE SPACE.              01930000
                                                                        01940000
005300     COPY HORD007.                                                01950002
005400                                                                  01960000
005500     COPY DPWS200O.                                               01970002
005600                                                                  01980000
016510******************************************************************01990000
016600 PROCEDURE DIVISION.                                              02000000
016610******************************************************************02010000
016700                                                                  02020000
016800 0000-MAIN-MODULE.                                                02030000
016900                                                                  02040000
017000       OPEN INPUT RMS-INPUT-FILE                                  02050000
017100                  XMT-INPUT-FILE                                  02060000
017200            OUTPUT ERROR-REPORT.                                  02070000
017300                                                                  02080000
017400       PERFORM 1000-INITIALIZE.                                   02090000
017500       PERFORM 7000-READ-XMT-INPUT-FILE.                          02100000
017600       PERFORM 7100-READ-RMS-INPUT-FILE.                          02110000
017700                                                                  02120000
017800       PERFORM 2000-PROCESS-RECS                                  02130000
017900          UNTIL (PS-END-OF-XMT-INPUT-RECS                         02140000
018000            AND PS-END-OF-RMS-INPUT-RECS).                        02150000
018100                                                                  02160000
018200       PERFORM 8400-WRITE-TOTALS.                                 02170000
018300                                                                  02180000
018400       CLOSE RMS-INPUT-FILE                                       02190000
018500             XMT-INPUT-FILE                                       02200000
018600             ERROR-REPORT.                                        02210000
018700                                                                  02220000
018800       DISPLAY '**** XMKRP032 STATISTICS ****'                    02230000
018900       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     02240000
019000       DISPLAY 'TOTAL XMT RECORDS READ : ' PA-XMT-RECS-READ.      02250000
019100       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      02260000
019200       DISPLAY ' '                                                02270000
019300                                                                  02280000
019400       STOP RUN.                                                  02290000
019500                                                                  02300000
019600 1000-INITIALIZE.                                                 02310000
019700                                                                  02320000
019800       ACCEPT PV-DATE-YYMMDD FROM DATE.                           02330000
019900       MOVE PV-YYMMDD-YY TO DP200O-RUN-YEAR.                      02340000
020000       MOVE PV-YYMMDD-MM TO DP200O-RUN-MONTH.                     02350000
020100       MOVE PV-YYMMDD-DD TO DP200O-RUN-DAY.                       02360000
020200                                                                  02370000
020300       ACCEPT PV-TIME-HHMMSS FROM TIME.                           02380000
020400       MOVE PV-HHMMSS-HH TO DP200O-RUN-HOUR.                      02390000
020500       MOVE PV-HHMMSS-MM TO DP200O-RUN-MINUTE.                    02400000
020600       MOVE PC-PGM-NAME  TO DP200O-PROGRAM-NAME.                  02410000
020700       MOVE 1            TO DP200O-REPORT-NUMBER.                 02420000
020800                                                                  02430000
020900       PERFORM 8100-WRITE-STD-RPT-HEADING.                        02440000
021000       PERFORM 8200-WRITE-REPORT-HEADING.                         02450000
021100       PERFORM 8300-WRITE-COLUMN-HEADING.                         02460000
021200                                                                  02470000
021300 2000-PROCESS-RECS.                                               02480000
021400                                                                  02490000
021500       MOVE HO007-DIST-NBR      TO  PV-RMS-DIST-NBR.              02500000
021510       MOVE HO007-DIST-REGN-NBR TO  PV-RMS-DIST-REGN-NBR.         02510000
021600       MOVE HO007-DIST-NM       TO  PV-RMS-DIST-NM.               02520000
021700       MOVE HO007-DIST-MGR-NM   TO  PV-RMS-DIST-MGR-NM.           02530000
021800                                                                  02540000
021900       MOVE XMT-DIST-NBR        TO  PV-XMT-DIST-NBR.              02550000
021910       MOVE XMT-DIST-REGN-NBR   TO  PV-XMT-DIST-REGN-NBR.         02560000
022000       MOVE XMT-DIST-NM         TO  PV-XMT-DIST-NM.               02570000
022100       MOVE XMT-DIST-MGR-NM     TO  PV-XMT-DIST-MGR-NM.           02580000
022200                                                                  02590000
022300     IF PV-XMT-KEY = PV-RMS-KEY                                   02600000
022400****** KEYS ON BOTH RMS AND XMT, CONTINUE PROCESSING ******       02610000
022500        PERFORM 3000-COMPARE-FIELDS                               02620000
022600        PERFORM 7000-READ-XMT-INPUT-FILE                          02630000
022700        PERFORM 7100-READ-RMS-INPUT-FILE                          02640000
022800      ELSE                                                        02650000
022900          IF ((PV-RMS-KEY < PV-XMT-KEY)                           02660000
023000             OR PS-END-OF-XMT-INPUT-RECS) AND                     02670000
023100             PS-MORE-RMS-INPUT-RECS                               02680000
023200             MOVE '1' TO PS-RMS-OR-XMT-ERR                        02690000
023300             MOVE 'KEY ON RMS DISTRICT TABLE ONLY'                02700000
023400                 TO PV-MESSAGE                                    02710000
023500             PERFORM 8000-WRITE-REPORT-LN                         02720000
023600             PERFORM 7100-READ-RMS-INPUT-FILE                     02730000
023700          ELSE                                                    02740000
023800              IF (PV-RMS-KEY > PV-XMT-KEY                         02750000
023900                   OR PS-END-OF-RMS-INPUT-RECS)                   02760000
024000                  AND PS-MORE-XMT-INPUT-RECS                      02770000
024100                  MOVE '2' TO PS-RMS-OR-XMT-ERR                   02780000
024200                  MOVE 'KEY ON XM DOMAIN DISTRICT TABLE ONLY'     02790000
024210                      TO PV-MESSAGE                               02800000
024300                  PERFORM 8000-WRITE-REPORT-LN                    02810000
024400                  PERFORM 7000-READ-XMT-INPUT-FILE                02820000
024500              END-IF                                              02830000
024600          END-IF                                                  02840000
024700      END-IF.                                                     02850000
024800                                                                  02860000
024900 3000-COMPARE-FIELDS.                                             02870000
025000                                                                  02880000
025100      EVALUATE TRUE                                               02890000
025200         WHEN PV-RMS-DIST-REGN-NBR NOT = PV-XMT-DIST-REGN-NBR     02900000
025300             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02910000
025400             MOVE 'DISTRICT REGION NUMBER DOES NOT MATCH'         02920000
025500                                                TO PV-MESSAGE     02930000
025600             PERFORM 8000-WRITE-REPORT-LN                         02940000
025610         WHEN PV-RMS-DIST-NM    NOT = PV-XMT-DIST-NM              02950000
025620             MOVE '3' TO PS-RMS-OR-XMT-ERR                        02960000
025630             MOVE 'DISTRICT NAME DOES NOT MATCH'                  02970002
025640                                                TO PV-MESSAGE     02980000
025650             PERFORM 8000-WRITE-REPORT-LN                         02990000
025700         WHEN PV-RMS-DIST-MGR-NM  NOT = PV-XMT-DIST-MGR-NM        03000000
025800             MOVE '3' TO PS-RMS-OR-XMT-ERR                        03010000
025900             MOVE 'DISTRICT MANAGER NAME DOES NOT MATCH'          03020000
026000                                                TO PV-MESSAGE     03030000
026100             PERFORM 8000-WRITE-REPORT-LN                         03040000
026200      END-EVALUATE.                                               03050000
026300                                                                  03060000
026400 7000-READ-XMT-INPUT-FILE.                                        03070000
026500                                                                  03080000
026600       INITIALIZE XMT-REC.                                        03090000
026700                                                                  03100000
026800       READ XMT-INPUT-FILE INTO XMT-REC                           03110000
026900           AT END SET PS-END-OF-XMT-INPUT-RECS TO TRUE.           03120000
027000                                                                  03130000
027100       ADD 1 TO PA-XMT-RECS-READ.                                 03140000
027200                                                                  03150000
027300 7100-READ-RMS-INPUT-FILE.                                        03160000
027400                                                                  03170000
027500       INITIALIZE HO007-DISTRICT-DATA.                            03180000
027600                                                                  03190000
027700       READ RMS-INPUT-FILE INTO HO007-DISTRICT-DATA               03200000
027800            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          03210000
027900                                                                  03220000
028000       ADD 1 TO PA-RMS-RECS-READ.                                 03230000
028100                                                                  03240000
028200 8000-WRITE-REPORT-LN.                                            03250000
028400                                                                  03260000
028500       IF PS-RMS-ERROR                                            03270000
028600          MOVE SPACES TO DL-DETAIL-LINE                           03280000
028700          MOVE PV-RMS-DIST-NBR      TO DL-DIST-NBR                03290000
028710          MOVE PV-RMS-DIST-REGN-NBR TO DL-RMS-DIST-REGN-NBR       03300000
028800          MOVE PV-RMS-DIST-NM       TO DL-RMS-DIST-NM             03310000
028900          MOVE PV-RMS-DIST-MGR-NM   TO DL-RMS-DIST-MGR-NM         03320000
029000          MOVE PV-MESSAGE TO DL-MESSAGE                           03330000
029100       ELSE                                                       03340000
029200          IF PS-XMT-ERROR                                         03350000
029300             MOVE SPACES TO DL-DETAIL-LINE                        03360000
029400             MOVE PV-XMT-DIST-NBR      TO DL-DIST-NBR             03370000
029410             MOVE PV-XMT-DIST-REGN-NBR TO DL-XMT-DIST-REGN-NBR    03380000
029500             MOVE PV-XMT-DIST-NM       TO DL-XMT-DIST-NM          03390000
029600             MOVE PV-XMT-DIST-MGR-NM   TO DL-XMT-DIST-MGR-NM      03400000
029700             MOVE PV-MESSAGE TO DL-MESSAGE                        03410000
029800          ELSE                                                    03420000
029900             MOVE SPACES TO DL-DETAIL-LINE                        03430000
030000             MOVE PV-RMS-DIST-NBR      TO DL-DIST-NBR             03440000
030010             MOVE PV-RMS-DIST-REGN-NBR TO DL-RMS-DIST-REGN-NBR    03450000
030100             MOVE PV-RMS-DIST-NM       TO DL-RMS-DIST-NM          03460000
030200             MOVE PV-RMS-DIST-MGR-NM   TO DL-RMS-DIST-MGR-NM      03470000
030300             MOVE PV-XMT-DIST-REGN-NBR TO DL-XMT-DIST-REGN-NBR    03480000
030310             MOVE PV-XMT-DIST-NM       TO DL-XMT-DIST-NM          03490000
030400             MOVE PV-XMT-DIST-MGR-NM   TO DL-XMT-DIST-MGR-NM      03500000
030500             MOVE PV-MESSAGE TO DL-MESSAGE                        03510000
030600          END-IF                                                  03520000
030700       END-IF.                                                    03530000
030800                                                                  03540000
030900       IF PV-LINE-CNT > PV-MAX-LINES                              03550000
031000          PERFORM 8100-WRITE-STD-RPT-HEADING                      03560000
031100          PERFORM 8200-WRITE-REPORT-HEADING                       03570000
031200          PERFORM 8300-WRITE-COLUMN-HEADING                       03580000
031300       END-IF.                                                    03590000
031400                                                                  03600000
031500       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     03610000
031600             AFTER ADVANCING 1 LINE.                              03620000
031700       ADD +1 TO PV-LINE-CNT.                                     03630000
031800       MOVE 4095 TO RETURN-CODE.                                  03640000
031900       ADD 1 TO PA-ERROR-MESSAGES.                                03650000
032000                                                                  03660000
032100 8100-WRITE-STD-RPT-HEADING.                                      03670000
032200                                                                  03680000
032300       ADD 1  TO PV-PAGE-CNT.                                     03690000
032400       MOVE PV-PAGE-CNT TO DP200O-PAGE-NUMBER.                    03700000
032500       WRITE ERR-RPT-LINE FROM DP200O-STANDRD-HEADER-200-COLS     03710000
032600             AFTER ADVANCING PAGE.                                03720000
032700       MOVE +1 TO PV-LINE-CNT.                                    03730000
032800                                                                  03740000
032900 8200-WRITE-REPORT-HEADING.                                       03750000
033000                                                                  03760000
033100       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 03770000
033200            AFTER ADVANCING 1 LINES.                              03780000
033300       ADD +1 TO PV-LINE-CNT.                                     03790000
033400                                                                  03800000
033500 8300-WRITE-COLUMN-HEADING.                                       03810000
033600                                                                  03820000
033700       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  03830000
033800            AFTER ADVANCING 2 LINES.                              03840000
033900       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  03850000
034000            AFTER ADVANCING 1 LINES.                              03860000
034100       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  03870000
034200            AFTER ADVANCING 1 LINES.                              03880000
034300       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  03890000
034400            AFTER ADVANCING 1 LINES.                              03900000
034410       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-5                  03910000
034420            AFTER ADVANCING 1 LINES.                              03920000
034500       ADD +6 TO PV-LINE-CNT.                                     03930000
034600                                                                  03940000
034700 8400-WRITE-TOTALS.                                               03950000
034800                                                                  03960000
034900      IF PV-LINE-CNT > PV-MAX-LINES                               03970000
035000         PERFORM 8100-WRITE-STD-RPT-HEADING                       03980000
035100         PERFORM 8200-WRITE-REPORT-HEADING                        03990000
035200         PERFORM 8300-WRITE-COLUMN-HEADING                        04000000
035300      END-IF.                                                     04010000
035400                                                                  04020000
035500      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    04030000
035600      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      04040000
035700            AFTER ADVANCING 2 LINES.                              04050000
035800      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              04060000
035900            AFTER ADVANCING 1 LINES.                              04070000
036000                                                                  04080000
