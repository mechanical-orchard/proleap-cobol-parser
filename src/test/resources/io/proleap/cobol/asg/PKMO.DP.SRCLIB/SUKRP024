000100 IDENTIFICATION DIVISION.                                         00010001
000200                                                                  00020001
000300 PROGRAM-ID.             SUKRP024.                                00030001
000400 AUTHOR.                 LYNN MCADAMS.                            00040001
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050001
000600 DATE-WRITTEN            FEBRUARY, 2001.                          00060001
000700 DATE-COMPILED.                                                   00070001
000800*                                                                 00080001
000900*---------------------------------------------------------------- 00090001
001000*  THIS PROGRAM WILL PRODUCE A REPORT OF THE DAILY AUDIT OF       00100001
001100*  ADJUSTMENTS MADE TO CARTON CONTENTS.                           00110001
001200*                                                                 00120001
001300*  THE PROGRAM LOOKS TO TCOCNTL FOR THE BATCH PROCESSING DATE.    00130001
001400*  IT THEN LOOKS AT TSUQADJ TO DETERMINE CARTONS THAT HAD A UNIT  00140001
001500*  ADJUSTMENT MADE. IF A CARTON HAS HAD AN ADJUSTMENT, THE PROGRAM00150001
001600*  GETS THE INFORMATION RELATED TO THAT CARTON AND REPORTS IT.    00160001
001700*                                                                 00170001
001800*  THE REPORT WILL BREAK AT DC LOCATION.                          00180001
001900*---------------------------------------------------------------- 00190001
002000*                                                                 00200001
002100 ENVIRONMENT DIVISION.                                            00210001
002200                                                                  00220001
002300 CONFIGURATION SECTION.                                           00230001
002400                                                                  00240001
002500 SOURCE-COMPUTER.        IBM-3090.                                00250001
002600 OBJECT-COMPUTER.        IBM-3090.                                00260001
002700                                                                  00270001
002800 INPUT-OUTPUT SECTION.                                            00280001
002900                                                                  00290001
003000 FILE-CONTROL.                                                    00300001
003100                                                                  00310001
003200     SELECT REPORT-FILE                                           00320001
003300         ASSIGN TO RPT01.                                         00330001
003400                                                                  00340001
003500 DATA DIVISION.                                                   00350001
003600                                                                  00360001
003700 FILE SECTION.                                                    00370001
003800 FD  REPORT-FILE                                                  00380001
003900     RECORDING MODE IS F                                          00390001
004000     LABEL RECORDS ARE STANDARD                                   00400001
004100     BLOCK CONTAINS 0 RECORDS.                                    00410001
004200 01  REPORT-RECORD                   PIC X(132).                  00420001
004300*                                                                 00430001
004400*                                                                 00440001
004500 WORKING-STORAGE SECTION.                                         00450001
004600 01  PROGRAM-SWITCHES.                                            00460001
004700     05  PS-EOF-ADJUSTMENT-SWITCH    PIC X(01) VALUE 'N'.         00470001
004800         88  PS-EOF-ADJUSTMENT-FILE            VALUE 'Y'.         00480001
004900     05  PS-CURSOR-SW                PIC X(01) VALUE 'N'.         00490001
005000         88  PS-CURSOR-OPEN                    VALUE 'Y'.         00500001
005100         88  PS-CURSOR-CLOSED                  VALUE 'N'.         00510001
005200     05  PS-NEW-PAGE-SW              PIC  X(03)    VALUE 'N'.     00520001
005300         88  PS-NEW-PAGE                           VALUE 'Y'.     00530001
005400         88  PS-NOT-NEW-PAGE                       VALUE 'N'.     00540001
005500*                                                                 00550001
005600 01  DK-DB-KEYS.                                                  00560001
005700     05  DK-DC-NBR                   PIC S9(04) COMP VALUE ZERO.  00570001
005800     05  DK-STR-NBR                  PIC S9(04) COMP VALUE ZERO.  00580001
005900     05  DK-SHIPT-UNT-ID             PIC S9(18)V COMP-3.          00590001
006000*                                                                 00600001
006100 01  PC-CONSTANTS.                                                00610001
006200     05  PC-1                        PIC S9(03)    VALUE +1       00620001
006300                                                   COMP-3.        00630001
006400     05  PC-2                        PIC S9(03)    VALUE +2       00640001
006500                                                   COMP-3.        00650001
006600     05  PC-10                       PIC S9(03)    VALUE +10      00660001
006700                                                   COMP-3.        00670001
006800     05  PC-55                       PIC S9(03)    VALUE +55      00680001
006900                                                   COMP-3.        00690001
007000     05  PC-MAX-REPORT-LINES         PIC S9(3) COMP-3 VALUE +60.  00700001
007100     05  PC-SLASH                    PIC  X(01)    VALUE '/'.     00710001
007200     05  PC-DASH                     PIC  X(01)    VALUE '-'.     00720001
007300     05  PC-SPACE                    PIC  X(01)    VALUE ' '.     00730001
007400     05  PC-PROGRAM-NAME             PIC  X(08)    VALUE          00740001
007500         'SUKRP024'.                                              00750001
007600     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.       00760001
007700*                                                                 00770001
007800 01  ABEND-CODE                       PIC S9(04) VALUE ZERO       00780001
007900                                                 COMP SYNC.       00790001
008000     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     00800001
008100*                                                                 00810001
008200 01 PV-VARIABLES.                                                 00820001
008300     05  PV-READ-COUNT                PIC S9(7) COMP-3            00830001
008400                                                VALUE ZERO.       00840001
008500     05  PV-WRITE-COUNT               PIC S9(7) COMP-3            00850001
008600                                                VALUE ZERO.       00860001
008700     05  PV-PAGE-COUNT               PIC S9(04)    VALUE ZERO     00870001
008800                                                   COMP-3.        00880001
008900     05  PV-LINES-USED               PIC S9(03)    VALUE ZERO     00890001
009000                                                   COMP-3.        00900001
009100     05  PV-SPACE-COUNT               PIC S9(05) VALUE ZERO       00910001
009200                                                 COMP-3.          00920001
009300     05  PV-CHAR-COUNT                PIC S9(05) VALUE ZERO       00930001
009400                                                 COMP-3.          00940001
009500     05  PV-DB2-FUNCTION             PIC X(30) VALUE SPACE.       00950001
009600     05  PV-PARAGRAPH                PIC X(30) VALUE SPACE.       00960001
009700     05  PV-PO-RCVR-LINE.                                         00970001
009800         10  PV-PO                   PIC 9(08).                   00980001
009900         10  PV-PO-X REDEFINES PV-PO PIC X(08).                   00990001
010000         10  PV-FIRST-DASH           PIC X(01).                   01000001
010100         10  PV-RCVR                 PIC 9(04).                   01010001
010200         10  PV-RCVR-X REDEFINES PV-RCVR PIC X(04).               01020001
010300         10  PV-SECOND-DASH          PIC X(01).                   01030001
010400         10  PV-LINE                 PIC 9(04).                   01040001
010500         10  PV-LINE-X REDEFINES PV-LINE PIC X(04).               01050001
010600                                                                  01060001
010700 01  PV-CONTROL-KEYS.                                             01070001
010800     05  PV-CURRENT-KEY.                                          01080001
010900         10  PV-CURR-OPER-UNT-ID     PIC 9(04)     VALUE ZERO.    01090001
011000     05  PV-PREVIOUS-KEY.                                         01100001
011100         10  PV-PREV-OPER-UNT-ID     PIC 9(04)     VALUE ZERO.    01110001
011200                                                                  01120001
011300     05  PV-CURR-SHIPT-UNT-ID        PIC X(18) VALUE SPACE.       01130001
011400     05  PV-PREV-SHIPT-UNT-ID        PIC X(18) VALUE SPACE.       01140001
011500     05  PV-CURR-ADJ-USER-ID         PIC X(08) VALUE SPACE.       01150001
011600     05  PV-PREV-ADJ-USER-ID         PIC X(08) VALUE SPACE.       01160001
011700*                                                                 01170001
011800     05  PV-DB2-TIMESTAMP               PIC X(26)   VALUE SPACES. 01180001
011900     05  PV-TMST-R REDEFINES  PV-DB2-TIMESTAMP.                   01190001
012000         10   PV-TMST-CC                PIC X(02).                01200001
012100         10   PV-TMST-YY                PIC X(02).                01210001
012200         10   FILLER                    PIC X(01).                01220001
012300         10   PV-TMST-MM                PIC X(02).                01230001
012400         10   FILLER                    PIC X(01).                01240001
012500         10   PV-TMST-DD                PIC X(02).                01250001
012600         10   FILLER                    PIC X(01).                01260001
012700         10   PV-TMST-HRS               PIC X(02).                01270001
012800         10   FILLER                    PIC X(01).                01280001
012900         10   PV-TMST-MIN               PIC X(02).                01290001
013000         10   FILLER                    PIC X(01).                01300001
013100         10   PV-TMST-SEC               PIC X(02).                01310001
013200         10   FILLER                    PIC X(07).                01320001
013300*                                                                 01330001
013400     05  PV-REPORT-FIELDS.                                        01340001
013500         10  PV-STORE-NMBR           PIC 9(04)     VALUE ZERO.    01350001
013600         10  FILLER REDEFINES PV-STORE-NMBR.                      01360001
013700             15  PV-STORE-NMBR-1     PIC X(01).                   01370001
013800             15  PV-STORE-NMBR-3     PIC X(03).                   01380001
013900         10  PV-ADJ-BEF-QTY          PIC S9(04) VALUE ZERO.       01390001
014000         10  PV-ADJ-AFT-QTY          PIC S9(04) VALUE ZERO.       01400001
014100         10  PV-ADJUSTED-QTY         PIC S9(07) VALUE ZERO.       01410001
014200                                                                  01420001
014300     05  PV-LOCATION-TOTALS.                                      01430001
014400         10  PV-TOT-ADJUSTMENTS-LOC     PIC S9(07)  VALUE ZERO.   01440001
014500         10  PV-TOT-ADJ-QTY-LOC         PIC S9(07)  VALUE ZERO.   01450001
014600     05  PV-FINAL-TOTALS.                                         01460001
014700         10  PV-TOT-ADJUSTMENTS-FIN     PIC S9(07)  VALUE ZERO.   01470001
014800         10  PV-TOT-ADJ-QTY-FIN         PIC S9(07)  VALUE ZERO.   01480001
014900                                                                  01490001
014910     05  PV-DISPLAY-NUMBER-5            PIC 9(5)    VALUE ZERO.   01500001
014911     05  PV-DISPLAY-NUMBER-9            PIC 9(9)    VALUE ZERO.   01510001
014912                                                                  01520001
014913     05  PV-BATCH-DATE                  PIC X(10)   VALUE SPACE.  01530001
014914     05  PV-BATCH-DATE-DISPLAY REDEFINES PV-BATCH-DATE.           01540001
014915         10   PV-DISPLAY-CC             PIC X(02).                01550001
014916         10   PV-DISPLAY-YY             PIC X(02).                01560001
014917         10   PV-DASH-1                 PIC X(01).                01570001
014918         10   PV-DISPLAY-MM             PIC X(02).                01580001
014919         10   PV-DASH-2                 PIC X(01).                01590001
014920         10   PV-DISPLAY-DD             PIC X(02).                01600001
014930                                                                  01610001
014940     05  SD-SYSTEM-DATE.                                          01620001
014950         10  SD-SYSTEM-DATE-YY       PIC  9(02)    VALUE ZERO.    01630001
014960         10  SD-SYSTEM-DATE-MM       PIC  9(02)    VALUE ZERO.    01640001
014970         10  SD-SYSTEM-DATE-DD       PIC  9(02)    VALUE ZERO.    01650001
014980     05  ST-SYSTEM-TIME.                                          01660001
014990         10  ST-SYSTEM-HOUR          PIC  9(02)    VALUE ZERO.    01670001
015000         10  ST-SYSTEM-MINUTE        PIC  9(02)    VALUE ZERO.    01680001
015100         10  ST-SYSTEM-SECOND        PIC  9(02)    VALUE ZERO.    01690001
015200         10  FILLER                  PIC  9(02)    VALUE ZERO.    01700001
015300                                                                  01710001
015400 EJECT                                                            01720001
015500*                                                                 01730001
015600*                                                                 01740001
015700 01  WS-BATCH-PROC-DATE.                                          01750001
015800     05  WS-BATCH-PROC-CC            PIC X(02)     VALUE SPACE.   01760001
015900     05  WS-BATCH-PROC-YY            PIC X(02)     VALUE SPACE.   01770001
016000     05  FILLER                      PIC X(01)     VALUE SPACE.   01780001
016100     05  WS-BATCH-PROC-MM            PIC X(02)     VALUE SPACE.   01790001
016200     05  FILLER                      PIC X(01)     VALUE SPACE.   01800001
016300     05  WS-BATCH-PROC-DD            PIC X(02)     VALUE SPACE.   01810001
016400*                                                                 01820001
016500*-----------------------------------------------------------------01830001
016600*  STANDARD REPORT HEADER FOR 132 COLUMN REPORT.                  01840001
016700*-----------------------------------------------------------------01850001
016800     COPY DPWS132O.                                               01860001
016900                                                                  01870001
017000*----------------------------------------------------------------*01880001
017100***  LAYOUT FOR THE TEMP ASSOC INFO SUBROUTINE                    01890001
017200*----------------------------------------------------------------*01900001
017300     COPY XLWS067.                                                01910001
017400                                                                  01920001
017500*----------------------------------------------------------------*01930001
017600***  LAYOUT FOR THE LOCATION MASTER INFO SUBROUTINE               01940001
017700*----------------------------------------------------------------*01950001
017800     COPY XLWS071.                                                01960001
017900                                                                  01970001
018000*MAIN HEADING                                                     01980001
018100 01  HL-HEADING-LINE-1.                                           01990001
018200     05  FILLER                  PIC  X(34)    VALUE SPACE.       02000001
018300     05  FILLER                  PIC  X(53)    VALUE              02010001
018400         'DAILY AUDIT OF ADJUSTMENTS MADE TO CARTON CONTENT FOR'. 02020001
018500     05  FILLER                  PIC  X(01)    VALUE SPACE.       02030001
018600     05  HL1-BTCH-PRC-DTE.                                        02040001
018700         10  HL1-BATCH-PROC-MM   PIC  X(02)    VALUE SPACE.       02050001
018800         10  HL1-SLASH-1         PIC  X(01)    VALUE '/'.         02060001
018900         10  HL1-BATCH-PROC-DD   PIC  X(02)    VALUE SPACE.       02070001
019000         10  HL1-SLASH-2         PIC  X(01)    VALUE '/'.         02080001
019100         10  HL1-BATCH-PROC-CC   PIC  X(02)    VALUE SPACE.       02090001
019200         10  HL1-BATCH-PROC-YY   PIC  X(02)    VALUE SPACE.       02100001
019300         10  FILLER              PIC  X(34)    VALUE SPACE.       02110001
019400                                                                  02120001
019500*SUB HEADINGS                                                     02130001
019600 01  HL-HEADING-LINE-2.                                           02140001
019700     05  FILLER                  PIC  X(01)    VALUE SPACE.       02150001
019800     05  FILLER                  PIC  X(13)    VALUE              02160001
019900         'DC LOCATION -'.                                         02170001
020000     05  FILLER                  PIC  X(01)    VALUE SPACE.       02180001
020100     05  HL2-DC-OPER-UNT         PIC  9(04)    VALUE ZERO.        02190001
020200     05  FILLER                  PIC  X(02)    VALUE SPACE.       02200001
020300     05  FILLER                  PIC  X(01)    VALUE '('.         02210001
020400     05  HL2-DC-NAME             PIC  X(25)    VALUE ZERO.        02220001
020500     05  FILLER                  PIC  X(01)    VALUE ')'.         02230001
020600     05  FILLER                  PIC  X(84)    VALUE SPACE.       02240001
020700                                                                  02250001
020800 01  HL-HEADING-LINE-3.                                           02260001
020900     05  FILLER                  PIC  X(49)    VALUE SPACE.       02270001
021000     05  FILLER                  PIC  X(43)    VALUE              02280001
021100         '   STR   BEFORE  AFTER     ADJ     ADJUSTED'.           02290001
021200     05  FILLER                  PIC  X(12)    VALUE SPACE.       02300001
021300     05  FILLER                  PIC  X(08)    VALUE              02310001
021400         'ADJUSTED'.                                              02320001
021500                                                                  02330001
021600 01  HL-HEADING-LINE-4.                                           02340001
021700     05  FILLER                  PIC  X(04)    VALUE SPACE.       02350001
021800     05  FILLER                  PIC  X(52)    VALUE              02360001
021900         'PO-RCVR-LINE          UPC NUMBER        SKU     NMBR'.  02370001
022000     05  FILLER                  PIC  X(53)    VALUE              02380001
022100         '    QTY    QTY      QTY        ON                  BY'. 02390001
022200     05  FILLER                  PIC  X(19)    VALUE              02400001
022300         '             REASON'.                                   02410001
022400                                                                  02420001
022500 01  HL-HEADING-LINE-5.                                           02430001
022600     05  FILLER                  PIC  X(01)    VALUE SPACE.       02440001
022700     05  FILLER                  PIC  X(38)    VALUE              02450001
022800         '------------------  ------------------'.                02460001
022900     05  FILLER                  PIC  X(41)    VALUE              02470001
023000         '  --------  ----  ------  ------  -------'.             02480001
023100     05  FILLER                  PIC  X(38)    VALUE              02490001
023200         ' ----------------- ------------------ '.                02500001
023300     05  FILLER                  PIC  X(14)    VALUE              02510001
023400         '--------------'.                                        02520001
023500*                                                                 02530001
023600 01  DL-DETAIL-LINE-1.                                            02540001
023700     05  FILLER                  PIC  X(01)    VALUE SPACE.       02550001
023800     05  FILLER                  PIC  X(12)    VALUE              02560001
023900         'SHIPT UNIT: '.                                          02570001
024000     05  DL1-SHIPT-UNT-ID        PIC  X(18).                      02580001
024100     05  FILLER                  PIC  X(101)   VALUE SPACES.      02590001
024200                                                                  02600001
024300*                                                                 02610001
024400 01  DL-DETAIL-LINE-2.                                            02620001
024500     05  FILLER                  PIC  X(01)    VALUE SPACE.       02630001
024600     05  DL2-PO-RCVR-LINE        PIC  X(18).                      02640001
024700     05  FILLER                  PIC  X(02)    VALUE SPACE.       02650001
024800     05  DL2-UPC-NBR             PIC  X(18).                      02660001
024900     05  FILLER                  PIC  X(02)    VALUE SPACE.       02670001
025000     05  DL2-SKU                 PIC  Z(08).                      02680001
025100     05  FILLER                  PIC  X(02)    VALUE SPACE.       02690001
025200     05  DL2-STORE-NBR           PIC  X(04).                      02700001
025300     05  FILLER                  PIC  X(02)    VALUE SPACE.       02710001
025400     05  DL2-ADJ-BEF-QTY         PIC  ZZ,ZZ9.                     02720001
025500     05  FILLER                  PIC  X(02)    VALUE SPACE.       02730001
025600     05  DL2-ADJ-AFT-QTY         PIC  ZZ,ZZ9.                     02740001
025700     05  FILLER                  PIC  X(02)    VALUE SPACE.       02750001
025800     05  DL2-ADJUSTED-QTY        PIC  ZZ,ZZ9-.                    02760001
025900     05  FILLER                  PIC  X(01)    VALUE SPACE.       02770001
026000                                                                  02780001
026100*DETAIL TIMESTAMP                                                 02790001
026200     05  DL2-DATE.                                                02800001
026300         10  DL2-MM              PIC 99.                          02810001
026400         10  FILLER              PIC X(01) VALUE '/'.             02820001
026500         10  DL2-DD              PIC 99.                          02830001
026600         10  FILLER              PIC X(01) VALUE '/'.             02840001
026700         10  DL2-YY              PIC 99.                          02850001
026800     05  FILLER                  PIC X(01) VALUE ' '.             02860001
026900     05  DL2-TIME.                                                02870001
027000         10  DL2-HH              PIC 99.                          02880001
027100         10  FILLER              PIC X(01) VALUE ':'.             02890001
027200         10  DL2-MI              PIC 99.                          02900001
027300         10  FILLER              PIC X(01) VALUE ':'.             02910001
027400         10  DL2-SS              PIC 99.                          02920001
027500     05  FILLER                  PIC X(01) VALUE SPACE.           02930001
027600     05  DL2-USER-NAME           PIC X(18).                       02940001
027700     05  FILLER                  PIC X(01) VALUE SPACE.           02950001
027800     05  DL2-RSN-CDE             PIC X(14).                       02960001
027900                                                                  02970001
028000 01  TL-LOC-TOT-LINE.                                             02980001
028100     05  FILLER                  PIC  X(01)    VALUE SPACE.       02990001
028200     05  FILLER                  PIC  X(13)    VALUE              03000001
028300         'DC LOCATION -'.                                         03010001
028400     05  FILLER                  PIC  X(02)    VALUE SPACE.       03020001
028500     05  TL-LOCATION             PIC  9(04)    VALUE ZERO.        03030001
028600     05  FILLER                  PIC  X(02)    VALUE SPACE.       03040001
028700     05  FILLER                  PIC  X(27)    VALUE              03050001
028800         'NUMBER OF ADJUSTMENTS MADE:'.                           03060001
028900     05  FILLER                  PIC  X(02)    VALUE SPACE.       03070001
029000     05  TL-ADJUSTMENTS          PIC  ZZZ,ZZ9.                    03080001
029100     05  FILLER                  PIC  X(03)    VALUE SPACE.       03090001
029200     05  FILLER                  PIC  X(20)    VALUE              03100001
029300         'WITH NET ADJ QTY OF:'.                                  03110001
029400     05  FILLER                  PIC  X(08)    VALUE SPACE.       03120001
029500     05  TL-NET-ADJ-QTY          PIC  ZZZ,ZZ9-.                   03130001
029600     05  FILLER                  PIC  X(35)    VALUE SPACE.       03140001
029700 01  GL-GRAND-TOT-LINE.                                           03150001
029800     05  FILLER                  PIC X(01) VALUE SPACE.           03160001
029900     05  FILLER                  PIC X(13) VALUE                  03170001
030000         'FINAL TOTALS:'.                                         03180001
030100     05  FILLER                  PIC X(02) VALUE SPACE.           03190001
030200     05  FILLER                  PIC X(33) VALUE                  03200001
030300         'TOTAL NUMBER OF ADJUSTMENTS MADE:'.                     03210001
030400     05  FILLER                  PIC X(02) VALUE SPACE.           03220001
030500     05  GL-ADJUSTMENTS          PIC ZZZ,ZZ9.                     03230001
030600     05  FILLER                  PIC X(03) VALUE SPACE.           03240001
030700     05  FILLER                  PIC X(26) VALUE                  03250001
030800         'WITH TOTAL NET ADJ QTY OF:'.                            03260001
030900     05  FILLER                  PIC X(02) VALUE SPACE.           03270001
031000     05  GL-NET-ADJ-QTY          PIC ZZZ,ZZ9-.                    03280001
031100     05  FILLER                  PIC X(35) VALUE SPACE.           03290001
031200                                                                  03300001
031300                                                                  03310001
031400 01  ER-END-OF-REPORT-LINE.                                       03320001
031500     05  FILLER                  PIC  X(44)    VALUE SPACE.       03330001
031600     05  FILLER                  PIC  X(45)    VALUE              03340001
031700         '*******   E N D   O F   R E P O R T   *******'.         03350001
031800     05  FILLER                  PIC  X(43)    VALUE SPACE.       03360001
031900 01  EP-EMPTY-REPORT-LINE.                                        03370001
032000     05  FILLER                  PIC  X(40)    VALUE SPACE.       03380001
032100     05  FILLER                  PIC  X(52)    VALUE              03390001
032200         '*******  N O   D A T A   T O   R E P O R T   *******'.  03400001
032300     05  FILLER                  PIC  X(40)    VALUE SPACE.       03410001
032400*                                                                 03420001
032500 01  BL-BLANK-LINE               PIC X(132)    VALUE SPACE.       03430001
032600                                                                  03440001
032700*** DB2 MESSAGE AREAS ****                                        03450001
032800     COPY DPWS004.                                                03460001
032900*                                                                 03470001
033000*----------------------------------------------------------------*03480001
033100*  COPYBOOK FOR LOGISTICS DOMAIN ITEM ACCESS MODULE              *03490001
033200*----------------------------------------------------------------*03500001
033300     COPY XLWS001.                                                03510001
033400*                                                                 03520001
033500*DB2 AREA FOR SHIPPING UNIT ADJUSTMENT TABLE                      03530001
033600     EXEC SQL                                                     03540001
033700          INCLUDE TSUQADJ                                         03550001
033800     END-EXEC.                                                    03560001
033900                                                                  03570001
034000*DB2 AREA FOR SHIPPING UNIT TABLE                                 03580001
034100     EXEC SQL                                                     03590001
034200          INCLUDE SUT00024                                        03600001
034300     END-EXEC.                                                    03610001
034400*                                                                 03620001
034500*  DB2 TABLE FOR UPC                                              03630001
034600     EXEC SQL                                                     03640001
034700          INCLUDE SUT00028                                        03650001
034800     END-EXEC.                                                    03660001
035000*                                                                 03670001
035600*DB2 AREA FOR COMPANY CONTROL TABLE                               03680001
035700     EXEC SQL                                                     03690001
035800          INCLUDE TCOCNTL                                         03700001
035900     END-EXEC.                                                    03710001
036000*                                                                 03720001
036100*DB2 AREA FOR SUT_OTBND_VND TABLE                                 03730001
036200     EXEC SQL                                                     03740001
036300          INCLUDE SUT00026                                        03750001
036400     END-EXEC.                                                    03760001
036500                                                                  03770001
036600*DB2 AREA FOR TPKSLIP TABLE                                       03780001
036700     EXEC SQL                                                     03790001
036800          INCLUDE TPKSLIP                                         03800001
036900     END-EXEC.                                                    03810001
037000                                                                  03820001
037100*DB2 AREA FOR COMMUNICATIONS                                      03830001
037200     EXEC SQL                                                     03840001
037300          INCLUDE SQLCA                                           03850001
037400     END-EXEC.                                                    03860001
037500                                                                  03870001
037600*DB2 AREA FOR COMMUNICATIONS AREA2                                03880001
037700     COPY SQLCA2.                                                 03890001
037800                                                                  03900001
037900     EXEC SQL                                                     03910001
038000         DECLARE ADJUSTMENT-CSR CURSOR FOR                        03920001
038100             SELECT A.SHIPT_UNT_ID                                03930001
038200                  , A.UPC_NBR                                     03940001
038300                  , A.ADJ_TMST                                    03950001
038400                  , A.OPER_UNT_ID                                 03960001
038500                  , A.ADJ_BEF_QTY                                 03970001
038600                  , A.ADJ_AFT_QTY                                 03980001
038700                  , A.PRC_RSN_CDE                                 03990001
038800                  , A.ADJ_USR_ID                                  04000001
038900              FROM TSUQADJ A                                      04010001
039000             WHERE DATE(A.ADJ_TMST)  = :COCNTL-BTCH-PRC-DTE       04020001
039100          ORDER BY A.OPER_UNT_ID                                  04030001
039200                 , A.SHIPT_UNT_ID                                 04040001
039300     END-EXEC.                                                    04050001
039400*                                                                 04060001
039500 PROCEDURE DIVISION.                                              04070001
039600                                                                  04080001
039700 0000-MAINLINE.                                                   04090001
039800     PERFORM 1000-INITIALIZE.                                     04100001
039900     PERFORM 2000-PROCESS-ADJUSTMENTS UNTIL PS-EOF-ADJUSTMENT-FILE04110001
040000                                                                  04120001
040100     IF PV-READ-COUNT > ZERO                                      04130001
040200        PERFORM 5000-FINAL-TOTALS                                 04140001
040300     END-IF                                                       04150001
040400                                                                  04160001
040500     PERFORM 9000-EOJ.                                            04170001
040600                                                                  04180001
040700     DISPLAY 'NUMBER OF RECORDS READ IS:     '                    04190001
040800         PV-READ-COUNT.                                           04200001
040900     DISPLAY 'NUMBER OF RECORDS WRITTEN IS:  '                    04210001
041000         PV-WRITE-COUNT.                                          04220001
041100                                                                  04230001
041200     GOBACK.                                                      04240001
041300*                                                                 04250001
041400*                                                                 04260001
041500 1000-INITIALIZE.                                                 04270001
041600     OPEN OUTPUT REPORT-FILE.                                     04280001
041700                                                                  04290001
041800     ACCEPT SD-SYSTEM-DATE FROM DATE.                             04300001
041900     ACCEPT ST-SYSTEM-TIME FROM TIME.                             04310001
042000                                                                  04320001
042100     MOVE SD-SYSTEM-DATE-YY      TO DP132O-RUN-YEAR.              04330001
042200     MOVE SD-SYSTEM-DATE-MM      TO DP132O-RUN-MONTH.             04340001
042300     MOVE SD-SYSTEM-DATE-DD      TO DP132O-RUN-DAY.               04350001
042400     MOVE ST-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              04360001
042500     MOVE ST-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            04370001
042600                                                                  04380001
042700     MOVE PC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          04390001
042800     MOVE PC-1                   TO DP132O-REPORT-NUMBER          04400001
042900                                    DP132O-PAGE-NUMBER            04410001
043000                                                                  04420001
043100     PERFORM 7200-SELECT-TCOCNTL                                  04430001
043200     MOVE COCNTL-BTCH-PRC-DTE TO PV-BATCH-DATE-DISPLAY            04440001
043300     MOVE PV-DISPLAY-MM TO HL1-BATCH-PROC-MM                      04450001
043400     MOVE PC-SLASH TO HL1-SLASH-1                                 04460001
043500     MOVE PV-DISPLAY-DD TO HL1-BATCH-PROC-DD                      04470001
043600     MOVE PC-SLASH TO HL1-SLASH-2                                 04480001
043700     MOVE PV-DISPLAY-CC TO HL1-BATCH-PROC-CC                      04490001
043800     MOVE PV-DISPLAY-YY TO HL1-BATCH-PROC-YY                      04500001
043900                                                                  04510001
044000                                                                  04520001
044100     PERFORM 7000-OPEN-ADJUSTMENT-CURSOR                          04530001
044200     PERFORM 7010-FETCH-ADJUSTMENT-CURSOR                         04540001
044300                                                                  04550001
044400     IF PS-EOF-ADJUSTMENT-FILE                                    04560001
044500        PERFORM 8000-WRITE-MAIN-HEADINGS                          04570001
044600        WRITE REPORT-RECORD FROM BL-BLANK-LINE                    04580001
044700            AFTER ADVANCING 2 LINES                               04590001
044800        WRITE REPORT-RECORD FROM EP-EMPTY-REPORT-LINE             04600001
044900            AFTER ADVANCING 3 LINES                               04610001
045000     ELSE                                                         04620001
045100        MOVE PV-CURRENT-KEY          TO PV-PREVIOUS-KEY           04630001
045200        SET PS-CURSOR-OPEN           TO TRUE                      04640001
045300        MOVE +0                      TO PV-PAGE-COUNT             04650001
045400        PERFORM 8000-WRITE-MAIN-HEADINGS                          04660001
045500        PERFORM 8100-WRITE-SUB-HEADINGS                           04670001
045600     END-IF.                                                      04680001
045700*                                                                 04690001
045800*                                                                 04700001
045900 2000-PROCESS-ADJUSTMENTS.                                        04710001
046000     IF PV-CURRENT-KEY = PV-PREVIOUS-KEY                          04720001
046100        PERFORM 3000-PRINT-DETAILS                                04730001
046200     ELSE                                                         04740001
046300        MOVE +0                      TO PV-PAGE-COUNT             04750001
046400        PERFORM 4000-LOCATION-BREAK                               04760001
046500        PERFORM 3000-PRINT-DETAILS                                04770001
046600     END-IF.                                                      04780001
046700                                                                  04790001
046800     IF PV-LINES-USED > PC-MAX-REPORT-LINES                       04800001
046900        PERFORM 8000-WRITE-MAIN-HEADINGS                          04810001
047000        PERFORM 8100-WRITE-SUB-HEADINGS                           04820001
047100        SET PS-NEW-PAGE TO TRUE                                   04830001
047200     END-IF.                                                      04840001
047300                                                                  04850001
047400     PERFORM 7010-FETCH-ADJUSTMENT-CURSOR.                        04860001
047500*                                                                 04870001
047600*                                                                 04880001
047700 3000-PRINT-DETAILS.                                              04890001
047800     ADD 1                          TO PV-TOT-ADJUSTMENTS-LOC     04900001
047900                                                                  04910001
048000     IF PV-CURR-SHIPT-UNT-ID = PV-PREV-SHIPT-UNT-ID               04920001
048100        AND PS-NOT-NEW-PAGE                                       04930001
048200        CONTINUE                                                  04940001
048300     ELSE                                                         04950001
048400        MOVE PV-CURR-SHIPT-UNT-ID   TO DL1-SHIPT-UNT-ID           04960001
048500        SET PS-NOT-NEW-PAGE         TO TRUE                       04970001
048600        MOVE PV-CURR-SHIPT-UNT-ID   TO PV-PREV-SHIPT-UNT-ID       04980001
048700        WRITE REPORT-RECORD FROM BL-BLANK-LINE                    04990001
048800            AFTER ADVANCING 1 LINES                               05000001
048900        WRITE REPORT-RECORD FROM DL-DETAIL-LINE-1                 05010001
049000            AFTER ADVANCING 1 LINES                               05020001
049100        ADD 2                       TO PV-LINES-USED              05030001
049200     END-IF.                                                      05040001
049300                                                                  05050001
049400     MOVE SUQADJ-UPC-NBR          TO DL2-UPC-NBR                  05060001
049500                                                                  05070001
049600     IF SUQADJ-UPC-NBR   >   0                                    05080001
049700        PERFORM 7500-CALL-XLKUT-DOMAIN-PGM                        05090001
049800     ELSE                                                         05100001
049900        MOVE ZERO            TO DL2-SKU                           05110001
050000     END-IF                                                       05120001
050100                                                                  05130001
050200     PERFORM 7300-SELECT-OTBND-CART.                              05140001
050300     IF SQLCODE = 0                                               05150001
050400         PERFORM 7400-DETERMIN-PO-RCVR                            05160001
050500         MOVE PV-PO-RCVR-LINE     TO DL2-PO-RCVR-LINE             05170001
050600     ELSE                                                         05180001
050700         MOVE SPACES              TO DL2-PO-RCVR-LINE             05190001
050800     END-IF.                                                      05200001
050900     MOVE DK-STR-NBR              TO DL2-STORE-NBR                05210001
051000                                                                  05220001
051100     MOVE SUQADJ-ADJ-BEF-QTY      TO DL2-ADJ-BEF-QTY.             05230001
051200     MOVE SUQADJ-ADJ-AFT-QTY      TO DL2-ADJ-AFT-QTY.             05240001
051300     SUBTRACT SUQADJ-ADJ-BEF-QTY FROM                             05250001
051400              SUQADJ-ADJ-AFT-QTY GIVING DL2-ADJUSTED-QTY          05260001
051500     MOVE DL2-ADJUSTED-QTY        TO PV-ADJUSTED-QTY              05270001
051600     ADD PV-ADJUSTED-QTY          TO PV-TOT-ADJ-QTY-LOC           05280001
051700                                                                  05290001
051800     MOVE SUQADJ-ADJ-TMST             TO PV-DB2-TIMESTAMP         05300001
051900     MOVE PV-TMST-YY                  TO DL2-YY                   05310001
052000     MOVE PV-TMST-MM                  TO DL2-MM                   05320001
052100     MOVE PV-TMST-DD                  TO DL2-DD                   05330001
052200     MOVE PV-TMST-HRS                 TO DL2-HH                   05340001
052300     MOVE PV-TMST-MIN                 TO DL2-MI                   05350001
052400     MOVE PV-TMST-SEC                 TO DL2-SS                   05360001
052500                                                                  05370001
052600     IF SUQADJ-ADJ-USR-ID NOT = PV-PREV-ADJ-USER-ID               05380001
052700        PERFORM 7150-GET-USER-NAME                                05390001
052800        IF XL067-KOHLS-NOT-FOUND OR XL067-USER-ID-MISSING         05400004
052900           MOVE SUQADJ-ADJ-USR-ID     TO DL2-USER-NAME            05410001
053000        ELSE                                                      05420001
053100           MOVE XL067-COMBINED-NAME-2 TO DL2-USER-NAME            05430001
053200           MOVE SUQADJ-ADJ-USR-ID     TO PV-PREV-ADJ-USER-ID      05440001
053300        END-IF                                                    05450001
053400     END-IF                                                       05460001
053500                                                                  05470001
053600     MOVE SUQADJ-PRC-RSN-CDE      TO DL2-RSN-CDE.                 05480001
053700                                                                  05490001
053800     WRITE REPORT-RECORD FROM DL-DETAIL-LINE-2                    05500001
053900        AFTER ADVANCING 1 LINES.                                  05510001
054000     ADD 1                         TO PV-LINES-USED.              05520001
054100*LMM                                                              05530001
054200     MOVE PV-CURRENT-KEY           TO PV-PREVIOUS-KEY.            05540001
054300*                                                                 05550001
054400*                                                                 05560001
054500 4000-LOCATION-BREAK.                                             05570001
054600     PERFORM 4100-LOCATION-TOTALS                                 05580001
054700                                                                  05590001
054800     WRITE REPORT-RECORD FROM BL-BLANK-LINE                       05600001
054900        AFTER ADVANCING 5 LINES.                                  05610001
055000                                                                  05620001
055100     PERFORM 8000-WRITE-MAIN-HEADINGS.                            05630001
055200     PERFORM 8100-WRITE-SUB-HEADINGS.                             05640001
055300*                                                                 05650001
055400*                                                                 05660001
055500 4100-LOCATION-TOTALS.                                            05670001
055600     MOVE PV-TOT-ADJUSTMENTS-LOC      TO TL-ADJUSTMENTS           05680001
055700     MOVE PV-TOT-ADJ-QTY-LOC          TO TL-NET-ADJ-QTY           05690001
055800                                                                  05700001
055900     IF PV-LINES-USED > (PC-MAX-REPORT-LINES - 3)                 05710001
056000        PERFORM 8000-WRITE-MAIN-HEADINGS                          05720001
056100        PERFORM 8100-WRITE-SUB-HEADINGS                           05730001
056200        SET PS-NEW-PAGE TO TRUE                                   05740001
056300     END-IF.                                                      05750001
056400                                                                  05760001
056500     WRITE REPORT-RECORD FROM BL-BLANK-LINE                       05770001
056600        AFTER ADVANCING 1 LINES.                                  05780001
056700                                                                  05790001
056800     WRITE REPORT-RECORD FROM TL-LOC-TOT-LINE                     05800001
056900         AFTER ADVANCING 2 LINES.                                 05810001
057000     ADD 2                            TO PV-LINES-USED            05820001
057100     ADD PV-TOT-ADJUSTMENTS-LOC       TO PV-TOT-ADJUSTMENTS-FIN   05830001
057200     ADD PV-TOT-ADJ-QTY-LOC           TO PV-TOT-ADJ-QTY-FIN       05840001
057300     INITIALIZE PV-LOCATION-TOTALS.                               05850001
057400*                                                                 05860001
057500*                                                                 05870001
057600 5000-FINAL-TOTALS.                                               05880001
057700     PERFORM 4100-LOCATION-TOTALS.                                05890001
057800     MOVE PV-TOT-ADJUSTMENTS-FIN      TO GL-ADJUSTMENTS           05900001
057900     MOVE PV-TOT-ADJ-QTY-FIN          TO GL-NET-ADJ-QTY           05910001
058000                                                                  05920001
058100     IF PV-LINES-USED > (PC-MAX-REPORT-LINES - 2)                 05930001
058200        PERFORM 8000-WRITE-MAIN-HEADINGS                          05940001
058300        PERFORM 8100-WRITE-SUB-HEADINGS                           05950001
058400        SET PS-NEW-PAGE TO TRUE                                   05960001
058500     END-IF.                                                      05970001
058600                                                                  05980001
058700     WRITE REPORT-RECORD FROM BL-BLANK-LINE                       05990001
058800        AFTER ADVANCING 1 LINES.                                  06000001
058900                                                                  06010001
059000     WRITE REPORT-RECORD FROM GL-GRAND-TOT-LINE                   06020001
059100         AFTER ADVANCING 2 LINES.                                 06030001
059200     ADD 2                            TO PV-LINES-USED.           06040001
059300*                                                                 06050001
059400*                                                                 06060001
059500 7000-OPEN-ADJUSTMENT-CURSOR.                                     06070001
059600     EXEC SQL                                                     06080001
059700         OPEN ADJUSTMENT-CSR                                      06090001
059800     END-EXEC.                                                    06100001
059900                                                                  06110001
060000     EVALUATE TRUE                                                06120001
060100         WHEN SQLCODE = ZERO                                      06130001
060200             CONTINUE                                             06140001
060300         WHEN SQLCODE < ZERO                                      06150001
060400             MOVE '7000-OPEN-ADJUSTMENT-CURSOR '                  06160001
060500                                      TO PV-PARAGRAPH             06170001
060600             MOVE 'OPEN'              TO PV-DB2-FUNCTION          06180001
060700             PERFORM 9200-SQL-ERROR                               06190001
060800         WHEN SQLCODE > ZERO                                      06200001
060900         WHEN SQLWARN0 NOT = SPACE                                06210001
061000             MOVE '7000-OPEN-ADJUSTMENT-CURSOR '                  06220001
061100                                      TO PV-PARAGRAPH             06230001
061200             MOVE 'OPEN'              TO PV-DB2-FUNCTION          06240001
061300             PERFORM 9300-SQL-WARNING                             06250001
061400     END-EVALUATE.                                                06260001
061500*                                                                 06270001
061600*                                                                 06280001
061700 7010-FETCH-ADJUSTMENT-CURSOR.                                    06290001
061800     EXEC SQL                                                     06300001
061900     FETCH ADJUSTMENT-CSR                                         06310001
062000               INTO :SUQADJ-SHIPT-UNT-ID                          06320001
062100                  , :SUQADJ-UPC-NBR                               06330001
062200                  , :SUQADJ-ADJ-TMST                              06340001
062300                  , :SUQADJ-OPER-UNT-ID                           06350001
062400                  , :SUQADJ-ADJ-BEF-QTY                           06360001
062500                  , :SUQADJ-ADJ-AFT-QTY                           06370001
062600                  , :SUQADJ-PRC-RSN-CDE                           06380001
062700                  , :SUQADJ-ADJ-USR-ID                            06390001
062800     END-EXEC                                                     06400001
062900                                                                  06410001
063000     EVALUATE TRUE                                                06420001
063100         WHEN SQLCODE = ZERO                                      06430001
063200             MOVE SUQADJ-OPER-UNT-ID   TO PV-CURR-OPER-UNT-ID     06440001
063300                                          DK-DC-NBR               06450001
063400             ADD 1                     TO PV-READ-COUNT           06460001
063500             MOVE SUQADJ-SHIPT-UNT-ID  TO PV-CURR-SHIPT-UNT-ID    06470001
063600                                          DK-SHIPT-UNT-ID         06480001
063700             PERFORM 7260-SELECT-OTBND-CART                       06490001
063800         WHEN SQLCODE = +100                                      06500001
063900             SET PS-EOF-ADJUSTMENT-FILE TO TRUE                   06510001
064000         WHEN SQLCODE < ZERO                                      06520001
064100             MOVE '7010-FETCH-ADJUSTMENT-CURSOR '                 06530001
064200                                      TO PV-PARAGRAPH             06540001
064300             MOVE 'FETCH'             TO PV-DB2-FUNCTION          06550001
064400             PERFORM 9200-SQL-ERROR                               06560001
064500         WHEN SQLCODE > ZERO                                      06570001
064600         WHEN SQLWARN0 NOT = SPACE                                06580001
064700             MOVE '7010-FETCH-ADJUSTMENT-CURSOR '                 06590001
064800                                      TO PV-PARAGRAPH             06600001
064900             MOVE 'FETCH'             TO PV-DB2-FUNCTION          06610001
065000             PERFORM 9300-SQL-WARNING                             06620001
065100     END-EVALUATE.                                                06630001
065200*                                                                 06640001
065300*                                                                 06650001
065400 7020-CLOSE-ADJUSTMENT-CSR.                                       06660001
065500     EXEC SQL                                                     06670001
065600     CLOSE ADJUSTMENT-CSR                                         06680001
065700     END-EXEC                                                     06690001
065800                                                                  06700001
065900     EVALUATE TRUE                                                06710001
066000         WHEN SQLCODE = ZERO                                      06720001
066100             CONTINUE                                             06730001
066200         WHEN SQLCODE < ZERO                                      06740001
066300             MOVE '7020-CLOSE-ADJUSTMENT-CURSOR '                 06750001
066400                                      TO PV-PARAGRAPH             06760001
066500             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          06770001
066600             PERFORM 9200-SQL-ERROR                               06780001
066700         WHEN SQLCODE > ZERO                                      06790001
066800         WHEN SQLWARN0 NOT = SPACE                                06800001
066900             MOVE '7020-CLOSE-ADJUSTMENT-CURSOR '                 06810001
067000                                      TO PV-PARAGRAPH             06820001
067100             MOVE 'CLOSE'             TO PV-DB2-FUNCTION          06830001
067200             PERFORM 9300-SQL-WARNING                             06840001
067300     END-EVALUATE.                                                06850001
067400*                                                                 06860001
067500*                                                                 06870001
067600 7100-SELECT-LOC-INFO.                                            06880001
067700                                                                  06890001
067800     INITIALIZE XL071-COMMAREA-REC.                               06900001
067900     MOVE DK-DC-NBR          TO XL071-LOCATION-NUMBER.            06910001
068000     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.         06920001
068100                                                                  06930001
068200     EVALUATE TRUE                                                06940001
068300         WHEN XL071-NO-ERRORS                                     06950001
068400             MOVE XL071-LOC-NM        TO HL2-DC-NAME              06960001
068500         WHEN XL071-LOC-NOT-FOUND                                 06970005
068600             MOVE 'NOT FOUND'         TO HL2-DC-NAME              06980001
068700             MOVE DK-DC-NBR           TO PV-DISPLAY-NUMBER-5      06990001
068800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07000001
068900             DISPLAY '*** SQLCODE +100, CALL XLKUT071  '          07010001
068910             DISPLAY '*** LOCATION NUMBER :' PV-DISPLAY-NUMBER-5  07020001
068920             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07030001
068930         WHEN XL071-BAD-DB2-RETURN                                07040001
068940             MOVE '7100-SELECT-LOC-INFO ' TO                      07050001
068950                  PV-PARAGRAPH                                    07060001
068960             MOVE 'SELECT LOCATION NAME'                          07070001
068970                                      TO PV-DB2-FUNCTION          07080001
068980             PERFORM 9220-XLKUT071-ERROR                          07090001
068990     END-EVALUATE.                                                07100001
069000*                                                                 07110001
069100*                                                                 07120001
069200 7150-GET-USER-NAME.                                              07130001
069300                                                                  07140001
069400     INITIALIZE XL067-USER-COMMAREA.                              07150001
069500                                                                  07160001
069600     SET XL067-BY-USER-ID            TO TRUE.                     07170001
069700     SET XL067-SELECT-KOHLS-USER     TO TRUE.                     07180001
069800                                                                  07190001
069900     MOVE SUQADJ-ADJ-USR-ID     TO XL067-KEY-USER-ID.             07200003
070000                                                                  07210001
070100     CALL XL067-USER-PGM USING XL067-USER-COMMAREA.               07220001
070200                                                                  07230001
070300     EVALUATE TRUE                                                07240001
070400         WHEN XL067-SUCCESSFUL                                    07250001
070400         WHEN XL067-USER-ID-MISSING                               07260005
070500             CONTINUE                                             07270001
070600         WHEN OTHER                                               07280001
070700             DISPLAY '***********************************'        07290001
070800             DISPLAY '****     SUKRP024  ABEND       ****'        07300001
070900             DISPLAY '***********************************'        07310001
071000             DISPLAY '**  PARAGRAPH 7150-GET-USER-NAME **'        07320001
071100             DISPLAY '**  UNSUCCESSFUL CALL TO XLKUT067**'        07330001
071200             DISPLAY '**  SEE PROD COPYBOOK XLWS067    **'        07340001
071300             DISPLAY '**  XL067-RETURN-CODE:'  XL067-RETURN-CODE  07350001
071400             DISPLAY '***********************************'        07360001
071500             MOVE +4013  TO ABEND-CODE                            07370001
071600             CALL 'ILBOABN0' USING ABEND-CODE                     07380001
071610                                                                  07390001
071620     END-EVALUATE.                                                07400001
071630                                                                  07410001
071640*                                                                 07420001
071650 7200-SELECT-TCOCNTL.                                             07430001
071660     EXEC SQL                                                     07440001
071670         SELECT                                                   07450001
071680                BTCH_PRC_DTE                                      07460001
071690         INTO  :COCNTL-BTCH-PRC-DTE                               07470001
071700         FROM TCOCNTL                                             07480001
071800         WHERE OPER_UNT_ID = 90                                   07490001
071900     END-EXEC.                                                    07500001
072000                                                                  07510001
072100     EVALUATE TRUE                                                07520001
072200         WHEN SQLCODE = +0                                        07530001
072300         WHEN SQLCODE = +100                                      07540001
072400         WHEN SQLCODE = -811                                      07550001
072500             CONTINUE                                             07560001
072600         WHEN SQLCODE < ZERO                                      07570001
072700             MOVE '7200-SELECT-TCOCNTL'                           07580001
072800                                      TO PV-PARAGRAPH             07590001
072900             MOVE 'SELECT'            TO PV-DB2-FUNCTION          07600001
073000             PERFORM 9200-SQL-ERROR                               07610001
073100         WHEN SQLCODE > ZERO                                      07620001
073200         WHEN SQLWARN0 NOT = SPACE                                07630001
073300             MOVE '7200-SELECT-TCOCNTL'                           07640001
073400                                      TO PV-PARAGRAPH             07650001
073500             MOVE 'SELECT'            TO PV-DB2-FUNCTION          07660001
073600             PERFORM 9300-SQL-WARNING                             07670001
073700     END-EVALUATE.                                                07680001
073800*                                                                 07690001
073900*                                                                 07700001
074000*                                                                 07710001
074100 7260-SELECT-OTBND-CART.                                          07720001
074200     EXEC SQL                                                     07730001
074300         SELECT  ORIG_CART_ID                                     07740001
074400                ,DEST_LOC_NBR                                     07750001
074500         INTO    :SUT00024-ORIG-CART-ID                           07760001
074600                ,:SUT00024-DEST-LOC-NBR                           07770001
074700         FROM   SUT_OTBND_CART                                    07780001
074800         WHERE  SHIPT_UNT_ID   = :DK-SHIPT-UNT-ID                 07790001
074900     END-EXEC                                                     07800001
075000     EVALUATE TRUE                                                07810001
075100         WHEN SQLCODE = ZERO                                      07820001
075200            IF SUT00024-DEST-LOC-NBR = 0                          07830001
075300                  MOVE SUT00024-ORIG-CART-ID TO                   07840001
075400                                        SUT00024-DEST-LOC-NBR     07850001
075500                                        DK-STR-NBR                07860001
075600            ELSE                                                  07870001
075700                  MOVE SUT00024-DEST-LOC-NBR TO DK-STR-NBR        07880001
075800            END-IF                                                07890001
075900         WHEN SQLCODE = +100                                      07900001
076000             CONTINUE                                             07910001
076100         WHEN SQLCODE < ZERO                                      07920001
076200             MOVE '7260-SELECT-OTBND-CART'                        07930001
076300                                      TO PV-PARAGRAPH             07940001
076400             MOVE 'SELECT'            TO PV-DB2-FUNCTION          07950001
076500             PERFORM 9200-SQL-ERROR                               07960001
076600         WHEN SQLCODE > ZERO                                      07970001
076700         WHEN SQLWARN0 NOT = SPACE                                07980001
076800             MOVE '7260-SELECT-OTBND-CART'                        07990001
076900                                      TO PV-PARAGRAPH             08000001
077000             MOVE 'SELECT'            TO PV-DB2-FUNCTION          08010001
077100             PERFORM 9300-SQL-WARNING                             08020001
077200     END-EVALUATE.                                                08030001
077300*                                                                 08040001
077400 7300-SELECT-OTBND-CART.                                          08050001
077500     EXEC SQL                                                     08060001
077600          SELECT  CART_SRC_CDE                                    08070001
077700            INTO :SUT00024-CART-SRC-CDE                           08080001
077800            FROM  SUT_OTBND_CART                                  08090001
077900           WHERE  SHIPT_UNT_ID    = :DK-SHIPT-UNT-ID              08100001
078000     END-EXEC.                                                    08110001
078100                                                                  08120001
078200     EVALUATE TRUE                                                08130001
078300         WHEN SQLCODE = ZERO                                      08140001
078400              CONTINUE                                            08150001
078500         WHEN SQLCODE = +100                                      08160001
078600              CONTINUE                                            08170001
078700                                                                  08180001
078800         WHEN SQLCODE < ZERO                                      08190001
078900             MOVE '7300-SELECT-OTBND-CART'                        08200001
079000                                      TO PV-PARAGRAPH             08210001
079100             MOVE 'SELECT'            TO PV-DB2-FUNCTION          08220001
079200             PERFORM 9200-SQL-ERROR                               08230001
079300         WHEN SQLCODE > ZERO                                      08240001
079400         WHEN SQLWARN0 NOT = SPACE                                08250001
079500             MOVE '7300-SELECT-OTBND-CART'                        08260001
079600                                      TO PV-PARAGRAPH             08270001
079700             MOVE 'SELECT'            TO PV-DB2-FUNCTION          08280001
079800             PERFORM 9300-SQL-WARNING                             08290001
079900     END-EVALUATE.                                                08300001
080000*-----------------------------------------------------------------08310001
080100 7400-DETERMIN-PO-RCVR.                                           08320001
080200*-----------------------------------------------------------------08330001
080300     EXEC SQL                                                     08340001
080400         SELECT TRN_NBR                                           08350001
080500            ,   RCVR_SEQ_NBR                                      08360001
080600            ,   TRN_LNE_NBR                                       08370001
080700          INTO :SUT00028-TRN-NBR                                  08380001
080800            ,  :SUT00028-RCVR-SEQ-NBR                             08390001
080900            ,  :SUT00028-TRN-LNE-NBR                              08400001
081000          FROM SUT_OTBND_UPC                                      08410001
081100         WHERE SHIPT_UNT_ID     =  :DK-SHIPT-UNT-ID               08420001
081200           AND TRN_TYP_CDE      =  'PO'                           08430001
081300           AND UPC_NBR          =  :SUQADJ-UPC-NBR                08440001
081400******     AND SHPD_UNT_QTY     >  0                              08450001
081500     END-EXEC                                                     08460001
081600                                                                  08470001
081700     EVALUATE TRUE                                                08480001
081800         WHEN SQLCODE = +0                                        08490001
081900             IF SUT00028-TRN-NBR      = 0 AND                     08500001
082000                SUT00028-RCVR-SEQ-NBR = 0 AND                     08510001
082100                SUT00028-TRN-LNE-NBR  = 0                         08520001
082200                MOVE SPACES              TO PV-PO-X               08530001
082300                MOVE SPACES              TO PV-FIRST-DASH         08540001
082400                MOVE SPACES              TO PV-RCVR-X             08550001
082500                MOVE SPACES              TO PV-SECOND-DASH        08560001
082600                MOVE SPACES              TO PV-LINE-X             08570001
082700             ELSE                                                 08580001
082800                MOVE SUT00028-TRN-NBR    TO PV-PO                 08590001
082900                MOVE PC-DASH             TO PV-FIRST-DASH         08600001
083000                IF  SUT00028-RCVR-SEQ-NBR = 0                     08610001
083100                    PERFORM 7450-GET-RCVR-SEQ                     08620001
083200                ELSE                                              08630001
083300                    MOVE SUT00028-RCVR-SEQ-NBR TO PV-RCVR         08640001
083400                END-IF                                            08650001
083500                MOVE PC-DASH             TO PV-SECOND-DASH        08660001
083600                MOVE SUT00028-TRN-LNE-NBR TO PV-LINE              08670001
083700             END-IF                                               08680001
083800         WHEN SQLCODE = -811                                      08690001
083900             MOVE 'MULTIPLE'          TO PV-PO-X                  08700001
084000             MOVE SPACES              TO PV-RCVR-X                08710001
084100             MOVE SPACES              TO PV-LINE-X                08720001
084200         WHEN SQLCODE = +100                                      08730001
084300             MOVE SPACES              TO PV-PO-X                  08740001
084400             MOVE SPACES              TO PV-RCVR-X                08750001
084500             MOVE SPACES              TO PV-LINE-X                08760001
084600         WHEN SQLCODE < ZERO                                      08770001
084700             MOVE '7400-DETERMIN-PO-RCVR'                         08780001
084800                                      TO PV-PARAGRAPH             08790001
084900             MOVE 'SELECT'            TO PV-DB2-FUNCTION          08800001
085000             PERFORM 9200-SQL-ERROR                               08810001
085100         WHEN SQLCODE > ZERO                                      08820001
085200         WHEN SQLWARN0 NOT = SPACE                                08830001
085300             MOVE '7400-DETERMIN-PO-RCVR'                         08840001
085400                                      TO PV-PARAGRAPH             08850001
085500             MOVE 'SELECT'            TO PV-DB2-FUNCTION          08860001
085600             PERFORM 9300-SQL-WARNING                             08870001
085700     END-EVALUATE.                                                08880001
085800                                                                  08890001
085900                                                                  08900001
086000 7450-GET-RCVR-SEQ.                                               08910001
086100                                                                  08920001
086200     EXEC SQL                                                     08930001
086300          SELECT  B.REC_SEQ_NBR                                   08940001
086400            INTO  :PKSLIP-REC-SEQ-NBR                             08950001
086500            FROM  SUT_OTBND_VND A                                 08960001
086600                 ,TPKSLIP  B                                      08970001
086700           WHERE  A.SHIPT_UNT_ID      = :DK-SHIPT-UNT-ID          08980001
086800             AND  A.PO_NBR            = B.PO_NBR                  08990001
086900             AND  A.PKSL_SEQ_NBR      = B.SEQ_NBR                 09000001
087000             AND  B.VER_STAT_CDE      = 'A'                       09010001
087100       END-EXEC.                                                  09020001
087200                                                                  09030001
087300     EVALUATE TRUE                                                09040001
087400         WHEN SQLCODE = ZERO                                      09050001
087500             MOVE PKSLIP-REC-SEQ-NBR TO PV-RCVR                   09060001
087600         WHEN SQLCODE = +100                                      09070001
087700              CONTINUE                                            09080001
087800         WHEN SQLCODE < ZERO                                      09090001
087900              MOVE '7450-GET-RCVR-SEQ' TO PV-PARAGRAPH            09100001
088000              MOVE 'SELECT REC SEQ NBR '                          09110001
088100                               TO PV-DB2-FUNCTION                 09120001
088200              PERFORM 9200-SQL-ERROR                              09130001
088300         WHEN SQLCODE > ZERO                                      09140001
088400         WHEN SQLWARN0 NOT = SPACE                                09150001
088500              MOVE '7450-GET-RCVR-SEQ' TO PV-PARAGRAPH            09160001
088600              MOVE 'SELECT REC SEQ NBR '                          09170001
088700                               TO PV-DB2-FUNCTION                 09180001
088800              PERFORM 9300-SQL-WARNING                            09190001
088900     END-EVALUATE.                                                09200001
089000                                                                  09210001
089100                                                                  09220001
089200*----------------------------------------------------------------*09230001
089300* CODE FOR ACCESSING LOGISTICS DOMAIN ITEM ACCESS MODULE         *09240001
089400*----------------------------------------------------------------*09250001
089500 7500-CALL-XLKUT-DOMAIN-PGM.                                      09260001
089600                                                                  09270001
089700     MOVE SUQADJ-UPC-NBR          TO XL001-KEY-UPC-NBR.           09280001
089800                                                                  09290001
089900     SET  XL001-BY-UPC-NBR                                        09300001
090000          XL001-SELECT-SKU        TO TRUE.                        09310001
090100                                                                  09320001
090200     CALL XL001-VSM-PGM USING  XL001-ITEM-COMMAREA.               09330001
090300                                                                  09340001
090400*    DISPLAY 'XL001-SKU-SQLCODE = '                               09350001
090500*          XL001-SKU-SQLCODE                                      09360001
090600     EVALUATE TRUE                                                09370001
090700      WHEN XL001-UPC-SQLCODE = +100                               09380001
090800        MOVE ZERO            TO DL2-SKU                           09390001
090900      WHEN XL001-SKU-SQLCODE = +0                                 09400001
091000        MOVE XL001-SKU-NBR   TO DL2-SKU                           09410001
091100                                                                  09420001
091200      WHEN XL001-SKU-SQLCODE = +100                               09430001
091300        MOVE ZERO            TO DL2-SKU                           09440001
091400                                                                  09450001
091500      WHEN XL001-SKU-CONTENTION                                   09460001
091600        MOVE '7500-CALL-XLKUT-DOMAIN-PGM'                         09470001
091700                             TO PV-PARAGRAPH                      09480001
091800        MOVE XL001-SKU-SQLCODE                                    09490001
091900                             TO SQLCODE                           09500001
092000        MOVE 'SELECT FROM XLV_SKU'                                09510001
092100                             TO PV-DB2-FUNCTION                   09520001
092200        PERFORM 9200-SQL-ERROR                                    09530001
092300                                                                  09540001
092400      WHEN OTHER                                                  09550001
092500        MOVE '7500-CALL-XLKUT-DOMAIN-PGM'                         09560001
092600                             TO PV-PARAGRAPH                      09570001
092700        MOVE XL001-SKU-SQLCODE                                    09580001
092800                             TO SQLCODE                           09590001
092900        MOVE 'SELECT FROM XLV_SKU'                                09600001
093000                             TO PV-DB2-FUNCTION                   09610001
093100        PERFORM 9200-SQL-ERROR                                    09620001
093200                                                                  09630001
093300     END-EVALUATE.                                                09640001
093400                                                                  09650001
093500*                                                                 09660001
093600 8000-WRITE-MAIN-HEADINGS.                                        09670001
093700     PERFORM 7100-SELECT-LOC-INFO                                 09680001
093900     MOVE DK-DC-NBR                   TO HL2-DC-OPER-UNT          09690001
094000                                         TL-LOCATION.             09700002
094100     ADD 1                            TO PV-PAGE-COUNT.           09710001
094200     MOVE PV-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      09720001
094300     MOVE ZERO                        TO PV-LINES-USED.           09730002
094400                                                                  09740001
094500     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      09750001
094600                 AFTER ADVANCING PAGE.                            09760002
094700                                                                  09770001
094800     WRITE REPORT-RECORD FROM HL-HEADING-LINE-1                   09780001
094900        AFTER ADVANCING 2 LINES.                                  09790001
095000*                                                                 09800001
095100*                                                                 09810001
095200 8100-WRITE-SUB-HEADINGS.                                         09820001
095300     WRITE REPORT-RECORD FROM HL-HEADING-LINE-2                   09830001
095400        AFTER ADVANCING 2 LINES.                                  09840001
095500                                                                  09850001
095600     WRITE REPORT-RECORD FROM HL-HEADING-LINE-3                   09860001
095700        AFTER ADVANCING 2 LINES.                                  09870001
095800                                                                  09880001
095900     WRITE REPORT-RECORD FROM HL-HEADING-LINE-4.                  09890001
096000                                                                  09900001
096100     WRITE REPORT-RECORD FROM HL-HEADING-LINE-5                   09910001
096200        AFTER ADVANCING 1 LINES.                                  09920001
096300                                                                  09930001
096400     WRITE REPORT-RECORD FROM BL-BLANK-LINE                       09940001
096500        AFTER ADVANCING 1 LINES.                                  09950001
096600                                                                  09960001
096700     INITIALIZE DP132O-LASER-NEW-PAGE-INDICATR.                   09970001
096800     ADD  7                           TO PV-LINES-USED.           09980001
096900                                                                  09990001
097000*                                                                 10000001
097100 9000-EOJ.                                                        10010001
097200     IF PS-CURSOR-OPEN                                            10020001
097300         PERFORM 7020-CLOSE-ADJUSTMENT-CSR                        10030001
097400     END-IF.                                                      10040001
097500                                                                  10050001
097600     WRITE REPORT-RECORD FROM ER-END-OF-REPORT-LINE               10060001
097700        AFTER ADVANCING 2 LINES.                                  10070001
097800                                                                  10080001
097900     CLOSE REPORT-FILE.                                           10090001
098000*                                                                 10100001
098100*                                                                 10110001
098200 9200-SQL-ERROR.                                                  10120001
098300     MOVE SQLCODE                     TO SQLCODE2.                10130001
098400     MOVE SQLERRD(3)                  TO SQLERRD3.                10140001
098500                                                                  10150001
098600     DISPLAY '** ABEND **         ** = SQLERROR'.                 10160001
098700     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                10170001
098800     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   10180001
098900     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                10190001
099000                                                                  10200001
099100     DISPLAY '** SQLCODE          ** = ' SQLCODE2.                10210001
099200     DISPLAY '** ROWS PROCESSED   ** = ' SQLERRD3.                10220001
099300     DISPLAY '** SQLERRM          ** = ' SQLERRM.                 10230001
099400     DISPLAY '** SQLERRMC         ** = ' SQLERRMC.                10240001
099500                                                                  10250001
099600                                                                  10260001
099700     MOVE +4013                       TO ABEND-CODE.              10270001
099800     CALL 'ILBOABN0' USING ABEND-CODE.                            10280001
099900*                                                                 10290001
100000*                                                                 10300001
100100 9220-XLKUT071-ERROR.                                             10310001
100200                                                                  10320001
100300     DISPLAY '** ABEND **         ** = XLKUT071'.                 10330001
100400     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                10340001
100500     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   10350001
100600     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                10360001
100700                                                                  10370001
100800     DISPLAY '** SQLCODE FROM MOD ** = ' XL071-SQLCODE.           10380001
100900     DISPLAY '** TABLE IN ERROR   ** = ' XL071-DB2-TABLE.         10390001
101000     DISPLAY '** XLKUT071 RETURN  ** = ' XL071-RETURN-CODE.       10400001
101100                                                                  10410001
101200     MOVE +4013                       TO ABEND-CODE.              10420001
101300     CALL 'ILBOABN0' USING ABEND-CODE.                            10430001
101400*                                                                 10440001
101500*                                                                 10450001
101600 9300-SQL-WARNING.                                                10460001
101700     DISPLAY '9300-SQL-WARNING'.                                  10470001
101800     DISPLAY '** PROGRAM   ** = ' PC-PROGRAM-NAME.                10480001
101900     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH.                   10490001
102000     DISPLAY '** OPERATION ** = ' PV-DB2-FUNCTION.                10500001
102100                                                                  10510001
102200     MOVE SQLCODE                     TO SQLCODE2.                10520001
102300     MOVE SQLERRD(3)                  TO SQLERRD3.                10530001
102400     DISPLAY '** ABEND **       ** = SQLWARNING'.                 10540001
102500     DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  10550001
102600     DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  10560001
102700     DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  10570001
102800     DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  10580001
102900     DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  10590001
103000     DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  10600001
103100     DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  10610001
103200     DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  10620001
103300     DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  10630001
103400     DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  10640001
103500                                                                  10650001
103600     MOVE +4013                       TO ABEND-CODE.              10660001
103700     CALL 'ILBOABN0' USING ABEND-CODE.                            10670001
103800                                                                  10680001
