000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKUT151.                                00050000
000600 AUTHOR.                 DENISE HAHN.                             00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN.           02-04-15.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00110000
001110*         I   M   P   O   R   T   A  N  T                       * 00111000
001120* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00112000
001130* THIS PROGRAM IS A COPY OF RCKUT023 (BATCH VERSION)            * 00113000
001131* RCKUT151 SHOULD ONLY BE COMPILED AS CICS                      * 00113100
001132*                                                               * 00113200
001140* THERE WAS AN ISSUE WITH RCKCS221 AFTER PO NUMBER EXPANSION    * 00114000
001150* LOADLIB FOR RCKUT023 WAS FROM 1995 - RECEIVED AZRA WHEN       * 00115000
001151* RCKCS221 WAS RECOMPILED IN 2015                               * 00115100
001152*                                                               * 00115200
001153* CHANGED RCKCS221 TO USE RCKUT151 MODULE INSTEAD RCKUT023      * 00115301
001154* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 00115400
001155*                                                                 00115500
001160******************************************************************00116000
001200*     THIS SUBROUTINE WILL EDIT A FREIGHT BILL, BILL OF LADING   *00120000
001300*  AND VEHICLE NUMBER FIELDS.  FOR ALL THREE FIELDS, ALL SPACES  *00130000
001400*  AND SPECIAL CHARACTERS WILL BE REMOVED AND THE VALID          *00140000
001500*  CHARACTERS WILL BE LEFT JUSTIFIED.  ALSO LEADING ZEROES WILL  *00150000
001600*  ALSO BE REMOVED FROM ALL THREE FIELDS.                        *00160000
001700*                                                                *00170000
001800*       THE PARAMETER LIST TO USE WHEN CALLING THIS SUBROUTINE   *00180000
001900*  IS DEFINED AS FOLLOWS:                                        *00190000
002000*                                                                *00200000
002100*       FIELDS TO BE SENT TO THE SUBROUTINE:                     *00210000
002200*                                                                *00220000
002300*            THE FREIGHT BILL FIELD                 X(22)        *00230000
002400*            THE BILL OF LADING FIELD               X(30)        *00240000
002500*            THE VEHICLE NUMBER FIELD               X(10)        *00250000
002600*                                                                *00260000
002700*       RESPONSES FROM THE SUBROUTINE:                           *00270000
002800*                                                                *00280000
002900*            AN INDICATION OF THE SUCCESS OR        X(1)         *00290000
003000*                 FAILURE OF THE CALL, AND, IN THE               *00300000
003100*                 CASE OF AN ERROR, THE SPECIFIC                 *00310000
003200*                 TYPE OF ERROR DETECTED                         *00320000
003300*                                                                *00330000
003400*            AN INDICATION OF THE SUCCESS OR        X(1)         *00340000
003500*                 FAILURE OF THE CALL, AND, IN THE               *00350000
003600*                 CASE OF AN ERROR, THE SPECIFIC                 *00360000
003700*                 TYPE OF ERROR DETECTED                         *00370000
003800*                                                                *00380000
003900*            AN INDICATION OF THE SUCCESS OR        X(1)         *00390000
004000*                 FAILURE OF THE CALL, AND, IN THE               *00400000
004100*                 CASE OF AN ERROR, THE SPECIFIC                 *00410000
004200*                 TYPE OF ERROR DETECTED                         *00420000
004300*                                                                *00430000
004400******************************************************************00440000
004500                                                                  00450000
004600******************************************************************00460000
004700 ENVIRONMENT DIVISION.                                            00470000
004800******************************************************************00480000
004900                                                                  00490000
005000 CONFIGURATION SECTION.                                           00500000
005100                                                                  00510000
005200 SOURCE-COMPUTER.        IBM-4381.                                00520000
005300 OBJECT-COMPUTER.        IBM-4381.                                00530000
005400                                                                  00540000
005900******************************************************************00590000
006000 DATA DIVISION.                                                   00600000
006100******************************************************************00610000
006200                                                                  00620000
006300 WORKING-STORAGE SECTION.                                         00630000
006400                                                                  00640000
006500*                                                                 00650000
006600*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (RCKUT151) 00660000
006700*                                                                 00670000
006800                                                                  00680000
006900     COPY RCWS023.                                                00690000
007000                                                                  00700000
007100 01  PS-PROGRAM-SWITCHES.                                         00710000
007200     05  PS-ZERO-FOUND-SW            PIC X(1)     VALUE 'Y'.      00720000
007300         88  PS-ZERO-FOUND                        VALUE 'Y'.      00730000
007400         88  PS-NON-ZERO-FOUND                    VALUE 'N'.      00740000
007500                                                                  00750000
007600 01  PC-PROGRAM-CONSTANTS.                                        00760000
007700     05  PC-ZERO                     PIC X(01)    VALUE '0'.      00770000
007800                                                                  00780000
007900 01  PV-PROGRAM-VARIABLES.                                        00790000
008000     05  PV-CURRENT-INDEX-LOCATION   PIC S9(4)    VALUE ZEROS     00800000
008100                                                  COMP SYNC.      00810000
008200     05  PV-30-DIGIT-BEFORE          PIC X(30).                   00820000
008300     05  FILLER REDEFINES PV-30-DIGIT-BEFORE.                     00830000
008400         10  PV-30-CHAR-BEFORE OCCURS 30 TIMES                    00840000
008500                               INDEXED BY PV-BEFORE-INDEX.        00850000
008600             15  PV-ONE-CHAR-BEFORE  PIC X(01).                   00860000
008700                                                                  00870000
008800     05  PV-30-DIGIT-AFTER           PIC X(30).                   00880000
008900     05  FILLER REDEFINES PV-30-DIGIT-AFTER.                      00890000
009000         10  PV-30-CHAR-AFTER OCCURS 30 TIMES                     00900000
009100                               INDEXED BY PV-AFTER-INDEX.         00910000
009200             15  PV-ONE-CHAR-AFTER   PIC X(01).                   00920000
009300                                                                  00930000
009400     05  PV-VERIFY-CHAR              PIC X(01).                   00940000
009500         88  PV-VALID-CHARACTER      VALUE '0' THRU '9',          00950000
009600                                           'A' THRU 'Z'.          00960000
009700 LINKAGE SECTION.                                                 00970000
009800                                                                  00980000
009900 01  FORMAT-DATA-AREA                PIC X(80).                   00990000
010000                                                                  01000000
010100******************************************************************01010000
010200 PROCEDURE DIVISION USING FORMAT-DATA-AREA.                       01020000
010300******************************************************************01030000
010400                                                                  01040000
010500 0000-MAINLINE.                                                   01050000
010600     PERFORM 1000-INITIALIZE.                                     01060000
010700                                                                  01070000
010800     IF RC023-FREIGHT-BILL NOT = SPACES                           01080000
010900         PERFORM 2000-FORMAT-FREIGHT-BILL                         01090000
011000         SET RC023-FOUND-DATA-1 TO TRUE                           01100000
011100     END-IF.                                                      01110000
011200                                                                  01120000
011300     IF RC023-BILL-OF-LADING NOT = SPACES                         01130000
011400         PERFORM 3000-FORMAT-BILL-OF-LADING                       01140000
011500         SET RC023-FOUND-DATA-2 TO TRUE                           01150000
011600     END-IF.                                                      01160000
011700                                                                  01170000
011800     IF RC023-VEHICLE NOT = SPACES                                01180000
011900         PERFORM 4000-FORMAT-VEHICL                               01190000
012000         SET RC023-FOUND-DATA-3 TO TRUE                           01200000
012100     END-IF.                                                      01210000
012200                                                                  01220000
012300     MOVE RC023-FORMAT-DATA-AREA TO                               01230000
012400               FORMAT-DATA-AREA.                                  01240000
012500                                                                  01250000
012600******************************************************************01260000
012700*                                                                *01270000
012800******************************************************************01280000
012900                                                                  01290000
013000 1000-INITIALIZE.                                                 01300000
013100     MOVE FORMAT-DATA-AREA TO                                     01310000
013200               RC023-FORMAT-DATA-AREA.                            01320000
013300                                                                  01330000
013400                                                                  01340000
013500******************************************************************01350000
013600*  REMOVE ALL INVALID CHARACTERS FROM THE FREIGHT BILL FIELD     *01360000
013700******************************************************************01370000
013800                                                                  01380000
013900 2000-FORMAT-FREIGHT-BILL.                                        01390000
014000     MOVE RC023-FREIGHT-BILL TO PV-30-DIGIT-BEFORE.               01400000
014100     PERFORM 5000-REMOVE-SPECIAL-CHARACTERS.                      01410000
014200     MOVE PV-30-DIGIT-AFTER TO PV-30-DIGIT-BEFORE.                01420000
014300     PERFORM 7000-REMOVE-LEADING-ZEROES.                          01430000
014400     MOVE PV-30-DIGIT-AFTER TO RC023-FREIGHT-BILL.                01440000
014500                                                                  01450000
014600******************************************************************01460000
014700*  REMOVE ALL INVALID CHARACTERS FROM THE BILL OF LADING FIELD.  *01470000
014800******************************************************************01480000
014900                                                                  01490000
015000 3000-FORMAT-BILL-OF-LADING.                                      01500000
015100     MOVE RC023-BILL-OF-LADING TO PV-30-DIGIT-BEFORE.             01510000
015200     PERFORM 5000-REMOVE-SPECIAL-CHARACTERS.                      01520000
015300     MOVE PV-30-DIGIT-AFTER TO PV-30-DIGIT-BEFORE.                01530000
015400     PERFORM 7000-REMOVE-LEADING-ZEROES.                          01540000
015500     MOVE PV-30-DIGIT-AFTER TO RC023-BILL-OF-LADING.              01550000
015600                                                                  01560000
015700                                                                  01570000
015800******************************************************************01580000
015900*  REMOVE ALL INVALID CHARACTERS FROM THE VEHICLE FIELD AND      *01590000
016000*  REMOVE ALL LEADING ZEROES.                                    *01600000
016100******************************************************************01610000
016200                                                                  01620000
016300 4000-FORMAT-VEHICL.                                              01630000
016400     MOVE RC023-VEHICLE TO PV-30-DIGIT-BEFORE.                    01640000
016500     PERFORM 5000-REMOVE-SPECIAL-CHARACTERS.                      01650000
016600     MOVE PV-30-DIGIT-AFTER TO PV-30-DIGIT-BEFORE.                01660000
016700     PERFORM 7000-REMOVE-LEADING-ZEROES.                          01670000
016800     MOVE PV-30-DIGIT-AFTER TO RC023-VEHICLE.                     01680000
016900                                                                  01690000
017000******************************************************************01700000
017100*                                                                *01710000
017200******************************************************************01720000
017300                                                                  01730000
017400 5000-REMOVE-SPECIAL-CHARACTERS.                                  01740000
017500     SET PV-BEFORE-INDEX TO 1.                                    01750000
017600     SET PV-AFTER-INDEX TO 1.                                     01760000
017700     MOVE SPACES TO PV-30-DIGIT-AFTER.                            01770000
017800     PERFORM 6000-MOVE-GOOD-DATA                                  01780000
017900         VARYING PV-BEFORE-INDEX FROM 1 BY 1                      01790000
018000         UNTIL PV-BEFORE-INDEX > 30.                              01800000
018100                                                                  01810000
018200******************************************************************01820000
018300*  MOVE ALL VALID CHARACTERS FROM THE BEFORE LAYOUT TO THE AFTER *01830000
018400*  LAYOUT, ONE CHARACTER AT A TIME.                              *01840000
018500******************************************************************01850000
018600                                                                  01860000
018700 6000-MOVE-GOOD-DATA.                                             01870000
018800     MOVE PV-ONE-CHAR-BEFORE (PV-BEFORE-INDEX) TO PV-VERIFY-CHAR. 01880000
018900     IF PV-VALID-CHARACTER                                        01890000
019000         MOVE PV-VERIFY-CHAR TO PV-ONE-CHAR-AFTER (PV-AFTER-INDEX)01900000
019100         SET PV-AFTER-INDEX UP BY 1                               01910000
019200     END-IF.                                                      01920000
019300                                                                  01930000
019400******************************************************************01940000
019500*  MOVE ALL VALID CHARACTERS AFTER THE LEADING ZEROES FROM THE   *01950000
019600*  BEFORE LAYOUT TO THE AFTER LAYOUT, ONE CHARACTER AT A TIME.   *01960000
019700******************************************************************01970000
019800                                                                  01980000
019900 7000-REMOVE-LEADING-ZEROES.                                      01990000
020000     SET PV-BEFORE-INDEX TO 1.                                    02000000
020100     SET PV-AFTER-INDEX TO 1.                                     02010000
020200     SET PS-ZERO-FOUND TO TRUE.                                   02020000
020300     MOVE SPACES TO PV-30-DIGIT-AFTER.                            02030000
020400     PERFORM 8000-MOVE-DATA-AFTER-ZEROES                          02040000
020500         VARYING PV-BEFORE-INDEX FROM 1 BY 1                      02050000
020600         UNTIL PV-BEFORE-INDEX > 30.                              02060000
020700                                                                  02070000
020800******************************************************************02080000
020900*  MOVE ALL VALID CHARACTERS FROM THE BEFORE LAYOUT TO THE AFTER *02090000
021000*  LAYOUT, ONE CHARACTER AT A TIME.                              *02100000
021100******************************************************************02110000
021200                                                                  02120000
021300 8000-MOVE-DATA-AFTER-ZEROES.                                     02130000
021400     IF PS-ZERO-FOUND AND                                         02140000
021500        PV-ONE-CHAR-BEFORE (PV-BEFORE-INDEX) = PC-ZERO            02150000
021600         NEXT SENTENCE                                            02160000
021700     ELSE                                                         02170000
021800         SET PS-NON-ZERO-FOUND TO TRUE                            02180000
021900         MOVE PV-ONE-CHAR-BEFORE (PV-BEFORE-INDEX) TO             02190000
022000                                PV-ONE-CHAR-AFTER (PV-AFTER-INDEX)02200000
022100         SET PV-AFTER-INDEX UP BY 1                               02210000
022200     END-IF.                                                      02220000
