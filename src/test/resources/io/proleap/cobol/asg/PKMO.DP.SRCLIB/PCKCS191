000050***************************************************************** 00005004
000060 IDENTIFICATION DIVISION.                                         00006004
000070******************************************************************00007004
000080*                                                                *00008036
000081*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE SOCKET  *00008136
000090* SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.  THIS *00009004
000100* PROGRAM IS USING "EZASOKET".                                   *00010004
000101*                                                                *00010136
000110******************************************************************00011004
000111******************************************************************00011104
000112* 05/14/2013  Cheri Parmley           CRQ# 0000000???????        *00011204
000113*             CHANGE NEEDED FOR RFID PROJECT - CALL TO THE RFID  *00011304
000114*             MODULE CHANGES BASED ON NEW REQUIREMENTS.          *00011404
000115******************************************************************00011515
000116* 12/09/2013  Cheri Parmley           CHG0068598                 *00011615
000117*             when SU093-VNDR-DPT-RFID-TAGS-YES AND              *00011712
000118*                  SU093-DC-DEPT-TAGS-YES means no rfid on label *00011812
000121******************************************************************00012104
000122* 06/19/2015  Cheri Parmley           CHG0120422                 *00012239
000124*             RETIRING THE XLT_MDSE_PGM TABLE AND REPLACING IT   *00012439
000125*             WITH XLT_BRND FOR BRAND DESCRIPTION                *00012537
000126******************************************************************00012618
000122* 02/14/2023  Jean Kurk               CHG0281369                 *00012750
000124*             Remove copybook for UPC Check Digit routine        *00012850
000126******************************************************************00012951
000122* 04/11/2023  Jean Kurk               CHG0279657                 *00013052
000124*             Remove copybook for Item Access module             *00013151
000126******************************************************************00013250
000128*   HAS CHANGES FOR E-COMMERCE LABEL                            * 00013336
000129*              FIND '** E-COMMERCE STORAGE CODE    ****'        * 00013436
000130*              TO LOCATE POSITIONING ON LABEL                   * 00013536
000131******************************************************************00013636
000132                                                                  00013704
000133 PROGRAM-ID.    PCKCS191.                                         00013805
000134 AUTHOR.        DENNIS STEFFEN - OMNI RESOURCES.                  00013905
000135 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00014005
000136 DATE-WRITTEN   OCTOBER 1998.                                     00014105
000137 DATE-COMPILED.                                                   00014205
000140*                                                                 00014305
000150 ENVIRONMENT DIVISION.                                            00015005
000160 CONFIGURATION SECTION.                                           00016005
000170*                                                                 00017005
000180 SOURCE-COMPUTER.        IBM-3090.                                00018005
000190 OBJECT-COMPUTER.        IBM-3090.                                00019005
000200*                                                                 00020005
000210 DATA DIVISION.                                                   00021005
000220 WORKING-STORAGE SECTION.                                         00022005
000230 01  PV-STR  PIC 9(04) VALUE ZERO.                                00023013
000240 01  PS-PROGRAM-SWITCHES.                                         00024005
000250     05  PS-DISPLAY-CSSL-SW           PIC X(1) VALUE 'N'.         00025005
000260         88  PS-DISPLAY-CSSL-YES               VALUE 'Y'.         00026005
000270         88  PS-DISPLAY-CSSL-NO                VALUE 'N'.         00027005
000280                                                                  00028005
000290     05  PS-ADD-BACK-FOR-MFST-SW      PIC X(1) VALUE 'N'.         00029005
000300         88  PS-ADD-BACK-FOR-MFST-YES          VALUE 'Y'.         00030005
000310         88  PS-ADD-BACK-FOR-MFST-NO           VALUE 'N'.         00031005
000311                                                                  00031105
000312     05  PS-SML-REQST-QUEUE-EOF-IND                               00031205
000313                                      PIC X(1) VALUE 'N'.         00031305
000314         88  PS-SML-REQST-QUEUE-EOF            VALUE 'Y'.         00031405
000315                                                                  00031505
000316     05  PS-EOF-DISTRO-SW             PIC X(01) VALUE 'N'.        00031605
000317         88  PS-NOT-EOF-DISTRO-CSR              VALUE 'N'.        00031705
000318         88  PS-EOF-DISTRO-CSR                  VALUE 'Y'.        00031805
000319                                                                  00031905
000320     05  PS-LABEL-PRINT-SW            PIC X(04) VALUE SPACE.      00032005
000330         88  PS-PRINT-FCSE-LABELS               VALUE 'FCSE'.     00033005
000340         88  PS-PRINT-INPK-LABELS               VALUE 'INPK'.     00034005
000350                                                                  00035005
000360     05  PS-STORE-QTY-SW              PIC X(01) VALUE 'K'.        00036005
000370         88  PS-KEEP-STORE-QTYS                 VALUE 'K'.        00037005
000380         88  PS-ZERO-OUT-QTY                    VALUE 'Z'.        00038005
000390     05  PS-START-POINT-SW            PIC X(01) VALUE 'N'.        00039005
000400         88  PS-START-POINT-NOT-FOUND           VALUE 'N'.        00040005
000410         88  PS-START-POINT-FOUND               VALUE 'Y'.        00041005
000420     05  PS-FIRST-LABEL-SW            PIC X(01) VALUE 'Y'.        00042005
000430         88  PS-NOT-FIRST-LABEL                 VALUE 'N'.        00043005
000440         88  PS-FIRST-LABEL                     VALUE 'Y'.        00044005
000450                                                                  00045005
000460     05  PS-TWKORIN-CSR-SW            PIC X(01) VALUE 'N'.        00046005
000470         88  PS-EOF-TWKORIN-CSR                 VALUE 'Y'.        00047005
000480         88  PS-NOT-EOF-TWKORIN-CSR             VALUE 'N'.        00048005
000490     05  PS-TWKORIN-ZERO-CSR-SW       PIC X(01) VALUE 'N'.        00049005
000500         88  PS-EOF-TWKORIN-ZERO-CSR            VALUE 'Y'.        00050005
000510         88  PS-NOT-EOF-TWKORIN-ZERO-CSR        VALUE 'N'.        00051005
000520     05  PS-PGBK-REQST-QUEUE-EOF-SW   PIC X(01) VALUE 'N'.        00052005
000530         88  PS-NOT-PGBK-REQST-QUEUE-EOF      VALUE 'N'.          00053005
000540         88  PS-PGBK-REQST-QUEUE-EOF          VALUE 'Y'.          00054005
000550     05  PS-FCSE-PRINTED-SW           PIC X(01) VALUE 'N'.        00055005
000560         88  PS-FCSE-WAS-PRINTED                VALUE 'Y'.        00056005
000570         88  PS-FCSE-NOT-PRINTED                VALUE 'N'.        00057005
000580     05  PS-INPK-PRINTED-SW           PIC X(01) VALUE 'N'.        00058005
000590         88  PS-INPK-WAS-PRINTED                VALUE 'Y'.        00059005
000600         88  PS-INPK-NOT-PRINTED                VALUE 'N'.        00060005
000610     05  PS-CS-OVERRIDE-SW            PIC X(01) VALUE 'N'.        00061005
000620         88  PS-CS-OVERRIDE                     VALUE 'Y'.        00062005
000630         88  PS-NO-CS-OVERRIDE                  VALUE 'N'.        00063005
000640     05  PS-FIRST-PASS-SW             PIC X(01) VALUE 'Y'.        00064005
000650         88  PS-FIRST-PASS                      VALUE 'Y'.        00065005
000660         88  PS-NOT-FIRST-PASS                  VALUE 'N'.        00066005
000670* dmh - 1/5/05 - begin                                            00067005
000680     05  PS-ODD-CART-FCSE-MFST-DONE-SW     PIC X(01) VALUE 'N'.   00068005
000690         88  PS-ODD-CART-FCSE-DONE            VALUE 'Y'.          00069005
000700         88  PS-ODD-CART-FCSE-NOT-DONE        VALUE 'N'.          00070005
000710* dmh - 1/5/05 - end                                              00071005
000720     05  PS-ODD-CART-FCSE-MFST-SW     PIC X(01) VALUE 'N'.        00072005
000730         88  PS-ODD-CART-FCSE-INSERT            VALUE 'Y'.        00073005
000740         88  PS-ODD-CART-FCSE-NO-INSERT         VALUE 'N'.        00074005
000750     05  PS-ODD-CART-FCSE-LBL-PRT-SW  PIC X(01) VALUE 'N'.        00075005
000760         88  PS-ODD-CART-FCSE-LBL-NOT-PRT       VALUE 'N'.        00076005
000770         88  PS-ODD-CART-FCSE-LBL-PRTD          VALUE 'Y'.        00077005
000780     05  PS-ODD-CART-INPK-LBL-PRT-SW  PIC X(01) VALUE 'N'.        00078005
000790         88  PS-ODD-CART-INPK-LBL-NOT-PRT       VALUE 'N'.        00079005
000800         88  PS-ODD-CART-INPK-LBL-PRTD          VALUE 'Y'.        00080005
000810     05  PS-ODD-CART-P2L-LBL-PRT-SW   PIC X(01) VALUE 'N'.        00081005
000820         88  PS-ODD-CART-P2L-LBL-NOT-PRT        VALUE 'N'.        00082005
000830         88  PS-ODD-CART-P2L-LBL-PRTD           VALUE 'Y'.        00083005
000840     05  PS-ODD-CART-LABEL-SW         PIC X(01) VALUE 'N'.        00084005
000850         88  PS-NOT-ODD-CART-LABEL              VALUE 'N'.        00085005
000860         88  PS-ODD-CART-LABEL                  VALUE 'Y'.        00086005
000870     05  PS-NEW-STORE-FIXTURE-SW      PIC X(01) VALUE 'N'.        00087005
000880         88  PS-NO-NEW-STORE-FIXTURE            VALUE 'N'.        00088005
000890         88  PS-NEW-STORE-FIXTURE               VALUE 'Y'.        00089005
000900     05  PS-SOCKET-ERROR-SW           PIC X(01) VALUE 'N'.        00090005
000910         88  PS-SOCKET-ERROR-NO                 VALUE 'N'.        00091005
000920         88  PS-SOCKET-ERROR                    VALUE 'Y'.        00092005
000930     05  PS-TRANS-ID-DUP-SW           PIC X(01) VALUE 'Y'.        00093005
000940         88  PS-TRANS-ID-NOT-DUP                VALUE 'N'.        00094005
000950         88  PS-TRANS-ID-DUP                    VALUE 'Y'.        00095005
000960     05  PS-VALID-TRANS-ID-SW         PIC X(01) VALUE 'Y'.        00096005
000970         88  PS-VALID-TRANS-ID                  VALUE 'Y'.        00097005
000980         88  PS-INVALID-TRANS-ID                VALUE 'N'.        00098005
000990     05  PS-LAST-FORM-SW              PIC X(01) VALUE ' '.        00099005
001000         88  PS-LAST-FORM-SML                   VALUE 'S'.        00100005
001010         88  PS-LAST-FORM-CNTL-STK              VALUE 'C'.        00101005
001020         88  PS-LAST-FORM-NONE                  VALUE ' '.        00102005
001030     05  PS-CENTRAL-STOCK-LBL-PRT-SW  PIC X(01) VALUE 'N'.        00103005
001040         88  PS-CENTRAL-STOCK-LBL-NOT-PRT       VALUE 'N'.        00104005
001050         88  PS-CENTRAL-STOCK-LBL-PRTD          VALUE 'Y'.        00105005
001051     05  PS-FIRST-CS-LBL-PRT-SW       PIC X(01) VALUE 'N'.        00105105
001052         88  PS-FIRST-CS-LBL-NOT-PRT            VALUE 'N'.        00105205
001053         88  PS-FIRST-CS-LBL-PRT                VALUE 'Y'.        00105305
001054     05  PS-FIRST-AFTER-FORM-SW       PIC X(01) VALUE 'N'.        00105405
001055         88  PS-FIRST-AFTER-FORM-NO             VALUE 'N'.        00105505
001056         88  PS-FIRST-AFTER-FORM-YES            VALUE 'Y'.        00105605
001057     05  PS-FIRST-SML-LBL-PRT-SW      PIC X(01) VALUE 'Y'.        00105705
001058         88  PS-FIRST-SML-LBL-NOT-PRT           VALUE 'N'.        00105805
001059         88  PS-FIRST-SML-LBL-PRT               VALUE 'Y'.        00105905
001060     05  PS-EO-PREPK-CSR-SW           PIC X(01) VALUE 'N'.        00106005
001070         88  PS-EO-PREPK-CSR                    VALUE 'Y'.        00107005
001080         88  PS-NOT-EO-PREPK-CSR                VALUE 'N'.        00108005
001090     05  PS-EO-REPRINT-MNFST-CSR-SW   PIC X(01) VALUE 'N'.        00109005
001100         88  PS-EO-REPRINT-MNFST-CSR            VALUE 'Y'.        00110005
001110         88  PS-NOT-EO-REPRINT-MNFST-CSR        VALUE 'N'.        00111005
001120     05  PS-FIRST-MFST-FETCH-SW       PIC X(01) VALUE 'Y'.        00112005
001130         88  PS-FIRST-MFST-FETCH                VALUE 'Y'.        00113005
001140         88  PS-NOT-FIRST-MFST-FETCH            VALUE 'N'.        00114005
001150     05  PS-MANIFEST-DC-FOUND-SW      PIC  X(01)  VALUE 'N'.      00115005
001160         88  PS-MANIFEST-DC-FOUND                 VALUE 'Y'.      00116005
001170         88  PS-MANIFEST-DC-NOT-FND               VALUE 'N'.      00117005
001180     05  PS-BLND-RECV-SIMPL-LOC-SW    PIC  X(01)  VALUE 'N'.      00118005
001190         88  PS-BLND-RECV-SIMPL-LOC-FND           VALUE 'Y'.      00119005
001200         88  PS-BLND-RECV-SIMPL-LOC-NOT-FND       VALUE 'N'.      00120005
001210     05  PS-CS-ECOMMERCE-LINE-SW      PIC  X(01)  VALUE 'N'.      00121005
001220         88  PS-CS-ECOMMERCE-LINE-YES             VALUE 'Y'.      00122005
001230         88  PS-CS-ECOMMERCE-LINE-NO              VALUE 'N'.      00123005
001240*                                                                 00124005
001250     05  PS-INPK-UNIT-QTY-SW          PIC  X(01)  VALUE 'N'.      00125005
001260         88  PS-INPK-UNIT-QTY-YES                 VALUE 'Y'.      00126005
001270         88  PS-INPK-UNIT-QTY-NO                  VALUE 'N'.      00127005
001280*                                                                 00128005
001290     05  PS-POG-DATA-FOUND-SW         PIC X(01) VALUE 'Y'.        00129005
001300         88  PS-POG-DATA-FOUND                  VALUE 'Y'.        00130005
001310         88  PS-NO-POG-DATA-FOUND               VALUE 'N'.        00131005
001320     05  PS-SEASET-DATA-FOUND-SW      PIC X(01) VALUE 'Y'.        00132005
001330         88  PS-SEASET-DATA-FOUND               VALUE 'Y'.        00133005
001340         88  PS-NO-SEASET-DATA-FOUND            VALUE 'N'.        00134005
001350     05  PS-CALL-ITEM-DOMAIN-SW       PIC X(01) VALUE 'Y'.        00135005
001360         88  PS-CALL-ITEM-DOMAIN-YES            VALUE 'Y'.        00136005
001370         88  PS-CALL-ITEM-DOMAIN-NO             VALUE 'N'.        00137005
001380     05  PS-P2L-LABEL-PROCESS-SW      PIC X(01) VALUE 'N'.        00138005
001390         88  PS-P2L-LABEL-PROCESS               VALUE 'Y'.        00139005
001400         88  PS-NOT-P2L-LABEL-PROCESS           VALUE 'N'.        00140005
001410     05  PS-BAL-ON-HAND-QTY-SW        PIC  X(01)  VALUE 'N'.      00141005
001420         88  PS-BAL-ON-HND-QTY-ZERO               VALUE 'Y'.      00142005
001430         88  PS-BAL-ON-HND-QTY-NOT-ZERO           VALUE 'N'.      00143005
001440     05  PS-PACK-ITEMS-CSR-SW         PIC  X(01)  VALUE 'N'.      00144005
001450         88  PS-EO-PACK-ITEMS-CSR                 VALUE 'Y'.      00145005
001460         88  PS-NOT-EO-PACK-ITEMS-CSR             VALUE 'N'.      00146005
001461*CLP 06/19/2015 START                                             00146126
001470     05  PS-BRAND-FOUND-SW               PIC  X(01)  VALUE 'N'.   00147017
001480         88  PS-BRAND-FOUND-YES                      VALUE 'Y'.   00148017
001490         88  PS-BRAND-FOUND-NO                       VALUE 'N'.   00149017
001491*CLP 06/19/2015 END                                               00149126
001492     05  PS-ONHAND-FORM-CHANGE-SW        PIC  X(01)  VALUE 'N'.   00149205
001493         88  PS-ONHAND-FORM-CHANGE-YES               VALUE 'Y'.   00149305
001494         88  PS-ONHAND-FORM-CHANGE-NO                VALUE 'N'.   00149405
001495     05  PS-FIXTURE-FORM-CHANGE-SW       PIC  X(01)  VALUE 'N'.   00149505
001496         88  PS-FIXTURE-FORM-CHANGE-YES              VALUE 'Y'.   00149605
001497         88  PS-FIXTURE-FORM-CHANGE-NO               VALUE 'N'.   00149705
001498     05  PS-P2L-LABEL-DISPLAY-SW         PIC  X(01)  VALUE 'N'.   00149805
001499         88  PS-TRIP-ARRIVE-DATE-ON-LABEL            VALUE 'Y'.   00149905
001500         88  PS-P2L-MOD-ON-LABEL                     VALUE 'N'.   00150005
001501* BBR WR41309 - RFID PROCESSING                                   00150105
001502     05  PS-RFID-SKU-SW                  PIC  X(01)  VALUE 'N'.   00150205
001503         88  PS-RFID-SKU-FOUND                       VALUE 'Y'.   00150305
001504         88  PS-RFID-SKU-NOT-FOUND                   VALUE 'N'.   00150405
001505*    05  PS-RFID-SKU-FIRST-CALL-SW       PIC  X(01)  VALUE 'Y'.   00150505
001506*        88  PS-RFID-SKU-FIRST-CALL                  VALUE 'Y'.   00150605
001507*        88  PS-RFID-SKU-NOT-FIRST-CALL              VALUE 'N'.   00150705
001508* BBR WR41309 - END                                               00150805
001509* CLP 04/23/13 PR5148B START                                      00150905
001510     05  PS-RFID-ON-LABEL-SW             PIC  X(01)  VALUE 'N'.   00151005
001511         88  PS-RFID-ON-LABEL-YES                    VALUE 'Y'.   00151105
001512         88  PS-RFID-ON-LABEL-NO                     VALUE 'N'.   00151205
001513* CLP 04/23/13 PR5148B END                                        00151305
001514                                                                  00151405
001515 01  DK-KEYS.                                                     00151505
001516     05  DK-OPER-UNT-ID               PIC S9(4) COMP VALUE ZERO.  00151605
001517     05  DK-PO-NBR                    PIC S9(9) COMP VALUE ZERO.  00151705
001518     05  DK-RCVR-SEQ-NBR              PIC S9(9) COMP VALUE ZERO.  00151805
001519     05  DK-ORD-LNE-NBR               PIC S9(9) COMP VALUE ZERO.  00151905
001520     05  DK-WKORD-LNE-NBR             PIC S9(4) COMP VALUE ZERO.  00152005
001521     05  DK-STORE-NMBR                PIC 9(4)       VALUE ZERO.  00152105
001522     05  DK-STR-NBR                   PIC S9(4) COMP VALUE ZERO.  00152205
001523     05  DK-MOD-NBR                   PIC S9(4) COMP VALUE ZERO.  00152305
001524     05  DK-LPMS-TRANS-ID             PIC S9(9) COMP VALUE ZERO.  00152405
001525     05  DK-DEPT-NBR                  PIC  X(3)      VALUE ZERO.  00152505
001526     05  DK-PREPK-ID                  PIC S9(4) COMP VALUE ZERO.  00152605
001527     05  DK-SHP-REPRT-FROM-CNT        PIC S9(4) COMP VALUE ZERO.  00152705
001528     05  DK-CS-ECOMM-STORE-LOC        PIC S9(4) COMP VALUE ZERO.  00152805
001529                                                                  00152905
001530*----------------------------------------------------------------*00153005
001531*                                                                *00153105
001532*----------------------------------------------------------------*00153205
001533 01  CONNECT-ERR.                                                 00153305
001534     05  FILLER                       PIC X(12)                   00153405
001535         VALUE ' PCKCS191 - '.                                    00153505
001536     05  FILLER                       PIC X(24)                   00153605
001537         VALUE 'CONNECT-SOCKET FAILED   '.                        00153705
001538     05  FILLER                       PIC X(9)                    00153805
001539         VALUE ' ERRNO = '.                                       00153905
001540     05  CONNECT-ERRNO                PIC 9(8).                   00154005
001541                                                                  00154105
001550                                                                  00155005
001560*----------------------------------------------------------------*00156005
001570*                                                                *00157005
001580*----------------------------------------------------------------*00158005
001590 01  RECEIVE-ERR.                                                 00159005
001600     05  FILLER                       PIC X(10)                   00160005
001610         VALUE ' PCKCS191-'.                                      00161005
001620     05  FILLER                       PIC X(17)                   00162005
001630         VALUE 'RCV CNFRM FAILED '.                               00163005
001640     05  FILLER                       PIC X(7)                    00164005
001650         VALUE ' ERRNO='.                                         00165005
001660     05  RECEIVE-RETCODE              PIC 9(10)-.                 00166005
001670     05  FILLER                       PIC X(2) VALUE SPACES.      00167005
001680     05  RECEIVE-ERRNO                PIC 9(8).                   00168005
001690     05  FILLER                       PIC X(2) VALUE SPACES.      00169005
001700     05  RECEIVE-RECEIVER             PIC 9(8).                   00170005
001710     05  FILLER                       PIC X(1) VALUE '-'.         00171005
001720     05  RECEIVE-SEQ                  PIC 9(3).                   00172005
001730     05  FILLER                       PIC X(1) VALUE '-'.         00173005
001740     05  RECEIVE-LINE                 PIC 9(4).                   00174005
001750                                                                  00175005
001760                                                                  00176005
001770 01  TCP-BUF2.                                                    00177005
001780     05 TCP-BUF                          PIC  X(50)  VALUE SPACE. 00178005
001790     05 TCP-BUF-DATA                     PIC X(254)  VALUE SPACE. 00179005
001800                                                                  00180005
001810 01  PC-PROGRAM-CONSTANTS.                                        00181005
001820     05  PC-RANDOM-PGM               PIC  X(08)  VALUE 'DPKUT902'.00182005
001830     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)  VALUE 'PCKCS191'.00183005
001840     05  PC-MANIFEST-NBR-MODULE      PIC  X(08)  VALUE 'PCKCS721'.00184005
001850     05  PC-CONTAINER-UPD-TRAN       PIC  X(04)  VALUE 'I210'.    00185005
001860                                                                  00186005
001870     05  PC-HEADER-LBL-APPL          PIC  X(03)  VALUE 'HDR'.     00187005
001880     05  PC-CARTON-LBL-APPL          PIC  X(03)  VALUE 'CRT'.     00188005
001890     05  PC-CHECK-IN-LBL-APPL        PIC  X(03)  VALUE 'CKN'.     00189005
001900     05  PC-PGYBK-LBL-APPL           PIC  X(03)  VALUE 'PBK'.     00190005
001910     05  PC-P2L-LBL-APPL             PIC  X(03)  VALUE 'P2L'.     00191005
001920     05  PC-SML-DC-LBL-APPL          PIC  X(03)  VALUE 'SMD'.     00192005
001930     05  PC-SML-STORE-LBL-APPL       PIC  X(03)  VALUE 'SMS'.     00193005
001940     05  PC-SHIP-DC-LBL-APPL         PIC  X(03)  VALUE 'SHD'.     00194005
001950     05  PC-SHIP-STORE-LBL-APPL      PIC  X(03)  VALUE 'SHS'.     00195005
001960     05  PC-USER-ID-LBL-APPL         PIC  X(03)  VALUE 'UID'.     00196005
001970     05  PC-CASEPACK-SPLIT-APPL      PIC  X(03)  VALUE 'CSP'.     00197005
001980     05  PC-SOCKET-INTERFACE         PIC  X(01)  VALUE 'S'.       00198005
001990     05  PC-FTP-INTERFACE            PIC  X(01)  VALUE 'F'.       00199005
002000                                                                  00200005
002010     05  PC-COMM-IDX-MAX              PIC S9(04)  VALUE  +7       00201005
002020                                              COMP SYNC.          00202005
002030     05  PC-OUTB-IDX-MAX              PIC S9(04)  VALUE  +12      00203005
002040                                              COMP SYNC.          00204005
002050     05  PC-FTP-IDX-MAX               PIC S9(04)  VALUE  +13      00205005
002060                                              COMP SYNC.          00206005
002070     05  PC-MAX-10-REGISTER-LINES     PIC S9(04)  VALUE  +10      00207005
002080                                              COMP SYNC.          00208005
002090     05  PC-OUTB-SYSIN-LINE           PIC S9(04)  VALUE  +3       00209005
002100                                              COMP SYNC.          00210005
002110     05  PC-FTP-SYSIN-LINE            PIC S9(04)  VALUE  +5       00211005
002120                                              COMP SYNC.          00212005
002130     05  PC-MAX-RETRIES               PIC S9(04)  VALUE  +3       00213005
002140                                              COMP SYNC.          00214005
002150     05  PC-MAX-LBL-TABLE-ENTRIES     PIC S9(04)  VALUE  +3000    00215005
002160                                              COMP SYNC.          00216005
002170     05  PC-MAX-05-STRS-PER-FILE      PIC 9(02)  VALUE   5.       00217005
002180     05  PC-A                         PIC X(01)  VALUE 'A'.       00218005
002190     05  PC-CPS                       PIC X(03)  VALUE 'CPS'.     00219005
002200     05  PC-00                        PIC 9(02)  VALUE  00.       00220005
002210     05  PC-0001                      PIC 9(04)  VALUE   1.       00221005
002220     05  PC-0002                      PIC 9(04)  VALUE   2.       00222005
002230     05  PC-PROD-HLQ                  PIC X(04) VALUE 'PKMT'.     00223005
002240     05  PC-TEST-HLQ                  PIC X(04) VALUE 'TKMT'.     00224005
002250     05  PC-FTP-PC-PATH               PIC X(09) VALUE             00225005
002260                                           'C:\LM\QUE'.           00226005
002270     05  PC-FTP-SYSTEC-PC-PATH        PIC X(16)  VALUE            00227005
002280                                         'C:\PTMS\PRINTJOB'.      00228005
002290     05  PC-FTP-OTHER-PC-PATH         PIC X(14)  VALUE            00229005
002300                                         '/PTMS/PRINTJOB'.        00230005
002310     05  PC-KOHLS                     PIC X(06) VALUE 'KOHL''S'.  00231005
002320     05  PC-VOID                      PIC X(04)  VALUE 'VOID'.    00232005
002330     05  PC-MAX-RTL-TICKETS           PIC S9(04) VALUE +15        00233005
002340                                              COMP SYNC.          00234005
002350     05  PC-DEFAULT-DATE                PIC  X(26)  VALUE         00235005
002360                                   '9999-09-09-09.09.09.999999'.  00236005
002370     05  PC-F                           PIC  X(01)  VALUE 'F'.    00237005
002380     05  PC-FCSE                        PIC  X(17)  VALUE         00238005
002390                                             'UNITS   PRCS FCSE'. 00239005
002400     05  PC-INPK                        PIC  X(17)  VALUE         00240005
002410                                             'UNITS   PRCS INPK'. 00241005
002420     05  PC-P2L                         PIC  X(17)  VALUE         00242005
002430                                             'UNITS   PRCS P2L '. 00243005
002440     05  PC-NONE                        PIC  X(17)  VALUE         00244005
002450                                             '                 '. 00245005
002460     05  PC-MAX-JOB-STEPS               PIC  9(02)  VALUE 42.     00246005
002470*                                                                 00247005
002480 01  PV-COUNTERS.                                                 00248005
002490     05  PV-PT-LABEL-TABLE-ENTRIES    PIC S9(04)  VALUE +0.       00249005
002500                                                                  00250005
002510     05  PV-DPKUT038                  PIC X(08)  VALUE 'DPKUT038'.00251005
002520     05  PV-DPKUT038-CA-LENGTH        PIC S9(04) VALUE +1237      00252005
002530                                                 COMP.            00253005
002540     05  PV-DPKUT038-CICS-RESP        PIC S9(04) VALUE +0         00254005
002550                                                 COMP SYNC.       00255005
002560     05  PV-DPKUT038-DATE             PIC X(06)  VALUE SPACES.    00256005
002570     05  PV-DPKUT038-DATE-R REDEFINES PV-DPKUT038-DATE.           00257005
002580         10 PV-DPKUT038-YY               PIC  X(02).              00258005
002590         10 PV-DPKUT038-MM               PIC  X(02).              00259005
002600         10 PV-DPKUT038-DD               PIC  X(02).              00260005
002610     05  PV-DPKUT038-MJR-CL.                                      00261005
002620         10 FILLER                       PIC  X(01) VALUE SPACE.  00262005
002630         10 PV-DPKUT038-MJR-CL-2         PIC  X(01) VALUE SPACE.  00263005
002640*                                                                 00264005
002650     05  PV-INPK-RETRY-COUNTER        PIC  9(04) VALUE ZERO.      00265005
002660     05  PV-ODD-CRTN-INPK-LBLS-NEED   PIC  9(04) VALUE ZERO.      00266005
002670     05  PV-ODD-CRTN-INPK-LBLS-NOT-NEED PIC  9(04) VALUE ZERO.    00267005
002680     05  PV-ODD-CRTN-INPK-LBLS-PRTD   PIC  9(04) VALUE ZERO.      00268005
002690     05  PV-ODD-CRTN-INPK-START.                                  00269005
002700         10  FILLER                   PIC  X(01).                 00270005
002710         10  PV-ODD-CRTN-INPK-LBL-NO  PIC  9(02).                 00271005
002720     05  PV-RESULT                    PIC S9(05) VALUE ZERO       00272005
002730                                                 COMP-3.          00273005
002740     05  PV-REMAINDER                 PIC S9(05) VALUE ZERO       00274005
002750                                                 COMP-3.          00275005
002760     05  PV-COUNT                     PIC S9(07) VALUE ZERO       00276005
002770                                                 COMP-3.          00277005
002780     05  PV-LABEL-COUNTER             PIC S9(07) VALUE ZERO       00278005
002790                                                 COMP-3.          00279005
002800     05  PV-STORE-COUNTER             PIC S9(05) VALUE ZERO       00280005
002810                                                 COMP-3.          00281005
002820     05  PV-DB2-COUNT                    PIC S9(09)   VALUE +0    00282005
002830                                                      COMP-3.     00283005
002840     05  PV-DISTRO-SUM                PIC S9(07) VALUE ZERO       00284005
002850                                                 COMP-3.          00285005
002860     05  PV-DISTRO-SUM-DISPLAY        PIC  9(04)-.                00286005
002870     05  PV-DISTRO-IDX-DISPLAY        PIC  9(04).                 00287005
002880     05  PV-DISTRO-FCSE-ODD           PIC S9(07) VALUE ZERO       00288005
002890                                                 COMP-3.          00289005
002900     05  PV-SHUFFLE-SUM               PIC S9(07) VALUE ZERO       00290005
002910                                                 COMP-3.          00291005
002920     05  PV-SHUFFLE-AVG               PIC S9(07) VALUE ZERO       00292005
002930                                                 COMP-3.          00293005
002940     05  PV-LOOP-LIMIT                PIC S9(07) VALUE ZERO       00294005
002950                                                 COMP-3.          00295005
002960     05  PV-NBR-OF-STRS               PIC S9(07) VALUE ZERO       00296005
002970                                                 COMP-3.          00297005
002980     05  PV-NEW-LABEL-SEQ-QTY         PIC S9(07) VALUE ZERO       00298005
002990                                                 COMP-3.          00299005
003000     05  PV-P2L-COUNT-LESS-ODD        PIC 9(04)  VALUE ZERO.      00300005
003010     05  PV-P2L-COUNT                 PIC 9(04)  VALUE ZERO.      00301005
003020     05  PV-PGYBK-COUNT               PIC 9(04)  VALUE ZERO.      00302005
003030     05  PV-RTL-TKT-CNT               PIC 9(03)  VALUE ZEROS.     00303005
003040     05  PV-CS-TOT-CTNS-FCSE          PIC 9(05)  VALUE ZEROS.     00304005
003050     05  PV-CS-TOT-CTNS-INPK          PIC 9(05)  VALUE ZEROS.     00305005
003060     05  PV-ORIG-CS-QTY-FCSE          PIC 9(05)  VALUE ZEROS.     00306005
003070     05  PV-ORIG-CS-QTY-INPK          PIC 9(05)  VALUE ZEROS.     00307005
003080     05  PV-REPRINT-QTY               PIC 9(05)  VALUE ZEROS.     00308005
003090     05  PV-STR-ONHAND-ZERO-COUNT     PIC 9(04)  VALUE ZEROS.     00309005
003100                                                                  00310005
003110 01  PV-PROGRAM-VARIABLES.                                        00311005
003120     05  PV-PREPACK-IND               PIC  9(4)  VALUE ZERO.      00312005
003130     05  PV-DISPLAY-SOCKETS           PIC  9(8)  VALUE ZERO.      00313005
003140     05  PV-DISPLAY-SOCKNO            PIC  9(8)- VALUE ZERO.      00314005
003150     05  PV-DISPLAY-SHIPT-UNT-ID      PIC 9(18)  VALUE ZERO.      00315005
003160     05  PV-DISPLAY-ITEM-NBR          PIC 9(18)  VALUE ZERO.      00316005
003170     05  PV-DISPLAY-LBL-PRT-SEQ       PIC 9(09)  VALUE ZERO.      00317005
003180     05  PV-CL-NBR                    PIC X(02)  VALUE SPACES.    00318005
003190     05  PV-TOTAL-LABELS-FOR-STORE    PIC S9(09) VALUE ZERO       00319005
003200                                                     COMP.        00320005
003210     05  PV-OB-CART-TOT-LBLS          PIC S9(09) VALUE ZERO       00321005
003220                                                     COMP.        00322005
003230     05  PV-OB-CART-UPD-COUNTER       PIC S9(09) VALUE ZERO       00323005
003240                                                     COMP.        00324005
003250     05  PV-OB-CART-DISPLAY           PIC 9(09) VALUE ZERO.       00325005
003260                                                                  00326005
003261     05  PV-OB-CART-DISPLAY-2         PIC 9(09) VALUE ZERO.       00326105
003262                                                                  00326205
003263*    05  PV-OB-CART-UPD-COUNTER       PIC 9(04) VALUE ZERO.       00326305
003264     05  PV-OB-CART-LBL-PRT-SEQ       PIC S9(09) VALUE ZERO       00326405
003265                                                     COMP.        00326505
003266     05  PV-INSERT-COUNTER            PIC 9(04) VALUE ZERO.       00326605
003267     05  PV-FCSE-COUNTER              PIC 9(04) VALUE ZERO.       00326705
003268     05  PV-INPK-COUNTER              PIC 9(04) VALUE ZERO.       00326805
003269     05  PV-DISTDT-UNT-QTY            PIC S9(09) VALUE ZERO       00326905
003270                                                     COMP.        00327005
003280     05  PV-DISTDT-UNT-QTY-LESS-ODD   PIC S9(09) VALUE ZERO       00328005
003290                                                     COMP.        00329005
003300     05  PV-PO-RCVR-SEQ-NBR.                                      00330005
003301         10  PV-PO-NBR                PIC ZZZZZZZ9 VALUE ZERO.    00330105
003302         10  PV-PO-DASH               PIC X(01) VALUE '-'.        00330205
003303         10  PV-RCVR-SEQ-NBR          PIC 9(03) VALUE ZERO.       00330305
003304     05  PV-ORIG-FCSE-CTN-CNT         PIC 9(04) VALUE ZERO.       00330405
003305     05  PV-ORIG-FCSE-CTN-CNT-NEW     PIC 9(04) VALUE ZERO.       00330505
003306     05  PV-ORIG-INPK-CTN-CNT         PIC 9(04) VALUE ZERO.       00330605
003307     05  PV-ORIG-INPK-CTN-CNT-NEW     PIC 9(04) VALUE ZERO.       00330705
003308     05  PV-ORIG-P2L-CTN-CNT          PIC 9(04) VALUE ZERO.       00330805
003309     05  PV-WORK-COUNT                PIC ZZZ9  VALUE ZERO.       00330905
003310     05  PV-WORK-UNTS                 PIC ZZZ9  VALUE ZERO.       00331005
003320     05  PV-LBL-DEPT-CLASS.                                       00332005
003330         10  PV-LBL-DEPT              PIC X(03) VALUE ZEROS.      00333005
003340         10  FILLER                   PIC X(01) VALUE '-'.        00334005
003350         10  PV-LBL-CLASS             PIC X(02) VALUE ZEROS.      00335005
003360     05  PV-TKT-DEPT-CL-SUB.                                      00336005
003370         10  PV-TKT-DEPT              PIC 9(03) VALUE ZEROS.      00337005
003380         10  FILLER                   PIC X(01) VALUE SPACE.      00338005
003390         10  PV-TKT-MAJ-CL            PIC 9(02) VALUE ZEROS.      00339005
003400         10  FILLER                   PIC X(01) VALUE SPACE.      00340005
003410         10  PV-TKT-SUB-CL            PIC 9(02) VALUE ZEROS.      00341005
003420     05  PV-DEPT-CLASS-SKU.                                       00342005
003430         10  FILLER                   PIC X(01) VALUE '('.        00343005
003440         10  PV-DCS-DEPT              PIC X(03) VALUE ZEROS.      00344005
003450         10  FILLER                   PIC X(01) VALUE '-'.        00345005
003460         10  PV-DCS-CLASS             PIC X(02) VALUE ZEROS.      00346005
003470         10  FILLER                   PIC X(01) VALUE ')'.        00347005
003480         10  PV-DCS-SKU               PIC X(08) VALUE SPACES.     00348005
003490     05  PV-EDIT-PREPK-ID.                                        00349005
003500         10  FILLER                   PIC X(05) VALUE 'PACK-'.    00350005
003510         10  PV-EDIT-PREPK-NBR        PIC 9(04) VALUE ZEROS.      00351005
003520     05  PV-STORES-PROCESSED          PIC 9(02) VALUE ZEROS.      00352005
003530     05  PV-CICS-RESPONSE             PIC S9(9) VALUE ZERO        00353005
003540                                                COMP SYNC.        00354005
003550     05  PV-CICS-RESP                 PIC S9(9) VALUE ZERO        00355005
003560                                                COMP SYNC.        00356005
003570     05  PV-PERFORM-START             PIC S9(04) VALUE ZERO       00357005
003580                                                 COMP SYNC.       00358005
003590     05  PV-VOID-TKT-START            PIC S9(04) VALUE ZERO       00359005
003600                                                 COMP SYNC.       00360005
003610     05  PV-READ-LENGTH               PIC S9(04) VALUE ZERO       00361005
003620                                                 COMP SYNC.       00362005
003630     05  PV-NBR-OF-LABELS             PIC S9(09) VALUE ZERO       00363005
003640                                                 COMP SYNC.       00364005
003650     05  PV-RBA                       PIC S9(09) VALUE ZERO       00365005
003660                                                 COMP SYNC.       00366005
003670                                                                  00367005
003680     05  PV-X                         PIC 9(03) VALUE ZEROS.      00368005
003690     05  PV-Q                         PIC 9(03) VALUE ZEROS.      00369005
003700     05  PV-R                         PIC 9(01) VALUE ZEROS.      00370005
003710     05  PV-MOD-10-CK-DGT             PIC 9(01) VALUE ZEROS.      00371005
003720     05  PV-HOLD-STORE-NBR-PFX        PIC 9(02) VALUE ZEROS.      00372005
003730     05  PV-STORE-NBR.                                            00373005
003740         10  PV-STORE-NBR-PFX         PIC 9(01) VALUE ZEROS.      00374005
003750         10  PV-STORE-NBR-4           PIC 9(04) VALUE ZEROS.      00375005
003760                                                                  00376005
003770     05  PV-HOLD-DEST-LOC             PIC  S9(4) COMP.            00377005
003780     05  PV-KEY-DEST-LOC              PIC  S9(4) COMP.            00378005
003790     05  PV-PC-CNTL-CDE               PIC 9(03) VALUE ZEROS.      00379005
003800     05  PV-PC-CNTL-CDE-X        REDEFINES                        00380005
003810         PV-PC-CNTL-CDE               PIC X(03).                  00381005
003820     05  PV-PC-CNTL-CDE-HOLD          PIC 9(03) VALUE ZEROS.      00382005
003830     05  PV-LBL-SEQ-NBR               PIC 9(07) VALUE ZEROS.      00383005
003840     05  PV-LBL-SEQ-NBR-R        REDEFINES                        00384005
003850         PV-LBL-SEQ-NBR.                                          00385005
003860         10  PV-LBL-SEQ-NBR-1-5       PIC X(05).                  00386005
003870         10  PV-LBL-SEQ-NBR-6-7       PIC X(02).                  00387005
003880                                                                  00388005
003890     05  PV-LBL-COPIES-NEEDED         PIC 9(04) VALUE ZEROS.      00389005
003900                                                                  00390005
003910     05  PV-WORK-DATE                 PIC X(05) VALUE SPACES.     00391005
003920     05  PV-TYPE-CODE                 PIC X(01) VALUE SPACES.     00392005
003930         88  PV-CS-DC-RTV                       VALUES 'A',       00393005
003940                                                       'B',       00394005
003950                                                       'C',       00395005
003960                                                       'D',       00396005
003970                                                       'E'.       00397005
003980         88  PV-CENTRAL-STOCK                   VALUE  'C'.       00398005
003990         88  PV-E-COMMERCE                      VALUES 'D'.       00399005
004000         88  PV-E-COMMERCE-PRPK                 VALUES 'E'.       00400005
004100         88  PV-DS-STORE                        VALUES 'F'.       00410005
004110                                                                  00411005
004120     05  PV-DB2-CURRENT-DATE          PIC X(10) VALUE SPACES.     00412005
004130                                                                  00413005
004140     05  PV-CURRENT-DATE                 PIC X(10)  VALUE SPACES. 00414005
004150     05  PV-CURRENT-DATE-R REDEFINES     PV-CURRENT-DATE.         00415005
004160         10 PV-CURRENT-CC                PIC  9(02).              00416005
004170         10 PV-CURRENT-YY                PIC  9(02).              00417005
004180         10 FILLER                       PIC  X(01).              00418005
004190         10 PV-CURRENT-MM                PIC  9(02).              00419005
004200         10 FILLER                       PIC  X(01).              00420005
004210         10 PV-CURRENT-DD                PIC  9(02).              00421005
004220     05  PV-CURRENT-TIME                 PIC X(08)  VALUE SPACES. 00422005
004230     05  PV-CURRENT-TIME-R REDEFINES     PV-CURRENT-TIME.         00423005
004240         10 PV-CURRENT-HR                PIC  9(02).              00424005
004250         10 FILLER                       PIC  X(01).              00425005
004260         10 PV-CURRENT-MN                PIC  9(02).              00426005
004270         10 FILLER                       PIC  X(03).              00427005
004280                                                                  00428005
004290     05  PV-LBL-PRT-DATE.                                         00429005
004300         10  PV-LBL-PRT-MM            PIC 9(02)      VALUE ZEROES.00430005
004310         10  FILLER                   PIC X(01)      VALUE '-'.   00431005
004320         10  PV-LBL-PRT-DD            PIC 9(02)      VALUE ZEROES.00432005
004330         10  FILLER                   PIC X(01)      VALUE '-'.   00433005
004340         10  PV-LBL-PRT-YY            PIC 9(02)      VALUE ZEROES.00434005
004350     05  PV-LBL-PRT-TIME.                                         00435005
004360         10  PV-LBL-PRT-HR            PIC 9(02)      VALUE ZEROES.00436005
004370         10  FILLER                   PIC X(01)      VALUE ':'.   00437005
004380         10  PV-LBL-PRT-MN            PIC 9(02)      VALUE ZEROES.00438005
004390     05  PV-DSPLY-PRTR                   PIC  X(07)  VALUE SPACES.00439005
004400     05  PV-DSPLY-PRTR-R REDEFINES PV-DSPLY-PRTR.                 00440005
004410         10  PV-DSPLY-NBR-SIGN           PIC  X(01).              00441005
004420         10  PV-DSPLY-DC                 PIC  X(02).              00442005
004430         10  PV-DSPLY-DASH               PIC  X(01).              00443005
004440         10  PV-DSPLY-PRTR-ID            PIC  X(03).              00444005
004450                                                                  00445005
004460     05  PV-DSPLY-PRTR2                  PIC  X(06)  VALUE SPACES.00446005
004470     05  PV-DSPLY-PRTR2-R REDEFINES PV-DSPLY-PRTR2.               00447005
004480         10  PV-DSPLY-DC-2               PIC  X(02).              00448005
004490         10  PV-DSPLY-DASH-2             PIC  X(01).              00449005
004500         10  PV-DSPLY-PRTR-ID-2          PIC  X(03).              00450005
004510                                                                  00451005
004520     05  PV-IP-ADDRESS.                                           00452005
004530         10  PV-IP-ADDR-NUM1             PIC 9(03).               00453005
004540             88  PV-IP-ADDR-NUM1-VALID              VALUE 1 THRU  00454005
004550                                                          255.    00455005
004560         10  PV-IP-ADDR-DOT1             PIC X(01).               00456005
004570             88  PV-IP-ADDR-DOT1-VALID              VALUE '.'.    00457005
004580         10  PV-IP-ADDR-NUM2             PIC 9(03).               00458005
004590             88  PV-IP-ADDR-NUM2-VALID              VALUE 1 THRU  00459005
004600                                                          255.    00460005
004610         10  PV-IP-ADDR-DOT2             PIC X(01).               00461005
004620             88  PV-IP-ADDR-DOT2-VALID              VALUE '.'.    00462005
004630         10  PV-IP-ADDR-NUM3             PIC 9(03).               00463005
004640             88  PV-IP-ADDR-NUM3-VALID              VALUE 1 THRU  00464005
004650                                                          255.    00465005
004660         10  PV-IP-ADDR-DOT3             PIC X(01).               00466005
004670             88  PV-IP-ADDR-DOT3-VALID              VALUE '.'.    00467005
004680         10  PV-IP-ADDR-NUM4             PIC 9(03).               00468005
004690             88  PV-IP-ADDR-NUM4-VALID              VALUE 1 THRU  00469005
004700                                                          255.    00470005
004710                                                                  00471005
004720     05  PV-HEX-FIELD.                                            00472005
004730         10  PV-HEX-FIELD-1              PIC X(01).               00473005
004740         10  PV-HEX-FIELD-2              PIC X(01).               00474005
004750         10  PV-HEX-FIELD-3              PIC X(01).               00475005
004760         10  PV-HEX-FIELD-4              PIC X(01).               00476005
004770     05  PV-HEX-FIELD-NUMBER REDEFINES PV-HEX-FIELD               00477005
004780                                         PIC 9(08)  COMP.         00478005
004790     05  PV-HEX-NUMERIC                  PIC 9(04) BINARY.        00479005
004800     05  PV-HEX-CHAR REDEFINES PV-HEX-NUMERIC.                    00480005
004810         10  PV-HEX-CHAR-1               PIC X(01).               00481005
004820         10  PV-HEX-CHAR-2               PIC X(01).               00482005
004830                                                                  00483005
004840     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.00484005
004850     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          00485005
004860         10  PV-RANDOM-1-8               PIC  9(08).              00486005
004870         10  FILLER                      PIC  9(01).              00487005
004880     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.00488005
004890     05  PV-LPMS-XMIT-RETURN             PIC  X(01)  VALUE SPACES.00489005
004900     05  PV-TRAILER-COUNT                PIC  9(07)  VALUE ZERO.  00490005
004910     05  PV-CICS-MSG-AREA                PIC  X(100) VALUE SPACES.00491005
004920     05  PV-RETCODE                      PIC  9(08)- VALUE ZERO.  00492005
004930     05  PV-ERRNO                        PIC  9(08)- VALUE ZERO.  00493005
004940     05  PV-SOCK-ID                      PIC  9(04)  VALUE ZERO.  00494005
004950     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00495005
004960                                                     COMP SYNC.   00496005
004970     05  PV-TOT-4X4-LBL-COUNT            PIC  9(09)  VALUE ZERO.  00497005
004980     05  PV-DIVIDER-LABEL-COUNT          PIC  9(09)  VALUE ZERO.  00498005
004990     05  PV-FCSE-INPK-LBL-QTY            PIC  9(09)  VALUE ZERO.  00499005
005000     05  PV-PRINTER-HOLD.                                         00500005
005010         10  PV-PRINTER-1-3              PIC  9(03).              00501005
005020         10  FILLER                      PIC  X(05).              00502005
005030     05  PV-DISPLAY-LPMS-TRAN            PIC  X(08)  VALUE SPACE. 00503005
005040     05  PV-DISPLAY-MANIFEST             PIC  X(09)  VALUE SPACE. 00504005
005050     05  PV-DISPLAY-BATCH-NO             PIC  9(04)  VALUE ZEROS. 00505005
005060     05  PV-DISPLAY-SOCK-ID              PIC  9(04)  VALUE ZEROS. 00506005
005070     05  PV-DISPLAY-FLAG                 PIC  9(08)  VALUE ZEROS. 00507005
005080     05  PV-DISPLAY-NBR-BYTES            PIC  9(08)  VALUE ZEROS. 00508005
005090     05  PV-DISPLAY-FAMILY               PIC  9(04)  VALUE ZEROS. 00509005
005100     05  PV-DISPLAY-PORT                 PIC  9(04)  VALUE ZEROS. 00510005
005110     05  PV-DISPLAY-IP-ADDR              PIC  9(08)  VALUE ZEROS. 00511005
005120     05  PV-DISPLAY-CURR-OPER            PIC  9(04)  VALUE ZEROS. 00512005
005130     05  PV-DISPLAY-EIBCALEN             PIC s9(04)  VALUE zeroes.00513005
005140     05  PV-DISPLAY-SQLCODE              PIC s9(08)  VALUE zeroes.00514005
005150     05  PV-DISPLAY-DOWNLOAD.                                     00515005
005160         10  PV-DISPLAY-DOWNLOAD-1       PIC  X(80)  VALUE SPACE. 00516005
005170         10  Pv-DISPLAY-DOWNLOAD-2       PIC  X(80)  VALUE SPACE. 00517005
005180         10  PV-DISPLAY-DOWNLOAD-3       PIC  X(80)  VALUE SPACE. 00518005
005190     05  PV-DISPLAY-PO-NBR              PIC  9(08) VALUE ZEROES.  00519005
005200     05  PV-DISPLAY-RCVR-SEQ-NBR        PIC  9(03) VALUE ZEROES.  00520005
005210     05  PV-DISPLAY-LNE-NBR             PIC  9(04) VALUE ZEROES.  00521005
005220     05  PV-DISPLAY-ODD-CRTN-QTY        PIC  9(04) VALUE ZEROES.  00522005
005230     05  PV-DISPLAY-OTPK-UNT-QTY        PIC  9(04) VALUE ZEROES.  00523005
005240     05  PV-DISPLAY-STORE               PIC  9(04) VALUE ZEROES.  00524005
005250     05  PV-PREPK-OTPK-UNT-QTY           PIC S9(09)  VALUE ZEROES 00525005
005260                                                     COMP.        00526005
005270     05  PV-PREPK-MULTIPLE               PIC S9(09)  VALUE ZEROES 00527005
005280                                                     COMP.        00528005
005290     05  PV-SEASET-SHRT-NM           PIC  X(25)  VALUE SPACES.    00529005
005300     05  PV-SEASET-RLSE-DT           PIC  X(10)  VALUE SPACES.    00530005
005310                                                                  00531005
005320* BBR WR41309 - RFID PROCESSING                                   00532005
005330     05  PV-RFID-STORE.                                           00533005
005340         10 PV-RFID-STORE-TXT-4       PIC X(12) VALUE             00534005
005350                                       '***@RFID@***'.            00535005
005360* BBR WR41309 - END                                               00536005
005370     05  PV-FIRST-STORE-RCPT.                                     00537005
005380         10 PV-FIRST-STORE-RCPT-TXT-1 PIC X(12) VALUE             00538005
005390                                       '@@@@NEW@@@@@'.            00539005
005400         10 PV-FIRST-STORE-RCPT-TXT-2 PIC X(12) VALUE             00540005
005410                                       '@@@@@TO@@@@@'.            00541005
005420         10 PV-FIRST-STORE-RCPT-TXT-3 PIC X(12) VALUE             00542005
005430                                       '@@@STORE@@@@'.            00543005
005440 01  PV-JCL-VARIABLES.                                            00544005
005450     05  PV-PC-FILE-NAME.                                         00545005
005460         10  PV-PC-FILE-PRT-ID        PIC X(03) VALUE SPACES.     00546005
005470         10  PV-PC-FILE-ID-1          PIC X(05) VALUE SPACES.     00547005
005480         10  FILLER                   PIC X(01) VALUE '.'.        00548005
005490         10  PV-PC-FILE-ID-2          PIC X(02) VALUE SPACES.     00549005
005500         10  FILLER                   PIC X(01) VALUE 'L'.        00550005
005510                                                                  00551005
005520     05  PV-JOB-NAME.                                             00552005
005530         10  PV-JOB-PREFIX            PIC X(03) VALUE 'PCK'.      00553005
005540         10  PV-JOB-SUFFIX            PIC X(01) VALUE SPACES.     00554005
005550         10  FILLER                   PIC 9(02) VALUE 02.         00555005
005551         10  PV-JOB-DC                PIC X(02) VALUE SPACES.     00555105
005552                                                                  00555205
005553     05  PV-OUTBOUND-APPL-ID.                                     00555305
005554         10  PV-OBN-ID-PREFIX         PIC X(06) VALUE 'OUTBND'.   00555405
005555         10  PV-OBN-ID-SUFFIX         PIC X(02) VALUE SPACE.      00555505
005556     05  PV-RETRY-COUNTER             PIC S9(04) VALUE ZERO       00555605
005557                                                 COMP SYNC.       00555705
005558     05  PV-SQL-RETURN-CD             PIC 999-.                   00555805
005559     05  PV-HEAT-LEVEL                PIC X(02) VALUE SPACES.     00555905
005560     05  PV-3-DIGIT-PRT-ID.                                       00556005
005570         10  PV-CLUSTER-CD            PIC X(01) VALUE SPACES.     00557005
005580         10  PV-2-DIGIT-PRT-ID        PIC X(02) VALUE SPACES.     00558005
005590     05  PV-3-DIGIT-PRT-ID-NBR REDEFINES                          00559005
005600         PV-3-DIGIT-PRT-ID            PIC 9(03).                  00560005
005610     05  PV-USER-ID-8.                                            00561005
005620         10  PV-USER-ID               PIC X(07) VALUE SPACES.     00562005
005630         10  FILLER                   PIC X(01) VALUE 'Q'.        00563005
005640     05  PV-SYSTEM-ID.                                            00564005
005650         10  FILLER                   PIC X(04) VALUE SPACE.      00565005
005660         10  PV-REGION-IND            PIC X(01).                  00566005
005670             88  PV-TEST-CICS                 VALUE 'T'.          00567005
005680             88  PV-QA-CICS                   VALUE 'Q'.          00568005
005690             88  PV-PROD-CICS                 VALUE 'P'.          00569005
005700             88  PV-LEARN-CICS                VALUE 'L'.          00570005
005710         10  FILLER                   PIC X(01) VALUE SPACES.     00571005
005720     05  PV-OBN-WAIT-TIME             PIC X(03) VALUE SPACES.     00572005
005730     05  PV-LABEL-NAME                PIC X(23) VALUE SPACES.     00573005
005740     05  PV-ABS-TIME                  PIC S9(15) COMP-3.          00574005
005750                                                                  00575005
005760     05  PV-DATE-TIME.                                            00576005
005770         10  PV-DATE                  PIC X(10) VALUE SPACES.     00577005
005780         10  FILLER                   PIC X(01) VALUE SPACES.     00578005
005790         10  PV-TIME                  PIC X(08) VALUE SPACES.     00579005
005800     05  PV-JOB-STEP-NBR.                                         00580005
005810         10  FILLER                   PIC X(04) VALUE '//PS'.     00581005
005820         10  PV-JOB-STEP-CNT          PIC 9(02) VALUE ZEROS.      00582005
005830         10  FILLER                   PIC 9(01) VALUE ZEROS.      00583005
005840     05  PV-JOB-STEP-NBR-R       REDEFINES                        00584005
005850         PV-JOB-STEP-NBR.                                         00585005
005860         10  FILLER                   PIC X(02).                  00586005
005870         10  PV-PROC-STEP             PIC X(05).                  00587005
005880     05  PV-JCL-LINE-EOF.                                         00588005
005890         10  FILLER                   PIC X(06) VALUE             00589005
005900             '/*EOF '.                                            00590005
005910         10  FILLER                   PIC X(74) VALUE SPACES.     00591005
005920                                                                  00592005
005930     05  PV-DIVERT-CODE               PIC 9(04) VALUE ZEROS.      00593005
005940     05  PV-DIVERT-CODE-X REDEFINES PV-DIVERT-CODE.               00594005
005950         10  PV-DIVERT-CODE-1-4       PIC X(04).                  00595005
005960     05  PV-ZZZ9                      PIC ZZZ9.                   00596005
005970     05  PV-ZZZZZ9                    PIC ZZZZZ9.                 00597005
005980     05  PV-GP-RTL-AMT-PRINT.                                     00598005
005990         10  PV-GP-QTY                PIC Z9 VALUE ZEROS.         00599005
006000         10  FILLER                   PIC X(01) VALUE '/'.        00600005
006010         10  PV-GP-RTL-AMT-X          PIC X(06) VALUE SPACES.     00601005
006020     05  PV-GP-RTL-AMT                PIC $$$.99 VALUE ZEROS.     00602005
006030     05  PV-RTL-PR-AMT                PIC $$,$$$.99               00603005
006040                                              VALUE ZEROS.        00604005
006050     05  PV-UPC-CODE-12-DIGIT         PIC 9(12) VALUE ZEROS.      00605005
006060     05  PV-UPC-CODE                  PIC 9(12) VALUE ZEROS.      00606005
006070     05  PV-UPC-CODE-X           REDEFINES                        00607005
006080         PV-UPC-CODE.                                             00608005
006090         10  PV-UPC-CODE-1            PIC X(01).                  00609005
006100         10  PV-UPC-CODE-2-6          PIC X(05).                  00610005
006110         10  PV-UPC-CODE-7-11         PIC X(05).                  00611005
006120         10  PV-UPC-CODE-12           PIC X(01).                  00612005
006130     05  PV-UPC-CODE-X2          REDEFINES                        00613005
006140         PV-UPC-CODE.                                             00614005
006150         10  PV-UPC-CODE-1-11         PIC 9(11).                  00615005
006160         10  FILLER                   PIC X(01).                  00616005
006170     05  PV-UPC-CODE-PRT.                                         00617005
006180         10  PV-UPC-CODE-PRT-1        PIC X(01) VALUE SPACES.     00618005
006190         10  FILLER                   PIC X(01) VALUE SPACES.     00619005
006200         10  PV-UPC-CODE-PRT-2-6      PIC X(05) VALUE SPACES.     00620005
006210         10  FILLER                   PIC X(01) VALUE SPACES.     00621005
006220         10  PV-UPC-CODE-PRT-7-11                                 00622005
006230                                      PIC X(05) VALUE SPACES.     00623005
006240         10  FILLER                   PIC X(01) VALUE SPACES.     00624005
006250         10  PV-UPC-CODE-PRT-12       PIC X(01) VALUE SPACES.     00625005
006260     05  PV-PRC-FCLTY-AREA-ID         PIC  X(06)  VALUE SPACES.   00626005
006270     05  PV-MANIFEST-DISPLAY          PIC 9(07) VALUE ZEROES.     00627005
006280     05  PV-WORK-RCVR-NBR.                                        00628005
006290         10  FILLER                   PIC X(01) VALUE SPACES.     00629005
006300         10  PV-WORK-REC-SEQ-NBR      PIC X(02) VALUE SPACES.     00630005
006310     05  PV-TICKET-LIMIT              PIC 9(02) VALUE ZERO.       00631005
006320*                                                                 00632005
006330     05  PV-ITEM-NBR-16-POS           PIC 9(16) VALUE ZERO.       00633005
006340     05  PV-PO-ITM-UNITS-BC           PIC X(21) VALUE ZERO.       00634005
006350     05  PV-PO-ITM-UNITS-BC-R REDEFINES PV-PO-ITM-UNITS-BC.       00635005
006360         10  PV-BC-PO-NBR-BC          PIC 9(09).                  00636005
006370         10  PV-BC-ITEM-NBR-BC        PIC 9(08).                  00637005
006380         10  PV-BC-UNITS-BC           PIC 9(04).                  00638005
006390     05  PV-PO-ITM-UNITS-NBR          PIC X(23) VALUE SPACES.     00639005
006400     05  PV-PO-ITM-UNITS-NBR-R REDEFINES PV-PO-ITM-UNITS-NBR.     00640005
006410         10  PV-BC-PO-NBR             PIC 9(09).                  00641005
006420         10  filler                   PIC X(01).                  00642005
006430         10  PV-BC-ITEM-NBR           PIC 9(08).                  00643005
006440         10  filler                   PIC X(01).                  00644005
006450         10  PV-BC-UNITS              PIC 9(04).                  00645005
006460     05  PV-PACK-RATIO                PIC 9(04) VALUE ZERO.       00646005
006470     05  PV-PACK-RATIO-R REDEFINES PV-PACK-RATIO.                 00647005
006480         10  FILLER                   PIC X(01).                  00648005
006490         10  PV-PACK-RATIO-3          PIC 9(03).                  00649005
006500     05  PV-PC126-OPER-UNT-ID.                                    00650005
006510         10  FILLER                   PIC X.                      00651005
006520         10  PV-PC126-OPER-3-POS      PIC X(03).                  00652005
006530     05  PV-PC126-PACKS-IN-CRTN       PIC S9(04) VALUE ZEROES     00653005
006540                                                 COMP.            00654005
006550     05  PV-PREPK-OUTER-PK            PIC S9(04) VALUE ZEROES     00655005
006560                                                 COMP.            00656005
006570     05  PV-ADJUSTED-LBL-QTY          PIC  9(04) VALUE ZEROES.    00657005
006580     05  PV-LBL-PRT-QTY               PIC  X(04) VALUE SPACES.    00658005
006590     05  PV-LBL-PRT-QTY-R  REDEFINES  PV-LBL-PRT-QTY.             00659005
006600         10  PV-LBL-PRT-QTY-N         PIC  9(04).                 00660005
006610     05  PV-LBL-PRT-QTY-NUMERIC       PIC S9(09) COMP-3.          00661005
006620     05  PV-TOTAL-LABELS-NUMERIC      PIC S9(09) COMP-3.          00662005
006630     05  PV-LBL-PRT-QTY-NUM-UPD       PIC S9(09) COMP-3.          00663005
006640     05  PV-LBL-PRT-QTY-NUM-CALC      PIC  9(04).                 00664005
006641*CLP 06/19/2015 START                                             00664130
006642     05  PV-CHAR-COUNT                PIC S9(04)  VALUE ZEROS     00664230
006643                                                 COMP SYNC.       00664330
006644     05  PV-BUS-AREA-BRAND        PIC  X(35)    VALUE SPACES.     00664434
006645     05  PV-DESC-LEN              PIC S9(04) VALUE +0             00664542
006646                                                COMP.             00664643
006647     05  PV-BUS-AREA-DESC-9       PIC  X(09)    VALUE SPACES.     00664743
006648*CLP 06/19/2015 END                                               00664830
006650*                                                                 00665005
006660     05  PV-OB-CART-BARCODE.                                      00666005
006670         10 FILLER                    PIC  9(02).                 00667005
006671         10 PV-OB-CART-BRCDE-18       PIC  9(18).                 00667105
006672         10 FILLER                    PIC  9(02).                 00667205
006673     05  PV-FIRST-MANIFEST            PIC  9(18).                 00667305
006674     05  PV-LAST-MANIFEST             PIC  9(18).                 00667405
006675*                                                                 00667505
006676     05  PV-SML-NUMBER-HOLD.                                      00667605
006677         10 FILLER                    PIC  X(17).                 00667705
006678         10 PV-SML-MANIFEST-HOLD      PIC  9(08).                 00667805
006679     05  PV-SML-NUMBER-HOLD-BRCDE.                                00667905
006680         10 FILLER                    PIC  X(12).                 00668005
006690         10 PV-SML-MANIFEST-HLD-BRCDE PIC  9(08).                 00669005
006700     05  PV-CART-TYP-CDE-OTPK         PIC  X(1).                  00670005
006710     05  PV-CART-TYP-CDE-INPK         PIC  X(1).                  00671005
006720*                                                                 00672005
006730     05  PV-DEPT-DESC                 PIC   X(25) VALUE SPACES.   00673005
006740     05  PV-MAJ-CL-DESC               PIC   X(25) VALUE SPACES.   00674005
006750                                                                  00675005
006760     05  PV-MOD-DATE.                                             00676005
006770         10  PV-MOD                  PIC   99     VALUE ZEROES.   00677005
006780         10  PV-DASH                 PIC   X      VALUE SPACE.    00678005
006790         10  PV-ARRIVE-MM            PIC   XX     VALUE ZEROES.   00679005
006800         10  PV-ARRIVE-DD            PIC   XX     VALUE ZEROES.   00680005
006810                                                                  00681005
006820                                                                  00682005
006821*    05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 00682105
006822*    05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     00682205
006823*                                                    COMP SYNC.   00682305
006824                                                                  00682405
006825* DMH - 10/06/04 - BEGIN                                          00682505
006826* add select parameter before recv socket command to determine if 00682605
006827* is still active                                                 00682705
006828*                                                                 00682805
006829* SELECT-NUMFDS needs to be set to 3.  1 for each p2l system and  00682905
006830* one for the print management system                             00683005
006840*                                                                 00684005
006850*                                                                 00685005
006860 01  SELECT-PARMS.                                                00686005
006870     02  SELECT-NUMFDS          PIC 9(8) COMP VALUE 3.            00687005
006880     02  SELECT-TIMEOUT.                                          00688005
006890         03  SELECT-SECS        PIC 9(8) COMP VALUE 05.           00689005
006900         03  SELECT-MILLSECS    PIC 9(8) COMP VALUE 0.            00690005
006910     02  SELECT-RD-MASK         PIC X(16).                        00691005
006920     02  SELECT-WR-MASK         PIC X(16).                        00692005
006930     02  SELECT-EX-MASK         PIC X(16).                        00693005
006940     02  SELECT-RR-MASK         PIC X(16).                        00694005
006950     02  SELECT-RW-MASK         PIC X(16).                        00695005
006951     02  SELECT-RE-MASK         PIC X(16).                        00695105
006952                                                                  00695205
006953 01  CHAR-MASK.                                                   00695305
006954     02 CHAR-STRING             PIC  X(100).                      00695405
006955                                                                  00695505
006956 01  CHAR-ARRAY REDEFINES CHAR-MASK.                              00695605
006957     02  CHAR-ENTRY-TABLE OCCURS 100 TIMES.                       00695705
006958       03  CHAR-ENTRY         PIC  X.                             00695805
006959                                                                  00695905
006960 01  BIT-MASK.                                                    00696005
006970     02  BIT-ARRAY            PIC  X(16).                         00697005
006980                                                                  00698005
006990 01  BIT-FUNCTION-CODES.                                          00699005
006991     02  CTOB                 PIC  X(4) VALUE 'CTOB'.             00699105
006992     02  BTOC                 PIC  X(4) VALUE 'BTOC'.             00699205
006993                                                                  00699305
006994 01  BIT-MASK-LENGTH          PIC  9(8) COMP VALUE 100.           00699405
006995                                                                  00699505
006996 01  BITMASK-TOKEN            PIC X(16) VALUE 'TCPIPBITMASKCOBL'. 00699605
006997 01  SOCKETS                  PIC  9(8) COMP VALUE 100.           00699705
006998 01  SOCKNO                   PIC S9(8) BINARY.                   00699805
006999 01  EZRETC                   PIC S9(8) COMP.                     00699905
007000                                                                  00700005
007001 01  SOCKET-SELECT-ERR.                                           00700105
007002     05  FILLER                       PIC X(10)                   00700205
007003         VALUE ' PCKCS191-'.                                      00700305
007004     05  FILLER                       PIC X(14)                   00700405
007005         VALUE 'SOCKET SELECT-'.                                  00700505
007006     05  FILLER                       PIC X(7)                    00700605
007007         VALUE '-RETCD='.                                         00700705
007008     05  SOCKET-RETCODE               PIC 9(10)-.                 00700805
007009     05  FILLER                       PIC X(2) VALUE SPACES.      00700905
007010     05  SOCKET-ERRNO                 PIC 9(8).                   00701005
007011     05  FILLER                       PIC X(2) VALUE SPACES.      00701105
007012     05  SOCKET-RECEIVER              PIC 9(8).                   00701205
007013     05  FILLER                       PIC X(1) VALUE '-'.         00701305
007014     05  SOCKET-SEQ                   PIC 9(3).                   00701405
007015     05  FILLER                       PIC X(1) VALUE '-'.         00701505
007016     05  SOCKET-LINE                  PIC 9(4).                   00701605
007017     05  FILLER                       PIC X(1) VALUE '-'.         00701705
007018     05  SOCKET-DESCR                 PIC X(20).                  00701805
007019*                                                                 00701905
007020* DMH - 10/06/04 - END                                            00702005
007021*                                                                 00702105
007022                                                                  00702205
007023 01  SE-SYSTEM-ERROR-MESSAGE.                                     00702305
007024     05  FILLER                       PIC X(43) VALUE             00702405
007025         'A SYSTEM ERROR HAS OCCURRED - CONTACT IS - '.           00702505
007026     05  FILLER                       PIC X(33) VALUE             00702605
007027         'PROGRAM PCKCS129       EIBRESP = '.                     00702705
007028     05  SE-CICS-RESPONSE             PIC 9(4) VALUE ZERO.        00702805
007029     05  FILLER                       PIC X(5) VALUE SPACES.      00702905
007030     05  FILLER                       PIC X(14) VALUE             00703005
007031         'ATTEMPTING TO '.                                        00703105
007032*                                                                 00703205
007033 01  PV-DL-DEST-CNTL-NBR.                                         00703305
007034     05  PV-DL-TYPE-IND               PIC 9(01).                  00703405
007035     05  PV-DL-DIVERT-CDE             PIC 9(04).                  00703505
007036     05  PV-DL-PO-NBR                 PIC 9(08).                  00703605
007037     05  PV-DL-RECV-SEQ-NBR           PIC 9(02).                  00703705
007038     05  PV-DL-PO-LINE-NBR            PIC 9(03).                  00703805
007039     05  PV-DL-CARTON-NBR             PIC 9(04).                  00703905
007040*                                                                 00704005
007041                                                                  00704105
008800*---------------------------------------------------------------* 00880005
008810*    COMMAREA PASSED FROM CALLING PROGRAM                         00881005
008820*---------------------------------------------------------------* 00882005
008830     COPY PCWS126.                                                00883005
008840                                                                  00884005
008850*---------------------------------------------------------------* 00885005
008860*    COMMAREA FOR STORE QUEUE                                     00886005
008870*---------------------------------------------------------------* 00887005
008880     COPY PCWS128.                                                00888005
008890                                                                  00889005
008900*----------------------------------------------------------------*00890005
008910*    PACKAGE HEADER LABEL LAYOUT - SOCKETS                        00891005
008920*----------------------------------------------------------------*00892005
008930     COPY PCWS144.                                                00893005
008940                                                                  00894005
008950*----------------------------------------------------------------*00895005
008960*    DC/RTV/CS HEADER LABEL LAYOUT - SOCKETS                      00896005
008970*----------------------------------------------------------------*00897005
008980     COPY PCWS145.                                                00898005
008990                                                                  00899005
009000*----------------------------------------------------------------*00900005
009010*    SML DIVIDER LABEL LAYOUT - SOCKETS                           00901005
009020*----------------------------------------------------------------*00902005
009030     COPY PCWS146.                                                00903005
009040                                                                  00904005
009050*----------------------------------------------------------------*00905005
009060*    SHIPPING MANIFEST LABEL FORM LAYOUT - SOCKETS                00906005
009070*----------------------------------------------------------------*00907005
009080     COPY PCWS253.                                                00908005
009090                                                                  00909005
009100*----------------------------------------------------------------*00910005
009110*    P2L LABEL LAYOUT FOR OTHER FACILITIES - SOCKETS              00911049
009120*----------------------------------------------------------------*00912005
009130     COPY PCWS149.                                                00913005
009140                                                                  00914005
009150*----------------------------------------------------------------*00915005
009160*    HIPPING MANIFEST LABEL DATA LAYOUT - SOCKETS                 00916049
009170*----------------------------------------------------------------*00917005
009180     COPY PCWS254.                                                00918005
009190                                                                  00919005
009200*----------------------------------------------------------------*00920005
009210*    DC/RTV/CS TRAILER LABEL LAYOUT - SOCKETS                     00921005
009220*----------------------------------------------------------------*00922005
009230     COPY PCWS150.                                                00923005
009240                                                                  00924005
009250*----------------------------------------------------------------*00925005
009260*    Central Stock SML label FORM layout - SOCKETS                00926005
009270*----------------------------------------------------------------*00927005
009280     COPY PCWS158.                                                00928005
009290                                                                  00929005
009300*----------------------------------------------------------------*00930005
009310*    Central Stock SML label DATA layout - SOCKETS                00931005
009320*----------------------------------------------------------------*00932005
009330     COPY PCWS159.                                                00933005
009340                                                                  00934005
009350*----------------------------------------------------------------*00935005
009360*    20 & 22 DIGIT LAYOUT FOR BARCODES                            00936005
009370*----------------------------------------------------------------*00937005
009380     COPY PCWS160.                                                00938005
009390                                                                  00939005
009400*----------------------------------------------------------------*00940005
009410*  RECORD LAYOUTS FOR LABEL PRINT MGMT SYSTEM (LPMS)             *00941005
009420*----------------------------------------------------------------*00942005
009430     COPY PCWS133.                                                00943005
009440                                                                  00944005
009450*----------------------------------------------------------------*00945005
009460*  LABEL PRINT MANAGEMENT SYSTEM - 'EZASOKET' ERROR MESSAGES     *00946005
009470*----------------------------------------------------------------*00947005
009480     COPY PCWS138.                                                00948005
009490                                                                  00949005
009500*----------------------------------------------------------------*00950005
009510*  COPYBOOK FOR INSERT TO SHIPPING UNIT TABLES                   *00951005
009520*----------------------------------------------------------------*00952005
009530     COPY PCWS180.                                                00953005
009540                                                                  00954005
009550*----------------------------------------------------------------*00955005
009560*  COMMUNICATION AREA FOR MANIFEST NBR MODULE (PCKCS721)         *00956005
009570*----------------------------------------------------------------*00957005
009580     COPY PCWS187.                                                00958005
009590                                                                  00959005
009600*----------------------------------------------------------------*00960005
009610*  COMMUNICATION AREA FOR SEASONAL SET MODULE (PCKUT025)         *00961005
009620*----------------------------------------------------------------*00962005
009630     COPY PCWS240.                                                00963005
009640                                                                  00964005
009650*----------------------------------------------------------------*00965005
009660*SOCKET COMMANDS CODES NEED FOR THE TCP/IP SOCKET CALLS-EZASOKET *00966005
009670*----------------------------------------------------------------*00967005
009680     COPY DPWS081.                                                00968005
009690                                                                  00969005
009700*----------------------------------------------------------------*00970005
009710*  RANDOM NUMBER AREA                                            *00971005
009720*----------------------------------------------------------------*00972005
009730     COPY DPWS902.                                                00973005
009740                                                                  00974005
009840*----------------------------------------------------------------*00984005
009850*    COPYBOOK USED BY MBS SYSTEM TO GET BUYER NAME               *00985005
009860*----------------------------------------------------------------*00986005
009870     COPY DPWS003.                                                00987005
009880                                                                  00988005
009950*----------------------------------------------------------------*00995005
009960*  COPYBOOK FOR CALLED MODULE TO RETURN business area id          00996005
009970*  VSM INTERFACE                                                  00997005
009980*----------------------------------------------------------------*00998005
009990     COPY XLWS073.                                                00999005
010000/                                                                 01000005
010070*----------------------------------------------------------------*01007005
010080*  COPYBOOK USED TO FOR ITEM ACCESS MODULE                        01008005
010090*  (XLKUT001)                                                     01009005
010100*----------------------------------------------------------------*01010005
010110     COPY XLWS001.                                                01011005
010120/                                                                 01012005
010130*----------------------------------------------------------------*01013005
010140*  COPYBOOK FOR CALLED MODULE TO RETURN THE STORE BALANCE ON HAND 01014005
010150*----------------------------------------------------------------*01015005
010160     COPY XLWS088.                                                01016005
010170/                                                                 01017005
010180* BBR WR41309 - ADD COPYBOOK FOR CALL TO SUKUT149                 01018005
010190*---------------------------------------------------------------* 01019005
010200*  RECORD LAYOUTS FOR RFID DETERMINATION MODULE                   01020005
010210*---------------------------------------------------------------* 01021005
010220     COPY SUWS093.                                                01022005
010230* BBR WR41309 - END                                               01023005
010240*---------------------------------------------------------------* 01024005
010250*                                                                 01025005
010260*---------------------------------------------------------------* 01026005
010270 01  PL-PGBK-LABEL-TICKET-AREA.                                   01027005
010271     05  PL-KOHLS-LOGO-LINE.                                      01027105
010272         10  FILLER                   PIC X(02) VALUE SPACES.     01027205
010273         10  PL-FMT-KOHLS-LOGO        PIC X(15) VALUE SPACES.     01027305
010274         10  PL-KOHLS-LOGO-PRT        PIC X(06) VALUE 'KOHL''S'.  01027405
010275         10  FILLER                   PIC X(57) VALUE SPACES.     01027505
010276     05  PL-SKU-LINE.                                             01027605
010277         10  FILLER                   PIC X(02) VALUE SPACES.     01027705
010278         10  PL-FMT-SKU               PIC X(15) VALUE SPACES.     01027805
010279         10  PL-SKU                   PIC X(09) VALUE SPACES.     01027905
010280         10  FILLER                   PIC X(54) VALUE SPACES.     01028005
010290     05  PL-UPC-BC-LINE.                                          01029005
010300         10  FILLER                   PIC X(02) VALUE SPACES.     01030005
010310         10  PL-FMT-UPC-CODE-BC       PIC X(15) VALUE SPACES.     01031005
010320         10  PL-UPC-CODE-BC           PIC X(12) VALUE SPACES.     01032005
010330         10  FILLER                   PIC X(51) VALUE SPACES.     01033005
010340     05  PL-UPC-HR-LINE.                                          01034005
010350         10  FILLER                   PIC X(02) VALUE SPACES.     01035005
010360         10  PL-FMT-UPC-CODE-HR       PIC X(15) VALUE SPACES.     01036005
010370         10  PL-UPC-CODE-HR           PIC X(15) VALUE SPACES.     01037005
010380         10  FILLER                   PIC X(48) VALUE SPACES.     01038005
010390     05  PL-RTL-PRICE-LINE.                                       01039005
010400         10  FILLER                   PIC X(02) VALUE SPACES.     01040005
010410         10  PL-FMT-RTL-PRICE         PIC X(15) VALUE SPACES.     01041005
010420         10  PL-RTL-PRICE             PIC X(09) VALUE SPACES.     01042005
010430         10  FILLER                   PIC X(54) VALUE SPACES.     01043005
010440     05  PL-VOID-LINE.                                            01044005
010450         10  FILLER                   PIC X(02) VALUE SPACES.     01045005
010460         10  PL-FMT-VOID              PIC X(15) VALUE SPACES.     01046005
010470         10  PL-VOID-PRT              PIC X(04) VALUE 'VOID'.     01047005
010480         10  FILLER                   PIC X(59) VALUE SPACES.     01048005
010490     05  PL-END-OF-LABEL-LINE.                                    01049005
010500         10  FILLER                   PIC X(02) VALUE SPACES.     01050005
010510         10  FILLER                   PIC X(02) VALUE             01051005
010520             'E '.                                                01052005
010530         10  FILLER                   PIC X(76) VALUE SPACES.     01053005
010540/                                                                 01054005
010550******************************************************************01055005
010560** THIS IS COPYBOOK USED TO HOLD TABLES CONTAINING CONTAINING   **01056005
010570** LABEL MATRIX FORMAT CODES.  THESE CODES ARE USED TO CREATE   **01057005
010580** THE RETAIL TICKETS ON THE PIGGYBACK LABELS.                  **01058005
010590******************************************************************01059005
010600     COPY PCWS115.                                                01060005
010610                                                                  01061005
010680                                                                  01068005
010690 01  PT-LABEL-DISTRO-TABLE.                                       01069005
010700     05  PT-STORE-INFO OCCURS 1000 TIMES                          01070005
010710                              INDEXED BY PT-DISTRO-IDX            01071005
010720                                         PT-SHUFFLE-IDX           01072005
010730                                         PT-START-IDX.            01073005
010740         10  PT-STR-NBR               PIC S9(4) COMP.             01074005
010750         10  PT-STORE-NMBR            PIC 9(4).                   01075005
010760         10  PT-TYPE-CODE             PIC X(1).                   01076005
010770             88  PT-CS-DC-RTV                   VALUES 'A',       01077005
010780                                                       'B',       01078005
010790                                                       'C',       01079005
010800                                                       'D'        01080005
010810                                                       'E'.       01081005
010820             88 PT-CENTRAL-STOCK                VALUES 'C'.       01082005
010830             88 PT-E-COMMERCE                   VALUES 'D'.       01083005
010840             88 PT-E-COMMERCE-PRPK              VALUES 'E'.       01084005
010850             88 PT-DS-STORE                     VALUES 'F'.       01085005
010860         10  PT-STR-ABBR10            PIC X(10).                  01086005
010870         10  PT-MANIFEST-START        PIC S9(9) COMP-3.           01087005
010880         10  PT-MANIFEST-END          PIC S9(9) COMP-3.           01088005
010890         10  PT-FCSE-LABELS-NEEDED    PIC 9(4).                   01089005
010900         10  PT-FCSE-LABEL-SEQ-QTY    PIC 9(4).                   01090005
010910         10  PT-INPK-LABELS-NEEDED    PIC 9(4).                   01091005
010920         10  PT-INPK-LABEL-SEQ-QTY    PIC 9(4).                   01092005
010930         10  PT-ODD-CART-IND          PIC X(1).                   01093005
010940             88  PT-ODD-CART-FCSE               VALUE 'F'.        01094005
010950             88  PT-ODD-CART-INPK               VALUE 'I'.        01095005
010960             88  PT-ODD-CART-NONE               VALUE 'N' ' '.    01096005
010970         10  PT-DIVERT-CODE           PIC 9(5).                   01097005
010980         10  PT-SEASONAL-SET-NAME     PIC X(25).                  01098005
010990         10  PT-FIXT-ID               PIC X(10).                  01099005
011000         10  PT-FCSE-LABELS-PRINTED   PIC 9(4).                   01100005
011010         10  PT-STORE-ONHAND-ZERO-IND PIC X(1).                   01101005
011020             88  PT-STORE-ONHAND-ZERO           VALUE 'Y'.        01102005
011030             88  PT-STORE-ONHAND-NOT-ZERO       VALUE 'N'.        01103005
011040         10  PT-DC-DOOR-ID            PIC X(4).                   01104005
011050         10  PT-PROCESS-MESSAGE       PIC X(35).                  01105005
011060         10  PT-FIRST-STORE-RCPT      PIC X(1).                   01106005
011070             88  PT-FIRST-STORE-RCPT-YES        VALUE 'Y'.        01107005
011080             88  PT-FIRST-STORE-RCPT-NO         VALUE 'N'.        01108005
011090         10  PT-STR-ONHAND-ZERO-COUNT PIC 9(4).                   01109005
011100         10  PT-FIRST-STR-RCPT-COUNT  PIC 9(4).                   01110005
011110* BBR WR41309 - RFID PROCESSING                                   01111005
011120         10  PT-RFID-STORE            PIC X(1).                   01112005
011130             88  PT-RFID-STORE-YES              VALUE 'Y'.        01113005
011140             88  PT-RFID-STORE-NO               VALUE 'N'.        01114005
011150* BBR WR41309 - END                                               01115005
011240                                                                  01124044
011250     EXEC SQL                                                     01125005
011260          INCLUDE XLT00010                                        01126005
011270     END-EXEC.                                                    01127005
011280/                                                                 01128005
011290     EXEC SQL                                                     01129005
011291          INCLUDE TPCLABL                                         01129105
011292     END-EXEC.                                                    01129205
011293/                                                                 01129305
011294     EXEC SQL                                                     01129405
011295          INCLUDE TDISTDT                                         01129505
011296     END-EXEC.                                                    01129605
011297/                                                                 01129705
011298     EXEC SQL                                                     01129805
011299          INCLUDE TDISTHD                                         01129905
011300     END-EXEC.                                                    01130005
011301/                                                                 01130105
011302     EXEC SQL                                                     01130205
011303          INCLUDE TRECITM                                         01130305
011304     END-EXEC.                                                    01130405
011305/                                                                 01130505
011310     EXEC SQL                                                     01131005
011320          INCLUDE TPURITM                                         01132005
011330     END-EXEC.                                                    01133005
011340/                                                                 01134005
011350     EXEC SQL                                                     01135005
011360          INCLUDE TENTNME                                         01136005
011370     END-EXEC.                                                    01137005
011380/                                                                 01138005
011390     EXEC SQL                                                     01139005
011400          INCLUDE TPURCHS                                         01140005
011410     END-EXEC.                                                    01141005
011420/                                                                 01142005
011430     EXEC SQL                                                     01143005
011440          INCLUDE TSEASET                                         01144005
011450     END-EXEC.                                                    01145005
011460/                                                                 01146005
011470     EXEC SQL                                                     01147005
011480          INCLUDE TP2LMOD                                         01148005
011490     END-EXEC.                                                    01149005
011500/                                                                 01150005
011510     EXEC SQL                                                     01151005
011520          INCLUDE TWKORIN                                         01152005
011530     END-EXEC.                                                    01153005
011540/                                                                 01154005
011550     EXEC SQL                                                     01155005
011560          INCLUDE TCOCNTL                                         01156005
011570     END-EXEC.                                                    01157005
011580/                                                                 01158005
011590     EXEC SQL                                                     01159005
011600          INCLUDE TPKSLIP                                         01160005
011610     END-EXEC.                                                    01161005
011620/                                                                 01162005
011630     EXEC SQL                                                     01163005
011640          INCLUDE TKRPRPM                                         01164005
011650     END-EXEC.                                                    01165005
011660/                                                                 01166005
011670     EXEC SQL                                                     01167005
011680          INCLUDE TSULBXF                                         01168005
011690     END-EXEC.                                                    01169005
011700/                                                                 01170005
011710     EXEC SQL                                                     01171005
011720          INCLUDE TPOPRPK                                         01172005
011730     END-EXEC.                                                    01173005
011740/                                                                 01174005
011750     EXEC SQL                                                     01175005
011760          INCLUDE TCNDCDR                                         01176005
011770     END-EXEC.                                                    01177005
011780     EXEC SQL                                                     01178005
011790          INCLUDE TCNDRST                                         01179005
011800     END-EXEC.                                                    01180005
011810                                                                  01181005
011820*----------------------------------------------------------------*01182005
011830*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *01183005
011840*  HISTORY TABLE                                                 *01184005
011850*----------------------------------------------------------------*01185005
011860     EXEC SQL                                                     01186005
011870         INCLUDE TLBTKHS                                          01187005
011880     END-EXEC.                                                    01188005
011890                                                                  01189005
011900*----------------------------------------------------------------*01190005
011910*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE LABEL TRANSACTION *01191005
011920*  ID TABLE                                                      *01192005
011930*----------------------------------------------------------------*01193005
011940     EXEC SQL                                                     01194005
011950         INCLUDE TLBTKID                                          01195005
011960     END-EXEC.                                                    01196005
011970                                                                  01197005
011980*----------------------------------------------------------------*01198005
011990*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE OTBND CART TABLE  *01199005
012000*  (SUT_OTBND_CART)                                               01200005
012010*----------------------------------------------------------------*01201005
012020     EXEC SQL                                                     01202005
012030         INCLUDE SUT00024                                         01203005
012031     END-EXEC.                                                    01203105
012032                                                                  01203205
012033*----------------------------------------------------------------*01203305
012034*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE OTBND UPC  TABLE  *01203405
012035*  (SUT_OTBND_UPC)                                                01203505
012036*----------------------------------------------------------------*01203605
012037     EXEC SQL                                                     01203705
012038         INCLUDE SUT00028                                         01203805
012039     END-EXEC.                                                    01203905
012040                                                                  01204005
012050*----------------------------------------------------------------*01205005
012060*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE OTBND PK TABLE  *  01206005
012070*  (SUT_OTBND_PK)                                                 01207005
012080*----------------------------------------------------------------*01208005
012090     EXEC SQL                                                     01209005
012100         INCLUDE SUT00041                                         01210005
012110     END-EXEC.                                                    01211005
012120                                                                  01212005
012130*================================================================*01213005
012140* DCLGEN FOR EAS MDSE TAG LOOKUP  (SFT_EAS_TG_MDSE)              *01214005
012150*================================================================*01215005
012160     EXEC SQL                                                     01216005
012170          INCLUDE SFT00000                                        01217005
012180     END-EXEC.                                                    01218005
012190                                                                  01219005
012191*CLP 06/19/2015 - START                                           01219125
012192*----------------------------------------------------------------*01219222
012193* SKU TABLE (XLT_SKU)                                             01219322
012194*----------------------------------------------------------------*01219422
012195     EXEC SQL                                                     01219522
012196          INCLUDE XLT00003                                        01219622
012197     END-EXEC.                                                    01219722
012198                                                                  01219822
012200*----------------------------------------------------------------*01220019
012300* VENDOR STYLE TABLE (XLT_VND_STYL)                               01230019
012310*----------------------------------------------------------------*01231019
012320     EXEC SQL                                                     01232019
012330          INCLUDE XLT00004                                        01233019
012331     END-EXEC.                                                    01233119
012332                                                                  01233219
012354*----------------------------------------------------------------*01235417
012355* BRAND TABLE (XLT_BRND)                                          01235517
012356*----------------------------------------------------------------*01235617
012357     EXEC SQL                                                     01235717
012358          INCLUDE XLT00043                                        01235817
012359     END-EXEC.                                                    01235917
012360                                                                  01236017
012361*CLP 06/19/2015 - END                                             01236125
012362*----------------------------------------------------------------*01236205
012363*                                                                *01236305
012364*----------------------------------------------------------------*01236405
012365     EXEC SQL                                                     01236505
012366     DECLARE STORE-CSR CURSOR WITH HOLD FOR                       01236605
012367         SELECT                                                   01236705
012368           CASE                                                   01236805
012369             WHEN B.LOC_TYP_CDE = 'DC' THEN 'A'                   01236905
012370             WHEN B.LOC_TYP_CDE = 'RV' THEN 'B'                   01237005
012371             WHEN B.LOC_TYP_CDE = 'CS' THEN 'C'                   01237105
012372             WHEN B.LOC_TYP_CDE = 'DS'                            01237205
012373                  AND B.E_BUS_IND  = 'Y'                          01237305
012374                                     THEN 'D'                     01237405
012375             WHEN B.LOC_TYP_CDE = 'DS'                            01237505
012376                  AND B.E_BUS_IND  = 'N'                          01237605
012377                                     THEN 'F'                     01237705
012378           ELSE 'Z'                                               01237805
012379           END                                                    01237905
012380         ,   A.STR_NBR                                            01238005
012381         ,   B.LOC_10_ABBR_NM                                     01238105
012382         ,   (A.FCSE_SPLT_UNT_QTY + A.INPK_SPLT_UNT_QTY)          01238205
012383         ,   A.ODD_CART_IND                                       01238305
012384         ,   B.OPN_DTE                                            01238405
012385         FROM                                                     01238505
012386             TDISTDT A                                            01238605
012387         ,   XLT_LOC B                                            01238705
012388         WHERE                                                    01238805
012389             A.ORD_NBR                = :DK-PO-NBR                01238905
012390         AND A.RCVR_SEQ_NBR           = :DK-RCVR-SEQ-NBR          01239005
012391         AND A.ORD_LNE_NBR            = :DK-ORD-LNE-NBR           01239105
012392         AND A.STR_NBR                = B.LOC_NBR                 01239205
012393         AND (A.FCSE_SPLT_UNT_QTY + A.INPK_SPLT_UNT_QTY) > 0      01239305
012394         ORDER BY 1                                               01239405
012400             ,    A.STR_NBR                                       01240005
012410     END-EXEC.                                                    01241005
012420                                                                  01242005
012430     EXEC SQL                                                     01243005
012440     DECLARE PREPK-STORE-CSR CURSOR WITH HOLD FOR                 01244005
012450         SELECT                                                   01245005
012460           CASE                                                   01246005
012470             WHEN B.LOC_TYP_CDE = 'DC' THEN 'A'                   01247005
012480             WHEN B.LOC_TYP_CDE = 'RV' THEN 'B'                   01248005
012490             WHEN B.LOC_TYP_CDE = 'CS' THEN 'C'                   01249005
012500             WHEN B.LOC_TYP_CDE = 'DS'                            01250005
012510                  AND B.E_BUS_IND   =  'Y'                        01251005
012520                                     THEN 'E'                     01252005
012530             WHEN B.LOC_TYP_CDE = 'DS'                            01253005
012540                  AND B.E_BUS_IND  = 'N'                          01254005
012550                                     THEN 'F'                     01255005
012560           ELSE 'Z'                                               01256005
012570           END                                                    01257005
012580         ,   A.STR_NBR                                            01258005
012590         ,   B.LOC_10_ABBR_NM                                     01259005
012600         ,   (A.FCSE_SPLT_UNT_QTY + A.INPK_SPLT_UNT_QTY)          01260005
012610         ,   A.ODD_CART_IND                                       01261005
012620         ,   B.OPN_DTE                                            01262005
012630         FROM                                                     01263005
012640             TDISTDT A                                            01264005
012650         ,   XLT_LOC B                                            01265005
012660         WHERE                                                    01266005
012670             A.ORD_NBR                = :DK-PO-NBR                01267005
012680         AND A.RCVR_SEQ_NBR           = :DK-RCVR-SEQ-NBR          01268005
012690         AND A.ORD_LNE_NBR            = :DK-ORD-LNE-NBR           01269005
012700         AND A.STR_NBR                = B.LOC_NBR                 01270005
012710         AND (A.FCSE_SPLT_UNT_QTY + A.INPK_SPLT_UNT_QTY) > 0      01271005
012720         ORDER BY 1                                               01272005
012730             ,    A.STR_NBR                                       01273005
012740     END-EXEC.                                                    01274005
012750                                                                  01275005
013190*----------------------------------------------------------------*01319005
013200*  PREPACK LINE CURSOR FOR INSERT TO OTBND UPC                   *01320005
013210*----------------------------------------------------------------*01321005
013220     EXEC SQL                                                     01322005
013230          DECLARE PREPK-LINE-CSR CURSOR FOR                       01323005
013240          SELECT                                                  01324005
013250                A.ORD_LNE_NBR                                     01325005
013260              , A.PREPK_RATO_QTY                                  01326005
013270              , B.ITM_NBR                                         01327005
013280          FROM                                                    01328005
013290                TRECITM A                                         01329005
013300              , TPURITM B                                         01330005
013310          WHERE A.ORD_NBR          = :PC180-PO-NBR                01331005
013320            AND A.REC_SEQ_NBR      = :PC180-RCVR-SEQ-NBR          01332005
013330            AND A.PREPK_ID         = :DK-PREPK-ID                 01333005
013340            AND A.ORD_NBR          =  B.PO_NBR                    01334005
013350            AND A.ORD_LNE_NBR      =  B.APP_PO_LNE_NBR            01335005
013360            AND A.VER_STATUS_CDE   = 'A'                          01336005
013370            AND A.PO_VER_NBR       =  B.VER_NBR                   01337005
013380          ORDER BY                                                01338005
013390                A.ORD_LNE_NBR                                     01339005
013400     END-EXEC.                                                    01340005
013410*----------------------------------------------------------------*01341005
013420*  REPRINT MANIFEST CURSOR                                       *01342005
013430*----------------------------------------------------------------*01343005
013440     EXEC SQL                                                     01344005
013450          DECLARE REPRINT-MNFST-CSR CURSOR FOR                    01345005
013460          SELECT                                                  01346005
013470                 DISTINCT(A.SHIPT_UNT_ID)                         01347005
013480              ,  B.LBL_PRT_SEQ_NBR                                01348005
013490          FROM                                                    01349005
013500                 SUT_OTBND_UPC A                                  01350005
013510                ,SUT_OTBND_CART B                                 01351005
013520          WHERE  A.TRN_NBR           = :PC180-PO-NBR              01352005
013530            AND  A.RCVR_SEQ_NBR      = :PC180-RCVR-SEQ-NBR        01353005
013540            AND  A.TRN_LNE_NBR       = :DK-ORD-LNE-NBR            01354005
013550            AND  A.SHIPT_UNT_ID      =  B.SHIPT_UNT_ID            01355005
013560            AND  B.ACTV_IND          = 'Y'                        01356005
013570            AND  B.DEST_LOC_NBR      = :DK-STR-NBR                01357005
013580            AND  B.LBL_PRT_SEQ_NBR  >= :DK-SHP-REPRT-FROM-CNT     01358005
013590            AND  (B.CART_TYP_CDE     = :PV-CART-TYP-CDE-OTPK      01359005
013600            OR   B.CART_TYP_CDE      = :PV-CART-TYP-CDE-INPK)     01360005
013610            AND  B.CRE_PGM_NM        = 'PCKCS191'                 01361005
013620        ORDER BY B.LBL_PRT_SEQ_NBR                                01362005
013630     END-EXEC.                                                    01363005
013640                                                                  01364005
013650*----------------------------------------------------------------*01365005
013660*  DOOR SEQ CURSOR                                               *01366005
013670*----------------------------------------------------------------*01367005
013680     EXEC SQL                                                     01368005
013690        DECLARE DOOR-SEQ-CSR CURSOR WITH HOLD FOR                 01369005
013700        SELECT                                                    01370005
013710         TOT_RSLTS.LOC_TYPE                                       01371005
013720      ,  TOT_RSLTS.STR_NBR                                        01372005
013730      ,  TOT_RSLTS.LOC_10_ABBR_NM                                 01373005
013740      ,  TOT_RSLTS.QTY                                            01374005
013750      ,  TOT_RSLTS.ODD_CART_IND                                   01375005
013760      ,  MIN(TOT_RSLTS.RSLTS_SET) AS LBL_SEQ                      01376005
013770      ,  TOT_RSLTS.OPN_DTE                                        01377005
013780         FROM                                                     01378005
013790          (                                                       01379005
013800          SELECT DISTINCT                                         01380005
013810            CASE                                                  01381005
013820                 WHEN T1.LOC_TYP_CDE = 'DC' THEN 'A'              01382005
013830                 WHEN T1.LOC_TYP_CDE = 'RV' THEN 'B'              01383005
013840                 WHEN T1.LOC_TYP_CDE = 'CS' THEN 'C'              01384005
013850                 WHEN T1.LOC_TYP_CDE = 'DS'                       01385005
013860                      AND T1.E_BUS_IND    = 'Y'                   01386005
013870                                         THEN 'D'                 01387005
013880                 WHEN T1.LOC_TYP_CDE = 'DS'                       01388005
013890                      AND T1.E_BUS_IND    = 'N'                   01389005
013900                                         THEN 'F'                 01390005
013910                 ELSE 'Z'                                         01391005
013920             END    AS LOC_TYPE                                   01392005
013930                ,T1.STR_NBR                                       01393005
013931                ,T1.LOC_10_ABBR_NM                                01393105
013932                ,(T1.FCSE_SPLT_UNT_QTY + T1.INPK_SPLT_UNT_QTY)    01393205
013933                                       AS QTY                     01393305
013934                ,T1.ODD_CART_IND                                  01393405
013935                ,T1.OPN_DTE                                       01393505
013936          , CASE                                                  01393605
013937                 WHEN T2.DOOR_LBL_SEQ_NBR = 0  THEN 9998          01393705
013938                 WHEN T2.DOOR_LBL_SEQ_NBR IS NULL THEN 9999       01393805
013939                 WHEN T2.END_TMST <  '9999-09-09-09.09.09.999999' 01393905
013940                                  THEN  9999                      01394005
013950                 ELSE T2.DOOR_LBL_SEQ_NBR                         01395005
013960            END  AS RSLTS_SET                                     01396005
013970         FROM                                                     01397005
013980        (SELECT DISTINCT                                          01398005
013990             B.LOC_TYP_CDE                                        01399005
013991          ,  B.E_BUS_IND                                          01399105
013992          ,  A.STR_NBR                                            01399205
013993          ,  B.LOC_10_ABBR_NM                                     01399305
013994          ,  A.FCSE_SPLT_UNT_QTY                                  01399405
013995          ,  A.INPK_SPLT_UNT_QTY                                  01399505
013996          ,  A.ODD_CART_IND                                       01399605
013997          ,  C.OPER_UNT_ID                                        01399705
013998          ,  B.OPN_DTE                                            01399805
013999         FROM                                                     01399905
014000             TDISTDT A                                            01400005
014001         ,   XLT_LOC B                                            01400105
014002         ,   TDISTHD C                                            01400205
014003         WHERE                                                    01400305
014004             A.ORD_NBR                = :DK-PO-NBR                01400405
014005         AND A.RCVR_SEQ_NBR           = :DK-RCVR-SEQ-NBR          01400505
014006         AND A.ORD_LNE_NBR            = :DK-ORD-LNE-NBR           01400605
014007         AND A.STR_NBR                = B.LOC_NBR                 01400705
014008         AND A.ORD_NBR                = C.ORD_NBR                 01400805
014009         AND A.RCVR_SEQ_NBR           = C.RCVR_SEQ_NBR            01400905
014010         AND A.ORD_LNE_NBR            = C.ORD_LNE_NBR             01401005
014011         AND (A.FCSE_SPLT_UNT_QTY + A.INPK_SPLT_UNT_QTY) > 0)     01401105
014012                                                  AS T1           01401205
014013      LEFT OUTER JOIN                                             01401305
014014        (SELECT DISTINCT                                          01401405
014015                E.STR_NBR                                         01401505
014016               ,E.OPER_UNT_ID                                     01401605
014017               ,E.END_TMST                                        01401705
014018               ,F.DOOR_LBL_SEQ_NBR                                01401805
014019           FROM TCNDRST E                                         01401905
014020               ,TCNDCDR F                                         01402005
014021           WHERE E.DOOR_ID  =  F.DOOR_ID                          01402105
014022             AND E.OPER_UNT_ID  = F.OPER_UNT_ID                   01402205
014023             AND F.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%'             01402305
014024             AND F.DOOR_LOC_DESC NOT LIKE '%UPS%'                 01402405
014025             AND F.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%'             01402505
014026             AND E.END_TMST       >= CURRENT TIMESTAMP            01402605
014027            ) AS T2                                               01402705
014028      ON T1.STR_NBR      = T2.STR_NBR                             01402805
014029      AND T1.OPER_UNT_ID  = T2.OPER_UNT_ID                        01402905
014030        ) AS TOT_RSLTS                                            01403005
014031                                                                  01403105
014032       GROUP BY                                                   01403205
014033         TOT_RSLTS.LOC_TYPE                                       01403305
014034      ,  TOT_RSLTS.STR_NBR                                        01403405
014035      ,  TOT_RSLTS.LOC_10_ABBR_NM                                 01403505
014036      ,  TOT_RSLTS.QTY                                            01403605
014037      ,  TOT_RSLTS.ODD_CART_IND                                   01403705
014038      ,  TOT_RSLTS.OPN_DTE                                        01403805
014039         ORDER BY                                                 01403905
014040         LBL_SEQ                                                  01404005
014041      ,  TOT_RSLTS.STR_NBR                                        01404105
014042                                                                  01404205
014043     END-EXEC.                                                    01404305
014044*----------------------------------------------------------------*01404405
014045*  DOOR SEQ CURSOR -  PREPACK                                    *01404505
014046*----------------------------------------------------------------*01404605
014047     EXEC SQL                                                     01404705
014048       DECLARE DOOR-PRPK-CSR CURSOR WITH HOLD FOR                 01404805
014049        SELECT                                                    01404905
014050         TOT_RSLTS.LOC_TYPE                                       01405005
014051      ,  TOT_RSLTS.STR_NBR                                        01405105
014052      ,  TOT_RSLTS.LOC_10_ABBR_NM                                 01405205
014053      ,  TOT_RSLTS.QTY                                            01405305
014054      ,  TOT_RSLTS.ODD_CART_IND                                   01405405
014055      ,  MIN(TOT_RSLTS.RSLTS_SET) AS LBL_SEQ                      01405505
014056      ,  TOT_RSLTS.OPN_DTE                                        01405605
014057         FROM                                                     01405705
014058          (                                                       01405805
014059          SELECT DISTINCT                                         01405905
014060            CASE                                                  01406005
014061                 WHEN T1.LOC_TYP_CDE = 'DC' THEN 'A'              01406105
014062                 WHEN T1.LOC_TYP_CDE = 'RV' THEN 'B'              01406205
014063                 WHEN T1.LOC_TYP_CDE = 'CS' THEN 'C'              01406305
014064                 WHEN T1.LOC_TYP_CDE = 'DS'                       01406405
014065                      AND T1.E_BUS_IND    = 'Y'                   01406505
014066                                         THEN 'D'                 01406605
014067                 WHEN T1.LOC_TYP_CDE = 'DS'                       01406705
014068                      AND T1.E_BUS_IND    = 'N'                   01406805
014069                                         THEN 'F'                 01406905
014070                 ELSE 'Z'                                         01407005
014071             END    AS LOC_TYPE                                   01407105
014072                ,T1.STR_NBR                                       01407205
014073                ,T1.LOC_10_ABBR_NM                                01407305
014074                ,(T1.FCSE_SPLT_UNT_QTY + T1.INPK_SPLT_UNT_QTY)    01407405
014075                                       AS QTY                     01407505
014076                ,T1.ODD_CART_IND                                  01407605
014077                ,T1.OPN_DTE                                       01407705
014078          , CASE                                                  01407805
014079                 WHEN T2.DOOR_LBL_SEQ_NBR = 0  THEN 9998          01407905
014080                 WHEN T2.DOOR_LBL_SEQ_NBR IS NULL THEN 9999       01408005
014081                 WHEN T2.END_TMST <  '9999-09-09-09.09.09.999999' 01408105
014082                                  THEN  9999                      01408205
014083                 ELSE T2.DOOR_LBL_SEQ_NBR                         01408305
014084            END  AS RSLTS_SET                                     01408405
014085         FROM                                                     01408505
014086        (SELECT DISTINCT                                          01408605
014087             B.LOC_TYP_CDE                                        01408705
014088          ,  B.E_BUS_IND                                          01408805
014089          ,  A.STR_NBR                                            01408905
014090          ,  B.LOC_10_ABBR_NM                                     01409005
014091          ,  A.FCSE_SPLT_UNT_QTY                                  01409105
014092          ,  A.INPK_SPLT_UNT_QTY                                  01409205
014093          ,  A.ODD_CART_IND                                       01409305
014094          ,  C.OPER_UNT_ID                                        01409405
014095          ,  B.OPN_DTE                                            01409505
014096         FROM                                                     01409605
014097             TDISTDT A                                            01409705
014098         ,   XLT_LOC B                                            01409805
014099         ,   TDISTHD C                                            01409905
014100         WHERE                                                    01410005
014101             A.ORD_NBR                = :DK-PO-NBR                01410105
014102         AND A.RCVR_SEQ_NBR           = :DK-RCVR-SEQ-NBR          01410205
014103         AND A.ORD_LNE_NBR            = :DK-ORD-LNE-NBR           01410305
014104         AND A.STR_NBR                = B.LOC_NBR                 01410405
014105         AND A.ORD_NBR                = C.ORD_NBR                 01410505
014106         AND A.RCVR_SEQ_NBR           = C.RCVR_SEQ_NBR            01410605
014107         AND A.ORD_LNE_NBR            = C.ORD_LNE_NBR             01410705
014108         AND (A.FCSE_SPLT_UNT_QTY + A.INPK_SPLT_UNT_QTY) > 0)     01410805
014109                                                  AS T1           01410905
014110      LEFT OUTER JOIN                                             01411005
014111        (SELECT DISTINCT                                          01411105
014112                E.STR_NBR                                         01411205
014113               ,E.OPER_UNT_ID                                     01411305
014114               ,E.END_TMST                                        01411405
014115               ,F.DOOR_LBL_SEQ_NBR                                01411505
014116           FROM TCNDRST E                                         01411605
014117               ,TCNDCDR F                                         01411705
014118           WHERE E.DOOR_ID  =  F.DOOR_ID                          01411805
014119             AND E.OPER_UNT_ID  = F.OPER_UNT_ID                   01411905
014120             AND F.DOOR_LOC_DESC NOT LIKE '%RE-OPEN%'             01412005
014121             AND F.DOOR_LOC_DESC NOT LIKE '%UPS%'                 01412105
014122             AND F.DOOR_LOC_DESC NOT LIKE '%VIRTUAL%'             01412205
014123             AND E.END_TMST       >= CURRENT TIMESTAMP            01412305
014124            ) AS T2                                               01412405
014125      ON T1.STR_NBR      = T2.STR_NBR                             01412505
014126      AND T1.OPER_UNT_ID  = T2.OPER_UNT_ID                        01412605
014127        ) AS TOT_RSLTS                                            01412705
014128                                                                  01412805
014129       GROUP BY                                                   01412905
014130         TOT_RSLTS.LOC_TYPE                                       01413005
014131      ,  TOT_RSLTS.STR_NBR                                        01413105
014132      ,  TOT_RSLTS.LOC_10_ABBR_NM                                 01413205
014133      ,  TOT_RSLTS.QTY                                            01413305
014134      ,  TOT_RSLTS.ODD_CART_IND                                   01413405
014135      ,  TOT_RSLTS.OPN_DTE                                        01413505
014136         ORDER BY                                                 01413605
014137         LBL_SEQ                                                  01413705
014138      ,  TOT_RSLTS.STR_NBR                                        01413805
014139     END-EXEC.                                                    01413905
014140                                                                  01414005
014141*----------------------------------------------------------------*01414105
014142*  PREPACK CSR FOR ITEMS TO CHECK FOR STORE BALANCE ON HAND     * 01414205
014143*----------------------------------------------------------------*01414305
014144     EXEC SQL                                                     01414405
014145          DECLARE PREPK_ITM_CSR CURSOR FOR                        01414505
014146          SELECT DISTINCT ITM_NBR                                 01414605
014147            FROM                                                  01414705
014148                TRECITM                                           01414805
014149           WHERE                                                  01414905
014150                ORD_NBR        =  :DK-PO-NBR                      01415005
014151            AND REC_SEQ_NBR    =  :DK-RCVR-SEQ-NBR                01415105
014152            AND PREPK_ID       =  :DK-PREPK-ID                    01415205
014153     END-EXEC.                                                    01415305
014154                                                                  01415405
014155     EXEC SQL                                                     01415505
014156          INCLUDE SQLCA                                           01415605
014157     END-EXEC.                                                    01415705
014158                                                                  01415805
014159 LINKAGE SECTION.                                                 01415905
014160                                                                  01416005
014161 01  DFHCOMMAREA.                                                 01416105
014162     05  FILLER                         OCCURS  1 TO 4072 TIMES   01416205
014163                                        DEPENDING ON EIBCALEN.    01416305
014164         10  FILLER                   PIC X.                      01416405
014165                                                                  01416505
014166/                                                                 01416605
014167 PROCEDURE DIVISION.                                              01416705
014168                                                                  01416805
014169 0000-PROGRAM-MAINLINE.                                           01416905
014170                                                                  01417005
014180     PERFORM 1000-INITIAL-PROCESS.                                01418005
014190                                                                  01419005
014200     SET PS-SOCKET-ERROR-NO  TO  TRUE.                            01420005
014210                                                                  01421005
014220     IF ((PC126-FCSE-LBL-CNT > ZERO  OR                           01422005
014230          PC126-INPK-LBL-CNT > ZERO  OR                           01423005
014240          PC126-ODD-CRTN-UNT-QTY > ZERO)                          01424005
014250             AND (PC126-SHIP-LBL-SML) )                           01425005
014260                                                                  01426005
014261             OR PC126-P2L-LBL-CNT > ZERO                          01426105
014262                                                                  01426205
014263         IF  PC126-SHP-XMIT-INTFC-CDE = PC-SOCKET-INTERFACE       01426305
014264             MOVE  PC126-SHP-PRTR-IP-ADDR TO PV-IP-ADDRESS        01426405
014265             ADD  PC126-FCSE-LBL-CNT                              01426505
014266                  PC126-INPK-LBL-CNT                              01426605
014267                  GIVING PV-FCSE-INPK-LBL-QTY                     01426705
014268             ADD  PC126-FCSE-LBL-CNT                              01426805
014269                  PC126-INPK-LBL-CNT                              01426905
014270                  PC126-P2L-LBL-CNT                               01427005
014271                  GIVING PV-TOT-4X4-LBL-COUNT                     01427105
014272             MOVE  2  TO  PV-DIVIDER-LABEL-COUNT                  01427205
014273             IF  PC126-ODD-CRTN-UNT-QTY  >  0  AND                01427305
014274                 PC126-FCSE-LBL-CNT      >  0  AND                01427405
014275                 PC126-INPK-LBL-CNT      >  0  AND                01427505
014276                 PC126-P2L-LBL-CNT       >  0                     01427605
014277                 ADD  3  TO  PV-DIVIDER-LABEL-COUNT               01427705
014278             ELSE                                                 01427805
014279             IF  PC126-FCSE-LBL-CNT  >  0  AND                    01427905
014280                 PC126-INPK-LBL-CNT  >  0  AND                    01428005
014281                 PC126-P2L-LBL-CNT   >  0                         01428105
014282                 ADD  2  TO  PV-DIVIDER-LABEL-COUNT               01428205
014283             ELSE                                                 01428305
014284             IF  PC126-ODD-CRTN-UNT-QTY  >  0  AND                01428405
014285                 PC126-FCSE-LBL-CNT      >  0  AND                01428505
014286                 PC126-P2L-LBL-CNT       >  0                     01428605
014287                 ADD  2  TO  PV-DIVIDER-LABEL-COUNT               01428705
014288             ELSE                                                 01428805
014289             IF  PC126-FCSE-LBL-CNT  >  0  AND                    01428905
014290                 PC126-P2L-LBL-CNT   >  0                         01429005
014291                 ADD  1  TO  PV-DIVIDER-LABEL-COUNT               01429105
014292             ELSE                                                 01429205
014293             IF  PC126-ODD-CRTN-UNT-QTY  >  0  AND                01429305
014294                 PC126-FCSE-LBL-CNT      >  0  AND                01429405
014295                 PC126-INPK-LBL-CNT      >  0                     01429505
014296                 ADD  2  TO  PV-DIVIDER-LABEL-COUNT               01429605
014297             ELSE                                                 01429705
014298             IF  PC126-FCSE-LBL-CNT  >  0  AND                    01429805
014299                 PC126-INPK-LBL-CNT  >  0                         01429905
014300                 ADD  1  TO  PV-DIVIDER-LABEL-COUNT               01430005
014310             ELSE                                                 01431005
014320             IF  PC126-ODD-CRTN-UNT-QTY  >  0  AND                01432005
014330                 PC126-INPK-LBL-CNT      >  0  AND                01433005
014340                 PC126-P2L-LBL-CNT       >  0                     01434005
014350                 ADD  1  TO  PV-DIVIDER-LABEL-COUNT               01435005
014360             IF  PC126-INPK-LBL-CNT  >  0  AND                    01436005
014370                 PC126-P2L-LBL-CNT   >  0                         01437005
014380                 ADD  1  TO  PV-DIVIDER-LABEL-COUNT               01438005
014390             END-IF                                               01439005
014400             END-IF                                               01440005
014410             END-IF                                               01441005
014420             END-IF                                               01442005
014430             END-IF                                               01443005
014440             END-IF                                               01444005
014450             END-IF                                               01445005
014460             END-IF                                               01446005
014470             ADD  PV-DIVIDER-LABEL-COUNT                          01447005
014480                  TO  PV-TOT-4X4-LBL-COUNT                        01448005
014490             PERFORM 5200-CREATE-TRANS-ID                         01449005
014500             PERFORM 5000-SOCKET-PROCESS                          01450005
014510         END-IF                                                   01451005
014520                                                                  01452005
014530         IF  PS-SOCKET-ERROR-NO                                   01453005
014540             PERFORM 0001-4BY4-PROCESSING                         01454005
014550         END-IF                                                   01455005
014560                                                                  01456005
014570         IF  PC126-SHP-XMIT-INTFC-CDE = PC-SOCKET-INTERFACE  and  01457005
014580             PS-SOCKET-ERROR-NO                                   01458005
014590             PERFORM 5500-BLD-TLR-REC                             01459005
014600         END-IF                                                   01460005
014610                                                                  01461005
014620         IF  PC126-SHP-XMIT-INTFC-CDE = PC-SOCKET-INTERFACE  and  01462005
014630             PS-SOCKET-ERROR-NO                                   01463005
014640             PERFORM 5340-CLOSE-SOCKET                            01464005
014650         END-IF                                                   01465005
014660                                                                  01466005
014670         IF PS-CS-ECOMMERCE-LINE-YES                              01467005
014680            PERFORM 1150-CHECK-FOR-BLIND-RECEIVING                01468005
014720         END-IF                                                   01472005
014730     END-IF.                                                      01473005
014740                                                                  01474005
014750*  AT THIS POINT WE HAVE SUBMITTED THE PRINT JOB FOR 4BY4         01475005
014760*  LABELS.                                                        01476043
014830                                                                  01483005
014840     IF  PS-SOCKET-ERROR-NO                                       01484005
014850         STRING 'PRINT REQ #'                                     01485005
014860                 PV-PC-CNTL-CDE-HOLD                              01486005
014870                ' SUBMITTED'        DELIMITED BY SIZE             01487005
014880                                      INTO PC126-CRA-RET-MSG      01488005
014890         MOVE '00'                    TO PC126-CRA-RET-CDE        01489005
014900     ELSE                                                         01490005
014910         MOVE   'SOCKET ERROR - NO LABELS '                       01491005
014920                                      TO PC126-CRA-RET-MSG        01492005
014930         MOVE '02'                    TO PC126-CRA-RET-CDE        01493005
014940     END-IF.                                                      01494005
014950                                                                  01495005
014960     PERFORM 9000-RETURN-CALL.                                    01496005
014970                                                                  01497005
014980 0001-4BY4-PROCESSING.                                            01498005
014990* DMH - 1/03/2005 - BEGIN                                         01499005
015000     IF   PS-DISPLAY-CSSL-YES                                     01500005
015010        INITIALIZE                       PV-CICS-MSG-AREA         01501005
015020        STRING ' PCKCS191- 0001-4BY4-PROCESSING   '               01502005
015030                                         DELIMITED BY SIZE        01503005
015040                                    INTO PV-CICS-MSG-AREA         01504005
015050        MOVE LENGTH OF PV-CICS-MSG-AREA                           01505005
015060                                      TO PV-COMMAREA-LENGTH       01506005
015070        EXEC CICS                                                 01507005
015080            WRITEQ TD                                             01508005
015090                QUEUE   ('CSSL')                                  01509005
015100                FROM    (PV-CICS-MSG-AREA)                        01510005
015110                LENGTH  (PV-COMMAREA-LENGTH)                      01511005
015120                RESP    (PV-CICS-RESP)                            01512005
015130        END-EXEC                                                  01513005
015140     END-IF.                                                      01514005
015150* DMH - 1/03/2005 - BEGIN                                         01515005
015160                                                                  01516005
015170* INCREMENTED THE LBL-SEQ-NBR HERE WORKS FINE BECAUSE ONLY ONE    01517005
015180* FILE IS SENT DOWN TO THE PC FOR 4BY4 LABELS.                    01518005
015190     PERFORM 7600-SELECT-FILE-NBR-ROW.                            01519005
015200     PERFORM 7700-UPDATE-FILE-NBR-ROW                             01520005
015210     PERFORM 9100-SYNCPOINT.                                      01521005
015220                                                                  01522005
015230     MOVE 'CS- SHIP MANIFEST LABEL'   TO PV-LABEL-NAME            01523005
015240     MOVE PC126-SHP-PRTR-ID           TO PV-3-DIGIT-PRT-ID        01524005
015250                                         PV-PC-FILE-PRT-ID.       01525005
015260     MOVE PC126-SHP-DATA-XFER-MODE-ID TO PV-JOB-DC.               01526005
015276     MOVE PC126-PO-NBR                TO PV-PO-NBR                01527605
015277     MOVE PC126-RCVR-SEQ-NBR          TO PV-RCVR-SEQ-NBR          01527705
015278                                                                  01527805
015279     IF  PC126-FCSE-LBL-CNT > ZERO OR                             01527905
015280         PC126-INPK-LBL-CNT > ZERO OR                             01528005
015281         PC126-P2L-LBL-CNT > ZERO                                 01528105
015282                                                                  01528205
015283         PERFORM 2000-PROC-HDR-LABELS                             01528305
015284                                                                  01528405
015285         IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO                      01528505
015286             IF  PC126-REPRINT                                    01528605
015287                 IF  PC126-ODD-CRTN-USE-P2L  AND                  01528705
015288                     PC126-P2L-RPRT-ALL                           01528805
015289                     PERFORM 3400-ODD-CARTON-LABEL                01528905
015290                     PERFORM 2160-FORMAT-DIVIDER-LBL              01529005
015300                 ELSE                                             01530005
015310                 IF  PC126-ODD-CRTN-USE-P2L  AND                  01531005
015320                     PC126-P2L-REPRT-FROM-CNT  =  PC-0001         01532005
015330                     PERFORM 3400-ODD-CARTON-LABEL                01533005
015340                     PERFORM 2160-FORMAT-DIVIDER-LBL              01534005
015350                 ELSE                                             01535005
015360                 IF  PC126-ODD-CRTN-USE-FCSE  AND                 01536005
015370                     (PC126-SHP-RPRT-FCSE-ALL  OR                 01537005
015380                      PC126-SHP-RPRT-ALL)                         01538005
015390                     PERFORM 3400-ODD-CARTON-LABEL                01539005
015400                         IF  PS-ODD-CART-FCSE-LBL-NOT-PRT         01540005
015410                             SET PS-ODD-CART-FCSE-LBL-PRTD        01541005
015420                                 PS-NOT-ODD-CART-LABEL TO TRUE    01542005
015430                         ELSE                                     01543005
015440                             PERFORM 2160-FORMAT-DIVIDER-LBL      01544005
015450                         END-IF                                   01545005
015460                 ELSE                                             01546005
015470                 IF  PC126-ODD-CRTN-USE-FCSE  AND                 01547005
015480                     PC126-SHP-REPRT-FROM-CNT  =  PC-0001         01548005
015490                     PERFORM 3400-ODD-CARTON-LABEL                01549005
015500* 10/16/00 - begin                                                01550005
015510                     IF  PS-ODD-CART-FCSE-LBL-NOT-PRT             01551005
015520                         SET PS-ODD-CART-FCSE-LBL-PRTD            01552005
015530                             PS-NOT-ODD-CART-LABEL TO TRUE        01553005
015540                     end-if                                       01554005
015550* 10/16/00 - end                                                  01555005
015560                     PERFORM 2160-FORMAT-DIVIDER-LBL              01556005
015570                 ELSE                                             01557005
015580                 IF  PC126-ODD-CRTN-USE-FCSE  AND                 01558005
015590                     PC126-SHP-REPRT-FROM-CNT  >  PC-0001         01559005
015600                     SET PS-ODD-CART-FCSE-LBL-PRTD                01560005
015610                         PS-NOT-ODD-CART-LABEL  TO  TRUE          01561005
015620                 ELSE                                             01562005
015630                 IF  PC126-ODD-CRTN-USE-INPK  AND                 01563005
015640                     (PC126-SHP-RPRT-INPK-ALL  OR                 01564005
015650                      PC126-SHP-RPRT-ALL)                         01565005
015660                     PERFORM 3400-ODD-CARTON-LABEL                01566005
015670                     IF  PV-DISTRO-SUM  >  ZERO  OR               01567005
015680                         PC126-FCSE-LBL-CNT  >  0                 01568005
015690                         PERFORM 2160-FORMAT-DIVIDER-LBL          01569005
015700                     END-IF                                       01570005
015710                 ELSE                                             01571005
015720                 IF  PC126-ODD-CRTN-USE-INPK  AND                 01572005
015730                     PC126-SHP-REPRT-FROM-CNT  =  PC-0001         01573005
015740                     PERFORM 3400-ODD-CARTON-LABEL                01574005
015750                     PERFORM 2160-FORMAT-DIVIDER-LBL              01575005
015760                 ELSE                                             01576005
015770                 IF  PC126-ODD-CRTN-USE-INPK  AND                 01577005
015780                     PC126-SHP-REPRT-FROM-CNT  >  PC-0001         01578005
015790                     DIVIDE PC126-ODD-CRTN-UNT-QTY                01579005
015800                         BY PC126-INPK-UNT-QTY                    01580005
015810                     GIVING PV-ODD-CRTN-INPK-LBLS-NEED            01581005
015820                     IF  PC126-SHP-REPRT-FROM-CNT  >              01582005
015830                         PV-ODD-CRTN-INPK-LBLS-NEED               01583005
015840                         MOVE  PV-ODD-CRTN-INPK-LBLS-NEED         01584005
015850                           TO  PV-ODD-CRTN-INPK-LBLS-NOT-NEED     01585005
015860                         PERFORM 3445-RESET-ODD-CRTN-COUNT        01586005
015870                         SET PS-ODD-CART-INPK-LBL-PRTD            01587005
015880                             PS-NOT-ODD-CART-LABEL  TO  TRUE      01588005
015890                     ELSE                                         01589005
015900                        SUBTRACT PC126-SHP-REPRT-FROM-CNT         01590005
015910                            FROM PV-ODD-CRTN-INPK-LBLS-NEED       01591005
015920                          GIVING PV-ODD-CRTN-INPK-LBLS-NOT-NEED   01592005
015930                             ADD 1                                01593005
015940                              TO PV-ODD-CRTN-INPK-LBLS-NOT-NEED   01594005
015950                         PERFORM 3445-RESET-ODD-CRTN-COUNT        01595005
015960                        SUBTRACT PC126-SHP-REPRT-FROM-CNT         01596005
015970                            FROM PV-ODD-CRTN-INPK-LBLS-NEED       01597005
015980                          GIVING PV-ODD-CRTN-INPK-LBLS-NOT-NEED   01598005
015990                             ADD 1                                01599005
016000                              TO PV-ODD-CRTN-INPK-LBLS-NOT-NEED   01600005
016010                         PERFORM 3400-ODD-CARTON-LABEL            01601005
016020                         PERFORM 2160-FORMAT-DIVIDER-LBL          01602005
016030                     END-IF                                       01603005
016040                 END-IF                                           01604005
016050                 END-IF                                           01605005
016060                 END-IF                                           01606005
016070                 END-IF                                           01607005
016080                 END-IF                                           01608005
016090                 END-IF                                           01609005
016100                 END-IF                                           01610005
016110                 END-IF                                           01611005
016120             ELSE                                                 01612005
016130                 PERFORM 3400-ODD-CARTON-LABEL                    01613005
016140                 PERFORM 2160-FORMAT-DIVIDER-LBL                  01614005
016150             END-IF                                               01615005
016160         END-IF                                                   01616005
016170                                                                  01617005
016180         IF PC126-FCSE-LBL-CNT > ZERO                             01618005
016190                    OR PC126-INPK-LBL-CNT > ZERO                  01619005
016200         EVALUATE TRUE                                            01620005
016210         WHEN PC126-SHIP-LBL-SML                                  01621005
016220             PERFORM 3100-4BY4-LABELS                             01622005
016230         END-EVALUATE                                             01623005
016240     END-IF                                                       01624005
016250                                                                  01625005
016260     IF PC126-P2L-LBL-CNT > ZERO                                  01626005
016270         IF PS-FCSE-WAS-PRINTED OR PS-INPK-WAS-PRINTED            01627005
016280             IF  PS-FCSE-WAS-PRINTED       AND                    01628005
016290                 PC126-FCSE-LBL-CNT  =  1  AND                    01629005
016300                 PC126-ODD-CRTN-USE-FCSE                          01630005
016310                     CONTINUE                                     01631005
016320             ELSE                                                 01632005
016330                 PERFORM 2160-FORMAT-DIVIDER-LBL                  01633005
016340             END-IF                                               01634005
016350         END-IF                                                   01635005
016360*        here its too late, short window for socket               01636005
016370*        PERFORM 8460-CHECK-IF-RFID                               01637005
016410         PERFORM 3300-P2L-LABELS                                  01641005
016420         MOVE ZERO                    TO PC126-P2L-LBL-CNT        01642005
016430     END-IF                                                       01643005
016440                                                                  01644005
016450     IF PC126-FCSE-LBL-CNT = ZERO AND PC126-INPK-LBL-CNT = ZERO   01645005
016460         AND PC126-SUPRESS-P2L-HDRS                               01646005
016470             CONTINUE                                             01647005
016480     ELSE                                                         01648005
016490         PERFORM 3900-PROC-SML-TRLR-LABEL                         01649005
016500     END-IF.                                                      01650005
016510                                                                  01651005
016520                                                                  01652005
016783 1000-INITIAL-PROCESS.                                            01678305
016784* DMH - 1/03/2005 - BEGIN                                         01678405
016785     IF   PS-DISPLAY-CSSL-YES                                     01678505
016786        INITIALIZE                       PV-CICS-MSG-AREA         01678605
016787        STRING ' PCKCS191- 1000-INITIAL-PROCESS     '             01678705
016788                                         DELIMITED BY SIZE        01678805
016789                                    INTO PV-CICS-MSG-AREA         01678905
016790        MOVE LENGTH OF PV-CICS-MSG-AREA                           01679005
016791                                      TO PV-COMMAREA-LENGTH       01679105
016792        EXEC CICS                                                 01679205
016793            WRITEQ TD                                             01679305
016794                QUEUE   ('CSSL')                                  01679405
016795                FROM    (PV-CICS-MSG-AREA)                        01679505
016796                LENGTH  (PV-COMMAREA-LENGTH)                      01679605
016797                RESP    (PV-CICS-RESP)                            01679705
016798        END-EXEC                                                  01679805
016799     END-IF.                                                      01679905
016800* DMH - 1/03/2005 - BEGIN                                         01680005
016810                                                                  01681005
016820     MOVE DFHCOMMAREA                 TO PC126-COMMAREA-REC       01682005
016830     MOVE SPACES                      TO PC126-CRA-RET-MSG        01683005
016840     SET  PC126-CRA-SUCCESSFUL        TO TRUE                     01684005
016850                                                                  01685005
016860                                                                  01686005
016870     EXEC CICS ASSIGN                                             01687005
016880               APPLID(PV-SYSTEM-ID)                               01688005
016890               USERID(PV-USER-ID)                                 01689005
016891     END-EXEC.                                                    01689105
016892                                                                  01689205
016893* TRY USING A COBOL FUNCTION FOR DATE/TIME                        01689305
016894     EXEC CICS                                                    01689405
016895               ASKTIME                                            01689505
016896               ABSTIME(PV-ABS-TIME)                               01689605
016897     END-EXEC.                                                    01689705
016898                                                                  01689805
016899     EXEC CICS FORMATTIME                                         01689905
016900                 ABSTIME(PV-ABS-TIME)                             01690005
016901                 YYMMDD(PV-DATE)                                  01690105
016902                 DATESEP                                          01690205
016903                 TIME(PV-TIME)                                    01690305
016904                 TIMESEP                                          01690405
016905     END-EXEC.                                                    01690505
016906                                                                  01690605
016907     MOVE PC126-OPER-UNT-ID           TO DK-OPER-UNT-ID           01690705
016908                                         PC180-OPER-UNT-ID.       01690805
016909     MOVE PC126-PO-NBR                TO DK-PO-NBR                01690905
016910                                         PC180-PO-NBR             01691005
016920                                         PURCHS-PO-NBR.           01692005
016930     MOVE PC126-RCVR-SEQ-NBR          TO DK-RCVR-SEQ-NBR          01693005
016940                                         PC180-RCVR-SEQ-NBR.      01694005
016950     MOVE PC126-PO-LNE-NBR            TO DK-ORD-LNE-NBR           01695005
016960                                         DK-WKORD-LNE-NBR.        01696005
016970     MOVE PC126-MOD-NBR               TO DK-MOD-NBR.              01697005
016980     MOVE PC126-PREPK-ID              TO DK-PREPK-ID.             01698005
016990     MOVE PC126-SHP-REPRT-FROM-CNT    TO DK-SHP-REPRT-FROM-CNT.   01699005
017000     PERFORM 1100-GET-CURRENT-DATE.                               01700005
017010* BBR WR41309 - RFID PROCESSING                                   01701005
017020*    SET PS-RFID-SKU-FIRST-CALL TO TRUE.                          01702005
017030* BBR WR41309 - END                                               01703005
017040                                                                  01704005
017050     PERFORM 1005-CHECK-CSSL-DISPLAY.                             01705005
017060                                                                  01706005
017070     PERFORM 1010-CHECK-TRIP-ON-P2L-LABEL.                        01707005
017071                                                                  01707105
017072* THE MANIFEST NUMBER APPEARS ONLY ON SHIPPING LABELS             01707205
017073     IF PC126-FCSE-LBL-CNT > ZERO OR PC126-INPK-LBL-CNT > ZERO    01707305
017074         PERFORM 1100-BUILD-LABEL-DISTRO-TABLE                    01707405
017075                                                                  01707505
017076     END-IF.                                                      01707605
017077                                                                  01707705
017078     IF   PS-DISPLAY-CSSL-YES                                     01707805
017079        STRING ' PCKCS191- IS IT P2L > 0            '             01707904
017080                                         DELIMITED BY SIZE        01708004
017081               PC126-P2L-LBL-CNT                                  01708104
017082                                         DELIMITED BY SIZE        01708204
017083                                    INTO PV-CICS-MSG-AREA         01708304
017084        MOVE LENGTH OF PV-CICS-MSG-AREA                           01708404
017085                                      TO PV-COMMAREA-LENGTH       01708504
017086        EXEC CICS                                                 01708604
017087            WRITEQ TD                                             01708704
017088                QUEUE   ('CSSL')                                  01708804
017089                FROM    (PV-CICS-MSG-AREA)                        01708904
017090                LENGTH  (PV-COMMAREA-LENGTH)                      01709004
017091                RESP    (PV-CICS-RESP)                            01709104
017092        END-EXEC                                                  01709204
017093     END-IF.                                                      01709305
017094     IF PC126-P2L-LBL-CNT > 0                                     01709404
017095         PERFORM 8460-CHECK-IF-RFID                               01709504
017096     END-IF.                                                      01709604
017097                                                                  01709704
017098     SET PS-CALL-ITEM-DOMAIN-YES TO TRUE                          01709804
017099     IF PC126-REPRINT                                             01709904
017100         SET PS-CALL-ITEM-DOMAIN-YES TO TRUE                      01710004
017101     ELSE                                                         01710104
017102         SET PS-MANIFEST-DC-NOT-FND TO TRUE                       01710204
017103         PERFORM 1125-CHECK-FOR-MANIFESTING                       01710304
017104         IF PS-MANIFEST-DC-FOUND                                  01710404
017105             SET PS-CALL-ITEM-DOMAIN-NO TO TRUE                   01710504
017106             PERFORM 8400-LABEL-MANIFESTING                       01710604
017107         ELSE                                                     01710704
017108             IF PS-CS-ECOMMERCE-LINE-YES                          01710804
017109                SET PS-CALL-ITEM-DOMAIN-NO TO TRUE                01710904
017110                PERFORM 8401-LABEL-MANIFESTING-RDM                01711004
017120             END-IF                                               01712004
017130         END-IF                                                   01713004
017140     END-IF.                                                      01714004
017150                                                                  01715004
017160     IF PS-CALL-ITEM-DOMAIN-YES                                   01716004
017170        PERFORM 8580-CALL-XLKUT001-2                              01717004
017180     END-IF.                                                      01718004
017190     IF PC126-FCSE-LBL-CNT > ZERO OR PC126-INPK-LBL-CNT > ZERO    01719004
017200        PERFORM 7200-GET-AD-DATE                                  01720004
017210        PERFORM 2500-CHECK-EAS-TAG                                01721004
017220        PERFORM 1300-DETERMINE-BUSINESS-AREA                      01722004
017230        PERFORM 1200-DETERMINE-MERCH-PRES                         01723004
017231*CLP 06/19/2015 START                                             01723117
017240        PERFORM 1400-CHECK-BRAND                                  01724017
017241*CLP 06/19/2015 END                                               01724117
017250     END-IF.                                                      01725004
017260*                                                                 01726004
017270                                                                  01727004
017280     PERFORM 1130-GET-SOCKET-TIMEOUT.                             01728004
017290                                                                  01729004
017300*-----------------------------------------------------------------01730004
017310*  CHECK IF CSSL LOGGING IS NEEDED                                01731004
017320*-----------------------------------------------------------------01732004
017330 1005-CHECK-CSSL-DISPLAY.                                         01733004
017340                                                                  01734004
017350     SET PS-DISPLAY-CSSL-NO  TO TRUE                              01735004
017360                                                                  01736004
017370     EXEC SQL                                                     01737004
017380          SELECT FUNC_TXT                                         01738004
017390          INTO  :KRPRPM-FUNC-TXT                                  01739004
017400          FROM   TKRPRPM                                          01740004
017410          WHERE  SYS_PRC_FUNC_CDE  = 'PLCSSL'                     01741004
017420            AND  LOC_ID            = :DK-OPER-UNT-ID              01742004
017430            AND  INTFC_SYS_CDE     = 'KHL'                        01743004
017440            AND  FUNC_PRC_STAT_CDE = 'AC'                         01744004
017450            AND  FUNC_TXT          = 'Y'                          01745004
017460     END-EXEC.                                                    01746004
017470                                                                  01747004
017480     EVALUATE TRUE                                                01748004
017490         WHEN SQLCODE = ZERO                                      01749004
017500             SET PS-DISPLAY-CSSL-YES   TO TRUE                    01750004
017510         WHEN SQLCODE = +100                                      01751004
017520             SET PS-DISPLAY-CSSL-NO    TO TRUE                    01752004
017530         WHEN SQLWARN0 NOT = SPACES                               01753004
017540         WHEN SQLCODE < ZERO                                      01754004
017550         WHEN SQLCODE > ZERO                                      01755004
017560             SET PS-DISPLAY-CSSL-NO    TO TRUE                    01756004
017570              INITIALIZE  PV-CICS-MSG-AREA                        01757004
017580              MOVE SQLCODE             TO PV-SQL-RETURN-CD        01758004
017590              STRING ' PCKCS191 - '             DELIMITED BY SIZE 01759004
017600                     '1005-CHECK-CSSL-DISPLAY'  DELIMITED BY SIZE 01760004
017610                     '  SQL - '                 DELIMITED BY SIZE 01761004
017620                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 01762004
017621                                           INTO PV-CICS-MSG-AREA  01762104
017622              MOVE LENGTH OF PV-CICS-MSG-AREA                     01762204
017623                     TO PV-COMMAREA-LENGTH                        01762304
017624              PERFORM 9999-WRITE-TO-CSSL                          01762404
017625              INITIALIZE  PV-CICS-MSG-AREA                        01762504
017626              STRING ' PCKCS191 -'             DELIMITED BY SIZE  01762604
017627                     ' PO:'                    DELIMITED BY SIZE  01762704
017628                     PC126-PO-NBR              DELIMITED BY SIZE  01762804
017629                     ' RCVR:'                  DELIMITED BY SIZE  01762904
017630                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  01763004
017631                     ' LINE:'                  DELIMITED BY SIZE  01763104
017632                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  01763204
017633                     ' STR:'                   DELIMITED BY SIZE  01763304
017634                     DK-STORE-NMBR             DELIMITED BY SIZE  01763404
017635                                           INTO PV-CICS-MSG-AREA  01763504
017636              MOVE LENGTH OF PV-CICS-MSG-AREA                     01763604
017637                     TO PV-COMMAREA-LENGTH                        01763704
017638              PERFORM 9999-WRITE-TO-CSSL                          01763804
017639                                                                  01763904
017640             STRING 'ERR FILE# SQL='                              01764004
017641                        DELIMITED BY SIZE                         01764104
017642                        PV-SQL-RETURN-CD                          01764204
017643                        DELIMITED BY SIZE                         01764304
017644                               INTO PC126-CRA-RET-MSG             01764404
017645             MOVE '02'                TO PC126-CRA-RET-CDE        01764504
017646             MOVE '1005-'             TO PC126-CRA-REQ-ID         01764604
017647             PERFORM 9000-RETURN-CALL                             01764704
017648                                                                  01764804
017649     END-EVALUATE.                                                01764904
017650                                                                  01765004
017651                                                                  01765104
017652*-----------------------------------------------------------------01765204
017653*  CHECK TO SEE IF THE DC WANTS TO HAVE THE TRIP ARRIVE DATE      01765304
017654*  TO APPEAR ON THE P2L LABEL                                     01765404
017655*                                                                 01765504
017656 1010-CHECK-TRIP-ON-P2L-LABEL.                                    01765604
017657                                                                  01765704
017658     SET PS-P2L-MOD-ON-LABEL TO TRUE                              01765804
017659                                                                  01765904
017660     EXEC SQL                                                     01766004
017661          SELECT FUNC_TXT                                         01766104
017662          INTO  :PS-P2L-LABEL-DISPLAY-SW                          01766204
017663          FROM   TKRPRPM                                          01766304
017664          WHERE  SYS_PRC_FUNC_CDE  = 'P2LARV'                     01766404
017665            and  FUNC_BEG_TMST    <=  current timestamp           01766504
017666            and  FUNC_end_TMST    >=  current timestamp           01766604
017667            AND  LOC_ID            = :DK-OPER-UNT-ID              01766704
017668            AND  INTFC_SYS_CDE     = 'KHL'                        01766804
017669            AND  FUNC_PRC_STAT_CDE = 'AC'                         01766904
017670     END-EXEC.                                                    01767004
017680                                                                  01768004
017681     EVALUATE TRUE                                                01768104
017682         WHEN SQLCODE = ZERO                                      01768204
017683             SET PS-TRIP-ARRIVE-DATE-ON-LABEL   TO  TRUE          01768304
017684         WHEN SQLCODE = +100                                      01768404
017685             SET PS-P2L-MOD-ON-LABEL   TO TRUE                    01768504
017686         WHEN SQLWARN0 NOT = SPACES                               01768604
017687         WHEN SQLCODE < ZERO                                      01768704
017688         WHEN SQLCODE > ZERO                                      01768804
017689             SET PS-P2L-MOD-ON-LABEL   TO TRUE                    01768904
017690              INITIALIZE  PV-CICS-MSG-AREA                        01769004
017691              MOVE SQLCODE             TO PV-SQL-RETURN-CD        01769104
017692              STRING ' PCKCS191 - '                               01769204
017693                     '1010-CHECK-P2LARV PARM '                    01769304
017694                     '  SQL - '                                   01769404
017695                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 01769504
017696                                           INTO PV-CICS-MSG-AREA  01769604
017697              MOVE LENGTH OF PV-CICS-MSG-AREA                     01769704
017698                     TO PV-COMMAREA-LENGTH                        01769804
017699              PERFORM 9999-WRITE-TO-CSSL                          01769904
017700              INITIALIZE  PV-CICS-MSG-AREA                        01770004
017701              STRING ' PCKCS191 -'                                01770104
017702                     ' PO:'                                       01770204
017703                     PC126-PO-NBR                                 01770304
017704                     ' RCVR:'                                     01770404
017705                     PC126-RCVR-SEQ-NBR                           01770504
017706                     ' LINE:'                                     01770604
017707                     PC126-PO-LNE-NBR                             01770704
017708                     ' STR:'                                      01770804
017709                     DK-STORE-NMBR             DELIMITED BY SIZE  01770904
017710                                           INTO PV-CICS-MSG-AREA  01771004
017711              MOVE LENGTH OF PV-CICS-MSG-AREA                     01771104
017712                     TO PV-COMMAREA-LENGTH                        01771204
017713              PERFORM 9999-WRITE-TO-CSSL                          01771304
017714                                                                  01771404
017715             STRING 'ERR FILE# SQL='                              01771504
017716                        DELIMITED BY SIZE                         01771604
017717                        PV-SQL-RETURN-CD                          01771704
017718                        DELIMITED BY SIZE                         01771804
017719                               INTO PC126-CRA-RET-MSG             01771904
017720             MOVE '02'                TO PC126-CRA-RET-CDE        01772004
017721             MOVE '1010-'             TO PC126-CRA-REQ-ID         01772104
017722             PERFORM 9000-RETURN-CALL                             01772204
017723                                                                  01772304
017724     END-EVALUATE.                                                01772404
017725                                                                  01772504
017726                                                                  01772604
017727                                                                  01772704
017728                                                                  01772804
017729*-----------------------------------------------------------------01772904
017730*  GET CURRENT DATE TO PRINT ON LABEL                             01773004
017731*-----------------------------------------------------------------01773104
017732 1100-GET-CURRENT-DATE.                                           01773204
017733* DMH - 1/03/2005 - BEGIN                                         01773304
017734     IF   PS-DISPLAY-CSSL-YES                                     01773404
017735        INITIALIZE                       PV-CICS-MSG-AREA         01773504
017736        STRING ' PCKCS191- 1100-GET-CURRENT-DATE    '             01773604
017737                                         DELIMITED BY SIZE        01773704
017738                                    INTO PV-CICS-MSG-AREA         01773804
017739        MOVE LENGTH OF PV-CICS-MSG-AREA                           01773904
017740                                      TO PV-COMMAREA-LENGTH       01774004
017741        EXEC CICS                                                 01774104
017742            WRITEQ TD                                             01774204
017743                QUEUE   ('CSSL')                                  01774304
017744                FROM    (PV-CICS-MSG-AREA)                        01774404
017745                LENGTH  (PV-COMMAREA-LENGTH)                      01774504
017746                RESP    (PV-CICS-RESP)                            01774604
017747        END-EXEC                                                  01774704
017748     END-IF.                                                      01774804
017749* DMH - 1/03/2005 - BEGIN                                         01774904
017750                                                                  01775004
017751     EXEC SQL                                                     01775104
017752         SELECT  CURRENT DATE                                     01775204
017753                ,CURRENT TIME                                     01775304
017754           INTO  :PV-CURRENT-DATE                                 01775404
017755                ,:PV-CURRENT-TIME                                 01775504
017756           FROM  TCOCNTL                                          01775604
017757          WHERE  OPER_UNT_ID = 90                                 01775704
017758     END-EXEC.                                                    01775804
017759                                                                  01775904
017760     EVALUATE TRUE                                                01776004
017761         WHEN SQLCODE = ZERO                                      01776104
017762              MOVE  PV-CURRENT-MM  TO  PV-LBL-PRT-MM              01776204
017763              MOVE  PV-CURRENT-DD  TO  PV-LBL-PRT-DD              01776304
017764              MOVE  PV-CURRENT-YY  TO  PV-LBL-PRT-YY              01776404
017765              MOVE  PV-CURRENT-HR  TO  PV-LBL-PRT-HR              01776504
017766              MOVE  PV-CURRENT-MN  TO  PV-LBL-PRT-MN              01776604
017767                                                                  01776704
017768         WHEN OTHER                                               01776804
017769              CONTINUE                                            01776904
017770      END-EVALUATE.                                               01777004
017771                                                                  01777104
017772                                                                  01777204
017773 1100-BUILD-LABEL-DISTRO-TABLE.                                   01777304
017774                                                                  01777404
017775* DMH - 1/03/2005 - BEGIN                                         01777504
017776     IF   PS-DISPLAY-CSSL-YES                                     01777604
017777        INITIALIZE                       PV-CICS-MSG-AREA         01777704
017778        STRING ' PCKCS191- 1100-BUILD-LABEL-DISTRO-TABLE'         01777804
017779                                         DELIMITED BY SIZE        01777904
017780                                    INTO PV-CICS-MSG-AREA         01778004
017781        MOVE LENGTH OF PV-CICS-MSG-AREA                           01778104
017782                                      TO PV-COMMAREA-LENGTH       01778204
017783        EXEC CICS                                                 01778304
017784            WRITEQ TD                                             01778404
017785                QUEUE   ('CSSL')                                  01778504
017786                FROM    (PV-CICS-MSG-AREA)                        01778604
017787                LENGTH  (PV-COMMAREA-LENGTH)                      01778704
017788                RESP    (PV-CICS-RESP)                            01778804
017789        END-EXEC                                                  01778904
017790     END-IF.                                                      01779004
017800* DMH - 1/03/2005 - BEGIN                                         01780004
017810                                                                  01781004
017820     INITIALIZE PT-LABEL-DISTRO-TABLE.                            01782004
017830     IF  PC126-CALLED-FROM-STRLST                                 01783004
017840         PERFORM 1102-USE-TS-QUEUE                                01784004
017850     ELSE                                                         01785004
017860         PERFORM 1101-USE-CURSOR                                  01786004
017870     END-IF.                                                      01787004
017880                                                                  01788004
017890 1101-USE-CURSOR.                                                 01789004
017900                                                                  01790004
017910* DMH - 1/03/2005 - BEGIN                                         01791004
017911     IF   PS-DISPLAY-CSSL-YES                                     01791104
017912        INITIALIZE                       PV-CICS-MSG-AREA         01791204
017913        STRING ' PCKCS191- 1101-USE-CURSOR              '         01791304
017914                                         DELIMITED BY SIZE        01791404
017915                                    INTO PV-CICS-MSG-AREA         01791504
017916        MOVE LENGTH OF PV-CICS-MSG-AREA                           01791604
017917                                      TO PV-COMMAREA-LENGTH       01791704
017918        EXEC CICS                                                 01791804
017919            WRITEQ TD                                             01791904
017920                QUEUE   ('CSSL')                                  01792004
017921                FROM    (PV-CICS-MSG-AREA)                        01792104
017922                LENGTH  (PV-COMMAREA-LENGTH)                      01792204
017923                RESP    (PV-CICS-RESP)                            01792304
017924        END-EXEC                                                  01792404
017925     END-IF.                                                      01792504
017926* DMH - 1/03/2005 - BEGIN                                         01792604
017927                                                                  01792704
017928     SET PS-NOT-EOF-DISTRO-CSR                                    01792804
017929         PS-SEASET-DATA-FOUND                                     01792904
017930         PS-POG-DATA-FOUND            TO TRUE                     01793004
017940                                                                  01794004
017950* DMH 10/31/02                                                    01795004
017960         IF  PC126-PRE-PACK-ORDER                                 01796004
017970             PERFORM 1120-GET-PREPK-OTPK-UNTS                     01797004
017980         END-IF                                                   01798004
017990* DMH 10/31/02                                                    01799004
017991                                                                  01799104
017992     PERFORM 7000-OPEN-STORE-CSR.                                 01799204
017993     PERFORM 7010-FETCH-STORE-CSR.                                01799304
017994     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1                    01799404
017995                  UNTIL PS-EOF-DISTRO-CSR OR                      01799504
017996                  PT-DISTRO-IDX > 1000                            01799604
017997         MOVE DISTDT-STR-NBR          TO PT-STR-NBR               01799704
017998                                        (PT-DISTRO-IDX)           01799804
017999         MOVE PV-TYPE-CODE            TO PT-TYPE-CODE             01799904
018000                                        (PT-DISTRO-IDX)           01800004
018001         MOVE XLT00010-LOC-10-ABBR-NM                             01800104
018002                                      TO PT-STR-ABBR10            01800204
018003                                        (PT-DISTRO-IDX)           01800304
018004         MOVE DISTDT-STR-NBR          TO PT-STORE-NMBR            01800404
018005                                        (PT-DISTRO-IDX)           01800504
018006         ADD  +1  TO PV-PT-LABEL-TABLE-ENTRIES                    01800604
018007                                                                  01800704
018008         IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO  AND                 01800804
018009             PC126-ODD-CRTN-USE-FCSE          AND                 01800904
018010             DISTDT-ODD-CART-IND     =  PC-F                      01801004
018020             SUBTRACT  PC126-ODD-CRTN-UNT-QTY                     01802004
018030                 FROM  PV-DISTDT-UNT-QTY                          01803004
018040               GIVING  PV-DISTDT-UNT-QTY-LESS-ODD                 01804004
018050             DIVIDE PV-DISTDT-UNT-QTY-LESS-ODD                    01805004
018060                 BY PC126-OTPK-UNT-QTY GIVING PV-RESULT           01806004
018070                    REMAINDER PV-REMAINDER                        01807004
018080             MOVE PV-RESULT           TO PT-FCSE-LABELS-NEEDED    01808004
018090                                             (PT-DISTRO-IDX)      01809004
018100             ADD  1                   TO PT-FCSE-LABELS-NEEDED    01810004
018110                                             (PT-DISTRO-IDX)      01811004
018120         ELSE                                                     01812004
018130             DIVIDE PV-DISTDT-UNT-QTY                             01813004
018140                 BY PC126-OTPK-UNT-QTY GIVING PV-RESULT           01814004
018150                    REMAINDER PV-REMAINDER                        01815004
018160             MOVE PV-RESULT           TO PT-FCSE-LABELS-NEEDED    01816004
018170                                             (PT-DISTRO-IDX)      01817004
018180         END-IF                                                   01818004
018190                                                                  01819004
018200         IF PV-REMAINDER > ZERO                                   01820004
018210             DIVIDE PV-REMAINDER BY PC126-INPK-UNT-QTY            01821004
018220                         GIVING PV-RESULT                         01822004
018230             MOVE PV-RESULT           TO PT-INPK-LABELS-NEEDED    01823004
018240                                             (PT-DISTRO-IDX)      01824004
018250         END-IF                                                   01825004
018260         MOVE DISTDT-ODD-CART-IND     TO PT-ODD-CART-IND          01826004
018270                                        (PT-DISTRO-IDX)           01827004
018280                                                                  01828004
018290                                                                  01829004
018300                                                                  01830004
018310     MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                           01831004
018320                                        TO PV-STORE-NBR-4         01832004
018330     IF  PS-SEASET-DATA-FOUND                                     01833004
018340         MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                       01834004
018350                                   TO PV-KEY-DEST-LOC             01835004
018360         PERFORM 8305-CALL-SET-FIXT-ID-MOD                        01836004
018370         IF  PS-SEASET-DATA-FOUND OR                              01837004
018380              (PV-CURRENT-DATE < XLT00010-OPN-DTE)                01838004
018390             IF  PS-POG-DATA-FOUND                                01839004
018400             OR  (PV-CURRENT-DATE < XLT00010-OPN-DTE)             01840004
018410                 MOVE PC240-FIXT-ID TO                            01841004
018420                      PT-FIXT-ID (PT-DISTRO-IDX)                  01842004
018430                 MOVE PC240-SEASET-NM TO                          01843004
018440                      PT-SEASONAL-SET-NAME (PT-DISTRO-IDX)        01844004
018450                      SEASET-SEASET-NM                            01845004
018460             ELSE                                                 01846004
018470                 MOVE PC240-SEASET-NM TO                          01847004
018480                      PT-SEASONAL-SET-NAME (PT-DISTRO-IDX)        01848004
018490                      SEASET-SEASET-NM                            01849004
018500             END-IF                                               01850004
018510         ELSE                                                     01851004
018520             MOVE SPACES TO                                       01852004
018530                  PT-SEASONAL-SET-NAME (PT-DISTRO-IDX)            01853004
018540                  PT-FIXT-ID (PT-DISTRO-IDX)                      01854004
018550                  SEASET-SEASET-NM                                01855004
018560         END-IF                                                   01856004
018570     ELSE                                                         01857004
018580        MOVE ZEROES TO PV-STORE-NBR-PFX                           01858004
018590     END-IF                                                       01859004
018600                                                                  01860004
018610*    MOVE '@@@@@@@@@@'                TO PC253-FIXTURE            01861004
018620     MOVE PV-STORE-NBR TO PT-DIVERT-CODE (PT-DISTRO-IDX)          01862004
018630                                                                  01863004
018640*--CHECK FOR DC DOOR ID      ------------------------------------*01864004
018650     IF DISTDT-STR-NBR = PV-HOLD-DEST-LOC                         01865004
018660        CONTINUE                                                  01866004
018670     ELSE                                                         01867004
018680        MOVE DISTDT-STR-NBR TO PV-HOLD-DEST-LOC                   01868004
018690        PERFORM 2400-GET-CURRENT-DOOR                             01869004
018700     END-IF                                                       01870004
018710     MOVE CNDCDR-DOOR-ID TO PT-DC-DOOR-ID (PT-DISTRO-IDX)         01871004
018720                                                                  01872004
018730* IF THE LABELS ARE TO PRINT IN SHUFFLED SEQUENCE, THEY           01873004
018740* WILL PRINT ONE AT A TIME FOR EACH STORE.  OTHERWISE THE         01874004
018750* MAX FOR EACH STORE WILL PRINT.                                  01875004
018760*                                                                 01876004
018770* STORES THAT HAVE A TYPE-CODE OF 'DC', 'CS,' OR 'RV' WILL        01877004
018780* ALWAYS PRINT IN STORE SEQUENCE AHEAD OF ALL THE OTHER LABELS.   01878004
018790                                                                  01879004
018800         IF PC126-PRT-SHUFFLED                                    01880004
018810             IF PV-CS-DC-RTV                                      01881004
018820                 IF PC126-SHP-RPRT-FCSE OR                        01882004
018830                        PC126-SHP-RPRT-INPK                       01883004
018840                     MOVE 1           TO PT-FCSE-LABEL-SEQ-QTY    01884004
018850                                             (PT-DISTRO-IDX)      01885004
018860                                         PT-INPK-LABEL-SEQ-QTY    01886004
018861                                             (PT-DISTRO-IDX)      01886104
018862                 ELSE                                             01886204
018863                     MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)   01886304
018864                                      TO PT-FCSE-LABEL-SEQ-QTY    01886404
018865                                             (PT-DISTRO-IDX)      01886504
018866* 7/13 - BEGIN                                                    01886604
018867                     IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO  AND     01886704
018868                         PC126-ODD-CRTN-USE-FCSE          AND     01886804
018869                         DISTDT-ODD-CART-IND     =  PC-F          01886904
018870                         SUBTRACT  1  FROM  PT-FCSE-LABEL-SEQ-QTY 01887004
018871                                             (PT-DISTRO-IDX)      01887104
018872                     END-IF                                       01887204
018873* 7/13 - END                                                      01887304
018874                     MOVE PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)   01887404
018875                                      TO PT-INPK-LABEL-SEQ-QTY    01887504
018876                                             (PT-DISTRO-IDX)      01887604
018877                 END-IF                                           01887704
018878                 IF PV-CENTRAL-STOCK                              01887804
018879                     PERFORM 1105-CENTRAL-STOCK-DEFAULT           01887904
018880                 END-IF                                           01888004
018890             ELSE                                                 01889004
018900                 MOVE 1               TO PT-FCSE-LABEL-SEQ-QTY    01890004
018910                                             (PT-DISTRO-IDX)      01891004
018920                                         PT-INPK-LABEL-SEQ-QTY    01892004
018930                                             (PT-DISTRO-IDX)      01893004
018940             END-IF                                               01894004
018950         ELSE                                                     01895004
018960* (STORE SEQUENCE FOR 4BY4 AND PIGGYBACK LABELS)                  01896004
018970             MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)           01897004
018980                                      TO PT-FCSE-LABEL-SEQ-QTY    01898004
018990                                             (PT-DISTRO-IDX)      01899004
019000* 7/13 - BEGIN                                                    01900004
019010             IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO  AND             01901004
019020                 PC126-ODD-CRTN-USE-FCSE          AND             01902004
019030                 DISTDT-ODD-CART-IND     =  PC-F                  01903004
019040                 SUBTRACT  1  FROM  PT-FCSE-LABEL-SEQ-QTY         01904004
019050                                             (PT-DISTRO-IDX)      01905004
019060             END-IF                                               01906004
019070* 7/13 - END                                                      01907004
019080             MOVE PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)           01908004
019090                                      TO PT-INPK-LABEL-SEQ-QTY    01909004
019100                                             (PT-DISTRO-IDX)      01910004
019110             IF PV-CENTRAL-STOCK AND PC126-SHIP-LBL-SML           01911004
019120                 PERFORM 1105-CENTRAL-STOCK-DEFAULT               01912004
019130             END-IF                                               01913004
019140         END-IF                                                   01914004
019150                                                                  01915004
019160         MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                       01916004
019170                                      TO DK-STORE-NMBR            01917004
019180                                         DK-STR-NBR               01918004
019190                                                                  01919004
019200         ADD PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)                01920004
019210             PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX) GIVING         01921004
019220                 PV-TOTAL-LABELS-FOR-STORE                        01922004
019230                                                                  01923004
019240                                                                  01924004
019250         IF PC126-REPRINT                                         01925004
019260            PERFORM 8900-CHECK-FOR-RPRT-MFST-NBR                  01926004
019270            SET PS-NOT-EO-REPRINT-MNFST-CSR TO TRUE               01927004
019280            IF PC126-SHP-RPRT-ALL                                 01928004
019290               MOVE 'F' TO PV-CART-TYP-CDE-OTPK                   01929004
019300               MOVE 'I' TO PV-CART-TYP-CDE-INPK                   01930004
019310            ELSE                                                  01931004
019320            IF PC126-SHP-RPRT-FCSE-ALL OR                         01932004
019330               PC126-SHP-RPRT-FCSE                                01933004
019340                  MOVE 'F'   TO PV-CART-TYP-CDE-OTPK              01934004
019350                  MOVE SPACE TO PV-CART-TYP-CDE-INPK              01935004
019360            ELSE                                                  01936004
019370            IF PC126-SHP-RPRT-INPK-ALL OR                         01937004
019380               PC126-SHP-RPRT-INPK                                01938004
019390                  MOVE SPACE TO PV-CART-TYP-CDE-OTPK              01939004
019400                  MOVE 'I' TO PV-CART-TYP-CDE-INPK                01940004
019410            END-IF                                                01941004
019420            END-IF                                                01942004
019430            END-IF                                                01943004
019440         END-IF                                                   01944004
019450         IF PC126-REPRINT AND (PV-DB2-COUNT > 0)                  01945004
019460            PERFORM 8940-OPEN-REPRINT-MNFST-CSR                   01946004
019470            PERFORM 8950-FETCH-REPRINT-MFST-CSR                   01947004
019480                    UNTIL PS-EO-REPRINT-MNFST-CSR                 01948004
019490            PERFORM 8960-CLOSE-REPRINT-MNFST-CSR                  01949004
019500         ELSE                                                     01950004
019510            PERFORM 7160-GET-MANIFEST-NBR                         01951004
019520         END-IF                                                   01952004
019530**check if the line is for ecomm or                               01953004
019540** central stock, if so set switch to check for blind receiving   01954004
019550         IF PS-CS-ECOMMERCE-LINE-NO                               01955004
019560            IF PV-CENTRAL-STOCK OR PV-E-COMMERCE                  01956004
019570               SET PS-CS-ECOMMERCE-LINE-YES TO TRUE               01957004
019580               MOVE PT-STR-NBR (PT-DISTRO-IDX)                    01958004
019590                                   TO DK-CS-ECOMM-STORE-LOC       01959004
019600            END-IF                                                01960004
019610         END-IF                                                   01961004
019620                                                                  01962004
019630         PERFORM 7010-FETCH-STORE-CSR                             01963004
019640                                                                  01964004
019650     END-PERFORM.                                                 01965004
019660                                                                  01966004
019670                                                                  01967004
019680     PERFORM 7020-CLOSE-STORE-CSR.                                01968004
019690/                                                                 01969004
019700 1102-USE-TS-QUEUE.                                               01970004
019710                                                                  01971004
019720* DMH - 1/03/2005 - BEGIN                                         01972004
019730     IF   PS-DISPLAY-CSSL-YES                                     01973004
019740        INITIALIZE                       PV-CICS-MSG-AREA         01974004
019750        STRING ' PCKCS191- 1102-USE-TS-QUEUE            '         01975004
019760                                         DELIMITED BY SIZE        01976004
019770                                    INTO PV-CICS-MSG-AREA         01977004
019780        MOVE LENGTH OF PV-CICS-MSG-AREA                           01978004
019790                                      TO PV-COMMAREA-LENGTH       01979004
019800        EXEC CICS                                                 01980004
019810            WRITEQ TD                                             01981004
019820                QUEUE   ('CSSL')                                  01982004
019830                FROM    (PV-CICS-MSG-AREA)                        01983004
019840                LENGTH  (PV-COMMAREA-LENGTH)                      01984004
019850                RESP    (PV-CICS-RESP)                            01985004
019860        END-EXEC                                                  01986004
019870     END-IF.                                                      01987004
019880* DMH - 1/03/2005 - BEGIN                                         01988004
019890                                                                  01989004
019900     MOVE LENGTH OF PC128-COMMAREA-REC                            01990004
019910                                      TO PV-READ-LENGTH.          01991004
019920     SET PS-NOT-PGBK-REQST-QUEUE-EOF  TO TRUE.                    01992004
019930                                                                  01993004
019940     PERFORM 9200-READ-STORE-QUEUE                                01994004
019950                                                                  01995004
019960     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1                    01996004
019970                  UNTIL PS-PGBK-REQST-QUEUE-EOF OR                01997004
019980                  PT-DISTRO-IDX > 1000                            01998004
019990               OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES       01999004
020000         MOVE PC128-STR-NBR           TO PT-STORE-NMBR            02000004
020010                                        (PT-DISTRO-IDX)           02001004
020020                                         DK-STORE-NMBR            02002004
020030                                         DK-STR-NBR               02003004
020040                                         DISTDT-STR-NBR           02004004
020041         MOVE PC128-FCSE-LBL-CNT      TO PT-FCSE-LABELS-NEEDED    02004104
020042                                             (PT-DISTRO-IDX)      02004204
020043         MOVE PC128-INPK-LBL-CNT      TO PT-INPK-LABELS-NEEDED    02004304
020044                                             (PT-DISTRO-IDX)      02004404
020045         MOVE PC128-ODD-CART-SW       TO PT-ODD-CART-IND          02004504
020046                                             (PT-DISTRO-IDX)      02004604
020047**GB*12/12/00  BEGIN *********************************************02004704
020048                                                                  02004804
020049       MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                         02004904
020050                                        TO PV-STORE-NBR-4         02005004
020051       IF  PS-SEASET-DATA-FOUND OR                                02005104
020052          (PV-CURRENT-DATE < XLT00010-OPN-DTE)                    02005204
020053           MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                     02005304
020054                                     TO PV-KEY-DEST-LOC           02005404
020055           PERFORM 8305-CALL-SET-FIXT-ID-MOD                      02005504
020056           IF  PS-SEASET-DATA-FOUND OR                            02005604
020057              (PV-CURRENT-DATE < XLT00010-OPN-DTE)                02005704
020058               MOVE PC240-FIXT-ID TO                              02005804
020059                        PT-FIXT-ID (PT-DISTRO-IDX)                02005904
020060               MOVE PC240-SEASET-NM TO                            02006004
020070                           PT-SEASONAL-SET-NAME (PT-DISTRO-IDX)   02007004
020080                           SEASET-SEASET-NM                       02008004
020090           ELSE                                                   02009004
020100               MOVE SPACES TO                                     02010004
020110                    PT-SEASONAL-SET-NAME (PT-DISTRO-IDX)          02011004
020120                    PT-FIXT-ID (PT-DISTRO-IDX)                    02012004
020130                    SEASET-SEASET-NM                              02013004
020140           END-IF                                                 02014004
020150       ELSE                                                       02015004
020160           MOVE ZEROES TO PV-STORE-NBR-PFX                        02016004
020170       END-IF                                                     02017004
020180                                                                  02018004
020190*      MOVE '@@@@@@@@@@'                TO PC253-FIXTURE          02019004
020200*--CHECK FOR DC DOOR ID      ------------------------------------*02020004
020210       PERFORM 2400-GET-CURRENT-DOOR                              02021004
020220       MOVE CNDCDR-DOOR-ID TO PT-DC-DOOR-ID (PT-DISTRO-IDX)       02022004
020230                                                                  02023004
020240                                                                  02024004
020250                                                                  02025004
020260       MOVE PV-STORE-NBR TO PT-DIVERT-CODE (PT-DISTRO-IDX)        02026004
020270**GB*12/12/00 ---END**********************************************02027004
020280                                                                  02028004
020290* LABELS FROM THE STORE QUEUE WILL ALWAYS PRINT IN STORE SEQUENCE 02029004
020300*                                                                 02030004
020310         MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)               02031004
020320                                      TO PT-FCSE-LABEL-SEQ-QTY    02032004
020330                                             (PT-DISTRO-IDX)      02033004
020340         MOVE PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)               02034004
020350                                      TO PT-INPK-LABEL-SEQ-QTY    02035004
020360                                             (PT-DISTRO-IDX)      02036004
020370                                                                  02037004
020380         PERFORM 7935-GET-STORE-TYPE                              02038004
020390                                                                  02039004
020400         MOVE PV-TYPE-CODE            TO PT-TYPE-CODE             02040004
020410                                        (PT-DISTRO-IDX)           02041004
020420                                                                  02042004
020430         IF PV-CENTRAL-STOCK                                      02043004
020440             PERFORM 1105-CENTRAL-STOCK-DEFAULT                   02044004
020450         END-IF                                                   02045004
020460                                                                  02046004
020470         ADD PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)                02047004
020480             PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX) GIVING         02048004
020490                 PV-TOTAL-LABELS-FOR-STORE                        02049004
020500                                                                  02050004
020510         IF PC126-REPRINT                                         02051004
020520            PERFORM 8900-CHECK-FOR-RPRT-MFST-NBR                  02052004
020530            SET  PS-NOT-EO-REPRINT-MNFST-CSR  TO TRUE             02053004
020540            IF PC126-SHP-RPRT-ALL                                 02054004
020550               MOVE 'F' TO PV-CART-TYP-CDE-OTPK                   02055004
020560               MOVE 'I' TO PV-CART-TYP-CDE-INPK                   02056004
020570            ELSE                                                  02057004
020580            IF PC126-SHP-RPRT-FCSE-ALL OR                         02058004
020590               PC126-SHP-RPRT-FCSE                                02059004
020600                  MOVE 'F'   TO PV-CART-TYP-CDE-OTPK              02060004
020610                  MOVE SPACE TO PV-CART-TYP-CDE-INPK              02061004
020620            ELSE                                                  02062004
020630            IF PC126-SHP-RPRT-INPK-ALL OR                         02063004
020640               PC126-SHP-RPRT-INPK                                02064004
020650                  MOVE SPACE TO PV-CART-TYP-CDE-OTPK              02065004
020660                  MOVE 'I'   TO PV-CART-TYP-CDE-INPK              02066004
020670            END-IF                                                02067004
020680            END-IF                                                02068004
020690            END-IF                                                02069004
020700         END-IF                                                   02070004
020710                                                                  02071004
020720         IF PC126-REPRINT AND (PV-DB2-COUNT > 0)                  02072004
020730            PERFORM 8940-OPEN-REPRINT-MNFST-CSR                   02073004
020740            PERFORM 8950-FETCH-REPRINT-MFST-CSR                   02074004
020750                    UNTIL PS-EO-REPRINT-MNFST-CSR                 02075004
020760            PERFORM 8960-CLOSE-REPRINT-MNFST-CSR                  02076004
020770         ELSE                                                     02077004
020780            PERFORM 7160-GET-MANIFEST-NBR                         02078004
020790         END-IF                                                   02079004
020800                                                                  02080004
020810         PERFORM 7170-GET-XLT-LOC-OTHER-INFO                      02081004
020820                                                                  02082004
020830         MOVE XLT00010-LOC-10-ABBR-NM                             02083004
020840                                      TO PT-STR-ABBR10            02084004
020850                                        (PT-DISTRO-IDX)           02085004
020860         MOVE XLT00010-LOC-NBR        TO PT-STR-NBR               02086004
020870                                        (PT-DISTRO-IDX)           02087004
020880                                                                  02088004
020890         PERFORM 9100-SYNCPOINT                                   02089004
020900                                                                  02090004
020910         PERFORM 9200-READ-STORE-QUEUE                            02091004
020920                                                                  02092004
020930     END-PERFORM.                                                 02093004
020940/                                                                 02094004
020950 1105-CENTRAL-STOCK-DEFAULT.                                      02095004
020960                                                                  02096004
020970* DMH - 1/03/2005 - BEGIN                                         02097004
020980     IF   PS-DISPLAY-CSSL-YES                                     02098004
020990        INITIALIZE                       PV-CICS-MSG-AREA         02099004
021000        STRING ' PCKCS191- 1105-CENTRAL-STOCK-DEFAULT    '        02100004
021010                                         DELIMITED BY SIZE        02101004
021020                                    INTO PV-CICS-MSG-AREA         02102004
021030        MOVE LENGTH OF PV-CICS-MSG-AREA                           02103004
021040                                      TO PV-COMMAREA-LENGTH       02104004
021050        EXEC CICS                                                 02105004
021060            WRITEQ TD                                             02106004
021070                QUEUE   ('CSSL')                                  02107004
021080                FROM    (PV-CICS-MSG-AREA)                        02108004
021090                LENGTH  (PV-COMMAREA-LENGTH)                      02109004
021100                RESP    (PV-CICS-RESP)                            02110004
021200        END-EXEC                                                  02120004
021210     END-IF.                                                      02121004
021220* DMH - 1/03/2005 - BEGIN                                         02122004
021230                                                                  02123004
021240     PERFORM 7930-SELECT-TCOCNTL.                                 02124004
021250                                                                  02125004
021260     SET PS-CS-OVERRIDE           TO TRUE.                        02126004
021270                                                                  02127004
021280     IF PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)                     02128004
021290                          > COCNTL-DFLT-CNSTK-LBL-QTY             02129004
021300         ADD PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)                02130004
021301                                      TO                          02130104
021302                         PV-ORIG-CS-QTY-FCSE                      02130204
021303         MOVE COCNTL-DFLT-CNSTK-LBL-QTY                           02130304
021304                                      TO                          02130404
021305                         PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)    02130504
021306                         PT-FCSE-LABEL-SEQ-QTY (PT-DISTRO-IDX)    02130604
021307         ADD COCNTL-DFLT-CNSTK-LBL-QTY                            02130704
021308                                      TO PV-CS-TOT-CTNS-FCSE      02130804
021309         SET PS-CS-OVERRIDE           TO TRUE                     02130904
021310* 10/16/00 - begin                                                02131004
021311     ELSE                                                         02131104
021312         MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)               02131204
021313                     TO  PT-FCSE-LABEL-SEQ-QTY (PT-DISTRO-IDX)    02131304
021314* 10/16/00 - end                                                  02131404
021315     END-IF.                                                      02131504
021316                                                                  02131604
021317     IF PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)                     02131704
021318                          > COCNTL-DFLT-CNSTK-LBL-QTY             02131804
021319         ADD PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)                02131904
021320                                      TO                          02132004
021330                         PV-ORIG-CS-QTY-INPK                      02133004
021340         MOVE COCNTL-DFLT-CNSTK-LBL-QTY                           02134004
021350                                      TO                          02135004
021360                         PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)    02136004
021370                         PT-INPK-LABEL-SEQ-QTY (PT-DISTRO-IDX)    02137004
021380         ADD COCNTL-DFLT-CNSTK-LBL-QTY                            02138004
021390                                      TO PV-CS-TOT-CTNS-INPK      02139004
021400         SET PS-CS-OVERRIDE           TO TRUE                     02140004
021410     END-IF.                                                      02141004
021420                                                                  02142004
021430******************************************************************02143004
021440* GET OTPK UNITS FOR PREPACK                                      02144004
021450******************************************************************02145004
021460 1120-GET-PREPK-OTPK-UNTS.                                        02146004
021470                                                                  02147004
021480* DMH - 1/03/2005 - BEGIN                                         02148004
021490     IF   PS-DISPLAY-CSSL-YES                                     02149004
021500        INITIALIZE                       PV-CICS-MSG-AREA         02150004
021510        STRING ' PCKCS191- 1120-GET-PREPK-OTPK-UNTS      '        02151004
021520                                         DELIMITED BY SIZE        02152004
021530                                    INTO PV-CICS-MSG-AREA         02153004
021540        MOVE LENGTH OF PV-CICS-MSG-AREA                           02154004
021550                                      TO PV-COMMAREA-LENGTH       02155004
021560        EXEC CICS                                                 02156004
021570            WRITEQ TD                                             02157004
021580                QUEUE   ('CSSL')                                  02158004
021590                FROM    (PV-CICS-MSG-AREA)                        02159004
021600                LENGTH  (PV-COMMAREA-LENGTH)                      02160004
021610                RESP    (PV-CICS-RESP)                            02161004
021620        END-EXEC                                                  02162004
021630     END-IF.                                                      02163004
021640* DMH - 1/03/2005 - BEGIN                                         02164004
021650                                                                  02165004
021660     EXEC SQL                                                     02166004
021670         SELECT                                                   02167004
021680             SUM(A.OTPK_UNT_QTY)                                  02168004
021690         ,   SUM(A.INPK_UNT_QTY)                                  02169004
021700         INTO                                                     02170004
021710             :DISTHD-OTPK-UNT-QTY                                 02171004
021720         ,   :DISTHD-INPK-UNT-QTY                                 02172004
021721         FROM                                                     02172104
021722             TDISTHD A                                            02172204
021723         ,   TRECITM C                                            02172304
021724         ,   TPURITM D                                            02172404
021725         WHERE                                                    02172504
021726             A.ORD_NBR                = :DK-PO-NBR                02172604
021727         AND A.RCVR_SEQ_NBR           = :DK-RCVR-SEQ-NBR          02172704
021728         AND A.ORD_NBR                = C.ORD_NBR                 02172804
021729         AND A.RCVR_SEQ_NBR           = C.REC_SEQ_NBR             02172904
021730         AND C.PREPK_ID               = :DK-PREPK-ID              02173004
021731         AND A.ORD_LNE_NBR            = C.ORD_LNE_NBR             02173104
021732         AND C.ORD_NBR                =  D.PO_NBR                 02173204
021733         AND C.ORD_LNE_NBR            =  D.APP_PO_LNE_NBR         02173304
021734         AND C.VER_STATUS_CDE         = 'A'                       02173404
021735         AND C.PO_VER_NBR             =  D.VER_NBR                02173504
021736         GROUP BY C.PREPK_ID                                      02173604
021737     END-EXEC.                                                    02173704
021738                                                                  02173804
021739     EVALUATE TRUE                                                02173904
021740         WHEN SQLCODE = ZERO                                      02174004
021750             MOVE  DISTHD-INPK-UNT-QTY                            02175004
021760               TO  PC126-PREPK-INPK-UNT-QTY                       02176004
021770                                                                  02177004
021780         WHEN SQLCODE = +100                                      02178004
021790             CONTINUE                                             02179004
021800         WHEN SQLWARN0 NOT = SPACES                               02180004
021810         WHEN SQLCODE < ZERO                                      02181004
021820         WHEN SQLCODE > ZERO                                      02182004
021830              INITIALIZE  PV-CICS-MSG-AREA                        02183004
021840              MOVE SQLCODE             TO PV-SQL-RETURN-CD        02184004
021850              STRING ' PCKCS191 - '             DELIMITED BY SIZE 02185004
021860                     '1120-GET-PREPK-OTPK-UNT'  DELIMITED BY SIZE 02186004
021870                     '  SQL - '                 DELIMITED BY SIZE 02187004
021880                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02188004
021890                                           INTO PV-CICS-MSG-AREA  02189004
021900              MOVE LENGTH OF PV-CICS-MSG-AREA                     02190004
021910                     TO PV-COMMAREA-LENGTH                        02191004
021920              PERFORM 9999-WRITE-TO-CSSL                          02192004
021930              INITIALIZE  PV-CICS-MSG-AREA                        02193004
021940              STRING ' PCKCS191 -'             DELIMITED BY SIZE  02194004
021950                     ' PO:'                    DELIMITED BY SIZE  02195004
021960                     PC126-PO-NBR              DELIMITED BY SIZE  02196004
021970                     ' RCVR:'                  DELIMITED BY SIZE  02197004
021980                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02198004
021990                     ' LINE:'                  DELIMITED BY SIZE  02199004
022000                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  02200004
022010                     ' STR:'                   DELIMITED BY SIZE  02201004
022020                     DK-STORE-NMBR             DELIMITED BY SIZE  02202004
022030                                           INTO PV-CICS-MSG-AREA  02203004
022040              MOVE LENGTH OF PV-CICS-MSG-AREA                     02204004
022050                     TO PV-COMMAREA-LENGTH                        02205004
022060              PERFORM 9999-WRITE-TO-CSSL                          02206004
022070                                                                  02207004
022080             STRING 'ERR FILE# SQL='                              02208004
022090                        DELIMITED BY SIZE                         02209004
022100                        PV-SQL-RETURN-CD                          02210004
022110                        DELIMITED BY SIZE                         02211004
022120                               INTO PC126-CRA-RET-MSG             02212004
022130             MOVE '02'                TO PC126-CRA-RET-CDE        02213004
022140             MOVE '1120-'             TO PC126-CRA-REQ-ID         02214004
022150             PERFORM 9000-RETURN-CALL                             02215004
022160                                                                  02216004
022170     END-EVALUATE.                                                02217004
022180                                                                  02218004
022190                                                                  02219004
022200******************************************************************02220004
022210*CHECK IF DC IS USING MANIFESTING                                 02221004
022220******************************************************************02222004
022230 1125-CHECK-FOR-MANIFESTING.                                      02223004
022240                                                                  02224004
022250* DMH - 1/03/2005 - BEGIN                                         02225004
022260     IF   PS-DISPLAY-CSSL-YES                                     02226004
022270        INITIALIZE                       PV-CICS-MSG-AREA         02227004
022280        STRING ' PCKCS191- 1125-CHECK-FOR-MANIFESTING    '        02228004
022290                                         DELIMITED BY SIZE        02229004
022300                                    INTO PV-CICS-MSG-AREA         02230004
022310        MOVE LENGTH OF PV-CICS-MSG-AREA                           02231004
022320                                      TO PV-COMMAREA-LENGTH       02232004
022330        EXEC CICS                                                 02233004
022340            WRITEQ TD                                             02234004
022350                QUEUE   ('CSSL')                                  02235004
022360                FROM    (PV-CICS-MSG-AREA)                        02236004
022370                LENGTH  (PV-COMMAREA-LENGTH)                      02237004
022380                RESP    (PV-CICS-RESP)                            02238004
022390        END-EXEC                                                  02239004
022400     END-IF.                                                      02240004
022410* DMH - 1/03/2005 - BEGIN                                         02241004
022420                                                                  02242004
022430     EXEC SQL                                                     02243004
022440          SELECT FUNC_END_TMST                                    02244004
022450          INTO  :KRPRPM-FUNC-END-TMST                             02245004
022460          FROM   TKRPRPM                                          02246004
022470          WHERE  SYS_PRC_FUNC_CDE  = 'CSMFST'                     02247004
022480            AND  LOC_ID            = :DK-OPER-UNT-ID              02248004
022490            AND  INTFC_SYS_CDE     = 'KHL'                        02249004
022491            AND  FUNC_PRC_STAT_CDE = 'AC'                         02249104
022492            AND  FUNC_TXT          = 'Y'                          02249204
022493     END-EXEC.                                                    02249304
022494                                                                  02249404
022495                                                                  02249504
022496     EVALUATE TRUE                                                02249604
022497         WHEN SQLCODE = ZERO                                      02249704
022498             SET PS-MANIFEST-DC-FOUND  TO TRUE                    02249804
022499         WHEN SQLCODE = +100                                      02249904
022500             SET PS-MANIFEST-DC-NOT-FND TO TRUE                   02250004
022501         WHEN SQLWARN0 NOT = SPACES                               02250104
022502         WHEN SQLCODE < ZERO                                      02250204
022503         WHEN SQLCODE > ZERO                                      02250304
022504              INITIALIZE  PV-CICS-MSG-AREA                        02250404
022505              MOVE SQLCODE             TO PV-SQL-RETURN-CD        02250504
022506              STRING ' PCKCS191 - '             DELIMITED BY SIZE 02250604
022507                     '1125-CHECK-FOR-MANIFEST'  DELIMITED BY SIZE 02250704
022508                     '  SQL - '                 DELIMITED BY SIZE 02250804
022509                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02250904
022510                                           INTO PV-CICS-MSG-AREA  02251004
022520              MOVE LENGTH OF PV-CICS-MSG-AREA                     02252004
022530                     TO PV-COMMAREA-LENGTH                        02253004
022540              PERFORM 9999-WRITE-TO-CSSL                          02254004
022550              INITIALIZE  PV-CICS-MSG-AREA                        02255004
022560              STRING ' PCKCS191 -'             DELIMITED BY SIZE  02256004
022570                     ' PO:'                    DELIMITED BY SIZE  02257004
022580                     PC126-PO-NBR              DELIMITED BY SIZE  02258004
022590                     ' RCVR:'                  DELIMITED BY SIZE  02259004
022600                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02260004
022610                     ' LINE:'                  DELIMITED BY SIZE  02261004
022620                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  02262004
022630                     ' STR:'                   DELIMITED BY SIZE  02263004
022640                     DK-STORE-NMBR             DELIMITED BY SIZE  02264004
022650                                           INTO PV-CICS-MSG-AREA  02265004
022660              MOVE LENGTH OF PV-CICS-MSG-AREA                     02266004
022670                     TO PV-COMMAREA-LENGTH                        02267004
022680              PERFORM 9999-WRITE-TO-CSSL                          02268004
022690                                                                  02269004
022700             STRING 'ERR FILE# SQL='                              02270004
022710                        DELIMITED BY SIZE                         02271004
022720                        PV-SQL-RETURN-CD                          02272004
022730                        DELIMITED BY SIZE                         02273004
022740                               INTO PC126-CRA-RET-MSG             02274004
022750             MOVE '02'                TO PC126-CRA-RET-CDE        02275004
022760             MOVE '1125-'             TO PC126-CRA-REQ-ID         02276004
022770             PERFORM 9000-RETURN-CALL                             02277004
022780                                                                  02278004
022790     END-EVALUATE.                                                02279004
022800/                                                                 02280004
022810*----------------------------------------------------------------*02281004
022820* SELECT SOCKET TIMEOUT FROM PARAMETER DATABASE                  *02282004
022830* DMH - 10/06/04 - BEGIN                                          02283004
022840*----------------------------------------------------------------*02284004
022850 1130-GET-SOCKET-TIMEOUT.                                         02285004
022860                                                                  02286004
022870* DMH - 1/03/2005 - BEGIN                                         02287004
022880     IF   PS-DISPLAY-CSSL-YES                                     02288004
022890        INITIALIZE                       PV-CICS-MSG-AREA         02289004
022900        STRING ' PCKCS191- 1130-GET-SOCKET-TIMEOUT       '        02290004
022910                                         DELIMITED BY SIZE        02291004
022920                                    INTO PV-CICS-MSG-AREA         02292004
022930        MOVE LENGTH OF PV-CICS-MSG-AREA                           02293004
022940                                      TO PV-COMMAREA-LENGTH       02294004
022950        EXEC CICS                                                 02295004
022960            WRITEQ TD                                             02296004
022970                QUEUE   ('CSSL')                                  02297004
022980                FROM    (PV-CICS-MSG-AREA)                        02298004
022990                LENGTH  (PV-COMMAREA-LENGTH)                      02299004
023000                RESP    (PV-CICS-RESP)                            02300004
023010        END-EXEC                                                  02301004
023020     END-IF.                                                      02302004
023030* DMH - 1/03/2005 - BEGIN                                         02303004
023040                                                                  02304004
023050     EXEC SQL                                                     02305004
023060          SELECT  FUNC_QTY                                        02306004
023061            INTO :KRPRPM-FUNC-QTY                                 02306104
023062            FROM  tKRPRPM                                         02306204
023063           WHERE  LOC_ID            =  90                         02306304
023064             AND  SYS_PRC_FUNC_CDE  = 'SCKTM3'                    02306404
023065             AND  FUNC_PRC_STAT_CDE = 'AC'                        02306504
023066             AND  INTFC_SYS_CDE     = 'KHL'                       02306604
023067     END-EXEC.                                                    02306704
023068                                                                  02306804
023069     EVALUATE TRUE                                                02306904
023070                                                                  02307004
023071         WHEN SQLCODE = +0                                        02307104
023072              MOVE KRPRPM-FUNC-QTY  TO  SELECT-SECS               02307204
023073                                                                  02307304
023074         WHEN SQLCODE = +100                                      02307404
023075              CONTINUE                                            02307504
023076                                                                  02307604
023077         WHEN SQLWARN0 NOT = SPACES                               02307704
023078         WHEN SQLCODE < ZERO                                      02307804
023079         WHEN SQLCODE > ZERO                                      02307904
023080              INITIALIZE  PV-CICS-MSG-AREA                        02308004
023081              MOVE SQLCODE             TO PV-SQL-RETURN-CD        02308104
023082              STRING ' PCKCS191 - '                               02308204
023083                     '1130-GET-SOCKET '                           02308304
023084                     '  SQL - '                                   02308404
023085                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02308504
023086                                           INTO PV-CICS-MSG-AREA  02308604
023087              MOVE LENGTH OF PV-CICS-MSG-AREA                     02308704
023088                     TO PV-COMMAREA-LENGTH                        02308804
023089              PERFORM 9999-WRITE-TO-CSSL                          02308904
023090              INITIALIZE  PV-CICS-MSG-AREA                        02309004
023091              STRING ' PCKCS191 -'                                02309104
023092                     ' PO:'   PC126-PO-NBR                        02309204
023093                     ' RCVR:' PC126-RCVR-SEQ-NBR                  02309304
023094                     ' LINE:' PC126-PO-LNE-NBR                    02309404
023095                     ' STR:'  DK-STORE-NMBR     DELIMITED BY SIZE 02309504
023096                                           INTO PV-CICS-MSG-AREA  02309604
023097              MOVE LENGTH OF PV-CICS-MSG-AREA                     02309704
023098                     TO PV-COMMAREA-LENGTH                        02309804
023099              PERFORM 9999-WRITE-TO-CSSL                          02309904
023100                                                                  02310004
023101             STRING 'ERR FILE# SQL='                              02310104
023102                     PV-SQL-RETURN-CD    DELIMITED BY SIZE        02310204
023103                                    INTO PC126-CRA-RET-MSG        02310304
023104             MOVE '02'                TO PC126-CRA-RET-CDE        02310404
023105             MOVE '1125-'             TO PC126-CRA-REQ-ID         02310504
023106             PERFORM 9000-RETURN-CALL                             02310604
023107     END-EVALUATE.                                                02310704
023108* DMH - 10/06/04 - BEGIN                                          02310804
023109                                                                  02310904
023110/                                                                 02311004
023111******************************************************************02311104
023112*CHECK IF ECOMMERCE OF CENTRAL STOCK LOCATION IS USING RDM VER 10 02311204
023113******************************************************************02311304
023114 1150-CHECK-FOR-BLIND-RECEIVING.                                  02311404
023115                                                                  02311504
023116* DMH - 1/03/2005 - BEGIN                                         02311604
023117     IF   PS-DISPLAY-CSSL-YES                                     02311704
023118        INITIALIZE                       PV-CICS-MSG-AREA         02311804
023119        STRING ' PCKCS191- 1150-CHECK-FOR-BLIND-RECEIVING'        02311904
023120                                         DELIMITED BY SIZE        02312004
023121                                    INTO PV-CICS-MSG-AREA         02312104
023122        MOVE LENGTH OF PV-CICS-MSG-AREA                           02312204
023123                                      TO PV-COMMAREA-LENGTH       02312304
023124        EXEC CICS                                                 02312404
023125            WRITEQ TD                                             02312504
023126                QUEUE   ('CSSL')                                  02312604
023127                FROM    (PV-CICS-MSG-AREA)                        02312704
023128                LENGTH  (PV-COMMAREA-LENGTH)                      02312804
023129                RESP    (PV-CICS-RESP)                            02312904
023130        END-EXEC                                                  02313004
023131     END-IF.                                                      02313104
023132* DMH - 1/03/2005 - BEGIN                                         02313204
023133                                                                  02313304
023134     EXEC SQL                                                     02313404
023135          SELECT FUNC_END_TMST                                    02313504
023136          INTO  :KRPRPM-FUNC-END-TMST                             02313604
023137          FROM   TKRPRPM                                          02313704
023138          WHERE  SYS_PRC_FUNC_CDE  = 'RDMRCV'                     02313804
023139            AND  LOC_ID            = :DK-CS-ECOMM-STORE-LOC       02313904
023140            AND  INTFC_SYS_CDE     = 'RDM'                        02314004
023141            AND  FUNC_PRC_STAT_CDE = 'AC'                         02314104
023142            AND  FUNC_TXT          = 'Y'                          02314204
023143     END-EXEC.                                                    02314304
023144                                                                  02314404
023145                                                                  02314504
023146     EVALUATE TRUE                                                02314604
023147         WHEN SQLCODE = ZERO                                      02314704
023148             SET PS-BLND-RECV-SIMPL-LOC-FND TO TRUE               02314804
023149         WHEN SQLCODE = +100                                      02314904
023150             SET PS-BLND-RECV-SIMPL-LOC-NOT-FND TO TRUE           02315004
023151         WHEN SQLWARN0 NOT = SPACES                               02315104
023152         WHEN SQLCODE < ZERO                                      02315204
023153         WHEN SQLCODE > ZERO                                      02315304
023154              INITIALIZE  PV-CICS-MSG-AREA                        02315404
023155              MOVE SQLCODE             TO PV-SQL-RETURN-CD        02315504
023156              STRING ' PCKCS191 - '             DELIMITED BY SIZE 02315604
023157                     '1150-CHECK-FOR-BLIND-RE'  DELIMITED BY SIZE 02315704
023158                     '  SQL - '                 DELIMITED BY SIZE 02315804
023159                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02315904
023160                                           INTO PV-CICS-MSG-AREA  02316004
023161              MOVE LENGTH OF PV-CICS-MSG-AREA                     02316104
023162                     TO PV-COMMAREA-LENGTH                        02316204
023163              PERFORM 9999-WRITE-TO-CSSL                          02316304
023164              INITIALIZE  PV-CICS-MSG-AREA                        02316404
023165              STRING ' PCKCS191 -'             DELIMITED BY SIZE  02316504
023166                     ' PO:'                    DELIMITED BY SIZE  02316604
023167                     PC126-PO-NBR              DELIMITED BY SIZE  02316704
023168                     ' RCVR:'                  DELIMITED BY SIZE  02316804
023169                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02316904
023170                     ' LINE:'                  DELIMITED BY SIZE  02317004
023180                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  02318004
023190                     ' STR:'                   DELIMITED BY SIZE  02319004
023200                     DK-STORE-NMBR             DELIMITED BY SIZE  02320004
023210                                           INTO PV-CICS-MSG-AREA  02321004
023220              MOVE LENGTH OF PV-CICS-MSG-AREA                     02322004
023230                     TO PV-COMMAREA-LENGTH                        02323004
023240              PERFORM 9999-WRITE-TO-CSSL                          02324004
023250                                                                  02325004
023260             STRING 'ERR FILE# SQL='                              02326004
023270                        DELIMITED BY SIZE                         02327004
023280                        PV-SQL-RETURN-CD                          02328004
023290                        DELIMITED BY SIZE                         02329004
023300                               INTO PC126-CRA-RET-MSG             02330004
023310             MOVE '02'                TO PC126-CRA-RET-CDE        02331004
023320             MOVE '1150-'             TO PC126-CRA-REQ-ID         02332004
023330             PERFORM 9000-RETURN-CALL                             02333004
023340                                                                  02334004
023350     END-EVALUATE.                                                02335004
023360/                                                                 02336004
023751 1200-DETERMINE-MERCH-PRES.                                       02375104
023752                                                                  02375204
023753* DMH - 1/03/2005 - BEGIN                                         02375304
023754     IF   PS-DISPLAY-CSSL-YES                                     02375404
023755        INITIALIZE                       PV-CICS-MSG-AREA         02375504
023756        STRING ' PCKCS191- 1200-DETERMINE-MERCH-PRES     '        02375604
023757                                         DELIMITED BY SIZE        02375704
023758                                    INTO PV-CICS-MSG-AREA         02375804
023759        MOVE LENGTH OF PV-CICS-MSG-AREA                           02375904
023760                                      TO PV-COMMAREA-LENGTH       02376004
023770        EXEC CICS                                                 02377004
023780            WRITEQ TD                                             02378004
023790                QUEUE   ('CSSL')                                  02379004
023800                FROM    (PV-CICS-MSG-AREA)                        02380004
023810                LENGTH  (PV-COMMAREA-LENGTH)                      02381004
023820                RESP    (PV-CICS-RESP)                            02382004
023830        END-EXEC                                                  02383004
023840     END-IF.                                                      02384004
023850* DMH - 1/03/2005 - BEGIN                                         02385004
023860                                                                  02386004
023870* dmh temp display                                                02387004
023880*             INITIALIZE  PV-CICS-MSG-AREA                        02388004
023890*             STRING ' PCKCS191 -'             DELIMITED BY SIZE  02389004
023900*                    ' PO:'                    DELIMITED BY SIZE  02390004
023910*                    PC126-PO-NBR              DELIMITED BY SIZE  02391004
023920*                    ' RCVR:'                  DELIMITED BY SIZE  02392004
023930*                    PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02393004
023940*                    ' LINE:'                  DELIMITED BY SIZE  02394004
023950*                    PC126-PO-LNE-NBR          DELIMITED BY SIZE  02395004
023960*                    ' 1200-determine-merch'   DELIMITED BY SIZE  02396004
023970*                                          INTO PV-CICS-MSG-AREA  02397004
023980*             MOVE LENGTH OF PV-CICS-MSG-AREA                     02398004
023990*                    TO PV-COMMAREA-LENGTH                        02399004
023991*             PERFORM 9999-WRITE-TO-CSSL                          02399104
023992*             INITIALIZE  PV-CICS-MSG-AREA                        02399204
023993*             STRING ' PCKCS191 -'             DELIMITED BY SIZE  02399304
023994*                    ' xl001-hng-fold-cde-'    DELIMITED BY SIZE  02399404
023995*                    xl001-hng-fold-cde        DELIMITED BY SIZE  02399504
023996*                                          INTO PV-CICS-MSG-AREA  02399604
023997*             MOVE LENGTH OF PV-CICS-MSG-AREA                     02399704
023998*                    TO PV-COMMAREA-LENGTH                        02399804
023999*             PERFORM 9999-WRITE-TO-CSSL.                         02399904
024000* dmh temp display                                                02400004
024001      EVALUATE XL001-HNG-FOLD-CDE                                 02400104
024002         WHEN 'H'                                                 02400204
024003            SET PC253-HANG to true                                02400343
024005         WHEN 'F'                                                 02400504
024006            SET PC253-FOLD to true                                02400643
024008         WHEN OTHER                                               02400804
024009            SET PC253-DEFLT-PRESENTATION to true                  02400943
024020      END-EVALUATE.                                               02402004
024030                                                                  02403004
024040 1300-DETERMINE-BUSINESS-AREA.                                    02404004
024050                                                                  02405004
024060     IF   PS-DISPLAY-CSSL-YES                                     02406004
024070        INITIALIZE                       PV-CICS-MSG-AREA         02407004
024080        STRING ' PCKCS191- 1300-DETERMINE-BUSINESS-AREA  '        02408004
024090                                         DELIMITED BY SIZE        02409004
024100                                    INTO PV-CICS-MSG-AREA         02410004
024110        MOVE LENGTH OF PV-CICS-MSG-AREA                           02411004
024120                                      TO PV-COMMAREA-LENGTH       02412004
024130        EXEC CICS                                                 02413004
024140            WRITEQ TD                                             02414004
024150                QUEUE   ('CSSL')                                  02415004
024160                FROM    (PV-CICS-MSG-AREA)                        02416004
024170                LENGTH  (PV-COMMAREA-LENGTH)                      02417004
024180                RESP    (PV-CICS-RESP)                            02418004
024190        END-EXEC                                                  02419004
024200     END-IF.                                                      02420004
024210                                                                  02421004
024220     INITIALIZE XL073-COMMAREA-REC                                02422004
024230     MOVE PC126-DEPT-NBR              TO XL073-DEPT-NBR           02423004
024240     CALL XL073-DEPT-CL-MODULE USING DFHEIBLK                     02424004
024250                                     XL073-COMMAREA               02425004
024260                                     XL073-COMMAREA-REC           02426004
024270                                                                  02427004
024280     EVALUATE TRUE                                                02428004
024290         WHEN XL073-NO-ERRORS                                     02429004
024300             MOVE XL073-BUS-AREA-ID TO PC253-MDSE-GROUP           02430004
024320         WHEN XL073-DEPT-NOT-FND                                  02432004
024330             MOVE '@@'              TO PC253-MDSE-GROUP           02433004
024350         WHEN OTHER                                               02435004
024360              INITIALIZE  PV-CICS-MSG-AREA                        02436004
024370              MOVE XL073-SQLCODE       TO PV-SQL-RETURN-CD        02437004
024380              STRING ' PCKCS191 - '             DELIMITED BY SIZE 02438004
024381                     '1300-DETERMINE-BUSINESS-' DELIMITED BY SIZE 02438104
024382                     '  SQL - '                 DELIMITED BY SIZE 02438204
024383                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02438304
024384                     ' TABLE- '                 DELIMITED BY SIZE 02438404
024385                     XL073-DB2-TABLE            DELIMITED BY SIZE 02438504
024386                                           INTO PV-CICS-MSG-AREA  02438604
024387              MOVE LENGTH OF PV-CICS-MSG-AREA                     02438704
024388                     TO PV-COMMAREA-LENGTH                        02438804
024389              PERFORM 9999-WRITE-TO-CSSL                          02438904
024390              INITIALIZE  PV-CICS-MSG-AREA                        02439004
024400              STRING ' PCKCS191 -'             DELIMITED BY SIZE  02440004
024401                     ' PO:'                    DELIMITED BY SIZE  02440104
024402                     PC126-PO-NBR              DELIMITED BY SIZE  02440204
024403                     ' RCVR:'                  DELIMITED BY SIZE  02440304
024404                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02440404
024405                     ' LINE:'                  DELIMITED BY SIZE  02440504
024406                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  02440604
024407                     ' STR:'                   DELIMITED BY SIZE  02440704
024408                     DK-STORE-NMBR             DELIMITED BY SIZE  02440804
024409                                           INTO PV-CICS-MSG-AREA  02440904
024410              MOVE LENGTH OF PV-CICS-MSG-AREA                     02441004
024420                     TO PV-COMMAREA-LENGTH                        02442004
024430              PERFORM 9999-WRITE-TO-CSSL                          02443004
024440                                                                  02444004
024450             STRING 'ERR FILE# SQL='                              02445004
024460                        DELIMITED BY SIZE                         02446004
024470                        PV-SQL-RETURN-CD                          02447004
024480                        DELIMITED BY SIZE                         02448004
024490                               INTO PC126-CRA-RET-MSG             02449004
024500             MOVE '02'                TO PC126-CRA-RET-CDE        02450004
024600             MOVE '1300-'             TO PC126-CRA-REQ-ID         02460004
024610             PERFORM 9000-RETURN-CALL                             02461004
024620                                                                  02462004
024630     END-EVALUATE.                                                02463004
024640                                                                  02464004
024650*----------------------------------------------------------------*02465004
024660*                                                                *02466004
024670*----------------------------------------------------------------*02467004
024671*CLP 06/19/2015 START                                             02467117
024680 1400-CHECK-BRAND.                                                02468017
024690                                                                  02469004
024700     MOVE PC126-SKU          TO XLT00003-SKU-NBR.                 02470024
024710                                                                  02471004
024720     EXEC SQL                                                     02472004
024730        SELECT  BRND_DESC                                         02473017
024740         INTO   :XLT00043-BRND-DESC                               02474017
024750          FROM  XLT_SKU      A                                    02475022
024751             ,  XLT_VND_STYL B                                    02475122
024760             ,  XLT_BRND     C                                    02476022
024770         WHERE  SKU_NBR           =  :XLT00003-SKU-NBR            02477022
024771           AND  A.STYL_ID         =  B.STYL_ID                    02477122
024780           AND  B.BRND_ID         =  C.BRND_ID                    02478022
024790           AND  C.BRND_ID         >  0                            02479042
024820     END-EXEC.                                                    02482004
024830                                                                  02483004
024840     EVALUATE TRUE                                                02484004
024850         WHEN SQLCODE = ZERO                                      02485004
024860              SET PS-BRAND-FOUND-YES TO TRUE                      02486017
024870         WHEN SQLCODE = +100                                      02487004
024880              SET PS-BRAND-FOUND-NO TO TRUE                       02488017
024890         WHEN OTHER                                               02489004
024900              INITIALIZE  PV-CICS-MSG-AREA                        02490004
025000              MOVE SQLCODE       TO PV-SQL-RETURN-CD              02500004
025001              STRING ' PCKCS191 - '             DELIMITED BY SIZE 02500104
025002                     '1400-CHECK-BRAND        ' DELIMITED BY SIZE 02500217
025003                     '  SQL - '                 DELIMITED BY SIZE 02500304
025004                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02500404
025005                     ' TABLE- '                 DELIMITED BY SIZE 02500504
025006                    'XLT_BRND        '          DELIMITED BY SIZE 02500625
025007                                           INTO PV-CICS-MSG-AREA  02500704
025008              MOVE LENGTH OF PV-CICS-MSG-AREA                     02500804
025009                     TO PV-COMMAREA-LENGTH                        02500904
025010              PERFORM 9999-WRITE-TO-CSSL                          02501004
025011              INITIALIZE  PV-CICS-MSG-AREA                        02501104
025012              STRING ' PCKCS191 -'             DELIMITED BY SIZE  02501204
025013                     ' PO:'                    DELIMITED BY SIZE  02501304
025014                     PC126-PO-NBR              DELIMITED BY SIZE  02501404
025015                     ' RCVR:'                  DELIMITED BY SIZE  02501504
025016                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02501604
025017                     ' SKU:'                   DELIMITED BY SIZE  02501704
025018                     PC126-SKU                 DELIMITED BY SIZE  02501804
025019                     ' STR:'                   DELIMITED BY SIZE  02501904
025020                     DK-STORE-NMBR             DELIMITED BY SIZE  02502004
025021                                           INTO PV-CICS-MSG-AREA  02502104
025022              MOVE LENGTH OF PV-CICS-MSG-AREA                     02502204
025023                     TO PV-COMMAREA-LENGTH                        02502304
025024              PERFORM 9999-WRITE-TO-CSSL                          02502404
025025                                                                  02502504
025026             STRING 'ERR FILE# SQL='                              02502604
025027                        DELIMITED BY SIZE                         02502704
025028                        PV-SQL-RETURN-CD                          02502804
025029                        DELIMITED BY SIZE                         02502904
025030                               INTO PC126-CRA-RET-MSG             02503004
025031             MOVE '02'                TO PC126-CRA-RET-CDE        02503104
025032             MOVE '1400-'             TO PC126-CRA-REQ-ID         02503204
025033             PERFORM 9000-RETURN-CALL                             02503304
025034     END-EVALUATE.                                                02503404
025035*CLP 06/19/2015 END                                               02503517
025036                                                                  02503604
025037 2000-PROC-HDR-LABELS.                                            02503704
025038                                                                  02503804
025039* DMH - 1/03/2005 - BEGIN                                         02503904
025040     IF   PS-DISPLAY-CSSL-YES                                     02504004
025041        INITIALIZE                       PV-CICS-MSG-AREA         02504104
025042        STRING ' PCKCS191- 2000-PROC-HDR-LABELS          '        02504204
025043                                         DELIMITED BY SIZE        02504304
025044                                    INTO PV-CICS-MSG-AREA         02504404
025045        MOVE LENGTH OF PV-CICS-MSG-AREA                           02504504
025046                                      TO PV-COMMAREA-LENGTH       02504604
025047        EXEC CICS                                                 02504704
025048            WRITEQ TD                                             02504804
025049                QUEUE   ('CSSL')                                  02504904
025050                FROM    (PV-CICS-MSG-AREA)                        02505004
025051                LENGTH  (PV-COMMAREA-LENGTH)                      02505104
025052                RESP    (PV-CICS-RESP)                            02505204
025053        END-EXEC                                                  02505304
025054     END-IF.                                                      02505404
025055* DMH - 1/03/2005 - BEGIN                                         02505504
025056                                                                  02505604
025057     IF PC126-FCSE-LBL-CNT = ZERO AND PC126-INPK-LBL-CNT = ZERO   02505704
025058         AND PC126-P2L-LBL-CNT > ZERO AND PC126-SUPRESS-P2L-HDRS  02505804
025059             MOVE PC126-P2L-LBL-CNT  TO PV-ORIG-P2L-CTN-CNT       02505904
025060     ELSE                                                         02506004
025061         SET PS-FCSE-NOT-PRINTED                                  02506104
025062             PS-INPK-NOT-PRINTED      TO TRUE                     02506204
025063                                                                  02506304
025064         PERFORM 2100-FORMAT-HDR-LABEL                            02506404
025065                                                                  02506504
025066         IF PC126-REPRINT                                         02506604
025067             CONTINUE                                             02506704
025068         ELSE                                                     02506804
025069             IF PC126-DC-BOUND-UNTS > ZERO OR                     02506904
025070                     PC126-RTV-BOUND-UNTS > ZERO OR               02507004
025071                     PC126-CS-BOUND-UNTS > ZERO                   02507104
025072                 PERFORM 2150-FORMAT-DCRTV-HDR-LBL                02507204
025073             END-IF                                               02507304
025074         END-IF                                                   02507404
025075     END-IF.                                                      02507504
025076                                                                  02507604
025077 2100-FORMAT-HDR-LABEL.                                           02507704
025078                                                                  02507804
025079* DMH - 1/03/2005 - BEGIN                                         02507904
025080     IF   PS-DISPLAY-CSSL-YES                                     02508004
025081        INITIALIZE                       PV-CICS-MSG-AREA         02508104
025082        STRING ' PCKCS191- 2100-FORMAT-HDR-LABEL         '        02508204
025083                                         DELIMITED BY SIZE        02508304
025084                                    INTO PV-CICS-MSG-AREA         02508404
025085        MOVE LENGTH OF PV-CICS-MSG-AREA                           02508504
025086                                      TO PV-COMMAREA-LENGTH       02508604
025087        EXEC CICS                                                 02508704
025088            WRITEQ TD                                             02508804
025089                QUEUE   ('CSSL')                                  02508904
025090                FROM    (PV-CICS-MSG-AREA)                        02509004
025091                LENGTH  (PV-COMMAREA-LENGTH)                      02509104
025092                RESP    (PV-CICS-RESP)                            02509204
025093        END-EXEC                                                  02509304
025094     END-IF.                                                      02509404
025095* DMH - 1/03/2005 - BEGIN                                         02509504
025096                                                                  02509604
025097*----------------------------------------------------------------*02509704
025098*  FORMATS AND TRANSLATES LABEL PRINT REQUEST INTO A DATA FORMAT *02509804
025099*  KNOWN TO THE REMOTE PRINTER.  THIS WILL BE USED TO CREATE THE *02509904
025100*  SML HEADER LABEL                                              *02510004
025101*----------------------------------------------------------------*02510104
025110                                                                  02511004
025120     MOVE  PC-0001                    TO PC144-SML-HDR-TOT-LBL    02512004
025130                                         PV-LBL-COPIES-NEEDED     02513004
025140                                                                  02514004
025150     MOVE PV-PO-RCVR-SEQ-NBR          TO PC144-SML-HDR-PO-SEQ-NBR 02515004
025160                                                                  02516004
025170**** BEGIN - PREPACK DESCRIPTIONS - LABEL PACKET HEADER           02517004
025180     IF  PC126-PRE-PACK-ORDER                                     02518004
025190         MOVE 'PACK ID:'              TO PC144-SML-HDR-LINE-DESC  02519004
025200         MOVE PC126-PREPK-ID          TO PC144-SML-HDR-LINE-NBR   02520004
025210     ELSE                                                         02521004
025211         MOVE 'LINE NO:'              TO PC144-SML-HDR-LINE-DESC  02521104
025212         MOVE PC126-PO-LNE-NBR        TO PC144-SML-HDR-LINE-NBR   02521204
025213     END-IF                                                       02521304
025214**** END   - PREPACK DESCRIPTIONS - LABEL PACKET HEADER           02521404
025215                                                                  02521504
025216     MOVE 'CS-PKT HDR'                TO PC144-HDR-LBL-DESC.      02521604
025217     MOVE PV-LBL-PRT-DATE             TO PC144-LBL-PRT-DATE.      02521704
025218     MOVE PV-LBL-PRT-TIME             TO PC144-LBL-PRT-TIME.      02521804
025219                                                                  02521904
025220     MOVE '#'                         TO PV-DSPLY-NBR-SIGN.       02522004
025221     MOVE PC126-DC-PRTD-AT            TO PV-DSPLY-DC.             02522104
025222     MOVE '-'                         TO PV-DSPLY-DASH.           02522204
025223     MOVE PC126-SHP-PRTR-ID           TO PV-DSPLY-PRTR-ID.        02522304
025224     MOVE PV-DSPLY-PRTR               TO PC144-HDR-PRTR-NBR.      02522404
025225                                                                  02522504
025226     MOVE PC126-USER-ID               TO PC144-USER-ID.           02522604
025227     MOVE PC126-DEPT-NBR              TO                          02522704
025228                                         PV-DCS-DEPT              02522804
025229                                         PC144-SML-HDR-DEPT       02522904
025230     MOVE PC126-CL-NBR                TO                          02523004
025240                                         PV-DCS-CLASS             02524004
025250                                         PC144-SML-HDR-CLASS      02525004
025260     MOVE PC126-SKU                   TO PV-DCS-SKU               02526004
025270     MOVE PV-DEPT-CLASS-SKU           TO PC144-SML-HDR-SKU        02527004
025280     MOVE PC126-VENDOR-STYLE          TO PC144-SML-HDR-VNDR-STYLE 02528004
025290     PERFORM 7300-GET-VENDOR-NAME                                 02529004
025300     MOVE ENTNME-ENT-NAME-DESC        TO PC144-SML-HDR-VENDOR-NAME02530004
025310                                                                  02531004
025320     EVALUATE TRUE                                                02532004
025330         WHEN PC126-REPRINT                                       02533004
025340             MOVE PC144-HDR-REPRT-BOX TO PC144-REPRINT-BOX        02534004
025350             MOVE PC144-HDR-REPRT-FLD TO PC144-REPRINT-FIELD      02535004
025360                                                                  02536004
025370             EVALUATE TRUE                                        02537004
025380             WHEN PC126-SHP-RPRT-ALL                              02538004
025390                 MOVE PC126-FCSE-LBL-CNT                          02539004
025400                                      TO PV-ORIG-FCSE-CTN-CNT     02540004
025410                 MOVE PC126-INPK-LBL-CNT                          02541004
025420                                      TO PV-ORIG-INPK-CTN-CNT     02542004
025430             WHEN PC126-SHP-RPRT-FCSE-ALL                         02543004
025440                 MOVE ZERO            TO PC126-INPK-LBL-CNT       02544004
025450                 MOVE PC126-FCSE-LBL-CNT                          02545004
025460                                      TO PV-ORIG-FCSE-CTN-CNT     02546004
025470             WHEN PC126-SHP-RPRT-FCSE                             02547004
025480                 MOVE PC126-FCSE-LBL-CNT                          02548004
025490                                      TO PV-ORIG-FCSE-CTN-CNT     02549004
025500                 SUBTRACT PC126-SHP-REPRT-FROM-CNT                02550004
025510                          FROM PC126-SHP-REPRT-TO-CNT             02551004
025520                          GIVING PC126-FCSE-LBL-CNT               02552004
025530                 ADD 1                TO PC126-FCSE-LBL-CNT       02553004
025540                 MOVE ZERO            TO PC126-INPK-LBL-CNT       02554004
025550             WHEN PC126-SHP-RPRT-INPK-ALL                         02555004
025560                 MOVE ZERO            TO PC126-FCSE-LBL-CNT       02556004
025570                 MOVE PC126-INPK-LBL-CNT                          02557004
025580                                      TO PV-ORIG-INPK-CTN-CNT     02558004
025590             WHEN PC126-SHP-RPRT-INPK                             02559004
025600                 MOVE PC126-INPK-LBL-CNT                          02560004
025610                                      TO PV-ORIG-INPK-CTN-CNT     02561004
025620                 SUBTRACT PC126-SHP-REPRT-FROM-CNT                02562004
025630                          FROM PC126-SHP-REPRT-TO-CNT             02563004
025640                          GIVING PC126-INPK-LBL-CNT               02564004
025650                 ADD 1                TO PC126-INPK-LBL-CNT       02565004
025660                 MOVE ZERO            TO PC126-FCSE-LBL-CNT       02566004
025670             END-EVALUATE                                         02567004
025680                                                                  02568004
025690* PACK-TO-LIGHT REPRINT LABEL COUNTS                              02569004
025700             MOVE PC126-P2L-LBL-CNT  TO PV-ORIG-P2L-CTN-CNT       02570004
025710                                                                  02571004
025720             IF PC126-P2L-REPRT-FROM-CNT > 0                      02572004
025730                IF PC126-P2L-REPRT-FROM-CNT <=                    02573004
025740                                  PC126-P2L-REPRT-TO-CNT          02574004
025750                    SUBTRACT PC126-P2L-REPRT-FROM-CNT FROM        02575004
025760                             PC126-P2L-REPRT-TO-CNT               02576004
025770                             GIVING PC126-P2L-LBL-CNT             02577004
025780                    ADD 1                TO PC126-P2L-LBL-CNT     02578004
025790                END-IF                                            02579004
025800             END-IF                                               02580004
025810                                                                  02581004
025820*   PC126-FCSE-LBL-CNT IS THE NBR OF LABELS THAT WILL PRINT.      02582004
025830*   FOR EXAMPLE, IF THE REQUEST RANGE WAS FROM 10 THRU 20,        02583004
025840*   LABEL NUMBER 10 WILL BE FIRST AND LABEL NUMBER 20 THE LAST.   02584004
025850*   THIS MAKES A TOTAL OF 11 LABELS IN ALL:                       02585004
025860*        20 - 10 + 1 = 11                                         02586004
025870*    THIS LOGIC IS SIMILAR TO THAT FOUND IN PARAGRAPH             02587004
025880*    3110-DETERMINE-START-POINT WHERE IT CONTROLS THE NUMBER OF   02588004
025890*    LABELS THAT WILL REPRINT.  IT IS USED HERE TO CHANGE THE     02589004
025900*    LABEL TOTAL ON THE HEADER LABEL.                             02590004
025910                                                                  02591004
025920         WHEN PC126-REVISED                                       02592004
025930             MOVE PC144-HDR-REPRT-BOX TO PC144-REPRINT-BOX        02593004
025940             MOVE PC144-HDR-REVSD-FLD TO PC144-REPRINT-FIELD      02594004
025950         WHEN OTHER                                               02595004
025960             MOVE PC144-HDR-NO-REPRINT TO PC144-REPRINT-FIELD     02596004
025970                                          PC144-REPRINT-BOX       02597004
025980     END-EVALUATE                                                 02598004
025990                                                                  02599004
026000     EVALUATE TRUE                                                02600004
026010     WHEN PC126-SHIP-LBL-SML                                      02601004
026020         IF PC126-ODD-CRTN-UNT-QTY > ZERO                         02602004
026030             MOVE PC144-HDR-ODD-CRTN-BOX                          02603004
026040                                      TO PC144-ODD-CARTON-BOX     02604004
026050             MOVE PC144-HDR-ODD-CRTN-FLD                          02605004
026060                                      TO PC144-SML-ODD-POSITION   02606004
026070             MOVE PC126-ODD-CRTN-UNT-QTY                          02607004
026080                                      TO PV-WORK-COUNT            02608004
026090             MOVE PV-WORK-COUNT       TO PC144-SML-ODD-CARTON-UNT 02609004
026100             EVALUATE TRUE                                        02610004
026110                 WHEN  PC126-ODD-CRTN-USE-FCSE                    02611004
026120                       MOVE PC-FCSE   TO PC144-SML-ODD-CARTON-USE 02612004
026130                 WHEN  PC126-ODD-CRTN-USE-INPK                    02613004
026140                       MOVE PC-INPK   TO PC144-SML-ODD-CARTON-USE 02614004
026150                 WHEN  PC126-ODD-CRTN-USE-P2L                     02615004
026160                       MOVE PC-P2L    TO PC144-SML-ODD-CARTON-USE 02616004
026170                 WHEN  PC126-ODD-CRTN-USE-NONE                    02617004
026180                       MOVE PC-NONE   TO PC144-SML-ODD-CARTON-USE 02618004
026190             END-EVALUATE                                         02619004
026200         ELSE                                                     02620004
026210             MOVE PC144-HDR-NO-ODD-CRTN                           02621004
026220                                      TO PC144-SML-ODD-POSITION   02622004
026230                                         PC144-ODD-CARTON-BOX     02623004
026240             MOVE SPACES              TO PC144-SML-ODD-CARTON-UNT 02624004
026250                                         PC144-SML-ODD-CARTON-USE 02625004
026260         END-IF                                                   02626004
026270                                                                  02627004
026280         IF PC126-FCSE-LBL-CNT > ZERO                             02628004
026290             MOVE PC144-HDR-FCSE-HEADING                          02629004
026300                                      TO PC144-SML-FCSE-POSITION  02630004
026310             MOVE PC126-FCSE-LBL-CNT  TO PV-WORK-COUNT            02631004
026320             MOVE PV-WORK-COUNT       TO PC144-SML-FCSE-LBL-CNT   02632004
026330         ELSE                                                     02633004
026340             MOVE PC144-HDR-NO-FCSE   TO PC144-SML-FCSE-POSITION  02634004
026350             MOVE SPACES              TO PC144-SML-FCSE-LBL-CNT   02635004
026360         END-IF                                                   02636004
026370                                                                  02637004
026380         IF PC126-INPK-LBL-CNT > ZERO                             02638004
026390             MOVE PC144-HDR-INPK-HEADING                          02639004
026400                                      TO PC144-SML-INPK-POSITION  02640004
026410             MOVE PC126-INPK-LBL-CNT  TO PV-WORK-COUNT            02641004
026420             MOVE PV-WORK-COUNT       TO PC144-SML-INPK-LBL-CNT   02642004
026430         ELSE                                                     02643004
026440             MOVE PC144-HDR-NO-INPK   TO PC144-SML-INPK-POSITION  02644004
026450             MOVE SPACES              TO PC144-SML-INPK-LBL-CNT   02645004
026460         END-IF                                                   02646004
026470                                                                  02647004
026810     END-EVALUATE                                                 02681004
026820                                                                  02682004
026830                                                                  02683004
026840* P2L LABEL COUNT                                                 02684004
026850     IF PC126-P2L-LBL-CNT > ZERO                                  02685004
026860         MOVE PC144-HDR-P2L-HEADING   TO PC144-P2L-POSITION       02686004
026870         MOVE PC126-P2L-LBL-CNT       TO PV-WORK-COUNT            02687004
026880         MOVE PV-WORK-COUNT           TO PC144-P2L-LBL-CNT        02688004
026890         IF PC126-ODD-CRTN-UNT-QTY > ZERO                         02689004
026900             MOVE PC144-HDR-ODD-CRTN-BOX                          02690004
026910                                      TO PC144-ODD-CARTON-BOX     02691004
026920             MOVE PC144-HDR-ODD-CRTN-FLD                          02692004
026930                                      TO PC144-SML-ODD-POSITION   02693004
026940             MOVE PC126-ODD-CRTN-UNT-QTY                          02694004
026950                                      TO PV-WORK-COUNT            02695004
026960             MOVE PV-WORK-COUNT       TO PC144-SML-ODD-CARTON-UNT 02696004
026970             EVALUATE TRUE                                        02697004
026980                 WHEN  PC126-ODD-CRTN-USE-FCSE                    02698004
026990                       MOVE PC-FCSE   TO PC144-SML-ODD-CARTON-USE 02699004
027000                 WHEN  PC126-ODD-CRTN-USE-INPK                    02700004
027010                       MOVE PC-INPK   TO PC144-SML-ODD-CARTON-USE 02701004
027020                 WHEN  PC126-ODD-CRTN-USE-P2L                     02702004
027030                       MOVE PC-P2L    TO PC144-SML-ODD-CARTON-USE 02703004
027040                 WHEN  PC126-ODD-CRTN-USE-NONE                    02704004
027050                       MOVE PC-NONE   TO PC144-SML-ODD-CARTON-USE 02705004
027060             END-EVALUATE                                         02706004
027070         ELSE                                                     02707004
027080             MOVE SPACES              TO PC144-SML-ODD-CARTON-UNT 02708004
027090                                         PC144-SML-ODD-CARTON-USE 02709004
027100         END-IF                                                   02710004
027110     ELSE                                                         02711004
027120         MOVE PC144-HDR-NO-P2L        TO PC144-P2L-POSITION       02712004
027130         MOVE SPACES                  TO PC144-P2L-LBL-CNT        02713004
027140         IF PC126-ODD-CRTN-UNT-QTY > ZERO                         02714004
027150             MOVE PC144-HDR-ODD-CRTN-BOX                          02715004
027160                                      TO PC144-ODD-CARTON-BOX     02716004
027170             MOVE PC144-HDR-ODD-CRTN-FLD                          02717004
027180                                      TO PC144-SML-ODD-POSITION   02718004
027190             MOVE PC126-ODD-CRTN-UNT-QTY                          02719004
027200                                      TO PV-WORK-COUNT            02720004
027210             MOVE PV-WORK-COUNT       TO PC144-SML-ODD-CARTON-UNT 02721004
027220             EVALUATE TRUE                                        02722004
027230                 WHEN  PC126-ODD-CRTN-USE-FCSE                    02723004
027240                       MOVE PC-FCSE   TO PC144-SML-ODD-CARTON-USE 02724004
027250                 WHEN  PC126-ODD-CRTN-USE-INPK                    02725004
027260                       MOVE PC-INPK   TO PC144-SML-ODD-CARTON-USE 02726004
027270                 WHEN  PC126-ODD-CRTN-USE-P2L                     02727004
027280                       MOVE PC-P2L    TO PC144-SML-ODD-CARTON-USE 02728004
027290                 WHEN  PC126-ODD-CRTN-USE-NONE                    02729004
027300                       MOVE PC-NONE   TO PC144-SML-ODD-CARTON-USE 02730004
027310             END-EVALUATE                                         02731004
027320         ELSE                                                     02732004
027330             MOVE PC144-HDR-NO-ODD-CRTN                           02733004
027340                                      TO PC144-SML-ODD-POSITION   02734004
027350                                         PC144-ODD-CARTON-BOX     02735004
027360             MOVE SPACES              TO PC144-SML-ODD-CARTON-UNT 02736004
027370                                         PC144-SML-ODD-CARTON-USE 02737004
027380         END-IF                                                   02738004
027390     END-IF.                                                      02739004
027400                                                                  02740004
027410     IF  PC126-SHP-XMIT-INTFC-CDE  =  PC-SOCKET-INTERFACE         02741004
027420         PERFORM 5410-SML-HDR-LABEL                               02742004
027430                 VARYING PC144-IDX FROM 1 BY 1                    02743004
027440                   UNTIL PC144-IDX > PC144-SML-HDR-LBL-MAX-LN     02744004
027450                      OR PS-SOCKET-ERROR                          02745004
027460     END-IF.                                                      02746004
027470                                                                  02747004
027480/                                                                 02748004
027490 2150-FORMAT-DCRTV-HDR-LBL.                                       02749004
027500                                                                  02750004
027510* DMH - 1/03/2005 - BEGIN                                         02751004
027520     IF   PS-DISPLAY-CSSL-YES                                     02752004
027530        INITIALIZE                       PV-CICS-MSG-AREA         02753004
027540        STRING ' PCKCS191- 2150-FORMAT-DCRTV-HDR-LBL     '        02754004
027550                                         DELIMITED BY SIZE        02755004
027560                                    INTO PV-CICS-MSG-AREA         02756004
027570        MOVE LENGTH OF PV-CICS-MSG-AREA                           02757004
027580                                      TO PV-COMMAREA-LENGTH       02758004
027590        EXEC CICS                                                 02759004
027600            WRITEQ TD                                             02760004
027610                QUEUE   ('CSSL')                                  02761004
027620                FROM    (PV-CICS-MSG-AREA)                        02762004
027630                LENGTH  (PV-COMMAREA-LENGTH)                      02763004
027640                RESP    (PV-CICS-RESP)                            02764004
027650        END-EXEC                                                  02765004
027660     END-IF.                                                      02766004
027670* DMH - 1/03/2005 - BEGIN                                         02767004
027680                                                                  02768004
027690     INITIALIZE PC145-HEADER-LABEL                                02769004
027700                                                                  02770004
027710      MOVE  PC126-PO-NBR          TO  PV-PO-NBR.                  02771004
027720      MOVE  PC126-RCVR-SEQ-NBR    TO  PV-RCVR-SEQ-NBR.            02772004
027730      MOVE  PV-PO-RCVR-SEQ-NBR    TO  PC145-SML-HDR-PO-SEQ-NBR.   02773004
027740                                                                  02774004
027750     IF PC126-DC-BOUND-UNTS > ZERO                                02775004
027760         MOVE 'DC LOCATION - '        TO  PC145-LOC-DESC-LNE1     02776004
027770         MOVE ' CARTONS, '            TO  PC145-LNE1-CTN-DESC     02777004
027780         MOVE ' UNITS'                TO  PC145-LNE1-UNT-DESC     02778004
027790         IF PC126-OTPK-UNT-QTY = 0                                02779004
027800            MOVE PC126-DC-BOUND-UNTS  TO PV-WORK-UNTS             02780004
027810            MOVE 0                    TO PV-WORK-COUNT            02781004
027820         ELSE                                                     02782004
027830            DIVIDE PC126-DC-BOUND-UNTS BY PC126-OTPK-UNT-QTY      02783004
027840                GIVING PV-RESULT REMAINDER PV-REMAINDER           02784004
027841            MOVE PV-RESULT            TO PV-WORK-COUNT            02784104
027842            MOVE PV-REMAINDER         TO PV-WORK-UNTS             02784204
027843         END-IF                                                   02784304
027844         MOVE PV-WORK-COUNT           TO PC145-LNE1-CTN-CNT       02784404
027845         MOVE PV-WORK-UNTS            TO PC145-LNE1-UNT-AMT       02784504
027846     END-IF                                                       02784604
027847                                                                  02784704
027848                                                                  02784804
027849     IF PC126-RTV-BOUND-UNTS > ZERO                               02784904
027850         MOVE 'RTV LOCATION - '       TO  PC145-LOC-DESC-LNE2     02785004
027851         MOVE ' CARTONS, '            TO  PC145-LNE2-CTN-DESC     02785104
027852         MOVE ' UNITS'                TO  PC145-LNE2-UNT-DESC     02785204
027853         IF PC126-OTPK-UNT-QTY = 0                                02785304
027854            MOVE PC126-RTV-BOUND-UNTS TO PV-WORK-UNTS             02785404
027855            MOVE 0                    TO PV-WORK-COUNT            02785504
027856         ELSE                                                     02785604
027857            DIVIDE PC126-RTV-BOUND-UNTS BY PC126-OTPK-UNT-QTY     02785704
027858                GIVING PV-RESULT REMAINDER PV-REMAINDER           02785804
027859            MOVE PV-RESULT            TO PV-WORK-COUNT            02785904
027860            MOVE PV-REMAINDER         TO PV-WORK-UNTS             02786004
027870         END-IF                                                   02787004
027880         MOVE PV-WORK-COUNT           TO PC145-LNE2-CTN-CNT       02788004
027890         MOVE PV-WORK-UNTS            TO PC145-LNE2-UNT-AMT       02789004
027900     END-IF                                                       02790004
027910                                                                  02791004
027920     IF PC126-CS-BOUND-UNTS > ZERO                                02792004
027930         MOVE 'CENTRAL STOCK LOCATION - '                         02793004
027940                                      TO  PC145-LOC-DESC-LNE3     02794004
027950         MOVE ' CARTONS, '            TO  PC145-LNE3-CTN-DESC     02795004
027960         MOVE ' UNITS'                TO  PC145-LNE3-UNT-DESC     02796004
027970         IF PC126-OTPK-UNT-QTY  = 0                               02797004
027980            MOVE PC126-CS-BOUND-UNTS  TO PV-WORK-UNTS             02798004
027990            MOVE 0                    TO PV-WORK-COUNT            02799004
028000         ELSE                                                     02800004
028010            DIVIDE PC126-CS-BOUND-UNTS BY PC126-OTPK-UNT-QTY      02801004
028020                GIVING PV-RESULT REMAINDER PV-REMAINDER           02802004
028030            MOVE PV-RESULT            TO PV-WORK-COUNT            02803004
028040            MOVE PV-REMAINDER         TO PV-WORK-UNTS             02804004
028050         END-IF                                                   02805004
028060         MOVE PV-WORK-COUNT           TO PC145-LNE3-CTN-CNT       02806004
028070         MOVE PV-WORK-UNTS            TO PC145-LNE3-UNT-AMT       02807004
028080     END-IF                                                       02808004
028090                                                                  02809004
028100      MOVE  PC-0001               TO  PC145-SML-HDR-TOT-LBL       02810004
028110                                      PV-LBL-COPIES-NEEDED.       02811004
028120                                                                  02812004
028130     IF  PC126-SHP-XMIT-INTFC-CDE  =  PC-SOCKET-INTERFACE         02813004
028140         PERFORM 5420-DC-RTV-CS-HDR-LABEL                         02814004
028150                 VARYING PC145-IDX FROM 1 BY 1                    02815004
028160                   UNTIL PC145-IDX > PC145-HDR-LBL-MAX-LN         02816004
028170                      OR PS-SOCKET-ERROR                          02817004
028180     END-IF.                                                      02818004
028190                                                                  02819004
028200/                                                                 02820004
028210 2160-FORMAT-DIVIDER-LBL.                                         02821004
028220                                                                  02822004
028230* DMH - 1/03/2005 - BEGIN                                         02823004
028240     IF   PS-DISPLAY-CSSL-YES                                     02824004
028250        INITIALIZE                       PV-CICS-MSG-AREA         02825004
028260        STRING ' PCKCS191- 2160-FORMAT-DIVIDER-LBL       '        02826004
028270                                         DELIMITED BY SIZE        02827004
028280                                    INTO PV-CICS-MSG-AREA         02828004
028290        MOVE LENGTH OF PV-CICS-MSG-AREA                           02829004
028300                                      TO PV-COMMAREA-LENGTH       02830004
028310        EXEC CICS                                                 02831004
028320            WRITEQ TD                                             02832004
028330                QUEUE   ('CSSL')                                  02833004
028340                FROM    (PV-CICS-MSG-AREA)                        02834004
028350                LENGTH  (PV-COMMAREA-LENGTH)                      02835004
028360                RESP    (PV-CICS-RESP)                            02836004
028370        END-EXEC                                                  02837004
028380     END-IF.                                                      02838004
028390* DMH - 1/03/2005 - BEGIN                                         02839004
028400                                                                  02840004
028410*----------------------------------------------------------------*02841004
028420*  FORMATS AND TRANSLATES LABEL PRINT REQUEST INTO A DATA FORMAT *02842004
028430*  KNOWN TO THE REMOTE PRINTER.  THIS WILL BE USED TO CREATE THE *02843004
028440*  SML HEADER LABEL                                              *02844004
028450*----------------------------------------------------------------*02845004
028460                                                                  02846004
028470                                                                  02847004
028480      MOVE  PC-0001               TO  PC146-SML-HDR-TOT-LBL       02848004
028490                                      PV-LBL-COPIES-NEEDED.       02849004
028500                                                                  02850004
028510     IF  PC126-SHP-XMIT-INTFC-CDE  =  PC-SOCKET-INTERFACE         02851004
028520         PERFORM 5430-DIVIDER-LABEL                               02852004
028530                 VARYING PC146-IDX FROM 1 BY 1                    02853004
028540                   UNTIL PC146-IDX > PC146-DIVIDER-LABEL-MAX-LN   02854004
028550                      OR PS-SOCKET-ERROR                          02855004
028551     END-IF.                                                      02855104
028552/                                                                 02855204
028553 2200-PROCESS-BAL-ON-HAND.                                        02855304
028554                                                                  02855404
028555     PERFORM 2300-CALL-STORE-ON-HAND-MOD.                         02855504
028556                                                                  02855604
028557                                                                  02855704
028558                                                                  02855804
028559                                                                  02855904
028560******************************************************************02856004
028561                                                                  02856104
028562 2300-CALL-STORE-ON-HAND-MOD.                                     02856204
028563                                                                  02856304
028564     INITIALIZE XL088-ITEM-COMMAREA.                              02856404
028565     SET  XL088-ONHAND-YES        TO TRUE                         02856504
028566     MOVE PC126-OPER-UNT-ID       TO XL088-OPER-UNT-ID            02856604
028567     MOVE PC-CURRENT-PROGRAM-NAME TO XL088-CALLING-PROGRAM        02856704
028568                                                                  02856804
028569     SET XL088-BY-OTBND-CRTN    TO TRUE                           02856904
028570*    MOVE SUT00024-DEST-LOC-NBR TO XL088-KEY-STR-NBR              02857004
028580     MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                           02858004
028590                                TO XL088-KEY-STR-NBR              02859004
028600     MOVE SUT00024-SHIPT-UNT-ID TO XL088-OTBND-CRTN               02860004
028610     MOVE PC126-PO-NBR          TO XL088-KEY-PO                   02861004
028620     MOVE PC126-RCVR-SEQ-NBR    TO XL088-KEY-REC-SEQ-NBR          02862004
028630                                                                  02863004
028640     CALL XL088-USER-PGM USING DFHEIBLK                           02864004
028650                               XL088-COMMAREA                     02865004
028660                               XL088-ITEM-COMMAREA.               02866004
028670                                                                  02867004
028680     EVALUATE TRUE                                                02868004
028690         WHEN XL088-SUCCESSFUL                                    02869004
028700             IF XL088-NO-PROCESS-MESSAGE                          02870004
028800                SET PT-STORE-ONHAND-NOT-ZERO (PT-DISTRO-IDX)      02880004
028900                                               TO TRUE            02890004
028910             ELSE                                                 02891004
028920                ADD +1           TO PT-STR-ONHAND-ZERO-COUNT      02892004
028930                                         (PT-DISTRO-IDX)          02893004
028940                SET PT-STORE-ONHAND-ZERO (PT-DISTRO-IDX)          02894004
028950                                               TO TRUE            02895004
028951                MOVE XL088-PROCESS-MESSAGE-TXT                    02895104
028952                         TO PT-PROCESS-MESSAGE (PT-DISTRO-IDX)    02895204
028953                IF XL088-FIRST-STORE-RCPT                         02895304
028954                   ADD  +1        TO PT-FIRST-STR-RCPT-COUNT      02895404
028955                                               (PT-DISTRO-IDX)    02895504
028956                   SET PT-FIRST-STORE-RCPT-YES (PT-DISTRO-IDX)    02895604
028957                                     TO TRUE                      02895704
028958                ELSE                                              02895804
028959                   SET PT-FIRST-STORE-RCPT-NO (PT-DISTRO-IDX)     02895904
028960                                     TO TRUE                      02896004
028961                END-IF                                            02896104
028962             END-IF                                               02896204
028963                                                                  02896304
028964         WHEN OTHER                                               02896404
028965            INITIALIZE  PV-CICS-MSG-AREA                          02896504
028966            MOVE XL088-RETURN-SQLCODE TO PV-SQL-RETURN-CD         02896604
028967            STRING ' PCKCS191 - '             DELIMITED BY SIZE   02896704
028968                   '2300-CALL-STORE-ON-HAND'  DELIMITED BY SIZE   02896804
028969                   '  SQL - '                 DELIMITED BY SIZE   02896904
028970                   PV-SQL-RETURN-CD           DELIMITED BY SIZE   02897004
028980                                         INTO PV-CICS-MSG-AREA    02898004
028981            MOVE LENGTH OF PV-CICS-MSG-AREA                       02898104
028982                   TO PV-COMMAREA-LENGTH                          02898204
028983            PERFORM 9999-WRITE-TO-CSSL                            02898304
028984            INITIALIZE  PV-CICS-MSG-AREA                          02898404
028985            STRING ' PCKCS191 -'             DELIMITED BY SIZE    02898504
028986                   ' PO:'                    DELIMITED BY SIZE    02898604
028987                   PC126-PO-NBR              DELIMITED BY SIZE    02898704
028988                   ' RCVR:'                  DELIMITED BY SIZE    02898804
028989                   PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE    02898904
028990                   ' LINE:'                  DELIMITED BY SIZE    02899004
029000                   PC126-PO-LNE-NBR          DELIMITED BY SIZE    02900004
029001                   ' STR:'                   DELIMITED BY SIZE    02900104
029002                   DK-STORE-NMBR             DELIMITED BY SIZE    02900204
029003                                         INTO PV-CICS-MSG-AREA    02900304
029004            MOVE LENGTH OF PV-CICS-MSG-AREA                       02900404
029005                   TO PV-COMMAREA-LENGTH                          02900504
029006            PERFORM 9999-WRITE-TO-CSSL                            02900604
029007                                                                  02900704
029008           STRING 'ERR FILE# SQL='                                02900804
029009                      DELIMITED BY SIZE                           02900904
029010                      PV-SQL-RETURN-CD                            02901004
029020                      DELIMITED BY SIZE                           02902004
029030                             INTO PC126-CRA-RET-MSG               02903004
029040           MOVE '45'                TO PC126-CRA-RET-CDE          02904004
029050           MOVE '2300-'             TO PC126-CRA-REQ-ID           02905004
029060           PERFORM 9000-RETURN-CALL                               02906004
029070                                                                  02907004
029071     END-EVALUATE.                                                02907104
029072                                                                  02907204
029073 2400-GET-CURRENT-DOOR.                                           02907304
029074                                                                  02907404
029075     EXEC SQL                                                     02907504
029076          SELECT A.DOOR_ID                                        02907604
029077          INTO   :CNDCDR-DOOR-ID                                  02907704
029078          FROM   TCNDCDR A                                        02907804
029079               , TCNDRST B                                        02907904
029080          WHERE  A.DOOR_ID         = B.DOOR_ID                    02908004
029081            AND  A.OPER_UNT_ID     = :DK-OPER-UNT-ID              02908104
029082            AND  A.OPER_UNT_ID     = B.OPER_UNT_ID                02908204
029083            AND  A.DOOR_TYP_CDE    = 'SH'                         02908304
029084            AND  B.STR_NBR         = :DISTDT-STR-NBR              02908404
029085            AND  B.END_TMST        = '9999-09-09-09.09.09.999999' 02908504
029086            AND  NOT   (DOOR_LOC_DESC  LIKE  '%UPS%'     OR       02908604
029087                        DOOR_LOC_DESC  LIKE  '%VIRTUAL%' OR       02908704
029088                        DOOR_LOC_DESC  LIKE  '%RE-OPEN%'          02908804
029089                       )                                          02908904
029090     END-EXEC.                                                    02909004
029091                                                                  02909104
029092     EVALUATE TRUE                                                02909204
029093         WHEN SQLCODE = ZERO                                      02909304
029094              CONTINUE                                            02909404
029095         WHEN SQLCODE = +100                                      02909504
029096         WHEN SQLCODE = -811                                      02909604
029097             MOVE SPACES TO CNDCDR-DOOR-ID                        02909704
029098         WHEN SQLCODE = -904                                      02909804
029099         WHEN SQLCODE = -911                                      02909904
029100         WHEN SQLCODE = -913                                      02910004
029101             MOVE SQLCODE             TO PV-SQL-RETURN-CD         02910104
029102             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     02910204
029103                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     02910304
029104                                      INTO PC126-CRA-RET-MSG      02910404
029105             MOVE '47'                TO PC126-CRA-RET-CDE        02910504
029106             PERFORM 9000-RETURN-CALL                             02910604
029107                                                                  02910704
029108         WHEN SQLWARN0 NOT = SPACES                               02910804
029109         WHEN SQLCODE < ZERO                                      02910904
029110         WHEN SQLCODE > ZERO                                      02911004
029111             MOVE SQLCODE             TO PV-SQL-RETURN-CD         02911104
029112             MOVE DISTDT-STR-NBR      TO PV-DISPLAY-STORE         02911204
029113              INITIALIZE PV-CICS-MSG-AREA                         02911304
029114              STRING ' PCKCS191 - '             DELIMITED BY SIZE 02911404
029115                     '2400-GET-CURRENT-DOOR   ' DELIMITED BY SIZE 02911504
029116                     '  SQL - '                 DELIMITED BY SIZE 02911604
029117                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02911704
029118                                           INTO PV-CICS-MSG-AREA  02911804
029119              MOVE LENGTH OF PV-CICS-MSG-AREA                     02911904
029120                     TO PV-COMMAREA-LENGTH                        02912004
029130              PERFORM 9999-WRITE-TO-CSSL                          02913004
029131              INITIALIZE PV-CICS-MSG-AREA                         02913104
029132              STRING ' PCKCS191 -'             DELIMITED BY SIZE  02913204
029133                     ' PO:'                    DELIMITED BY SIZE  02913304
029134                     PC126-PO-NBR              DELIMITED BY SIZE  02913404
029135                     ' RCVR:'                  DELIMITED BY SIZE  02913504
029136                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02913604
029137                     ' LINE:'                  DELIMITED BY SIZE  02913704
029138                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  02913804
029139                     ' STORE'                  DELIMITED BY SIZE  02913904
029140                     PV-DISPLAY-STORE          DELIMITED BY SIZE  02914004
029141                                           INTO PV-CICS-MSG-AREA  02914104
029142              MOVE LENGTH OF PV-CICS-MSG-AREA                     02914204
029143                     TO PV-COMMAREA-LENGTH                        02914304
029144              PERFORM 9999-WRITE-TO-CSSL                          02914404
029145                                                                  02914504
029146              STRING '2400-GET-CURRENT-DOOR '                     02914604
029147                     DELIMITED BY SIZE                            02914704
029148                     PV-SQL-RETURN-CD                             02914804
029149                     DELIMITED BY SIZE                            02914904
029150                            INTO PC126-CRA-RET-MSG                02915004
029151              MOVE '02'       TO PC126-CRA-RET-CDE                02915104
029152              MOVE '2400-'    TO PC126-CRA-REQ-ID                 02915204
029153             PERFORM 9000-RETURN-CALL                             02915304
029154     END-EVALUATE.                                                02915404
029155                                                                  02915504
029156 2500-CHECK-EAS-TAG.                                              02915604
029157     IF   PS-DISPLAY-CSSL-YES                                     02915704
029158        INITIALIZE                       PV-CICS-MSG-AREA         02915804
029159        STRING ' PCKCS191- 2500-CHECK-EAS-TAG           '         02915904
029160                                         DELIMITED BY SIZE        02916004
029161                                    INTO PV-CICS-MSG-AREA         02916104
029162        MOVE LENGTH OF PV-CICS-MSG-AREA                           02916204
029163                                      TO PV-COMMAREA-LENGTH       02916304
029164        EXEC CICS                                                 02916404
029165            WRITEQ TD                                             02916504
029166                QUEUE   ('CSSL')                                  02916604
029167                FROM    (PV-CICS-MSG-AREA)                        02916704
029168                LENGTH  (PV-COMMAREA-LENGTH)                      02916804
029169                RESP    (PV-CICS-RESP)                            02916904
029170        END-EXEC                                                  02917004
029171     END-IF.                                                      02917104
029172                                                                  02917204
029173      MOVE PURITM-UNT-RTL-PR-AMT TO SFT00000-BEG-PRPT-AMT.        02917304
029174                                                                  02917404
029175      EXEC SQL                                                    02917504
029176           SELECT DEPT_NBR                                        02917604
029177           INTO  :SFT00000-DEPT-NBR                               02917704
029178           FROM   SFT_EAS_TG_MDSE                                 02917804
029179           WHERE ( DEPT_NBR        = :XL001-DEPT-NBR              02917904
029180                 AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR            02918004
029181                 AND SUB_CL_NBR    = :XL001-SUB-CL-NBR )          02918104
029182             OR  ( DEPT_NBR        = :XL001-DEPT-NBR              02918204
029183                 AND MAJ_CL_NBR    = :XL001-MAJ-CL-NBR            02918304
029184                 AND SUB_CL_NBR IS NULL )                         02918404
029185             AND BEG_PRPT_AMT      <= :SFT00000-BEG-PRPT-AMT      02918504
029186      END-EXEC.                                                   02918604
029187                                                                  02918704
029188     EVALUATE TRUE                                                02918804
029189         WHEN SQLCODE = ZERO                                      02918904
029190              SET PC253-EAS-TAG-NEEDED TO TRUE                    02919004
029191         WHEN SQLCODE = +100                                      02919104
029192              SET PC253-EAS-TAG-NOT-NEEDED TO TRUE                02919204
029193         WHEN SQLCODE = -904                                      02919304
029194         WHEN SQLCODE = -911                                      02919404
029195         WHEN SQLCODE = -913                                      02919504
029196             MOVE SQLCODE             TO PV-SQL-RETURN-CD         02919604
029197             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     02919704
029198                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     02919804
029199                                      INTO PC126-CRA-RET-MSG      02919904
029200             MOVE '48'                TO PC126-CRA-RET-CDE        02920004
029201             PERFORM 9000-RETURN-CALL                             02920104
029202                                                                  02920204
029203         WHEN SQLWARN0 NOT = SPACES                               02920304
029204         WHEN SQLCODE < ZERO                                      02920404
029205         WHEN SQLCODE > ZERO                                      02920504
029206             MOVE SQLCODE             TO PV-SQL-RETURN-CD         02920604
029207             MOVE DISTDT-STR-NBR      TO PV-DISPLAY-STORE         02920704
029208              INITIALIZE PV-CICS-MSG-AREA                         02920804
029209              STRING ' PCKCS191 - '             DELIMITED BY SIZE 02920904
029210                     '2500-CHECK-EAS-TAG  '     DELIMITED BY SIZE 02921004
029211                     '  SQL - '                 DELIMITED BY SIZE 02921104
029212                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 02921204
029213                                           INTO PV-CICS-MSG-AREA  02921304
029214              MOVE LENGTH OF PV-CICS-MSG-AREA                     02921404
029215                     TO PV-COMMAREA-LENGTH                        02921504
029216              PERFORM 9999-WRITE-TO-CSSL                          02921604
029217              INITIALIZE PV-CICS-MSG-AREA                         02921704
029218              STRING ' PCKCS191 -'             DELIMITED BY SIZE  02921804
029219                     ' PO:'                    DELIMITED BY SIZE  02921904
029220                     PC126-PO-NBR              DELIMITED BY SIZE  02922004
029221                     ' RCVR:'                  DELIMITED BY SIZE  02922104
029222                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  02922204
029223                     ' LINE:'                  DELIMITED BY SIZE  02922304
029224                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  02922404
029225                     ' STORE'                  DELIMITED BY SIZE  02922504
029226                     PV-DISPLAY-STORE          DELIMITED BY SIZE  02922604
029227                                           INTO PV-CICS-MSG-AREA  02922704
029228              MOVE LENGTH OF PV-CICS-MSG-AREA                     02922804
029229                     TO PV-COMMAREA-LENGTH                        02922904
029230              PERFORM 9999-WRITE-TO-CSSL                          02923004
029231                                                                  02923104
029232              STRING '2500-CHECK-EAS-TAG    '                     02923204
029233                     DELIMITED BY SIZE                            02923304
029234                     PV-SQL-RETURN-CD                             02923404
029235                     DELIMITED BY SIZE                            02923504
029236                            INTO PC126-CRA-RET-MSG                02923604
029237              MOVE '02'       TO PC126-CRA-RET-CDE                02923704
029238              MOVE '2500-'    TO PC126-CRA-REQ-ID                 02923804
029239             PERFORM 9000-RETURN-CALL                             02923904
029240     END-EVALUATE.                                                02924004
029241                                                                  02924104
029242 3100-4BY4-LABELS.                                                02924204
029243                                                                  02924304
029244* DMH - 1/03/2005 - BEGIN                                         02924404
029245     IF   PS-DISPLAY-CSSL-YES                                     02924504
029246        INITIALIZE                       PV-CICS-MSG-AREA         02924604
029247        STRING ' PCKCS191- 3100-4BY4-LABELS              '        02924704
029248                                         DELIMITED BY SIZE        02924804
029249                                    INTO PV-CICS-MSG-AREA         02924904
029250        MOVE LENGTH OF PV-CICS-MSG-AREA                           02925004
029251                                      TO PV-COMMAREA-LENGTH       02925104
029252        EXEC CICS                                                 02925204
029253            WRITEQ TD                                             02925304
029254                QUEUE   ('CSSL')                                  02925404
029255                FROM    (PV-CICS-MSG-AREA)                        02925504
029256                LENGTH  (PV-COMMAREA-LENGTH)                      02925604
029257                RESP    (PV-CICS-RESP)                            02925704
029258        END-EXEC                                                  02925804
029259     END-IF.                                                      02925904
029260* DMH - 1/03/2005 - BEGIN                                         02926004
029261                                                                  02926104
029262                                                                  02926204
029263* EXTRA LOGIC IS NEEDED TO DETERMINE THE STARTING LABEL IF STORE  02926304
029264* SEQUENCE IS REQUIRED.  WE SEND ONLY ONE RECORD TO THE LABEL PC  02926404
029265* FOR EACH STORE.  WE SPECIFY HOW MANY COPIES TO PRINT OF EACH.   02926504
029266* SO IF THE STARTING LABEL NUMBER FALLS WITHIN THE RANGE OF ONE   02926604
029267* STORE'S NUMBER OF COPIES, WE HAVE TO DECREASE THE NUMBER OF     02926704
029268* COPIES NEED FOR THE REPRINT.  FOR EXAMPLE, WE HAVE 10 LABELS    02926804
029269* PRINTED IN THE ORIGINAL RUN:                                    02926904
029270*                                                                 02927004
029271*   STORE 250 HAS 4 LABELS                                        02927104
029272*   STORE 251 HAS 4 LABELS                                        02927204
029273*   STORE 252 HAS 2 LABELS                                        02927304
029274*                                                                 02927404
029275*    IF WE REQUEST A REPRINT OF LABELS 5 THRU 10, WE'RE OK        02927504
029276*    BECAUSE IT WOULD START PRINTING WITH STORE 251 EVENLY.  BUT  02927604
029277*    IF WE ASKED FOR LABELS 2 THRU 6, WE START ON THE 2ND LABEL   02927704
029278*    OF STORE 250 INSTEAD OF THE 1ST.  WE NEED TO REDUCE THE      02927804
029279*    COPIES OF STORE 250 TO 2 SO THAT 6 LABELS PRINT INSTEAD OF   02927904
029280*    8.                                                           02928004
029281*                                                                 02928104
029282*  A SHUFFLE SEQUENCE DOES NOT NEED THIS BECAUSE THE LABELS PRINT 02928204
029283*  ONE AT A TIME WITH COPIES=1.  IN THAT CASE WE CHECK THE LABEL  02928304
029284*  SEQUENCE NUMBERS JUST BEFORE PRINTING TIME TO SEE IF THEY FALL 02928404
029285*  INTO THE REQUESTED RANGE.                                      02928504
029286*                                                                 02928604
029287     IF PC126-REPRINT                                             02928704
029288         EVALUATE TRUE                                            02928804
029289             WHEN PC126-SHP-RPRT-FCSE                             02928904
029290             WHEN PC126-SHP-RPRT-INPK                             02929004
029291                 PERFORM 3110-DETERMINE-START-POINT               02929104
029292         END-EVALUATE                                             02929204
029293     END-IF.                                                      02929304
029294                                                                  02929404
029295* CALC TOTAL FCSE LABELS                                          02929504
029296     MOVE ZERO                        TO PV-DISTRO-SUM            02929604
029297     MOVE ZERO                        TO PV-DISTRO-FCSE-ODD       02929704
029298     PERFORM VARYING PT-DISTRO-IDX                                02929804
029299              FROM 1 BY 1 UNTIL PT-STR-NBR (PT-DISTRO-IDX) = ZERO 02929904
029300              OR PT-DISTRO-IDX > 1000                             02930004
029301              OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES        02930104
029302         ADD PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)                 02930204
029303                                      TO PV-DISTRO-SUM            02930304
029304     END-PERFORM                                                  02930404
029305                                                                  02930504
029306     PERFORM VARYING PT-DISTRO-IDX                                02930604
029307              FROM 1 BY 1 UNTIL PV-DISTRO-FCSE-ODD  > 0           02930704
029308              OR PT-STR-NBR (PT-DISTRO-IDX) = ZERO                02930804
029309              OR PT-DISTRO-IDX > 1000                             02930904
029310              OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES        02931004
029311              IF  PT-ODD-CART-FCSE (PT-DISTRO-IDX)                02931104
029312                  ADD 1               TO PV-DISTRO-FCSE-ODD       02931204
029313              END-IF                                              02931304
029314     END-PERFORM                                                  02931404
029315                                                                  02931504
029316* PRINT FCSE LABELS                                               02931604
029317     SET PS-FIRST-LABEL               TO TRUE                     02931704
029318                                                                  02931804
029319     IF PV-DISTRO-SUM > ZERO                                      02931904
029320         SET PS-PRINT-FCSE-LABELS     TO TRUE                     02932004
029321                                                                  02932104
029322         IF  PS-ODD-CART-FCSE-LBL-PRTD                            02932204
029323* 7/13 - BEGIN                                                    02932304
029324             IF  PC126-PRT-SHUFFLED                               02932404
029325* 7/13 - END                                                      02932504
029326                 IF PC126-REPRINT AND                             02932604
029327                    (PC126-SHP-REPRT-FROM-CNT > PC-0001 OR        02932704
029328                     PC126-SHP-REPRT-FROM-CNT = ZERO)             02932804
029329                     MOVE '+01'       TO PC253-AUTO-LBL-CNT       02932904
029330                                         PC158-AUTO-LBL-CNT       02933004
029331                 ELSE                                             02933104
029332                     MOVE '+01'       TO PC253-AUTO-LBL-CNT       02933204
029333                                         PC158-AUTO-LBL-CNT       02933304
029334                 END-IF                                           02933404
029335             ELSE                                                 02933504
029336                 MOVE '+01'           TO PC253-AUTO-LBL-CNT       02933604
029337                                         PC158-AUTO-LBL-CNT       02933704
029338             END-IF                                               02933804
029339         END-IF                                                   02933904
029340                                                                  02934004
029341                                                                  02934104
029342         PERFORM 8005-PRINT-FORM-LAYOUT                           02934204
029343         MOVE 1                       TO PC254-LABEL-NUMBER-N     02934304
029344                                         PC159-LABEL-NUMBER-N     02934404
029345                                                                  02934504
029346         IF  PC254-LABEL-NUMBER-N  = 1                            02934604
029347             IF  PS-ODD-CART-FCSE-LBL-PRTD                        02934704
029348                 ADD  1               TO PC254-LABEL-NUMBER-N     02934804
029349                                         PC159-LABEL-NUMBER-N     02934904
029350             END-IF                                               02935004
029360         END-IF                                                   02936004
029370                                                                  02937004
029380         MOVE ZERO                    TO PV-COUNT                 02938004
029390                                         PV-FCSE-COUNTER          02939004
029400         IF PC126-REPRINT                                         02940004
029410             EVALUATE TRUE                                        02941004
029420             WHEN PC126-SHP-RPRT-FCSE-ALL                         02942004
029430* DMH - 1/03/2005 - BEGIN                                         02943004
029440     IF   PS-DISPLAY-CSSL-YES                                     02944004
029450        INITIALIZE                       PV-CICS-MSG-AREA         02945004
029460        STRING ' PCKCS191- 3100-4BY4-LABELS - 1          '        02946004
029470                                         DELIMITED BY SIZE        02947004
029480                                    INTO PV-CICS-MSG-AREA         02948004
029490        MOVE LENGTH OF PV-CICS-MSG-AREA                           02949004
029500                                      TO PV-COMMAREA-LENGTH       02950004
029510        EXEC CICS                                                 02951004
029520            WRITEQ TD                                             02952004
029530                QUEUE   ('CSSL')                                  02953004
029540                FROM    (PV-CICS-MSG-AREA)                        02954004
029550                LENGTH  (PV-COMMAREA-LENGTH)                      02955004
029560                RESP    (PV-CICS-RESP)                            02956004
029570        END-EXEC                                                  02957004
029580     END-IF                                                       02958004
029590* DMH - 1/03/2005 - BEGIN                                         02959004
029600                 PERFORM 8000-FORMAT-AND-PRINT                    02960004
029610                    VARYING PT-DISTRO-IDX                         02961004
029620                    FROM 1                                        02962004
029630                    BY 1 UNTIL PV-DISTRO-SUM  <= ZERO             02963004
029640             WHEN PC126-SHP-RPRT-ALL                              02964004
029650* DMH - 1/03/2005 - BEGIN                                         02965004
029660     IF   PS-DISPLAY-CSSL-YES                                     02966004
029670        INITIALIZE                       PV-CICS-MSG-AREA         02967004
029671        STRING ' PCKCS191- 3100-4BY4-LABELS - 2          '        02967104
029672                                         DELIMITED BY SIZE        02967204
029673                                    INTO PV-CICS-MSG-AREA         02967304
029674        MOVE LENGTH OF PV-CICS-MSG-AREA                           02967404
029675                                      TO PV-COMMAREA-LENGTH       02967504
029676        EXEC CICS                                                 02967604
029677            WRITEQ TD                                             02967704
029678                QUEUE   ('CSSL')                                  02967804
029679                FROM    (PV-CICS-MSG-AREA)                        02967904
029680                LENGTH  (PV-COMMAREA-LENGTH)                      02968004
029681                RESP    (PV-CICS-RESP)                            02968104
029682        END-EXEC                                                  02968204
029683     END-IF                                                       02968304
029684* DMH - 1/03/2005 - BEGIN                                         02968404
029685                 PERFORM 8000-FORMAT-AND-PRINT                    02968504
029686                    VARYING PT-DISTRO-IDX                         02968604
029687                    FROM 1                                        02968704
029688                    BY 1 UNTIL PV-DISTRO-SUM  <= ZERO             02968804
029689             WHEN PC126-SHP-RPRT-FCSE                             02968904
029690                 MOVE PC126-SHP-REPRT-FROM-CNT                    02969004
029700                                      TO PC254-LABEL-NUMBER-N     02970004
029710                                         PC159-LABEL-NUMBER-N     02971004
029720                 SUBTRACT 1 FROM PC126-SHP-REPRT-FROM-CNT         02972004
029721                                      GIVING PV-FCSE-COUNTER      02972104
029722                 IF  PC254-LABEL-NUMBER-N  = 1  AND               02972204
029723                     PS-ODD-CART-FCSE-LBL-PRTD                    02972304
029724                     ADD  1           TO PC254-LABEL-NUMBER-N     02972404
029725                                         PC159-LABEL-NUMBER-N     02972504
029726                     SUBTRACT 1     FROM PV-DISTRO-SUM            02972604
029727                 END-IF                                           02972704
029728* DMH - 1/03/2005 - BEGIN                                         02972804
029729     IF   PS-DISPLAY-CSSL-YES                                     02972904
029730        INITIALIZE                       PV-CICS-MSG-AREA         02973004
029731        STRING ' PCKCS191- 3100-4BY4-LABELS - 3          '        02973104
029732                                         DELIMITED BY SIZE        02973204
029733                                    INTO PV-CICS-MSG-AREA         02973304
029734        MOVE LENGTH OF PV-CICS-MSG-AREA                           02973404
029735                                      TO PV-COMMAREA-LENGTH       02973504
029736        EXEC CICS                                                 02973604
029737            WRITEQ TD                                             02973704
029738                QUEUE   ('CSSL')                                  02973804
029739                FROM    (PV-CICS-MSG-AREA)                        02973904
029740                LENGTH  (PV-COMMAREA-LENGTH)                      02974004
029750                RESP    (PV-CICS-RESP)                            02975004
029760        END-EXEC                                                  02976004
029770     END-IF                                                       02977004
029780* DMH - 1/03/2005 - BEGIN                                         02978004
029790                 PERFORM 8000-FORMAT-AND-PRINT                    02979004
029800                    VARYING PT-DISTRO-IDX                         02980004
029810                    FROM 1                                        02981004
029820                    BY 1 UNTIL PV-DISTRO-SUM  <= ZERO             02982004
029830             END-EVALUATE                                         02983004
029840         ELSE                                                     02984004
029850* DMH - 1/03/2005 - BEGIN                                         02985004
029860     IF   PS-DISPLAY-CSSL-YES                                     02986004
029870          MOVE PV-DISTRO-SUM  TO  PV-DISTRO-SUM-DISPLAY           02987004
029880        INITIALIZE                       PV-CICS-MSG-AREA         02988004
029881        STRING ' PCKCS191- 3100-4BY4-LABELS - 4          '        02988104
029882                PV-DISTRO-SUM-DISPLAY                             02988204
029883                                         DELIMITED BY SIZE        02988304
029884                                    INTO PV-CICS-MSG-AREA         02988404
029885        MOVE LENGTH OF PV-CICS-MSG-AREA                           02988504
029886                                      TO PV-COMMAREA-LENGTH       02988604
029887        EXEC CICS                                                 02988704
029888            WRITEQ TD                                             02988804
029889                QUEUE   ('CSSL')                                  02988904
029890                FROM    (PV-CICS-MSG-AREA)                        02989004
029891                LENGTH  (PV-COMMAREA-LENGTH)                      02989104
029892                RESP    (PV-CICS-RESP)                            02989204
029893        END-EXEC                                                  02989304
029894     END-IF                                                       02989404
029895* DMH - 1/03/2005 - BEGIN                                         02989504
029896             PERFORM 8000-FORMAT-AND-PRINT                        02989604
029897                    VARYING PT-DISTRO-IDX                         02989704
029898                    FROM 1 BY 1                                   02989804
029899                    UNTIL PV-DISTRO-SUM  <= ZERO                  02989904
029900         END-IF                                                   02990004
029910                                                                  02991004
029920     END-IF.                                                      02992004
029930                                                                  02993004
029940***************************************************************   02994004
029941* PRINT INNER PACK LABELS                                         02994104
029942***************************************************************   02994204
029943* CALC TOTAL INPK LABELS                                          02994304
029944                                                                  02994404
029945* DMH 06/04/02 - BEG                                              02994504
029946     SET  PS-ADD-BACK-FOR-MFST-NO     TO TRUE                     02994604
029947* DMH 06/04/02 - END                                              02994704
029948                                                                  02994804
029949     MOVE ZERO                        TO PV-DISTRO-SUM            02994904
029950     PERFORM VARYING PT-DISTRO-IDX                                02995004
029951              FROM 1 BY 1 UNTIL PT-STR-NBR (PT-DISTRO-IDX) = ZERO 02995104
029952              OR PT-DISTRO-IDX > 1000                             02995204
029953              OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES        02995304
029954         ADD PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)                 02995404
029955                                      TO PV-DISTRO-SUM            02995504
029956     END-PERFORM                                                  02995604
029957                                                                  02995704
029958     SET PS-FIRST-LABEL               TO TRUE                     02995804
029959     IF PV-DISTRO-SUM > ZERO                                      02995904
029960         SET PS-INPK-WAS-PRINTED      TO TRUE                     02996004
029970         IF PS-FCSE-WAS-PRINTED AND                               02997004
029980            (PC126-SHP-RPRT-ALL OR PC126-INITIAL-PRINT OR         02998004
029990                 PC126-REVISED)                                   02999004
030000             PERFORM 2160-FORMAT-DIVIDER-LBL                      03000004
030010         END-IF                                                   03001004
030020                                                                  03002004
030030         SET  PC253-FORM-INPK-BOX     TO TRUE                     03003004
030040         MOVE PC158-FORM-INPK-BOX     TO PC158-INPK-CONVY-BOX     03004004
030050         SET  PC253-FORM-INPK-HDG     TO TRUE                     03005004
030060         MOVE PC158-FORM-INPK-HDG     TO PC158-INPK-CONVY-TEXT    03006004
030070         SET PS-PRINT-INPK-LABELS     TO TRUE                     03007004
030080                                                                  03008004
030090         IF PC126-REPRINT                                         03009004
030100             SET PS-FIRST-PASS        TO TRUE                     03010004
030110             EVALUATE TRUE                                        03011004
030120             WHEN PC126-SHP-RPRT-INPK-ALL                         03012004
030130             WHEN PC126-SHP-RPRT-ALL                              03013004
030140                 MOVE 1               TO PC254-LABEL-NUMBER-N     03014004
030150                                         PC159-LABEL-NUMBER-N     03015004
030160                 MOVE ZERO            TO PV-COUNT                 03016004
030170                                         PV-INPK-COUNTER          03017004
030180                 IF PC254-LABEL-NUMBER-N = 1 AND                  03018004
030190                     PS-ODD-CART-INPK-LBL-PRTD                    03019004
030200                     ADD PV-ODD-CRTN-INPK-LBLS-PRTD               03020004
030210                                      TO PC254-LABEL-NUMBER-N     03021004
030220                                         PC159-LABEL-NUMBER-N     03022004
030230                     MOVE '+01'                                   03023004
030240                       TO PC253-AUTO-LBL-CNT                      03024004
030250                          PC158-AUTO-LBL-CNT                      03025004
030260                 END-IF                                           03026004
030270                 PERFORM 8005-PRINT-FORM-LAYOUT                   03027004
030280* DMH - 1/03/2005 - BEGIN                                         03028004
030290     IF   PS-DISPLAY-CSSL-YES                                     03029004
030300        INITIALIZE                       PV-CICS-MSG-AREA         03030004
030310        STRING ' PCKCS191- 3100-4BY4-LABELS - 5          '        03031004
030320                                         DELIMITED BY SIZE        03032004
030330                                    INTO PV-CICS-MSG-AREA         03033004
030340        MOVE LENGTH OF PV-CICS-MSG-AREA                           03034004
030350                                      TO PV-COMMAREA-LENGTH       03035004
030360        EXEC CICS                                                 03036004
030370            WRITEQ TD                                             03037004
030380                QUEUE   ('CSSL')                                  03038004
030390                FROM    (PV-CICS-MSG-AREA)                        03039004
030400                LENGTH  (PV-COMMAREA-LENGTH)                      03040004
030410                RESP    (PV-CICS-RESP)                            03041004
030420        END-EXEC                                                  03042004
030430     END-IF                                                       03043004
030440* DMH - 1/03/2005 - BEGIN                                         03044004
030450                 PERFORM 8000-FORMAT-AND-PRINT                    03045004
030460                    VARYING PT-DISTRO-IDX FROM 1 BY 1             03046004
030470                         UNTIL PV-DISTRO-SUM  <= ZERO             03047004
030480                                                                  03048004
030490             WHEN PC126-SHP-RPRT-INPK                             03049004
030500                 MOVE PC126-SHP-REPRT-FROM-CNT                    03050004
030510                                      TO PC254-LABEL-NUMBER-N     03051004
030520                                         PC159-LABEL-NUMBER-N     03052004
030530                 SUBTRACT 1 FROM PC126-SHP-REPRT-FROM-CNT         03053004
030531                                      GIVING PV-INPK-COUNTER      03053104
030532                 IF PC254-LABEL-NUMBER-N = 1 AND                  03053204
030533                     PS-ODD-CART-INPK-LBL-PRTD                    03053304
030534                     ADD PV-ODD-CRTN-INPK-LBLS-PRTD               03053404
030535                                      TO PC254-LABEL-NUMBER-N     03053504
030536                                         PC159-LABEL-NUMBER-N     03053604
030537                     MOVE '+01'                                   03053704
030538                       TO PC253-AUTO-LBL-CNT                      03053804
030539                          PC158-AUTO-LBL-CNT                      03053904
030540                 ELSE                                             03054004
030541                 IF PC254-LABEL-NUMBER-N > 1 AND                  03054104
030542                     PS-ODD-CART-INPK-LBL-PRTD                    03054204
030543                     IF  PV-ODD-CRTN-INPK-LBLS-NOT-NEED > 0       03054304
030544                         ADD PV-ODD-CRTN-INPK-LBLS-NOT-NEED       03054404
030545                          TO PV-ODD-CRTN-INPK-LBLS-NEED           03054504
030546                     END-IF                                       03054604
030547                     IF (PC126-SHP-REPRT-FROM-CNT  <              03054704
030548                         PV-ODD-CRTN-INPK-LBLS-NEED   OR          03054804
030549                         PC126-SHP-REPRT-FROM-CNT  =              03054904
030550                         PV-ODD-CRTN-INPK-LBLS-NEED)              03055004
030560                     MOVE PV-ODD-CRTN-INPK-LBLS-NEED              03056004
030570                                      TO PC254-LABEL-NUMBER-N     03057004
030580                                         PC159-LABEL-NUMBER-N     03058004
030590                     ADD  1           TO PC254-LABEL-NUMBER-N     03059004
030600                                         PC159-LABEL-NUMBER-N     03060004
030610                     MOVE '+01'       TO PC253-AUTO-LBL-CNT       03061004
030620                                         PC158-AUTO-LBL-CNT       03062004
030630                     END-IF                                       03063004
030640                 END-IF                                           03064004
030650                 END-IF                                           03065004
030660                 PERFORM 8005-PRINT-FORM-LAYOUT                   03066004
030670* DMH - 1/03/2005 - BEGIN                                         03067004
030680     IF   PS-DISPLAY-CSSL-YES                                     03068004
030690        INITIALIZE                       PV-CICS-MSG-AREA         03069004
030700        STRING ' PCKCS191- 3100-4BY4-LABELS - 6          '        03070004
030710                                         DELIMITED BY SIZE        03071004
030720                                    INTO PV-CICS-MSG-AREA         03072004
030730        MOVE LENGTH OF PV-CICS-MSG-AREA                           03073004
030740                                      TO PV-COMMAREA-LENGTH       03074004
030750        EXEC CICS                                                 03075004
030760            WRITEQ TD                                             03076004
030770                QUEUE   ('CSSL')                                  03077004
030780                FROM    (PV-CICS-MSG-AREA)                        03078004
030790                LENGTH  (PV-COMMAREA-LENGTH)                      03079004
030800                RESP    (PV-CICS-RESP)                            03080004
030810        END-EXEC                                                  03081004
030820     END-IF                                                       03082004
030830* DMH - 1/03/2005 - BEGIN                                         03083004
030840                 PERFORM 8000-FORMAT-AND-PRINT                    03084004
030850                    VARYING PT-DISTRO-IDX FROM 1 BY 1             03085004
030860                         UNTIL PV-DISTRO-SUM  <= ZERO             03086004
030870             END-EVALUATE                                         03087004
030880         ELSE                                                     03088004
030890             MOVE 1                   TO PC254-LABEL-NUMBER-N     03089004
030900                                         PC159-LABEL-NUMBER-N     03090004
030910             IF  PC254-LABEL-NUMBER-N = 1 AND                     03091004
030920                 PS-ODD-CART-INPK-LBL-PRTD                        03092004
030930                 ADD PV-ODD-CRTN-INPK-LBLS-PRTD                   03093004
030931                                      TO PC254-LABEL-NUMBER-N     03093104
030932                                         PC159-LABEL-NUMBER-N     03093204
030933                 MOVE '+01'                                       03093304
030934                   TO  PC253-AUTO-LBL-CNT                         03093404
030935                       PC158-AUTO-LBL-CNT                         03093504
030936             END-IF                                               03093604
030937                                                                  03093704
030938             MOVE ZERO                TO PV-COUNT                 03093804
030939                                         PV-INPK-COUNTER          03093904
030940             PERFORM 8005-PRINT-FORM-LAYOUT                       03094004
030941* DMH - 1/03/2005 - BEGIN                                         03094104
030942     IF   PS-DISPLAY-CSSL-YES                                     03094204
030943        INITIALIZE                       PV-CICS-MSG-AREA         03094304
030944        STRING ' PCKCS191- 3100-4BY4-LABELS - 7          '        03094404
030945                                         DELIMITED BY SIZE        03094504
030946                                    INTO PV-CICS-MSG-AREA         03094604
030947        MOVE LENGTH OF PV-CICS-MSG-AREA                           03094704
030948                                      TO PV-COMMAREA-LENGTH       03094804
030949        EXEC CICS                                                 03094904
030950            WRITEQ TD                                             03095004
030960                QUEUE   ('CSSL')                                  03096004
030970                FROM    (PV-CICS-MSG-AREA)                        03097004
030980                LENGTH  (PV-COMMAREA-LENGTH)                      03098004
030990                RESP    (PV-CICS-RESP)                            03099004
031000        END-EXEC                                                  03100004
031010     END-IF                                                       03101004
031020* DMH - 1/03/2005 - BEGIN                                         03102004
031030             PERFORM 8000-FORMAT-AND-PRINT                        03103004
031040                 VARYING PT-DISTRO-IDX FROM 1 BY 1                03104004
031050                     UNTIL PV-DISTRO-SUM  <= ZERO                 03105004
031060         END-IF                                                   03106004
031070                                                                  03107004
031080     END-IF.                                                      03108004
031090/                                                                 03109004
031100 3110-DETERMINE-START-POINT.                                      03110004
031110                                                                  03111004
031120* DMH - 1/03/2005 - BEGIN                                         03112004
031130     IF   PS-DISPLAY-CSSL-YES                                     03113004
031131        INITIALIZE                       PV-CICS-MSG-AREA         03113104
031132        STRING ' PCKCS191- 3110-DETERMINE-START-POINT    '        03113204
031133                                         DELIMITED BY SIZE        03113304
031134                                    INTO PV-CICS-MSG-AREA         03113404
031135        MOVE LENGTH OF PV-CICS-MSG-AREA                           03113504
031136                                      TO PV-COMMAREA-LENGTH       03113604
031137        EXEC CICS                                                 03113704
031138            WRITEQ TD                                             03113804
031139                QUEUE   ('CSSL')                                  03113904
031140                FROM    (PV-CICS-MSG-AREA)                        03114004
031141                LENGTH  (PV-COMMAREA-LENGTH)                      03114104
031142                RESP    (PV-CICS-RESP)                            03114204
031143        END-EXEC                                                  03114304
031144     END-IF.                                                      03114404
031145* DMH - 1/03/2005 - BEGIN                                         03114504
031146                                                                  03114604
031147     EVALUATE TRUE                                                03114704
031148         WHEN PC126-PRT-SHUFFLED                                  03114804
031149             CONTINUE                                             03114904
031150         WHEN PC126-SHP-RPRT-FCSE                                 03115004
031160             PERFORM 3113-STORE-START-POINT                       03116004
031170         WHEN PC126-SHP-RPRT-INPK                                 03117004
031180             PERFORM 3114-STORE-START-POINT                       03118004
031190     END-EVALUATE.                                                03119004
031200                                                                  03120004
031210 3113-STORE-START-POINT.                                          03121004
031211                                                                  03121104
031212* DMH - 1/03/2005 - BEGIN                                         03121204
031213     IF   PS-DISPLAY-CSSL-YES                                     03121304
031214        INITIALIZE                       PV-CICS-MSG-AREA         03121404
031215        STRING ' PCKCS191- 3113-STORE-START-POINT        '        03121504
031216                                         DELIMITED BY SIZE        03121604
031217                                    INTO PV-CICS-MSG-AREA         03121704
031218        MOVE LENGTH OF PV-CICS-MSG-AREA                           03121804
031219                                      TO PV-COMMAREA-LENGTH       03121904
031220        EXEC CICS                                                 03122004
031221            WRITEQ TD                                             03122104
031222                QUEUE   ('CSSL')                                  03122204
031223                FROM    (PV-CICS-MSG-AREA)                        03122304
031224                LENGTH  (PV-COMMAREA-LENGTH)                      03122404
031225                RESP    (PV-CICS-RESP)                            03122504
031226        END-EXEC                                                  03122604
031227     END-IF.                                                      03122704
031228* DMH - 1/03/2005 - BEGIN                                         03122804
031229                                                                  03122904
031230     SET PS-START-POINT-NOT-FOUND     TO TRUE                     03123004
031240     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1 UNTIL              03124004
031250          PS-START-POINT-FOUND OR                                 03125004
031260          PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR               03126004
031270          PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR               03127004
031280                     PT-DISTRO-IDX > 1000                         03128004
031290                  OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES    03129004
031300                                                                  03130004
031310         ADD PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)                 03131004
031320                                      TO PV-COUNT                 03132004
031330         EVALUATE TRUE                                            03133004
031331             WHEN PV-COUNT            > PC126-SHP-REPRT-FROM-CNT  03133104
031332                     SUBTRACT PC126-SHP-REPRT-FROM-CNT            03133204
031333                     FROM PV-COUNT                                03133304
031334                     GIVING                                       03133404
031335                         PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)     03133504
031336                     ADD 1            TO                          03133604
031337                         PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)     03133704
031338                 IF PS-START-POINT-NOT-FOUND                      03133804
031339                     SET PS-START-POINT-FOUND                     03133904
031340                                      TO TRUE                     03134004
031341                     SET PT-START-IDX TO PT-DISTRO-IDX            03134104
031342                 END-IF                                           03134204
031343             WHEN PV-COUNT            < PC126-SHP-REPRT-FROM-CNT  03134304
031344                 MOVE ZERO            TO                          03134404
031345                         PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)     03134504
031346             WHEN PV-COUNT            = PC126-SHP-REPRT-FROM-CNT  03134604
031347                 MOVE 1               TO                          03134704
031348                         PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)     03134804
031349                 IF PS-START-POINT-NOT-FOUND                      03134904
031350                     SET PS-START-POINT-FOUND                     03135004
031360                                      TO TRUE                     03136004
031370                     SET PT-START-IDX TO PT-DISTRO-IDX            03137004
031380                 END-IF                                           03138004
031390         END-EVALUATE                                             03139004
031400                                                                  03140004
031410     END-PERFORM.                                                 03141004
031420                                                                  03142004
031430     SET PS-KEEP-STORE-QTYS           TO TRUE                     03143004
031440     MOVE ZERO                        TO PV-COUNT                 03144004
031450                                                                  03145004
031460     SUBTRACT PC126-SHP-REPRT-FROM-CNT                            03146004
031470                 FROM PC126-SHP-REPRT-TO-CNT                      03147004
031480     ADD 1                            TO PC126-SHP-REPRT-TO-CNT   03148004
031490*   PC126-SHP-REPRT-TO-CNT IS THE NBR OF LABELS THAT WILL PRINT.  03149004
031500*   FOR EXAMPLE, IF THE REQUEST RANGE WAS FROM 10 THRU 20,        03150004
031510*   LABEL NUMBER 10 WILL BE FIRST AND LABEL NUMBER 20 THE LAST.   03151004
031520*   THIS MAKES A TOTAL OF 11 LABELS IN ALL:                       03152004
031530*        20 - 10 + 1 = 11                                         03153004
031540                                                                  03154004
031550     PERFORM VARYING PT-DISTRO-IDX FROM PT-START-IDX              03155004
031560                   BY 1 UNTIL                                     03156004
031570                     PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR    03157004
031580                     PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR    03158004
031590                     PT-DISTRO-IDX > 1000                         03159004
031600                  OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES    03160004
031610                                                                  03161004
031620         ADD PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)                 03162004
031630                                      TO PV-COUNT                 03163004
031640         EVALUATE TRUE                                            03164004
031650             WHEN PS-ZERO-OUT-QTY                                 03165004
031660                 MOVE ZERO            TO                          03166004
031670                         PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)     03167004
031680             WHEN PV-COUNT < PC126-SHP-REPRT-TO-CNT               03168004
031690* 11/17          CONTINUE                                         03169004
031700                 SUBTRACT  PV-COUNT  FROM                         03170004
031710                           PC126-SHP-REPRT-TO-CNT                 03171004
031720                 MOVE  ZEROES  TO  PV-COUNT                       03172004
031730* 11/17                                                           03173004
031740             WHEN PV-COUNT = PC126-SHP-REPRT-TO-CNT               03174004
031750                 SET PS-ZERO-OUT-QTY  TO TRUE                     03175004
031760             WHEN PV-COUNT > PC126-SHP-REPRT-TO-CNT               03176004
031770* 11/17          COMPUTE PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX) =   03177004
031780* 11/17          PV-COUNT - PC126-SHP-REPRT-TO-CNT                03178004
031790                 MOVE PC126-SHP-REPRT-TO-CNT                      03179004
031800                   TO PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX)        03180004
031810                 SET PS-ZERO-OUT-QTY  TO TRUE                     03181004
031820         END-EVALUATE                                             03182004
031830                                                                  03183004
031840     END-PERFORM.                                                 03184004
031850                                                                  03185004
031860* RE-DO THE SEQ-QTYS BECAUSE THEY MIGHT HAVE CHANGED DURING THE   03186004
031870* POSITIONING PROCESS.                                            03187004
031880     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1 UNTIL              03188004
031890                     PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR    03189004
031900                     PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR    03190004
031910                     PT-DISTRO-IDX > 1000                         03191004
031920                  OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES    03192004
031930                                                                  03193004
031940             MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)           03194004
031950                                      TO PT-FCSE-LABEL-SEQ-QTY    03195004
031960                                             (PT-DISTRO-IDX)      03196004
031970             MOVE PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)           03197004
031980                                      TO PT-INPK-LABEL-SEQ-QTY    03198004
031990                                             (PT-DISTRO-IDX)      03199004
032000     END-PERFORM.                                                 03200004
032010/                                                                 03201004
032020 3114-STORE-START-POINT.                                          03202004
032030                                                                  03203004
032040* DMH - 1/03/2005 - BEGIN                                         03204004
032050     IF   PS-DISPLAY-CSSL-YES                                     03205004
032060        INITIALIZE                       PV-CICS-MSG-AREA         03206004
032070        STRING ' PCKCS191- 3114-STORE-START-POINT        '        03207004
032080                                         DELIMITED BY SIZE        03208004
032090                                    INTO PV-CICS-MSG-AREA         03209004
032100        MOVE LENGTH OF PV-CICS-MSG-AREA                           03210004
032110                                      TO PV-COMMAREA-LENGTH       03211004
032120        EXEC CICS                                                 03212004
032130            WRITEQ TD                                             03213004
032140                QUEUE   ('CSSL')                                  03214004
032150                FROM    (PV-CICS-MSG-AREA)                        03215004
032151                LENGTH  (PV-COMMAREA-LENGTH)                      03215104
032152                RESP    (PV-CICS-RESP)                            03215204
032153        END-EXEC                                                  03215304
032154     END-IF.                                                      03215404
032155* DMH - 1/03/2005 - BEGIN                                         03215504
032156                                                                  03215604
032157     SET PS-START-POINT-NOT-FOUND     TO TRUE                     03215704
032158     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1 UNTIL              03215804
032159          PS-START-POINT-FOUND OR                                 03215904
032160          PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR               03216004
032170          PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR               03217004
032180                     PT-DISTRO-IDX > 1000                         03218004
032190                 OR  PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES    03219004
032200                                                                  03220004
032210         ADD PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)                 03221004
032220                                      TO PV-COUNT                 03222004
032230                                                                  03223004
032240         IF  PC126-REPRINT                                        03224004
032250             IF PS-ODD-CART-INPK-LBL-PRTD AND                     03225004
032260                 PV-COUNT = 1                                     03226004
032261                 ADD PV-ODD-CRTN-INPK-LBLS-NEED                   03226104
032262                                          TO PV-COUNT             03226204
032263             END-IF                                               03226304
032264         END-IF                                                   03226404
032265                                                                  03226504
032266         EVALUATE TRUE                                            03226604
032267             WHEN PV-COUNT            > PC126-SHP-REPRT-FROM-CNT  03226704
032268                     SUBTRACT PC126-SHP-REPRT-FROM-CNT            03226804
032269                     FROM PV-COUNT                                03226904
032270                     GIVING                                       03227004
032271                         PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)     03227104
032272                     ADD 1            TO                          03227204
032273                         PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)     03227304
032274                 IF PS-START-POINT-NOT-FOUND                      03227404
032275                     SET PS-START-POINT-FOUND                     03227504
032276                                      TO TRUE                     03227604
032277                     SET PT-START-IDX TO PT-DISTRO-IDX            03227704
032278                 END-IF                                           03227804
032279             WHEN PV-COUNT            < PC126-SHP-REPRT-FROM-CNT  03227904
032280                 MOVE ZERO            TO                          03228004
032290                         PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)     03229004
032300             WHEN PV-COUNT            = PC126-SHP-REPRT-FROM-CNT  03230004
032310                 MOVE 1               TO                          03231004
032320                         PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)     03232004
032330                 IF PS-START-POINT-NOT-FOUND                      03233004
032340                     SET PS-START-POINT-FOUND                     03234004
032350                                      TO TRUE                     03235004
032360                     SET PT-START-IDX TO PT-DISTRO-IDX            03236004
032370                 END-IF                                           03237004
032380         END-EVALUATE                                             03238004
032390     END-PERFORM.                                                 03239004
032400                                                                  03240004
032410     SET PS-KEEP-STORE-QTYS           TO TRUE                     03241004
032420     MOVE ZERO                        TO PV-COUNT                 03242004
032430                                         PV-LABEL-COUNTER         03243004
032440                                                                  03244004
032450     SUBTRACT PC126-SHP-REPRT-FROM-CNT                            03245004
032460                 FROM PC126-SHP-REPRT-TO-CNT                      03246004
032470     ADD 1                            TO PC126-SHP-REPRT-TO-CNT   03247004
032480*   PC126-SHP-REPRT-TO-CNT IS THE NBR OF LABELS THAT WILL PRINT.  03248004
032490*   FOR EXAMPLE, IF THE REQUEST RANGE WAS FROM 10 THRU 20,        03249004
032500*   LABEL NUMBER 10 WILL BE FIRST AND LABEL NUMBER 20 THE LAST.   03250004
032510*   THIS MAKES A TOTAL OF 11 LABELS IN ALL:                       03251004
032520*        20 - 10 + 1 = 11                                         03252004
032530                                                                  03253004
032540     PERFORM VARYING PT-DISTRO-IDX FROM PT-START-IDX              03254004
032550                   BY 1 UNTIL                                     03255004
032560                     PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR    03256004
032570                     PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR    03257004
032580                     PT-DISTRO-IDX > 1000                         03258004
032590                 OR  PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES    03259004
032600                                                                  03260004
032610         ADD PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)                 03261004
032620                                      TO PV-COUNT                 03262004
032630         EVALUATE TRUE                                            03263004
032640             WHEN PS-ZERO-OUT-QTY                                 03264004
032650                 MOVE ZERO            TO                          03265004
032660                         PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)     03266004
032670             WHEN PV-COUNT < PC126-SHP-REPRT-TO-CNT               03267004
032680                 ADD 1                TO PV-LABEL-COUNTER         03268004
032690             WHEN PV-COUNT = PC126-SHP-REPRT-TO-CNT               03269004
032700                 SET PS-ZERO-OUT-QTY  TO TRUE                     03270004
032710             WHEN PV-COUNT > PC126-SHP-REPRT-TO-CNT               03271004
032720                 COMPUTE PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX) =   03272004
032730                 PV-COUNT - PC126-SHP-REPRT-TO-CNT                03273004
032740*                  - PV-LABEL-COUNTER                             03274004
032750                 SET PS-ZERO-OUT-QTY  TO TRUE                     03275004
032760         END-EVALUATE                                             03276004
032770                                                                  03277004
032780     END-PERFORM.                                                 03278004
032790                                                                  03279004
032800* RE-DO THE SEQ-QTYS BECAUSE THEY MIGHT HAVE CHANGED DURING THE   03280004
032810* POSITIONING PROCESS.                                            03281004
032820     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1 UNTIL              03282004
032830                     PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR    03283004
032840                     PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR    03284004
032850                     PT-DISTRO-IDX > 1000                         03285004
032860                 OR  PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES    03286004
032870                                                                  03287004
032880             MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)           03288004
032890                                      TO PT-FCSE-LABEL-SEQ-QTY    03289004
032900                                             (PT-DISTRO-IDX)      03290004
032910             MOVE PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)           03291004
032920                                      TO PT-INPK-LABEL-SEQ-QTY    03292004
032930                                             (PT-DISTRO-IDX)      03293004
032940     END-PERFORM.                                                 03294004
032950                                                                  03295043
032960                                                                  03296043
036330 3300-P2L-LABELS.                                                 03633004
036331                                                                  03633104
036332* DMH - 1/03/2005 - BEGIN                                         03633204
036333     IF   PS-DISPLAY-CSSL-YES                                     03633304
036334        INITIALIZE                       PV-CICS-MSG-AREA         03633404
036335        STRING ' PCKCS191- 3300-P2L-LABELS               '        03633504
036336                                         DELIMITED BY SIZE        03633604
036337                                    INTO PV-CICS-MSG-AREA         03633704
036338        MOVE LENGTH OF PV-CICS-MSG-AREA                           03633804
036339                                      TO PV-COMMAREA-LENGTH       03633904
036340        EXEC CICS                                                 03634004
036341            WRITEQ TD                                             03634104
036342                QUEUE   ('CSSL')                                  03634204
036343                FROM    (PV-CICS-MSG-AREA)                        03634304
036344                LENGTH  (PV-COMMAREA-LENGTH)                      03634404
036345                RESP    (PV-CICS-RESP)                            03634504
036346        END-EXEC                                                  03634604
036347     END-IF.                                                      03634704
036348* DMH - 1/03/2005 - BEGIN                                         03634804
036349                                                                  03634904
036350     PERFORM 7400-SELECT-P2L-MOD.                                 03635004
036360                                                                  03636004
036370     PERFORM 3320-FORMAT-P2L-LABEL.                               03637004
036380     PERFORM 3340-WRITE-P2L-LABEL.                                03638004
036390                                                                  03639004
036400                                                                  03640004
036410*----------------------------------------------------------------*03641004
036411* FORMAT P2L LABEL                                               *03641104
036412*----------------------------------------------------------------*03641204
036413 3320-FORMAT-P2L-LABEL.                                           03641304
036414                                                                  03641404
036415* DMH - 1/03/2005 - BEGIN                                         03641504
036416     IF   PS-DISPLAY-CSSL-YES                                     03641604
036417        INITIALIZE                       PV-CICS-MSG-AREA         03641704
036418        STRING ' PCKCS191- 3320-FORMAT-P2L-LABEL         '        03641804
036419                                         DELIMITED BY SIZE        03641904
036420                                    INTO PV-CICS-MSG-AREA         03642004
036421        MOVE LENGTH OF PV-CICS-MSG-AREA                           03642104
036422                                      TO PV-COMMAREA-LENGTH       03642204
036423        EXEC CICS                                                 03642304
036424            WRITEQ TD                                             03642404
036425                QUEUE   ('CSSL')                                  03642504
036426                FROM    (PV-CICS-MSG-AREA)                        03642604
036427                LENGTH  (PV-COMMAREA-LENGTH)                      03642704
036428                RESP    (PV-CICS-RESP)                            03642804
036429        END-EXEC                                                  03642904
036430     END-IF.                                                      03643004
036440* DMH - 1/03/2005 - BEGIN                                         03644004
036450* DMH - 6/06/2013 - BEGIN                                         03645004
036460     IF   PS-DISPLAY-CSSL-YES                                     03646004
036470         MOVE SPACE TO PV-CICS-MSG-AREA                           03647004
036480         STRING ' PCKCS191- 3320-FORMAT-P2L-LABEL         '       03648004
036490                                   DELIMITED BY SIZE              03649004
036500                ' IND: '                                          03650004
036510                SU093-RETURN-CODE                                 03651004
036520                ' RFID-IND: '                                     03652004
036521                SU093-RFID-IND                                    03652104
036522                ' DPTSTR '                                        03652204
036523                SU093-RFID-KOHL-DPT-IN-STR-SW                     03652304
036524                  ' ERROR-NBR  '                                  03652404
036525                  SU093-ERROR-NBR                                 03652504
036526                ' PS-RFID-ON-LABEL-sw:'                           03652604
036527                PS-RFID-ON-LABEL-SW       DELIMITED BY SIZE       03652704
036528                                      INTO PV-CICS-MSG-AREA       03652804
036529            MOVE LENGTH OF PV-CICS-MSG-AREA                       03652904
036530                   TO PV-COMMAREA-LENGTH                          03653004
036531            PERFORM 9999-WRITE-TO-CSSL                            03653104
036532     END-IF.                                                      03653204
036533* DMH - 6/06/2013 - end                                           03653304
036534                                                                  03653404
036535     MOVE 'CS DESTINATION LABEL'    TO PV-LABEL-NAME              03653504
036536     MOVE 'CS-DEST LBL'             TO PC149-DEST-LBL-DESC        03653604
036537                                                                  03653704
036538     MOVE PV-LBL-PRT-DATE           TO PC149-LBL-PRT-DATE         03653804
036539     MOVE PV-LBL-PRT-TIME           TO PC149-LBL-PRT-TIME         03653904
036540                                                                  03654004
036541     MOVE '#'                       TO PV-DSPLY-NBR-SIGN          03654104
036542     MOVE PC126-DC-PRTD-AT          TO PV-DSPLY-DC                03654204
036543     MOVE '-'                       TO PV-DSPLY-DASH              03654304
036544     MOVE PC126-SHP-PRTR-ID         TO PV-DSPLY-PRTR-ID           03654404
036545     MOVE PV-DSPLY-PRTR             TO PC149-DES-PRINTER-ID       03654504
036546                                                                  03654604
036547*                                                                 03654704
036548* DMH - 10-5-10 - BEGIN                                           03654804
036549*                                                                 03654904
036550     IF  PS-P2L-MOD-ON-LABEL                                      03655004
036551         MOVE P2LMOD-MODU-DESC      TO PC149-MODULE-NAME          03655104
036552     ELSE                                                         03655204
036553         MOVE P2LMOD-MODU-NBR       TO PV-MOD                     03655304
036554         MOVE '-'                   TO PV-DASH                    03655404
036555         MOVE PC126-TRIP-ARRIVE-MM  TO PV-ARRIVE-MM               03655504
036556         MOVE PC126-TRIP-ARRIVE-DD  TO PV-ARRIVE-DD               03655604
036557         MOVE PV-MOD-DATE           TO PC149-MODULE-NAME          03655704
036558     END-IF                                                       03655804
036559*                                                                 03655904
036560* DMH - 10-5-10 - END                                             03656004
036561*                                                                 03656104
036562     MOVE P2LMOD-DIVERT-CDE         TO PC149-BC-PROC-AREA-CODE    03656204
036563                                       PC149-PROC-AREA-CODE       03656304
036564     MOVE '-'                       TO PC149-DES-PO-DASH          03656404
036565     MOVE PC126-PO-NBR              TO PC149-BC-PO-NO             03656504
036566                                       PC149-PO-NO                03656604
036567                                       PC149-DES-PO               03656704
036568                                                                  03656804
036569     MOVE PC126-RCVR-SEQ-NBR        TO PC149-SEQ-NO               03656904
036570                                       PV-WORK-RCVR-NBR           03657004
036571     MOVE PV-WORK-REC-SEQ-NBR       TO PC149-BC-RECV-SEQ-NO       03657104
036572                                       PC149-RECV-SEQ-NO          03657204
036573                                                                  03657304
036574     MOVE PC126-PO-LNE-NBR          TO PC149-BC-PO-LINE-NO        03657404
036575                                       PC149-PO-LINE-NO           03657504
036576                                                                  03657604
036577     MOVE PC126-USER-ID             TO PC149-USER-ID.             03657704
036578                                                                  03657804
036579     MOVE PC126-DEPT-NBR             TO                           03657904
036580                                        PV-LBL-DEPT               03658004
036590                                                                  03659004
036600     MOVE PC126-CL-NBR               TO                           03660004
036610                                        PV-LBL-CLASS              03661004
036620                                                                  03662004
036630     MOVE PV-LBL-DEPT-CLASS          TO PC149-DEPT-CLASS          03663004
036640                                                                  03664004
036650                                                                  03665004
036660**** BEGIN - PREPACK DESCRIPTIONS - P2L DESTINATION LABEL         03666004
036670     IF  PC126-PRE-PACK-ORDER                                     03667004
036680         MOVE PC126-PREPK-ID            TO PV-EDIT-PREPK-NBR      03668004
036690         MOVE PV-EDIT-PREPK-ID          TO PC149-SKU              03669004
036700         MOVE 'TOT UNTS IN PACK:  '     TO PC149-DES-INPK-DESC    03670004
036710         MOVE PC126-TOT-PREPK-UNTS      TO PC149-DES-INPK-QTY     03671004
036720         MOVE 'DRIVR LINE RATIO:   '    TO PC149-LINE-NO-DESC     03672004
036730         MOVE PC126-PREPK-RATIO         TO PV-PACK-RATIO          03673004
036740         MOVE PV-PACK-RATIO-3           TO PC149-LINE-NO          03674004
036750         MOVE 'PACKS IN CARTON:   '     TO PC149-DES-UNT-PK-DESC  03675004
036760         IF  PC126-ODD-CRTN-USE-P2L  AND                          03676004
036770             PS-ODD-CART-LABEL                                    03677004
036780                 DIVIDE PC126-ODD-CRTN-UNT-QTY                    03678004
036790                     BY PC126-PREPK-RATIO                         03679004
036800                 GIVING PV-PC126-PACKS-IN-CRTN                    03680004
036810                 MOVE PV-PC126-PACKS-IN-CRTN                      03681004
036820                                        TO PC149-DES-UNT-PK-QTY   03682004
036830         ELSE                                                     03683004
036840             MOVE PC126-PACKS-IN-CRTN                             03684004
036850                                        TO PC149-DES-UNT-PK-QTY   03685004
036860         END-IF                                                   03686004
036870         MOVE 'DRIVR LNE SKU: '         TO PC149-DES-DWN-SK-DESC  03687004
036880         MOVE PC126-SKU                 TO PC149-DES-DWN-SK-QTY   03688004
036890         MOVE PC149-PK-DIVIDE-BOX       TO PC149-PACK-DIVIDE-BOX  03689004
036900         MOVE PC149-PK-DIVIDE-FLD       TO PC149-PACK-DIVIDE-FLD  03690004
036910     ELSE                                                         03691004
036920         MOVE PC126-SKU                 TO PC149-SKU              03692004
036930         MOVE 'INNER PK UNITS:    '     TO PC149-DES-INPK-DESC    03693004
036940         MOVE PC126-INPK-UNT-QTY        TO PC149-DES-INPK-QTY     03694004
036950         MOVE 'LINE NUMBER:        '    TO PC149-LINE-NO-DESC     03695004
036960         MOVE PC126-PO-LNE-NBR          TO PC149-LINE-NO          03696004
036970         MOVE '                   '     TO PC149-DES-UNT-PK-DESC  03697004
036980         MOVE '               '         TO PC149-DES-DWN-SK-DESC  03698004
036990         MOVE PC149-NO-PK-DIVIDE-BOX    TO PC149-PACK-DIVIDE-BOX  03699004
037000         MOVE PC149-NO-PK-DIVIDE-FLD    TO PC149-PACK-DIVIDE-FLD  03700004
037010     END-IF.                                                      03701004
037020****  END  - PREPACK DESCRIPTIONS - P2L DESTINATION LABEL         03702004
037030                                                                  03703004
037040     IF PC126-REPRINT                                             03704004
037050         IF PC126-P2L-RPRT-ALL                                    03705004
037060             MOVE '0001'            TO PC149-BC-START-CARTON-CNT  03706004
037070                                       PC149-START-CARTON-CNT     03707004
037080                                       PC149-LABEL-NBR            03708004
037090             MOVE '   1'            TO PC149-START-CARTON-CNT-1   03709004
037100             MOVE PC126-P2L-LBL-CNT TO PC149-BC-TOTAL-CARTON-CNT  03710004
037110                                       PC149-TOT-LABEL            03711004
037120             IF  PS-ODD-CART-LABEL                                03712004
037130                 MOVE PC-0001       TO PC149-BC-TOTAL-CARTON-CNT  03713004
037140             END-IF                                               03714004
037150                                                                  03715004
037160             IF  PC126-ODD-CRTN-USE-P2L  AND                      03716004
037170                 PS-NOT-ODD-CART-LABEL   AND                      03717004
037180                 PS-ODD-CART-P2L-LBL-PRTD                         03718004
037190                 SUBTRACT  1                                      03719004
037200                     FROM  PC126-P2L-LBL-CNT                      03720004
037210                   GIVING  PV-P2L-COUNT-LESS-ODD                  03721004
037220                   MOVE    PV-P2L-COUNT-LESS-ODD                  03722004
037230                     TO    PC149-BC-TOTAL-CARTON-CNT              03723004
037240                 MOVE '   2'        TO PC149-START-CARTON-CNT-1   03724004
037250                 MOVE '0002'        TO PC149-LABEL-NBR            03725004
037260                                       PV-DL-CARTON-NBR           03726004
037270                                       PC149-BC-START-CARTON-CNT  03727004
037280                                       PC149-START-CARTON-CNT     03728004
037290             END-IF                                               03729004
037300         ELSE                                                     03730004
037310             SUBTRACT PC126-P2L-REPRT-FROM-CNT FROM               03731004
037320                 PC126-P2L-REPRT-TO-CNT GIVING                    03732004
037330                 PV-P2L-COUNT                                     03733004
037340             ADD 1                  TO PV-P2L-COUNT               03734004
037350             MOVE PC126-P2L-REPRT-FROM-CNT                        03735004
037360                                    TO PC149-BC-START-CARTON-CNT  03736004
037370                                       PC149-START-CARTON-CNT     03737004
037380                                       PV-ZZZ9                    03738004
037390                                       PC149-LABEL-NBR            03739004
037400             MOVE PV-ZZZ9           TO PC149-START-CARTON-CNT-1   03740004
037410             MOVE PV-P2L-COUNT      TO PC149-BC-TOTAL-CARTON-CNT  03741004
037420             MOVE PV-ORIG-P2L-CTN-CNT                             03742004
037430                                    TO PC149-TOT-LABEL            03743004
037440                                                                  03744004
037450             IF  PS-ODD-CART-LABEL                                03745004
037460                 MOVE PC-0001       TO PC149-BC-TOTAL-CARTON-CNT  03746004
037470             END-IF                                               03747004
037480                                                                  03748004
037490             IF  PC126-ODD-CRTN-USE-P2L  AND                      03749004
037500                 PS-NOT-ODD-CART-LABEL   AND                      03750004
037510                 PS-ODD-CART-P2L-LBL-PRTD                         03751004
037520                 SUBTRACT  1                                      03752004
037530                     FROM  PC126-P2L-LBL-CNT                      03753004
037540                   GIVING  PV-P2L-COUNT-LESS-ODD                  03754004
037550                   MOVE    PV-P2L-COUNT-LESS-ODD                  03755004
037560                     TO    PC149-BC-TOTAL-CARTON-CNT              03756004
037570                 MOVE '   2'        TO PC149-START-CARTON-CNT-1   03757004
037580                 MOVE '0002'        TO PC149-LABEL-NBR            03758004
037590                                       PV-DL-CARTON-NBR           03759004
037600                                       PC149-BC-START-CARTON-CNT  03760004
037610                                       PC149-START-CARTON-CNT     03761004
037620             END-IF                                               03762004
037630     ELSE                                                         03763004
037640         MOVE '0001'                TO PC149-BC-START-CARTON-CNT  03764004
037650                                       PC149-START-CARTON-CNT     03765004
037660                                       PC149-LABEL-NBR            03766004
037670         MOVE '   1'                TO PC149-START-CARTON-CNT-1   03767004
037680         MOVE PC126-P2L-LBL-CNT     TO PC149-BC-TOTAL-CARTON-CNT  03768004
037690                                       PC149-TOT-LABEL            03769004
037700                                                                  03770004
037710         IF  PS-ODD-CART-LABEL                                    03771004
037720             MOVE PC-0001           TO PC149-BC-TOTAL-CARTON-CNT  03772004
037730         END-IF                                                   03773004
037740                                                                  03774004
037750         IF  PC126-ODD-CRTN-USE-P2L  AND                          03775004
037760             PS-NOT-ODD-CART-LABEL   AND                          03776004
037770             PS-ODD-CART-P2L-LBL-PRTD                             03777004
037780             SUBTRACT  1                                          03778004
037790                 FROM  PC126-P2L-LBL-CNT                          03779004
037800               GIVING  PV-P2L-COUNT-LESS-ODD                      03780004
037810               MOVE    PV-P2L-COUNT-LESS-ODD                      03781004
037820                 TO    PC149-BC-TOTAL-CARTON-CNT                  03782004
037830             MOVE '   2'            TO PC149-START-CARTON-CNT-1   03783004
037840             MOVE '0002'            TO PC149-LABEL-NBR            03784004
037850                                       PV-DL-CARTON-NBR           03785004
037860                                       PC149-BC-START-CARTON-CNT  03786004
037870                                       PC149-START-CARTON-CNT     03787004
037880         END-IF                                                   03788004
037890     END-IF.                                                      03789004
037900                                                                  03790004
037910* 05/10/99 - BEGIN                                                03791004
037920     IF  PC126-REPRINT                                            03792004
037930         CONTINUE                                                 03793004
037940     ELSE                                                         03794004
037950     IF  PC126-P2L-REPRT-FROM-CNT  >  0                           03795004
037960         SUBTRACT PC126-P2L-REPRT-FROM-CNT                        03796004
037970             FROM PC126-P2L-REPRT-TO-CNT                          03797004
037980           GIVING PV-P2L-COUNT                                    03798004
037990              ADD 1                  TO PV-P2L-COUNT              03799004
038000         MOVE PC126-P2L-REPRT-FROM-CNT                            03800004
038010                                     TO PC149-BC-START-CARTON-CNT 03801004
038020                                        PC149-START-CARTON-CNT    03802004
038030                                        PV-ZZZ9                   03803004
038040                                        PC149-LABEL-NBR           03804004
038050                                                                  03805004
038060         MOVE PV-ZZZ9                TO PC149-START-CARTON-CNT-1  03806004
038070         MOVE PV-P2L-COUNT           TO PC149-BC-TOTAL-CARTON-CNT 03807004
038080         MOVE PC126-P2L-LBL-CNT      TO PC149-TOT-LABEL           03808004
038090     END-IF                                                       03809004
038100     END-IF.                                                      03810004
038110* 05/10/99 - END                                                  03811004
038120*  gb 1/12/01                                                     03812004
038130                                                                  03813004
038140     MOVE PC126-PO-NBR               TO PURCHS-PO-NBR.            03814004
038150                                                                  03815004
038160     IF  PS-SEASET-DATA-FOUND                                     03816004
038170         MOVE DK-OPER-UNT-ID  TO PV-KEY-DEST-LOC                  03817004
038180         SET PS-P2L-LABEL-PROCESS TO TRUE                         03818004
038190         PERFORM 8305-CALL-SET-FIXT-ID-MOD                        03819004
038200         SET PS-NOT-P2L-LABEL-PROCESS TO TRUE                     03820004
038210         IF  PS-SEASET-DATA-FOUND                                 03821004
038220             IF  PV-CURRENT-DATE > PV-SEASET-RLSE-DT              03822004
038230                 MOVE PC126-STR-ZNE TO PC149-DES-ZONE             03823004
038240             ELSE                                                 03824004
038250                 MOVE PV-SEASET-SHRT-NM TO PC149-DES-ZONE         03825004
038260             END-IF                                               03826004
038270         ELSE                                                     03827004
038280             MOVE PC126-STR-ZNE TO PC149-DES-ZONE                 03828004
038290         END-IF                                                   03829004
038300     ELSE                                                         03830004
038310         MOVE PC126-STR-ZNE TO PC149-DES-ZONE                     03831004
038320     END-IF                                                       03832004
038330*                                                                 03833004
038340*    IF PS-NO-SEASET-DATA-FOUND                                   03834004
038350*       MOVE PC126-STR-ZNE TO PC149-DES-ZONE                      03835004
038360*    ELSE                                                         03836004
038370*       IF PC126-FCSE-LBL-CNT > ZERO OR PC126-INPK-LBL-CNT > ZERO 03837004
038380*          MOVE SEASET-SEASET-SHRT-NM TO PC149-DES-ZONE           03838004
038390*       ELSE                                                      03839004
038400*          MOVE DK-OPER-UNT-ID  TO PV-KEY-DEST-LOC                03840004
038410*          PERFORM 8305-CALL-SET-FIXT-ID-MOD                      03841004
038420*          IF PS-SEASET-DATA-FOUND                                03842004
038430*             MOVE SEASET-SEASET-SHRT-NM TO PC149-DES-ZONE        03843004
038440*          ELSE                                                   03844004
038441*             MOVE PC126-STR-ZNE TO PC149-DES-ZONE                03844104
038442*          END-IF                                                 03844204
038443*       END-IF                                                    03844304
038444*    END-IF                                                       03844404
038445                                                                  03844504
038446                                                                  03844604
038447     IF  PS-ODD-CART-LABEL                                        03844704
038448         MOVE PC149-ODD-CRTN-BOX    TO PC149-ODD-CARTON-BOX       03844804
038449         MOVE PC149-ODD-CRTN-FLD    TO PC149-ODD-FIELD            03844904
038450     ELSE                                                         03845004
038460         MOVE PC149-FORM-NO-ODD-BOX TO PC149-ODD-CARTON-BOX       03846004
038470         MOVE PC149-FORM-NO-ODD-FLD TO PC149-ODD-FIELD            03847004
038480     END-IF.                                                      03848004
038490                                                                  03849004
038500     IF   PS-DISPLAY-CSSL-YES                                     03850004
038510         STRING ' PCKCS191- 3320- BEFORE RFID BOX'                03851004
038520                                   DELIMITED BY SIZE              03852004
038530                ' RFID-IND='                                      03853004
038540                SU093-RFID-IND                                    03854004
038541                ' PS-RFID-ON-LABEL-sw:'                           03854104
038542                PS-RFID-ON-LABEL-SW       DELIMITED BY SIZE       03854204
038543                                         INTO PV-CICS-MSG-AREA    03854304
038544         MOVE LENGTH OF PV-CICS-MSG-AREA                          03854404
038545                   TO PV-COMMAREA-LENGTH                          03854504
038546         PERFORM 9999-WRITE-TO-CSSL                               03854604
038547     end-if.                                                      03854704
038548                                                                  03854804
038549     IF PS-RFID-ON-LABEL-YES                                      03854904
038550         MOVE PC149-RFID-BOX    TO PC149-LBL-RFID-BOX             03855004
038560         MOVE PC149-RFID-FLD    TO PC149-LBL-RFID-FLD             03856004
038561         MOVE 'T'               TO PC149-CASI                     03856104
038562     ELSE                                                         03856204
038563         MOVE PC149-NO-RFID-BOX TO PC149-LBL-RFID-BOX             03856304
038564         MOVE PC149-NO-RFID-FLD TO PC149-LBL-RFID-FLD             03856404
038565         MOVE SPACE             TO PC149-CASI                     03856504
038566     END-IF.                                                      03856604
038567                                                                  03856704
038568*----------------------------------------------------------------*03856804
038569* WRITE P2L LABEL                                                *03856904
038570*----------------------------------------------------------------*03857004
038571 3340-WRITE-P2L-LABEL.                                            03857104
038572                                                                  03857204
038573* DMH - 1/03/2005 - BEGIN                                         03857304
038574     IF   PS-DISPLAY-CSSL-YES                                     03857404
038575        INITIALIZE                       PV-CICS-MSG-AREA         03857504
038576        STRING ' PCKCS191- 3340-WRITE-P2L-LABEL          '        03857604
038577                                         DELIMITED BY SIZE        03857704
038578                                    INTO PV-CICS-MSG-AREA         03857804
038579        MOVE LENGTH OF PV-CICS-MSG-AREA                           03857904
038580                                      TO PV-COMMAREA-LENGTH       03858004
038590        EXEC CICS                                                 03859004
038600            WRITEQ TD                                             03860004
038610                QUEUE   ('CSSL')                                  03861004
038620                FROM    (PV-CICS-MSG-AREA)                        03862004
038630                LENGTH  (PV-COMMAREA-LENGTH)                      03863004
038640                RESP    (PV-CICS-RESP)                            03864004
038650        END-EXEC                                                  03865004
038660     END-IF.                                                      03866004
038670* DMH - 1/03/2005 - BEGIN                                         03867004
038680                                                                  03868004
038690     IF  PC126-SHP-XMIT-INTFC-CDE  =  PC-SOCKET-INTERFACE         03869004
038700         PERFORM 5470-DESTINATION-LABEL                           03870004
038710                 VARYING PC149-IDX FROM 1 BY 1                    03871004
038720                   UNTIL PC149-IDX > PC149-P2L-DEST-LBL-MAX-LN    03872004
038730                      OR PS-SOCKET-ERROR                          03873004
038740     END-IF.                                                      03874004
038750                                                                  03875004
038760                                                                  03876004
038770                                                                  03877004
038780*----------------------------------------------------------------*03878004
038790*  DETERMINE LABEL FOR ODD-CARTON.                               *03879004
038800*----------------------------------------------------------------*03880004
038810 3400-ODD-CARTON-LABEL.                                           03881004
038820                                                                  03882004
038830* DMH - 1/03/2005 - BEGIN                                         03883004
038840     IF   PS-DISPLAY-CSSL-YES                                     03884004
038850        INITIALIZE                       PV-CICS-MSG-AREA         03885004
038860        STRING ' PCKCS191- 3400-ODD-CARTON-LABEL         '        03886004
038870                                         DELIMITED BY SIZE        03887004
038880                                    INTO PV-CICS-MSG-AREA         03888004
038881        MOVE LENGTH OF PV-CICS-MSG-AREA                           03888104
038882                                      TO PV-COMMAREA-LENGTH       03888204
038883        EXEC CICS                                                 03888304
038884            WRITEQ TD                                             03888404
038885                QUEUE   ('CSSL')                                  03888504
038886                FROM    (PV-CICS-MSG-AREA)                        03888604
038887                LENGTH  (PV-COMMAREA-LENGTH)                      03888704
038888                RESP    (PV-CICS-RESP)                            03888804
038889        END-EXEC                                                  03888904
038890     END-IF.                                                      03889004
038891* DMH - 1/03/2005 - BEGIN                                         03889104
038892                                                                  03889204
038893     EVALUATE TRUE                                                03889304
038894         WHEN PC126-ODD-CRTN-USE-FCSE                             03889404
038895              PERFORM 3420-ODD-CARTON-FCSE                        03889504
038896         WHEN PC126-ODD-CRTN-USE-INPK                             03889604
038897              PERFORM 3440-ODD-CARTON-INPK                        03889704
038898         WHEN PC126-ODD-CRTN-USE-P2L                              03889804
038899              PERFORM 3460-ODD-CARTON-P2L                         03889904
038900     END-EVALUATE.                                                03890004
038910                                                                  03891004
038920                                                                  03892004
038930*----------------------------------------------------------------*03893004
038940*  CREATE LABEL FOR ODD-CARTON - FOR FULL-CASE (FCSE)            *03894004
038950*----------------------------------------------------------------*03895004
038960 3420-ODD-CARTON-FCSE.                                            03896004
038970                                                                  03897004
038980* DMH - 1/03/2005 - BEGIN                                         03898004
038990     IF   PS-DISPLAY-CSSL-YES                                     03899004
039000        INITIALIZE                       PV-CICS-MSG-AREA         03900004
039010        STRING ' PCKCS191- 3420-ODD-CARTON-FCSE          '        03901004
039020                                         DELIMITED BY SIZE        03902004
039021                                    INTO PV-CICS-MSG-AREA         03902104
039022        MOVE LENGTH OF PV-CICS-MSG-AREA                           03902204
039023                                      TO PV-COMMAREA-LENGTH       03902304
039024        EXEC CICS                                                 03902404
039025            WRITEQ TD                                             03902504
039026                QUEUE   ('CSSL')                                  03902604
039027                FROM    (PV-CICS-MSG-AREA)                        03902704
039028                LENGTH  (PV-COMMAREA-LENGTH)                      03902804
039029                RESP    (PV-CICS-RESP)                            03902904
039030        END-EXEC                                                  03903004
039031     END-IF.                                                      03903104
039032* DMH - 1/03/2005 - BEGIN                                         03903204
039033                                                                  03903304
039034* PRINT ODD-CARTON-FCSE LABEL                                     03903404
039035                                                                  03903504
039036     SET PS-FIRST-LABEL               TO TRUE.                    03903604
039037                                                                  03903704
039038     SET PS-PRINT-FCSE-LABELS         TO TRUE.                    03903804
039039                                                                  03903904
039040     PERFORM 8005-PRINT-FORM-LAYOUT.                              03904004
039050     MOVE 1                           TO PC254-LABEL-NUMBER-N     03905004
039060                                         PC159-LABEL-NUMBER-N.    03906004
039070     MOVE ZERO                        TO PV-COUNT                 03907004
039080                                         PV-FCSE-COUNTER.         03908004
039090                                                                  03909004
039100     SET  PS-ODD-CART-FCSE-LBL-NOT-PRT  TO  TRUE                  03910004
039110     SET  PS-NOT-ODD-CART-LABEL         TO  TRUE                  03911004
039120                                                                  03912004
039130     PERFORM VARYING PT-DISTRO-IDX                                03913004
039140                FROM 1 BY 1                                       03914004
039150               UNTIL PS-ODD-CART-FCSE-LBL-PRTD                    03915004
039160                  OR PT-DISTRO-IDX > 1000                         03916004
039170                  OR PT-DISTRO-IDX  > PV-PT-LABEL-TABLE-ENTRIES   03917004
039171                     IF  PT-ODD-CART-FCSE (PT-DISTRO-IDX)         03917104
039172                         SET  PS-ODD-CART-LABEL       TO TRUE     03917204
039173* DMH - 1/03/2005 - BEGIN                                         03917304
039174     IF   PS-DISPLAY-CSSL-YES                                     03917404
039175        INITIALIZE                       PV-CICS-MSG-AREA         03917504
039176        STRING ' PCKCS191- 3100-4BY4-LABELS - 10         '        03917604
039177                                         DELIMITED BY SIZE        03917704
039178                                    INTO PV-CICS-MSG-AREA         03917804
039179        MOVE LENGTH OF PV-CICS-MSG-AREA                           03917904
039180                                      TO PV-COMMAREA-LENGTH       03918004
039181        EXEC CICS                                                 03918104
039182            WRITEQ TD                                             03918204
039183                QUEUE   ('CSSL')                                  03918304
039184                FROM    (PV-CICS-MSG-AREA)                        03918404
039185                LENGTH  (PV-COMMAREA-LENGTH)                      03918504
039186                RESP    (PV-CICS-RESP)                            03918604
039187        END-EXEC                                                  03918704
039188     END-IF                                                       03918804
039189* DMH - 1/03/2005 - BEGIN                                         03918904
039190                         PERFORM 8000-FORMAT-AND-PRINT            03919004
039200                         SET  PS-ODD-CART-FCSE-LBL-PRTD           03920004
039210                              PS-NOT-ODD-CART-LABEL   TO TRUE     03921004
039220                     END-IF                                       03922004
039230     END-PERFORM.                                                 03923004
039240                                                                  03924004
039250                                                                  03925004
039260*----------------------------------------------------------------*03926004
039270*  CREATE LABEL FOR ODD-CARTON - FOR INNER-PACK (INPK)           *03927004
039280*----------------------------------------------------------------*03928004
039290 3440-ODD-CARTON-INPK.                                            03929004
039300                                                                  03930004
039310* DMH - 1/03/2005 - BEGIN                                         03931004
039320     IF   PS-DISPLAY-CSSL-YES                                     03932004
039330        INITIALIZE                       PV-CICS-MSG-AREA         03933004
039340        STRING ' PCKCS191- 3440-ODD-CARTON-INPK          '        03934004
039350                                         DELIMITED BY SIZE        03935004
039360                                    INTO PV-CICS-MSG-AREA         03936004
039370        MOVE LENGTH OF PV-CICS-MSG-AREA                           03937004
039380                                      TO PV-COMMAREA-LENGTH       03938004
039381        EXEC CICS                                                 03938104
039382            WRITEQ TD                                             03938204
039383                QUEUE   ('CSSL')                                  03938304
039384                FROM    (PV-CICS-MSG-AREA)                        03938404
039385                LENGTH  (PV-COMMAREA-LENGTH)                      03938504
039386                RESP    (PV-CICS-RESP)                            03938604
039387        END-EXEC                                                  03938704
039388     END-IF.                                                      03938804
039389* DMH - 1/03/2005 - BEGIN                                         03938904
039390                                                                  03939004
039391* PRINT ODD-CARTON-INPK LABEL                                     03939104
039392                                                                  03939204
039393     MOVE ZERO                        TO PV-DISTRO-SUM            03939304
039394     PERFORM VARYING PT-DISTRO-IDX                                03939404
039395              FROM 1 BY 1 UNTIL PT-STR-NBR (PT-DISTRO-IDX) = ZERO 03939504
039396              OR PT-DISTRO-IDX > 1000                             03939604
039397              OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES        03939704
039398         ADD PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX)                 03939804
039399                                      TO PV-DISTRO-SUM            03939904
039400     END-PERFORM                                                  03940004
039410                                                                  03941004
039420     DIVIDE  PC126-ODD-CRTN-UNT-QTY                               03942004
039430         BY  PC126-INPK-UNT-QTY                                   03943004
039440     GIVING  PV-ODD-CRTN-INPK-LBLS-NEED.                          03944004
039450                                                                  03945004
039460     IF  PV-ODD-CRTN-INPK-LBLS-NOT-NEED  >  0                     03946004
039470         SUBTRACT PV-ODD-CRTN-INPK-LBLS-NOT-NEED                  03947004
039480             FROM PV-ODD-CRTN-INPK-LBLS-NEED                      03948004
039490     END-IF.                                                      03949004
039500                                                                  03950004
039501     SET PS-FIRST-LABEL               TO TRUE                     03950104
039502                                                                  03950204
039503     IF PV-DISTRO-SUM > ZERO                                      03950304
039504                                                                  03950404
039505         SET  PC253-FORM-INPK-BOX     TO TRUE                     03950504
039506         MOVE PC158-FORM-INPK-BOX     TO PC158-INPK-CONVY-BOX     03950604
039507         SET  PC253-FORM-INPK-HDG     TO TRUE                     03950704
039508         MOVE PC158-FORM-INPK-HDG     TO PC158-INPK-CONVY-TEXT    03950804
039509         SET  PC253-FORM-ODD-CRTN-BOX TO TRUE                     03950904
039510         MOVE PC158-FORM-ODD-CRTN-BOX TO PC158-ODD-CARTON-BOX     03951004
039511         SET  PC253-FORM-ODD-CRTN-FLD TO TRUE                     03951104
039512         MOVE PC158-FORM-ODD-CRTN-FLD TO PC158-ODD-CARTON-FIELD   03951204
039513         SET PS-PRINT-INPK-LABELS     TO TRUE                     03951304
039514                                                                  03951404
039515             MOVE 1                   TO PC254-LABEL-NUMBER-N     03951504
039516                                         PC159-LABEL-NUMBER-N     03951604
039517             MOVE ZERO                TO PV-COUNT                 03951704
039518                                         PV-INPK-COUNTER          03951804
039519             IF  PC126-REPRINT                                    03951904
039520                 IF PC126-SHP-REPRT-FROM-CNT  >  0                03952004
039530                     MOVE  PC126-SHP-REPRT-FROM-CNT               03953004
039540                                      TO PC254-LABEL-NUMBER-N     03954004
039550                                         PC159-LABEL-NUMBER-N     03955004
039560                 END-IF                                           03956004
039570             END-IF                                               03957004
039580                                                                  03958004
039590             PERFORM 8005-PRINT-FORM-LAYOUT                       03959004
039600                                                                  03960004
039610             SET PS-ODD-CART-INPK-LBL-NOT-PRT TO TRUE             03961004
039620             SET PS-ODD-CART-LABEL            TO TRUE             03962004
039630                                                                  03963004
039640             PERFORM VARYING PT-DISTRO-IDX                        03964004
039650                        FROM 1 BY 1                               03965004
039660                       UNTIL PV-ODD-CRTN-INPK-LBLS-PRTD =         03966004
039670                             PV-ODD-CRTN-INPK-LBLS-NEED           03967004
039680                          OR PT-DISTRO-IDX > 1000                 03968004
039690                          OR PT-DISTRO-IDX  >                     03969004
039700                             PV-PT-LABEL-TABLE-ENTRIES            03970004
039710                             IF PT-ODD-CART-INPK (PT-DISTRO-IDX)  03971004
039720                                 SET PS-ODD-CART-LABEL TO TRUE    03972004
039730* DMH - 1/03/2005 - BEGIN                                         03973004
039740     IF   PS-DISPLAY-CSSL-YES                                     03974004
039750        INITIALIZE                       PV-CICS-MSG-AREA         03975004
039760        STRING ' PCKCS191- 3100-4BY4-LABELS - 11         '        03976004
039770                                         DELIMITED BY SIZE        03977004
039780                                    INTO PV-CICS-MSG-AREA         03978004
039790        MOVE LENGTH OF PV-CICS-MSG-AREA                           03979004
039800                                      TO PV-COMMAREA-LENGTH       03980004
039810        EXEC CICS                                                 03981004
039820            WRITEQ TD                                             03982004
039830                QUEUE   ('CSSL')                                  03983004
039840                FROM    (PV-CICS-MSG-AREA)                        03984004
039850                LENGTH  (PV-COMMAREA-LENGTH)                      03985004
039860                RESP    (PV-CICS-RESP)                            03986004
039870        END-EXEC                                                  03987004
039880     END-IF                                                       03988004
039890* DMH - 1/03/2005 - BEGIN                                         03989004
039900                                 PERFORM 8000-FORMAT-AND-PRINT    03990004
039910                                 ADD  1                           03991004
039920                                  TO PV-ODD-CRTN-INPK-LBLS-PRTD   03992004
039930                             END-IF                               03993004
039940             END-PERFORM                                          03994004
039950                                                                  03995004
039960* 6/2/00 DMH BEGIN                                                03996004
039970             IF  PV-ODD-CRTN-INPK-LBLS-PRTD =                     03997004
039980                 PV-ODD-CRTN-INPK-LBLS-NEED                       03998004
039990                 CONTINUE                                         03999004
040000             ELSE                                                 04000004
040010                 PERFORM WITH TEST AFTER                          04001004
040020                 VARYING PV-INPK-RETRY-COUNTER  FROM 2 BY 1       04002004
040030                   UNTIL ((PV-INPK-RETRY-COUNTER >                04003004
040040                           PV-ODD-CRTN-INPK-LBLS-NEED)            04004004
040050                      OR  (PV-ODD-CRTN-INPK-LBLS-PRTD =           04005004
040060                           PV-ODD-CRTN-INPK-LBLS-NEED))           04006004
040070                     PERFORM VARYING PT-DISTRO-IDX                04007004
040071                        FROM 1 BY 1                               04007104
040072                       UNTIL PV-ODD-CRTN-INPK-LBLS-PRTD =         04007204
040073                             PV-ODD-CRTN-INPK-LBLS-NEED           04007304
040074                          OR PT-DISTRO-IDX > 1000                 04007404
040075                          OR PT-DISTRO-IDX >                      04007504
040076                             PV-PT-LABEL-TABLE-ENTRIES            04007604
040077                             IF PT-ODD-CART-INPK (PT-DISTRO-IDX)  04007704
040078                                 SET PS-ODD-CART-LABEL TO TRUE    04007804
040079* DMH - 1/03/2005 - BEGIN                                         04007904
040080     IF   PS-DISPLAY-CSSL-YES                                     04008004
040081        INITIALIZE                       PV-CICS-MSG-AREA         04008104
040082        STRING ' PCKCS191- 3100-4BY4-LABELS - 12         '        04008204
040083                                         DELIMITED BY SIZE        04008304
040084                                    INTO PV-CICS-MSG-AREA         04008404
040085        MOVE LENGTH OF PV-CICS-MSG-AREA                           04008504
040086                                      TO PV-COMMAREA-LENGTH       04008604
040087        EXEC CICS                                                 04008704
040088            WRITEQ TD                                             04008804
040089                QUEUE   ('CSSL')                                  04008904
040090                FROM    (PV-CICS-MSG-AREA)                        04009004
040100                LENGTH  (PV-COMMAREA-LENGTH)                      04010004
040110                RESP    (PV-CICS-RESP)                            04011004
040120        END-EXEC                                                  04012004
040130     END-IF                                                       04013004
040140* DMH - 1/03/2005 - BEGIN                                         04014004
040150                                 PERFORM 8000-FORMAT-AND-PRINT    04015004
040160                                 ADD  1                           04016004
040170                                  TO PV-ODD-CRTN-INPK-LBLS-PRTD   04017004
040180                             END-IF                               04018004
040190                     END-PERFORM                                  04019004
040200                 END-PERFORM                                      04020004
040210             END-IF                                               04021004
040220* 6/2/00 DMH END                                                  04022004
040230                                                                  04023004
040240             SET PS-ODD-CART-INPK-LBL-PRTD                        04024004
040250                 PS-NOT-ODD-CART-LABEL TO TRUE                    04025004
040260                                                                  04026004
040270     END-IF.                                                      04027004
040280                                                                  04028004
040290                                                                  04029004
040300*----------------------------------------------------------------*04030004
040310* REPRINT - INNERPACK LABELS - IF NOT REPRINTING ODD CARTON LABEL*04031004
040311* DECREASE NUMBER OF INNER PACKS NEEDED IN TABLE                 *04031104
040312*----------------------------------------------------------------*04031204
040313 3445-RESET-ODD-CRTN-COUNT.                                       04031304
040314                                                                  04031404
040315* DMH - 1/03/2005 - BEGIN                                         04031504
040316     IF   PS-DISPLAY-CSSL-YES                                     04031604
040317        INITIALIZE                       PV-CICS-MSG-AREA         04031704
040318        STRING ' PCKCS191- 3445-RESET-ODD-CRTN-COUNT     '        04031804
040319                                         DELIMITED BY SIZE        04031904
040320                                    INTO PV-CICS-MSG-AREA         04032004
040321        MOVE LENGTH OF PV-CICS-MSG-AREA                           04032104
040322                                      TO PV-COMMAREA-LENGTH       04032204
040323        EXEC CICS                                                 04032304
040324            WRITEQ TD                                             04032404
040325                QUEUE   ('CSSL')                                  04032504
040326                FROM    (PV-CICS-MSG-AREA)                        04032604
040327                LENGTH  (PV-COMMAREA-LENGTH)                      04032704
040328                RESP    (PV-CICS-RESP)                            04032804
040329        END-EXEC                                                  04032904
040330     END-IF.                                                      04033004
040340* DMH - 1/03/2005 - BEGIN                                         04034004
040350                                                                  04035004
040360     PERFORM VARYING PT-DISTRO-IDX                                04036004
040370                FROM 1 BY 1                                       04037004
040380               UNTIL PV-ODD-CRTN-INPK-LBLS-NOT-NEED = 0           04038004
040390                  OR PT-DISTRO-IDX > 1000                         04039004
040400                  OR PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES    04040004
040410                     IF PT-ODD-CART-INPK (PT-DISTRO-IDX)          04041004
040420                         SUBTRACT 1 FROM PT-INPK-LABELS-NEEDED    04042004
040430                                         (PT-DISTRO-IDX)          04043004
040440                         IF  PT-INPK-LABELS-NEEDED                04044004
040450                             (PT-DISTRO-IDX)  =  0                04045004
040460                             SET PT-ODD-CART-NONE (PT-DISTRO-IDX) 04046004
040470                                 TO  TRUE                         04047004
040480                         END-IF                                   04048004
040490                         SUBTRACT 1 FROM                          04049004
040500                                  PV-ODD-CRTN-INPK-LBLS-NOT-NEED  04050004
040510                     END-IF                                       04051004
040511     END-PERFORM.                                                 04051104
040512                                                                  04051204
040513                                                                  04051304
040514*----------------------------------------------------------------*04051404
040515*  CREATE LABEL FOR ODD-CARTON - FOR PACK-TO-LIGHT (P2L)         *04051504
040516*----------------------------------------------------------------*04051604
040517 3460-ODD-CARTON-P2L.                                             04051704
040518                                                                  04051804
040519* DMH - 1/03/2005 - BEGIN                                         04051904
040520     IF   PS-DISPLAY-CSSL-YES                                     04052004
040521        INITIALIZE                       PV-CICS-MSG-AREA         04052104
040522        STRING ' PCKCS191- 3460-ODD-CARTON-P2L           '        04052204
040523                                         DELIMITED BY SIZE        04052304
040524                                    INTO PV-CICS-MSG-AREA         04052404
040525        MOVE LENGTH OF PV-CICS-MSG-AREA                           04052504
040526                                      TO PV-COMMAREA-LENGTH       04052604
040527        EXEC CICS                                                 04052704
040528            WRITEQ TD                                             04052804
040529                QUEUE   ('CSSL')                                  04052904
040530                FROM    (PV-CICS-MSG-AREA)                        04053004
040540                LENGTH  (PV-COMMAREA-LENGTH)                      04054004
040550                RESP    (PV-CICS-RESP)                            04055004
040560        END-EXEC                                                  04056004
040570     END-IF.                                                      04057004
040580* DMH - 1/03/2005 - BEGIN                                         04058004
040590                                                                  04059004
040600* PRINT ODD-CARTON-P2L  LABEL                                     04060004
040610                                                                  04061004
040620     PERFORM 7400-SELECT-P2L-MOD.                                 04062004
040630                                                                  04063004
040640     SET  PS-ODD-CART-LABEL       TO TRUE.                        04064004
040650     PERFORM 3320-FORMAT-P2L-LABEL.                               04065004
040660     PERFORM 3340-WRITE-P2L-LABEL.                                04066004
040670     SET  PS-ODD-CART-P2L-LBL-PRTD                                04067004
040680          PS-NOT-ODD-CART-LABEL   TO TRUE.                        04068004
040690                                                                  04069004
042009 3900-PROC-SML-TRLR-LABEL.                                        04200904
042010                                                                  04201004
042011* DMH - 1/03/2005 - BEGIN                                         04201104
042012     IF   PS-DISPLAY-CSSL-YES                                     04201204
042013        INITIALIZE                       PV-CICS-MSG-AREA         04201304
042014        STRING ' PCKCS191- 3900-PROC-SML-TRLR-LABEL      '        04201404
042015                                         DELIMITED BY SIZE        04201504
042016                                    INTO PV-CICS-MSG-AREA         04201604
042017        MOVE LENGTH OF PV-CICS-MSG-AREA                           04201704
042018                                      TO PV-COMMAREA-LENGTH       04201804
042019        EXEC CICS                                                 04201904
042020            WRITEQ TD                                             04202004
042021                QUEUE   ('CSSL')                                  04202104
042022                FROM    (PV-CICS-MSG-AREA)                        04202204
042023                LENGTH  (PV-COMMAREA-LENGTH)                      04202304
042024                RESP    (PV-CICS-RESP)                            04202404
042025        END-EXEC                                                  04202504
042026     END-IF.                                                      04202604
042027* DMH - 1/03/2005 - BEGIN                                         04202704
042028                                                                  04202804
042029*----------------------------------------------------------------*04202904
042030*  FORMAT THE SHIPPING MANIFEST TRAILER LABEL AND SUBMIT THE     *04203004
042040*  REQUEST FOR THIS LABEL.  THIS LABEL WILL BE USED TO SIGNIFY   *04204004
042050*  THE END OF A SHIPPING MANIFEST LABEL REQUEST.                 *04205004
042060*----------------------------------------------------------------*04206004
042070                                                                  04207004
042080      MOVE  PC-0001               TO  PC150-SML-TRLR-TOT-LBL      04208004
042090      MOVE  PV-PO-RCVR-SEQ-NBR    TO  PC150-SML-TRLR-PO-SEQ-NBR.  04209004
042100                                                                  04210004
042110**** BEGIN - PREPACK DESCRIPTIONS - LABEL PACKET TRAILER          04211004
042120     IF  PC126-PRE-PACK-ORDER                                     04212004
042130         MOVE 'PACK ID:'              TO PC150-SML-TLR-LINE-DESC  04213004
042140         MOVE PC126-PREPK-ID          TO PC150-SML-TRLR-LINE-NBR  04214004
042150     ELSE                                                         04215004
042160         MOVE 'LINE NO:'              TO PC150-SML-TLR-LINE-DESC  04216004
042170         MOVE PC126-PO-LNE-NBR        TO PC150-SML-TRLR-LINE-NBR  04217004
042180     END-IF.                                                      04218004
042190**** END   - PREPACK DESCRIPTIONS - LABEL PACKET TRAILER          04219004
042191                                                                  04219104
042192     MOVE 'CS-PKT TLR'                TO PC150-TLR-LBL-DESC.      04219204
042193     MOVE PV-LBL-PRT-DATE             TO PC150-LBL-PRT-DATE.      04219304
042194     MOVE PV-LBL-PRT-TIME             TO PC150-LBL-PRT-TIME.      04219404
042195                                                                  04219504
042196     MOVE '#'                         TO PV-DSPLY-NBR-SIGN.       04219604
042197     MOVE PC126-DC-PRTD-AT            TO PV-DSPLY-DC.             04219704
042198     MOVE '-'                         TO PV-DSPLY-DASH.           04219804
042199     MOVE PC126-SHP-PRTR-ID           TO PV-DSPLY-PRTR-ID.        04219904
042200     MOVE PV-DSPLY-PRTR               TO PC150-TLR-PRTR-NBR.      04220004
042201     MOVE PC126-USER-ID               TO PC150-USER-ID.           04220104
042202                                                                  04220204
042203                                                                  04220304
042204     IF  PC126-SHP-XMIT-INTFC-CDE  =  PC-SOCKET-INTERFACE         04220404
042205         PERFORM 5460-SML-TRAILER-LBL                             04220504
042206                 VARYING PC150-IDX FROM 1 BY 1                    04220604
042207                   UNTIL PC150-IDX > PC150-SML-TRLR-LABEL-MAX-LN  04220704
042208                      OR PS-SOCKET-ERROR                          04220804
042209     END-IF.                                                      04220904
042210                                                                  04221004
044120*----------------------------------------------------------------*04412004
044130* EZASOKET PROCESS                                               *04413004
044140*----------------------------------------------------------------*04414004
044150 5000-SOCKET-PROCESS.                                             04415004
044160                                                                  04416004
044161* DMH - 1/03/2005 - BEGIN                                         04416104
044162     IF   PS-DISPLAY-CSSL-YES                                     04416204
044163        INITIALIZE                       PV-CICS-MSG-AREA         04416304
044164        STRING ' PCKCS191- 5000-SOCKET-PROCESS           '        04416404
044165                                         DELIMITED BY SIZE        04416504
044166                                    INTO PV-CICS-MSG-AREA         04416604
044167        MOVE LENGTH OF PV-CICS-MSG-AREA                           04416704
044168                                      TO PV-COMMAREA-LENGTH       04416804
044169        EXEC CICS                                                 04416904
044170            WRITEQ TD                                             04417004
044171                QUEUE   ('CSSL')                                  04417104
044172                FROM    (PV-CICS-MSG-AREA)                        04417204
044173                LENGTH  (PV-COMMAREA-LENGTH)                      04417304
044174                RESP    (PV-CICS-RESP)                            04417404
044175        END-EXEC                                                  04417504
044176     END-IF.                                                      04417604
044177* DMH - 1/03/2005 - BEGIN                                         04417704
044178                                                                  04417804
044179     PERFORM 5100-FORMAT-IP-ADDR.                                 04417904
044180     PERFORM 5110-CALL-SOCKET.                                    04418004
044190     IF  PS-SOCKET-ERROR-NO                                       04419004
044200         PERFORM 5120-CONNECT-SOCKET                              04420004
044210     END-IF.                                                      04421004
044220     IF  PS-SOCKET-ERROR-NO                                       04422004
044230         PERFORM 5400-BLD-HDR-REC                                 04423004
044240     END-IF.                                                      04424004
044250                                                                  04425004
044260*----------------------------------------------------------------*04426004
044270*  THIS PARAGRAPH WILL TAKE EACH NUMERIC PORTION OF THE IP       *04427004
044280*  ADDRESS AND CONVERT EACH PORTION INTO ITS HEX VALUE.  THE     *04428004
044290*  HEX VALUE WILL THEN BE MOVED TO A FIELD WHICH WILL STACK THE  *04429004
044300*  FOUR HEX VALUES SIDE BY SIDE INTO A FIELD DEFINED AS X(04).   *04430004
044301*  THIS VALUE IS THEN WHAT IS USED BY THE SOCKETS LOGIC FOR THE  *04430104
044302*  IP ADDRESS.                                                   *04430204
044303*----------------------------------------------------------------*04430304
044304 5100-FORMAT-IP-ADDR.                                             04430404
044305                                                                  04430504
044306* DMH - 1/03/2005 - BEGIN                                         04430604
044307     IF   PS-DISPLAY-CSSL-YES                                     04430704
044308        INITIALIZE                       PV-CICS-MSG-AREA         04430804
044309        STRING ' PCKCS191- 5000-SOCKET-PROCESS           '        04430904
044310                                         DELIMITED BY SIZE        04431004
044311                                    INTO PV-CICS-MSG-AREA         04431104
044312        MOVE LENGTH OF PV-CICS-MSG-AREA                           04431204
044313                                      TO PV-COMMAREA-LENGTH       04431304
044314        EXEC CICS                                                 04431404
044315            WRITEQ TD                                             04431504
044316                QUEUE   ('CSSL')                                  04431604
044317                FROM    (PV-CICS-MSG-AREA)                        04431704
044318                LENGTH  (PV-COMMAREA-LENGTH)                      04431804
044319                RESP    (PV-CICS-RESP)                            04431904
044320        END-EXEC                                                  04432004
044330     END-IF.                                                      04433004
044340* DMH - 1/03/2005 - BEGIN                                         04434004
044350                                                                  04435004
044360     MOVE PV-IP-ADDR-NUM1 TO PV-HEX-NUMERIC.                      04436004
044370     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-1.                        04437004
044380                                                                  04438004
044390     MOVE PV-IP-ADDR-NUM2 TO PV-HEX-NUMERIC.                      04439004
044400     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-2.                        04440004
044410                                                                  04441004
044420     MOVE PV-IP-ADDR-NUM3 TO PV-HEX-NUMERIC.                      04442004
044430     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-3.                        04443004
044440                                                                  04444004
044450     MOVE PV-IP-ADDR-NUM4 TO PV-HEX-NUMERIC.                      04445004
044460     MOVE PV-HEX-CHAR-2 TO PV-HEX-FIELD-4.                        04446004
044470                                                                  04447004
044480     MOVE PV-HEX-FIELD-NUMBER TO DP081-NAME-IP-ADDR.              04448004
044490                                                                  04449004
044491                                                                  04449104
044492*----------------------------------------------------------------*04449204
044493*  CALL SOCKET                                                   *04449304
044494*----------------------------------------------------------------*04449404
044495 5110-CALL-SOCKET.                                                04449504
044496                                                                  04449604
044497* DMH - 1/03/2005 - BEGIN                                         04449704
044498     IF   PS-DISPLAY-CSSL-YES                                     04449804
044499        INITIALIZE                       PV-CICS-MSG-AREA         04449904
044500        STRING ' PCKCS191- 5110-CALL-SOCKET              '        04450004
044501                                         DELIMITED BY SIZE        04450104
044502                                    INTO PV-CICS-MSG-AREA         04450204
044503        MOVE LENGTH OF PV-CICS-MSG-AREA                           04450304
044504                                      TO PV-COMMAREA-LENGTH       04450404
044505        EXEC CICS                                                 04450504
044506            WRITEQ TD                                             04450604
044507                QUEUE   ('CSSL')                                  04450704
044508                FROM    (PV-CICS-MSG-AREA)                        04450804
044509                LENGTH  (PV-COMMAREA-LENGTH)                      04450904
044510                RESP    (PV-CICS-RESP)                            04451004
044520        END-EXEC                                                  04452004
044530     END-IF.                                                      04453004
044540* DMH - 1/03/2005 - BEGIN                                         04454004
044550                                                                  04455004
044560     CALL 'EZASOKET'                                              04456004
044570         USING DP081-SOCKET-CMD                                   04457004
044580               DP081-AF-INET                                      04458004
044590               DP081-SOCK-TYPE                                    04459004
044600               DP081-PROTOCOL                                     04460004
044610               DP081-ERRNO                                        04461004
044620               DP081-RETCODE.                                     04462004
044630                                                                  04463004
044640     MOVE DP081-RETCODE TO DP081-SOCK-ID.                         04464004
044650                                                                  04465004
044660     IF DP081-RETCODE < ZERO                                      04466004
044670        INITIALIZE  PV-CICS-MSG-AREA                              04467004
044680        SET  PS-SOCKET-ERROR         TO TRUE                      04468004
044690        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     04469004
044691        SET  DP081-TCP-IP-SOCKET-ERR TO TRUE                      04469104
044692        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      04469204
044693        MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA         04469304
044694        PERFORM 9999-WRITE-TO-CSSL                                04469404
044695                                                                  04469504
044696     END-IF.                                                      04469604
044697                                                                  04469704
044698                                                                  04469804
044699*----------------------------------------------------------------*04469904
044700*  CONNECT THE PATH (SOCKET).                                    *04470004
044701*----------------------------------------------------------------*04470104
044702 5120-CONNECT-SOCKET.                                             04470204
044703                                                                  04470304
044704* DMH - 1/03/2005 - BEGIN                                         04470404
044705     IF   PS-DISPLAY-CSSL-YES                                     04470504
044706        INITIALIZE                       PV-CICS-MSG-AREA         04470604
044707        STRING ' PCKCS191- 5120-CONNECT-SOCKET           '        04470704
044708                                         DELIMITED BY SIZE        04470804
044709                                    INTO PV-CICS-MSG-AREA         04470904
044710        MOVE LENGTH OF PV-CICS-MSG-AREA                           04471004
044720                                      TO PV-COMMAREA-LENGTH       04472004
044730        EXEC CICS                                                 04473004
044740            WRITEQ TD                                             04474004
044750                QUEUE   ('CSSL')                                  04475004
044760                FROM    (PV-CICS-MSG-AREA)                        04476004
044770                LENGTH  (PV-COMMAREA-LENGTH)                      04477004
044780                RESP    (PV-CICS-RESP)                            04478004
044790        END-EXEC                                                  04479004
044800     END-IF.                                                      04480004
044810* DMH - 1/03/2005 - BEGIN                                         04481004
044820                                                                  04482004
044830     MOVE DP081-AF-INET         TO DP081-NAME-FAMILY.             04483004
044840     MOVE DP081-COM-PORT        TO DP081-NAME-PORT.               04484004
044850                                                                  04485004
044860                                                                  04486004
044870     CALL 'EZASOKET'                                              04487004
044880         USING DP081-CONNECT-CMD                                  04488004
044890               DP081-SOCK-ID                                      04489004
044900               DP081-SOCK-NAME                                    04490004
044910               DP081-ERRNO                                        04491004
044920               DP081-RETCODE.                                     04492004
044930                                                                  04493004
044940                                                                  04494004
044950     IF DP081-RETCODE < ZERO                                      04495004
044960        INITIALIZE  PV-CICS-MSG-AREA                              04496004
044961        SET  PS-SOCKET-ERROR         TO TRUE                      04496104
044962        MOVE PC-CURRENT-PROGRAM-NAME  TO DP081-TCP-IP-PGM-NAME    04496204
044963        SET  DP081-TCP-IP-CONNECT-ERR TO TRUE                     04496304
044964        MOVE DP081-ERRNO              TO DP081-TCP-IP-ERR-NBR     04496404
044965                                         CONNECT-ERRNO            04496504
044966        MOVE CONNECT-ERR              TO PV-CICS-MSG-AREA         04496604
044967                                                                  04496704
044968        PERFORM 9999-WRITE-TO-CSSL                                04496804
044969                                                                  04496904
044970        INITIALIZE  PV-CICS-MSG-AREA                              04497004
044971        STRING ' PCKCS191 -'            DELIMITED BY SIZE         04497104
044972               ' PO-RCVR-LNE - '        DELIMITED BY SIZE         04497204
044973               PC126-PO-NBR             DELIMITED BY SIZE         04497304
044974               '-'                      DELIMITED BY SIZE         04497404
044975               PC126-RCVR-SEQ-NBR       DELIMITED BY SIZE         04497504
044976               '-'                      DELIMITED BY SIZE         04497604
044977               PC126-PO-LNE-NBR         DELIMITED BY SIZE         04497704
044978               '   DC - '               DELIMITED BY SIZE         04497804
044979               PC126-OPER-UNT-ID        DELIMITED BY SIZE         04497904
044980               '   PRTR ID - '          DELIMITED BY SIZE         04498004
044990               PC126-SHP-PRTR-ID        DELIMITED BY SIZE         04499004
045000                                    INTO PV-CICS-MSG-AREA         04500004
045010        PERFORM 9999-WRITE-TO-CSSL                                04501004
045020                                                                  04502004
045030        INITIALIZE  PV-CICS-MSG-AREA                              04503004
045040        MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA         04504004
045050        PERFORM 9999-WRITE-TO-CSSL                                04505004
045060                                                                  04506004
045070     END-IF.                                                      04507004
045080                                                                  04508004
045090                                                                  04509004
045100*----------------------------------------------------------------*04510004
045110*                                                                *04511004
045120*----------------------------------------------------------------*04512004
045130 5200-CREATE-TRANS-ID.                                            04513004
045140                                                                  04514004
045150* DMH - 1/03/2005 - BEGIN                                         04515004
045160     IF   PS-DISPLAY-CSSL-YES                                     04516004
045170        INITIALIZE                       PV-CICS-MSG-AREA         04517004
045180        STRING ' PCKCS191- 5200-CREATE-TRANS-ID          '        04518004
045190                                         DELIMITED BY SIZE        04519004
045200                                    INTO PV-CICS-MSG-AREA         04520004
045210        MOVE LENGTH OF PV-CICS-MSG-AREA                           04521004
045220                                      TO PV-COMMAREA-LENGTH       04522004
045230        EXEC CICS                                                 04523004
045240            WRITEQ TD                                             04524004
045250                QUEUE   ('CSSL')                                  04525004
045260                FROM    (PV-CICS-MSG-AREA)                        04526004
045270                LENGTH  (PV-COMMAREA-LENGTH)                      04527004
045280                RESP    (PV-CICS-RESP)                            04528004
045290        END-EXEC                                                  04529004
045300     END-IF.                                                      04530004
045310* DMH - 1/03/2005 - BEGIN                                         04531004
045320                                                                  04532004
045330     CALL PC-RANDOM-PGM USING DFHEIBLK                            04533004
045340                              DFHCOMMAREA                         04534004
045350                              DP902-RANDNBR-ROUTINE-FIELDS.       04535004
045360                                                                  04536004
045370     IF  DP902-SUCCESSFUL                                         04537004
045380         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          04538004
045390         MOVE PV-RANDOM-1-8          TO PV-LPMS-TRANS-ID          04539004
045400         SET  PS-TRANS-ID-DUP        TO TRUE                      04540004
045410         PERFORM 5250-CK-TRANS-ID                                 04541004
045420                 UNTIL PS-TRANS-ID-NOT-DUP                        04542004
045430         PERFORM 5300-LABEL-HISTORY                               04543004
045440                                                                  04544004
045450     ELSE                                                         04545004
045460                                                                  04546004
045461         INITIALIZE  PV-CICS-MSG-AREA                             04546104
045462         SET  PS-SOCKET-ERROR        TO TRUE                      04546204
045463         STRING ' PCKCS191 -'              DELIMITED BY SIZE      04546304
045464                ' 5200-CREATE-TRANS-ID -'  DELIMITED BY SIZE      04546404
045465                ' ERROR GENERATING RANDOM' DELIMITED BY SIZE      04546504
045466                ' NBR FOR LPMS TRANS ID'   DELIMITED BY SIZE      04546604
045467                                           INTO PV-CICS-MSG-AREA  04546704
045468         PERFORM 9999-WRITE-TO-CSSL                               04546804
045469         INITIALIZE  PV-CICS-MSG-AREA                             04546904
045470         STRING ' PCKCS191 -'              DELIMITED BY SIZE      04547004
045471                ' PO:'                     DELIMITED BY SIZE      04547104
045472                PC126-PO-NBR               DELIMITED BY SIZE      04547204
045473                ' RCVR:'                   DELIMITED BY SIZE      04547304
045474                PC126-RCVR-SEQ-NBR         DELIMITED BY SIZE      04547404
045475                ' LINE:'                   DELIMITED BY SIZE      04547504
045476                PC126-PO-LNE-NBR           DELIMITED BY SIZE      04547604
045477                                           INTO PV-CICS-MSG-AREA  04547704
045478         PERFORM 9999-WRITE-TO-CSSL                               04547804
045479     END-IF.                                                      04547904
045480                                                                  04548004
045490                                                                  04549004
045500*----------------------------------------------------------------*04550004
045510*  CHECK TO SEE IF LABEL TRANSACTION ID ALREADY EXISTS           *04551004
045520*----------------------------------------------------------------*04552004
045530 5250-CK-TRANS-ID.                                                04553004
045540                                                                  04554004
045550* DMH - 1/03/2005 - BEGIN                                         04555004
045560     IF   PS-DISPLAY-CSSL-YES                                     04556004
045570        INITIALIZE                       PV-CICS-MSG-AREA         04557004
045580        STRING ' PCKCS191- 5250-CK-TRANS-ID              '        04558004
045590                                         DELIMITED BY SIZE        04559004
045600                                    INTO PV-CICS-MSG-AREA         04560004
045610        MOVE LENGTH OF PV-CICS-MSG-AREA                           04561004
045620                                      TO PV-COMMAREA-LENGTH       04562004
045630        EXEC CICS                                                 04563004
045640            WRITEQ TD                                             04564004
045650                QUEUE   ('CSSL')                                  04565004
045660                FROM    (PV-CICS-MSG-AREA)                        04566004
045670                LENGTH  (PV-COMMAREA-LENGTH)                      04567004
045680                RESP    (PV-CICS-RESP)                            04568004
045690        END-EXEC                                                  04569004
045700     END-IF.                                                      04570004
045710* DMH - 1/03/2005 - BEGIN                                         04571004
045720                                                                  04572004
045730     MOVE PV-LPMS-TRANS-ID  TO  DK-LPMS-TRANS-ID.                 04573004
045740                                                                  04574004
045750     EXEC SQL                                                     04575004
045760          SELECT LBL_REQ_TRN_ID                                   04576004
045770          INTO  :LBTKHS-LBL-REQ-TRN-ID                            04577004
045780          FROM   TLBTKHS                                          04578004
045790          WHERE  LBL_REQ_TRN_ID  = :DK-LPMS-TRANS-ID              04579004
045800     END-EXEC.                                                    04580004
045810                                                                  04581004
045820     EVALUATE TRUE                                                04582004
045830         WHEN SQLCODE = ZERO                                      04583004
045840              ADD  1  TO  PV-LPMS-TRANS-ID                        04584004
045850              SET  PS-TRANS-ID-DUP    TO  TRUE                    04585004
045860*                                                                 04586004
045861         WHEN SQLCODE = +100                                      04586104
045862             SET PS-TRANS-ID-NOT-DUP  TO  TRUE                    04586204
045863             SET PS-VALID-TRANS-ID    TO  TRUE                    04586304
045864                                                                  04586404
045865         WHEN OTHER                                               04586504
045866              INITIALIZE  PV-CICS-MSG-AREA                        04586604
045867              SET  PS-SOCKET-ERROR        TO TRUE                 04586704
045868              MOVE   SQLCODE              TO PV-CICS-MSG-AREA     04586804
045869              MOVE LENGTH OF PV-CICS-MSG-AREA                     04586904
045870                     TO PV-COMMAREA-LENGTH                        04587004
045871              PERFORM 9999-WRITE-TO-CSSL                          04587104
045872              INITIALIZE  PV-CICS-MSG-AREA                        04587204
045873              STRING ' PCKCS191 - '            DELIMITED BY SIZE  04587304
045874                     'DK-LPMS-TRANS-ID: '      DELIMITED BY SIZE  04587404
045875                     PV-DISPLAY-LPMS-TRAN      DELIMITED BY SIZE  04587504
045876                     ' 5250-CK-TRANS-ID '      DELIMITED BY SIZE  04587604
045877                                           INTO PV-CICS-MSG-AREA  04587704
045878              MOVE LENGTH OF PV-CICS-MSG-AREA                     04587804
045879                     TO PV-COMMAREA-LENGTH                        04587904
045880              PERFORM 9999-WRITE-TO-CSSL                          04588004
045890              INITIALIZE  PV-CICS-MSG-AREA                        04589004
045900              STRING ' PCKCS191 -'             DELIMITED BY SIZE  04590004
045910                     ' PO:'                    DELIMITED BY SIZE  04591004
045920                     PC126-PO-NBR              DELIMITED BY SIZE  04592004
045930                     ' RCVR:'                  DELIMITED BY SIZE  04593004
045940                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  04594004
045950                     ' LINE:'                  DELIMITED BY SIZE  04595004
045960                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  04596004
045970                                           INTO PV-CICS-MSG-AREA  04597004
045980              MOVE LENGTH OF PV-CICS-MSG-AREA                     04598004
045990                     TO PV-COMMAREA-LENGTH                        04599004
046000              PERFORM 9999-WRITE-TO-CSSL                          04600004
046010                                                                  04601004
046020             MOVE SQLCODE             TO PV-SQL-RETURN-CD         04602004
046030             STRING 'ERR FILE# SQL='                              04603004
046040                        DELIMITED BY SIZE                         04604004
046050                        PV-SQL-RETURN-CD                          04605004
046060                        DELIMITED BY SIZE                         04606004
046070                               INTO PC126-CRA-RET-MSG             04607004
046080             MOVE '02'                TO PC126-CRA-RET-CDE        04608004
046090             MOVE '5250-'             TO PC126-CRA-REQ-ID         04609004
046100             PERFORM 9000-RETURN-CALL                             04610004
046110                                                                  04611004
046120     END-EVALUATE.                                                04612004
046130                                                                  04613004
046140                                                                  04614004
046150*----------------------------------------------------------------*04615004
046160* GENERATE LABEL HISTORY INFORMATION FOR 4X4 LABELS (SML & P2L)  *04616004
046170*----------------------------------------------------------------*04617004
046180 5300-LABEL-HISTORY.                                              04618004
046190                                                                  04619004
046200* DMH - 1/03/2005 - BEGIN                                         04620004
046210     IF   PS-DISPLAY-CSSL-YES                                     04621004
046220        INITIALIZE                       PV-CICS-MSG-AREA         04622004
046230        STRING ' PCKCS191- 5300-LABEL-HISTORY            '        04623004
046240                                         DELIMITED BY SIZE        04624004
046250                                    INTO PV-CICS-MSG-AREA         04625004
046260        MOVE LENGTH OF PV-CICS-MSG-AREA                           04626004
046270                                      TO PV-COMMAREA-LENGTH       04627004
046280        EXEC CICS                                                 04628004
046290            WRITEQ TD                                             04629004
046300                QUEUE   ('CSSL')                                  04630004
046310                FROM    (PV-CICS-MSG-AREA)                        04631004
046320                LENGTH  (PV-COMMAREA-LENGTH)                      04632004
046330                RESP    (PV-CICS-RESP)                            04633004
046340        END-EXEC                                                  04634004
046350     END-IF.                                                      04635004
046360* DMH - 1/03/2005 - BEGIN                                         04636004
046370                                                                  04637004
046380     INITIALIZE  DCLTLBTKHS                                       04638004
046390                 DCLTLBTKID.                                      04639004
046400                                                                  04640004
046410     MOVE  PV-LPMS-TRANS-ID         TO LBTKHS-LBL-REQ-TRN-ID.     04641004
046420     MOVE  PC-CASEPACK-SPLIT-APPL   TO LBTKHS-LBL-TYP-CDE.        04642004
046430     MOVE  PV-USER-ID               TO LBTKHS-CRED-BY-USR-ID.     04643004
046440     MOVE  PC-CURRENT-PROGRAM-NAME  TO LBTKHS-REQ-PGM-NM.         04644004
046450     MOVE  ZEROES                   TO LBTKHS-LOC-ID.             04645004
046460     MOVE  PV-TOT-4X4-LBL-COUNT     TO LBTKHS-LBL-PRT-QTY.        04646004
046470     MOVE  PC126-SHP-PRTR-ID        TO LBTKHS-PRTR-ID.            04647004
046480     MOVE  PC126-OPER-UNT-ID        TO LBTKHS-PRTR-OPER-UNT-ID.   04648004
046490     MOVE  1                        TO LBTKHS-PRTR-FCLTY-ID.      04649004
046500     MOVE  PC-SOCKET-INTERFACE      TO LBTKHS-XMIT-INTFC-CDE.     04650004
046510     MOVE  PC-A                     TO LBTKHS-XMIT-STAT-CDE.      04651004
046511     MOVE  ZERO                     TO LBTKHS-USR-LBL-ID-LEN.     04651104
046512                                                                  04651204
046513     PERFORM 5310-INSERT-TLBTKHS.                                 04651304
046514                                                                  04651404
046515     MOVE  PV-LPMS-TRANS-ID         TO LBTKID-LBL-REQ-TRN-ID.     04651504
046516     MOVE  PC-SML-STORE-LBL-APPL    TO LBTKID-LBL-TYP-CDE.        04651604
046517     MOVE  PC126-PO-NBR             TO LBTKID-PO-NBR.             04651704
046518     MOVE  PC126-RCVR-SEQ-NBR       TO LBTKID-RCVR-SEQ-NBR.       04651804
046519     MOVE  PC126-PO-LNE-NBR         TO LBTKID-PO-LNE-NBR.         04651904
046520     MOVE  ZEROES                   TO LBTKID-TRIP-ID.            04652004
046521     MOVE  ZEROES                   TO LBTKID-LBL-PRT-BTCH-ID.    04652104
046522     MOVE  PV-FCSE-INPK-LBL-QTY     TO LBTKID-LBL-PRT-QTY.        04652204
046523     MOVE  PV-DIVIDER-LABEL-COUNT   TO LBTKID-SEPOR-LBL-PRT-QTY.  04652304
046524                                                                  04652404
046525     IF  PV-FCSE-INPK-LBL-QTY  >  0                               04652504
046526         PERFORM 5320-INSERT-LBTKID                               04652604
046527     END-IF.                                                      04652704
046528                                                                  04652804
046529     MOVE  PV-LPMS-TRANS-ID         TO LBTKID-LBL-REQ-TRN-ID.     04652904
046530     MOVE  PC-P2L-LBL-APPL          TO LBTKID-LBL-TYP-CDE.        04653004
046540     MOVE  PC126-PO-NBR             TO LBTKID-PO-NBR.             04654004
046550     MOVE  PC126-RCVR-SEQ-NBR       TO LBTKID-RCVR-SEQ-NBR.       04655004
046560     MOVE  PC126-PO-LNE-NBR         TO LBTKID-PO-LNE-NBR.         04656004
046570     MOVE  ZEROES                   TO LBTKID-TRIP-ID.            04657004
046580     MOVE  ZEROES                   TO LBTKID-LBL-PRT-BTCH-ID.    04658004
046590     MOVE  PC126-P2L-LBL-CNT        TO LBTKID-LBL-PRT-QTY.        04659004
046600     IF  PV-FCSE-INPK-LBL-QTY  >  0                               04660004
046610         MOVE  ZEROES               TO LBTKID-SEPOR-LBL-PRT-QTY   04661004
046620     else                                                         04662004
046630         MOVE  PV-DIVIDER-LABEL-COUNT TO LBTKID-SEPOR-LBL-PRT-QTY 04663004
046640     END-IF                                                       04664004
046650                                                                  04665004
046660     IF  PC126-P2L-LBL-CNT  >  0                                  04666004
046670         PERFORM 5320-INSERT-LBTKID                               04667004
046680     END-IF                                                       04668004
046690                                                                  04669004
046700     PERFORM 9100-SYNCPOINT.                                      04670004
046710                                                                  04671004
046720*----------------------------------------------------------------*04672004
046730* INSERT INTO TLBTKHS - LABEL HISTORY                            *04673004
046740*----------------------------------------------------------------*04674004
046750 5310-INSERT-TLBTKHS.                                             04675004
046760                                                                  04676004
046770* DMH - 1/03/2005 - BEGIN                                         04677004
046780     IF   PS-DISPLAY-CSSL-YES                                     04678004
046790        INITIALIZE                       PV-CICS-MSG-AREA         04679004
046800        STRING ' PCKCS191- 5310-INSERT-TLBTKHS           '        04680004
046810                                         DELIMITED BY SIZE        04681004
046820                                    INTO PV-CICS-MSG-AREA         04682004
046830        MOVE LENGTH OF PV-CICS-MSG-AREA                           04683004
046840                                      TO PV-COMMAREA-LENGTH       04684004
046850        EXEC CICS                                                 04685004
046860            WRITEQ TD                                             04686004
046870                QUEUE   ('CSSL')                                  04687004
046880                FROM    (PV-CICS-MSG-AREA)                        04688004
046890                LENGTH  (PV-COMMAREA-LENGTH)                      04689004
046900                RESP    (PV-CICS-RESP)                            04690004
046910        END-EXEC                                                  04691004
046920     END-IF.                                                      04692004
046930* DMH - 1/03/2005 - BEGIN                                         04693004
046940                                                                  04694004
046950     EXEC SQL                                                     04695004
046960         INSERT INTO TLBTKHS                                      04696004
046970               (LBL_REQ_TRN_ID,                                   04697004
046980                LBL_TYP_CDE,                                      04698004
046990                CRE_TMST,                                         04699004
047000                CRED_BY_USR_ID,                                   04700004
047010                REQ_PGM_NM,                                       04701004
047020                LOC_ID,                                           04702004
047030                LBL_PRT_QTY,                                      04703004
047040                PRTR_ID,                                          04704004
047050                PRTR_OPER_UNT_ID,                                 04705004
047060                PRTR_FCLTY_ID,                                    04706004
047070                XMIT_INTFC_CDE,                                   04707004
047080                XMIT_STAT_CDE,                                    04708004
047081                USR_LBL_ID)                                       04708104
047082         VALUES                                                   04708204
047083               (:LBTKHS-LBL-REQ-TRN-ID,                           04708304
047084                :LBTKHS-LBL-TYP-CDE,                              04708404
047085                CURRENT TIMESTAMP,                                04708504
047086                :LBTKHS-CRED-BY-USR-ID,                           04708604
047087                :LBTKHS-REQ-PGM-NM,                               04708704
047088                :LBTKHS-LOC-ID,                                   04708804
047089                :LBTKHS-LBL-PRT-QTY,                              04708904
047090                :LBTKHS-PRTR-ID,                                  04709004
047091                :LBTKHS-PRTR-OPER-UNT-ID,                         04709104
047092                :LBTKHS-PRTR-FCLTY-ID,                            04709204
047093                :LBTKHS-XMIT-INTFC-CDE,                           04709304
047094                :LBTKHS-XMIT-STAT-CDE,                            04709404
047095                :LBTKHS-USR-LBL-ID)                               04709504
047096     END-EXEC.                                                    04709604
047097                                                                  04709704
047098     EVALUATE TRUE                                                04709804
047099         WHEN SQLCODE = ZERO                                      04709904
047100             CONTINUE                                             04710004
047110         WHEN SQLWARN0 NOT = SPACES                               04711004
047120         WHEN SQLCODE NOT EQUAL ZERO                              04712004
047130              INITIALIZE  PV-CICS-MSG-AREA                        04713004
047140              SET  PS-SOCKET-ERROR        TO TRUE                 04714004
047150              MOVE ' PCKCS191 - 5310-INSERT LABEL HISTORY'        04715004
047160                                          TO PV-CICS-MSG-AREA     04716004
047170              MOVE LENGTH OF PV-CICS-MSG-AREA                     04717004
047180                     TO PV-COMMAREA-LENGTH                        04718004
047190              PERFORM 9999-WRITE-TO-CSSL                          04719004
047200              INITIALIZE  PV-CICS-MSG-AREA                        04720004
047210              STRING ' PCKCS191 -'             DELIMITED BY SIZE  04721004
047220                     ' PO:'                    DELIMITED BY SIZE  04722004
047230                     PC126-PO-NBR              DELIMITED BY SIZE  04723004
047240                     ' RCVR:'                  DELIMITED BY SIZE  04724004
047250                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  04725004
047260                     ' LINE:'                  DELIMITED BY SIZE  04726004
047270                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  04727004
047280                                           INTO PV-CICS-MSG-AREA  04728004
047290              MOVE LENGTH OF PV-CICS-MSG-AREA                     04729004
047300                     TO PV-COMMAREA-LENGTH                        04730004
047310              PERFORM 9999-WRITE-TO-CSSL                          04731004
047320     END-EVALUATE.                                                04732004
047330                                                                  04733004
047340                                                                  04734004
047350*----------------------------------------------------------------*04735004
047360* INSERT INTO TLBTKID - LABEL IDENTIFICATION                     *04736004
047370*----------------------------------------------------------------*04737004
047380 5320-INSERT-LBTKID.                                              04738004
047390                                                                  04739004
047400* DMH - 1/03/2005 - BEGIN                                         04740004
047410     IF   PS-DISPLAY-CSSL-YES                                     04741004
047420        INITIALIZE                       PV-CICS-MSG-AREA         04742004
047430        STRING ' PCKCS191- 5320-INSERT-LBTKID            '        04743004
047440                                         DELIMITED BY SIZE        04744004
047450                                    INTO PV-CICS-MSG-AREA         04745004
047460        MOVE LENGTH OF PV-CICS-MSG-AREA                           04746004
047470                                      TO PV-COMMAREA-LENGTH       04747004
047480        EXEC CICS                                                 04748004
047490            WRITEQ TD                                             04749004
047500                QUEUE   ('CSSL')                                  04750004
047510                FROM    (PV-CICS-MSG-AREA)                        04751004
047520                LENGTH  (PV-COMMAREA-LENGTH)                      04752004
047530                RESP    (PV-CICS-RESP)                            04753004
047540        END-EXEC                                                  04754004
047550     END-IF.                                                      04755004
047560* DMH - 1/03/2005 - BEGIN                                         04756004
047570                                                                  04757004
047580     EXEC SQL                                                     04758004
047590         INSERT INTO TLBTKID                                      04759004
047600               (LBL_REQ_TRN_ID,                                   04760004
047610                LBL_TYP_CDE,                                      04761004
047620                PO_NBR,                                           04762004
047630                RCVR_SEQ_NBR,                                     04763004
047640                PO_LNE_NBR,                                       04764004
047650                TRIP_ID,                                          04765004
047660                LBL_PRT_BTCH_ID,                                  04766004
047670                LBL_PRT_QTY,                                      04767004
047680                SEPOR_LBL_PRT_QTY)                                04768004
047690         VALUES                                                   04769004
047700               (:LBTKID-LBL-REQ-TRN-ID,                           04770004
047710                :LBTKID-LBL-TYP-CDE,                              04771004
047711                :LBTKID-PO-NBR,                                   04771104
047712                :LBTKID-RCVR-SEQ-NBR,                             04771204
047713                :LBTKID-PO-LNE-NBR,                               04771304
047714                :LBTKID-TRIP-ID,                                  04771404
047715                :LBTKID-LBL-PRT-BTCH-ID,                          04771504
047716                :LBTKID-LBL-PRT-QTY,                              04771604
047717                :LBTKID-SEPOR-LBL-PRT-QTY)                        04771704
047718     END-EXEC.                                                    04771804
047719                                                                  04771904
047720     EVALUATE TRUE                                                04772004
047721         WHEN SQLCODE = ZERO                                      04772104
047722             CONTINUE                                             04772204
047723         WHEN SQLWARN0 NOT = SPACES                               04772304
047724         WHEN SQLCODE NOT EQUAL ZERO                              04772404
047725              INITIALIZE  PV-CICS-MSG-AREA                        04772504
047726              SET  PS-SOCKET-ERROR        TO TRUE                 04772604
047727              MOVE ' PCKCS191-5320-INSERT LABEL IDENTIFICATION'   04772704
047728                                          TO PV-CICS-MSG-AREA     04772804
047729              MOVE LENGTH OF PV-CICS-MSG-AREA                     04772904
047730                     TO PV-COMMAREA-LENGTH                        04773004
047740              PERFORM 9999-WRITE-TO-CSSL                          04774004
047750              INITIALIZE  PV-CICS-MSG-AREA                        04775004
047760              STRING ' PCKCS191 -'             DELIMITED BY SIZE  04776004
047770                     ' PO:'                    DELIMITED BY SIZE  04777004
047780                     PC126-PO-NBR              DELIMITED BY SIZE  04778004
047790                     ' RCVR:'                  DELIMITED BY SIZE  04779004
047800                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  04780004
047810                     ' LINE:'                  DELIMITED BY SIZE  04781004
047820                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  04782004
047830                                           INTO PV-CICS-MSG-AREA  04783004
047840              MOVE LENGTH OF PV-CICS-MSG-AREA                     04784004
047850                     TO PV-COMMAREA-LENGTH                        04785004
047860              PERFORM 9999-WRITE-TO-CSSL                          04786004
047870     END-EVALUATE.                                                04787004
047880                                                                  04788004
047890                                                                  04789004
048420*----------------------------------------------------------------*04842004
048430*  CLOSE THE SOCKET                                              *04843004
048440*----------------------------------------------------------------*04844004
048450 5340-CLOSE-SOCKET.                                               04845004
048460                                                                  04846004
048470* DMH - 1/03/2005 - BEGIN                                         04847004
048480     IF   PS-DISPLAY-CSSL-YES                                     04848004
048490        INITIALIZE                       PV-CICS-MSG-AREA         04849004
048500        STRING ' PCKCS191- 5340-CLOSE-SOCKET             '        04850004
048510                                         DELIMITED BY SIZE        04851004
048520                                    INTO PV-CICS-MSG-AREA         04852004
048530        MOVE LENGTH OF PV-CICS-MSG-AREA                           04853004
048540                                      TO PV-COMMAREA-LENGTH       04854004
048550        EXEC CICS                                                 04855004
048560            WRITEQ TD                                             04856004
048570                QUEUE   ('CSSL')                                  04857004
048580                FROM    (PV-CICS-MSG-AREA)                        04858004
048590                LENGTH  (PV-COMMAREA-LENGTH)                      04859004
048600                RESP    (PV-CICS-RESP)                            04860004
048610        END-EXEC                                                  04861004
048620     END-IF.                                                      04862004
048630* DMH - 1/03/2005 - BEGIN                                         04863004
048640                                                                  04864004
048650     CALL 'EZASOKET'                                              04865004
048660         USING DP081-CLOSE-CMD                                    04866004
048670               DP081-SOCK-ID                                      04867004
048680               DP081-ERRNO                                        04868004
048690               DP081-RETCODE.                                     04869004
048700                                                                  04870004
048710     IF DP081-RETCODE < ZERO                                      04871004
048720        INITIALIZE  PV-CICS-MSG-AREA                              04872004
048730        SET  PS-SOCKET-ERROR         TO TRUE                      04873004
048740        MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME     04874004
048750        SET  DP081-TCP-IP-CLOSE-ERR  TO TRUE                      04875004
048760        MOVE DP081-ERRNO             TO DP081-TCP-IP-ERR-NBR      04876004
048770        MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA         04877004
048780        PERFORM 9999-WRITE-TO-CSSL                                04878004
048781                                                                  04878104
048782                                                                  04878204
048783     END-IF.                                                      04878304
048784                                                                  04878404
048785                                                                  04878504
048786*----------------------------------------------------------------*04878604
048787*  GET LPMS RETURN CODE                                          *04878704
048788*----------------------------------------------------------------*04878804
048789 5350-GET-LPMS-RETURN.                                            04878904
048790                                                                  04879004
048791* DMH - 1/03/2005 - BEGIN                                         04879104
048792     IF   PS-DISPLAY-CSSL-YES                                     04879204
048793        INITIALIZE                       PV-CICS-MSG-AREA         04879304
048794        STRING ' PCKCS191- 5350-GET-LPMS-RETURN          '        04879404
048795                                         DELIMITED BY SIZE        04879504
048796                                    INTO PV-CICS-MSG-AREA         04879604
048797        MOVE LENGTH OF PV-CICS-MSG-AREA                           04879704
048798                                      TO PV-COMMAREA-LENGTH       04879804
048799        EXEC CICS                                                 04879904
048800            WRITEQ TD                                             04880004
048810                QUEUE   ('CSSL')                                  04881004
048820                FROM    (PV-CICS-MSG-AREA)                        04882004
048830                LENGTH  (PV-COMMAREA-LENGTH)                      04883004
048840                RESP    (PV-CICS-RESP)                            04884004
048850        END-EXEC                                                  04885004
048860     END-IF.                                                      04886004
048870* DMH - 1/03/2005 - BEGIN                                         04887004
048880                                                                  04888004
048890     SEARCH ALL PC138-SOCKET-ERRORS                               04889004
048900            AT END                                                04890004
048910                MOVE 'Z' TO  PV-LPMS-XMIT-RETURN                  04891004
048920            WHEN                                                  04892004
048930                PC138-CONFIRM-CODE(PC138-IDX)  =                  04893004
048940                PC133-CONFIRM-CODE                                04894004
048950                    MOVE PC138-XREF-CODE(PC138-IDX)               04895004
048960                      TO PV-LPMS-XMIT-RETURN.                     04896004
048970                                                                  04897004
048980                                                                  04898004
048990*----------------------------------------------------------------*04899004
049000*                                                                *04900004
049010*----------------------------------------------------------------*04901004
049020 5400-BLD-HDR-REC.                                                04902004
049030                                                                  04903004
049031* DMH - 1/03/2005 - BEGIN                                         04903104
049032     IF   PS-DISPLAY-CSSL-YES                                     04903204
049033        INITIALIZE                       PV-CICS-MSG-AREA         04903304
049034        STRING ' PCKCS191- 5400-BLD-HDR-REC              '        04903404
049035                                         DELIMITED BY SIZE        04903504
049036                                    INTO PV-CICS-MSG-AREA         04903604
049037        MOVE LENGTH OF PV-CICS-MSG-AREA                           04903704
049038                                      TO PV-COMMAREA-LENGTH       04903804
049039        EXEC CICS                                                 04903904
049040            WRITEQ TD                                             04904004
049041                QUEUE   ('CSSL')                                  04904104
049042                FROM    (PV-CICS-MSG-AREA)                        04904204
049043                LENGTH  (PV-COMMAREA-LENGTH)                      04904304
049044                RESP    (PV-CICS-RESP)                            04904404
049045        END-EXEC                                                  04904504
049046     END-IF.                                                      04904604
049047* DMH - 1/03/2005 - BEGIN                                         04904704
049048                                                                  04904804
049049     INITIALIZE PC133-LABEL-HDR-REC.                              04904904
049050     SET  PC133-LABEL-HDR           TO  TRUE.                     04905004
049060     MOVE PV-LPMS-TRANS-ID          TO  PC133-HDR-TRANS-ID.       04906004
049070     MOVE PC126-SHP-PRTR-ID         TO  PV-PRINTER-HOLD.          04907004
049080     MOVE PV-PRINTER-1-3            TO  PC133-HDR-PRTR-ID.        04908004
049090     MOVE SPACES                    TO  PC133-HDR-LBL-TYPE.       04909004
049100     MOVE PC126-PO-NBR              TO  PC133-HDR-PO-NBR.         04910004
049110     MOVE PC126-RCVR-SEQ-NBR        TO  PC133-HDR-RCVR-SEQ.       04911004
049120     MOVE ZEROES                    TO  PC133-HDR-STORE-NBR.      04912004
049130     MOVE SPACES                    TO  PC133-HDR-PROC-AREA.      04913004
049140                                                                  04914004
049150     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    04915004
049160         '' BY SPACES.                                           04916004
049170     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    04917004
049180         ';' BY SPACES.                                           04918004
049190     INSPECT PC133-LABEL-HDR-REC REPLACING ALL                    04919004
049200         LOW-VALUES BY SPACES.                                    04920004
049210                                                                  04921004
049220     MOVE PC133-HDR-REC-LENGTH    TO DP081-TCPLENG                04922004
049221                                     DP081-NBR-BYTES.             04922104
049222     PERFORM 6000-SEND-DATA-TO-LPMS.                              04922204
049223                                                                  04922304
049224                                                                  04922404
049225*----------------------------------------------------------------*04922504
049226* SEND HEADER LABEL - USING EZASOKET                             *04922604
049227*----------------------------------------------------------------*04922704
049228 5410-SML-HDR-LABEL.                                              04922804
049229                                                                  04922904
049230* DMH - 1/03/2005 - BEGIN                                         04923004
049231     IF   PS-DISPLAY-CSSL-YES                                     04923104
049232        INITIALIZE                       PV-CICS-MSG-AREA         04923204
049233        STRING ' PCKCS191- 5410-SML-HDR-LABEL            '        04923304
049234                                         DELIMITED BY SIZE        04923404
049235                                    INTO PV-CICS-MSG-AREA         04923504
049236        MOVE LENGTH OF PV-CICS-MSG-AREA                           04923604
049237                                      TO PV-COMMAREA-LENGTH       04923704
049238        EXEC CICS                                                 04923804
049239            WRITEQ TD                                             04923904
049240                QUEUE   ('CSSL')                                  04924004
049250                FROM    (PV-CICS-MSG-AREA)                        04925004
049260                LENGTH  (PV-COMMAREA-LENGTH)                      04926004
049270                RESP    (PV-CICS-RESP)                            04927004
049280        END-EXEC                                                  04928004
049290     END-IF.                                                      04929004
049300* DMH - 1/03/2005 - BEGIN                                         04930004
049310                                                                  04931004
049320     INITIALIZE PC133-LABEL-DTL-REC.                              04932004
049330     SET  PC133-LABEL-DTL           TO  TRUE.                     04933004
049340     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       04934004
049350     SET  PC144-IDX-2               TO  PC144-IDX.                04935004
049360     MOVE PC144-HDR-LINE-LENGTH (PC144-IDX-2)                     04936004
049370                                    TO  PC133-DTL-LENGTH.         04937004
049380     MOVE PC144-SML-HEADER-LINE (PC144-IDX)                       04938004
049390                                    TO  PC133-DTL-DATA.           04939004
049400                                                                  04940004
049410     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    04941004
049420         '' BY SPACES.                                           04942004
049430     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    04943004
049440         ';' BY SPACES.                                           04944004
049450     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    04945004
049460         LOW-VALUES BY SPACES.                                    04946004
049470                                                                  04947004
049480******************************************************************04948004
049490* LENGTH CALCULATION:                                            *04949004
049500*       LINE LENGTH HEADER LABEL (PC134-HDR-LINE-LENGTH)         *04950004
049501*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *04950104
049502*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *04950204
049503*              PC133-DTL-LENGTH        (3 POSITIONS)             *04950304
049504*              HEX 03-END EACH DTL REC (1 POSITIONS)             *04950404
049505*              FILLER                  (6 POSITIONS)             *04950504
049506******************************************************************04950604
049507     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        04950704
049508     MOVE PC144-HDR-LINE-LENGTH (PC144-IDX-2)                     04950804
049509                                  TO PC133-DTL-REC-LENGTH.        04950904
049510     ADD  20                      TO PC133-DTL-REC-LENGTH.        04951004
049511     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                04951104
049512                                     DP081-NBR-BYTES.             04951204
049513                                                                  04951304
049514     PERFORM 6000-SEND-DATA-TO-LPMS.                              04951404
049515                                                                  04951504
049516     ADD  1  TO  PV-TRAILER-COUNT.                                04951604
049517                                                                  04951704
049518                                                                  04951804
049519*----------------------------------------------------------------*04951904
049520* SEND DC/RTV/CS HEADER LABEL - USING EZASOKET                   *04952004
049530*----------------------------------------------------------------*04953004
049540 5420-DC-RTV-CS-HDR-LABEL.                                        04954004
049550                                                                  04955004
049560* DMH - 1/03/2005 - BEGIN                                         04956004
049570     IF   PS-DISPLAY-CSSL-YES                                     04957004
049580        INITIALIZE                       PV-CICS-MSG-AREA         04958004
049590        STRING ' PCKCS191- 5420-DC-RTV-CS-HDR-LABEL      '        04959004
049600                                         DELIMITED BY SIZE        04960004
049610                                    INTO PV-CICS-MSG-AREA         04961004
049620        MOVE LENGTH OF PV-CICS-MSG-AREA                           04962004
049630                                      TO PV-COMMAREA-LENGTH       04963004
049640        EXEC CICS                                                 04964004
049650            WRITEQ TD                                             04965004
049660                QUEUE   ('CSSL')                                  04966004
049670                FROM    (PV-CICS-MSG-AREA)                        04967004
049680                LENGTH  (PV-COMMAREA-LENGTH)                      04968004
049690                RESP    (PV-CICS-RESP)                            04969004
049700        END-EXEC                                                  04970004
049710     END-IF.                                                      04971004
049720* DMH - 1/03/2005 - BEGIN                                         04972004
049730                                                                  04973004
049740     INITIALIZE PC133-LABEL-DTL-REC.                              04974004
049750     SET  PC133-LABEL-DTL           TO  TRUE.                     04975004
049760     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       04976004
049770     SET  PC145-IDX-2               TO  PC145-IDX.                04977004
049780     MOVE PC145-HDR-LINE-LENGTH (PC145-IDX-2)                     04978004
049790                                    TO  PC133-DTL-LENGTH.         04979004
049800     MOVE PC145-HEADER-LABEL-LINE (PC145-IDX)                     04980004
049810                                    TO  PC133-DTL-DATA.           04981004
049820                                                                  04982004
049830     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    04983004
049840         '' BY SPACES.                                           04984004
049850     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    04985004
049860         ';' BY SPACES.                                           04986004
049870     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    04987004
049880         LOW-VALUES BY SPACES.                                    04988004
049890                                                                  04989004
049900******************************************************************04990004
049910* LENGTH CALCULATION:                                            *04991004
049920*       LINE LENGTH HEADER LABEL (PC134-HDR-LINE-LENGTH)         *04992004
049921*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *04992104
049922*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *04992204
049923*              PC133-DTL-LENGTH        (3 POSITIONS)             *04992304
049924*              HEX 03-END EACH DTL REC (1 POSITIONS)             *04992404
049925*              FILLER                  (6 POSITIONS)             *04992504
049926******************************************************************04992604
049927     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        04992704
049928     MOVE PC145-HDR-LINE-LENGTH (PC145-IDX-2)                     04992804
049929                                  TO PC133-DTL-REC-LENGTH.        04992904
049930     ADD  20                      TO PC133-DTL-REC-LENGTH.        04993004
049931     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                04993104
049932                                     DP081-NBR-BYTES.             04993204
049933                                                                  04993304
049934     PERFORM 6000-SEND-DATA-TO-LPMS.                              04993404
049935                                                                  04993504
049936     ADD  1  TO  PV-TRAILER-COUNT.                                04993604
049937                                                                  04993704
049938                                                                  04993804
049939*----------------------------------------------------------------*04993904
049940* SEND DIVIDER LABEL - USING EZASOKET                            *04994004
049950*----------------------------------------------------------------*04995004
049960 5430-DIVIDER-LABEL.                                              04996004
049970                                                                  04997004
049980* DMH - 1/03/2005 - BEGIN                                         04998004
049990     IF   PS-DISPLAY-CSSL-YES                                     04999004
050000        INITIALIZE                       PV-CICS-MSG-AREA         05000004
050010        STRING ' PCKCS191- 5430-DIVIDER-LABEL            '        05001004
050020                                         DELIMITED BY SIZE        05002004
050030                                    INTO PV-CICS-MSG-AREA         05003004
050040        MOVE LENGTH OF PV-CICS-MSG-AREA                           05004004
050050                                      TO PV-COMMAREA-LENGTH       05005004
050060        EXEC CICS                                                 05006004
050070            WRITEQ TD                                             05007004
050080                QUEUE   ('CSSL')                                  05008004
050090                FROM    (PV-CICS-MSG-AREA)                        05009004
050100                LENGTH  (PV-COMMAREA-LENGTH)                      05010004
050110                RESP    (PV-CICS-RESP)                            05011004
050120        END-EXEC                                                  05012004
050130     END-IF.                                                      05013004
050140* DMH - 1/03/2005 - BEGIN                                         05014004
050150                                                                  05015004
050160     INITIALIZE PC133-LABEL-DTL-REC.                              05016004
050170     SET  PC133-LABEL-DTL           TO  TRUE.                     05017004
050180     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       05018004
050190     SET  PC146-IDX-2               TO  PC146-IDX.                05019004
050200     MOVE PC146-DVD-LINE-LENGTH (PC146-IDX-2)                     05020004
050210                                    TO  PC133-DTL-LENGTH.         05021004
050220     MOVE PC146-DIVIDER-LABEL-LINE (PC146-IDX)                    05022004
050230                                    TO  PC133-DTL-DATA.           05023004
050240                                                                  05024004
050250     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05025004
050260         '' BY SPACES.                                           05026004
050270     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05027004
050280         ';' BY SPACES.                                           05028004
050290     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05029004
050300         LOW-VALUES BY SPACES.                                    05030004
050310                                                                  05031004
050320******************************************************************05032004
050330* LENGTH CALCULATION:                                            *05033004
050340*       LINE LENGTH HEADER LABEL (PC134-HDR-LINE-LENGTH)         *05034004
050341*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *05034104
050342*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *05034204
050343*              PC133-DTL-LENGTH        (3 POSITIONS)             *05034304
050344*              HEX 03-END EACH DTL REC (1 POSITIONS)             *05034404
050345*              FILLER                  (6 POSITIONS)             *05034504
050346******************************************************************05034604
050347     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        05034704
050348     MOVE PC146-DVD-LINE-LENGTH (PC146-IDX-2)                     05034804
050349                                  TO PC133-DTL-REC-LENGTH.        05034904
050350     ADD  20                      TO PC133-DTL-REC-LENGTH.        05035004
050351     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                05035104
050352                                     DP081-NBR-BYTES.             05035204
050353                                                                  05035304
050354     PERFORM 6000-SEND-DATA-TO-LPMS.                              05035404
050355                                                                  05035504
050356     ADD  1  TO  PV-TRAILER-COUNT.                                05035604
050357                                                                  05035704
050358                                                                  05035804
050359*----------------------------------------------------------------*05035904
050360* SEND SML-FORM - USING EZASOKET                                 *05036004
050370*----------------------------------------------------------------*05037004
050380 5440-SML-FORM.                                                   05038004
050390                                                                  05039004
050400* DMH - 1/03/2005 - BEGIN                                         05040004
050410     IF   PS-DISPLAY-CSSL-YES                                     05041004
050420        INITIALIZE                       PV-CICS-MSG-AREA         05042004
050430        STRING ' PCKCS191- 5440-SML-FORM                 '        05043004
050440                                         DELIMITED BY SIZE        05044004
050450                                    INTO PV-CICS-MSG-AREA         05045004
050460        MOVE LENGTH OF PV-CICS-MSG-AREA                           05046004
050470                                      TO PV-COMMAREA-LENGTH       05047004
050480        EXEC CICS                                                 05048004
050490            WRITEQ TD                                             05049004
050500                QUEUE   ('CSSL')                                  05050004
050510                FROM    (PV-CICS-MSG-AREA)                        05051004
050520                LENGTH  (PV-COMMAREA-LENGTH)                      05052004
050530                RESP    (PV-CICS-RESP)                            05053004
050540        END-EXEC                                                  05054004
050550     END-IF.                                                      05055004
050560* DMH - 1/03/2005 - BEGIN                                         05056004
050570                                                                  05057004
050580     INITIALIZE PC133-LABEL-DTL-REC.                              05058004
050590     SET  PC133-LABEL-DTL           TO  TRUE.                     05059004
050600     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       05060004
050610     SET  PC253-IDX-2               TO  PC253-IDX.                05061004
050620     MOVE PC253-SML-FORM-LINE-LENGTH (PC253-IDX-2)                05062004
050630                                    TO  PC133-DTL-LENGTH.         05063004
050640     MOVE PC253-SHIP-MFST-LBL-LINE (PC253-IDX)                    05064004
050650                                    TO  PC133-DTL-DATA.           05065004
050660                                                                  05066004
050670     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05067004
050680         '' BY SPACES.                                           05068004
050690     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05069004
050700         ';' BY SPACES.                                           05070004
050710     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05071004
050720         LOW-VALUES BY SPACES.                                    05072004
050730                                                                  05073004
050740******************************************************************05074004
050750* LENGTH CALCULATION:                                            *05075004
050760*       LINE LENGTH HEADER LABEL (PC253-HDR-LINE-LENGTH)         *05076004
050761*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *05076104
050762*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *05076204
050763*              PC133-DTL-LENGTH        (3 POSITIONS)             *05076304
050764*              HEX 03-END EACH DTL REC (1 POSITIONS)             *05076404
050765*              FILLER                  (6 POSITIONS)             *05076504
050766******************************************************************05076604
050767     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        05076704
050768     MOVE PC253-SML-FORM-LINE-LENGTH (PC253-IDX-2)                05076804
050769                                  TO PC133-DTL-REC-LENGTH.        05076904
050770     ADD  20                      TO PC133-DTL-REC-LENGTH.        05077004
050771     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                05077104
050772                                     DP081-NBR-BYTES.             05077204
050773                                                                  05077304
050774     PERFORM 6000-SEND-DATA-TO-LPMS.                              05077404
050775                                                                  05077504
050776     ADD  1  TO  PV-TRAILER-COUNT.                                05077604
050777                                                                  05077704
050778                                                                  05077804
050779*----------------------------------------------------------------*05077904
050780* SEND Central Stock SML-FORM - USING EZASOKET                   *05078004
050790*----------------------------------------------------------------*05079004
050800 5445-CS-SML-FORM.                                                05080004
050810                                                                  05081004
050820* DMH - 1/03/2005 - BEGIN                                         05082004
050830     IF   PS-DISPLAY-CSSL-YES                                     05083004
050840        INITIALIZE                       PV-CICS-MSG-AREA         05084004
050850        STRING ' PCKCS191- 5445-CS-SML-FORM              '        05085004
050860                                         DELIMITED BY SIZE        05086004
050870                                    INTO PV-CICS-MSG-AREA         05087004
050880        MOVE LENGTH OF PV-CICS-MSG-AREA                           05088004
050890                                      TO PV-COMMAREA-LENGTH       05089004
050900        EXEC CICS                                                 05090004
050910            WRITEQ TD                                             05091004
050920                QUEUE   ('CSSL')                                  05092004
050930                FROM    (PV-CICS-MSG-AREA)                        05093004
050940                LENGTH  (PV-COMMAREA-LENGTH)                      05094004
050950                RESP    (PV-CICS-RESP)                            05095004
050960        END-EXEC                                                  05096004
050970     END-IF.                                                      05097004
050980* DMH - 1/03/2005 - BEGIN                                         05098004
050990                                                                  05099004
051000     INITIALIZE PC133-LABEL-DTL-REC.                              05100004
051010     SET  PC133-LABEL-DTL           TO  TRUE.                     05101004
051020     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       05102004
051030     SET  PC158-IDX-2               TO  PC158-IDX.                05103004
051040     MOVE PC158-SML-FORM-LINE-LENGTH (PC158-IDX-2)                05104004
051050                                    TO  PC133-DTL-LENGTH.         05105004
051060     MOVE PC158-SHIP-MFST-LBL-LINE (PC158-IDX)                    05106004
051070                                    TO  PC133-DTL-DATA.           05107004
051080                                                                  05108004
051090     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05109004
051100         '' BY SPACES.                                           05110004
051110     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05111004
051120         ';' BY SPACES.                                           05112004
051130     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05113004
051140         LOW-VALUES BY SPACES.                                    05114004
051150                                                                  05115004
051160******************************************************************05116004
051170* LENGTH CALCULATION:                                            *05117004
051180*       LINE LENGTH HEADER LABEL (PC158-HDR-LINE-LENGTH)         *05118004
051181*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *05118104
051182*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *05118204
051183*              PC133-DTL-LENGTH        (3 POSITIONS)             *05118304
051184*              HEX 03-END EACH DTL REC (1 POSITIONS)             *05118404
051185*              FILLER                  (6 POSITIONS)             *05118504
051186******************************************************************05118604
051187     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        05118704
051188     MOVE PC158-SML-FORM-LINE-LENGTH (PC158-IDX-2)                05118804
051189                                  TO PC133-DTL-REC-LENGTH.        05118904
051190     ADD  20                      TO PC133-DTL-REC-LENGTH.        05119004
051191     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                05119104
051192                                     DP081-NBR-BYTES.             05119204
051193                                                                  05119304
051194     PERFORM 6000-SEND-DATA-TO-LPMS.                              05119404
051195                                                                  05119504
051196     ADD  1  TO  PV-TRAILER-COUNT.                                05119604
051197                                                                  05119704
051198                                                                  05119804
051199*----------------------------------------------------------------*05119904
051200* SEND SML-DATA - USING EZASOKET                                 *05120004
051210*----------------------------------------------------------------*05121004
051220 5450-SML-DATA.                                                   05122004
051230                                                                  05123004
051240* DMH - 1/03/2005 - BEGIN                                         05124004
051250     IF   PS-DISPLAY-CSSL-YES                                     05125004
051260        INITIALIZE                       PV-CICS-MSG-AREA         05126004
051270        STRING ' PCKCS191- 5450-SML-DATA                 '        05127004
051280                                         DELIMITED BY SIZE        05128004
051290                                    INTO PV-CICS-MSG-AREA         05129004
051300        MOVE LENGTH OF PV-CICS-MSG-AREA                           05130004
051310                                      TO PV-COMMAREA-LENGTH       05131004
051320        EXEC CICS                                                 05132004
051330            WRITEQ TD                                             05133004
051340                QUEUE   ('CSSL')                                  05134004
051350                FROM    (PV-CICS-MSG-AREA)                        05135004
051360                LENGTH  (PV-COMMAREA-LENGTH)                      05136004
051370                RESP    (PV-CICS-RESP)                            05137004
051380        END-EXEC                                                  05138004
051390                                                                  05139004
051400        INITIALIZE                       PV-CICS-MSG-AREA         05140004
051410        STRING ' PCKCS191- 5450-  '                               05141004
051420               PC254-SML-LABEL-LINE (PC254-IDX)                   05142004
051430                                         DELIMITED BY SIZE        05143004
051440                                    INTO PV-CICS-MSG-AREA         05144004
051450        MOVE LENGTH OF PV-CICS-MSG-AREA                           05145004
051460                                      TO PV-COMMAREA-LENGTH       05146004
051470        EXEC CICS                                                 05147004
051480            WRITEQ TD                                             05148004
051490                QUEUE   ('CSSL')                                  05149004
051500                FROM    (PV-CICS-MSG-AREA)                        05150004
051510                LENGTH  (PV-COMMAREA-LENGTH)                      05151004
051520                RESP    (PV-CICS-RESP)                            05152004
051530        END-EXEC                                                  05153004
051540     END-IF.                                                      05154004
051550* DMH - 1/03/2005 - BEGIN                                         05155004
051560     IF PC126-PRT-SHUFFLED OR                                     05156004
051570        ((PC126-PRT-STR-SEQ OR PC126-PRT-DOOR-SEQ ) AND           05157004
051580         PV-STR-ONHAND-ZERO-COUNT = PV-LBL-PRT-QTY-NUMERIC)       05158004
051590         OR PV-STR-ONHAND-ZERO-COUNT = 0                          05159004
051600        PERFORM 5452-SML-DATA-LOGIC                               05160004
051601                                                                  05160104
051602     ELSE                                                         05160204
051603       IF PV-STR-ONHAND-ZERO-COUNT < PV-LBL-PRT-QTY-NUMERIC       05160304
051604          MOVE PV-STR-ONHAND-ZERO-COUNT TO PC254-SML-TOT-LBLS     05160404
051605                                                                  05160504
051606         PERFORM 5452-SML-DATA-LOGIC                              05160604
051607                                                                  05160704
051608         IF PC254-IDX = PC254-MAX-LABEL-LINES                     05160804
051626           SET PC253-OH-ZERO-NO TO TRUE                           05162604
051627           SET PC254-OH-ZERO-MSG-NO TO TRUE                       05162704
051628           SET PC254-NO-TEXT-LINE-1 TO TRUE                       05162804
051629           SET PC254-NO-TEXT-LINE-2 TO TRUE                       05162904
051630           SET PC254-NO-TEXT-LINE-3 TO TRUE                       05163004
051631*gb 8/5/13 CHG0059834                                             05163110
051632           IF   PT-RFID-STORE-YES (PT-DISTRO-IDX)                 05163209
051633                MOVE PV-RFID-STORE-TXT-4 TO PC254-TEXT-LINE-4     05163309
051634           ELSE                                                   05163409
051635                SET PC254-NO-TEXT-LINE-4 TO TRUE                  05163509
051636           END-IF                                                 05163609
051637*gb 8/5/13 CHG0059834                                             05163710
051638           PERFORM 5440-SML-FORM                                  05163804
051639                   VARYING PC253-IDX FROM 1 BY 1                  05163904
051640                     UNTIL PC253-IDX > PC253-SHIP-MFST-LBL-MAX-LN 05164004
051641                        OR PS-SOCKET-ERROR                        05164104
051642           SUBTRACT PV-STR-ONHAND-ZERO-COUNT FROM                 05164204
051643                                  PV-LBL-PRT-QTY-NUMERIC          05164304
051644                                  GIVING PV-LBL-PRT-QTY-NUM-CALC  05164404
051645           MOVE PV-LBL-PRT-QTY-NUM-CALC TO PC254-SML-TOT-LBLS     05164504
051646********************************                                  05164604
051647                      MOVE PC160-20-DIGIT-BARCODE-NBR             05164704
051648                                  TO PV-SML-NUMBER-HOLD           05164804
051649                      MOVE PC160-20-DIGIT-BARCODE                 05164904
051650                                  TO PV-SML-NUMBER-HOLD-BRCDE     05165004
051651                      ADD PV-STR-ONHAND-ZERO-COUNT TO             05165104
051652                                        PV-SML-MANIFEST-HOLD      05165204
051653                                     PV-SML-MANIFEST-HLD-BRCDE    05165304
051654                      MOVE PV-SML-NUMBER-HOLD                     05165404
051655                                  TO PC254-SML-BC-NBR             05165504
051660                      MOVE PV-SML-NUMBER-HOLD-BRCDE               05166004
051670                                  TO PC254-SML-BC                 05167004
051680                      ADD  1           TO PC254-LABEL-NUMBER-N    05168004
051690********************************                                  05169004
051700           PERFORM 5452-SML-DATA-LOGIC                            05170004
051800                    VARYING PC254-IDX FROM 1 BY 1                 05180004
051900                      UNTIL PC254-IDX > PC254-MAX-LABEL-LINES     05190004
051910                         OR PS-SOCKET-ERROR                       05191004
051911         END-IF                                                   05191104
051912                                                                  05191204
051913       END-IF                                                     05191304
051914     END-IF.                                                      05191404
051915                                                                  05191504
051916 5452-SML-DATA-LOGIC.                                             05191604
051917                                                                  05191704
051918* DMH - 1/03/2005 - BEGIN                                         05191804
051919     IF   PS-DISPLAY-CSSL-YES                                     05191904
051920        INITIALIZE                       PV-CICS-MSG-AREA         05192004
051921        STRING ' PCKCS191- 5452-SML-DATA                 '        05192104
051922                                         DELIMITED BY SIZE        05192204
051923                                    INTO PV-CICS-MSG-AREA         05192304
051924        MOVE LENGTH OF PV-CICS-MSG-AREA                           05192404
051925                                      TO PV-COMMAREA-LENGTH       05192504
051926        EXEC CICS                                                 05192604
051927            WRITEQ TD                                             05192704
051928                QUEUE   ('CSSL')                                  05192804
051929                FROM    (PV-CICS-MSG-AREA)                        05192904
051930                LENGTH  (PV-COMMAREA-LENGTH)                      05193004
051931                RESP    (PV-CICS-RESP)                            05193104
051932        END-EXEC                                                  05193204
051933                                                                  05193304
051934        INITIALIZE                       PV-CICS-MSG-AREA         05193404
051935        STRING ' PCKCS191- 5452-  '                               05193504
051936               PC254-SML-LABEL-LINE (PC254-IDX)                   05193604
051937                                         DELIMITED BY SIZE        05193704
051938                                    INTO PV-CICS-MSG-AREA         05193804
051939        MOVE LENGTH OF PV-CICS-MSG-AREA                           05193904
051940                                      TO PV-COMMAREA-LENGTH       05194004
051941        EXEC CICS                                                 05194104
051942            WRITEQ TD                                             05194204
051943                QUEUE   ('CSSL')                                  05194304
051944                FROM    (PV-CICS-MSG-AREA)                        05194404
051945                LENGTH  (PV-COMMAREA-LENGTH)                      05194504
051946                RESP    (PV-CICS-RESP)                            05194604
051947        END-EXEC                                                  05194704
051948     END-IF.                                                      05194804
051949* DMH - 1/03/2005 - BEGIN                                         05194904
051950     INITIALIZE PC133-LABEL-DTL-REC                               05195004
051951     SET  PC133-LABEL-DTL           TO  TRUE                      05195104
051952     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID        05195204
051953     SET  PC254-IDX-2               TO  PC254-IDX.                05195304
051954     MOVE PC254-SML-DATA-LINE-LENGTH (PC254-IDX-2)                05195404
051955                                    TO  PC133-DTL-LENGTH          05195504
051956     MOVE PC254-SML-LABEL-LINE (PC254-IDX)                        05195604
051957                                    TO  PC133-DTL-DATA            05195704
051958                                                                  05195804
051959     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05195904
051960         '' BY SPACES                                            05196004
051961     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05196104
051962         ';' BY SPACES                                            05196204
051963     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05196304
051964         LOW-VALUES BY SPACES                                     05196404
051965                                                                  05196504
051966******************************************************************05196604
051967* LENGTH CALCULATION:                                            *05196704
051968*       LINE LENGTH HEADER LABEL (PC254-HDR-LINE-LENGTH)         *05196804
051969*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *05196904
051970*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *05197004
051971*              PC133-DTL-LENGTH        (3 POSITIONS)             *05197104
051972*              HEX 03-END EACH DTL REC (1 POSITIONS)             *05197204
051973*              FILLER                  (6 POSITIONS)             *05197304
051974******************************************************************05197404
051975     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH         05197504
051976     MOVE PC254-SML-DATA-LINE-LENGTH (PC254-IDX-2)                05197604
051977                                  TO PC133-DTL-REC-LENGTH         05197704
051978     ADD  20                      TO PC133-DTL-REC-LENGTH         05197804
051979     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                05197904
051980                                     DP081-NBR-BYTES              05198004
051981                                                                  05198104
051982     PERFORM 6000-SEND-DATA-TO-LPMS                               05198204
051983                                                                  05198304
051984     ADD  1  TO  PV-TRAILER-COUNT.                                05198404
051985                                                                  05198504
051986*----------------------------------------------------------------*05198604
051987* SEND Central Stock SML-DATA - USING EZASOKET                   *05198704
051988*----------------------------------------------------------------*05198804
051989 5455-CS-SML-DATA.                                                05198904
051990                                                                  05199004
051991* DMH - 1/03/2005 - BEGIN                                         05199104
051992     IF   PS-DISPLAY-CSSL-YES                                     05199204
051993        INITIALIZE                       PV-CICS-MSG-AREA         05199304
051994        STRING ' PCKCS191- 5455-CS-SML-DATA              '        05199404
051995                                         DELIMITED BY SIZE        05199504
051996                                    INTO PV-CICS-MSG-AREA         05199604
051997        MOVE LENGTH OF PV-CICS-MSG-AREA                           05199704
051998                                      TO PV-COMMAREA-LENGTH       05199804
051999        EXEC CICS                                                 05199904
052000            WRITEQ TD                                             05200004
052001                QUEUE   ('CSSL')                                  05200104
052002                FROM    (PV-CICS-MSG-AREA)                        05200204
052003                LENGTH  (PV-COMMAREA-LENGTH)                      05200304
052004                RESP    (PV-CICS-RESP)                            05200404
052005        END-EXEC                                                  05200504
052006     END-IF.                                                      05200604
052007* DMH - 1/03/2005 - BEGIN                                         05200704
052008                                                                  05200804
052009     INITIALIZE PC133-LABEL-DTL-REC.                              05200904
052010     SET  PC133-LABEL-DTL           TO  TRUE.                     05201004
052011     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       05201104
052012     SET  PC159-IDX-2               TO  PC159-IDX.                05201204
052013     MOVE PC159-SML-DATA-LINE-LENGTH (PC159-IDX-2)                05201304
052014                                    TO  PC133-DTL-LENGTH.         05201404
052015     MOVE PC159-SML-LABEL-LINE (PC159-IDX)                        05201504
052016                                    TO  PC133-DTL-DATA.           05201604
052017                                                                  05201704
052018     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05201804
052019         '' BY SPACES.                                           05201904
052020     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05202004
052021         ';' BY SPACES.                                           05202104
052022     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05202204
052023         LOW-VALUES BY SPACES.                                    05202304
052024                                                                  05202404
052025******************************************************************05202504
052026* LENGTH CALCULATION:                                            *05202604
052027*       LINE LENGTH HEADER LABEL (PC159-HDR-LINE-LENGTH)         *05202704
052028*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *05202804
052029*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *05202904
052030*              PC133-DTL-LENGTH        (3 POSITIONS)             *05203004
052031*              HEX 03-END EACH DTL REC (1 POSITIONS)             *05203104
052032*              FILLER                  (6 POSITIONS)             *05203204
052033******************************************************************05203304
052034     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        05203404
052035     MOVE PC159-SML-DATA-LINE-LENGTH (PC159-IDX-2)                05203504
052036                                  TO PC133-DTL-REC-LENGTH.        05203604
052037     ADD  20                      TO PC133-DTL-REC-LENGTH.        05203704
052038     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                05203804
052039                                     DP081-NBR-BYTES.             05203904
052040                                                                  05204004
052050     PERFORM 6000-SEND-DATA-TO-LPMS.                              05205004
052060                                                                  05206004
052070     ADD  1  TO  PV-TRAILER-COUNT.                                05207004
052080                                                                  05208004
052090                                                                  05209004
052100*----------------------------------------------------------------*05210004
052110* SEND trailer label - using EZASOKET                            *05211004
052120*----------------------------------------------------------------*05212004
052130 5460-SML-TRAILER-LBL.                                            05213004
052140                                                                  05214004
052150* DMH - 1/03/2005 - BEGIN                                         05215004
052160     IF   PS-DISPLAY-CSSL-YES                                     05216004
052170        INITIALIZE                       PV-CICS-MSG-AREA         05217004
052180        STRING ' PCKCS191- 5460-SML-TRAILER-LBL          '        05218004
052190                                         DELIMITED BY SIZE        05219004
052200                                    INTO PV-CICS-MSG-AREA         05220004
052210        MOVE LENGTH OF PV-CICS-MSG-AREA                           05221004
052220                                      TO PV-COMMAREA-LENGTH       05222004
052230        EXEC CICS                                                 05223004
052240            WRITEQ TD                                             05224004
052250                QUEUE   ('CSSL')                                  05225004
052260                FROM    (PV-CICS-MSG-AREA)                        05226004
052270                LENGTH  (PV-COMMAREA-LENGTH)                      05227004
052280                RESP    (PV-CICS-RESP)                            05228004
052290        END-EXEC                                                  05229004
052300     END-IF.                                                      05230004
052310* DMH - 1/03/2005 - BEGIN                                         05231004
052320                                                                  05232004
052330     INITIALIZE PC133-LABEL-DTL-REC.                              05233004
052340     SET  PC133-LABEL-DTL           TO  TRUE.                     05234004
052350     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       05235004
052360     SET  PC150-IDX-2               TO  PC150-IDX.                05236004
052370     MOVE PC150-TRLR-LINE-LENGTH (PC150-IDX-2)                    05237004
052380                                    TO  PC133-DTL-LENGTH.         05238004
052390     MOVE PC150-SML-TRLR-LABEL-LINE (PC150-IDX)                   05239004
052400                                    TO  PC133-DTL-DATA.           05240004
052410                                                                  05241004
052420     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05242004
052430         '' BY SPACES.                                           05243004
052440     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05244004
052441         ';' BY SPACES.                                           05244104
052442     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05244204
052443         LOW-VALUES BY SPACES.                                    05244304
052444                                                                  05244404
052445******************************************************************05244504
052446* LENGTH CALCULATION:                                            *05244604
052447*       LINE LENGTH HEADER LABEL (PC150-HDR-LINE-LENGTH)         *05244704
052448*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *05244804
052449*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *05244904
052450*              PC133-DTL-LENGTH        (3 POSITIONS)             *05245004
052451*              HEX 03-END EACH DTL REC (1 POSITIONS)             *05245104
052452*              FILLER                  (6 POSITIONS)             *05245204
052453******************************************************************05245304
052454     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        05245404
052455     MOVE PC150-TRLR-LINE-LENGTH (PC150-IDX-2)                    05245504
052456                                  TO PC133-DTL-REC-LENGTH.        05245604
052457     ADD  20                      TO PC133-DTL-REC-LENGTH.        05245704
052458     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                05245804
052459                                     DP081-NBR-BYTES.             05245904
052460                                                                  05246004
052470     PERFORM 6000-SEND-DATA-TO-LPMS.                              05247004
052480                                                                  05248004
052490     ADD  1  TO  PV-TRAILER-COUNT.                                05249004
052500                                                                  05250004
052510                                                                  05251004
052520*----------------------------------------------------------------*05252004
052530* SEND DESTINATION LABEL (P2L) USING EZASOKET                    *05253004
052540*----------------------------------------------------------------*05254004
052550 5470-DESTINATION-LABEL.                                          05255004
052560                                                                  05256004
052570* DMH - 1/03/2005 - BEGIN                                         05257004
052580     IF   PS-DISPLAY-CSSL-YES                                     05258004
052590        INITIALIZE                       PV-CICS-MSG-AREA         05259004
052600        STRING ' PCKCS191- 5470-DESTINATION-LABEL        '        05260004
052610                                         DELIMITED BY SIZE        05261004
052620                                    INTO PV-CICS-MSG-AREA         05262004
052630        MOVE LENGTH OF PV-CICS-MSG-AREA                           05263004
052640                                      TO PV-COMMAREA-LENGTH       05264004
052650        EXEC CICS                                                 05265004
052660            WRITEQ TD                                             05266004
052670                QUEUE   ('CSSL')                                  05267004
052680                FROM    (PV-CICS-MSG-AREA)                        05268004
052690                LENGTH  (PV-COMMAREA-LENGTH)                      05269004
052700                RESP    (PV-CICS-RESP)                            05270004
052710        END-EXEC                                                  05271004
052720     END-IF.                                                      05272004
052730* DMH - 1/03/2005 - BEGIN                                         05273004
052740                                                                  05274004
052750     INITIALIZE PC133-LABEL-DTL-REC.                              05275004
052760     SET  PC133-LABEL-DTL           TO  TRUE.                     05276004
052770     MOVE PV-LPMS-TRANS-ID          TO  PC133-DTL-TRANS-ID.       05277004
052780     SET  PC149-IDX-2               TO  PC149-IDX.                05278004
052790     MOVE PC149-DEST-LBL-LINE-LENGTH (PC149-IDX-2)                05279004
052800                                    TO  PC133-DTL-LENGTH.         05280004
052810     MOVE PC149-P2L-DEST-LBL-LINE (PC149-IDX)                     05281004
052820                                    TO  PC133-DTL-DATA.           05282004
052830                                                                  05283004
052840     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05284004
052850         '' BY SPACES.                                           05285004
052860     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05286004
052861         ';' BY SPACES.                                           05286104
052862     INSPECT PC133-LABEL-DTL-REC REPLACING ALL                    05286204
052863         LOW-VALUES BY SPACES.                                    05286304
052864                                                                  05286404
052865******************************************************************05286504
052866* LENGTH CALCULATION:                                            *05286604
052867*       LINE LENGTH HEADER LABEL (PC149-HDR-LINE-LENGTH)         *05286704
052868*       20  =  PC133-RECORD-TYPE (LD)  (2 POSITIONS)             *05286804
052869*              PC133-DTL-TRANS-ID      (8 POSITIONS)             *05286904
052870*              PC133-DTL-LENGTH        (3 POSITIONS)             *05287004
052871*              HEX 03-END EACH DTL REC (1 POSITIONS)             *05287104
052872*              FILLER                  (6 POSITIONS)             *05287204
052873******************************************************************05287304
052874     MOVE ZEROES                  TO PC133-DTL-REC-LENGTH.        05287404
052875     MOVE PC149-DEST-LBL-LINE-LENGTH (PC149-IDX-2)                05287504
052876                                  TO PC133-DTL-REC-LENGTH.        05287604
052877     ADD  20                      TO PC133-DTL-REC-LENGTH.        05287704
052878     MOVE PC133-DTL-REC-LENGTH    TO DP081-TCPLENG                05287804
052879                                     DP081-NBR-BYTES.             05287904
052880                                                                  05288004
052890     PERFORM 6000-SEND-DATA-TO-LPMS.                              05289004
052900                                                                  05290004
052910     ADD  1  TO  PV-TRAILER-COUNT.                                05291004
052920                                                                  05292004
052930                                                                  05293004
052940*----------------------------------------------------------------*05294004
052950* BUILD TRAILER RECORD FOR LPMS - USING SOCKETS                  *05295004
052960*----------------------------------------------------------------*05296004
052970 5500-BLD-TLR-REC.                                                05297004
052980                                                                  05298004
052990* DMH - 1/03/2005 - BEGIN                                         05299004
053000     IF   PS-DISPLAY-CSSL-YES                                     05300004
053010        INITIALIZE                       PV-CICS-MSG-AREA         05301004
053020        STRING ' PCKCS191- 5500-BLD-TLR-REC              '        05302004
053030                                         DELIMITED BY SIZE        05303004
053040                                    INTO PV-CICS-MSG-AREA         05304004
053050        MOVE LENGTH OF PV-CICS-MSG-AREA                           05305004
053060                                      TO PV-COMMAREA-LENGTH       05306004
053070        EXEC CICS                                                 05307004
053080            WRITEQ TD                                             05308004
053090                QUEUE   ('CSSL')                                  05309004
053100                FROM    (PV-CICS-MSG-AREA)                        05310004
053110                LENGTH  (PV-COMMAREA-LENGTH)                      05311004
053120                RESP    (PV-CICS-RESP)                            05312004
053130        END-EXEC                                                  05313004
053140     END-IF.                                                      05314004
053150* DMH - 1/03/2005 - BEGIN                                         05315004
053160                                                                  05316004
053170     INITIALIZE PC133-LABEL-TLR-REC.                              05317004
053180     SET  PC133-LABEL-TLR           TO  TRUE.                     05318004
053190     MOVE PV-LPMS-TRANS-ID          TO  PC133-TLR-TRANS-ID.       05319004
053200     MOVE PV-TRAILER-COUNT          TO  PC133-TLR-RECORD-COUNT.   05320004
053210                                                                  05321004
053220     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    05322004
053230         '' BY SPACES.                                           05323004
053240     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    05324004
053250         ';' BY SPACES.                                           05325004
053260     INSPECT PC133-LABEL-TLR-REC REPLACING ALL                    05326004
053270         LOW-VALUES BY SPACES.                                    05327004
053280                                                                  05328004
053281     MOVE PC133-TLR-REC-LENGTH    TO DP081-TCPLENG                05328104
053282                                     DP081-NBR-BYTES.             05328204
053283                                                                  05328304
053284     PERFORM 6000-SEND-DATA-TO-LPMS.                              05328404
053285                                                                  05328504
053286                                                                  05328604
053287                                                                  05328704
053288                                                                  05328804
053289                                                                  05328904
053290                                                                  05329004
053291*----------------------------------------------------------------*05329104
053292*  CONNECT THE PATH (SOCKET).                                    *05329204
053293*----------------------------------------------------------------*05329304
053294 6000-SEND-DATA-TO-LPMS.                                          05329404
053295                                                                  05329504
053296* DMH - 1/03/2005 - BEGIN                                         05329604
053297     IF   PS-DISPLAY-CSSL-YES                                     05329704
053298        INITIALIZE                       PV-CICS-MSG-AREA         05329804
053299        STRING ' PCKCS191- 6000-SEND-DATA-TO-LPMS        '        05329904
053300                                         DELIMITED BY SIZE        05330004
053310                                    INTO PV-CICS-MSG-AREA         05331004
053320        MOVE LENGTH OF PV-CICS-MSG-AREA                           05332004
053330                                      TO PV-COMMAREA-LENGTH       05333004
053340        EXEC CICS                                                 05334004
053350            WRITEQ TD                                             05335004
053360                QUEUE   ('CSSL')                                  05336004
053370                FROM    (PV-CICS-MSG-AREA)                        05337004
053380                LENGTH  (PV-COMMAREA-LENGTH)                      05338004
053390                RESP    (PV-CICS-RESP)                            05339004
053400        END-EXEC                                                  05340004
053410     END-IF.                                                      05341004
053420* DMH - 1/03/2005 - BEGIN                                         05342004
053430                                                                  05343004
053440     MOVE LOW-VALUES              TO TCP-BUF2.                    05344004
053450     MOVE PC133-LABEL-RECORD      TO TCP-BUF2.                    05345004
053460     MOVE PC133-LABEL-RECORD      TO PV-DISPLAY-DOWNLOAD.         05346004
053470     MOVE SPACES                  TO PV-CICS-MSG-AREA.            05347004
053480                                                                  05348004
053490                                                                  05349004
053500*-----------------------------------------------------*           05350004
053510*                                                     *           05351004
053520*-----------------------------------------------------*           05352004
053530     CALL 'EZACIC04'                                              05353004
053540         USING DP081-TOASCII-TOKEN                                05354004
053550               TCP-BUF2                                           05355004
053551               DP081-TCPLENG.                                     05355104
053552                                                                  05355204
053553*-----------------------------------------------------*           05355304
053554*                                                     *           05355404
053555*-----------------------------------------------------*           05355504
053556                                                                  05355604
053557                                                                  05355704
053558     SET  DP081-OUT-OF-BAND-FLAG TO TRUE.                         05355804
053559                                                                  05355904
053560     CALL 'EZASOKET'                                              05356004
053561         USING DP081-SEND-CMD                                     05356104
053562               DP081-SOCK-ID                                      05356204
053563               DP081-FLAG                                         05356304
053564               DP081-NBR-BYTES                                    05356404
053565               TCP-BUF2                                           05356504
053566               DP081-ERRNO                                        05356604
053567               DP081-RETCODE.                                     05356704
053568                                                                  05356804
053569*-----------------------------------------------------*           05356904
053570*                                                     *           05357004
053580*-----------------------------------------------------*           05358004
053590                                                                  05359004
053600     IF  DP081-RETCODE < ZERO                                     05360004
053610         INITIALIZE  PV-CICS-MSG-AREA                             05361004
053620         SET  PS-SOCKET-ERROR        TO TRUE                      05362004
053630         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    05363004
053640         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    05364004
053650         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05365004
053660                                        RECEIVE-ERRNO             05366004
053670         MOVE DP081-RETCODE          TO RECEIVE-RETCODE           05367004
053680         MOVE PC126-PO-NBR           TO RECEIVE-RECEIVER          05368004
053690         MOVE PC126-RCVR-SEQ-NBR     TO RECEIVE-SEQ               05369004
053700         MOVE PC126-PO-LNE-NBR       TO RECEIVE-LINE              05370004
053710                                                                  05371004
053720         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          05372004
053730         PERFORM 9999-WRITE-TO-CSSL                               05373004
053740                                                                  05374004
053750         INITIALIZE  PV-CICS-MSG-AREA                             05375004
053760         STRING ' PCKCS191 -'            DELIMITED BY SIZE        05376004
053770                ' PO-RCVR-LNE - '        DELIMITED BY SIZE        05377004
053780                PC126-PO-NBR             DELIMITED BY SIZE        05378004
053790                '-'                      DELIMITED BY SIZE        05379004
053800                PC126-RCVR-SEQ-NBR       DELIMITED BY SIZE        05380004
053810                '-'                      DELIMITED BY SIZE        05381004
053820                PC126-PO-LNE-NBR         DELIMITED BY SIZE        05382004
053830                '   DC - '               DELIMITED BY SIZE        05383004
053840                PC126-OPER-UNT-ID        DELIMITED BY SIZE        05384004
053850                '   PRTR ID - '          DELIMITED BY SIZE        05385004
053860                PC126-SHP-PRTR-ID        DELIMITED BY SIZE        05386004
053870                                     INTO PV-CICS-MSG-AREA        05387004
053880         PERFORM 9999-WRITE-TO-CSSL                               05388004
053890                                                                  05389004
053900         INITIALIZE  PV-CICS-MSG-AREA                             05390004
053910         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05391004
053920         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        05392004
053930         PERFORM 9999-WRITE-TO-CSSL                               05393004
053940                                                                  05394004
053950                                                                  05395004
053960     END-IF.                                                      05396004
053970*                                                                 05397004
053980     PERFORM 6050-CHECK-SOCKET-CONNECTION.                        05398004
053990                                                                  05399004
054000     IF  PS-SOCKET-ERROR-NO                                       05400004
054010         PERFORM 6100-RECEIVE-CONFIRM-FROM-LPMS                   05401004
054020     END-IF.                                                      05402004
054030                                                                  05403004
054040* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05404004
054050*  added Select socket command to check if socket connection    * 05405004
054060*  is still active.  if return code > 0 then socket is active   * 05406004
054070*  if return code = 0 socket is no longer active.               * 05407004
054080* DMH - 10/06/04 - BEGIN                                          05408004
054090* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05409004
054100 6050-CHECK-SOCKET-CONNECTION.                                    05410004
054110                                                                  05411004
054120* DMH - 1/03/2005 - BEGIN                                         05412004
054130     IF   PS-DISPLAY-CSSL-YES                                     05413004
054140        INITIALIZE                       PV-CICS-MSG-AREA         05414004
054150        STRING ' PCKCS191- 6050-CHECK-SOCKET-CONNECTION  '        05415004
054160                                         DELIMITED BY SIZE        05416004
054170                                    INTO PV-CICS-MSG-AREA         05417004
054180        MOVE LENGTH OF PV-CICS-MSG-AREA                           05418004
054190                                      TO PV-COMMAREA-LENGTH       05419004
054200        EXEC CICS                                                 05420004
054210            WRITEQ TD                                             05421004
054220                QUEUE   ('CSSL')                                  05422004
054230                FROM    (PV-CICS-MSG-AREA)                        05423004
054240                LENGTH  (PV-COMMAREA-LENGTH)                      05424004
054250                RESP    (PV-CICS-RESP)                            05425004
054260        END-EXEC                                                  05426004
054270     END-IF.                                                      05427004
054271* DMH - 1/03/2005 - BEGIN                                         05427104
054272                                                                  05427204
054273* ZERO OUT ALL OUTPUT BIT MASKS FOR SELECT                        05427304
054274     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    05427404
054275        MOVE '0' TO CHAR-ENTRY(SOCKNO)                            05427504
054276     END-PERFORM.                                                 05427604
054277     PERFORM 6060-CHAR-TO-BIT.                                    05427704
054278                                                                  05427804
054279* DMH - 1/03/2005 - BEGIN                                         05427904
054280     IF   PS-DISPLAY-CSSL-YES                                     05428004
054290        INITIALIZE                       PV-CICS-MSG-AREA         05429004
054291        MOVE SOCKNO                 TO  PV-DISPLAY-SOCKNO         05429104
054292        MOVE SOCKETS                TO  PV-DISPLAY-SOCKETS        05429204
054293        STRING ' PCKCS191- 6050-'                                 05429304
054294               '  SOCKNO='   PV-DISPLAY-SOCKNO                    05429404
054295               '  SOCKETS='  PV-DISPLAY-SOCKETS                   05429504
054296                                         DELIMITED BY SIZE        05429604
054297                                    INTO PV-CICS-MSG-AREA         05429704
054298        MOVE LENGTH OF PV-CICS-MSG-AREA                           05429804
054299                                      TO PV-COMMAREA-LENGTH       05429904
054300        EXEC CICS                                                 05430004
054301            WRITEQ TD                                             05430104
054302                QUEUE   ('CSSL')                                  05430204
054303                FROM    (PV-CICS-MSG-AREA)                        05430304
054304                LENGTH  (PV-COMMAREA-LENGTH)                      05430404
054305                RESP    (PV-CICS-RESP)                            05430504
054306        END-EXEC                                                  05430604
054307     END-IF.                                                      05430704
054308* DMH - 1/03/2005 - BEGIN                                         05430804
054309                                                                  05430904
054310     MOVE BIT-MASK TO SELECT-RR-MASK.                             05431004
054311     MOVE BIT-MASK TO SELECT-RW-MASK.                             05431104
054312     MOVE BIT-MASK TO SELECT-RE-MASK.                             05431204
054313     MOVE BIT-MASK TO SELECT-EX-MASK.                             05431304
054314     MOVE BIT-MASK TO SELECT-WR-MASK.                             05431404
054315                                                                  05431504
054316* set all input bit masks for select to 1                         05431604
054317     PERFORM VARYING SOCKNO FROM 1 BY 1 UNTIL SOCKNO > SOCKETS    05431704
054318        MOVE '1' TO CHAR-ENTRY(SOCKNO)                            05431804
054319     END-PERFORM.                                                 05431904
054320     PERFORM 6060-CHAR-TO-BIT.                                    05432004
054321     MOVE BIT-MASK TO SELECT-RD-MASK.                             05432104
054322                                                                  05432204
054323* DMH - 1/03/2005 - BEGIN                                         05432304
054324     IF   PS-DISPLAY-CSSL-YES                                     05432404
054325        INITIALIZE                       PV-CICS-MSG-AREA         05432504
054326        MOVE SOCKNO                 TO  PV-DISPLAY-SOCKNO         05432604
054327        MOVE SOCKETS                TO  PV-DISPLAY-SOCKETS        05432704
054328        STRING ' PCKCS191- 6050-'                                 05432804
054329               '  SOCKNO='   PV-DISPLAY-SOCKNO                    05432904
054330               '  SOCKETS='  PV-DISPLAY-SOCKETS                   05433004
054331                                         DELIMITED BY SIZE        05433104
054332                                    INTO PV-CICS-MSG-AREA         05433204
054333        MOVE LENGTH OF PV-CICS-MSG-AREA                           05433304
054334                                      TO PV-COMMAREA-LENGTH       05433404
054335        EXEC CICS                                                 05433504
054336            WRITEQ TD                                             05433604
054337                QUEUE   ('CSSL')                                  05433704
054338                FROM    (PV-CICS-MSG-AREA)                        05433804
054339                LENGTH  (PV-COMMAREA-LENGTH)                      05433904
054340                RESP    (PV-CICS-RESP)                            05434004
054341        END-EXEC                                                  05434104
054342     END-IF.                                                      05434204
054343* DMH - 1/03/2005 - BEGIN                                         05434304
054344                                                                  05434404
054345*                                                                 05434504
054346* ISSUE THE SELECT COMMAND ----------------------------           05434604
054347* SELECT WILL FLIP A BIT IN THE READ MASK TO '1' FOR ANY          05434704
054348* SOCKET THAT HAS DATA TO BE PROCESSED.                           05434804
054349*                                                                 05434904
054350                                                                  05435004
054351     MOVE 0 TO DP081-ERRNO.                                       05435104
054352     MOVE 0 TO DP081-RETCODE.                                     05435204
054353     CALL 'EZASOKET' USING DP081-SELECT-CMD                       05435304
054354         SELECT-NUMFDS SELECT-TIMEOUT                             05435404
054355         SELECT-RD-MASK SELECT-WR-MASK SELECT-EX-MASK             05435504
054356         SELECT-RR-MASK SELECT-RW-MASK SELECT-RE-MASK             05435604
054357         DP081-ERRNO DP081-RETCODE.                               05435704
054358                                                                  05435804
054359                                                                  05435904
054360* DMH - 1/03/2005 - BEGIN                                         05436004
054361     IF   PS-DISPLAY-CSSL-YES                                     05436104
054362        INITIALIZE                       PV-CICS-MSG-AREA         05436204
054363        MOVE SOCKNO                 TO  PV-DISPLAY-SOCKNO         05436304
054364        MOVE SOCKETS                TO  PV-DISPLAY-SOCKETS        05436404
054365        STRING ' PCKCS191- 6050-'                                 05436504
054366               '  RD-MASK=' SELECT-RD-MASK                        05436604
054367               '  WR-MASK=' SELECT-WR-MASK                        05436704
054368               '  EX-MASK=' SELECT-EX-MASK                        05436804
054369                                         DELIMITED BY SIZE        05436904
054370                                    INTO PV-CICS-MSG-AREA         05437004
054371        MOVE LENGTH OF PV-CICS-MSG-AREA                           05437104
054372                                      TO PV-COMMAREA-LENGTH       05437204
054373        EXEC CICS                                                 05437304
054374            WRITEQ TD                                             05437404
054375                QUEUE   ('CSSL')                                  05437504
054376                FROM    (PV-CICS-MSG-AREA)                        05437604
054377                LENGTH  (PV-COMMAREA-LENGTH)                      05437704
054378                RESP    (PV-CICS-RESP)                            05437804
054379        END-EXEC                                                  05437904
054380                                                                  05438004
054381        INITIALIZE                       PV-CICS-MSG-AREA         05438104
054382        MOVE SOCKNO                 TO  PV-DISPLAY-SOCKNO         05438204
054383        MOVE SOCKETS                TO  PV-DISPLAY-SOCKETS        05438304
054384        STRING ' PCKCS191- 6050-'                                 05438404
054385               '  RR-MASK=' SELECT-RR-MASK                        05438504
054386               '  RW-MASK=' SELECT-RW-MASK                        05438604
054387               '  RE-MASK=' SELECT-RE-MASK                        05438704
054388               '  BIT-MASK=' BIT-MASK                             05438804
054389                                         DELIMITED BY SIZE        05438904
054390                                    INTO PV-CICS-MSG-AREA         05439004
054391        MOVE LENGTH OF PV-CICS-MSG-AREA                           05439104
054392                                      TO PV-COMMAREA-LENGTH       05439204
054393        EXEC CICS                                                 05439304
054394            WRITEQ TD                                             05439404
054395                QUEUE   ('CSSL')                                  05439504
054396                FROM    (PV-CICS-MSG-AREA)                        05439604
054397                LENGTH  (PV-COMMAREA-LENGTH)                      05439704
054398                RESP    (PV-CICS-RESP)                            05439804
054399        END-EXEC                                                  05439904
054400     END-IF.                                                      05440004
054401* DMH - 1/03/2005 - BEGIN                                         05440104
054402                                                                  05440204
054403                                                                  05440304
054404     IF DP081-RETCODE < 0                                         05440404
054405         INITIALIZE  PV-CICS-MSG-AREA                             05440504
054406         SET  PS-SOCKET-ERROR        TO TRUE                      05440604
054407         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    05440704
054408         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    05440804
054409         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05440904
054410                                        SOCKET-ERRNO              05441004
054411         MOVE DP081-RETCODE          TO SOCKET-RETCODE            05441104
054412         MOVE PC133-HDR-PO-NBR       TO SOCKET-RECEIVER           05441204
054413         MOVE PC133-HDR-RCVR-SEQ     TO SOCKET-SEQ                05441304
054414         MOVE PC133-HDR-LINE-NBR     TO SOCKET-LINE               05441404
054415         MOVE 'SEE ERROR NO '        TO SOCKET-DESCR              05441504
054416                                                                  05441604
054417         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          05441704
054418         PERFORM 9999-WRITE-TO-CSSL                               05441804
054419                                                                  05441904
054420         INITIALIZE  PV-CICS-MSG-AREA                             05442004
054421         STRING ' PCKCS191 -'            DELIMITED BY SIZE        05442104
054422                ' PO-RCVR-LNE - '        DELIMITED BY SIZE        05442204
054423                PC126-PO-NBR             DELIMITED BY SIZE        05442304
054424                '-'                      DELIMITED BY SIZE        05442404
054425                PC126-RCVR-SEQ-NBR       DELIMITED BY SIZE        05442504
054426                '-'                      DELIMITED BY SIZE        05442604
054427                PC126-PO-LNE-NBR         DELIMITED BY SIZE        05442704
054428                '   DC - '               DELIMITED BY SIZE        05442804
054429                PC126-OPER-UNT-ID        DELIMITED BY SIZE        05442904
054430                '   PRTR ID - '          DELIMITED BY SIZE        05443004
054440                PC126-SHP-PRTR-ID        DELIMITED BY SIZE        05444004
054441                                     INTO PV-CICS-MSG-AREA        05444104
054442         PERFORM 9999-WRITE-TO-CSSL                               05444204
054443                                                                  05444304
054444         INITIALIZE  PV-CICS-MSG-AREA                             05444404
054445         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05444504
054446         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        05444604
054447         PERFORM 9999-WRITE-TO-CSSL                               05444704
054448                                                                  05444804
054449     END-IF.                                                      05444904
054450                                                                  05445004
054451     IF DP081-RETCODE = 0                                         05445104
054452         INITIALIZE  PV-CICS-MSG-AREA                             05445204
054453         SET  PS-SOCKET-ERROR        TO TRUE                      05445304
054454         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    05445404
054455         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    05445504
054456         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05445604
054457                                        SOCKET-ERRNO              05445704
054458         MOVE DP081-RETCODE          TO SOCKET-RETCODE            05445804
054459         MOVE PC133-HDR-PO-NBR       TO SOCKET-RECEIVER           05445904
054460         MOVE PC133-HDR-RCVR-SEQ     TO SOCKET-SEQ                05446004
054461         MOVE PC133-HDR-LINE-NBR     TO SOCKET-LINE               05446104
054462         MOVE 'SOCKET TIMEOUT'       TO SOCKET-DESCR              05446204
054463                                                                  05446304
054464         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          05446404
054465         PERFORM 9999-WRITE-TO-CSSL                               05446504
054466                                                                  05446604
054467         INITIALIZE  PV-CICS-MSG-AREA                             05446704
054468         STRING ' PCKCS191 -'            DELIMITED BY SIZE        05446804
054469                ' PO-RCVR-LNE - '        DELIMITED BY SIZE        05446904
054470                PC126-PO-NBR             DELIMITED BY SIZE        05447004
054471                '-'                      DELIMITED BY SIZE        05447104
054472                PC126-RCVR-SEQ-NBR       DELIMITED BY SIZE        05447204
054473                '-'                      DELIMITED BY SIZE        05447304
054474                PC126-PO-LNE-NBR         DELIMITED BY SIZE        05447404
054475                '   DC - '               DELIMITED BY SIZE        05447504
054476                PC126-OPER-UNT-ID        DELIMITED BY SIZE        05447604
054477                '   PRTR ID - '          DELIMITED BY SIZE        05447704
054478                PC126-SHP-PRTR-ID        DELIMITED BY SIZE        05447804
054479                                     INTO PV-CICS-MSG-AREA        05447904
054480         PERFORM 9999-WRITE-TO-CSSL                               05448004
054481                                                                  05448104
054482         INITIALIZE  PV-CICS-MSG-AREA                             05448204
054483         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05448304
054484         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        05448404
054485         PERFORM 9999-WRITE-TO-CSSL                               05448504
054486                                                                  05448604
054487     END-IF.                                                      05448704
054488                                                                  05448804
054489***************************************************************   05448904
054490* CHAR-TO-BIT                                                 *   05449004
054491* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE*   05449104
054492* COBOL PROGRAM CAN WRITE IT.                                 *   05449204
054493***************************************************************   05449304
054494 6060-CHAR-TO-BIT.                                                05449404
054495                                                                  05449504
054496* DMH - 1/03/2005 - BEGIN                                         05449604
054497     IF   PS-DISPLAY-CSSL-YES                                     05449704
054498        INITIALIZE                       PV-CICS-MSG-AREA         05449804
054499        STRING ' PCKCS191- 6060-CHAR-TO-BIT              '        05449904
054500                                         DELIMITED BY SIZE        05450004
054501                                    INTO PV-CICS-MSG-AREA         05450104
054502        MOVE LENGTH OF PV-CICS-MSG-AREA                           05450204
054503                                      TO PV-COMMAREA-LENGTH       05450304
054504        EXEC CICS                                                 05450404
054505            WRITEQ TD                                             05450504
054506                QUEUE   ('CSSL')                                  05450604
054507                FROM    (PV-CICS-MSG-AREA)                        05450704
054508                LENGTH  (PV-COMMAREA-LENGTH)                      05450804
054509                RESP    (PV-CICS-RESP)                            05450904
054510        END-EXEC                                                  05451004
054511     END-IF.                                                      05451104
054512* DMH - 1/03/2005 - BEGIN                                         05451204
054513                                                                  05451304
054514* CHAR-TO-BIT                                                     05451404
054515* CONVERT THE CHARACTER ARRAY TO A SELECT BIT MASK SO THAT THE    05451504
054516* COBOL PROGRAM CAN WRITE IT.                                     05451604
054517*                                                                 05451704
054518     CALL 'EZACIC06' USING BITMASK-TOKEN CTOB                     05451804
054519          BIT-MASK CHAR-MASK BIT-MASK-LENGTH EZRETC               05451904
054520     IF  EZRETC < 0 THEN                                          05452004
054521         MOVE '!EZCIC06 - CTOB-EXCP ' TO PV-CICS-MSG-AREA         05452104
054522         MOVE LENGTH OF PV-CICS-MSG-AREA TO PV-COMMAREA-LENGTH    05452204
054523                                                                  05452304
054524         EXEC CICS                                                05452404
054525             WRITEQ TD                                            05452504
054526                 QUEUE   ('CSSL')                                 05452604
054527                 FROM    (PV-CICS-MSG-AREA)                       05452704
054528                 LENGTH  (PV-COMMAREA-LENGTH)                     05452804
054529                 RESP    (PV-CICS-RESPONSE)                       05452904
054530         END-EXEC                                                 05453004
054531                                                                  05453104
054532         INITIALIZE  PV-CICS-MSG-AREA                             05453204
054533         SET  PS-SOCKET-ERROR        TO TRUE                      05453304
054534         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    05453404
054535         SET  DP081-TCP-IP-SEND-TO-ERR TO TRUE                    05453504
054536         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05453604
054537                                        SOCKET-ERRNO              05453704
054538         MOVE DP081-RETCODE          TO SOCKET-RETCODE            05453804
054539         MOVE PC133-HDR-PO-NBR       TO SOCKET-RECEIVER           05453904
054540         MOVE PC133-HDR-RCVR-SEQ     TO SOCKET-SEQ                05454004
054541         MOVE PC133-HDR-LINE-NBR     TO SOCKET-LINE               05454104
054542         MOVE 'SEE ERROR NO '        TO SOCKET-DESCR              05454204
054543                                                                  05454304
054544         MOVE SOCKET-SELECT-ERR      TO PV-CICS-MSG-AREA          05454404
054545         PERFORM 9999-WRITE-TO-CSSL                               05454504
054546                                                                  05454604
054547         INITIALIZE  PV-CICS-MSG-AREA                             05454704
054548         STRING ' PCKCS191 -'            DELIMITED BY SIZE        05454804
054549                ' PO-RCVR-LNE - '        DELIMITED BY SIZE        05454904
054550                PC126-PO-NBR             DELIMITED BY SIZE        05455004
054551                '-'                      DELIMITED BY SIZE        05455104
054552                PC126-RCVR-SEQ-NBR       DELIMITED BY SIZE        05455204
054553                '-'                      DELIMITED BY SIZE        05455304
054554                PC126-PO-LNE-NBR         DELIMITED BY SIZE        05455404
054555                '   DC - '               DELIMITED BY SIZE        05455504
054556                PC126-OPER-UNT-ID        DELIMITED BY SIZE        05455604
054557                '   PRTR ID - '          DELIMITED BY SIZE        05455704
054558                PC126-SHP-PRTR-ID        DELIMITED BY SIZE        05455804
054559                                     INTO PV-CICS-MSG-AREA        05455904
054560         PERFORM 9999-WRITE-TO-CSSL                               05456004
054561                                                                  05456104
054562         INITIALIZE  PV-CICS-MSG-AREA                             05456204
054563         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05456304
054564         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        05456404
054565         PERFORM 9999-WRITE-TO-CSSL                               05456504
054566                                                                  05456604
054567     END-IF.                                                      05456704
054568                                                                  05456804
054569* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05456904
054570* DMH - 10/06/04 - END                                            05457004
054571                                                                  05457104
054572                                                                  05457204
054573*----------------------------------------------------------------*05457304
054574*  RECEIVE CONFIRMATION BACK FROM LPMS PRINT MANAGEMENT SYSTEM   *05457404
054575*  THAT THEY RECEIVED ALL THE RECORDS CORRECTLY.                 *05457504
054576*----------------------------------------------------------------*05457604
054577 6100-RECEIVE-CONFIRM-FROM-LPMS.                                  05457704
054578                                                                  05457804
054579* DMH - 1/03/2005 - BEGIN                                         05457904
054580     IF   PS-DISPLAY-CSSL-YES                                     05458004
054581        INITIALIZE                       PV-CICS-MSG-AREA         05458104
054582        STRING ' PCKCS191- 6100-RECEIVE-CONFIRM-FROM-LPMS'        05458204
054583                                         DELIMITED BY SIZE        05458304
054584                                    INTO PV-CICS-MSG-AREA         05458404
054585        MOVE LENGTH OF PV-CICS-MSG-AREA                           05458504
054586                                      TO PV-COMMAREA-LENGTH       05458604
054587        EXEC CICS                                                 05458704
054588            WRITEQ TD                                             05458804
054589                QUEUE   ('CSSL')                                  05458904
054590                FROM    (PV-CICS-MSG-AREA)                        05459004
054591                LENGTH  (PV-COMMAREA-LENGTH)                      05459104
054592                RESP    (PV-CICS-RESP)                            05459204
054593        END-EXEC                                                  05459304
054594     END-IF.                                                      05459404
054595* DMH - 1/03/2005 - BEGIN                                         05459504
054596                                                                  05459604
054597     MOVE LOW-VALUES  TO  TCP-BUF2.                               05459704
054598     MOVE 50          TO  DP081-TCPLENG                           05459804
054599                          DP081-NBR-BYTES.                        05459904
054600                                                                  05460004
054601     SET  DP081-NO-FLAG  TO  TRUE.                                05460104
054602                                                                  05460204
054603     CALL 'EZASOKET'                                              05460304
054604         USING DP081-RECV-CMD                                     05460404
054605               DP081-SOCK-ID                                      05460504
054606               DP081-FLAG                                         05460604
054607               DP081-NBR-BYTES                                    05460704
054608               TCP-BUF                                            05460804
054609               DP081-ERRNO                                        05460904
054610               DP081-RETCODE.                                     05461004
054611                                                                  05461104
054612                                                                  05461204
054613*-----------------------------------------------------*           05461304
054614*                                                     *           05461404
054615*-----------------------------------------------------*           05461504
054616     CALL 'EZACIC05'                                              05461604
054617         USING DP081-TOEBCDIC-TOKEN                               05461704
054618               TCP-BUF                                            05461804
054619               DP081-TCPLENG.                                     05461904
054620                                                                  05462004
054621     IF  DP081-RETCODE < ZERO                                     05462104
054622         INITIALIZE  PV-CICS-MSG-AREA                             05462204
054623         SET  PS-SOCKET-ERROR         TO TRUE                     05462304
054624         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    05462404
054625         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      05462504
054626         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05462604
054627                                                                  05462704
054628         MOVE DP081-TCP-IP-LOGGING-MSG TO PV-CICS-MSG-AREA        05462804
054629         PERFORM 9999-WRITE-TO-CSSL                               05462904
054630                                                                  05463004
054631                                                                  05463104
054632     END-IF.                                                      05463204
054633                                                                  05463304
054634*-----------------------------------------------------*           05463404
054635*                                                     *           05463504
054636*-----------------------------------------------------*           05463604
054637     MOVE TCP-BUF TO PC133-LABEL-RECORD.                          05463704
054638                                                                  05463804
054639     IF  NOT PC133-SEND-SUCCESSFUL                                05463904
054640         INITIALIZE  PV-CICS-MSG-AREA                             05464004
054641         PERFORM 5340-CLOSE-SOCKET                                05464104
054642         MOVE PC-CURRENT-PROGRAM-NAME TO DP081-TCP-IP-PGM-NAME    05464204
054643         SET  PS-SOCKET-ERROR         TO TRUE                     05464304
054644         SET  DP081-TCP-IP-READ-ERR  TO TRUE                      05464404
054645         MOVE DP081-ERRNO            TO DP081-TCP-IP-ERR-NBR      05464504
054646                                        RECEIVE-ERRNO             05464604
054647         MOVE PC126-PO-NBR           TO RECEIVE-RECEIVER          05464704
054648         MOVE PC126-RCVR-SEQ-NBR     TO RECEIVE-SEQ               05464804
054649         MOVE PC126-PO-LNE-NBR       TO RECEIVE-LINE              05464904
054650                                                                  05465004
054660         MOVE RECEIVE-ERR            TO PV-CICS-MSG-AREA          05466004
054670         PERFORM 9999-WRITE-TO-CSSL                               05467004
054680         INITIALIZE  PV-CICS-MSG-AREA                             05468004
054690         STRING '  '                 DELIMITED BY SIZE            05469004
054700                PC133-LABEL-RECORD   DELIMITED BY SIZE            05470004
054710                                     INTO PV-CICS-MSG-AREA        05471004
054720         PERFORM 9999-WRITE-TO-CSSL                               05472004
054730                                                                  05473004
054740         INITIALIZE  PV-CICS-MSG-AREA                             05474004
054750         STRING ' PCKCS191 -'            DELIMITED BY SIZE        05475004
054760                ' PO-RCVR-LNE - '        DELIMITED BY SIZE        05476004
054770                PC126-PO-NBR             DELIMITED BY SIZE        05477004
054780                '-'                      DELIMITED BY SIZE        05478004
054790                PC126-RCVR-SEQ-NBR       DELIMITED BY SIZE        05479004
054800                '-'                      DELIMITED BY SIZE        05480004
054810                PC126-PO-LNE-NBR         DELIMITED BY SIZE        05481004
054820                '   DC - '               DELIMITED BY SIZE        05482004
054830                PC126-OPER-UNT-ID        DELIMITED BY SIZE        05483004
054840                '   PRTR ID - '          DELIMITED BY SIZE        05484004
054850                PC126-SHP-PRTR-ID        DELIMITED BY SIZE        05485004
054860                                     INTO PV-CICS-MSG-AREA        05486004
054870         PERFORM 9999-WRITE-TO-CSSL                               05487004
054880                                                                  05488004
054890         PERFORM 5350-GET-LPMS-RETURN                             05489004
054900                                                                  05490004
054910         EVALUATE TRUE                                            05491004
054920             WHEN  PC133-INVALID-PRINTER                          05492004
054930                   INITIALIZE  PV-CICS-MSG-AREA                   05493004
054940               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05494004
054950                 PC138-MSG-INVALID-PRTR       DELIMITED BY SIZE   05495004
054960                                          INTO PV-CICS-MSG-AREA   05496004
054970             WHEN  PC133-DTL-WITHOUT-HDR                          05497004
054980                   INITIALIZE  PV-CICS-MSG-AREA                   05498004
054990               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05499004
055000                 PC138-MSG-DTL-WO-HDR         DELIMITED BY SIZE   05500004
055010                                          INTO PV-CICS-MSG-AREA   05501004
055020             WHEN  PC133-TLR-WITHOUT-HDR-DTL                      05502004
055030                   INITIALIZE  PV-CICS-MSG-AREA                   05503004
055040               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05504004
055050                 PC138-MSG-TLR-WO-HDR-DTL     DELIMITED BY SIZE   05505004
055060                                          INTO PV-CICS-MSG-AREA   05506004
055070             WHEN  PC133-TLR-CNT-NOT-MTCH-DTL                     05507004
055080                   INITIALIZE  PV-CICS-MSG-AREA                   05508004
055090               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05509004
055100                 PC138-MSG-TLR-CNT-NOT-DTL    DELIMITED BY SIZE   05510004
055110                                          INTO PV-CICS-MSG-AREA   05511004
055120             WHEN  PC133-TRAN-IDS-NOT-MTCH                        05512004
055130                   INITIALIZE  PV-CICS-MSG-AREA                   05513004
055140               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05514004
055150                 PC138-MSG-TRAN-IDS-NOT-MTCH  DELIMITED BY SIZE   05515004
055160                                          INTO PV-CICS-MSG-AREA   05516004
055170             WHEN  PC133-DTL-LNGTH-NOT-MTCH                       05517004
055180                   INITIALIZE  PV-CICS-MSG-AREA                   05518004
055190               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05519004
055200                 PC138-MSG-DTL-LNGTH-NOT-MTCH DELIMITED BY SIZE   05520004
055210                                          INTO PV-CICS-MSG-AREA   05521004
055220             WHEN  PC133-DISK-ERROR                               05522004
055230                   INITIALIZE  PV-CICS-MSG-AREA                   05523004
055240               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05524004
055250                 PC138-MSG-DISK-ERROR         DELIMITED BY SIZE   05525004
055260                                          INTO PV-CICS-MSG-AREA   05526004
055270             WHEN  PC133-TIMEOUT                                  05527004
055280                   INITIALIZE  PV-CICS-MSG-AREA                   05528004
055290               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05529004
055300                 PC138-MSG-TIMEOUT            DELIMITED BY SIZE   05530004
055310                                          INTO PV-CICS-MSG-AREA   05531004
055320             WHEN  PC133-ADDR-NOT-FND                             05532004
055330                   INITIALIZE  PV-CICS-MSG-AREA                   05533004
055340               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05534004
055350                 PC138-MSG-ADDR-NOT-FND       DELIMITED BY SIZE   05535004
055360                                          INTO PV-CICS-MSG-AREA   05536004
055370             WHEN  PC133-INVALID-PACKET                           05537004
055380                   INITIALIZE  PV-CICS-MSG-AREA                   05538004
055390               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05539004
055400                 PC138-MSG-INVALID-PACKET     DELIMITED BY SIZE   05540004
055410                                          INTO PV-CICS-MSG-AREA   05541004
055420             WHEN  OTHER                                          05542004
055430                   INITIALIZE  PV-CICS-MSG-AREA                   05543004
055440               STRING ' PCKCS191 -'           DELIMITED BY SIZE   05544004
055450                'INVALID RETURN CODE-LPMS- '  DELIMITED BY SIZE   05545004
055460                 PC133-CONFIRM-CODE           DELIMITED BY SIZE   05546004
055470                                          INTO PV-CICS-MSG-AREA   05547004
055480         END-EVALUATE                                             05548004
055490         PERFORM 9999-WRITE-TO-CSSL                               05549004
055500                                                                  05550004
055510         INITIALIZE  PV-CICS-MSG-AREA                             05551004
055520         STRING ' PCKCS191 - '           DELIMITED BY SIZE        05552004
055530                DP081-TCP-IP-LOGGING-MSG DELIMITED BY SIZE        05553004
055540                                     INTO PV-CICS-MSG-AREA        05554004
055550         PERFORM 9999-WRITE-TO-CSSL                               05555004
055560     END-IF.                                                      05556004
055570                                                                  05557004
055580                                                                  05558004
055590 7000-OPEN-STORE-CSR.                                             05559004
055600                                                                  05560004
055610* DMH - 1/03/2005 - BEGIN                                         05561004
055620     IF   PS-DISPLAY-CSSL-YES                                     05562004
055630        INITIALIZE                       PV-CICS-MSG-AREA         05563004
055640        STRING ' PCKCS191- 7000-OPEN-STORE-CSR           '        05564004
055650                                         DELIMITED BY SIZE        05565004
055660                                    INTO PV-CICS-MSG-AREA         05566004
055670        MOVE LENGTH OF PV-CICS-MSG-AREA                           05567004
055680                                      TO PV-COMMAREA-LENGTH       05568004
055690        EXEC CICS                                                 05569004
055700            WRITEQ TD                                             05570004
055710                QUEUE   ('CSSL')                                  05571004
055720                FROM    (PV-CICS-MSG-AREA)                        05572004
055730                LENGTH  (PV-COMMAREA-LENGTH)                      05573004
055740                RESP    (PV-CICS-RESP)                            05574004
055750        END-EXEC                                                  05575004
055760     END-IF.                                                      05576004
055770* DMH - 1/03/2005 - BEGIN                                         05577004
055780                                                                  05578004
055790     IF  PC126-PRE-PACK-ORDER                                     05579004
055800         IF PC126-PRT-DOOR-SEQ                                    05580004
055810            EXEC SQL                                              05581004
055820                OPEN DOOR-PRPK-CSR                                05582004
055830            END-EXEC                                              05583004
055840         ELSE                                                     05584004
055850            EXEC SQL                                              05585004
055860                OPEN PREPK-STORE-CSR                              05586004
055870            END-EXEC                                              05587004
055880         END-IF                                                   05588004
055881     ELSE                                                         05588104
055882         IF PC126-PRT-DOOR-SEQ                                    05588204
055883            EXEC SQL                                              05588304
055884                OPEN DOOR-SEQ-CSR                                 05588404
055885            END-EXEC                                              05588504
055886         ELSE                                                     05588604
055887            EXEC SQL                                              05588704
055888                OPEN STORE-CSR                                    05588804
055889            END-EXEC                                              05588904
055890         END-IF                                                   05589004
055891     END-IF.                                                      05589104
055892                                                                  05589204
055893     EVALUATE TRUE                                                05589304
055894         WHEN SQLCODE = ZERO                                      05589404
055895             CONTINUE                                             05589504
055896                                                                  05589604
055897         WHEN SQLCODE = -904                                      05589704
055898         WHEN SQLCODE = -911                                      05589804
055899         WHEN SQLCODE = -913                                      05589904
055900             MOVE SQLCODE             TO PV-SQL-RETURN-CD         05590004
055901             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     05590104
055902                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     05590204
055903                                      INTO PC126-CRA-RET-MSG      05590304
055904             MOVE '01'                TO PC126-CRA-RET-CDE        05590404
055905             PERFORM 9000-RETURN-CALL                             05590504
055906                                                                  05590604
055907         WHEN SQLWARN0 NOT = SPACES                               05590704
055908         WHEN SQLCODE < ZERO                                      05590804
055909         WHEN SQLCODE > ZERO                                      05590904
055910             INITIALIZE  PV-CICS-MSG-AREA                         05591004
055920              MOVE SQLCODE             TO PV-SQL-RETURN-CD        05592004
055930              STRING ' PCKCS191 - '            DELIMITED BY SIZE  05593004
055940                     ' 7000-OPEN-STORE-CSR '   DELIMITED BY SIZE  05594004
055950                     '  sql - '                delimited by size  05595004
055960                     PV-SQL-RETURN-CD          delimited by size  05596004
055961                                           INTO PV-CICS-MSG-AREA  05596104
055962              MOVE LENGTH OF PV-CICS-MSG-AREA                     05596204
055963                     TO PV-COMMAREA-LENGTH                        05596304
055964              PERFORM 9999-WRITE-TO-CSSL                          05596404
055965              INITIALIZE  PV-CICS-MSG-AREA                        05596504
055966              STRING ' PCKCS191 -'             DELIMITED BY SIZE  05596604
055967                     ' PO:'                    DELIMITED BY SIZE  05596704
055968                     PC126-PO-NBR              DELIMITED BY SIZE  05596804
055969                     ' RCVR:'                  DELIMITED BY SIZE  05596904
055970                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  05597004
055980                     ' LINE:'                  DELIMITED BY SIZE  05598004
055990                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  05599004
056000                                           INTO PV-CICS-MSG-AREA  05600004
056010              MOVE LENGTH OF PV-CICS-MSG-AREA                     05601004
056020                     TO PV-COMMAREA-LENGTH                        05602004
056030              PERFORM 9999-WRITE-TO-CSSL                          05603004
056040                                                                  05604004
056050             STRING 'ERR FILE# SQL='                              05605004
056060                        DELIMITED BY SIZE                         05606004
056070                        PV-SQL-RETURN-CD                          05607004
056080                        DELIMITED BY SIZE                         05608004
056090                               INTO PC126-CRA-RET-MSG             05609004
056100             MOVE '02'                TO PC126-CRA-RET-CDE        05610004
056110             MOVE '7000-'             TO PC126-CRA-REQ-ID         05611004
056120             PERFORM 9000-RETURN-CALL                             05612004
056130                                                                  05613004
056140     END-EVALUATE.                                                05614004
056150                                                                  05615004
056160 7010-FETCH-STORE-CSR.                                            05616004
056170                                                                  05617004
056180* DMH - 1/03/2005 - BEGIN                                         05618004
056190     IF   PS-DISPLAY-CSSL-YES                                     05619004
056200        INITIALIZE                       PV-CICS-MSG-AREA         05620004
056210        STRING ' PCKCS191- 7010-FETCH-STORE-CSR          '        05621004
056220                                         DELIMITED BY SIZE        05622004
056230                                    INTO PV-CICS-MSG-AREA         05623004
056240        MOVE LENGTH OF PV-CICS-MSG-AREA                           05624004
056250                                      TO PV-COMMAREA-LENGTH       05625004
056260        EXEC CICS                                                 05626004
056270            WRITEQ TD                                             05627004
056280                QUEUE   ('CSSL')                                  05628004
056290                FROM    (PV-CICS-MSG-AREA)                        05629004
056300                LENGTH  (PV-COMMAREA-LENGTH)                      05630004
056310                RESP    (PV-CICS-RESP)                            05631004
056320        END-EXEC                                                  05632004
056330     END-IF.                                                      05633004
056340* DMH - 1/03/2005 - BEGIN                                         05634004
056350                                                                  05635004
056360     IF  PC126-PRE-PACK-ORDER                                     05636004
056370         IF PC126-PRT-DOOR-SEQ                                    05637004
056380            EXEC SQL                                              05638004
056390                FETCH DOOR-PRPK-CSR                               05639004
056400                INTO                                              05640004
056410                    :PV-TYPE-CODE                                 05641004
056420                ,   :DISTDT-STR-NBR                               05642004
056430                ,   :XLT00010-LOC-10-ABBR-NM                      05643004
056440                ,   :PV-DISTDT-UNT-QTY                            05644004
056450                ,   :DISTDT-ODD-CART-IND                          05645004
056460                ,   :CNDCDR-DOOR-LBL-SEQ-NBR                      05646004
056470                ,   :XLT00010-OPN-DTE                             05647004
056480            END-EXEC                                              05648004
056490         ELSE                                                     05649004
056500            EXEC SQL                                              05650004
056501                FETCH PREPK-STORE-CSR                             05650104
056502                INTO                                              05650204
056503                    :PV-TYPE-CODE                                 05650304
056504                ,   :DISTDT-STR-NBR                               05650404
056505                ,   :XLT00010-LOC-10-ABBR-NM                      05650504
056506                ,   :PV-DISTDT-UNT-QTY                            05650604
056507                ,   :DISTDT-ODD-CART-IND                          05650704
056508                ,   :XLT00010-OPN-DTE                             05650804
056509            END-EXEC                                              05650904
056510         END-IF                                                   05651004
056511     ELSE                                                         05651104
056512         IF PC126-PRT-DOOR-SEQ                                    05651204
056513            EXEC SQL                                              05651304
056514                FETCH DOOR-SEQ-CSR                                05651404
056515                INTO                                              05651504
056516                    :PV-TYPE-CODE                                 05651604
056517                ,   :DISTDT-STR-NBR                               05651704
056518                ,   :XLT00010-LOC-10-ABBR-NM                      05651804
056519                ,   :PV-DISTDT-UNT-QTY                            05651904
056520                ,   :DISTDT-ODD-CART-IND                          05652004
056530                ,   :CNDCDR-DOOR-LBL-SEQ-NBR                      05653004
056540                ,   :XLT00010-OPN-DTE                             05654004
056550            END-EXEC                                              05655004
056560         ELSE                                                     05656004
056570            EXEC SQL                                              05657004
056580                FETCH STORE-CSR                                   05658004
056590                INTO                                              05659004
056600                    :PV-TYPE-CODE                                 05660004
056610                ,   :DISTDT-STR-NBR                               05661004
056611                ,   :XLT00010-LOC-10-ABBR-NM                      05661104
056612                ,   :PV-DISTDT-UNT-QTY                            05661204
056613                ,   :DISTDT-ODD-CART-IND                          05661304
056614                ,   :XLT00010-OPN-DTE                             05661404
056615            END-EXEC                                              05661504
056616         END-IF                                                   05661604
056617     END-IF.                                                      05661704
056618                                                                  05661804
056619     EVALUATE TRUE                                                05661904
056620         WHEN SQLCODE = ZERO                                      05662004
056621             ADD +1                   TO PV-STORE-COUNTER         05662104
056622         WHEN SQLCODE = +100                                      05662204
056623             SET PS-EOF-DISTRO-CSR    TO TRUE                     05662304
056624                                                                  05662404
056625         WHEN SQLCODE = -904                                      05662504
056626         WHEN SQLCODE = -911                                      05662604
056627         WHEN SQLCODE = -913                                      05662704
056628             MOVE SQLCODE             TO PV-SQL-RETURN-CD         05662804
056629             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     05662904
056630                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     05663004
056640                                      INTO PC126-CRA-RET-MSG      05664004
056650             MOVE '03'                TO PC126-CRA-RET-CDE        05665004
056660             PERFORM 9000-RETURN-CALL                             05666004
056670                                                                  05667004
056680         WHEN SQLWARN0 NOT = SPACES                               05668004
056690         WHEN SQLCODE < ZERO                                      05669004
056700         WHEN SQLCODE > ZERO                                      05670004
056710              INITIALIZE  PV-CICS-MSG-AREA                        05671004
056720             MOVE SQLCODE             TO PV-SQL-RETURN-CD         05672004
056721              STRING ' PCKCS191 - '            DELIMITED BY SIZE  05672104
056722                     ' 7010-FETCH-STORE-CSR '  DELIMITED BY SIZE  05672204
056723                     '  sql - '                delimited by size  05672304
056724                     PV-SQL-RETURN-CD          delimited by size  05672404
056725                                           INTO PV-CICS-MSG-AREA  05672504
056726              MOVE LENGTH OF PV-CICS-MSG-AREA                     05672604
056727                     TO PV-COMMAREA-LENGTH                        05672704
056728              PERFORM 9999-WRITE-TO-CSSL                          05672804
056729              INITIALIZE  PV-CICS-MSG-AREA                        05672904
056730              STRING ' PCKCS191 -'             DELIMITED BY SIZE  05673004
056740                     ' PO:'                    DELIMITED BY SIZE  05674004
056750                     PC126-PO-NBR              DELIMITED BY SIZE  05675004
056760                     ' RCVR:'                  DELIMITED BY SIZE  05676004
056770                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  05677004
056780                     ' LINE:'                  DELIMITED BY SIZE  05678004
056790                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  05679004
056800                                           INTO PV-CICS-MSG-AREA  05680004
056810              MOVE LENGTH OF PV-CICS-MSG-AREA                     05681004
056820                     TO PV-COMMAREA-LENGTH                        05682004
056830              PERFORM 9999-WRITE-TO-CSSL                          05683004
056840                                                                  05684004
056850             STRING 'ERR FILE# SQL='                              05685004
056860                        DELIMITED BY SIZE                         05686004
056870                        PV-SQL-RETURN-CD                          05687004
056880                        DELIMITED BY SIZE                         05688004
056890                               INTO PC126-CRA-RET-MSG             05689004
056900             MOVE '02'                TO PC126-CRA-RET-CDE        05690004
056910             MOVE '7010-'             TO PC126-CRA-REQ-ID         05691004
056920             PERFORM 9000-RETURN-CALL                             05692004
056930                                                                  05693004
056940     END-EVALUATE.                                                05694004
056950                                                                  05695004
056960 7020-CLOSE-STORE-CSR.                                            05696004
056970                                                                  05697004
056980* DMH - 1/03/2005 - BEGIN                                         05698004
056990     IF   PS-DISPLAY-CSSL-YES                                     05699004
057000        INITIALIZE                       PV-CICS-MSG-AREA         05700004
057010        STRING ' PCKCS191- 7020-CLOSE-STORE-CSR          '        05701004
057020                                         DELIMITED BY SIZE        05702004
057030                                    INTO PV-CICS-MSG-AREA         05703004
057040        MOVE LENGTH OF PV-CICS-MSG-AREA                           05704004
057050                                      TO PV-COMMAREA-LENGTH       05705004
057060        EXEC CICS                                                 05706004
057070            WRITEQ TD                                             05707004
057080                QUEUE   ('CSSL')                                  05708004
057090                FROM    (PV-CICS-MSG-AREA)                        05709004
057100                LENGTH  (PV-COMMAREA-LENGTH)                      05710004
057110                RESP    (PV-CICS-RESP)                            05711004
057120        END-EXEC                                                  05712004
057130     END-IF.                                                      05713004
057140* DMH - 1/03/2005 - BEGIN                                         05714004
057150                                                                  05715004
057160     IF  PC126-PRE-PACK-ORDER                                     05716004
057170         IF PC126-PRT-DOOR-SEQ                                    05717004
057180            EXEC SQL                                              05718004
057190                CLOSE DOOR-PRPK-CSR                               05719004
057200            END-EXEC                                              05720004
057210         ELSE                                                     05721004
057220            EXEC SQL                                              05722004
057230                CLOSE PREPK-STORE-CSR                             05723004
057240            END-EXEC                                              05724004
057250         END-IF                                                   05725004
057260     ELSE                                                         05726004
057270         IF PC126-PRT-DOOR-SEQ                                    05727004
057280            EXEC SQL                                              05728004
057290                CLOSE DOOR-SEQ-CSR                                05729004
057300            END-EXEC                                              05730004
057310         ELSE                                                     05731004
057320            EXEC SQL                                              05732004
057330                CLOSE STORE-CSR                                   05733004
057340            END-EXEC                                              05734004
057350         END-IF                                                   05735004
057360     END-IF.                                                      05736004
057370                                                                  05737004
057371     EVALUATE TRUE                                                05737104
057372         WHEN SQLCODE = ZERO                                      05737204
057373             CONTINUE                                             05737304
057374                                                                  05737404
057375         WHEN SQLCODE = -904                                      05737504
057376         WHEN SQLCODE = -911                                      05737604
057377         WHEN SQLCODE = -913                                      05737704
057378             MOVE SQLCODE             TO PV-SQL-RETURN-CD         05737804
057379             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     05737904
057380                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     05738004
057381                                      INTO PC126-CRA-RET-MSG      05738104
057382             MOVE '05'                TO PC126-CRA-RET-CDE        05738204
057383             PERFORM 9000-RETURN-CALL                             05738304
057384                                                                  05738404
057385         WHEN SQLWARN0 NOT = SPACES                               05738504
057386         WHEN SQLCODE < ZERO                                      05738604
057387         WHEN SQLCODE > ZERO                                      05738704
057388              INITIALIZE  PV-CICS-MSG-AREA                        05738804
057389             MOVE SQLCODE             TO PV-SQL-RETURN-CD         05738904
057390              STRING ' PCKCS191 - '            DELIMITED BY SIZE  05739004
057391                     ' 7020-CLOSE-STORE-CSR '  DELIMITED BY SIZE  05739104
057392                     '  sql - '                delimited by size  05739204
057393                     PV-SQL-RETURN-CD          delimited by size  05739304
057394                                           INTO PV-CICS-MSG-AREA  05739404
057395              MOVE LENGTH OF PV-CICS-MSG-AREA                     05739504
057396                     TO PV-COMMAREA-LENGTH                        05739604
057397              PERFORM 9999-WRITE-TO-CSSL                          05739704
057398              INITIALIZE  PV-CICS-MSG-AREA                        05739804
057399              STRING ' PCKCS191 -'             DELIMITED BY SIZE  05739904
057400                     ' PO:'                    DELIMITED BY SIZE  05740004
057401                     PC126-PO-NBR              DELIMITED BY SIZE  05740104
057402                     ' RCVR:'                  DELIMITED BY SIZE  05740204
057403                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  05740304
057404                     ' LINE:'                  DELIMITED BY SIZE  05740404
057405                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  05740504
057406                                           INTO PV-CICS-MSG-AREA  05740604
057407              MOVE LENGTH OF PV-CICS-MSG-AREA                     05740704
057408                     TO PV-COMMAREA-LENGTH                        05740804
057409              PERFORM 9999-WRITE-TO-CSSL                          05740904
057410                                                                  05741004
057420             STRING 'ERR FILE# SQL='                              05742004
057430                        DELIMITED BY SIZE                         05743004
057440                        PV-SQL-RETURN-CD                          05744004
057450                        DELIMITED BY SIZE                         05745004
057460                               INTO PC126-CRA-RET-MSG             05746004
057470             MOVE '02'                TO PC126-CRA-RET-CDE        05747004
057480             MOVE '7020-'             TO PC126-CRA-REQ-ID         05748004
057490             PERFORM 9000-RETURN-CALL                             05749004
057500                                                                  05750004
057510     END-EVALUATE.                                                05751004
057520                                                                  05752004
057530                                                                  05753004
057540******************************************************************05754004
057550*                                                                *05755004
057560******************************************************************05756004
057570 7160-GET-MANIFEST-NBR.                                           05757004
057580                                                                  05758004
057590* DMH - 1/03/2005 - BEGIN                                         05759004
057600     IF   PS-DISPLAY-CSSL-YES                                     05760004
057610        INITIALIZE                       PV-CICS-MSG-AREA         05761004
057620        STRING ' PCKCS191- 7160-GET-MANIFEST-NBR         '        05762004
057630                                         DELIMITED BY SIZE        05763004
057640                                    INTO PV-CICS-MSG-AREA         05764004
057650        MOVE LENGTH OF PV-CICS-MSG-AREA                           05765004
057660                                      TO PV-COMMAREA-LENGTH       05766004
057670        EXEC CICS                                                 05767004
057680            WRITEQ TD                                             05768004
057690                QUEUE   ('CSSL')                                  05769004
057700                FROM    (PV-CICS-MSG-AREA)                        05770004
057710                LENGTH  (PV-COMMAREA-LENGTH)                      05771004
057720                RESP    (PV-CICS-RESP)                            05772004
057730        END-EXEC                                                  05773004
057740     END-IF.                                                      05774004
057750* DMH - 1/03/2005 - BEGIN                                         05775004
057760                                                                  05776004
057770     MOVE DK-STORE-NMBR                 TO  PC187-STR-NBR.        05777004
057780     MOVE PV-TOTAL-LABELS-FOR-STORE     TO  PC187-NO-OF-LBLS.     05778004
057790                                                                  05779004
057800     MOVE LENGTH OF PC187-COMMAREA-REC  TO  PV-COMMAREA-LENGTH.   05780004
057810                                                                  05781004
057820     EXEC CICS                                                    05782004
057830         LINK PROGRAM  (PC-MANIFEST-NBR-MODULE)                   05783004
057840              COMMAREA (PC187-COMMAREA-REC)                       05784004
057850              LENGTH   (PV-COMMAREA-LENGTH)                       05785004
057860              RESP     (PV-CICS-RESPONSE)                         05786004
057870     END-EXEC.                                                    05787004
057880                                                                  05788004
057890     EVALUATE TRUE                                                05789004
057900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 05790004
057910              IF  PC187-CRA-SUCCESSFUL                            05791004
057920                  MOVE  PC187-START-MFST-NBR                      05792004
057930                    TO  PT-MANIFEST-START (PT-DISTRO-IDX)         05793004
057940                  MOVE  PC187-END-MFST-NBR                        05794004
057950                    TO  PT-MANIFEST-END (PT-DISTRO-IDX)           05795004
057951              ELSE                                                05795104
057952                  INITIALIZE  PV-CICS-MSG-AREA                    05795204
057953                  MOVE SQLCODE             TO PV-SQL-RETURN-CD    05795304
057954                  STRING ' PCKCS191 - '         DELIMITED BY SIZE 05795404
057955                         '7160-GET-MANIFEST-NB' DELIMITED BY SIZE 05795504
057956                         ' RETURN MESSAGE - '   DELIMITED BY SIZE 05795604
057957                         PC187-CRA-RET-MSG      DELIMITED BY SIZE 05795704
057958                         '  PARA-'              DELIMITED BY SIZE 05795804
057959                         PC187-CRA-REQ-ID       DELIMITED BY SIZE 05795904
057960                                           INTO PV-CICS-MSG-AREA  05796004
057961                  MOVE LENGTH OF PV-CICS-MSG-AREA                 05796104
057962                         TO PV-COMMAREA-LENGTH                    05796204
057963                  PERFORM 9999-WRITE-TO-CSSL                      05796304
057964                  INITIALIZE  PV-CICS-MSG-AREA                    05796404
057965                  STRING ' PCKCS191 -'         DELIMITED BY SIZE  05796504
057966                         ' PO:'                DELIMITED BY SIZE  05796604
057967                         PC126-PO-NBR          DELIMITED BY SIZE  05796704
057968                         ' RCVR:'              DELIMITED BY SIZE  05796804
057969                         PC126-RCVR-SEQ-NBR    DELIMITED BY SIZE  05796904
057970                         ' LINE:'              DELIMITED BY SIZE  05797004
057980                         PC126-PO-LNE-NBR      DELIMITED BY SIZE  05798004
057990                         ' STR:'               DELIMITED BY SIZE  05799004
058000                         DK-STORE-NMBR         DELIMITED BY SIZE  05800004
058010                                           INTO PV-CICS-MSG-AREA  05801004
058020                  MOVE LENGTH OF PV-CICS-MSG-AREA                 05802004
058030                         TO PV-COMMAREA-LENGTH                    05803004
058040                  PERFORM 9999-WRITE-TO-CSSL                      05804004
058050                                                                  05805004
058060                 STRING 'ERR FILE# SQL='       DELIMITED BY SIZE  05806004
058070                        PV-SQL-RETURN-CD       DELIMITED BY SIZE  05807004
058080                                          INTO PC126-CRA-RET-MSG  05808004
058090                 MOVE '02'                  TO PC126-CRA-RET-CDE  05809004
058100                 MOVE '7160-'               TO PC126-CRA-REQ-ID   05810004
058110                 PERFORM 9000-RETURN-CALL                         05811004
058120                                                                  05812004
058130              END-IF                                              05813004
058140                                                                  05814004
058150         WHEN OTHER                                               05815004
058160              INITIALIZE  PV-CICS-MSG-AREA                        05816004
058170              MOVE SQLCODE             TO PV-SQL-RETURN-CD        05817004
058180              STRING ' PCKCS191 (OTHER) - ' DELIMITED BY SIZE     05818004
058190                     '7160-GET-MANIFEST-NB' DELIMITED BY SIZE     05819004
058200                     ' RETURN MESSAGE - '   DELIMITED BY SIZE     05820004
058210                     PC187-CRA-RET-MSG      DELIMITED BY SIZE     05821004
058220                     '  PARA-'              DELIMITED BY SIZE     05822004
058230                     PC187-CRA-REQ-ID       DELIMITED BY SIZE     05823004
058240                                       INTO PV-CICS-MSG-AREA      05824004
058250              MOVE LENGTH OF PV-CICS-MSG-AREA                     05825004
058260                     TO PV-COMMAREA-LENGTH                        05826004
058270              PERFORM 9999-WRITE-TO-CSSL                          05827004
058280              INITIALIZE  PV-CICS-MSG-AREA                        05828004
058290              STRING ' PCKCS191 -'         DELIMITED BY SIZE      05829004
058300                     ' PO:'                DELIMITED BY SIZE      05830004
058310                     PC126-PO-NBR          DELIMITED BY SIZE      05831004
058320                     ' RCVR:'              DELIMITED BY SIZE      05832004
058330                     PC126-RCVR-SEQ-NBR    DELIMITED BY SIZE      05833004
058340                     ' LINE:'              DELIMITED BY SIZE      05834004
058350                     PC126-PO-LNE-NBR      DELIMITED BY SIZE      05835004
058360                     ' STR:'               DELIMITED BY SIZE      05836004
058370                     DK-STORE-NMBR         DELIMITED BY SIZE      05837004
058380                                       INTO PV-CICS-MSG-AREA      05838004
058390              MOVE LENGTH OF PV-CICS-MSG-AREA                     05839004
058400                     TO PV-COMMAREA-LENGTH                        05840004
058410              PERFORM 9999-WRITE-TO-CSSL                          05841004
058420                                                                  05842004
058430             STRING 'ERR FILE# SQL='       DELIMITED BY SIZE      05843004
058440                    PV-SQL-RETURN-CD       DELIMITED BY SIZE      05844004
058450                                      INTO PC126-CRA-RET-MSG      05845004
058460             MOVE '02'                  TO PC126-CRA-RET-CDE      05846004
058470             MOVE '7160-'               TO PC126-CRA-REQ-ID       05847004
058480             PERFORM 9000-RETURN-CALL                             05848004
058490     END-EVALUATE.                                                05849004
058500                                                                  05850004
058510                                                                  05851004
058520******************************************************************05852004
058530*                                                                *05853004
058540******************************************************************05854004
058550 7170-GET-XLT-LOC-OTHER-INFO.                                     05855004
058560                                                                  05856004
058570* DMH - 1/03/2005 - BEGIN                                         05857004
058580     IF   PS-DISPLAY-CSSL-YES                                     05858004
058590        INITIALIZE                       PV-CICS-MSG-AREA         05859004
058600        STRING ' PCKCS191- 7170-GET-XLT-LOC-OTHER-INFO   '        05860004
058610                                         DELIMITED BY SIZE        05861004
058620                                    INTO PV-CICS-MSG-AREA         05862004
058630        MOVE LENGTH OF PV-CICS-MSG-AREA                           05863004
058640                                      TO PV-COMMAREA-LENGTH       05864004
058650        EXEC CICS                                                 05865004
058660            WRITEQ TD                                             05866004
058670                QUEUE   ('CSSL')                                  05867004
058680                FROM    (PV-CICS-MSG-AREA)                        05868004
058690                LENGTH  (PV-COMMAREA-LENGTH)                      05869004
058700                RESP    (PV-CICS-RESP)                            05870004
058710        END-EXEC                                                  05871004
058720     END-IF.                                                      05872004
058730* DMH - 1/03/2005 - BEGIN                                         05873004
058740                                                                  05874004
058750     EXEC SQL                                                     05875004
058760         SELECT                                                   05876004
058770             LOC_10_ABBR_NM                                       05877004
058780         ,   LOC_NBR                                              05878004
058790         INTO                                                     05879004
058800            :XLT00010-LOC-10-ABBR-NM                              05880004
058810         ,  :XLT00010-LOC-NBR                                     05881004
058820         FROM                                                     05882004
058830             XLT_LOC                                              05883004
058840        WHERE LOC_NBR    = :DK-STR-NBR                            05884004
058850     END-EXEC.                                                    05885004
058860                                                                  05886004
058870     EVALUATE TRUE                                                05887004
058880         WHEN SQLCODE = ZERO                                      05888004
058890             CONTINUE                                             05889004
058900                                                                  05890004
058910         WHEN SQLCODE = -904                                      05891004
058920         WHEN SQLCODE = -911                                      05892004
058930         WHEN SQLCODE = -913                                      05893004
058931             MOVE SQLCODE             TO PV-SQL-RETURN-CD         05893104
058932             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     05893204
058933                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     05893304
058934                                      INTO PC126-CRA-RET-MSG      05893404
058935             MOVE '09'                TO PC126-CRA-RET-CDE        05893504
058936             PERFORM 9000-RETURN-CALL                             05893604
058937                                                                  05893704
058938         WHEN SQLWARN0 NOT = SPACES                               05893804
058939         WHEN SQLCODE < ZERO                                      05893904
058940         WHEN SQLCODE > ZERO                                      05894004
058941              INITIALIZE  PV-CICS-MSG-AREA                        05894104
058942              MOVE SQLCODE             TO PV-SQL-RETURN-CD        05894204
058943              STRING ' PCKCS191 - '             DELIMITED BY SIZE 05894304
058944                     '7170-GET-XLT-LOC-OTHER-I' DELIMITED BY SIZE 05894404
058945                     '  SQL - '                 DELIMITED BY SIZE 05894504
058946                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 05894604
058947                                           INTO PV-CICS-MSG-AREA  05894704
058948              MOVE LENGTH OF PV-CICS-MSG-AREA                     05894804
058949                     TO PV-COMMAREA-LENGTH                        05894904
058950              PERFORM 9999-WRITE-TO-CSSL                          05895004
058960              INITIALIZE  PV-CICS-MSG-AREA                        05896004
058970              STRING ' PCKCS191 -'             DELIMITED BY SIZE  05897004
058980                     ' PO:'                    DELIMITED BY SIZE  05898004
058990                     PC126-PO-NBR              DELIMITED BY SIZE  05899004
059000                     ' RCVR:'                  DELIMITED BY SIZE  05900004
059100                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  05910004
059110                     ' LINE:'                  DELIMITED BY SIZE  05911004
059120                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  05912004
059130                     ' STR:'                   DELIMITED BY SIZE  05913004
059140                     DK-STORE-NMBR             DELIMITED BY SIZE  05914004
059150                                           INTO PV-CICS-MSG-AREA  05915004
059160              MOVE LENGTH OF PV-CICS-MSG-AREA                     05916004
059170                     TO PV-COMMAREA-LENGTH                        05917004
059180              PERFORM 9999-WRITE-TO-CSSL                          05918004
059190                                                                  05919004
059200             STRING 'ERR FILE# SQL='                              05920004
059210                        DELIMITED BY SIZE                         05921004
059220                        PV-SQL-RETURN-CD                          05922004
059230                        DELIMITED BY SIZE                         05923004
059240                               INTO PC126-CRA-RET-MSG             05924004
059250             MOVE '02'                TO PC126-CRA-RET-CDE        05925004
059260             MOVE '7110-'             TO PC126-CRA-REQ-ID         05926004
059270             PERFORM 9000-RETURN-CALL                             05927004
059280                                                                  05928004
059290     END-EVALUATE.                                                05929004
059300                                                                  05930004
059310                                                                  05931004
059320******************************************************************05932004
059330*                                                                *05933004
059340******************************************************************05934004
059350 7200-GET-AD-DATE.                                                05935004
059360                                                                  05936004
059370* DMH - 1/03/2005 - BEGIN                                         05937004
059380     IF   PS-DISPLAY-CSSL-YES                                     05938004
059390        INITIALIZE                       PV-CICS-MSG-AREA         05939004
059400        STRING ' PCKCS191- 7200-GET-AD-DATE              '        05940004
059410                                         DELIMITED BY SIZE        05941004
059420                                    INTO PV-CICS-MSG-AREA         05942004
059430        MOVE LENGTH OF PV-CICS-MSG-AREA                           05943004
059440                                      TO PV-COMMAREA-LENGTH       05944004
059450        EXEC CICS                                                 05945004
059460            WRITEQ TD                                             05946004
059470                QUEUE   ('CSSL')                                  05947004
059480                FROM    (PV-CICS-MSG-AREA)                        05948004
059490                LENGTH  (PV-COMMAREA-LENGTH)                      05949004
059500                RESP    (PV-CICS-RESP)                            05950004
059510        END-EXEC                                                  05951004
059520     END-IF.                                                      05952004
059530* DMH - 1/03/2005 - BEGIN                                         05953004
059540                                                                  05954004
059550     EXEC SQL                                                     05955004
059560          SELECT CHAR(AD_EVNT_DTE, USA)                           05956004
059570             ,   B.GP_QTY                                         05957004
059580             ,   B.GP_RTL_AMT                                     05958004
059590             ,   B.UNT_RTL_PR_AMT                                 05959004
059600          INTO :PV-WORK-DATE                                      05960004
059610             , :PURITM-GP-QTY                                     05961004
059620             , :PURITM-GP-RTL-AMT                                 05962004
059630             , :PURITM-UNT-RTL-PR-AMT                             05963004
059640          FROM  TRECITM A                                         05964004
059650              , TPURITM B                                         05965004
059660          WHERE A.ORD_NBR        = :DK-PO-NBR                     05966004
059661            AND A.REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               05966104
059662            AND A.ORD_LNE_NBR    = :DK-ORD-LNE-NBR                05966204
059663            AND A.VER_STATUS_CDE = 'A'                            05966304
059664                                                                  05966404
059665            AND A.ORD_NBR        = B.PO_NBR                       05966504
059666            AND A.PO_VER_NBR     = B.VER_NBR                      05966604
059667            AND A.ORD_LNE_NBR    = B.APP_PO_LNE_NBR               05966704
059668     END-EXEC                                                     05966804
059669                                                                  05966904
059670     EVALUATE TRUE                                                05967004
059671         WHEN SQLCODE = ZERO                                      05967104
059672              CONTINUE                                            05967204
059673         WHEN SQLCODE = +100                                      05967304
059674              MOVE '0001-01-01'       TO PURITM-AD-EVNT-DTE       05967404
059675         WHEN SQLCODE = -904                                      05967504
059676         WHEN SQLCODE = -911                                      05967604
059677         WHEN SQLCODE = -913                                      05967704
059678             MOVE SQLCODE             TO PV-SQL-RETURN-CD         05967804
059679             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     05967904
059680                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     05968004
059690                                      INTO PC126-CRA-RET-MSG      05969004
059700             MOVE '13'                TO PC126-CRA-RET-CDE        05970004
059710             PERFORM 9000-RETURN-CALL                             05971004
059720                                                                  05972004
059730         WHEN SQLWARN0 NOT = SPACES                               05973004
059740         WHEN SQLCODE < ZERO                                      05974004
059750         WHEN SQLCODE > ZERO                                      05975004
059760              INITIALIZE  PV-CICS-MSG-AREA                        05976004
059770              MOVE SQLCODE   TO PV-SQL-RETURN-CD                  05977004
059780              STRING ' PCKCS191 - '             DELIMITED BY SIZE 05978004
059790                     '7200-GET-AD-DATE        ' DELIMITED BY SIZE 05979004
059800                     '  SQL - '                 DELIMITED BY SIZE 05980004
059810                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 05981004
059820                                           INTO PV-CICS-MSG-AREA  05982004
059830              MOVE LENGTH OF PV-CICS-MSG-AREA                     05983004
059840                     TO PV-COMMAREA-LENGTH                        05984004
059850              PERFORM 9999-WRITE-TO-CSSL                          05985004
059860              INITIALIZE  PV-CICS-MSG-AREA                        05986004
059870              STRING ' PCKCS191 -'             DELIMITED BY SIZE  05987004
059880                     ' PO:'                    DELIMITED BY SIZE  05988004
059890                     PC126-PO-NBR              DELIMITED BY SIZE  05989004
059900                     ' RCVR:'                  DELIMITED BY SIZE  05990004
059910                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  05991004
059920                     ' LINE:'                  DELIMITED BY SIZE  05992004
059930                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  05993004
059940                                           INTO PV-CICS-MSG-AREA  05994004
059950              MOVE LENGTH OF PV-CICS-MSG-AREA                     05995004
059960                     TO PV-COMMAREA-LENGTH                        05996004
059970              PERFORM 9999-WRITE-TO-CSSL                          05997004
059980                                                                  05998004
059990              STRING '7200-GET-AD-DATE    '                       05999004
060000                     DELIMITED BY SIZE                            06000004
060010                     PV-SQL-RETURN-CD                             06001004
060020                     DELIMITED BY SIZE                            06002004
060030                            INTO PC126-CRA-RET-MSG                06003004
060040              MOVE '02'       TO PC126-CRA-RET-CDE                06004004
060050              MOVE '7200-'    TO PC126-CRA-REQ-ID                 06005004
060060             PERFORM 9000-RETURN-CALL                             06006004
060070     END-EVALUATE.                                                06007004
060080                                                                  06008004
060090                                                                  06009004
060100 7300-GET-VENDOR-NAME.                                            06010004
060110                                                                  06011004
060120* DMH - 1/03/2005 - BEGIN                                         06012004
060130     IF   PS-DISPLAY-CSSL-YES                                     06013004
060140        INITIALIZE                       PV-CICS-MSG-AREA         06014004
060150        STRING ' PCKCS191- 7300-GET-VENDOR-NAME          '        06015004
060160                                         DELIMITED BY SIZE        06016004
060170                                    INTO PV-CICS-MSG-AREA         06017004
060180        MOVE LENGTH OF PV-CICS-MSG-AREA                           06018004
060190                                      TO PV-COMMAREA-LENGTH       06019004
060200        EXEC CICS                                                 06020004
060210            WRITEQ TD                                             06021004
060220                QUEUE   ('CSSL')                                  06022004
060230                FROM    (PV-CICS-MSG-AREA)                        06023004
060240                LENGTH  (PV-COMMAREA-LENGTH)                      06024004
060250                RESP    (PV-CICS-RESP)                            06025004
060260        END-EXEC                                                  06026004
060270     END-IF.                                                      06027004
060280* DMH - 1/03/2005 - BEGIN                                         06028004
060290                                                                  06029004
060300     EXEC SQL                                                     06030004
060310         SELECT B.ENT_NAME_DESC                                   06031004
060320         INTO :ENTNME-ENT-NAME-DESC                               06032004
060330         FROM  TPURCHS A                                          06033004
060340             , TENTNME B                                          06034004
060350     WHERE A.PO_NBR         = :DK-PO-NBR                          06035004
060360       AND A.VER_STATUS_CDE = 'A'                                 06036004
060370       AND A.ENT_ID         = B.ENT_ID                            06037004
060380       AND B.TYPE_CDE       = '01'                                06038004
060390     END-EXEC                                                     06039004
060400                                                                  06040004
060401                                                                  06040104
060402     EVALUATE TRUE                                                06040204
060403         WHEN SQLCODE = ZERO                                      06040304
060404              CONTINUE                                            06040404
060405         WHEN SQLCODE = +100                                      06040504
060406              MOVE 'UNKNOWN'          TO ENTNME-ENT-NAME-DESC     06040604
060407         WHEN SQLCODE = -904                                      06040704
060408         WHEN SQLCODE = -911                                      06040804
060409         WHEN SQLCODE = -913                                      06040904
060410             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06041004
060411             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     06041104
060412                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     06041204
060413                                      INTO PC126-CRA-RET-MSG      06041304
060414             MOVE '15'                TO PC126-CRA-RET-CDE        06041404
060415             PERFORM 9000-RETURN-CALL                             06041504
060416                                                                  06041604
060417         WHEN SQLWARN0 NOT = SPACES                               06041704
060418         WHEN SQLCODE < ZERO                                      06041804
060419         WHEN SQLCODE > ZERO                                      06041904
060420              INITIALIZE PV-CICS-MSG-AREA                         06042004
060430              MOVE SQLCODE   TO PV-SQL-RETURN-CD                  06043004
060440              STRING ' PCKCS191 - '             DELIMITED BY SIZE 06044004
060450                     '7300-GET-VENDOR-NAME    ' DELIMITED BY SIZE 06045004
060460                     '  SQL - '                 DELIMITED BY SIZE 06046004
060470                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 06047004
060480                                           INTO PV-CICS-MSG-AREA  06048004
060490              MOVE LENGTH OF PV-CICS-MSG-AREA                     06049004
060500                     TO PV-COMMAREA-LENGTH                        06050004
060510              PERFORM 9999-WRITE-TO-CSSL                          06051004
060520              INITIALIZE PV-CICS-MSG-AREA                         06052004
060530              STRING ' PCKCS191 -'             DELIMITED BY SIZE  06053004
060540                     ' PO:'                    DELIMITED BY SIZE  06054004
060550                     PC126-PO-NBR              DELIMITED BY SIZE  06055004
060560                     ' RCVR:'                  DELIMITED BY SIZE  06056004
060570                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  06057004
060580                     ' LINE:'                  DELIMITED BY SIZE  06058004
060590                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  06059004
060600                                           INTO PV-CICS-MSG-AREA  06060004
060610              MOVE LENGTH OF PV-CICS-MSG-AREA                     06061004
060620                     TO PV-COMMAREA-LENGTH                        06062004
060630              PERFORM 9999-WRITE-TO-CSSL                          06063004
060640                                                                  06064004
060650              STRING '7300-GET-VENDOR-NAME '                      06065004
060660                     DELIMITED BY SIZE                            06066004
060670                     PV-SQL-RETURN-CD                             06067004
060680                     DELIMITED BY SIZE                            06068004
060690                            INTO PC126-CRA-RET-MSG                06069004
060700              MOVE '02'       TO PC126-CRA-RET-CDE                06070004
060710              MOVE '7300-'    TO PC126-CRA-REQ-ID                 06071004
060720             PERFORM 9000-RETURN-CALL                             06072004
060730     END-EVALUATE.                                                06073004
060740/                                                                 06074004
060750 7400-SELECT-P2L-MOD.                                             06075004
060760                                                                  06076004
060770* DMH - 1/03/2005 - BEGIN                                         06077004
060780     IF   PS-DISPLAY-CSSL-YES                                     06078004
060790        INITIALIZE                       PV-CICS-MSG-AREA         06079004
060800        STRING ' PCKCS191- 7400-SELECT-P2L-MOD           '        06080004
060810                                         DELIMITED BY SIZE        06081004
060820                                    INTO PV-CICS-MSG-AREA         06082004
060830        MOVE LENGTH OF PV-CICS-MSG-AREA                           06083004
060840                                      TO PV-COMMAREA-LENGTH       06084004
060850        EXEC CICS                                                 06085004
060860            WRITEQ TD                                             06086004
060870                QUEUE   ('CSSL')                                  06087004
060880                FROM    (PV-CICS-MSG-AREA)                        06088004
060890                LENGTH  (PV-COMMAREA-LENGTH)                      06089004
060900                RESP    (PV-CICS-RESP)                            06090004
060910        END-EXEC                                                  06091004
060920     END-IF.                                                      06092004
060930* DMH - 1/03/2005 - BEGIN                                         06093004
060940                                                                  06094004
060950     EXEC SQL                                                     06095004
060960         SELECT                                                   06096004
060970         MODU_NBR                                                 06097004
060980     ,   MODU_DESC                                                06098004
060990     ,   DIVERT_CDE                                               06099004
061000     INTO                                                         06100004
061010         :P2LMOD-MODU-NBR                                         06101004
061020     ,   :P2LMOD-MODU-DESC                                        06102004
061030     ,   :P2LMOD-DIVERT-CDE                                       06103004
061040     FROM                                                         06104004
061041         TP2LMOD                                                  06104104
061042     WHERE                                                        06104204
061043         OPER_UNT_ID   = :DK-OPER-UNT-ID                          06104304
061044     AND MODU_NBR      = :DK-MOD-NBR                              06104404
061045     END-EXEC.                                                    06104504
061046                                                                  06104604
061047     EVALUATE TRUE                                                06104704
061048         WHEN SQLCODE = ZERO                                      06104804
061049              CONTINUE                                            06104904
061050         WHEN SQLCODE = +100                                      06105004
061051             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06105104
061052             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     06105204
061053                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     06105304
061054                                      INTO PC126-CRA-RET-MSG      06105404
061055             MOVE '17'                TO PC126-CRA-RET-CDE        06105504
061056             PERFORM 9000-RETURN-CALL                             06105604
061057                                                                  06105704
061058         WHEN SQLCODE = -904                                      06105804
061059         WHEN SQLCODE = -911                                      06105904
061060         WHEN SQLCODE = -913                                      06106004
061061             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06106104
061062             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     06106204
061063                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     06106304
061064                                      INTO PC126-CRA-RET-MSG      06106404
061065             MOVE '18'                TO PC126-CRA-RET-CDE        06106504
061066             PERFORM 9000-RETURN-CALL                             06106604
061067                                                                  06106704
061068         WHEN SQLWARN0 NOT = SPACES                               06106804
061069         WHEN SQLCODE < ZERO                                      06106904
061070         WHEN SQLCODE > ZERO                                      06107004
061080             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06108004
061090              INITIALIZE PV-CICS-MSG-AREA                         06109004
061100              STRING ' PCKCS191 - '             DELIMITED BY SIZE 06110004
061110                     '7400-SELECT-P2L-MOD.    ' DELIMITED BY SIZE 06111004
061120                     '  SQL - '                 DELIMITED BY SIZE 06112004
061130                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 06113004
061140                                           INTO PV-CICS-MSG-AREA  06114004
061150              MOVE LENGTH OF PV-CICS-MSG-AREA                     06115004
061160                     TO PV-COMMAREA-LENGTH                        06116004
061170              PERFORM 9999-WRITE-TO-CSSL                          06117004
061180              INITIALIZE PV-CICS-MSG-AREA                         06118004
061190              STRING ' PCKCS191 -'             DELIMITED BY SIZE  06119004
061200                     ' PO:'                    DELIMITED BY SIZE  06120004
061210                     PC126-PO-NBR              DELIMITED BY SIZE  06121004
061220                     ' RCVR:'                  DELIMITED BY SIZE  06122004
061230                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  06123004
061240                     ' LINE:'                  DELIMITED BY SIZE  06124004
061250                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  06125004
061260                                           INTO PV-CICS-MSG-AREA  06126004
061270              MOVE LENGTH OF PV-CICS-MSG-AREA                     06127004
061280                     TO PV-COMMAREA-LENGTH                        06128004
061290              PERFORM 9999-WRITE-TO-CSSL                          06129004
061300                                                                  06130004
061310              STRING '7400-SELECT-P2L-MOD'                        06131004
061320                     DELIMITED BY SIZE                            06132004
061330                     PV-SQL-RETURN-CD                             06133004
061340                     DELIMITED BY SIZE                            06134004
061350                            INTO PC126-CRA-RET-MSG                06135004
061360              MOVE '02'       TO PC126-CRA-RET-CDE                06136004
061370              MOVE '7400-'    TO PC126-CRA-REQ-ID                 06137004
061380             PERFORM 9000-RETURN-CALL                             06138004
061390     END-EVALUATE.                                                06139004
061400/                                                                 06140004
061410 7600-SELECT-FILE-NBR-ROW.                                        06141004
061420                                                                  06142004
061430* DMH - 1/03/2005 - BEGIN                                         06143004
061440     IF   PS-DISPLAY-CSSL-YES                                     06144004
061450        INITIALIZE                       PV-CICS-MSG-AREA         06145004
061460        STRING ' PCKCS191- 7600-SELECT-FILE-NBR-ROW      '        06146004
061470                                         DELIMITED BY SIZE        06147004
061480                                    INTO PV-CICS-MSG-AREA         06148004
061490        MOVE LENGTH OF PV-CICS-MSG-AREA                           06149004
061500                                      TO PV-COMMAREA-LENGTH       06150004
061510        EXEC CICS                                                 06151004
061520            WRITEQ TD                                             06152004
061530                QUEUE   ('CSSL')                                  06153004
061540                FROM    (PV-CICS-MSG-AREA)                        06154004
061550                LENGTH  (PV-COMMAREA-LENGTH)                      06155004
061560                RESP    (PV-CICS-RESP)                            06156004
061570        END-EXEC                                                  06157004
061580     END-IF.                                                      06158004
061590* DMH - 1/03/2005 - BEGIN                                         06159004
061600                                                                  06160004
061610*----------------------------------------------------------------*06161004
061620*  GET THE PC FILE ID NUMBER.                                    *06162004
061630*----------------------------------------------------------------*06163004
061640                                                                  06164004
061650     EXEC SQL                                                     06165004
061660         SELECT CNTL_CDE                                          06166004
061670               ,REF_CDE                                           06167004
061680               ,LBL_SEQ_NBR                                       06168004
061690         INTO :PCLABL-CNTL-CDE                                    06169004
061700             ,:PCLABL-REF-CDE                                     06170004
061710             ,:PCLABL-LBL-SEQ-NBR                                 06171004
061720         FROM TPCLABL                                             06172004
061730         WHERE LBL_TYP_CDE = 'K '                                 06173004
061740     END-EXEC                                                     06174004
061750                                                                  06175004
061760     EVALUATE TRUE                                                06176004
061770         WHEN SQLCODE = ZERO                                      06177004
061780             MOVE PCLABL-CNTL-CDE     TO PV-PC-CNTL-CDE           06178004
061781             MOVE PCLABL-REF-CDE      TO PV-OBN-WAIT-TIME         06178104
061782             MOVE PCLABL-LBL-SEQ-NBR  TO PV-LBL-SEQ-NBR           06178204
061783                                                                  06178304
061784         WHEN SQLCODE = -904                                      06178404
061785         WHEN SQLCODE = -911                                      06178504
061786         WHEN SQLCODE = -913                                      06178604
061787             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06178704
061788             STRING 'PARA 7600- SQL= '                            06178804
061789                     PV-SQL-RETURN-CD        DELIMITED BY SIZE    06178904
061790                                      INTO PC126-CRA-RET-MSG      06179004
061791             MOVE '20'                TO PC126-CRA-RET-CDE        06179104
061792             PERFORM 9000-RETURN-CALL                             06179204
061793                                                                  06179304
061794         WHEN SQLWARN0 NOT = SPACES                               06179404
061795         WHEN SQLCODE < ZERO                                      06179504
061796         WHEN SQLCODE > ZERO                                      06179604
061797              INITIALIZE PV-CICS-MSG-AREA                         06179704
061798             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06179804
061799              STRING ' PCKCS191 - '             DELIMITED BY SIZE 06179904
061800                     '7600-SELECT-FILE-NBR-ROW' DELIMITED BY SIZE 06180004
061810                     '  SQL - '                 DELIMITED BY SIZE 06181004
061820                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 06182004
061830                                           INTO PV-CICS-MSG-AREA  06183004
061840              MOVE LENGTH OF PV-CICS-MSG-AREA                     06184004
061850                     TO PV-COMMAREA-LENGTH                        06185004
061860              PERFORM 9999-WRITE-TO-CSSL                          06186004
061870              INITIALIZE PV-CICS-MSG-AREA                         06187004
061880              STRING ' PCKCS191 -'             DELIMITED BY SIZE  06188004
061890                     ' PO:'                    DELIMITED BY SIZE  06189004
061900                     PC126-PO-NBR              DELIMITED BY SIZE  06190004
061910                     ' RCVR:'                  DELIMITED BY SIZE  06191004
061920                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  06192004
061930                     ' LINE:'                  DELIMITED BY SIZE  06193004
061940                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  06194004
061950                                           INTO PV-CICS-MSG-AREA  06195004
061960              MOVE LENGTH OF PV-CICS-MSG-AREA                     06196004
061970                     TO PV-COMMAREA-LENGTH                        06197004
061980              PERFORM 9999-WRITE-TO-CSSL                          06198004
061990                                                                  06199004
062000             STRING 'PARA 7600- SQL= '                            06200004
062010                        DELIMITED BY SIZE                         06201004
062020                        PV-SQL-RETURN-CD                          06202004
062030                        DELIMITED BY SIZE                         06203004
062040                                      INTO PC126-CRA-RET-MSG      06204004
062050             MOVE '02'                TO PC126-CRA-RET-CDE        06205004
062060             MOVE '7600-'             TO PC126-CRA-REQ-ID         06206004
062070             PERFORM 9000-RETURN-CALL                             06207004
062080                                                                  06208004
062090     END-EVALUATE.                                                06209004
062100/                                                                 06210004
062110 7700-UPDATE-FILE-NBR-ROW.                                        06211004
062120                                                                  06212004
062130* DMH - 1/03/2005 - BEGIN                                         06213004
062140     IF   PS-DISPLAY-CSSL-YES                                     06214004
062150        INITIALIZE                       PV-CICS-MSG-AREA         06215004
062160        STRING ' PCKCS191- 7700-UPDATE-FILE-NBR-ROW      '        06216004
062170                                         DELIMITED BY SIZE        06217004
062180                                    INTO PV-CICS-MSG-AREA         06218004
062190        MOVE LENGTH OF PV-CICS-MSG-AREA                           06219004
062200                                      TO PV-COMMAREA-LENGTH       06220004
062210        EXEC CICS                                                 06221004
062220            WRITEQ TD                                             06222004
062230                QUEUE   ('CSSL')                                  06223004
062240                FROM    (PV-CICS-MSG-AREA)                        06224004
062250                LENGTH  (PV-COMMAREA-LENGTH)                      06225004
062260                RESP    (PV-CICS-RESP)                            06226004
062270        END-EXEC                                                  06227004
062280     END-IF.                                                      06228004
062290* DMH - 1/03/2005 - BEGIN                                         06229004
062300                                                                  06230004
062310*----------------------------------------------------------------*06231004
062320*  ADD THE NUMBER OF LABELS TO THE LABEL SEQUENCE NUMBER ON THE  *06232004
062330*  PC LABEL TABLE.  THE NUMBER OF LABELS WILL BE COMPUTED AS     *06233004
062340*  FOLLOWS:                                                      *06234004
062350*     (NBR OF STORES / 2) + 1 (TO ALLOW FOR REQUEST HEADER)      *06235004
062360*     IF THE NBR OF STORES IS NOT EVENLY DIVISIBLE, ADD 1 TO     *06236004
062370*     THE NUMBER OF LABELS.                                      *06237004
062380*  THERE ARE 2 STORE REQUESTS PER FILE BEING SENT DOWN TO THE    *06238004
062390*  PC.  ANY EXTRA STORES THAT ARE LEFT OVER AFTER THIS DIVISION  *06239004
062400*  ARE BEING SENT IN THEIR OWN FILE.                             *06240004
062410*  ALSO ADD 1 TO THE CONTROL CODE ON THE PC LABEL TABLE TO       *06241004
062420*  UPDATE THE LAST REQUEST NUMBER USED.                          *06242004
062430*  PIGGYBACK LABELS ARE SENT TO THE PC IN MULTIPLE FILES.       * 06243004
062440*  4BY4 LABELS ARE SENT IN ONE FILE                             * 06244004
062450*----------------------------------------------------------------*06245004
062484                                                                  06248404
062485     ADD 1 TO PV-PC-CNTL-CDE                                      06248504
062486*             PV-NBR-OF-LABELS.                                   06248604
062487                                                                  06248704
062488         EXEC SQL                                                 06248804
062489             UPDATE TPCLABL                                       06248904
062490                SET CNTL_CDE    = :PV-PC-CNTL-CDE-X               06249004
062500                  , LBL_SEQ_NBR = LBL_SEQ_NBR + :PV-NBR-OF-LABELS 06250004
062510              WHERE LBL_TYP_CDE = 'K '                            06251004
062520         END-EXEC                                                 06252004
062530                                                                  06253004
062540         EVALUATE TRUE                                            06254004
062550             WHEN SQLCODE = ZERO                                  06255004
062560                 CONTINUE                                         06256004
062570             WHEN SQLWARN0 NOT = SPACES                           06257004
062580             WHEN SQLCODE < ZERO                                  06258004
062590             WHEN SQLCODE > ZERO                                  06259004
062600                 MOVE SQLCODE   TO PV-SQL-RETURN-CD               06260004
062610              INITIALIZE PV-CICS-MSG-AREA                         06261004
062620              STRING ' PCKCS191 - '             DELIMITED BY SIZE 06262004
062630                     '7700-UPDATE-FILE-NBR-ROW' DELIMITED BY SIZE 06263004
062640                     '  SQL - '                 DELIMITED BY SIZE 06264004
062650                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 06265004
062660                                           INTO PV-CICS-MSG-AREA  06266004
062670              MOVE LENGTH OF PV-CICS-MSG-AREA                     06267004
062680                     TO PV-COMMAREA-LENGTH                        06268004
062690              PERFORM 9999-WRITE-TO-CSSL                          06269004
062700              INITIALIZE PV-CICS-MSG-AREA                         06270004
062710              STRING ' PCKCS191 -'             DELIMITED BY SIZE  06271004
062720                     ' PO:'                    DELIMITED BY SIZE  06272004
062730                     PC126-PO-NBR              DELIMITED BY SIZE  06273004
062740                     ' RCVR:'                  DELIMITED BY SIZE  06274004
062750                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  06275004
062760                     ' LINE:'                  DELIMITED BY SIZE  06276004
062770                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  06277004
062780                                           INTO PV-CICS-MSG-AREA  06278004
062790              MOVE LENGTH OF PV-CICS-MSG-AREA                     06279004
062800                     TO PV-COMMAREA-LENGTH                        06280004
062810              PERFORM 9999-WRITE-TO-CSSL                          06281004
062820                                                                  06282004
062830                 STRING 'ERR FILE# SQL='     DELIMITED BY SIZE    06283004
062840                        PV-SQL-RETURN-CD     DELIMITED BY SIZE    06284004
062850                               INTO PC126-CRA-RET-MSG             06285004
062860                 MOVE '02'       TO PC126-CRA-RET-CDE             06286004
062870                 MOVE '7700-'    TO PC126-CRA-REQ-ID              06287004
062880                 PERFORM 9000-RETURN-CALL                         06288004
062890     END-EVALUATE.                                                06289004
062900                                                                  06290043
066790                                                                  06679004
066800 7930-SELECT-TCOCNTL.                                             06680004
066810                                                                  06681004
066820* DMH - 1/03/2005 - BEGIN                                         06682004
066830     IF   PS-DISPLAY-CSSL-YES                                     06683004
066840        INITIALIZE                       PV-CICS-MSG-AREA         06684004
066850        STRING ' PCKCS191- 7930-SELECT-TCOCNTL           '        06685004
066860                                         DELIMITED BY SIZE        06686004
066870                                    INTO PV-CICS-MSG-AREA         06687004
066880        MOVE LENGTH OF PV-CICS-MSG-AREA                           06688004
066890                                      TO PV-COMMAREA-LENGTH       06689004
066900        EXEC CICS                                                 06690004
066910            WRITEQ TD                                             06691004
066920                QUEUE   ('CSSL')                                  06692004
066930                FROM    (PV-CICS-MSG-AREA)                        06693004
066940                LENGTH  (PV-COMMAREA-LENGTH)                      06694004
066950                RESP    (PV-CICS-RESP)                            06695004
066960        END-EXEC                                                  06696004
066970     END-IF.                                                      06697004
066980* DMH - 1/03/2005 - BEGIN                                         06698004
066990                                                                  06699004
067000     EXEC SQL                                                     06700004
067010         SELECT  DFLT_CNSTK_LBL_QTY                               06701004
067020           INTO  :COCNTL-DFLT-CNSTK-LBL-QTY                       06702004
067030           FROM  TCOCNTL                                          06703004
067040          WHERE  OPER_UNT_ID = :DK-OPER-UNT-ID                    06704004
067050            AND  FCLTY_ID    = 1                                  06705004
067060     END-EXEC.                                                    06706004
067070                                                                  06707004
067080     EVALUATE TRUE                                                06708004
067090         WHEN SQLCODE = ZERO                                      06709004
067100             CONTINUE                                             06710004
067101                                                                  06710104
067102         WHEN SQLCODE = -904                                      06710204
067103         WHEN SQLCODE = -911                                      06710304
067104         WHEN SQLCODE = -913                                      06710404
067105             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06710504
067106             STRING 'PARA 7930- SQL= '                            06710604
067107                     PV-SQL-RETURN-CD        DELIMITED BY SIZE    06710704
067108                                      INTO PC126-CRA-RET-MSG      06710804
067109             MOVE '34'                TO PC126-CRA-RET-CDE        06710904
067110             PERFORM 9000-RETURN-CALL                             06711004
067111                                                                  06711104
067112         WHEN SQLWARN0 NOT = SPACES                               06711204
067113         WHEN SQLCODE < ZERO                                      06711304
067114         WHEN SQLCODE > ZERO                                      06711404
067115             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06711504
067116              INITIALIZE PV-CICS-MSG-AREA                         06711604
067117              STRING ' PCKCS191 - '             DELIMITED BY SIZE 06711704
067118                     '7930-SELECT-TCOCNTL     ' DELIMITED BY SIZE 06711804
067119                     '  SQL - '                 DELIMITED BY SIZE 06711904
067120                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 06712004
067130                                           INTO PV-CICS-MSG-AREA  06713004
067140              MOVE LENGTH OF PV-CICS-MSG-AREA                     06714004
067150                     TO PV-COMMAREA-LENGTH                        06715004
067160              PERFORM 9999-WRITE-TO-CSSL                          06716004
067170              INITIALIZE PV-CICS-MSG-AREA                         06717004
067180              STRING ' PCKCS191 -'             DELIMITED BY SIZE  06718004
067190                     ' PO:'                    DELIMITED BY SIZE  06719004
067200                     PC126-PO-NBR              DELIMITED BY SIZE  06720004
067210                     ' RCVR:'                  DELIMITED BY SIZE  06721004
067220                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  06722004
067230                     ' LINE:'                  DELIMITED BY SIZE  06723004
067240                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  06724004
067250                                           INTO PV-CICS-MSG-AREA  06725004
067260              MOVE LENGTH OF PV-CICS-MSG-AREA                     06726004
067270                     TO PV-COMMAREA-LENGTH                        06727004
067280              PERFORM 9999-WRITE-TO-CSSL                          06728004
067290                                                                  06729004
067300             STRING 'PARA 7930- SQL= '                            06730004
067310                        DELIMITED BY SIZE                         06731004
067320                        PV-SQL-RETURN-CD                          06732004
067330                        DELIMITED BY SIZE                         06733004
067340                                      INTO PC126-CRA-RET-MSG      06734004
067350             MOVE '02'                TO PC126-CRA-RET-CDE        06735004
067360             MOVE '7930-'             TO PC126-CRA-REQ-ID         06736004
067370             PERFORM 9000-RETURN-CALL                             06737004
067380     END-EVALUATE.                                                06738004
067390                                                                  06739004
067400 7935-GET-STORE-TYPE.                                             06740004
067410                                                                  06741004
067420* DMH - 1/03/2005 - BEGIN                                         06742004
067430     IF   PS-DISPLAY-CSSL-YES                                     06743004
067440        INITIALIZE                       PV-CICS-MSG-AREA         06744004
067450        STRING ' PCKCS191- 7935-GET-STORE-TYPE           '        06745004
067460                                         DELIMITED BY SIZE        06746004
067470                                    INTO PV-CICS-MSG-AREA         06747004
067480        MOVE LENGTH OF PV-CICS-MSG-AREA                           06748004
067490                                      TO PV-COMMAREA-LENGTH       06749004
067500        EXEC CICS                                                 06750004
067510            WRITEQ TD                                             06751004
067520                QUEUE   ('CSSL')                                  06752004
067530                FROM    (PV-CICS-MSG-AREA)                        06753004
067540                LENGTH  (PV-COMMAREA-LENGTH)                      06754004
067550                RESP    (PV-CICS-RESP)                            06755004
067560        END-EXEC                                                  06756004
067570     END-IF.                                                      06757004
067580* DMH - 1/03/2005 - BEGIN                                         06758004
067590                                                                  06759004
067600     EXEC SQL                                                     06760004
067610         SELECT                                                   06761004
067620           CASE                                                   06762004
067630             WHEN LOC_TYP_CDE = 'DC' THEN 'A'                     06763004
067640             WHEN LOC_TYP_CDE = 'RV' THEN 'B'                     06764004
067650             WHEN LOC_TYP_CDE = 'CS' THEN 'C'                     06765004
067660             WHEN LOC_TYP_CDE = 'DS'                              06766004
067670                  AND E_BUS_IND  = 'Y'                            06767004
067680                                   THEN 'D'                       06768004
067690             WHEN LOC_TYP_CDE = 'DS'                              06769004
067691                  AND E_BUS_IND  = 'N'                            06769104
067692                                   THEN 'F'                       06769204
067693           ELSE 'Z'                                               06769304
067694           END                                                    06769404
067695             INTO :PV-TYPE-CODE                                   06769504
067696         FROM                                                     06769604
067697             XLT_LOC                                              06769704
067698         WHERE                                                    06769804
067699             LOC_NBR    = :DK-STR-NBR                             06769904
067700     END-EXEC.                                                    06770004
067701                                                                  06770104
067702     EVALUATE TRUE                                                06770204
067703         WHEN SQLCODE = ZERO                                      06770304
067704             CONTINUE                                             06770404
067705                                                                  06770504
067706         WHEN SQLCODE = -904                                      06770604
067707         WHEN SQLCODE = -911                                      06770704
067708         WHEN SQLCODE = -913                                      06770804
067709             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06770904
067710             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     06771004
067711                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     06771104
067712                                      INTO PC126-CRA-RET-MSG      06771204
067713             MOVE '36'                TO PC126-CRA-RET-CDE        06771304
067714             PERFORM 9000-RETURN-CALL                             06771404
067715                                                                  06771504
067716         WHEN SQLWARN0 NOT = SPACES                               06771604
067717         WHEN SQLCODE < ZERO                                      06771704
067718         WHEN SQLCODE > ZERO                                      06771804
067719              INITIALIZE PV-CICS-MSG-AREA                         06771904
067720             MOVE SQLCODE             TO PV-SQL-RETURN-CD         06772004
067730              STRING ' PCKCS191 - '             DELIMITED BY SIZE 06773004
067740                     '7935-GET-STORE-TYPE     ' DELIMITED BY SIZE 06774004
067750                     '  SQL - '                 DELIMITED BY SIZE 06775004
067760                     PV-SQL-RETURN-CD           DELIMITED BY SIZE 06776004
067770                                           INTO PV-CICS-MSG-AREA  06777004
067780              MOVE LENGTH OF PV-CICS-MSG-AREA                     06778004
067790                     TO PV-COMMAREA-LENGTH                        06779004
067800              PERFORM 9999-WRITE-TO-CSSL                          06780004
067900              INITIALIZE PV-CICS-MSG-AREA                         06790004
067910              STRING ' PCKCS191 -'             DELIMITED BY SIZE  06791004
067920                     ' PO:'                    DELIMITED BY SIZE  06792004
067930                     PC126-PO-NBR              DELIMITED BY SIZE  06793004
067940                     ' RCVR:'                  DELIMITED BY SIZE  06794004
067950                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  06795004
067960                     ' LINE:'                  DELIMITED BY SIZE  06796004
067970                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  06797004
067980                     ' STR:'                   DELIMITED BY SIZE  06798004
067990                     DK-STORE-NMBR             DELIMITED BY SIZE  06799004
068000                                           INTO PV-CICS-MSG-AREA  06800004
068010              MOVE LENGTH OF PV-CICS-MSG-AREA                     06801004
068020                     TO PV-COMMAREA-LENGTH                        06802004
068030              PERFORM 9999-WRITE-TO-CSSL                          06803004
068040                                                                  06804004
068050             STRING 'ERR FILE# SQL='                              06805004
068060                        DELIMITED BY SIZE                         06806004
068070                        PV-SQL-RETURN-CD                          06807004
068080                        DELIMITED BY SIZE                         06808004
068090                               INTO PC126-CRA-RET-MSG             06809004
068100             MOVE '02'                TO PC126-CRA-RET-CDE        06810004
068110             MOVE '7935-'             TO PC126-CRA-REQ-ID         06811004
068120             PERFORM 9000-RETURN-CALL                             06812004
068130                                                                  06813004
068140     END-EVALUATE.                                                06814004
068150/                                                                 06815004
068160                                                                  06816004
068170/                                                                 06817004
068180 8000-FORMAT-AND-PRINT.                                           06818004
068190                                                                  06819004
068200* DMH - 1/03/2005 - BEGIN                                         06820004
068210     IF   PS-DISPLAY-CSSL-YES                                     06821004
068220        MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                        06822004
068230          TO PV-DISPLAY-STORE                                     06823004
068240          MOVE PV-DISTRO-SUM  TO  PV-DISTRO-SUM-DISPLAY           06824004
068250          SET  PV-DISTRO-IDX-DISPLAY TO PT-DISTRO-IDX             06825004
068260        INITIALIZE                       PV-CICS-MSG-AREA         06826004
068270        STRING ' PCKCS191- 8000-FORMAT-AND-PRINT '                06827004
068280               ' STORE=' PV-DISPLAY-STORE                         06828004
068290               '  TYPE=' PT-TYPE-CODE (PT-DISTRO-IDX)             06829004
068300               '  ODD=' PT-ODD-CART-IND (PT-DISTRO-IDX)           06830004
068310               '  SUM=' PV-DISTRO-SUM-DISPLAY                     06831004
068320               '  IDX=' PV-DISTRO-IDX-DISPLAY                     06832004
068330                                         DELIMITED BY SIZE        06833004
068340                                    INTO PV-CICS-MSG-AREA         06834004
068350        MOVE LENGTH OF PV-CICS-MSG-AREA                           06835004
068360                                      TO PV-COMMAREA-LENGTH       06836004
068370        EXEC CICS                                                 06837004
068380            WRITEQ TD                                             06838004
068390                QUEUE   ('CSSL')                                  06839004
068400                FROM    (PV-CICS-MSG-AREA)                        06840004
068410                LENGTH  (PV-COMMAREA-LENGTH)                      06841004
068420                RESP    (PV-CICS-RESP)                            06842004
068430        END-EXEC                                                  06843004
068440     END-IF.                                                      06844004
068450* DMH - 1/03/2005 - BEGIN                                         06845004
068460                                                                  06846004
068470     IF PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR                 06847004
068480        PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES                    06848004
068481         SET PT-DISTRO-IDX            TO 1                        06848104
068482         IF PC126-PRT-SHUFFLED                                    06848204
068483             IF PS-PRINT-FCSE-LABELS                              06848304
068484                 IF PS-FIRST-PASS                                 06848404
068485                     SET PS-NOT-FIRST-PASS TO TRUE                06848504
068486                                                                  06848604
068487                                                                  06848704
068488*  SHUFFLE SEQUENCE NOTE:                                         06848804
068489* AFTER EACH STORE HAS BEEN GIVEN 1 CASE, CALCULATE AN AVERAGE    06848904
068490* BASED ON THE NUMBER OF CASES THAT REMAIN AND THE NUMBER         06849004
068491* OF STORES THAT STILL NEED CASES.  A NEW SEQUENCE QTY IS         06849104
068492* DERIVED FROM THIS AVERAGE.  OVERRIDE THE ORIGINAL SEQUENCE      06849204
068493* QTY WITH THE NEW ONE FOR THE REST OF THE DISTRIBUTION.          06849304
068494* THE PROCEDURE FOR INNER PACK QTYS DIFFERS FROM THE FULLCASE     06849404
068495* LOGIC ONLY IN THE NUMBER USED TO CALCULATE THE AVERAGE.         06849504
068496* THESE ROUTINES WILL SPEED UP THE PRINTING BY INCREASING         06849604
068497* THE NUMBER OF COPIES THAT CAN BE PRINTED FOR A STORE.           06849704
068498                                                                  06849804
068499                     PERFORM 8000A-CALC-SHUFFLE-AVG               06849904
068500                     PERFORM 8000B-ADJUST-SHUFFLE-QTYS            06850004
068501                 ELSE                                             06850104
068502                     PERFORM 8000B-ADJUST-SHUFFLE-QTYS            06850204
068503                 END-IF                                           06850304
068504             ELSE                                                 06850404
068505                 IF PS-FIRST-PASS                                 06850504
068506                     SET PS-NOT-FIRST-PASS TO TRUE                06850604
068507                     PERFORM 8000C-CALC-SHUFFLE-AVG-INPK          06850704
068508                     PERFORM 8000D-ADJUST-SHUFFLE-QTYS-INPK       06850804
068509                 ELSE                                             06850904
068510                     PERFORM 8000D-ADJUST-SHUFFLE-QTYS-INPK       06851004
068511                 END-IF                                           06851104
068512             END-IF                                               06851204
068513         END-IF                                                   06851304
068514     END-IF.                                                      06851404
068515                                                                  06851504
068516     EVALUATE TRUE                                                06851604
068517     WHEN PS-PRINT-FCSE-LABELS                                    06851704
068518         IF PT-FCSE-LABELS-NEEDED(PT-DISTRO-IDX) > ZERO           06851804
068519             PERFORM 8010-CREATE-LABEL                            06851904
068539         END-IF                                                   06853904
068540     WHEN PS-PRINT-INPK-LABELS                                    06854004
068541         IF PT-INPK-LABELS-NEEDED(PT-DISTRO-IDX) > ZERO           06854104
068550             PERFORM 8010-CREATE-LABEL                            06855004
068560         END-IF                                                   06856004
068570     END-EVALUATE.                                                06857004
068580                                                                  06858004
068590 8000A-CALC-SHUFFLE-AVG.                                          06859004
068600                                                                  06860004
068610* DMH - 1/03/2005 - BEGIN                                         06861004
068620     IF   PS-DISPLAY-CSSL-YES                                     06862004
068630        INITIALIZE                       PV-CICS-MSG-AREA         06863004
068640        STRING ' PCKCS191- 8000A-CALC-SHUFFLE-AVG        '        06864004
068650                                         DELIMITED BY SIZE        06865004
068660                                    INTO PV-CICS-MSG-AREA         06866004
068670        MOVE LENGTH OF PV-CICS-MSG-AREA                           06867004
068680                                      TO PV-COMMAREA-LENGTH       06868004
068690        EXEC CICS                                                 06869004
068700            WRITEQ TD                                             06870004
068710                QUEUE   ('CSSL')                                  06871004
068720                FROM    (PV-CICS-MSG-AREA)                        06872004
068730                LENGTH  (PV-COMMAREA-LENGTH)                      06873004
068740                RESP    (PV-CICS-RESP)                            06874004
068750        END-EXEC                                                  06875004
068760     END-IF.                                                      06876004
068770* DMH - 1/03/2005 - BEGIN                                         06877004
068780                                                                  06878004
068790     PERFORM VARYING PT-SHUFFLE-IDX FROM 1 BY 1                   06879004
068800              UNTIL PT-STR-NBR (PT-SHUFFLE-IDX) = ZERO            06880004
068810              OR PT-SHUFFLE-IDX > 1000                            06881004
068820              OR PT-SHUFFLE-IDX > PV-PT-LABEL-TABLE-ENTRIES       06882004
068830         ADD PT-FCSE-LABELS-NEEDED(PT-SHUFFLE-IDX)                06883004
068840                                      TO PV-SHUFFLE-SUM           06884004
068850         ADD 1                        TO PV-NBR-OF-STRS           06885004
068860     END-PERFORM.                                                 06886004
068870                                                                  06887004
068880     COMPUTE PV-SHUFFLE-AVG = PV-SHUFFLE-SUM / PV-NBR-OF-STRS.    06888004
068890                                                                  06889004
068900     EVALUATE TRUE                                                06890004
068910     WHEN PV-SHUFFLE-AVG  < 4                                     06891004
068920         MOVE 1                       TO PV-NEW-LABEL-SEQ-QTY     06892004
068930     WHEN PV-SHUFFLE-AVG  < 9                                     06893004
068940         MOVE 2                       TO PV-NEW-LABEL-SEQ-QTY     06894004
068950     WHEN PV-SHUFFLE-AVG  < 16                                    06895004
068960         MOVE 3                       TO PV-NEW-LABEL-SEQ-QTY     06896004
068961     WHEN PV-SHUFFLE-AVG  < 25                                    06896104
068962         MOVE 4                       TO PV-NEW-LABEL-SEQ-QTY     06896204
068963     WHEN OTHER                                                   06896304
068964         MOVE 5                       TO PV-NEW-LABEL-SEQ-QTY     06896404
068965     END-EVALUATE.                                                06896504
068966                                                                  06896604
068967 8000B-ADJUST-SHUFFLE-QTYS.                                       06896704
068968                                                                  06896804
068969* DMH - 1/03/2005 - BEGIN                                         06896904
068970     IF   PS-DISPLAY-CSSL-YES                                     06897004
068971        INITIALIZE                       PV-CICS-MSG-AREA         06897104
068972        STRING ' PCKCS191- 8000B-ADJUST-SHUFFLE-QTYS     '        06897204
068973                                         DELIMITED BY SIZE        06897304
068974                                    INTO PV-CICS-MSG-AREA         06897404
068975        MOVE LENGTH OF PV-CICS-MSG-AREA                           06897504
068976                                      TO PV-COMMAREA-LENGTH       06897604
068977        EXEC CICS                                                 06897704
068978            WRITEQ TD                                             06897804
068979                QUEUE   ('CSSL')                                  06897904
068980                FROM    (PV-CICS-MSG-AREA)                        06898004
068990                LENGTH  (PV-COMMAREA-LENGTH)                      06899004
069000                RESP    (PV-CICS-RESP)                            06900004
069010        END-EXEC                                                  06901004
069020     END-IF.                                                      06902004
069030* DMH - 1/03/2005 - BEGIN                                         06903004
069040                                                                  06904004
069050     PERFORM VARYING PT-SHUFFLE-IDX FROM 1 BY 1                   06905004
069060              UNTIL PT-STR-NBR (PT-SHUFFLE-IDX) = ZERO            06906004
069070              OR PT-SHUFFLE-IDX > 1000                            06907004
069080              OR PT-SHUFFLE-IDX > PV-PT-LABEL-TABLE-ENTRIES       06908004
069090         IF PV-NEW-LABEL-SEQ-QTY >                                06909004
069100                     PT-FCSE-LABELS-NEEDED(PT-SHUFFLE-IDX)        06910004
069110             MOVE PT-FCSE-LABELS-NEEDED(PT-SHUFFLE-IDX)           06911004
069120                                      TO PT-FCSE-LABEL-SEQ-QTY    06912004
069130                                             (PT-SHUFFLE-IDX)     06913004
069140         ELSE                                                     06914004
069150         MOVE PV-NEW-LABEL-SEQ-QTY    TO PT-FCSE-LABEL-SEQ-QTY    06915004
069160                                             (PT-SHUFFLE-IDX)     06916004
069170         END-IF                                                   06917004
069180     END-PERFORM.                                                 06918004
069190                                                                  06919004
069200 8000C-CALC-SHUFFLE-AVG-INPK.                                     06920004
069210                                                                  06921004
069211* DMH - 1/03/2005 - BEGIN                                         06921104
069212     IF   PS-DISPLAY-CSSL-YES                                     06921204
069213        INITIALIZE                       PV-CICS-MSG-AREA         06921304
069214        STRING ' PCKCS191- 8000C-CALC-SHUFFLE-AVG-INPK   '        06921404
069215                                         DELIMITED BY SIZE        06921504
069216                                    INTO PV-CICS-MSG-AREA         06921604
069217        MOVE LENGTH OF PV-CICS-MSG-AREA                           06921704
069218                                      TO PV-COMMAREA-LENGTH       06921804
069219        EXEC CICS                                                 06921904
069220            WRITEQ TD                                             06922004
069221                QUEUE   ('CSSL')                                  06922104
069222                FROM    (PV-CICS-MSG-AREA)                        06922204
069223                LENGTH  (PV-COMMAREA-LENGTH)                      06922304
069224                RESP    (PV-CICS-RESP)                            06922404
069225        END-EXEC                                                  06922504
069226     END-IF.                                                      06922604
069227* DMH - 1/03/2005 - BEGIN                                         06922704
069228                                                                  06922804
069229     PERFORM VARYING PT-SHUFFLE-IDX FROM 1 BY 1                   06922904
069230              UNTIL PT-STR-NBR (PT-SHUFFLE-IDX) = ZERO            06923004
069240              OR PT-SHUFFLE-IDX > 1000                            06924004
069250              OR PT-SHUFFLE-IDX > PV-PT-LABEL-TABLE-ENTRIES       06925004
069260         ADD PT-INPK-LABELS-NEEDED(PT-SHUFFLE-IDX)                06926004
069270                                      TO PV-SHUFFLE-SUM           06927004
069280         ADD 1                        TO PV-NBR-OF-STRS           06928004
069290     END-PERFORM.                                                 06929004
069300                                                                  06930004
069310     COMPUTE PV-SHUFFLE-AVG = PV-SHUFFLE-SUM / PV-NBR-OF-STRS.    06931004
069320                                                                  06932004
069330     EVALUATE TRUE                                                06933004
069340     WHEN PV-SHUFFLE-AVG  < 4                                     06934004
069350         MOVE 1                       TO PV-NEW-LABEL-SEQ-QTY     06935004
069360     WHEN PV-SHUFFLE-AVG  < 9                                     06936004
069361         MOVE 2                       TO PV-NEW-LABEL-SEQ-QTY     06936104
069362     WHEN PV-SHUFFLE-AVG  < 16                                    06936204
069363         MOVE 3                       TO PV-NEW-LABEL-SEQ-QTY     06936304
069364     WHEN PV-SHUFFLE-AVG  < 25                                    06936404
069365         MOVE 4                       TO PV-NEW-LABEL-SEQ-QTY     06936504
069366     WHEN OTHER                                                   06936604
069367         MOVE 5                       TO PV-NEW-LABEL-SEQ-QTY     06936704
069368     END-EVALUATE.                                                06936804
069369                                                                  06936904
069370 8000D-ADJUST-SHUFFLE-QTYS-INPK.                                  06937004
069371                                                                  06937104
069372* DMH - 1/03/2005 - BEGIN                                         06937204
069373     IF   PS-DISPLAY-CSSL-YES                                     06937304
069374        INITIALIZE                       PV-CICS-MSG-AREA         06937404
069375        STRING ' PCKCS191- 8000D-ADJUST-SHUFFLE-QTYS-INPK'        06937504
069376                                         DELIMITED BY SIZE        06937604
069377                                    INTO PV-CICS-MSG-AREA         06937704
069378        MOVE LENGTH OF PV-CICS-MSG-AREA                           06937804
069379                                      TO PV-COMMAREA-LENGTH       06937904
069380        EXEC CICS                                                 06938004
069390            WRITEQ TD                                             06939004
069400                QUEUE   ('CSSL')                                  06940004
069410                FROM    (PV-CICS-MSG-AREA)                        06941004
069420                LENGTH  (PV-COMMAREA-LENGTH)                      06942004
069430                RESP    (PV-CICS-RESP)                            06943004
069440        END-EXEC                                                  06944004
069450     END-IF.                                                      06945004
069460* DMH - 1/03/2005 - BEGIN                                         06946004
069470                                                                  06947004
069480     PERFORM VARYING PT-SHUFFLE-IDX FROM 1 BY 1                   06948004
069490              UNTIL PT-STR-NBR (PT-SHUFFLE-IDX) = ZERO            06949004
069500              OR PT-SHUFFLE-IDX > 1000                            06950004
069510              OR PT-SHUFFLE-IDX > PV-PT-LABEL-TABLE-ENTRIES       06951004
069520         IF PV-NEW-LABEL-SEQ-QTY >                                06952004
069530                     PT-INPK-LABELS-NEEDED(PT-SHUFFLE-IDX)        06953004
069540             MOVE PT-INPK-LABELS-NEEDED(PT-SHUFFLE-IDX)           06954004
069550                                      TO PT-INPK-LABEL-SEQ-QTY    06955004
069560                                             (PT-SHUFFLE-IDX)     06956004
069570         ELSE                                                     06957004
069580         MOVE PV-NEW-LABEL-SEQ-QTY    TO PT-INPK-LABEL-SEQ-QTY    06958004
069590                                             (PT-SHUFFLE-IDX)     06959004
069600         END-IF                                                   06960004
069610     END-PERFORM.                                                 06961004
069611                                                                  06961104
069612 8005-PRINT-FORM-LAYOUT.                                          06961204
069613                                                                  06961304
069614* DMH - 1/03/2005 - BEGIN                                         06961404
069615     IF   PS-DISPLAY-CSSL-YES                                     06961504
069616        INITIALIZE                       PV-CICS-MSG-AREA         06961604
069617        STRING ' PCKCS191- 8005-PRINT-FORM-LAYOUT        '        06961704
069618                                         DELIMITED BY SIZE        06961804
069619                                    INTO PV-CICS-MSG-AREA         06961904
069620        MOVE LENGTH OF PV-CICS-MSG-AREA                           06962004
069621                                      TO PV-COMMAREA-LENGTH       06962104
069622        EXEC CICS                                                 06962204
069623            WRITEQ TD                                             06962304
069624                QUEUE   ('CSSL')                                  06962404
069625                FROM    (PV-CICS-MSG-AREA)                        06962504
069626                LENGTH  (PV-COMMAREA-LENGTH)                      06962604
069627                RESP    (PV-CICS-RESP)                            06962704
069628        END-EXEC                                                  06962804
069629     END-IF.                                                      06962904
069630* DMH - 1/03/2005 - BEGIN                                         06963004
069640                                                                  06964004
069650     MOVE '@@@@@'                     TO PC158-CRTN-HDG.          06965004
069660     SET  PC253-FORM-OF               TO TRUE.                    06966004
069670     MOVE PC158-FORM-OF               TO PC158-LABEL-CNT.         06967004
069680                                                                  06968004
069690     IF PS-PRINT-INPK-LABELS                                      06969004
069700         IF PS-CS-OVERRIDE                                        06970004
069710             SUBTRACT PV-ORIG-CS-QTY-INPK                         06971004
069720                            FROM PC126-INPK-LBL-CNT               06972004
069730             ADD PV-CS-TOT-CTNS-INPK  TO PC126-INPK-LBL-CNT       06973004
069740             MOVE PC126-INPK-LBL-CNT  TO PC253-TOT-LBL-CNT        06974004
069750                                         PC158-TOT-LBL-CNT        06975004
069760             MOVE PC126-INPK-UNT-QTY  TO PC253-PACK-UNT           06976004
069770                                         PC158-PACK-UNT           06977004
069771             IF PC126-PREPK-RATIO > 0                             06977104
069772                DIVIDE PC126-INPK-UNT-QTY                         06977204
069773                    BY PC126-PREPK-RATIO                          06977304
069774                GIVING PV-PC126-PACKS-IN-CRTN                     06977404
069775             ELSE                                                 06977504
069776                MOVE ZEROES TO PV-PC126-PACKS-IN-CRTN             06977604
069777             END-IF                                               06977704
069778             IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO  AND             06977804
069779                 PC126-ODD-CRTN-USE-INPK          AND             06977904
069780                 PS-ODD-CART-INPK-LBL-NOT-PRT                     06978004
069781                 MOVE PC126-ODD-CRTN-UNT-QTY TO PC158-PACK-UNT    06978104
069782             END-IF                                               06978204
069783         ELSE                                                     06978304
069784             MOVE PC126-INPK-LBL-CNT  TO PC253-TOT-LBL-CNT        06978404
069785                                         PC158-TOT-LBL-CNT        06978504
069786             MOVE PC126-INPK-UNT-QTY  TO PC253-PACK-UNT           06978604
069787                                         PC158-PACK-UNT           06978704
069788             IF PC126-PREPK-RATIO > 0                             06978804
069789                DIVIDE PC126-INPK-UNT-QTY                         06978904
069790                    BY PC126-PREPK-RATIO                          06979004
069800                GIVING PV-PC126-PACKS-IN-CRTN                     06980004
069810             ELSE                                                 06981004
069820                MOVE ZEROES TO PV-PC126-PACKS-IN-CRTN             06982004
069830             END-IF                                               06983004
069840             IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO  AND             06984004
069850                 PC126-ODD-CRTN-USE-INPK          AND             06985004
069860                 PS-ODD-CART-INPK-LBL-NOT-PRT                     06986004
069870                 MOVE PC126-ODD-CRTN-UNT-QTY TO PC253-PACK-UNT    06987004
069880                                                PC158-PACK-UNT    06988004
069890                 SET  PC253-FORM-ODD-CRTN-BOX TO TRUE             06989004
069900                 SET  PC253-FORM-ODD-CRTN-FLD TO TRUE             06990004
069910                 MOVE PC158-FORM-ODD-CRTN-BOX                     06991004
069920                                      TO PC158-ODD-CARTON-BOX     06992004
069930                 MOVE PC158-FORM-ODD-CRTN-FLD                     06993004
069940                                      TO PC158-ODD-CARTON-FIELD   06994004
069950             ELSE                                                 06995004
069960                 MOVE PC126-PACKS-IN-CRTN                         06996004
069970                                      TO PV-PC126-PACKS-IN-CRTN   06997004
069980                 SET  PC253-FORM-NO-ODD-BOX                       06998004
069990                                      TO TRUE                     06999004
070000                 SET  PC253-FORM-NO-ODD-FLD                       07000004
070010                                      TO TRUE                     07001004
070020                 MOVE PC158-FORM-NO-ODD-BOX                       07002004
070030                                      TO PC158-ODD-CARTON-BOX     07003004
070040                 MOVE PC158-FORM-NO-ODD-FLD                       07004004
070050                                      TO PC158-ODD-CARTON-FIELD   07005004
070060             END-IF                                               07006004
070070         END-IF                                                   07007004
070080     ELSE                                                         07008004
070090         IF PS-CS-OVERRIDE                                        07009004
070100* 10/16/00 - BEGIN                                                07010004
070110             SUBTRACT PV-ORIG-CS-QTY-FCSE                         07011004
070120                 FROM PC126-FCSE-LBL-CNT                          07012004
070130               GIVING PV-ADJUSTED-LBL-QTY                         07013004
070140             ADD PV-CS-TOT-CTNS-FCSE  TO PV-ADJUSTED-LBL-QTY      07014004
070150* 10/16/00 - END                                                  07015004
070160             MOVE PV-ADJUSTED-LBL-QTY TO PC158-TOT-LBL-CNT        07016004
070170                                         PC253-TOT-LBL-CNT        07017004
070180             MOVE PC158-FORM-NO-INPK-BOX                          07018004
070190                                      TO PC158-INPK-CONVY-BOX     07019004
070200             SET  PC253-FORM-NO-INPK-BOX TO TRUE                  07020004
070210             MOVE PC158-FORM-OTPK-HDG                             07021004
070220                                      TO PC158-INPK-CONVY-TEXT    07022004
070230             SET  PC253-FORM-OTPK-HDG TO TRUE                     07023004
070240             IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO  AND             07024004
070250                 PC126-ODD-CRTN-USE-FCSE          AND             07025004
070260                 PS-ODD-CART-FCSE-LBL-NOT-PRT                     07026004
070270                 MOVE PC126-ODD-CRTN-UNT-QTY TO PC158-PACK-UNT    07027004
070280                                                PC253-PACK-UNT    07028004
070290                                                PC158-PACK-UNT    07029004
070300                 IF PC126-PREPK-RATIO > 0                         07030004
070310                    DIVIDE PC126-ODD-CRTN-UNT-QTY                 07031004
070320                        BY PC126-PREPK-RATIO                      07032004
070330                    GIVING PV-PC126-PACKS-IN-CRTN                 07033004
070340                 ELSE                                             07034004
070350                    MOVE ZEROES TO PV-PC126-PACKS-IN-CRTN         07035004
070360                 END-IF                                           07036004
070370                 SET  PC253-FORM-ODD-CRTN-BOX TO TRUE             07037004
070380                 SET PC253-FORM-ODD-CRTN-FLD  TO TRUE             07038004
070390                 MOVE PC158-FORM-ODD-CRTN-BOX                     07039004
070400                                      TO PC158-ODD-CARTON-BOX     07040004
070410                 MOVE PC158-FORM-ODD-CRTN-FLD                     07041004
070420                                      TO PC158-ODD-CARTON-FIELD   07042004
070430             ELSE                                                 07043004
070440                 MOVE PC126-PACKS-IN-CRTN                         07044004
070450                                        TO PV-PC126-PACKS-IN-CRTN 07045004
070460                 MOVE PC126-OTPK-UNT-QTY  TO PC158-PACK-UNT       07046004
070470                                             PC253-PACK-UNT       07047004
070480                 SET  PC253-FORM-NO-ODD-BOX                       07048004
070490                                      TO TRUE                     07049004
070500                 SET  PC253-FORM-NO-ODD-FLD                       07050004
070600                                      TO TRUE                     07060004
070610                 MOVE PC158-FORM-NO-ODD-BOX                       07061004
070620                                      TO PC158-ODD-CARTON-BOX     07062004
070630                 MOVE PC158-FORM-NO-ODD-FLD                       07063004
070640                                      TO PC158-ODD-CARTON-FIELD   07064004
070650             END-IF                                               07065004
070660         ELSE                                                     07066004
070670             SET PC253-FORM-NO-INPK-BOX                           07067004
070680                                      TO TRUE                     07068004
070690             MOVE PC158-FORM-NO-INPK-BOX                          07069004
070700                                      TO PC158-INPK-CONVY-BOX     07070004
070710             SET  PC253-FORM-OTPK-HDG TO TRUE                     07071004
070720             MOVE PC158-FORM-OTPK-HDG TO PC158-INPK-CONVY-TEXT    07072004
070730             MOVE PC126-FCSE-LBL-CNT  TO PC253-TOT-LBL-CNT        07073004
070740                                         PC158-TOT-LBL-CNT        07074004
070750             IF  PC126-ODD-CRTN-UNT-QTY  >  ZERO  AND             07075004
070760                 PC126-ODD-CRTN-USE-FCSE          AND             07076004
070770                 PS-ODD-CART-FCSE-LBL-NOT-PRT                     07077004
070780                 MOVE PC126-ODD-CRTN-UNT-QTY TO PC253-PACK-UNT    07078004
070790                                                PC158-PACK-UNT    07079004
070800                 IF PC126-PREPK-RATIO > 0                         07080004
070810                    DIVIDE PC126-ODD-CRTN-UNT-QTY                 07081004
070820                        BY PC126-PREPK-RATIO                      07082004
070830                    GIVING PV-PC126-PACKS-IN-CRTN                 07083004
070840                 ELSE                                             07084004
070850                    MOVE ZEROES TO PV-PC126-PACKS-IN-CRTN         07085004
070860                 END-IF                                           07086004
070870                 set  PC253-FORM-ODD-CRTN-BOX                     07087004
070880                                      TO TRUE                     07088004
070890                 SET  PC253-FORM-ODD-CRTN-FLD TO TRUE             07089004
070900                 MOVE PC158-FORM-ODD-CRTN-BOX                     07090004
070910                                      TO PC158-ODD-CARTON-BOX     07091004
070920                 MOVE PC158-FORM-ODD-CRTN-FLD                     07092004
070930                                      TO PC158-ODD-CARTON-FIELD   07093004
070940             ELSE                                                 07094004
070950                 MOVE PC126-OTPK-UNT-QTY  TO PC253-PACK-UNT       07095004
070960                                             PC158-PACK-UNT       07096004
070970                 MOVE PC126-PACKS-IN-CRTN                         07097004
070980                                      TO PV-PC126-PACKS-IN-CRTN   07098004
070990                 SET  PC253-FORM-NO-ODD-BOX                       07099004
071000                                      TO TRUE                     07100004
071010                 SET  PC253-FORM-NO-ODD-FLD                       07101004
071020                                      TO TRUE                     07102004
071030                 MOVE PC158-FORM-NO-ODD-BOX                       07103004
071040                                      TO PC158-ODD-CARTON-BOX     07104004
071050                 MOVE PC158-FORM-NO-ODD-FLD                       07105004
071060                                      TO PC158-ODD-CARTON-FIELD   07106004
071070             END-IF                                               07107004
071080         END-IF                                                   07108004
071090     END-IF                                                       07109004
071100                                                                  07110004
071110     IF PC126-REPRINT                                             07111004
071120         EVALUATE TRUE                                            07112004
071130         WHEN PS-PRINT-INPK-LABELS                                07113004
071140         IF PS-CS-OVERRIDE                                        07114004
071150             SUBTRACT PV-ORIG-CS-QTY-INPK                         07115004
071160                 FROM PV-ORIG-INPK-CTN-CNT                        07116004
071170               giving PV-ORIG-INPK-CTN-CNT-NEW                    07117004
071180             ADD PV-CS-TOT-CTNS-INPK  TO PV-ORIG-INPK-CTN-CNT-NEW 07118004
071190             MOVE PV-ORIG-INPK-CTN-CNT-NEW                        07119004
071200                                      TO PC253-TOT-LBL-CNT        07120004
071210                                         PC158-TOT-LBL-CNT        07121004
071220         ELSE                                                     07122004
071230             MOVE PV-ORIG-INPK-CTN-CNT                            07123004
071240                                      TO PC253-TOT-LBL-CNT        07124004
071250                                         PC158-TOT-LBL-CNT        07125004
071260         END-IF                                                   07126004
071270         WHEN OTHER                                               07127004
071280         IF PS-CS-OVERRIDE                                        07128004
071290             SUBTRACT PV-ORIG-CS-QTY-FCSE                         07129004
071300                 FROM PV-ORIG-FCSE-CTN-CNT                        07130004
071310               giving PV-ORIG-FCSE-CTN-CNT-NEW                    07131004
071320             ADD PV-CS-TOT-CTNS-FCSE  TO PV-ORIG-FCSE-CTN-CNT-NEW 07132004
071330             MOVE PV-ORIG-FCSE-CTN-CNT-NEW                        07133004
071340                                      TO PC253-TOT-LBL-CNT        07134004
071350                                         PC158-TOT-LBL-CNT        07135004
071360         ELSE                                                     07136004
071370             MOVE PV-ORIG-FCSE-CTN-CNT                            07137004
071380                                      TO PC253-TOT-LBL-CNT        07138004
071390                                         PC158-TOT-LBL-CNT        07139004
071400         END-IF                                                   07140004
071410         END-EVALUATE                                             07141004
071420     END-IF                                                       07142004
071430                                                                  07143004
071440*                                                                 07144004
071450*** BEGIN - SML - LABEL MOCK-UP - DMH                             07145004
071460     SET PC253-FORM-SEASET-NO-HDG TO TRUE                         07146004
071470*    IF  SEASET-SEASET-NM  >  SPACES                              07147004
071480*        SET  PC253-FORM-SEASET-HDG   TO TRUE                     07148004
071490*        MOVE SEASET-SEASET-NM        TO PC253-SEASONAL-SET       07149004
071500*    ELSE                                                         07150004
071510*        SET  PC253-FORM-NO-SEASET    TO TRUE                     07151004
071520*    END-IF.                                                      07152004
071530*** BEGIN - SML - LABEL MOCK-UP - DMH                             07153004
071540                                                                  07154004
071550     SET PC253-OH-ZERO-YES            TO TRUE                     07155004
071560                                                                  07156004
071570     PERFORM 8300-GET-DEPT-NAME.                                  07157004
071580                                                                  07158004
071590*----------------------------------------------------------------*07159004
071600     MOVE PC126-PO-NBR                TO PV-PO-NBR.               07160004
071610     MOVE PC126-RCVR-SEQ-NBR          TO PV-RCVR-SEQ-NBR.         07161004
071620     MOVE PV-PO-RCVR-SEQ-NBR          TO PC253-PO-RCVR-NBR        07162004
071630                                         PC158-PO-RCVR-NBR.       07163004
071640     MOVE PC126-PO-LNE-NBR            TO PC253-PO-LNE-NBR         07164004
071650                                         PC158-PO-LNE-NBR.        07165004
071660     MOVE PC126-DEPT-NBR              TO                          07166004
071670                                         PV-DCS-DEPT              07167004
071680     MOVE PC126-CL-NBR                TO                          07168004
071690                                         PV-DCS-CLASS             07169004
071700     MOVE PC126-SKU                   TO                          07170004
071710                                         PV-DCS-SKU               07171004
071720     MOVE PV-DEPT-CLASS-SKU           TO PC253-SKU-NBR            07172004
071730                                         PC158-SKU-NBR.           07173004
071740                                                                  07174004
071750     MOVE PC126-VENDOR-STYLE          TO PC253-STYLE              07175004
071760                                         PC158-STYLE.             07176004
071770                                                                  07177004
071780*    IF  PC126-STR-ZNE  >  SPACES                                 07178004
071790*        MOVE PC126-STR-ZNE           TO PC253-MDSE-GROUP         07179004
071800*    END-IF.                                                      07180004
071810                                                                  07181004
071820**** BEGIN - PREPACK DESCRIPTIONS - SML LABEL                     07182004
071830     IF  PC126-PRE-PACK-ORDER                                     07183004
071840         SET  PC253-PACK-HDG          TO TRUE                     07184004
071850         MOVE PC126-PREPK-ID          TO PC253-PO-LNE-NBR         07185004
071860         MULTIPLY  PC126-TOT-PREPK-UNTS                           07186004
071870               BY  PV-PC126-PACKS-IN-CRTN                         07187004
071880           GIVING  PV-PREPK-OUTER-PK                              07188004
071890         IF  PS-PRINT-INPK-LABELS                                 07189004
071900             MOVE  PC126-PREPK-INPK-UNT-QTY                       07190004
071910                                      TO PC253-PACK-UNT           07191004
071920         ELSE                                                     07192004
071930             MOVE  PV-PREPK-OUTER-PK  TO PC253-PACK-UNT           07193004
071940         END-IF                                                   07194004
071950     ELSE                                                         07195004
071960         MOVE 'LINE NO: '             TO PC253-LINE-PACK-DESC     07196004
071970         MOVE PC126-PO-LNE-NBR        TO PC253-PO-LNE-NBR         07197004
071980     END-IF                                                       07198004
071990**** END   - PREPACK DESCRIPTIONS - SML LABEL                     07199004
072000                                                                  07200004
072010**   MOVE PC126-ITEM-NBR              TO PV-ITEM-NBR-16-POS.      07201004
072020**   MOVE PV-ITEM-NBR-16-POS          TO PC158-ITEM-NBR-BC-NBR    07202004
072030**                                       PC158-ITEM-NBR-BC.       07203004
072040                                                                  07204004
072050     MOVE PC126-SKU                   TO PC158-ITEM-NBR-BC-NBR    07205004
072060                                         PC158-ITEM-NBR-BC.       07206004
072070                                                                  07207004
072080     EVALUATE TRUE                                                07208004
072090         WHEN PC126-REPRINT                                       07209004
072100         WHEN PC126-REVISED                                       07210004
072110             SET  PC253-FORM-REPRT-FLD TO TRUE                    07211004
072120             MOVE PC158-FORM-REPRT-FLD                            07212004
072130                                      TO PC158-REPRINT-TEXT       07213004
072140             SET  PC253-FORM-REPRT-BOX TO TRUE                    07214004
072150             MOVE PC158-FORM-REPRT-BOX                            07215004
072160                                      TO PC158-REPRINT-BOX        07216004
072170         WHEN PC126-INITIAL-PRINT                                 07217004
072180             SET  PC253-FORM-NO-RPRT-FLD                          07218004
072190                                      TO TRUE                     07219004
072200             MOVE PC158-FORM-NO-RPRT-FLD                          07220004
072210                                      TO PC158-REPRINT-TEXT       07221004
072220             SET  PC253-FORM-NO-RPRT-BOX                          07222004
072230                                      TO TRUE                     07223004
072240             MOVE PC158-FORM-NO-RPRT-BOX                          07224004
072250                                      TO PC158-REPRINT-BOX        07225004
072260     END-EVALUATE.                                                07226004
072270                                                                  07227004
072280     MOVE PC126-USER-ID               TO PC253-USER-ID            07228004
072290                                         PC158-USER-ID            07229004
072300                                                                  07230004
072310     MOVE PC126-DC-PRTD-AT            TO PV-DSPLY-DC-2            07231004
072320     MOVE '-'                         TO PV-DSPLY-DASH-2          07232004
072330     MOVE PC126-SHP-PRTR-ID           TO PV-DSPLY-PRTR-ID-2       07233004
072340     MOVE PV-DSPLY-PRTR2              TO PC253-SML-PRTR-NBR       07234004
072350                                         PC158-SML-PRTR-NBR       07235004
072360                                                                  07236004
072370     MOVE 'CS-SML LBL'                TO PC253-SML-LBL-DESC       07237004
072380     MOVE PV-LBL-PRT-DATE             TO PC253-LBL-PRT-DATE       07238004
072390                                         PC158-LBL-PRT-DATE       07239004
072400     MOVE PV-LBL-PRT-TIME             TO PC253-LBL-PRT-TIME       07240004
072500                                         PC158-LBL-PRT-TIME       07250004
072600                                                                  07260004
072700*    MOVE PC253-FORM-NO-REVRSE-STR TO PC253-REVERSE-STORE-BOX     07270004
072710                                                                  07271004
072720     MOVE PC158-FORM-NO-REVRSE-STR TO PC158-REVERSE-STORE-BOX     07272004
072730                                                                  07273004
072740                                                                  07274004
072750     IF  PC126-SHP-XMIT-INTFC-CDE  =  PC-SOCKET-INTERFACE         07275004
072760       IF PS-CS-OVERRIDE                                          07276004
072770          PERFORM 5445-CS-SML-FORM                                07277004
072780                  VARYING PC158-IDX FROM 1 BY 1                   07278004
072790                    UNTIL PC158-IDX > PC158-SHIP-MFST-LBL-MAX-LN  07279004
072800                       OR PS-SOCKET-ERROR                         07280004
072810           SET  PS-LAST-FORM-CNTL-STK                             07281004
072820                PS-FIRST-CS-LBL-NOT-PRT    TO  TRUE               07282004
072830       ELSE                                                       07283004
072840           PERFORM 5440-SML-FORM                                  07284004
072850                   VARYING PC253-IDX FROM 1 BY 1                  07285004
072860                     UNTIL PC253-IDX > PC253-SHIP-MFST-LBL-MAX-LN 07286004
072870                        OR PS-SOCKET-ERROR                        07287004
072880           SET  PS-LAST-FORM-SML                                  07288004
072890                PS-FIRST-AFTER-FORM-YES                           07289004
072900                PS-FIRST-CS-LBL-NOT-PRT TO   TRUE                 07290004
072910       END-IF                                                     07291004
072920     END-IF.                                                      07292004
072930                                                                  07293004
072940                                                                  07294004
072950 8010-CREATE-LABEL.                                               07295004
072960                                                                  07296004
072970* DMH - 1/03/2005 - BEGIN                                         07297004
072980     IF   PS-DISPLAY-CSSL-YES                                     07298004
072990        INITIALIZE                       PV-CICS-MSG-AREA         07299004
073000        STRING ' PCKCS191- 8010-CREATE-LABEL             '        07300004
073010                                         DELIMITED BY SIZE        07301004
073020                                    INTO PV-CICS-MSG-AREA         07302004
073030        MOVE LENGTH OF PV-CICS-MSG-AREA                           07303004
073040                                      TO PV-COMMAREA-LENGTH       07304004
073050        EXEC CICS                                                 07305004
073060            WRITEQ TD                                             07306004
073070                QUEUE   ('CSSL')                                  07307004
073080                FROM    (PV-CICS-MSG-AREA)                        07308004
073090                LENGTH  (PV-COMMAREA-LENGTH)                      07309004
073100                RESP    (PV-CICS-RESP)                            07310004
073110        END-EXEC                                                  07311004
073120     END-IF.                                                      07312004
073130* DMH - 1/03/2005 - BEGIN                                         07313004
073140                                                                  07314004
073150     IF PC126-SHIP-LBL-SML                                        07315004
073160         PERFORM 8011-CREATE-4BY4-LABEL                           07316004
073380     END-IF.                                                      07338004
073390                                                                  07339004
073400 8011-CREATE-4BY4-LABEL.                                          07340004
073410                                                                  07341004
073420* DMH - 1/03/2005 - BEGIN                                         07342004
073430     IF   PS-DISPLAY-CSSL-YES                                     07343004
073440        INITIALIZE                       PV-CICS-MSG-AREA         07344004
073450        STRING ' PCKCS191- 8011-CREATE-4BY4-LABEL        '        07345004
073460                                         DELIMITED BY SIZE        07346004
073470                                    INTO PV-CICS-MSG-AREA         07347004
073480        MOVE LENGTH OF PV-CICS-MSG-AREA                           07348004
073490                                      TO PV-COMMAREA-LENGTH       07349004
073500        EXEC CICS                                                 07350004
073510            WRITEQ TD                                             07351004
073520                QUEUE   ('CSSL')                                  07352004
073530                FROM    (PV-CICS-MSG-AREA)                        07353004
073540                LENGTH  (PV-COMMAREA-LENGTH)                      07354004
073550                RESP    (PV-CICS-RESP)                            07355004
073560        END-EXEC                                                  07356004
073570     END-IF.                                                      07357004
073580* DMH - 1/03/2005 - BEGIN                                         07358004
073590                                                                  07359004
073600     MOVE ZEROES   TO PV-STR-ONHAND-ZERO-COUNT.                   07360004
073610                                                                  07361004
073620     EVALUATE TRUE                                                07362004
073630         WHEN PS-PRINT-FCSE-LABELS                                07363004
073631                                                                  07363104
073632             IF  PS-ODD-CART-FCSE-LBL-NOT-PRT  AND                07363204
073633                 PS-ODD-CART-LABEL                                07363304
073634                 MOVE PC-0001         TO PC254-SML-TOT-LBLS       07363404
073635                                         PC159-SML-TOT-LBLS       07363504
073636                                         PV-LBL-PRT-QTY-NUMERIC   07363604
073637                                         PV-LBL-PRT-QTY-NUM-UPD   07363704
073638             ELSE                                                 07363804
073639                 MOVE PT-FCSE-LABEL-SEQ-QTY(PT-DISTRO-IDX)        07363904
073640                                      TO PC254-SML-TOT-LBLS       07364004
073641                                         PC159-SML-TOT-LBLS       07364104
073642                                         PV-LBL-PRT-QTY-NUMERIC   07364204
073643                                         PV-LBL-PRT-QTY-NUM-UPD   07364304
073644                 IF  PC254-LABEL-NUMBER-N  =  PC-0002 AND         07364404
073645                     PV-DISTRO-FCSE-ODD    =  ZERO                07364504
073646                     MOVE PC-0001  TO  PC254-LABEL-NUMBER-N       07364604
073647                                       PC159-LABEL-NUMBER-N       07364704
073648                 END-IF                                           07364804
073649                                                                  07364904
073650                 IF  PT-CENTRAL-STOCK (PT-DISTRO-IDX)  AND        07365004
073660                     PT-ODD-CART-FCSE (PT-DISTRO-IDX)  AND        07366004
073670                     PS-ODD-CART-FCSE-LBL-PRTD                    07367004
073680                     SUBTRACT  1                                  07368004
073690                       FROM  PT-FCSE-LABEL-SEQ-QTY(PT-DISTRO-IDX) 07369004
073700                      GIVING PV-ADJUSTED-LBL-QTY                  07370004
073710                      MOVE   PV-ADJUSTED-LBL-QTY                  07371004
073720                        TO PC159-SML-TOT-LBLS                     07372004
073730                 ELSE                                             07373004
073740                 IF  PT-ODD-CART-FCSE (PT-DISTRO-IDX)  AND        07374004
073750                     PC126-REPRINT                     AND        07375004
073760                     PS-ODD-CART-FCSE-LBL-PRTD                    07376004
073770                     SUBTRACT  1                                  07377004
073780                       FROM  PT-FCSE-LABEL-SEQ-QTY(PT-DISTRO-IDX) 07378004
073790                      GIVING PV-ADJUSTED-LBL-QTY                  07379004
073800                      MOVE   PV-ADJUSTED-LBL-QTY                  07380004
073810                        TO PC254-SML-TOT-LBLS                     07381004
073820                           PV-LBL-PRT-QTY-NUMERIC                 07382004
073830                           PV-LBL-PRT-QTY-NUM-UPD                 07383004
073840                 END-IF                                           07384004
073850                 END-IF                                           07385004
073860             END-IF                                               07386004
073870                                                                  07387004
073880         WHEN PS-PRINT-INPK-LABELS                                07388004
073890                                                                  07389004
073900             IF  PS-ODD-CART-INPK-LBL-NOT-PRT  AND                07390004
073910                 PS-ODD-CART-LABEL                                07391004
073920                 MOVE PC-0001         TO PC254-SML-TOT-LBLS       07392004
073921                                         PC159-SML-TOT-LBLS       07392104
073922                                         PV-LBL-PRT-QTY-NUMERIC   07392204
073923                                         PV-LBL-PRT-QTY-NUM-UPD   07392304
073924             ELSE                                                 07392404
073925                 MOVE PT-INPK-LABEL-SEQ-QTY(PT-DISTRO-IDX)        07392504
073926                                      TO PC254-SML-TOT-LBLS       07392604
073927                                         PC159-SML-TOT-LBLS       07392704
073928                                         PV-LBL-PRT-QTY-NUMERIC   07392804
073929                                         PV-LBL-PRT-QTY-NUM-UPD   07392904
073930             END-IF                                               07393004
073940     END-EVALUATE                                                 07394004
073950                                                                  07395004
073960     MOVE '@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@'                   07396004
073970                                      TO PC159-ERROR-MSG-1        07397004
073980                                         PC159-ERROR-MSG-2.       07398004
073990     move '@@@@@'                     to PC159-CARTON-NBR.        07399004
074000                                                                  07400004
074010     MOVE PT-STR-ABBR10(PT-DISTRO-IDX)                            07401004
074020                                      TO                          07402004
074030                                         PC159-SML-STR-NME.       07403004
074040                                                                  07404004
074050     MOVE PT-STORE-NMBR (PT-DISTRO-IDX)                           07405004
074060                                      TO PC254-SML-STR-NBR        07406004
074070                                         PC159-SML-STR-NBR        07407004
074080                                         PV-STORE-NBR-4.          07408004
074090*** GB 2/21/06 ALWAYS DISPLAY THE DOOR HEADING                    07409004
074100     SET  PC254-DOOR-HDG-YES   TO TRUE                            07410004
074110     IF   PT-DC-DOOR-ID (PT-DISTRO-IDX) > SPACES                  07411004
074120          MOVE PT-DC-DOOR-ID (PT-DISTRO-IDX)                      07412004
074130                                      TO PC254-DOOR-NUMBER        07413004
074140     ELSE                                                         07414004
074150          SET PC254-DOOR-NBR-NO     TO TRUE                       07415004
074160     END-IF                                                       07416004
074170                                                                  07417004
074180     IF   PT-STR-ONHAND-ZERO-COUNT (PT-DISTRO-IDX) > 0            07418004
074190*         SET  PC253-OH-ZERO-YES TO TRUE                          07419004
074200          MOVE PT-PROCESS-MESSAGE (PT-DISTRO-IDX)                 07420004
074210                                      TO PC254-STR-ON-HAND        07421004
074220                                         PC253-STORE-ON-HAND      07422004
074230          IF PT-FIRST-STR-RCPT-COUNT (PT-DISTRO-IDX) > 0          07423004
074240             MOVE PV-FIRST-STORE-RCPT-TXT-1 TO                    07424004
074250                                      PC254-TEXT-LINE-1           07425004
074260             MOVE PV-FIRST-STORE-RCPT-TXT-2 TO                    07426004
074270                                      PC254-TEXT-LINE-2           07427004
074280             MOVE PV-FIRST-STORE-RCPT-TXT-3 TO                    07428004
074290                                      PC254-TEXT-LINE-3           07429004
074300             SET PC254-NO-TEXT-LINE-4 TO TRUE                     07430004
074310             SUBTRACT 1 FROM                                      07431004
074320                 PT-FIRST-STR-RCPT-COUNT (PT-DISTRO-IDX)          07432004
074321          ELSE                                                    07432104
074322             SET PC254-NO-TEXT-LINE-1 TO TRUE                     07432204
074323             SET PC254-NO-TEXT-LINE-2 TO TRUE                     07432304
074324             SET PC254-NO-TEXT-LINE-3 TO TRUE                     07432404
074325             SET PC254-NO-TEXT-LINE-4 TO TRUE                     07432504
074326          END-IF                                                  07432604
074327     ELSE                                                         07432704
074328*         SET  PC253-OH-ZERO-NO  TO TRUE                          07432804
074329          SET  PC253-FORM-NO-STORE-ON-HAND                        07432904
074330               PC254-OH-ZERO-MSG-NO        to true                07433004
074340          SET PC254-NO-TEXT-LINE-1 TO TRUE                        07434004
074341          SET PC254-NO-TEXT-LINE-2 TO TRUE                        07434104
074342          SET PC254-NO-TEXT-LINE-3 TO TRUE                        07434204
074343          SET PC254-NO-TEXT-LINE-4 TO TRUE                        07434304
074344     END-IF                                                       07434404
074345                                                                  07434504
074364* BBR WR41309 - RFID PROCESSING                                   07436404
074365     IF   PT-RFID-STORE-YES (PT-DISTRO-IDX)                       07436504
074366         MOVE PV-RFID-STORE-TXT-4 TO PC254-TEXT-LINE-4            07436604
074367     ELSE                                                         07436704
074368         SET PC254-NO-TEXT-LINE-4 TO TRUE                         07436804
074369     END-IF                                                       07436904
074370* BBR WR41309 - END                                               07437004
074371                                                                  07437104
074372     SET  PC160-20-SML-INTERNAL-LBL                               07437204
074373          PC160-20-SML-FROM-KOHLS    TO TRUE                      07437304
074374                                                                  07437404
074375     MOVE  PC126-OPER-UNT-ID    TO                                07437504
074376                                   PC160-20-SML-BC-DC-ORIGIN      07437604
074377                                   PC160-20-SML-NBR-BC-DC-ORIGIN  07437704
074378                                                                  07437804
074379*divert code                                                      07437904
074380     MOVE PT-DIVERT-CODE (PT-DISTRO-IDX)                          07438004
074381                                TO                                07438104
074382                                   PC160-20-SML-BC-DIVERT         07438204
074383                                   PC160-20-SML-NBR-BC-DIVERT     07438304
074384* 29 digit barcode & nbr - DATA                                   07438404
074385     MOVE  PC126-PO-NBR               TO PV-BC-PO-NBR-BC          07438504
074386                                         PV-BC-PO-NBR             07438604
074387     MOVE  PC126-SKU                  TO PV-BC-ITEM-NBR-BC        07438704
074388                                         PV-BC-ITEM-NBR           07438804
074389     MOVE  PC158-PACK-UNT             TO PV-BC-UNITS-BC           07438904
074390                                         PV-BC-UNITS              07439004
074391     MOVE  PV-PO-ITM-UNITS-NBR        TO PC159-PO-ITM-UNITS       07439104
074392     MOVE  PV-PO-ITM-UNITS-BC         TO PC159-PO-ITM-UNITS-BC.   07439204
074393                                                                  07439304
074394                                                                  07439404
074395     IF PT-SEASONAL-SET-NAME (PT-DISTRO-IDX) > SPACES             07439504
074396        SET  PC254-SEASET-HDG-YES   TO TRUE                       07439604
074397        MOVE PT-SEASONAL-SET-NAME (PT-DISTRO-IDX) TO              07439704
074398                                      PC253-SEASONAL-SET          07439804
074399                                      PC254-SEASONAL-SET          07439904
074400     ELSE                                                         07440004
074401        SET  PC254-SEASET-HDG-NO                                  07440104
074402             PC254-SEASET-NO        TO TRUE                       07440204
074403     END-IF                                                       07440304
074404                                                                  07440404
074405* DMH - 1/03/2005 - BEGIN                                         07440504
074406     IF   PS-DISPLAY-CSSL-YES                                     07440604
074407        INITIALIZE                       PV-CICS-MSG-AREA         07440704
074408        STRING ' PCKCS191- pt-fixt-id = '                         07440804
074409                 PT-FIXT-ID (PT-DISTRO-IDX)                       07440904
074410                                         DELIMITED BY SIZE        07441004
074411                                    INTO PV-CICS-MSG-AREA         07441104
074412        MOVE LENGTH OF PV-CICS-MSG-AREA                           07441204
074413                                      TO PV-COMMAREA-LENGTH       07441304
074414        EXEC CICS                                                 07441404
074415            WRITEQ TD                                             07441504
074416                QUEUE   ('CSSL')                                  07441604
074417                FROM    (PV-CICS-MSG-AREA)                        07441704
074418                LENGTH  (PV-COMMAREA-LENGTH)                      07441804
074419                RESP    (PV-CICS-RESP)                            07441904
074420        END-EXEC                                                  07442004
074430     END-IF.                                                      07443004
074440* DMH - 1/03/2005 - BEGIN                                         07444004
074441                                                                  07444104
074442     IF PT-FIXT-ID (PT-DISTRO-IDX) > SPACES                       07444204
074443        SET PC254-FIXTURE-HDG-YES TO TRUE                         07444304
074444        MOVE PT-FIXT-ID (PT-DISTRO-IDX) TO PC254-FIXTURE          07444404
074445     ELSE                                                         07444504
074446        SET PC254-FIXTURE-HDG-NO  TO TRUE                         07444604
074447        MOVE '@@@@@@@@@@'               TO PC254-FIXTURE          07444704
074448     END-IF                                                       07444804
074449                                                                  07444904
074450                                                                  07445004
074451* CENTRAL STOCK LABEL - LINE NUMBER                               07445104
074452     MOVE  PC126-PO-LNE-NBR           TO PC159-LINE-NUMBER-N.     07445204
074453                                                                  07445304
074454                                                                  07445404
074455*    IF PV-WORK-DATE = '01/01'                                    07445504
074456*        MOVE '@@@@@'                 TO PC254-AD-DATE            07445604
074457*    ELSE                                                         07445704
074458*        MOVE PV-WORK-DATE            TO PC254-AD-DATE            07445804
074459*    END-IF                                                       07445904
074460*                                                                 07446004
074470     IF  PC126-STR-ZNE  >  SPACES                                 07447004
074480         MOVE PC126-STR-ZNE           TO                          07448004
074490                                         PC158-STR-ZN-ID          07449004
074500     END-IF                                                       07450004
074510                                                                  07451004
074520                                                                  07452004
074530                                                                  07453004
074540*----------------------------------------------------------------*07454004
074550* SET BALANCE ON HAND ZERO MESASGE    6/13/05                    *07455004
074560*----------------------------------------------------------------*07456004
074570*    IF PT-STORE-ONHAND-ZERO (PT-DISTRO-IDX)                      07457004
074580*       SET PC254-OH-ZERO-MSG-YES TO TRUE                         07458004
074590*    ELSE                                                         07459004
074600*       SET PC254-OH-ZERO-MSG-NO  TO TRUE                         07460004
074610*    END-IF                                                       07461004
074620                                                                  07462004
074630*----------------------------------------------------------------*07463004
074640* CHECK IF LABEL FOR CENTRAL STOCK OR E-COMMERCE - 11/13/2000    *07464004
074650*----------------------------------------------------------------*07465004
074660     IF  PT-CENTRAL-STOCK (PT-DISTRO-IDX)                         07466004
074670         MOVE  PC159-CS-CTL-STK-LBL     TO  PC159-SML-LBL-DESC    07467004
074680         MOVE  PC159-ZONE-HDG-VALUE     TO  PC159-ZONE-STRG-HDG   07468004
074690         MOVE  PC158-STR-ZN-ID          TO  PC159-ZONE-STRG-DESC  07469004
074700     ELSE                                                         07470004
074710                                                                  07471004
074720************ FUTURE **************                                07472004
074730** E-COMMERCE STORAGE CODE    ****                                07473004
074740**********************************                                07474004
074750     IF  PT-E-COMMERCE (PT-DISTRO-IDX)                            07475004
074760         MOVE  PC159-CS-E-COMM-LBL      TO  PC159-SML-LBL-DESC    07476004
074770         MOVE  PC159-STORAGE-HDG-VALUE  TO  PC159-ZONE-STRG-HDG   07477004
074780         MOVE  '@@@@@'                  TO  PC159-ZONE-STRG-DESC  07478004
074790     END-IF                                                       07479004
074800     END-IF.                                                      07480004
074810                                                                  07481004
074820                                                                  07482004
074830* A REPRINT CAN BE DONE AN ANY RANGE OF LABEL NUMBERS WITHIN THE  07483004
074840* COMPLETE SET.  FOR EXAMPLE, IF 22 LABELS COMPRISE THE COMPLETE  07484004
074850* SET, WE CAN REQUEST LABELS 10 THRU 15 TO PRINT.  WE WILL PASS   07485004
074860* THRU THE LIST FROM BEGINNING TO END BUT WILL PRINT ONLY THE     07486004
074870* 10TH LABEL THRU THE 15TH LABEL.  THE ORIGINAL SEQUENCE WILL BE  07487004
074871* KEPT.                                                           07487104
074872                                                                  07487204
074873                                                                  07487304
074874     IF PC126-REPRINT AND                                         07487404
074875         (PC126-SHP-RPRT-FCSE OR PC126-SHP-RPRT-INPK)             07487504
074876         IF PC126-PRT-SHUFFLED                                    07487604
074877                                                                  07487704
074878             IF PT-CS-DC-RTV (PT-DISTRO-IDX)                      07487804
074879                 IF PS-ODD-CART-FCSE-LBL-PRTD  AND                07487904
074880                    PT-ODD-CART-FCSE (PT-DISTRO-IDX)              07488004
074890                     IF  PC126-REPRINT AND                        07489004
074900                         PC126-SHP-REPRT-FROM-CNT = PC-0001 AND   07490004
074910                         PV-COUNT = ZERO                          07491004
074920                         ADD  1       TO PV-COUNT                 07492004
074930                     END-IF                                       07493004
074940                 END-IF                                           07494004
074950                                                                  07495004
074960                 IF PS-ODD-CART-INPK-LBL-PRTD  AND                07496004
074970                    PT-ODD-CART-INPK (PT-DISTRO-IDX)              07497004
074980                     IF  PC126-REPRINT AND                        07498004
074990                         PC126-SHP-REPRT-FROM-CNT > PC-0001 AND   07499004
075000                         PV-COUNT = ZERO                          07500004
075010                             MOVE PV-ODD-CRTN-INPK-LBLS-NEED      07501004
075020                               TO PV-COUNT                        07502004
075030                     END-IF                                       07503004
075040                 END-IF                                           07504004
075050                                                                  07505004
075060                 IF PS-ODD-CART-FCSE-LBL-PRTD                     07506004
075070                     IF  PC126-REPRINT AND                        07507004
075080                         PC126-SHP-REPRT-FROM-CNT = PC-0001 AND   07508004
075090                         PV-COUNT = ZERO                          07509004
075100                         ADD  1       TO PV-COUNT                 07510004
075110                     END-IF                                       07511004
075120                 END-IF                                           07512004
075130                                                                  07513004
075140                 IF  PS-ODD-CART-INPK-LBL-PRTD                    07514004
075150                     IF  PC126-REPRINT AND                        07515004
075160                         PC126-SHP-REPRT-FROM-CNT > PC-0001 AND   07516004
075170                         PV-COUNT = ZERO                          07517004
075180                             MOVE PV-ODD-CRTN-INPK-LBLS-NEED      07518004
075190                               TO PV-COUNT                        07519004
075200                     END-IF                                       07520004
075210                 END-IF                                           07521004
075220                                                                  07522004
075230                 IF PC126-SHP-RPRT-FCSE                           07523004
075240                                                                  07524004
075250                     IF PS-ODD-CART-LABEL                AND      07525004
075260                        PS-ODD-CART-FCSE-LBL-NOT-PRT     AND      07526004
075270                       (PT-CENTRAL-STOCK (PT-DISTRO-IDX)     OR   07527004
075280                        PT-E-COMMERCE    (PT-DISTRO-IDX)) AND     07528004
075290                        PT-ODD-CART-FCSE (PT-DISTRO-IDX)          07529004
075300                         ADD 1  TO  PV-COUNT                      07530004
075310                         IF PV-COUNT >= PC126-SHP-REPRT-FROM-CNT  07531004
075320                            AND PV-COUNT <= PC126-SHP-REPRT-TO-CNT07532004
075330                            PERFORM 8011A-MOVE-SML-LINES          07533004
075340                         END-IF                                   07534004
075350                         SUBTRACT 1                               07535004
075360                             FROM PV-DISTRO-SUM                   07536004
075370                         ADD  1                                   07537004
075380                           TO  PT-MANIFEST-START (PT-DISTRO-IDX)  07538004
075390                     ELSE                                         07539004
075400                                                                  07540004
075410                        PERFORM UNTIL PT-FCSE-LABELS-NEEDED       07541004
075420                               (PT-DISTRO-IDX) <= ZERO            07542004
075430                            ADD PT-FCSE-LABEL-SEQ-QTY             07543004
075440                                    (PT-DISTRO-IDX) TO PV-COUNT   07544004
075450                                                                  07545004
075460                            IF  PV-COUNT >=                       07546004
075470                                    PC126-SHP-REPRT-FROM-CNT  AND 07547004
075480                                PV-COUNT <= PC126-SHP-REPRT-TO-CNT07548004
075490                                PERFORM 8011A-MOVE-SML-LINES      07549004
075500                            END-IF                                07550004
075510                            SUBTRACT PT-FCSE-LABEL-SEQ-QTY        07551004
075520                                         (PT-DISTRO-IDX)          07552004
075530                                FROM PT-FCSE-LABELS-NEEDED        07553004
075540                                         (PT-DISTRO-IDX)          07554004
075550                                     PV-DISTRO-SUM                07555004
075560                                 ADD PT-FCSE-LABEL-SEQ-QTY        07556004
075570                                         (PT-DISTRO-IDX)          07557004
075580                                  TO PT-MANIFEST-START            07558004
075590                                         (PT-DISTRO-IDX)          07559004
075600                        END-PERFORM                               07560004
075610                     END-IF                                       07561004
075620                 ELSE                                             07562004
075630                                                                  07563004
075640                 MOVE PT-INPK-LABEL-SEQ-QTY                       07564004
075650                               (PT-DISTRO-IDX)                    07565004
075660                                      TO PV-LOOP-LIMIT            07566004
075670                 PERFORM PV-LOOP-LIMIT TIMES                      07567004
075680                     ADD 1    TO PV-COUNT                         07568004
075690                     IF PV-COUNT >= PC126-SHP-REPRT-FROM-CNT      07569004
075700                        AND PV-COUNT <= PC126-SHP-REPRT-TO-CNT    07570004
075710                         MOVE 1       TO PC254-SML-TOT-LBLS       07571004
075720                                         PC159-SML-TOT-LBLS       07572004
075730                                         PV-LBL-PRT-QTY-NUMERIC   07573004
075740                                         PV-LBL-PRT-QTY-NUM-UPD   07574004
075750                         PERFORM 8011A-MOVE-SML-LINES             07575004
075760                     END-IF                                       07576004
075770                 END-PERFORM                                      07577004
075780                                                                  07578004
075790                 SUBTRACT PT-INPK-LABEL-SEQ-QTY                   07579004
075800                              (PT-DISTRO-IDX)                     07580004
075810                      FROM    PT-INPK-LABELS-NEEDED               07581004
075820                             (PT-DISTRO-IDX)                      07582004
075830                              PV-DISTRO-SUM                       07583004
075840             ELSE                                                 07584004
075850                 IF PS-ODD-CART-FCSE-LBL-PRTD                     07585004
075860                     IF  PC126-REPRINT AND                        07586004
075870                         PC126-SHP-REPRT-FROM-CNT = PC-0001 AND   07587004
075880                         PV-COUNT = ZERO                          07588004
075890                         ADD  1       TO PV-COUNT                 07589004
075900                     END-IF                                       07590004
075910                 END-IF                                           07591004
075920                                                                  07592004
075930                 IF  PS-ODD-CART-INPK-LBL-PRTD                    07593004
075940                     IF  PC126-REPRINT AND                        07594004
075950                         PC126-SHP-REPRT-FROM-CNT > PC-0001 AND   07595004
075960                         PV-COUNT = ZERO                          07596004
075970                             MOVE PV-ODD-CRTN-INPK-LBLS-NEED      07597004
075980                               TO PV-COUNT                        07598004
075990                     END-IF                                       07599004
076000                 END-IF                                           07600004
076010                                                                  07601004
076020                 MOVE PT-FCSE-LABEL-SEQ-QTY                       07602004
076030                               (PT-DISTRO-IDX)                    07603004
076040                                      TO PV-LOOP-LIMIT            07604004
076050                 PERFORM PV-LOOP-LIMIT TIMES                      07605004
076060                     ADD 1    TO PV-COUNT                         07606004
076070                     IF PV-COUNT >= PC126-SHP-REPRT-FROM-CNT      07607004
076080                        AND PV-COUNT <= PC126-SHP-REPRT-TO-CNT    07608004
076090                         MOVE 1       TO PC254-SML-TOT-LBLS       07609004
076100                                         PC159-SML-TOT-LBLS       07610004
076110                                         PV-LBL-PRT-QTY-NUMERIC   07611004
076120                                         PV-LBL-PRT-QTY-NUM-UPD   07612004
076130                         PERFORM 8011A-MOVE-SML-LINES             07613004
076140                     END-IF                                       07614004
076150                 END-PERFORM                                      07615004
076160                 IF  PS-PRINT-FCSE-LABELS                         07616004
076170                     SUBTRACT PT-FCSE-LABEL-SEQ-QTY               07617004
076180                                  (PT-DISTRO-IDX)                 07618004
076190                     FROM PT-FCSE-LABELS-NEEDED                   07619004
076200                                   (PT-DISTRO-IDX)                07620004
076210                                   PV-DISTRO-SUM                  07621004
076220                 ELSE                                             07622004
076230                     SUBTRACT 1                                   07623004
076240                         FROM PT-INPK-LABELS-NEEDED               07624004
076250                              (PT-DISTRO-IDX)                     07625004
076260                              PV-DISTRO-SUM                       07626004
076270                 END-IF                                           07627004
076280             END-IF                                               07628004
076290         ELSE                                                     07629004
076300             IF PS-PRINT-FCSE-LABELS                              07630004
076310                 PERFORM 8011A-MOVE-SML-LINES                     07631004
076320                                                                  07632004
076330                 IF  PS-ODD-CART-FCSE-LBL-NOT-PRT      AND        07633004
076340                     PT-ODD-CART-FCSE (PT-DISTRO-IDX)  AND        07634004
076350                    (PT-CENTRAL-STOCK (PT-DISTRO-IDX)        OR   07635004
076360                     PT-E-COMMERCE    (PT-DISTRO-IDX)) AND        07636004
076370                     PC126-REPRINT                                07637004
076380                     SUBTRACT 1                                   07638004
076390                         FROM PT-FCSE-LABELS-NEEDED               07639004
076400                              (PT-DISTRO-IDX)                     07640004
076410                              PV-DISTRO-SUM                       07641004
076420                 ELSE                                             07642004
076430                                                                  07643004
076440                     SUBTRACT PT-FCSE-LABEL-SEQ-QTY               07644004
076450                              (PT-DISTRO-IDX)                     07645004
076460                         FROM PT-FCSE-LABELS-NEEDED               07646004
076470                              (PT-DISTRO-IDX)                     07647004
076480                              PV-DISTRO-SUM                       07648004
076490                 END-IF                                           07649004
076500             ELSE                                                 07650004
076510                 PERFORM 8011A-MOVE-SML-LINES                     07651004
076520                 SUBTRACT PT-INPK-LABEL-SEQ-QTY                   07652004
076530                              (PT-DISTRO-IDX)                     07653004
076540                       FROM    PT-INPK-LABELS-NEEDED              07654004
076550                               (PT-DISTRO-IDX)                    07655004
076560                               PV-DISTRO-SUM                      07656004
076570         END-IF                                                   07657004
076580     ELSE                                                         07658004
076590         IF PS-PRINT-FCSE-LABELS                                  07659004
076600             PERFORM 8011A-MOVE-SML-LINES                         07660004
076610                                                                  07661004
076620             IF  PS-ODD-CART-FCSE-LBL-NOT-PRT  AND                07662004
076630                 PS-ODD-CART-LABEL                                07663004
076640                 SUBTRACT PC-0001 FROM PT-FCSE-LABELS-NEEDED      07664004
076650                                       (PT-DISTRO-IDX)            07665004
076660                                       PV-DISTRO-SUM              07666004
076670             ELSE                                                 07667004
076680                                                                  07668004
076690                 SUBTRACT PT-FCSE-LABEL-SEQ-QTY (PT-DISTRO-IDX)   07669004
076700                       FROM    PT-FCSE-LABELS-NEEDED              07670004
076710                               (PT-DISTRO-IDX)                    07671004
076720                               PV-DISTRO-SUM                      07672004
076730             END-IF                                               07673004
076740         ELSE                                                     07674004
076750             PERFORM 8011A-MOVE-SML-LINES                         07675004
076760                                                                  07676004
076770             IF  PS-ODD-CART-INPK-LBL-NOT-PRT  AND                07677004
076780                 PS-ODD-CART-LABEL                                07678004
076790                 SUBTRACT PC-0001 FROM PT-INPK-LABELS-NEEDED      07679004
076800                                       (PT-DISTRO-IDX)            07680004
076810                                       PV-DISTRO-SUM              07681004
076820                                       PT-INPK-LABEL-SEQ-QTY      07682004
076830                                       (PT-DISTRO-IDX)            07683004
076840             ELSE                                                 07684004
076850                                                                  07685004
076860                 SUBTRACT PT-INPK-LABEL-SEQ-QTY (PT-DISTRO-IDX)   07686004
076870                       FROM    PT-INPK-LABELS-NEEDED              07687004
076880                               (PT-DISTRO-IDX)                    07688004
076890                               PV-DISTRO-SUM                      07689004
076900             END-IF                                               07690004
076910         END-IF                                                   07691004
076920     END-IF.                                                      07692004
076930                                                                  07693004
076940                                                                  07694004
076950 8011A-MOVE-SML-LINES.                                            07695004
076960                                                                  07696004
076970* DMH - 1/03/2005 - BEGIN                                         07697004
076980     IF   PS-DISPLAY-CSSL-YES                                     07698004
076990        INITIALIZE                       PV-CICS-MSG-AREA         07699004
077000        STRING ' PCKCS191- 8011A-MOVE-SML-LINES          '        07700004
077010                                         DELIMITED BY SIZE        07701004
077020                                    INTO PV-CICS-MSG-AREA         07702004
077030        MOVE LENGTH OF PV-CICS-MSG-AREA                           07703004
077040                                      TO PV-COMMAREA-LENGTH       07704004
077050        EXEC CICS                                                 07705004
077060            WRITEQ TD                                             07706004
077070                QUEUE   ('CSSL')                                  07707004
077080                FROM    (PV-CICS-MSG-AREA)                        07708004
077090                LENGTH  (PV-COMMAREA-LENGTH)                      07709004
077100                RESP    (PV-CICS-RESP)                            07710004
077110        END-EXEC                                                  07711004
077120     END-IF.                                                      07712004
077130* DMH - 1/03/2005 - BEGIN                                         07713004
077140                                                                  07714004
077150* THE MANIFEST NUMBERS ARE INCREMENTED AUTOMATICALLY AFTER        07715004
077160* THE FIRST LABEL PRINTED                                         07716004
077170                                                                  07717004
077180     IF PS-FIRST-LABEL                                            07718004
077190         MOVE PT-MANIFEST-START (PT-DISTRO-IDX)                   07719004
077200                               TO PC160-20-SML-BC-MNFST-NBR       07720004
077210                                  PC160-20-SML-NBR-BC-MNFST-NBR   07721004
077220     ELSE                                                         07722004
077230         MOVE PT-MANIFEST-START (PT-DISTRO-IDX)                   07723004
077240                               TO PC160-20-SML-BC-MNFST-NBR       07724004
077250                                  PC160-20-SML-NBR-BC-MNFST-NBR   07725004
077260                                                                  07726004
077270         IF  PC126-SHP-PRTR-PRODMAX                               07727004
077280             SET  PS-ADD-BACK-FOR-MFST-NO  TO  TRUE               07728004
077290             CONTINUE                                             07729004
077291         ELSE                                                     07729104
077292              SUBTRACT 1        FROM                              07729204
077293                                   PC160-20-SML-BC-MNFST-NBR      07729304
077294                                   PC160-20-SML-NBR-BC-MNFST-NBR  07729404
077295              SET  PS-ADD-BACK-FOR-MFST-YES TO  TRUE              07729504
077296         END-IF                                                   07729604
077297     END-IF                                                       07729704
077298                                                                  07729804
077299     ADD  PV-LBL-PRT-QTY-NUMERIC                                  07729904
077300      TO  PT-MANIFEST-START (PT-DISTRO-IDX).                      07730004
077301                                                                  07730104
077302     SET  PC160-20-SML-NBR-INTERNAL-LBL                           07730204
077303          PC160-20-SML-NBR-FROM-KOHLS   TO TRUE                   07730304
077304     MOVE ZEROES            TO PC160-20-SML-NBR-CONTAINER-CDE     07730404
077305     MOVE PC160-20-DIGIT-BARCODE     TO PC159-SML-BC              07730504
077306                                        PC254-SML-BC              07730604
077307     MOVE PC160-20-DIGIT-BARCODE-NBR TO PC159-SML-BC-NBR          07730704
077308                                        PC254-SML-BC-NBR          07730804
077309                                                                  07730904
077310* THE LABEL PRINTER SOFTWARE WILL INCREMENT THE LABEL NUMBERS     07731004
077320* AUTOMATICALLY STARTING WITH THE SECOND LABEL.                   07732004
077330* THIS IS THE SEQUENCE NUMBER FOR ALL THE LABELS BEING PRINTED    07733004
077340* THAT APPEARS ON THE BOTTOM OF EACH LABEL.                       07734004
077350                                                                  07735004
077360     IF PS-PRINT-FCSE-LABELS                                      07736004
077370         SET PS-FCSE-WAS-PRINTED      TO TRUE                     07737004
077380         IF PS-FIRST-LABEL                                        07738004
077390             SET PS-NOT-FIRST-LABEL   TO TRUE                     07739004
077400                                                                  07740004
077410             IF  PS-ODD-CART-FCSE-LBL-NOT-PRT  AND                07741004
077420                 PS-ODD-CART-LABEL                                07742004
077430                 ADD PC-0001          TO PV-FCSE-COUNTER          07743004
077440             ELSE                                                 07744004
077450                                                                  07745004
077460                 ADD PT-FCSE-LABEL-SEQ-QTY(PT-DISTRO-IDX)         07746004
077470                                      TO PV-FCSE-COUNTER          07747004
077480             END-IF                                               07748004
077490             ADD 1                    TO PV-FCSE-COUNTER          07749004
077500                                                                  07750004
077510             IF  PS-ODD-CART-FCSE-LBL-PRTD                        07751004
077520                 ADD 1                TO PV-FCSE-COUNTER          07752004
077530             END-IF                                               07753004
077540                                                                  07754004
077550         ELSE                                                     07755004
077560             IF  PC126-PRT-SHUFFLED   AND                         07756004
077570                 PC126-REPRINT        AND                         07757004
077580                 PC126-SHP-RPRT-FCSE  AND NOT                     07758004
077590                 PT-CS-DC-RTV (PT-DISTRO-IDX)                     07759004
077600                     MOVE PV-COUNT    TO PC254-LABEL-NUMBER-N     07760004
077700                                         PC159-LABEL-NUMBER-N     07770004
077800                 IF  PC126-SHP-PRTR-PRODMAX                       07780004
077810                     SET  PS-ADD-BACK-FOR-MFST-NO  TO  TRUE       07781004
077820                     CONTINUE                                     07782004
077830                 ELSE                                             07783004
077840                     IF  PS-FIRST-CS-LBL-PRT  OR                  07784004
077850                         PS-FIRST-AFTER-FORM-YES                  07785004
077860                         SET  PS-ADD-BACK-FOR-MFST-NO TO TRUE     07786004
077870                     ELSE                                         07787004
077880                         SUBTRACT 1     FROM PC254-LABEL-NUMBER-N 07788004
077890                                             PC159-LABEL-NUMBER-N 07789004
077900                         SET  PS-ADD-BACK-FOR-MFST-YES TO  TRUE   07790004
077910                     END-IF                                       07791004
077920                 END-IF                                           07792004
077930                 IF  PS-ODD-CART-FCSE-LBL-PRTD  AND               07793004
077940                     PC126-REPRINT                                07794004
077950                         ADD  1       TO PC254-LABEL-NUMBER-N     07795004
077960                                         PC159-LABEL-NUMBER-N     07796004
077970                 END-IF                                           07797004
077980             ELSE                                                 07798004
077990                 MOVE PV-FCSE-COUNTER TO PC254-LABEL-NUMBER-N     07799004
078000                                         PC159-LABEL-NUMBER-N     07800004
078010                                                                  07801004
078020                 IF  PC126-SHP-PRTR-PRODMAX                       07802004
078030                     SET  PS-ADD-BACK-FOR-MFST-NO  TO  TRUE       07803004
078040                     ADD PT-FCSE-LABEL-SEQ-QTY(PT-DISTRO-IDX)     07804004
078050                                      TO PV-FCSE-COUNTER          07805004
078060                 ELSE                                             07806004
078070                     IF  PS-FIRST-SML-LBL-PRT       AND           07807004
078080                         PS-CENTRAL-STOCK-LBL-PRTD  AND           07808004
078090                         PS-ODD-CART-FCSE-LBL-PRTD                07809004
078100                         SET  PS-ADD-BACK-FOR-MFST-NO  TO  TRUE   07810004
078110                         CONTINUE                                 07811004
078120                     ELSE                                         07812004
078130                         IF  PS-FIRST-CS-LBL-PRT  OR              07813004
078140                             PS-FIRST-AFTER-FORM-YES              07814004
078150                             SET PS-ADD-BACK-FOR-MFST-NO TO TRUE  07815004
078160                         ELSE                                     07816004
078170                             SUBTRACT 1   FROM                    07817004
078180                                         PC254-LABEL-NUMBER-N     07818004
078190                                         PC159-LABEL-NUMBER-N     07819004
078200                             SET PS-ADD-BACK-FOR-MFST-YES TO TRUE 07820004
078210                         END-IF                                   07821004
078220                     END-IF                                       07822004
078230                     ADD PT-FCSE-LABEL-SEQ-QTY(PT-DISTRO-IDX)     07823004
078240                                      TO PV-FCSE-COUNTER          07824004
078250                 END-IF                                           07825004
078260                                                                  07826004
078270             END-IF                                               07827004
078280         END-IF                                                   07828004
078290                                                                  07829004
078300     ELSE                                                         07830004
078310                                                                  07831004
078320         IF PS-FIRST-LABEL                                        07832004
078330             SET PS-NOT-FIRST-LABEL   TO TRUE                     07833004
078340             ADD PT-INPK-LABEL-SEQ-QTY(PT-DISTRO-IDX)             07834004
078350                                      TO PV-INPK-COUNTER          07835004
078360             ADD 1                    TO PV-INPK-COUNTER          07836004
078370             IF  PS-ODD-CART-INPK-LBL-PRTD                        07837004
078380                 ADD PV-ODD-CRTN-INPK-LBLS-NEED                   07838004
078390                                      TO PV-INPK-COUNTER          07839004
078400             END-IF                                               07840004
078410         ELSE                                                     07841004
078420             IF PC126-PRT-SHUFFLED AND PC126-REPRINT              07842004
078430                 AND PC126-SHP-RPRT-INPK                          07843004
078440                 AND NOT PT-CS-DC-RTV (PT-DISTRO-IDX)             07844004
078450                 MOVE PV-COUNT        TO PC254-LABEL-NUMBER-N     07845004
078460                                         PC159-LABEL-NUMBER-N     07846004
078470                 SUBTRACT 1           FROM                        07847004
078480                                         PC254-LABEL-NUMBER-N     07848004
078490                                         PC159-LABEL-NUMBER-N     07849004
078500             ELSE                                                 07850004
078510                 MOVE PV-INPK-COUNTER TO PC254-LABEL-NUMBER-N     07851004
078520                                         PC159-LABEL-NUMBER-N     07852004
078530                                                                  07853004
078540                 IF  PC126-SHP-PRTR-PRODMAX                       07854004
078550                     SET  PS-ADD-BACK-FOR-MFST-NO  TO  TRUE       07855004
078560                     ADD PT-INPK-LABEL-SEQ-QTY(PT-DISTRO-IDX)     07856004
078570                                      TO PV-INPK-COUNTER          07857004
078580                                                                  07858004
078590                     IF  PT-INPK-LABEL-SEQ-QTY (PT-DISTRO-IDX) = 007859004
078600                         ADD  1  TO PV-INPK-COUNTER               07860004
078610                     END-IF                                       07861004
078620                                                                  07862004
078630                 ELSE                                             07863004
078640                     SET PS-ADD-BACK-FOR-MFST-YES TO  TRUE        07864004
078650                     SUBTRACT 1    FROM                           07865004
078660                                         PC254-LABEL-NUMBER-N     07866004
078670                                         PC159-LABEL-NUMBER-N     07867004
078680                     ADD PT-INPK-LABEL-SEQ-QTY(PT-DISTRO-IDX)     07868004
078690                                      TO PV-INPK-COUNTER          07869004
078700                 END-IF                                           07870004
078710             END-IF                                               07871004
078720         END-IF                                                   07872004
078730     END-IF.                                                      07873004
078740                                                                  07874004
078750     IF PT-STR-ONHAND-ZERO-COUNT (PT-DISTRO-IDX) > 0              07875004
078760        MOVE PT-STR-ONHAND-ZERO-COUNT (PT-DISTRO-IDX)             07876004
078770                                TO PV-STR-ONHAND-ZERO-COUNT       07877004
078780        SUBTRACT 1 FROM                                           07878004
078790                 PT-STR-ONHAND-ZERO-COUNT (PT-DISTRO-IDX)         07879004
078800        IF PC253-OH-ZERO-YES                                      07880004
078810           SET PS-ONHAND-FORM-CHANGE-NO TO TRUE                   07881004
078820        ELSE                                                      07882004
078830           SET PS-LAST-FORM-NONE                                  07883004
078840               PS-ONHAND-FORM-CHANGE-YES                          07884004
078850               PC253-OH-ZERO-YES       TO TRUE                    07885004
078860        END-IF                                                    07886004
078870     ELSE                                                         07887004
078880        IF PC253-OH-ZERO-NO                                       07888004
078890           SET PS-ONHAND-FORM-CHANGE-NO TO TRUE                   07889004
078900        ELSE                                                      07890004
078910           SET PS-LAST-FORM-NONE                                  07891004
078920               PS-ONHAND-FORM-CHANGE-YES                          07892004
078930               PC253-OH-ZERO-NO        TO TRUE                    07893004
078940        END-IF                                                    07894004
078950     END-IF                                                       07895004
078960                                                                  07896004
078970***                                                               07897004
078980*** check if form needs to be resent due to fixture reverse image 07898004
078990***                                                               07899004
079000*dmh IF  PT-FIXT-ID (PT-DISTRO-IDX) > SPACES                      07900004
079010*dmh6/30 IF  PC253-FIXTURE-YES                                    07901004
079020*dmh6/30     SET PS-FIXTURE-FORM-CHANGE-NO TO TRUE                07902004
079030*dmh6/30 ELSE                                                     07903004
079040*dmh6/30     SET PS-LAST-FORM-NONE                                07904004
079050*dmh6/30         PS-FIXTURE-FORM-CHANGE-YES                       07905004
079060*dmh6/30         PC253-FIXTURE-YES       TO TRUE                  07906004
079070*dmh6/30 END-IF                                                   07907004
079080*dmh ELSE                                                         07908004
079090*dmh6/30 IF  PC253-FIXTURE-YES                                    07909004
079100*dmh6/30     SET PS-LAST-FORM-NONE                                07910004
079101*dmh6/30         PS-FIXTURE-FORM-CHANGE-YES                       07910104
079102*dmh6/30         PC253-FIXTURE-NO        TO TRUE                  07910204
079103*dmh END-IF.                                                      07910304
079104                                                                  07910404
079105                                                                  07910504
079106*********************************                                 07910604
079107     IF  PC126-SHP-PRTR-PRODMAX                                   07910704
079108         CONTINUE                                                 07910804
079109     ELSE                                                         07910904
079110         IF PS-ONHAND-FORM-CHANGE-YES AND                         07911004
079111            PS-ADD-BACK-FOR-MFST-YES                              07911104
079112            ADD     1        TO                                   07911204
079113                                PC160-20-SML-BC-MNFST-NBR         07911304
079114                                PC160-20-SML-NBR-BC-MNFST-NBR     07911404
079115                                PC254-LABEL-NUMBER-N              07911504
079116            MOVE PC160-20-DIGIT-BARCODE     TO PC254-SML-BC       07911604
079117            MOVE PC160-20-DIGIT-BARCODE-NBR TO PC254-SML-BC-NBR   07911704
079118            SET  PS-ONHAND-FORM-CHANGE-NO   TO TRUE               07911804
079119            SET  PS-ADD-BACK-FOR-MFST-NO    TO TRUE               07911904
079120         END-IF                                                   07912004
079121     END-IF                                                       07912104
079122**********************************                                07912204
079123     IF  PC126-SHP-XMIT-INTFC-CDE  =  PC-SOCKET-INTERFACE         07912304
079124         IF (PT-CENTRAL-STOCK (PT-DISTRO-IDX)  OR                 07912404
079125             PT-E-COMMERCE    (PT-DISTRO-IDX))                    07912504
079126             IF PS-LAST-FORM-CNTL-STK                             07912604
079127                PERFORM 5455-CS-SML-DATA                          07912704
079128                        VARYING PC159-IDX FROM 1 BY 1             07912804
079129                          UNTIL PC159-IDX > PC159-MAX-LABEL-LINES 07912904
079130                             OR PS-SOCKET-ERROR                   07913004
079131                SET PS-FIRST-CS-LBL-NOT-PRT                       07913104
079132                    PS-CENTRAL-STOCK-LBL-PRTD                     07913204
079133                    PS-FIRST-SML-LBL-PRT       TO  TRUE           07913304
079134             ELSE                                                 07913404
079135                PERFORM 5445-CS-SML-FORM                          07913504
079136                        VARYING PC158-IDX FROM 1 BY 1             07913604
079137                          UNTIL PC158-IDX >                       07913704
079138                                      PC158-SHIP-MFST-LBL-MAX-LN  07913804
079139                             OR PS-SOCKET-ERROR                   07913904
079140                SET  PS-LAST-FORM-CNTL-STK  TO  TRUE              07914004
079141*DMH BEG - 06/04/02                                               07914104
079142                   IF PC126-SHP-PRTR-PRODMAX                      07914204
079143                      CONTINUE                                    07914304
079144                   ELSE                                           07914404
079145                      ADD 1       TO PC160-20-SML-BC-MNFST-NBR    07914504
079146                                     PC160-20-SML-NBR-BC-MNFST-NBR07914604
079147                                     PC159-LABEL-NUMBER-N         07914704
079148                      MOVE PC160-20-DIGIT-BARCODE-NBR             07914804
079149                                  TO PC159-SML-BC-NBR             07914904
079150                      MOVE PC160-20-DIGIT-BARCODE                 07915004
079151                                  TO PC159-SML-BC                 07915104
079152                   END-IF                                         07915204
079153*DMH END - 06/04/02                                               07915304
079154                PERFORM 5455-CS-SML-DATA                          07915404
079155                        VARYING PC159-IDX FROM 1 BY 1             07915504
079156                          UNTIL PC159-IDX > PC159-MAX-LABEL-LINES 07915604
079157                             OR PS-SOCKET-ERROR                   07915704
079158                SET PS-FIRST-CS-LBL-NOT-PRT                       07915804
079159                    PS-CENTRAL-STOCK-LBL-PRTD                     07915904
079160                    PS-FIRST-SML-LBL-PRT       TO  TRUE           07916004
079170             END-IF                                               07917004
079180         ELSE                                                     07918004
079190             IF PS-LAST-FORM-SML                                  07919004
079200                PERFORM 5450-SML-DATA                             07920004
079210                        VARYING PC254-IDX FROM 1 BY 1             07921004
079220                          UNTIL PC254-IDX > PC254-MAX-LABEL-LINES 07922004
079230                             OR PS-SOCKET-ERROR                   07923004
079240                                                                  07924004
079250                                                                  07925004
079260                                                                  07926004
079270                SET PS-FIRST-SML-LBL-NOT-PRT                      07927004
079280                    PS-FIRST-AFTER-FORM-NO   TO TRUE              07928004
079290             ELSE                                                 07929004
079300                                                                  07930004
079310                PERFORM 5440-SML-FORM                             07931004
079320                        VARYING PC253-IDX FROM 1 BY 1             07932004
079330                          UNTIL PC253-IDX >                       07933004
079340                                      PC253-SHIP-MFST-LBL-MAX-LN  07934004
079350                             OR PS-SOCKET-ERROR                   07935004
079360                                                                  07936004
079370*DMH BEG - 06/03/02                                               07937004
079380                IF PS-LAST-FORM-CNTL-STK                          07938004
079390                   IF PC126-SHP-PRTR-PRODMAX                      07939004
079400                      CONTINUE                                    07940004
079410                   ELSE                                           07941004
079420                      ADD 1       TO PC160-20-SML-BC-MNFST-NBR    07942004
079430                                     PC160-20-SML-NBR-BC-MNFST-NBR07943004
079440                      MOVE PC160-20-DIGIT-BARCODE-NBR             07944004
079450                                  TO PC254-SML-BC-NBR             07945004
079460                      MOVE PC160-20-DIGIT-BARCODE                 07946004
079470                                  TO PC254-SML-BC                 07947004
079480                   END-IF                                         07948004
079490               END-IF                                             07949004
079500*DMH END - 06/03/02                                               07950004
079510                                                                  07951004
079520                SET  PS-LAST-FORM-SML  TO  TRUE                   07952004
079530                PERFORM 5450-SML-DATA                             07953004
079540                        VARYING PC254-IDX FROM 1 BY 1             07954004
079550                          UNTIL PC254-IDX > PC254-MAX-LABEL-LINES 07955004
079560                             OR PS-SOCKET-ERROR                   07956004
079570                SET PS-FIRST-SML-LBL-NOT-PRT                      07957004
079580                    PS-FIRST-AFTER-FORM-NO   TO TRUE              07958004
079590             END-IF                                               07959004
079600         END-IF                                                   07960004
079610     END-IF.                                                      07961004
079620                                                                  07962004
079630     IF  PS-SOCKET-ERROR-NO                                       07963004
079640         IF PT-CENTRAL-STOCK (PT-DISTRO-IDX)                      07964004
079650            MOVE PC159-SML-BC           TO  PV-OB-CART-BARCODE    07965004
079660            MOVE PC159-SML-TOT-LBLS     TO  PV-OB-CART-TOT-LBLS   07966004
079670            MOVE PC159-LABEL-NUMBER-N   TO  PV-OB-CART-LBL-PRT-SEQ07967004
079680         ELSE                                                     07968004
079690            MOVE PC160-20-DIGIT-BARCODE     TO PV-OB-CART-BARCODE 07969004
079700            MOVE PC254-LABEL-NUMBER-N   TO  PV-OB-CART-LBL-PRT-SEQ07970004
079710            MOVE PV-LBL-PRT-QTY-NUM-UPD TO  PV-OB-CART-TOT-LBLS   07971004
079720         END-IF                                                   07972004
079730                                                                  07973004
079740         IF PC126-INITIAL-PRINT  and                              07974004
079750            PS-MANIFEST-DC-FOUND                                  07975004
079760             INITIALIZE PV-OB-CART-UPD-COUNTER                    07976004
079770             PERFORM                                              07977004
079780                 VARYING PV-OB-CART-UPD-COUNTER                   07978004
079790                 FROM 1 BY 1                                      07979004
079800                 UNTIL PV-OB-CART-UPD-COUNTER >                   07980004
079810                          PV-OB-CART-TOT-LBLS                     07981004
079820                    PERFORM 8800-UPDATE-OTBND-CART                07982004
079830                       ADD 1 TO PV-OB-CART-LBL-PRT-SEQ            07983004
079840                                PV-OB-CART-BRCDE-18               07984004
079850             END-PERFORM                                          07985004
079860         END-IF                                                   07986004
079870     END-IF.                                                      07987004
083740                                                                  08374004
085221*----------------------------------------------------------------*08522104
085222* GET DEPT NAME & MAJOR CLASS DESCRIPTION                         08522204
085223*----------------------------------------------------------------*08522304
085224 8300-GET-DEPT-NAME.                                              08522404
085225                                                                  08522504
085226* DMH - 1/03/2005 - BEGIN                                         08522604
085227     IF   PS-DISPLAY-CSSL-YES                                     08522704
085228        INITIALIZE                       PV-CICS-MSG-AREA         08522804
085229        STRING ' PCKCS191- 8300-GET-DEPT-NAME            '        08522904
085230                                         DELIMITED BY SIZE        08523004
085231                                    INTO PV-CICS-MSG-AREA         08523104
085232        MOVE LENGTH OF PV-CICS-MSG-AREA                           08523204
085233                                      TO PV-COMMAREA-LENGTH       08523304
085234        EXEC CICS                                                 08523404
085235            WRITEQ TD                                             08523504
085236                QUEUE   ('CSSL')                                  08523604
085237                FROM    (PV-CICS-MSG-AREA)                        08523704
085238                LENGTH  (PV-COMMAREA-LENGTH)                      08523804
085239                RESP    (PV-CICS-RESP)                            08523904
085240        END-EXEC                                                  08524004
085250     END-IF.                                                      08525004
085260* DMH - 1/03/2005 - BEGIN                                         08526004
085270                                                                  08527004
085280     SET DP003-MCL-LOOKUP              TO TRUE.                   08528004
085290     SET DP003-DPT-LOOKUP              TO TRUE.                   08529004
085300                                                                  08530004
085310     MOVE 'MP'                         TO DP003-SYSTEM-CODE.      08531004
085320     MOVE '03'                         TO DP003-OP-CO-NMBR.       08532004
085330     MOVE PV-CURRENT-YY                TO PV-DPKUT038-YY.         08533004
085340     MOVE PV-CURRENT-MM                TO PV-DPKUT038-MM.         08534004
085350     MOVE PV-CURRENT-DD                TO PV-DPKUT038-DD          08535004
085360     MOVE PV-DPKUT038-DATE             TO DP003-CURRENT-DATE      08536004
085370                                          DP003-EFF-DATE.         08537004
085380     MOVE PC126-DEPT-NBR               TO DP003-DPT-INPUT.        08538004
085390     MOVE PC126-CL-NBR                 TO PV-DPKUT038-MJR-CL.     08539004
085400     MOVE ZERO                         TO PV-DPKUT038-MJR-CL-2.   08540004
085410     MOVE PV-DPKUT038-MJR-CL           TO DP003-MCL-INPUT.        08541004
085420                                                                  08542004
085430     EXEC CICS                                                    08543004
085431         LINK PROGRAM  (PV-DPKUT038)                              08543104
085432              COMMAREA (DP003-MBS-SUBROUTINE-FIELDS)              08543204
085433              LENGTH   (PV-DPKUT038-CA-LENGTH)                    08543304
085434              RESP     (PV-DPKUT038-CICS-RESP)                    08543404
085435     END-EXEC.                                                    08543504
085436                                                                  08543604
085437     EVALUATE TRUE                                                08543704
085438         WHEN PV-DPKUT038-CICS-RESP = DFHRESP (NORMAL)            08543804
085439              SET  PC253-FORM-NO-POG-NAME TO TRUE                 08543904
085440              MOVE DP003-DPT-DESCRIPTION TO PV-DEPT-DESC          08544004
085443              MOVE DP003-MCL-DESCRIPTION TO PV-MAJ-CL-DESC        08544304
085446         WHEN OTHER                                               08544604
085447              SET  PC253-FORM-NO-POG-NAME TO TRUE                 08544704
085490     END-EVALUATE.                                                08549004
085500     SET PC253-FORM-NO-POG-NAME   TO TRUE                         08550004
085501*CLP 06/19/2015 START                                             08550117
085510     IF PS-BRAND-FOUND-YES                                        08551017
085512        PERFORM 8302-INSPECT-BUS-AREA                             08551230
085513        MOVE PV-BUS-AREA-BRAND    TO PC253-POG-PROGRAM-NAME       08551335
085534*CLP 06/19/2015 END                                               08553425
085540     ELSE                                                         08554004
085550        STRING PV-DEPT-DESC                DELIMITED BY '  '      08555004
085560                     '/'                   DELIMITED BY SIZE      08556004
085570                 PV-MAJ-CL-DESC            DELIMITED BY '   '     08557004
085580                                INTO PC253-POG-PROGRAM-NAME       08558004
085590     END-IF.                                                      08559004
085600                                                                  08560004
085601*CLP 06/19/2015 START                                             08560130
085602***************************************************************** 08560230
085603* ONLY BRING BACK AS MANY CHARACTERS UP TO 9 FOR THE BUSINESS     08560330
085604* AREA DESCRIPTION                                                08560430
085605***************************************************************** 08560530
085610 8302-INSPECT-BUS-AREA.                                           08561030
085611                                                                  08561130
085612     MOVE XL073-BUS-AREA-DESC(1:9) TO PV-BUS-AREA-DESC-9.         08561240
085613                                                                  08561340
085614     MOVE +0                               TO PV-DESC-LEN.        08561440
085615     MOVE LENGTH OF PV-BUS-AREA-DESC-9     TO PV-DESC-LEN.        08561540
085616                                                                  08561640
085617     PERFORM                                                      08561740
085618       UNTIL PV-BUS-AREA-DESC-9(PV-DESC-LEN:1) > SPACES OR        08561840
085619         PV-DESC-LEN = +0                                         08561940
085620       COMPUTE PV-DESC-LEN   = PV-DESC-LEN - 1                    08562040
085621     END-PERFORM.                                                 08562140
085622                                                                  08562240
085628     MOVE SPACES  TO  PV-BUS-AREA-BRAND.                          08562830
085629                                                                  08562930
085630     EVALUATE TRUE                                                08563040
085631        WHEN  PV-DESC-LEN   =  9                                  08563140
085632            STRING   PV-BUS-AREA-DESC-9(1:9)                      08563240
085633                                 '-'                              08563340
085634                     XLT00043-BRND-DESC DELIMITED BY SIZE         08563440
085635            INTO  PV-BUS-AREA-BRAND                               08563540
085636        WHEN  PV-DESC-LEN   =  8                                  08563640
085637            STRING   PV-BUS-AREA-DESC-9(1:8)                      08563740
085638                                 '-'                              08563840
085639                     XLT00043-BRND-DESC DELIMITED BY SIZE         08563940
085640            INTO  PV-BUS-AREA-BRAND                               08564040
085641        WHEN  PV-DESC-LEN   =  7                                  08564140
085642            STRING   PV-BUS-AREA-DESC-9(1:7)                      08564240
085643                                 '-'                              08564340
085644                     XLT00043-BRND-DESC DELIMITED BY SIZE         08564440
085645            INTO  PV-BUS-AREA-BRAND                               08564540
085646        WHEN  PV-DESC-LEN   =  6                                  08564640
085647            STRING   PV-BUS-AREA-DESC-9(1:6)                      08564740
085648                                 '-'                              08564840
085649                     XLT00043-BRND-DESC DELIMITED BY SIZE         08564940
085650            INTO  PV-BUS-AREA-BRAND                               08565040
085651        WHEN  PV-DESC-LEN   =  5                                  08565140
085652            STRING   PV-BUS-AREA-DESC-9(1:5)                      08565241
085653                                 '-'                              08565340
085654                     XLT00043-BRND-DESC DELIMITED BY SIZE         08565440
085655            INTO  PV-BUS-AREA-BRAND                               08565540
085656        WHEN  PV-DESC-LEN   =  4                                  08565640
085657            STRING   PV-BUS-AREA-DESC-9(1:4)                      08565740
085658                                 '-'                              08565840
085659                     XLT00043-BRND-DESC DELIMITED BY SIZE         08565940
085660            INTO  PV-BUS-AREA-BRAND                               08566040
085661        WHEN  PV-DESC-LEN   =  3                                  08566140
085662            STRING   PV-BUS-AREA-DESC-9(1:3)                      08566240
085663                                 '-'                              08566340
085664                     XLT00043-BRND-DESC DELIMITED BY SIZE         08566440
085665            INTO  PV-BUS-AREA-BRAND                               08566540
085666        WHEN  PV-DESC-LEN   =  2                                  08566640
085667            STRING   PV-BUS-AREA-DESC-9(1:2)                      08566740
085668                                 '-'                              08566840
085669                     XLT00043-BRND-DESC DELIMITED BY SIZE         08566940
085670            INTO  PV-BUS-AREA-BRAND                               08567040
085671        WHEN  PV-DESC-LEN   =  1                                  08567140
085672            STRING   PV-BUS-AREA-DESC-9(1:1)                      08567240
085673                                 '-'                              08567340
085674                     XLT00043-BRND-DESC DELIMITED BY SIZE         08567440
085675            INTO  PV-BUS-AREA-BRAND                               08567540
085676        WHEN  OTHER                                               08567640
085677*           NO BUSINESS AREA AVAILABLE                            08567740
085678            STRING   PV-BUS-AREA-DESC-9(1:9)                      08567840
085679                                 '-'                              08567940
085680                     XLT00043-BRND-DESC DELIMITED BY SIZE         08568040
085681            INTO  PV-BUS-AREA-BRAND                               08568140
085682     END-EVALUATE.                                                08568240
085725                                                                  08572531
085726*CLP 06/19/2015 END                                               08572630
085727                                                                  08572730
085728 8305-CALL-SET-FIXT-ID-MOD.                                       08572830
085729                                                                  08572904
085730* DMH - 1/03/2005 - BEGIN                                         08573004
085731     IF   PS-DISPLAY-CSSL-YES                                     08573104
085732        INITIALIZE                       PV-CICS-MSG-AREA         08573204
085733        STRING ' PCKCS191- 8305-CALL-SET-FIXT-ID-MOD     '        08573304
085734                                         DELIMITED BY SIZE        08573404
085735                                    INTO PV-CICS-MSG-AREA         08573504
085736        MOVE LENGTH OF PV-CICS-MSG-AREA                           08573604
085737                                      TO PV-COMMAREA-LENGTH       08573704
085738        EXEC CICS                                                 08573804
085739            WRITEQ TD                                             08573904
085740                QUEUE   ('CSSL')                                  08574004
085741                FROM    (PV-CICS-MSG-AREA)                        08574104
085750                LENGTH  (PV-COMMAREA-LENGTH)                      08575004
085760                RESP    (PV-CICS-RESP)                            08576004
085770        END-EXEC                                                  08577004
085780     END-IF.                                                      08578004
085790* DMH - 1/03/2005 - BEGIN                                         08579004
085800                                                                  08580004
085810     INITIALIZE PC240-ITEM-COMMAREA                               08581004
085820     MOVE PV-KEY-DEST-LOC               TO PC240-KEY-DEST-LOC     08582004
085821     MOVE PC126-PO-NBR                  TO PC240-KEY-PO           08582104
085822     MOVE PC126-SKU                     TO PC240-KEY-SKU          08582204
085823                                                                  08582304
085824     IF PC126-PRE-PACK-ORDER                                      08582404
085825        SET PC240-PREPK-ORDER-YES       TO TRUE                   08582504
085826        MOVE PC126-PREPK-ID             TO PC240-KEY-PREPK-ID     08582604
085827        MOVE PC126-RCVR-SEQ-NBR         TO PC240-KEY-REC-SEQ-NBR  08582704
085828     ELSE                                                         08582804
085829        SET PC240-PREPK-ORDER-NO        TO TRUE                   08582904
085830     END-IF                                                       08583004
085840                                                                  08584004
085850                                                                  08585004
085860     IF  PS-P2L-LABEL-PROCESS                                     08586004
085870         SET PC240-SET-NAME-ONLY TO TRUE                          08587004
085880     ELSE                                                         08588004
085890         SET PC240-CSEPK-SPLIT   TO TRUE                          08589004
085900     END-IF.                                                      08590004
085910                                                                  08591004
085920     CALL PC240-VSM-PGM USING DFHEIBLK                            08592004
085930                              PC240-COMMAREA                      08593004
085940                              PC240-ITEM-COMMAREA                 08594004
085950     EVALUATE TRUE                                                08595004
085960         WHEN PC240-SUCCESSFUL                                    08596004
085970                                                                  08597004
085971             IF PC240-NO-SEASONAL-SET-FOUND                       08597104
085972* rpk 08/09     SET PS-NO-SEASET-DATA-FOUND TO TRUE               08597204
085973                MOVE SPACES TO PV-SEASET-SHRT-NM                  08597304
085974                               PV-SEASET-RLSE-DT                  08597404
085975             ELSE                                                 08597504
085976                MOVE PC240-SEASET-SHRT-NM TO PV-SEASET-SHRT-NM    08597604
085977                MOVE PC240-STR-RLSE-END-DTE TO PV-SEASET-RLSE-DT  08597704
085978             END-IF                                               08597804
085979                                                                  08597904
085980             IF PC240-DIVERT-PFX-NBR = ZEROES                     08598004
085990                MOVE ZEROES TO PV-STORE-NBR-PFX                   08599004
086000             ELSE                                                 08600004
086010                MOVE PC240-DIVERT-PFX-NBR TO PV-STORE-NBR-PFX     08601004
086020             END-IF                                               08602004
086030                                                                  08603004
086040             IF PC240-POG-SEASET-IND = 'Y'                        08604004
086050                SET PS-POG-DATA-FOUND TO TRUE                     08605004
086060             ELSE                                                 08606004
086070                IF (PC240-POG-SEASET-YR    > SPACES) AND          08607004
086080                   (PC240-POG-SEASET-SHRT-NM  > SPACES)           08608004
086090                   SET PS-POG-DATA-FOUND TO TRUE                  08609004
086100                ELSE                                              08610004
086101                   SET PS-NO-POG-DATA-FOUND TO TRUE               08610104
086102*                  MOVE SPACES            TO PC240-SEASET-NM      08610204
086103*                  MOVE SPACES            TO PC240-SEASET-SHRT-NM 08610304
086104                END-IF                                            08610404
086105             END-IF                                               08610504
086106                                                                  08610604
086107         WHEN PC240-ITEM-NOT-FOUND                                08610704
086108             MOVE ZEROES               TO PV-STORE-NBR-PFX        08610804
086109             MOVE PC240-SEASET-NM      TO SEASET-SEASET-NM        08610904
086110         WHEN PC240-SQL-ERROR                                     08611004
086120         WHEN PC240-INVALID-ACCESS                                08612004
086130              INITIALIZE  PV-CICS-MSG-AREA                        08613004
086140              MOVE PC240-ERROR-NBR     TO   PV-SQL-RETURN-CD      08614004
086150              MOVE PC240-KEY-DEST-LOC  TO   PV-display-store      08615004
086160              STRING ' PCKCS191 (OTHER) - ' DELIMITED BY SIZE     08616004
086170                     '8305-CALL-SET-FIXT-'  DELIMITED BY SIZE     08617004
086180                     ' RETURN MESSAGE - '   DELIMITED BY SIZE     08618004
086190                                       INTO PV-CICS-MSG-AREA      08619004
086200              MOVE LENGTH OF PV-CICS-MSG-AREA                     08620004
086210                     TO PV-COMMAREA-LENGTH                        08621004
086220              PERFORM 9999-WRITE-TO-CSSL                          08622004
086230              INITIALIZE  PV-CICS-MSG-AREA                        08623004
086240              STRING ' PCKCS191 -'         DELIMITED BY SIZE      08624004
086250                     ' PO:'                DELIMITED BY SIZE      08625004
086260                     PC126-PO-NBR          DELIMITED BY SIZE      08626004
086270                     ' RCVR:'              DELIMITED BY SIZE      08627004
086280                     PC126-RCVR-SEQ-NBR    DELIMITED BY SIZE      08628004
086290                     ' LINE:'              DELIMITED BY SIZE      08629004
086300                     PC126-PO-LNE-NBR      DELIMITED BY SIZE      08630004
086310                     ' STR:'               DELIMITED BY SIZE      08631004
086320                     pv-display-store      DELIMITED BY SIZE      08632004
086330                                       INTO PV-CICS-MSG-AREA      08633004
086340              MOVE LENGTH OF PV-CICS-MSG-AREA                     08634004
086350                     TO PV-COMMAREA-LENGTH                        08635004
086360              PERFORM 9999-WRITE-TO-CSSL                          08636004
086370              STRING 'ERR FILE# SQL='                             08637004
086380                         DELIMITED BY SIZE                        08638004
086390                         PV-SQL-RETURN-CD                         08639004
086400                         DELIMITED BY SIZE                        08640004
086410                                INTO PC126-CRA-RET-MSG            08641004
086420              MOVE '02'                TO PC126-CRA-RET-CDE       08642004
086430              MOVE '8305-'             TO PC126-CRA-REQ-ID        08643004
086440              PERFORM 9000-RETURN-CALL                            08644004
086450                                                                  08645004
086460         WHEN OTHER                                               08646004
086470              INITIALIZE  PV-CICS-MSG-AREA                        08647004
086480              MOVE PC240-ERROR-NBR     TO   PV-SQL-RETURN-CD      08648004
086490              STRING ' PCKCS191 (OTHER) - ' DELIMITED BY SIZE     08649004
086500                     '8305-CALL-SET-FIXT-'  DELIMITED BY SIZE     08650004
086510                     ' RETURN MESSAGE - '   DELIMITED BY SIZE     08651004
086520                                       INTO PV-CICS-MSG-AREA      08652004
086530              MOVE LENGTH OF PV-CICS-MSG-AREA                     08653004
086540                     TO PV-COMMAREA-LENGTH                        08654004
086550              PERFORM 9999-WRITE-TO-CSSL                          08655004
086560              INITIALIZE  PV-CICS-MSG-AREA                        08656004
086570              STRING ' PCKCS191 -'         DELIMITED BY SIZE      08657004
086580                     ' PO:'                DELIMITED BY SIZE      08658004
086590                     PC126-PO-NBR          DELIMITED BY SIZE      08659004
086600                     ' RCVR:'              DELIMITED BY SIZE      08660004
086610                     PC126-RCVR-SEQ-NBR    DELIMITED BY SIZE      08661004
086620                     ' LINE:'              DELIMITED BY SIZE      08662004
086630                     PC126-PO-LNE-NBR      DELIMITED BY SIZE      08663004
086640                     ' STR:'               DELIMITED BY SIZE      08664004
086650                     DK-STORE-NMBR         DELIMITED BY SIZE      08665004
086660                                       INTO PV-CICS-MSG-AREA      08666004
086670              MOVE LENGTH OF PV-CICS-MSG-AREA                     08667004
086680                     TO PV-COMMAREA-LENGTH                        08668004
086690              PERFORM 9999-WRITE-TO-CSSL                          08669004
086700              STRING 'ERR FILE# SQL='                             08670004
086710                         DELIMITED BY SIZE                        08671004
086720                         PV-SQL-RETURN-CD                         08672004
086730                         DELIMITED BY SIZE                        08673004
086740                                INTO PC126-CRA-RET-MSG            08674004
086750              MOVE '02'                TO PC126-CRA-RET-CDE       08675004
086760              MOVE '8305-'             TO PC126-CRA-REQ-ID        08676004
086770              PERFORM 9000-RETURN-CALL                            08677004
086780                                                                  08678004
086790                                                                  08679004
086800     END-EVALUATE.                                                08680004
086810                                                                  08681004
086820******************************************************************08682004
086830 8400-LABEL-MANIFESTING.                                          08683004
086840******************************************************************08684004
086850                                                                  08685004
086860* DMH - 1/03/2005 - BEGIN                                         08686004
086870     IF   PS-DISPLAY-CSSL-YES                                     08687004
086880        INITIALIZE                       PV-CICS-MSG-AREA         08688004
086890        STRING ' PCKCS191- 8400-LABEL-MANIFESTING        '        08689004
086900                                         DELIMITED BY SIZE        08690004
086910                                    INTO PV-CICS-MSG-AREA         08691004
086920        MOVE LENGTH OF PV-CICS-MSG-AREA                           08692004
086930                                      TO PV-COMMAREA-LENGTH       08693004
086940        EXEC CICS                                                 08694004
086950            WRITEQ TD                                             08695004
086960                QUEUE   ('CSSL')                                  08696004
086970                FROM    (PV-CICS-MSG-AREA)                        08697004
086980                LENGTH  (PV-COMMAREA-LENGTH)                      08698004
086990                RESP    (PV-CICS-RESP)                            08699004
087000        END-EXEC                                                  08700004
087010     END-IF.                                                      08701004
087020* DMH - 1/03/2005 - BEGIN                                         08702004
087030                                                                  08703004
087040     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1 UNTIL              08704004
087050                  PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR       08705004
087060                  PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR       08706004
087070                  PT-DISTRO-IDX > 1000                            08707004
087080              OR  PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES       08708004
087090                                                                  08709004
087100        MOVE PT-MANIFEST-START (PT-DISTRO-IDX)                    08710004
087110                                     TO PC180-SML-MNFST-NBR       08711004
087120******************************************************************08712004
087130**  ODD CARTON INPK PROCESSING             ***********************08713004
087140******************************************************************08714004
087150      IF PT-ODD-CART-INPK (PT-DISTRO-IDX)                         08715004
087160         MOVE 1                   TO  PC180-LABELS-NEEDED         08716004
087170         SUBTRACT 1 FROM                                          08717004
087180             PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX) GIVING         08718004
087190             PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)                08719004
087200                                                                  08720004
087210         MOVE PC126-OPER-UNT-ID   TO  PC180-SML-DC-ORIGIN         08721004
087211                                      PC180-OPER-UNT-ID           08721104
087212         SET PC180-SML-INTERNAL-LBL                               08721204
087213             PC180-SML-FROM-KOHLS TO  TRUE                        08721304
087214                                                                  08721404
087215         MOVE PT-DIVERT-CODE (PT-DISTRO-IDX)                      08721504
087216                                  TO PC180-SML-DIVERT             08721604
087217         MOVE PC126-OTPK-UNT-QTY  TO PC180-OTPK-UNT-QTY           08721704
087218                                                                  08721804
087219                                                                  08721904
087220        PERFORM  8450-TABLE-INSERTS-FOR-MFST                      08722004
087221                                                                  08722104
087222      END-IF                                                      08722204
087223******************************************************************08722304
087224**  FULL CASE LABEL PROCESSING             ***********************08722404
087225******************************************************************08722504
087226      IF PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX) > 0                08722604
087227         MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)               08722704
087228                                  TO  PC180-LABELS-NEEDED         08722804
087229                                                                  08722904
087230         MOVE PC126-OPER-UNT-ID   TO  PC180-SML-DC-ORIGIN         08723004
087240                                      PC180-OPER-UNT-ID           08724004
087250         SET PC180-SML-INTERNAL-LBL                               08725004
087260             PC180-SML-FROM-KOHLS TO  TRUE                        08726004
087270                                                                  08727004
087280         MOVE PT-DIVERT-CODE (PT-DISTRO-IDX)                      08728004
087290                                  TO PC180-SML-DIVERT             08729004
087300         IF PT-ODD-CART-FCSE (PT-DISTRO-IDX)                      08730004
087310            MOVE PC126-ODD-CRTN-UNT-QTY TO PC180-OTPK-UNT-QTY     08731004
087320            SET PS-ODD-CART-FCSE-INSERT   TO TRUE                 08732004
087330            SET PS-ODD-CART-FCSE-NOT-DONE TO TRUE                 08733004
087340         ELSE                                                     08734004
087350            MOVE PC126-OTPK-UNT-QTY     TO PC180-OTPK-UNT-QTY     08735004
087360            SET PS-ODD-CART-FCSE-NO-INSERT TO TRUE                08736004
087370            SET PS-ODD-CART-FCSE-NOT-DONE  TO TRUE                08737004
087380         END-IF                                                   08738004
087390                                                                  08739004
087400         PERFORM  8450-TABLE-INSERTS-FOR-MFST                     08740004
087410                                                                  08741004
087420      END-IF                                                      08742004
087430******************************************************************08743004
087440**  INNER PACK CNVYBLE LABEL PROCESSING                 **********08744004
087450******************************************************************08745004
087460                                                                  08746004
087470      IF PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX) > 0                08747004
087480         MOVE PT-INPK-LABELS-NEEDED (PT-DISTRO-IDX)               08748004
087490                                  TO  PC180-LABELS-NEEDED         08749004
087500                                                                  08750004
087510         MOVE PC126-OPER-UNT-ID   TO  PC180-SML-DC-ORIGIN         08751004
087520                                      PC180-OPER-UNT-ID           08752004
087530         SET PC180-SML-INTERNAL-LBL                               08753004
087540             PC180-SML-FROM-KOHLS  TO  TRUE                       08754004
087550                                                                  08755004
087560         MOVE PT-DIVERT-CODE (PT-DISTRO-IDX)                      08756004
087570                                   TO PC180-SML-DIVERT            08757004
087580         MOVE PC126-INPK-UNT-QTY TO PC180-OTPK-UNT-QTY            08758004
087590         SET PS-INPK-UNIT-QTY-YES  TO TRUE                        08759004
087600                                                                  08760004
087610         PERFORM  8450-TABLE-INSERTS-FOR-MFST                     08761004
087620*GB 3/9/05                                                        08762004
087630         SET PS-INPK-UNIT-QTY-NO   TO TRUE                        08763004
087640      END-IF                                                      08764004
087650     END-PERFORM.                                                 08765004
087660                                                                  08766004
087670******************************************************************08767004
087680 8401-LABEL-MANIFESTING-RDM.                                      08768004
087690******************************************************************08769004
087700                                                                  08770004
087710* DMH - 1/03/2005 - BEGIN                                         08771004
087720     IF   PS-DISPLAY-CSSL-YES                                     08772004
087730        INITIALIZE                       PV-CICS-MSG-AREA         08773004
087740        STRING ' PCKCS191- 8401-LABEL-MANIFESTING-RDM    '        08774004
087750                                         DELIMITED BY SIZE        08775004
087760                                    INTO PV-CICS-MSG-AREA         08776004
087770        MOVE LENGTH OF PV-CICS-MSG-AREA                           08777004
087780                                      TO PV-COMMAREA-LENGTH       08778004
087790        EXEC CICS                                                 08779004
087800            WRITEQ TD                                             08780004
087810                QUEUE   ('CSSL')                                  08781004
087820                FROM    (PV-CICS-MSG-AREA)                        08782004
087830                LENGTH  (PV-COMMAREA-LENGTH)                      08783004
087840                RESP    (PV-CICS-RESP)                            08784004
087850        END-EXEC                                                  08785004
087860     END-IF.                                                      08786004
087870* DMH - 1/03/2005 - BEGIN                                         08787004
087880                                                                  08788004
087890     PERFORM VARYING PT-DISTRO-IDX FROM 1 BY 1 UNTIL              08789004
087900                  PT-STORE-NMBR (PT-DISTRO-IDX) = SPACES OR       08790004
087910                  PT-STORE-NMBR (PT-DISTRO-IDX) = ZEROES OR       08791004
087920                  PT-DISTRO-IDX > 1000                            08792004
087930              OR  PT-DISTRO-IDX > PV-PT-LABEL-TABLE-ENTRIES       08793004
087940                                                                  08794004
087950        MOVE PT-MANIFEST-START (PT-DISTRO-IDX)                    08795004
087960                                     TO PC180-SML-MNFST-NBR       08796004
087970******************************************************************08797004
087980**  FULL CASE LABEL PROCESSING             ***********************08798004
087990******************************************************************08799004
088000      IF PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX) > 0                08800004
088010        IF PT-CENTRAL-STOCK (PT-DISTRO-IDX) OR                    08801004
088011              PT-E-COMMERCE  (PT-DISTRO-IDX)                      08801104
088012           MOVE PT-STR-NBR (PT-DISTRO-IDX) TO                     08801204
088013                                        DK-CS-ECOMM-STORE-LOC     08801304
088014           PERFORM 1150-CHECK-FOR-BLIND-RECEIVING                 08801404
088015           IF PS-BLND-RECV-SIMPL-LOC-FND                          08801504
088016              MOVE PT-FCSE-LABELS-NEEDED (PT-DISTRO-IDX)          08801604
088017                                  TO  PC180-LABELS-NEEDED         08801704
088018                                                                  08801804
088019              MOVE PC126-OPER-UNT-ID   TO  PC180-SML-DC-ORIGIN    08801904
088020                                           PC180-OPER-UNT-ID      08802004
088021              SET PC180-SML-INTERNAL-LBL                          08802104
088022                  PC180-SML-FROM-KOHLS TO  TRUE                   08802204
088023                                                                  08802304
088024              MOVE PT-DIVERT-CODE (PT-DISTRO-IDX)                 08802404
088025                                   TO PC180-SML-DIVERT            08802504
088026              IF PT-ODD-CART-FCSE (PT-DISTRO-IDX)                 08802604
088027                 MOVE PC126-ODD-CRTN-UNT-QTY                      08802704
088028                                     TO PC180-OTPK-UNT-QTY        08802804
088029                 SET PS-ODD-CART-FCSE-INSERT TO TRUE              08802904
088030              ELSE                                                08803004
088040                 MOVE PC126-OTPK-UNT-QTY                          08804004
088050                                     TO PC180-OTPK-UNT-QTY        08805004
088060                 SET PS-ODD-CART-FCSE-NO-INSERT TO TRUE           08806004
088070              END-IF                                              08807004
088080                                                                  08808004
088090              SET PS-INPK-UNIT-QTY-NO   TO TRUE                   08809004
088100                                                                  08810004
088110              PERFORM  8450-TABLE-INSERTS-FOR-MFST                08811004
088120           END-IF                                                 08812004
088130        END-IF                                                    08813004
088140      END-IF                                                      08814004
088150     END-PERFORM.                                                 08815004
088160                                                                  08816004
088170******************************************************************08817004
088180 8450-TABLE-INSERTS-FOR-MFST.                                     08818004
088190******************************************************************08819004
088200                                                                  08820004
088210* DMH - 1/03/2005 - BEGIN                                         08821004
088220     IF   PS-DISPLAY-CSSL-YES                                     08822004
088230        INITIALIZE                       PV-CICS-MSG-AREA         08823004
088240        STRING ' PCKCS191- 8450-TABLE-INSERTS-FOR-MFST   '        08824004
088250                                         DELIMITED BY SIZE        08825004
088260                                    INTO PV-CICS-MSG-AREA         08826004
088270        MOVE LENGTH OF PV-CICS-MSG-AREA                           08827004
088280                                      TO PV-COMMAREA-LENGTH       08828004
088290        EXEC CICS                                                 08829004
088300            WRITEQ TD                                             08830004
088310                QUEUE   ('CSSL')                                  08831004
088320                FROM    (PV-CICS-MSG-AREA)                        08832004
088330                LENGTH  (PV-COMMAREA-LENGTH)                      08833004
088340                RESP    (PV-CICS-RESP)                            08834004
088350        END-EXEC                                                  08835004
088360     END-IF.                                                      08836004
088370* DMH - 1/03/2005 - BEGIN                                         08837004
088380                                                                  08838004
088390     PERFORM VARYING PV-INSERT-COUNTER FROM 1 BY 1                08839004
088400              UNTIL PV-INSERT-COUNTER > PC180-LABELS-NEEDED       08840004
088410*INSERT TO SUT_OTBND_CART                                         08841004
088420         PERFORM 8500-INSERT-OTBND-CART                           08842004
088430                                                                  08843004
088440              SET   PS-NOT-EO-PREPK-CSR   TO   TRUE               08844004
088450              IF PC126-PRE-PACK-ORDER                             08845004
088460* DMH - 1/5/05 - BEGIN                                            08846004
088470                 IF  PS-ODD-CART-FCSE-INSERT  AND                 08847004
088480                     PS-ODD-CART-FCSE-DONE                        08848004
088490                     IF  PC126-PREPK-RATIO   > 0  AND             08849004
088491                         PC126-OTPK-UNT-QTY  >  0                 08849104
088492                         DIVIDE  PC126-OTPK-UNT-QTY               08849204
088493                             BY  PC126-PREPK-RATIO                08849304
088494                         GIVING  PV-PREPK-MULTIPLE                08849404
088495                     ELSE                                         08849504
088496                         MOVE  ZEROES  TO  PV-PREPK-MULTIPLE      08849604
088497                     END-IF                                       08849704
088498                 ELSE                                             08849804
088499* DMH - 1/5/05 - END                                              08849904
088500                 IF  PC126-PREPK-RATIO   > 0  AND                 08850004
088501                     PC180-OTPK-UNT-QTY  >  0                     08850104
088502                     DIVIDE  PC180-OTPK-UNT-QTY                   08850204
088503                         BY  PC126-PREPK-RATIO                    08850304
088504                     GIVING  PV-PREPK-MULTIPLE                    08850404
088505                 ELSE                                             08850504
088506                     MOVE  ZEROES  TO  PV-PREPK-MULTIPLE          08850604
088507                 END-IF                                           08850704
088508                 END-IF                                           08850804
088509                 PERFORM 8475-POPULATE-OTBND-PACK                 08850904
088510                 PERFORM 8530-OPEN-PREPK-LINE-CURSOR              08851004
088511                 PERFORM 8540-FETCH-PREPK-LINE-CURSOR             08851104
088512                           UNTIL PS-EO-PREPK-CSR                  08851204
088513                 PERFORM 8550-CLOSE-PREPK-LINE-CURSOR             08851304
088514              ELSE                                                08851404
088515                 PERFORM 8570-CALL-XLKUT001                       08851504
088516              END-IF                                              08851604
088517                                                                  08851704
088518         IF  PS-ODD-CART-FCSE-INSERT  AND                         08851804
088519             PS-ODD-CART-FCSE-NOT-DONE                            08851904
088520             SET PS-ODD-CART-FCSE-DONE  TO  TRUE                  08852004
088530         END-IF                                                   08853004
088540                                                                  08854004
088550         PERFORM 8670-INSERT-TSULBXF                              08855004
088560******************************************************************08856004
088561*   check  balance on hand by carton  - STORE CARTONS            *08856104
088562******************************************************************08856204
088563         PERFORM 2200-PROCESS-BAL-ON-HAND                         08856304
088564******************************************************************08856404
088565                                                                  08856504
088566* BBR WR41309 - ADD CALL TO SEE IF RFID                           08856604
088567*        IF PC126-AUTO-CONVEY-NO-CRTNS                            08856704
088568*            CONTINUE                                             08856804
088569*        ELSE                                                     08856904
088570             PERFORM 8460-CHECK-IF-RFID                           08857004
088580*        END-IF                                                   08858004
088590* BBR WR41309 - END                                               08859004
088600                                                                  08860004
088610         ADD  +1   TO   PC180-SML-MNFST-NBR                       08861004
088620      END-PERFORM.                                                08862004
088630                                                                  08863004
088640* BBR WR41309 - CALL RFID DETERMINATION MODULE                    08864004
088650*----------------------------------------------------------------*08865004
088660 8460-CHECK-IF-RFID.                                              08866004
088670                                                                  08867004
088680     IF   PS-DISPLAY-CSSL-YES                                     08868004
088681         MOVE PC126-PREPK-ID TO PV-PREPACK-IND                    08868104
088682         STRING ' PCKCS191- 8460-CHECK-IF-RFID '                  08868204
088683                                   DELIMITED BY SIZE              08868304
088684                ' PO:'                    DELIMITED BY SIZE       08868404
088685                PC126-PO-NBR              DELIMITED BY SIZE       08868504
088686                ' RCVR:'                  DELIMITED BY SIZE       08868604
088687                PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE       08868704
088688                ' UNT-ID:'                DELIMITED BY SIZE       08868804
088689                PC126-OPER-UNT-ID         DELIMITED BY SIZE       08868904
088690                ' PKG-CD: '               DELIMITED BY SIZE       08869004
088691                PC126-PKGNG-CD            DELIMITED BY SIZE       08869104
088692                ' DPT: '                  DELIMITED BY SIZE       08869204
088693                PC126-DEPT-NBR            DELIMITED BY SIZE       08869304
088694                                         INTO PV-CICS-MSG-AREA    08869404
088695         MOVE LENGTH OF PV-CICS-MSG-AREA                          08869504
088696                   TO PV-COMMAREA-LENGTH                          08869604
088697         PERFORM 9999-WRITE-TO-CSSL                               08869704
088698         MOVE PT-STORE-NMBR (PT-DISTRO-IDX) TO PV-STR             08869813
088699                                                                  08869904
088700         MOVE SPACE TO PV-CICS-MSG-AREA                           08870004
088710*        PRE PACK = M OR I  - B = BULK                            08871004
088711         STRING ' *******'                                        08871104
088712                                   DELIMITED BY SIZE              08871204
088713                ' IS P2L?'                DELIMITED BY SIZE       08871304
088714                 PC126-P2L-LBL-CNT        DELIMITED BY SIZE       08871404
088715                ' STR =  '                DELIMITED BY SIZE       08871504
088716                 PV-STR                   DELIMITED BY SIZE       08871613
088717                ' PREPK-ID: '             DELIMITED BY SIZE       08871704
088718                PV-PREPACK-IND            DELIMITED BY SIZE       08871804
088719                ' SKU='                   DELIMITED BY SIZE       08871904
088720                PC126-SKU                 DELIMITED BY SIZE       08872004
088730                ' LINE:'                  DELIMITED BY SIZE       08873004
088731                PC126-PO-LNE-NBR          DELIMITED BY SIZE       08873104
088732                                         INTO PV-CICS-MSG-AREA    08873204
088733         MOVE LENGTH OF PV-CICS-MSG-AREA                          08873304
088734                   TO PV-COMMAREA-LENGTH                          08873404
088735         PERFORM 9999-WRITE-TO-CSSL                               08873504
088736     END-IF.                                                      08873604
088737                                                                  08873704
088738     INITIALIZE SU093-ITEM-COMMAREA.                              08873804
088739* 5/14/13 cp begin                                                08873904
088740     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE.                   08874004
088741     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE.                   08874104
088742     SET SU093-DC-DEPT-TAGS-NO         TO TRUE.                   08874204
088743     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   08874304
088744     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   08874404
088745     SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE.                   08874504
088746     SET SU093-RFID-NO                 TO TRUE.                   08874604
088747* 5/14/13 cp end                                                  08874704
088748                                                                  08874804
088749     SET  SU093-CSEPK-SPLIT            TO TRUE.                   08874904
088750                                                                  08875004
088751     IF PC126-P2L-LBL-CNT > 0                                     08875104
088752* 5/14/13 cp begin                                                08875204
088753         SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE               08875304
088754         SET SU093-CHECK-BY-DEPT-IN-STR-NO  TO TRUE               08875404
088755         SET SU093-RFID-STR-CHK-NEEDED-NO   TO TRUE               08875504
088756         SET SU093-CHECK-BY-DC              TO TRUE               08875604
088757* 5/14/13 cp end                                                  08875704
088758         IF PC126-PRE-PACK-ORDER                                  08875804
088759             SET SU093-PREPK-ORDER-YES      TO TRUE               08875904
088760             MOVE PC126-PREPK-ID            TO SU093-KEY-PREPK-ID 08876004
088761         ELSE                                                     08876104
088762             SET SU093-PREPK-ORDER-NO       TO TRUE               08876204
088763             MOVE PC126-SKU                 TO SU093-KEY-SKU-NBR  08876304
088764             MOVE PC126-PO-LNE-NBR          TO SU093-KEY-LNE-NBR  08876404
088765         END-IF                                                   08876504
088766     ELSE                                                         08876604
088767****     THIS IS ---NOT P2L---                                    08876704
088768* 5/14/13 cp begin                                                08876804
088769         SET SU093-CHECK-BY-DEPT-SUBCLS-YES  TO TRUE              08876904
088770         SET SU093-CHECK-BY-DEPT-IN-STR-YES  TO TRUE              08877004
088780         SET SU093-RFID-STR-CHK-NEEDED-NO    TO TRUE              08878004
088781         SET SU093-CHECK-BY-DC               TO TRUE              08878104
088782* 5/14/13 cp end                                                  08878204
088783         MOVE PT-STORE-NMBR (PT-DISTRO-IDX) TO SU093-KEY-DEST-LOC 08878304
088784                                                                  08878404
088785         IF PC126-PRE-PACK-ORDER                                  08878504
088786             SET SU093-PREPK-ORDER-YES       TO TRUE              08878604
088787             MOVE PC126-PREPK-ID             TO SU093-KEY-PREPK-ID08878704
088788         ELSE                                                     08878804
088789* 5/14/13 cp begin                                                08878904
088790             SET SU093-RFID-KOHL-DPT-IN-STR-YES TO TRUE           08879004
088791             SET SU093-CHECK-BY-STORE          TO TRUE            08879104
088792             SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE            08879204
088793             SET SU093-RFID-NO                 TO TRUE            08879304
088794* 5/14/13 cp end                                                  08879404
088795             SET SU093-PREPK-ORDER-NO        TO TRUE              08879504
088796             MOVE PC126-SKU                  TO SU093-KEY-SKU-NBR 08879604
088797             MOVE PC126-PO-LNE-NBR           TO SU093-KEY-LNE-NBR 08879704
088798         END-IF                                                   08879804
088799     END-IF.                                                      08879904
088800                                                                  08880004
088801     MOVE PC126-OPER-UNT-ID            TO SU093-KEY-OPER-UNT-ID.  08880104
088802     MOVE PC126-PO-NBR                 TO SU093-KEY-PO.           08880204
088803     MOVE PC126-RCVR-SEQ-NBR           TO SU093-KEY-REC-SEQ-NBR.  08880304
088804                                                                  08880404
088805     CALL SU093-RFID-PGM       USING DFHEIBLK                     08880504
088806                                     SU093-COMMAREA               08880604
088807                                     SU093-ITEM-COMMAREA.         08880704
088808                                                                  08880804
088809     IF   PS-DISPLAY-CSSL-YES                                     08880904
088810         MOVE SPACE TO PV-CICS-MSG-AREA                           08881004
088811         STRING ' PCKCS191- 8460-AFTER CALL TO SUBROUTINE '       08881104
088812                                   DELIMITED BY SIZE              08881204
088813                ' IND: '                  DELIMITED BY SIZE       08881304
088814                SU093-RETURN-CODE         DELIMITED BY SIZE       08881404
088815                ' RFID-IND: '             DELIMITED BY SIZE       08881504
088816                SU093-RFID-IND            DELIMITED BY SIZE       08881604
088817                  ' ERROR-NBR  '          DELIMITED BY SIZE       08881704
088818                  SU093-ERROR-NBR         DELIMITED BY SIZE       08881804
088819                                      INTO PV-CICS-MSG-AREA       08881904
088820            MOVE LENGTH OF PV-CICS-MSG-AREA                       08882004
088821                   TO PV-COMMAREA-LENGTH                          08882104
088822            PERFORM 9999-WRITE-TO-CSSL                            08882204
088823     END-IF.                                                      08882304
088824                                                                  08882404
088825     EVALUATE TRUE                                                08882504
088826       WHEN SU093-SUCCESSFUL                                      08882604
088827            IF SU093-RFID-IND = 'Y'                               08882704
088828* IF THE STORE IN DEPT SW WAS SET TO 'YES' BUT THE STORE IN       08882804
088829* DEPT INDICATOR COMING BACK FROM SUKUT149 IS NO, THEN,           08882904
088830* THE DEPT IN THE STORE IS NOT RFID AND SHOULD NOT PROCESS AS     08883004
088831* SUCH.                                                           08883104
088832               IF SU093-CHECK-BY-DEPT-IN-STR-YES                  08883204
088833                 AND SU093-RFID-KOHL-DPT-IN-STR-SW = 'N'          08883304
088834                   SET PT-RFID-STORE-NO  (PT-DISTRO-IDX) TO TRUE  08883404
088835               ELSE                                               08883504
088836* 5/14/13 cp begin                                                08883604
088837               PERFORM 8061-SET-RFID-FOR-PRINT                    08883704
088838               IF PS-RFID-ON-LABEL-YES                            08883804
088839                   SET PC126-RFID-STORE-YES TO TRUE               08883904
088840                   SET PT-RFID-STORE-YES (PT-DISTRO-IDX) TO TRUE  08884004
088841               ELSE                                               08884104
088842                   SET PT-RFID-STORE-NO  (PT-DISTRO-IDX) TO TRUE  08884204
088843               END-IF                                             08884304
088844            ELSE                                                  08884404
088845               SET PT-RFID-STORE-NO  (PT-DISTRO-IDX) TO TRUE      08884504
088846            END-IF                                                08884604
088847* 5/14/13 cp end                                                  08884704
088848       WHEN OTHER                                                 08884804
088849            INITIALIZE  PV-CICS-MSG-AREA                          08884904
088850            MOVE SPACE TO PV-CICS-MSG-AREA                        08885004
088851            MOVE SU093-SQLCODE TO PV-SQL-RETURN-CD                08885104
088852            STRING ' PCKCS191 - '             DELIMITED BY SIZE   08885204
088853                   '8460-CHECK-IF-RFID    '   DELIMITED BY SIZE   08885304
088854                   '  SQL - '                 DELIMITED BY SIZE   08885404
088855                   PV-SQL-RETURN-CD           DELIMITED BY SIZE   08885504
088856                  ' ERROR-NBR  '              DELIMITED BY SIZE   08885604
088857                  SU093-ERROR-NBR             DELIMITED BY SIZE   08885704
088858                                         INTO PV-CICS-MSG-AREA    08885804
088859            MOVE LENGTH OF PV-CICS-MSG-AREA                       08885904
088860                   TO PV-COMMAREA-LENGTH                          08886004
088861            PERFORM 9999-WRITE-TO-CSSL                            08886104
088862            INITIALIZE  PV-CICS-MSG-AREA                          08886204
088863            STRING ' PCKCS191 -'             DELIMITED BY SIZE    08886304
088864                   ' PO:'                    DELIMITED BY SIZE    08886404
088865                   PC126-PO-NBR              DELIMITED BY SIZE    08886504
088866                   ' RCVR:'                  DELIMITED BY SIZE    08886604
088867                   PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE    08886704
088868                   ' LINE:'                  DELIMITED BY SIZE    08886804
088869                   PC126-PO-LNE-NBR          DELIMITED BY SIZE    08886904
088870                                         INTO PV-CICS-MSG-AREA    08887004
088871            MOVE LENGTH OF PV-CICS-MSG-AREA                       08887104
088872                   TO PV-COMMAREA-LENGTH                          08887204
088873            PERFORM 9999-WRITE-TO-CSSL                            08887304
088874                                                                  08887404
088875           STRING 'ERR FILE# SQL='                                08887504
088876                      DELIMITED BY SIZE                           08887604
088877                      PV-SQL-RETURN-CD                            08887704
088878                      DELIMITED BY SIZE                           08887804
088879                             INTO PC126-CRA-RET-MSG               08887904
088880           MOVE '45'                TO PC126-CRA-RET-CDE          08888004
088881           MOVE '4560-'             TO PC126-CRA-REQ-ID           08888104
088882           PERFORM 9000-RETURN-CALL                               08888204
088883                                                                  08888304
088884     END-EVALUATE.                                                08888404
088885                                                                  08888504
088886* 5/14/13 cp begin                                                08888604
088887 8061-SET-RFID-FOR-PRINT.                                         08888704
088888* **************************************************************  08888804
088889* ONCE COMING BACK FROM ROUTINE AND YOU KNOW ITS RFID YOU      *  08888904
088890* STILL NEED TO CHECK THE FOLLOWING SWITCHES TO DETERMINE IF   *  08889004
088891* RFID IS PRINTED ON THE LABEL                                 *  08889104
088892* **************************************************************  08889204
088893                                                                  08889304
088894     SET PS-RFID-ON-LABEL-NO TO TRUE.                             08889404
088895                                                                  08889504
088896     IF SU093-VNDR-DPT-RFID-COMPLI-YES                            08889604
088897*       MEANS NO RFID ON LABELS                                   08889704
088898        SET PS-RFID-ON-LABEL-NO TO TRUE                           08889804
088899     ELSE                                                         08889904
088900        IF SU093-VNDR-DPT-RFID-TAGS-YES AND                       08890004
088901            SU093-DC-DEPT-TAGS-NO                                 08890104
088902*           MEANS NO RFID ON LABELS                               08890204
088903            SET PS-RFID-ON-LABEL-NO  TO TRUE                      08890304
088904        ELSE                                                      08890404
088905            IF SU093-VNDR-DPT-RFID-TAGS-NO AND                    08890504
088906              SU093-DC-DEPT-TAGS-YES                              08890604
088907*             MEANS YES TO RFID ON LABELS                         08890704
088908              SET PS-RFID-ON-LABEL-YES TO TRUE                    08890804
088909            ELSE                                                  08890904
088910              IF SU093-VNDR-DPT-RFID-TAGS-NO AND                  08891004
088911                 SU093-DC-DEPT-TAGS-NO                            08891104
088912*                MEANS NO RFID ON LABELS                          08891204
088913                 SET PS-RFID-ON-LABEL-NO TO TRUE                  08891304
088914              ELSE                                                08891404
088915                  IF SU093-VNDR-DPT-RFID-TAGS-YES AND             08891504
088916                     SU093-DC-DEPT-TAGS-YES                       08891604
088918*CLP 12/09/13        MEANS NO RFID ON LABELS                      08891811
088919                     SET PS-RFID-ON-LABEL-NO  TO TRUE             08891911
088920                  END-IF                                          08892011
088921              END-IF                                              08892111
088922            END-IF                                                08892211
088923        END-IF                                                    08892311
088924     END-IF.                                                      08892411
088925                                                                  08892511
088983*----------------------------------------------------------------*08898311
088984 8475-POPULATE-OTBND-PACK.                                        08898411
088985                                                                  08898511
088986* DMH - 1/03/2005 - BEGIN                                         08898611
088987     IF   PS-DISPLAY-CSSL-YES                                     08898711
088988        INITIALIZE                       PV-CICS-MSG-AREA         08898811
088989        STRING ' PCKCS191- 8475-POPULATE-OTBND-PACK      '        08898911
088990                                         DELIMITED BY SIZE        08899011
088991                                    INTO PV-CICS-MSG-AREA         08899111
088992        MOVE LENGTH OF PV-CICS-MSG-AREA                           08899211
088993                                      TO PV-COMMAREA-LENGTH       08899311
088994        EXEC CICS                                                 08899411
088995            WRITEQ TD                                             08899511
088996                QUEUE   ('CSSL')                                  08899611
088997                FROM    (PV-CICS-MSG-AREA)                        08899711
088998                LENGTH  (PV-COMMAREA-LENGTH)                      08899811
088999                RESP    (PV-CICS-RESP)                            08899911
089000        END-EXEC                                                  08900011
089001     END-IF.                                                      08900111
089002* DMH - 1/03/2005 - BEGIN                                         08900211
089003                                                                  08900311
089004     PERFORM 8480-GET-PK-SKU-NBR.                                 08900411
089005                                                                  08900511
089006     EXEC SQL                                                     08900611
089007         INSERT INTO SUT_OTBND_PK                                 08900711
089008               ( SHIPT_UNT_ID                                     08900811
089009                ,TRN_NBR                                          08900911
089010                ,RCVR_SEQ_NBR                                     08901011
089011                ,TRN_TYP_CDE                                      08901111
089012                ,PK_SKU_NBR                                       08901211
089013                ,SHPD_PK_QTY )                                    08901311
089014         VALUES                                                   08901411
089015              (:SUT00024-SHIPT-UNT-ID                             08901511
089016             , :DK-PO-NBR                                         08901611
089017             , :DK-RCVR-SEQ-NBR                                   08901711
089018             , 'PO'                                               08901811
089019             , :POPRPK-PK-SKU-NBR                                 08901911
089020             , :PV-PREPK-MULTIPLE )                               08902011
089021     END-EXEC.                                                    08902111
089022                                                                  08902211
089023     EVALUATE TRUE                                                08902311
089024         WHEN SQLCODE = ZERO                                      08902411
089025              CONTINUE                                            08902511
089026         WHEN SQLCODE = -904                                      08902611
089027         WHEN SQLCODE = -911                                      08902711
089028         WHEN SQLCODE = -913                                      08902811
089029              SET  PS-SOCKET-ERROR        TO TRUE                 08902911
089030              MOVE ' PCKCS191-8475-POPULATE-OTBND-PACK  '         08903011
089031                                          TO PV-CICS-MSG-AREA     08903111
089032              MOVE LENGTH OF PV-CICS-MSG-AREA                     08903211
089033                     TO PV-COMMAREA-LENGTH                        08903311
089034              PERFORM 9999-WRITE-TO-CSSL                          08903411
089035              INITIALIZE  PV-CICS-MSG-AREA                        08903511
089036              MOVE SQLCODE             TO PV-SQL-RETURN-CD        08903611
089037              STRING ' PCKCS191 -'             DELIMITED BY SIZE  08903711
089038                     ' PO:'                    DELIMITED BY SIZE  08903811
089039                     PC126-PO-NBR              DELIMITED BY SIZE  08903911
089040                     ' RCVR:'                  DELIMITED BY SIZE  08904011
089041                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  08904111
089042                     ' LINE:'                  DELIMITED BY SIZE  08904211
089043                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  08904311
089044                     ' SQLCODE:'               DELIMITED BY SIZE  08904411
089045                     PV-SQL-RETURN-CD          DELIMITED BY SIZE  08904511
089046                                           INTO PV-CICS-MSG-AREA  08904611
089047              MOVE LENGTH OF PV-CICS-MSG-AREA                     08904711
089048                     TO PV-COMMAREA-LENGTH                        08904811
089049              PERFORM 9999-WRITE-TO-CSSL                          08904911
089050             MOVE SQLCODE             TO PV-SQL-RETURN-CD         08905011
089051             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     08905111
089060                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     08906004
089070                                      INTO PC126-CRA-RET-MSG      08907004
089080             SET PC126-CRA-SQL-CONTENTION TO TRUE                 08908004
089090             PERFORM 9000-RETURN-CALL                             08909004
089100                                                                  08910004
089110         WHEN SQLWARN0 NOT = SPACES                               08911004
089120         WHEN SQLCODE NOT EQUAL ZERO                              08912004
089130              SET  PS-SOCKET-ERROR        TO TRUE                 08913004
089140              MOVE ' PCKCS191-8475-POPULATE-OTBND-PACK  '         08914004
089150                                          TO PV-CICS-MSG-AREA     08915004
089160              MOVE LENGTH OF PV-CICS-MSG-AREA                     08916004
089170                     TO PV-COMMAREA-LENGTH                        08917004
089180              PERFORM 9999-WRITE-TO-CSSL                          08918004
089190              INITIALIZE  PV-CICS-MSG-AREA                        08919004
089200              MOVE SQLCODE             TO PV-SQL-RETURN-CD        08920004
089300              STRING ' PCKCS191 -'             DELIMITED BY SIZE  08930004
089310                     ' PO:'                    DELIMITED BY SIZE  08931004
089320                     PC126-PO-NBR              DELIMITED BY SIZE  08932004
089330                     ' RCVR:'                  DELIMITED BY SIZE  08933004
089340                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  08934004
089350                     ' LINE:'                  DELIMITED BY SIZE  08935004
089360                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  08936004
089370                     ' SQLCODE:'               DELIMITED BY SIZE  08937004
089380                     PV-SQL-RETURN-CD          DELIMITED BY SIZE  08938004
089390                                           INTO PV-CICS-MSG-AREA  08939004
089400              MOVE LENGTH OF PV-CICS-MSG-AREA                     08940004
089410                     TO PV-COMMAREA-LENGTH                        08941004
089420              PERFORM 9999-WRITE-TO-CSSL                          08942004
089430              INITIALIZE  PV-CICS-MSG-AREA                        08943004
089440              MOVE SUT00024-SHIPT-UNT-ID                          08944004
089450                TO PV-DISPLAY-SHIPT-UNT-ID                        08945004
089460              STRING ' PCKCS191 -'             DELIMITED BY SIZE  08946004
089470                     ' CARTON ID:'             DELIMITED BY SIZE  08947004
089480                     PV-DISPLAY-SHIPT-UNT-ID   DELIMITED BY SIZE  08948004
089490                                           INTO PV-CICS-MSG-AREA  08949004
089500              MOVE LENGTH OF PV-CICS-MSG-AREA                     08950004
089510                     TO PV-COMMAREA-LENGTH                        08951004
089520              PERFORM 9999-WRITE-TO-CSSL                          08952004
089530              STRING 'ERR FILE# SQL='                             08953004
089540                         DELIMITED BY SIZE                        08954004
089550                         PV-SQL-RETURN-CD                         08955004
089560                         DELIMITED BY SIZE                        08956004
089570                                INTO PC126-CRA-RET-MSG            08957004
089580              MOVE '02'                TO PC126-CRA-RET-CDE       08958004
089590              MOVE '8475-'             TO PC126-CRA-REQ-ID        08959004
089600              PERFORM 9000-RETURN-CALL                            08960004
089610     END-EVALUATE.                                                08961004
089620                                                                  08962004
089630*---------------------------------------------------------------- 08963004
089640 8480-GET-PK-SKU-NBR.                                             08964004
089650                                                                  08965004
089660* DMH - 1/03/2005 - BEGIN                                         08966004
089670     IF   PS-DISPLAY-CSSL-YES                                     08967004
089680        INITIALIZE                       PV-CICS-MSG-AREA         08968004
089690        STRING ' PCKCS191- 8480-GET-PK-SKU-NBR           '        08969004
089700                                         DELIMITED BY SIZE        08970004
089710                                    INTO PV-CICS-MSG-AREA         08971004
089720        MOVE LENGTH OF PV-CICS-MSG-AREA                           08972004
089730                                      TO PV-COMMAREA-LENGTH       08973004
089740        EXEC CICS                                                 08974004
089750            WRITEQ TD                                             08975004
089760                QUEUE   ('CSSL')                                  08976004
089770                FROM    (PV-CICS-MSG-AREA)                        08977004
089780                LENGTH  (PV-COMMAREA-LENGTH)                      08978004
089790                RESP    (PV-CICS-RESP)                            08979004
089800        END-EXEC                                                  08980004
089810     END-IF.                                                      08981004
089820* DMH - 1/03/2005 - BEGIN                                         08982004
089830                                                                  08983004
089840     EXEC SQL                                                     08984004
089850         SELECT PK_SKU_NBR                                        08985004
089860         INTO   :POPRPK-PK-SKU-NBR                                08986004
089870         FROM   TPOPRPK                                           08987004
089880         WHERE  PO_NBR         = :DK-PO-NBR                       08988004
089890           AND  PO_PREPK_ID    = :PC126-PREPK-ID                  08989004
089900           AND  PREPK_STAT_CDE = 'A'                              08990004
089910     END-EXEC.                                                    08991004
089920                                                                  08992004
089930     EVALUATE TRUE                                                08993004
089940         WHEN SQLCODE = ZERO                                      08994004
089950              CONTINUE                                            08995004
089960         WHEN OTHER                                               08996004
089970              INITIALIZE  PV-CICS-MSG-AREA                        08997004
089971              SET  PS-SOCKET-ERROR        TO TRUE                 08997104
089972              MOVE ' PCKCS191-8480-GET-PK-SKU-NBR  '              08997204
089973                                          TO PV-CICS-MSG-AREA     08997304
089974              MOVE LENGTH OF PV-CICS-MSG-AREA                     08997404
089975                     TO PV-COMMAREA-LENGTH                        08997504
089976              PERFORM 9999-WRITE-TO-CSSL                          08997604
089977              INITIALIZE  PV-CICS-MSG-AREA                        08997704
089978              STRING ' PCKCS191 -'             DELIMITED BY SIZE  08997804
089979                     ' PO:'                    DELIMITED BY SIZE  08997904
089980                     PC126-PO-NBR              DELIMITED BY SIZE  08998004
089981                     ' RCVR:'                  DELIMITED BY SIZE  08998104
089982                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  08998204
089983                     ' LINE:'                  DELIMITED BY SIZE  08998304
089984                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  08998404
089985                                           INTO PV-CICS-MSG-AREA  08998504
089986              MOVE LENGTH OF PV-CICS-MSG-AREA                     08998604
089987                     TO PV-COMMAREA-LENGTH                        08998704
089988              PERFORM 9999-WRITE-TO-CSSL                          08998804
089989     END-EVALUATE.                                                08998904
089990                                                                  08999004
089991******************************************************************08999104
089992 8500-INSERT-OTBND-CART.                                          08999204
089993******************************************************************08999304
089994                                                                  08999404
089995* DMH - 1/03/2005 - BEGIN                                         08999504
089996     IF   PS-DISPLAY-CSSL-YES                                     08999604
089997        INITIALIZE                       PV-CICS-MSG-AREA         08999704
089998        STRING ' PCKCS191- 8500-INSERT-OTBND-CART        '        08999804
089999                                         DELIMITED BY SIZE        08999904
090000                                    INTO PV-CICS-MSG-AREA         09000004
090001        MOVE LENGTH OF PV-CICS-MSG-AREA                           09000104
090002                                      TO PV-COMMAREA-LENGTH       09000204
090003        EXEC CICS                                                 09000304
090004            WRITEQ TD                                             09000404
090005                QUEUE   ('CSSL')                                  09000504
090006                FROM    (PV-CICS-MSG-AREA)                        09000604
090007                LENGTH  (PV-COMMAREA-LENGTH)                      09000704
090008                RESP    (PV-CICS-RESP)                            09000804
090009        END-EXEC                                                  09000904
090010     END-IF.                                                      09001004
090011* DMH - 1/03/2005 - BEGIN                                         09001104
090012                                                                  09001204
090013     MOVE PT-STR-NBR (PT-DISTRO-IDX) TO                           09001304
090014                                   SUT00024-DEST-LOC-NBR.         09001404
090015     MOVE ZEROES              TO                                  09001504
090016                                   SUT00024-LBL-PRT-SEQ-NBR       09001604
090017                                   SUT00024-CART-RVSN-NBR.        09001704
090018     MOVE PC-CURRENT-PROGRAM-NAME    TO                           09001804
090019                                   SUT00024-CRE-PGM-NM.           09001904
090020                                                                  09002004
090021     MOVE PC180-SML-BARCODE   TO   SUT00024-SHIPT-UNT-ID          09002104
090022                                   SUT00024-PRNT-CART-ID          09002204
090023                                   SUT00024-ORIG-CART-ID.         09002304
090024                                                                  09002404
090025     MOVE SPACES              TO   SUT00024-CART-TYP-CDE.         09002504
090026                                                                  09002604
090027                                                                  09002704
090028     EXEC SQL                                                     09002804
090029         INSERT INTO SUT_OTBND_CART                               09002904
090030               ( SHIPT_UNT_ID                                     09003004
090031                ,ORGN_LOC_NBR                                     09003104
090032                ,DEST_LOC_NBR                                     09003204
090033                ,CART_SRC_CDE                                     09003304
090034                ,CRE_DTE                                          09003404
090035                ,CRE_TM                                           09003504
090036                ,CRE_USR_ID                                       09003604
090037                ,CRE_PGM_NM                                       09003704
090038                ,MSTR_CART_IND                                    09003804
090039                ,PRNT_CART_ID                                     09003904
090040                ,ORIG_CART_ID                                     09004004
090041                ,CART_TYP_CDE                                     09004104
090042                ,LBL_PRT_SEQ_NBR                                  09004204
090043                ,CART_RVSN_NBR                                    09004304
090044                ,OTBND_TRIP_ID                                    09004404
090045                ,ACTV_IND)                                        09004504
090046         VALUES                                                   09004604
090047              (:SUT00024-SHIPT-UNT-ID                             09004704
090048             , :DK-OPER-UNT-ID                                    09004804
090049             , :SUT00024-DEST-LOC-NBR                             09004904
090050             , :PC-CPS                                            09005004
090060             ,  CURRENT DATE                                      09006004
090061             ,  CURRENT TIME                                      09006104
090062             , :PC126-USER-ID                                     09006204
090063             , :SUT00024-CRE-PGM-NM                               09006304
090064             , 'N'                                                09006404
090065             , :SUT00024-PRNT-CART-ID                             09006504
090066             , :SUT00024-ORIG-CART-ID                             09006604
090067             , :SUT00024-CART-TYP-CDE                             09006704
090068             , :SUT00024-LBL-PRT-SEQ-NBR                          09006804
090069             , :SUT00024-CART-RVSN-NBR                            09006904
090070             , NULL                                               09007004
090080             , 'Y' )                                              09008004
090090     END-EXEC.                                                    09009004
090100                                                                  09010004
090110     EVALUATE TRUE                                                09011004
090120         WHEN SQLCODE = ZERO                                      09012004
090130              CONTINUE                                            09013004
090140                                                                  09014004
090150         WHEN SQLCODE = -904                                      09015004
090160         WHEN SQLCODE = -911                                      09016004
090170         WHEN SQLCODE = -913                                      09017004
090180              SET  PS-SOCKET-ERROR        TO TRUE                 09018004
090190              MOVE ' PCKCS191-8500-INSERT-SUT_OTBND_CART  '       09019004
090200                                          TO PV-CICS-MSG-AREA     09020004
090210              MOVE LENGTH OF PV-CICS-MSG-AREA                     09021004
090220                     TO PV-COMMAREA-LENGTH                        09022004
090230              PERFORM 9999-WRITE-TO-CSSL                          09023004
090240              INITIALIZE  PV-CICS-MSG-AREA                        09024004
090250              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09025004
090260              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09026004
090270                     ' PO:'                    DELIMITED BY SIZE  09027004
090280                     PC126-PO-NBR              DELIMITED BY SIZE  09028004
090290                     ' RCVR:'                  DELIMITED BY SIZE  09029004
090300                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09030004
090310                     ' LINE:'                  DELIMITED BY SIZE  09031004
090320                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09032004
090330                     ' SQLCODE:'               DELIMITED BY SIZE  09033004
090340                     PV-SQL-RETURN-CD          DELIMITED BY SIZE  09034004
090350                                           INTO PV-CICS-MSG-AREA  09035004
090360              MOVE LENGTH OF PV-CICS-MSG-AREA                     09036004
090370                     TO PV-COMMAREA-LENGTH                        09037004
090380              PERFORM 9999-WRITE-TO-CSSL                          09038004
090390             MOVE SQLCODE             TO PV-SQL-RETURN-CD         09039004
090400             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     09040004
090410                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     09041004
090420                                      INTO PC126-CRA-RET-MSG      09042004
090430             SET PC126-CRA-SQL-CONTENTION TO TRUE                 09043004
090440             PERFORM 9000-RETURN-CALL                             09044004
090450                                                                  09045004
090460         WHEN SQLWARN0 NOT = SPACES                               09046004
090470         WHEN SQLCODE NOT EQUAL ZERO                              09047004
090480              SET  PS-SOCKET-ERROR        TO TRUE                 09048004
090490              MOVE ' PCKCS191-8500-INSERT-SUT_OTBND_CART  '       09049004
090500                                          TO PV-CICS-MSG-AREA     09050004
090510              MOVE LENGTH OF PV-CICS-MSG-AREA                     09051004
090520                     TO PV-COMMAREA-LENGTH                        09052004
090530              PERFORM 9999-WRITE-TO-CSSL                          09053004
090540              INITIALIZE  PV-CICS-MSG-AREA                        09054004
090550              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09055004
090560              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09056004
090570                     ' PO:'                    DELIMITED BY SIZE  09057004
090580                     PC126-PO-NBR              DELIMITED BY SIZE  09058004
090590                     ' RCVR:'                  DELIMITED BY SIZE  09059004
090600                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09060004
090610                     ' LINE:'                  DELIMITED BY SIZE  09061004
090620                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09062004
090630                     ' SQLCODE:'               DELIMITED BY SIZE  09063004
090640                     PV-SQL-RETURN-CD          DELIMITED BY SIZE  09064004
090650                                           INTO PV-CICS-MSG-AREA  09065004
090660              MOVE LENGTH OF PV-CICS-MSG-AREA                     09066004
090670                     TO PV-COMMAREA-LENGTH                        09067004
090680              PERFORM 9999-WRITE-TO-CSSL                          09068004
090690              INITIALIZE  PV-CICS-MSG-AREA                        09069004
090700              MOVE SUT00024-SHIPT-UNT-ID                          09070004
090710                TO PV-DISPLAY-SHIPT-UNT-ID                        09071004
090720              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09072004
090730                     ' carton id:'             DELIMITED BY SIZE  09073004
090740                     PV-DISPLAY-SHIPT-UNT-ID   DELIMITED BY SIZE  09074004
090750                                           INTO PV-CICS-MSG-AREA  09075004
090760              MOVE LENGTH OF PV-CICS-MSG-AREA                     09076004
090770                     TO PV-COMMAREA-LENGTH                        09077004
090780              PERFORM 9999-WRITE-TO-CSSL                          09078004
090790              STRING 'ERR FILE# SQL='                             09079004
090800                         DELIMITED BY SIZE                        09080004
090810                         PV-SQL-RETURN-CD                         09081004
090820                         DELIMITED BY SIZE                        09082004
090830                                INTO PC126-CRA-RET-MSG            09083004
090840              MOVE '02'                TO PC126-CRA-RET-CDE       09084004
090850              MOVE '8500-'             TO PC126-CRA-REQ-ID        09085004
090860              PERFORM 9000-RETURN-CALL                            09086004
090870     END-EVALUATE.                                                09087004
090880                                                                  09088004
090890******************************************************************09089004
090900 8530-OPEN-PREPK-LINE-CURSOR.                                     09090004
090910******************************************************************09091004
090920* DMH - 1/03/2005 - BEGIN                                         09092004
090930     IF   PS-DISPLAY-CSSL-YES                                     09093004
090940        INITIALIZE                       PV-CICS-MSG-AREA         09094004
090950        STRING ' PCKCS191- 8530-OPEN-PREPK-LINE-CURSOR   '        09095004
090960                                         DELIMITED BY SIZE        09096004
090970                                    INTO PV-CICS-MSG-AREA         09097004
090980        MOVE LENGTH OF PV-CICS-MSG-AREA                           09098004
090990                                      TO PV-COMMAREA-LENGTH       09099004
091000        EXEC CICS                                                 09100004
091010            WRITEQ TD                                             09101004
091020                QUEUE   ('CSSL')                                  09102004
091030                FROM    (PV-CICS-MSG-AREA)                        09103004
091040                LENGTH  (PV-COMMAREA-LENGTH)                      09104004
091050                RESP    (PV-CICS-RESP)                            09105004
091060        END-EXEC                                                  09106004
091070     END-IF.                                                      09107004
091080* DMH - 1/03/2005 - BEGIN                                         09108004
091090                                                                  09109004
091100                                                                  09110004
091110     EXEC SQL                                                     09111004
091120          OPEN PREPK-LINE-CSR                                     09112004
091130     END-EXEC                                                     09113004
091140                                                                  09114004
091150     EVALUATE TRUE                                                09115004
091160         WHEN SQLCODE = ZERO                                      09116004
091170             CONTINUE                                             09117004
091180                                                                  09118004
091190         WHEN SQLCODE = -904                                      09119004
091200         WHEN SQLCODE = -911                                      09120004
091210         WHEN SQLCODE = -913                                      09121004
091220             MOVE SQLCODE             TO PV-SQL-RETURN-CD         09122004
091230             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     09123004
091240                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     09124004
091250                                      INTO PC126-CRA-RET-MSG      09125004
091260             MOVE '01'                TO PC126-CRA-RET-CDE        09126004
091270             PERFORM 9000-RETURN-CALL                             09127004
091280                                                                  09128004
091290         WHEN SQLWARN0 NOT = SPACES                               09129004
091300         WHEN SQLCODE < ZERO                                      09130004
091310         WHEN SQLCODE > ZERO                                      09131004
091320             INITIALIZE  PV-CICS-MSG-AREA                         09132004
091330              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09133004
091331              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09133104
091332                     '8530-OPEN-PREPK-CURSOR'  DELIMITED BY SIZE  09133204
091333                     '  sql - '                delimited by size  09133304
091334                     PV-SQL-RETURN-CD          delimited by size  09133404
091335                                           INTO PV-CICS-MSG-AREA  09133504
091336              MOVE LENGTH OF PV-CICS-MSG-AREA                     09133604
091337                     TO PV-COMMAREA-LENGTH                        09133704
091338              PERFORM 9999-WRITE-TO-CSSL                          09133804
091339              INITIALIZE  PV-CICS-MSG-AREA                        09133904
091340              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09134004
091341                     ' PO:'                    DELIMITED BY SIZE  09134104
091342                     PC126-PO-NBR              DELIMITED BY SIZE  09134204
091343                     ' RCVR:'                  DELIMITED BY SIZE  09134304
091344                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09134404
091345                     ' LINE:'                  DELIMITED BY SIZE  09134504
091346                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09134604
091347                                           INTO PV-CICS-MSG-AREA  09134704
091348              MOVE LENGTH OF PV-CICS-MSG-AREA                     09134804
091349                     TO PV-COMMAREA-LENGTH                        09134904
091350              PERFORM 9999-WRITE-TO-CSSL                          09135004
091360                                                                  09136004
091370             STRING 'ERR FILE# SQL='                              09137004
091380                        DELIMITED BY SIZE                         09138004
091390                        PV-SQL-RETURN-CD                          09139004
091400                        DELIMITED BY SIZE                         09140004
091410                               INTO PC126-CRA-RET-MSG             09141004
091420             MOVE '02'                TO PC126-CRA-RET-CDE        09142004
091430             MOVE '8530-'             TO PC126-CRA-REQ-ID         09143004
091440             PERFORM 9000-RETURN-CALL                             09144004
091450                                                                  09145004
091460     END-EVALUATE.                                                09146004
091470                                                                  09147004
091480                                                                  09148004
091490 EJECT                                                            09149004
091500*----------------------------------------------------------------*09150004
091510*                                                                 09151004
091520*----------------------------------------------------------------*09152004
091530 8540-FETCH-PREPK-LINE-CURSOR.                                    09153004
091540                                                                  09154004
091550* DMH - 1/03/2005 - BEGIN                                         09155004
091560     IF   PS-DISPLAY-CSSL-YES                                     09156004
091570        INITIALIZE                       PV-CICS-MSG-AREA         09157004
091580        STRING ' PCKCS191- 8540-FETCH-PREPK-LINE-CURSOR  '        09158004
091590                                         DELIMITED BY SIZE        09159004
091600                                    INTO PV-CICS-MSG-AREA         09160004
091610        MOVE LENGTH OF PV-CICS-MSG-AREA                           09161004
091620                                      TO PV-COMMAREA-LENGTH       09162004
091630        EXEC CICS                                                 09163004
091640            WRITEQ TD                                             09164004
091650                QUEUE   ('CSSL')                                  09165004
091660                FROM    (PV-CICS-MSG-AREA)                        09166004
091670                LENGTH  (PV-COMMAREA-LENGTH)                      09167004
091680                RESP    (PV-CICS-RESP)                            09168004
091690        END-EXEC                                                  09169004
091700     END-IF.                                                      09170004
091710* DMH - 1/03/2005 - BEGIN                                         09171004
091720                                                                  09172004
091730     EXEC SQL                                                     09173004
091740        FETCH   PREPK-LINE-CSR                                    09174004
091750        INTO   :RECITM-ORD-LNE-NBR                                09175004
091760              ,:RECITM-PREPK-RATO-QTY                             09176004
091770              ,:PURITM-ITM-NBR                                    09177004
091780     END-EXEC.                                                    09178004
091790                                                                  09179004
091800     EVALUATE TRUE                                                09180004
091810         WHEN SQLCODE = ZERO                                      09181004
091820            MOVE RECITM-ORD-LNE-NBR  TO  DK-ORD-LNE-NBR           09182004
091830            PERFORM 8570-CALL-XLKUT001                            09183004
091840         WHEN SQLCODE = +100                                      09184004
091850            SET PS-EO-PREPK-CSR   TO    TRUE                      09185004
091860         WHEN SQLCODE = -904                                      09186004
091870         WHEN SQLCODE = -911                                      09187004
091880         WHEN SQLCODE = -913                                      09188004
091890             MOVE SQLCODE             TO PV-SQL-RETURN-CD         09189004
091900             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     09190004
091910                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     09191004
091920                                      INTO PC126-CRA-RET-MSG      09192004
091930             MOVE '01'                TO PC126-CRA-RET-CDE        09193004
091940             PERFORM 9000-RETURN-CALL                             09194004
091950                                                                  09195004
091960         WHEN SQLWARN0 NOT = SPACES                               09196004
091961         WHEN SQLCODE < ZERO                                      09196104
091962         WHEN SQLCODE > ZERO                                      09196204
091963             INITIALIZE  PV-CICS-MSG-AREA                         09196304
091964              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09196404
091965              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09196504
091966                     '8540-FETCH-PREPK-CSR  '  DELIMITED BY SIZE  09196604
091967                     '  sql - '                delimited by size  09196704
091968                     PV-SQL-RETURN-CD          delimited by size  09196804
091969                                           INTO PV-CICS-MSG-AREA  09196904
091970              MOVE LENGTH OF PV-CICS-MSG-AREA                     09197004
091971                     TO PV-COMMAREA-LENGTH                        09197104
091972              PERFORM 9999-WRITE-TO-CSSL                          09197204
091973              INITIALIZE  PV-CICS-MSG-AREA                        09197304
091974              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09197404
091975                     ' PO:'                    DELIMITED BY SIZE  09197504
091976                     PC126-PO-NBR              DELIMITED BY SIZE  09197604
091977                     ' RCVR:'                  DELIMITED BY SIZE  09197704
091978                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09197804
091979                     ' LINE:'                  DELIMITED BY SIZE  09197904
091980                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09198004
091990                                           INTO PV-CICS-MSG-AREA  09199004
092000              MOVE LENGTH OF PV-CICS-MSG-AREA                     09200004
092010                     TO PV-COMMAREA-LENGTH                        09201004
092020              PERFORM 9999-WRITE-TO-CSSL                          09202004
092030                                                                  09203004
092040             STRING 'ERR FILE# SQL='                              09204004
092050                        DELIMITED BY SIZE                         09205004
092060                        PV-SQL-RETURN-CD                          09206004
092070                        DELIMITED BY SIZE                         09207004
092080                               INTO PC126-CRA-RET-MSG             09208004
092090             MOVE '02'                TO PC126-CRA-RET-CDE        09209004
092100             MOVE '8540-'             TO PC126-CRA-REQ-ID         09210004
092110             PERFORM 9000-RETURN-CALL                             09211004
092120                                                                  09212004
092130     END-EVALUATE.                                                09213004
092140                                                                  09214004
092150*----------------------------------------------------------------*09215004
092160*                                                                 09216004
092170*----------------------------------------------------------------*09217004
092180 8550-CLOSE-PREPK-LINE-CURSOR.                                    09218004
092190                                                                  09219004
092200* DMH - 1/03/2005 - BEGIN                                         09220004
092210     IF   PS-DISPLAY-CSSL-YES                                     09221004
092220        INITIALIZE                       PV-CICS-MSG-AREA         09222004
092230        STRING ' PCKCS191- 8550-CLOSE-PREPK-LINE-CURSOR  '        09223004
092240                                         DELIMITED BY SIZE        09224004
092250                                    INTO PV-CICS-MSG-AREA         09225004
092260        MOVE LENGTH OF PV-CICS-MSG-AREA                           09226004
092270                                      TO PV-COMMAREA-LENGTH       09227004
092280        EXEC CICS                                                 09228004
092290            WRITEQ TD                                             09229004
092300                QUEUE   ('CSSL')                                  09230004
092310                FROM    (PV-CICS-MSG-AREA)                        09231004
092320                LENGTH  (PV-COMMAREA-LENGTH)                      09232004
092330                RESP    (PV-CICS-RESP)                            09233004
092340        END-EXEC                                                  09234004
092350     END-IF.                                                      09235004
092360* DMH - 1/03/2005 - BEGIN                                         09236004
092370                                                                  09237004
092380         EXEC SQL                                                 09238004
092390             CLOSE PREPK-LINE-CSR                                 09239004
092400         END-EXEC                                                 09240004
092410                                                                  09241004
092420     EVALUATE TRUE                                                09242004
092430         WHEN SQLCODE = ZERO                                      09243004
092440             CONTINUE                                             09244004
092450                                                                  09245004
092460         WHEN SQLCODE = -904                                      09246004
092470         WHEN SQLCODE = -911                                      09247004
092480         WHEN SQLCODE = -913                                      09248004
092490             MOVE SQLCODE             TO PV-SQL-RETURN-CD         09249004
092500             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     09250004
092510                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     09251004
092520                                      INTO PC126-CRA-RET-MSG      09252004
092530             MOVE '01'                TO PC126-CRA-RET-CDE        09253004
092540             PERFORM 9000-RETURN-CALL                             09254004
092550                                                                  09255004
092560         WHEN SQLWARN0 NOT = SPACES                               09256004
092570         WHEN SQLCODE < ZERO                                      09257004
092580         WHEN SQLCODE > ZERO                                      09258004
092590             INITIALIZE  PV-CICS-MSG-AREA                         09259004
092600              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09260004
092610              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09261004
092611                     '8550-CLOSE-PREPK-CSR  '  DELIMITED BY SIZE  09261104
092612                     '  sql - '                delimited by size  09261204
092613                     PV-SQL-RETURN-CD          delimited by size  09261304
092614                                           INTO PV-CICS-MSG-AREA  09261404
092615              MOVE LENGTH OF PV-CICS-MSG-AREA                     09261504
092616                     TO PV-COMMAREA-LENGTH                        09261604
092617              PERFORM 9999-WRITE-TO-CSSL                          09261704
092618              INITIALIZE  PV-CICS-MSG-AREA                        09261804
092619              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09261904
092620                     ' PO:'                    DELIMITED BY SIZE  09262004
092621                     PC126-PO-NBR              DELIMITED BY SIZE  09262104
092622                     ' RCVR:'                  DELIMITED BY SIZE  09262204
092623                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09262304
092624                     ' LINE:'                  DELIMITED BY SIZE  09262404
092625                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09262504
092626                                           INTO PV-CICS-MSG-AREA  09262604
092627              MOVE LENGTH OF PV-CICS-MSG-AREA                     09262704
092628                     TO PV-COMMAREA-LENGTH                        09262804
092629              PERFORM 9999-WRITE-TO-CSSL                          09262904
092630                                                                  09263004
092640             STRING 'ERR FILE# SQL='                              09264004
092650                        DELIMITED BY SIZE                         09265004
092660                        PV-SQL-RETURN-CD                          09266004
092670                        DELIMITED BY SIZE                         09267004
092680                               INTO PC126-CRA-RET-MSG             09268004
092690             MOVE '02'                TO PC126-CRA-RET-CDE        09269004
092700             MOVE '8550-'             TO PC126-CRA-REQ-ID         09270004
092710             PERFORM 9000-RETURN-CALL                             09271004
092720                                                                  09272004
092730     END-EVALUATE.                                                09273004
092740                                                                  09274004
092750                                                                  09275004
092760 EJECT                                                            09276004
092770                                                                  09277004
092780*----------------------------------------------------------------*09278004
092790 8570-CALL-XLKUT001.                                              09279004
092800                                                                  09280004
092810* DMH - 1/03/2005 - BEGIN                                         09281004
092820     IF   PS-DISPLAY-CSSL-YES                                     09282004
092830        INITIALIZE                       PV-CICS-MSG-AREA         09283004
092840        STRING ' PCKCS191- 8570-CALL-XLKUT001            '        09284004
092850                                         DELIMITED BY SIZE        09285004
092860                                    INTO PV-CICS-MSG-AREA         09286004
092870        MOVE LENGTH OF PV-CICS-MSG-AREA                           09287004
092880                                      TO PV-COMMAREA-LENGTH       09288004
092890        EXEC CICS                                                 09289004
092900            WRITEQ TD                                             09290004
092910                QUEUE   ('CSSL')                                  09291004
092920                FROM    (PV-CICS-MSG-AREA)                        09292004
092930                LENGTH  (PV-COMMAREA-LENGTH)                      09293004
092940                RESP    (PV-CICS-RESP)                            09294004
092950        END-EXEC                                                  09295004
092960     END-IF.                                                      09296004
092970* DMH - 1/03/2005 - BEGIN                                         09297004
092980                                                                  09298004
092990     INITIALIZE XL001-ITEM-COMMAREA.                              09299004
093000                                                                  09300004
093010     IF  PC126-PRE-PACK-ORDER                                     09301004
093020         MOVE PURITM-ITM-NBR TO XL001-KEY-ITM-NBR                 09302004
093030     ELSE                                                         09303004
093040         MOVE PC126-ITEM-NBR TO XL001-KEY-ITM-NBR                 09304004
093050     END-IF                                                       09305004
093060                                                                  09306004
093070     MOVE  'V'               TO XL001-KEY-UPC-TYP-CDE             09307004
093080                                                                  09308004
093090     SET  XL001-BY-ITEM                                           09309004
093100          XL001-SELECT-UPC                                        09310004
093110          XL001-SELECT-VND-STYL       TO TRUE                     09311004
093120                                                                  09312004
093130* dmh temp display                                                09313004
093140*             INITIALIZE  PV-CICS-MSG-AREA                        09314004
093150*             MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09315004
093160*             STRING ' PCKCS191 -'             DELIMITED BY SIZE  09316004
093170*                    ' 8570-call-xl         '  DELIMITED BY SIZE  09317004
093180*                    ' key-upc-typ-cde-'       DELIMITED BY SIZE  09318004
093190*                    xl001-key-upc-typ-cde     DELIMITED BY SIZE  09319004
093200*                    ' key-itm-nbr-'           DELIMITED BY SIZE  09320004
093210*                    pv-display-item-nbr       DELIMITED BY SIZE  09321004
093220*                                          INTO PV-CICS-MSG-AREA  09322004
093221*             MOVE LENGTH OF PV-CICS-MSG-AREA                     09322104
093222*                    TO PV-COMMAREA-LENGTH                        09322204
093223*             PERFORM 9999-WRITE-TO-CSSL                          09322304
093224* dmh temp display                                                09322404
093225     CALL XL001-VSM-PGM USING  DFHEIBLK                           09322504
093226                               XL001-COMMAREA                     09322604
093227                               XL001-ITEM-COMMAREA.               09322704
093228     EVALUATE TRUE                                                09322804
093229         WHEN XL001-SUCCESSFUL                                    09322904
093230         WHEN XL001-UPC-SQLCODE = -811                            09323004
093231             MOVE XL001-UPC-NBR     TO SUT00028-UPC-NBR           09323104
093232             IF  PC126-PRE-PACK-ORDER                             09323204
093233                 PERFORM 8610-INSERT-OTBND-UPC-PREPK              09323304
093234             ELSE                                                 09323404
093235                 PERFORM 8600-INSERT-OTBND-UPC                    09323504
093236             END-IF                                               09323604
093237         WHEN XL001-UPC-SQLCODE = +100                            09323704
093238             PERFORM 8575-GET-INTR-UPC-NBR                        09323804
093239         WHEN XL001-SQL-ERROR                                     09323904
093240              MOVE XL001-UPC-SQLCODE TO PV-SQL-RETURN-CD          09324004
093250              INITIALIZE  PV-CICS-MSG-AREA                        09325004
093260              SET  PS-SOCKET-ERROR        TO TRUE                 09326004
093270              STRING ' PCKCS191-8570-CALL-XLKUT001  '             09327004
093280                     ' sqlcode='                                  09328004
093290                     PV-DISPLAY-SQLCODE        delimited by size  09329004
093300                                        INTO PV-CICS-MSG-AREA     09330004
093310              MOVE LENGTH OF PV-CICS-MSG-AREA                     09331004
093320                     TO PV-COMMAREA-LENGTH                        09332004
093330              PERFORM 9999-WRITE-TO-CSSL                          09333004
093340              INITIALIZE  PV-CICS-MSG-AREA                        09334004
093350              MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09335004
093360              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09336004
093370                     'ITEM NUMBER :     '      DELIMITED BY SIZE  09337004
093380                     PV-DISPLAY-ITEM-NBR       DELIMITED BY SIZE  09338004
093390                                           INTO PV-CICS-MSG-AREA  09339004
093400              MOVE LENGTH OF PV-CICS-MSG-AREA                     09340004
093410                     TO PV-COMMAREA-LENGTH                        09341004
093420              PERFORM 9999-WRITE-TO-CSSL                          09342004
093430              INITIALIZE  PV-CICS-MSG-AREA                        09343004
093440              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09344004
093450                     ' PO:'                    DELIMITED BY SIZE  09345004
093460                     PC126-PO-NBR              DELIMITED BY SIZE  09346004
093470                     ' RCVR:'                  DELIMITED BY SIZE  09347004
093480                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09348004
093490                                           INTO PV-CICS-MSG-AREA  09349004
093500              MOVE LENGTH OF PV-CICS-MSG-AREA                     09350004
093510                     TO PV-COMMAREA-LENGTH                        09351004
093520              PERFORM 9999-WRITE-TO-CSSL                          09352004
093530              STRING 'ERR FILE# SQL='                             09353004
093540                         DELIMITED BY SIZE                        09354004
093550                         PV-SQL-RETURN-CD                         09355004
093560                         DELIMITED BY SIZE                        09356004
093570                                INTO PC126-CRA-RET-MSG            09357004
093580              MOVE '02'                TO PC126-CRA-RET-CDE       09358004
093590              MOVE '8570-'             TO PC126-CRA-REQ-ID        09359004
093600              PERFORM 9000-RETURN-CALL                            09360004
093610                                                                  09361004
093620         WHEN OTHER                                               09362004
093630              INITIALIZE  PV-CICS-MSG-AREA                        09363004
093640              MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09364004
093650              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09365004
093660                     'ITEM NUMBER :     '      DELIMITED BY SIZE  09366004
093670                     PV-DISPLAY-ITEM-NBR       DELIMITED BY SIZE  09367004
093680                                           INTO PV-CICS-MSG-AREA  09368004
093690              MOVE LENGTH OF PV-CICS-MSG-AREA                     09369004
093700                     TO PV-COMMAREA-LENGTH                        09370004
093710              PERFORM 9999-WRITE-TO-CSSL                          09371004
093720              INITIALIZE  PV-CICS-MSG-AREA                        09372004
093730              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09373004
093740                     ' PO:'                    DELIMITED BY SIZE  09374004
093750                     PC126-PO-NBR              DELIMITED BY SIZE  09375004
093760                     ' RCVR:'                  DELIMITED BY SIZE  09376004
093770                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09377004
093780                                           INTO PV-CICS-MSG-AREA  09378004
093790              MOVE LENGTH OF PV-CICS-MSG-AREA                     09379004
093800                     TO PV-COMMAREA-LENGTH                        09380004
093810              PERFORM 9999-WRITE-TO-CSSL                          09381004
093820              STRING 'ERR FILE# SQL='                             09382004
093830                         DELIMITED BY SIZE                        09383004
093840                         PV-SQL-RETURN-CD                         09384004
093850                         DELIMITED BY SIZE                        09385004
093860                                INTO PC126-CRA-RET-MSG            09386004
093870              MOVE '02'                TO PC126-CRA-RET-CDE       09387004
093880              MOVE '8570-'             TO PC126-CRA-REQ-ID        09388004
093890              PERFORM 9000-RETURN-CALL                            09389004
093900     END-EVALUATE.                                                09390004
093910                                                                  09391004
093920                                                                  09392004
093930 8575-GET-INTR-UPC-NBR.                                           09393004
093940                                                                  09394004
093950* DMH - 1/03/2005 - BEGIN                                         09395004
093960     IF   PS-DISPLAY-CSSL-YES                                     09396004
093970        INITIALIZE                       PV-CICS-MSG-AREA         09397004
093980        STRING ' PCKCS191- 8575-GET-INTR-UPC-NBR         '        09398004
093990                                         DELIMITED BY SIZE        09399004
094000                                    INTO PV-CICS-MSG-AREA         09400004
094010        MOVE LENGTH OF PV-CICS-MSG-AREA                           09401004
094020                                      TO PV-COMMAREA-LENGTH       09402004
094030        EXEC CICS                                                 09403004
094040            WRITEQ TD                                             09404004
094050                QUEUE   ('CSSL')                                  09405004
094060                FROM    (PV-CICS-MSG-AREA)                        09406004
094070                LENGTH  (PV-COMMAREA-LENGTH)                      09407004
094080                RESP    (PV-CICS-RESP)                            09408004
094090        END-EXEC                                                  09409004
094100     END-IF.                                                      09410004
094110* DMH - 1/03/2005 - BEGIN                                         09411004
094120                                                                  09412004
094130     INITIALIZE XL001-ITEM-COMMAREA.                              09413004
094140                                                                  09414004
094150     IF  PC126-PRE-PACK-ORDER                                     09415004
094160         MOVE PURITM-ITM-NBR TO XL001-KEY-ITM-NBR                 09416004
094170     ELSE                                                         09417004
094180         MOVE PC126-ITEM-NBR TO XL001-KEY-ITM-NBR                 09418004
094190     END-IF                                                       09419004
094200                                                                  09420004
094210     MOVE  'I'               TO XL001-KEY-UPC-TYP-CDE             09421004
094220                                                                  09422004
094230     SET  XL001-BY-ITEM                                           09423004
094240          XL001-SELECT-UPC                                        09424004
094250          XL001-SELECT-VND-STYL       TO TRUE                     09425004
094260                                                                  09426004
094270     CALL XL001-VSM-PGM USING  DFHEIBLK                           09427004
094280                               XL001-COMMAREA                     09428004
094290                               XL001-ITEM-COMMAREA.               09429004
094300     EVALUATE TRUE                                                09430004
094310         WHEN XL001-SUCCESSFUL                                    09431004
094320         WHEN XL001-UPC-SQLCODE = -811                            09432004
094330             MOVE XL001-UPC-NBR     TO SUT00028-UPC-NBR           09433004
094340             IF  PC126-PRE-PACK-ORDER                             09434004
094341                 PERFORM 8610-INSERT-OTBND-UPC-PREPK              09434104
094342             ELSE                                                 09434204
094343                 PERFORM 8600-INSERT-OTBND-UPC                    09434304
094344             END-IF                                               09434404
094345         WHEN XL001-SQL-ERROR                                     09434504
094346              MOVE XL001-UPC-SQLCODE TO PV-SQL-RETURN-CD          09434604
094347              INITIALIZE  PV-CICS-MSG-AREA                        09434704
094348              SET  PS-SOCKET-ERROR        TO TRUE                 09434804
094349              STRING ' PCKCS191-8575-GET-INTR-UPC-NBR'            09434904
094350                     ' sqlcode='                                  09435004
094351                     PV-DISPLAY-SQLCODE        delimited by size  09435104
094352                                        INTO PV-CICS-MSG-AREA     09435204
094353              MOVE LENGTH OF PV-CICS-MSG-AREA                     09435304
094354                     TO PV-COMMAREA-LENGTH                        09435404
094355              PERFORM 9999-WRITE-TO-CSSL                          09435504
094356              INITIALIZE  PV-CICS-MSG-AREA                        09435604
094357              MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09435704
094358              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09435804
094359                     'ITEM NUMBER :     '      DELIMITED BY SIZE  09435904
094360                     PV-DISPLAY-ITEM-NBR       DELIMITED BY SIZE  09436004
094370                                           INTO PV-CICS-MSG-AREA  09437004
094380              MOVE LENGTH OF PV-CICS-MSG-AREA                     09438004
094390                     TO PV-COMMAREA-LENGTH                        09439004
094400              PERFORM 9999-WRITE-TO-CSSL                          09440004
094410              INITIALIZE  PV-CICS-MSG-AREA                        09441004
094420              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09442004
094430                     ' PO:'                    DELIMITED BY SIZE  09443004
094440                     PC126-PO-NBR              DELIMITED BY SIZE  09444004
094450                     ' RCVR:'                  DELIMITED BY SIZE  09445004
094460                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09446004
094470                                           INTO PV-CICS-MSG-AREA  09447004
094480              MOVE LENGTH OF PV-CICS-MSG-AREA                     09448004
094490                     TO PV-COMMAREA-LENGTH                        09449004
094500              PERFORM 9999-WRITE-TO-CSSL                          09450004
094510              STRING 'ERR FILE# SQL='                             09451004
094520                         DELIMITED BY SIZE                        09452004
094530                         PV-SQL-RETURN-CD                         09453004
094540                         DELIMITED BY SIZE                        09454004
094550                                INTO PC126-CRA-RET-MSG            09455004
094560              MOVE '02'                TO PC126-CRA-RET-CDE       09456004
094570              MOVE '8575-'             TO PC126-CRA-REQ-ID        09457004
094580              PERFORM 9000-RETURN-CALL                            09458004
094590                                                                  09459004
094600         WHEN OTHER                                               09460004
094610              INITIALIZE  PV-CICS-MSG-AREA                        09461004
094620              MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09462004
094630              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09463004
094640                     'ITEM NUMBER :     '      DELIMITED BY SIZE  09464004
094650                     PV-DISPLAY-ITEM-NBR       DELIMITED BY SIZE  09465004
094660                                           INTO PV-CICS-MSG-AREA  09466004
094670              MOVE LENGTH OF PV-CICS-MSG-AREA                     09467004
094680                     TO PV-COMMAREA-LENGTH                        09468004
094690              PERFORM 9999-WRITE-TO-CSSL                          09469004
094700              INITIALIZE  PV-CICS-MSG-AREA                        09470004
094710              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09471004
094720                     ' PO:'                    DELIMITED BY SIZE  09472004
094730                     PC126-PO-NBR              DELIMITED BY SIZE  09473004
094740                     ' RCVR:'                  DELIMITED BY SIZE  09474004
094750                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09475004
094760                                           INTO PV-CICS-MSG-AREA  09476004
094770              MOVE LENGTH OF PV-CICS-MSG-AREA                     09477004
094780                     TO PV-COMMAREA-LENGTH                        09478004
094790              PERFORM 9999-WRITE-TO-CSSL                          09479004
094800              STRING 'ERR FILE# SQL='                             09480004
094810                         DELIMITED BY SIZE                        09481004
094820                         PV-SQL-RETURN-CD                         09482004
094830                         DELIMITED BY SIZE                        09483004
094840                                INTO PC126-CRA-RET-MSG            09484004
094850              MOVE '02'                TO PC126-CRA-RET-CDE       09485004
094860              MOVE '8575-'             TO PC126-CRA-REQ-ID        09486004
094870              PERFORM 9000-RETURN-CALL                            09487004
094880     END-EVALUATE.                                                09488004
094890******************************************************************09489004
094900*----------------------------------------------------------------*09490004
094910 8580-CALL-XLKUT001-2.                                            09491004
094920                                                                  09492004
094930* DMH - 1/03/2005 - BEGIN                                         09493004
094940     IF   PS-DISPLAY-CSSL-YES                                     09494004
094950        INITIALIZE                       PV-CICS-MSG-AREA         09495004
094960        STRING ' PCKCS191- 8580-CALL-XLKUT001-2          '        09496004
094970                                         DELIMITED BY SIZE        09497004
094980                                    INTO PV-CICS-MSG-AREA         09498004
094990        MOVE LENGTH OF PV-CICS-MSG-AREA                           09499004
095000                                      TO PV-COMMAREA-LENGTH       09500004
095010        EXEC CICS                                                 09501004
095020            WRITEQ TD                                             09502004
095030                QUEUE   ('CSSL')                                  09503004
095040                FROM    (PV-CICS-MSG-AREA)                        09504004
095050                LENGTH  (PV-COMMAREA-LENGTH)                      09505004
095060                RESP    (PV-CICS-RESP)                            09506004
095070        END-EXEC                                                  09507004
095080     END-IF.                                                      09508004
095090* DMH - 1/03/2005 - BEGIN                                         09509004
095100                                                                  09510004
095110     INITIALIZE XL001-ITEM-COMMAREA.                              09511004
095120                                                                  09512004
095130     MOVE PC126-ITEM-NBR TO XL001-KEY-ITM-NBR                     09513004
095140                                                                  09514004
095150                                                                  09515004
095160     SET  XL001-BY-ITEM                                           09516004
095170          XL001-SELECT-UPC                                        09517004
095180          XL001-SELECT-VND-STYL       TO TRUE                     09518004
095190                                                                  09519004
095200* dmh temp display                                                09520004
095210*             INITIALIZE  PV-CICS-MSG-AREA                        09521004
095220*             MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09522004
095230*             STRING ' PCKCS191 -'             DELIMITED BY SIZE  09523004
095240*                    ' 8580-call-xl         '  DELIMITED BY SIZE  09524004
095250*                    ' key-upc-typ-cde-'       DELIMITED BY SIZE  09525004
095260*                    xl001-key-upc-typ-cde     DELIMITED BY SIZE  09526004
095270*                    ' key-itm-nbr-'           DELIMITED BY SIZE  09527004
095280*                    pv-display-item-nbr       DELIMITED BY SIZE  09528004
095290*                                          INTO PV-CICS-MSG-AREA  09529004
095300*             MOVE LENGTH OF PV-CICS-MSG-AREA                     09530004
095310*                    TO PV-COMMAREA-LENGTH                        09531004
095320*             PERFORM 9999-WRITE-TO-CSSL                          09532004
095321* dmh temp display                                                09532104
095322     CALL XL001-VSM-PGM USING  DFHEIBLK                           09532204
095323                               XL001-COMMAREA                     09532304
095324                               XL001-ITEM-COMMAREA.               09532404
095325     EVALUATE TRUE                                                09532504
095326         WHEN XL001-SUCCESSFUL                                    09532604
095327              CONTINUE                                            09532704
095328         WHEN XL001-SQL-ERROR                                     09532804
095329              MOVE XL001-UPC-SQLCODE TO PV-SQL-RETURN-CD          09532904
095330              INITIALIZE  PV-CICS-MSG-AREA                        09533004
095331              SET  PS-SOCKET-ERROR        TO TRUE                 09533104
095332              STRING ' PCKCS191-8580-CALL-XLKUT001-2'             09533204
095333                     ' sqlcode='                                  09533304
095334                     PV-DISPLAY-SQLCODE        delimited by size  09533404
095335                                        INTO PV-CICS-MSG-AREA     09533504
095336              MOVE LENGTH OF PV-CICS-MSG-AREA                     09533604
095337                     TO PV-COMMAREA-LENGTH                        09533704
095338              PERFORM 9999-WRITE-TO-CSSL                          09533804
095339              INITIALIZE  PV-CICS-MSG-AREA                        09533904
095340              MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09534004
095350              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09535004
095360                     'ITEM NUMBER :     '      DELIMITED BY SIZE  09536004
095370                     PV-DISPLAY-ITEM-NBR       DELIMITED BY SIZE  09537004
095380                                           INTO PV-CICS-MSG-AREA  09538004
095390              MOVE LENGTH OF PV-CICS-MSG-AREA                     09539004
095400                     TO PV-COMMAREA-LENGTH                        09540004
095410              PERFORM 9999-WRITE-TO-CSSL                          09541004
095420              INITIALIZE  PV-CICS-MSG-AREA                        09542004
095430              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09543004
095440                     ' PO:'                    DELIMITED BY SIZE  09544004
095450                     PC126-PO-NBR              DELIMITED BY SIZE  09545004
095460                     ' RCVR:'                  DELIMITED BY SIZE  09546004
095470                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09547004
095480                                           INTO PV-CICS-MSG-AREA  09548004
095490              MOVE LENGTH OF PV-CICS-MSG-AREA                     09549004
095500                     TO PV-COMMAREA-LENGTH                        09550004
095510              PERFORM 9999-WRITE-TO-CSSL                          09551004
095520              STRING 'ERR FILE# SQL='                             09552004
095530                         DELIMITED BY SIZE                        09553004
095540                         PV-SQL-RETURN-CD                         09554004
095550                         DELIMITED BY SIZE                        09555004
095560                                INTO PC126-CRA-RET-MSG            09556004
095570              MOVE '02'                TO PC126-CRA-RET-CDE       09557004
095580              MOVE '8580-'             TO PC126-CRA-REQ-ID        09558004
095590              PERFORM 9000-RETURN-CALL                            09559004
095600                                                                  09560004
095610         WHEN OTHER                                               09561004
095620              INITIALIZE  PV-CICS-MSG-AREA                        09562004
095630              MOVE XL001-KEY-ITM-NBR    TO PV-DISPLAY-ITEM-NBR    09563004
095640              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09564004
095650                     'ITEM NUMBER :     '      DELIMITED BY SIZE  09565004
095660                     PV-DISPLAY-ITEM-NBR       DELIMITED BY SIZE  09566004
095670                                           INTO PV-CICS-MSG-AREA  09567004
095680              MOVE LENGTH OF PV-CICS-MSG-AREA                     09568004
095690                     TO PV-COMMAREA-LENGTH                        09569004
095700              PERFORM 9999-WRITE-TO-CSSL                          09570004
095710              INITIALIZE  PV-CICS-MSG-AREA                        09571004
095720              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09572004
095730                     ' PO:'                    DELIMITED BY SIZE  09573004
095740                     PC126-PO-NBR              DELIMITED BY SIZE  09574004
095750                     ' RCVR:'                  DELIMITED BY SIZE  09575004
095760                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09576004
095770                                           INTO PV-CICS-MSG-AREA  09577004
095780              MOVE LENGTH OF PV-CICS-MSG-AREA                     09578004
095790                     TO PV-COMMAREA-LENGTH                        09579004
095800              PERFORM 9999-WRITE-TO-CSSL                          09580004
095810              STRING 'ERR FILE# SQL='                             09581004
095820                         DELIMITED BY SIZE                        09582004
095830                         PV-SQL-RETURN-CD                         09583004
095840                         DELIMITED BY SIZE                        09584004
095850                                INTO PC126-CRA-RET-MSG            09585004
095860              MOVE '02'                TO PC126-CRA-RET-CDE       09586004
095870              MOVE '8580-'             TO PC126-CRA-REQ-ID        09587004
095880              PERFORM 9000-RETURN-CALL                            09588004
095890     END-EVALUATE.                                                09589004
095900******************************************************************09590004
095910 8600-INSERT-OTBND-UPC.                                           09591004
095920******************************************************************09592004
095930                                                                  09593004
095940* DMH - 1/03/2005 - BEGIN                                         09594004
095950     IF   PS-DISPLAY-CSSL-YES                                     09595004
095960        INITIALIZE                       PV-CICS-MSG-AREA         09596004
095970        STRING ' PCKCS191- 8600-INSERT-OTBND-UPC         '        09597004
095980                                         DELIMITED BY SIZE        09598004
095990                                    INTO PV-CICS-MSG-AREA         09599004
096000        MOVE LENGTH OF PV-CICS-MSG-AREA                           09600004
096010                                      TO PV-COMMAREA-LENGTH       09601004
096020        EXEC CICS                                                 09602004
096030            WRITEQ TD                                             09603004
096040                QUEUE   ('CSSL')                                  09604004
096050                FROM    (PV-CICS-MSG-AREA)                        09605004
096060                LENGTH  (PV-COMMAREA-LENGTH)                      09606004
096070                RESP    (PV-CICS-RESP)                            09607004
096080        END-EXEC                                                  09608004
096090     END-IF.                                                      09609004
096100* DMH - 1/03/2005 - BEGIN                                         09610004
096110                                                                  09611004
096120     MOVE  PC180-SML-BARCODE  TO   SUT00028-SHIPT-UNT-ID.         09612004
096130     MOVE 'PO'                TO   SUT00028-TRN-TYP-CDE.          09613004
096140                                                                  09614004
096150     IF PS-ODD-CART-FCSE-INSERT                                   09615004
096160        SET PS-ODD-CART-FCSE-NO-INSERT TO TRUE                    09616004
096170     ELSE                                                         09617004
096180        IF PS-INPK-UNIT-QTY-YES                                   09618004
096190           MOVE PC126-INPK-UNT-QTY TO PC180-OTPK-UNT-QTY          09619004
096200        ELSE                                                      09620004
096210           MOVE PC126-OTPK-UNT-QTY TO PC180-OTPK-UNT-QTY          09621004
096220        END-IF                                                    09622004
096230     END-IF.                                                      09623004
096240                                                                  09624004
096250     EXEC SQL                                                     09625004
096260         INSERT INTO SUT_OTBND_UPC                                09626004
096270            (SHIPT_UNT_ID                                         09627004
096280            ,TRN_NBR                                              09628004
096290            ,RCVR_SEQ_NBR                                         09629004
096300            ,TRN_LNE_NBR                                          09630004
096310            ,TRN_TYP_CDE                                          09631004
096320            ,UPC_NBR                                              09632004
096330            ,SHPD_UNT_QTY)                                        09633004
096331         VALUES                                                   09633104
096332            (:SUT00028-SHIPT-UNT-ID                               09633204
096333            ,:PC180-PO-NBR                                        09633304
096334            ,:PC180-RCVR-SEQ-NBR                                  09633404
096335            ,:DK-ORD-LNE-NBR                                      09633504
096336            ,:SUT00028-TRN-TYP-CDE                                09633604
096337            ,:SUT00028-UPC-NBR                                    09633704
096338            ,:PC180-OTPK-UNT-QTY)                                 09633804
096339     END-EXEC                                                     09633904
096340                                                                  09634004
096341     EVALUATE TRUE                                                09634104
096342         WHEN SQLCODE = ZERO                                      09634204
096343              CONTINUE                                            09634304
096344         WHEN SQLCODE = -904                                      09634404
096345         WHEN SQLCODE = -911                                      09634504
096346         WHEN SQLCODE = -913                                      09634604
096347              SET  PS-SOCKET-ERROR        TO TRUE                 09634704
096348              MOVE ' PCKCS191-8600-INSERT-OTBND-UPC    '          09634804
096349                                          TO PV-CICS-MSG-AREA     09634904
096350              MOVE LENGTH OF PV-CICS-MSG-AREA                     09635004
096360                     TO PV-COMMAREA-LENGTH                        09636004
096370              PERFORM 9999-WRITE-TO-CSSL                          09637004
096380              INITIALIZE  PV-CICS-MSG-AREA                        09638004
096390              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09639004
096400              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09640004
096410                     ' PO:'                    DELIMITED BY SIZE  09641004
096420                     PC126-PO-NBR              DELIMITED BY SIZE  09642004
096430                     ' RCVR:'                  DELIMITED BY SIZE  09643004
096440                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09644004
096450                     ' LINE:'                  DELIMITED BY SIZE  09645004
096460                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09646004
096470                     ' SQLCODE:'               DELIMITED BY SIZE  09647004
096480                     PV-SQL-RETURN-CD          DELIMITED BY SIZE  09648004
096490                                           INTO PV-CICS-MSG-AREA  09649004
096500              MOVE LENGTH OF PV-CICS-MSG-AREA                     09650004
096510                     TO PV-COMMAREA-LENGTH                        09651004
096520              PERFORM 9999-WRITE-TO-CSSL                          09652004
096530             MOVE SQLCODE             TO PV-SQL-RETURN-CD         09653004
096540             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     09654004
096550                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     09655004
096560                                      INTO PC126-CRA-RET-MSG      09656004
096570             SET PC126-CRA-SQL-CONTENTION TO TRUE                 09657004
096580             PERFORM 9000-RETURN-CALL                             09658004
096590                                                                  09659004
096600         WHEN SQLWARN0 NOT = SPACES                               09660004
096610         WHEN SQLCODE NOT EQUAL ZERO                              09661004
096620              SET  PS-SOCKET-ERROR        TO TRUE                 09662004
096630              MOVE ' PCKCS191-8600-INSERT-OTBND-UPC'              09663004
096640                                          TO PV-CICS-MSG-AREA     09664004
096650              MOVE LENGTH OF PV-CICS-MSG-AREA                     09665004
096660                     TO PV-COMMAREA-LENGTH                        09666004
096670              PERFORM 9999-WRITE-TO-CSSL                          09667004
096680              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09668004
096690                     ' PO:'                    DELIMITED BY SIZE  09669004
096700                     PC126-PO-NBR              DELIMITED BY SIZE  09670004
096710                     ' RCVR:'                  DELIMITED BY SIZE  09671004
096720                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09672004
096730                     ' LINE:'                  DELIMITED BY SIZE  09673004
096740                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09674004
096750                                           INTO PV-CICS-MSG-AREA  09675004
096760              MOVE LENGTH OF PV-CICS-MSG-AREA                     09676004
096770                     TO PV-COMMAREA-LENGTH                        09677004
096780              PERFORM 9999-WRITE-TO-CSSL                          09678004
096790              MOVE '02'                TO PC126-CRA-RET-CDE       09679004
096800              MOVE '8600-'             TO PC126-CRA-REQ-ID        09680004
096810              PERFORM 9000-RETURN-CALL                            09681004
096820     END-EVALUATE.                                                09682004
096830                                                                  09683004
096840                                                                  09684004
096850******************************************************************09685004
096860 8610-INSERT-OTBND-UPC-PREPK.                                     09686004
096870******************************************************************09687004
096880* DMH - 1/03/2005 - BEGIN                                         09688004
096890     IF   PS-DISPLAY-CSSL-YES                                     09689004
096900        INITIALIZE                       PV-CICS-MSG-AREA         09690004
096910        STRING ' PCKCS191- 8610-INSERT-OTBND-UPC-PREPK   '        09691004
096920                                         DELIMITED BY SIZE        09692004
096930                                    INTO PV-CICS-MSG-AREA         09693004
096940        MOVE LENGTH OF PV-CICS-MSG-AREA                           09694004
096950                                      TO PV-COMMAREA-LENGTH       09695004
096960        EXEC CICS                                                 09696004
096970            WRITEQ TD                                             09697004
096980                QUEUE   ('CSSL')                                  09698004
096990                FROM    (PV-CICS-MSG-AREA)                        09699004
097000                LENGTH  (PV-COMMAREA-LENGTH)                      09700004
097010                RESP    (PV-CICS-RESP)                            09701004
097020        END-EXEC                                                  09702004
097030     END-IF.                                                      09703004
097040* DMH - 1/03/2005 - BEGIN                                         09704004
097050                                                                  09705004
097060                                                                  09706004
097070     MOVE  PC180-SML-BARCODE  TO   SUT00028-SHIPT-UNT-ID.         09707004
097080     MOVE 'PO'                TO   SUT00028-TRN-TYP-CDE.          09708004
097090     MULTIPLY  PV-PREPK-MULTIPLE                                  09709004
097100           BY  RECITM-PREPK-RATO-QTY                              09710004
097110       GIVING  PV-PREPK-OTPK-UNT-QTY.                             09711004
097120                                                                  09712004
097130     EXEC SQL                                                     09713004
097140         INSERT INTO SUT_OTBND_UPC                                09714004
097150            (SHIPT_UNT_ID                                         09715004
097160            ,TRN_NBR                                              09716004
097170            ,RCVR_SEQ_NBR                                         09717004
097180            ,TRN_LNE_NBR                                          09718004
097190            ,TRN_TYP_CDE                                          09719004
097200            ,UPC_NBR                                              09720004
097210            ,SHPD_UNT_QTY)                                        09721004
097220         VALUES                                                   09722004
097230            (:SUT00028-SHIPT-UNT-ID                               09723004
097240            ,:PC180-PO-NBR                                        09724004
097250            ,:PC180-RCVR-SEQ-NBR                                  09725004
097260            ,:DK-ORD-LNE-NBR                                      09726004
097270            ,:SUT00028-TRN-TYP-CDE                                09727004
097271            ,:SUT00028-UPC-NBR                                    09727104
097272            ,:PV-PREPK-OTPK-UNT-QTY)                              09727204
097273     END-EXEC                                                     09727304
097274                                                                  09727404
097275     EVALUATE TRUE                                                09727504
097276         WHEN SQLCODE = ZERO                                      09727604
097277              CONTINUE                                            09727704
097278         WHEN SQLCODE = -904                                      09727804
097279         WHEN SQLCODE = -911                                      09727904
097280         WHEN SQLCODE = -913                                      09728004
097281              SET  PS-SOCKET-ERROR        TO TRUE                 09728104
097282              MOVE ' 8610-INSERT-OTBND-UPC-PREPK    '             09728204
097283                                          TO PV-CICS-MSG-AREA     09728304
097284              MOVE LENGTH OF PV-CICS-MSG-AREA                     09728404
097285                     TO PV-COMMAREA-LENGTH                        09728504
097286              PERFORM 9999-WRITE-TO-CSSL                          09728604
097287              INITIALIZE  PV-CICS-MSG-AREA                        09728704
097288              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09728804
097289              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09728904
097290                     ' PO:'                    DELIMITED BY SIZE  09729004
097300                     PC126-PO-NBR              DELIMITED BY SIZE  09730004
097310                     ' RCVR:'                  DELIMITED BY SIZE  09731004
097320                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09732004
097330                     ' LINE:'                  DELIMITED BY SIZE  09733004
097340                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09734004
097350                     ' SQLCODE:'               DELIMITED BY SIZE  09735004
097360                     PV-SQL-RETURN-CD          DELIMITED BY SIZE  09736004
097370                                           INTO PV-CICS-MSG-AREA  09737004
097380              MOVE LENGTH OF PV-CICS-MSG-AREA                     09738004
097390                     TO PV-COMMAREA-LENGTH                        09739004
097400              PERFORM 9999-WRITE-TO-CSSL                          09740004
097410             MOVE SQLCODE             TO PV-SQL-RETURN-CD         09741004
097420             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     09742004
097430                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     09743004
097440                                      INTO PC126-CRA-RET-MSG      09744004
097450             SET PC126-CRA-SQL-CONTENTION TO TRUE                 09745004
097460             PERFORM 9000-RETURN-CALL                             09746004
097470         WHEN SQLWARN0 NOT = SPACES                               09747004
097480         WHEN SQLCODE NOT EQUAL ZERO                              09748004
097490              SET  PS-SOCKET-ERROR        TO TRUE                 09749004
097500              MOVE ' PCKCS191-8610-INSERT-OTBND-UPC-PREPK'        09750004
097510                                          TO PV-CICS-MSG-AREA     09751004
097520              MOVE LENGTH OF PV-CICS-MSG-AREA                     09752004
097530                     TO PV-COMMAREA-LENGTH                        09753004
097540              PERFORM 9999-WRITE-TO-CSSL                          09754004
097550              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09755004
097560                     ' PO:'                    DELIMITED BY SIZE  09756004
097570                     PC126-PO-NBR              DELIMITED BY SIZE  09757004
097580                     ' RCVR:'                  DELIMITED BY SIZE  09758004
097590                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09759004
097600                     ' LINE:'                  DELIMITED BY SIZE  09760004
097610                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09761004
097620                                           INTO PV-CICS-MSG-AREA  09762004
097630              MOVE LENGTH OF PV-CICS-MSG-AREA                     09763004
097640                     TO PV-COMMAREA-LENGTH                        09764004
097650              PERFORM 9999-WRITE-TO-CSSL                          09765004
097660              MOVE '02'                TO PC126-CRA-RET-CDE       09766004
097670              MOVE '8610-'             TO PC126-CRA-REQ-ID        09767004
097680              PERFORM 9000-RETURN-CALL                            09768004
097690     END-EVALUATE.                                                09769004
097700                                                                  09770004
097710                                                                  09771004
097720**********************************************************        09772004
097730 8670-INSERT-TSULBXF.                                             09773004
097740**********************************************************        09774004
097750* DMH - 1/03/2005 - BEGIN                                         09775004
097760     IF   PS-DISPLAY-CSSL-YES                                     09776004
097770        INITIALIZE                       PV-CICS-MSG-AREA         09777004
097780        STRING ' PCKCS191- 8670-INSERT-TSULBXF           '        09778004
097790                                         DELIMITED BY SIZE        09779004
097800                                    INTO PV-CICS-MSG-AREA         09780004
097810        MOVE LENGTH OF PV-CICS-MSG-AREA                           09781004
097820                                      TO PV-COMMAREA-LENGTH       09782004
097830        EXEC CICS                                                 09783004
097840            WRITEQ TD                                             09784004
097850                QUEUE   ('CSSL')                                  09785004
097860                FROM    (PV-CICS-MSG-AREA)                        09786004
097870                LENGTH  (PV-COMMAREA-LENGTH)                      09787004
097880                RESP    (PV-CICS-RESP)                            09788004
097890        END-EXEC                                                  09789004
097900     END-IF.                                                      09790004
097910* DMH - 1/03/2005 - BEGIN                                         09791004
097920                                                                  09792004
097930                                                                  09793004
097940     MOVE PC180-SML-BARCODE   TO   SULBXF-SHIPT-UNT-ID.           09794004
097950     MOVE SPACES              TO   SULBXF-BRCDE-NBR.              09795004
097960     MOVE '00'                TO   SULBXF-BRCDE-NBR (1:2).        09796004
097970     MOVE PC180-SML-BARCODE   TO   SULBXF-BRCDE-NBR (3:18).       09797004
097980     MOVE 'S'                 TO   SULBXF-CART-LBL-TYP-CDE.       09798004
097990     MOVE PT-STR-NBR (PT-DISTRO-IDX)                              09799004
098000                              TO   SULBXF-DEST-OPER-UNT-ID.       09800004
098010                                                                  09801004
098020     EXEC SQL                                                     09802004
098030         INSERT INTO TSULBXF                                      09803004
098040               ( SHIPT_UNT_ID                                     09804004
098050                ,BRCDE_NBR                                        09805004
098060                ,CART_LBL_TYP_CDE                                 09806004
098070                ,DEST_OPER_UNT_ID                                 09807004
098080                ,STAT_CDE                                         09808004
098090                ,LAST_STAT_CHG_TMST                               09809004
098100                ,CRE_TMST)                                        09810004
098110         VALUES (:SULBXF-SHIPT-UNT-ID                             09811004
098120               , :SULBXF-BRCDE-NBR                                09812004
098130               , :SULBXF-CART-LBL-TYP-CDE                         09813004
098140               , :SULBXF-DEST-OPER-UNT-ID                         09814004
098141               , :PC-A                                            09814104
098142               ,  CURRENT TIMESTAMP                               09814204
098143               ,  CURRENT TIMESTAMP)                              09814304
098144     END-EXEC                                                     09814404
098145         EVALUATE TRUE                                            09814504
098146           WHEN SQLCODE = ZERO                                    09814604
098147                CONTINUE                                          09814704
098148           WHEN SQLCODE = -904                                    09814804
098149           WHEN SQLCODE = -911                                    09814904
098150           WHEN SQLCODE = -913                                    09815004
098151              SET  PS-SOCKET-ERROR        TO TRUE                 09815104
098152              MOVE ' PCKCS191-8670-INSERT-TSULBXF         '       09815204
098153                                          TO PV-CICS-MSG-AREA     09815304
098154              MOVE LENGTH OF PV-CICS-MSG-AREA                     09815404
098155                     TO PV-COMMAREA-LENGTH                        09815504
098156              PERFORM 9999-WRITE-TO-CSSL                          09815604
098157              INITIALIZE  PV-CICS-MSG-AREA                        09815704
098158              MOVE SQLCODE             TO PV-SQL-RETURN-CD        09815804
098159              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09815904
098160                     ' PO:'                    DELIMITED BY SIZE  09816004
098170                     PC126-PO-NBR              DELIMITED BY SIZE  09817004
098180                     ' RCVR:'                  DELIMITED BY SIZE  09818004
098190                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09819004
098200                     ' LINE:'                  DELIMITED BY SIZE  09820004
098210                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09821004
098220                     ' SQLCODE:'               DELIMITED BY SIZE  09822004
098230                     PV-SQL-RETURN-CD          DELIMITED BY SIZE  09823004
098240                                           INTO PV-CICS-MSG-AREA  09824004
098250                MOVE LENGTH OF PV-CICS-MSG-AREA                   09825004
098260                     TO PV-COMMAREA-LENGTH                        09826004
098270                PERFORM 9999-WRITE-TO-CSSL                        09827004
098280                MOVE SQLCODE             TO PV-SQL-RETURN-CD      09828004
098290                STRING 'ERR FILE# SQL='        DELIMITED BY SIZE  09829004
098300                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     09830004
098310                                      INTO PC126-CRA-RET-MSG      09831004
098320                SET PC126-CRA-SQL-CONTENTION TO TRUE              09832004
098330                PERFORM 9000-RETURN-CALL                          09833004
098340                                                                  09834004
098350             WHEN SQLWARN0 NOT = SPACES                           09835004
098360             WHEN SQLCODE < ZERO                                  09836004
098370             WHEN SQLCODE > ZERO                                  09837004
098380                 MOVE '8670-INSERT-TSULBXF'                       09838004
098390                                             TO PV-CICS-MSG-AREA  09839004
098400                 MOVE LENGTH OF PV-CICS-MSG-AREA                  09840004
098410                        TO PV-COMMAREA-LENGTH                     09841004
098420                 PERFORM 9999-WRITE-TO-CSSL                       09842004
098430                 STRING ' PCKCS191 -'      DELIMITED BY SIZE      09843004
098440                        ' CARTON: '        DELIMITED BY SIZE      09844004
098450                        SULBXF-BRCDE-NBR   DELIMITED BY SIZE      09845004
098460                                           INTO PV-CICS-MSG-AREA  09846004
098470                 PERFORM 9999-WRITE-TO-CSSL                       09847004
098480                 MOVE '02'                TO PC126-CRA-RET-CDE    09848004
098490                 MOVE '8670-'             TO PC126-CRA-REQ-ID     09849004
098500                 PERFORM 9000-RETURN-CALL                         09850004
098510         END-EVALUATE.                                            09851004
098520                                                                  09852004
098530                                                                  09853004
098540******************************************************************09854004
098550* UPDATE SUT_OTBND_CART - UPDATE ROW WITH LABEL SEQUENCE NUMBER  *09855004
098560******************************************************************09856004
098570 8800-UPDATE-OTBND-CART.                                          09857004
098580                                                                  09858004
098590* DMH - 1/03/2005 - BEGIN                                         09859004
098600     IF   PS-DISPLAY-CSSL-YES                                     09860004
098610        INITIALIZE                       PV-CICS-MSG-AREA         09861004
098620        STRING ' PCKCS191- 8800-UPDATE-OTBND-CART        '        09862004
098630                                         DELIMITED BY SIZE        09863004
098640                                    INTO PV-CICS-MSG-AREA         09864004
098650        MOVE LENGTH OF PV-CICS-MSG-AREA                           09865004
098660                                      TO PV-COMMAREA-LENGTH       09866004
098670        EXEC CICS                                                 09867004
098680            WRITEQ TD                                             09868004
098690                QUEUE   ('CSSL')                                  09869004
098700                FROM    (PV-CICS-MSG-AREA)                        09870004
098710                LENGTH  (PV-COMMAREA-LENGTH)                      09871004
098720                RESP    (PV-CICS-RESP)                            09872004
098730        END-EXEC                                                  09873004
098740     END-IF.                                                      09874004
098750* DMH - 1/03/2005 - BEGIN                                         09875004
098760                                                                  09876004
098770     IF PS-PRINT-FCSE-LABELS                                      09877004
098780        MOVE 'F'   TO   SUT00024-CART-TYP-CDE                     09878004
098790     ELSE                                                         09879004
098800        MOVE 'I'   TO   SUT00024-CART-TYP-CDE                     09880004
098810     END-IF.                                                      09881004
098820     MOVE    PV-OB-CART-BRCDE-18  TO SUT00024-SHIPT-UNT-ID.       09882004
098830                                                                  09883004
098840     IF PC253-EAS-TAG-NEEDED                                      09884004
098850        MOVE 'Y'           TO SUT00024-EAS-TAG-IND                09885004
098860     ELSE                                                         09886004
098870        MOVE 'N'           TO SUT00024-EAS-TAG-IND                09887004
098880     END-IF                                                       09888004
098890* DMH BEGIN 06/04/02                                              09889004
098900     IF  PS-ADD-BACK-FOR-MFST-YES                                 09890004
098910         ADD  1  TO  PV-OB-CART-LBL-PRT-SEQ                       09891004
098920                     SUT00024-SHIPT-UNT-ID                        09892004
098930     END-IF.                                                      09893004
098940* DMH END 06/04/02                                                09894004
098950                                                                  09895004
098960* dmh begin 05/30/02 test                                         09896004
098970*    INITIALIZE  PV-CICS-MSG-AREA                                 09897004
098980*    MOVE SUT00024-SHIPT-UNT-ID TO PV-DISPLAY-SHIPT-UNT-ID        09898004
098990*    MOVE PV-OB-CART-LBL-PRT-SEQ TO PV-DISPLAY-LBL-PRT-SEQ        09899004
098991*    STRING ' PCKCS191-'                        DELIMITED BY SIZE 09899104
098992*           ' BARCODE-' PV-DISPLAY-SHIPT-UNT-ID DELIMITED BY SIZE 09899204
098993*           ' TYPE-'     SUT00024-CART-TYP-CDE  DELIMITED BY SIZE 09899304
098994*           ' SEQ-'     PV-DISPLAY-LBL-PRT-SEQ  DELIMITED BY SIZE 09899404
098995*                                       INTO PV-CICS-MSG-AREA     09899504
098996*    MOVE LENGTH OF PV-CICS-MSG-AREA                              09899604
098997*      TO PV-COMMAREA-LENGTH                                      09899704
098998*    PERFORM 9999-WRITE-TO-CSSL                                   09899804
098999*    INITIALIZE  PV-CICS-MSG-AREA.                                09899904
099000* dmh end 05/30/02 - test                                         09900004
099010                                                                  09901004
099011     EXEC SQL                                                     09901104
099012         UPDATE SUT_OTBND_CART                                    09901204
099013         SET                                                      09901304
099014             LBL_PRT_SEQ_NBR =  :PV-OB-CART-LBL-PRT-SEQ           09901404
099015           , CART_TYP_CDE    =  :SUT00024-CART-TYP-CDE            09901504
099016           , EAS_TAG_IND     =  :SUT00024-EAS-TAG-IND             09901604
099017          WHERE                                                   09901704
099018             SHIPT_UNT_ID    =  :SUT00024-SHIPT-UNT-ID            09901804
099019     END-EXEC.                                                    09901904
099020                                                                  09902004
099030     EVALUATE TRUE                                                09903004
099040         WHEN SQLCODE = ZERO                                      09904004
099050             CONTINUE                                             09905004
099060         WHEN OTHER                                               09906004
099070              move sqlcode  to  PV-DISPLAY-SQLCODE                09907004
099080              INITIALIZE  PV-CICS-MSG-AREA                        09908004
099090              SET  PS-SOCKET-ERROR        TO TRUE                 09909004
099100              string ' PCKCS191-8800-UPDATE-OTBND-CART   '        09910004
099110                     ' sqlcode='                                  09911004
099120                     PV-DISPLAY-SQLCODE        delimited by size  09912004
099130                                        inTO PV-CICS-MSG-AREA     09913004
099140              MOVE LENGTH OF PV-CICS-MSG-AREA                     09914004
099150                     TO PV-COMMAREA-LENGTH                        09915004
099160              PERFORM 9999-WRITE-TO-CSSL                          09916004
099170              INITIALIZE  PV-CICS-MSG-AREA                        09917004
099180              MOVE   DK-LPMS-TRANS-ID   TO PV-DISPLAY-LPMS-TRAN   09918004
099190              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09919004
099191                     'DK-LPMS-TRANS-ID: '      DELIMITED BY SIZE  09919104
099192                     PV-DISPLAY-LPMS-TRAN      DELIMITED BY SIZE  09919204
099193                     '  PV-LPMS-XMIT-RETURN: ' DELIMITED BY SIZE  09919304
099194                     PV-LPMS-XMIT-RETURN       DELIMITED BY SIZE  09919404
099195                                           INTO PV-CICS-MSG-AREA  09919504
099196              MOVE LENGTH OF PV-CICS-MSG-AREA                     09919604
099197                     TO PV-COMMAREA-LENGTH                        09919704
099198              PERFORM 9999-WRITE-TO-CSSL                          09919804
099199              INITIALIZE  PV-CICS-MSG-AREA                        09919904
099200              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09920004
099210                     ' PO:'                    DELIMITED BY SIZE  09921004
099220                     PC126-PO-NBR              DELIMITED BY SIZE  09922004
099230                     ' RCVR:'                  DELIMITED BY SIZE  09923004
099240                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09924004
099250                     ' BARCODE:'               DELIMITED BY SIZE  09925004
099260                     PV-OB-CART-BRCDE-18       DELIMITED BY SIZE  09926004
099270                                           INTO PV-CICS-MSG-AREA  09927004
099280              MOVE LENGTH OF PV-CICS-MSG-AREA                     09928004
099290                     TO PV-COMMAREA-LENGTH                        09929004
099300              PERFORM 9999-WRITE-TO-CSSL                          09930004
099310              STRING 'ERR FILE# SQL='                             09931004
099320                         DELIMITED BY SIZE                        09932004
099330                         PV-SQL-RETURN-CD                         09933004
099340                         DELIMITED BY SIZE                        09934004
099350                                INTO PC126-CRA-RET-MSG            09935004
099360              MOVE '02'                TO PC126-CRA-RET-CDE       09936004
099370              MOVE '8800-'             TO PC126-CRA-REQ-ID        09937004
099380              PERFORM 9000-RETURN-CALL                            09938004
099390                                                                  09939004
099400     END-EVALUATE.                                                09940004
099410                                                                  09941004
099420                                                                  09942004
099430******************************************************************09943004
099440* CHECK SUT_OTBND_CART/SUT_OTBND_UPC                              09944004
099450* FOR REPRINT MANIFEST NUMBER     *                               09945004
099460******************************************************************09946004
099470 8900-CHECK-FOR-RPRT-MFST-NBR.                                    09947004
099480                                                                  09948004
099490* DMH - 1/03/2005 - BEGIN                                         09949004
099500     IF   PS-DISPLAY-CSSL-YES                                     09950004
099510        INITIALIZE                       PV-CICS-MSG-AREA         09951004
099520        STRING ' PCKCS191- 8900-CHECK-FOR-RPRT-MFST-NBR  '        09952004
099530                                         DELIMITED BY SIZE        09953004
099540                                    INTO PV-CICS-MSG-AREA         09954004
099550        MOVE LENGTH OF PV-CICS-MSG-AREA                           09955004
099560                                      TO PV-COMMAREA-LENGTH       09956004
099570        EXEC CICS                                                 09957004
099580            WRITEQ TD                                             09958004
099590                QUEUE   ('CSSL')                                  09959004
099600                FROM    (PV-CICS-MSG-AREA)                        09960004
099610                LENGTH  (PV-COMMAREA-LENGTH)                      09961004
099620                RESP    (PV-CICS-RESP)                            09962004
099630        END-EXEC                                                  09963004
099640     END-IF.                                                      09964004
099650* DMH - 1/03/2005 - BEGIN                                         09965004
099660                                                                  09966004
099670     INITIALIZE PV-DB2-COUNT.                                     09967004
099680                                                                  09968004
099690     EXEC SQL                                                     09969004
099700         SELECT COUNT(*)                                          09970004
099710         INTO   :PV-DB2-COUNT                                     09971004
099720         FROM   SUT_OTBND_UPC A                                   09972004
099730               ,SUT_OTBND_CART B                                  09973004
099740         WHERE  A.TRN_NBR      = :PC180-PO-NBR                    09974004
099750           AND  A.RCVR_SEQ_NBR = :PC180-RCVR-SEQ-NBR              09975004
099760           AND  A.TRN_LNE_NBR  = :DK-ORD-LNE-NBR                  09976004
099770           AND  A.SHIPT_UNT_ID =  B.SHIPT_UNT_ID                  09977004
099780           AND  B.ACTV_IND     = 'Y'                              09978004
099790           AND  B.DEST_LOC_NBR = :DK-STR-NBR                      09979004
099800           AND  B.CRE_PGM_NM       = 'PCKCS191'                   09980004
099810     END-EXEC.                                                    09981004
099820                                                                  09982004
099830     EVALUATE TRUE                                                09983004
099840         WHEN SQLCODE = ZERO                                      09984004
099850              CONTINUE                                            09985004
099860         WHEN OTHER                                               09986004
099870              INITIALIZE  PV-CICS-MSG-AREA                        09987004
099880              SET  PS-SOCKET-ERROR        TO TRUE                 09988004
099890              MOVE ' PCKCS191-8900-CHECK-FOR-RPRT-MFST-NBR'       09989004
099900                                          TO PV-CICS-MSG-AREA     09990004
099910              MOVE LENGTH OF PV-CICS-MSG-AREA                     09991004
099911                     TO PV-COMMAREA-LENGTH                        09991104
099912              PERFORM 9999-WRITE-TO-CSSL                          09991204
099913              INITIALIZE  PV-CICS-MSG-AREA                        09991304
099914              MOVE   DK-LPMS-TRANS-ID   TO PV-DISPLAY-LPMS-TRAN   09991404
099915              STRING ' PCKCS191 - '            DELIMITED BY SIZE  09991504
099916                     'DK-LPMS-TRANS-ID: '      DELIMITED BY SIZE  09991604
099917                     PV-DISPLAY-LPMS-TRAN      DELIMITED BY SIZE  09991704
099918                     '  PV-LPMS-XMIT-RETURN: ' DELIMITED BY SIZE  09991804
099919                     PV-LPMS-XMIT-RETURN       DELIMITED BY SIZE  09991904
099920                                           INTO PV-CICS-MSG-AREA  09992004
099921              MOVE LENGTH OF PV-CICS-MSG-AREA                     09992104
099922                     TO PV-COMMAREA-LENGTH                        09992204
099923              PERFORM 9999-WRITE-TO-CSSL                          09992304
099924              INITIALIZE  PV-CICS-MSG-AREA                        09992404
099925              STRING ' PCKCS191 -'             DELIMITED BY SIZE  09992504
099926                     ' PO:'                    DELIMITED BY SIZE  09992604
099927                     PC126-PO-NBR              DELIMITED BY SIZE  09992704
099928                     ' RCVR:'                  DELIMITED BY SIZE  09992804
099929                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  09992904
099930                     ' LINE:'                  DELIMITED BY SIZE  09993004
099940                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  09994004
099950                                           INTO PV-CICS-MSG-AREA  09995004
099960              MOVE LENGTH OF PV-CICS-MSG-AREA                     09996004
099970                     TO PV-COMMAREA-LENGTH                        09997004
099980              PERFORM 9999-WRITE-TO-CSSL                          09998004
099990     END-EVALUATE.                                                09999004
100000                                                                  10000004
100010                                                                  10001004
100020******************************************************************10002004
100030 8940-OPEN-REPRINT-MNFST-CSR.                                     10003004
100040******************************************************************10004004
100050                                                                  10005004
100060* DMH - 1/03/2005 - BEGIN                                         10006004
100070     IF   PS-DISPLAY-CSSL-YES                                     10007004
100080        INITIALIZE                       PV-CICS-MSG-AREA         10008004
100090        STRING ' PCKCS191- 8940-OPEN-REPRINT-MNFST-CSR   '        10009004
100100                                         DELIMITED BY SIZE        10010004
100110                                    INTO PV-CICS-MSG-AREA         10011004
100120        MOVE LENGTH OF PV-CICS-MSG-AREA                           10012004
100130                                      TO PV-COMMAREA-LENGTH       10013004
100140        EXEC CICS                                                 10014004
100150            WRITEQ TD                                             10015004
100160                QUEUE   ('CSSL')                                  10016004
100170                FROM    (PV-CICS-MSG-AREA)                        10017004
100180                LENGTH  (PV-COMMAREA-LENGTH)                      10018004
100190                RESP    (PV-CICS-RESP)                            10019004
100200        END-EXEC                                                  10020004
100210     END-IF.                                                      10021004
100220* DMH - 1/03/2005 - BEGIN                                         10022004
100230                                                                  10023004
100240         EXEC SQL                                                 10024004
100250              OPEN REPRINT-MNFST-CSR                              10025004
100260         END-EXEC                                                 10026004
100270                                                                  10027004
100280                                                                  10028004
100290     EVALUATE TRUE                                                10029004
100300         WHEN SQLCODE = ZERO                                      10030004
100310             CONTINUE                                             10031004
100320                                                                  10032004
100330         WHEN SQLCODE = -904                                      10033004
100340         WHEN SQLCODE = -911                                      10034004
100350         WHEN SQLCODE = -913                                      10035004
100360             MOVE SQLCODE             TO PV-SQL-RETURN-CD         10036004
100370             STRING 'ERR FILE# SQL='        DELIMITED BY SIZE     10037004
100380                    PV-SQL-RETURN-CD        DELIMITED BY SIZE     10038004
100390                                      INTO PC126-CRA-RET-MSG      10039004
100400             MOVE '01'                TO PC126-CRA-RET-CDE        10040004
100410             PERFORM 9000-RETURN-CALL                             10041004
100420                                                                  10042004
100430         WHEN SQLWARN0 NOT = SPACES                               10043004
100440         WHEN SQLCODE < ZERO                                      10044004
100450         WHEN SQLCODE > ZERO                                      10045004
100460             INITIALIZE  PV-CICS-MSG-AREA                         10046004
100470              MOVE SQLCODE             TO PV-SQL-RETURN-CD        10047004
100480              STRING ' PCKCS191 - '            DELIMITED BY SIZE  10048004
100481                     '8940-OPEN-REPRINT-MFST'  DELIMITED BY SIZE  10048104
100482                     '  sql - '                delimited by size  10048204
100483                     PV-SQL-RETURN-CD          delimited by size  10048304
100484                                           INTO PV-CICS-MSG-AREA  10048404
100485              MOVE LENGTH OF PV-CICS-MSG-AREA                     10048504
100486                     TO PV-COMMAREA-LENGTH                        10048604
100487              PERFORM 9999-WRITE-TO-CSSL                          10048704
100488              INITIALIZE  PV-CICS-MSG-AREA                        10048804
100489              STRING ' PCKCS191 -'             DELIMITED BY SIZE  10048904
100490                     ' PO:'                    DELIMITED BY SIZE  10049004
100491                     PC126-PO-NBR              DELIMITED BY SIZE  10049104
100492                     ' RCVR:'                  DELIMITED BY SIZE  10049204
100493                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  10049304
100494                     ' LINE:'                  DELIMITED BY SIZE  10049404
100495                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  10049504
100496                                           INTO PV-CICS-MSG-AREA  10049604
100497              MOVE LENGTH OF PV-CICS-MSG-AREA                     10049704
100498                     TO PV-COMMAREA-LENGTH                        10049804
100499              PERFORM 9999-WRITE-TO-CSSL                          10049904
100500                                                                  10050004
100510             STRING 'ERR FILE# SQL='                              10051004
100520                        DELIMITED BY SIZE                         10052004
100530                        PV-SQL-RETURN-CD                          10053004
100540                        DELIMITED BY SIZE                         10054004
100550                               INTO PC126-CRA-RET-MSG             10055004
100560             MOVE '02'                TO PC126-CRA-RET-CDE        10056004
100570             MOVE '8940-'             TO PC126-CRA-REQ-ID         10057004
100580             PERFORM 9000-RETURN-CALL                             10058004
100590                                                                  10059004
100600     END-EVALUATE.                                                10060004
100610                                                                  10061004
100620 EJECT                                                            10062004
100630******************************************************************10063004
100640* CHECK SUT_OTBND_CART/SUT_OTBND_UPC                              10064004
100650* FOR REPRINT MANIFEST NUMBER     *                               10065004
100660*----------------------------------------------------------------*10066004
100670*                                                                 10067004
100680*----------------------------------------------------------------*10068004
100690 8950-FETCH-REPRINT-MFST-CSR.                                     10069004
100700                                                                  10070004
100710* DMH - 1/03/2005 - BEGIN                                         10071004
100720     IF   PS-DISPLAY-CSSL-YES                                     10072004
100730        INITIALIZE                       PV-CICS-MSG-AREA         10073004
100740        STRING ' PCKCS191- 8950-FETCH-REPRINT-MFST-CSR   '        10074004
100750                                         DELIMITED BY SIZE        10075004
100760                                    INTO PV-CICS-MSG-AREA         10076004
100770        MOVE LENGTH OF PV-CICS-MSG-AREA                           10077004
100780                                      TO PV-COMMAREA-LENGTH       10078004
100790        EXEC CICS                                                 10079004
100800            WRITEQ TD                                             10080004
100810                QUEUE   ('CSSL')                                  10081004
100820                FROM    (PV-CICS-MSG-AREA)                        10082004
100830                LENGTH  (PV-COMMAREA-LENGTH)                      10083004
100840                RESP    (PV-CICS-RESP)                            10084004
100850        END-EXEC                                                  10085004
100860     END-IF.                                                      10086004
100870* DMH - 1/03/2005 - BEGIN                                         10087004
100880                                                                  10088004
100890     EXEC SQL                                                     10089004
100900        FETCH   REPRINT-MNFST-CSR                                 10090004
100910        INTO   :SUT00028-SHIPT-UNT-ID                             10091004
100920             , :SUT00024-LBL-PRT-SEQ-NBR                          10092004
100930     END-EXEC.                                                    10093004
100940                                                                  10094004
100950     EVALUATE TRUE                                                10095004
100960       WHEN SQLCODE = ZEROS                                       10096004
100970         MOVE SUT00028-SHIPT-UNT-ID TO PV-OB-CART-BRCDE-18        10097004
100980                                       SUT00024-SHIPT-UNT-ID      10098004
100990         IF PS-FIRST-MFST-FETCH                                   10099004
101000            MOVE PV-OB-CART-BRCDE-18 TO PV-FIRST-MANIFEST         10100004
101010                                       PV-LAST-MANIFEST           10101004
101020            SET  PS-NOT-FIRST-MFST-FETCH   TO TRUE                10102004
101030         ELSE                                                     10103004
101040            MOVE PV-OB-CART-BRCDE-18 TO PV-LAST-MANIFEST          10104004
101050         END-IF                                                   10105004
101060         PERFORM 2300-CALL-STORE-ON-HAND-MOD                      10106004
101070       WHEN SQLCODE = +100                                        10107004
101080            SET PS-EO-REPRINT-MNFST-CSR TO TRUE                   10108004
101090            SET PS-FIRST-MFST-FETCH  TO TRUE                      10109004
101100            MOVE PV-FIRST-MANIFEST TO                             10110004
101110                                PT-MANIFEST-START (PT-DISTRO-IDX) 10111004
101120            MOVE PV-LAST-MANIFEST TO                              10112004
101130                                PT-MANIFEST-END (PT-DISTRO-IDX)   10113004
101131                                                                  10113104
101132       WHEN SQLWARN0 NOT = SPACES                                 10113204
101133       WHEN SQLCODE < ZERO                                        10113304
101134       WHEN SQLCODE > ZERO                                        10113404
101135             INITIALIZE  PV-CICS-MSG-AREA                         10113504
101136              MOVE SQLCODE             TO PV-SQL-RETURN-CD        10113604
101137              STRING ' PCKCS191 - '            DELIMITED BY SIZE  10113704
101138                     '8950-FETCH-REPRINT-MFST'  DELIMITED BY SIZE 10113804
101139                     '  sql - '                delimited by size  10113904
101140                     PV-SQL-RETURN-CD          delimited by size  10114004
101141                                           INTO PV-CICS-MSG-AREA  10114104
101142              MOVE LENGTH OF PV-CICS-MSG-AREA                     10114204
101143                     TO PV-COMMAREA-LENGTH                        10114304
101144              PERFORM 9999-WRITE-TO-CSSL                          10114404
101145              INITIALIZE  PV-CICS-MSG-AREA                        10114504
101146              STRING ' PCKCS191 -'             DELIMITED BY SIZE  10114604
101147                     ' PO:'                    DELIMITED BY SIZE  10114704
101148                     PC126-PO-NBR              DELIMITED BY SIZE  10114804
101149                     ' RCVR:'                  DELIMITED BY SIZE  10114904
101150                     PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE  10115004
101160                     ' LINE:'                  DELIMITED BY SIZE  10116004
101170                     PC126-PO-LNE-NBR          DELIMITED BY SIZE  10117004
101180                                           INTO PV-CICS-MSG-AREA  10118004
101190              MOVE LENGTH OF PV-CICS-MSG-AREA                     10119004
101200                     TO PV-COMMAREA-LENGTH                        10120004
101210              PERFORM 9999-WRITE-TO-CSSL                          10121004
101220                                                                  10122004
101230             STRING 'ERR FILE# SQL='                              10123004
101240                        DELIMITED BY SIZE                         10124004
101250                        PV-SQL-RETURN-CD                          10125004
101260                        DELIMITED BY SIZE                         10126004
101270                               INTO PC126-CRA-RET-MSG             10127004
101280             MOVE '02'                TO PC126-CRA-RET-CDE        10128004
101290             MOVE '8950-'             TO PC126-CRA-REQ-ID         10129004
101300             PERFORM 9000-RETURN-CALL                             10130004
101310                                                                  10131004
101320     END-EVALUATE.                                                10132004
101330                                                                  10133004
101340                                                                  10134004
101350******************************************************************10135004
101360 8960-CLOSE-REPRINT-MNFST-CSR.                                    10136004
101370******************************************************************10137004
101380                                                                  10138004
101390* DMH - 1/03/2005 - BEGIN                                         10139004
101400     IF   PS-DISPLAY-CSSL-YES                                     10140004
101410        INITIALIZE                       PV-CICS-MSG-AREA         10141004
101420        STRING ' PCKCS191- 8960-CLOSE-REPRINT-MNFST-CSR  '        10142004
101430                                         DELIMITED BY SIZE        10143004
101440                                    INTO PV-CICS-MSG-AREA         10144004
101450        MOVE LENGTH OF PV-CICS-MSG-AREA                           10145004
101460                                      TO PV-COMMAREA-LENGTH       10146004
101470        EXEC CICS                                                 10147004
101480            WRITEQ TD                                             10148004
101490                QUEUE   ('CSSL')                                  10149004
101500                FROM    (PV-CICS-MSG-AREA)                        10150004
101510                LENGTH  (PV-COMMAREA-LENGTH)                      10151004
101520                RESP    (PV-CICS-RESP)                            10152004
101530        END-EXEC                                                  10153004
101540     END-IF.                                                      10154004
101550* DMH - 1/03/2005 - BEGIN                                         10155004
101560                                                                  10156004
101570       EXEC SQL                                                   10157004
101580            CLOSE REPRINT-MNFST-CSR                               10158004
101590       END-EXEC                                                   10159004
101600                                                                  10160004
101610       EVALUATE TRUE                                              10161004
101620           WHEN SQLCODE = ZERO                                    10162004
101630               CONTINUE                                           10163004
101640                                                                  10164004
101650           WHEN SQLCODE = -904                                    10165004
101660           WHEN SQLCODE = -911                                    10166004
101670           WHEN SQLCODE = -913                                    10167004
101680               MOVE SQLCODE             TO PV-SQL-RETURN-CD       10168004
101690               STRING 'ERR FILE# SQL='        DELIMITED BY SIZE   10169004
101700                      PV-SQL-RETURN-CD        DELIMITED BY SIZE   10170004
101710                                        INTO PC126-CRA-RET-MSG    10171004
101720               MOVE '01'                TO PC126-CRA-RET-CDE      10172004
101730               PERFORM 9000-RETURN-CALL                           10173004
101740                                                                  10174004
101750           WHEN SQLWARN0 NOT = SPACES                             10175004
101760           WHEN SQLCODE < ZERO                                    10176004
101770           WHEN SQLCODE > ZERO                                    10177004
101780               INITIALIZE  PV-CICS-MSG-AREA                       10178004
101790                MOVE SQLCODE             TO PV-SQL-RETURN-CD      10179004
101791                STRING ' PCKCS191 - '            DELIMITED BY SIZE10179104
101792                       '8960-CLOSE REPRINT-MFST' DELIMITED BY SIZE10179204
101793                       '  sql - '                delimited by size10179304
101794                       PV-SQL-RETURN-CD          delimited by size10179404
101795                                             INTO PV-CICS-MSG-AREA10179504
101796                MOVE LENGTH OF PV-CICS-MSG-AREA                   10179604
101797                       TO PV-COMMAREA-LENGTH                      10179704
101798                PERFORM 9999-WRITE-TO-CSSL                        10179804
101799                INITIALIZE  PV-CICS-MSG-AREA                      10179904
101800                STRING ' PCKCS191 -'             DELIMITED BY SIZE10180004
101801                       ' PO:'                    DELIMITED BY SIZE10180104
101802                       PC126-PO-NBR              DELIMITED BY SIZE10180204
101803                       ' RCVR:'                  DELIMITED BY SIZE10180304
101804                       PC126-RCVR-SEQ-NBR        DELIMITED BY SIZE10180404
101805                       ' LINE:'                  DELIMITED BY SIZE10180504
101806                       PC126-PO-LNE-NBR          DELIMITED BY SIZE10180604
101807                                             INTO PV-CICS-MSG-AREA10180704
101808                MOVE LENGTH OF PV-CICS-MSG-AREA                   10180804
101809                       TO PV-COMMAREA-LENGTH                      10180904
101810                PERFORM 9999-WRITE-TO-CSSL                        10181004
101820                                                                  10182004
101830               STRING 'ERR FILE# SQL='                            10183004
101840                          DELIMITED BY SIZE                       10184004
101850                          PV-SQL-RETURN-CD                        10185004
101860                          DELIMITED BY SIZE                       10186004
101870                                 INTO PC126-CRA-RET-MSG           10187004
101880               MOVE '02'                TO PC126-CRA-RET-CDE      10188004
101890               MOVE '8960-'             TO PC126-CRA-REQ-ID       10189004
101900               PERFORM 9000-RETURN-CALL                           10190004
101910                                                                  10191004
101920       END-EVALUATE.                                              10192004
101930                                                                  10193004
101940                                                                  10194004
101950 EJECT                                                            10195004
101960                                                                  10196004
101970 9000-RETURN-CALL.                                                10197004
101980*----------------------------------------------------------------*10198004
101990*  PREPARES INFO TO BE RETURNED TO THE 'CALLING' PROGRAM.        *10199004
102000*----------------------------------------------------------------*10200004
102010                                                                  10201004
102020* DMH - 1/03/2005 - BEGIN                                         10202004
102030     IF   PS-DISPLAY-CSSL-YES                                     10203004
102040        INITIALIZE                       PV-CICS-MSG-AREA         10204004
102050        STRING ' PCKCS191- 9000-RETURN-CALL              '        10205004
102060                                         DELIMITED BY SIZE        10206004
102070                                    INTO PV-CICS-MSG-AREA         10207004
102080        MOVE LENGTH OF PV-CICS-MSG-AREA                           10208004
102090                                      TO PV-COMMAREA-LENGTH       10209004
102100        EXEC CICS                                                 10210004
102110            WRITEQ TD                                             10211004
102120                QUEUE   ('CSSL')                                  10212004
102130                FROM    (PV-CICS-MSG-AREA)                        10213004
102140                LENGTH  (PV-COMMAREA-LENGTH)                      10214004
102150                RESP    (PV-CICS-RESP)                            10215004
102160        END-EXEC                                                  10216004
102170     END-IF.                                                      10217004
102180* DMH - 1/03/2005 - BEGIN                                         10218004
102190                                                                  10219004
102200     MOVE PC126-COMMAREA-REC           TO DFHCOMMAREA.            10220004
102210     IF PC126-CRA-SQL-CONTENTION                                  10221004
102220        EXEC CICS SYNCPOINT                                       10222004
102230          ROLLBACK                                                10223004
102240        END-EXEC                                                  10224004
102250     END-IF                                                       10225004
102260                                                                  10226004
102270     EXEC CICS                                                    10227004
102280         RETURN                                                   10228004
102290     END-EXEC.                                                    10229004
102300                                                                  10230004
102310 9100-SYNCPOINT.                                                  10231004
102320                                                                  10232004
102330* DMH - 1/03/2005 - BEGIN                                         10233004
102340     IF   PS-DISPLAY-CSSL-YES                                     10234004
102350        INITIALIZE                       PV-CICS-MSG-AREA         10235004
102360        STRING ' PCKCS191- 9100-SYNCPOINT                '        10236004
102370                                         DELIMITED BY SIZE        10237004
102380                                    INTO PV-CICS-MSG-AREA         10238004
102390        MOVE LENGTH OF PV-CICS-MSG-AREA                           10239004
102400                                      TO PV-COMMAREA-LENGTH       10240004
102410        EXEC CICS                                                 10241004
102420            WRITEQ TD                                             10242004
102421                QUEUE   ('CSSL')                                  10242104
102422                FROM    (PV-CICS-MSG-AREA)                        10242204
102423                LENGTH  (PV-COMMAREA-LENGTH)                      10242304
102424                RESP    (PV-CICS-RESP)                            10242404
102425        END-EXEC                                                  10242504
102426     END-IF.                                                      10242604
102427* DMH - 1/03/2005 - BEGIN                                         10242704
102428                                                                  10242804
102429     EXEC CICS                                                    10242904
102430         SYNCPOINT                                                10243004
102431     END-EXEC.                                                    10243104
102432                                                                  10243204
102433 9200-READ-STORE-QUEUE.                                           10243304
102434                                                                  10243404
102435* DMH - 1/03/2005 - BEGIN                                         10243504
102436     IF   PS-DISPLAY-CSSL-YES                                     10243604
102437        INITIALIZE                       PV-CICS-MSG-AREA         10243704
102438        STRING ' PCKCS191- 9200-READ-STORE-QUEUE         '        10243804
102439                                         DELIMITED BY SIZE        10243904
102440                                    INTO PV-CICS-MSG-AREA         10244004
102450        MOVE LENGTH OF PV-CICS-MSG-AREA                           10245004
102460                                      TO PV-COMMAREA-LENGTH       10246004
102470        EXEC CICS                                                 10247004
102480            WRITEQ TD                                             10248004
102490                QUEUE   ('CSSL')                                  10249004
102500                FROM    (PV-CICS-MSG-AREA)                        10250004
102510                LENGTH  (PV-COMMAREA-LENGTH)                      10251004
102520                RESP    (PV-CICS-RESP)                            10252004
102530        END-EXEC                                                  10253004
102540     END-IF.                                                      10254004
102550* DMH - 1/03/2005 - BEGIN                                         10255004
102551                                                                  10255104
102552     EXEC CICS                                                    10255204
102553          READQ TS                                                10255304
102554              QUEUE (PC126-PRT-QUEUE-NAME)                        10255404
102555              INTO  (PC128-COMMAREA-REC)                          10255504
102556              LENGTH(PV-READ-LENGTH)                              10255604
102557              RESP  (PV-CICS-RESPONSE)                            10255704
102558     END-EXEC.                                                    10255804
102559*                                                                 10255904
102560     EVALUATE PV-CICS-RESPONSE                                    10256004
102561         WHEN DFHRESP(NORMAL)                                     10256104
102562             SET PS-NOT-PGBK-REQST-QUEUE-EOF  TO TRUE             10256204
102563             ADD +1                   TO PV-STORE-COUNTER         10256304
102564                                         PV-PT-LABEL-TABLE-ENTRIES10256404
102565         WHEN DFHRESP(ITEMERR)                                    10256504
102566             SET PS-PGBK-REQST-QUEUE-EOF      TO TRUE             10256604
102567         WHEN OTHER                                               10256704
102568             MOVE PV-CICS-RESPONSE TO SE-CICS-RESPONSE            10256804
102569             STRING 'READ PGBK QUE'     DELIMITED BY SIZE         10256904
102570                    SE-CICS-RESPONSE    DELIMITED BY SIZE         10257004
102580                                 INTO PC126-CRA-RET-MSG           10258004
102590             MOVE '39'             TO PC126-CRA-RET-CDE           10259004
102600             PERFORM 9000-RETURN-CALL                             10260004
102601     END-EVALUATE.                                                10260104
102602                                                                  10260204
103140 9999-WRITE-TO-CSSL.                                              10314004
103150        MOVE LENGTH OF PV-CICS-MSG-AREA                           10315004
103160            TO PV-COMMAREA-LENGTH                                 10316004
103170        EXEC CICS                                                 10317004
103171            WRITEQ TD                                             10317104
103172                QUEUE   ('CSSL')                                  10317204
103173                FROM    (PV-CICS-MSG-AREA)                        10317304
103174                LENGTH  (PV-COMMAREA-LENGTH)                      10317404
103175                RESP    (PV-CICS-RESPONSE)                        10317504
103176        END-EXEC.                                                 10317604
