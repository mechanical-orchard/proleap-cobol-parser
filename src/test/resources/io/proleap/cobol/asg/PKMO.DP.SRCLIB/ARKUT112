000100 IDENTIFICATION DIVISION.                                         00010000
000200*                                                                 00020000
000300 PROGRAM-ID.    ARKUT112.                                         00030000
000400*                                                                 00040000
000500 AUTHOR.        JOE GARDETTO.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  10/2014.                                          00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*                                                                *00100000
001100*  THIS PROGRAM GETS THE STATE CODE FROM THE TABLE TADZIP FOR    *00110000
001200*  EACH TRANSACTION ON THE POS TRANSACTION FILE.                 *00120000
001300*  AN EXCEPTION REPORT IS WRITTEN OUT FOR ANY INVALID ZIP CODES  *00130000
001400*  OR ANY ZIP CODES WHICH MAY EXIST IN MORE THAN ONE STATE.      *00140000
001500*                                                                *00150000
P10237*----------------------------------------------------------------*00160000
P10237*  HISTORY LOG:                                                  *00170000
P10237*----------------------------------------------------------------*00180000
P10237*                                                                *00190000
P10237*  DATE      : 04/20/2015                                        *00200000
P10237*  WR/IR#    : CHG0104429                                        *00210000
P10237*  PROGRAMMER: COGNIZANT                                         *00220000
P10237*  DESC      : REMOVED THE DISPLAY OF ZIPCODE                    *00230000
P10237*----------------------------------------------------------------*00240000
CFEES *                                                                *00250000
CFEES *  DATE      : 11/09/2016                                        *00260000
CFEES *  WR/IR#    : CHG0160001                                        *00270000
CFEES *  PROGRAMMER: BARB SCHULTZ                                      *00280000
CFEES *  DESC      : INCREASED THE INPUT AND OUTPUT FILE TO 385 FROM   *00290000
CFEES *              311.                                              *00300000
CFEES *----------------------------------------------------------------*00310000
002300******************************************************************00320000
002400 ENVIRONMENT DIVISION.                                            00330000
002500*                                                                 00340000
002700 CONFIGURATION SECTION.                                           00350000
002800 SOURCE-COMPUTER. IBM-3090.                                       00360000
002900 OBJECT-COMPUTER. IBM-3090.                                       00370000
003000*                                                                 00380000
003200 INPUT-OUTPUT SECTION.                                            00390000
003300 FILE-CONTROL.                                                    00400000
003500                                                                  00410000
003100     SELECT AR-TRANSACTION-FILE-IN                                00420000
003200         ASSIGN TO INP01.                                         00430000
003100     SELECT AR-TRANSACTION-FILE-OUT                               00440000
003200         ASSIGN TO OUT01.                                         00450000
AAAAAA     SELECT ORACLE-LOGON-FILE                                     00460000
AAAAAA         ASSIGN TO ORALOGON.                                      00470000
005000***************                                                   00480000
005100 DATA DIVISION.                                                   00490000
005200***************                                                   00500000
005300*                                                                 00510000
005400 FILE SECTION.                                                    00520000
005500*                                                                 00530000
006200 FD  AR-TRANSACTION-FILE-IN                                       00540000
006300     RECORDING MODE IS F                                          00550000
006400     LABEL RECORDS ARE STANDARD                                   00560000
006500     BLOCK CONTAINS 0 RECORDS                                     00570000
CFEES      RECORD CONTAINS 385 CHARACTERS                               00580000
006700     DATA RECORD IS AR-TRANSACTION-RECORD-IN.                     00590000
006800                                                                  00600000
CFEES  01  AR-TRANSACTION-RECORD-IN        PIC X(385).                  00610000
005500*                                                                 00620000
006200 FD  AR-TRANSACTION-FILE-OUT                                      00630000
006300     RECORDING MODE IS F                                          00640000
006400     LABEL RECORDS ARE STANDARD                                   00650000
006500     BLOCK CONTAINS 0 RECORDS                                     00660000
CFEES      RECORD CONTAINS 385 CHARACTERS                               00670000
006700     DATA RECORD IS AR-TRANSACTION-RECORD-OUT.                    00680000
AAAAAA                                                                  00690000
CFEES  01  AR-TRANSACTION-RECORD-OUT       PIC X(385).                  00700000
AAAAAA                                                                  00710000
AAAAAA FD  ORACLE-LOGON-FILE                                            00720000
AAAAAA     RECORDING MODE IS F                                          00730000
AAAAAA     LABEL RECORDS ARE STANDARD                                   00740000
AAAAAA     BLOCK CONTAINS 0 RECORDS                                     00750000
AAAAAA     RECORD CONTAINS 80 CHARACTERS                                00760000
AAAAAA     DATA RECORDS IS OL-ORACLE-LOGON-RECORD.                      00770000
AAAAAA                                                                  00780000
AAAAAA 01  OL-ORACLE-LOGON-RECORD      PIC X(80).                       00790000
005500*                                                                 00800000
009800 WORKING-STORAGE SECTION.                                         00810000
009900*                                                                 00820000
066400***************************************************************** 00830000
066500*  ACCOUNTS RECEIVABLE TRANSACTION FILE RECORD LAYOUT             00840000
066600***************************************************************** 00850000
066700     COPY ARRD001.                                                00860000
066800                                                                  00870000
012000 01  WS-ERROR-FIELDS.                                             00880000
012100     05 WS-MSG-TEXT                  PIC X(512).                  00890000
012200     05 WS-MAX-SIZE                  PIC S9(09) COMP              00900000
012300                                                 VALUE +512.      00910000
012400     05 WS-MSG-LENGTH                PIC S9(09) COMP.             00920000
012500     05 WS-ABEND-CODE                PIC S9(04) COMP SYNC         00930000
012600                                                VALUE ZEROS.      00940000
012700                                                                  00950000
012800 01 PV-PROGRAM-VARIABLES.                                         00960000
AAAAAA    05  PV-ORACLE-USERID-LEN   PIC S9(4)  VALUE ZEROS             00970000
AAAAAA                                          COMP SYNC.              00980000
AAAAAA    05  PV-ORACLE-PASSWORD-LEN PIC S9(4)  VALUE ZEROS             00990000
AAAAAA                                          COMP SYNC.              01000000
013100    05  PVP-ABEND-PARAGRAPH    PIC X(40)  VALUE SPACES.           01010000
013200    05  PVP-ABEND-CODE         PIC S9(04) COMP SYNC VALUE +0000.  01020000
013600    05  PV-READ-CNT            PIC 9(07)  COMP-3 VALUE ZEROES.    01030000
013710    05  PV-OUT-CNT             PIC 9(07)  COMP-3 VALUE ZEROES.    01040000
013712    05  PV-DISPLAY-CNT         PIC Z,ZZZ,ZZ9.                     01050000
013900    05  PV-SAVE-ZIP-CDE        PIC X(05)  VALUE SPACES.           01060000
013500    05  PV-DISPLAY-NBR         PIC 9(04)  VALUE ZEROES.           01070000
013500    05  PV-VALID-STATE-CHECK   PIC X(02)  VALUE SPACES.           01080000
015600         88  PS-VALID-STATE                       VALUE 'AL'      01090000
                                                            , 'AK'      01100000
                                                            , 'AZ'      01110000
                                                            , 'AR'      01120000
                                                            , 'CA'      01130000
                                                            , 'CO'      01140000
                                                            , 'CT'      01150000
                                                            , 'DE'      01160000
                                                            , 'FL'      01170000
                                                            , 'GA'      01180000
                                                            , 'HI'      01190000
                                                            , 'ID'      01200000
                                                            , 'IL'      01210000
                                                            , 'IN'      01220000
                                                            , 'IA'      01230000
                                                            , 'KS'      01240000
                                                            , 'KY'      01250000
                                                            , 'LA'      01260000
                                                            , 'ME'      01270000
                                                            , 'MD'      01280000
                                                            , 'MA'      01290000
                                                            , 'MI'      01300000
                                                            , 'MN'      01310000
                                                            , 'MS'      01320000
                                                            , 'MO'      01330000
                                                            , 'MT'      01340000
                                                            , 'NE'      01350000
                                                            , 'NV'      01360000
                                                            , 'NH'      01370000
                                                            , 'NJ'      01380000
                                                            , 'NM'      01390000
                                                            , 'NY'      01400000
                                                            , 'NC'      01410000
                                                            , 'ND'      01420000
                                                            , 'OH'      01430000
                                                            , 'OK'      01440000
                                                            , 'OR'      01450000
                                                            , 'PA'      01460000
                                                            , 'RI'      01470000
                                                            , 'SC'      01480000
                                                            , 'SD'      01490000
                                                            , 'TN'      01500000
                                                            , 'TX'      01510000
                                                            , 'UT'      01520000
                                                            , 'VT'      01530000
                                                            , 'VA'      01540000
                                                            , 'WA'      01550000
                                                            , 'WV'      01560000
                                                            , 'WI'      01570000
                                                            , 'WY'      01580000
                                                            , 'DC'.     01590000
015400                                                                  01600000
015500 01 PS-PROGRAM-SWITCHES.                                          01610000
015500     05  PS-END-OF-TRANS-FILE-SW       PIC X(01)  VALUE 'N'.      01620000
015600         88  PS-END-OF-TRANS-FILE                 VALUE 'Y'.      01630000
015700         88  PS-NOT-END-OF-TRANS-FILE             VALUE 'N'.      01640000
AAAAAA     05  PS-END-OF-LOGON-FILE-SW       PIC X(01)  VALUE 'N'.      01650000
AAAAAA         88  PS-END-OF-LOGON-FILE                 VALUE 'Y'.      01660000
AAAAAA     05  PS-ORA-SRC-CTL-DONE-SW        PIC  X(01) VALUE 'N'.      01670000
AAAAAA         88  PS-ORA-SRC-EMPTY                     VALUE 'Y'.      01680000
015910     05  PS-ZIP-CODE-ERROR-SW          PIC X(1)   VALUE 'N'.      01690000
015920         88  PS-ZIP-CODE-ERROR                    VALUE 'Y'.      01700000
015930         88  PS-ZIP-CODE-ERROR-NO                 VALUE 'N'.      01710000
016000                                                                  01720000
016100 01  PC-PROGRAM-CONSTANTS.                                        01730000
016200     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)     VALUE         01740000
016300                                                   'ARKUT112'.    01750000
AAAAAA     05  PC-PROGRAM-NAME              PIC X(08)     VALUE         01760000
AAAAAA                                                   'ARKUT112'.    01770000
AAAAAA     05  PC-AUTO-LOGON                PIC X(1)      VALUE '/'.    01780000
                                                                        01790000
AAAAAA 01  CC-ORACLE-CONNECTION.                                        01800000
AAAAAA     05  CC-ORACLE-USERID             PIC X(40).                  01810000
AAAAAA         88 CC-AUTO-LOGON                            VALUE '/'.   01820000
AAAAAA     05  CC-ORACLE-PASSWORD           PIC X(40).                  01830000
021700*---------------------------------------------------------------* 01840000
021800*    ORACLE DECLARE SECTION                                       01850000
021900*---------------------------------------------------------------* 01860000
022000     EXEC SQL BEGIN DECLARE SECTION END-EXEC.                     01870000
022100                                                                  01880000
022200 01  USERNAME                        PIC X(10)      VARYING.      01890000
022300 01  PASSWD                          PIC X(10)      VARYING.      01900000
022400 01  PC-ENT01-TYPE-CDE               PIC X(02)      VALUE '01'.   01910000
022500 01  PV-ORACLE-ID                    PIC X(01)      VALUE '/'.    01920000
022600 01  WS-HOST-VARIABLES.                                           01930000
022700     05  WS-STATE-CODE               PIC   X(02).                 01940000
022800     05  WS-ZIP-CODE                 PIC   X(05).                 01950000
022900                                                                  01960000
023000     EXEC SQL END DECLARE SECTION END-EXEC.                       01970000
023100                                                                  01980000
023200     EXEC SQL INCLUDE SQLCACOB      END-EXEC.                     01990000
023300                                                                  02000000
023400*                                                                 02010000
023800****************************************************************  02020000
023900 PROCEDURE DIVISION.                                              02030000
024000****************************************************************  02040000
024100                                                                  02050000
024200****************************************************************  02060000
024300* 0000-PROGRAM-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE  *  02070000
024400* PROGRAM.                                                     *  02080000
024500****************************************************************  02090000
024600                                                                  02100000
024700 0000-PROGRAM-MAINLINE.                                           02110000
024800                                                                  02120000
024900     PERFORM 1000-INITIALIZATION.                                 02130000
025000                                                                  02140000
025001     PERFORM 2000-PROCESS-TRAN-FILE                               02150000
025010        UNTIL PS-END-OF-TRANS-FILE.                               02160000
025020                                                                  02170000
025030     PERFORM 3000-END-ROUTINE.                                    02180000
025040                                                                  02190000
025100     GOBACK.                                                      02200000
025200                                                                  02210000
025400*                                                                 02220000
025500****************************************************************  02230000
025600* 1000-INITIALIZATION OPENS ALL FILES, CONNECTS TO ORACLE      *  02240000
025700*      FORMATS THE PERIOD BEGIN AND END DATES                  *  02250000
025800*      OPENS THE CURSOR AND PERFORMS FIRST CURSOR FETCH        *  02260000
025900****************************************************************  02270000
026000 1000-INITIALIZATION.                                             02280000
026100                                                                  02290000
026100     DISPLAY 'ORACLE FILE OPEN'.                                  02300000
026100     OPEN INPUT ORACLE-LOGON-FILE.                                02310000
026100                                                                  02320000
026100     DISPLAY 'ORACLE FILE READ'.                                  02330000
026200     PERFORM 8000-READ-ORACLE-LOGON.                              02340000
026300                                                                  02350000
026300     DISPLAY 'ORACLE FILE CLOSE'.                                 02360000
026300     CLOSE ORACLE-LOGON-FILE.                                     02370000
026300                                                                  02380000
AAAAAA     IF ((PS-END-OF-LOGON-FILE)                                   02390000
AAAAAA              OR (CC-ORACLE-CONNECTION = SPACES))                 02400000
AAAAAA           DISPLAY '** ABEND **'                                  02410000
AAAAAA           DISPLAY PC-PROGRAM-NAME ' - ORACLE LOGON CONTROL CARD '02420000
AAAAAA               'NOT PROVIDED'                                     02430000
AAAAAA           SET PS-ORA-SRC-EMPTY TO TRUE                           02440000
AAAAAA           CALL 'ILBOABN0' USING WS-ABEND-CODE                    02450000
AAAAAA     END-IF.                                                      02460000
AAAAAA                                                                  02470000
AAAAAA     IF CC-AUTO-LOGON                                             02480000
AAAAAA            DISPLAY PC-PROGRAM-NAME  ' - AUTO LOGON TO ORACLE'    02490000
AAAAAA            EXEC SQL                                              02500000
AAAAAA                 CONNECT :PC-AUTO-LOGON                           02510000
AAAAAA            END-EXEC                                              02520000
AAAAAA     ELSE                                                         02530000
AAAAAA         INITIALIZE PV-ORACLE-USERID-LEN                          02540000
AAAAAA                    PV-ORACLE-PASSWORD-LEN                        02550000
AAAAAA           INSPECT    CC-ORACLE-USERID                            02560000
AAAAAA             TALLYING   PV-ORACLE-USERID-LEN                      02570000
AAAAAA             FOR CHARACTERS BEFORE INITIAL SPACE                  02580000
AAAAAA           INSPECT    CC-ORACLE-PASSWORD                          02590000
AAAAAA             TALLYING   PV-ORACLE-PASSWORD-LEN                    02600000
AAAAAA             FOR CHARACTERS BEFORE INITIAL SPACE                  02610000
AAAAAA         MOVE CC-ORACLE-USERID (1:PV-ORACLE-USERID-LEN) TO        02620000
AAAAAA                    USERNAME-ARR                                  02630000
AAAAAA         MOVE PV-ORACLE-USERID-LEN TO USERNAME-LEN                02640000
AAAAAA         MOVE CC-ORACLE-PASSWORD (1:PV-ORACLE-PASSWORD-LEN) TO    02650000
AAAAAA                      PASSWD-ARR                                  02660000
AAAAAA         MOVE PV-ORACLE-PASSWORD-LEN TO PASSWD-LEN                02670000
AAAAAA           DISPLAY PC-PROGRAM-NAME  ' - LOGON TO ORACLE AS USER ' 02680000
AAAAAA                      USERNAME-ARR                                02690000
AAAAAA            EXEC SQL                                              02700000
AAAAAA                 CONNECT :USERNAME IDENTIFIED BY :PASSWD          02710000
AAAAAA            END-EXEC                                              02720000
AAAAAA         INITIALIZE CC-ORACLE-PASSWORD                            02730000
AAAAAA                    PASSWD                                        02740000
AAAAAA     END-IF.                                                      02750000
041400                                                                  02760000
041500     IF (SQLCODE NOT = 0)                                         02770000
041700        PERFORM Z999-SQL-ERROR                                    02780000
041800     END-IF.                                                      02790000
041800                                                                  02800000
026400     OPEN   INPUT  AR-TRANSACTION-FILE-IN.                        02810000
026500     OPEN   OUTPUT AR-TRANSACTION-FILE-OUT.                       02820000
027100                                                                  02830000
027200     PERFORM 2200-READ-TRAN-FILE.                                 02840000
027400                                                                  02850000
027500****************************************************************  02860000
027600* 2000-PROCESS-TRAN-FILE                                       *  02870000
027700****************************************************************  02880000
027800 2000-PROCESS-TRAN-FILE.                                          02890000
028000                                                                  02900000
           IF AR001-SHIP-ADDR-ZIP > SPACES                              02910000
               IF AR001-SHIP-ADDR-ZIP = PV-SAVE-ZIP-CDE                 02920000
                   MOVE WS-STATE-CODE TO AR001-SHIP-ADDR-ST             02930000
               ELSE                                                     02940000
                   SET PS-ZIP-CODE-ERROR-NO TO TRUE                     02950000
                   PERFORM 2100-READ-TADZIP-CURSOR                      02960000
                   IF PS-ZIP-CODE-ERROR                                 02970000
                       MOVE SPACES        TO AR001-SHIP-ADDR-ST         02980000
                                             WS-STATE-CODE              02990000
                       MOVE AR001-PARTITION-NUMBER TO PV-DISPLAY-NBR    03000000
                       DISPLAY 'AR001-PARTITION-NUMBER   '              03010000
                       DISPLAY  PV-DISPLAY-NBR                          03020000
                       DISPLAY 'AR001-STORE-NUMBER       '              03030000
                                AR001-STORE-NUMBER                      03040000
                       DISPLAY 'AR001-TERMINAL-NUMBER    '              03050000
                                AR001-TERMINAL-NUMBER                   03060000
                       DISPLAY 'AR001-TRANSACTION-NUMBER '              03070000
                                AR001-TRANSACTION-NUMBER                03080000
                       DISPLAY '                         '              03090000
                   ELSE                                                 03100000
                       MOVE WS-STATE-CODE TO AR001-SHIP-ADDR-ST         03110000
                   END-IF                                               03120000
                   MOVE AR001-SHIP-ADDR-ZIP TO PV-SAVE-ZIP-CDE          03130000
               END-IF                                                   03140000
           ELSE                                                         03150000
               MOVE SPACES TO AR001-SHIP-ADDR-ST                        03160000
           END-IF.                                                      03170000
           IF AR001-SHIP-ADDR-ST > SPACES                               03180000
               MOVE AR001-SHIP-ADDR-ST TO PV-VALID-STATE-CHECK          03190000
               IF PS-VALID-STATE                                        03200000
                   CONTINUE                                             03210000
               ELSE                                                     03220000
                   MOVE SPACES         TO AR001-SHIP-ADDR-ST            03230000
               END-IF                                                   03240000
           END-IF.                                                      03250000
029207     PERFORM 5000-WRITE-RECORD.                                   03260000
029230                                                                  03270000
029700     PERFORM 2200-READ-TRAN-FILE.                                 03280000
029800                                                                  03290000
029900******************************************************************03300000
030000* 2100-READ THE TADZIP CURSOR...                                  03310000
030100******************************************************************03320000
030200 2100-READ-TADZIP-CURSOR.                                         03330000
031800                                                                  03340000
031900     MOVE '2100-READ-TADZIP-CURSOR' TO PVP-ABEND-PARAGRAPH.       03350000
032000     MOVE AR001-SHIP-ADDR-ZIP TO WS-ZIP-CODE.                     03360000
032100                                                                  03370000
032200     EXEC SQL                                                     03380000
032300       SELECT                                                     03390000
032400         TADZIP.ST_CDE                                            03400000
032500       INTO                                                       03410000
032600         :WS-STATE-CODE                                           03420000
032700       FROM                                                       03430000
032800        TADZIP                                                    03440000
032900       WHERE                                                      03450000
033000         TADZIP.ZIP_CDE = :WS-ZIP-CODE                            03460000
033100     END-EXEC.                                                    03470000
033200                                                                  03480000
033300     EVALUATE TRUE                                                03490000
033400         WHEN SQLCODE = ZERO                                      03500000
033600             CONTINUE                                             03510000
033800         WHEN SQLCODE = -1405                                     03520000
033900         WHEN SQLCODE = +1403                                     03530000
034000         WHEN SQLCODE = -1403                                     03540000
034110             SET PS-ZIP-CODE-ERROR TO TRUE                        03550000
034300         WHEN OTHER                                               03560000
ZX    * THE LINE BELOW WAS USED FOR TESTING PURPOSES DONE BY DAN PAYNTER03561001
ZX    *            SET PS-ZIP-CODE-ERROR TO TRUE                        03561101
034500             PERFORM Z999-SQL-ERROR                               03562001
034500     END-EVALUATE.                                                03563000
034501                                                                  03564000
034502******************************************************************03565000
034503* 2200-READ-TRAN-FILE                                             03566000
034504******************************************************************03567000
034510 2200-READ-TRAN-FILE.                                             03568000
034511                                                                  03569000
034520     MOVE SPACES TO AR001-AR-TRANSACTION-RECORD.                  03570000
034530                                                                  03580000
034540     READ AR-TRANSACTION-FILE-IN                                  03590000
034550         INTO AR001-AR-TRANSACTION-RECORD                         03600000
034560         AT END                                                   03610000
034570             SET PS-END-OF-TRANS-FILE TO TRUE                     03620000
034580     END-READ.                                                    03630000
034590                                                                  03640000
034591     IF NOT PS-END-OF-TRANS-FILE                                  03650000
034592         ADD  1    TO  PV-READ-CNT                                03660000
           END-IF.                                                      03670000
                                                                        03680000
034600***************************************************************** 03690000
034700* 3000-END-ROUTINE                                              * 03700000
034800* CLOSE FILES                                                   * 03710000
034900***************************************************************** 03720000
035000                                                                  03730000
035100 3000-END-ROUTINE.                                                03740000
035200                                                                  03750000
035300     CLOSE AR-TRANSACTION-FILE-IN.                                03760000
035400     CLOSE AR-TRANSACTION-FILE-OUT.                               03770000
035700                                                                  03780000
035710     MOVE PV-READ-CNT TO PV-DISPLAY-CNT.                          03790000
035800     DISPLAY 'RECORDS READ:          ' PV-DISPLAY-CNT.            03800000
035810     MOVE PV-OUT-CNT TO PV-DISPLAY-CNT.                           03810000
035900     DISPLAY 'RECORDS WRITTEN:       ' PV-DISPLAY-CNT.            03820000
036000                                                                  03830000
036200****************************************************************  03840000
036300* 5000-WRITE-RECORD                                               03850000
036400****************************************************************  03860000
036500 5000-WRITE-RECORD.                                               03870000
036600                                                                  03880000
036700     WRITE AR-TRANSACTION-RECORD-OUT                              03890000
036700           FROM AR001-AR-TRANSACTION-RECORD.                      03900000
036800     ADD  1    TO  PV-OUT-CNT.                                    03910000
036900                                                                  03920000
037800                                                                  03930000
040000                                                                  03940000
040100****************************************************************  03950000
040200* LOGON TO ORACLE                                                 03960000
040300****************************************************************  03970000
040400 8000-READ-ORACLE-LOGON.                                          03980000
040500                                                                  03990000
041000     READ ORACLE-LOGON-FILE                                       04000000
041000         INTO CC-ORACLE-CONNECTION                                04010000
041000         AT END                                                   04020000
041000             SET PS-END-OF-LOGON-FILE TO TRUE                     04030000
041000     END-READ.                                                    04040000
041900                                                                  04050000
042000****************************************************************  04060000
042100*Z999-SQL-ERROR.                                                 *04070000
042200******************************************************************04080000
042300 Z999-SQL-ERROR.                                                  04090000
042400                                                                  04100000
042500     DISPLAY '** ABEND **       ** = SQLERROR'.                   04110000
042600     DISPLAY '** PROGRAM        ** = ARKUT112'.                   04120000
042700     DISPLAY '** SQLERRM        ** = ' SQLERRM.                   04130000
042800     DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  04140000
042900     DISPLAY '** SQLERRD(5)     ** = ' SQLERRD(5).                04150000
043000                                                                  04160000
043100                                                                  04170000
043200     MOVE SPACES TO WS-MSG-TEXT.                                  04180000
043300                                                                  04190000
043400     CALL 'SQLGLM' USING WS-MSG-TEXT,                             04200000
043500                         WS-MAX-SIZE,                             04210000
043600                         WS-MSG-LENGTH.                           04220000
043700     DISPLAY 'MESSAGE TEXT      ** = ' WS-MSG-TEXT.               04230000
043800                                                                  04240000
043900     MOVE +4013 TO WS-ABEND-CODE.                                 04250000
044000     CALL 'ILBOABN0' USING WS-ABEND-CODE.                         04260000
046000                                                                  04270000
049800******************************************************************04280000
049900***                    END  OF  PROGRAM                        ***04290000
050000******************************************************************04300000
