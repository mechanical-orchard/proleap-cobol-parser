000100 IDENTIFICATION DIVISION.                                         00010000
000200 TITLE 'MANIFESTING - TRAILER STATUS CRITERIA SCREEN'.            00020000
000300                                                                  00030000
000400 PROGRAM-ID.             PCKRF898.                                00040000
000500 AUTHOR.                 DENNIS STEFFEN.                          00050000
000600 INSTALLATION.           KOHLS.                                   00060000
000700 DATE-WRITTEN.           MAY, 2001.                               00070000
000800 DATE-COMPILED.                                                   00080000
000900 ENVIRONMENT DIVISION.                                            00090000
001000 DATA DIVISION.                                                   00100000
001100                                                                  00110000
001200 WORKING-STORAGE SECTION.                                         00120000
001300                                                                  00130000
001400 01  PC-PROGRAM-CONSTANTS.                                        00140000
001500     05  PC-TRANID                    PIC X(04) VALUE 'E898'.     00150000
001600     05  PC-CURRENT-PROGRAM-NAME      PIC X(08) VALUE 'PCKRF898'. 00160000
001700     05  PC-DUMMY-TIMESTAMP           PIC X(26) VALUE             00170000
001800            '9999-09-09-09.09.09.999999'.                         00180000
001900     05  PC-LOW-TIMESTAMP             PIC X(26) VALUE             00190000
002000            '0001-01-01-00.00.00.000000'.                         00200000
002100                                                                  00210000
002200                                                                  00220000
002300* ERROR MESSAGES                                                 *00230000
002400     05  PC-UNRECOGNIZED-PF-KEY-MSG   PIC X(19) VALUE             00240000
002500                                           'UNRECOGNIZED PF KEY'. 00250000
002600     05  PC-ENTER-THROUGH-MENU-MSG    PIC X(19) VALUE             00260000
002700                                           'ENTER THROUGH MENU '. 00270000
002800     05  PC-TRANS-UNAVAILABLE-MSG     PIC X(19) VALUE             00280000
002900                                           'TRANS NOT AVAILABLE'. 00290000
003000     05  PC-WRONG-FACILITY            PIC X(19) VALUE             00300000
003100                                           'WRG FCLTY - F2 CONF'. 00310000
003200                                                                  00320000
003300 01  PS-PROGRAM-SWITCHES.                                         00330000
003400     05  PS-ERROR-SW                  PIC X(01)  VALUE 'N'.       00340000
003500         88  PS-ERRORS-YES                        VALUE 'Y'.      00350000
003600         88  PS-ERRORS-NO                         VALUE 'N'.      00360000
003700     05  PS-XCTL-SW                   PIC X(04)   VALUE SPACES.   00370000
003800         88  PS-XCTL-E871                       VALUE 'E871'.     00380000
003900         88  PS-XCTL-E873                       VALUE 'E873'.     00390000
004000         88  PS-XCTL-E877                       VALUE 'E877'.     00400000
004100     05  PS-VALID-INPUT-SW            PIC X(01) VALUE 'N'.        00410000
004200         88  PS-VALID-INPUT                       VALUE 'Y'.      00420000
004300         88  PS-INVALID-INPUT                     VALUE 'N'.      00430000
004400     05  PS-TRLR-OPEN-SW              PIC X(04) VALUE SPACES.     00440000
004500         88  PS-TRLR-OPEN-THIS-DOOR             VALUE 'THIS'.     00450000
004600         88  PS-TRLR-OPEN-DIFF-DOOR             VALUE 'DIFF'.     00460000
004700     05  PC-STORE-DOOR-CSR-SW         PIC X(01) VALUE 'N'.        00470000
004800         88  PS-END-STORE-DOOR-CSR              VALUE 'Y'.        00480000
004900         88  PS-NOT-END-STORE-DOOR-CSR          VALUE 'N'.        00490000
005000     05  PS-DOOR-DEST-EDIT-SW         PIC X(01) VALUE 'Y'.        00500000
005100         88  PS-SKIP-DOOR-DEST-EDITS            VALUE 'N'.        00510000
005200         88  PS-DO-DOOR-DEST-EDITS              VALUE 'Y'.        00520000
005300     05  PS-DIVERT-DOOR-SW            PIC X(01) VALUE 'Y'.        00530000
005400         88  PS-DIVERT-DOOR-YES                 VALUE 'Y'.        00540000
005500         88  PS-DIVERT-DOOR-NO                  VALUE 'N'.        00550000
005600     05  PS-SERIAL-SW                 PIC X(01) VALUE 'N'.        00560000
005700         88  PS-SERIAL-NO                       VALUE 'N'.        00570000
005800         88  PS-SERIAL-YES                      VALUE 'Y'.        00580000
005900     05  PS-ACTIVE-TRIP-SW            PIC X(01) VALUE 'N'.        00590000
006000         88  PS-ACTIVE-TRIP-EXISTS              VALUE 'Y'.        00600000
006100         88  PS-NO-ACTIVE-TRIP-EXISTS           VALUE 'N'.        00610000
006101                                                                  00610114
006110 01  DN-DB2-NULL-INDICATORS.                                      00611014
006120     05  DN-TIMESTAMP               PIC S9(04) COMP VALUE ZEROES. 00612014
006200                                                                  00620000
006300 01  PV-PROGRAM-VARIABLES.                                        00630000
006400     05  PV-MAX-TIMESTAMP             PIC X(26).                  00640010
006500     05  PV-CURRENT-TRIP-ID           PIC S9(09) COMP.            00650009
006600     05  PV-DOOR-COUNT                PIC S9(03) COMP-3.          00660009
006700     05  PV-DB2-COUNT                 PIC S9(03) COMP-3.          00670000
006800     05  PV-TRIP-STAT-DESC            PIC X(10)  VALUE SPACES.    00680000
006900     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        00690000
007000                                                     COMP SYNC.   00700000
007100     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    00710000
007200     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     00720000
007300                                                     COMP SYNC.   00730000
007400     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    00740000
007500                                                                  00750000
007600     05  PV-DISPLAY-DOOR-ID           PIC  X(04)  VALUE SPACE.    00760000
007700     05  PV-DISPLAY-OPER              PIC  9(04)  VALUE ZEROES.   00770000
007800     05  PV-DISPLAY-DEST              PIC  9(04)  VALUE ZEROES.   00780000
007900     05  PV-DISPLAY-SRL-NBR           PIC  9(09)  VALUE ZEROES.   00790000
008000     05  PV-DISPLAY-SCAC              PIC  X(04)  VALUE SPACES.   00800000
008100     05  PV-DISPLAY-TRLR-ID           PIC  X(12)  VALUE ZEROES.   00810000
008200     05  PV-DISPLAY-TRIP              PIC  9(09)  VALUE ZEROES.   00820000
008300                                                                  00830000
008400 01  PV-LOG-MSG.                                                  00840000
008500     05  FILLER                       PIC X(12) VALUE             00850000
008600         ' E898 ERROR '.                                          00860000
008700     05  FILLER                       PIC X(06) VALUE             00870000
008800         'USER= '.                                                00880000
008900     05  PV-USER-ID                   PIC X(08) VALUE SPACES.     00890000
009000     05  FILLER                       PIC X(10) VALUE             00900000
009100         ' SQLCODE= '.                                            00910000
009200     05  PV-SQLCODE                   PIC -9(03).                 00920000
009300     05  FILLER                       PIC X(06) VALUE             00930000
009400         ' ERR= '.                                                00940000
009500     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       00950000
009600     05  FILLER                       PIC X(07) VALUE             00960000
009700         ' DOOR= '.                                               00970000
009800     05  PV-DISPLAY-DOOR              PIC X(04) VALUE ZEROES.     00980000
009900/                                                                 00990000
010000 01  PV-EDITING-FIELDS.                                           01000000
010100     05  PV-SCREEN-SERIAL-NBR         PIC X(09).                  01010000
010200                                                                  01020000
010300/                                                                 01030000
010400 01  CA-COMMAREA.                                                 01040000
010500     COPY PCWS233.                                                01050000
010600     05  CA-PRIVATE-COMMAREA          PIC X(100).                 01060000
010700     05  CA-REDEFINED-COMMAREA REDEFINES CA-PRIVATE-COMMAREA.     01070000
010800         10  CA-CURR-DOOR             PIC X(04).                  01080000
010900         10  CA-CURR-DEST             PIC 9(04).                  01090000
011000         10  CA-CURR-SERIAL-NBR       PIC 9(09).                  01100000
011100/                                                                 01110000
011200*  MAP LAYOUT                                                     01120000
011300     COPY PCKM898.                                                01130000
011400                                                                  01140000
011500* HELP SCREEN COMMAREA                                            01150000
011600     COPY PCWS192.                                                01160000
011700* HELP SCREEN WORK AREA                                           01170000
011800     COPY PCWS188.                                                01180000
011900/                                                                 01190000
012000     COPY DPWS010I.                                               01200000
012100*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01210000
012200     COPY DPWS015.                                                01220000
012300                                                                  01230000
012400*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      01240000
012500     COPY DFHAID.                                                 01250000
012600                                                                  01260000
012700*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               01270000
012800     COPY DPWS013.                                                01280000
012900/                                                                 01290000
013000*    DC DOOR MASTER                                               01300000
013100                                                                  01310000
013200*    TRAILER ID MASTER                                            01320000
013300     EXEC SQL                                                     01330000
013400         INCLUDE TCNTRID                                          01340000
013500     END-EXEC.                                                    01350000
013600                                                                  01360000
013700*    OUTBOUND TRAILER TRIP                                        01370000
013800     EXEC SQL                                                     01380000
013900         INCLUDE TSUOBTR                                          01390000
014000     END-EXEC.                                                    01400000
014100                                                                  01410000
014200*    OUTBOUND TRAILER TRIP STATUS                                 01420000
014300     EXEC SQL                                                     01430000
014400         INCLUDE TSUOBTS                                          01440000
014500     END-EXEC.                                                    01450000
014600                                                                  01460000
014700*    OUTBOUND TRAILER TRIP STATUS CODES                           01470000
014800     EXEC SQL                                                     01480000
014900         INCLUDE TSUOBSC                                          01490000
015000     END-EXEC.                                                    01500000
015100                                                                  01510000
015200/                                                                 01520000
015300     EXEC SQL                                                     01530000
015400         INCLUDE SQLCA                                            01540000
015500     END-EXEC.                                                    01550000
015600                                                                  01560000
015700 LINKAGE SECTION.                                                 01570000
015800 01  DFHCOMMAREA.                                                 01580000
015900     05  FILLER                         OCCURS  1 TO 4072 TIMES   01590000
016000                                      DEPENDING ON EIBCALEN.      01600000
016100         10  FILLER                   PIC X.                      01610000
016200/                                                                 01620000
016300 PROCEDURE DIVISION.                                              01630000
016400 0000-PROGRAM-MAINLINE.                                           01640000
016500                                                                  01650000
016600     INITIALIZE CA-COMMAREA                                       01660000
016700     MOVE DFHCOMMAREA                 TO CA-COMMAREA              01670000
016800                                                                  01680000
016900     EVALUATE TRUE                                                01690000
017000         WHEN EIBCALEN = ZERO                                     01700000
017100             MOVE PC-ENTER-THROUGH-MENU-MSG                       01710000
017200                                      TO PV-MESSAGE-AREA          01720000
017300             PERFORM 8110-RETURN                                  01730000
017400                                                                  01740000
017500         WHEN EIBTRNID = 'E899' OR 'E743'                         01750000
017600             MOVE PC233-RETURN-MSG      TO AMSGLNO                01760016
017700             MOVE PC233-SERIAL-NBR      TO ASERIALO               01770016
017800             MOVE PC233-TRIP-ID         TO ATRIPO                 01780016
017900             MOVE PC233-OWNER-SCAC-ID   TO ASCACO                 01790016
018000             MOVE PC233-TRAILER         TO ATRLRO                 01800016
018100             MOVE PC233-STR-NBR         TO ADESTO                 01810016
018200             MOVE PC233-TRAILER-STATUS  TO ASTATUSO               01820016
018300             IF  PC233-TRLR-PRKG-SLOT-NBR  >  SPACES              01830019
018400                 STRING 'PARK SLOT: ' DELIMITED BY SIZE           01840020
018500                     PC233-TRLR-PRKG-SLOT-NBR                     01850020
018510                     DELIMITED BY SIZE    INTO ALOCO              01851020
018600             ELSE                                                 01860016
018610                 IF  PC233-DOOR-ID    >  SPACES                   01861020
018700                     STRING 'DOOR ID: ' DELIMITED BY SIZE         01870016
018800                         PC233-DOOR-ID                            01880016
018900                         DELIMITED BY SIZE    INTO ALOCO          01890000
018901                 ELSE                                             01890120
018910                     IF  PC233-TRLR-PRKG-LOC-DESC  >  SPACES      01891016
018920                        MOVE PC233-TRLR-PRKG-LOC-DESC TO ALOCO    01892016
019000                     END-IF                                       01900018
019001                 END-IF                                           01900118
019010             END-IF                                               01901016
019100             PERFORM 8000-SEND-MAP                                01910000
019200             PERFORM 8100-RETURN-TRANID                           01920000
019300                                                                  01930000
019400         WHEN EIBTRNID = 'Z278'                                   01940000
019500*            RETURNING FROM F1 HELP INFO SCREEN                   01950000
019600             MOVE DFHCOMMAREA         TO PC192-COMMAREA           01960000
019700             MOVE PC192-HOST-SAVE-AREA                            01970000
019800                                      TO CA-COMMAREA              01980000
019900             SET PC233-PROCESS-SCREEN TO TRUE                     01990000
020000             MOVE PC192-HOST-SAVE-MAP TO PC898AO                  02000000
020100             PERFORM 8000-SEND-MAP                                02010000
020200             PERFORM 8100-RETURN-TRANID                           02020000
020300                                                                  02030000
020400         WHEN PC233-INITIALIZE-SCREEN                             02040000
020500         WHEN EIBAID = DFHCLEAR                                   02050000
020600             SET PC233-PROCESS-SCREEN TO TRUE                     02060000
020700             PERFORM 1000-INITIALIZE                              02070000
020800             PERFORM 8000-SEND-MAP                                02080000
020900             PERFORM 8100-RETURN-TRANID                           02090000
021000                                                                  02100000
021100         WHEN EIBAID = DFHPF3                                     02110000
021200             MOVE PC233-MENU-PROGRAM  TO PV-TRANSFER-PROGRAM      02120000
021300             PERFORM 8200-XCTL                                    02130000
021400                                                                  02140000
021500         WHEN EIBAID = DFHPF4                                     02150000
021600*            EDIT AND PROCEED TO PCKRF899                         02160000
021700             PERFORM 8020-RECEIVE-MAP                             02170000
021800             PERFORM 2100-EDIT-INPUT                              02180000
021900             IF PS-ERRORS-NO                                      02190000
022000                 PERFORM 2205-GET-TRAILER-INFO                    02200008
022100                 PERFORM 7100-SELECT-TRAILER-STATUS               02210001
022200                 IF PS-ERRORS-NO                                  02220000
022300                     MOVE 'PCKRF899'  TO PV-TRANSFER-PROGRAM      02230000
022400                     PERFORM 8200-XCTL                            02240000
022500                 ELSE                                             02250000
022600                     PERFORM 8010-SEND-DATA-ONLY                  02260000
022700                     PERFORM 8100-RETURN-TRANID                   02270000
022800                 END-IF                                           02280000
022900             ELSE                                                 02290000
023000                 IF PS-XCTL-E871                                  02300000
023100                     PERFORM 8210-XCTL-ERROR-SCREEN               02310000
023200                 ELSE                                             02320000
023300                     PERFORM 8010-SEND-DATA-ONLY                  02330000
023400                     PERFORM 8100-RETURN-TRANID                   02340000
023500                 END-IF                                           02350000
023600             END-IF                                               02360000
023700                                                                  02370000
023800         WHEN EIBAID = DFHPF6                                     02380000
023900             PERFORM 8020-RECEIVE-MAP                             02390000
024000             PERFORM 2100-EDIT-INPUT                              02400000
024100                                                                  02410000
024200             IF PS-ERRORS-NO                                      02420000
024300                 PERFORM 2205-GET-TRAILER-INFO                    02430000
024400             END-IF                                               02440000
024500                                                                  02450000
024600             IF  PS-ERRORS-NO                                     02460000
024700                 MOVE 'PCKRF744'          TO PV-TRANSFER-PROGRAM  02470000
024800                 SET PC233-PROCESS-SCREEN TO TRUE                 02480000
024900                 PERFORM 8200-XCTL                                02490000
025000             ELSE                                                 02500000
025100                 PERFORM 8010-SEND-DATA-ONLY                      02510000
025200                 PERFORM 8100-RETURN-TRANID                       02520000
025300             END-IF                                               02530000
025400                                                                  02540000
025410         WHEN EIBAID = DFHPF9                                     02541015
025420             MOVE 'PCKRF743'          TO PV-TRANSFER-PROGRAM      02542015
025430             PERFORM 8200-XCTL                                    02543015
025440                                                                  02544015
025500         WHEN EIBAID = DFHENTER                                   02550000
025600*            EDIT ONLY                                            02560000
025700             PERFORM 8020-RECEIVE-MAP                             02570000
025800             PERFORM 2100-EDIT-INPUT                              02580000
025900             IF PS-ERRORS-NO                                      02590000
026000                 PERFORM 2205-GET-TRAILER-INFO                    02600000
026100             END-IF                                               02610000
026200                                                                  02620000
026300             IF PS-ERRORS-YES                                     02630000
026400                 IF PS-XCTL-E871                                  02640000
026500                     PERFORM 8210-XCTL-ERROR-SCREEN               02650000
026600                 ELSE                                             02660000
026700                     PERFORM 8010-SEND-DATA-ONLY                  02670000
026800                     PERFORM 8100-RETURN-TRANID                   02680000
026900                 END-IF                                           02690000
027000             ELSE                                                 02700000
027100                 PERFORM 8010-SEND-DATA-ONLY                      02710000
027200                 PERFORM 8100-RETURN-TRANID                       02720000
027300             END-IF                                               02730000
027400                                                                  02740000
027500         WHEN EIBAID = DFHPF1                                     02750000
027600             PERFORM 8020-RECEIVE-MAP                             02760000
027700             MOVE PC898AO             TO PC192-HOST-SAVE-MAP      02770000
027800             PERFORM 1200-HELP-SCREEN                             02780000
027900                                                                  02790000
028000         WHEN OTHER                                               02800000
028100             PERFORM 8020-RECEIVE-MAP                             02810000
028200             MOVE PC-UNRECOGNIZED-PF-KEY-MSG                      02820000
028300                                      TO AMSGLNO                  02830000
028400             PERFORM 8000-SEND-MAP                                02840000
028500             PERFORM 8100-RETURN-TRANID                           02850000
028600     END-EVALUATE.                                                02860000
028700                                                                  02870000
028800     GOBACK.                                                      02880000
028900                                                                  02890000
029000 1000-INITIALIZE.                                                 02900000
029100                                                                  02910000
029200     INITIALIZE CA-REDEFINED-COMMAREA                             02920000
029300                PC233-TRIP-ID                                     02930000
029400                PC233-SERIAL-NBR                                  02940000
029500                PC233-STR-NBR                                     02950000
029600                PC233-OWNER-SCAC-ID                               02960000
029700                PC233-CARTON                                      02970000
029800                PC233-TRAILER                                     02980000
029900                PC233-ERROR-FIELDS                                02990000
030000     MOVE PC233-MENU-PROGRAM          TO PV-TRANSFER-PROGRAM      03000000
030100                                                                  03010000
030200     MOVE PC-TRANID                   TO PC233-TRAN-ID            03020000
030300                                                                  03030000
030400     MOVE PC233-USER-ID               TO PV-USER-ID.              03040000
030500                                                                  03050000
030600                                                                  03060000
030700 1200-HELP-SCREEN.                                                03070000
030800     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      03080000
030900     MOVE PC-CURRENT-PROGRAM-NAME     TO PC192-PROGRAM-NAME       03090000
031000     COPY PCPD188.                                                03100000
031100     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      03110000
031200     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     03120000
031300     PERFORM 8220-XCTL-TO-HELP.                                   03130000
031400                                                                  03140000
031500/                                                                 03150000
031600 2100-EDIT-INPUT.                                                 03160000
031700                                                                  03170000
031800     SET PS-ERRORS-NO                 TO TRUE                     03180000
031900                                                                  03190000
032000     IF ASERIALA = DP015-ERASE-EOF                                03200000
032100         MOVE ZEROES                  TO PV-SCREEN-SERIAL-NBR     03210000
032200     ELSE                                                         03220000
032300         MOVE ASERIALI                TO PV-SCREEN-SERIAL-NBR     03230000
032400     END-IF                                                       03240000
032500                                                                  03250000
032600     PERFORM 2110-PRE-EDITS                                       03260000
032700*    (VALIDATE NUMERIC FIELDS AND LOAD CA-CURR FIELDS)            03270000
032800                                                                  03280000
032900                                                                  03290000
033000     IF PS-ERRORS-NO                                              03300000
033100         IF PC233-SERIAL-NBR = ZERO                               03310000
033200             SET PS-ERRORS-YES        TO TRUE                     03320000
033300             MOVE '  SER NBR REQUIRED '                           03330000
033400                                      TO AMSGLNO                  03340000
033500         END-IF                                                   03350000
033600     END-IF.                                                      03360000
033700                                                                  03370000
033800                                                                  03380000
033900 2110-PRE-EDITS.                                                  03390000
034000     MOVE PV-SCREEN-SERIAL-NBR        TO DP010I-UNEDITED-FIELD    03400000
034100     MOVE LENGTH OF PV-SCREEN-SERIAL-NBR                          03410000
034200                                      TO DP010I-MAXIMUM-DIGITS    03420000
034300     MOVE ZERO                        TO DP010I-MAXIMUM-DECIMALS  03430000
034400     SET DP010I-NEGATIVE-NOT-ALLOWED  TO TRUE                     03440000
034510     CALL DP010I-NUMERIC-EDIT-ROUTINE                             03451020
034520                         USING DP010I-NUMERIC-EDIT-AREA           03452020
034600     IF DP010I-ERROR-DETECTED                                     03460000
034700         SET PS-ERRORS-YES            TO TRUE                     03470000
034800                                                                  03480000
034900         MOVE 'SER NBR NOT NUMERIC '                              03490000
035000                                      TO AMSGLNO                  03500000
035100     ELSE                                                         03510000
035200         MOVE DP010I-NUMERIC-FIELD    TO CA-CURR-SERIAL-NBR       03520000
035300                                         PC233-SERIAL-NBR         03530000
035400     END-IF.                                                      03540000
035500/                                                                 03550000
035600 2205-GET-TRAILER-INFO.                                           03560000
035700     PERFORM 6400-GET-MOST-RECENT-TMST.                           03570010
035800                                                                  03580010
035900     IF  PS-ERRORS-YES                                            03590010
036000         INITIALIZE PV-CURRENT-TRIP-ID                            03600010
036100     ELSE                                                         03610010
036200         PERFORM 6800-GET-MOST-RECENT-TRIP                        03620010
036300     END-IF.                                                      03630010
036400                                                                  03640010
036500     PERFORM 7000-SELECT-TRAILER-INFO.                            03650009
036600                                                                  03660010
036700     IF PS-ACTIVE-TRIP-EXISTS                                     03670000
036800         MOVE SUOBTS-OTBND-TRIP-ID    TO ATRIPO                   03680000
036900                                         PC233-TRIP-ID            03690000
037000                                         PC233-ERROR-TRIP-ID      03700000
037100         MOVE CNTRID-SCAC-CDE         TO ASCACO                   03710000
037200                                         PC233-OWNER-SCAC-ID      03720000
037300                                         PC233-ERROR-SCAC-ID      03730000
037400         MOVE CNTRID-TRLR-ID          TO PC233-TRAILER            03740000
037500                                         PC233-ERROR-TRLR-ID      03750000
037600                                         ATRLRO                   03760000
037700         MOVE SUOBTR-DEST-OPER-UNT-ID TO ADESTO                   03770000
037800                                         PC233-STR-NBR            03780000
037900         MOVE SUOBTR-DOOR-TYP-CDE     TO PC233-DOOR-TYPE-CDE      03790000
038000         MOVE SUOBSC-STAT-SHRT-DESC   TO ASTATUSO                 03800000
038100                                         PC233-TRAILER-STATUS     03810000
038200                                         PC233-ERROR-TRLR-STATUS  03820000
038300         MOVE SUOBTS-TRLR-PRKG-LOC-DESC                           03830000
038400                                      TO ALOCO                    03840000
038500                                         PC233-TRLR-PRKG-LOC-DESC 03850000
038600         MOVE SUOBTS-TRLR-PRKG-SLOT-NBR                           03860000
038700                                      TO PC233-TRLR-PRKG-SLOT-NBR 03870000
038710         MOVE SUOBTS-DOOR-ID          TO PC233-DOOR-ID            03871016
039010         IF  SUOBTS-TRLR-PRKG-SLOT-NBR  >  SPACES                 03901016
039100                 STRING 'PARK SLOT: ' DELIMITED BY SIZE           03910016
039200                     PC233-TRLR-PRKG-SLOT-NBR                     03920000
039300                     DELIMITED BY SIZE    INTO ALOCO              03930000
039310         ELSE                                                     03931016
039311             IF  SUOBTS-DOOR-ID    >  SPACES                      03931116
039320                 STRING 'DOOR ID: ' DELIMITED BY SIZE             03932016
039330                     PC233-DOOR-ID                                03933016
039340                     DELIMITED BY SIZE    INTO ALOCO              03934016
039341             ELSE                                                 03934116
039350                 IF  SUOBTS-TRLR-PRKG-LOC-DESC  >  SPACES         03935016
039360                     MOVE SUOBTS-TRLR-PRKG-LOC-DESC   TO ALOCO    03936016
039400                 END-IF                                           03940018
039401             END-IF                                               03940118
039410         END-IF                                                   03941016
039500         MOVE ' F4=MOVE  F6=INFO  '   TO AMSGLNO                  03950000
039600     ELSE                                                         03960000
039700         MOVE 'TRLR READY TO OPEN '   TO AMSGLNO                  03970019
039800         MOVE ZERO                    TO ATRIPO                   03980000
039900                                         PC233-TRIP-ID            03990000
040000                                         PC233-ERROR-TRIP-ID      04000000
040100                                         ADESTO                   04010000
040200                                         PC233-STR-NBR            04020000
040300         MOVE SPACES                  TO ASCACO                   04030000
040400                                         PC233-OWNER-SCAC-ID      04040000
040500                                         PC233-ERROR-SCAC-ID      04050000
040600                                         PC233-TRAILER            04060000
040700                                         PC233-ERROR-TRLR-ID      04070000
040800                                         PC233-ERROR-TRLR-STATUS  04080000
040900                                         ALOCO                    04090000
041000                                         ASTATUSO                 04100000
041100                                         ATRLRO                   04110000
041200     END-IF.                                                      04120000
041300                                                                  04130000
041400/                                                                 04140000
041500 6400-GET-MOST-RECENT-TMST.                                       04150010
041600                                                                  04160010
041700     INITIALIZE PV-MAX-TIMESTAMP.                                 04170010
041800                                                                  04180010
041900     EXEC SQL                                                     04190010
042000     SELECT MAX(OTBND_STAT_TMST)                                  04200010
042100       INTO                                                       04210010
042200           :PV-MAX-TIMESTAMP :DN-TIMESTAMP                        04220014
042300     FROM TSUOBTS OBTS                                            04230011
042400     ,    TSUOBTR OBTR                                            04240011
042500     WHERE                                                        04250010
042600         OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID            04260010
042700     AND OBTR.TRLR_SRL_NBR        = :PC233-SERIAL-NBR             04270010
042800     AND OBTR.TRIP_ACTV_CDE       = 'A'                           04280010
042900     AND OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID            04290010
043000     AND OBTS.TRIP_STAT_CDE      IN ('DO','AO')                   04300010
043100     END-EXEC.                                                    04310010
043200                                                                  04320010
043300     EVALUATE TRUE                                                04330010
043400         WHEN SQLCODE = ZERO                                      04340010
043410             IF DN-TIMESTAMP = -1                                 04341014
043420                SET PS-ERRORS-YES TO TRUE                         04342014
043430             END-IF                                               04343014
043600         WHEN SQLCODE = +100                                      04360010
043700             SET PS-ERRORS-YES TO TRUE                            04370013
043800         WHEN SQLCODE = -904                                      04380010
043900         WHEN SQLCODE = -913                                      04390010
044000         WHEN SQLCODE = -911                                      04400010
044100             MOVE 1                   TO PV-ERROR-NBR             04410010
044200             PERFORM 9903-WRITE-CICS-LOG                          04420010
044300             PERFORM 9000-SOFT-ABORT                              04430010
044400         WHEN SQLWARN0 NOT = SPACES                               04440010
044500         WHEN SQLCODE NOT EQUAL ZERO                              04450010
044600              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      04460010
044700              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   04470010
044800              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      04480010
044900              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   04490010
045000              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      04500010
045100              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      04510010
045200              STRING  ' OPER-'               DELIMITED BY SIZE    04520010
045300                      PV-DISPLAY-OPER        DELIMITED BY SIZE    04530010
045400                      '  DOOR-'              DELIMITED BY SIZE    04540010
045500                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    04550010
045600                      '  DEST-'              DELIMITED BY SIZE    04560010
045700                      PV-DISPLAY-DEST        DELIMITED BY SIZE    04570010
045800                                        INTO                      04580010
045900                                        PC233-MESSAGE-TEXT(2)     04590010
046000             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    04600010
046100                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    04610010
046200                      '   SCAC-'             DELIMITED BY SIZE    04620010
046300                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    04630010
046400                      '   TRIP-'             DELIMITED BY SIZE    04640010
046500                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    04650010
046600                                        INTO                      04660010
046700                                        PC233-MESSAGE-TEXT(3)     04670010
046800                                                                  04680010
046900             MOVE 2                   TO PV-ERROR-NBR             04690010
047000                                         PC233-ERROR-NBR          04700010
047100             PERFORM 9903-WRITE-CICS-LOG                          04710010
047200             MOVE '6400-GET-MOST-RECENT-TMST'                     04720010
047300                                      TO PC233-PARAGRAPH          04730010
047400             MOVE 'PCKRF898 - CHECK TRLR AT ANOTHER DOOR'         04740010
047500                                      TO PC233-MESSAGE-TEXT(1)    04750010
047600             MOVE SQLCA               TO PC233-SQLCA              04760010
047700             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  04770010
047800             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  04780010
047900             SET PC233-ABEND          TO TRUE                     04790010
048000             MOVE 99                  TO PC233-PGM-MSG-NBR        04800010
048100             PERFORM 8210-XCTL-ERROR-SCREEN                       04810010
048200     END-EVALUATE.                                                04820010
048300/                                                                 04830010
048400 6800-GET-MOST-RECENT-TRIP.                                       04840009
048500                                                                  04850000
048600     INITIALIZE PV-CURRENT-TRIP-ID.                               04860009
048700                                                                  04870000
048800     EXEC SQL                                                     04880000
048810                                                                  04881010
048811     SELECT OBTS.OTBND_TRIP_ID                                    04881110
048812     INTO                                                         04881212
048813         :PV-CURRENT-TRIP-ID                                      04881312
048814     FROM TSUOBTS OBTS                                            04881411
048815     ,    TSUOBTR OBTR                                            04881511
048817     WHERE                                                        04881711
048818         OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID            04881811
048819     AND OBTR.TRLR_SRL_NBR        = :PC233-SERIAL-NBR             04881911
048820     AND OBTR.TRIP_ACTV_CDE       = 'A'                           04882010
048821     AND OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID            04882110
048822     AND OBTS.OTBND_STAT_TMST     = :PV-MAX-TIMESTAMP             04882211
048823     END-EXEC.                                                    04882311
048824                                                                  04882410
051100     EVALUATE TRUE                                                05110000
051200         WHEN SQLCODE = ZERO                                      05120000
051300             SET PS-ACTIVE-TRIP-EXISTS                            05130000
051400                                      TO TRUE                     05140000
051500         WHEN SQLCODE = +100                                      05150000
051600             SET PS-ERRORS-YES                                    05160000
051700                 PS-NO-ACTIVE-TRIP-EXISTS                         05170000
051800                                      TO TRUE                     05180000
051900         WHEN SQLCODE = -904                                      05190000
052000         WHEN SQLCODE = -913                                      05200000
052100         WHEN SQLCODE = -911                                      05210000
052200             MOVE 1                   TO PV-ERROR-NBR             05220000
052300             PERFORM 9903-WRITE-CICS-LOG                          05230000
052400             PERFORM 9000-SOFT-ABORT                              05240000
052500         WHEN SQLWARN0 NOT = SPACES                               05250000
052600         WHEN SQLCODE NOT EQUAL ZERO                              05260000
052700              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      05270000
052800              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   05280000
052900              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      05290000
053000              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   05300000
053100              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      05310000
053200              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      05320000
053300              STRING  ' OPER-'               DELIMITED BY SIZE    05330000
053400                      PV-DISPLAY-OPER        DELIMITED BY SIZE    05340000
053500                      '  DOOR-'              DELIMITED BY SIZE    05350000
053600                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    05360000
053700                      '  DEST-'              DELIMITED BY SIZE    05370000
053800                      PV-DISPLAY-DEST        DELIMITED BY SIZE    05380000
053900                                        INTO                      05390000
054000                                        PC233-MESSAGE-TEXT(2)     05400000
054100             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    05410000
054200                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    05420000
054300                      '   SCAC-'             DELIMITED BY SIZE    05430000
054400                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    05440000
054500                      '   TRIP-'             DELIMITED BY SIZE    05450000
054600                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    05460000
054700                                        INTO                      05470000
054800                                        PC233-MESSAGE-TEXT(3)     05480000
054900                                                                  05490000
055000             MOVE 2                   TO PV-ERROR-NBR             05500000
055100                                         PC233-ERROR-NBR          05510000
055200             PERFORM 9903-WRITE-CICS-LOG                          05520000
055300             MOVE '6800-GET-MOST-RECENT-TRIP'                     05530009
055400                                      TO PC233-PARAGRAPH          05540000
055500             MOVE 'PCKRF898 - CHECK TRLR AT ANOTHER DOOR'         05550000
055600                                      TO PC233-MESSAGE-TEXT(1)    05560000
055700             MOVE SQLCA               TO PC233-SQLCA              05570000
055800             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  05580000
055900             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  05590000
056000             SET PC233-ABEND          TO TRUE                     05600000
056100             MOVE 99                  TO PC233-PGM-MSG-NBR        05610000
056200             PERFORM 8210-XCTL-ERROR-SCREEN                       05620000
056300     END-EVALUATE.                                                05630000
056400                                                                  05640000
056500 7000-SELECT-TRAILER-INFO.                                        05650009
056600                                                                  05660009
056700     INITIALIZE SUOBTS-OTBND-TRIP-ID                              05670009
056710                SUOBTS-DOOR-ID                                    05671017
056800                CNTRID-SCAC-CDE                                   05680009
056900                CNTRID-TRLR-ID                                    05690009
057000                SUOBTS-TRIP-STAT-CDE                              05700009
057100                SUOBTS-TRLR-PRKG-LOC-DESC                         05710009
057200                SUOBTR-DEST-OPER-UNT-ID                           05720009
057300                SUOBTR-DOOR-TYP-CDE                               05730009
057400                SUOBSC-STAT-SHRT-DESC                             05740009
057500                                                                  05750009
057600     EXEC SQL                                                     05760009
057700       SELECT                                                     05770009
057800           OBTS.OTBND_TRIP_ID                                     05780009
057810       ,   OBTS.DOOR_ID                                           05781017
057900       ,   TRID.SCAC_CDE                                          05790009
058000       ,   TRID.TRLR_ID                                           05800009
058100       ,   OBTS.TRIP_STAT_CDE                                     05810009
058200       ,   OBTR.DEST_OPER_UNT_ID                                  05820009
058300       ,   OBTR.DOOR_TYP_CDE                                      05830009
058400       ,   OBTS.TRLR_PRKG_LOC_DESC                                05840009
058500       ,   OBTS.TRLR_PRKG_SLOT_NBR                                05850009
058600       ,   OBSC.STAT_SHRT_DESC                                    05860009
058700       INTO                                                       05870009
058800           :SUOBTS-OTBND-TRIP-ID                                  05880009
058810       ,   :SUOBTS-DOOR-ID                                        05881016
058900       ,   :CNTRID-SCAC-CDE                                       05890009
059000       ,   :CNTRID-TRLR-ID                                        05900009
059100       ,   :SUOBTS-TRIP-STAT-CDE                                  05910009
059200       ,   :SUOBTR-DEST-OPER-UNT-ID                               05920009
059300       ,   :SUOBTR-DOOR-TYP-CDE                                   05930009
059400       ,   :SUOBTS-TRLR-PRKG-LOC-DESC                             05940009
059500       ,   :SUOBTS-TRLR-PRKG-SLOT-NBR                             05950009
059600       ,   :SUOBSC-STAT-SHRT-DESC                                 05960009
059700       FROM TSUOBTS OBTS                                          05970009
059800       ,    TSUOBTR OBTR                                          05980009
059900       ,    TCNTRID TRID                                          05990009
060000       ,    TSUOBSC OBSC                                          06000009
060100       WHERE                                                      06010009
060200           OBTR.ORGN_OPER_UNT_ID    = :PC233-OPER-UNT-ID          06020009
060300       AND OBTR.TRLR_SRL_NBR        = :PC233-SERIAL-NBR           06030009
060400       AND OBTR.TRIP_ACTV_CDE       = 'A'                         06040009
060500       AND OBTR.TRLR_SRL_NBR        = TRID.TRLR_SRL_NBR           06050009
060600       AND OBTS.OTBND_TRIP_ID       = :PV-CURRENT-TRIP-ID         06060009
060700       AND OBTS.OTBND_TRIP_ID       = OBTR.OTBND_TRIP_ID          06070009
060800       AND OBSC.TRIP_STAT_CDE       = OBTS.TRIP_STAT_CDE          06080009
060900                                                                  06090009
061000       AND OBTS.OTBND_STAT_TMST =                                 06100009
061100           (SELECT MAX(OBTS1.OTBND_STAT_TMST)                     06110009
061200               FROM TSUOBTS OBTS1                                 06120009
061300               WHERE                                              06130009
061400               OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)          06140009
061500                                                                  06150009
061600     END-EXEC.                                                    06160009
061700                                                                  06170009
061800     EVALUATE TRUE                                                06180009
061900         WHEN SQLCODE = ZERO                                      06190009
062000             SET PS-ACTIVE-TRIP-EXISTS                            06200009
062100                                      TO TRUE                     06210009
062200         WHEN SQLCODE = +100                                      06220009
062300             SET PS-ERRORS-YES                                    06230009
062400                 PS-NO-ACTIVE-TRIP-EXISTS                         06240009
062500                                      TO TRUE                     06250009
062600         WHEN SQLCODE = -904                                      06260009
062700         WHEN SQLCODE = -913                                      06270009
062800         WHEN SQLCODE = -911                                      06280009
062900             MOVE 1                   TO PV-ERROR-NBR             06290009
063000             PERFORM 9903-WRITE-CICS-LOG                          06300009
063100             PERFORM 9000-SOFT-ABORT                              06310009
063200         WHEN SQLWARN0 NOT = SPACES                               06320009
063300         WHEN SQLCODE NOT EQUAL ZERO                              06330009
063400              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      06340009
063500              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   06350009
063600              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      06360009
063700              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   06370009
063800              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      06380009
063900              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      06390009
064000              STRING  ' OPER-'               DELIMITED BY SIZE    06400009
064100                      PV-DISPLAY-OPER        DELIMITED BY SIZE    06410009
064200                      '  DOOR-'              DELIMITED BY SIZE    06420009
064300                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    06430009
064400                      '  DEST-'              DELIMITED BY SIZE    06440009
064500                      PV-DISPLAY-DEST        DELIMITED BY SIZE    06450009
064600                                        INTO                      06460009
064700                                        PC233-MESSAGE-TEXT(2)     06470009
064800             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    06480009
064900                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    06490009
065000                      '   SCAC-'             DELIMITED BY SIZE    06500009
065100                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    06510009
065200                      '   TRIP-'             DELIMITED BY SIZE    06520009
065300                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    06530009
065400                                        INTO                      06540009
065500                                        PC233-MESSAGE-TEXT(3)     06550009
065600                                                                  06560009
065700             MOVE 2                   TO PV-ERROR-NBR             06570009
065800                                         PC233-ERROR-NBR          06580009
065900             PERFORM 9903-WRITE-CICS-LOG                          06590009
066000             MOVE '7000-SELECT-TRAILER-INFO'                      06600009
066100                                      TO PC233-PARAGRAPH          06610009
066200             MOVE 'PCKRF898 - CHECK TRLR AT ANOTHER DOOR'         06620009
066300                                      TO PC233-MESSAGE-TEXT(1)    06630009
066400             MOVE SQLCA               TO PC233-SQLCA              06640009
066500             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  06650009
066600             MOVE 'TSUOBTR'           TO PC233-DB2-TABLE-NAME(2)  06660009
066700             SET PC233-ABEND          TO TRUE                     06670009
066800             MOVE 99                  TO PC233-PGM-MSG-NBR        06680009
066900             PERFORM 8210-XCTL-ERROR-SCREEN                       06690009
067000     END-EVALUATE.                                                06700009
067100                                                                  06710009
067200 7100-SELECT-TRAILER-STATUS.                                      06720009
067300                                                                  06730000
067400     EXEC SQL                                                     06740000
067500       SELECT                                                     06750000
067600           OBTS.TRIP_STAT_CDE                                     06760000
067700       INTO                                                       06770000
067800           :SUOBTS-TRIP-STAT-CDE                                  06780000
067900       FROM TSUOBTS OBTS                                          06790000
068000       WHERE                                                      06800000
068100           OBTS.OTBND_TRIP_ID       = :PC233-TRIP-ID              06810000
068200       AND OBTS.OTBND_STAT_TMST =                                 06820000
068300           (SELECT MAX(OBTS1.OTBND_STAT_TMST)                     06830000
068400               FROM TSUOBTS OBTS1                                 06840000
068500               WHERE                                              06850000
068600               OBTS1.OTBND_TRIP_ID = OBTS.OTBND_TRIP_ID)          06860000
068700                                                                  06870000
068800                                                                  06880000
068900     END-EXEC.                                                    06890000
069000                                                                  06900000
069100     EVALUATE TRUE                                                06910000
069200         WHEN SQLCODE = ZERO                                      06920000
069300*LMM         IF SUOBTS-TRIP-STAT-CDE = 'DO' OR 'AO'               06930006
069400*            END-IF                                               06940006
069500           EVALUATE TRUE                                          06950006
069600              WHEN SUOBTS-TRIP-STAT-CDE = 'DC' OR 'AK'            06960006
069700                 CONTINUE                                         06970006
069800              WHEN SUOBTS-TRIP-STAT-CDE = 'DO' OR 'AO'            06980006
069900                 SET PS-ERRORS-YES            TO TRUE             06990007
070000                 MOVE ' CANNOT MV OPN TRLR'   TO AMSGLNO          07000006
070100              WHEN OTHER                                          07010006
070200                 SET PS-ERRORS-YES            TO TRUE             07020006
070300                 MOVE 'BAD STATUS FOR MOVE'   TO AMSGLNO          07030006
070400           END-EVALUATE                                           07040006
070500         WHEN SQLCODE = +100                                      07050000
070600             CONTINUE                                             07060000
070700         WHEN SQLCODE = -904                                      07070000
070800         WHEN SQLCODE = -913                                      07080000
070900         WHEN SQLCODE = -911                                      07090000
071000             MOVE 3                   TO PV-ERROR-NBR             07100000
071100             PERFORM 9903-WRITE-CICS-LOG                          07110000
071200             PERFORM 9000-SOFT-ABORT                              07120000
071300         WHEN SQLWARN0 NOT = SPACES                               07130000
071400         WHEN SQLCODE NOT EQUAL ZERO                              07140000
071500              MOVE PC233-OPER-UNT-ID      TO PV-DISPLAY-OPER      07150000
071600              MOVE PC233-DOOR-ID          TO PV-DISPLAY-DOOR-ID   07160000
071700              MOVE PC233-STR-NBR          TO PV-DISPLAY-DEST      07170000
071800              MOVE PC233-SERIAL-NBR       TO PV-DISPLAY-SRL-NBR   07180000
071900              MOVE PC233-OWNER-SCAC-ID    TO PV-DISPLAY-SCAC      07190000
072000              MOVE PC233-TRIP-ID          TO PV-DISPLAY-TRIP      07200000
072100              STRING  ' OPER-'               DELIMITED BY SIZE    07210000
072200                      PV-DISPLAY-OPER        DELIMITED BY SIZE    07220000
072300                      '  DOOR-'              DELIMITED BY SIZE    07230000
072400                      PV-DISPLAY-DOOR-ID     DELIMITED BY SIZE    07240000
072500                      '  DEST-'              DELIMITED BY SIZE    07250000
072600                      PV-DISPLAY-DEST        DELIMITED BY SIZE    07260000
072700                                        INTO                      07270000
072800                                        PC233-MESSAGE-TEXT(2)     07280000
072900             STRING   ' TRLR SRL#-'          DELIMITED BY SIZE    07290000
073000                      PV-DISPLAY-SRL-NBR     DELIMITED BY SIZE    07300000
073100                      '   SCAC-'             DELIMITED BY SIZE    07310000
073200                      PV-DISPLAY-SCAC        DELIMITED BY SIZE    07320000
073300                      '   TRIP-'             DELIMITED BY SIZE    07330000
073400                      PV-DISPLAY-TRIP        DELIMITED BY SIZE    07340000
073500                                        INTO                      07350000
073600                                        PC233-MESSAGE-TEXT(3)     07360000
073700                                                                  07370000
073800             MOVE 4                   TO PV-ERROR-NBR             07380000
073900                                         PC233-ERROR-NBR          07390000
074000             PERFORM 9903-WRITE-CICS-LOG                          07400000
074100             MOVE '7100-SELECT-TRAILER-STATUS'                    07410016
074200                                      TO PC233-PARAGRAPH          07420000
074300             MOVE 'PCKRF898 - CHECK TRLR AT ANOTHER DOOR'         07430000
074400                                      TO PC233-MESSAGE-TEXT(1)    07440000
074500             MOVE SQLCA               TO PC233-SQLCA              07450000
074600             MOVE 'TSUOBTS'           TO PC233-DB2-TABLE-NAME(1)  07460000
074700             SET PC233-ABEND          TO TRUE                     07470000
074800             MOVE 99                  TO PC233-PGM-MSG-NBR        07480000
074900             PERFORM 8210-XCTL-ERROR-SCREEN                       07490000
075000     END-EVALUATE.                                                07500000
075100                                                                  07510000
075200/                                                                 07520000
075300 8000-SEND-MAP.                                                   07530000
075400                                                                  07540000
075500     MOVE -1                          TO ASERIALL                 07550000
075600     EXEC CICS                                                    07560000
075700         SEND MAP       ('PC898A')                                07570000
075800              MAPSET    ('PCKM898')                               07580000
075900              ERASE                                               07590000
076000              CURSOR                                              07600000
076100              RESP      (PV-CICS-RESPONSE)                        07610000
076200     END-EXEC.                                                    07620000
076300                                                                  07630000
076400     EVALUATE TRUE                                                07640000
076500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07650000
076600             CONTINUE                                             07660000
076700         WHEN OTHER                                               07670000
076800             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          07680000
076900             MOVE 'PCKRF898 - UNABLE TO SEND MAP'                 07690000
077000                                      TO DP013-MESSAGE-TEXT (1)   07700000
077100             SET DP013-CICS-ABEND                                 07710000
077200                 DP013-ROLLBACK       TO TRUE                     07720000
077300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07730000
077400     END-EVALUATE.                                                07740000
077500                                                                  07750000
077600 8010-SEND-DATA-ONLY.                                             07760000
077700                                                                  07770000
077800     MOVE -1                          TO ASERIALL                 07780000
077900     EXEC CICS                                                    07790000
078000         SEND MAP       ('PC898A')                                07800000
078100              MAPSET    ('PCKM898')                               07810000
078200              CURSOR                                              07820000
078300              DATAONLY                                            07830000
078400              RESP      (PV-CICS-RESPONSE)                        07840000
078500     END-EXEC.                                                    07850000
078600                                                                  07860000
078700     EVALUATE TRUE                                                07870000
078800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 07880000
078900             CONTINUE                                             07890000
079000         WHEN OTHER                                               07900000
079100             MOVE '8010-SEND-DATA-ONLY'                           07910000
079200                                      TO DP013-PARAGRAPH          07920000
079300             MOVE 'PCKRF898 - UNABLE TO SEND DATA'                07930000
079400                                      TO DP013-MESSAGE-TEXT (1)   07940000
079500             SET DP013-CICS-ABEND                                 07950000
079600                 DP013-ROLLBACK       TO TRUE                     07960000
079700             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               07970000
079800     END-EVALUATE.                                                07980000
079900                                                                  07990000
080000 8020-RECEIVE-MAP.                                                08000000
080100                                                                  08010000
080200     EXEC CICS                                                    08020000
080300         RECEIVE MAP    ('PC898A')                                08030000
080400                 MAPSET ('PCKM898')                               08040000
080500                 RESP   (PV-CICS-RESPONSE)                        08050000
080600     END-EXEC.                                                    08060000
080700                                                                  08070000
080800     EVALUATE TRUE                                                08080000
080900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08090000
081000             CONTINUE                                             08100000
081100         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                08110000
081200             CONTINUE                                             08120000
081300         WHEN OTHER                                               08130000
081400            MOVE '8020-RECEIVE-MAP'   TO DP013-PARAGRAPH          08140000
081500            MOVE 'PCKRF898 - UNABLE TO RECEIVE MAP'               08150000
081600                                      TO DP013-MESSAGE-TEXT (1)   08160000
081700            SET DP013-LOGIC-ABEND     TO TRUE                     08170000
081800            SET DP013-ROLLBACK        TO TRUE                     08180000
081900            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                08190000
082000     END-EVALUATE.                                                08200000
082100                                                                  08210000
082200 8100-RETURN-TRANID.                                              08220000
082300                                                                  08230000
082400     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       08240000
082500     EXEC CICS                                                    08250000
082600         RETURN TRANSID  (PC-TRANID)                              08260000
082700                COMMAREA (CA-COMMAREA)                            08270000
082800                LENGTH   (PV-COMMAREA-LENGTH)                     08280000
082900                RESP     (PV-CICS-RESPONSE)                       08290000
083000     END-EXEC.                                                    08300000
083100                                                                  08310000
083200     EVALUATE TRUE                                                08320000
083300         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08330000
083400             CONTINUE                                             08340000
083500         WHEN OTHER                                               08350000
083600             MOVE '8100-RETURN-TRANIND'                           08360000
083700                                      TO DP013-PARAGRAPH          08370000
083800             MOVE 'PCKRF898 - UNABLE TO RETURN TO TRANID'         08380000
083900                 TO DP013-MESSAGE-TEXT (1)                        08390000
084000             SET DP013-CICS-ABEND     TO TRUE                     08400000
084100             SET DP013-ROLLBACK       TO TRUE                     08410000
084200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08420000
084300     END-EVALUATE.                                                08430000
084400                                                                  08440000
084500 8110-RETURN.                                                     08450000
084600                                                                  08460000
084700     EXEC CICS                                                    08470000
084800         SEND FROM (PV-MESSAGE-AREA)                              08480000
084900              LENGTH (19)                                         08490000
085000              ERASE                                               08500000
085100     END-EXEC.                                                    08510000
085200                                                                  08520000
085300     EXEC CICS                                                    08530000
085400         RETURN                                                   08540000
085500     END-EXEC.                                                    08550000
085600                                                                  08560000
085700 8200-XCTL.                                                       08570000
085800     SET PC233-INITIALIZE-SCREEN      TO TRUE.                    08580000
085900     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      08590000
086000     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       08600000
086100                                                                  08610000
086200     EXEC CICS                                                    08620000
086300         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    08630000
086400               COMMAREA  (CA-COMMAREA)                            08640000
086500               LENGTH    (PV-COMMAREA-LENGTH)                     08650000
086600               RESP      (PV-CICS-RESPONSE)                       08660000
086700     END-EXEC.                                                    08670000
086800                                                                  08680000
086900     EVALUATE TRUE                                                08690000
087000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 08700000
087100             CONTINUE                                             08710000
087200         WHEN OTHER                                               08720000
087300             MOVE '8200-XCTL'                                     08730000
087400                                      TO DP013-PARAGRAPH          08740000
087500             MOVE 'PCKRF898 - UNABLE TO XCTL TO PROGRAM: '        08750000
087600                                      TO DP013-MESSAGE-TEXT (1)   08760000
087700             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   08770000
087800             SET DP013-CICS-ABEND                                 08780000
087900                 DP013-ROLLBACK       TO TRUE                     08790000
088000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               08800000
088100             MOVE PC-TRANS-UNAVAILABLE-MSG                        08810000
088200                                      TO AMSGLNO                  08820000
088300             SET PC233-PROCESS-SCREEN TO TRUE                     08830000
088400             PERFORM 8000-SEND-MAP                                08840000
088500             PERFORM 8100-RETURN-TRANID                           08850000
088600     END-EVALUATE.                                                08860000
088700                                                                  08870000
088800 8210-XCTL-ERROR-SCREEN.                                          08880000
088900     IF NOT PC233-ABEND                                           08890000
089000         SET PC233-INITIALIZE-SCREEN  TO TRUE                     08900000
089100     END-IF                                                       08910000
089200     IF PC233-PGM-MSG-NBR = ZERO                                  08920000
089300         MOVE 2                       TO PC233-PGM-MSG-NBR        08930000
089400     END-IF                                                       08940000
089500                                                                  08950000
089600     MOVE DFHEIBLK                    TO PC233-DFHEIBLK.          08960000
089700     MOVE PC-CURRENT-PROGRAM-NAME     TO PC233-LAST-PROGRAM.      08970000
089800     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       08980000
089900     MOVE 'PCKRF871'                  TO PV-TRANSFER-PROGRAM      08990000
090000                                                                  09000000
090100     EXEC CICS                                                    09010000
090200         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    09020000
090300               COMMAREA  (CA-COMMAREA)                            09030000
090400               LENGTH    (PV-COMMAREA-LENGTH)                     09040000
090500               RESP      (PV-CICS-RESPONSE)                       09050000
090600     END-EXEC.                                                    09060000
090700                                                                  09070000
090800     EVALUATE TRUE                                                09080000
090900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09090000
091000             CONTINUE                                             09100000
091100         WHEN OTHER                                               09110000
091200             MOVE '8200-XCTL'                                     09120000
091300                                      TO DP013-PARAGRAPH          09130000
091400             MOVE 'PCKRF898 - UNABLE TO XCTL TO PROGRAM: '        09140000
091500                                      TO DP013-MESSAGE-TEXT (1)   09150000
091600             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   09160000
091700             SET DP013-CICS-ABEND                                 09170000
091800                 DP013-ROLLBACK       TO TRUE                     09180000
091900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09190000
092000             MOVE PC-TRANS-UNAVAILABLE-MSG                        09200000
092100                                      TO AMSGLNO                  09210000
092200             SET PC233-PROCESS-SCREEN TO TRUE                     09220000
092300             PERFORM 8000-SEND-MAP                                09230000
092400             PERFORM 8100-RETURN-TRANID                           09240000
092500     END-EVALUATE.                                                09250000
092600                                                                  09260000
092700*                                                                 09270000
092800 8220-XCTL-TO-HELP.                                               09280000
092900                                                                  09290000
093000     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       09300000
093100                                                                  09310000
093200     EXEC CICS                                                    09320000
093300         XCTL                                                     09330000
093400             PROGRAM   (PV-TRANSFER-PROGRAM)                      09340000
093500             COMMAREA  (PC192-COMMAREA)                           09350000
093600             LENGTH    (PV-COMMAREA-LENGTH)                       09360000
093700             RESP      (PV-CICS-RESPONSE)                         09370000
093800     END-EXEC.                                                    09380000
093900                                                                  09390000
094000     EVALUATE TRUE                                                09400000
094100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 09410000
094200              CONTINUE                                            09420000
094300         WHEN OTHER                                               09430000
094400             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          09440000
094500             MOVE 'PCKRF898 - UNABLE TO XCTL TO PROGRAM: '        09450000
094600                                      TO DP013-MESSAGE-TEXT (1)   09460000
094700             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   09470000
094800             SET DP013-CICS-ABEND                                 09480000
094900                 DP013-ROLLBACK       TO TRUE                     09490000
095000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               09500000
095100             MOVE PC-TRANS-UNAVAILABLE-MSG                        09510000
095200                                      TO AMSGLNO                  09520000
095300             SET PC233-PROCESS-SCREEN TO TRUE                     09530000
095400             PERFORM 8000-SEND-MAP                                09540000
095500             PERFORM 8100-RETURN-TRANID                           09550000
095600     END-EVALUATE.                                                09560000
095700/                                                                 09570000
095800 9000-SOFT-ABORT.                                                 09580000
095900                                                                  09590000
096000     EXEC CICS                                                    09600000
096100         SYNCPOINT ROLLBACK                                       09610000
096200     END-EXEC                                                     09620000
096300                                                                  09630000
096400     MOVE 1                           TO PC233-PGM-MSG-NBR        09640000
096500     MOVE SQLCODE                     TO PC233-SQLCODE            09650000
096600     PERFORM 8210-XCTL-ERROR-SCREEN.                              09660000
096700                                                                  09670000
096800                                                                  09680000
096900 9903-WRITE-CICS-LOG.                                             09690000
097000                                                                  09700000
097100     MOVE SQLCODE                     TO PV-SQLCODE               09710000
097200     MOVE PC233-USER-ID               TO PV-USER-ID               09720000
097300                                                                  09730000
097400     EXEC CICS                                                    09740000
097500         WRITEQ TD                                                09750000
097600             QUEUE  ('CSSL')                                      09760000
097700             FROM   (PV-LOG-MSG)                                  09770000
097800             RESP   (PV-CICS-RESPONSE)                            09780000
097900     END-EXEC.                                                    09790000
098000                                                                  09800000
098100 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  09810000
098200                                                                  09820000
098300     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           09830000
098400     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          09840000
098500     INITIALIZE DP013-SRC-TASK-NUMBER                             09850000
098600                DP013-STACK.                                      09860000
098700     SET DP013-LINK-RETURN            TO TRUE.                    09870000
098800                                                                  09880000
098900     EXEC CICS                                                    09890000
099000         LINK                                                     09900000
099100             PROGRAM   (DP013-NAME)                               09910000
099200             COMMAREA  (DP013-PARAMETERS)                         09920000
099300             LENGTH    (DP013-LENGTH)                             09930000
099400     END-EXEC.                                                    09940000
