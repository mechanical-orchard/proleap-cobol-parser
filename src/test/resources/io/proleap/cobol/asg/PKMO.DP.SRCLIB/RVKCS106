000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    RVKCS106.                                         00040099
000500 AUTHOR.        VIRGENE LENNEMAN.                                 00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES                           00060099
000700 DATE-WRITTEN.  SEPTEMBER 2003.                                   00070099
000800 DATE-COMPILED.                                                   00080099
000900*----------------------------------------------------------------*00090099
001000*    T106 - RTV AUTHORIZATION UPDATE SCREEN                      *00100099
001100*                                                                *00110099
001200*    THIS PROGRAM ALLOWS THE USER TO UPDATE SHIPPING INFORMATION *00120099
001300*    FOR RTV AND DEBIT/DISPOSE LISTINGS AND THEN SHIP A LISTING  *00130099
001400*----------------------------------------------------------------*00140099
001410*  CHANGED 11/07/2022    BY JIM HUNTER      WR: CHG0277924        00141099
001420*                                                                 00142099
001430*  ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL       00143099
001440*  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      00144099
001450*-----------------------------------------------------------------00145099
001500                                                                  00150099
001600 ENVIRONMENT DIVISION.                                            00160099
001700                                                                  00170099
001800 DATA DIVISION.                                                   00180099
001900                                                                  00190099
002000 WORKING-STORAGE SECTION.                                         00200099
002100                                                                  00210099
002200 01  DK-DB2-KEYS.                                                 00220099
002300     05  DK-DFCT-ORD-ID           PIC S9(12)V VALUE +0 COMP-3.    00230099
002400     05  DK-DFCT-SHIPT-ID         PIC S9(09)  VALUE +0 COMP.      00240099
002500     05  DK-ENT-ID                PIC S9(09)  VALUE +0 COMP.      00250099
002600     05  DK-DEPT-NBR              PIC  X(03)  VALUE SPACES.       00260099
002700                                                                  00270099
002800*                                                                 00280099
002900 01  PC-PROGRAM-CONSTANTS.                                        00290099
003000     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'RVKCS106'.  00300099
003100     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'RV106A  '.  00310099
003200     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'RVKM106 '.  00320099
003300     05  PC-RAND-PGM              PIC  X(08)  VALUE  'DPKUT902'.  00330099
003400     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1 COMP.     00340099
003500     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3 COMP.     00350099
003600                                                                  00360099
003700     05  PC-TSYMSG-NUMBERS.                                       00370099
003800***********   00005 INVALID VALUE                                 00380099
003900         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00390099
004000***********   00007 REQUIRED ENTRY                                00400099
004100         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00410099
004200***********   00008 MUST BE NUMERIC                               00420099
004300         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00430099
004400***********   00009 INVALID DATE                                  00440099
004500         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       00450099
004600***********   00045 INVALID FUNCTION KEY                          00460099
004700         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00470099
004800***********   00059 UPDATE(S) SUCCESSFUL                          00480099
004900         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00490099
005000***********   00148 DATA DOES NOT EXIST                           00500099
005100         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       00510099
005200***********   00342 MUST BE NUMERIC AND > 0                       00520099
005300         10  PC-TSYMSG-00342      PIC  9(05)  VALUE  00342.       00530099
005400***********   01912 PERCENT FIELD CANNOT BE GREATER THAN 100      00540099
005500         10  PC-TSYMSG-01912      PIC  9(05)  VALUE  01912.       00550099
005600***********   02609 INVALID SCAC CODE                             00560099
005700         10  PC-TSYMSG-02609      PIC  9(05)  VALUE  02609.       00570099
005800***********   03155 RETURN AUTHORIZATION REQUIRED FROM VENDOR     00580099
005900         10  PC-TSYMSG-03155      PIC  9(05)  VALUE  03155.       00590099
006000***********   03156 SHIPPING CHARGES NOT ALLOWED IF PAYMENT       00600099
006100***********         TYPE = C-COLLECT                              00610099
006200         10  PC-TSYMSG-03156      PIC  9(05)  VALUE  03156.       00620099
006300***********   03157 ONLY ONE IS ALLOWED, A DEDUCTION OR DISCOUNT  00630099
006400***********         % OR DISCOUNT AMOUNT                          00640099
006500         10  PC-TSYMSG-03157      PIC  9(05)  VALUE  03157.       00650099
006600***********   03158 CANNOT SHIP LISTING, NOT ALL SHIPPING         00660099
006700***********         INFORMATION IS PRESENT                        00670099
006800         10  PC-TSYMSG-03158      PIC  9(05)  VALUE  03158.       00680099
006900***********   03160 UPDATE NOT SUCCESSFUL, TRY AGAIN. IF          00690099
007000***********         ERROR CONTINUES, CALL HELPDESK                00700099
007100         10  PC-TSYMSG-03160      PIC  9(05)  VALUE  03160.       00710099
007200***********   03195 MORE THAN ONE VENDOR AGREEMENT ON FILE,       00720099
007300***********         RETURN AUTHORIZATION REQUIRED                 00730099
007400         10  PC-TSYMSG-03195      PIC  9(05)  VALUE  03195.       00740099
007500***********   03196 LISTING HAS BEEN SHIPPED, MUST UNSHIP         00750099
007600***********         BEFORE CHANGING LISTING TO D&D                00760099
007700         10  PC-TSYMSG-03196      PIC  9(05)  VALUE  03196.       00770099
007800***********   03197 PRESS F2 TO CONFIRM CHANGING RTV LISTING      00780099
007900***********         TO A D&D LISTING                              00790099
008000         10  PC-TSYMSG-03197      PIC  9(05)  VALUE  03197.       00800099
008100***********   03198 PRESS F2 TO CONFIRM UNSHIPPING A              00810099
008200***********         SHIPPED LISTING                               00820099
008300         10  PC-TSYMSG-03198      PIC  9(05)  VALUE  03198.       00830099
008400***********   03202 LISTING HAS ALREADY BEEN SHIPPED, PRESS       00840099
008500***********        F15 TO UPDATE                                  00850099
008600         10  PC-TSYMSG-03202      PIC  9(05)  VALUE  03202.       00860099
008700***********   03215 UPDATE INVALID, SHIPMENT NOT CREATED,         00870099
008800***********        PRESS F22 TO SHIP LISTING                      00880099
008900         10  PC-TSYMSG-03215      PIC  9(05)  VALUE  03215.       00890099
009000***********   03232 GRAND TOTAL HAS TO BE GREATER THAN ZERO,      00900099
009100***********        REDUCE DEDUCTIONS/DISCOUNTS                    00910099
009200         10  PC-TSYMSG-03232      PIC  9(05)  VALUE  03232.       00920099
009300***********   03234 AUTHORIZATION DATE MUST BE LESS THAN OR       00930099
009400***********        EQUAL TO THE CURRENT DATE                      00940099
009500         10  PC-TSYMSG-03234      PIC  9(05)  VALUE  03234.       00950099
009600***********   03235 SHIP DATE MUST BE GREATER THAN OR EQUAL TO    00960099
009700***********        THE AUTHORIZATION DATE                         00970099
009800         10  PC-TSYMSG-03235      PIC  9(05)  VALUE  03235.       00980099
009900***********   03238 SHIP DATE MUST BE LESS THAN OR EQUAL TO       00990099
010000***********        CURRENT DATE OR PLUS 1 DAY                     01000099
010100         10  PC-TSYMSG-03238      PIC  9(05)  VALUE  03238.       01010099
010200***********   03242 AUTH NUMBER/DATE NEEDS TO HAVE BEEN SAVED     01020099
010300***********        BEFORE CHANGING TO D & D                       01030099
010400         10  PC-TSYMSG-03242      PIC  9(05)  VALUE  03242.       01040099
010500***********   03272 CANNOT SHIP ON INVENTORY CUTOFF DATE (&VAR)   01050099
010600         10  PC-TSYMSG-03272      PIC  9(05)  VALUE  03272.       01060099
010700***********   03273 CAN'T CHANGE LISTING TO D&D DURING THE        01070099
010800***********         INVENTORY CUTOFF PERIOD (&VAR)                01080099
010900         10  PC-TSYMSG-03273      PIC  9(05)  VALUE  03273.       01090099
011000*                                                                 01100099
011100 01  PS-PROGRAM-SWITCHES.                                         01110099
011200     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01120099
011300         88  PS-ERROR                         VALUE  'Y'.         01130099
011400         88  PS-NO-ERROR                      VALUE  'N'.         01140099
011500     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01150099
011600         88  PS-COMMAREA-VALID                VALUE  'Y'.         01160099
011700         88  PS-COMMAREA-INVALID              VALUE  'N'.         01170099
011800     05  PS-DATA-FOUND-SW        PIC  X(01)   VALUE  'Y'.         01180099
011900         88  PS-DATA-FOUND                    VALUE  'Y'.         01190099
012000         88  PS-DATA-NOT-FOUND                VALUE  'N'.         01200099
012100     05  PS-VALID-SCAC-SW        PIC  X(01)   VALUE  'Y'.         01210099
012200         88  PS-VALID-SCAC                    VALUE  'Y'.         01220099
012300         88  PS-INVALID-SCAC                  VALUE  'N'.         01230099
012400     05  PS-CHK-DTE-SW           PIC  X(01)   VALUE  ' '.         01240099
012500         88  PS-CHK-AUTH-DTE                  VALUE  'A'.         01250099
012600         88  PS-CHK-SHIP-DTE                  VALUE  'S'.         01260099
012700         88  PS-CHK-BOTH-DTES                 VALUE  'B'.         01270099
012800     05  PS-UPDATE-OK-SW         PIC  X(01)   VALUE  'Y'.         01280099
012900         88  PS-UPDATE-OK                     VALUE  'Y'.         01290099
013000         88  PS-UPDATE-NOT-OK                 VALUE  'N'.         01300099
013100     05  PS-ROLLBACK-NEEDED-SW   PIC  X(01)   VALUE  'N'.         01310099
013200         88  PS-ROLLBACK-NEEDED               VALUE  'Y'.         01320099
013300         88  PS-ROLLBACK-NOT-NEEDED           VALUE  'N'.         01330099
013400     05  PS-INSERT-SHIP-STAT-SW  PIC  X(01)   VALUE  'Y'.         01340099
013500         88  PS-INSERT-SHIP-STAT              VALUE  'Y'.         01350099
013600         88  PS-DO-NOT-INSERT-SHIP-STAT       VALUE  'N'.         01360099
013700     05  PS-DELETE-SHIPMENT-SW   PIC  X(01)   VALUE  'N'.         01370099
013800         88  PS-DELETE-SHIPMENT               VALUE  'Y'.         01380099
013900         88  PS-DO-NOT-DELETE-SHIPMENT        VALUE  'N'.         01390099
014000******* WHO PAID INBOUND-FREIGHT?                                 01400099
014100     05  PS-PAID-IN-FRGT-SW      PIC  X(01)   VALUE  ' '.         01410099
014200         88  PS-KOHLS-PAID                    VALUE  'K'.         01420099
014300         88  PS-VENDOR-PAID                   VALUE  'V'.         01430099
014400*                                                                 01440099
014500 01  PV-PROGRAM-VARIABLES.                                        01450099
014600     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01460099
014700                                              COMP SYNC.          01470099
014800     05  PV-DB2-OPER-UNT-ID       PIC S9(04)  VALUE +0            01480099
014900                                              COMP SYNC.          01490099
015000     05  PV-PRT-LIST-TRANID       PIC  X(04)  VALUE SPACES.       01500099
015100     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01510099
015200                                              COMP SYNC.          01520099
015300     05  PV-COMMAREA-LENGTH       PIC S9(04)  VALUE +0            01530099
015400                                              COMP SYNC.          01540099
015500     05  PV-HOLD-TYP-CDE          PIC  X(01)  VALUE SPACE.        01550099
015600         88  PV-HOLD-RTV                      VALUE 'R'.          01560099
015700         88  PV-HOLD-DND                      VALUE 'D'.          01570099
015800     05  PV-CURRENT-TMST          PIC  X(26)  VALUE SPACES.       01580099
015900     05  PV-CUR-TMST.                                             01590099
016000         10  PV-CURRENT-DT        PIC  X(10)  VALUE SPACE.        01600099
016100         10  FILLER               PIC  X(01)  VALUE SPACE.        01610099
016200         10  PV-CURRENT-TIME      PIC  X(15)  VALUE SPACE.        01620099
016300     05  PV-CURRENT-DATE.                                         01630099
016400         10  PV-CURRENT-DT-CCYY   PIC  X(04)  VALUE SPACE.        01640099
016500         10  FILLER               PIC  X(01)  VALUE '-'.          01650099
016600         10  PV-CURRENT-DT-MM     PIC  X(02)  VALUE SPACE.        01660099
016700         10  FILLER               PIC  X(01)  VALUE '-'.          01670099
016800         10  PV-CURRENT-DT-DD     PIC  X(02)  VALUE SPACE.        01680099
016900     05  PV-CURRENT-DATE-USA.                                     01690099
017000         10  PV-CUR-USA-DT-MM     PIC  X(02)  VALUE SPACE.        01700099
017100         10  FILLER               PIC  X(01)  VALUE '/'.          01710099
017200         10  PV-CUR-USA-DT-DD     PIC  X(02)  VALUE SPACE.        01720099
017300         10  FILLER               PIC  X(01)  VALUE '/'.          01730099
017400         10  PV-CUR-USA-DT-CCYY   PIC  X(04)  VALUE SPACE.        01740099
017500     05  PV-DATE-USA.                                             01750099
017600         10  PV-DATE-USA-MM       PIC  X(02)  VALUE SPACE.        01760099
017700         10  FILLER               PIC  X(01)  VALUE '/'.          01770099
017800         10  PV-DATE-USA-DD       PIC  X(02)  VALUE SPACE.        01780099
017900         10  FILLER               PIC  X(01)  VALUE '/'.          01790099
018000         10  PV-DATE-USA-CCYY     PIC  X(04)  VALUE SPACE.        01800099
018100     05  PV-COMPARE-DATE-USA      PIC  X(10)  VALUE SPACES.       01810099
018200     05  PV-COMPARE-DATE-USA-R    REDEFINES                       01820099
018300         PV-COMPARE-DATE-USA.                                     01830099
018400         10  PV-CMPR-USA-DT-MM    PIC  X(02).                     01840099
018500         10  PV-CMPR-USA-DT-SLASH-1                               01850099
018600                                  PIC  X(01).                     01860099
018700         10  PV-CMPR-USA-DT-DD    PIC  X(02).                     01870099
018800         10  PV-CMPR-USA-DT-SLASH-2                               01880099
018900                                  PIC  X(01).                     01890099
019000         10  PV-CMPR-USA-DT-CCYY  PIC  X(04).                     01900099
019100     05  PV-CLOSE-DATE            PIC  X(10)  VALUE SPACES.       01910099
019200     05  PV-DFCT-ORD-ID-X         PIC  X(12)  VALUE SPACES.       01920099
019300     05  PV-SHIPT-ID-X            PIC  X(09)  VALUE SPACES.       01930099
019400     05  PV-NBR-SLASHES           PIC  9(02)  VALUE ZEROS.        01940099
019500     05  PV-NBR-AGRMTS            PIC  9(01)  VALUE ZEROS.        01950099
019600     05  PV-TOTAL-COST            PIC  9(06)V99999                01960099
019700                                              VALUE ZEROS.        01970099
019800     05  PV-DED-CHRG-DISC-AMT     PIC  9(06)V99999                01980099
019900                                              VALUE ZEROS.        01990099
020000     05  PV-NEW-AMT-9             PIC  9(08)  VALUE ZEROS.        02000099
020100     05  PV-NEW-AMT               REDEFINES                       02010099
020200         PV-NEW-AMT-9             PIC  9(06)V99.                  02020099
020300     05  PV-HOLD-NEW-AMT-UNPACK   PIC S9(11)V9(06)                02030099
020400                                              VALUE ZEROS.        02040099
020500     05  PV-HOLD-NEW-AMT          REDEFINES                       02050099
020600         PV-HOLD-NEW-AMT-UNPACK.                                  02060099
020700         10  PV-HOLD-NEW-AMT-DIGITS                               02070099
020800                                  PIC  9(11).                     02080099
020900         10  PV-HOLD-NEW-AMT-DECIMAL                              02090099
021000                                  PIC  9(06).                     02100099
021100     05  PV-ZERO-CTR              PIC  9(04)  VALUE ZEROS.        02110099
021200     05  PV-GRAND-TOTAL           PIC S9(06)V99.                  02120099
021300     05  PV-LISTING-COUNT         PIC S9(09)  VALUE ZEROS COMP.   02130099
021400     05  PV-INV-DATE-COUNT        PIC S9(09)  VALUE ZEROS COMP.   02140099
021500*                                                                 02150099
021600*** NULL INDICATORS                                               02160099
021700 01  NI-NULL-INDICATORS.                                          02170099
021800     05  NI-SHIPT-ID              PIC S9(04)  VALUE +0            02180099
021900                                              COMP SYNC.          02190099
022000     05  NI-AUTH-ID               PIC S9(04)  VALUE +0            02200099
022100                                              COMP SYNC.          02210099
022200     05  NI-AUTH-DTE              PIC S9(04)  VALUE +0            02220099
022300                                              COMP SYNC.          02230099
022400     05  NI-CART-QTY              PIC S9(04)  VALUE +0            02240099
022500                                              COMP SYNC.          02250099
022600     05  NI-SPEC-INSTR            PIC S9(04)  VALUE +0            02260099
022700                                              COMP SYNC.          02270099
022800     05  NI-INBND-FRGT            PIC S9(04)  VALUE +0            02280099
022900                                              COMP SYNC.          02290099
023000     05  NI-OUTBND-FRGT           PIC S9(04)  VALUE +0            02300099
023100                                              COMP SYNC.          02310099
023200     05  NI-DEDUCT                PIC S9(04)  VALUE +0            02320099
023300                                              COMP SYNC.          02330099
023400     05  NI-WEIGHT                PIC S9(04)  VALUE +0            02340099
023500                                              COMP SYNC.          02350099
023600     05  NI-DISC-PCT              PIC S9(04)  VALUE +0            02360099
023700                                              COMP SYNC.          02370099
023800     05  NI-DISC-AMT              PIC S9(04)  VALUE +0            02380099
023900                                              COMP SYNC.          02390099
024000     05  NI-TRKG-ID               PIC S9(04)  VALUE +0            02400099
024100                                              COMP SYNC.          02410099
024200     05  NI-RET-RSN               PIC S9(04)  VALUE +0            02420099
024300                                              COMP SYNC.          02430099
024400     05  NI-PAYT-TYP              PIC S9(04)  VALUE +0            02440099
024500                                              COMP SYNC.          02450099
024600     05  NI-VND-AUTH-ID           PIC S9(04)  VALUE +0            02460099
024700                                              COMP SYNC.          02470099
024800                                                                  02480099
024900*----------------------------------------------------------------*02490099
025000*    MAP LAYOUT                                                  *02500099
025100*----------------------------------------------------------------*02510099
025200     COPY RVKM106.                                                02520099
025300                                                                  02530099
025400*----------------------------------------------------------------*02540099
025500*    ATTRIBUTE SETTINGS COPYBOOK.                                *02550099
025600*----------------------------------------------------------------*02560099
025700     COPY DPWS015.                                                02570099
025800                                                                  02580099
025900*----------------------------------------------------------------*02590099
026000*    FUNCTION KEYS COPYBOOK                                      *02600099
026100*----------------------------------------------------------------*02610099
026200     COPY DPWS016.                                                02620099
026300                                                                  02630099
026400*----------------------------------------------------------------*02640099
026500*    COPYBOOK FOR RANDOM NUMBER GENERATOR                        *02650099
026600*----------------------------------------------------------------*02660099
026700     COPY DPWS902.                                                02670099
026800                                                                  02680099
026900******************************************************************02690099
027000*  COPYBOOK FOR THE CALENDAR ROUTINE                             *02700099
027100******************************************************************02710099
027200     COPY DPWS500.                                                02720099
027300                                                                  02730099
027400**--------------------------------------------------------------**02740099
027500** THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **02750099
027600** SUB-ROUTINE (DPKUT100).                                      **02760099
027700**--------------------------------------------------------------**02770099
027800     COPY DPWS010I.                                               02780099
027900                                                                  02790099
028000**--------------------------------------------------------------**02800099
028100** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*02810099
028200** APPLICATION PROGRAMMING INTERFACE MODULE.                    **02820099
028300**--------------------------------------------------------------**02830099
028400     COPY DPWS030.                                                02840099
028410     COPY DPWS930.                                                02841099
028500                                                                  02850099
028600**--------------------------------------------------------------**02860099
028700*    STANDARD COMMAREA.                                           02870099
028800**--------------------------------------------------------------**02880099
028900     COPY DPWS020.                                                02890099
029000     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02900099
029100                                                                  02910099
029200***************************************************************** 02920099
029300*    INTER-APPLICATION COMMAREA.                                  02930099
029400*         RVWS100 - COMMAREA COMING FROM RVKCS101 (HEADER UPDATE) 02940099
029500*         RVWS008 - COMMAREA COMING FROM RVKCS108 (SHIPMENT INFO) 02950099
029600*         VNWS001 - COMMAREA GOING TO VENDOR TERMS (VLUDCTRM)     02960099
029700***************************************************************** 02970099
029800         10  INTER-APPL-COMM-AREA PIC X(200).                     02980099
029900     COPY RVWS100.                                                02990099
030000                                                                  03000099
030100     COPY RVWS008.                                                03010099
030200                                                                  03020099
030300     COPY VNWS001.                                                03030099
030400                                                                  03040099
030500***************************************************************** 03050099
030600*    SPECIFIC COMMMAREA FOR RVKCS106.                             03060099
030700***************************************************************** 03070099
030800         10  ASC-SPECIFIC-COMMAREA.                               03080099
030900             15  ASC-CONFIRM-SW            PIC  X(01).            03090099
031000                 88 ASC-CONFIRM            VALUE 'Y'.             03100099
031100                 88 ASC-NO-CONFIRM         VALUE 'N'.             03110099
031200             15  ASC-CHG-STATUS-SW         PIC  X(01).            03120099
031300                 88 ASC-RESET-CHG-STATUS   VALUE ' '.             03130099
031400                 88 ASC-RTV-TO-DND         VALUE 'R'.             03140099
031500                 88 ASC-DND-TO-RTV         VALUE 'D'.             03150099
031600                 88 ASC-SHIP-TO-DND        VALUE 'S'.             03160099
031700                 88 ASC-SHIP-TO-RTV        VALUE 'T'.             03170099
031800*-------------- ASC-SHIP-TO-UNSHIP  ONLY USED FOR F21 UNSHIP      03180099
031900                 88 ASC-SHIP-TO-UNSHIP     VALUE 'U'.             03190099
032000             15  ASC-RETURN-FROM-SW        PIC  X(01).            03200099
032100                 88 ASC-RETURN-FROM-SHIPT  VALUE '1'.             03210099
032200                 88 ASC-VNTERMS            VALUE '2'.             03220099
032300             15  ASC-CURRENT-DATE-USA      PIC  X(10).            03230099
032400             15  ASC-CURRENT-DATE-PLUS-ONE-DAY                    03240099
032500                                           PIC  X(10).            03250099
032600             15  ASC-DFCT-ORD-ID           PIC S9(12) COMP-3.     03260099
032700             15  ASC-DFCT-SHIPT-ID         PIC S9(09) COMP.       03270099
032800             15  ASC-SHIPT-ID-SW           PIC  X(01).            03280099
032900                 88  ASC-SHIPT-ID-FOUND    VALUE  'Y'.            03290099
033000                 88  ASC-SHIPT-ID-NOT-FOUND                       03300099
033100                                           VALUE  'N'.            03310099
033200             15  ASC-LIST-TYPE             PIC  X(08).            03320099
033300             15  ASC-TYPE-CDE              PIC  X(01).            03330099
033400                 88 ASC-VALID-TYP-CDE      VALUE 'D', 'R'.        03340099
033500                 88 ASC-DND-TYP            VALUE 'D'.             03350099
033600                 88 ASC-RTV-TYP            VALUE 'R'.             03360099
033700             15  ASC-TYPE-CDE-OLD          PIC  X(01).            03370099
033800             15  ASC-LOCATION              PIC  X(15).            03380099
033900             15  ASC-VENDOR-NAME           PIC  X(25).            03390099
034000             15  ASC-ENT-ID                PIC S9(09) COMP.       03400099
034100             15  ASC-DEPT-NBR              PIC  X(03).            03410099
034200             15  ASC-INHOUSE-NBR           PIC S9(03)V COMP-3.    03420099
034300             15  ASC-STATUS                PIC  X(08).            03430099
034400             15  ASC-STAT-CDE              PIC  X(01).            03440099
034500                 88 ASC-VALID-STAT         VALUE                  03450099
034600                                         'C', 'D', 'S', 'A'.      03460099
034700                 88 ASC-DND-STAT-D         VALUE 'D'.             03470099
034800                 88 ASC-DND-STAT-S         VALUE 'S'.             03480099
034900                 88 ASC-DND-STAT-A         VALUE 'A'.             03490099
035000                 88 ASC-RTV-STAT-C         VALUE 'C'.             03500099
035100                 88 ASC-RTV-STAT-S         VALUE 'S'.             03510099
035200                 88 ASC-RTV-STAT-A         VALUE 'A'.             03520099
035300             15  ASC-STAT-CDE-OLD          PIC  X(01).            03530099
035400             15  ASC-TK-NBR                PIC  X(08).            03540099
035500             15  ASC-AUTH-ID               PIC  X(10).            03550099
035600             15  ASC-AUTH-DTE              PIC  X(10).            03560099
035700             15  ASC-SHIP-DTE              PIC  X(10).            03570099
035800             15  ASC-SHIPPED-BY            PIC  X(40).            03580099
035900             15  ASC-SHIP-ID               PIC  9(09).            03590099
036000             15  ASC-SCAC                  PIC  X(04).            03600099
036100             15  ASC-TRAILER-NBR           PIC  X(12).            03610099
036200             15  ASC-TRACKING-NBR          PIC  X(25).            03620099
036300             15  ASC-CART-QTY              PIC  9(10).            03630099
036400             15  ASC-CART-QTY-X            PIC  X(10).            03640099
036500             15  ASC-DFCT-WT-QTY           PIC  9(08).            03650099
036600             15  ASC-DFCT-WT-QTY-X         PIC  X(08).            03660099
036700             15  ASC-RET-RSN               PIC  X(01).            03670099
036800                 88 ASC-VALID-RET-RSN      VALUE '1' '2' '3'      03680099
036900                                                 '4' '5' '6'      03690099
037000                                                 '7' '8' '9'.     03700099
037100             15  ASC-PAYT-TYPE             PIC  X(01).            03710099
037200             15  ASC-TOTAL-COST            PIC  9(06)V99.         03720099
037300             15  ASC-TOTAL-COST-X          PIC  X(10).            03730099
037400             15  ASC-TOTAL-RETAIL          PIC  9(06)V99.         03740099
037500             15  ASC-TOTAL-RETAIL-X        PIC  X(10).            03750099
037600             15  ASC-OUTBND-CHRGS          PIC  9(06)V99.         03760099
037700             15  ASC-OUTBND-CHRGS-X        PIC  X(10).            03770099
037800             15  ASC-INBND-CHRGS           PIC  9(06)V99.         03780099
037900             15  ASC-INBND-CHRGS-X         PIC  X(10).            03790099
038000             15  ASC-DED-CHRG-AMT-X        PIC  X(10).            03800099
038100             15  ASC-DED-CHRG-AMT          PIC  9(06)V99.         03810099
038200             15  ASC-DED-CHRG-PCT          PIC  9(03)V99.         03820099
038300             15  ASC-DISC-PCT              PIC  9(03)V99.         03830099
038400             15  ASC-DISC-PCT-OLD          PIC  9(03)V99.         03840099
038500             15  ASC-DISC-PCT-X            PIC  X(10).            03850099
038600             15  ASC-DISC-AMT              PIC  9(06)V99.         03860099
038700             15  ASC-DISC-AMT-OLD          PIC  9(06)V99.         03870099
038800             15  ASC-DISC-AMT-X            PIC  X(10).            03880099
038900             15  ASC-GRAND-TOTAL           PIC  9(06)V99.         03890099
039000             15  ASC-GRAND-TOTAL-X         PIC  X(10).            03900099
039100             15  ASC-SPEC-INSTRUCTIONS.                           03910099
039200                 20 ASC-SPEC-INSTR-LINE-1  PIC  X(35).            03920099
039300                 20 ASC-SPEC-INSTR-LINE-2  PIC  X(65).            03930099
039400             15  ASC-BUYER                 PIC  X(15).            03940099
039500                                                                  03950099
039600*----------------------------------------------------------------*03960099
039700*    ABEND PROCESSING COPYBOOK.                                  *03970099
039800*----------------------------------------------------------------*03980099
039900     COPY DPWS013.                                                03990099
040000                                                                  04000099
040100                                                                  04010099
040200***  DB2 AREA FOR TDFCTOR TABLE                                   04020099
040300                                                                  04030099
040400     EXEC SQL                                                     04040099
040500          INCLUDE TDFCTOR                                         04050099
040600     END-EXEC.                                                    04060099
040700                                                                  04070099
040800***  DB2 AREA FOR TDFMEIT TABLE                                   04080099
040900                                                                  04090099
041000     EXEC SQL                                                     04100099
041100          INCLUDE TDFMEIT                                         04110099
041200     END-EXEC.                                                    04120099
041300                                                                  04130099
041400***  DB2 AREA FOR RVT_DFCT_SHIPT  TABLE                           04140099
041500                                                                  04150099
041600     EXEC SQL                                                     04160099
041700          INCLUDE RVT00000                                        04170099
041800     END-EXEC.                                                    04180099
041900                                                                  04190099
042000***  DB2 AREA FOR RVT_SHIPT_STAT TABLE                            04200099
042100                                                                  04210099
042200     EXEC SQL                                                     04220099
042300          INCLUDE RVT00001                                        04230099
042400     END-EXEC.                                                    04240099
042500                                                                  04250099
042600***  DB2 AREA FOR RVT_DFCT_STAT TABLE                             04260099
042700                                                                  04270099
042800     EXEC SQL                                                     04280099
042900          INCLUDE RVT00003                                        04290099
043000     END-EXEC.                                                    04300099
043100                                                                  04310099
043200***  DB2 AREA FOR VENDOR AGREEMENT TABLE                          04320099
043300                                                                  04330099
043400     EXEC SQL                                                     04340099
043500          INCLUDE TVNDAGR                                         04350099
043600     END-EXEC.                                                    04360099
043700                                                                  04370099
043800***  DB2 AREA FOR ENTITY NAME TABLE                               04380099
043900                                                                  04390099
044000     EXEC SQL                                                     04400099
044100          INCLUDE TENTNME                                         04410099
044200     END-EXEC.                                                    04420099
044300                                                                  04430099
044400***  DB2 AREA FOR EXTERNAL ENTITY TABLE                           04440099
044500                                                                  04450099
044600     EXEC SQL                                                     04460099
044700          INCLUDE TEXTENT                                         04470099
044800     END-EXEC.                                                    04480099
044900                                                                  04490099
045000***  DB2 AREA FOR FREIGHT TERMS TABLE                             04500099
045100                                                                  04510099
045200     EXEC SQL                                                     04520099
045300          INCLUDE TFRGTRM                                         04530099
045400     END-EXEC.                                                    04540099
045500                                                                  04550099
045600***  DB2 AREA FOR VENDOR DEPARTMENT TABLE                         04560099
045700                                                                  04570099
045800     EXEC SQL                                                     04580099
045900          INCLUDE TVNDDPT                                         04590099
046000     END-EXEC.                                                    04600099
046100                                                                  04610099
046200***  DB2 AREA FOR XLT_USR TABLE                                   04620099
046300                                                                  04630099
046400     EXEC SQL                                                     04640099
046500          INCLUDE XLT00024                                        04650099
046600     END-EXEC.                                                    04660099
046700                                                                  04670099
046800***  DB2 AREA FOR XLT_MDSE_INV_PARM (INVENTORY PARAMETERS) TABLE  04680099
046900                                                                  04690099
047000     EXEC SQL                                                     04700099
047100          INCLUDE XLT00025                                        04710099
047200     END-EXEC.                                                    04720099
047300                                                                  04730099
047400*    DB2 AREA FOR COMMUNICATIONS                                  04740099
047500                                                                  04750099
047600     EXEC SQL                                                     04760099
047700          INCLUDE SQLCA                                           04770099
047800     END-EXEC.                                                    04780099
047900                                                                  04790099
048000 LINKAGE SECTION.                                                 04800099
048100                                                                  04810099
048200 01  DFHCOMMAREA.                                                 04820099
048300     05  FILLER                         OCCURS  1 TO 4072 TIMES   04830099
048400                                        DEPENDING ON EIBCALEN.    04840099
048500         10  FILLER                     PIC X.                    04850099
048600                                                                  04860099
048700                                                                  04870099
048800 PROCEDURE DIVISION.                                              04880099
048900***************************************************************** 04890099
049000** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 04900099
049100** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 04910099
049200** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 04920099
049300**                                                             ** 04930099
049400** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 04940099
049500** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 04950099
049600***************************************************************** 04960099
049700 0000-MAIN-MODULE.                                                04970099
049800     INITIALIZE DP030-CICS-API-FIELDS.                            04980099
049900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04990099
050000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05000099
050100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05010099
050200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05020099
050300     MOVE LENGTH OF RV106AI        TO DP030-MAP-LENGTH (1).       05030099
050400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05040099
050500     PERFORM 0001-CALL-CICS-ARCH-API.                             05050099
050600*                                                                 05060099
050700     PERFORM 1000-CONTROL-PROCESSING                              05070099
050800*                                                                 05080099
050900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05090099
051000     PERFORM 0001-CALL-CICS-ARCH-API.                             05100099
051100                                                                  05110099
051200 0001-CALL-CICS-ARCH-API.                                         05120099
051300     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      05130099
051400                                    DFHCOMMAREA                   05140099
051500                                    DP030-CICS-API-FIELDS         05150099
051600                                    DP020-STANDARD-COMMAREA       05160099
051700                                    RV106AI.                      05170099
051800*                                                                 05180099
051900     IF  DP030-RC-CALL-SUCCESSFUL                                 05190099
052000         CONTINUE                                                 05200099
052100     ELSE                                                         05210099
052200         SET DP013-NO-ROLLBACK                                    05220099
052300             DP013-XCTL-DISPLAY-RESTART                           05230099
052400             DP013-CICS-ABEND      TO TRUE                        05240099
052500         MOVE 'BEFORE 0000-MAIN-MODULE'                           05250099
052600                                   TO DP013-PARAGRAPH             05260099
052610         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O05261099
052620-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      05262099
052900         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      05290099
053000         PERFORM DP013-0000-PROCESS-ABEND                         05300099
053100     END-IF.                                                      05310099
053200                                                                  05320099
053300*----------------------------------------------------------------*05330099
053400*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *05340099
053500*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *05350099
053600*----------------------------------------------------------------*05360099
053700 1000-CONTROL-PROCESSING.                                         05370099
053800     EVALUATE TRUE                                                05380099
053900         WHEN DP020-NEXT-ACT-INITIAL                              05390099
054000              INITIALIZE ASC-SPECIFIC-COMMAREA                    05400099
054100              PERFORM 1100-PROCESS-INTER-APPL-COMM                05410099
054200              IF PS-NO-ERROR                                      05420099
054300                  PERFORM 4000-BUILD-INITIAL-PANEL                05430099
054400                  IF SQLCODE = +100                               05440099
054500                      SET DP020-NEXT-ACT-APPL-ERROR TO TRUE       05450099
054600                      MOVE PC-TSYMSG-00148 TO DP020-MSG-NUMBER    05460099
054700                      SET DP020-MSG-INFORMATIONAL TO TRUE         05470099
054800                  END-IF                                          05480099
054900                  PERFORM 3200-RESET-ATTRIBUTES                   05490099
055000              END-IF                                              05500099
055100                                                                  05510099
055200         WHEN DP020-NEXT-ACT-READ-MAP                             05520099
055300             PERFORM 2000-PROCESS-PANEL                           05530099
055400                                                                  05540099
055500         WHEN DP020-NEXT-ACT-RETURN                               05550099
055600             MOVE DP020-INT-APPL-FORMAT-IND TO ASC-RETURN-FROM-SW 05560099
055700             EVALUATE TRUE                                        05570099
055800                 WHEN ASC-RETURN-FROM-SHIPT                       05580099
055900                     MOVE RV008-DFCT-SHIPT-ID  TO ASC-SHIP-ID     05590099
056000                     MOVE RV008-SCAC-CDE       TO ASC-SCAC        05600099
056100                     MOVE RV008-TRLR-ID        TO ASC-TRAILER-NBR 05610099
056200                     MOVE RV008-ACTL-SHIPT-DTE TO ASC-SHIP-DTE    05620099
056300                 WHEN ASC-VNTERMS                                 05630099
056400                     CONTINUE                                     05640099
056500             END-EVALUATE                                         05650099
056600                                                                  05660099
056700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05670099
056800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05680099
056900                                                                  05690099
057000         WHEN OTHER                                               05700099
057100             SET DP013-LOGIC-ABEND TO TRUE                        05710099
057200             SET DP013-NO-ROLLBACK TO TRUE                        05720099
057300             MOVE '1000-CONTROL-PROCESSING'                       05730099
057400                                   TO DP013-PARAGRAPH             05740099
057500             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   05750099
057600                                   TO DP013-MESSAGE-TEXT(1)       05760099
057700             MOVE DP020-NEXT-APPL-ACTIVITY                        05770099
057800                                   TO DP013-MESSAGE-TEXT(2)       05780099
057900             PERFORM DP013-0000-PROCESS-ABEND                     05790099
058000     END-EVALUATE.                                                05800099
058100                                                                  05810099
058200*----------------------------------------------------------------*05820099
058300* GET THE NECESSARY FIELDS FROM THE  INTER-APPL COMMAREA         *05830099
058400*----------------------------------------------------------------*05840099
058500 1100-PROCESS-INTER-APPL-COMM.                                    05850099
058600     EXEC SQL                                                     05860099
058700         SET :PV-CURRENT-TMST = CURRENT_TIMESTAMP                 05870099
058800     END-EXEC.                                                    05880099
058900     MOVE PV-CURRENT-TMST         TO PV-CUR-TMST.                 05890099
059000     MOVE PV-CURRENT-DT           TO PV-CURRENT-DATE.             05900099
059100     MOVE PV-CURRENT-DT-CCYY      TO PV-CUR-USA-DT-CCYY.          05910099
059200     MOVE PV-CURRENT-DT-MM        TO PV-CUR-USA-DT-MM.            05920099
059300     MOVE PV-CURRENT-DT-DD        TO PV-CUR-USA-DT-DD.            05930099
059400     MOVE PV-CURRENT-DATE-USA     TO ASC-CURRENT-DATE-USA.        05940099
059500                                                                  05950099
059600* ADD ONE DAY TO THE CURRENT DATE.  THIS DATE WILL BE USED IN     05960099
059700* THE VALIDATION OF THE SHIP DATE.                                05970099
059800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05980099
059900     SET DPG51-ACTUAL-CALENDAR-ONLY                               05990099
060000         DPG51-INCREMENT-DATE                                     06000099
060100                                  TO TRUE.                        06010099
060200     MOVE 1                       TO DPG51-INCR-DECR-DAYS-9.      06020099
060300     SET DPG52-LK-DTE-GREG-CC-FMT TO TRUE.                        06030099
060400     MOVE ASC-CURRENT-DATE-USA    TO DPG52-LK-DATE-INPUT.         06040099
060500     PERFORM 1200-DTE-RTN-ADD-ONE-DAY.                            06050099
060600                                                                  06060099
060700     MOVE RV100-RA-NUMBER         TO ASC-DFCT-ORD-ID.             06070099
060800     EVALUATE RV100-TYPE-CDE                                      06080099
060900         WHEN 'R'                                                 06090099
061000             MOVE 'RTV     '      TO ASC-LIST-TYPE                06100099
061100         WHEN 'D'                                                 06110099
061200             MOVE 'D & D   '      TO ASC-LIST-TYPE                06120099
061300     END-EVALUATE.                                                06130099
061400     MOVE RV100-TYPE-CDE          TO ASC-TYPE-CDE                 06140099
061500                                     ASC-TYPE-CDE-OLD.            06150099
061600     MOVE RV100-LOCATION          TO ASC-LOCATION.                06160099
061700     MOVE RV100-VENDOR-NAME       TO ASC-VENDOR-NAME.             06170099
061800     MOVE RV100-DEPT-NUMBER       TO ASC-DEPT-NBR                 06180099
061900                                     DK-DEPT-NBR.                 06190099
062000     MOVE RV100-ENT-ID            TO ASC-ENT-ID                   06200099
062100                                     DK-ENT-ID.                   06210099
062200     MOVE RV100-TOTAL-RETAIL      TO ASC-TOTAL-RETAIL.            06220099
062300     MOVE RV100-TOTAL-COST        TO ASC-TOTAL-COST.              06230099
062400                                                                  06240099
062500     EVALUATE RV100-STATUS-CDE                                    06250099
062600         WHEN 'N'                                                 06260099
062700             MOVE 'NEW     '      TO ASC-STATUS                   06270099
062800         WHEN 'O'                                                 06280099
062900             MOVE 'OPEN    '      TO ASC-STATUS                   06290099
063000         WHEN 'C'                                                 06300099
063100             MOVE 'CLOSED  '      TO ASC-STATUS                   06310099
063200         WHEN 'P'                                                 06320099
063300             MOVE 'PENDING '      TO ASC-STATUS                   06330099
063400         WHEN 'S'                                                 06340099
063500             MOVE 'SHIPPED '      TO ASC-STATUS                   06350099
063600         WHEN 'A'                                                 06360099
063700             MOVE 'APPROVED'      TO ASC-STATUS                   06370099
063800         WHEN 'D'                                                 06380099
063900             MOVE 'D & D   '      TO ASC-STATUS                   06390099
064000     END-EVALUATE.                                                06400099
064100     MOVE RV100-STATUS-CDE        TO ASC-STAT-CDE                 06410099
064200                                     ASC-STAT-CDE-OLD.            06420099
064300                                                                  06430099
064400******************************************************************06440099
064500*  CALL THE DATE ROUTINE TO ADD 1 DAY TO THE CURRENT DATE.       *06450099
064600******************************************************************06460099
064700 1200-DTE-RTN-ADD-ONE-DAY.                                        06470099
064800     CALL DP500-KOHLS-CALENDAR-ROUTINE                            06480099
064900             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.           06490099
065000                                                                  06500099
065100     IF DPG54-NO-ERROR                                            06510099
065200         MOVE DPG55-GREG-CC-DATE-FMT                              06520099
065300                                  TO ASC-CURRENT-DATE-PLUS-ONE-DAY06530099
065400     ELSE                                                         06540099
065500         IF (DPG54-DATE-INVALID                                   06550099
065600           OR DPG54-SEVERE-ERROR)                                 06560099
065700             SET PS-ERROR                                         06570099
065800                 DP020-MSG-FATAL             TO TRUE              06580099
065900             MOVE PC-TSYMSG-00009            TO DP020-MSG-NUMBER  06590099
066000             MOVE DP015-UNP-ALP-BRT-MDT      TO ASHPDTEA          06600099
066100             MOVE DP015-RED                  TO ASHPDTEC          06610099
066200             MOVE DP015-REVERSE              TO ASHPDTEH          06620099
066300             MOVE -1                         TO ASHPDTEL          06630099
066400             SET DP030-SET-CURSOR-APPL-1     TO TRUE              06640099
066500         END-IF                                                   06650099
066600     END-IF.                                                      06660099
066700                                                                  06670099
066800*----------------------------------------------------------------*06680099
066900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *06690099
067000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *06700099
067100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *06710099
067200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *06720099
067300* FUNCTION KEYS CAN GET THIS FAR.                                *06730099
067400*----------------------------------------------------------------*06740099
067500 2000-PROCESS-PANEL.                                              06750099
067600     EVALUATE TRUE                                                06760099
067700         WHEN DP020-SRC-AID = DP016-CLEAR                         06770099
067800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06780099
067900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06790099
068000         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     06800099
068100             SET DP030-DONT-ERASE                                 06810099
068200                 DP030-SEND-DATAONLY (PC-APPL-MAP) TO TRUE        06820099
068300             PERFORM 4000-BUILD-INITIAL-PANEL                     06830099
068400             PERFORM 3200-RESET-ATTRIBUTES                        06840099
068500         WHEN OTHER                                               06850099
068600             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 06860099
068700             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   06870099
068800             IF  PS-NO-ERROR                                      06880099
068900                 SET DP030-CONTINUE-GO TO TRUE                    06890099
069000                 PERFORM 2100-CHECK-FUNCTION-KEY                  06900099
069100             ELSE                                                 06910099
069200                 SET DP030-OVERRIDE-GO TO TRUE                    06920099
069300             END-IF                                               06930099
069400     END-EVALUATE.                                                06940099
069500                                                                  06950099
069600*----------------------------------------------------------------*06960099
069700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *06970099
069800* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *06980099
069900* FROM THE CICS ARCHITECTURE API.                                *06990099
070000*----------------------------------------------------------------*07000099
070100 2100-CHECK-FUNCTION-KEY.                                         07010099
070200     EVALUATE TRUE                                                07020099
070300* - ENTER KEY                                                     07030099
070400         WHEN DP020-SRC-AID = DP016-ENTER                         07040099
070500             SET DP030-CONTINUE-GO TO TRUE                        07050099
070600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07060099
070700* - F2 - CONFIRM                                                  07070099
070800         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    07080099
070900             SET DP030-CONTINUE-GO TO TRUE                        07090099
071000             IF ASC-CONFIRM                                       07100099
071100                 EVALUATE TRUE                                    07110099
071200                     WHEN ASC-RTV-TO-DND                          07120099
071300                     WHEN ASC-DND-TO-RTV                          07130099
071400                         PERFORM 3710-CHANGE-LIST-TYPE            07140099
071500                         IF ASC-DND-TO-RTV                        07150099
071600                             PERFORM 5200-UPD-TDFCTOR-TO-RTV-LIST 07160099
071700                         ELSE                                     07170099
071800* WHEN SWITCHING FROM RTV TO DND, THE AUTH ID AND AUTH DATE VALUES07180099
071900* MUST HAVE BEEN SAVED TO THE RTV HEADER TABLE, TDFCTOR.  IF THEY 07190099
072000* HAVE NOT BEEN SAVED, DISPLAY AN ERROR MESSAGE AND DO NOT ALLOW  07200099
072100* THE SWITCH.                                                     07210099
072200                            IF ASC-RTV-TO-DND                     07220099
072300                                PERFORM 5240-CHECK-AUTH-ID-DATE   07230099
072400                                IF PS-UPDATE-OK                   07240099
072500                                    PERFORM                       07250099
072600                                      5250-UPD-TDFCTOR-TO-DND-LIST07260099
072700                                ELSE                              07270099
072800                                    SET ASC-RESET-CHG-STATUS      07280099
072900                                        ASC-RTV-STAT-C            07290099
073000                                        ASC-RTV-TYP    TO TRUE    07300099
073100                                    MOVE 'CLOSED' TO ASC-STATUS   07310099
073200                                    MOVE 'RTV'    TO ASC-LIST-TYPE07320099
073300                                    SET PS-ERROR                  07330099
073400                                        DP020-MSG-FATAL           07340099
073500                                                       TO TRUE    07350099
073600                                    MOVE PC-TSYMSG-03242          07360099
073700                                                       TO         07370099
073800                                                  DP020-MSG-NUMBER07380099
073900                                    MOVE DP015-UNP-ALP-BRT-MDT    07390099
074000                                                       TO AAUTHIDA07400099
074100                                                          AAUTHDTA07410099
074200                                    MOVE DP015-RED     TO AAUTHIDC07420099
074300                                                          AAUTHDTC07430099
074400                                    MOVE DP015-REVERSE TO AAUTHIDH07440099
074500                                                          AAUTHDTH07450099
074600                                    MOVE -1            TO AAUTHIDL07460099
074700                                    SET DP030-SET-CURSOR-APPL-1   07470099
074800                                                       TO TRUE    07480099
074900                                END-IF                            07490099
075000                            END-IF                                07500099
075100                         END-IF                                   07510099
075200                         IF PS-UPDATE-OK                          07520099
075300*----------  CONTINUE WITH UPDATE TO STATUS TABLE                 07530099
075400                             MOVE ASC-DFCT-ORD-ID TO              07540099
075500                                      RVT00003-DFCT-ORD-ID        07550099
075600                             MOVE ASC-STAT-CDE    TO              07560099
075700                                      RVT00003-DFCT-ORD-STAT-CDE  07570099
075800                             MOVE DP020-USERID    TO              07580099
075900                                      RVT00003-USR-ID             07590099
076000                             PERFORM 5300-INSERT-DFCT-STAT        07600099
076100                         END-IF                                   07610099
076200*----------  UPDATES SUCCESSFUL                                   07620099
076300                         IF PS-UPDATE-OK                          07630099
076400                             SET DP030-CONTINUE-GO      TO TRUE   07640099
076500                             MOVE PC-TSYMSG-00059       TO        07650099
076600                                      DP020-MSG-NUMBER            07660099
076700                             SET DP020-MSG-INFORMATIONAL TO TRUE  07670099
076800                             PERFORM 8900-SYNCPOINT               07680099
076900                             PERFORM 4000-BUILD-INITIAL-PANEL     07690099
077000                             PERFORM 3200-RESET-ATTRIBUTES        07700099
077100                         ELSE                                     07710099
077200                             PERFORM 8950-SYNCPOINT-ROLLBACK      07720099
077300                             SET PS-ERROR                         07730099
077400                                 DP020-MSG-FATAL                  07740099
077500                                 DP013-DB2-ABEND  TO TRUE         07750099
077600                             MOVE DP015-UNP-ALP-BRT-MDT TO        07760099
077700                                      AAUTHIDA                    07770099
077800                             MOVE DP015-RED       TO AAUTHIDC     07780099
077900                             MOVE DP015-REVERSE   TO AAUTHIDH     07790099
078000                             MOVE -1              TO AAUTHIDL     07800099
078100                             SET DP030-SET-CURSOR-APPL-1 TO TRUE  07810099
078200                         END-IF                                   07820099
078300                                                                  07830099
078400                     WHEN ASC-SHIP-TO-DND                         07840099
078500                     WHEN ASC-SHIP-TO-RTV                         07850099
078600                         MOVE PC-TSYMSG-03160 TO                  07860099
078700                                      DP020-MSG-NUMBER            07870099
078800                         SET DP020-MSG-INFORMATIONAL TO TRUE      07880099
078900                     WHEN ASC-SHIP-TO-UNSHIP                      07890099
079000*----------  CHECK FOR MORE THAN 1 LISTING ON A SHIPMENT          07900099
079100*----------    IF ONLY 1, DEL SHIPT, ELSE DON'T DELETE SHIPT TBLS 07910099
079200*----------    CHANGE STATUS:   RTV ==> C, DND ==> D              07920099
079300                         PERFORM 3720-UNSHIP-LISTING              07930099
079400                         IF PS-UPDATE-OK                          07940099
079500                             PERFORM 5750-UPD-DFCT-SHIPT-ID       07950099
079600                         END-IF                                   07960099
079700                         IF PS-UPDATE-OK                          07970099
079800                             MOVE ASC-DFCT-ORD-ID TO              07980099
079900                                      RVT00003-DFCT-ORD-ID        07990099
080000                             MOVE ASC-STAT-CDE    TO              08000099
080100                                      RVT00003-DFCT-ORD-STAT-CDE  08010099
080200                             MOVE DP020-USERID    TO              08020099
080300                                      RVT00003-USR-ID             08030099
080400                             PERFORM 5300-INSERT-DFCT-STAT        08040099
080500                         END-IF                                   08050099
080600                         IF PS-DELETE-SHIPMENT AND                08060099
080700                            PS-UPDATE-OK                          08070099
080800                             PERFORM 5700-DEL-DFCT-SHIPT          08080099
080900                         END-IF                                   08090099
081000*----------  UPDATES SUCCESSFUL ---                               08100099
081100                         IF PS-UPDATE-OK                          08110099
081200                             SET DP030-CONTINUE-GO      TO TRUE   08120099
081300                             MOVE PC-TSYMSG-00059       TO        08130099
081400                                      DP020-MSG-NUMBER            08140099
081500                             SET DP020-MSG-INFORMATIONAL TO TRUE  08150099
081600                             PERFORM 8900-SYNCPOINT               08160099
081700                             MOVE SPACES TO ASC-SHIPPED-BY        08170099
081800                                            ASC-TRACKING-NBR      08180099
081900                             PERFORM 4000-BUILD-INITIAL-PANEL     08190099
082000                             PERFORM 3200-RESET-ATTRIBUTES        08200099
082100                         ELSE                                     08210099
082200                             PERFORM 8950-SYNCPOINT-ROLLBACK      08220099
082300                             SET PS-ERROR                         08230099
082400                                 DP020-MSG-FATAL                  08240099
082500                                 DP013-DB2-ABEND  TO TRUE         08250099
082600                             MOVE PC-TSYMSG-03160 TO              08260099
082700                                      DP020-MSG-NUMBER            08270099
082800                             MOVE DP015-UNP-ALP-BRT-MDT TO        08280099
082900                                      AAUTHIDA                    08290099
083000                             MOVE DP015-RED       TO AAUTHIDC     08300099
083100                             MOVE DP015-REVERSE   TO AAUTHIDH     08310099
083200                             MOVE -1              TO AAUTHIDL     08320099
083300                             SET DP030-SET-CURSOR-APPL-1 TO TRUE  08330099
083400                         END-IF                                   08340099
083500                 END-EVALUATE                                     08350099
083600             END-IF                                               08360099
083700* - PF 15 -- UPDATE                                               08370099
083800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08380099
083900             SET PS-ROLLBACK-NOT-NEEDED                           08390099
084000                 DP030-CONTINUE-GO TO TRUE                        08400099
084100             IF ASC-RTV-TYP                                       08410099
084200                 IF ASC-SHIPT-ID-FOUND                            08420099
084300                     IF ASC-RTV-STAT-C OR ASC-RTV-STAT-S          08430099
084400*** WE CANNOT ALLOW LISTINGS TO BE SHIPPED ON A SCHEDULED         08440099
084500*** INVENTORY DATE.  THE WAY WE CAN CHECK FOR THIS IS TO SEE IF   08450099
084600*** THERE IS A ROW OUT ON XLT_MDSE_INV_PARM WITH A PLANNED        08460099
084700*** INVENTORY DATE EQUAL TO THE ENTERED SHIP DATE.  IF THERE IS A 08470099
084800*** ROW, WE NEED TO DISPLAY A MESSAGE AND NOT ALLOW THE LISTING TO08480099
084900*** BE SHIPPED.                                                   08490099
085000                         IF  ASC-SHIP-DTE = SPACES                08500099
085100                             MOVE ASC-CURRENT-DATE-USA            08510099
085200                                              TO PV-DATE-USA      08520099
085300                         ELSE                                     08530099
085400                             MOVE ASC-SHIP-DTE                    08540099
085500                                              TO PV-DATE-USA      08550099
085600                         END-IF                                   08560099
085700                         MOVE PV-DATE-USA-MM  TO PV-CMPR-USA-DT-MM08570099
085800                         MOVE PV-DATE-USA-DD  TO PV-CMPR-USA-DT-DD08580099
085900                         MOVE PV-DATE-USA-CCYY                    08590099
086000                                              TO                  08600099
086100                                               PV-CMPR-USA-DT-CCYY08610099
086200                         MOVE '/'             TO                  08620099
086300                                            PV-CMPR-USA-DT-SLASH-108630099
086400                                            PV-CMPR-USA-DT-SLASH-208640099
086500                         PERFORM 3560-CHECK-INVENTORY-DATE        08650099
086600                         IF PS-DATA-FOUND                         08660099
086700                             SET DP020-MSG-FATAL                  08670099
086800                                 PS-UPDATE-NOT-OK                 08680099
086900                                 PS-ROLLBACK-NOT-NEEDED           08690099
087000                                 PS-ERROR     TO TRUE             08700099
087100                             MOVE PC-TSYMSG-03272                 08710099
087200                                              TO DP020-MSG-NUMBER 08720099
087300                             MOVE XLT00025-PLND-INV-DTE           08730099
087400                                              TO DP020-MSG-TEXT   08740099
087500                             MOVE DP015-UNP-ALP-BRT-MDT           08750099
087600                                              TO ASHPDTEA         08760099
087700                             MOVE DP015-RED   TO ASHPDTEC         08770099
087800                             MOVE DP015-REVERSE                   08780099
087900                                              TO ASHPDTEH         08790099
088000                             INITIALIZE AAUTHIDL                  08800099
088100                             MOVE -1          TO ASHPDTEL         08810099
088200                             SET DP030-SET-CURSOR-APPL-1          08820099
088300                                              TO TRUE             08830099
088400                         END-IF                                   08840099
088500                         IF PS-UPDATE-OK                          08850099
088600                             PERFORM 5500-UPD-DFCT-SHIPT          08860099
088700                         END-IF                                   08870099
088800                         IF PS-UPDATE-OK                          08880099
088900                             PERFORM 5000-UPD-TDFCTOR-RTV         08890099
089000                         END-IF                                   08900099
089100                     ELSE                                         08910099
089200                         IF ASC-RTV-STAT-A                        08920099
089300                             PERFORM 5950-UPD-COMMENTS-ONLY       08930099
089400                         END-IF                                   08940099
089500                     END-IF                                       08950099
089600                 ELSE                                             08960099
089700                     IF ASC-RTV-STAT-C OR ASC-RTV-STAT-S          08970099
089800                         PERFORM 5000-UPD-TDFCTOR-RTV             08980099
089900                     ELSE                                         08990099
090000                         IF ASC-RTV-STAT-A                        09000099
090100                             PERFORM 5950-UPD-COMMENTS-ONLY       09010099
090200                         END-IF                                   09020099
090300                     END-IF                                       09030099
090400                 END-IF                                           09040099
090500             ELSE                                                 09050099
090600                 IF ASC-DND-STAT-S                                09060099
090700*** WE CANNOT ALLOW LISTINGS TO BE SHIPPED ON A SCHEDULED         09070099
090800*** INVENTORY DATE.  THE WAY WE CAN CHECK FOR THIS IS TO SEE IF   09080099
090900*** THERE IS A ROW OUT ON XLT_MDSE_INV_PARM WITH A PLANNED        09090099
091000*** INVENTORY DATE EQUAL TO THE ENTERED SHIP DATE.  IF THERE IS A 09100099
091100*** ROW, WE NEED TO DISPLAY A MESSAGE AND NOT ALLOW THE LISTING TO09110099
091200*** BE SHIPPED.                                                   09120099
091300                     IF  ASC-SHIP-DTE = SPACES                    09130099
091400                         MOVE ASC-CURRENT-DATE-USA                09140099
091500                                              TO PV-DATE-USA      09150099
091600                     ELSE                                         09160099
091700                         MOVE ASC-SHIP-DTE    TO PV-DATE-USA      09170099
091800                     END-IF                                       09180099
091900                     MOVE PV-DATE-USA-MM      TO PV-CMPR-USA-DT-MM09190099
092000                     MOVE PV-DATE-USA-DD      TO PV-CMPR-USA-DT-DD09200099
092100                     MOVE PV-DATE-USA-CCYY    TO                  09210099
092200                                               PV-CMPR-USA-DT-CCYY09220099
092300                     MOVE '/'                 TO                  09230099
092400                                            PV-CMPR-USA-DT-SLASH-109240099
092500                                            PV-CMPR-USA-DT-SLASH-209250099
092600                     PERFORM 3560-CHECK-INVENTORY-DATE            09260099
092700                     IF PS-DATA-FOUND                             09270099
092800                         SET DP020-MSG-FATAL                      09280099
092900                             PS-UPDATE-NOT-OK                     09290099
093000                             PS-ROLLBACK-NOT-NEEDED               09300099
093100                             PS-ERROR         TO TRUE             09310099
093200                         MOVE PC-TSYMSG-03272 TO DP020-MSG-NUMBER 09320099
093300                         MOVE XLT00025-PLND-INV-DTE               09330099
093400                                              TO DP020-MSG-TEXT   09340099
093500                         MOVE DP015-UNP-ALP-BRT-MDT               09350099
093600                                              TO ASHPDTEA         09360099
093700                         MOVE DP015-RED       TO ASHPDTEC         09370099
093800                         MOVE DP015-REVERSE   TO ASHPDTEH         09380099
093900                         INITIALIZE AAUTHIDL                      09390099
094000                         MOVE -1              TO ASHPDTEL         09400099
094100                         SET DP030-SET-CURSOR-APPL-1              09410099
094200                                              TO TRUE             09420099
094300                     END-IF                                       09430099
094400                     IF PS-UPDATE-OK                              09440099
094500                         PERFORM 5500-UPD-DFCT-SHIPT              09450099
094600                     END-IF                                       09460099
094700                     IF PS-UPDATE-OK                              09470099
094800                         PERFORM 5100-UPD-TDFCTOR-DND             09480099
094900                     END-IF                                       09490099
095000                 ELSE                                             09500099
095100                     IF ASC-DND-STAT-D                            09510099
095200                         PERFORM 5100-UPD-TDFCTOR-DND             09520099
095300                     ELSE                                         09530099
095400                         IF ASC-DND-STAT-A                        09540099
095500                             PERFORM 5950-UPD-COMMENTS-ONLY       09550099
095600                         END-IF                                   09560099
095700                     END-IF                                       09570099
095800                 END-IF                                           09580099
095900             END-IF                                               09590099
096000*----------  UPDATES SUCCESSFUL ---                               09600099
096100             IF PS-UPDATE-OK                                      09610099
096200                 MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER         09620099
096300                 SET DP020-MSG-INFORMATIONAL TO TRUE              09630099
096400                 PERFORM 8900-SYNCPOINT                           09640099
096500                 PERFORM 4000-BUILD-INITIAL-PANEL                 09650099
096600                 PERFORM 3200-RESET-ATTRIBUTES                    09660099
096700             ELSE                                                 09670099
096800                 IF PS-ROLLBACK-NEEDED                            09680099
096900                     PERFORM 8950-SYNCPOINT-ROLLBACK              09690099
097000                     SET PS-ERROR         TO TRUE                 09700099
097100                     SET DP020-MSG-FATAL  TO TRUE                 09710099
097200                     MOVE PC-TSYMSG-03160 TO DP020-MSG-NUMBER     09720099
097300                     MOVE DP015-UNP-ALP-BRT-MDT TO AAUTHIDA       09730099
097400                     MOVE DP015-RED       TO AAUTHIDC             09740099
097500                     MOVE DP015-REVERSE   TO AAUTHIDH             09750099
097600                     MOVE -1              TO AAUTHIDL             09760099
097700                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          09770099
097800                 END-IF                                           09780099
097900             END-IF                                               09790099
098000* - PF 17 -- VNTERMS - INQUIRE ON VENDOR TERMS                    09800099
098100         WHEN DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)              09810099
098200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 09820099
098300             SET ASC-VNTERMS       TO TRUE                        09830099
098400             MOVE ASC-DEPT-NBR     TO VN001-DEPARTMENT-NUMBER     09840099
098500             MOVE ASC-INHOUSE-NBR  TO VN001-INHOUSE-NUMBER        09850099
098600             MOVE ASC-VENDOR-NAME  TO VN001-VENDOR-NAME           09860099
098700             SET DP030-CONTINUE-GO TO TRUE                        09870099
098800* - PF 20 -- SELSHIP -- SELECT SHIPMENT -- USED WHEN SELECTING    09880099
098900*              AN EXISTING SHIPMENT TO ADD A NEW LISTING          09890099
099000         WHEN DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID)              09900099
099100                 INITIALIZE RV008-INTER-APPL-COMMAREA             09910099
099200                 MOVE ASC-DFCT-ORD-ID   TO RV008-DFCT-ORD-ID      09920099
099300                 MOVE ASC-STAT-CDE      TO RV008-DFCT-ORD-STAT-CDE09930099
099400                 SET DP030-CONTINUE-GO       TO TRUE              09940099
099500* - PF 21 -- UNSHIP -- REMOVE A LISTING SHIPPED IN ERROR          09950099
099600         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              09960099
099700             EVALUATE TRUE                                        09970099
099800                 WHEN ASC-RTV-STAT-S                              09980099
099900                 WHEN ASC-DND-STAT-S                              09990099
100000                     MOVE PC-TSYMSG-03198 TO DP020-MSG-NUMBER     10000099
100100                     SET ASC-CONFIRM                              10010099
100200                         ASC-SHIP-TO-UNSHIP                       10020099
100300                         DP020-MSG-WARNING TO TRUE                10030099
100400                 WHEN OTHER                                       10040099
100500                     SET ASC-NO-CONFIRM                           10050099
100600                         DP020-MSG-WARNING TO TRUE                10060099
100700                     MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER     10070099
100800             END-EVALUATE                                         10080099
100900* - PF 22 -- SHIP                                                 10090099
101000*** DISPLAY A MESSAGE IF THIS KEY IS PRESSED AND THE LISTING IS   10100099
101100*** ALREADY SHIPPED OR APPROVED.                                  10110099
101200         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              10120099
101300             IF ASC-DND-STAT-S OR                                 10130099
101400                ASC-DND-STAT-A OR                                 10140099
101500                ASC-RTV-STAT-S OR                                 10150099
101600                ASC-RTV-STAT-A                                    10160099
101700                 SET PS-ERROR     TO TRUE                         10170099
101800                 SET DP020-MSG-FATAL TO TRUE                      10180099
101900                 MOVE PC-TSYMSG-03202 TO DP020-MSG-NUMBER         10190099
102000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10200099
102100             ELSE                                                 10210099
102200                 SET DP030-CONTINUE-GO        TO TRUE             10220099
102300                 IF ASC-RTV-TYP                                   10230099
102400*** WE CANNOT ALLOW RTV LISTINGS TO BE SHIPPED ON A SCHEDULED     10240099
102500*** INVENTORY DATE.  THE WAY WE CAN CHECK FOR THIS IS TO SEE IF   10250099
102600*** THERE IS A ROW OUT ON XLT_MDSE_INV_PARM WITH A PLANNED        10260099
102700*** INVENTORY DATE EQUAL TO THE ENTERED SHIP DATE.  IF THERE IS A 10270099
102800*** ROW, WE NEED TO DISPLAY A MESSAGE AND NOT ALLOW THE LISTING TO10280099
102900*** BE SHIPPED.                                                   10290099
103000                     IF  ASC-SHIP-DTE = SPACES                    10300099
103100                         MOVE ASC-CURRENT-DATE-USA                10310099
103200                                              TO PV-DATE-USA      10320099
103300                     ELSE                                         10330099
103400                         MOVE ASC-SHIP-DTE                        10340099
103500                                              TO PV-DATE-USA      10350099
103600                     END-IF                                       10360099
103700                     MOVE PV-DATE-USA-MM      TO PV-CMPR-USA-DT-MM10370099
103800                     MOVE PV-DATE-USA-DD      TO PV-CMPR-USA-DT-DD10380099
103900                     MOVE PV-DATE-USA-CCYY    TO                  10390099
104000                                               PV-CMPR-USA-DT-CCYY10400099
104100                     MOVE '/'                 TO                  10410099
104200                                            PV-CMPR-USA-DT-SLASH-110420099
104300                                            PV-CMPR-USA-DT-SLASH-210430099
104400                     PERFORM 3560-CHECK-INVENTORY-DATE            10440099
104500                     IF PS-DATA-FOUND                             10450099
104600                         SET DP020-MSG-FATAL                      10460099
104700                             PS-UPDATE-NOT-OK                     10470099
104800                             PS-ERROR     TO TRUE                 10480099
104900                         MOVE PC-TSYMSG-03272 TO DP020-MSG-NUMBER 10490099
105000                         MOVE XLT00025-PLND-INV-DTE               10500099
105100                                              TO DP020-MSG-TEXT   10510099
105200                         MOVE DP015-UNP-ALP-BRT-MDT               10520099
105300                                              TO ASHPDTEA         10530099
105400                         MOVE DP015-RED       TO ASHPDTEC         10540099
105500                         MOVE DP015-REVERSE                       10550099
105600                                              TO ASHPDTEH         10560099
105700                         INITIALIZE AAUTHIDL                      10570099
105800                         MOVE -1              TO ASHPDTEL         10580099
105900                         SET DP030-SET-CURSOR-APPL-1              10590099
106000                                              TO TRUE             10600099
106100                     END-IF                                       10610099
106200*** CHECK IF THE CURRENT DATE IS THE SAME AS THE SCHEDULED        10620099
106300*** INVENTORY DATE.  IF IT IS, DO NOT ALLOW A SHIP DATE TO BE     10630099
106400*** ENTERED THAT IS GREATER THAN THE CURRENT DATE FOR THIS RTV    10640099
106500*** LISTING.                                                      10650099
106600                     IF PS-UPDATE-OK                              10660099
106700                         MOVE ASC-CURRENT-DATE-USA                10670099
106800                                              TO PV-DATE-USA      10680099
106900                         MOVE PV-DATE-USA-MM  TO PV-CMPR-USA-DT-MM10690099
107000                         MOVE PV-DATE-USA-DD  TO PV-CMPR-USA-DT-DD10700099
107100                         MOVE PV-DATE-USA-CCYY                    10710099
107200                                              TO                  10720099
107300                                               PV-CMPR-USA-DT-CCYY10730099
107400                         MOVE '/'             TO                  10740099
107500                                            PV-CMPR-USA-DT-SLASH-110750099
107600                                            PV-CMPR-USA-DT-SLASH-210760099
107700                         PERFORM 3560-CHECK-INVENTORY-DATE        10770099
107800                         IF PS-DATA-FOUND                         10780099
107900                             IF (ASC-SHIP-DTE =                   10790099
108000                                 ASC-CURRENT-DATE-PLUS-ONE-DAY)   10800099
108100                                 SET DP020-MSG-FATAL              10810099
108200                                     PS-UPDATE-NOT-OK             10820099
108300                                     PS-ERROR                     10830099
108400                                              TO TRUE             10840099
108500                                 MOVE PC-TSYMSG-03272             10850099
108600                                              TO DP020-MSG-NUMBER 10860099
108700                                 MOVE XLT00025-PLND-INV-DTE       10870099
108800                                              TO DP020-MSG-TEXT   10880099
108900                                 MOVE DP015-UNP-ALP-BRT-MDT       10890099
109000                                              TO ASHPDTEA         10900099
109100                                 MOVE DP015-RED                   10910099
109200                                              TO ASHPDTEC         10920099
109300                                 MOVE DP015-REVERSE               10930099
109400                                              TO ASHPDTEH         10940099
109500                                 INITIALIZE AAUTHIDL              10950099
109600                                 MOVE -1      TO ASHPDTEL         10960099
109700                                 SET DP030-SET-CURSOR-APPL-1      10970099
109800                                              TO TRUE             10980099
109900                             END-IF                               10990099
110000                         END-IF                                   11000099
110100                     END-IF                                       11010099
110200                     IF PS-UPDATE-OK                              11020099
110300                         PERFORM 3600-PREPARE-RTV-INFO            11030099
110400                     END-IF                                       11040099
110500                     IF PS-UPDATE-OK                              11050099
110600                         MOVE ASC-DFCT-ORD-ID TO                  11060099
110700                                      RVT00003-DFCT-ORD-ID        11070099
110800                         MOVE ASC-STAT-CDE    TO                  11080099
110900                                      RVT00003-DFCT-ORD-STAT-CDE  11090099
111000                         MOVE DP020-USERID    TO                  11100099
111100                                      RVT00003-USR-ID             11110099
111200                         PERFORM 5300-INSERT-DFCT-STAT            11120099
111300                     END-IF                                       11130099
111400                     IF PS-UPDATE-OK                              11140099
111500                         PERFORM 5400-INSERT-DFCT-SHIPT           11150099
111600                         IF  PS-INSERT-SHIP-STAT                  11160099
111700                             PERFORM 5600-INSERT-SHIPT-STAT       11170099
111800                         END-IF                                   11180099
111900                     END-IF                                       11190099
112000                     IF PS-UPDATE-OK                              11200099
112100                         PERFORM 5000-UPD-TDFCTOR-RTV             11210099
112200                     END-IF                                       11220099
112300*                --- UPDATES SUCCESSFUL ---                       11230099
112400                     IF PS-UPDATE-OK                              11240099
112500                         MOVE PC-TSYMSG-00059 TO                  11250099
112600                                         DP020-MSG-NUMBER         11260099
112700                         SET DP020-MSG-INFORMATIONAL TO TRUE      11270099
112800                         PERFORM 8900-SYNCPOINT                   11280099
112900                         PERFORM 4000-BUILD-INITIAL-PANEL         11290099
113000                         PERFORM 3200-RESET-ATTRIBUTES            11300099
113100                     ELSE                                         11310099
113200                         PERFORM 8950-SYNCPOINT-ROLLBACK          11320099
113300                         INITIALIZE AAUTHIDL                      11330099
113400                         SET PS-ERROR                             11340099
113500                             DP020-MSG-FATAL                      11350099
113600                             DP030-SET-CURSOR-APPL-1 TO TRUE      11360099
113700                     END-IF                                       11370099
113800                 ELSE                                             11380099
113900                     IF ASC-DND-TYP                               11390099
114000*** WE CANNOT ALLOW D-N-D LISTINGS TO BE SHIPPED ON A SCHEDULED   11400099
114100*** INVENTORY DATE.  THE WAY WE CAN CHECK FOR THIS IS TO SEE IF   11410099
114200*** THERE IS A ROW OUT ON XLT_MDSE_INV_PARM WITH A PLANNED        11420099
114300*** INVENTORY DATE EQUAL TO THE ENTERED SHIP DATE.  IF THERE IS A 11430099
114400*** ROW, WE NEED TO DISPLAY A MESSAGE AND NOT ALLOW THE LISTING TO11440099
114500*** BE SHIPPED.                                                   11450099
114600                         IF  ASC-SHIP-DTE = SPACES                11460099
114700                             MOVE ASC-CURRENT-DATE-USA            11470099
114800                                              TO PV-DATE-USA      11480099
114900                         ELSE                                     11490099
115000                             MOVE ASC-SHIP-DTE                    11500099
115100                                              TO PV-DATE-USA      11510099
115200                         END-IF                                   11520099
115300                         MOVE PV-DATE-USA-MM  TO PV-CMPR-USA-DT-MM11530099
115400                         MOVE PV-DATE-USA-DD  TO PV-CMPR-USA-DT-DD11540099
115500                         MOVE PV-DATE-USA-CCYY                    11550099
115600                                              TO                  11560099
115700                                               PV-CMPR-USA-DT-CCYY11570099
115800                         MOVE '/'             TO                  11580099
115900                                            PV-CMPR-USA-DT-SLASH-111590099
116000                                            PV-CMPR-USA-DT-SLASH-211600099
116100                         PERFORM 3560-CHECK-INVENTORY-DATE        11610099
116200                         IF PS-DATA-FOUND                         11620099
116300                             SET DP020-MSG-FATAL                  11630099
116400                                 PS-UPDATE-NOT-OK                 11640099
116500                                 PS-ROLLBACK-NOT-NEEDED           11650099
116600                                 PS-ERROR     TO TRUE             11660099
116700                             MOVE PC-TSYMSG-03272                 11670099
116800                                              TO DP020-MSG-NUMBER 11680099
116900                             MOVE XLT00025-PLND-INV-DTE           11690099
117000                                              TO DP020-MSG-TEXT   11700099
117100                             MOVE DP015-UNP-ALP-BRT-MDT           11710099
117200                                              TO ASHPDTEA         11720099
117300                             MOVE DP015-RED   TO ASHPDTEC         11730099
117400                             MOVE DP015-REVERSE                   11740099
117500                                              TO ASHPDTEH         11750099
117600                             INITIALIZE AAUTHIDL                  11760099
117700                             MOVE -1          TO ASHPDTEL         11770099
117800                             SET DP030-SET-CURSOR-APPL-1          11780099
117900                                              TO TRUE             11790099
118000                         END-IF                                   11800099
118100*** CHECK IF THE CURRENT DATE IS THE SAME AS THE SCHEDULED        11810099
118200*** INVENTORY DATE.  IF IT IS, DO NOT ALLOW A SHIP DATE TO BE     11820099
118300*** ENTERED THAT IS GREATER THAN THE CURRENT DATE FOR THIS D-N-D  11830099
118400*** LISTING.                                                      11840099
118500                         IF PS-UPDATE-OK                          11850099
118600                             MOVE ASC-CURRENT-DATE-USA            11860099
118700                                              TO PV-DATE-USA      11870099
118800                             MOVE PV-DATE-USA-MM                  11880099
118900                                              TO PV-CMPR-USA-DT-MM11890099
119000                             MOVE PV-DATE-USA-DD                  11900099
119100                                              TO PV-CMPR-USA-DT-DD11910099
119200                             MOVE PV-DATE-USA-CCYY                11920099
119300                                              TO                  11930099
119400                                               PV-CMPR-USA-DT-CCYY11940099
119500                             MOVE '/'         TO                  11950099
119600                                            PV-CMPR-USA-DT-SLASH-111960099
119700                                            PV-CMPR-USA-DT-SLASH-211970099
119800                             PERFORM 3560-CHECK-INVENTORY-DATE    11980099
119900                             IF PS-DATA-FOUND                     11990099
120000                                 IF (ASC-SHIP-DTE =               12000099
120100                                    ASC-CURRENT-DATE-PLUS-ONE-DAY)12010099
120200                                     SET DP020-MSG-FATAL          12020099
120300                                         PS-UPDATE-NOT-OK         12030099
120400                                         PS-ERROR                 12040099
120500                                              TO TRUE             12050099
120600                                     MOVE PC-TSYMSG-03272         12060099
120700                                              TO DP020-MSG-NUMBER 12070099
120800                                     MOVE XLT00025-PLND-INV-DTE   12080099
120900                                              TO DP020-MSG-TEXT   12090099
121000                                     MOVE DP015-UNP-ALP-BRT-MDT   12100099
121100                                              TO ASHPDTEA         12110099
121200                                     MOVE DP015-RED               12120099
121300                                              TO ASHPDTEC         12130099
121400                                     MOVE DP015-REVERSE           12140099
121500                                              TO ASHPDTEH         12150099
121600                                     INITIALIZE AAUTHIDL          12160099
121700                                     MOVE -1  TO ASHPDTEL         12170099
121800                                     SET DP030-SET-CURSOR-APPL-1  12180099
121900                                              TO TRUE             12190099
122000                                 END-IF                           12200099
122100                             END-IF                               12210099
122200                         END-IF                                   12220099
122300                         IF PS-UPDATE-OK                          12230099
122400                             PERFORM 3700-PREPARE-DND-INFO        12240099
122500                         END-IF                                   12250099
122600                         IF PS-UPDATE-OK                          12260099
122700                             MOVE ASC-DFCT-ORD-ID TO              12270099
122800                                      RVT00003-DFCT-ORD-ID        12280099
122900                             MOVE ASC-STAT-CDE    TO              12290099
123000                                      RVT00003-DFCT-ORD-STAT-CDE  12300099
123100                             MOVE DP020-USERID    TO              12310099
123200                                      RVT00003-USR-ID             12320099
123300                             PERFORM 5300-INSERT-DFCT-STAT        12330099
123400                         END-IF                                   12340099
123500                         IF PS-UPDATE-OK                          12350099
123600                             PERFORM 5400-INSERT-DFCT-SHIPT       12360099
123700                             IF  PS-INSERT-SHIP-STAT              12370099
123800                                 PERFORM 5600-INSERT-SHIPT-STAT   12380099
123900                             END-IF                               12390099
124000                         END-IF                                   12400099
124100                         IF PS-UPDATE-OK                          12410099
124200                             PERFORM 5100-UPD-TDFCTOR-DND         12420099
124300                         END-IF                                   12430099
124400*                    --- UPDATES SUCCESSFUL ---                   12440099
124500                         IF PS-UPDATE-OK                          12450099
124600                             MOVE PC-TSYMSG-00059 TO              12460099
124700                                                 DP020-MSG-NUMBER 12470099
124800                             SET DP020-MSG-INFORMATIONAL TO TRUE  12480099
124900                             PERFORM 8900-SYNCPOINT               12490099
125000                             PERFORM 4000-BUILD-INITIAL-PANEL     12500099
125100                             PERFORM 3200-RESET-ATTRIBUTES        12510099
125200                         ELSE                                     12520099
125300                             PERFORM 8950-SYNCPOINT-ROLLBACK      12530099
125400                             INITIALIZE AAUTHIDL                  12540099
125500                             SET PS-ERROR                         12550099
125600                                 DP020-MSG-FATAL                  12560099
125700                                 DP030-SET-CURSOR-APPL-1 TO TRUE  12570099
125800                         END-IF                                   12580099
125900                     ELSE                                         12590099
126000                         SET PS-ERROR     TO TRUE                 12600099
126100                         SET DP020-MSG-FATAL TO TRUE              12610099
126200                         MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER 12620099
126300                         MOVE DP015-UNP-ALP-BRT-MDT TO AAUTHIDA   12630099
126400                         MOVE DP015-RED   TO AAUTHIDC             12640099
126500                         MOVE DP015-REVERSE TO AAUTHIDH           12650099
126600                         MOVE -1          TO AAUTHIDL             12660099
126700                         SET DP030-SET-CURSOR-APPL-1 TO TRUE      12670099
126800                     END-IF                                       12680099
126900                 END-IF                                           12690099
127000             END-IF                                               12700099
127100* - PF 23 -- CHG LISTING TYPE (CHANGE RTV TO D&D OR D&D TO RTV)   12710099
127200         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID)              12720099
127300             SET ASC-CONFIRM                                      12730099
127400                 DP020-MSG-WARNING TO TRUE                        12740099
127500             EVALUATE TRUE                                        12750099
127600                 WHEN ASC-RTV-TYP                                 12760099
127700*** WE CANNOT ALLOW LISTINGS TO BE CHANGED TO A D&D STATUS ON A   12770099
127800*** SCHEDULED INVENTORY DATE.  THE WAY WE CAN CHECK FOR THIS IS TO12780099
127900*** SEE IF THERE IS A ROW OUT ON XLT_MDSE_INV_PARM WITH A PLANNED 12790099
128000*** INVENTORY DATE EQUAL TO THE CURRENT DATE.  IF THERE IS A      12800099
128100*** ROW, WE NEED TO DISPLAY A MESSAGE AND NOT ALLOW THE LISTING TO12810099
128200*** BE CHANGED TO A D&D STATUS.                                   12820099
128300                     MOVE ASC-CURRENT-DATE-USA                    12830099
128400                                              TO                  12840099
128500                                               PV-CURRENT-DATE-USA12850099
128600                     MOVE PV-CUR-USA-DT-MM    TO PV-CMPR-USA-DT-MM12860099
128700                     MOVE PV-CUR-USA-DT-DD    TO PV-CMPR-USA-DT-DD12870099
128800                     MOVE PV-CUR-USA-DT-CCYY  TO                  12880099
128900                                               PV-CMPR-USA-DT-CCYY12890099
129000                     MOVE '/'                 TO                  12900099
129100                                            PV-CMPR-USA-DT-SLASH-112910099
129200                                            PV-CMPR-USA-DT-SLASH-212920099
129300                     SET PS-NO-ERROR          TO TRUE             12930099
129400                     PERFORM 3560-CHECK-INVENTORY-DATE            12940099
129500                     IF PS-DATA-FOUND                             12950099
129600                         SET DP020-MSG-FATAL                      12960099
129700                             PS-UPDATE-NOT-OK                     12970099
129800                             PS-ERROR     TO TRUE                 12980099
129900                         MOVE PC-TSYMSG-03273                     12990099
130000                                              TO DP020-MSG-NUMBER 13000099
130100                         MOVE XLT00025-PLND-INV-DTE               13010099
130200                                              TO DP020-MSG-TEXT   13020099
130300                         MOVE DP015-UNP-ALP-BRT-MDT               13030099
130400                                              TO ASHPDTEA         13040099
130500                         MOVE DP015-RED       TO ASHPDTEC         13050099
130600                         MOVE DP015-REVERSE                       13060099
130700                                              TO ASHPDTEH         13070099
130800                         INITIALIZE AAUTHIDL                      13080099
130900                         MOVE -1              TO ASHPDTEL         13090099
131000                         SET DP030-SET-CURSOR-APPL-1              13100099
131100                                              TO TRUE             13110099
131200                     END-IF                                       13120099
131300                                                                  13130099
131400                     IF PS-NO-ERROR                               13140099
131500                         EVALUATE TRUE                            13150099
131600                             WHEN ASC-RTV-STAT-S                  13160099
131700                                 MOVE PC-TSYMSG-03196             13170099
131800                                         TO DP020-MSG-NUMBER      13180099
131900                                 SET ASC-SHIP-TO-DND TO TRUE      13190099
132000                             WHEN ASC-RTV-STAT-C                  13200099
132100                                 MOVE PC-TSYMSG-03197             13210099
132200                                         TO DP020-MSG-NUMBER      13220099
132300                                 SET ASC-RTV-TO-DND TO TRUE       13230099
132400                             WHEN OTHER                           13240099
132500                                 MOVE PC-TSYMSG-00045             13250099
132600                                         TO DP020-MSG-NUMBER      13260099
132700                                 SET DP020-MSG-WARNING            13270099
132800                                     ASC-NO-CONFIRM    TO TRUE    13280099
132900                         END-EVALUATE                             13290099
133000                     END-IF                                       13300099
133100                 WHEN ASC-DND-TYP                                 13310099
133200                     EVALUATE TRUE                                13320099
133300                        WHEN ASC-DND-STAT-S                       13330099
133400                             MOVE PC-TSYMSG-03196                 13340099
133500                                         TO DP020-MSG-NUMBER      13350099
133600                             SET ASC-SHIP-TO-RTV TO TRUE          13360099
133700                         WHEN ASC-DND-STAT-D                      13370099
133800                             MOVE PC-TSYMSG-03197                 13380099
133900                                         TO DP020-MSG-NUMBER      13390099
134000                             SET ASC-DND-TO-RTV TO TRUE           13400099
134100                         WHEN OTHER                               13410099
134200                             MOVE PC-TSYMSG-00045                 13420099
134300                                         TO DP020-MSG-NUMBER      13430099
134400                             SET DP020-MSG-WARNING                13440099
134500                                 ASC-NO-CONFIRM    TO TRUE        13450099
134600                     END-EVALUATE                                 13460099
134700                 END-EVALUATE                                     13470099
134800         WHEN OTHER                                               13480099
134900             SET DP013-NO-ROLLBACK                                13490099
135000                 DP013-XCTL-DISPLAY-RESTART                       13500099
135100                 DP013-CICS-ABEND  TO TRUE                        13510099
135200             MOVE '2100-CHECK-FUNCTION-KEY'                       13520099
135300                                   TO DP013-PARAGRAPH             13530099
135400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      13540099
135500                                   TO DP013-MESSAGE-TEXT (1)      13550099
135600             PERFORM DP013-0000-PROCESS-ABEND                     13560099
135700     END-EVALUATE.                                                13570099
135800                                                                  13580099
135900*----------------------------------------------------------------*13590099
136000* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *13600099
136100* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *13610099
136200* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *13620099
136300*----------------------------------------------------------------*13630099
136400 2200-MOVE-SCREEN-TO-COMMAREA.                                    13640099
136500     IF ARANBRL > ZERO                                            13650099
136600         MOVE ARANBRI            TO ASC-DFCT-ORD-ID               13660099
136700     ELSE                                                         13670099
136800         IF ARANBRF = DP015-ERASE-EOF                             13680099
136900             INITIALIZE             ASC-DFCT-ORD-ID               13690099
137000         END-IF                                                   13700099
137100     END-IF.                                                      13710099
137200                                                                  13720099
137300     IF ATYPEL > ZERO                                             13730099
137400         MOVE ATYPEI             TO ASC-LIST-TYPE                 13740099
137500     ELSE                                                         13750099
137600         IF ATYPEF = DP015-ERASE-EOF                              13760099
137700             INITIALIZE             ASC-LIST-TYPE                 13770099
137800         END-IF                                                   13780099
137900     END-IF.                                                      13790099
138000                                                                  13800099
138100     IF ALOCL > ZERO                                              13810099
138200         MOVE ALOCI              TO ASC-LOCATION                  13820099
138300     ELSE                                                         13830099
138400         IF ALOCF = DP015-ERASE-EOF                               13840099
138500             INITIALIZE             ASC-LOCATION                  13850099
138600         END-IF                                                   13860099
138700     END-IF.                                                      13870099
138800                                                                  13880099
138900     IF AVNDRL > ZERO                                             13890099
139000         MOVE AVNDRI             TO ASC-VENDOR-NAME               13900099
139100     ELSE                                                         13910099
139200         IF AVNDRF = DP015-ERASE-EOF                              13920099
139300             INITIALIZE             ASC-VENDOR-NAME               13930099
139400         END-IF                                                   13940099
139500     END-IF.                                                      13950099
139600                                                                  13960099
139700     IF ASTATL > ZERO                                             13970099
139800         MOVE ASTATI             TO ASC-STATUS                    13980099
139900     ELSE                                                         13990099
140000         IF ASTATF = DP015-ERASE-EOF                              14000099
140100             INITIALIZE             ASC-STATUS                    14010099
140200         END-IF                                                   14020099
140300     END-IF.                                                      14030099
140400                                                                  14040099
140500     IF ATKNBRL > ZERO                                            14050099
140600         MOVE ATKNBRI            TO ASC-TK-NBR                    14060099
140700     ELSE                                                         14070099
140800         IF ATKNBRF = DP015-ERASE-EOF                             14080099
140900             INITIALIZE             ASC-TK-NBR                    14090099
141000         END-IF                                                   14100099
141100     END-IF.                                                      14110099
141200                                                                  14120099
141300     IF AAUTHIDL > ZERO                                           14130099
141400         MOVE AAUTHIDI           TO ASC-AUTH-ID                   14140099
141500     ELSE                                                         14150099
141600         IF AAUTHIDF = DP015-ERASE-EOF                            14160099
141700             INITIALIZE             ASC-AUTH-ID                   14170099
141800         END-IF                                                   14180099
141900     END-IF.                                                      14190099
142000                                                                  14200099
142100     IF AAUTHDTL > ZERO                                           14210099
142200         MOVE AAUTHDTI           TO ASC-AUTH-DTE                  14220099
142300     ELSE                                                         14230099
142400         IF AAUTHDTF = DP015-ERASE-EOF OR AAUTHDTL = ZERO         14240099
142500             INITIALIZE             ASC-AUTH-DTE                  14250099
142600         END-IF                                                   14260099
142700     END-IF.                                                      14270099
142800                                                                  14280099
142900     IF ASHPDTEL > ZERO                                           14290099
143000         MOVE ASHPDTEI           TO ASC-SHIP-DTE                  14300099
143100     ELSE                                                         14310099
143200         IF ASHPDTEF = DP015-ERASE-EOF                            14320099
143300             INITIALIZE             ASC-SHIP-DTE                  14330099
143400         END-IF                                                   14340099
143500     END-IF.                                                      14350099
143600                                                                  14360099
143700     IF ASHPDBYL > ZERO                                           14370099
143800         MOVE ASHPDBYI           TO ASC-SHIPPED-BY                14380099
143900     ELSE                                                         14390099
144000         IF ASHPDBYF = DP015-ERASE-EOF                            14400099
144100             INITIALIZE             ASC-SHIPPED-BY                14410099
144200         END-IF                                                   14420099
144300     END-IF.                                                      14430099
144400                                                                  14440099
144500     IF ASCACL > ZERO                                             14450099
144600         MOVE ASCACI             TO ASC-SCAC                      14460099
144700     ELSE                                                         14470099
144800         IF  ASCACF = DP015-ERASE-EOF                             14480099
144900             INITIALIZE             ASC-SCAC                      14490099
145000         END-IF                                                   14500099
145100     END-IF.                                                      14510099
145200                                                                  14520099
145300     IF ATRAILRL > ZERO                                           14530099
145400         MOVE ATRAILRI           TO ASC-TRAILER-NBR               14540099
145500     ELSE                                                         14550099
145600         IF ATRAILRF = DP015-ERASE-EOF                            14560099
145700             INITIALIZE             ASC-TRAILER-NBR               14570099
145800         END-IF                                                   14580099
145900     END-IF.                                                      14590099
146000                                                                  14600099
146100     IF ATRKNBRL > ZERO                                           14610099
146200         MOVE ATRKNBRI           TO ASC-TRACKING-NBR              14620099
146300     ELSE                                                         14630099
146400         IF ATRKNBRF = DP015-ERASE-EOF                            14640099
146500             INITIALIZE             ASC-TRACKING-NBR              14650099
146600         END-IF                                                   14660099
146700     END-IF.                                                      14670099
146800                                                                  14680099
146900     IF ACARTONL > ZERO                                           14690099
147000         MOVE ACARTONI           TO ASC-CART-QTY                  14700099
147100                                    ASC-CART-QTY-X                14710099
147200     ELSE                                                         14720099
147300         IF ACARTONF = DP015-ERASE-EOF                            14730099
147400             INITIALIZE             ASC-CART-QTY                  14740099
147500                                    ASC-CART-QTY-X                14750099
147600         END-IF                                                   14760099
147700     END-IF.                                                      14770099
147800                                                                  14780099
147900     IF AWEIGHTL > ZERO                                           14790099
148000         MOVE AWEIGHTI           TO ASC-DFCT-WT-QTY               14800099
148100                                    ASC-DFCT-WT-QTY-X             14810099
148200     ELSE                                                         14820099
148300         IF  AWEIGHTF = DP015-ERASE-EOF                           14830099
148400            INITIALIZE              ASC-DFCT-WT-QTY               14840099
148500                                    ASC-DFCT-WT-QTY-X             14850099
148600         END-IF                                                   14860099
148700     END-IF.                                                      14870099
148800                                                                  14880099
148900     IF ASHIPMTL > ZERO                                           14890099
149000         MOVE ASHIPMTI           TO ASC-DFCT-SHIPT-ID             14900099
149100     ELSE                                                         14910099
149200         IF  ASHIPMTF = DP015-ERASE-EOF                           14920099
149300            INITIALIZE              ASC-DFCT-SHIPT-ID             14930099
149400         END-IF                                                   14940099
149500     END-IF.                                                      14950099
149600                                                                  14960099
149700     IF ATCOSTL > ZERO                                            14970099
149800         MOVE ATCOSTI            TO ASC-TOTAL-COST                14980099
149900                                    ASC-TOTAL-COST-X              14990099
150000     ELSE                                                         15000099
150100         IF ATCOSTF = DP015-ERASE-EOF                             15010099
150200             INITIALIZE             ASC-TOTAL-COST                15020099
150300                                    ASC-TOTAL-COST-X              15030099
150400         END-IF                                                   15040099
150500     END-IF.                                                      15050099
150600                                                                  15060099
150700     IF ATRETLL > ZERO                                            15070099
150800         MOVE ATRETLI             TO ASC-TOTAL-RETAIL             15080099
150900                                     ASC-TOTAL-RETAIL-X           15090099
151000     ELSE                                                         15100099
151100         IF ATRETLF = DP015-ERASE-EOF                             15110099
151200             INITIALIZE             ASC-TOTAL-RETAIL              15120099
151300                                    ASC-TOTAL-RETAIL-X            15130099
151400         END-IF                                                   15140099
151500     END-IF.                                                      15150099
151600                                                                  15160099
151700     IF AOUTCHGL > ZERO                                           15170099
151800         MOVE AOUTCHGI           TO ASC-OUTBND-CHRGS              15180099
151900                                    ASC-OUTBND-CHRGS-X            15190099
152000                                    ASC-INBND-CHRGS               15200099
152100                                    ASC-INBND-CHRGS-X             15210099
152200     ELSE                                                         15220099
152300         IF AOUTCHGF = DP015-ERASE-EOF                            15230099
152400             INITIALIZE             ASC-OUTBND-CHRGS              15240099
152500                                    ASC-OUTBND-CHRGS-X            15250099
152600                                    ASC-INBND-CHRGS               15260099
152700                                    ASC-INBND-CHRGS-X             15270099
152800         END-IF                                                   15280099
152900     END-IF.                                                      15290099
153000                                                                  15300099
153100     IF  ARETRSNL > ZERO                                          15310099
153200         MOVE ARETRSNI           TO ASC-RET-RSN                   15320099
153300     ELSE                                                         15330099
153400         IF  ARETRSNF = DP015-ERASE-EOF                           15340099
153500             MOVE 6              TO ASC-RET-RSN                   15350099
153600         END-IF                                                   15360099
153700     END-IF.                                                      15370099
153800                                                                  15380099
153900     IF ADEDUCTL > ZERO                                           15390099
154000         MOVE ADEDUCTI           TO ASC-DED-CHRG-AMT-X            15400099
154100                                    ASC-DED-CHRG-AMT              15410099
154200     ELSE                                                         15420099
154300         IF ADEDUCTF = DP015-ERASE-EOF                            15430099
154400             INITIALIZE             ASC-DED-CHRG-AMT              15440099
154500                                    ASC-DED-CHRG-AMT-X            15450099
154600         END-IF                                                   15460099
154700     END-IF.                                                      15470099
154800                                                                  15480099
154900     IF ADISCNTL > ZERO                                           15490099
155000         MOVE ADISCNTI           TO ASC-DISC-AMT                  15500099
155100                                    ASC-DISC-AMT-X                15510099
155200     ELSE                                                         15520099
155300         IF ADISCNTF = DP015-ERASE-EOF                            15530099
155400             INITIALIZE             ASC-DISC-AMT                  15540099
155500                                    ASC-DISC-AMT-X                15550099
155600         END-IF                                                   15560099
155700     END-IF.                                                      15570099
155800                                                                  15580099
155900     IF ADSCPCTL > ZERO                                           15590099
156000         MOVE ADSCPCTI           TO ASC-DISC-PCT                  15600099
156100                                    ASC-DISC-PCT-X                15610099
156200     ELSE                                                         15620099
156300         IF ADSCPCTF = DP015-ERASE-EOF                            15630099
156400             INITIALIZE             ASC-DISC-PCT                  15640099
156500                                    ASC-DISC-PCT-X                15650099
156600         END-IF                                                   15660099
156700     END-IF.                                                      15670099
156800                                                                  15680099
156900     IF AGTOTALL > ZERO                                           15690099
157000         MOVE AGTOTALI           TO ASC-GRAND-TOTAL               15700099
157100                                    ASC-GRAND-TOTAL-X             15710099
157200     ELSE                                                         15720099
157300         IF AGTOTALF = DP015-ERASE-EOF                            15730099
157400             INITIALIZE             ASC-GRAND-TOTAL               15740099
157500                                    ASC-GRAND-TOTAL-X             15750099
157600         END-IF                                                   15760099
157700     END-IF.                                                      15770099
157800                                                                  15780099
157900     IF APAYTYPL > ZERO                                           15790099
158000         MOVE APAYTYPI           TO ASC-PAYT-TYPE                 15800099
158100     ELSE                                                         15810099
158200         IF APAYTYPF = DP015-ERASE-EOF                            15820099
158300             MOVE 'P'            TO ASC-PAYT-TYPE                 15830099
158400         END-IF                                                   15840099
158500     END-IF.                                                      15850099
158600                                                                  15860099
158700     IF AINST1L > ZERO                                            15870099
158800         MOVE AINST1I            TO ASC-SPEC-INSTR-LINE-1         15880099
158900     ELSE                                                         15890099
159000         IF AINST1F = DP015-ERASE-EOF                             15900099
159100             INITIALIZE             ASC-SPEC-INSTR-LINE-1         15910099
159200         END-IF                                                   15920099
159300     END-IF.                                                      15930099
159400                                                                  15940099
159500     IF AINST2L > ZERO                                            15950099
159600         MOVE AINST2I            TO ASC-SPEC-INSTR-LINE-2         15960099
159700     ELSE                                                         15970099
159800         IF AINST2F = DP015-ERASE-EOF                             15980099
159900             INITIALIZE             ASC-SPEC-INSTR-LINE-2         15990099
160000         END-IF                                                   16000099
160100     END-IF.                                                      16010099
160200                                                                  16020099
160300*----------------------------------------------------------------*16030099
160400* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *16040099
160500* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *16050099
160600* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *16060099
160700*----------------------------------------------------------------*16070099
160800 3000-EDIT-DATA-IN-COMMAREA.                                      16080099
160900     PERFORM 3200-RESET-ATTRIBUTES.                               16090099
161000     SET PS-NO-ERROR                 TO TRUE.                     16100099
161100                                                                  16110099
161200******* TYPE = RTV, D&D ETC                                       16120099
161300******* WE DO NOT WANT TO PERFORM THIS EDIT IF THE "F17" KEY HAS  16130099
161400******* BEEN PRESSED TO VIEW THE VENDOR AGREEMENT SCREEN OR THE   16140099
161500******* "F20" KEY HAS BEEN PRESSED TO VIEW THE EXISTING SHIPMENTS.16150099
161600     IF DP020-FK-LOCAL-FUNC-05 (DP020-SRC-AID) OR                 16160099
161700        DP020-FK-LOCAL-FUNC-06 (DP020-SRC-AID)                    16170099
161800         CONTINUE                                                 16180099
161900     ELSE                                                         16190099
162000         IF ASC-TYPE-CDE  > SPACE                                 16200099
162100             IF ASC-AUTH-ID = SPACES                              16210099
162200                 PERFORM 3400-SELECT-TVNDAGR-3                    16220099
162300                 IF PS-DATA-FOUND                                 16230099
162400                     PERFORM 3410-CHK-TVNDAGR                     16240099
162500                 ELSE                                             16250099
162600                     MOVE SPACES               TO ASC-AUTH-ID     16260099
162700                                                  ASC-AUTH-DTE    16270099
162800                     SET DP020-MSG-WARNING     TO TRUE            16280099
162900                     MOVE PC-TSYMSG-03155      TO DP020-MSG-NUMBER16290099
163000                     MOVE DP015-UNP-ALP-BRT-MDT                   16300099
163100                                               TO AAUTHIDA        16310099
163200                     MOVE DP015-RED            TO AAUTHIDC        16320099
163300                     MOVE DP015-REVERSE        TO AAUTHIDH        16330099
163400                     MOVE -1                   TO AAUTHIDL        16340099
163500                     SET DP030-SET-CURSOR-APPL-1                  16350099
163600                                               TO TRUE            16360099
163700                 END-IF                                           16370099
163800             ELSE                                                 16380099
163900                 IF ASC-AUTH-DTE = SPACES                         16390099
164000                     PERFORM 3800-GET-CLOSE-DATE                  16400099
164100                 END-IF                                           16410099
164200             END-IF                                               16420099
164300         END-IF                                                   16430099
164400     END-IF.                                                      16440099
164500                                                                  16450099
164600****************************************************************  16460099
164700* AUTHORIZATION DATE -- MUST BE IN A VALID DATE FORMAT AND CANNOT 16470099
164800*                       BE GREATER THAN THE CURRENT DATE.         16480099
164900****************************************************************  16490099
165000     IF ASC-AUTH-DTE > SPACE                                      16500099
165100         INITIALIZE PS-CHK-DTE-SW                                 16510099
165200                    PV-NBR-SLASHES                                16520099
165300         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           16530099
165400         SET PS-CHK-AUTH-DTE TO TRUE                              16540099
165500         INSPECT ASC-AUTH-DTE                                     16550099
165600             TALLYING PV-NBR-SLASHES FOR ALL '/'                  16560099
165700         IF PV-NBR-SLASHES = 2                                    16570099
165800             SET DPG52-LK-DTE-GREG-CC-FMT TO TRUE                 16580099
165900             MOVE ASC-AUTH-DTE      TO DPG52-LK-DATE-INPUT        16590099
166000         ELSE                                                     16600099
166100             IF PV-NBR-SLASHES = ZERO                             16610099
166200                 SET DPG52-LK-DTE-GREG TO TRUE                    16620099
166300                 MOVE ASC-AUTH-DTE     TO DPG52-LK-DATE-INPUT     16630099
166400             END-IF                                               16640099
166500         END-IF                                                   16650099
166600         SET DPG51-ACTUAL-CALENDAR-ONLY                           16660099
166700                                       TO TRUE                    16670099
166800         PERFORM 3500-CALL-DTE-RTN                                16680099
166900         IF PS-NO-ERROR                                           16690099
167000             INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56       16700099
167100             SET DPG51-ACTUAL-CALENDAR-ONLY                       16710099
167200                                       TO TRUE                    16720099
167300             SET DPG52-LK-DTE-GREG-CC-FMT                         16730099
167400                                       TO TRUE                    16740099
167500             MOVE ASC-AUTH-DTE         TO DPG52-LK-DATE-INPUT     16750099
167600             SET DPG53-LK-CMPR-DTE-GREG-CC-FMT                    16760099
167700                                       TO TRUE                    16770099
167800             MOVE ASC-CURRENT-DATE-USA TO DPG53-LK-CMPR-DATE-INPUT16780099
167900             PERFORM 3550-CAL-RTN-COMPARE-DATES                   16790099
168000         END-IF                                                   16800099
168100         IF PS-NO-ERROR                                           16810099
168200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  16820099
168300         END-IF                                                   16830099
168400     END-IF.                                                      16840099
168500*                                                                 16850099
168600****************************************************************  16860099
168700* SHIP DATE -- MUST BE IN A VALID DATE FORMAT AND CANNOT BE       16870099
168800*              GREATER THAN THE CURRENT DATE PLUS ONE DAY.        16880099
168900*              IF IT HAS NOT BEEN FILLED IN, DEFAULT IT TO THE    16890099
169000*              CURRENT DATE.                                      16900099
169100****************************************************************  16910099
169200     IF ASC-SHIP-DTE > SPACES                                     16920099
169300         INITIALIZE PS-CHK-DTE-SW                                 16930099
169400                    PV-NBR-SLASHES                                16940099
169500         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           16950099
169600         SET PS-CHK-SHIP-DTE TO TRUE                              16960099
169700         INSPECT ASC-SHIP-DTE                                     16970099
169800             TALLYING PV-NBR-SLASHES FOR ALL '/'                  16980099
169900         IF PV-NBR-SLASHES = 2                                    16990099
170000             SET DPG52-LK-DTE-GREG-CC-FMT TO TRUE                 17000099
170100             MOVE ASC-SHIP-DTE      TO DPG52-LK-DATE-INPUT        17010099
170200         ELSE                                                     17020099
170300             IF PV-NBR-SLASHES = ZERO                             17030099
170400                 SET DPG52-LK-DTE-GREG TO TRUE                    17040099
170500                 MOVE ASC-SHIP-DTE     TO DPG52-LK-DATE-INPUT     17050099
170600             END-IF                                               17060099
170700         END-IF                                                   17070099
170800         SET DPG51-ACTUAL-CALENDAR-ONLY                           17080099
170900                                       TO TRUE                    17090099
171000         PERFORM 3500-CALL-DTE-RTN                                17100099
171100         IF PS-NO-ERROR                                           17110099
171200             INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56       17120099
171300             SET DPG51-ACTUAL-CALENDAR-ONLY                       17130099
171400                                       TO TRUE                    17140099
171500             SET DPG52-LK-DTE-GREG-CC-FMT                         17150099
171600                                       TO TRUE                    17160099
171700             MOVE ASC-SHIP-DTE         TO DPG52-LK-DATE-INPUT     17170099
171800             SET DPG53-LK-CMPR-DTE-GREG-CC-FMT                    17180099
171900                                       TO TRUE                    17190099
172000             MOVE ASC-CURRENT-DATE-PLUS-ONE-DAY                   17200099
172100                                       TO DPG53-LK-CMPR-DATE-INPUT17210099
172200             PERFORM 3550-CAL-RTN-COMPARE-DATES                   17220099
172300         END-IF                                                   17230099
172400         IF PS-NO-ERROR                                           17240099
172500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17250099
172600         END-IF                                                   17260099
172700     END-IF.                                                      17270099
172800*                                                                 17280099
172900**** IF BOTH THE SHIP DATE AND THE AUTHORIZATION DATE ARE FILLED  17290099
173000**** IN, THE AUTHORIZATION DATE CANNOT BE GREATER THAN THE SHIP   17300099
173100**** DATE.                                                        17310099
173200     IF ASC-AUTH-DTE > SPACE AND                                  17320099
173300        ASC-SHIP-DTE > SPACE AND                                  17330099
173400        PS-NO-ERROR                                               17340099
173500         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           17350099
173600         INITIALIZE PS-CHK-DTE-SW                                 17360099
173700         SET PS-CHK-BOTH-DTES          TO TRUE                    17370099
173800         SET DPG51-ACTUAL-CALENDAR-ONLY                           17380099
173900                                       TO TRUE                    17390099
174000         SET DPG52-LK-DTE-GREG-CC-FMT  TO TRUE                    17400099
174100         MOVE ASC-AUTH-DTE             TO DPG52-LK-DATE-INPUT     17410099
174200         SET DPG53-LK-CMPR-DTE-GREG-CC-FMT                        17420099
174300                                       TO TRUE                    17430099
174400         MOVE ASC-SHIP-DTE             TO DPG53-LK-CMPR-DATE-INPUT17440099
174500         PERFORM 3550-CAL-RTN-COMPARE-DATES                       17450099
174600     END-IF.                                                      17460099
174700     IF PS-NO-ERROR                                               17470099
174800         SET DP030-SET-CURSOR-APPL-1   TO TRUE                    17480099
174900     END-IF.                                                      17490099
175000*                                                                 17500099
175100******* SCAC = CARRIER, WHO'S HAULING IT                          17510099
175200     IF ASC-SCAC > SPACE                                          17520099
175300         PERFORM 3300-VALIDATE-SCAC                               17530099
175400         IF  PS-INVALID-SCAC                                      17540099
175500             MOVE DP015-RED              TO ASCACC                17550099
175600             MOVE DP015-REVERSE          TO ASCACH                17560099
175700             MOVE -1                     TO ASCACL                17570099
175800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  17580099
175900             MOVE PC-TSYMSG-02609        TO DP020-MSG-NUMBER      17590099
176000             SET DP020-MSG-FATAL         TO TRUE                  17600099
176100             SET PS-ERROR                TO TRUE                  17610099
176200         END-IF                                                   17620099
176300     END-IF.                                                      17630099
176400*                                                                 17640099
176500******* CARTON QTY = NBR OF CARTONS                               17650099
176600     IF ASC-CART-QTY-X     > SPACES                               17660099
176700         MOVE ASC-CART-QTY-X       TO DP010I-UNEDITED-FIELD       17670099
176800         MOVE 10                 TO DP010I-MAXIMUM-DIGITS         17680099
176900         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       17690099
177000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17700099
177100         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17710099
177200                         USING DP010I-NUMERIC-EDIT-AREA           17720099
177300                                                                  17730099
177400         IF DP010I-NO-ERROR-DETECTED                              17740099
177500             MOVE DP010I-NUMERIC-FIELD   TO ASC-CART-QTY          17750099
177600         ELSE                                                     17760099
177700             SET PS-ERROR                                         17770099
177800                 DP020-MSG-FATAL                                  17780099
177900                 DP030-SET-CURSOR-APPL-1 TO TRUE                  17790099
178000             MOVE PC-TSYMSG-00342       TO DP020-MSG-NUMBER       17800099
178100             MOVE DP015-UNP-NUM-BRT-MDT TO ACARTONA               17810099
178200             MOVE DP015-RED             TO ACARTONC               17820099
178300             MOVE DP015-REVERSE         TO ACARTONH               17830099
178400             MOVE -1                    TO ACARTONL               17840099
178500         END-IF                                                   17850099
178600     END-IF.                                                      17860099
178700*                                                                 17870099
178800******* WEIGHT OF WHAT'S BEING SHIPPED                            17880099
178900     IF ASC-DFCT-WT-QTY-X > SPACES                                17890099
179000         MOVE ASC-DFCT-WT-QTY-X  TO DP010I-UNEDITED-FIELD         17900099
179100         MOVE 8                  TO DP010I-MAXIMUM-DIGITS         17910099
179200         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       17920099
179300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  17930099
179400         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17940099
179500                         USING DP010I-NUMERIC-EDIT-AREA           17950099
179600                                                                  17960099
179700         IF DP010I-NO-ERROR-DETECTED                              17970099
179800             MOVE DP010I-NUMERIC-FIELD   TO ASC-DFCT-WT-QTY       17980099
179900         ELSE                                                     17990099
180000             SET PS-ERROR                                         18000099
180100                 DP020-MSG-FATAL                                  18010099
180200                 DP030-SET-CURSOR-APPL-1 TO TRUE                  18020099
180300             MOVE PC-TSYMSG-00342       TO DP020-MSG-NUMBER       18030099
180400             MOVE DP015-UNP-NUM-BRT-MDT TO AWEIGHTA               18040099
180500             MOVE DP015-RED             TO AWEIGHTC               18050099
180600             MOVE DP015-REVERSE         TO AWEIGHTH               18060099
180700             MOVE -1                    TO AWEIGHTL               18070099
180800         END-IF                                                   18080099
180900     END-IF.                                                      18090099
181000*                                                                 18100099
181100******* TOTAL UNIT COST                                           18110099
181200     IF  ASC-TOTAL-COST-X > SPACES                                18120099
181300         MOVE ASC-TOTAL-COST-X TO DP010I-UNEDITED-FIELD           18130099
181400         MOVE 6                  TO DP010I-MAXIMUM-DIGITS         18140099
181500         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       18150099
181600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18160099
181700         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18170099
181800                         USING DP010I-NUMERIC-EDIT-AREA           18180099
181900                                                                  18190099
182000         IF DP010I-NO-ERROR-DETECTED                              18200099
182100             MOVE DP010I-NUMERIC-FIELD  TO ASC-TOTAL-COST         18210099
182200         ELSE                                                     18220099
182300             SET PS-ERROR                                         18230099
182400                 DP020-MSG-FATAL                                  18240099
182500                 DP030-SET-CURSOR-APPL-1 TO TRUE                  18250099
182600             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       18260099
182700             MOVE DP015-UNP-NUM-BRT-MDT TO ATCOSTA                18270099
182800             MOVE DP015-RED             TO ATCOSTC                18280099
182900             MOVE DP015-REVERSE         TO ATCOSTH                18290099
183000             MOVE -1                    TO ATCOSTL                18300099
183100         END-IF                                                   18310099
183200     END-IF.                                                      18320099
183300*                                                                 18330099
183400******* TOTAL RETAIL COST                                         18340099
183500     IF  ASC-TOTAL-RETAIL-X > SPACES                              18350099
183600         MOVE ASC-TOTAL-RETAIL-X TO DP010I-UNEDITED-FIELD         18360099
183700         MOVE 6                  TO DP010I-MAXIMUM-DIGITS         18370099
183800         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       18380099
183900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18390099
184000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18400099
184100                         USING DP010I-NUMERIC-EDIT-AREA           18410099
184200                                                                  18420099
184300         IF DP010I-NO-ERROR-DETECTED                              18430099
184400             MOVE DP010I-NUMERIC-FIELD  TO ASC-TOTAL-RETAIL       18440099
184500         ELSE                                                     18450099
184600             SET PS-ERROR                                         18460099
184700                 DP020-MSG-FATAL                                  18470099
184800                 DP030-SET-CURSOR-APPL-1 TO TRUE                  18480099
184900             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       18490099
185000             MOVE DP015-UNP-NUM-BRT-MDT TO ATRETLA                18500099
185100             MOVE DP015-RED             TO ATRETLC                18510099
185200             MOVE DP015-REVERSE         TO ATRETLH                18520099
185300             MOVE -1                    TO ATRETLL                18530099
185400         END-IF                                                   18540099
185500     END-IF.                                                      18550099
185600*                                                                 18560099
185700******* OUTBOUND CHARGES                                          18570099
185800     IF ASC-OUTBND-CHRGS-X > SPACES                               18580099
185900         MOVE ASC-OUTBND-CHRGS-X TO DP010I-UNEDITED-FIELD         18590099
186000         MOVE 9                  TO DP010I-MAXIMUM-DIGITS         18600099
186100         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       18610099
186200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  18620099
186300         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18630099
186400                         USING DP010I-NUMERIC-EDIT-AREA           18640099
186500                                                                  18650099
186600         IF DP010I-ERROR-DETECTED                                 18660099
186700             SET PS-ERROR                                         18670099
186800                 DP020-MSG-FATAL                                  18680099
186900                 DP030-SET-CURSOR-APPL-1 TO TRUE                  18690099
187000             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       18700099
187100             MOVE DP015-UNP-NUM-BRT-MDT TO AOUTCHGA               18710099
187200             MOVE DP015-RED             TO AOUTCHGC               18720099
187300             MOVE DP015-REVERSE         TO AOUTCHGH               18730099
187400             MOVE -1                    TO AOUTCHGL               18740099
187500         END-IF                                                   18750099
187600*                                                                 18760099
187700         IF DP010I-NO-DECIMAL-POINT-FOUND                         18770099
187800************* NO DECIMAL POINT FOUND                              18780099
187900             IF DP010I-DIGIT-COUNT < 10 AND                       18790099
188000************* MEANING 9 DIGITS OR LESS                            18800099
188100                 DP010I-DECIMAL-COUNT = 0                         18810099
188200************* AND NO DECIMALS                                     18820099
188300                 MOVE DP010I-NUMERIC-FIELD                        18830099
188400                                       TO PV-HOLD-NEW-AMT-UNPACK  18840099
188500************* CHECK THE NUMBER OF LEADING ZEROS IF PV-ZERO-CTR    18850099
188600************* GREATER THAN OR EQUAL TO 3, THAT MEANS THE NUMBER   18860099
188700************* IS LESS THAN 999999.99 AND IS OK, OTHERWISE IT IS   18870099
188800************* TOO BIG AND IS AN ERROR.                            18880099
188900                 INSPECT PV-HOLD-NEW-AMT-DIGITS TALLYING          18890099
189000                     PV-ZERO-CTR FOR LEADING ZEROS                18900099
189100                 IF  PV-ZERO-CTR >= 3                             18910099
189200                     IF PS-KOHLS-PAID                             18920099
189300                         MOVE PV-HOLD-NEW-AMT-DIGITS              18930099
189400                                           TO PV-NEW-AMT-9        18940099
189500                         MOVE PV-NEW-AMT   TO ASC-OUTBND-CHRGS    18950099
189600                                              ASC-INBND-CHRGS     18960099
189700                     ELSE                                         18970099
189800                         MOVE PV-HOLD-NEW-AMT-DIGITS              18980099
189900                                           TO PV-NEW-AMT-9        18990099
190000                         MOVE PV-NEW-AMT   TO ASC-OUTBND-CHRGS    19000099
190100                         MOVE +0           TO ASC-INBND-CHRGS     19010099
190200                     END-IF                                       19020099
190300                 ELSE                                             19030099
190400                     SET PS-ERROR                                 19040099
190500                         DP020-MSG-FATAL                          19050099
190600                         DP030-SET-CURSOR-APPL-1                  19060099
190700                                           TO TRUE                19070099
190800                     MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    19080099
190900                     MOVE DP015-UNP-NUM-BRT-MDT                   19090099
191000                                           TO AOUTCHGA            19100099
191100                     MOVE DP015-RED        TO AOUTCHGC            19110099
191200                     MOVE DP015-REVERSE    TO AOUTCHGH            19120099
191300                     MOVE -1               TO AOUTCHGL            19130099
191400                 END-IF                                           19140099
191500             ELSE                                                 19150099
191600                 SET PS-ERROR                                     19160099
191700                     DP020-MSG-FATAL                              19170099
191800                     DP030-SET-CURSOR-APPL-1                      19180099
191900                                           TO TRUE                19190099
192000                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    19200099
192100                 MOVE DP015-UNP-NUM-BRT-MDT                       19210099
192200                                           TO AOUTCHGA            19220099
192300                 MOVE DP015-RED            TO AOUTCHGC            19230099
192400                 MOVE DP015-REVERSE        TO AOUTCHGH            19240099
192500                 MOVE -1                   TO AOUTCHGL            19250099
192600             END-IF                                               19260099
192700         ELSE                                                     19270099
192800*************  DECIMAL POINT FOUND                                19280099
192900             IF DP010I-DIGIT-COUNT < 7 AND                        19290099
193000                 DP010I-DECIMAL-COUNT = 2                         19300099
193100                 IF PS-KOHLS-PAID                                 19310099
193200                     MOVE DP010I-NUMERIC-FIELD                    19320099
193300                                           TO ASC-OUTBND-CHRGS    19330099
193400                                              ASC-INBND-CHRGS     19340099
193500                 ELSE                                             19350099
193600                     MOVE DP010I-NUMERIC-FIELD                    19360099
193700                                           TO ASC-OUTBND-CHRGS    19370099
193800                     MOVE +0               TO ASC-INBND-CHRGS     19380099
193900                 END-IF                                           19390099
194000             ELSE                                                 19400099
194100                 SET PS-ERROR                                     19410099
194200                     DP020-MSG-FATAL                              19420099
194300                     DP030-SET-CURSOR-APPL-1                      19430099
194400                                           TO TRUE                19440099
194500                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    19450099
194600                 MOVE DP015-UNP-NUM-BRT-MDT                       19460099
194700                                           TO AOUTCHGA            19470099
194800                 MOVE DP015-RED            TO AOUTCHGC            19480099
194900                 MOVE DP015-REVERSE        TO AOUTCHGH            19490099
195000                 MOVE -1                   TO AOUTCHGL            19500099
195100             END-IF                                               19510099
195200         END-IF                                                   19520099
195300     END-IF.                                                      19530099
195400*                                                                 19540099
195500******* RETURN REASON                                             19550099
195600     IF ASC-RET-RSN > SPACES                                      19560099
195700         IF ASC-VALID-RET-RSN                                     19570099
195800             CONTINUE                                             19580099
195900         ELSE                                                     19590099
196000             SET PS-ERROR            TO TRUE                      19600099
196100             SET DP020-MSG-FATAL     TO TRUE                      19610099
196200             MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER          19620099
196300             MOVE DP015-UNP-ALP-BRT-MDT                           19630099
196400                                     TO ARETRSNA                  19640099
196500             MOVE DP015-RED          TO ARETRSNC                  19650099
196600             MOVE DP015-REVERSE      TO ARETRSNH                  19660099
196700             MOVE -1                 TO ARETRSNL                  19670099
196800             SET DP030-SET-CURSOR-APPL-1                          19680099
196900                                     TO TRUE                      19690099
197000         END-IF                                                   19700099
197100     ELSE                                                         19710099
197200         SET PS-ERROR                TO TRUE                      19720099
197300         SET DP020-MSG-FATAL         TO TRUE                      19730099
197400         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          19740099
197500         MOVE DP015-UNP-ALP-BRT-MDT  TO ARETRSNA                  19750099
197600         MOVE DP015-RED              TO ARETRSNC                  19760099
197700         MOVE DP015-REVERSE          TO ARETRSNH                  19770099
197800         MOVE -1                     TO ARETRSNL                  19780099
197900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      19790099
198000     END-IF.                                                      19800099
198100*                                                                 19810099
198200******* DEDUCTION AMT GIVEN AS PART OF VENDOR AGREEMENT           19820099
198300     IF  ASC-DED-CHRG-AMT-X > SPACES                              19830099
198400         MOVE ASC-DED-CHRG-AMT-X TO DP010I-UNEDITED-FIELD         19840099
198500         MOVE 9                  TO DP010I-MAXIMUM-DIGITS         19850099
198600         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       19860099
198700         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  19870099
198800         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19880099
198900                         USING DP010I-NUMERIC-EDIT-AREA           19890099
199000                                                                  19900099
199100         IF DP010I-ERROR-DETECTED                                 19910099
199200             SET PS-ERROR                                         19920099
199300                 DP020-MSG-FATAL                                  19930099
199400                 DP030-SET-CURSOR-APPL-1 TO TRUE                  19940099
199500             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       19950099
199600             MOVE DP015-UNP-NUM-BRT-MDT TO ADEDUCTA               19960099
199700             MOVE DP015-RED             TO ADEDUCTC               19970099
199800             MOVE DP015-REVERSE         TO ADEDUCTH               19980099
199900             MOVE -1                    TO ADEDUCTL               19990099
200000         END-IF                                                   20000099
200100                                                                  20010099
200200         IF DP010I-NO-DECIMAL-POINT-FOUND                         20020099
200300************* NO DECIMAL POINT FOUND                              20030099
200400             IF DP010I-DIGIT-COUNT < 10 AND                       20040099
200500************* MEANING 9 DIGITS OR LESS                            20050099
200600                 DP010I-DECIMAL-COUNT = 0                         20060099
200700************* AND NO DECIMALS                                     20070099
200800                 MOVE DP010I-NUMERIC-FIELD                        20080099
200900                                       TO PV-HOLD-NEW-AMT-UNPACK  20090099
201000************* CHECK THE NUMBER OF LEADING ZEROS IF PV-ZERO-CTR    20100099
201100************* GREATER THAN OR EQUAL TO 3, THAT MEANS THE NUMBER   20110099
201200************* IS LESS THAN 999999.99 AND IS OK, OTHERWISE IT IS   20120099
201300************* TOO BIG AND IS AN ERROR.                            20130099
201400                 INSPECT PV-HOLD-NEW-AMT-DIGITS TALLYING          20140099
201500                     PV-ZERO-CTR FOR LEADING ZEROS                20150099
201600                 IF  PV-ZERO-CTR >= 3                             20160099
201700                     MOVE PV-HOLD-NEW-AMT-DIGITS                  20170099
201800                                           TO PV-NEW-AMT-9        20180099
201900                     MOVE PV-NEW-AMT       TO ASC-DED-CHRG-AMT    20190099
202000                 ELSE                                             20200099
202100                     SET PS-ERROR                                 20210099
202200                         DP020-MSG-FATAL                          20220099
202300                         DP030-SET-CURSOR-APPL-1                  20230099
202400                                           TO TRUE                20240099
202500                     MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    20250099
202600                     MOVE DP015-UNP-NUM-BRT-MDT                   20260099
202700                                           TO ADEDUCTA            20270099
202800                     MOVE DP015-RED        TO ADEDUCTC            20280099
202900                     MOVE DP015-REVERSE    TO ADEDUCTH            20290099
203000                     MOVE -1               TO ADEDUCTL            20300099
203100                 END-IF                                           20310099
203200             ELSE                                                 20320099
203300                 SET PS-ERROR                                     20330099
203400                     DP020-MSG-FATAL                              20340099
203500                     DP030-SET-CURSOR-APPL-1                      20350099
203600                                           TO TRUE                20360099
203700                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    20370099
203800                 MOVE DP015-UNP-NUM-BRT-MDT                       20380099
203900                                           TO ADEDUCTA            20390099
204000                 MOVE DP015-RED            TO ADEDUCTC            20400099
204100                 MOVE DP015-REVERSE        TO ADEDUCTH            20410099
204200                 MOVE -1                   TO ADEDUCTL            20420099
204300             END-IF                                               20430099
204400         ELSE                                                     20440099
204500*************  DECIMAL POINT FOUND                                20450099
204600             IF DP010I-DIGIT-COUNT < 7 AND                        20460099
204700                 DP010I-DECIMAL-COUNT = 2                         20470099
204800                 MOVE DP010I-NUMERIC-FIELD TO ASC-DED-CHRG-AMT    20480099
204900             ELSE                                                 20490099
205000                 SET PS-ERROR                                     20500099
205100                     DP020-MSG-FATAL                              20510099
205200                     DP030-SET-CURSOR-APPL-1                      20520099
205300                                           TO TRUE                20530099
205400                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    20540099
205500                 MOVE DP015-UNP-NUM-BRT-MDT                       20550099
205600                                           TO ADEDUCTA            20560099
205700                 MOVE DP015-RED            TO ADEDUCTC            20570099
205800                 MOVE DP015-REVERSE        TO ADEDUCTH            20580099
205900                 MOVE -1                   TO ADEDUCTL            20590099
206000             END-IF                                               20600099
206100         END-IF                                                   20610099
206200     END-IF.                                                      20620099
206300*                                                                 20630099
206400****************************************************************  20640099
206500* IF DEDUCTION AMT IS ENTERED, CALCULATE A DISCOUNT PERCENT.      20650099
206600* THIS VALUE IS NEEDED FOR ACCOUNTS PAYABLE.                      20660099
206700****************************************************************  20670099
206800     IF PS-NO-ERROR                                               20680099
206900         IF ASC-DED-CHRG-AMT > 0                                  20690099
207000             MOVE ASC-DED-CHRG-AMT                                20700099
207100                                 TO PV-DED-CHRG-DISC-AMT          20710099
207200             MOVE ASC-TOTAL-COST TO PV-TOTAL-COST                 20720099
207300             COMPUTE ASC-DED-CHRG-PCT ROUNDED =                   20730099
207400                (PV-DED-CHRG-DISC-AMT / PV-TOTAL-COST) * 100      20740099
207500         END-IF                                                   20750099
207600     END-IF.                                                      20760099
207700*                                                                 20770099
207800******* DISCOUNT PERCENT                                          20780099
207900     IF  ASC-DISC-PCT-X > SPACES                                  20790099
208000         MOVE ASC-DISC-PCT-X     TO DP010I-UNEDITED-FIELD         20800099
208100         MOVE 5                  TO DP010I-MAXIMUM-DIGITS         20810099
208200         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       20820099
208300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  20830099
208400         CALL DP010I-NUMERIC-EDIT-ROUTINE                         20840099
208500                         USING DP010I-NUMERIC-EDIT-AREA           20850099
208600                                                                  20860099
208700         IF DP010I-ERROR-DETECTED                                 20870099
208800             SET PS-ERROR                                         20880099
208900                 DP020-MSG-FATAL                                  20890099
209000                 DP030-SET-CURSOR-APPL-1 TO TRUE                  20900099
209100             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       20910099
209200             MOVE DP015-UNP-NUM-BRT-MDT TO ADSCPCTA               20920099
209300             MOVE DP015-RED             TO ADSCPCTC               20930099
209400             MOVE DP015-REVERSE         TO ADSCPCTH               20940099
209500             MOVE -1                    TO ADSCPCTL               20950099
209600         END-IF                                                   20960099
209700                                                                  20970099
209800         IF DP010I-NO-DECIMAL-POINT-FOUND                         20980099
209900************* NO DECIMAL POINT FOUND                              20990099
210000             IF DP010I-DIGIT-COUNT < 6 AND                        21000099
210100************* MEANING 5 DIGITS OR LESS                            21010099
210200                 DP010I-DECIMAL-COUNT = 0                         21020099
210300************* AND NO DECIMALS                                     21030099
210400                 MOVE DP010I-NUMERIC-FIELD                        21040099
210500                                       TO PV-HOLD-NEW-AMT-UNPACK  21050099
210600************* CHECK THE NUMBER OF LEADING ZEROS IF PV-ZERO-CTR    21060099
210700************* GREATER THAN OR EQUAL TO 6, THAT MEANS THE NUMBER   21070099
210800************* IS LESS THAN 999.99 AND IS OK, OTHERWISE IT IS      21080099
210900************* TOO BIG AND IS AN ERROR.  AN ADDITIONAL CHECK IS    21090099
211000************* ADDED TO ENSURE THE NUMBER IS NOT GREATER THAN 100. 21100099
211100                 INSPECT PV-HOLD-NEW-AMT-DIGITS TALLYING          21110099
211200                     PV-ZERO-CTR FOR LEADING ZEROS                21120099
211300                 IF  PV-ZERO-CTR >= 6                             21130099
211400                     MOVE PV-HOLD-NEW-AMT-DIGITS                  21140099
211500                                           TO PV-NEW-AMT-9        21150099
211600                     IF PV-NEW-AMT <= 100                         21160099
211700                         MOVE PV-NEW-AMT   TO ASC-DISC-PCT        21170099
211800                     ELSE                                         21180099
211900                         SET PS-ERROR                             21190099
212000                             DP020-MSG-FATAL                      21200099
212100                             DP030-SET-CURSOR-APPL-1              21210099
212200                                           TO TRUE                21220099
212300                         MOVE PC-TSYMSG-00008                     21230099
212400                                           TO DP020-MSG-NUMBER    21240099
212500                         MOVE DP015-UNP-NUM-BRT-MDT               21250099
212600                                           TO ADSCPCTA            21260099
212700                         MOVE DP015-RED    TO ADSCPCTC            21270099
212800                         MOVE DP015-REVERSE                       21280099
212900                                           TO ADSCPCTH            21290099
213000                         MOVE -1           TO ADSCPCTL            21300099
213100                     END-IF                                       21310099
213200                 ELSE                                             21320099
213300                     SET PS-ERROR                                 21330099
213400                         DP020-MSG-FATAL                          21340099
213500                         DP030-SET-CURSOR-APPL-1                  21350099
213600                                           TO TRUE                21360099
213700                     MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    21370099
213800                     MOVE DP015-UNP-NUM-BRT-MDT                   21380099
213900                                           TO ADSCPCTA            21390099
214000                     MOVE DP015-RED        TO ADSCPCTC            21400099
214100                     MOVE DP015-REVERSE    TO ADSCPCTH            21410099
214200                     MOVE -1               TO ADSCPCTL            21420099
214300                 END-IF                                           21430099
214400             ELSE                                                 21440099
214500                 SET PS-ERROR                                     21450099
214600                     DP020-MSG-FATAL                              21460099
214700                     DP030-SET-CURSOR-APPL-1                      21470099
214800                                           TO TRUE                21480099
214900                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    21490099
215000                 MOVE DP015-UNP-NUM-BRT-MDT                       21500099
215100                                           TO ADSCPCTA            21510099
215200                 MOVE DP015-RED            TO ADSCPCTC            21520099
215300                 MOVE DP015-REVERSE        TO ADSCPCTH            21530099
215400                 MOVE -1                   TO ADSCPCTL            21540099
215500             END-IF                                               21550099
215600         ELSE                                                     21560099
215700*************  DECIMAL POINT FOUND                                21570099
215800             IF DP010I-DIGIT-COUNT < 4 AND                        21580099
215900                 DP010I-DECIMAL-COUNT = 2                         21590099
216000                 IF DP010I-NUMERIC-FIELD <= 100                   21600099
216100                     MOVE DP010I-NUMERIC-FIELD                    21610099
216200                                           TO ASC-DISC-PCT        21620099
216300                 ELSE                                             21630099
216400                     SET PS-ERROR                                 21640099
216500                         DP020-MSG-FATAL                          21650099
216600                         DP030-SET-CURSOR-APPL-1                  21660099
216700                                           TO TRUE                21670099
216800                     MOVE PC-TSYMSG-01912  TO DP020-MSG-NUMBER    21680099
216900                     MOVE DP015-UNP-NUM-BRT-MDT                   21690099
217000                                           TO ADSCPCTA            21700099
217100                     MOVE DP015-RED        TO ADSCPCTC            21710099
217200                     MOVE DP015-REVERSE    TO ADSCPCTH            21720099
217300                     MOVE -1               TO ADSCPCTL            21730099
217400                 END-IF                                           21740099
217500             ELSE                                                 21750099
217600                 SET PS-ERROR                                     21760099
217700                     DP020-MSG-FATAL                              21770099
217800                     DP030-SET-CURSOR-APPL-1                      21780099
217900                                           TO TRUE                21790099
218000                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    21800099
218100                 MOVE DP015-UNP-NUM-BRT-MDT                       21810099
218200                                           TO ADSCPCTA            21820099
218300                 MOVE DP015-RED            TO ADSCPCTC            21830099
218400                 MOVE DP015-REVERSE        TO ADSCPCTH            21840099
218500                 MOVE -1                   TO ADSCPCTL            21850099
218600             END-IF                                               21860099
218700         END-IF                                                   21870099
218800     END-IF.                                                      21880099
218900                                                                  21890099
219000******* DISCOUNT AMOUNT                                           21900099
219100     IF  ASC-DISC-AMT-X > SPACES                                  21910099
219200         MOVE ASC-DISC-AMT-X     TO DP010I-UNEDITED-FIELD         21920099
219300         MOVE 9                  TO DP010I-MAXIMUM-DIGITS         21930099
219400         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       21940099
219500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  21950099
219600         CALL DP010I-NUMERIC-EDIT-ROUTINE                         21960099
219700                         USING DP010I-NUMERIC-EDIT-AREA           21970099
219800                                                                  21980099
219900         IF DP010I-ERROR-DETECTED                                 21990099
220000             SET PS-ERROR                                         22000099
220100                 DP020-MSG-FATAL                                  22010099
220200                 DP030-SET-CURSOR-APPL-1 TO TRUE                  22020099
220300             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       22030099
220400             MOVE DP015-UNP-NUM-BRT-MDT TO ADISCNTA               22040099
220500             MOVE DP015-RED             TO ADISCNTC               22050099
220600             MOVE DP015-REVERSE         TO ADISCNTH               22060099
220700             MOVE -1                    TO ADISCNTL               22070099
220800         END-IF                                                   22080099
220900         IF DP010I-NO-DECIMAL-POINT-FOUND                         22090099
221000************* NO DECIMAL POINT FOUND                              22100099
221100             IF DP010I-DIGIT-COUNT < 10 AND                       22110099
221200************* MEANING 9 DIGITS OR LESS                            22120099
221300                 DP010I-DECIMAL-COUNT = 0                         22130099
221400************* AND NO DECIMALS                                     22140099
221500                 MOVE DP010I-NUMERIC-FIELD                        22150099
221600                                       TO PV-HOLD-NEW-AMT-UNPACK  22160099
221700************* CHECK THE NUMBER OF LEADING ZEROS IF PV-ZERO-CTR    22170099
221800************* GREATER THAN OR EQUAL TO 3, THAT MEANS THE NUMBER   22180099
221900************* IS LESS THAN 999999.99 AND IS OK, OTHERWISE IT IS   22190099
222000************* TOO BIG AND IS AN ERROR.                            22200099
222100                 INSPECT PV-HOLD-NEW-AMT-DIGITS TALLYING          22210099
222200                     PV-ZERO-CTR FOR LEADING ZEROS                22220099
222300                 IF  PV-ZERO-CTR >= 3                             22230099
222400                     MOVE PV-HOLD-NEW-AMT-DIGITS                  22240099
222500                                           TO PV-NEW-AMT-9        22250099
222600                     MOVE PV-NEW-AMT       TO ASC-DISC-AMT        22260099
222700                 ELSE                                             22270099
222800                     SET PS-ERROR                                 22280099
222900                         DP020-MSG-FATAL                          22290099
223000                         DP030-SET-CURSOR-APPL-1                  22300099
223100                                           TO TRUE                22310099
223200                     MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER    22320099
223300                     MOVE DP015-UNP-NUM-BRT-MDT                   22330099
223400                                           TO ADISCNTA            22340099
223500                     MOVE DP015-RED        TO ADISCNTC            22350099
223600                     MOVE DP015-REVERSE    TO ADISCNTH            22360099
223700                     MOVE -1               TO ADISCNTL            22370099
223800                 END-IF                                           22380099
223900             ELSE                                                 22390099
224000                 SET PS-ERROR                                     22400099
224100                     DP020-MSG-FATAL                              22410099
224200                     DP030-SET-CURSOR-APPL-1                      22420099
224300                                           TO TRUE                22430099
224400                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    22440099
224500                 MOVE DP015-UNP-NUM-BRT-MDT                       22450099
224600                                           TO ADISCNTA            22460099
224700                 MOVE DP015-RED            TO ADISCNTC            22470099
224800                 MOVE DP015-REVERSE        TO ADISCNTH            22480099
224900                 MOVE -1                   TO ADISCNTL            22490099
225000             END-IF                                               22500099
225100         ELSE                                                     22510099
225200*************  DECIMAL POINT FOUND                                22520099
225300             IF DP010I-DIGIT-COUNT < 7 AND                        22530099
225400                 DP010I-DECIMAL-COUNT = 2                         22540099
225500                 MOVE DP010I-NUMERIC-FIELD TO ASC-DISC-AMT        22550099
225600             ELSE                                                 22560099
225700                 SET PS-ERROR                                     22570099
225800                     DP020-MSG-FATAL                              22580099
225900                     DP030-SET-CURSOR-APPL-1                      22590099
226000                                           TO TRUE                22600099
226100                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    22610099
226200                 MOVE DP015-UNP-NUM-BRT-MDT                       22620099
226300                                           TO ADISCNTA            22630099
226400                 MOVE DP015-RED            TO ADISCNTC            22640099
226500                 MOVE DP015-REVERSE        TO ADISCNTH            22650099
226600                 MOVE -1                   TO ADISCNTL            22660099
226700             END-IF                                               22670099
226800         END-IF                                                   22680099
226900     END-IF.                                                      22690099
227000                                                                  22700099
227100****************************************************************  22710099
227200* IF DISCOUNT AMT ENTERED, CALCULATE DISCOUNT PCT.  OTHERWISE,    22720099
227300* IF DISCOUNT PCT ENTERED, CALCULATE DISCOUNT AMT.                22730099
227400****************************************************************  22740099
227500     IF PS-NO-ERROR                                               22750099
227600         EVALUATE TRUE                                            22760099
227700* DISCOUNT AMOUNT FILLED IN, BUT DISCOUNT PERCENT IS STILL ZERO   22770099
227800* IF THE DISCOUNT PERCENT WAS CHANGED TO ZERO, WE WANT TO ALSO    22780099
227900* ZERO OUT THE DISCOUNT AMOUNT FIELD.                             22790099
228000             WHEN ASC-DISC-AMT > 0 AND                            22800099
228100                  ASC-DISC-PCT = 0                                22810099
228200               IF ASC-DISC-PCT NOT = ASC-DISC-PCT-OLD             22820099
228300                   MOVE ZERO         TO ASC-DISC-PCT              22830099
228400                                        ASC-DISC-PCT-OLD          22840099
228500                                        ASC-DISC-AMT              22850099
228600                                        ASC-DISC-AMT-OLD          22860099
228700               ELSE                                               22870099
228800                   MOVE ASC-DISC-AMT TO PV-DED-CHRG-DISC-AMT      22880099
228900                   MOVE ASC-TOTAL-COST                            22890099
229000                                     TO PV-TOTAL-COST             22900099
229100                   COMPUTE ASC-DISC-PCT ROUNDED =                 22910099
229200                      (PV-DED-CHRG-DISC-AMT / PV-TOTAL-COST) * 10022920099
229300                   MOVE ASC-DISC-PCT TO ASC-DISC-PCT-OLD          22930099
229400                   MOVE ASC-DISC-AMT TO ASC-DISC-AMT-OLD          22940099
229500               END-IF                                             22950099
229600                                                                  22960099
229700* DISCOUNT PERCENT FILLED IN, BUT DISCOUNT AMOUNT IS STILL ZERO   22970099
229800* IF THE DISCOUNT AMOUNT WAS CHANGED TO ZERO, WE WANT TO ALSO     22980099
229900* ZERO OUT THE DISCOUNT PERCENT FIELD.                            22990099
230000             WHEN ASC-DISC-PCT > 0 AND                            23000099
230100                  ASC-DISC-AMT = 0                                23010099
230200               IF ASC-DISC-AMT NOT = ASC-DISC-AMT-OLD             23020099
230300                   MOVE ZERO         TO ASC-DISC-PCT              23030099
230400                                        ASC-DISC-PCT-OLD          23040099
230500                                        ASC-DISC-AMT              23050099
230600                                        ASC-DISC-AMT-OLD          23060099
230700               ELSE                                               23070099
230800                   COMPUTE ASC-DISC-AMT ROUNDED =                 23080099
230900                      ASC-TOTAL-COST * ASC-DISC-PCT / 100         23090099
231000                   MOVE ASC-DISC-AMT TO ASC-DISC-AMT-OLD          23100099
231100                   MOVE ASC-DISC-PCT TO ASC-DISC-PCT-OLD          23110099
231200               END-IF                                             23120099
231300                                                                  23130099
231400* DISCOUNT AMOUNT AND DISCOUNT PERCENT ARE BOTH FILLED IN.  IN    23140099
231500* THIS CASE, THE DISCOUNT AMOUNT HAS BEEN UPDATED ON THE SCREEN.  23150099
231600* THE DISCOUNT PERCENT NEEDS TO BE RECALCULATED.                  23160099
231700             WHEN ASC-DISC-AMT NOT = ASC-DISC-AMT-OLD             23170099
231800                 MOVE ASC-DISC-AMT   TO PV-DED-CHRG-DISC-AMT      23180099
231900                                        ASC-DISC-AMT-OLD          23190099
232000                 MOVE ASC-TOTAL-COST TO PV-TOTAL-COST             23200099
232100                 COMPUTE ASC-DISC-PCT ROUNDED =                   23210099
232200                    (PV-DED-CHRG-DISC-AMT / PV-TOTAL-COST) * 100  23220099
232300                 MOVE ASC-DISC-PCT   TO ASC-DISC-PCT-OLD          23230099
232400                                                                  23240099
232500* DISCOUNT AMOUNT AND DISCOUNT PERCENT ARE BOTH FILLED IN.  IN    23250099
232600* THIS CASE, THE DISCOUNT PERCENT HAS BEEN UPDATED ON THE SCREEN. 23260099
232700* THE DISCOUNT AMOUNT NEEDS TO BE RECALCULATED.                   23270099
232800             WHEN ASC-DISC-PCT NOT = ASC-DISC-PCT-OLD             23280099
232900                 COMPUTE ASC-DISC-AMT ROUNDED =                   23290099
233000                    ASC-TOTAL-COST * ASC-DISC-PCT / 100           23300099
233100                 MOVE ASC-DISC-AMT TO ASC-DISC-AMT-OLD            23310099
233200                 MOVE ASC-DISC-PCT TO ASC-DISC-PCT-OLD            23320099
233300                                                                  23330099
233400         END-EVALUATE                                             23340099
233500     END-IF.                                                      23350099
233600*                                                                 23360099
233700****************************************************************  23370099
233800* CANNOT ENTER BOTH A DEDUCTION AND A DISCOUNT (PCT OR AMT)       23380099
233900****************************************************************  23390099
234000     IF (ASC-DED-CHRG-AMT > 0) AND                                23400099
234100         (ASC-DISC-AMT > 0 OR                                     23410099
234200          ASC-DISC-PCT > 0)                                       23420099
234300         SET PS-ERROR                                             23430099
234400             DP020-MSG-FATAL                                      23440099
234500             DP030-SET-CURSOR-APPL-1 TO TRUE                      23450099
234600         MOVE PC-TSYMSG-03157        TO DP020-MSG-NUMBER          23460099
234700         MOVE DP015-UNP-NUM-BRT-MDT  TO ADISCNTA                  23470099
234800                                        ADSCPCTA                  23480099
234900                                        ADEDUCTA                  23490099
235000         MOVE DP015-RED              TO ADISCNTC                  23500099
235100                                        ADSCPCTC                  23510099
235200                                        ADEDUCTC                  23520099
235300         MOVE DP015-REVERSE          TO ADISCNTH                  23530099
235400                                        ADSCPCTH                  23540099
235500                                        ADEDUCTH                  23550099
235600         MOVE -1                     TO ADEDUCTL                  23560099
235700     END-IF                                                       23570099
235800*                                                                 23580099
235900******* PAYMENT TYPE = PREPAID OR COLLECT, IF COLLECT NO          23590099
236000*******     OUTBOUND OR INBOUND CHARGES CAN BE ENTERED            23600099
236100     IF ASC-PAYT-TYPE > SPACES                                    23610099
236200         IF ASC-PAYT-TYPE = 'P'                                   23620099
236300             CONTINUE                                             23630099
236400         ELSE                                                     23640099
236500             IF ASC-PAYT-TYPE = 'C'                               23650099
236600                 MOVE 0 TO ASC-INBND-CHRGS                        23660099
236700                           ASC-OUTBND-CHRGS                       23670099
236800             ELSE                                                 23680099
236900                 SET PS-ERROR        TO TRUE                      23690099
237000                 SET DP020-MSG-FATAL TO TRUE                      23700099
237100                 MOVE PC-TSYMSG-00005                             23710099
237200                                     TO DP020-MSG-NUMBER          23720099
237300                 MOVE DP015-UNP-ALP-BRT-MDT                       23730099
237400                                     TO APAYTYPA                  23740099
237500                 MOVE DP015-RED      TO APAYTYPC                  23750099
237600                 MOVE DP015-REVERSE  TO APAYTYPH                  23760099
237700                 MOVE -1             TO APAYTYPL                  23770099
237800                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              23780099
237900             END-IF                                               23790099
238000         END-IF                                                   23800099
238100     ELSE                                                         23810099
238200         SET PS-ERROR                TO TRUE                      23820099
238300         SET DP020-MSG-FATAL         TO TRUE                      23830099
238400         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          23840099
238500         MOVE DP015-UNP-ALP-BRT-MDT  TO APAYTYPA                  23850099
238600         MOVE DP015-RED              TO APAYTYPC                  23860099
238700         MOVE DP015-REVERSE          TO APAYTYPH                  23870099
238800         MOVE -1                     TO APAYTYPL                  23880099
238900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      23890099
239000     END-IF.                                                      23900099
239100                                                                  23910099
239200******* GRAND TOTAL = TOTAL UNIT COST PLUS ANY CHARGES AND MINUS  23920099
239300*******     ANY DEDUCTIONS OR DISCOUNTS                           23930099
239400                                                                  23940099
239500     IF  ASC-GRAND-TOTAL-X > SPACES                               23950099
239600         MOVE ASC-GRAND-TOTAL-X TO DP010I-UNEDITED-FIELD          23960099
239700         MOVE 6                  TO DP010I-MAXIMUM-DIGITS         23970099
239800         MOVE 2                  TO DP010I-MAXIMUM-DECIMALS       23980099
239900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  23990099
240000         CALL DP010I-NUMERIC-EDIT-ROUTINE                         24000099
240100                         USING DP010I-NUMERIC-EDIT-AREA           24010099
240200                                                                  24020099
240300         IF DP010I-NO-ERROR-DETECTED                              24030099
240400             MOVE DP010I-NUMERIC-FIELD  TO ASC-GRAND-TOTAL        24040099
240500         ELSE                                                     24050099
240600             SET PS-ERROR                                         24060099
240700                 DP020-MSG-FATAL                                  24070099
240800                 DP030-SET-CURSOR-APPL-1 TO TRUE                  24080099
240900             MOVE PC-TSYMSG-00008       TO DP020-MSG-NUMBER       24090099
241000             MOVE DP015-UNP-NUM-BRT-MDT TO AGTOTALA               24100099
241100             MOVE DP015-RED             TO AGTOTALC               24110099
241200             MOVE DP015-REVERSE         TO AGTOTALH               24120099
241300             MOVE -1                    TO AGTOTALL               24130099
241400         END-IF                                                   24140099
241500     END-IF.                                                      24150099
241600****************************************************************  24160099
241700******* GRAND TOTAL = TOTAL UNIT COST PLUS ANY CHARGES AND MINUS  24170099
241800*******     ANY DEDUCTIONS OR DISCOUNTS                           24180099
241900****************************************************************  24190099
242000     IF  PS-NO-ERROR                                              24200099
242100         COMPUTE PV-GRAND-TOTAL =                                 24210099
242200             ASC-TOTAL-COST + ASC-OUTBND-CHRGS +                  24220099
242300             ASC-INBND-CHRGS - ASC-DED-CHRG-AMT - ASC-DISC-AMT    24230099
242400         IF PV-GRAND-TOTAL >= ZERO                                24240099
242500             MOVE PV-GRAND-TOTAL     TO ASC-GRAND-TOTAL           24250099
242600         ELSE                                                     24260099
242700             SET PS-ERROR                                         24270099
242800                 DP020-MSG-FATAL                                  24280099
242900                 DP030-SET-CURSOR-APPL-1 TO TRUE                  24290099
243000             MOVE PC-TSYMSG-03232       TO DP020-MSG-NUMBER       24300099
243100             MOVE DP015-UNP-NUM-BRT-MDT TO ADISCNTA               24310099
243200                                           ADSCPCTA               24320099
243300                                           ADEDUCTA               24330099
243400             MOVE DP015-RED             TO ADISCNTC               24340099
243500                                           ADSCPCTC               24350099
243600                                           ADEDUCTC               24360099
243700             MOVE DP015-REVERSE         TO ADISCNTH               24370099
243800                                           ADSCPCTH               24380099
243900                                           ADEDUCTH               24390099
244000             MOVE -1                    TO ADEDUCTL               24400099
244100         END-IF                                                   24410099
244200     END-IF.                                                      24420099
244300*                                                                 24430099
244400     IF  PS-NO-ERROR                                              24440099
244500         MOVE -1                     TO AAUTHIDL                  24450099
244600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      24460099
244700     END-IF.                                                      24470099
244800*                                                                 24480099
244900*----------------------------------------------------------------*24490099
245000* RESET ATTRIBUTES -- DEPENDING ON THE STATUS THE LISTING IS     *24500099
245100*    (CLOSED, APPROVED, DEBIT/DISPOSE) THE ATTRIBUTES OF THE     *24510099
245200*    FIELDS NEED TO BE SET DIFFERENTLY. PAYT-TYPE OF 'C' ALSO    *24520099
245300*    AFFECTS THE ATTRIBUTES OF THE FIELDS.                       *24530099
245400*    ALSO CHECK IF KOHLS OR VENDOR PAID THE INCOMING FRGT CHRGS  *24540099
245500*----------------------------------------------------------------*24550099
245600 3200-RESET-ATTRIBUTES.                                           24560099
245700     EVALUATE TRUE                                                24570099
245800         WHEN ASC-STATUS = 'APPROVED'                             24580099
245900             PERFORM 3210-APPROVED-ATTRIBUTES                     24590099
246000         WHEN DP020-FK-LOCAL-FUNC-04 (DP020-SRC-AID) OR           24600099
246100              ASC-LIST-TYPE = 'D & D' OR                          24610099
246200              ASC-RTV-TO-DND                                      24620099
246300             PERFORM 3220-DEBIT-DISP-ATTRIBUTES                   24630099
246400         WHEN ASC-PAYT-TYPE = 'C'                                 24640099
246500             PERFORM 3240-COLLECT-ATTRIBUTES                      24650099
246600         WHEN OTHER                                               24660099
246700             PERFORM 3230-NORMAL-ATTRIBUTES                       24670099
246800     END-EVALUATE.                                                24680099
246900                                                                  24690099
247000     MOVE ASC-ENT-ID      TO DK-ENT-ID.                           24700099
247100     MOVE ASC-DEPT-NBR    TO DK-DEPT-NBR.                         24710099
247200     MOVE ASC-DFCT-ORD-ID TO DK-DFCT-ORD-ID.                      24720099
247300                                                                  24730099
247400     PERFORM 3420-SELECT-TVNDAGR-1.                               24740099
247500     PERFORM 3430-CHK-FRGT-TERMS.                                 24750099
247600                                                                  24760099
247700*----------------------------------------------------------------*24770099
247800* WHEN THE STATUS OF A LISTING HAS BEEN SET TO APPROVED BECAUSE  *24780099
247900*    THE TRANSACTION WAS SENT TO AP, ONLY THE COMMENT FIELD CAN  *24790099
248000*    BE UPDATED                                                  *24800099
248100*----------------------------------------------------------------*24810099
248200 3210-APPROVED-ATTRIBUTES.                                        24820099
248300     MOVE DP015-ASK-NOR-MDT        TO AAUTHIDA                    24830099
248400                                      AAUTHDTA                    24840099
248500                                      ASHPDTEA                    24850099
248600                                      ASCACA                      24860099
248700                                      ATRAILRA                    24870099
248800                                      ATRKNBRA                    24880099
248900                                      ACARTONA                    24890099
249000                                      AWEIGHTA                    24900099
249100                                      ASHIPMTA                    24910099
249200                                      AOUTCHGA                    24920099
249300                                      AINCHGA                     24930099
249400                                      ARETRSNA                    24940099
249500                                      ADEDUCTA                    24950099
249600                                      ADSCPCTA                    24960099
249700                                      ADISCNTA                    24970099
249800                                      APAYTYPA.                   24980099
249900     MOVE DP015-BLUE               TO AAUTHIDC                    24990099
250000                                      AAUTHDTC                    25000099
250100                                      ASHPDTEC                    25010099
250200                                      ASCACC                      25020099
250300                                      ATRAILRC                    25030099
250400                                      ATRKNBRC                    25040099
250500                                      ACARTONC                    25050099
250600                                      AWEIGHTC                    25060099
250700                                      ASHIPMTC                    25070099
250800                                      AOUTCHGC                    25080099
250900                                      AINCHGC                     25090099
251000                                      ARETRSNC                    25100099
251100                                      ADEDUCTC                    25110099
251200                                      ADSCPCTC                    25120099
251300                                      ADISCNTC                    25130099
251400                                      APAYTYPC.                   25140099
251500     MOVE DP015-HL-OFF             TO AAUTHIDH                    25150099
251600                                      AAUTHDTH                    25160099
251700                                      ASHPDTEH                    25170099
251800                                      ASCACH                      25180099
251900                                      ATRAILRH                    25190099
252000                                      ATRKNBRH                    25200099
252100                                      ACARTONH                    25210099
252200                                      AWEIGHTH                    25220099
252300                                      ASHIPMTH                    25230099
252400                                      AOUTCHGH                    25240099
252500                                      AINCHGH                     25250099
252600                                      ARETRSNH                    25260099
252700                                      ADEDUCTH                    25270099
252800                                      ADSCPCTH                    25280099
252900                                      ADISCNTH                    25290099
253000                                      APAYTYPH.                   25300099
253100                                                                  25310099
253200     MOVE DP015-UNP-ALP-NOR-MDT    TO AINST1A                     25320099
253300                                      AINST2A.                    25330099
253400     MOVE DP015-GREEN              TO AINST1C                     25340099
253500                                      AINST2C.                    25350099
253600     MOVE DP015-UNDERLINE          TO AINST1H                     25360099
253700                                      AINST2H.                    25370099
253800                                                                  25380099
253900*----------------------------------------------------------------*25390099
254000* WHEN THE STATUS OF A LISTING IS BEING CHANGED FROM RTV TO      *25400099
254100*    DEBIT AND DISPOSE OR THE STATUS IS ALREADY D & D, THE       *25410099
254200*    THE FIELDS FOR FRGT CHARGES, DISCOUNTS, DEDUCTIONS NEED TO  *25420099
254300*    PROTECTED.  THE OTHER FIELDS CAN BE ENTERED DEPENDING ON    *25430099
254400*    HOW THE ARE DISPOSING OF THE MDSE -- SENDING TO JOBBER OR   *25440099
254500*    DISPOSING OF IT SOME OTHER WAY.                            * 25450099
254600*----------------------------------------------------------------*25460099
254700 3220-DEBIT-DISP-ATTRIBUTES.                                      25470099
254800     MOVE DP015-ASK-NOR-MDT        TO ASHIPMTA                    25480099
254900                                      AOUTCHGA                    25490099
255000                                      AINCHGA                     25500099
255100                                      ADEDUCTA                    25510099
255200                                      ADSCPCTA                    25520099
255300                                      ADISCNTA.                   25530099
255400     MOVE DP015-BLUE               TO ASHIPMTC                    25540099
255500                                      AOUTCHGC                    25550099
255600                                      AINCHGC                     25560099
255700                                      ADEDUCTC                    25570099
255800                                      ADSCPCTC                    25580099
255900                                      ADISCNTC.                   25590099
256000     MOVE DP015-HL-OFF             TO ASHIPMTH                    25600099
256100                                      AOUTCHGH                    25610099
256200                                      AINCHGH                     25620099
256300                                      ADEDUCTH                    25630099
256400                                      ADSCPCTH                    25640099
256500                                      ADISCNTH.                   25650099
256600                                                                  25660099
256700     MOVE DP015-UNP-ALP-NOR-MDT    TO AAUTHIDA                    25670099
256800                                      AAUTHDTA                    25680099
256900                                      ASHPDTEA                    25690099
257000                                      ASCACA                      25700099
257100                                      ATRAILRA                    25710099
257200                                      ATRKNBRA                    25720099
257300                                      AWEIGHTA                    25730099
257400                                      ACARTONA                    25740099
257500                                      ARETRSNA                    25750099
257600                                      APAYTYPA                    25760099
257700                                      AINST1A                     25770099
257800                                      AINST2A.                    25780099
257900     MOVE DP015-GREEN              TO AAUTHIDC                    25790099
258000                                      AAUTHDTC                    25800099
258100                                      ASHPDTEC                    25810099
258200                                      ASCACC                      25820099
258300                                      ATRAILRC                    25830099
258400                                      ATRKNBRC                    25840099
258500                                      ACARTONC                    25850099
258600                                      AWEIGHTC                    25860099
258700                                      ARETRSNC                    25870099
258800                                      APAYTYPC                    25880099
258900                                      AINST1C                     25890099
259000                                      AINST2C.                    25900099
259100     MOVE DP015-UNDERLINE          TO AAUTHIDH                    25910099
259200                                      AAUTHDTH                    25920099
259300                                      ASHPDTEH                    25930099
259400                                      ASCACH                      25940099
259500                                      ATRAILRH                    25950099
259600                                      ATRKNBRH                    25960099
259700                                      ACARTONH                    25970099
259800                                      AWEIGHTH                    25980099
259900                                      ARETRSNH                    25990099
260000                                      APAYTYPH                    26000099
260100                                      AINST1H                     26010099
260200                                      AINST2H.                    26020099
260300                                                                  26030099
260400*----------------------------------------------------------------*26040099
260500* WHEN THE STATUS OF A LISTING IS NOT APPROVED NOR IS IT BEING   *26050099
260600*    CHANGED TO DEBIT AND DISPOSE, ALL ENTERABLE FIELDS ARE      *26060099
260700*    UNPROTECTED.                                                *26070099
260800*----------------------------------------------------------------*26080099
260900 3230-NORMAL-ATTRIBUTES.                                          26090099
261000     MOVE DP015-UNP-ALP-NOR-MDT    TO AAUTHIDA                    26100099
261100                                      AAUTHDTA                    26110099
261200                                      ASHPDTEA                    26120099
261300                                      ASCACA                      26130099
261400                                      ATRAILRA                    26140099
261500                                      ATRKNBRA                    26150099
261600                                      ACARTONA                    26160099
261700                                      AWEIGHTA                    26170099
261800                                      AOUTCHGA                    26180099
261900                                      AINCHGA                     26190099
262000                                      ARETRSNA                    26200099
262100                                      ADEDUCTA                    26210099
262200                                      ADSCPCTA                    26220099
262300                                      ADISCNTA                    26230099
262400                                      APAYTYPA                    26240099
262500                                      AINST1A                     26250099
262600                                      AINST2A.                    26260099
262700     MOVE DP015-GREEN              TO AAUTHIDC                    26270099
262800                                      AAUTHDTC                    26280099
262900                                      ASHPDTEC                    26290099
263000                                      ASCACC                      26300099
263100                                      ATRAILRC                    26310099
263200                                      ATRKNBRC                    26320099
263300                                      ACARTONC                    26330099
263400                                      AWEIGHTC                    26340099
263500                                      AOUTCHGC                    26350099
263600                                      AINCHGC                     26360099
263700                                      ARETRSNC                    26370099
263800                                      ADEDUCTC                    26380099
263900                                      ADSCPCTC                    26390099
264000                                      ADISCNTC                    26400099
264100                                      APAYTYPC                    26410099
264200                                      AINST1C                     26420099
264300                                      AINST2C.                    26430099
264400     MOVE DP015-UNDERLINE          TO AAUTHIDH                    26440099
264500                                      AAUTHDTH                    26450099
264600                                      ASHPDTEH                    26460099
264700                                      ASCACH                      26470099
264800                                      ATRAILRH                    26480099
264900                                      ATRKNBRH                    26490099
265000                                      ACARTONH                    26500099
265100                                      AWEIGHTH                    26510099
265200                                      AOUTCHGH                    26520099
265300                                      AINCHGH                     26530099
265400                                      ARETRSNH                    26540099
265500                                      ADEDUCTH                    26550099
265600                                      ADSCPCTH                    26560099
265700                                      ADISCNTH                    26570099
265800                                      APAYTYPH                    26580099
265900                                      AINST1H                     26590099
266000                                      AINST2H.                    26600099
266100                                                                  26610099
266200     MOVE DP015-ASK-NOR-MDT        TO AINCHGA                     26620099
266300     MOVE DP015-BLUE               TO AINCHGC                     26630099
266400     MOVE DP015-UNDERLINE          TO AINCHGH.                    26640099
266500                                                                  26650099
266600*----------------------------------------------------------------*26660099
266700* WHEN THE PAYMENT TYPE IS COLLECT, PROTECT SHIPPING CHARGE      *26670099
266800*    FIELDS.  CHARGES WILL BE COLLECTED FROM THE VENDOR WHEN     *26680099
266900*    RECEIVED RATHER THAN PRE-PAID.                              *26690099
267000*----------------------------------------------------------------*26700099
267100 3240-COLLECT-ATTRIBUTES.                                         26710099
267200     MOVE DP015-UNP-ALP-NOR-MDT    TO AAUTHIDA                    26720099
267300                                      AAUTHDTA                    26730099
267400                                      ASHPDTEA                    26740099
267500                                      ASCACA                      26750099
267600                                      ATRAILRA                    26760099
267700                                      ATRKNBRA                    26770099
267800                                      ACARTONA                    26780099
267900                                      ARETRSNA                    26790099
268000                                      AWEIGHTA                    26800099
268100                                      ADEDUCTA                    26810099
268200                                      ADSCPCTA                    26820099
268300                                      ADISCNTA                    26830099
268400                                      APAYTYPA                    26840099
268500                                      AINST1A                     26850099
268600                                      AINST2A.                    26860099
268700     MOVE DP015-GREEN              TO AAUTHIDC                    26870099
268800                                      AAUTHDTC                    26880099
268900                                      ASHPDTEC                    26890099
269000                                      ASCACC                      26900099
269100                                      ATRAILRC                    26910099
269200                                      ATRKNBRC                    26920099
269300                                      ACARTONC                    26930099
269400                                      AWEIGHTC                    26940099
269500                                      ARETRSNC                    26950099
269600                                      ADEDUCTC                    26960099
269700                                      ADSCPCTC                    26970099
269800                                      ADISCNTC                    26980099
269900                                      APAYTYPC                    26990099
270000                                      AINST1C                     27000099
270100                                      AINST2C.                    27010099
270200     MOVE DP015-UNDERLINE          TO AAUTHIDH                    27020099
270300                                      AAUTHDTH                    27030099
270400                                      ASHPDTEH                    27040099
270500                                      ASCACH                      27050099
270600                                      ATRAILRH                    27060099
270700                                      ATRKNBRH                    27070099
270800                                      ACARTONH                    27080099
270900                                      AWEIGHTH                    27090099
271000                                      AOUTCHGH                    27100099
271100                                      AINCHGH                     27110099
271200                                      ADEDUCTH                    27120099
271300                                      ADSCPCTH                    27130099
271400                                      ADISCNTH                    27140099
271500                                      ARETRSNH                    27150099
271600                                      APAYTYPH                    27160099
271700                                      AINST1H                     27170099
271800                                      AINST2H.                    27180099
271900                                                                  27190099
272000     MOVE DP015-ASK-NOR-MDT        TO AOUTCHGA                    27200099
272100                                      AINCHGA.                    27210099
272200     MOVE DP015-BLUE               TO AOUTCHGC                    27220099
272300                                      AINCHGC.                    27230099
272400                                                                  27240099
272500*----------------------------------------------------------------*27250099
272600*    ENSURE THE STANDARD CARRIER ALPHA CODE (SCAC) ENTERED ON    *27260099
272700*    VALID                                                       *27270099
272800*----------------------------------------------------------------*27280099
272900 3300-VALIDATE-SCAC.                                              27290099
273000     PERFORM WITH TEST AFTER                                      27300099
273100         VARYING PV-RETRY-COUNTER                                 27310099
273200         FROM 1 BY 1                                              27320099
273300         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 27330099
273400                 OR SQLCODE = 0                                   27340099
273500                 OR SQLCODE = +100)                               27350099
273600                                                                  27360099
273700         EXEC SQL                                                 27370099
273800             SELECT SCAC_CDE                                      27380099
273900                  , EXTENT.ENT_ID                                 27390099
274000               INTO :EXTENT-SCAC-CDE                              27400099
274100                  , :EXTENT-ENT-ID                                27410099
274200               FROM TEXTENT EXTENT                                27420099
274300                  , TENTNME ENTNME                                27430099
274400             WHERE  EXTENT.SCAC_CDE    = :ASC-SCAC                27440099
274500               AND  EXTENT.CARRIER_IND = 'Y'                      27450099
274600               AND  EXTENT.ENT_ID      = ENTNME.ENT_ID            27460099
274700               AND  ENTNME.TYPE_CDE    = '04'                     27470099
274800         END-EXEC                                                 27480099
274900                                                                  27490099
275000         EVALUATE TRUE                                            27500099
275100             WHEN SQLCODE = ZERO                                  27510099
275200                 SET PS-VALID-SCAC   TO TRUE                      27520099
275300             WHEN SQLCODE = +100                                  27530099
275400             WHEN SQLCODE = -904                                  27540099
275500             WHEN SQLCODE = -913                                  27550099
275600                 SET PS-INVALID-SCAC TO TRUE                      27560099
275700             WHEN SQLWARN0 NOT = SPACES                           27570099
275800             WHEN SQLCODE NOT EQUAL ZERO                          27580099
275900                 MOVE '3300-VALIDATE-SCAC'                        27590099
276000                                 TO DP013-PARAGRAPH               27600099
276100                 MOVE 'VALIDATE SCAC'                             27610099
276200                                 TO DP013-MESSAGE-TEXT(1)         27620099
276300                 MOVE SQLCA      TO DP013-SQLCA                   27630099
276400                 MOVE 'TEXTENT'  TO DP013-DB2-TABLE-NAME(1)       27640099
276500                 MOVE 'TENTNME'  TO DP013-DB2-TABLE-NAME(2)       27650099
276600                 SET DP013-DB2-ABEND                              27660099
276700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           27670099
276800                 PERFORM DP013-0000-PROCESS-ABEND                 27680099
276900         END-EVALUATE                                             27690099
277000     END-PERFORM.                                                 27700099
277100                                                                  27710099
277200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         27720099
277300         MOVE '3300-VALIDATE-SCAC'                                27730099
277400                                 TO DP013-PARAGRAPH               27740099
277500         MOVE 'VALIDATE SCAC'    TO DP013-MESSAGE-TEXT(1)         27750099
277600         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    27760099
277700                                 TO DP013-MESSAGE-TEXT(2)         27770099
277800         MOVE SQLCA              TO DP013-SQLCA                   27780099
277900         MOVE 'TEXTENT'          TO DP013-DB2-TABLE-NAME(1)       27790099
278000         MOVE 'TENTNME'          TO DP013-DB2-TABLE-NAME(2)       27800099
278100         SET DP013-DB2-ABEND                                      27810099
278200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   27820099
278300         PERFORM DP013-0000-PROCESS-ABEND                         27830099
278400     END-IF.                                                      27840099
278500                                                                  27850099
278600*----------------------------------------------------------------*27860099
278700*    SELECT THE VENDOR AGREEMENT FOR THE VENDOR, CHECK IF        *27870099
278800*    AUTHORIZATION NBR IS NEEDED OR IF THERE IS A PERMANENT ONE  *27880099
278900*    AGRMT_TYP_ID = '3' IS THE PURCHASING TERMS AGREEMENT        *27890099
279000*----------------------------------------------------------------*27900099
279100 3400-SELECT-TVNDAGR-3.                                           27910099
279200     INITIALIZE DCLTVNDAGR                                        27920099
279300                                                                  27930099
279400     PERFORM WITH TEST AFTER                                      27940099
279500         VARYING PV-RETRY-COUNTER                                 27950099
279600         FROM 1 BY 1                                              27960099
279700         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 27970099
279800                 OR SQLCODE = 0                                   27980099
279900                 OR SQLCODE = +100)                               27990099
280000                                                                  28000099
280100         EXEC SQL                                                 28010099
280200             SELECT RTV_RA_REQD_IND                               28020099
280300                  , RTV_NO_RA_REQD_IND                            28030099
280400                  , DEBIT_DESTROY_IND                             28040099
280500                  , MARKOUT_IND                                   28050099
280600                  , VND_AUTH_ID                                   28060099
280700                  , VNDDPT.INHOUSE_NBR                            28070099
280800               INTO :VNDAGR-RTV-RA-REQD-IND                       28080099
280900                  , :VNDAGR-RTV-NO-RA-REQD-IND                    28090099
281000                  , :VNDAGR-DEBIT-DESTROY-IND                     28100099
281100                  , :VNDAGR-MARKOUT-IND                           28110099
281200                  , :VNDAGR-VND-AUTH-ID:NI-VND-AUTH-ID            28120099
281300                  , :VNDDPT-INHOUSE-NBR                           28130099
281400               FROM TVNDAGR VNDAGR                                28140099
281500                  , TVNDDPT VNDDPT                                28150099
281600              WHERE VNDAGR.ENT_ID   = :DK-ENT-ID                  28160099
281700                AND VNDAGR.DEPT_NBR = :DK-DEPT-NBR                28170099
281800                AND VNDAGR.ENT_ID   = VNDDPT.ENT_ID               28180099
281900                AND VNDAGR.DEPT_NBR = VNDDPT.DEPT_NBR             28190099
282000                AND AGRMT_TYP_ID    = '3'                         28200099
282100                AND (CURRENT_DATE   >= EFFECTIVE_DATE             28210099
282200                   AND CURRENT_DATE <= EXPIRATION_DATE)           28220099
282300                AND SEQ_NBR         =                             28230099
282400                   (SELECT MAX(SEQ_NBR)                           28240099
282500                      FROM TVNDAGR VNDAGR2                        28250099
282600                     WHERE VNDAGR2.ENT_ID       = VNDAGR.ENT_ID   28260099
282700                       AND VNDAGR2.DEPT_NBR     = VNDAGR.DEPT_NBR 28270099
282800                       AND VNDAGR2.AGRMT_TYP_ID = '3')            28280099
282900         END-EXEC                                                 28290099
283000                                                                  28300099
283100         EVALUATE TRUE                                            28310099
283200             WHEN SQLCODE = ZERO                                  28320099
283300                 SET PS-DATA-FOUND   TO TRUE                      28330099
283400                 MOVE VNDDPT-INHOUSE-NBR TO ASC-INHOUSE-NBR       28340099
283500             WHEN SQLCODE = +100                                  28350099
283600             WHEN SQLCODE = -904                                  28360099
283700             WHEN SQLCODE = -913                                  28370099
283800                 SET PS-DATA-NOT-FOUND TO TRUE                    28380099
283900             WHEN SQLWARN0 NOT = SPACES                           28390099
284000             WHEN SQLCODE NOT EQUAL ZERO                          28400099
284100                 MOVE '3400-SELECT-TVNDAGR-3' TO DP013-PARAGRAPH  28410099
284200                 MOVE 'SELECT TVNDAGR'  TO DP013-MESSAGE-TEXT(1)  28420099
284300                 MOVE SQLCA             TO DP013-SQLCA            28430099
284400                 MOVE 'TVNDAGR'         TO DP013-DB2-TABLE-NAME(1)28440099
284500                 SET DP013-DB2-ABEND                              28450099
284600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           28460099
284700                 PERFORM DP013-0000-PROCESS-ABEND                 28470099
284800         END-EVALUATE                                             28480099
284900     END-PERFORM.                                                 28490099
285000                                                                  28500099
285100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         28510099
285200         MOVE '3400-SELECT-TVNDAGR-3'                             28520099
285300                                 TO DP013-PARAGRAPH               28530099
285400         MOVE 'SELECT TVNDAGR'   TO DP013-MESSAGE-TEXT(1)         28540099
285500         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    28550099
285600                                 TO DP013-MESSAGE-TEXT(2)         28560099
285700         MOVE SQLCA              TO DP013-SQLCA                   28570099
285800         MOVE 'TVNDAGR'          TO DP013-DB2-TABLE-NAME(1)       28580099
285900         SET DP013-DB2-ABEND                                      28590099
286000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   28600099
286100         PERFORM DP013-0000-PROCESS-ABEND                         28610099
286200     END-IF.                                                      28620099
286300                                                                  28630099
286400*----------------------------------------------------------------*28640099
286500*    CHECK THE  VENDOR AGREEMENT FOR THE VENDOR TO DETERMINE IF  *28650099
286600*    AUTHORIZATION NBR IS NEEDED OR IF THERE IS A PERMANENT ONE  *28660099
286700*    IF MORE THAN ONE INDICATOR IS SET TO YES OR NONE ARE SET,   *28670099
286800*    SEND ERROR MESSAGE -- DON'T KNOW WHAT IT SHOULD BE.         *28680099
286900*----------------------------------------------------------------*28690099
287000 3410-CHK-TVNDAGR.                                                28700099
287100     INITIALIZE PV-NBR-AGRMTS.                                    28710099
287200     IF VNDAGR-RTV-RA-REQD-IND = 'Y'                              28720099
287300        ADD +1 TO PV-NBR-AGRMTS                                   28730099
287400     END-IF.                                                      28740099
287500     IF VNDAGR-RTV-NO-RA-REQD-IND = 'Y'                           28750099
287600        ADD +1 TO PV-NBR-AGRMTS                                   28760099
287700     END-IF.                                                      28770099
287800     IF VNDAGR-DEBIT-DESTROY-IND = 'Y'                            28780099
287900        ADD +1 TO PV-NBR-AGRMTS                                   28790099
288000     END-IF.                                                      28800099
288100     IF VNDAGR-MARKOUT-IND = 'Y'                                  28810099
288200        ADD +1 TO PV-NBR-AGRMTS                                   28820099
288300     END-IF.                                                      28830099
288400                                                                  28840099
288500     IF PV-NBR-AGRMTS = +1                                        28850099
288600         CONTINUE                                                 28860099
288700     ELSE                                                         28870099
288800         IF PV-NBR-AGRMTS > +1                                    28880099
288900             SET PS-ERROR            TO TRUE                      28890099
289000             SET DP020-MSG-WARNING   TO TRUE                      28900099
289100             MOVE PC-TSYMSG-03195    TO DP020-MSG-NUMBER          28910099
289200             MOVE -1                 TO AAUTHIDL                  28920099
289300             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  28930099
289400         ELSE                                                     28940099
289500             IF PV-NBR-AGRMTS = +0                                28950099
289600                 SET PS-ERROR          TO TRUE                    28960099
289700                 SET DP020-MSG-WARNING TO TRUE                    28970099
289800                 MOVE PC-TSYMSG-03155  TO DP020-MSG-NUMBER        28980099
289900                 MOVE -1               TO AAUTHIDL                28990099
290000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              29000099
290100             END-IF                                               29010099
290200         END-IF                                                   29020099
290300     END-IF.                                                      29030099
290400                                                                  29040099
290500     IF VNDAGR-RTV-RA-REQD-IND    = 'Y' AND                       29050099
290600        VNDAGR-RTV-NO-RA-REQD-IND = 'N' AND                       29060099
290700        VNDAGR-DEBIT-DESTROY-IND  = 'N' AND                       29070099
290800        VNDAGR-MARKOUT-IND        = 'N'                           29080099
290900***      RA NBR IS REQUIRED                                       29090099
291000         IF VNDAGR-VND-AUTH-ID > SPACES                           29100099
291100             MOVE VNDAGR-VND-AUTH-ID TO ASC-AUTH-ID               29110099
291200             IF ASC-AUTH-DTE = SPACES                             29120099
291300                 PERFORM 3800-GET-CLOSE-DATE                      29130099
291400             END-IF                                               29140099
291500         ELSE                                                     29150099
291600             SET PS-ERROR            TO TRUE                      29160099
291700             SET DP020-MSG-WARNING   TO TRUE                      29170099
291800             MOVE PC-TSYMSG-03155    TO DP020-MSG-NUMBER          29180099
291900             MOVE -1                 TO AAUTHIDL                  29190099
292000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  29200099
292100         END-IF                                                   29210099
292200     ELSE                                                         29220099
292300***      NO RA NBR IS REQUIRED                                    29230099
292400         IF VNDAGR-RTV-RA-REQD-IND    = 'N' AND                   29240099
292500            VNDAGR-RTV-NO-RA-REQD-IND = 'Y' AND                   29250099
292600            VNDAGR-DEBIT-DESTROY-IND  = 'N' AND                   29260099
292700            VNDAGR-MARKOUT-IND        = 'N'                       29270099
292800             MOVE 'NORA'             TO ASC-AUTH-ID               29280099
292900             IF ASC-AUTH-DTE = SPACES                             29290099
293000                 PERFORM 3800-GET-CLOSE-DATE                      29300099
293100             END-IF                                               29310099
293200         ELSE                                                     29320099
293300***      THIS IS A D & D                                          29330099
293400             IF VNDAGR-RTV-RA-REQD-IND    = 'N' AND               29340099
293500                VNDAGR-RTV-NO-RA-REQD-IND = 'N' AND               29350099
293600                VNDAGR-DEBIT-DESTROY-IND  = 'Y' AND               29360099
293700                VNDAGR-MARKOUT-IND        = 'N'                   29370099
293800                 MOVE 'D & D'        TO ASC-AUTH-ID               29380099
293900                 IF ASC-AUTH-DTE = SPACES                         29390099
294000                     PERFORM 3800-GET-CLOSE-DATE                  29400099
294100                 END-IF                                           29410099
294200             ELSE                                                 29420099
294300***      THIS IS A MOS OR NO AGREEMENT INDICATED                  29430099
294400                 IF VNDAGR-RTV-RA-REQD-IND    = 'N' AND           29440099
294500                    VNDAGR-RTV-NO-RA-REQD-IND = 'N' AND           29450099
294600                    VNDAGR-DEBIT-DESTROY-IND  = 'N' AND           29460099
294700                    (VNDAGR-MARKOUT-IND       = 'Y' OR            29470099
294800                     VNDAGR-MARKOUT-IND       = 'N')              29480099
294900                     SET PS-ERROR          TO TRUE                29490099
295000                     SET DP020-MSG-WARNING TO TRUE                29500099
295100                     MOVE PC-TSYMSG-03155  TO DP020-MSG-NUMBER    29510099
295200                     MOVE -1               TO AAUTHIDL            29520099
295300                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          29530099
295400                 END-IF                                           29540099
295500             END-IF                                               29550099
295600         END-IF                                                   29560099
295700     END-IF.                                                      29570099
295800                                                                  29580099
295900*----------------------------------------------------------------*29590099
296000*    SELECT THE SHIPPING VENDOR AGREEMENT TO DETERMINE WHO PAID  *29600099
296100*    THE INITIAL SHIPPING CHARGES.                               *29610099
296200*    AGRMT_TYP_ID = '1' IS THE SHIPPING TERMS AGREEMENT          *29620099
296300*----------------------------------------------------------------*29630099
296400 3420-SELECT-TVNDAGR-1.                                           29640099
296500     INITIALIZE DCLTVNDAGR                                        29650099
296600                DCLTFRGTRM.                                       29660099
296700                                                                  29670099
296800     PERFORM WITH TEST AFTER                                      29680099
296900         VARYING PV-RETRY-COUNTER                                 29690099
297000         FROM 1 BY 1                                              29700099
297100         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 29710099
297200                 OR SQLCODE = 0                                   29720099
297300                 OR SQLCODE = +100)                               29730099
297400                                                                  29740099
297500         EXEC SQL                                                 29750099
297600             SELECT FRGTRM.FRGT_TERM_ID                           29760099
297700                  , KOHLS_FRGT_PCT                                29770099
297800                  , VND_FRGT_PCT                                  29780099
297900               INTO :FRGTRM-FRGT-TERM-ID                          29790099
298000                  , :FRGTRM-KOHLS-FRGT-PCT                        29800099
298100                  , :FRGTRM-VND-FRGT-PCT                          29810099
298200               FROM TVNDAGR VNDAGR                                29820099
298300                  , TFRGTRM FRGTRM                                29830099
298400              WHERE AGRMT_TYP_ID = '1'                            29840099
298500                AND (CURRENT_DATE >= EFFECTIVE_DATE               29850099
298600                     AND CURRENT_DATE <= EXPIRATION_DATE)         29860099
298700                AND ENT_ID       = :DK-ENT-ID                     29870099
298800                AND DEPT_NBR     = :DK-DEPT-NBR                   29880099
298900                AND VNDAGR.FRGT_TERM_ID = FRGTRM.FRGT_TERM_ID     29890099
299000         END-EXEC                                                 29900099
299100                                                                  29910099
299200         EVALUATE TRUE                                            29920099
299300             WHEN SQLCODE = ZERO                                  29930099
299400                 SET PS-DATA-FOUND   TO TRUE                      29940099
299500             WHEN SQLCODE = +100                                  29950099
299600                 SET PS-DATA-FOUND   TO TRUE                      29960099
299700                 MOVE 0 TO FRGTRM-FRGT-TERM-ID                    29970099
299800             WHEN SQLCODE = -904                                  29980099
299900             WHEN SQLCODE = -913                                  29990099
300000                 SET PS-DATA-NOT-FOUND TO TRUE                    30000099
300100             WHEN SQLWARN0 NOT = SPACES                           30010099
300200             WHEN SQLCODE NOT EQUAL ZERO                          30020099
300300                 MOVE '3420-SELECT-TVNDAGR-1' TO DP013-PARAGRAPH  30030099
300400                 MOVE 'SELECT TVNDAGR'  TO DP013-MESSAGE-TEXT(1)  30040099
300500                 MOVE SQLCA             TO DP013-SQLCA            30050099
300600                 MOVE 'TVNDAGR'         TO DP013-DB2-TABLE-NAME(1)30060099
300700                 SET DP013-DB2-ABEND                              30070099
300800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           30080099
300900                 PERFORM DP013-0000-PROCESS-ABEND                 30090099
301000         END-EVALUATE                                             30100099
301100     END-PERFORM.                                                 30110099
301200                                                                  30120099
301300     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         30130099
301400         MOVE '3420-SELECT-TVNDAGR-1'                             30140099
301500                                 TO DP013-PARAGRAPH               30150099
301600         MOVE 'SELECT TVNDAGR'   TO DP013-MESSAGE-TEXT(1)         30160099
301700         MOVE 'MAX NUMBER OF RETRIES EXCEEDED'                    30170099
301800                                 TO DP013-MESSAGE-TEXT(2)         30180099
301900         MOVE SQLCA              TO DP013-SQLCA                   30190099
302000         MOVE 'TVNDAGR'          TO DP013-DB2-TABLE-NAME(1)       30200099
302100         SET DP013-DB2-ABEND                                      30210099
302200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   30220099
302300         PERFORM DP013-0000-PROCESS-ABEND                         30230099
302400     END-IF.                                                      30240099
302500                                                                  30250099
302600*----------------------------------------------------------------*30260099
302700*    CHECK THE FREIGHT TERMS FROM THE SHIPPING AGREEMENT TO      *30270099
302800*    DETERMINE WHO ORIGINALLY PAID THE FREIGHT.  IF VENDOR PAID  *30280099
302900*    THEM, THEN INBOUND CHARGES WOULD BE SET TO 0, IF SOMEONE    *30290099
303000*    OTHER THAN THE VENDOR THEN INBOUND CHRGS = OUTBOUND CHRGS.  *30300099
303100*----------------------------------------------------------------*30310099
303200 3430-CHK-FRGT-TERMS.                                             30320099
303300     INITIALIZE PS-PAID-IN-FRGT-SW.                               30330099
303400     IF FRGTRM-KOHLS-FRGT-PCT = 1.0                               30340099
303500        SET PS-KOHLS-PAID TO TRUE                                 30350099
303600     ELSE                                                         30360099
303700         IF FRGTRM-VND-FRGT-PCT = 1.0                             30370099
303800            SET PS-VENDOR-PAID TO TRUE                            30380099
303900         ELSE                                                     30390099
304000             IF FRGTRM-KOHLS-FRGT-PCT > 0 AND                     30400099
304100                FRGTRM-VND-FRGT-PCT > 0                           30410099
304200                 SET PS-VENDOR-PAID TO TRUE                       30420099
304300             ELSE                                                 30430099
304400                 IF FRGTRM-FRGT-TERM-ID = 0                       30440099
304500                     SET PS-VENDOR-PAID TO TRUE                   30450099
304600                 END-IF                                           30460099
304700             END-IF                                               30470099
304800         END-IF                                                   30480099
304900     END-IF.                                                      30490099
305000                                                                  30500099
305100******************************************************************30510099
305200*  CALL THE DATE ROUTINE TO CHECK THAT THE DATE ENTERED IS A     *30520099
305300*  VALID DATE                                                    *30530099
305400******************************************************************30540099
305500 3500-CALL-DTE-RTN.                                               30550099
305600     CALL DP500-KOHLS-CALENDAR-ROUTINE                            30560099
305700             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.           30570099
305800                                                                  30580099
305900     IF DPG54-NO-ERROR                                            30590099
306000         IF PS-CHK-AUTH-DTE                                       30600099
306100             MOVE DPG55-GREG-CC-DATE-FMT     TO ASC-AUTH-DTE      30610099
306200         ELSE                                                     30620099
306300             MOVE DPG55-GREG-CC-DATE-FMT     TO ASC-SHIP-DTE      30630099
306400         END-IF                                                   30640099
306500     ELSE                                                         30650099
306600         IF (DPG54-DATE-INVALID                                   30660099
306700           OR DPG54-SEVERE-ERROR)                                 30670099
306800             SET PS-ERROR                                         30680099
306900                 DP020-MSG-FATAL             TO TRUE              30690099
307000             MOVE PC-TSYMSG-00009            TO DP020-MSG-NUMBER  30700099
307100             IF PS-CHK-AUTH-DTE                                   30710099
307200                 MOVE DP015-UNP-ALP-BRT-MDT  TO AAUTHDTA          30720099
307300                 MOVE DP015-RED              TO AAUTHDTC          30730099
307400                 MOVE DP015-REVERSE          TO AAUTHDTH          30740099
307500                 MOVE -1                     TO AAUTHDTL          30750099
307600             ELSE                                                 30760099
307700                 MOVE DP015-UNP-ALP-BRT-MDT  TO ASHPDTEA          30770099
307800                 MOVE DP015-RED              TO ASHPDTEC          30780099
307900                 MOVE DP015-REVERSE          TO ASHPDTEH          30790099
308000                 MOVE -1                     TO ASHPDTEL          30800099
308100             END-IF                                               30810099
308200             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  30820099
308300         END-IF                                                   30830099
308400     END-IF.                                                      30840099
308500                                                                  30850099
308600******************************************************************30860099
308700*  CALL THE DATE ROUTINE TO COMPARE TWO DATES AS FOLLOWS:        *30870099
308800*      -- IS THE AUTHORIZATION DATE ENTERED LESS THAN OR EQUAL   *30880099
308900*         TO THE CURRENT DATE?                                   *30890099
309000*      -- IS THE SHIP DATE ENTERED LESS THAN OR EQUAL TO THE     *30900099
309100*         CURRENT DATE?                                          *30910099
309200*      -- IS THE SHIP DATE ENTERED GREATER THAN OR EQUAL TO THE  *30920099
309300*         AUTHORIZATION DATE THAT WAS ENTERED?                   *30930099
309400******************************************************************30940099
309500 3550-CAL-RTN-COMPARE-DATES.                                      30950099
309600     CALL DP500-KOHLS-CALENDAR-ROUTINE                            30960099
309700             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.           30970099
309800                                                                  30980099
309900     IF DPG54-NO-ERROR                                            30990099
310000         EVALUATE TRUE                                            31000099
310100             WHEN PS-CHK-AUTH-DTE                                 31010099
310200****         AUTHORIZATION DATE IS GREATER THAN THE CURRENT DATE  31020099
310300                 IF DPG55-DAYS-DIFFERENCE > 0                     31030099
310400                     SET PS-ERROR                                 31040099
310500                         DP030-SET-CURSOR-APPL-1                  31050099
310600                         DP020-MSG-FATAL     TO TRUE              31060099
310700                     MOVE PC-TSYMSG-03234    TO DP020-MSG-NUMBER  31070099
310800                     MOVE DP015-UNP-ALP-BRT-MDT                   31080099
310900                                             TO AAUTHDTA          31090099
311000                     MOVE DP015-RED          TO AAUTHDTC          31100099
311100                     MOVE DP015-REVERSE      TO AAUTHDTH          31110099
311200                     MOVE -1                 TO AAUTHDTL          31120099
311300                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          31130099
311400                 END-IF                                           31140099
311500             WHEN PS-CHK-SHIP-DTE                                 31150099
311600****         SHIP DATE IS GREATER THAN THE CURRENT DATE           31160099
311700                 IF DPG55-DAYS-DIFFERENCE > 0                     31170099
311800                     SET PS-ERROR                                 31180099
311900                         DP030-SET-CURSOR-APPL-1                  31190099
312000                         DP020-MSG-FATAL     TO TRUE              31200099
312100                     MOVE PC-TSYMSG-03238    TO DP020-MSG-NUMBER  31210099
312200                     MOVE DP015-UNP-ALP-BRT-MDT                   31220099
312300                                             TO ASHPDTEA          31230099
312400                     MOVE DP015-RED          TO ASHPDTEC          31240099
312500                     MOVE DP015-REVERSE      TO ASHPDTEH          31250099
312600                     MOVE -1                 TO ASHPDTEL          31260099
312700                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          31270099
312800                 END-IF                                           31280099
312900****         AUTHORIZATION DATE IS GREATER THAN THE SHIP DATE     31290099
313000             WHEN PS-CHK-BOTH-DTES                                31300099
313100                 IF DPG55-DAYS-DIFFERENCE > 0                     31310099
313200                     SET PS-ERROR                                 31320099
313300                         DP030-SET-CURSOR-APPL-1                  31330099
313400                         DP020-MSG-FATAL     TO TRUE              31340099
313500                     MOVE PC-TSYMSG-03235    TO DP020-MSG-NUMBER  31350099
313600                     MOVE DP015-UNP-ALP-BRT-MDT                   31360099
313700                                             TO AAUTHDTA          31370099
313800                                                ASHPDTEA          31380099
313900                     MOVE DP015-RED          TO AAUTHDTC          31390099
314000                                                ASHPDTEC          31400099
314100                     MOVE DP015-REVERSE      TO AAUTHDTH          31410099
314200                                                ASHPDTEH          31420099
314300                     MOVE -1                 TO AAUTHDTL          31430099
314400                     SET DP030-SET-CURSOR-APPL-1 TO TRUE          31440099
314500                 END-IF                                           31450099
314600         END-EVALUATE                                             31460099
314700     ELSE                                                         31470099
314800         IF (DPG54-DATE-INVALID                                   31480099
314900           OR DPG54-SEVERE-ERROR)                                 31490099
315000             SET PS-ERROR                                         31500099
315100                 DP020-MSG-FATAL             TO TRUE              31510099
315200             MOVE PC-TSYMSG-00009            TO DP020-MSG-NUMBER  31520099
315300             IF PS-CHK-AUTH-DTE                                   31530099
315400                 MOVE DP015-UNP-ALP-BRT-MDT  TO AAUTHDTA          31540099
315500                 MOVE DP015-RED              TO AAUTHDTC          31550099
315600                 MOVE DP015-REVERSE          TO AAUTHDTH          31560099
315700                 MOVE -1                     TO AAUTHDTL          31570099
315800             ELSE                                                 31580099
315900                 MOVE DP015-UNP-ALP-BRT-MDT  TO ASHPDTEA          31590099
316000                 MOVE DP015-RED              TO ASHPDTEC          31600099
316100                 MOVE DP015-REVERSE          TO ASHPDTEH          31610099
316200                 MOVE -1                     TO ASHPDTEL          31620099
316300             END-IF                                               31630099
316400             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  31640099
316500         END-IF                                                   31650099
316600     END-IF.                                                      31660099
316700                                                                  31670099
316800******************************************************************31680099
316900*  READ THE XLT_MDSE_INV_PARM TABLE TO FIND THE DATE OF THE      *31690099
317000*  SCHEDULED INVENTORY.                                          *31700099
317100*  WHEN CHECKING INV DATE OPER-UNT-ID MUST BE 811 VML 6/16/2005  *31710099
317200******************************************************************31720099
317300 3560-CHECK-INVENTORY-DATE.                                       31730099
317400**   MOVE DP020-OPER-UNT-ID TO PV-DB2-OPER-UNT-ID.                31740099
317500     MOVE 811               TO PV-DB2-OPER-UNT-ID.                31750099
317600     INITIALIZE PV-INV-DATE-COUNT.                                31760099
317700                                                                  31770099
317800     PERFORM WITH TEST AFTER                                      31780099
317900         VARYING PV-RETRY-COUNTER                                 31790099
318000         FROM 1 BY 1                                              31800099
318100         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 31810099
318200                 OR SQLCODE = 0                                   31820099
318300                 OR SQLCODE = +100)                               31830099
318400                                                                  31840099
318500         EXEC SQL                                                 31850099
318600             SELECT CHAR(DATE(INVPAR.PLND_INV_DTE),USA)           31860099
318700                  , COUNT(PLND_INV_DTE)                           31870099
318800               INTO :XLT00025-PLND-INV-DTE                        31880099
318900                  , :PV-INV-DATE-COUNT                            31890099
319000               FROM XLT_MDSE_INV_PARM INVPAR                      31900099
319100              WHERE INVPAR.LOC_NBR      = :PV-DB2-OPER-UNT-ID     31910099
319200                AND INVPAR.PLND_INV_DTE = :PV-COMPARE-DATE-USA    31920099
319210                AND INVPAR.ACTV_IND         = 'Y'                 31921099
319220                AND INVPAR.LOC_INV_STAT_CDE = 'IN'                31922099
319300              GROUP BY INVPAR.PLND_INV_DTE                        31930099
319400         END-EXEC                                                 31940099
319500                                                                  31950099
319600         EVALUATE TRUE                                            31960099
319700             WHEN SQLCODE = ZERO                                  31970099
319800                 SET PS-DATA-FOUND   TO TRUE                      31980099
319900             WHEN SQLCODE = +100                                  31990099
320000                 SET PS-DATA-NOT-FOUND                            32000099
320100                                     TO TRUE                      32010099
320200                 MOVE SPACES         TO XLT00025-PLND-INV-DTE     32020099
320300                 MOVE ZERO           TO PV-INV-DATE-COUNT         32030099
320400             WHEN SQLCODE = -904                                  32040099
320500             WHEN SQLCODE = -913                                  32050099
320600                 CONTINUE                                         32060099
320700             WHEN SQLWARN0 NOT = SPACES                           32070099
320800             WHEN SQLCODE NOT EQUAL ZERO                          32080099
320900                 MOVE '3560-CHECK-INVENTORY-DATE'                 32090099
321000                                        TO DP013-PARAGRAPH        32100099
321100                 MOVE 'GET PLANNED INVENTORY DATE'                32110099
321200                                        TO DP013-MESSAGE-TEXT(1)  32120099
321300                 MOVE SQLCA             TO DP013-SQLCA            32130099
321400                 MOVE 'XLT_MDSE_INV_PARM'                         32140099
321500                                        TO DP013-DB2-TABLE-NAME(1)32150099
321600                 SET DP013-DB2-ABEND                              32160099
321700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           32170099
321800                 PERFORM DP013-0000-PROCESS-ABEND                 32180099
321900         END-EVALUATE                                             32190099
322000     END-PERFORM.                                                 32200099
322100                                                                  32210099
322200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         32220099
322300         MOVE '3560-CHECK-INVENTORY-DATE'                         32230099
322400                                  TO DP013-PARAGRAPH              32240099
322500         MOVE 'GET PLANNED INVENTORY DATE'                        32250099
322600                                  TO DP013-MESSAGE-TEXT(1)        32260099
322700         MOVE 'MAX RETRIES EXCEEDED'                              32270099
322800                                  TO DP013-MESSAGE-TEXT(2)        32280099
322900         MOVE SQLCA               TO DP013-SQLCA                  32290099
323000         MOVE 'XLT_MDSE_INV_PARM' TO DP013-DB2-TABLE-NAME(1)      32300099
323100         SET DP013-DB2-ABEND                                      32310099
323200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   32320099
323300         PERFORM DP013-0000-PROCESS-ABEND                         32330099
323400     END-IF.                                                      32340099
323500                                                                  32350099
323600******************************************************************32360099
323700*  SET-UP RTV INFO:  CREATE SHIPT-ID, CHECK THAT REQUIRED INFO   *32370099
323800*  HAS BEEN FILLED IN.  IF ANYTHING IS MISSING, SEND ERROR MSG   *32380099
323900*  AND DO NOT ALLOW UPDATE                                       *32390099
324000******************************************************************32400099
324100 3600-PREPARE-RTV-INFO.                                           32410099
324200     IF  ASC-DFCT-SHIPT-ID = 0                                    32420099
324300         INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS                  32430099
324400         CALL PC-RAND-PGM USING DFHEIBLK                          32440099
324500                                DFHCOMMAREA                       32450099
324600                                DP902-RANDNBR-ROUTINE-FIELDS      32460099
324700                                                                  32470099
324800         IF DP902-SUCCESSFUL                                      32480099
324900             MOVE DP902-RANDOM-NUMBER TO ASC-DFCT-SHIPT-ID        32490099
325000         ELSE                                                     32500099
325100             SET PS-ERROR                                         32510099
325200                 DP020-MSG-FATAL      TO TRUE                     32520099
325300             MOVE '3600-PREPARE-RTV-INFO'                         32530099
325400                                      TO DP013-PARAGRAPH          32540099
325500             MOVE 'GET RANDOM NBR ROUTINE'                        32550099
325600                                      TO DP013-MESSAGE-TEXT (1)   32560099
325700             SET DP013-DB2-ABEND                                  32570099
325800                 DP013-XCTL-DISPLAY-RESTART                       32580099
325900                                      TO TRUE                     32590099
326000             PERFORM DP013-0000-PROCESS-ABEND                     32600099
326100         END-IF                                                   32610099
326200     END-IF.                                                      32620099
326300                                                                  32630099
326400     IF ASC-DFCT-WT-QTY  = ZERO                                   32640099
326500         SET PS-UPDATE-NOT-OK        TO TRUE                      32650099
326600         SET PS-ERROR                TO TRUE                      32660099
326700         SET DP020-MSG-WARNING       TO TRUE                      32670099
326800         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          32680099
326900         MOVE -1                     TO AWEIGHTL                  32690099
327000         MOVE DP015-UNP-ALP-BRT-MDT  TO AWEIGHTA                  32700099
327100         MOVE DP015-RED              TO AWEIGHTC                  32710099
327200         MOVE DP015-REVERSE          TO AWEIGHTH                  32720099
327300     END-IF.                                                      32730099
327400                                                                  32740099
327500     IF ASC-CART-QTY     = ZERO                                   32750099
327600         SET PS-UPDATE-NOT-OK        TO TRUE                      32760099
327700         SET PS-ERROR                TO TRUE                      32770099
327800         SET DP020-MSG-WARNING       TO TRUE                      32780099
327900         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          32790099
328000         MOVE -1                     TO ACARTONL                  32800099
328100         MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTONA                  32810099
328200         MOVE DP015-RED              TO ACARTONC                  32820099
328300         MOVE DP015-REVERSE          TO ACARTONH                  32830099
328400     END-IF.                                                      32840099
328500                                                                  32850099
328600     IF ASC-TRAILER-NBR  = SPACES                                 32860099
328700         SET PS-UPDATE-NOT-OK        TO TRUE                      32870099
328800         SET PS-ERROR                TO TRUE                      32880099
328900         SET DP020-MSG-WARNING       TO TRUE                      32890099
329000         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          32900099
329100         MOVE -1                     TO ATRAILRL                  32910099
329200         MOVE DP015-UNP-ALP-BRT-MDT  TO ATRAILRA                  32920099
329300         MOVE DP015-RED              TO ATRAILRC                  32930099
329400         MOVE DP015-REVERSE          TO ATRAILRH                  32940099
329500     END-IF.                                                      32950099
329600                                                                  32960099
329700     IF ASC-SCAC         = SPACES                                 32970099
329800         SET PS-UPDATE-NOT-OK        TO TRUE                      32980099
329900         SET PS-ERROR                TO TRUE                      32990099
330000         SET DP020-MSG-WARNING       TO TRUE                      33000099
330100         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          33010099
330200         MOVE -1                     TO ASCACL                    33020099
330300         MOVE DP015-UNP-ALP-BRT-MDT  TO ASCACA                    33030099
330400         MOVE DP015-RED              TO ASCACC                    33040099
330500         MOVE DP015-REVERSE          TO ASCACH                    33050099
330600     END-IF.                                                      33060099
330700                                                                  33070099
330800     IF ASC-AUTH-DTE     = SPACES                                 33080099
330900         SET PS-UPDATE-NOT-OK        TO TRUE                      33090099
331000         SET PS-ERROR                TO TRUE                      33100099
331100         SET DP020-MSG-WARNING       TO TRUE                      33110099
331200         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          33120099
331300         MOVE -1                     TO AAUTHDTL                  33130099
331400         MOVE DP015-UNP-ALP-BRT-MDT  TO AAUTHDTA                  33140099
331500         MOVE DP015-RED              TO AAUTHDTC                  33150099
331600         MOVE DP015-REVERSE          TO AAUTHDTH                  33160099
331700         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      33170099
331800     END-IF.                                                      33180099
331900                                                                  33190099
332000     IF ASC-AUTH-ID      = SPACES                                 33200099
332100         SET PS-UPDATE-NOT-OK        TO TRUE                      33210099
332200         SET PS-ERROR                TO TRUE                      33220099
332300         SET DP020-MSG-WARNING       TO TRUE                      33230099
332400         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          33240099
332500         MOVE -1                     TO AAUTHIDL                  33250099
332600         MOVE DP015-UNP-ALP-BRT-MDT  TO AAUTHIDA                  33260099
332700         MOVE DP015-RED              TO AAUTHIDC                  33270099
332800         MOVE DP015-REVERSE          TO AAUTHIDH                  33280099
332900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      33290099
333000     END-IF.                                                      33300099
333100                                                                  33310099
333200     IF ASC-DED-CHRG-AMT > ZERO   AND                             33320099
333300        (ASC-DISC-PCT    > ZERO   OR                              33330099
333400         ASC-DISC-AMT    > ZERO)                                  33340099
333500         SET PS-UPDATE-NOT-OK        TO TRUE                      33350099
333600         SET PS-ERROR                TO TRUE                      33360099
333700         SET DP020-MSG-WARNING       TO TRUE                      33370099
333800         MOVE PC-TSYMSG-03157        TO DP020-MSG-NUMBER          33380099
333900         MOVE -1                     TO ADEDUCTL                  33390099
334000         MOVE DP015-UNP-ALP-BRT-MDT  TO ADEDUCTA                  33400099
334100                                        ADSCPCTA                  33410099
334200                                        ADISCNTA                  33420099
334300         MOVE DP015-RED              TO ADEDUCTC                  33430099
334400                                        ADSCPCTC                  33440099
334500                                        ADISCNTC                  33450099
334600         MOVE DP015-REVERSE          TO ADEDUCTH                  33460099
334700                                        ADSCPCTH                  33470099
334800                                        ADISCNTH                  33480099
334900         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      33490099
335000     END-IF.                                                      33500099
335100                                                                  33510099
335200     IF PS-UPDATE-OK                                              33520099
335300         SET ASC-RTV-STAT-S TO TRUE                               33530099
335400         MOVE 'SHIPPED'       TO ASC-STATUS                       33540099
335500     END-IF.                                                      33550099
335600                                                                  33560099
335700******************************************************************33570099
335800*  SET-UP DND INFO:  CHECK THAT AUTH-ID, AUTH-DATE, RET. REASON, *33580099
335900*  NBR OF CARTONS ARE FILLED IN. IF NOT ALL FIELDS ARE ENTERED   *33590099
336000*  SEND ERROR MSG AND DO NOT ALLOW UPDATE                        *33600099
336100******************************************************************33610099
336200 3700-PREPARE-DND-INFO.                                           33620099
336300     IF  ASC-DFCT-SHIPT-ID = 0                                    33630099
336400         INITIALIZE DP902-RANDNBR-ROUTINE-FIELDS                  33640099
336500         CALL PC-RAND-PGM USING DFHEIBLK                          33650099
336600                                DFHCOMMAREA                       33660099
336700                                DP902-RANDNBR-ROUTINE-FIELDS      33670099
336800                                                                  33680099
336900         IF DP902-SUCCESSFUL                                      33690099
337000             MOVE DP902-RANDOM-NUMBER TO ASC-DFCT-SHIPT-ID        33700099
337100         ELSE                                                     33710099
337200             SET PS-ERROR                                         33720099
337300                 DP020-MSG-FATAL      TO TRUE                     33730099
337400             MOVE '3700-PREPARE-DND-INFO'                         33740099
337500                                      TO DP013-PARAGRAPH          33750099
337600             MOVE 'GET RANDOM NBR ROUTINE'                        33760099
337700                                      TO DP013-MESSAGE-TEXT (1)   33770099
337800             SET DP013-DB2-ABEND                                  33780099
337900                 DP013-XCTL-DISPLAY-RESTART                       33790099
338000                                      TO TRUE                     33800099
338100             PERFORM DP013-0000-PROCESS-ABEND                     33810099
338200         END-IF                                                   33820099
338300     END-IF.                                                      33830099
338400                                                                  33840099
338500     IF ASC-DFCT-WT-QTY  = ZERO                                   33850099
338600         SET PS-UPDATE-NOT-OK        TO TRUE                      33860099
338700         SET PS-ERROR                TO TRUE                      33870099
338800         SET DP020-MSG-WARNING       TO TRUE                      33880099
338900         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          33890099
339000         MOVE -1                     TO AWEIGHTL                  33900099
339100         MOVE DP015-UNP-ALP-BRT-MDT  TO AWEIGHTA                  33910099
339200         MOVE DP015-RED              TO AWEIGHTC                  33920099
339300         MOVE DP015-REVERSE          TO AWEIGHTH                  33930099
339400     END-IF.                                                      33940099
339500                                                                  33950099
339600     IF ASC-CART-QTY     = ZERO                                   33960099
339700         SET PS-UPDATE-NOT-OK        TO TRUE                      33970099
339800         SET PS-ERROR                TO TRUE                      33980099
339900         SET DP020-MSG-WARNING       TO TRUE                      33990099
340000         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          34000099
340100         MOVE -1                     TO ACARTONL                  34010099
340200         MOVE DP015-UNP-ALP-BRT-MDT  TO ACARTONA                  34020099
340300         MOVE DP015-RED              TO ACARTONC                  34030099
340400         MOVE DP015-REVERSE          TO ACARTONH                  34040099
340500     END-IF.                                                      34050099
340600                                                                  34060099
340700     IF ASC-TRAILER-NBR  = SPACES                                 34070099
340800         SET PS-UPDATE-NOT-OK        TO TRUE                      34080099
340900         SET PS-ERROR                TO TRUE                      34090099
341000         SET DP020-MSG-WARNING       TO TRUE                      34100099
341100         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          34110099
341200         MOVE -1                     TO ATRAILRL                  34120099
341300         MOVE DP015-UNP-ALP-BRT-MDT  TO ATRAILRA                  34130099
341400         MOVE DP015-RED              TO ATRAILRC                  34140099
341500         MOVE DP015-REVERSE          TO ATRAILRH                  34150099
341600     END-IF.                                                      34160099
341700                                                                  34170099
341800     IF ASC-SCAC         = SPACES                                 34180099
341900         SET PS-UPDATE-NOT-OK        TO TRUE                      34190099
342000         SET PS-ERROR                TO TRUE                      34200099
342100         SET DP020-MSG-WARNING       TO TRUE                      34210099
342200         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          34220099
342300         MOVE -1                     TO ASCACL                    34230099
342400         MOVE DP015-UNP-ALP-BRT-MDT  TO ASCACA                    34240099
342500         MOVE DP015-RED              TO ASCACC                    34250099
342600         MOVE DP015-REVERSE          TO ASCACH                    34260099
342700     END-IF.                                                      34270099
342800                                                                  34280099
342900     IF ASC-AUTH-DTE     = SPACES                                 34290099
343000         SET PS-UPDATE-NOT-OK        TO TRUE                      34300099
343100         SET PS-ERROR                TO TRUE                      34310099
343200         SET DP020-MSG-WARNING       TO TRUE                      34320099
343300         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          34330099
343400         MOVE -1                     TO AAUTHDTL                  34340099
343500         MOVE DP015-UNP-ALP-BRT-MDT  TO AAUTHDTA                  34350099
343600         MOVE DP015-RED              TO AAUTHDTC                  34360099
343700         MOVE DP015-REVERSE          TO AAUTHDTH                  34370099
343800         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34380099
343900     END-IF.                                                      34390099
344000                                                                  34400099
344100     IF ASC-AUTH-ID      = SPACES                                 34410099
344200         SET PS-UPDATE-NOT-OK        TO TRUE                      34420099
344300         SET PS-ERROR                TO TRUE                      34430099
344400         SET DP020-MSG-WARNING       TO TRUE                      34440099
344500         MOVE PC-TSYMSG-03158        TO DP020-MSG-NUMBER          34450099
344600         MOVE -1                     TO AAUTHIDL                  34460099
344700         MOVE DP015-UNP-ALP-BRT-MDT  TO AAUTHIDA                  34470099
344800         MOVE DP015-RED              TO AAUTHIDC                  34480099
344900         MOVE DP015-REVERSE          TO AAUTHIDH                  34490099
345000         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      34500099
345100     END-IF.                                                      34510099
345200                                                                  34520099
345300     IF PS-UPDATE-OK                                              34530099
345400         MOVE +0        TO NI-SHIPT-ID                            34540099
345500                           NI-AUTH-ID                             34550099
345600                           NI-AUTH-DTE                            34560099
345700                           NI-CART-QTY                            34570099
345800                           NI-INBND-FRGT                          34580099
345900                           NI-OUTBND-FRGT                         34590099
346000                           NI-DEDUCT                              34600099
346100                           NI-WEIGHT                              34610099
346200                           NI-DISC-PCT                            34620099
346300                           NI-DISC-AMT                            34630099
346400                           NI-RET-RSN                             34640099
346500                           NI-PAYT-TYP                            34650099
346600                           NI-SPEC-INSTR                          34660099
346700         MOVE 'D & D'             TO ASC-AUTH-ID                  34670099
346800         IF ASC-AUTH-DTE = SPACES                                 34680099
346900             PERFORM 3800-GET-CLOSE-DATE                          34690099
347000         END-IF                                                   34700099
347100         SET ASC-DND-STAT-S                                       34710099
347200             ASC-DND-TYP          TO TRUE                         34720099
347300         MOVE 'SHIPPED'           TO ASC-STATUS                   34730099
347400         MOVE ASC-DFCT-ORD-ID     TO DK-DFCT-ORD-ID               34740099
347500         PERFORM 3900-GET-USER-NAME                               34750099
347600     END-IF.                                                      34760099
347700                                                                  34770099
347800******************************************************************34780099
347900*  CHANGE STATUS IF LISTING IS RTV CHANGE TO DND. IF IT IS DND   *34790099
348000*  THEN CHANGE TO RTV                                            *34800099
348100******************************************************************34810099
348200 3710-CHANGE-LIST-TYPE.                                           34820099
348300     MOVE +0                  TO NI-SPEC-INSTR.                   34830099
348400     IF  ASC-RTV-TYP                                              34840099
348500         SET ASC-DND-STAT-D                                       34850099
348600             ASC-DND-TYP      TO TRUE                             34860099
348700         MOVE 'D & D'         TO ASC-STATUS                       34870099
348800                                 ASC-LIST-TYPE                    34880099
348900     ELSE                                                         34890099
349000         SET ASC-RTV-STAT-C                                       34900099
349100             ASC-RTV-TYP      TO TRUE                             34910099
349200         MOVE 'CLOSED'        TO ASC-STATUS                       34920099
349300         MOVE 'RTV'           TO ASC-LIST-TYPE                    34930099
349400     END-IF.                                                      34940099
349500     MOVE ASC-DFCT-ORD-ID     TO DK-DFCT-ORD-ID.                  34950099
349600                                                                  34960099
349700******************************************************************34970099
349800*  UNSHIP A LISTING                                              *34980099
349900******************************************************************34990099
350000 3720-UNSHIP-LISTING.                                             35000099
350100     MOVE +0                  TO NI-SPEC-INSTR.                   35010099
350200     IF  ASC-RTV-TYP                                              35020099
350300         MOVE ASC-TYPE-CDE    TO ASC-STAT-CDE-OLD                 35030099
350400         SET ASC-RTV-STAT-C   TO TRUE                             35040099
350500         MOVE 'CLOSED'        TO ASC-STATUS                       35050099
350600     ELSE                                                         35060099
350700         MOVE ASC-TYPE-CDE    TO ASC-STAT-CDE-OLD                 35070099
350800         SET ASC-DND-STAT-D   TO TRUE                             35080099
350900         MOVE 'D & D'         TO ASC-STATUS                       35090099
351000     END-IF.                                                      35100099
351100     MOVE ASC-DFCT-ORD-ID     TO DK-DFCT-ORD-ID.                  35110099
351200     MOVE ASC-DFCT-SHIPT-ID   TO DK-DFCT-SHIPT-ID.                35120099
351300     PERFORM 3730-COUNT-LISTINGS.                                 35130099
351400     IF PV-LISTING-COUNT > 1                                      35140099
351500******* MORE THAN 1 LISTING ON SHIPMENT, CAN'T DELETE SHIPMENT    35150099
351600         SET PS-DO-NOT-DELETE-SHIPMENT                            35160099
351700                              TO TRUE                             35170099
351800     ELSE                                                         35180099
351900         IF PV-LISTING-COUNT = 1                                  35190099
352000*******  ONLY 1 CAN DELETE SHIPMENT ROWS                          35200099
352100             SET PS-DELETE-SHIPMENT                               35210099
352200                              TO TRUE                             35220099
352300         ELSE                                                     35230099
352400             IF PV-LISTING-COUNT = 0                              35240099
352500*******  LISTING HASN'T BEEN SHIPPED                              35250099
352600                 MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER         35260099
352700                 SET DP020-MSG-WARNING TO TRUE                    35270099
352800             END-IF                                               35280099
352900         END-IF                                                   35290099
353000     END-IF.                                                      35300099
353100                                                                  35310099
353200*----------------------------------------------------------------*35320099
353300*  COUNT THE NUMBER OF LISTING ON A SHIPMENT                     *35330099
353400*----------------------------------------------------------------*35340099
353500 3730-COUNT-LISTINGS.                                             35350099
353600     PERFORM WITH TEST AFTER                                      35360099
353700         VARYING PV-RETRY-COUNTER                                 35370099
353800         FROM 1 BY 1                                              35380099
353900         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 35390099
354000                 OR SQLCODE = 0                                   35400099
354100                 OR SQLCODE = +100                                35410099
354200                 OR SQLCODE = -811)                               35420099
354300                                                                  35430099
354400         EXEC SQL                                                 35440099
354500             SELECT DFCT.DFCT_SHIPT_ID                            35450099
354600                  , COUNT(DFCT.DFCT_SHIPT_ID)                     35460099
354700               INTO :DFCTOR-DFCT-SHIPT-ID                         35470099
354800                  , :PV-LISTING-COUNT                             35480099
354900               FROM TDFCTOR DFCT                                  35490099
355000              WHERE DFCT.DFCT_SHIPT_ID = :DK-DFCT-SHIPT-ID        35500099
355100              GROUP BY DFCT.DFCT_SHIPT_ID                         35510099
355200         END-EXEC                                                 35520099
355300                                                                  35530099
355400         EVALUATE TRUE                                            35540099
355500             WHEN SQLCODE = ZERO                                  35550099
355600                 SET PS-DATA-FOUND   TO TRUE                      35560099
355700             WHEN SQLCODE = -811                                  35570099
355800                 SET PS-DATA-FOUND   TO TRUE                      35580099
355900             WHEN SQLCODE = +100                                  35590099
356000                 SET PS-DATA-NOT-FOUND TO TRUE                    35600099
356100                 MOVE 0 TO PV-LISTING-COUNT                       35610099
356200             WHEN SQLCODE = -904                                  35620099
356300             WHEN SQLCODE = -913                                  35630099
356400                 SET PS-DATA-NOT-FOUND TO TRUE                    35640099
356500             WHEN SQLWARN0 NOT = SPACES                           35650099
356600             WHEN SQLCODE NOT EQUAL ZERO                          35660099
356700                 MOVE '3730-COUNT-LISTINGS'                       35670099
356800                                        TO DP013-PARAGRAPH        35680099
356900                 MOVE 'COUNT LISTINGS ON SPECIFIC SHIPMENT'       35690099
357000                                        TO DP013-MESSAGE-TEXT(1)  35700099
357100                 MOVE SQLCA             TO DP013-SQLCA            35710099
357200                 MOVE 'TDFCTOR'         TO DP013-DB2-TABLE-NAME(1)35720099
357300                 SET DP013-DB2-ABEND                              35730099
357400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           35740099
357500                 PERFORM DP013-0000-PROCESS-ABEND                 35750099
357600         END-EVALUATE                                             35760099
357700     END-PERFORM.                                                 35770099
357800                                                                  35780099
357900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         35790099
358000         MOVE '3730-COUNT-LISTINGS'                               35800099
358100                                  TO DP013-PARAGRAPH              35810099
358200         MOVE 'COUNT LISTINGS ON SPECIFIC SHIPMENT'               35820099
358300                                  TO DP013-MESSAGE-TEXT(1)        35830099
358400         MOVE 'MAX RETRIES EXCEEDED'                              35840099
358500                                  TO DP013-MESSAGE-TEXT(2)        35850099
358600         MOVE SQLCA               TO DP013-SQLCA                  35860099
358700         MOVE 'TDFCTOR'           TO DP013-DB2-TABLE-NAME(1)      35870099
358800         SET DP013-DB2-ABEND                                      35880099
358900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   35890099
359000         PERFORM DP013-0000-PROCESS-ABEND                         35900099
359100     END-IF.                                                      35910099
359200                                                                  35920099
359300*----------------------------------------------------------------*35930099
359400*  GET THE CLOSE DATE FOR THE AUTH-DTE                           *35940099
359500*----------------------------------------------------------------*35950099
359600 3800-GET-CLOSE-DATE.                                             35960099
359700     PERFORM WITH TEST AFTER                                      35970099
359800         VARYING PV-RETRY-COUNTER                                 35980099
359900         FROM 1 BY 1                                              35990099
360000         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 36000099
360100                 OR SQLCODE = 0                                   36010099
360200                 OR SQLCODE = +100)                               36020099
360300                                                                  36030099
360400         EXEC SQL                                                 36040099
360500             SELECT DFCT.DFCT_ORD_ID                              36050099
360600                  , CHAR(DATE(STAT.CHGD_TMST),USA)                36060099
360700               INTO :DFCTOR-DFCT-ORD-ID                           36070099
360800                  , :PV-CLOSE-DATE                                36080099
360900               FROM TDFCTOR DFCT                                  36090099
361000                  , RVT_DFCT_STAT STAT                            36100099
361100              WHERE DFCT.DFCT_ORD_ID  = :DK-DFCT-ORD-ID           36110099
361200                AND DFCT.DFCT_ORD_ID  = STAT.DFCT_ORD_ID          36120099
361300                AND DFCT.DFCT_ORD_STAT_CDE IN ('C', 'D')          36130099
361400                AND  STAT.CHGD_TMST   =                           36140099
361500                        (SELECT MIN(CHGD_TMST)                    36150099
361600                           FROM RVT_DFCT_STAT Z                   36160099
361700                          WHERE Z.DFCT_ORD_ID = DFCT.DFCT_ORD_ID  36170099
361800                            AND Z.DFCT_ORD_STAT_CDE               36180099
361900                                              IN ('C', 'D'))      36190099
362000         END-EXEC                                                 36200099
362100                                                                  36210099
362200         EVALUATE TRUE                                            36220099
362300             WHEN SQLCODE = ZERO                                  36230099
362400                 SET PS-DATA-FOUND   TO TRUE                      36240099
362500                 MOVE PV-CLOSE-DATE  TO ASC-AUTH-DTE              36250099
362600             WHEN SQLCODE = +100                                  36260099
362700             WHEN SQLCODE = -904                                  36270099
362800             WHEN SQLCODE = -913                                  36280099
362900                 SET PS-DATA-NOT-FOUND TO TRUE                    36290099
363000             WHEN SQLWARN0 NOT = SPACES                           36300099
363100             WHEN SQLCODE NOT EQUAL ZERO                          36310099
363200                 MOVE '3800-GET-CLOSE-DATE' TO DP013-PARAGRAPH    36320099
363300                 MOVE 'GET RVT_DFCT_STAT' TO DP013-MESSAGE-TEXT(1)36330099
363400                 MOVE SQLCA             TO DP013-SQLCA            36340099
363500                 MOVE 'RVT_DFCT_STAT'   TO DP013-DB2-TABLE-NAME(1)36350099
363600                 SET DP013-DB2-ABEND                              36360099
363700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36370099
363800                 PERFORM DP013-0000-PROCESS-ABEND                 36380099
363900         END-EVALUATE                                             36390099
364000     END-PERFORM.                                                 36400099
364100                                                                  36410099
364200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         36420099
364300         MOVE '3800-GET-CLOSE-DATE'                               36430099
364400                                  TO DP013-PARAGRAPH              36440099
364500         MOVE 'GET RVT_DFCT_STAT' TO DP013-MESSAGE-TEXT(1)        36450099
364600         MOVE 'MAX RETRIES EXCEEDED' TO DP013-MESSAGE-TEXT(2)     36460099
364700         MOVE SQLCA               TO DP013-SQLCA                  36470099
364800         MOVE 'RVT_DFCT_STAT'     TO DP013-DB2-TABLE-NAME(1)      36480099
364900         SET DP013-DB2-ABEND                                      36490099
365000             DP013-XCTL-DISPLAY-RESTART TO TRUE                   36500099
365100         PERFORM DP013-0000-PROCESS-ABEND                         36510099
365200     END-IF.                                                      36520099
365300                                                                  36530099
365400*----------------------------------------------------------------*36540099
365500*  GET THE NAME OF WHO IS SHIPPING THE LISTING                   *36550099
365600*----------------------------------------------------------------*36560099
365700 3900-GET-USER-NAME.                                              36570099
365800     INITIALIZE DCLXLT00024.                                      36580099
365900                                                                  36590099
366000     PERFORM WITH TEST AFTER                                      36600099
366100         VARYING PV-RETRY-COUNTER                                 36610099
366200         FROM 1 BY 1                                              36620099
366300         UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES                 36630099
366400                 OR SQLCODE = 0                                   36640099
366500                 OR SQLCODE = +100)                               36650099
366600                                                                  36660099
366700         EXEC SQL                                                 36670099
366800             SELECT USR_FRST_NM                                   36680099
366900                  , USR_LAST_NM                                   36690099
367000               INTO :XLT00024-USR-FRST-NM                         36700099
367100                  , :XLT00024-USR-LAST-NM                         36710099
367200               FROM XLT_USR                                       36720099
367300              WHERE USR_ID         = :DP020-USERID                36730099
367400         END-EXEC                                                 36740099
367500                                                                  36750099
367600         EVALUATE TRUE                                            36760099
367700             WHEN SQLCODE = ZERO                                  36770099
367800                 SET PS-DATA-FOUND   TO TRUE                      36780099
367900                 STRING XLT00024-USR-FRST-NM DELIMITED BY '  '    36790099
368000                        ' '                  DELIMITED BY SIZE    36800099
368100                        XLT00024-USR-LAST-NM DELIMITED BY SIZE    36810099
368200                   INTO ASC-SHIPPED-BY                            36820099
368300             WHEN SQLCODE = +100                                  36830099
368400                 SET PS-DATA-NOT-FOUND TO TRUE                    36840099
368500                 MOVE DP020-USERID   TO ASC-SHIPPED-BY            36850099
368600             WHEN SQLCODE = -904                                  36860099
368700             WHEN SQLCODE = -913                                  36870099
368800                 SET PS-DATA-NOT-FOUND TO TRUE                    36880099
368900             WHEN SQLWARN0 NOT = SPACES                           36890099
369000             WHEN SQLCODE NOT EQUAL ZERO                          36900099
369100                 MOVE '3900-GET-USER-NAME' TO DP013-PARAGRAPH     36910099
369200                 MOVE 'GET USER NAME'   TO DP013-MESSAGE-TEXT(1)  36920099
369300                 MOVE SQLCA             TO DP013-SQLCA            36930099
369400                 MOVE 'XLT_USR'         TO DP013-DB2-TABLE-NAME(1)36940099
369500                 SET DP013-DB2-ABEND                              36950099
369600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           36960099
369700                 PERFORM DP013-0000-PROCESS-ABEND                 36970099
369800         END-EVALUATE                                             36980099
369900     END-PERFORM.                                                 36990099
370000                                                                  37000099
370100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         37010099
370200         MOVE '3900-GET-USER-NAME'   TO DP013-PARAGRAPH           37020099
370300         MOVE 'GET USER NAME'        TO DP013-MESSAGE-TEXT(1)     37030099
370400         MOVE 'MAX RETRIES EXCEEDED' TO DP013-MESSAGE-TEXT(2)     37040099
370500         MOVE SQLCA                  TO DP013-SQLCA               37050099
370600         MOVE 'XLT_USR'              TO DP013-DB2-TABLE-NAME(1)   37060099
370700         SET DP013-DB2-ABEND                                      37070099
370800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   37080099
370900         PERFORM DP013-0000-PROCESS-ABEND                         37090099
371000     END-IF.                                                      37100099
371100                                                                  37110099
371200*----------------------------------------------------------------*37120099
371300*    BUILD THE INITIAL PANEL FOR FIRST TIME DISPLAY              *37130099
371400*----------------------------------------------------------------*37140099
371500 4000-BUILD-INITIAL-PANEL.                                        37150099
371600     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        37160099
371700     MOVE ASC-DFCT-ORD-ID              TO DK-DFCT-ORD-ID.         37170099
371800                                                                  37180099
371900     PERFORM 4100-GET-DATA.                                       37190099
372000     IF PS-DATA-FOUND                                             37200099
372100         IF NI-SHIPT-ID    < ZERO                                 37210099
372200             SET ASC-SHIPT-ID-NOT-FOUND TO TRUE                   37220099
372300             MOVE SPACES TO RVT00001-CRE-TMST                     37230099
372400             MOVE SPACES TO RVT00001-SHIPT-STAT-CDE               37240099
372500             MOVE SPACES TO RVT00001-USR-ID                       37250099
372600             MOVE SPACES TO RVT00000-TRLR-ID                      37260099
372700             MOVE SPACES TO RVT00000-SCAC-CDE                     37270099
372800             MOVE SPACES TO RVT00000-ACTL-SHIPT-DTE               37280099
372900         ELSE                                                     37290099
373000             MOVE DFCTOR-DFCT-SHIPT-ID TO DK-DFCT-SHIPT-ID        37300099
373100             PERFORM 4200-GET-SHIP-INFO                           37310099
373200         END-IF                                                   37320099
373300         IF PS-DATA-FOUND                                         37330099
373400             PERFORM 4300-MOVE-DB-DATA-TO-COMMAREA                37340099
373500             PERFORM 3420-SELECT-TVNDAGR-1                        37350099
373600             PERFORM 3430-CHK-FRGT-TERMS                          37360099
373700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 37370099
373800         END-IF                                                   37380099
373900     END-IF.                                                      37390099
374000                                                                  37400099
374100*----------------------------------------------------------------*37410099
374200* SELECT A ROW FROM TDFCTOR AND ACCOMPANYING STATUS TABLE        *37420099
374300*----------------------------------------------------------------*37430099
374400 4100-GET-DATA.                                                   37440099
374500     PERFORM                                                      37450099
374600         WITH TEST AFTER                                          37460099
374700         VARYING PV-RETRY-COUNTER                                 37470099
374800         FROM 1 BY 1                                              37480099
374900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               37490099
375000                   OR (SQLCODE = ZERO)                            37500099
375100                   OR (SQLCODE = +100))                           37510099
375200*                                                                 37520099
375300         EXEC SQL                                                 37530099
375400             SELECT DFCT_SHIPT_ID                                 37540099
375500                  , DFCT_UID_NBR                                  37550099
375600                  , LOC_ID                                        37560099
375700                  , DFCT_ORD_ID_CDE                               37570099
375800                  , DFCT.DFCT_ORD_STAT_CDE                        37580099
375900                  , VND_AUTH_ID                                   37590099
376000                  , CHAR(DATE(VND_AUTH_DTE),USA)                  37600099
376100                  , RET_RSN_CDE                                   37610099
376200                  , PAYT_TYP_CDE                                  37620099
376300                  , CART_QTY                                      37630099
376400                  , SPC_INSTR_TXT                                 37640099
376500                  , INBD_RET_FRGT_AMT                             37650099
376600                  , OTBND_RET_FRGT_AMT                            37660099
376700                  , DED_CHRG_AMT                                  37670099
376800                  , DFCT_WT_QTY                                   37680099
376900                  , DISC_PCT                                      37690099
377000                  , DISC_AMT                                      37700099
377100                  , CARR_TRKG_ID                                  37710099
377200                  , USR_ID                                        37720099
377300               INTO :DFCTOR-DFCT-SHIPT-ID:NI-SHIPT-ID             37730099
377400                  , :DFCTOR-DFCT-UID-NBR                          37740099
377500                  , :DFCTOR-LOC-ID                                37750099
377600                  , :DFCTOR-DFCT-ORD-ID-CDE                       37760099
377700                  , :DFCTOR-DFCT-ORD-STAT-CDE                     37770099
377800                  , :DFCTOR-VND-AUTH-ID:NI-AUTH-ID                37780099
377900                  , :DFCTOR-VND-AUTH-DTE:NI-AUTH-DTE              37790099
378000                  , :DFCTOR-RET-RSN-CDE:NI-RET-RSN                37800099
378100                  , :DFCTOR-PAYT-TYP-CDE:NI-PAYT-TYP              37810099
378200                  , :DFCTOR-CART-QTY:NI-CART-QTY                  37820099
378300                  , :DFCTOR-SPC-INSTR-TXT:NI-SPEC-INSTR           37830099
378400                  , :DFCTOR-INBD-RET-FRGT-AMT:NI-INBND-FRGT       37840099
378500                  , :DFCTOR-OTBND-RET-FRGT-AMT:NI-OUTBND-FRGT     37850099
378600                  , :DFCTOR-DED-CHRG-AMT:NI-DEDUCT                37860099
378700                  , :DFCTOR-DFCT-WT-QTY:NI-WEIGHT                 37870099
378800                  , :DFCTOR-DISC-PCT:NI-DISC-PCT                  37880099
378900                  , :DFCTOR-DISC-AMT:NI-DISC-AMT                  37890099
379000                  , :DFCTOR-CARR-TRKG-ID:NI-TRKG-ID               37900099
379100                  , :RVT00003-USR-ID                              37910099
379200             FROM   TDFCTOR  DFCT                                 37920099
379300                  , RVT_DFCT_STAT  DSTAT                          37930099
379400             WHERE  DFCT.DFCT_ORD_ID       = :DK-DFCT-ORD-ID      37940099
379500               AND  DFCT.DFCT_ORD_ID       = DSTAT.DFCT_ORD_ID    37950099
379600               AND  DFCT.DFCT_ORD_STAT_CDE =                      37960099
379700                                           DSTAT.DFCT_ORD_STAT_CDE37970099
379800               AND  DSTAT.CHGD_TMST        =                      37980099
379900                        (SELECT MAX(CHGD_TMST)                    37990099
380000                           FROM RVT_DFCT_STAT Z                   38000099
380100                          WHERE Z.DFCT_ORD_ID = DFCT.DFCT_ORD_ID) 38010099
380200         END-EXEC                                                 38020099
380300                                                                  38030099
380400         EVALUATE TRUE                                            38040099
380500             WHEN SQLCODE = ZERO                                  38050099
380600                 SET PS-DATA-FOUND TO TRUE                        38060099
380700             WHEN SQLCODE = +100                                  38070099
380800                 SET PS-DATA-NOT-FOUND TO TRUE                    38080099
380900             WHEN SQLCODE = -904                                  38090099
381000             WHEN SQLCODE = -913                                  38100099
381100                 CONTINUE                                         38110099
381200             WHEN SQLWARN0 NOT = SPACES                           38120099
381300             WHEN SQLCODE < ZERO                                  38130099
381400             WHEN SQLCODE > ZERO                                  38140099
381500                 MOVE '4100-GET-DATA' TO DP013-PARAGRAPH          38150099
381600                 MOVE 'SELECT LISTING NUMBER'                     38160099
381700                                      TO DP013-MESSAGE-TEXT (1)   38170099
381800                 MOVE DK-DFCT-ORD-ID  TO DP013-MESSAGE-TEXT (2)   38180099
381900                 MOVE SQLCA           TO DP013-SQLCA              38190099
382000                 MOVE 'TDFCTOR'       TO DP013-DB2-TABLE-NAME (1) 38200099
382100                 MOVE 'RVT_DFCT_STAT' TO DP013-DB2-TABLE-NAME (2) 38210099
382200                 SET DP013-DB2-ABEND                              38220099
382300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38230099
382400                 PERFORM DP013-0000-PROCESS-ABEND                 38240099
382500         END-EVALUATE                                             38250099
382600     END-PERFORM.                                                 38260099
382700*                                                                 38270099
382800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38280099
382900         MOVE '4100-GET-DATA'                                     38290099
383000                                   TO DP013-PARAGRAPH             38300099
383100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     38310099
383200                                   TO DP013-MESSAGE-TEXT (1)      38320099
383300         MOVE 'LIST NUMBER'        TO DP013-MESSAGE-TEXT (2)      38330099
383400         MOVE DK-DFCT-ORD-ID       TO DP013-MESSAGE-TEXT (3)      38340099
383500         MOVE SQLCA                TO DP013-SQLCA                 38350099
383600         MOVE 'TDFCTOR'            TO DP013-DB2-TABLE-NAME (1)    38360099
383700         MOVE 'RVT_DFCT_STAT'      TO DP013-DB2-TABLE-NAME (2)    38370099
383800         SET DP013-DB2-ABEND                                      38380099
383900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   38390099
384000         PERFORM DP013-0000-PROCESS-ABEND                         38400099
384100     END-IF.                                                      38410099
384200                                                                  38420099
384300*----------------------------------------------------------------*38430099
384400* SELECT DATA FROM THE RTV SHIPPING TABLES                       *38440099
384500*----------------------------------------------------------------*38450099
384600 4200-GET-SHIP-INFO.                                              38460099
384700     PERFORM                                                      38470099
384800         WITH TEST AFTER                                          38480099
384900         VARYING PV-RETRY-COUNTER                                 38490099
385000         FROM 1 BY 1                                              38500099
385100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               38510099
385200                   OR (SQLCODE = ZERO)                            38520099
385300                   OR (SQLCODE = +100))                           38530099
385400*                                                                 38540099
385500         EXEC SQL                                                 38550099
385600             SELECT TRLR_ID                                       38560099
385700                  , SCAC_CDE                                      38570099
385800                  , COALESCE(CHAR(ACTL_SHIPT_DTE,USA),'         ')38580099
385900               INTO :RVT00000-TRLR-ID                             38590099
386000                  , :RVT00000-SCAC-CDE                            38600099
386100                  , :RVT00000-ACTL-SHIPT-DTE                      38610099
386200             FROM   RVT_DFCT_SHIPT SHIPT                          38620099
386300             WHERE  SHIPT.DFCT_SHIPT_ID  = :DK-DFCT-SHIPT-ID      38630099
386400         END-EXEC                                                 38640099
386500                                                                  38650099
386600         EVALUATE TRUE                                            38660099
386700             WHEN SQLCODE = ZERO                                  38670099
386800                 SET PS-DATA-FOUND                                38680099
386900                     ASC-SHIPT-ID-FOUND TO TRUE                   38690099
387000                 PERFORM 4250-GET-SHIP-USERNAME                   38700099
387100             WHEN SQLCODE = -904                                  38710099
387200             WHEN SQLCODE = -913                                  38720099
387300                 CONTINUE                                         38730099
387400             WHEN SQLCODE = +100                                  38740099
387500                 SET PS-DATA-NOT-FOUND                            38750099
387600                     ASC-SHIPT-ID-NOT-FOUND TO TRUE               38760099
387700                 MOVE SPACES TO RVT00001-CRE-TMST                 38770099
387800                 MOVE SPACES TO RVT00001-SHIPT-STAT-CDE           38780099
387900                 MOVE SPACES TO RVT00001-USR-ID                   38790099
388000                 MOVE SPACES TO RVT00000-TRLR-ID                  38800099
388100                 MOVE SPACES TO RVT00000-SCAC-CDE                 38810099
388200                 MOVE SPACES TO RVT00000-ACTL-SHIPT-DTE           38820099
388300             WHEN SQLWARN0 NOT = SPACES                           38830099
388400             WHEN SQLCODE < ZERO                                  38840099
388500             WHEN SQLCODE > ZERO                                  38850099
388600                 MOVE '4200-GET-SHIP-INFO' TO DP013-PARAGRAPH     38860099
388700                 MOVE 'SELECT DFCT_SHIPT_ID'                      38870099
388800                                       TO DP013-MESSAGE-TEXT (1)  38880099
388900                 MOVE DK-DFCT-SHIPT-ID TO DP013-MESSAGE-TEXT (2)  38890099
389000                 MOVE SQLCA            TO DP013-SQLCA             38900099
389100                 MOVE 'RVT_DFCT_SHIPT' TO DP013-DB2-TABLE-NAME (1)38910099
389200                 SET DP013-DB2-ABEND                              38920099
389300                     DP013-XCTL-DISPLAY-RESTART TO TRUE           38930099
389400                 PERFORM DP013-0000-PROCESS-ABEND                 38940099
389500         END-EVALUATE                                             38950099
389600     END-PERFORM.                                                 38960099
389700*                                                                 38970099
389800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        38980099
389900         MOVE '4200-GET-SHIP-INFO'                                38990099
390000                                   TO DP013-PARAGRAPH             39000099
390100         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     39010099
390200                                   TO DP013-MESSAGE-TEXT (1)      39020099
390300         MOVE 'SHIPPING INFO '     TO DP013-MESSAGE-TEXT (2)      39030099
390400         MOVE DK-DFCT-SHIPT-ID     TO DP013-MESSAGE-TEXT (3)      39040099
390500         MOVE SQLCA                TO DP013-SQLCA                 39050099
390600         MOVE 'RVT_DFCT_SHIPT'     TO DP013-DB2-TABLE-NAME (1)    39060099
390700         SET DP013-DB2-ABEND                                      39070099
390800             DP013-XCTL-DISPLAY-RESTART TO TRUE                   39080099
390900         PERFORM DP013-0000-PROCESS-ABEND                         39090099
391000     END-IF.                                                      39100099
391100                                                                  39110099
391200******************************************************************39120099
391300* 4250-GET-SHIP-USERNAME.                                         39130099
391400* ==> PROCESSES:                                                  39140099
391500*   - READS THE USERNAME OF THE PERSON WHO SHIPPED THE ORDER      39150099
391600*     FROM THE RVT_DFCT_STAT AND XLT_USR TABLES                   39160099
391700******************************************************************39170099
391800 4250-GET-SHIP-USERNAME.                                          39180099
391900                                                                  39190099
392000     INITIALIZE DCLXLT00024.                                      39200099
392100                                                                  39210099
392200     PERFORM                                                      39220099
392300         WITH TEST AFTER                                          39230099
392400         VARYING PV-RETRY-COUNTER                                 39240099
392500         FROM 1 BY 1                                              39250099
392600         UNTIL ((PV-RETRY-COUNTER GREATER THAN PC-MAX-RETRIES)    39260099
392700            OR (SQLCODE = 0)                                      39270099
392800            OR (SQLCODE = +100))                                  39280099
392900                                                                  39290099
393000         EXEC SQL                                                 39300099
393100             SELECT  B.USR_LAST_NM                                39310099
393200                    ,B.USR_FRST_NM                                39320099
393300               INTO  :XLT00024-USR-LAST-NM                        39330099
393400                    ,:XLT00024-USR-FRST-NM                        39340099
393500               FROM  RVT_DFCT_STAT A                              39350099
393600                    ,XLT_USR       B                              39360099
393700              WHERE A.DFCT_ORD_ID     = :DK-DFCT-ORD-ID           39370099
393800                AND A.CHGD_TMST =                                 39380099
393900                   (SELECT MAX(C.CHGD_TMST)                       39390099
394000                      FROM RVT_DFCT_STAT C                        39400099
394100                     WHERE C.DFCT_ORD_ID = A.DFCT_ORD_ID          39410099
394200                       AND C.DFCT_ORD_STAT_CDE = 'S')             39420099
394300                AND B.USR_ID                   = A.USR_ID         39430099
394400         END-EXEC                                                 39440099
394500                                                                  39450099
394600         EVALUATE TRUE                                            39460099
394700             WHEN SQLCODE = ZERO                                  39470099
394800                  STRING XLT00024-USR-FRST-NM DELIMITED BY '  '   39480099
394900                         ' '                  DELIMITED BY SIZE   39490099
395000                         XLT00024-USR-LAST-NM DELIMITED BY SIZE   39500099
395100                                     INTO ASC-SHIPPED-BY          39510099
395200             WHEN SQLCODE = +100                                  39520099
395300                 MOVE '** USERID NOT FOUND **'                    39530099
395400                                       TO ASC-SHIPPED-BY          39540099
395500             WHEN SQLCODE = -904                                  39550099
395600             WHEN SQLCODE = -913                                  39560099
395700                 CONTINUE                                         39570099
395800             WHEN SQLWARN0 NOT EQUAL SPACE                        39580099
395900             WHEN SQLCODE NOT EQUAL ZERO                          39590099
396000                  MOVE '4250-GET-SHIP-USERNAME'                   39600099
396100                               TO  DP013-PARAGRAPH                39610099
396200                  MOVE 'SELECT SHIPPING USERNAME INFORMATION'     39620099
396300                               TO  DP013-MESSAGE-TEXT (1)         39630099
396400                  MOVE DK-DFCT-ORD-ID                             39640099
396500                               TO  DP013-MESSAGE-TEXT (2)         39650099
396600                  MOVE 'RVT_DFCT_STAT'                            39660099
396700                                 TO  DP013-DB2-TABLE-NAME (1)     39670099
396800                  MOVE 'XLT_USR' TO  DP013-DB2-TABLE-NAME (2)     39680099
396900                  MOVE SQLCA     TO  DP013-SQLCA                  39690099
397000                  SET DP013-DB2-ABEND                             39700099
397100                      DP013-XCTL-DISPLAY-RESTART TO TRUE          39710099
397200                  PERFORM DP013-0000-PROCESS-ABEND                39720099
397300         END-EVALUATE                                             39730099
397400     END-PERFORM.                                                 39740099
397500                                                                  39750099
397600     IF  PV-RETRY-COUNTER GREATER THAN PC-MAX-RETRIES             39760099
397700         MOVE '4250-GET-SHIP-USERNAME   '                         39770099
397800                               TO  DP013-PARAGRAPH                39780099
397900         MOVE 'MAX RETRIES EXCEEDED FOR SELECT SHIP USERNAME INFO'39790099
398000                               TO  DP013-MESSAGE-TEXT (1)         39800099
398100         MOVE DK-DFCT-ORD-ID   TO  DP013-MESSAGE-TEXT (2)         39810099
398200         MOVE 'RVT_DFCT_STAT'  TO  DP013-DB2-TABLE-NAME (1)       39820099
398300         MOVE 'XLT_USR'        TO  DP013-DB2-TABLE-NAME (2)       39830099
398400         MOVE SQLCA            TO  DP013-SQLCA                    39840099
398500         SET DP013-DB2-ABEND                                      39850099
398600             DP013-XCTL-DISPLAY-RESTART TO TRUE                   39860099
398700         PERFORM DP013-0000-PROCESS-ABEND                         39870099
398800     END-IF.                                                      39880099
398900                                                                  39890099
399000 EJECT                                                            39900099
399100*----------------------------------------------------------------*39910099
399200*   MOVE DB2 DATA TO THE COMMAREA                                *39920099
399300*----------------------------------------------------------------*39930099
399400 4300-MOVE-DB-DATA-TO-COMMAREA.                                   39940099
399500     MOVE DFCTOR-LOC-ID                  TO ASC-LOCATION.         39950099
399600     MOVE RVT00003-USR-ID                TO ASC-TK-NBR.           39960099
399700                                                                  39970099
399800     EVALUATE TRUE                                                39980099
399900         WHEN NI-AUTH-ID < +0 AND                                 39990099
400000              NI-AUTH-DTE  < +0                                   40000099
400100             MOVE ASC-ENT-ID      TO DK-ENT-ID                    40010099
400200             MOVE ASC-DEPT-NBR    TO DK-DEPT-NBR                  40020099
400300             PERFORM 3400-SELECT-TVNDAGR-3                        40030099
400400             IF PS-DATA-FOUND                                     40040099
400500                 PERFORM 3410-CHK-TVNDAGR                         40050099
400600             END-IF                                               40060099
400700         WHEN NI-AUTH-ID < +0                                     40070099
400800             MOVE ASC-ENT-ID      TO DK-ENT-ID                    40080099
400900             MOVE ASC-DEPT-NBR    TO DK-DEPT-NBR                  40090099
401000             PERFORM 3400-SELECT-TVNDAGR-3                        40100099
401100             IF PS-DATA-FOUND                                     40110099
401200                 PERFORM 3410-CHK-TVNDAGR                         40120099
401300             END-IF                                               40130099
401400         WHEN NI-AUTH-DTE    < +0                                 40140099
401500             PERFORM 3800-GET-CLOSE-DATE                          40150099
401600         WHEN OTHER                                               40160099
401700             MOVE DFCTOR-VND-AUTH-ID        TO ASC-AUTH-ID        40170099
401800             MOVE DFCTOR-VND-AUTH-DTE       TO ASC-AUTH-DTE       40180099
401900     END-EVALUATE.                                                40190099
402000                                                                  40200099
402100     IF NI-SHIPT-ID    < +0                                       40210099
402200          MOVE ZERO                      TO ASC-SHIP-ID           40220099
402300      ELSE                                                        40230099
402400          MOVE DFCTOR-DFCT-SHIPT-ID      TO ASC-SHIP-ID           40240099
402500     END-IF.                                                      40250099
402600                                                                  40260099
402700     IF DFCTOR-RET-RSN-CDE = SPACES                               40270099
402800          MOVE 6                         TO ASC-RET-RSN           40280099
402900      ELSE                                                        40290099
403000          MOVE DFCTOR-RET-RSN-CDE        TO ASC-RET-RSN           40300099
403100     END-IF.                                                      40310099
403200                                                                  40320099
403300     IF DFCTOR-PAYT-TYP-CDE = SPACES                              40330099
403400          MOVE 'P'                       TO ASC-PAYT-TYPE         40340099
403500      ELSE                                                        40350099
403600          MOVE DFCTOR-PAYT-TYP-CDE       TO ASC-PAYT-TYPE         40360099
403700     END-IF.                                                      40370099
403800                                                                  40380099
403900     IF NI-CART-QTY    < +0                                       40390099
404000          MOVE ZERO                      TO ASC-CART-QTY          40400099
404100      ELSE                                                        40410099
404200          MOVE DFCTOR-CART-QTY           TO ASC-CART-QTY          40420099
404300     END-IF.                                                      40430099
404400                                                                  40440099
404500     IF NI-SPEC-INSTR    < +0                                     40450099
404600          MOVE SPACES                    TO ASC-SPEC-INSTRUCTIONS 40460099
404700      ELSE                                                        40470099
404800          MOVE DFCTOR-SPC-INSTR-TXT      TO ASC-SPEC-INSTRUCTIONS 40480099
404900     END-IF.                                                      40490099
405000                                                                  40500099
405100     IF NI-INBND-FRGT    < +0                                     40510099
405200          MOVE ZERO                      TO ASC-INBND-CHRGS       40520099
405300      ELSE                                                        40530099
405400          MOVE DFCTOR-INBD-RET-FRGT-AMT  TO ASC-INBND-CHRGS       40540099
405500     END-IF.                                                      40550099
405600                                                                  40560099
405700     IF NI-OUTBND-FRGT    < +0                                    40570099
405800          MOVE ZERO                      TO ASC-OUTBND-CHRGS      40580099
405900      ELSE                                                        40590099
406000          MOVE DFCTOR-OTBND-RET-FRGT-AMT TO ASC-OUTBND-CHRGS      40600099
406100     END-IF.                                                      40610099
406200                                                                  40620099
406300     IF NI-DEDUCT         < +0                                    40630099
406400          MOVE ZERO                      TO ASC-DED-CHRG-AMT      40640099
406500      ELSE                                                        40650099
406600          MOVE DFCTOR-DED-CHRG-AMT       TO ASC-DED-CHRG-AMT      40660099
406700     END-IF.                                                      40670099
406800                                                                  40680099
406900     IF NI-WEIGHT         < +0                                    40690099
407000          MOVE ZERO                      TO ASC-DFCT-WT-QTY       40700099
407100      ELSE                                                        40710099
407200          MOVE DFCTOR-DFCT-WT-QTY        TO ASC-DFCT-WT-QTY       40720099
407300     END-IF.                                                      40730099
407400                                                                  40740099
407500     IF NI-DISC-PCT       < +0                                    40750099
407600          MOVE ZERO                      TO ASC-DISC-PCT          40760099
407700      ELSE                                                        40770099
407800          MOVE DFCTOR-DISC-PCT           TO ASC-DISC-PCT          40780099
407900     END-IF.                                                      40790099
408000                                                                  40800099
408100     IF NI-DISC-AMT       < +0                                    40810099
408200          MOVE ZERO                      TO ASC-DISC-AMT          40820099
408300      ELSE                                                        40830099
408400          MOVE DFCTOR-DISC-AMT           TO ASC-DISC-AMT          40840099
408500     END-IF.                                                      40850099
408600                                                                  40860099
408700     IF NI-TRKG-ID        < +0                                    40870099
408800          MOVE SPACES                    TO ASC-TRACKING-NBR      40880099
408900      ELSE                                                        40890099
409000          MOVE DFCTOR-CARR-TRKG-ID       TO ASC-TRACKING-NBR      40900099
409100     END-IF.                                                      40910099
409200                                                                  40920099
409300     COMPUTE ASC-GRAND-TOTAL =                                    40930099
409400         ASC-TOTAL-COST + ASC-OUTBND-CHRGS +                      40940099
409500         ASC-INBND-CHRGS - ASC-DED-CHRG-AMT - ASC-DISC-AMT.       40950099
409600                                                                  40960099
409700     MOVE RVT00000-TRLR-ID               TO ASC-TRAILER-NBR.      40970099
409800     MOVE RVT00000-SCAC-CDE              TO ASC-SCAC.             40980099
409900     MOVE RVT00000-ACTL-SHIPT-DTE        TO ASC-SHIP-DTE.         40990099
410000                                                                  41000099
410100*----------------------------------------------------------------*41010099
410200*   MOVE COMMAREA TO THE THE SCREEN                              *41020099
410300*----------------------------------------------------------------*41030099
410400 4400-MOVE-COMMAREA-TO-SCREEN.                                    41040099
410500     MOVE ASC-DFCT-ORD-ID          TO ARANBRO.                    41050099
410600     MOVE ASC-LIST-TYPE            TO ATYPEO.                     41060099
410700     MOVE ASC-LOCATION             TO ALOCO.                      41070099
410800     MOVE ASC-VENDOR-NAME          TO AVNDRO.                     41080099
410900     MOVE ASC-STATUS               TO ASTATO.                     41090099
411000     MOVE ASC-TK-NBR               TO ATKNBRO.                    41100099
411100     MOVE ASC-AUTH-ID              TO AAUTHIDO.                   41110099
411200     MOVE ASC-AUTH-DTE             TO AAUTHDTO.                   41120099
411300     MOVE ASC-SHIP-DTE             TO ASHPDTEO.                   41130099
411400     MOVE ASC-SHIPPED-BY           TO ASHPDBYO.                   41140099
411500     MOVE ASC-SHIP-ID              TO ASHIPMTO.                   41150099
411600     MOVE ASC-SCAC                 TO ASCACO.                     41160099
411700     MOVE ASC-TRAILER-NBR          TO ATRAILRO.                   41170099
411800     MOVE ASC-TRACKING-NBR         TO ATRKNBRO.                   41180099
411900     MOVE ASC-CART-QTY             TO ACARTONO.                   41190099
412000     MOVE ASC-DFCT-WT-QTY          TO AWEIGHTO.                   41200099
412100     MOVE ASC-RET-RSN              TO ARETRSNO.                   41210099
412200     MOVE ASC-PAYT-TYPE            TO APAYTYPO.                   41220099
412300     MOVE ASC-TOTAL-COST           TO ATCOSTO.                    41230099
412400     MOVE ASC-TOTAL-RETAIL         TO ATRETLO.                    41240099
412500     MOVE ASC-OUTBND-CHRGS         TO AOUTCHGO.                   41250099
412600     MOVE ASC-INBND-CHRGS          TO AINCHGO.                    41260099
412700     MOVE ASC-DED-CHRG-AMT         TO ADEDUCTO.                   41270099
412800                                                                  41280099
412900** IF ASC-DED-CHRG-AMT IS GREATER THAN ZERO, WE WANT TO SHOW    **41290099
413000** ZEROS IN THE DISCOUNT PERCENT FIELD ON THE MAP.  IN THIS     **41300099
413100** CASE, THE AMOUNT IN ASC-DISC-PCT IS BASED ON THE DEDUCTED    **41310099
413200** AMOUNT RATHER THAN THE DISCOUNTED AMOUNT.  WE ONLY WANT TO   **41320099
413300** SHOW THE DISCOUNT PERCENT WHEN THERE IS A DISCOUNT AMOUNT    **41330099
413400** ENTERED.                                                     **41340099
413500     IF  ASC-DED-CHRG-AMT > 0                                     41350099
413600         MOVE ZEROS                TO ADSCPCTO                    41360099
413700     ELSE                                                         41370099
413800         MOVE ASC-DISC-PCT         TO ADSCPCTO                    41380099
413900     END-IF.                                                      41390099
414000     MOVE ASC-DISC-AMT             TO ADISCNTO.                   41400099
414100     MOVE ASC-GRAND-TOTAL          TO AGTOTALO.                   41410099
414200     MOVE ASC-SPEC-INSTR-LINE-1    TO AINST1O.                    41420099
414300     MOVE ASC-SPEC-INSTR-LINE-2    TO AINST2O.                    41430099
414400                                                                  41440099
414500     MOVE -1                       TO AAUTHIDL.                   41450099
414600                                                                  41460099
414700******************************************************************41470099
414800** UPDATE TDFCTOR FOR RTV LISTINGS                              **41480099
414900******************************************************************41490099
415000 5000-UPD-TDFCTOR-RTV.                                            41500099
415100     MOVE +0        TO NI-SHIPT-ID                                41510099
415200                       NI-AUTH-ID                                 41520099
415300                       NI-AUTH-DTE                                41530099
415400                       NI-CART-QTY                                41540099
415500                       NI-INBND-FRGT                              41550099
415600                       NI-OUTBND-FRGT                             41560099
415700                       NI-DEDUCT                                  41570099
415800                       NI-WEIGHT                                  41580099
415900                       NI-DISC-PCT                                41590099
416000                       NI-DISC-AMT                                41600099
416100                       NI-TRKG-ID                                 41610099
416200                       NI-RET-RSN                                 41620099
416300                       NI-PAYT-TYP                                41630099
416400                       NI-SPEC-INSTR.                             41640099
416500                                                                  41650099
416600     IF (ASC-DFCT-SHIPT-ID = 0) OR                                41660099
416700        (ASC-DND-STAT-D) OR                                       41670099
416800        (ASC-RTV-STAT-C)                                          41680099
416900         MOVE -1                  TO NI-SHIPT-ID                  41690099
417000     ELSE                                                         41700099
417100         MOVE ASC-DFCT-SHIPT-ID   TO DFCTOR-DFCT-SHIPT-ID         41710099
417200     END-IF.                                                      41720099
417300     MOVE ASC-AUTH-ID             TO DFCTOR-VND-AUTH-ID.          41730099
417400     MOVE ASC-AUTH-DTE            TO DFCTOR-VND-AUTH-DTE.         41740099
417500     MOVE ASC-CART-QTY            TO DFCTOR-CART-QTY.             41750099
417600     MOVE ASC-DFCT-WT-QTY         TO DFCTOR-DFCT-WT-QTY.          41760099
417700     MOVE ASC-RET-RSN             TO DFCTOR-RET-RSN-CDE.          41770099
417800     MOVE ASC-PAYT-TYPE           TO DFCTOR-PAYT-TYP-CDE.         41780099
417900     MOVE ASC-OUTBND-CHRGS        TO DFCTOR-OTBND-RET-FRGT-AMT.   41790099
418000     MOVE ASC-INBND-CHRGS         TO DFCTOR-INBD-RET-FRGT-AMT.    41800099
418100     MOVE ASC-DED-CHRG-AMT        TO DFCTOR-DED-CHRG-AMT.         41810099
418200**                                                              **41820099
418300** IF THE DEDUCTIBLE CHARGE AMOUNT HAS BEEN FILLED IN, WE NEED  **41830099
418400** TO MOVE THE PERCENTAGE BASED ON THIS DEDUCTIBLE CHARGE TO    **41840099
418500** THE DISCOUNT PERCENTAGE.  OTHERWISE, USE THE DISCOUNT        **41850099
418600** PERCENTAGE THAT WAS ENTERED ON THE SCREEN OR WAS CALCULATED  **41860099
418700** BASED ON THE DISCOUNT AMOUNT THAT WAS ENTERED.  THIS NEEDS   **41870099
418800** TO BE DONE SO IT CAN BE RECORDED CORRECTLY IN THE ACCOUNTS   **41880099
418900** PAYABLE SYSTEM.                                              **41890099
419000**                                                              **41900099
419100     IF  ASC-DED-CHRG-AMT > 0                                     41910099
419200         MOVE ASC-DED-CHRG-PCT    TO DFCTOR-DISC-PCT              41920099
419300     ELSE                                                         41930099
419400         MOVE ASC-DISC-PCT        TO DFCTOR-DISC-PCT              41940099
419500     END-IF.                                                      41950099
419600                                                                  41960099
419700     MOVE ASC-DISC-AMT            TO DFCTOR-DISC-AMT.             41970099
419800                                                                  41980099
419900     IF  ASC-TRACKING-NBR = SPACES OR                             41990099
420000         ASC-TRACKING-NBR = LOW-VALUES                            42000099
420100         MOVE -1                  TO NI-TRKG-ID                   42010099
420200     ELSE                                                         42020099
420300         MOVE ASC-TRACKING-NBR    TO DFCTOR-CARR-TRKG-ID          42030099
420400     END-IF.                                                      42040099
420500                                                                  42050099
420600     IF  ASC-SPEC-INSTRUCTIONS = SPACES OR                        42060099
420700         ASC-SPEC-INSTRUCTIONS = LOW-VALUES                       42070099
420800         MOVE -1                  TO NI-SPEC-INSTR                42080099
420900     ELSE                                                         42090099
421000         MOVE ASC-SPEC-INSTRUCTIONS                               42100099
421100                                  TO DFCTOR-SPC-INSTR-TXT         42110099
421200     END-IF.                                                      42120099
421300                                                                  42130099
421400     MOVE ASC-STAT-CDE            TO DFCTOR-DFCT-ORD-STAT-CDE.    42140099
421500                                                                  42150099
421600     PERFORM                                                      42160099
421700         WITH TEST AFTER                                          42170099
421800         VARYING PV-RETRY-COUNTER                                 42180099
421900         FROM 1 BY 1                                              42190099
422000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42200099
422100                   OR (SQLCODE = ZERO))                           42210099
422200         EXEC SQL                                                 42220099
422300             UPDATE TDFCTOR                                       42230099
422400                 SET DFCT_SHIPT_ID = :DFCTOR-DFCT-SHIPT-ID        42240099
422500                                     :NI-SHIPT-ID                 42250099
422600                   , DFCT_ORD_STAT_CDE                            42260099
422700                                   = :DFCTOR-DFCT-ORD-STAT-CDE    42270099
422800                   , STATUS_CHG_DTE                               42280099
422900                                   = CURRENT DATE                 42290099
423000                   , VND_AUTH_ID   = :DFCTOR-VND-AUTH-ID          42300099
423100                   , VND_AUTH_DTE  = :DFCTOR-VND-AUTH-DTE         42310099
423200                   , CART_QTY      = :DFCTOR-CART-QTY             42320099
423300                   , DFCT_WT_QTY   = :DFCTOR-DFCT-WT-QTY          42330099
423400                   , RET_RSN_CDE   = :DFCTOR-RET-RSN-CDE          42340099
423500                   , PAYT_TYP_CDE  = :DFCTOR-PAYT-TYP-CDE         42350099
423600                   , OTBND_RET_FRGT_AMT                           42360099
423700                                   = :DFCTOR-OTBND-RET-FRGT-AMT   42370099
423800                   , INBD_RET_FRGT_AMT                            42380099
423900                                   = :DFCTOR-INBD-RET-FRGT-AMT    42390099
424000                   , DED_CHRG_AMT  = :DFCTOR-DED-CHRG-AMT         42400099
424100                   , DISC_PCT      = :DFCTOR-DISC-PCT             42410099
424200                   , DISC_AMT      = :DFCTOR-DISC-AMT             42420099
424300                   , SPC_INSTR_TXT = :DFCTOR-SPC-INSTR-TXT        42430099
424400                                     :NI-SPEC-INSTR               42440099
424500                   , CARR_TRKG_ID  = :DFCTOR-CARR-TRKG-ID         42450099
424600                                     :NI-TRKG-ID                  42460099
424700             WHERE DFCT_ORD_ID     = :DK-DFCT-ORD-ID              42470099
424800         END-EXEC                                                 42480099
424900                                                                  42490099
425000         EVALUATE TRUE                                            42500099
425100             WHEN SQLCODE = ZERO                                  42510099
425200                 SET PS-ROLLBACK-NOT-NEEDED                       42520099
425300                     PS-UPDATE-OK TO TRUE                         42530099
425400             WHEN SQLCODE = -904                                  42540099
425500             WHEN SQLCODE = -913                                  42550099
425600                 CONTINUE                                         42560099
425700             WHEN SQLWARN0 NOT = SPACES                           42570099
425800             WHEN SQLCODE < ZERO                                  42580099
425900             WHEN SQLCODE > ZERO                                  42590099
426000                 SET PS-UPDATE-NOT-OK                             42600099
426100                     PS-ROLLBACK-NEEDED                           42610099
426200                     PS-ERROR                                     42620099
426300                     DP020-MSG-FATAL  TO TRUE                     42630099
426400                 MOVE PC-TSYMSG-03160 TO DP020-MSG-NUMBER         42640099
426500                 MOVE '5000-UPD-TDFCTOR-RTV'                      42650099
426600                                   TO DP013-PARAGRAPH             42660099
426700                 MOVE 'UPDATE TDFCTOR FOR RTV'                    42670099
426800                                   TO DP013-MESSAGE-TEXT(1)       42680099
426900                 MOVE DK-DFCT-ORD-ID                              42690099
427000                                   TO DP013-MESSAGE-TEXT(2)       42700099
427100                 MOVE SQLCA        TO DP013-SQLCA                 42710099
427200                 MOVE 'TDFCTOR'    TO DP013-DB2-TABLE-NAME (1)    42720099
427300                 SET DP013-DB2-ABEND                              42730099
427400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           42740099
427500                 PERFORM DP013-0000-PROCESS-ABEND                 42750099
427600         END-EVALUATE                                             42760099
427700     END-PERFORM.                                                 42770099
427800                                                                  42780099
427900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        42790099
428000         SET PS-UPDATE-NOT-OK                                     42800099
428100             PS-ROLLBACK-NEEDED                                   42810099
428200             PS-ERROR                                             42820099
428300             DP020-MSG-FATAL         TO TRUE                      42830099
428400         MOVE PC-TSYMSG-03160        TO DP020-MSG-NUMBER          42840099
428500         MOVE '5000-UPD-TDFCTOR-RTV' TO DP013-PARAGRAPH           42850099
428600         MOVE 'MAXIMUM RETRIES EXCEEDED'                          42860099
428700                                     TO DP013-MESSAGE-TEXT (1)    42870099
428800         MOVE DK-DFCT-ORD-ID         TO DP013-MESSAGE-TEXT(2)     42880099
428900         MOVE SQLCA                  TO DP013-SQLCA               42890099
429000         MOVE 'TDFCTOR'              TO DP013-DB2-TABLE-NAME (1)  42900099
429100         SET DP013-DB2-ABEND                                      42910099
429200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   42920099
429300         PERFORM DP013-0000-PROCESS-ABEND                         42930099
429400     END-IF.                                                      42940099
429500                                                                  42950099
429600******************************************************************42960099
429700** UPDATE TDFCTOR FOR D & D LISTINGS  -- F15                    **42970099
429800**   THIS UPDATE IS FOR LISTINGS THAT COME IN AS D&D            **42980099
429900**   ANY NULL INDICATORS NEED TO BE RESET TO +0 BEFORE UPDATE   **42990099
430000******************************************************************43000099
430100 5100-UPD-TDFCTOR-DND.                                            43010099
430200     MOVE +0        TO NI-AUTH-ID                                 43020099
430300                       NI-AUTH-DTE                                43030099
430400                       NI-CART-QTY                                43040099
430500                       NI-RET-RSN                                 43050099
430600                       NI-TRKG-ID                                 43060099
430700                       NI-SPEC-INSTR.                             43070099
430800                                                                  43080099
430900     IF (ASC-DFCT-SHIPT-ID = 0) OR                                43090099
431000        (ASC-DND-STAT-D) OR                                       43100099
431100        (ASC-RTV-STAT-C)                                          43110099
431200         MOVE -1                  TO NI-SHIPT-ID                  43120099
431300     ELSE                                                         43130099
431400         MOVE ASC-DFCT-SHIPT-ID   TO DFCTOR-DFCT-SHIPT-ID         43140099
431500     END-IF.                                                      43150099
431600                                                                  43160099
431700     MOVE ASC-AUTH-ID             TO DFCTOR-VND-AUTH-ID.          43170099
431800     MOVE ASC-AUTH-DTE            TO DFCTOR-VND-AUTH-DTE.         43180099
431900     MOVE ASC-CART-QTY            TO DFCTOR-CART-QTY.             43190099
432000     MOVE ASC-DFCT-WT-QTY         TO DFCTOR-DFCT-WT-QTY.          43200099
432100     MOVE ASC-RET-RSN             TO DFCTOR-RET-RSN-CDE.          43210099
432200                                                                  43220099
432300     IF  ASC-TRACKING-NBR = SPACES OR                             43230099
432400         ASC-TRACKING-NBR = LOW-VALUES                            43240099
432500         MOVE -1                  TO NI-TRKG-ID                   43250099
432600     ELSE                                                         43260099
432700         MOVE ASC-TRACKING-NBR    TO DFCTOR-CARR-TRKG-ID          43270099
432800     END-IF.                                                      43280099
432900                                                                  43290099
433000     IF  ASC-SPEC-INSTRUCTIONS = SPACES OR                        43300099
433100         ASC-SPEC-INSTRUCTIONS = LOW-VALUES                       43310099
433200         MOVE -1                  TO NI-SPEC-INSTR                43320099
433300     ELSE                                                         43330099
433400         MOVE ASC-SPEC-INSTRUCTIONS                               43340099
433500                                  TO DFCTOR-SPC-INSTR-TXT         43350099
433600     END-IF.                                                      43360099
433700                                                                  43370099
433800     MOVE ASC-STAT-CDE            TO DFCTOR-DFCT-ORD-STAT-CDE.    43380099
433900                                                                  43390099
434000     PERFORM                                                      43400099
434100         WITH TEST AFTER                                          43410099
434200         VARYING PV-RETRY-COUNTER                                 43420099
434300         FROM 1 BY 1                                              43430099
434400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43440099
434500                   OR (SQLCODE = ZERO))                           43450099
434600         EXEC SQL                                                 43460099
434700             UPDATE TDFCTOR                                       43470099
434800                 SET DFCT_SHIPT_ID = :DFCTOR-DFCT-SHIPT-ID        43480099
434900                                     :NI-SHIPT-ID                 43490099
435000                   , DFCT_ORD_STAT_CDE                            43500099
435100                                   = :DFCTOR-DFCT-ORD-STAT-CDE    43510099
435200                   , STATUS_CHG_DTE                               43520099
435300                                   = CURRENT DATE                 43530099
435400                   , VND_AUTH_ID   = :DFCTOR-VND-AUTH-ID          43540099
435500                   , VND_AUTH_DTE  = :DFCTOR-VND-AUTH-DTE         43550099
435600                   , CART_QTY      = :DFCTOR-CART-QTY             43560099
435700                   , DFCT_WT_QTY   = :DFCTOR-DFCT-WT-QTY          43570099
435800                   , RET_RSN_CDE   = :DFCTOR-RET-RSN-CDE          43580099
435900                   , SPC_INSTR_TXT = :DFCTOR-SPC-INSTR-TXT        43590099
436000                                     :NI-SPEC-INSTR               43600099
436100                   , CARR_TRKG_ID  = :DFCTOR-CARR-TRKG-ID         43610099
436200                                     :NI-TRKG-ID                  43620099
436300               WHERE DFCT_ORD_ID   = :DK-DFCT-ORD-ID              43630099
436400         END-EXEC                                                 43640099
436500                                                                  43650099
436600         EVALUATE TRUE                                            43660099
436700             WHEN SQLCODE = ZERO                                  43670099
436800                 SET PS-ROLLBACK-NOT-NEEDED                       43680099
436900                     PS-UPDATE-OK  TO TRUE                        43690099
437000             WHEN SQLCODE = -904                                  43700099
437100             WHEN SQLCODE = -913                                  43710099
437200                 CONTINUE                                         43720099
437300             WHEN SQLWARN0 NOT = SPACES                           43730099
437400             WHEN SQLCODE < ZERO                                  43740099
437500             WHEN SQLCODE > ZERO                                  43750099
437600                 SET PS-UPDATE-NOT-OK                             43760099
437700                     PS-ROLLBACK-NEEDED                           43770099
437800                     PS-ERROR                                     43780099
437900                     DP020-MSG-FATAL         TO TRUE              43790099
438000                 MOVE PC-TSYMSG-03160        TO DP020-MSG-NUMBER  43800099
438100                 MOVE '5100-UPD-TDFCTOR-DND' TO DP013-PARAGRAPH   43810099
438200                 MOVE 'UPDATE TDFCTOR FOR D & D'                  43820099
438300                                   TO DP013-MESSAGE-TEXT(1)       43830099
438400                 MOVE DK-DFCT-ORD-ID                              43840099
438500                                   TO DP013-MESSAGE-TEXT(2)       43850099
438600                 MOVE SQLCA        TO DP013-SQLCA                 43860099
438700                 MOVE 'TDFCTOR'    TO DP013-DB2-TABLE-NAME (1)    43870099
438800                 SET DP013-DB2-ABEND                              43880099
438900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           43890099
439000                 PERFORM DP013-0000-PROCESS-ABEND                 43900099
439100         END-EVALUATE                                             43910099
439200     END-PERFORM.                                                 43920099
439300                                                                  43930099
439400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        43940099
439500         SET PS-UPDATE-NOT-OK                                     43950099
439600             PS-ROLLBACK-NEEDED                                   43960099
439700             PS-ERROR                                             43970099
439800             DP020-MSG-FATAL         TO TRUE                      43980099
439900         MOVE PC-TSYMSG-03160        TO DP020-MSG-NUMBER          43990099
440000         MOVE '5100-UPD-TDFCTOR-DND' TO DP013-PARAGRAPH           44000099
440100         MOVE 'MAXIMUM RETRIES EXCEEDED'                          44010099
440200                                     TO DP013-MESSAGE-TEXT (1)    44020099
440300         MOVE DK-DFCT-ORD-ID         TO DP013-MESSAGE-TEXT(2)     44030099
440400         MOVE SQLCA                  TO DP013-SQLCA               44040099
440500         MOVE 'TDFCTOR'              TO DP013-DB2-TABLE-NAME (1)  44050099
440600         SET DP013-DB2-ABEND                                      44060099
440700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   44070099
440800         PERFORM DP013-0000-PROCESS-ABEND                         44080099
440900     END-IF.                                                      44090099
441000                                                                  44100099
441100******************************************************************44110099
441200** UPDATE TDFCTOR WHEN A LISING IS CHANGED BY F23 TO AN RTV     **44120099
441300** LISTING.                                                     **44130099
441400******************************************************************44140099
441500 5200-UPD-TDFCTOR-TO-RTV-LIST.                                    44150099
441600     MOVE ASC-DFCT-ORD-ID TO DK-DFCT-ORD-ID.                      44160099
441700     MOVE ASC-STAT-CDE    TO DFCTOR-DFCT-ORD-STAT-CDE.            44170099
441800     MOVE ASC-TYPE-CDE    TO DFCTOR-DFCT-ORD-ID-CDE.              44180099
441900                                                                  44190099
442000     PERFORM                                                      44200099
442100         WITH TEST AFTER                                          44210099
442200         VARYING PV-RETRY-COUNTER                                 44220099
442300         FROM 1 BY 1                                              44230099
442400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44240099
442500                   OR (SQLCODE = ZERO))                           44250099
442600         EXEC SQL                                                 44260099
442700             UPDATE TDFCTOR                                       44270099
442800                 SET DFCT_ORD_ID_CDE = :DFCTOR-DFCT-ORD-ID-CDE    44280099
442900                   , STATUS_CHG_DTE  = CURRENT_DATE               44290099
443000                   , DFCT_ORD_STAT_CDE = :DFCTOR-DFCT-ORD-STAT-CDE44300099
443100               WHERE DFCT_ORD_ID     = :DK-DFCT-ORD-ID            44310099
443200         END-EXEC                                                 44320099
443300                                                                  44330099
443400         EVALUATE TRUE                                            44340099
443500             WHEN SQLCODE = ZERO                                  44350099
443600                 SET PS-UPDATE-OK  TO TRUE                        44360099
443700             WHEN SQLCODE = -904                                  44370099
443800             WHEN SQLCODE = -913                                  44380099
443900                 CONTINUE                                         44390099
444000             WHEN SQLWARN0 NOT = SPACES                           44400099
444100             WHEN SQLCODE < ZERO                                  44410099
444200             WHEN SQLCODE > ZERO                                  44420099
444300                 SET PS-UPDATE-NOT-OK                             44430099
444400                     PS-ERROR                                     44440099
444500                     DP020-MSG-FATAL       TO TRUE                44450099
444600                 MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER    44460099
444700                 MOVE '5200-UPD-TDFCTOR-TO-RTV-LIST'              44470099
444800                                           TO DP013-PARAGRAPH     44480099
444900                 MOVE 'UPDATE TDFCTOR TO AN RTV LISTING'          44490099
445000                                   TO DP013-MESSAGE-TEXT(1)       44500099
445100                 MOVE DK-DFCT-ORD-ID                              44510099
445200                                   TO DP013-MESSAGE-TEXT(2)       44520099
445300                 MOVE SQLCA        TO DP013-SQLCA                 44530099
445400                 MOVE 'TDFCTOR'    TO DP013-DB2-TABLE-NAME (1)    44540099
445500                 SET DP013-DB2-ABEND                              44550099
445600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           44560099
445700                 PERFORM DP013-0000-PROCESS-ABEND                 44570099
445800         END-EVALUATE                                             44580099
445900     END-PERFORM.                                                 44590099
446000                                                                  44600099
446100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        44610099
446200         SET PS-UPDATE-NOT-OK                                     44620099
446300             PS-ERROR                                             44630099
446400             DP020-MSG-FATAL       TO TRUE                        44640099
446500         MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER            44650099
446600         MOVE '5200-UPD-TDFCTOR-TO-RTV-LIST'                      44660099
446700                                   TO DP013-PARAGRAPH             44670099
446800         MOVE 'MAX RETRIES EXCEEDED'                              44680099
446900                                   TO DP013-MESSAGE-TEXT (1)      44690099
447000         MOVE DK-DFCT-ORD-ID       TO DP013-MESSAGE-TEXT(2)       44700099
447100         MOVE SQLCA                TO DP013-SQLCA                 44710099
447200         MOVE 'TDFCTOR'            TO DP013-DB2-TABLE-NAME (1)    44720099
447300         SET DP013-DB2-ABEND                                      44730099
447400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   44740099
447500         PERFORM DP013-0000-PROCESS-ABEND                         44750099
447600     END-IF.                                                      44760099
447700                                                                  44770099
447800******************************************************************44780099
447900** CHECK TO SEE IF THE AUTH ID AND AUTH DATE FIELDS HAVE BEEN   **44790099
448000** FILLED IN ON TDFCTOR                                         **44800099
448100******************************************************************44810099
448200 5240-CHECK-AUTH-ID-DATE.                                         44820099
448300     MOVE ASC-DFCT-ORD-ID TO DK-DFCT-ORD-ID.                      44830099
448400                                                                  44840099
448500     PERFORM                                                      44850099
448600         WITH TEST AFTER                                          44860099
448700         VARYING PV-RETRY-COUNTER                                 44870099
448800         FROM 1 BY 1                                              44880099
448900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44890099
449000                   OR (SQLCODE = ZERO))                           44900099
449100         EXEC SQL                                                 44910099
449200             SELECT VND_AUTH_ID                                   44920099
449300                  , VND_AUTH_DTE                                  44930099
449400               INTO :DFCTOR-VND-AUTH-ID  :NI-AUTH-ID              44940099
449500                  , :DFCTOR-VND-AUTH-DTE :NI-AUTH-DTE             44950099
449600               FROM TDFCTOR                                       44960099
449700              WHERE DFCT_ORD_ID     = :DK-DFCT-ORD-ID             44970099
449800         END-EXEC                                                 44980099
449900                                                                  44990099
450000         EVALUATE TRUE                                            45000099
450100             WHEN SQLCODE = ZERO                                  45010099
450200                 IF  NI-AUTH-ID < 0 OR                            45020099
450300                     NI-AUTH-DTE < 0                              45030099
450400                     SET PS-UPDATE-NOT-OK  TO TRUE                45040099
450500                 ELSE                                             45050099
450600                     IF DFCTOR-VND-AUTH-ID = SPACES               45060099
450700                         SET PS-UPDATE-NOT-OK                     45070099
450800                                           TO TRUE                45080099
450900                     ELSE                                         45090099
451000                         SET PS-UPDATE-OK  TO TRUE                45100099
451100                     END-IF                                       45110099
451200                 END-IF                                           45120099
451300                                                                  45130099
451400             WHEN SQLCODE = -904                                  45140099
451500             WHEN SQLCODE = -913                                  45150099
451600                 CONTINUE                                         45160099
451700                                                                  45170099
451800             WHEN SQLWARN0 NOT = SPACES                           45180099
451900             WHEN SQLCODE < ZERO                                  45190099
452000             WHEN SQLCODE > ZERO                                  45200099
452100                 SET PS-UPDATE-NOT-OK                             45210099
452200                     PS-ERROR                                     45220099
452300                     DP020-MSG-FATAL       TO TRUE                45230099
452400                 MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER    45240099
452500                 MOVE '5240-CHECK-AUTH-ID-DATE'                   45250099
452600                                           TO DP013-PARAGRAPH     45260099
452700                 MOVE 'CHECK IF AUTH ID AND DATE ARE SAVED'       45270099
452800                                   TO DP013-MESSAGE-TEXT(1)       45280099
452900                 MOVE DK-DFCT-ORD-ID                              45290099
453000                                   TO DP013-MESSAGE-TEXT(2)       45300099
453100                 MOVE SQLCA        TO DP013-SQLCA                 45310099
453200                 MOVE 'TDFCTOR'    TO DP013-DB2-TABLE-NAME (1)    45320099
453300                 SET DP013-DB2-ABEND                              45330099
453400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           45340099
453500                 PERFORM DP013-0000-PROCESS-ABEND                 45350099
453600         END-EVALUATE                                             45360099
453700     END-PERFORM.                                                 45370099
453800                                                                  45380099
453900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        45390099
454000         SET PS-UPDATE-NOT-OK                                     45400099
454100             PS-ERROR                                             45410099
454200             DP020-MSG-FATAL       TO TRUE                        45420099
454300         MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER            45430099
454400         MOVE '5240-CHECK-AUTH-ID-DATE'                           45440099
454500                                   TO DP013-PARAGRAPH             45450099
454600         MOVE 'MAX RETRIES EXCEEDED'                              45460099
454700                                   TO DP013-MESSAGE-TEXT (1)      45470099
454800         MOVE DK-DFCT-ORD-ID       TO DP013-MESSAGE-TEXT(2)       45480099
454900         MOVE SQLCA                TO DP013-SQLCA                 45490099
455000         MOVE 'TDFCTOR'            TO DP013-DB2-TABLE-NAME (1)    45500099
455100         SET DP013-DB2-ABEND                                      45510099
455200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   45520099
455300         PERFORM DP013-0000-PROCESS-ABEND                         45530099
455400     END-IF.                                                      45540099
455500                                                                  45550099
455600******************************************************************45560099
455700** UPDATE TDFCTOR WHEN A LISING IS CHANGED BY F23 TO A D&D      **45570099
455800** LISTING.                                                     **45580099
455900******************************************************************45590099
456000 5250-UPD-TDFCTOR-TO-DND-LIST.                                    45600099
456100     MOVE ASC-DFCT-ORD-ID TO DK-DFCT-ORD-ID.                      45610099
456200     MOVE ASC-STAT-CDE    TO DFCTOR-DFCT-ORD-STAT-CDE.            45620099
456300     MOVE ASC-TYPE-CDE    TO DFCTOR-DFCT-ORD-ID-CDE.              45630099
456400                                                                  45640099
456500** MOVE A -1 TO THE NULL INDICATOR FIELD FOR THE CHARGES AND    **45650099
456600** DISCOUNTS FIELDS.  THIS WILL PLACE NULL VALUES IN THESE      **45660099
456700** FIELDS.  THESE FIELDS SHOULD NOT BE FILLED IN FOR D&D        **45670099
456800** LISTINGS.                                                    **45680099
456900     MOVE -1              TO NI-INBND-FRGT                        45690099
457000                             NI-OUTBND-FRGT                       45700099
457100                             NI-DEDUCT                            45710099
457200                             NI-DISC-PCT                          45720099
457300                             NI-DISC-AMT.                         45730099
457400                                                                  45740099
457500     PERFORM                                                      45750099
457600         WITH TEST AFTER                                          45760099
457700         VARYING PV-RETRY-COUNTER                                 45770099
457800         FROM 1 BY 1                                              45780099
457900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               45790099
458000                   OR (SQLCODE = ZERO))                           45800099
458100         EXEC SQL                                                 45810099
458200             UPDATE TDFCTOR                                       45820099
458300                 SET DFCT_ORD_ID_CDE    = :DFCTOR-DFCT-ORD-ID-CDE 45830099
458400                   , STATUS_CHG_DTE     = CURRENT_DATE            45840099
458500                   , DFCT_ORD_STAT_CDE  =                         45850099
458600                                         :DFCTOR-DFCT-ORD-STAT-CDE45860099
458700                   , INBD_RET_FRGT_AMT  =                         45870099
458800                                         :DFCTOR-INBD-RET-FRGT-AMT45880099
458900                                         :NI-INBND-FRGT           45890099
459000                   , OTBND_RET_FRGT_AMT =                         45900099
459100                                        :DFCTOR-OTBND-RET-FRGT-AMT45910099
459200                                        :NI-OUTBND-FRGT           45920099
459300                   , DED_CHRG_AMT       = :DFCTOR-DED-CHRG-AMT    45930099
459400                                          :NI-DEDUCT              45940099
459500                   , DISC_PCT           = :DFCTOR-DISC-PCT        45950099
459600                                          :NI-DISC-PCT            45960099
459700                   , DISC_AMT           = :DFCTOR-DISC-AMT        45970099
459800                                          :NI-DISC-AMT            45980099
459900               WHERE DFCT_ORD_ID     = :DK-DFCT-ORD-ID            45990099
460000         END-EXEC                                                 46000099
460100                                                                  46010099
460200         EVALUATE TRUE                                            46020099
460300             WHEN SQLCODE = ZERO                                  46030099
460400                 SET PS-UPDATE-OK  TO TRUE                        46040099
460500             WHEN SQLCODE = -904                                  46050099
460600             WHEN SQLCODE = -913                                  46060099
460700                 CONTINUE                                         46070099
460800             WHEN SQLWARN0 NOT = SPACES                           46080099
460900             WHEN SQLCODE < ZERO                                  46090099
461000             WHEN SQLCODE > ZERO                                  46100099
461100                 SET PS-UPDATE-NOT-OK                             46110099
461200                     PS-ERROR                                     46120099
461300                     DP020-MSG-FATAL       TO TRUE                46130099
461400                 MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER    46140099
461500                 MOVE '5250-UPD-TDFCTOR-TO-DND-LIST'              46150099
461600                                           TO DP013-PARAGRAPH     46160099
461700                 MOVE 'UPDATE TDFCTOR RTV TO D & D'               46170099
461800                                   TO DP013-MESSAGE-TEXT(1)       46180099
461900                 MOVE DK-DFCT-ORD-ID                              46190099
462000                                   TO DP013-MESSAGE-TEXT(2)       46200099
462100                 MOVE SQLCA        TO DP013-SQLCA                 46210099
462200                 MOVE 'TDFCTOR'    TO DP013-DB2-TABLE-NAME (1)    46220099
462300                 SET DP013-DB2-ABEND                              46230099
462400                     DP013-XCTL-DISPLAY-RESTART TO TRUE           46240099
462500                 PERFORM DP013-0000-PROCESS-ABEND                 46250099
462600         END-EVALUATE                                             46260099
462700     END-PERFORM.                                                 46270099
462800                                                                  46280099
462900     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46290099
463000         SET PS-UPDATE-NOT-OK                                     46300099
463100             PS-ERROR                                             46310099
463200             DP020-MSG-FATAL       TO TRUE                        46320099
463300         MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER            46330099
463400         MOVE '5250-UPD-TDFCTOR-TO-DND-LIST'                      46340099
463500                                   TO DP013-PARAGRAPH             46350099
463600         MOVE 'MAX RETRIES EXCEEDED'                              46360099
463700                                   TO DP013-MESSAGE-TEXT (1)      46370099
463800         MOVE DK-DFCT-ORD-ID       TO DP013-MESSAGE-TEXT(2)       46380099
463900         MOVE SQLCA                TO DP013-SQLCA                 46390099
464000         MOVE 'TDFCTOR'            TO DP013-DB2-TABLE-NAME (1)    46400099
464100         SET DP013-DB2-ABEND                                      46410099
464200             DP013-XCTL-DISPLAY-RESTART TO TRUE                   46420099
464300         PERFORM DP013-0000-PROCESS-ABEND                         46430099
464400     END-IF.                                                      46440099
464500                                                                  46450099
464600******************************************************************46460099
464700** INSERT RVT_DFCT_STAT TABLE WHEN THE STATUS OF A LISTING      **46470099
464800**   IS CHANGED                                                   46480099
464900******************************************************************46490099
465000 5300-INSERT-DFCT-STAT.                                           46500099
465100     PERFORM                                                      46510099
465200         WITH TEST AFTER                                          46520099
465300         VARYING PV-RETRY-COUNTER                                 46530099
465400         FROM 1 BY 1                                              46540099
465500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               46550099
465600                   OR (SQLCODE = ZERO))                           46560099
465700         EXEC SQL                                                 46570099
465800             INSERT INTO RVT_DFCT_STAT                            46580099
465900                   ( DFCT_ORD_ID                                  46590099
466000                   , CHGD_TMST                                    46600099
466100                   , DFCT_ORD_STAT_CDE                            46610099
466200                   , USR_ID )                                     46620099
466300            VALUES ( :RVT00003-DFCT-ORD-ID                        46630099
466400                   ,  CURRENT TIMESTAMP                           46640099
466500                   , :RVT00003-DFCT-ORD-STAT-CDE                  46650099
466600                   , :RVT00003-USR-ID )                           46660099
466700         END-EXEC                                                 46670099
466800                                                                  46680099
466900         EVALUATE TRUE                                            46690099
467000             WHEN SQLCODE = ZERO                                  46700099
467100                 SET PS-UPDATE-OK  TO TRUE                        46710099
467200             WHEN SQLCODE = -904                                  46720099
467300             WHEN SQLCODE = -913                                  46730099
467400                 CONTINUE                                         46740099
467500             WHEN SQLWARN0 NOT = SPACES                           46750099
467600             WHEN SQLCODE < ZERO                                  46760099
467700             WHEN SQLCODE > ZERO                                  46770099
467800                 SET PS-UPDATE-NOT-OK                             46780099
467900                     PS-ERROR                                     46790099
468000                     DP020-MSG-FATAL  TO TRUE                     46800099
468100                 MOVE PC-TSYMSG-03160 TO DP020-MSG-NUMBER         46810099
468200                 MOVE '5300-INSERT-DFCT-STAT' TO DP013-PARAGRAPH  46820099
468300                 MOVE 'INSERT A ROW ON THE DFCT STAT TABLE'       46830099
468400                                      TO DP013-MESSAGE-TEXT(1)    46840099
468500                 MOVE DK-DFCT-ORD-ID  TO DP013-MESSAGE-TEXT(2)    46850099
468600                 MOVE SQLCA           TO DP013-SQLCA              46860099
468700                 MOVE 'RVT_DFCT_STAT' TO DP013-DB2-TABLE-NAME (1) 46870099
468800                 SET DP013-DB2-ABEND                              46880099
468900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           46890099
469000                 PERFORM DP013-0000-PROCESS-ABEND                 46900099
469100         END-EVALUATE                                             46910099
469200     END-PERFORM.                                                 46920099
469300                                                                  46930099
469400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        46940099
469500         SET PS-UPDATE-NOT-OK                                     46950099
469600             PS-ERROR                                             46960099
469700             DP020-MSG-FATAL          TO TRUE                     46970099
469800         MOVE PC-TSYMSG-03160         TO DP020-MSG-NUMBER         46980099
469900         MOVE '5300-INSERT-DFCT-STAT' TO DP013-PARAGRAPH          46990099
470000         MOVE 'MAX RETRIES EXCEEDED'  TO DP013-MESSAGE-TEXT(1)    47000099
470100         MOVE DK-DFCT-ORD-ID          TO DP013-MESSAGE-TEXT(2)    47010099
470200         MOVE SQLCA                   TO DP013-SQLCA              47020099
470300         MOVE 'RVT_DFCT_STAT'         TO DP013-DB2-TABLE-NAME (1) 47030099
470400         SET DP013-DB2-ABEND                                      47040099
470500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   47050099
470600         PERFORM DP013-0000-PROCESS-ABEND                         47060099
470700     END-IF.                                                      47070099
470800                                                                  47080099
470900******************************************************************47090099
471000** INSERT TO RVT_DFCT_SHIPT TABLE FOR RTV LISTING WHEN F22      **47100099
471100** IS PRESSED.                                                  **47110099
471200** WE ARE CODING FOR THE -803 SQLCODE (DUPLICATE ROW ON INSERT).**47120099
471300** IN MOST INSTANCES, A NEW SHIPMENT WILL BE GETTING CREATED    **47130099
471400** FOR THE LISTING, SO WE SHOULDN'T ENCOUNTER THIS SITUATION    **47140099
471500** VERY MUCH.  FOR THE TIMES WHEN THE LISTING WILL BE PUT ON AN **47150099
471600** EXISTING LISTING, THIS CONDITION WILL BE ENCOUNTERED.  WE    **47160099
471700** WILL PROCEED WITH AN UPDATE IN THIS CASE.                    **47170099
471800******************************************************************47180099
471900 5400-INSERT-DFCT-SHIPT.                                          47190099
472000     MOVE ASC-DFCT-SHIPT-ID       TO RVT00000-DFCT-SHIPT-ID.      47200099
472100     MOVE ASC-TRAILER-NBR         TO RVT00000-TRLR-ID.            47210099
472200     MOVE ASC-SCAC                TO RVT00000-SCAC-CDE.           47220099
472300                                                                  47230099
472400** IF THE SHIP DATE IS NOT ENTERED ON THE SCREEN, USE THE CURRENT 47240099
472500** DATE, OTHERWISE USE THE DATE THAT IS ENTERED ON THE SCREEN.    47250099
472600     IF  ASC-SHIP-DTE = SPACES                                    47260099
472700         MOVE ASC-CURRENT-DATE-USA                                47270099
472800                                  TO RVT00000-ACTL-SHIPT-DTE      47280099
472900     ELSE                                                         47290099
473000         MOVE ASC-SHIP-DTE        TO RVT00000-ACTL-SHIPT-DTE      47300099
473100     END-IF.                                                      47310099
473200                                                                  47320099
473300     PERFORM                                                      47330099
473400         WITH TEST AFTER                                          47340099
473500         VARYING PV-RETRY-COUNTER                                 47350099
473600         FROM 1 BY 1                                              47360099
473700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               47370099
473800                   OR (SQLCODE = ZERO)                            47380099
473900                   OR (SQLCODE = -803))                           47390099
474000         EXEC SQL                                                 47400099
474100             INSERT INTO RVT_DFCT_SHIPT                           47410099
474200                    ( DFCT_SHIPT_ID                               47420099
474300                   ,  TRLR_ID                                     47430099
474400                   ,  SCAC_CDE                                    47440099
474500                   ,  ACTL_SHIPT_DTE )                            47450099
474600             VALUES ( :RVT00000-DFCT-SHIPT-ID                     47460099
474700                   ,  :RVT00000-TRLR-ID                           47470099
474800                   ,  :RVT00000-SCAC-CDE                          47480099
474900                   ,  :RVT00000-ACTL-SHIPT-DTE )                  47490099
475000         END-EXEC                                                 47500099
475100                                                                  47510099
475200         EVALUATE TRUE                                            47520099
475300             WHEN SQLCODE = ZERO                                  47530099
475400                 SET PS-INSERT-SHIP-STAT                          47540099
475500                     PS-UPDATE-OK        TO TRUE                  47550099
475600             WHEN SQLCODE = -803                                  47560099
475700                 SET PS-DO-NOT-INSERT-SHIP-STAT                   47570099
475800                                         TO TRUE                  47580099
475900                 PERFORM 5500-UPD-DFCT-SHIPT                      47590099
476000             WHEN SQLCODE = -904                                  47600099
476100             WHEN SQLCODE = -913                                  47610099
476200                 CONTINUE                                         47620099
476300             WHEN SQLWARN0 NOT = SPACES                           47630099
476400             WHEN SQLCODE < ZERO                                  47640099
476500             WHEN SQLCODE > ZERO                                  47650099
476600                 SET PS-UPDATE-NOT-OK                             47660099
476700                     PS-ERROR                                     47670099
476800                     DP020-MSG-FATAL     TO TRUE                  47680099
476900                 MOVE PC-TSYMSG-03160    TO DP020-MSG-NUMBER      47690099
477000                 MOVE '5400-INSERT-DFCT-SHIPT' TO DP013-PARAGRAPH 47700099
477100                 MOVE 'INSERT ROW ON RVT_TDFCTOR'                 47710099
477200                                         TO DP013-MESSAGE-TEXT(1) 47720099
477300                 MOVE ASC-DFCT-SHIPT-ID  TO DP013-MESSAGE-TEXT(2) 47730099
477400                 MOVE SQLCA              TO DP013-SQLCA           47740099
477500                 MOVE 'RVT_DFCT_SHIPT' TO DP013-DB2-TABLE-NAME (1)47750099
477600                 SET DP013-DB2-ABEND                              47760099
477700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           47770099
477800                 PERFORM DP013-0000-PROCESS-ABEND                 47780099
477900         END-EVALUATE                                             47790099
478000     END-PERFORM.                                                 47800099
478100                                                                  47810099
478200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        47820099
478300         SET PS-UPDATE-NOT-OK                                     47830099
478400             PS-ERROR                                             47840099
478500             DP020-MSG-FATAL           TO TRUE                    47850099
478600         MOVE PC-TSYMSG-03160          TO DP020-MSG-NUMBER        47860099
478700         MOVE '5400-INSERT-DFCT-SHIPT' TO DP013-PARAGRAPH         47870099
478800         MOVE 'MAX RETRIES EXCEEDED'   TO DP013-MESSAGE-TEXT(1)   47880099
478900         MOVE ASC-DFCT-SHIPT-ID        TO DP013-MESSAGE-TEXT(2)   47890099
479000         MOVE SQLCA                    TO DP013-SQLCA             47900099
479100         MOVE 'RVT_DFCT_SHIPT'         TO DP013-DB2-TABLE-NAME (1)47910099
479200         SET DP013-DB2-ABEND                                      47920099
479300             DP013-XCTL-DISPLAY-RESTART TO TRUE                   47930099
479400         PERFORM DP013-0000-PROCESS-ABEND                         47940099
479500     END-IF.                                                      47950099
479600                                                                  47960099
479700******************************************************************47970099
479800** UPDATE RVT_DFCT_SHIPT TABLE WHEN SHIPPING INFO CHANGES AND     47980099
479900**   STATUS IS ALREADY 'S', BUT HASN'T GONE TO AP YET             47990099
480000******************************************************************48000099
480100 5500-UPD-DFCT-SHIPT.                                             48010099
480200     MOVE ASC-DFCT-SHIPT-ID       TO DK-DFCT-SHIPT-ID.            48020099
480300     MOVE ASC-TRAILER-NBR         TO RVT00000-TRLR-ID.            48030099
480400     MOVE ASC-SCAC                TO RVT00000-SCAC-CDE.           48040099
480500                                                                  48050099
480600** IF THE SHIP DATE IS NOT ENTERED ON THE SCREEN, USE THE CURRENT 48060099
480700** DATE, OTHERWISE USE THE DATE THAT IS ENTERED ON THE SCREEN.    48070099
480800     IF  ASC-SHIP-DTE = SPACES                                    48080099
480900         MOVE ASC-CURRENT-DATE-USA                                48090099
481000                                  TO RVT00000-ACTL-SHIPT-DTE      48100099
481100     ELSE                                                         48110099
481200         MOVE ASC-SHIP-DTE        TO RVT00000-ACTL-SHIPT-DTE      48120099
481300     END-IF.                                                      48130099
481400                                                                  48140099
481500     PERFORM                                                      48150099
481600         WITH TEST AFTER                                          48160099
481700         VARYING PV-RETRY-COUNTER                                 48170099
481800         FROM 1 BY 1                                              48180099
481900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48190099
482000                   OR (SQLCODE = ZERO))                           48200099
482100         EXEC SQL                                                 48210099
482200             UPDATE RVT_DFCT_SHIPT                                48220099
482300                SET TRLR_ID          = :RVT00000-TRLR-ID          48230099
482400                   , SCAC_CDE        = :RVT00000-SCAC-CDE         48240099
482500                   , ACTL_SHIPT_DTE  = :RVT00000-ACTL-SHIPT-DTE   48250099
482600            WHERE DFCT_SHIPT_ID      = :DK-DFCT-SHIPT-ID          48260099
482700         END-EXEC                                                 48270099
482800                                                                  48280099
482900         EVALUATE TRUE                                            48290099
483000             WHEN SQLCODE = ZERO                                  48300099
483100                 SET PS-ROLLBACK-NOT-NEEDED                       48310099
483200                     PS-UPDATE-OK  TO TRUE                        48320099
483300             WHEN SQLCODE = -904                                  48330099
483400             WHEN SQLCODE = -913                                  48340099
483500                 CONTINUE                                         48350099
483600             WHEN SQLWARN0 NOT = SPACES                           48360099
483700             WHEN SQLCODE < ZERO                                  48370099
483800             WHEN SQLCODE > ZERO                                  48380099
483900                 SET PS-UPDATE-NOT-OK                             48390099
484000                     PS-ROLLBACK-NEEDED                           48400099
484100                     PS-ERROR                                     48410099
484200                     DP020-MSG-FATAL   TO TRUE                    48420099
484300                 MOVE PC-TSYMSG-03160  TO DP020-MSG-NUMBER        48430099
484400                 MOVE '5500-UPD-DFCT-SHIPT' TO DP013-PARAGRAPH    48440099
484500                 MOVE 'UPDATE A ROW ON RVT_DFCT_SHIPT'            48450099
484600                                       TO DP013-MESSAGE-TEXT(1)   48460099
484700                 MOVE DK-DFCT-SHIPT-ID TO DP013-MESSAGE-TEXT(2)   48470099
484800                 MOVE SQLCA            TO DP013-SQLCA             48480099
484900                 MOVE 'RVT_DFCT_SHIPT' TO DP013-DB2-TABLE-NAME (1)48490099
485000                 SET DP013-DB2-ABEND                              48500099
485100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           48510099
485200                 PERFORM DP013-0000-PROCESS-ABEND                 48520099
485300         END-EVALUATE                                             48530099
485400     END-PERFORM.                                                 48540099
485500                                                                  48550099
485600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        48560099
485700         SET PS-UPDATE-NOT-OK                                     48570099
485800             PS-ROLLBACK-NEEDED                                   48580099
485900             PS-ERROR                                             48590099
486000             DP020-MSG-FATAL         TO TRUE                      48600099
486100         MOVE PC-TSYMSG-03160        TO DP020-MSG-NUMBER          48610099
486200         MOVE '5500-UPD-DFCT-SHIPT'  TO DP013-PARAGRAPH           48620099
486300         MOVE 'MAX RETRIES EXCEEDED' TO DP013-MESSAGE-TEXT (1)    48630099
486400         MOVE DK-DFCT-SHIPT-ID       TO DP013-MESSAGE-TEXT(2)     48640099
486500         MOVE SQLCA                  TO DP013-SQLCA               48650099
486600         MOVE 'RVT_DFCT_SHIPT'       TO DP013-DB2-TABLE-NAME (1)  48660099
486700         SET DP013-DB2-ABEND                                      48670099
486800             DP013-XCTL-DISPLAY-RESTART                           48680099
486900                                     TO TRUE                      48690099
487000         PERFORM DP013-0000-PROCESS-ABEND                         48700099
487100     END-IF.                                                      48710099
487200                                                                  48720099
487300******************************************************************48730099
487400** INSERT TO RVT_SHIPT_STAT TABLE FOR RTV LISTING WHEN F23      **48740099
487500**   IS PRESSED                                                 **48750099
487600******************************************************************48760099
487700 5600-INSERT-SHIPT-STAT.                                          48770099
487800     MOVE ASC-DFCT-SHIPT-ID       TO RVT00001-DFCT-SHIPT-ID       48780099
487900     MOVE ASC-STAT-CDE            TO RVT00001-SHIPT-STAT-CDE      48790099
488000     MOVE DP020-USERID            TO RVT00001-USR-ID              48800099
488100                                                                  48810099
488200     PERFORM                                                      48820099
488300         WITH TEST AFTER                                          48830099
488400         VARYING PV-RETRY-COUNTER                                 48840099
488500         FROM 1 BY 1                                              48850099
488600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               48860099
488700                   OR (SQLCODE = ZERO))                           48870099
488800         EXEC SQL                                                 48880099
488900             INSERT INTO RVT_SHIPT_STAT                           48890099
489000                   ( DFCT_SHIPT_ID                                48900099
489100                   , CRE_TMST                                     48910099
489200                   , SHIPT_STAT_CDE                               48920099
489300                   , USR_ID )                                     48930099
489400            VALUES ( :RVT00001-DFCT-SHIPT-ID                      48940099
489500                   , CURRENT TIMESTAMP                            48950099
489600                   , :RVT00001-SHIPT-STAT-CDE                     48960099
489700                   , :RVT00001-USR-ID )                           48970099
489800         END-EXEC                                                 48980099
489900                                                                  48990099
490000         EVALUATE TRUE                                            49000099
490100             WHEN SQLCODE = ZERO                                  49010099
490200                 SET PS-UPDATE-OK  TO TRUE                        49020099
490300             WHEN SQLCODE = -904                                  49030099
490400             WHEN SQLCODE = -913                                  49040099
490500                 CONTINUE                                         49050099
490600             WHEN SQLWARN0 NOT = SPACES                           49060099
490700             WHEN SQLCODE < ZERO                                  49070099
490800             WHEN SQLCODE > ZERO                                  49080099
490900                 SET PS-UPDATE-NOT-OK                             49090099
491000                     PS-ERROR                                     49100099
491100                     DP020-MSG-FATAL       TO TRUE                49110099
491200                 MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER    49120099
491300                 MOVE '5600-INSERT-SHIPT-STAT' TO DP013-PARAGRAPH 49130099
491400                 MOVE 'INSERT ROW ON RVT_SHIPT_STAT'              49140099
491500                                   TO DP013-MESSAGE-TEXT(1)       49150099
491600                 MOVE ASC-DFCT-SHIPT-ID                           49160099
491700                                       TO DP013-MESSAGE-TEXT(2)   49170099
491800                 MOVE SQLCA        TO DP013-SQLCA                 49180099
491900                 MOVE 'RVT_SHIPT_STAT' TO DP013-DB2-TABLE-NAME (1)49190099
492000                 SET DP013-DB2-ABEND                              49200099
492100                     DP013-XCTL-DISPLAY-RESTART TO TRUE           49210099
492200                 PERFORM DP013-0000-PROCESS-ABEND                 49220099
492300         END-EVALUATE                                             49230099
492400     END-PERFORM.                                                 49240099
492500                                                                  49250099
492600     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49260099
492700         SET PS-UPDATE-NOT-OK                                     49270099
492800             PS-ERROR                                             49280099
492900             DP020-MSG-FATAL       TO TRUE                        49290099
493000         MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER            49300099
493100         MOVE '5600-INSERT-SHIPT-STAT' TO DP013-PARAGRAPH         49310099
493200         MOVE 'MAX RETRIES EXCEEDED'   TO DP013-MESSAGE-TEXT(1)   49320099
493300         MOVE ASC-DFCT-SHIPT-ID        TO DP013-MESSAGE-TEXT(2)   49330099
493400         MOVE SQLCA                TO DP013-SQLCA                 49340099
493500         MOVE 'RVT_SHIPT_STAT'     TO DP013-DB2-TABLE-NAME (1)    49350099
493600         SET DP013-DB2-ABEND                                      49360099
493700             DP013-XCTL-DISPLAY-RESTART TO TRUE                   49370099
493800         PERFORM DP013-0000-PROCESS-ABEND                         49380099
493900     END-IF.                                                      49390099
494000                                                                  49400099
494100******************************************************************49410099
494200** DELETE SHIPMENT WHEN ONLY 1 LISTING ON IT                      49420099
494300******************************************************************49430099
494400 5700-DEL-DFCT-SHIPT.                                             49440099
494500     MOVE ASC-DFCT-SHIPT-ID       TO DK-DFCT-SHIPT-ID             49450099
494600                                                                  49460099
494700     PERFORM                                                      49470099
494800         WITH TEST AFTER                                          49480099
494900         VARYING PV-RETRY-COUNTER                                 49490099
495000         FROM 1 BY 1                                              49500099
495100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               49510099
495200                   OR (SQLCODE = ZERO))                           49520099
495300         EXEC SQL                                                 49530099
495400             DELETE                                               49540099
495500               FROM RVT_DFCT_SHIPT                                49550099
495600            WHERE DFCT_SHIPT_ID    = :DK-DFCT-SHIPT-ID            49560099
495700         END-EXEC                                                 49570099
495800                                                                  49580099
495900         EVALUATE TRUE                                            49590099
496000             WHEN SQLCODE = ZERO                                  49600099
496100                 SET PS-UPDATE-OK  TO TRUE                        49610099
496200             WHEN SQLCODE = -904                                  49620099
496300             WHEN SQLCODE = -913                                  49630099
496400                 CONTINUE                                         49640099
496500             WHEN SQLWARN0 NOT = SPACES                           49650099
496600             WHEN SQLCODE < ZERO                                  49660099
496700             WHEN SQLCODE > ZERO                                  49670099
496800                 SET PS-UPDATE-NOT-OK                             49680099
496900                     PS-ERROR                                     49690099
497000                     DP020-MSG-FATAL   TO TRUE                    49700099
497100                 MOVE PC-TSYMSG-03160  TO DP020-MSG-NUMBER        49710099
497200                 MOVE '5700-DEL-DFCT-SHIPT' TO DP013-PARAGRAPH    49720099
497300                 MOVE 'DELETE A ROW ON RVT_DFCT_SHIPT'            49730099
497400                                       TO DP013-MESSAGE-TEXT(1)   49740099
497500                 MOVE DK-DFCT-SHIPT-ID TO DP013-MESSAGE-TEXT(2)   49750099
497600                 MOVE SQLCA            TO DP013-SQLCA             49760099
497700                 MOVE 'RVT_DFCT_SHIPT' TO DP013-DB2-TABLE-NAME (1)49770099
497800                 SET DP013-DB2-ABEND                              49780099
497900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           49790099
498000                 PERFORM DP013-0000-PROCESS-ABEND                 49800099
498100         END-EVALUATE                                             49810099
498200     END-PERFORM.                                                 49820099
498300                                                                  49830099
498400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        49840099
498500         SET PS-UPDATE-NOT-OK                                     49850099
498600             PS-ERROR                                             49860099
498700             DP020-MSG-FATAL         TO TRUE                      49870099
498800         MOVE PC-TSYMSG-03160        TO DP020-MSG-NUMBER          49880099
498900         MOVE '5700-DEL-DFCT-SHIPT'  TO DP013-PARAGRAPH           49890099
499000         MOVE 'MAX RETRIES EXCEEDED' TO DP013-MESSAGE-TEXT (1)    49900099
499100         MOVE DK-DFCT-SHIPT-ID       TO DP013-MESSAGE-TEXT (2)    49910099
499200         MOVE SQLCA                TO DP013-SQLCA                 49920099
499300         MOVE 'RVT_DFCT_SHIPT'     TO DP013-DB2-TABLE-NAME (1)    49930099
499400         SET DP013-DB2-ABEND                                      49940099
499500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   49950099
499600         PERFORM DP013-0000-PROCESS-ABEND                         49960099
499700     END-IF.                                                      49970099
499800                                                                  49980099
499900******************************************************************49990099
500000** UPDATE TDFCTOR WHEN A LISING IS REMOVED FROM A SHIPMENT      **50000099
500100**                             RESET NULL INDICATOR IN CASE     **50010099
500200**      SPECIAL INSTRUCTIONS WERE ADDED                         **50020099
500300**                                                              **50030099
500400** MOVE A -1 TO THE NULL INDICATOR FIELD FOR THE DEFECT SHIP ID **50040099
500500** FIELD, THE SPECIAL INSTRUCTIONS FIELD, AND THE CARRIER       **50050099
500600** TRACKING ID FIELD.  THIS WILL PLACE NULL VALUES INTO THE     **50060099
500700** FIELDS.                                                      **50070099
500800******************************************************************50080099
500900 5750-UPD-DFCT-SHIPT-ID.                                          50090099
501000     MOVE +0 TO NI-SPEC-INSTR.                                    50100099
501100     MOVE -1 TO NI-SHIPT-ID                                       50110099
501200                NI-TRKG-ID.                                       50120099
501300     MOVE ASC-DFCT-ORD-ID TO DK-DFCT-ORD-ID.                      50130099
501400     MOVE ASC-STAT-CDE    TO DFCTOR-DFCT-ORD-STAT-CDE.            50140099
501500     IF  ASC-SPEC-INSTRUCTIONS = SPACES OR                        50150099
501600         ASC-SPEC-INSTRUCTIONS = LOW-VALUES                       50160099
501700         MOVE -1                  TO NI-SPEC-INSTR                50170099
501800     ELSE                                                         50180099
501900         MOVE ASC-SPEC-INSTRUCTIONS                               50190099
502000                                  TO DFCTOR-SPC-INSTR-TXT         50200099
502100     END-IF.                                                      50210099
502200                                                                  50220099
502300     PERFORM                                                      50230099
502400         WITH TEST AFTER                                          50240099
502500         VARYING PV-RETRY-COUNTER                                 50250099
502600         FROM 1 BY 1                                              50260099
502700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               50270099
502800                   OR (SQLCODE = ZERO))                           50280099
502900         EXEC SQL                                                 50290099
503000             UPDATE TDFCTOR                                       50300099
503100                 SET SPC_INSTR_TXT   = :DFCTOR-SPC-INSTR-TXT      50310099
503200                                       :NI-SPEC-INSTR             50320099
503300                   , DFCT_SHIPT_ID   = :ASC-DFCT-SHIPT-ID         50330099
503400                                       :NI-SHIPT-ID               50340099
503500                   , CARR_TRKG_ID    = :ASC-TRACKING-NBR          50350099
503600                                       :NI-TRKG-ID                50360099
503700                   , STATUS_CHG_DTE  = CURRENT_DATE               50370099
503800                   , DFCT_ORD_STAT_CDE = :DFCTOR-DFCT-ORD-STAT-CDE50380099
503900               WHERE DFCT_ORD_ID     = :DK-DFCT-ORD-ID            50390099
504000                 AND DFCT_SHIPT_ID   = :DK-DFCT-SHIPT-ID          50400099
504100         END-EXEC                                                 50410099
504200                                                                  50420099
504300         EVALUATE TRUE                                            50430099
504400             WHEN SQLCODE = ZERO                                  50440099
504500                 SET PS-UPDATE-OK  TO TRUE                        50450099
504600             WHEN SQLCODE = -904                                  50460099
504700             WHEN SQLCODE = -913                                  50470099
504800                 CONTINUE                                         50480099
504900             WHEN SQLWARN0 NOT = SPACES                           50490099
505000             WHEN SQLCODE < ZERO                                  50500099
505100             WHEN SQLCODE > ZERO                                  50510099
505200                 SET PS-UPDATE-NOT-OK                             50520099
505300                     PS-ERROR                                     50530099
505400                     DP020-MSG-FATAL       TO TRUE                50540099
505500                 MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER    50550099
505600                 MOVE '5750-UPD-DFCT-SHIPT-ID  '                  50560099
505700                                           TO DP013-PARAGRAPH     50570099
505800                 MOVE 'UPDATE TDFCTOR SHIPT ID '                  50580099
505900                                   TO DP013-MESSAGE-TEXT(1)       50590099
506000                 MOVE DK-DFCT-ORD-ID                              50600099
506100                                   TO PV-DFCT-ORD-ID-X            50610099
506200                 MOVE DK-DFCT-SHIPT-ID                            50620099
506300                                   TO PV-SHIPT-ID-X               50630099
506400                 STRING 'DEFECT ORDER ID: ' DELIMITED BY SIZE     50640099
506500                        PV-DFCT-ORD-ID-X    DELIMITED BY SIZE     50650099
506600                        '   SHIPMENT ID: '  DELIMITED BY SIZE     50660099
506700                        PV-SHIPT-ID-X       DELIMITED BY SIZE     50670099
506800                                 INTO DP013-MESSAGE-TEXT(2)       50680099
506900                 MOVE SQLCA        TO DP013-SQLCA                 50690099
507000                 MOVE 'TDFCTOR'    TO DP013-DB2-TABLE-NAME (1)    50700099
507100                 SET DP013-DB2-ABEND                              50710099
507200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           50720099
507300                 PERFORM DP013-0000-PROCESS-ABEND                 50730099
507400         END-EVALUATE                                             50740099
507500     END-PERFORM.                                                 50750099
507600                                                                  50760099
507700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        50770099
507800         SET PS-UPDATE-NOT-OK                                     50780099
507900             PS-ERROR                                             50790099
508000             DP020-MSG-FATAL       TO TRUE                        50800099
508100         MOVE PC-TSYMSG-03160      TO DP020-MSG-NUMBER            50810099
508200         MOVE '5750-UPD-DFCT-SHIPT-ID' TO DP013-PARAGRAPH         50820099
508300         MOVE 'MAX RETRIES EXCEEDED' TO DP013-MESSAGE-TEXT (1)    50830099
508400         MOVE DK-DFCT-ORD-ID       TO PV-DFCT-ORD-ID-X            50840099
508500         MOVE DK-DFCT-SHIPT-ID     TO PV-SHIPT-ID-X               50850099
508600         STRING 'DEFECT ORDER ID: '   DELIMITED BY SIZE           50860099
508700                PV-DFCT-ORD-ID-X      DELIMITED BY SIZE           50870099
508800                '   SHIPMENT ID: '    DELIMITED BY SIZE           50880099
508900                PV-SHIPT-ID-X         DELIMITED BY SIZE           50890099
509000                                 INTO DP013-MESSAGE-TEXT(2)       50900099
509100         MOVE DK-DFCT-SHIPT-ID     TO DP013-MESSAGE-TEXT(2)       50910099
509200         MOVE SQLCA                TO DP013-SQLCA                 50920099
509300         MOVE 'TDFCTOR'            TO DP013-DB2-TABLE-NAME (1)    50930099
509400         SET DP013-DB2-ABEND                                      50940099
509500             DP013-XCTL-DISPLAY-RESTART TO TRUE                   50950099
509600         PERFORM DP013-0000-PROCESS-ABEND                         50960099
509700     END-IF.                                                      50970099
509800                                                                  50980099
509900******************************************************************50990099
510000** UPDATE THE SPECIAL INSTRUCTIONS/COMMENTS ON TDFCTOR. ONCE A    51000099
510100**   LISTING HAS BEEN SENT TO AP, ONLY THE COMMENTS CAN CHANGE.   51010099
510200** MOVE A -1 TO THE NULL INDICATOR FIELD FOR THE SPECIAL        **51020099
510300** INSTRUCTIONS FIELD IF THE FIELD HAS BEEN CLEARED OUT.  THIS  **51030099
510400** WILL PLACE NULL VALUES INTO THE FIELDS.                      **51040099
510500******************************************************************51050099
510600 5950-UPD-COMMENTS-ONLY.                                          51060099
510700     MOVE +0 TO NI-SPEC-INSTR.                                    51070099
510800                                                                  51080099
510900     IF  ASC-SPEC-INSTRUCTIONS = SPACES OR                        51090099
511000         ASC-SPEC-INSTRUCTIONS = LOW-VALUES                       51100099
511100         MOVE -1                  TO NI-SPEC-INSTR                51110099
511200     ELSE                                                         51120099
511300         MOVE ASC-SPEC-INSTRUCTIONS                               51130099
511400                                  TO DFCTOR-SPC-INSTR-TXT         51140099
511500     END-IF.                                                      51150099
511600                                                                  51160099
511700     PERFORM                                                      51170099
511800         WITH TEST AFTER                                          51180099
511900         VARYING PV-RETRY-COUNTER                                 51190099
512000         FROM 1 BY 1                                              51200099
512100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               51210099
512200                   OR (SQLCODE = ZERO))                           51220099
512300         EXEC SQL                                                 51230099
512400             UPDATE TDFCTOR                                       51240099
512500                SET SPC_INSTR_TXT = :DFCTOR-SPC-INSTR-TXT         51250099
512600                                    :NI-SPEC-INSTR                51260099
512700            WHERE DFCT_ORD_ID      = :DK-DFCT-ORD-ID              51270099
512800         END-EXEC                                                 51280099
512900                                                                  51290099
513000         EVALUATE TRUE                                            51300099
513100             WHEN SQLCODE = ZERO                                  51310099
513200                 SET PS-ROLLBACK-NOT-NEEDED                       51320099
513300                     PS-UPDATE-OK  TO TRUE                        51330099
513400             WHEN SQLCODE = -904                                  51340099
513500             WHEN SQLCODE = -913                                  51350099
513600                 CONTINUE                                         51360099
513700             WHEN SQLWARN0 NOT = SPACES                           51370099
513800             WHEN SQLCODE < ZERO                                  51380099
513900             WHEN SQLCODE > ZERO                                  51390099
514000                 SET PS-UPDATE-NOT-OK                             51400099
514100                     PS-ROLLBACK-NEEDED                           51410099
514200                     PS-ERROR                                     51420099
514300                     DP020-MSG-FATAL   TO TRUE                    51430099
514400                 MOVE PC-TSYMSG-03160  TO DP020-MSG-NUMBER        51440099
514500                 MOVE '5950-UPD-COMMENTS-ONLY' TO DP013-PARAGRAPH 51450099
514600                 MOVE 'UPDATE TDFCTOR COMMENTS'                   51460099
514700                                      TO DP013-MESSAGE-TEXT(1)    51470099
514800                 MOVE DK-DFCT-ORD-ID  TO DP013-MESSAGE-TEXT(2)    51480099
514900                 MOVE SQLCA           TO DP013-SQLCA              51490099
515000                 MOVE 'TDFCTOR'       TO DP013-DB2-TABLE-NAME (1) 51500099
515100                 SET DP013-DB2-ABEND                              51510099
515200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           51520099
515300                 PERFORM DP013-0000-PROCESS-ABEND                 51530099
515400         END-EVALUATE                                             51540099
515500     END-PERFORM.                                                 51550099
515600                                                                  51560099
515700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        51570099
515800         SET PS-UPDATE-NOT-OK                                     51580099
515900             PS-ROLLBACK-NEEDED                                   51590099
516000             PS-ERROR                                             51600099
516100             DP020-MSG-FATAL           TO TRUE                    51610099
516200         MOVE PC-TSYMSG-03160          TO DP020-MSG-NUMBER        51620099
516300         MOVE '5950-UPD-COMMENTS-ONLY' TO DP013-PARAGRAPH         51630099
516400         MOVE 'MAX RETRIES EXCEEDED'   TO DP013-MESSAGE-TEXT(1)   51640099
516500         MOVE DK-DFCT-ORD-ID           TO DP013-MESSAGE-TEXT(2)   51650099
516600         MOVE SQLCA                    TO DP013-SQLCA             51660099
516700         MOVE 'TDFCTOR'                TO DP013-DB2-TABLE-NAME (1)51670099
516800         SET DP013-DB2-ABEND                                      51680099
516900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   51690099
517000         PERFORM DP013-0000-PROCESS-ABEND                         51700099
517100     END-IF.                                                      51710099
517200                                                                  51720099
517300******************************************************************51730099
517400** DO A SYNCPOINT OF ALL UPDATED/INSERTED DATA                  **51740099
517500******************************************************************51750099
517600 8900-SYNCPOINT.                                                  51760099
517700     EXEC CICS                                                    51770099
517800         SYNCPOINT                                                51780099
517900     END-EXEC.                                                    51790099
518000                                                                  51800099
518100******************************************************************51810099
518200** NOT ALL UPDATES/INSERTS SUCCESSSFUL, ROLLBACK CHANGES        **51820099
518300******************************************************************51830099
518400 8950-SYNCPOINT-ROLLBACK.                                         51840099
518500     EXEC CICS                                                    51850099
518600         SYNCPOINT ROLLBACK                                       51860099
518700     END-EXEC.                                                    51870099
518800                                                                  51880099
518900*----------------------------------------------------------------*51890099
519000*    ABEND PROCESSOR MODULE                                      *51900099
519100*----------------------------------------------------------------*51910099
519200     COPY DPPD013.                                                51920099
