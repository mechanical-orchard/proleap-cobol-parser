000100*-----------------------*                                         00010004
000200 IDENTIFICATION DIVISION.                                         00020000
000300*-----------------------*                                         00030000
000400 PROGRAM-ID.    PCKCS711.                                         00040004
000500 AUTHOR.        GERMAN BANDA.                                     00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  06-2001.                                          00070099
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*---------------------------------------------------------------* 00100000
001100*    E711 - PBS SMOOTHING CARTON UPDATE                         * 00110027
001200*                                                               * 00120000
001300*---------------------------------------------------------------* 00130000
001310*  CHANGED 10/13/2014    BY COGNIZANT       WR: CHG0094517        00131099
001320*                                                                 00132099
001330* EXTENDED PO# FROM 7 TO 8 DIGITS WHERE NEEDED.                   00133099
001340*-----------------------------------------------------------------00134099
001350* DATE  11/04/2021                                                00135099
001360*            - CHANGE CALL OF 'DPKUT100' TO                     * 00136099
001370*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00137099
001380*              MAKING THE CALL DYNAMIC VS STATIC                * 00138099
001390*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00139099
001391*-----------------------------------------------------------------00139199
1122RM* DATE  11/07/2022                                              * 00139299
1122RM*            - ADD COPYBOOK DPWS930                             * 00139399
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00139499
1122RM*              DYNAMIC.                                         * 00139599
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00139699
1122RM*-----------------------------------------------------------------00139799
001400 EJECT                                                            00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600                                                                  00160000
001700 DATA DIVISION.                                                   00170000
001800                                                                  00180000
001900 WORKING-STORAGE SECTION.                                         00190000
002000                                                                  00200000
002100 01  DK-DB2-KEYS.                                                 00210000
002200     15  DK-SHIPT-UNT-ID                 PIC S9(18)V COMP-3.      00220004
002300                                                                  00230004
002400     15  DK-SCAC-ID                      PIC  X(04) VALUE SPACES. 00240004
002500                                                                  00250004
002600     15  DK-TRLR-NBR                     PIC  X(11) VALUE SPACES. 00260004
002700                                                                  00270004
002800     15  DK-TRIP-ID                      PIC  S9(09) VALUE ZERO   00280031
002900                                                    COMP.         00290004
003000     15  DK-PO-NBR                       PIC  S9(09) VALUE ZERO   00300031
003100                                                    COMP.         00310004
003200     15  DK-REC-SEQ-NBR                  PIC  S9(09) VALUE ZERO   00320031
003300                                                      COMP.       00330050
003400     15  DK-STR-NBR                      PIC  S9(04)  COMP.       00340050
003500     15  DK-RECEIVER                     PIC  S9(04)  COMP.       00350099
003600     15  DK-RANDOM-NBR                   PIC  S9(09)  COMP.       00360099
003700                                                                  00370004
003800                                                                  00380004
003900 01  PC-PROGRAM-CONSTANTS.                                        00390004
004000     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'PCK711  '.  00400005
004100     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'PCKM711 '.  00410004
004200     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'PCKCS711'.  00420004
004300     05  PC-RANDOM-PGM             PIC  X(08)  VALUE  'DPKUT902'. 00430062
004400     05  PC-PRINT-PROGRAM          PIC  X(08)  VALUE  'PCKCS728'. 00440066
004500     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00450004
004600     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00460004
004700     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00470004
004800     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00480004
004900     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +11          00490004
005000                                               COMP SYNC.         00500004
005100     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00510004
005200                                               COMP SYNC.         00520004
005300     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00530004
005400                                               COMP-3.            00540004
005500     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00550004
005600                                               COMP SYNC.         00560004
005700     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00570004
005800                                               COMP-3.            00580004
005900     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00590004
006000     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00600004
006100     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00610004
006200     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00620004
006300     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00630004
006400     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00640004
006500     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00650004
006600                                               COMP.              00660004
006700     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00670004
006800     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00680004
006900     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00690004
007000     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00700004
007100     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00710004
007200     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00720004
007300     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00730004
007400     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00740004
007500     05  PC-01                     PIC  X(02)  VALUE '01'.        00750004
007600     05  PC-MULT                   PIC  X(08)  VALUE 'MULTIPLE'.  00760004
007700*                                                                 00770004
007800                                                                  00780004
007900*                                                                 00790004
008000*----------------------------------------------------------------*00800004
008100*  DESCRIPTION CONSTANTS                                         *00810004
008200*----------------------------------------------------------------*00820004
008300     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  00830004
008400     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  00840004
008500     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  00850004
008600     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  00860004
008700     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  00870004
008800     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  00880004
008900     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  00890004
009000     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  00900004
009100     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  00910004
009200     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  00920004
009300     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.00930004
009400     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.00940004
009500     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     00950004
009600                                           VALUE '** UNKNOWN **'. 00960004
009700     05  PC-UNKNWN-VENDOR           PIC X(16)                     00970004
009800                                         VALUE ' UNKNOWN VENDOR '.00980004
009900*                                                                 00990004
010000*----------------------------------------------------------------*01000004
010100*  SYSTEM MESSAGES                                               *01010004
010200*----------------------------------------------------------------*01020004
010300*   00005 = INVALID VALUE                                        *01030004
010400*   00008 = MUST BE NUMERIC                                      *01040004
010500*   00045 = INVALID FUNCTION KEY                                 *01050004
010600*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *01060004
010700*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01070004
010800*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01080004
010900*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01090004
011000*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01100004
011100*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01110004
011200*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01120004
011300*   00069 - TOP OF LIST                                          *01130004
011400*   00070 - BOTTOM OF LIST                                       *01140004
011500*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01150004
011600*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01160004
011700*   00279 - MORE ITEMS TO DISPLAY                                *01170004
011800*   00746 = INVALID PRINTER DESTINATION                          *01180004
011900*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01190004
012000*   01563 = PRINTER ID MUST BE ENTERED FOR THIS SELECTION        *01200004
012100*   02224 = CANNOT CONFIRM/UNCONFIRM DISTRO-PULL POSTED           01210004
012200*   02225 = CANNOT CONFIRM DISTRIBUTION - PULL CANCELLED          01220004
012300*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01230004
012400*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01240004
012500*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01250004
012600*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01260004
012700*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01270004
012800*   02254 - CANCEL  PULL - PRESS F2 TO CONFIRM                    01280004
012900*   02255 - UNCANCEL PULL - PRESS F2 TO CONFIRM                   01290004
013000*   02256 - CANCEL LINE ITEM - PRESS F2 TO CONFIRM                01300004
013100*   02257 - UNCANCEL LINE ITEM - PRESS F2 TO CONFIRM              01310004
013200*   02258 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM PULL DI01320004
013300*   02259 - UNCONFIRM PULL DISTRIBUTION - PRESS F2 TO CONFIRM     01330004
013400*   02260 - HAVE STORE UNITS BEEN ADJUSTED?  F2 TO CONFIRM LINE IT01340004
013500*   02261 - UNCONFIRM LINE ITEM DISTRIBUTION - PRESS F2 TO CONFIRM01350004
013600*   02262 - CONFIRM PULL - PRESS F2 TO CONFIRM                    01360004
013700*   02263 - UNCONFIRM PULL - PRESS F2 TO CONFIRM                  01370004
013800*   02264 - CONFIRM LINE ITEM - PRESS F2 TO CONFIRM               01380004
013900*   02265 - UNCONFIRM LINE ITEM - PRESS F2 TO CONFIRM             01390004
014000*   02266 - ALL SELECTED ITEMS MUST HAVE THE SAME STATUS          01400004
014100*   02267 - CANNOT CANCEL/UNCANCEL - PULL ALREADY POSTED/DISTRIBTD01410004
014200*   02268 - CANNOT CANCEL/UNCANCEL - LINE(S) ALREADY POSTED/DISTRB01420004
014300*   02269 - (UN)CANCEL PULL REQUEST FAILED                        01430004
014400*   02270 - (UN)CONFIRM PULL DISTRIBUTION REQUEST FAILED          01440004
014500*   02271 - (UN)CONFIRM PULL REQUEST FAILED                       01450004
014600*   02272 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS IS DISTRIBTD01460004
014700*   02273 - CANNOT UNCONFIRM DISTRIBUTION - PULL STATUS NOT DISTRB01470004
014800*   02274 - (UN)CANCEL PULL REQUEST SUCCESSFUL                    01480004
014900*   02275 - (UN)CONFIRM PULL DISTRIBUTION REQUEST SUCCESSFUL      01490004
015000*   02276 - (UN)CONFIRM PULL REQUEST SUCCESSFUL                   01500004
015100*   02278 = ALL SELECTED LINES MUST HAVE THE SAME STATUS TO PER  *01510004
015200*   02287 - CONFIRM DISTRIBUTION FAILED - NO LINE(S) FOR PULL     01520004
015300*   02288 - CONFIRM DISTRIBUTION FAILED - LINE(S) MISSING DISTRB  01530004
015400*   02289 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS DISTRIBTD01540004
015500*   02290 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS POSTED   01550004
015600*   02291 - CANNOT CONFIRM DISTRIBUTION - LINE STATUS IS CANCELLED01560004
015700*   02296 - PRINT PULL FAILED - NO LINE(S) FOR REQUESTED PULL     01570004
015800*   02297 - PRINT PULL FAILED - LINE(S) MISSING DISTRIBUTION INFOR01580004
015900*   02306 - YOU DO NOT HAVE AUTHORITY TO PRINT                    01590004
016000*   02307 - YOU DO NOT HAVE AUTHORITY TO CANCEL/UNCANCEL          01600004
016100*   02308 - YOU DO NOT HAVE AUTHORITY TO CONFIRM/UNCONFIRM DISTRIB01610004
016200*   02317 - CANNOT CONFIRM DISTRIBUTION - PULL STATUS NEW         01620004
016300*   02324 - PRINT REQUEST FAILED - LINE STATUS IS POSTED OR DISTRI01630004
016400*   02325 - PRINT REQUEST FAILED - LINE STATUS IS CANCELLED       01640004
016500*   02328 - YOU DO NOT HAVE AUTHORITY TO ADD NEW LINE ITEMS       01650004
016600*   02332 - CANNOT ADD LINE ITEMS - PULL STATUS IS POSTED/DISTRIBU01660004
016700*   02339 - CANNOT CONFIRM DISTRIBUTION - PULL LINE STATUS NEW    01670004
016800*   02743 - NUMBER OF UNITS MUST BE GREATER THAN NUMBER OF CARTONS01680099
016900*   99901 = INVALID COMMAND WAS ENTERED                          *01690004
017000*----------------------------------------------------------------*01700004
017100     05  PC-TSYMSG-NUMBERS.                                       01710004
017200         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01720004
017300         10  PC-TSYMSG-00007            PIC  9(05)  VALUE 00007.  01730053
017400         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01740053
017500         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  01750004
017600         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01760004
017700         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01770004
017800         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01780004
017900         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01790004
018000         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01800004
018100         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01810004
018200         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01820004
018300         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01830004
018400         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01840004
018500         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01850004
018600         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01860004
018700         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01870004
018800         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01880004
018900         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01890004
019000         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01900004
019100         10  PC-TSYMSG-02224            PIC  9(05)  VALUE 02224.  01910073
019200         10  PC-TSYMSG-02225            PIC  9(05)  VALUE 02225.  01920004
019300         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01930004
019400         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01940004
019500         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01950004
019600         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01960004
019700         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01970004
019800         10  PC-TSYMSG-02254            PIC  9(05)  VALUE 02254.  01980004
019900         10  PC-TSYMSG-02255            PIC  9(05)  VALUE 02255.  01990004
020000         10  PC-TSYMSG-02256            PIC  9(05)  VALUE 02256.  02000004
020100         10  PC-TSYMSG-02257            PIC  9(05)  VALUE 02257.  02010004
020200         10  PC-TSYMSG-02258            PIC  9(05)  VALUE 02258.  02020004
020300         10  PC-TSYMSG-02259            PIC  9(05)  VALUE 02259.  02030004
020400         10  PC-TSYMSG-02260            PIC  9(05)  VALUE 02260.  02040004
020500         10  PC-TSYMSG-02261            PIC  9(05)  VALUE 02261.  02050004
020600         10  PC-TSYMSG-02262            PIC  9(05)  VALUE 02262.  02060004
020700         10  PC-TSYMSG-02263            PIC  9(05)  VALUE 02263.  02070004
020800         10  PC-TSYMSG-02264            PIC  9(05)  VALUE 02264.  02080004
020900         10  PC-TSYMSG-02265            PIC  9(05)  VALUE 02265.  02090004
021000         10  PC-TSYMSG-02266            PIC  9(05)  VALUE 02266.  02100004
021100         10  PC-TSYMSG-02267            PIC  9(05)  VALUE 02267.  02110004
021200         10  PC-TSYMSG-02268            PIC  9(05)  VALUE 02268.  02120004
021300         10  PC-TSYMSG-02269            PIC  9(05)  VALUE 02269.  02130004
021400         10  PC-TSYMSG-02270            PIC  9(05)  VALUE 02270.  02140004
021500         10  PC-TSYMSG-02271            PIC  9(05)  VALUE 02271.  02150004
021600         10  PC-TSYMSG-02272            PIC  9(05)  VALUE 02272.  02160004
021700         10  PC-TSYMSG-02273            PIC  9(05)  VALUE 02273.  02170004
021800         10  PC-TSYMSG-02274            PIC  9(05)  VALUE 02274.  02180004
021900         10  PC-TSYMSG-02275            PIC  9(05)  VALUE 02275.  02190004
022000         10  PC-TSYMSG-02276            PIC  9(05)  VALUE 02276.  02200004
022100         10  PC-TSYMSG-02278            PIC  9(05)  VALUE 02278.  02210004
022200         10  PC-TSYMSG-02287            PIC  9(05)  VALUE 02287.  02220004
022300         10  PC-TSYMSG-02288            PIC  9(05)  VALUE 02288.  02230004
022400         10  PC-TSYMSG-02289            PIC  9(05)  VALUE 02289.  02240004
022500         10  PC-TSYMSG-02290            PIC  9(05)  VALUE 02290.  02250004
022600         10  PC-TSYMSG-02291            PIC  9(05)  VALUE 02291.  02260004
022700         10  PC-TSYMSG-02296            PIC  9(05)  VALUE 02296.  02270004
022800         10  PC-TSYMSG-02297            PIC  9(05)  VALUE 02297.  02280004
022900         10  PC-TSYMSG-02306            PIC  9(05)  VALUE 02306.  02290004
023000         10  PC-TSYMSG-02307            PIC  9(05)  VALUE 02307.  02300004
023100         10  PC-TSYMSG-02308            PIC  9(05)  VALUE 02308.  02310004
023200         10  PC-TSYMSG-02317            PIC  9(05)  VALUE 02317.  02320004
023300         10  PC-TSYMSG-02324            PIC  9(05)  VALUE 02324.  02330004
023400         10  PC-TSYMSG-02325            PIC  9(05)  VALUE 02325.  02340004
023500         10  PC-TSYMSG-02328            PIC  9(05)  VALUE 02328.  02350004
023600         10  PC-TSYMSG-02332            PIC  9(05)  VALUE 02332.  02360004
023700         10  PC-TSYMSG-02339            PIC  9(05)  VALUE 02339.  02370004
023800         10  PC-TSYMSG-02685            PIC  9(05)  VALUE 02685.  02380089
023900         10  PC-TSYMSG-02693            PIC  9(05)  VALUE 02693.  02390081
024000         10  PC-TSYMSG-02694            PIC  9(05)  VALUE 02694.  02400081
024100         10  PC-TSYMSG-02743            PIC  9(05)  VALUE 02743.  02410099
024200         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  02420004
024300*                                                                 02430004
024400 01  PS-PROGRAM-SWITCHES.                                         02440004
024500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    02450004
024600         88  PS-NO-ERROR                            VALUE 'Y'.    02460004
024700         88  PS-ERROR                               VALUE 'N'.    02470004
024800     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    02480004
024900         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    02490004
025000         88  PS-BLOCK-ERROR                         VALUE 'N'.    02500004
025100     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   02510004
025200         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   02520004
025300         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   02530004
025400     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    02540004
025500         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    02550004
025600         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    02560004
025700     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    02570004
025800         88  PS-COMMAREA-VALID                      VALUE 'Y'.    02580004
025900         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    02590004
026000     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    02600004
026100         88  PS-DONE                                VALUE 'Y'.    02610004
026200         88  PS-NOT-DONE                            VALUE 'N'.    02620004
026300     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    02630004
026400         88  PS-LIST-END                            VALUE 'Y'.    02640004
026500         88  PS-NO-LIST-END                         VALUE 'N'.    02650004
026600     05  PS-ACCESS-SW                   PIC  X(01)  VALUE  'N'.   02660004
026700         88  PS-ACCESS-ALLOWED                      VALUE  'Y'.   02670004
026800         88  PS-ACCESS-NOT-ALLOWED                  VALUE  'N'.   02680004
026900     05  PS-FIRST-FETCH-SW              PIC  X(01)  VALUE  'N'.   02690004
027000         88  PS-FIRST-FETCH                         VALUE  'Y'.   02700004
027100         88  PS-NOT-FIRST-FETCH                     VALUE  'N'.   02710004
027200     05  PS-TRANS-ID-DUP-SW             PIC X(01)   VALUE 'Y'.    02720099
027300         88  PS-TRANS-ID-NOT-DUP                    VALUE 'N'.    02730099
027400         88  PS-TRANS-ID-DUP                        VALUE 'Y'.    02740099
027500*                                                                 02750004
027600 01  PV-PROGRAM-VARIABLES.                                        02760004
027700     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  02770004
027800                                        COMP SYNC.                02780004
027900     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 02790004
028000     05  PV-SUB                         PIC S9(04)  VALUE +0      02800004
028100                                                    COMP SYNC.    02810004
028200     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      02820004
028300                                                    COMP SYNC.    02830004
028400     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      02840004
028500                                                    COMP-3.       02850004
028600     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      02860004
028700                                                    COMP-3.       02870004
028800     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      02880004
028900                                                    COMP-3.       02890004
029000     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      02900004
029100                                                    COMP-3.       02910004
029200     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      02920004
029300                                                    COMP-3.       02930004
029400     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      02940004
029500                                                    COMP-3.       02950004
029600     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      02960004
029700                                                    COMP-3.       02970004
029800     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      02980004
029900                                                    COMP SYNC.    02990004
030000     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      03000004
030100                                                    COMP SYNC.    03010004
030200     05  PV-ITEM                        PIC S9(04)  VALUE +0      03020004
030300                                                    COMP SYNC.    03030004
030400     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      03040004
030500                                                    COMP SYNC.    03050004
030600     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      03060004
030700                                                    COMP SYNC.    03070004
030800     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      03080004
030900                                                    COMP SYNC.    03090004
031000     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      03100004
031100                                                    COMP SYNC.    03110004
031200     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      03120004
031300                                                    COMP SYNC.    03130004
031400     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03140004
031500                                                    COMP SYNC.    03150004
031600     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      03160004
031700                                                    COMP SYNC.    03170004
031800     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      03180004
031900                                                    COMP SYNC.    03190004
032000     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      03200004
032100                                                    COMP SYNC.    03210004
032200     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      03220004
032300                                                    COMP SYNC.    03230004
032400     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      03240004
032500                                                    COMP SYNC.    03250004
032600     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      03260004
032700                                                    COMP SYNC.    03270004
032800     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      03280004
032900                                                    COMP SYNC.    03290004
033000     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      03300004
033100                                                    COMP.         03310004
033200     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      03320004
033300                                                    COMP.         03330004
033400     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      03340004
033500                                                    COMP.         03350004
033600     05  PV-SOFT-ABORT-MSG.                                       03360004
033700         10  FILLER            PIC X(12) VALUE ' PCKCS711 - '.    03370004
033800         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       03380004
033900         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    03390004
034000         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    03400004
034100         10  PV-SOFT-PARAGRAPH PIC X(30).                         03410004
034200     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     03420004
034300                                                     COMP SYNC.   03430004
034400     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 03440004
034500     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 03450004
034600     05  PV-CICS-MSG-HOLD.                                        03460004
034700         10  FILLER                      PIC  X(01)  VALUE SPACE. 03470004
034800         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 03480004
034900     05  PV-CICS-MSG-HOLD2.                                       03490004
035000         10  FILLER                      PIC  X(01)  VALUE SPACE. 03500004
035100         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 03510004
035200                                                                  03520004
035300     05  PV-SHIPT-UNT-ID                 PIC S9(18)  VALUE ZEROES 03530004
035400                                                     COMP.        03540004
035500     05  PV-PO-RECEIVER.                                          03550004
035600         10  PV-PO-NBR                  PIC  9(08).               03560099
035700         10  FILLER                     PIC  X(01)   VALUE '-'.   03570004
035800         10  PV-RECEIVER                PIC  9(04).               03580004
035900                                                                  03590004
036000     05  PV-REC-SEQ-NBR                 PIC S9(09)  VALUE +0      03600004
036100                                                    COMP SYNC.    03610004
036200                                                                  03620004
036300                                                                  03630004
036400     05  PV-CREATED-BY                   PIC  X(08) VALUE SPACES. 03640018
036500     05  PV-CREATE-DTE                   PIC  X(10) VALUE SPACES. 03650038
036600     05  PV-REFORMAT-DATE.                                        03660038
036700         10  PV-REFORMAT-DTE.                                     03670038
036800             15  PV-REFORMAT-YYYY         PIC X(04)  VALUE SPACES.03680038
036900             15  FILLER                   PIC X(01)  VALUE SPACES.03690038
037000             15  PV-REFORMAT-MM           PIC X(02)  VALUE SPACES.03700038
037100             15  FILLER                   PIC X(01)  VALUE SPACES.03710038
037200             15  PV-REFORMAT-DD           PIC X(02)  VALUE SPACES.03720038
037300     05  PV-FORMAT-DATE.                                          03730038
037400         10  PV-FORMAT-DTE.                                       03740038
037500             15  PV-FORMAT-MM             PIC X(02)  VALUE SPACES.03750038
037600             15  FILLER                   PIC X(01)  VALUE '/'.   03760039
037700             15  PV-FORMAT-DD             PIC X(02)  VALUE SPACES.03770038
037800             15  FILLER                   PIC X(01)  VALUE '/'.   03780039
037900             15  PV-FORMAT-YYYY           PIC X(04)  VALUE SPACES.03790038
038000                                                                  03800038
038100     05  PV-CREATE-TME                   PIC  X(08) VALUE SPACES. 03810018
038200     05  PV-FORMAT-TIME.                                          03820038
038300         10  PV-FORMAT-TME.                                       03830038
038400             15  PV-FORMAT-HH             PIC X(02)  VALUE SPACES.03840038
038500             15  FILLER                   PIC X(01)  VALUE ':'.   03850039
038600             15  PV-FORMAT-MIN            PIC X(02)  VALUE SPACES.03860039
038700             15  FILLER                   PIC X(01)  VALUE ':'.   03870039
038800             15  PV-FORMAT-SS             PIC X(02)  VALUE SPACES.03880038
038900                                                                  03890004
039000     05  PV-ADDL-LABELS-REQ              PIC  9(05) VALUE ZEROES. 03900069
039100                                                                  03910020
039200     05  PV-STR-UNITS                    PIC  9(05) VALUE ZEROES. 03920097
039300                                                                  03930097
039400     05  PV-DB2-COUNT-ACTV               PIC S9(04)  VALUE +0     03940048
039500                                                    COMP SYNC.    03950048
039600     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     03960004
039700                                                     COMP SYNC.   03970004
039800     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      03980004
039900     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      03990004
040000     05  PV-LPMS-TRANS-ID                PIC  9(08)  VALUE ZEROES.04000099
040100     05  PV-RANDOM-NUMBER                PIC  9(09)  VALUE ZEROES.04010062
040200     05  PV-RANDOM-NUMBER-R REDEFINES  PV-RANDOM-NUMBER.          04020062
040300         10  PV-RANDOM-1-8               PIC  9(08).              04030062
040400         10  FILLER                      PIC  9(01).              04040062
040500     05  PV-RANDOM-NBR-R                 PIC  9(08)  VALUE ZEROES.04050062
040600                                                                  04060004
040700 01  DN-DB2-NULL-INDICATORS.                                      04070004
040800     05  DN-VEH-NBR                PIC S9(04) COMP VALUE ZEROES.  04080004
040900*                                                                 04090004
041000                                                                  04100004
041100                                                                  04110004
041200*---------------------------------------------------------------* 04120004
041300*    MAP LAYOUT                                                 * 04130004
041400*---------------------------------------------------------------* 04140004
041500                                                                  04150004
041600     COPY PCKM711.                                                04160012
041700*                                                                 04170004
041800*----------------------------------------------------------------*04180004
041900*  SENDING/RECEIVING AREA FOR THE                                *04190004
042000*  PRINTER VALIDATION ROUTING (DPKCS060)                         *04200004
042100*----------------------------------------------------------------*04210004
042200     COPY DPWS072.                                                04220004
042300                                                                  04230004
042400                                                                  04240004
042500*----------------------------------------------------------------*04250004
042600**  SECURITY SUBROUTINE PARAMETERS                                04260004
042700*----------------------------------------------------------------*04270004
042800     COPY DPWS008.                                                04280004
042900                                                                  04290004
043000                                                                  04300004
043100*----------------------------------------------------------------*04310062
043200*  RANDOM NUMBER AREA                                             04320062
043300*----------------------------------------------------------------*04330062
043400     COPY DPWS902.                                                04340062
043500                                                                  04350062
043600*---------------------------------------------------------------* 04360004
043700*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04370004
043800*---------------------------------------------------------------* 04380004
043900                                                                  04390004
044000     COPY DPWS015.                                                04400063
044100                                                                  04410004
044200*---------------------------------------------------------------* 04420004
044300*    FUNCTION KEYS COPYBOOK.                                    * 04430004
044400*---------------------------------------------------------------* 04440004
044500                                                                  04450004
044600     COPY DPWS016.                                                04460063
044700                                                                  04470004
044800*---------------------------------------------------------------* 04480004
044900*    NUMERIC EDIT LAYOUT.                                       * 04490004
045000*---------------------------------------------------------------* 04500004
045100                                                                  04510004
045200     COPY DPWS010I.                                               04520063
045300 EJECT                                                            04530004
045400*---------------------------------------------------------------* 04540004
045500*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 04550004
045600*---------------------------------------------------------------* 04560004
045700                                                                  04570004
045800     COPY DPWS030.                                                04580063
1122RM     COPY DPWS930.                                                04581099
045900 EJECT                                                            04590004
046000*---------------------------------------------------------------* 04600004
046100*    STANDARD COMMAREA.                                         * 04610004
046200*---------------------------------------------------------------* 04620004
046300                                                                  04630004
046400     COPY DPWS020.                                                04640063
046500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04650004
046600                                                                  04660004
046700*---------------------------------------------------------------* 04670004
046800* INTER-APPLICATION COMMAREA.                                   * 04680004
046900*   PCWS202 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04690009
047000*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04700004
047100*---------------------------------------------------------------* 04710004
047200                                                                  04720004
047300         10  INTER-APPL-COMM-AREA       PIC X(200).               04730004
047400     COPY PCWS202.                                                04740064
047500     COPY PCWS204.                                                04750077
047600*---------------------------------------------------------------* 04760004
047700*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04770004
047800*---------------------------------------------------------------* 04780004
047900         10  ASC-SPECIFIC-COMMAREA.                               04790004
048000             15  ASC-OPER-UNT-ID             PIC S9(04)           04800009
048100                                                  COMP.           04810009
048200             15  ASC-FCLTY-ID                PIC S9(04)           04820009
048300                                                  COMP.           04830009
048400             15  ASC-PO-NBR                  PIC  S9(09)          04840025
048500                                                  COMP.           04850025
048600             15  ASC-REC-SEQ-NBR             PIC  S9(09)          04860032
048700                                                  COMP.           04870025
048800             15  ASC-DEST-OPER-UNT-ID        PIC S9(09) COMP.     04880032
048900             15  ASC-PREV-CTN-COUNT          PIC  9(05).          04890025
049000*            15  ASC-STR-UNITS               PIC S9(05) COMP.     04900098
049100             15  ASC-STR-UNITS               PIC  9(05).          04910098
049200             15  ASC-TRLR-NBR                PIC  X(11).          04920004
049300             15  ASC-CREATED-BY              PIC  X(08).          04930038
049400             15  ASC-CREATE-DTE              PIC  X(10).          04940038
049500             15  ASC-CREATE-TME              PIC  X(08).          04950038
049600             15  ASC-SML-PRINTER             PIC  X(08).          04960009
049700             15  ASC-CURRENT-CTN-COUNT       PIC  9(05).          04970017
049800             15  ASC-TOTAL-CART-PO           PIC  9(05).          04980099
049900             15  ASC-ADJUST-CTN-COUNT        PIC  X(05).          04990054
050000             15  ASC-ADJUST-CTN-COUNT-N REDEFINES                 05000054
050100                        ASC-ADJUST-CTN-COUNT PIC  9(05).          05010071
050200             15  ASC-SHP-PRTR-IP-ADDR        PIC  X(15).          05020071
050300             15  FILLER                      PIC  X(124).         05030004
050400*-----------------------------------------------------------------05040004
050500             15  ASC-BLK-SUB                  PIC S9(04) COMP     05050004
050600                                                         SYNC.    05060004
050700             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05070004
050800                                                         SYNC.    05080004
050900             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05090004
051000             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05100004
051100             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05110004
051200             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05120004
051300             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05130004
051400             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05140004
051500                                                         SYNC.    05150004
051600             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05160004
051700             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05170004
051800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05180004
051900                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05190004
052000                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05200004
052100                                                                  05210004
052200             15  ASC-LIST-QUEUE-NAME.                             05220028
052300                 20  ASC-LIST-TERM-ID                PIC  X(04).  05230028
052400                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   05240028
052500                                                          COMP-3. 05250028
052600                 20  ASC-LIST-SEQ                    PIC  9(01).  05260028
052700             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05270004
052800             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05280004
052900             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05290004
053000                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05300004
053100             15  ASC-SEL-QUEUE-NAME.                              05310004
053200                 20  ASC-SEL-TERM-ID          PIC  X(04).         05320004
053300                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05330004
053400                 20  ASC-SEL-SEQ              PIC  9(01).         05340004
053500             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05350004
053600                                                                  05360004
053700     COPY PCWS203.                                                05370064
053800*                                                                 05380004
053900     EJECT                                                        05390004
054000*---------------------------------------------------------------* 05400004
054100*    ABEND PROCESSING COPYBOOK.                                 * 05410004
054200*---------------------------------------------------------------* 05420004
054300                                                                  05430004
054400     COPY DPWS013.                                                05440065
054500                                                                  05450004
054600 EJECT                                                            05460004
054700*---------------------------------------------------------------* 05470004
054800*    SUT_OTBND_UPC -                                              05480099
054900*---------------------------------------------------------------* 05490004
055000     EXEC SQL                                                     05500004
055100          INCLUDE SUT00028                                        05510099
055200     END-EXEC.                                                    05520004
055300*---------------------------------------------------------------* 05530004
055400*    SUT_OTBND_CART                                               05540099
055500*---------------------------------------------------------------* 05550004
055600     EXEC SQL                                                     05560004
055700          INCLUDE SUT00024                                        05570099
055800     END-EXEC.                                                    05580004
055900*---------------------------------------------------------------* 05590004
056000*---------------------------------------------------------------* 05600099
056100*    TLBTKHS                                                      05610099
056200*---------------------------------------------------------------* 05620099
056300     EXEC SQL                                                     05630099
056400          INCLUDE TLBTKHS                                         05640099
056500     END-EXEC.                                                    05650099
056600*---------------------------------------------------------------* 05660099
056700*    DB2 AREA FOR COMMUNICATIONS                                * 05670004
056800*---------------------------------------------------------------* 05680004
056900     EXEC SQL                                                     05690004
057000          INCLUDE SQLCA                                           05700004
057100     END-EXEC.                                                    05710004
057200                                                                  05720004
057300 LINKAGE SECTION.                                                 05730004
057400                                                                  05740004
057500 01  DFHCOMMAREA.                                                 05750004
057600     05  FILLER                         OCCURS  1 TO 4072 TIMES   05760004
057700                                        DEPENDING ON EIBCALEN.    05770004
057800         10  FILLER                     PIC X.                    05780004
057900                                                                  05790004
058000 EJECT                                                            05800004
058100 PROCEDURE DIVISION.                                              05810004
058200******************************************************************05820004
058300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **05830004
058400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **05840004
058500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **05850004
058600******************************************************************05860004
058700 0000-MAIN-MODULE.                                                05870004
058800     INITIALIZE DP030-CICS-API-FIELDS.                            05880004
058900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       05890004
059000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          05900004
059100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         05910004
059200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       05920004
059300     MOVE LENGTH OF PCK711I        TO DP030-MAP-LENGTH (1).       05930005
059400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     05940004
059500     PERFORM 0001-CALL-CICS-ARCH-API.                             05950004
059600*                                                                 05960004
059700     PERFORM 1000-CONTROL-PROCESSING                              05970004
059800*                                                                 05980004
059900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     05990004
060000     PERFORM 0001-CALL-CICS-ARCH-API.                             06000004
060100                                                                  06010004
060200******************************************************************06020004
060300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **06030004
060400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **06040004
060500******************************************************************06050004
060600 0001-CALL-CICS-ARCH-API.                                         06060004
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               06070099
1122RM     CALL DP930-CICS-ARCH-API                                     06071099
1122RM                     USING DFHEIBLK                               06072099
060800                           DFHCOMMAREA                            06080004
060900                           DP030-CICS-API-FIELDS                  06090004
061000                           DP020-STANDARD-COMMAREA                06100004
061100                           PCK711I.                               06110005
061200*                                                                 06120004
061300     IF  DP030-RC-CALL-SUCCESSFUL                                 06130004
061400         CONTINUE                                                 06140004
061500     ELSE                                                         06150004
061600         SET DP013-NO-ROLLBACK                                    06160004
061700             DP013-XCTL-DISPLAY-RESTART                           06170004
061800             DP013-CICS-ABEND      TO TRUE                        06180004
061900         MOVE '0001-CALL-CICS-ARCH-API'                           06190004
062000                                   TO DP013-PARAGRAPH             06200004
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06210099
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06220099
1122rm         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06221099
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06222099
062300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06230004
062400         PERFORM DP013-0000-PROCESS-ABEND                         06240004
062500     END-IF.                                                      06250004
062600*----------------------------------------------------------------*06260004
062700* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06270004
062800* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *06280004
062900*                                                                *06290004
063000* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *06300004
063100*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *06310004
063200*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *06320004
063300*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *06330004
063400*----------------------------------------------------------------*06340004
063500                                                                  06350004
063600 1000-CONTROL-PROCESSING.                                         06360004
063700                                                                  06370004
063800     EVALUATE TRUE                                                06380004
063900         WHEN DP020-NEXT-ACT-INITIAL                              06390004
064000             INITIALIZE ASC-SPECIFIC-COMMAREA                     06400004
064100             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            06410004
064200                                      ASC-SEL-TERM-ID             06420004
064300             MOVE DP020-SRC-TASK-NUMBER                           06430004
064400                                   TO ASC-LIST-TASK-NUMBER        06440004
064500                                      ASC-SEL-TASK-NUMBER         06450004
064600             MOVE PC-LIST-QUEUE-SEQ                               06460004
064700                                   TO ASC-LIST-SEQ                06470004
064800             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 06480004
064900             PERFORM 1100-PROCESS-INTER-APPL-COMM                 06490004
065000***-----$TEMPLATE NOTE$-------------------------------------------06500004
065100*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,06510004
065200*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  06520004
065300*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.06530004
065400***---------------------------------------------------------------06540004
065500             IF  PS-COMMAREA-NOT-VALID                            06550004
065600                 SET DP020-NEXT-ACT-APPL-ERROR                    06560004
065700                                   TO TRUE                        06570004
065800             ELSE                                                 06580004
065900                 PERFORM 4000-BUILD-INITIAL-PANEL                 06590004
066000                 PERFORM 3200-RESET-ATTRIBUTES                    06600035
066100             END-IF                                               06610004
066200                                                                  06620004
066300         WHEN DP020-NEXT-ACT-READ-MAP                             06630004
066400             PERFORM 2000-PROCESS-PANEL                           06640004
066500                                                                  06650004
066600         WHEN DP020-NEXT-ACT-RETURN                               06660004
066700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        06670004
066800                                   TO PV-TOP-ITEM                 06680004
066900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    06690004
067000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06700004
067100                 PERFORM 3000-EDIT-DATA-IN-COMMAREA               06710004
067200                                                                  06720004
067300         WHEN OTHER                                               06730004
067400             SET DP013-LOGIC-ABEND TO TRUE                        06740004
067500             SET DP013-NO-ROLLBACK TO TRUE                        06750004
067600             MOVE '1000-CONTROL-PROCESSING'                       06760004
067700                                   TO DP013-PARAGRAPH             06770004
067800             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    06780004
067900                                   TO DP013-MESSAGE-TEXT(1)       06790004
068000             PERFORM DP013-0000-PROCESS-ABEND                     06800004
068100     END-EVALUATE.                                                06810004
068200                                                                  06820004
068300 EJECT                                                            06830004
068400*----------------------------------------------------------------*06840004
068500* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *06850004
068600* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *06860004
068700*----------------------------------------------------------------*06870004
068800                                                                  06880004
068900 1100-PROCESS-INTER-APPL-COMM.                                    06890006
069000                                                                  06900004
069100     SET PS-COMMAREA-VALID         TO TRUE.                       06910004
069200                                                                  06920004
069300                                                                  06930004
069400     IF  DP020-INT-APPL-FORMAT-IND =  PC-LIST-FORMAT              06940004
069500       IF PC202-NUMBER-OF-SELECTED-ITEMS > 0                      06950006
069600         MOVE PC202-OPER-UNT-ID       TO ASC-OPER-UNT-ID          06960007
069700         MOVE PC202-FCLTY-ID          TO ASC-FCLTY-ID             06970007
069800         MOVE PC202-PO-NBR            TO ASC-PO-NBR               06980006
069900                                         PV-PO-NBR                06990004
070000         MOVE PC202-REC-SEQ-NBR       TO ASC-REC-SEQ-NBR          07000025
070100                                         PV-REC-SEQ-NBR           07010004
070200         MOVE PC202-DEST-OPER-UNT-ID  TO ASC-DEST-OPER-UNT-ID     07020085
070300         MOVE PC202-DEST-STORE-UNITS  TO ASC-STR-UNITS            07030086
070400                                         PV-STR-UNITS             07040097
070500         MOVE PC202-PREV-CTN-COUNT    TO ASC-PREV-CTN-COUNT       07050088
070600         MOVE PC202-SML-PRINTER       TO ASC-SML-PRINTER          07060085
070700         MOVE PC202-SHP-PRTR-IP-ADDR  TO ASC-SHP-PRTR-IP-ADDR     07070071
070800         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    07080004
070900         MOVE PC202-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  07090006
071000         MOVE PC202-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      07100006
071100         PERFORM 1120-PREPARE-LIST-ENTRY                          07110004
071200       ELSE                                                       07120004
071300         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           07130004
071400         SET  PS-COMMAREA-NOT-VALID TO TRUE                       07140004
071500       END-IF                                                     07150004
071600     END-IF.                                                      07160004
071700                                                                  07170004
071800                                                                  07180004
071900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07190004
072000 1120-PREPARE-LIST-ENTRY.                                         07200004
072100                                                                  07210004
072200     MOVE PC203-MAX-ITEMS          TO ASC-SEL-SUB.                07220006
072300     MOVE ZERO                     TO ASC-SEL-ITEM.               07230004
072400     PERFORM 1130-GET-NEXT-RECORD.                                07240004
072500                                                                  07250004
072600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07260004
072700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*07270004
072800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07280004
072900 1130-GET-NEXT-RECORD.                                            07290004
073000                                                                  07300004
073100     ADD +1                       TO ASC-SEL-SUB.                 07310004
073200                                                                  07320004
073300     IF  ASC-SEL-SUB > PC203-MAX-ITEMS                            07330006
073400         ADD +1                   TO ASC-SEL-ITEM                 07340004
073500         MOVE +1                  TO ASC-SEL-SUB                  07350004
073600     END-IF.                                                      07360004
073700                                                                  07370004
073800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                07380004
073900         PERFORM 9100-READ-SEL-QUEUE                              07390004
074000         IF  PC203-ITEM (ASC-SEL-SUB) > ZERO                      07400006
074100                                                                  07410009
074200             MOVE PC203-DEST-OPER-UNT-ID (ASC-SEL-SUB)            07420009
074300                                        TO ASC-DEST-OPER-UNT-ID   07430009
074400             MOVE PC203-DEST-STORE-UNITS (ASC-SEL-SUB)            07440009
074500                                        TO ASC-STR-UNITS          07450009
074600                                           PV-STR-UNITS           07460097
074700             MOVE PC203-PREV-CTN-COUNT (ASC-SEL-SUB)              07470009
074800                                        TO ASC-PREV-CTN-COUNT     07480009
074900             MOVE PC203-TOT-CRTNS-PO (ASC-SEL-SUB)                07490099
075000                                        TO ASC-TOTAL-CART-PO      07500099
075100             SET PC203-INQ (ASC-SEL-SUB)                          07510006
075200                                  TO TRUE                         07520004
075300             SET PC202-UPDATE-TSQ TO TRUE                         07530074
075400             PERFORM 9200-REWRITE-SEL-QUEUE                       07540004
075500         ELSE                                                     07550004
075600             SUBTRACT +1 FROM ASC-SEL-SUB                         07560004
075700             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             07570004
075800             SET DP020-MSG-INFORMATIONAL                          07580004
075900                 PS-LIST-END             TO TRUE                  07590004
076000         END-IF                                                   07600004
076100     ELSE                                                         07610004
076200         SUBTRACT +1 FROM ASC-SEL-ITEM                            07620004
076300         MOVE PC203-MAX-ITEMS     TO ASC-SEL-SUB                  07630006
076400         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             07640004
076500         SET DP020-MSG-INFORMATIONAL                              07650004
076600             PS-LIST-END             TO TRUE                      07660004
076700     END-IF.                                                      07670004
076800                                                                  07680004
076900/                                                                 07690004
077000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07700004
077100*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *07710004
077200*    PROCESSED.                                                  *07720004
077300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*07730004
077400                                                                  07740004
077500 1140-GET-PREV-RECORD.                                            07750004
077600                                                                  07760004
077700     SUBTRACT +1 FROM ASC-SEL-SUB.                                07770004
077800                                                                  07780004
077900     IF  ASC-SEL-SUB < +1                                         07790004
078000         SUBTRACT +1 FROM ASC-SEL-ITEM                            07800004
078100         MOVE PC203-MAX-ITEMS     TO ASC-SEL-SUB                  07810006
078200     END-IF.                                                      07820004
078300                                                                  07830004
078400     IF  ASC-SEL-ITEM > ZERO                                      07840004
078500         PERFORM 9100-READ-SEL-QUEUE                              07850004
078600             MOVE PC203-DEST-OPER-UNT-ID (ASC-SEL-SUB)            07860009
078700                                        TO ASC-DEST-OPER-UNT-ID   07870009
078800             MOVE PC203-DEST-STORE-UNITS (ASC-SEL-SUB)            07880009
078900                                        TO ASC-STR-UNITS          07890009
079000                                           PV-STR-UNITS           07900097
079100             MOVE PC203-PREV-CTN-COUNT (ASC-SEL-SUB)              07910009
079200                                        TO ASC-PREV-CTN-COUNT     07920009
079300         SET PC203-INQ (ASC-SEL-SUB)                              07930006
079400                                  TO TRUE                         07940004
079500         SET PC202-UPDATE-TSQ TO TRUE                             07950074
079600         PERFORM 9200-REWRITE-SEL-QUEUE                           07960004
079700     ELSE                                                         07970004
079800         MOVE +1                  TO ASC-SEL-ITEM                 07980004
079900                                     ASC-SEL-SUB                  07990004
080000         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             08000004
080100         SET DP020-MSG-INFORMATIONAL                              08010004
080200             PS-LIST-END             TO TRUE                      08020004
080300     END-IF.                                                      08030004
080400                                                                  08040004
080500                                                                  08050004
080600                                                                  08060004
080700                                                                  08070004
080800*----------------------------------------------------------------*08080004
080900* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08090004
081000* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08100004
081100* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08110004
081200* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08120004
081300* FUNCTION KEYS CAN GET THIS FAR.                                *08130004
081400*----------------------------------------------------------------*08140004
081500                                                                  08150004
081600 2000-PROCESS-PANEL.                                              08160004
081700     EVALUATE TRUE                                                08170004
081800         WHEN DP020-SRC-AID = DP016-CLEAR                         08180004
081900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08190004
082000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08200004
082100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08210004
082200                                                                  08220004
082300         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08230004
082400             MOVE SPACES TO ASC-ADJUST-CTN-COUNT                  08240060
082500             PERFORM 4000-BUILD-INITIAL-PANEL                     08250058
082600             PERFORM 3200-RESET-ATTRIBUTES                        08260057
082700                                                                  08270004
082800         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             08280004
082900             IF  ASC-USE-SELECTION-QUEUE                          08290004
083000                 PERFORM 1130-GET-NEXT-RECORD                     08300004
083100                 IF PS-LIST-END                                   08310004
083200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08320004
083300                     SET PS-NO-LIST-END TO TRUE                   08330004
083400                 ELSE                                             08340004
083500*                    PERFORM 3200-RESET-ATTRIBUTES                08350013
083600                     MOVE SPACES TO ASC-ADJUST-CTN-COUNT          08360061
083700                     PERFORM 4000-BUILD-INITIAL-PANEL             08370004
083800                 END-IF                                           08380004
083900              ELSE                                                08390004
084000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08400004
084100*                --- BOTTOM OF LIST ---                           08410004
084200                 MOVE PC-TSYMSG-00070                             08420004
084300                                   TO DP020-MSG-NUMBER            08430004
084400                 SET DP020-MSG-INFORMATIONAL                      08440004
084500                                   TO TRUE                        08450004
084600             END-IF                                               08460004
084700                                                                  08470004
084800         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             08480004
084900             IF  ASC-USE-SELECTION-QUEUE                          08490004
085000                 PERFORM 1140-GET-PREV-RECORD                     08500004
085100                 IF PS-LIST-END                                   08510047
085200                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08520047
085300                     SET PS-NO-LIST-END TO TRUE                   08530047
085400                 ELSE                                             08540047
085500                     MOVE SPACES TO ASC-ADJUST-CTN-COUNT          08550061
085600*                    PERFORM 3200-RESET-ATTRIBUTES                08560047
085700                     PERFORM 4000-BUILD-INITIAL-PANEL             08570047
085800             ELSE                                                 08580004
085900                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08590004
086000                 MOVE PC-TSYMSG-00069                             08600004
086100                                   TO DP020-MSG-NUMBER            08610004
086200                 SET DP020-MSG-INFORMATIONAL                      08620004
086300                                   TO TRUE                        08630004
086400             END-IF                                               08640004
086500                                                                  08650004
086600         WHEN OTHER                                               08660004
086700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08670004
086800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08680004
086900                                                                  08690004
087000                                                                  08700004
087100             IF  PS-NO-ERROR                                      08710004
087200                 SET DP030-CONTINUE-GO                            08720004
087300                                 TO TRUE                          08730004
087400                 PERFORM 2100-CHECK-FUNCTION-KEY                  08740004
087500             ELSE                                                 08750004
087600                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             08760004
087700                 SET DP030-OVERRIDE-GO                            08770004
087800                                 TO TRUE                          08780004
087900             END-IF                                               08790004
088000     END-EVALUATE.                                                08800004
088100 EJECT                                                            08810004
088200*----------------------------------------------------------------*08820004
088300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*08830004
088400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *08840004
088500* CICS ARCHITECTURE API.                                         *08850004
088600*----------------------------------------------------------------*08860004
088700 2100-CHECK-FUNCTION-KEY.                                         08870004
088800                                                                  08880004
088900     EVALUATE TRUE                                                08890004
089000*                                                                 08900004
089100*F15 UPD & PRT                                                    08910060
089200         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08920060
089300                 IF ASC-ADJUST-CTN-COUNT > ASC-CURRENT-CTN-COUNT  08930070
089400                  IF ASC-ADJUST-CTN-COUNT > ASC-STR-UNITS         08940098
089500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         08950096
089600                     MOVE PC-TSYMSG-02743  TO DP020-MSG-NUMBER    08960099
089700                     SET DP030-SET-CURSOR-APPL-1   TO TRUE        08970096
089800                     SET DP020-MSG-WARNING                        08980096
089900                                       TO TRUE                    08990096
090000                     MOVE -1           TO AADJUSTL                09000096
090100                     MOVE DP015-REVERSE                           09010096
090200                                       TO AADJUSTH                09020096
090300                     MOVE DP015-RED    TO AADJUSTC                09030096
090400                     MOVE DP015-UNP-NUM-BRT-MDT                   09040096
090500                                       TO AADJUSTA                09050096
090600                  ELSE                                            09060096
090700                    COMPUTE PV-ADDL-LABELS-REQ =                  09070096
090800                       ( ASC-ADJUST-CTN-COUNT-N  -                09080096
090900                         ASC-CURRENT-CTN-COUNT )                  09090096
091000                     PERFORM 7000-CREATE-RANDOM-NBR               09100062
091100                     PERFORM 4630-LINK-TO-LOAD-TABLE              09110080
091200                     IF PS-NO-ERROR                               09120080
091300                        SET DP020-MSG-INFORMATIONAL  TO  TRUE     09130080
091400                        MOVE PC-TSYMSG-02234  TO DP020-MSG-NUMBER 09140080
091500                        ADD PV-ADDL-LABELS-REQ                    09150099
091600                                     TO ASC-CURRENT-CTN-COUNT     09160099
091700                                        ASC-TOTAL-CART-PO         09170099
091800                        PERFORM 9100-READ-SEL-QUEUE               09180099
091900                        MOVE ASC-TOTAL-CART-PO TO                 09190099
092000                               PC203-TOT-CRTNS-PO (ASC-SEL-SUB)   09200099
092100                        MOVE ASC-CURRENT-CTN-COUNT                09210099
092200                             TO PC203-PREV-CTN-COUNT (ASC-SEL-SUB)09220099
092300                        PERFORM 9200-REWRITE-SEL-QUEUE            09230099
092400*                                                                 09240099
092500                     END-IF                                       09250099
092600                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09260083
092700                  END-IF                                          09270096
092800                 ELSE                                             09280004
092900                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         09290004
093000                     MOVE PC-TSYMSG-02685  TO DP020-MSG-NUMBER    09300095
093100                     SET DP030-SET-CURSOR-APPL-1   TO TRUE        09310095
093200                     SET DP020-MSG-WARNING                        09320095
093300                                       TO TRUE                    09330095
093400                     MOVE -1           TO AADJUSTL                09340095
093500                     MOVE DP015-REVERSE                           09350095
093600                                       TO AADJUSTH                09360095
093700                     MOVE DP015-RED    TO AADJUSTC                09370095
093800                     MOVE DP015-UNP-NUM-BRT-MDT                   09380095
093900                                       TO AADJUSTA                09390095
094000                 END-IF                                           09400004
094100*                                                                 09410004
094200* F6 - FIRST PAGE                                                 09420004
094300*                                                                 09430004
094400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09440004
094500             MOVE +1               TO PV-TOP-ITEM                 09450004
094600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09460004
094700*                                                                 09470004
094800* F7 - PREVIOUS PAGE                                              09480004
094900*                                                                 09490004
095000         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   09500004
095100             PERFORM 2110-BROWSE-BACKWARD                         09510004
095200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09520004
095300*                                                                 09530004
095400* ENTER KEY                                                       09540004
095500*                                                                 09550004
095600         WHEN DP020-SRC-AID = DP016-ENTER                         09560004
095700             IF  PS-ERROR                                         09570004
095800                 CONTINUE                                         09580004
095900             ELSE                                                 09590004
096000                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             09600004
096100             END-IF                                               09610004
096200                                                                  09620004
096300         WHEN OTHER                                               09630004
096400             SET DP013-NO-ROLLBACK                                09640004
096500                 DP013-XCTL-DISPLAY-RESTART                       09650004
096600                 DP013-CICS-ABEND  TO TRUE                        09660004
096700             MOVE '2100-CHECK-FUNCTION-KEY'                       09670004
096800                                   TO DP013-PARAGRAPH             09680004
096900             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09690004
097000                                   TO DP013-MESSAGE-TEXT (1)      09700004
097100             PERFORM DP013-0000-PROCESS-ABEND                     09710004
097200     END-EVALUATE.                                                09720004
097300                                                                  09730004
097400                                                                  09740004
097500*----------------------------------------------------------------*09750004
097600*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *09760004
097700*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *09770004
097800*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *09780004
097900*    MESSAGE.                                                    *09790004
098000*----------------------------------------------------------------*09800004
098100                                                                  09810004
098200 2110-BROWSE-BACKWARD.                                            09820004
098300     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    09830004
098400         GIVING PV-TOP-ITEM.                                      09840004
098500*                                                                 09850004
098600     IF  ((PV-TOP-ITEM < +1)                                      09860004
098700       OR (PV-TOP-ITEM = +1))                                     09870004
098800         MOVE +1                   TO PV-TOP-ITEM                 09880004
098900*        -- TOP OF LIST --                                        09890004
099000         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            09900004
099100         SET DP020-MSG-INFORMATIONAL TO TRUE                      09910004
099200     END-IF.                                                      09920004
099300                                                                  09930004
099400 EJECT                                                            09940004
099500******************************************************************09950004
099600** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **09960004
099700** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **09970004
099800******************************************************************09980004
099900 2200-MOVE-SCREEN-TO-COMMAREA.                                    09990004
100000                                                                  10000004
100100     IF  AADJUSTL > ZERO                                          10010011
100200         MOVE AADJUSTI         TO ASC-ADJUST-CTN-COUNT            10020011
100300     ELSE                                                         10030004
100400         IF  AADJUSTF = DP015-ERASE-EOF                           10040011
100500             MOVE ZERO TO ASC-ADJUST-CTN-COUNT                    10050011
100600         END-IF                                                   10060004
100700     END-IF.                                                      10070004
100800                                                                  10080004
100900                                                                  10090004
101000******************************************************************10100004
101100** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **10110004
101200** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **10120004
101300******************************************************************10130004
101400 3000-EDIT-DATA-IN-COMMAREA.                                      10140004
101500     PERFORM 3200-RESET-ATTRIBUTES.                               10150030
101600*-----------------------------------------------------------------10160051
101700* VERIFY THAT ADJUST CTN COUNT ENTERED IS  NUMERIC                10170051
101800*-----------------------------------------------------------------10180051
101900     IF  PS-NO-ERROR                                              10190051
102000         IF  ASC-ADJUST-CTN-COUNT > SPACES                        10200051
102100             MOVE ASC-ADJUST-CTN-COUNT TO DP010I-UNEDITED-FIELD   10210051
102200             MOVE LENGTH OF ASC-ADJUST-CTN-COUNT                  10220051
102300                                       TO DP010I-MAXIMUM-DIGITS   10230051
102400             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 10240051
102500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              10250051
102610             CALL DP010I-NUMERIC-EDIT-ROUTINE                     10261099
102620                         USING DP010I-NUMERIC-EDIT-AREA           10262099
102700             IF  DP010I-ERROR-DETECTED                            10270051
102800                     SET PS-ERROR                                 10280052
102900                         DP020-MSG-FATAL       TO TRUE            10290052
103000                 MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER    10300052
103100                 MOVE DP015-UNP-ALP-BRT-OFF                       10310052
103200                                           TO AADJUSTA            10320052
103300                 MOVE DP015-RED            TO AADJUSTC            10330052
103400                 MOVE DP015-REVERSE        TO AADJUSTH            10340052
103500                 MOVE -1                   TO AADJUSTL            10350052
103600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              10360052
103700             ELSE                                                 10370051
103800                 MOVE DP010I-NUMERIC-FIELD                        10380051
103900                                       TO ASC-ADJUST-CTN-COUNT-N  10390055
104000                                          AADJUSTO                10400051
104100             END-IF                                               10410051
104200         ELSE                                                     10420051
104300             SET PS-ERROR                                         10430051
104400                 DP020-MSG-FATAL       TO TRUE                    10440051
104500             MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER        10450051
104600             MOVE DP015-UNP-ALP-BRT-OFF                           10460051
104700                                       TO AADJUSTA                10470051
104800             MOVE DP015-RED            TO AADJUSTC                10480051
104900             MOVE DP015-REVERSE        TO AADJUSTH                10490051
105000             MOVE -1                   TO AADJUSTL                10500051
105100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  10510051
105200         END-IF                                                   10520051
105300     END-IF.                                                      10530051
105400                                                                  10540004
105500                                                                  10550004
105600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10560027
105700*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.       10570027
105800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*10580027
105900 3200-RESET-ATTRIBUTES.                                           10590027
106000     MOVE DP015-UNP-ALP-NOR-OFF    TO AADJUSTA.                   10600027
106100     MOVE DP015-UNP-NUM-NOR-OFF    TO AADJUSTA.                   10610027
106200     MOVE DP015-GREEN              TO AADJUSTC.                   10620027
106300     MOVE DP015-UNDERLINE          TO AADJUSTH.                   10630027
106400                                                                  10640027
106500                                                                  10650004
106600*----------------------------------------------------------------*10660004
106700*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *10670004
106800*    INITIALIZE ALL COUNTERS AND FLAGS.                          *10680004
106900*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *10690004
107000*    DISPLAY THE PANEL TO USER.                                  *10700004
107100*----------------------------------------------------------------*10710004
107200                                                                  10720004
107300 4000-BUILD-INITIAL-PANEL.                                        10730004
107400                                                                  10740004
107500                                                                  10750004
107600     MOVE +0                 TO ASC-ITEM-SUB                      10760004
107700                                ASC-NUMBER-OF-ITEMS-READ          10770004
107800                                ASC-NUMBER-OF-SELECTED-ITEMS.     10780031
107900                                                                  10790004
108000                                                                  10800004
108100                                                                  10810004
108200     PERFORM 4100-PREPARE-CURSOR.                                 10820037
108300     PERFORM 4350-GET-USER-TIME.                                  10830037
108400     PERFORM 4500-CURRENT-CRTN-COUNT.                             10840048
108500          MOVE PV-DB2-COUNT-ACTV  TO ASC-CURRENT-CTN-COUNT        10850048
108600*    IF PS-NO-ERROR                                               10860048
108700          MOVE SUT00024-CRE-USR-ID TO ASC-CREATED-BY              10870099
108800*                                                                 10880048
108900          MOVE SUT00024-CRE-DTE   TO PV-REFORMAT-DATE             10890099
109000          MOVE PV-REFORMAT-YYYY   TO PV-FORMAT-YYYY               10900048
109100          MOVE PV-REFORMAT-MM     TO PV-FORMAT-MM                 10910048
109200          MOVE PV-REFORMAT-DD     TO PV-FORMAT-DD                 10920048
109300          MOVE PV-FORMAT-DATE     TO ASC-CREATE-DTE               10930038
109400*                                                                 10940038
109500          MOVE SUT00024-CRE-TM    TO PV-FORMAT-TIME               10950099
109600          MOVE PV-FORMAT-TIME     TO ASC-CREATE-TME               10960038
109700                                                                  10970038
109800     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        10980056
109900     MOVE -1                   TO AADJUSTL.                       10990036
110000     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        11000056
110100                                                                  11010004
110200 EJECT                                                            11020004
110300*----------------------------------------------------------------*11030004
110400*    SET UP THE HOST VARIABLES.                                  *11040004
110500*----------------------------------------------------------------*11050004
110600                                                                  11060004
110700 4100-PREPARE-CURSOR.                                             11070004
110800                                                                  11080004
110900     MOVE  ASC-PO-NBR           TO  DK-PO-NBR.                    11090026
111000     MOVE  ASC-REC-SEQ-NBR      TO  DK-REC-SEQ-NBR                11100049
111100                                    DK-RECEIVER.                  11110049
111200     MOVE  ASC-DEST-OPER-UNT-ID TO  DK-STR-NBR.                   11120031
111300                                                                  11130004
111400                                                                  11140004
111500*----------------------------------------------------------------*11150031
111600* GET TIMESTAMP AND USER ID                                      *11160031
111700*----------------------------------------------------------------*11170031
111800 4350-GET-USER-TIME.                                              11180031
111900                                                                  11190031
112000                                                                  11200031
112100     EXEC SQL                                                     11210031
112200         SELECT  CRE_DTE                                          11220031
112300               , CRE_TM                                           11230031
112400               , CRE_USR_ID                                       11240031
112500           INTO  :SUT00024-CRE-DTE                                11250099
112600               , :SUT00024-CRE-TM                                 11260099
112700               , :SUT00024-CRE-USR-ID                             11270099
112800           FROM  SUT_OTBND_UPC A,                                 11280099
112900                 SUT_OTBND_CART B                                 11290099
113000            WHERE A.TRN_NBR           =  :DK-PO-NBR               11300031
113100             AND   A.RCVR_SEQ_NBR     =  :DK-REC-SEQ-NBR          11310031
113200             AND   A.SHIPT_UNT_ID     =   B.SHIPT_UNT_ID          11320031
113300             AND   B.DEST_LOC_NBR     =  :DK-STR-NBR              11330099
113400             AND   B.ACTV_IND         =  'Y'                      11340099
113500     END-EXEC                                                     11350031
113600                                                                  11360031
113700     EVALUATE TRUE                                                11370031
113800         WHEN SQLCODE = +0                                        11380031
113900         WHEN SQLCODE = -811                                      11390033
114000              CONTINUE                                            11400031
114100         WHEN OTHER                                               11410031
114200              MOVE '4350-GET-USER-TIME'                           11420031
114300                               TO DP013-PARAGRAPH                 11430031
114400              MOVE 'GET VENDOR NAME     '                         11440031
114500                               TO DP013-MESSAGE-TEXT (1)          11450031
114600              MOVE SQLCA       TO DP013-SQLCA                     11460031
114700              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        11470031
114800              SET DP013-DB2-ABEND                                 11480031
114900                  DP013-XCTL-DISPLAY-RESTART                      11490031
115000                                   TO TRUE                        11500031
115100                  PERFORM DP013-0000-PROCESS-ABEND                11510031
115200     END-EVALUATE.                                                11520031
115300                                                                  11530031
115400*                                                                 11540004
115500*                                                                 11550004
115600*                                                                 11560004
115700                                                                  11570004
115800 4400-MOVE-COMMAREA-TO-SCREEN.                                    11580004
115900                                                                  11590004
116000     MOVE ASC-OPER-UNT-ID            TO AOPERO.                   11600038
116100     MOVE ASC-FCLTY-ID               TO AFCLTYO.                  11610013
116200     MOVE ASC-CREATED-BY             TO ACREBYO.                  11620013
116300     MOVE ASC-PO-NBR                 TO APONBRO.                  11630013
116400     MOVE ASC-REC-SEQ-NBR            TO ARECVRO.                  11640026
116500     MOVE ASC-CREATE-DTE             TO ACREDTEO.                 11650013
116600     MOVE ASC-DEST-OPER-UNT-ID       TO ASTRNBRO.                 11660013
116700     MOVE ASC-CREATE-TME             TO ACRETMEO.                 11670013
116800     MOVE ASC-STR-UNITS              TO AUNITSO.                  11680013
116900     MOVE ASC-CURRENT-CTN-COUNT      TO ACCTNSO.                  11690013
117000     MOVE ASC-PREV-CTN-COUNT         TO APCTNSO.                  11700013
117100     MOVE ASC-ADJUST-CTN-COUNT       TO AADJUSTO.                 11710013
117200     MOVE ASC-SML-PRINTER            TO APRTRO.                   11720013
117300*                                                                 11730004
117400     IF  DP020-MSG-NUMBER-X = SPACE                               11740004
117500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  11750004
117600*            --- MORE ITEMS TO DISPLAY ----                       11760004
117700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            11770004
117800             SET DP020-MSG-INFORMATIONAL TO TRUE                  11780004
117900         END-IF                                                   11790004
118000     END-IF.                                                      11800004
118100 4500-CURRENT-CRTN-COUNT.                                         11810048
118200     INITIALIZE PV-DB2-COUNT-ACTV.                                11820048
118300                                                                  11830048
118400     PERFORM                                                      11840048
118500         WITH TEST AFTER                                          11850048
118600         VARYING PV-RETRY-COUNTER                                 11860048
118700         FROM 1 BY 1                                              11870048
118800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11880048
118900             OR (SQLCODE = +0)                                    11890048
119000             OR (SQLCODE = +100))                                 11900048
119100                                                                  11910048
119200     EXEC SQL                                                     11920048
119300         SELECT COUNT(DISTINCT(A.SHIPT_UNT_ID))                   11930048
119400           INTO :PV-DB2-COUNT-ACTV                                11940048
119500           FROM SUT_OTBND_UPC A                                   11950099
119600              , SUT_OTBND_CART B                                  11960099
119700           WHERE A.TRN_NBR          = :DK-PO-NBR                  11970048
119800            AND  A.RCVR_SEQ_NBR     = :DK-RECEIVER                11980048
119900            AND  A.SHIPT_UNT_ID     =  B.SHIPT_UNT_ID             11990048
120000            AND  B.DEST_LOC_NBR     =  :DK-STR-NBR                12000099
120100            AND  B.CART_SRC_CDE     =  'SMO'                      12010099
120200            AND  B.ACTV_IND         =  'Y'                        12020099
120300            AND  B.CRE_PGM_NM       = 'PCKCS728'                  12030048
120400     END-EXEC                                                     12040048
120500                                                                  12050048
120600         EVALUATE TRUE                                            12060048
120700             WHEN SQLCODE = +0                                    12070048
120800                  CONTINUE                                        12080048
120900             WHEN SQLCODE = -904                                  12090048
121000             WHEN SQLCODE = -913                                  12100048
121100                  CONTINUE                                        12110048
121200             WHEN SQLWARN0 NOT = +0                               12120048
121300             WHEN SQLCODE < +0                                    12130048
121400             WHEN SQLCODE > +0                                    12140048
121500                  MOVE '4500-CURRENT-CRTN-COUNT'                  12150087
121600                                  TO DP013-PARAGRAPH              12160048
121700                  MOVE 'UNSUCCESSFUL SELECT ON UPC TABLE'         12170099
121800                                  TO DP013-MESSAGE-TEXT (1)       12180048
121900                  MOVE SQLCA      TO DP013-SQLCA                  12190048
122000                  MOVE 'SUT00028' TO DP013-DB2-TABLE-NAME (1)     12200099
122100                  SET DP013-DB2-ABEND                             12210048
122200                      DP013-XCTL-DISPLAY-RESTART                  12220048
122300                                  TO TRUE                         12230048
122400              PERFORM DP013-0000-PROCESS-ABEND                    12240048
122500         END-EVALUATE                                             12250048
122600     END-PERFORM.                                                 12260048
122700                                                                  12270048
122800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        12280048
122900         MOVE '4500-CURRENT-CRTN-COUNT '                          12290087
123000                                  TO DP013-PARAGRAPH              12300048
123100         MOVE 'MAX RETRIES EXCEEDED ON SELECT UPC TABLE'          12310099
123200                                  TO DP013-MESSAGE-TEXT (1)       12320048
123300         MOVE SQLCA               TO DP013-SQLCA                  12330048
123400         MOVE 'SUT00028'          TO DP013-DB2-TABLE-NAME (1)     12340099
123500         SET DP013-DB2-ABEND                                      12350048
123600             DP013-XCTL-DISPLAY-RESTART                           12360048
123700                                  TO TRUE                         12370048
123800         PERFORM DP013-0000-PROCESS-ABEND                         12380048
123900     END-IF.                                                      12390048
124000                                                                  12400048
124100                                                                  12410048
124200*----------------------------------------------------------------*12420066
124300 4630-LINK-TO-LOAD-TABLE.                                         12430066
124400*----------------------------------------------------------------*12440066
124500                                                                  12450066
124600                                                                  12460066
124700     INITIALIZE PC204-INTER-APPL-COMMAREA.                        12470076
124800                                                                  12480066
124900     SET PC204-RESMOOTH-CRTNS-ADD TO TRUE.                        12490075
125000                                                                  12500066
125100     MOVE PV-RANDOM-NBR-R         TO PC204-SMTHG-PRC-ID           12510066
125200     MOVE ASC-OPER-UNT-ID         TO PC204-OPER-UNT-ID.           12520066
125300     MOVE ASC-FCLTY-ID            TO PC204-FCLTY-ID.              12530066
125400     MOVE ASC-PO-NBR              TO PC204-PO-NBR.                12540066
125500     MOVE ASC-REC-SEQ-NBR         TO PC204-REC-SEQ-NBR.           12550066
125600     MOVE ASC-SML-PRINTER         TO PC204-SML-PRINTER.           12560072
125700                                                                  12570066
125800     MOVE ASC-DEST-OPER-UNT-ID     TO                             12580066
125900                                   PC204-STR-NBR                  12590066
126000     MOVE ASC-ADJUST-CTN-COUNT    TO                              12600066
126100                                   PC204-LABELS-NEEDED            12610066
126200                                   PC204-TOT-LABELS-CNT           12620084
126300     MOVE PV-ADDL-LABELS-REQ      TO                              12630069
126400                                   PC204-ADDL-LABELS-REQ          12640069
126500     MOVE ASC-SHP-PRTR-IP-ADDR    TO                              12650071
126600                                   PC204-SHP-PRTR-IP-ADDR         12660071
126700     MOVE LENGTH OF PC204-INTER-APPL-COMMAREA                     12670076
126800                                        TO PV-COMMAREA-LENGTH.    12680076
126900                                                                  12690066
127000     EXEC CICS                                                    12700066
127100         LINK                                                     12710066
127200             PROGRAM   (PC-PRINT-PROGRAM)                         12720066
127300             COMMAREA  (PC204-INTER-APPL-COMMAREA)                12730076
127400             LENGTH    (PV-COMMAREA-LENGTH)                       12740066
127500             RESP      (PV-CICS-RESP)                             12750066
127600     END-EXEC.                                                    12760066
127700                                                                  12770066
127800     EVALUATE TRUE                                                12780066
127900         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     12790066
128000              CONTINUE                                            12800066
128100              IF PC204-SUCCESSFUL-REQ                             12810080
128200                  CONTINUE                                        12820080
128300              ELSE                                                12830080
128400                  IF PC204-SQL-ERROR                              12840080
128500                     SET DP020-MSG-INFORMATIONAL  TO  TRUE        12850082
128600                     MOVE PC-TSYMSG-02694  TO DP020-MSG-NUMBER    12860080
128700                     SET PS-ERROR TO TRUE                         12870080
128800                  ELSE                                            12880080
128900                     MOVE PC-TSYMSG-02693  TO DP020-MSG-NUMBER    12890080
129000                     SET DP020-MSG-INFORMATIONAL  TO  TRUE        12900082
129100                     SET PS-ERROR TO TRUE                         12910080
129200                  END-IF                                          12920080
129300              END-IF                                              12930080
129400*-2693 COMMUNICATION-ERROR--*                                     12940080
129500*-2694  DATABASE ERROR------*                                     12950080
129600         WHEN OTHER                                               12960066
129700              MOVE PC-TSYMSG-02693  TO DP020-MSG-NUMBER           12970080
129800              PERFORM DP013-0000-PROCESS-ABEND                    12980066
129900     END-EVALUATE.                                                12990066
130000                                                                  13000066
130100*----------------------------------------------------------------*13010004
130200* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *13020004
130300* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *13030004
130400* FOR THE SELECTED ITEMS QUEUE.                                  *13040004
130500*                                                                *13050004
130600* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *13060004
130700* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *13070004
130800* THE ARRAY IS FULL.                                             *13080004
130900*----------------------------------------------------------------*13090004
131000                                                                  13100004
131100 5000-PREPARE-SEL-QUEUE.                                          13110004
131200                                                                  13120004
131300                                                                  13130004
131400     MOVE ASC-SEL-QUEUE-NAME   TO  PC202-SEL-QUEUE-NAME.          13140006
131500                                                                  13150004
131600                                                                  13160004
131700                                                                  13170004
131800 EJECT                                                            13180004
131900*-----------------------------------------------------------------13190062
132000 7000-CREATE-RANDOM-NBR.                                          13200062
132100*-----------------------------------------------------------------13210062
132200     INITIALIZE PV-RANDOM-NBR-R.                                  13220062
132300     CALL PC-RANDOM-PGM USING DFHEIBLK                            13230062
132400                              DFHCOMMAREA                         13240062
132500                              DP902-RANDNBR-ROUTINE-FIELDS.       13250062
132600                                                                  13260062
132700     IF DP902-SUCCESSFUL                                          13270062
132800         MOVE DP902-RANDOM-NUMBER    TO PV-RANDOM-NUMBER          13280062
132900         MOVE PV-RANDOM-1-8          TO PV-RANDOM-NBR-R           13290062
133000         SET  PS-TRANS-ID-DUP        TO TRUE                      13300099
133100         PERFORM 7250-NOT-DUP-RNDM                                13310099
133200                 UNTIL PS-TRANS-ID-NOT-DUP                        13320099
133300                                                                  13330062
133400     ELSE                                                         13340062
133500         SET DP013-CICS-ABEND  TO  TRUE                           13350062
133600         SET DP013-NO-ROLLBACK TO  TRUE                           13360062
133700         MOVE '7000-CREATE-RANDOM-NBR'                            13370062
133800                               TO  DP013-PARAGRAPH                13380062
133900         MOVE 'ATTEMPTING TO CREATE RANDM NUMBR'                  13390062
134000                               TO  DP013-MESSAGE-TEXT(1)          13400062
134100         PERFORM DP013-0000-PROCESS-ABEND                         13410062
134200     END-IF.                                                      13420062
134300*----------------------------------------------------------------*13430099
134400*  CHECK TO SEE IF RANDOM NUMBER ALREADY EXISTS                   13440099
134500*----------------------------------------------------------------*13450099
134600 7250-NOT-DUP-RNDM.                                               13460099
134700                                                                  13470099
134800     MOVE PV-RANDOM-NBR-R   TO  DK-RANDOM-NBR.                    13480099
134900                                                                  13490099
135000     EXEC SQL                                                     13500099
135100          SELECT LBL_REQ_TRN_ID                                   13510099
135200          INTO  :LBTKHS-LBL-REQ-TRN-ID                            13520099
135300          FROM   TLBTKHS                                          13530099
135400          WHERE  LBL_REQ_TRN_ID  = :DK-RANDOM-NBR                 13540099
135500     END-EXEC.                                                    13550099
135600                                                                  13560099
135700     EVALUATE TRUE                                                13570099
135800         WHEN SQLCODE = ZERO                                      13580099
135900              ADD  1  TO  PV-RANDOM-NBR-R                         13590099
136000              SET  PS-TRANS-ID-DUP    TO  TRUE                    13600099
136100                                                                  13610099
136200         WHEN SQLCODE = +100                                      13620099
136300             SET PS-TRANS-ID-NOT-DUP  TO  TRUE                    13630099
136400                                                                  13640099
136500         WHEN OTHER                                               13650099
136600              MOVE '7250-NOT-DUP-RNDM   '                         13660099
136700                               TO DP013-PARAGRAPH                 13670099
136800              MOVE 'CHECK FOR DUPLICATE '                         13680099
136900                               TO DP013-MESSAGE-TEXT (1)          13690099
137000              MOVE SQLCA       TO DP013-SQLCA                     13700099
137100              SET DP013-DB2-ABEND                                 13710099
137200                               TO TRUE                            13720099
137300              PERFORM DP013-0000-PROCESS-ABEND                    13730099
137400                                                                  13740099
137500     END-EVALUATE.                                                13750099
137600                                                                  13760099
137700*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 13770004
137800* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *13780004
137900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 13790004
138000 9100-READ-SEL-QUEUE.                                             13800004
138100     EXEC CICS                                                    13810004
138200         READQ TS                                                 13820004
138300             QUEUE (ASC-SEL-QUEUE-NAME)                           13830004
138400             INTO  (PC203-DC-SELECT-RECORD)                       13840006
138500             ITEM  (ASC-SEL-ITEM)                                 13850004
138600             RESP  (PV-CICS-RESP)                                 13860004
138700     END-EXEC.                                                    13870004
138800     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL) OR                     13880099
138900        (PV-CICS-RESP = DFHRESP(QIDERR))                          13890099
139000         CONTINUE                                                 13900004
139100     ELSE                                                         13910004
139200         SET DP013-LOGIC-ABEND                                    13920004
139300             DP013-NO-ROLLBACK   TO   TRUE                        13930004
139400         MOVE '9100-READ-SEL-QUEUE'                               13940004
139500                                 TO   DP013-PARAGRAPH             13950004
139600         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   13960004
139700                                 TO   DP013-MESSAGE-TEXT (1)      13970004
139800         PERFORM DP013-0000-PROCESS-ABEND                         13980004
139900     END-IF.                                                      13990004
140000                                                                  14000004
140100                                                                  14010004
140200*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*14020004
140300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *14030004
140400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 14040004
140500 9200-REWRITE-SEL-QUEUE.                                          14050004
140600                                                                  14060004
140700     EXEC CICS                                                    14070004
140800          WRITEQ TS                                               14080004
140900              QUEUE  (ASC-SEL-QUEUE-NAME)                         14090004
141000              FROM   (PC203-DC-SELECT-RECORD)                     14100006
141100              ITEM   (ASC-SEL-ITEM)                               14110004
141200              RESP   (PV-CICS-RESP)                               14120004
141300              REWRITE                                             14130004
141400     END-EXEC.                                                    14140004
141500                                                                  14150004
141600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL) OR                    14160099
141700        (PV-CICS-RESP = DFHRESP(QIDERR))                          14170099
141800           CONTINUE                                               14180099
141900     ELSE                                                         14190099
142000         SET DP013-CICS-ABEND                                     14200004
142100             DP013-NO-ROLLBACK     TO TRUE                        14210004
142200         MOVE '9200-REWRITE-SEL-QUEUE'                            14220004
142300                                   TO DP013-PARAGRAPH             14230004
142400         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   14240004
142500                                   TO DP013-MESSAGE-TEXT (1)      14250004
142600         PERFORM DP013-0000-PROCESS-ABEND                         14260004
142700     END-IF.                                                      14270004
142800                                                                  14280004
142900                                                                  14290004
143000*----------------------------------------------------------------*14300004
143100*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *14310004
143200*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *14320004
143300*----------------------------------------------------------------*14330004
143400 9900-SOFT-ABORT.                                                 14340004
143500                                                                  14350004
143600     EXEC CICS SYNCPOINT                                          14360004
143700          ROLLBACK                                                14370004
143800     END-EXEC.                                                    14380004
143900                                                                  14390004
144000     SET  PS-ERROR                                                14400004
144100          PS-SOFT-ABORT-ERROR                                     14410004
144200          DP020-MSG-FATAL       TO  TRUE.                         14420004
144300                                                                  14430004
144400                                                                  14440004
144500*----------------------------------------------------------------*14450004
144600*    ABEND PROCESSOR MODULE                                      *14460004
144700*----------------------------------------------------------------*14470004
144800                                                                  14480004
144900     COPY DPPD013.                                                14490004
