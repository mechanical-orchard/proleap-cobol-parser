000100 IDENTIFICATION DIVISION.                                         00010020
000200 PROGRAM-ID.    RCKCS287.                                         00020020
000300 AUTHOR.        MICHAEL WALTERS                                   00030020
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040020
000500 DATE-WRITTEN.  09-24-96                                          00050020
000600 DATE-COMPILED.                                                   00060020
000700******************************************************************00070020
000800*    E287 - PRE-TICKET REQUEST SELECTION LIST                     00080020
000900*                                                                 00090020
001000******************************************************************00100020
001100*** NOTE: THIS PROGRAM IS A COPY OF RCKCS254.  IT HAS BEEN        00110020
001200*    MODIFIED TO DISPLAY SCREEN INFO FROM A PRETICKET REQUEST.    00120020
001300*    THE SIZE, COLOR, AND VENDOR STYLE HAS ALSO BEEN CHANGED TO BE00130020
001400*    RETRIEVED FROM THE SKU FILE ... NO OTHER LOGIC HAS CHANGED.  00140042
001500*    WHEN CHANGING THIS PROGRAM, ALSO CHECK RCKCS254 TO DETERMINE 00150042
001600*    IF THE SAME CHANGES MUST BE MADE TO IT.                      00160042
001800******************************************************************00180020
001900*                                                                 00190020
002000*    THE USER CAN SELECT LINES TO PRINT TICKETS.                  00200020
002100*                                                                 00210020
002200******************************************************************00220020
002201* CHANGE HISTORY                                                 *00220169
002202*     MADE BY: PRITHIVIRAJ SUBRAMANIAN (COGNIZANT)               *00220265
002203*     DATE:    10/17/2014                                        *00220375
002204*                                                                *00220475
002205*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00220575
002206*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *PS 10/17/2014     *00220675
002210******************************************************************00221065
002220* CHANGE HISTORY                                                 *00222076
002230*     MADE BY: BARB SCHULTZ        CHG0273427                    *00223077
002240*     DATE:    08/15/2022                                        *00224077
002250*                                                                *00225077
002260* CHANGED CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE   *00226077
002270* MAKING THE CALL DYNAMIC VS STATIC.                             *00227077
002280******************************************************************00228073
002300 ENVIRONMENT DIVISION.                                            00230020
002400 DATA DIVISION.                                                   00240020
002500 WORKING-STORAGE SECTION.                                         00250020
002600                                                                  00260020
002700 01  PC-PROGRAM-CONSTANTS.                                        00270020
002800     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC287A  '. 00280020
002900     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM287 '. 00290020
003000     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS287'. 00300020
003200     05  PC-PO-PRINT-TRANID           PIC X(4)  VALUE 'V515'.     00320020
003300     05  PC-TEST-PRINTER              PIC X(5)  VALUE 'U4086'.    00330020
003400     05  PC-TKT-PRINTER               PIC X(5)  VALUE 'U4042'.    00340070
003500     05  PC-MAX-EXTRA-TICKET-PERCENT  PIC 9(4)  VALUE 200.        00350020
003600     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00360020
003700     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00370020
003800     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +5          00380030
003900                                                COMP SYNC.        00390020
004000     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00400020
004100                                                COMP SYNC.        00410020
004200     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00420020
004300                                                COMP SYNC.        00430020
004400     05  PC-MAX-RETRIES               PIC S9(4) VALUE +3          00440020
004500                                                COMP SYNC.        00450020
004600     05  PC-MAX-PC-TICKET-QUANTITY    PIC  9(05)  VALUE 99999.    00460020
005210     05  PC-UPC                       PIC X(03) VALUE 'UPC'.      00521024
005400     05  PC-HHP                       PIC X(03) VALUE 'HHP'.      00540020
005500     05  PC-HP                        PIC X(03) VALUE 'HP '.      00550020
005600     05  PC-PRINT                     PIC X(03) VALUE 'P  '.      00560020
005700     05  PC-SLASH                     PIC X(01) VALUE '/'.        00570020
005710     05  PC-SPACE                     PIC X(01) VALUE ' '.        00571028
006000     05  PC-PUT                       PIC  X(03)  VALUE 'PUT'.    00600020
006100     05  PC-INIT                      PIC  X(04)  VALUE 'INIT'.   00610020
006200     05  PC-TERM                      PIC  X(04)  VALUE 'TERM'.   00620020
006500     05  PC-GIFT-WITH-PURCHASE        PIC X(03) VALUE '999'.      00650020
006800     05  PC-ALL-ZERO-UPC-CODE         PIC 9(13) VALUE ZEROS.      00680047
006900     05  PC-Y                         PIC X(01) VALUE 'Y'.        00690020
007000     05  PC-SIX                       PIC  9(01)  VALUE 6.        00700020
007100**DH 05  PC-FALL                      PIC  X(01)  VALUE 'F'.      00710045
007200**DH 05  PC-SPRING                    PIC  X(01)  VALUE 'S'.      00720045
007700     05  PC-MULT-SPECIAL-INSTRS-MSG      PIC  X(50)  VALUE        00770020
007800         'MULT SPECIAL INSTRUCTIONS EXIST, SEE ONLINE SYSTEM'.    00780020
007900     05  PC-INTER-APPL-CODES.                                     00790020
008000         10  PC-INTER-APPL-PTICK-QUEUE  PIC  X(04)  VALUE '1'.    00800020
008100                                                                  00810020
008200     05  PC-TSYMSG-NUMBERS.                                       00820020
008300         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00830020
008400*            INVALID VALUE                                        00840020
008500         10  PC-TSYMSG-00007          PIC 9(5)  VALUE 00007.      00850020
008600*            REQUIRED ENTRY                                       00860020
008700         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00870020
008800*            MUST BE NUMERIC                                      00880020
008900         10  PC-TSYMSG-00034          PIC 9(5)  VALUE 00034.      00890020
009000*            ADD(S) SUCCESSFUL                                    00900020
009100         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00910020
009200*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00920020
009300         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00930020
009400*            NO END OF RANGE HAS BEEN SPECIFIED                   00940020
009500         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00950020
009600*            END OF RANGE PRECEDES START OF RANGE                 00960020
009700         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00970020
009800*            NO START OF RANGE HAS BEEN SPECIFIED                 00980020
009900         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00990020
010000*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   01000020
010100         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      01010020
010200*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     01020020
010300         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      01030020
010400*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       01040020
010500         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      01050020
010600*            TOP OF LIST                                          01060020
010700         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      01070020
010800*            BOTTOM OF LIST                                       01080020
010900         10  PC-TSYMSG-00083          PIC 9(5)  VALUE 00083.      01090020
011000*            PURCHASE ORDER DOES NOT EXIST                        01100020
011100         10  PC-TSYMSG-00098          PIC 9(5)  VALUE 00098.      01110020
011200*            PRINT REQUEST HAS BEEN SUBMITTED                     01120020
011300         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      01130020
011400*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      01140020
011500         10  PC-TSYMSG-00117          PIC 9(05)  VALUE 00117.     01150020
011600*            CANNOT ADD - RECORD ALREADY EXISTS                   01160020
011700         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01170020
011800*            MORE ITEMS TO DISPLAY                                01180020
011900         10  PC-TSYMSG-00948          PIC 9(5)  VALUE 00948.      01190020
012000*            INVALID TICKET FORMAT                                01200020
012100         10  PC-TSYMSG-01419          PIC 9(5)  VALUE 01419.      01210020
012200         10  PC-TSYMSG-01464          PIC 9(5)  VALUE 01464.      01220020
012210         10  PC-TSYMSG-03037          PIC 9(5)  VALUE 03037.      01221047
012220*            TICKETS NOT CREATED FOR THE LINE(S) WITH NO UPC FOUND01222047
012300                                                                  01230020
012400 01  PS-PROGRAM-SWITCHES.                                         01240020
012500     05  PS-TD-ERROR-IND              PIC  X    VALUE 'N'.        01250020
012600         88  PS-NO-TD-ERROR                     VALUE 'N'.        01260020
012700         88  PS-TD-ERROR                        VALUE 'Y'.        01270020
013100     05  PS-SPECIAL-INSTRS-IND        PIC  X    VALUE SPACE.      01310020
013200         88  PS-NO-SPECIAL-INSTRS-FOUND         VALUE 'N'.        01320020
013300         88  PS-MULT-SPECIAL-INSTRS-FOUND       VALUE 'Y'.        01330020
013400     05  PS-INVALID-TICKET-FORMAT-IND PIC  X    VALUE 'N'.        01340020
013500         88  PS-INVALID-TICKET-FORMAT           VALUE 'Y'.        01350020
013600         88  PS-VALID-TICKET-FORMAT             VALUE 'N'.        01360020
013900     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01390020
014000         88  PS-NO-ERROR                        VALUE 'N'.        01400020
014100         88  PS-ERROR                           VALUE 'Y'.        01410020
014200     05  PS-PKITEM-SW                 PIC  X    VALUE 'N'.        01420020
014300         88  PS-PKITEM-NOT-FOUND                VALUE 'N'.        01430020
014400         88  PS-PKITEM-FOUND                    VALUE 'Y'.        01440020
014500     05  PS-PO-FOUND-SW               PIC  X    VALUE 'N'.        01450020
014600         88  PS-PO-FOUND                        VALUE 'Y'.        01460020
014700         88  PS-PO-NOT-FOUND                    VALUE 'N'.        01470020
014800     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01480020
014900         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01490020
015000         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01500020
015100     05  PS-CREATE-HEADER-SW            PIC  X(01)  VALUE 'N'.    01510020
015200         88  PS-CREATE-HEADER                       VALUE 'Y'.    01520020
015300         88  PS-HEADER-CREATED                      VALUE 'N'.    01530020
015400     05  PS-MULTI-PRICE-HEADER-SW       PIC  X(01)  VALUE 'N'.    01540020
015500         88  PS-MULTI-PRICE-HEADER                  VALUE 'Y'.    01550020
015510     05  PS-DOMAIN-INFO-FOUND-SW        PIC  X(01)  VALUE 'N'.    01551047
015520         88  PS-DOMAIN-INFO-FOUND                   VALUE 'Y'.    01552047
015530         88  PS-DOMAIN-INFO-NOT-FOUND               VALUE 'N'.    01553047
015540     05  PS-VALID-TICKET-OFFICE-SW      PIC  X(01)  VALUE 'N'.    01554070
015550         88  PS-VALID-TICKET-OFFICE                 VALUE 'Y'.    01555070
015560         88  PS-VALID-TICKET-OFFICE-NO              VALUE 'N'.    01556070
015600                                                                  01560020
016100 01  DK-DB2-KEYS.                                                 01610020
016200     05  DK-TKT-FORMAT-VS             PIC  X(20).                 01620020
016300     05  DK-TKT-FORMAT                PIC  X(06).                 01630020
016400     05  DK-OPER-UNT-ID               PIC S9(4) COMP.             01640020
016500     05  DK-FCLTY-ID                  PIC S9(4) COMP.             01650020
016600     05  DK-PO-NBR                    PIC S9(9) COMP.             01660020
016700     05  DK-PO-REQ-NBR                PIC S9(9) COMP.             01670020
016800     05  DK-REC-SEQ-NBR               PIC S9(9) COMP.             01680020
016900     05  DK-LINE-NBR                  PIC S9(9) COMP.             01690020
016910     05  DK-ITM-NBR                   PIC S9(15)V COMP-3.         01691047
017000     05  DK-TKT-OFFICE                PIC  X(6).                  01700020
017400                                                                  01740020
017500 01  AM-ABEND-MESSAGES.                                           01750020
017600     05  AM-ABEND-MESSAGE-7.                                      01760020
017700         10  FILLER                     PIC X(52)    VALUE        01770020
017800     'ERROR WRITING TRANSIENT DATA QUEUE -  RETURN CODE = '.      01780020
017900         10  AM-CICS-CODE-7             PIC S9(8)    VALUE 0.     01790020
018000         10  FILLER                     PIC X(16)    VALUE SPACE. 01800020
018100     05  AM-ABEND-MESSAGE-8.                                      01810020
018200         10  FILLER                     PIC X(55)    VALUE        01820020
018300     'ERROR EN-QUEUEING TRANSIENT DATA QUEUE - RETURN CODE = '.   01830020
018400         10  AM-CICS-CODE-8             PIC S9(8)    VALUE 0.     01840020
018500         10  FILLER                     PIC X(13)    VALUE SPACE. 01850020
018600     05  AM-ABEND-MESSAGE-9.                                      01860020
018700         10  FILLER                     PIC X(54)    VALUE        01870020
018800     'ERROR D-QUEUEING TRANSIENT DATA QUEUE - RETURN CODE = '.    01880020
018900         10  AM-CICS-CODE-9             PIC S9(8)    VALUE 0.     01890020
019000         10  FILLER                     PIC X(14)    VALUE SPACE. 01900020
019100                                                                  01910020
019200 01  SE-SYSTEM-ERROR-MESSAGE.                                     01920020
019300     05  FILLER                  PIC X(51)    VALUE               01930020
019400         'A SYSTEM ERROR HAS OCCURRED - CONTACT DP - PROGRAM '.   01940020
019500     05  SE-CURRENT-PROGRAM-NAME PIC X(8)     VALUE SPACES.       01950020
019600     05  FILLER                  PIC X(7)     VALUE SPACES.       01960020
019700     05  FILLER                  PIC X(10)    VALUE 'EIBRESP = '. 01970020
019800     05  SE-CICS-RESPONSE        PIC 9(4)     VALUE ZERO.         01980020
019900     05  FILLER                  PIC X(5)     VALUE SPACES.       01990020
020000     05  FILLER                  PIC X(14)    VALUE               02000020
020100         'ATTEMPTING TO '.                                        02010020
020200     05  SE-ATTEMPTED-ACTION     PIC X(61)    VALUE SPACES.       02020020
020300                                                                  02030020
020400 01  PV-PROGRAM-VARIABLES.                                        02040020
020500     05  PV-COMMAREA-LENGTH           PIC S9(04) COMP.            02050020
020600     05  PV-DISPLAY-COMP-9            PIC 9(9).                   02060020
020700     05  PV-DISPLAY-GWP-RETAIL        PIC .99.                    02070020
020800     05  PV-SAVE-COMM-DATA            PIC  X(264).                02080020
020900     05  PV-SAVE-TKT-DESC             PIC  X(20).                 02090020
021000     05  PV-SAVE-TKT-FORMAT           PIC  X(08).                 02100020
021010     05  PV-STICKER-99999             PIC  9(05).                 02101061
021020     05  PV-STICKER-NBR-ZZ999         PIC  ZZ999.                 02102063
021100     05  PV-NUMBER-OF-SELECTED-ITEMS  PIC  9(03).                 02110020
021200*DH  05  PV-SEASON-CODE.                                          02120026
021300*DH      10  PV-SEASON-CODE-SEASON    PIC  X(01)  VALUE SPACE.    02130026
021400*DH          88  PV-VAILD-SEASON-CODES               VALUE        02140026
021500*DH              'F' 'S'.                                         02150026
021600*DH      10  PV-SEASON-CODE-SCND-DGT-OF-YR                        02160026
021700*DH                                   PIC  X(01)  VALUE SPACE.    02170026
021800*DH      10  PV-SEASON-CODE-MONTH     PIC  9(01)  VALUE ZEROS.    02180026
021900     05  PV-DATE.                                                 02190020
022000         10  PV-MONTH                    PIC  9(02)  VALUE ZEROS. 02200020
022100         10  FILLER REDEFINES PV-MONTH.                           02210020
022200             15  PV-FIRST-DIGIT-OF-MONTH PIC  9(01).              02220020
022300             15  PV-SECOND-DIGIT-OF-MONTH                         02230020
022400                                         PIC  9(01).              02240020
022500         10  PV-DAY                      PIC  X(02)  VALUE SPACE. 02250020
022600         10  PV-YEAR.                                             02260020
022700             15  PV-FIRST-DIGIT-OF-YEAR  PIC  X(01)  VALUE SPACE. 02270020
022800             15  PV-SECOND-DIGIT-OF-YEAR PIC  X(01)  VALUE SPACE. 02280020
022900     05  PV-DISPLAY-KEYS.                                         02290020
023000         10  PV-DISPLAY-ORD-NBR          PIC  9(09)  VALUE ZEROS  02300020
023100                                                BLANK WHEN ZEROS. 02310020
023200         10  FILLER                      PIC  X(02)  VALUE SPACE. 02320020
023300         10  PV-DISPLAY-RCVR-SEQ-NBR     PIC  9(09)  VALUE ZEROS  02330020
023400                                                BLANK WHEN ZEROS. 02340020
023500         10  FILLER                      PIC  X(02)  VALUE SPACE. 02350020
023600         10  PV-DISPLAY-ORD-LNE-NBR      PIC  9(04)  VALUE ZEROS  02360020
023700                                                BLANK WHEN ZEROS. 02370020
023800         10  FILLER                      PIC  X(02)  VALUE SPACE. 02380020
023900         10  PV-DISPLAY-WORK-ORD-SEQ-NBR PIC  9(04)  VALUE ZEROS  02390020
024000                                                BLANK WHEN ZEROS. 02400020
024100         10  FILLER                      PIC  X(02)  VALUE SPACE. 02410020
024200         10  PV-DISPLAY-OPER-UNT-ID      PIC  9(04)  VALUE ZEROS  02420020
024300                                                BLANK WHEN ZEROS. 02430020
024400         10  FILLER                      PIC  X(02)  VALUE SPACE. 02440020
024500         10  PV-DISPLAY-FCLTY-ID         PIC  9(04)  VALUE ZEROS  02450020
024600                                                BLANK WHEN ZEROS. 02460020
025800     05  PV-JOB-ID.                                               02580020
025900         10  PV-PO-REC-SEQ.                                       02590020
026000             15  PV-KEY-PO-NBR        PIC  9(08).                 02600020
026100             15  FILLER               PIC  X(01)  VALUE '-'.      02610020
026200             15  PV-KEY-REC-SEQ-NBR   PIC  9(03).                 02620020
026300         10  FILLER                   PIC  X(08)  VALUE SPACES.   02630020
026310     05  PV-MAJOR-CLASS.                                          02631026
026320         10  PV-MAJOR-CLASS-1         PIC  X(01)  VALUE SPACE.    02632026
026330         10  PV-MAJOR-CLASS-2         PIC  X(01)  VALUE ZERO.     02633026
026340     05  PV-CL-NBR.                                               02634026
026350         10  PV-CL-NBR-1              PIC  X(01)  VALUE SPACE.    02635026
026360         10  PV-CL-NBR-2              PIC  X(01)  VALUE SPACE.    02636026
026400     05  PV-TICKET-QUANTITY           PIC  9(08)  VALUE ZEROS.    02640020
026500     05  PV-TKT-FMT-ID                PIC  X(06)  VALUE SPACES.   02650020
026600     05  PV-TOTAL-TICKET-QUANTITY     PIC  9(09)  VALUE ZEROS.    02660020
026700     05  PV-NMBR-OF-TICKETS           PIC  9(05)  VALUE ZEROS.    02670020
026800     05  PV-NMBR-OF-TICKETS-4-DGT     PIC  9(04)  VALUE ZEROS.    02680020
026900     05  PV-DETAIL-CONTROL-NMBR.                                  02690020
027000         10  PV-PO-LINE-NMBR-DETAIL   PIC  X(03)  VALUE SPACE.    02700020
027100         10  PV-QUANTITY-SEQ-NMBR     PIC  9(02)  VALUE ZEROS.    02710020
027200         10  FILLER                   PIC  X(02)  VALUE SPACE.    02720020
027300     05  PV-HEADER-CONTROL-NMBR.                                  02730020
027400         10  PV-RIGHTMOST4-DIGITS-OF-KEYREC                       02740020
027500                                      PIC  X(04)  VALUE SPACE.    02750020
027600         10  PV-PO-LINE-NMBR-HEADER   PIC  X(03)  VALUE SPACE.    02760020
027700     05  PV-SELECT-COUNTER            PIC S9(04)  VALUE ZERO      02770020
027800                                                COMP SYNC.        02780020
027900     05  PV-SUB                       PIC S9(4) VALUE ZERO        02790020
028000                                                COMP SYNC.        02800020
028610     05  PV-GP-QTY                    PIC  9.                     02861026
028620     05  PV-GP-RTL-1                  PIC  9.99.                  02862026
028630     05  PV-GP-RTL-2                  PIC  99.99.                 02863026
028640     05  PV-GP-RTL-DOLLAR-2           PIC $$9.99.                 02864026
028650     05  PV-GP-RTL-DOLLAR-1           PIC $9.99.                  02865026
028660     05  PV-GP-QTY-SLASH.                                         02866026
028670         10  PV-GP-QTY-1              PIC  9(01).                 02867026
028680         10  PV-GP-SLASH              PIC  X(01) VALUE '/'.       02868026
028700     05  PV-QUANTITY                  PIC S9(09) VALUE ZERO       02870020
028800                                                 COMP-3.          02880020
028900     05  PV-REC-SEQ-NBR               PIC  9(3).                  02890020
029000     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        02900020
029100                                                COMP SYNC.        02910020
029200     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        02920020
029300                                                COMP-3.           02930020
029400     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        02940020
029500                                                COMP-3.           02950020
029600     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        02960020
029700                                                COMP-3.           02970020
029800     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        02980020
029900                                                COMP-3.           02990020
030000     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        03000020
030100                                                COMP-3.           03010020
030200     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        03020020
030300                                                COMP-3.           03030020
030400     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        03040020
030500                                                COMP-3.           03050020
030600     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        03060020
030700                                                COMP SYNC.        03070020
030800     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        03080020
030900                                                COMP SYNC.        03090020
031000     05  PV-ITEM                      PIC S9(4) VALUE ZERO        03100020
031100                                                COMP SYNC.        03110020
031200     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        03120020
031300                                                COMP SYNC.        03130020
031400     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        03140020
031500                                                COMP SYNC.        03150020
031600     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        03160020
031700                                                COMP SYNC.        03170020
031800     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        03180020
031900                                                COMP SYNC.        03190020
032000     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        03200020
032100                                                COMP SYNC.        03210020
032200     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        03220020
032300                                                COMP SYNC.        03230020
032400     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        03240020
032500                                                COMP SYNC.        03250020
032600     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        03260020
032700                                                COMP SYNC.        03270020
032800     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        03280020
032900                                                COMP SYNC.        03290020
033000     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        03300020
033100                                                COMP SYNC.        03310020
033200     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        03320020
033300                                                COMP SYNC.        03330020
033400     05  PV-SQL-SUB                   PIC S9(4) VALUE ZERO        03340020
033500                                                COMP SYNC.        03350020
033600     05  PV-REC-IND                   PIC S9(4) VALUE ZERO        03360020
033700                                                COMP SYNC.        03370020
033800     05  PV-DISTRO-IND                PIC S9(4) VALUE ZERO        03380020
033900                                                COMP SYNC.        03390020
034000     05  PV-EXPTED-IND                PIC S9(4) VALUE ZERO        03400020
034100                                                COMP SYNC.        03410020
034200     05  PV-VERIFIED-IND              PIC S9(4) VALUE ZERO        03420020
034300                                                COMP SYNC.        03430020
034310     05  PV-LINES-NOT-PRINTED         PIC S9(4) VALUE ZERO        03431047
034320                                                COMP SYNC.        03432047
034400     05  PV-REC-ITEMS                 PIC S9(9) VALUE ZERO        03440020
034500                                                COMP SYNC.        03450020
034600     05  PV-SUM-EXPTED-QTY            PIC S9(9) VALUE ZERO        03460020
034700                                                COMP SYNC.        03470020
034800     05  PV-SUM-VERIFIED-QTY          PIC S9(9) VALUE ZERO        03480020
034900                                                COMP SYNC.        03490020
035000     05  PV-SUM-DISTRO-QTY            PIC S9(9) VALUE ZERO        03500020
035100                                                COMP SYNC.        03510020
035200     05  PV-SUM-STR-DISTRO-QTY        PIC S9(9) VALUE ZERO        03520020
035300                                                COMP SYNC.        03530020
035400     05  PV-OPEN-TO-REC               PIC S9(6) VALUE ZERO.       03540020
035700     05  PV-DRS-ABEND-DISPLAY-LINE1.                              03570020
035800         10  FILLER                      PIC  X(14)  VALUE        03580020
035900             'DRRB ID = DRRB'.                                    03590020
036000         10  FILLER                      PIC  X(02)  VALUE SPACE. 03600020
036100         10  FILLER                      PIC  X(12)  VALUE        03610020
036200             'DRRB FUNC = '.                                      03620020
036300         10  PV-DRS-DRRB-FUNC            PIC  X(04)  VALUE SPACE. 03630020
036400         10  FILLER                      PIC  X(02)  VALUE SPACE. 03640020
036500         10  FILLER                      PIC  X(11)  VALUE        03650020
036600             'DRRB RID = '.                                       03660020
036700         10  PV-DRS-DRRB-RID             PIC  X(08)  VALUE SPACE. 03670020
036800         10  FILLER                      PIC  X(02)  VALUE SPACE. 03680020
036900         10  FILLER                      PIC  X(15)  VALUE        03690020
037000             'DRRB OPTIONS = '.                                   03700020
037100         10  PV-DRS-DRRB-OPTIONS         PIC  X(08)  VALUE SPACE. 03710020
037200     05  PV-DRS-ABEND-DISPLAY-LINE2.                              03720020
037300         10  FILLER                      PIC  X(10)  VALUE        03730020
037400             'DRRB RC = '.                                        03740020
037500         10  PV-DRS-DRRB-RC              PIC  X(04)  VALUE SPACE. 03750020
037600         10  FILLER                      PIC  X(02)  VALUE SPACE. 03760020
037700         10  FILLER                      PIC  X(18)  VALUE        03770020
037800             'DRRB ATTR-ERROR = '.                                03780020
037900         10  PV-DRS-ATTR-ERROR           PIC  X(02)  VALUE SPACE. 03790020
038000         10  FILLER                      PIC  X(02)  VALUE SPACE. 03800020
038100         10  FILLER                      PIC  X(12)  VALUE        03810020
038200             'DRRB DRDC = '.                                      03820020
038300         10  PV-DRS-DRRB-DRDC            PIC  X(04)  VALUE SPACE. 03830020
038400         10  FILLER                      PIC  X(02)  VALUE SPACE. 03840020
038500         10  FILLER                      PIC  X(13)  VALUE        03850020
038600             'DRRB LINES = '.                                     03860020
038700         10  PV-DRS-DRRB-LINES           PIC  X(04)  VALUE SPACE. 03870020
038800     05  PV-ID                           PIC  9(09)  VALUE ZEROS. 03880020
038810     05  PV-ITM-NBR-X.                                            03881047
038820         10  PV-ITM-NBR                  PIC  9(15)  VALUE ZEROS. 03882047
038900                                                                  03890020
039000 01  ST-SYSTEM-TIME-AREA.                                         03900020
039100     05  ST-ABSTIME                      PIC S9(16)  VALUE +0     03910020
039200                                                     COMP SYNC.   03920020
039300     05  ST-TIME-EDIT.                                            03930020
039400         10  ST-TIME-HHMM                PIC  X(05)  VALUE SPACE. 03940020
039500         10  FILLER                      PIC  X(03)  VALUE SPACE. 03950020
039600                                                                  03960020
039700 01  LQW-LIST-QUEUE-WORK-AREA.                                    03970020
039800     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     03980020
039900     05  LQW-ITEM-ENTRIES             OCCURS 5 TIMES              03990022
040000                                      INDEXED BY LQW-IDX.         04000020
040100         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          04010020
040200         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  04020020
040300         10  LQW-SELECTED-SW          PIC X(01).                  04030020
040400             88  LQW-SELECT                      VALUE 'S'.       04040020
040500             88  LQW-DESELECT                    VALUE ' '.       04050020
040600         10  LQW-PO-LNE-NBR           PIC 9(09).                  04060020
040700         10  FILLER REDEFINES LQW-PO-LNE-NBR.                     04070020
040800             15  FILLER               PIC X(06).                  04080020
040900             15  LQW-PO-LNE-NBR-X     PIC X(03).                  04090020
041000         10  LQW-UNT-QTY-X.                                       04100020
041100             15  LQW-UNT-QTY          PIC 9(05).                  04110031
041110         10  LQW-ITM-NBR              PIC S9(15)V COMP-3.         04111047
041200         10  LQW-MAJOR-CLASS          PIC X(02).                  04120026
041210         10  LQW-SUB-CLASS            PIC X(02).                  04121026
041400         10  LQW-UPC-TEXT             PIC X(03).                  04140026
041410         10  LQW-UPC                  PIC X(13).                  04141026
041500         10  FILLER REDEFINES LQW-UPC.                            04150020
041700             15  LQW-UPC-12           PIC X(12).                  04170053
041710             15  FILLER               PIC X(01).                  04171053
041900         10  LQW-VEND-STYL            PIC X(20).                  04190020
042000         10  LQW-SIZE                 PIC X(10).                  04200020
042100         10  LQW-DISP-SIZE-IND        PIC X(01).                  04210020
042200             88 LQW-DISP-SIZE        VALUE 'Y'.                   04220020
042300             88 LQW-DONT-DISP-SIZE   VALUE 'N'.                   04230020
042400         10  LQW-COLOR                PIC X(10).                  04240020
042500         10  LQW-DISP-COLOR-IND       PIC X(01).                  04250020
042600             88 LQW-DISP-COLOR       VALUE 'Y'.                   04260020
042700             88 LQW-DONT-DISP-COLOR  VALUE 'N'.                   04270020
042800         10  LQW-TKT-FORMAT           PIC X(06).                  04280020
042900         10  LQW-PAPER-TYP-ID         PIC X(06).                  04290020
043000         10  LQW-LNE-XTKTS            PIC 9(03).                  04300020
043100         10  LQW-LNE-XTKT-PCT         PIC 9(03).                  04310020
043200         10  LQW-UNT-RTL-PR-X.                                    04320020
043300             15  LQW-UNT-RTL-PR       PIC 9(06)V99.               04330020
043400         10  FILLER REDEFINES LQW-UNT-RTL-PR-X.                   04340020
043500             15  FILLER               PIC X(01).                  04350020
043600             15  LQW-UNT-RTL-PRICE    PIC X(07).                  04360020
043700         10  FILLER REDEFINES LQW-UNT-RTL-PR-X.                   04370020
043800             15  FILLER               PIC X(02).                  04380020
043900             15  LQW-UNT-RTL-PRICE-6  PIC X(06).                  04390020
044000         10  FILLER REDEFINES LQW-UNT-RTL-PR-X.                   04400020
044100             15  FILLER               PIC X(05).                  04410020
044200             15  LQW-UNT-RTL-PRICE-3  PIC X(03).                  04420020
044300         10  LQW-GP-RTL-QTY           PIC 9(01).                  04430031
045000         10  LQW-GP-RTL               PIC 9(02)V99.               04500031
045600         10  LQW-OPT-BLK              PIC X(03).                  04560039
045700         10  LQW-STICKER-NBR         PIC  X(05).                  04570048
045800         10  LQW-STICKER-NBR-N       REDEFINES                    04580020
045900             LQW-STICKER-NBR         PIC  9(05).                  04590048
046000                                                                  04600020
046100******************************************************************04610020
046200*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           04620020
046300******************************************************************04630020
046400     COPY PCWS016.                                                04640064
046500                                                                  04650020
046600******************************************************************04660020
046700*    BMS MAP                                                      04670020
046800******************************************************************04680020
046900     COPY RCKM287.                                                04690020
047000                                                                  04700020
047100 01  MR-OCCURS-LAYOUT                 REDEFINES RC287AO.          04710020
047200*PS 10/17/2014 CHANGE STARTS                                      04720066
047210     05  FILLER                       PIC X(177).                 04721066
047220*PS 10/17/2014 CHANGE ENDS                                        04722066
047300     05  MR-SCROLL-AREA               OCCURS 5 TIMES.             04730022
047400         10  MR-SELECTL               PIC S9(4) COMP.             04740020
047500         10  MR-SELECTA               PIC X.                      04750020
047600         10  MR-SELECTC               PIC X.                      04760020
047700         10  MR-SELECTH               PIC X.                      04770020
047800         10  MR-SELECTI               PIC X.                      04780020
047900                                                                  04790020
048000         10  MR-LINE-NBR-L            PIC S9(4) COMP.             04800020
048100         10  MR-LINE-NBR-A            PIC X.                      04810020
048200         10  MR-LINE-NBR-C            PIC X.                      04820020
048300         10  MR-LINE-NBR-H            PIC X.                      04830020
048400         10  MR-LINE-NBR.                                         04840020
048500             15  MR-LINE-NBR-EDITED                               04850020
048600                                      PIC ZZ9.                    04860020
048700                                                                  04870020
048800         10  MR-QUANT-L               PIC S9(4) COMP.             04880020
048900         10  MR-QUANT-A               PIC X.                      04890020
049000         10  MR-QUANT-C               PIC X.                      04900020
049100         10  MR-QUANT-H               PIC X.                      04910020
049200         10  MR-QUANT.                                            04920020
049300             15  MR-QUANT-EDITED                                  04930020
049400                                      PIC ZZZZ9.                  04940022
049500                                                                  04950020
049600         10  MR-CLASS-L               PIC S9(4) COMP.             04960022
049700         10  MR-CLASS-A               PIC X.                      04970022
049800         10  MR-CLASS-C               PIC X.                      04980022
049900         10  MR-CLASS-H               PIC X.                      04990022
050000         10  MR-CLASS                 PIC X(05).                  05000022
050100                                                                  05010020
050200         10  MR-COLOR-L               PIC S9(4) COMP.             05020020
050300         10  MR-COLOR-A               PIC X.                      05030020
050400         10  MR-COLOR-C               PIC X.                      05040020
050500         10  MR-COLOR-H               PIC X.                      05050020
050600         10  MR-COLOR                 PIC X(10).                  05060022
050700                                                                  05070020
050800         10  MR-SIZE-L                PIC S9(4) COMP.             05080020
050900         10  MR-SIZE-A                PIC X.                      05090020
051000         10  MR-SIZE-C                PIC X.                      05100020
051100         10  MR-SIZE-H                PIC X.                      05110020
051200         10  MR-SIZE                  PIC X(10).                  05120022
051300                                                                  05130020
051400         10  MR-STYLE-L               PIC S9(4) COMP.             05140020
051500         10  MR-STYLE-A               PIC X.                      05150020
051600         10  MR-STYLE-C               PIC X.                      05160020
051700         10  MR-STYLE-H               PIC X.                      05170020
051800         10  MR-STYLE                 PIC X(12).                  05180022
051900                                                                  05190020
052000         10  MR-TKT-FORMAT-L          PIC S9(4) COMP.             05200020
052100         10  MR-TKT-FORMAT-A          PIC X.                      05210020
052200         10  MR-TKT-FORMAT-C          PIC X.                      05220020
052300         10  MR-TKT-FORMAT-H          PIC X.                      05230020
052400         10  MR-TKT-FORMAT            PIC X(06).                  05240022
052500                                                                  05250020
052600         10  MR-RETAIL-L              PIC S9(4) COMP.             05260020
052700         10  MR-RETAIL-A              PIC X.                      05270020
052800         10  MR-RETAIL-C              PIC X.                      05280020
052900         10  MR-RETAIL-H              PIC X.                      05290020
053000         10  MR-RETAIL.                                           05300020
053100             15  MR-RETAIL-EDITED     PIC ZZZZ.99.                05310020
053200                                                                  05320020
053300         10  MR-GP-RETAIL-L           PIC S9(4) COMP.             05330020
053400         10  MR-GP-RETAIL-A           PIC X.                      05340020
053500         10  MR-GP-RETAIL-C           PIC X.                      05350020
053600         10  MR-GP-RETAIL-H           PIC X.                      05360020
053700         10  MR-GP-RETAIL             PIC X(07).                  05370022
053710                                                                  05371024
053720         10  MR-UPC-NBR-TXT-L         PIC S9(4) COMP.             05372024
053730         10  MR-UPC-NBR-TXT-A         PIC X.                      05373024
053740         10  MR-UPC-NBR-TXT-C         PIC X.                      05374024
053750         10  MR-UPC-NBR-TXT-H         PIC X.                      05375024
053760         10  MR-UPC-NBR-TXT           PIC X(03).                  05376024
053770                                                                  05377024
053780         10  MR-UPC-NBR-L             PIC S9(4) COMP.             05378024
053790         10  MR-UPC-NBR-A             PIC X.                      05379024
053791         10  MR-UPC-NBR-C             PIC X.                      05379124
053792         10  MR-UPC-NBR-H             PIC X.                      05379224
053793         10  MR-UPC-NBR               PIC X(13).                  05379324
053800                                                                  05380020
053900                                                                  05390020
054000******************************************************************05400020
054100*    BMS ATTRIBUTES                                               05410020
054200******************************************************************05420020
054300     COPY DPWS015.                                                05430064
054400                                                                  05440020
054500******************************************************************05450020
054600*    FUNCTION KEYS                                                05460020
054700******************************************************************05470020
054800     COPY DPWS016.                                                05480064
054900                                                                  05490020
055000******************************************************************05500020
055100*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   05510020
055200******************************************************************05520020
055300     COPY DPWS010I.                                               05530064
055900                                                                  05590020
056000******************************************************************05600020
056100*  RECORD LAYOUT FOR THE ON-LINE TICKETING SYSTEM DATA STREAM     05610020
056200*  TO DRS (DYNAMIC REPORT SYSTEM)                                 05620020
056300******************************************************************05630020
056400     COPY MPRD049.                                                05640064
056500                                                                  05650020
056600                                                                  05660020
056700******************************************************************05670020
056800*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) COMMAREA            05680020
056900******************************************************************05690020
057000     COPY DRRD003.                                                05700064
057100                                                                  05710020
057200******************************************************************05720020
057300*  LAYOUT FOR THE DRS (DYNAMIC REPORT SYSTEM) DETAIL LINES        05730020
057400******************************************************************05740020
057500     COPY DRRD004.                                                05750064
057600                                                                  05760020
057700******************************************************************05770020
057800*  LAYOUT FOR THE COMMAREA FOR THE PO-PRINT STARTED SUBROUTINE    05780020
057900******************************************************************05790020
058000     COPY VLWS010.                                                05800064
058100                                                                  05810020
058200                                                                  05820020
058300******************************************************************05830020
058400*    PARAMETER LIST FOR CICS API                                  05840020
058500******************************************************************05850020
058600     COPY DPWS030.                                                05860064
058610     COPY DPWS930.                                                05861077
058700                                                                  05870020
058800******************************************************************05880020
058900*    GLOBAL COMMUNICATION AREA                                    05890020
059000******************************************************************05900020
059100     COPY DPWS020.                                                05910064
059200     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05920020
059300                                                                  05930020
059400******************************************************************05940020
059500*    INTER-APPLICATION COMMUNICATION AREA                         05950020
059600*    RCWS015 = INPUT FROM PACK SLIP HEADER MAINTENANCE PROGRAM    05960020
059700******************************************************************05970020
059800         10  INTER-APPL-COMM-AREA       PIC X(200).               05980020
059900     COPY RCWS030.                                                05990064
060000     COPY POWS017.                                                06000064
060100                                                                  06010020
060200******************************************************************06020020
060300*    APPLICATION SPECIFIC COMMUNICATION AREA                      06030020
060400******************************************************************06040020
060500         10  ASC-SPECIFIC-COMMAREA.                               06050020
060600             15  ASC-LIST-HEADER-INFO.                            06060020
060700                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   06070020
060800                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   06080020
060900                 20  ASC-KEY-FCLTY-DESC         PIC  X(30).       06090020
061000                 20  ASC-KEY-PO-REQ-NBR         PIC S9(09) COMP.  06100020
061100                 20  ASC-KEY-PO-NBR.                              06110020
061200*PS 10/17/2014 CHANGE STARTS                                      06120065
061210                     25  ASC-KEY-PO-NBR-N       PIC  9(08).       06121065
061220*PS 10/17/2014 CHANGE ENDS                                        06122065
061300                 20  ASC-KEY-VENDOR-NAME        PIC  X(30).       06130020
061400                 20  ASC-DEPT-NBR               PIC  X(03).       06140020
061500                 20  ASC-REQ-STAT-CDE           PIC  X(01).       06150020
061600                 20  ASC-LOCATION               PIC  X(06).       06160032
061700                 20  ASC-TKT-OFFICE             PIC  X(06).       06170020
061800                 20  ASC-PRINT-TKT-OFFICE       PIC  X(06).       06180020
061900                 20  ASC-TKT-OFF-ADR-ID         PIC  X(08).       06190020
062000**DH             20  ASC-SEASON-CDE             PIC  X(03).       06200022
062100                 20  ASC-EXTRA-TKTS             PIC  X(03).       06210020
062200                 20  ASC-EXTRA-TKTS-N REDEFINES ASC-EXTRA-TKTS    06220020
062300                                                PIC  9(03).       06230020
062400                 20  ASC-EXTRA-TKT-PCT          PIC  X(03).       06240020
062500                 20  ASC-EXTRA-TKT-PCT-N REDEFINES                06250020
062600                     ASC-EXTRA-TKT-PCT          PIC  9(03).       06260020
062700             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               06270020
062800                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       06280020
062900                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06290020
063000                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06300020
063100                                                                  06310020
063200                 20  ASC-ITEM-ARRAY.                              06320020
063300                     25  ASC-ITEM-ENTRIES  OCCURS 5 TIMES.        06330022
063400                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    06340020
063500                                                     COMP-3.      06350020
063600                         30  ASC-TEMP-SELECTED-SW    PIC X.       06360020
063700                             88  ASC-VALID-SELECT    VALUE ' '    06370020
063800                                                           'S'    06380020
063900                                                           'B'    06390020
064000                                                           'E'.   06400020
064100                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06410020
064200                             88  ASC-TEMP-SELECT     VALUE 'S'.   06420020
064300                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06430020
064400                             88  ASC-TEMP-END        VALUE 'E'.   06440020
064500                         30  ASC-SELECTED-SW         PIC  X.      06450020
064600                             88  ASC-NO-SELECT       VALUE ' '.   06460020
064700                             88  ASC-SELECT          VALUE 'S'.   06470020
064800                             88  ASC-BEGIN           VALUE 'B'.   06480020
064900                             88  ASC-END             VALUE 'E'.   06490020
065000                         30  ASC-PO-LNE-NBR          PIC  9(09).  06500020
065100                         30  ASC-UNT-QTY             PIC  X(05).  06510031
065200                         30  ASC-UNT-QTY-N REDEFINES ASC-UNT-QTY  06520020
065300                                                     PIC  9(05).  06530031
065310                         30  ASC-ITM-NBR             PIC S9(15)V  06531047
065320                                                          COMP-3. 06532047
065400                         30  ASC-MAJOR-CLASS         PIC  9(02).  06540052
065410                         30  ASC-SUB-CLASS           PIC  9(02).  06541052
065600                         30  ASC-UPC-NBR-TXT         PIC  X(03).  06560026
065610                         30  ASC-UPC-NBR.                         06561049
065620                             35  ASC-UPC-NBR-N       PIC  9(12).  06562049
065700                         30  FILLER                  PIC  X(01).  06570020
065800                         30  ASC-VEND-STYL           PIC  X(20).  06580026
065900                         30  ASC-SIZE                PIC  X(10).  06590020
066000                         30  ASC-DISP-SIZE-IND       PIC  X(01).  06600020
066100                             88 ASC-DISP-SIZE        VALUE 'Y'.   06610020
066200                             88 ASC-DONT-DISP-SIZE   VALUE 'N'.   06620020
066300                         30  ASC-COLOR               PIC  X(10).  06630020
066400                         30  ASC-DISP-COLOR-IND      PIC  X(01).  06640020
066500                             88 ASC-DISP-COLOR       VALUE 'Y'.   06650020
066600                             88 ASC-DONT-DISP-COLOR  VALUE 'N'.   06660020
066700                         30  ASC-TKT-FORMAT          PIC  X(06).  06670020
066800                         30  ASC-PAPER-TYP-ID        PIC  X(06).  06680020
066900                         30  ASC-LNE-XTKTS           PIC  9(03).  06690020
067000                         30  ASC-LNE-XTKT-PCT        PIC  9(03).  06700020
067100                         30  ASC-UNT-RTL-PR          PIC 9(06)V99.06710036
067200                         30  ASC-GP-RTL-QTY          PIC 9(01).   06720022
067300                         30  ASC-GP-RTL              PIC 9(02)V99.06730025
067400                         30  ASC-OPT-BLK             PIC  X(03).  06740025
067500                         30  ASC-STICKER-NBR         PIC  X(05).  06750048
067600                         30  ASC-STICKER-NBR-N       REDEFINES    06760020
067700                             ASC-STICKER-NBR         PIC  9(05).  06770048
067800             15  ASC-BLK-SUB                         PIC S9(4)    06780020
067900                                                     COMP SYNC.   06790020
068000             15  ASC-ITEM-SUB                        PIC S9(4)    06800020
068100                                                     COMP SYNC.   06810020
068200             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    06820020
068300                                                     COMP-3.      06830020
068400             15  ASC-ITEMS-DISPLAYED                 PIC S999     06840020
068500                                                     COMP-3.      06850020
068600             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    06860020
068700                                                     COMP-3.      06870020
068800             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    06880020
068900                                                     COMP-3.      06890020
069000             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    06900020
069100                                                     COMP SYNC.   06910020
069200             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    06920020
069300                                                     COMP-3.      06930020
069400             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    06940020
069500                                                     COMP-3.      06950020
069600             15  ASC-ITEMS-LEFT-INDICATOR                         06960020
069700                                        PIC X(01).                06970020
069800                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     06980020
069900                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     06990020
070000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       07000020
070100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07010020
070200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07020020
070300             15  ASC-LIST-QUEUE-NAME.                             07030020
070400                 20  ASC-LIST-TERM-ID                PIC X(4).    07040020
070500                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    07050020
070600                                                     COMP-3.      07060020
070700                 20  ASC-LIST-SEQ                    PIC 9.       07070020
070800             15  ASC-SEL-QUEUE-NAME.                              07080020
070900                 20  ASC-SEL-TERM-ID                 PIC X(4).    07090020
071000                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    07100020
071100                                                     COMP-3.      07110020
071200                 20  ASC-SEL-SEQ                     PIC 9.       07120020
071300             15  ASC-START-ITEM-REQUEST.                          07130020
071400                 20  ASC-START-ITEM-REQUEST-N        PIC 9(7).    07140020
071500             15  ASC-USE-SELECTION-QUEUE-IND                      07150020
071600                                        PIC  X(01).               07160020
071700                 88  ASC-USE-SELECTION-QUEUE        VALUE 'Y'.    07170020
071800             15  ASC-SEL-QUEUE-NAME-IN  PIC  X(08).               07180020
071900             15  ASC-NUMBER-OF-TS-ITEMS PIC S9(05)  COMP-3.       07190020
072000             15  ASC-NUMBER-OF-SELECTED-ITEMS                     07200020
072100                                        PIC S9(09)  COMP-3.       07210020
072200             15  ASC-SEL-SUB            PIC S9(04)  COMP.         07220020
072300             15  ASC-SEL-ITEM           PIC S9(04)  COMP.         07230020
072400                                                                  07240020
072500******************************************************************07250020
072600*    ABEND PROCESSING                                             07260020
072700******************************************************************07270020
072800     COPY DPWS013.                                                07280064
072900                                                                  07290020
073000******************************************************************07300020
073100*    DB2 SQL COMMUNICATION AREA                                   07310020
073200******************************************************************07320020
073300     EXEC SQL                                                     07330020
073400          INCLUDE SQLCA                                           07340020
073500     END-EXEC.                                                    07350020
073600                                                                  07360020
073700******************************************************************07370020
073800*    DB2 DCLGEN FOR XL-SKU DOMAIN TABLE                           07380048
073900******************************************************************07390020
074000     EXEC SQL                                                     07400020
074100          INCLUDE XLT00003                                        07410048
074200     END-EXEC.                                                    07420020
074300                                                                  07430020
075100******************************************************************07510020
075200*    DB2 DCLGEN FOR THE XL-VENDOR STYLE DOMAIN TABLE              07520048
075300******************************************************************07530020
075400     EXEC SQL                                                     07540020
075410          INCLUDE XLT00004                                        07541048
075600     END-EXEC.                                                    07560020
075700                                                                  07570020
075800******************************************************************07580048
075900*    DB2 DCLGEN FOR THE XL-UPC TABLE VIEW                         07590048
076000******************************************************************07600048
076100     EXEC SQL                                                     07610048
076200          INCLUDE XLV00003                                        07620048
076300     END-EXEC.                                                    07630048
076400                                                                  07640048
077900******************************************************************07790020
078000*    DB2 DCLGEN FOR PRETICKET REQUEST TABLE                       07800020
078100******************************************************************07810020
078200     EXEC SQL                                                     07820020
078300          INCLUDE TPTKREQ                                         07830020
078400     END-EXEC.                                                    07840020
078500                                                                  07850020
078600******************************************************************07860020
078700*    DB2 DCLGEN FOR PRETICKET REQUEST LINE DETAIL TABLE           07870020
078800******************************************************************07880020
078900     EXEC SQL                                                     07890020
079000          INCLUDE TPTKLNE                                         07900020
079100     END-EXEC.                                                    07910020
079200                                                                  07920020
079300******************************************************************07930020
079400*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     07940020
079500******************************************************************07950020
079600     EXEC SQL                                                     07960020
079700          INCLUDE TPURITM                                         07970020
079800     END-EXEC.                                                    07980020
079900                                                                  07990020
080700******************************************************************08070020
080800*    DB2 DCLGEN FOR TICKET FORMAT TABLE                           08080020
080900******************************************************************08090020
081000     EXEC SQL                                                     08100020
081100          INCLUDE TTKTFMT                                         08110020
081200     END-EXEC.                                                    08120020
081300                                                                  08130020
081500******************************************************************08150020
081600*    DB2 DCLGEN FOR PRINT STOCK TABLE                             08160020
081700******************************************************************08170020
081800     EXEC SQL                                                     08180020
081900          INCLUDE TPRTSTK                                         08190020
082000     END-EXEC.                                                    08200020
082100                                                                  08210020
082200******************************************************************08220071
082300*    DB2 DCLGEN FOR PARM TABLE                                    08230071
082400******************************************************************08240071
082500     EXEC SQL                                                     08250071
082600          INCLUDE TKRPRPM                                         08260071
082700     END-EXEC.                                                    08270071
082800                                                                  08280071
088600******************************************************************08860020
088700*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF ITEMS INCLUDED ON A   08870020
088800*    PRETICKET REQUEST                                            08880020
088900******************************************************************08890020
089000     EXEC SQL                                                     08900020
089100          DECLARE PRETICK_CURSOR CURSOR FOR                       08910020
089200           SELECT A.DEPT_NBR,                                     08920020
089300                  A.REQ_STAT_CDE,                                 08930020
089400                  B.CL_NBR,                                       08940020
089600                  B.GP_QTY,                                       08960020
089700                  B.GP_RTL_AMT,                                   08970020
089800                  B.UNT_RTL_PR_AMT,                               08980020
089900                  C.TKT_QTY,                                      08990020
090000                  B.ITM_NBR,                                      09000020
090010                  B.VEND_STYL_NAME,                               09001049
090100                  C.TKT_DESC,                                     09010020
090200                  C.OPT_BLCK_CDE,                                 09020020
090300                  C.TKT_PLCMNT_CDE,                               09030020
090400                  B.COLOR_DESC,                                   09040020
090500                  B.SIZE_DESC,                                    09050020
090600                  B.APP_PO_LNE_NBR,                               09060020
090700                  B.PO_LNE_NBR                                    09070020
090800             FROM TPTKREQ A,                                      09080020
090900                  TPURITM B,                                      09090020
091000                  TPTKLNE C                                       09100020
091100            WHERE A.PO_REQ_NBR     = :DK-PO-REQ-NBR               09110020
091200              AND A.PO_REQ_NBR     = C.PO_REQ_NBR                 09120020
091300              AND A.PO_NBR         = B.PO_NBR                     09130020
091400              AND C.PO_LNE_NBR     = B.PO_LNE_NBR                 09140020
091500              AND A.REQ_STAT_CDE   IN ('A', 'I')                  09150047
091600              AND B.VER_STATUS_CDE = 'A'                          09160047
091700         ORDER BY B.APP_PO_LNE_NBR, B.PO_LNE_NBR                  09170020
091800     END-EXEC.                                                    09180020
091900                                                                  09190020
092000                                                                  09200020
092100                                                                  09210020
092200 LINKAGE SECTION.                                                 09220020
092300                                                                  09230020
092400 01  DFHCOMMAREA.                                                 09240020
092500     05  FILLER                       OCCURS 1 TO 4072 TIMES      09250020
092600                                      DEPENDING ON EIBCALEN.      09260020
092700         10  FILLER                   PIC X.                      09270020
092800                                                                  09280020
092900                                                                  09290020
093000 PROCEDURE DIVISION.                                              09300020
093100                                                                  09310020
093200 0000-MAIN-MODULE.                                                09320020
093300                                                                  09330020
093400     INITIALIZE DP030-CICS-API-FIELDS.                            09340020
093500                                                                  09350020
093600     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         09360020
093700     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            09370020
093800     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           09380020
093900     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         09390020
094000     MOVE LENGTH OF RC287AI      TO DP030-MAP-LENGTH (1).         09400020
094100     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       09410020
094200     SET DP030-OVERRIDE-APPL-ERROR                                09420020
094300                                 TO TRUE.                         09430020
094400                                                                  09440020
094500     PERFORM 0001-CALL-CICS-ARCH-API.                             09450020
094600                                                                  09460020
094700     PERFORM 1000-CONTROL-PROCESSING.                             09470020
094800                                                                  09480020
094900     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       09490020
095000                                                                  09500020
095100     PERFORM 0001-CALL-CICS-ARCH-API.                             09510020
095200                                                                  09520020
095300 0001-CALL-CICS-ARCH-API.                                         09530020
095400                                                                  09540020
095510     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09551077
095600                                    DFHCOMMAREA                   09560077
095700                                    DP030-CICS-API-FIELDS         09570077
095800                                    DP020-STANDARD-COMMAREA       09580077
095900                                    RC287AI.                      09590077
096000                                                                  09600020
096100     IF DP030-RC-CALL-SUCCESSFUL OR                               09610020
096200        DP030-RC-APPL-ERROR                                       09620020
096300         CONTINUE                                                 09630020
096400     ELSE                                                         09640020
096500         SET DP013-CICS-ABEND                                     09650020
096600             DP013-ROLLBACK                                       09660020
096700             DP013-XCTL-DISPLAY-RESTART                           09670020
096800                                 TO TRUE                          09680020
096900         MOVE '0001-CALL-CICS-ARCH-API'                           09690020
097000                                 TO DP013-PARAGRAPH               09700020
097020         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O09702077
097030-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09703077
097300         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        09730020
097400                                                                  09740020
097500         PERFORM DP013-0000-PROCESS-ABEND.                        09750020
097600                                                                  09760020
097700 1000-CONTROL-PROCESSING.                                         09770020
097800                                                                  09780020
097900     EVALUATE TRUE                                                09790020
098000                                                                  09800020
098100         WHEN DP030-RC-APPL-ERROR                                 09810020
098200              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       09820020
098300                                 TO PV-TOP-ITEM                   09830020
098400              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      09840020
098500                                                                  09850020
098600              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                09860020
098700                                                                  09870020
098800              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  09880020
098900                                                                  09890020
099000              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09900020
099100                                                                  09910020
099200                                                                  09920020
099300         WHEN DP020-NEXT-ACT-INITIAL                              09930020
099400              INITIALIZE ASC-SPECIFIC-COMMAREA                    09940020
099500              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              09950020
099600                                    ASC-SEL-TERM-ID               09960020
099700              MOVE DP020-SRC-TASK-NUMBER                          09970020
099800                                 TO ASC-LIST-TASK-NUMBER          09980020
099900                                    ASC-SEL-TASK-NUMBER           09990020
100000              MOVE PC-LIST-QUEUE-SEQ                              10000020
100100                                 TO ASC-LIST-SEQ                  10010020
100200              MOVE PC-SEL-QUEUE-SEQ                               10020020
100300                                 TO ASC-SEL-SEQ                   10030020
100400              SET PS-NO-ERROR    TO TRUE                          10040020
100500                                                                  10050020
100600              PERFORM 1100-PROCESS-INTER-APPL-COMM                10060020
100700                                                                  10070020
100800              IF  PS-COMMAREA-NOT-VALID                           10080020
100900                  SET DP020-MSG-FATAL                             10090020
101000                      DP020-NEXT-ACT-APPL-ERROR                   10100020
101100                                    TO TRUE                       10110020
101200              ELSE                                                10120020
101300                  PERFORM 4000-BUILD-INITIAL-PANEL                10130020
101400              END-IF                                              10140020
101500                                                                  10150020
101600                                                                  10160020
101700         WHEN DP020-NEXT-ACT-READ-MAP                             10170020
101800              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10180020
101900                                 TO PV-TOP-ITEM                   10190020
102000                                                                  10200020
102100              PERFORM 2000-PROCESS-PANEL                          10210020
102200                                                                  10220020
102300                                                                  10230020
102400         WHEN DP020-NEXT-ACT-RETURN                               10240020
102500              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10250020
102600                                 TO PV-TOP-ITEM                   10260020
102700              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      10270020
102800                                                                  10280020
102900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  10290020
103000                                                                  10300020
103100              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10310020
103200                                                                  10320020
103300                                                                  10330020
103400         WHEN OTHER                                               10340020
103500              SET DP013-LOGIC-ABEND                               10350020
103600                  DP013-ROLLBACK                                  10360020
103700                                 TO TRUE                          10370020
103800              MOVE '1000-CONTROL-PROCESSING'                      10380020
103900                                 TO DP013-PARAGRAPH               10390020
104000              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   10400020
104100                                 TO DP013-MESSAGE-TEXT(1)         10410020
104200                                                                  10420020
104300              PERFORM DP013-0000-PROCESS-ABEND                    10430020
104400                                                                  10440020
104500     END-EVALUATE.                                                10450020
104600                                                                  10460020
104700 1100-PROCESS-INTER-APPL-COMM.                                    10470020
104800                                                                  10480020
104900     SET PS-COMMAREA-VALID       TO TRUE.                         10490020
105000     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       10500020
105100     EVALUATE DP020-INT-APPL-FORMAT-IND                           10510020
105200         WHEN PC-INTER-APPL-PTICK-QUEUE                           10520020
105300             MOVE DP020-LOCATION-NBR                              10530064
105400                                 TO ASC-KEY-OPER-UNT-ID           10540020
105500             MOVE '0001'         TO ASC-KEY-FCLTY-ID              10550020
105600             PERFORM 1200-ESTABLISH-ASC-AREA                      10560020
105700         WHEN OTHER                                               10570020
105800             SET PS-COMMAREA-NOT-VALID                            10580020
105900                                 TO TRUE                          10590020
106000     END-EVALUATE.                                                10600020
106100                                                                  10610020
106200*----------------------------------------------------------------*10620020
106300*  ENTRY IS FROM A LIST. GET THE KEYS FROM THE TEMP STORAGE      *10630020
106400*  QUEUE PASSED FROM THE LIST.                                   *10640020
106500*----------------------------------------------------------------*10650020
106600                                                                  10660020
106700 1120-PREPARE-LIST-ENTRY.                                         10670020
106800      MOVE PC016-MAX-ITEMS         TO ASC-SEL-SUB.                10680020
106900      MOVE ZERO                    TO ASC-SEL-ITEM.               10690020
107000                                                                  10700020
107100 1200-ESTABLISH-ASC-AREA.                                         10710020
107200     MOVE RC030-SEL-PO-REQ-NBR     TO ASC-KEY-PO-REQ-NBR.         10720020
107300     MOVE RC030-SEL-PO-NBR         TO ASC-KEY-PO-NBR-N.           10730020
107400     MOVE RC030-VENDOR-NAME        TO ASC-KEY-VENDOR-NAME.        10740020
107500                                                                  10750020
107600 2000-PROCESS-PANEL.                                              10760020
107700                                                                  10770020
107800     EVALUATE TRUE                                                10780020
107900                                                                  10790020
108000         WHEN DP020-SRC-AID = DP016-CLEAR                         10800020
108100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      10810020
108200                                                                  10820020
108300              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  10830020
108400                                                                  10840020
108500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                10850020
108600                                                                  10860020
108700                                                                  10870020
108800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10880020
108900                                                                  10890020
109000             PERFORM 2050-DELETE-LIST-QUEUE                       10900020
109100             EVALUATE DP020-INT-APPL-FORMAT-IND                   10910020
109200                 WHEN PC-INTER-APPL-PTICK-QUEUE                   10920020
109300                     MOVE DP020-LOCATION-NBR                      10930064
109400                                         TO ASC-KEY-OPER-UNT-ID   10940020
109500                     MOVE '0001'         TO ASC-KEY-FCLTY-ID      10950020
109600                     PERFORM 1200-ESTABLISH-ASC-AREA              10960020
109700                 WHEN OTHER                                       10970020
109800                     SET PS-COMMAREA-NOT-VALID                    10980020
109900                                         TO TRUE                  10990020
110000             END-EVALUATE                                         11000020
110100                                                                  11010020
110200             PERFORM 4000-BUILD-INITIAL-PANEL                     11020020
110300                                                                  11030020
110400* WHEN DELETE COLOR KEY IS PRESSED                                11040020
110500         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              11050020
110600* WHEN DELETE SIZE KEY IS PRESSED                                 11060020
110700         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11070020
110800                                                                  11080020
110900              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                11090020
111000                                                                  11100020
111100              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11110020
111200                                                                  11120020
111300              PERFORM 2170-REMOVE-COLOR-SIZE                      11130020
111400                                                                  11140020
111500                                                                  11150020
111600         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   11160020
111700                                                                  11170020
111800              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                11180020
111900                                                                  11190020
112000              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11200020
112100                                                                  11210020
112200              PERFORM 2140-DESELECT-ALL-ITEMS                     11220020
112300                                                                  11230020
112400              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11240020
112500                                                                  11250020
112600                                                                  11260020
112700         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 11270020
112800                                                                  11280020
112900              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                11290020
113000                                                                  11300020
113100              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11310020
113200                                                                  11320020
113300              PERFORM 2150-SELECT-ALL-ITEMS                       11330020
113400                                                                  11340020
113500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11350020
113600                                                                  11360020
113700                                                                  11370020
113800                                                                  11380020
113900         WHEN OTHER                                               11390020
114000                                                                  11400020
114100              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                11410020
114200                                                                  11420020
114300              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11430020
114400                                                                  11440020
114500              IF PS-NO-ERROR                                      11450020
114600                  SET DP030-CONTINUE-GO                           11460020
114700                                 TO TRUE                          11470020
114800                                                                  11480020
114900                  PERFORM 2100-CHECK-FUNCTION-KEY                 11490020
115000                                                                  11500020
115100              ELSE                                                11510020
115200                  SET DP030-OVERRIDE-GO                           11520020
115300                                 TO TRUE                          11530020
115400              END-IF                                              11540020
115500                                                                  11550020
115600     END-EVALUATE.                                                11560020
115700                                                                  11570020
115800 2050-DELETE-LIST-QUEUE.                                          11580020
115900                                                                  11590020
116000     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             11600020
116100                          RESP  (PV-CICS-RESP)                    11610020
116200                          END-EXEC.                               11620020
116300                                                                  11630020
116400     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      11640020
116500        (PV-CICS-RESP = DFHRESP (QIDERR))                         11650020
116600         CONTINUE                                                 11660020
116700     ELSE                                                         11670020
116800         SET DP013-CICS-ABEND                                     11680020
116900             DP013-ROLLBACK      TO TRUE                          11690020
117000         MOVE '2050-DELETE-LIST-QUEUE'                            11700020
117100                                 TO DP013-PARAGRAPH               11710020
117200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 11720020
117300                                 TO DP013-MESSAGE-TEXT (1)        11730020
117400                                                                  11740020
117500         PERFORM DP013-0000-PROCESS-ABEND                         11750020
117600     END-IF.                                                      11760020
117700                                                                  11770020
117800     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    11780020
117900                                                                  11790020
118000 2100-CHECK-FUNCTION-KEY.                                         11800020
118100                                                                  11810020
118200     EVALUATE TRUE                                                11820020
118300         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 11830020
118400              INITIALIZE PO017-INTER-APPL-COMMAREA                11840020
118500              MOVE ASC-KEY-PO-NBR-N                               11850020
118600                                 TO PO017-PO-NBR                  11860020
118700                                                                  11870020
118800* IF THE PRINT TICKETS KEY WAS PRESSED                            11880020
118900         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              11890020
119000              IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO              11900020
119100                 PERFORM 7400-GET-TICKET-OFFICE                   11910020
119200                 EVALUATE TRUE                                    11920020
119300* THE FIRST LINE PRINTED FOR THE REQUEST - UPDATE THE REQUEST     11930020
119400* WITH THE INPROCESS STATUS CODE AND THE PRINT TICKET OFFICE.     11940020
119500* THEN PRINT THE PAPER WORK, AND PRINT THE TICKETS                11950020
119600                 WHEN ASC-PRINT-TKT-OFFICE = SPACES               11960020
119700                    MOVE 'I' TO ASC-REQ-STAT-CDE                  11970020
119800                    MOVE ASC-TKT-OFFICE TO ASC-PRINT-TKT-OFFICE   11980020
119900                    PERFORM 7300-UPDATE-STATUS-CODE               11990020
120000                    IF SQLCODE = 0                                12000020
120100                       PERFORM 8000-START-PO-PRINT-PGM            12010040
120200                       PERFORM 4500-PROCESS-TICKET-REQ            12020020
120300                    END-IF                                        12030020
120400                                                                  12040020
120500* THE REQUEST HAS ALREADY BEEN STARTED BY THIS OFFICE - JUST      12050020
120600* PRINT THE SELECTED LINES.                                       12060020
120700                 WHEN ASC-PRINT-TKT-OFFICE = ASC-TKT-OFFICE       12070020
120800                       PERFORM 4500-PROCESS-TICKET-REQ            12080020
120900* THE REQUEST HAS ALREADY BEEN STARTED BY A DIFFERENT OFFICE -    12090020
121000* DISPLAY ERROR                                                   12100020
121100                 WHEN OTHER                                       12110020
121200                     MOVE PC-TSYMSG-01464                         12120020
121300                                 TO DP020-MSG-NUMBER              12130020
121400                     MOVE ASC-PRINT-TKT-OFFICE                    12140020
121500                                 TO DP020-MSG-TEXT                12150020
121600                     SET DP030-SET-CURSOR-APPL-1                  12160020
121700                                 TO TRUE                          12170020
121800                     SET PS-ERROR                                 12180020
121900                         DP020-MSG-FATAL                          12190020
122000                                 TO TRUE                          12200020
122100                                                                  12210020
122200                 END-EVALUATE                                     12220020
122300              ELSE                                                12230020
122400                 IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO           12240020
122500                    SET ASC-NO-TSQ-UPDATE                         12250020
122600                                 TO TRUE                          12260020
122700                    SET DP030-OVERRIDE-GO                         12270020
122800                        DP020-MSG-WARNING                         12280020
122900                                 TO TRUE                          12290020
123000                    MOVE PC-TSYMSG-00057                          12300020
123100                                 TO DP020-MSG-NUMBER              12310020
123200                 END-IF                                           12320020
123300              END-IF                                              12330020
123400                                                                  12340020
123500                                                                  12350020
123600         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 12360020
123700             MOVE +1             TO PV-TOP-ITEM                   12370020
123800                                                                  12380020
123900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12390020
124000                                                                  12400020
124100             PERFORM 3200-RESET-ATTRIBUTES                        12410020
124200                                                                  12420020
124300                                                                  12430020
124400         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  12440020
124500                                                                  12450020
124600             PERFORM 2110-BROWSE-BACKWARD                         12460020
124700                                                                  12470020
124800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12480020
124900                                                                  12490020
125000             PERFORM 3200-RESET-ATTRIBUTES                        12500020
125100                                                                  12510020
125200                                                                  12520020
125300         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  12530020
125400                                                                  12540020
125500             PERFORM 2120-BROWSE-FORWARD                          12550020
125600                                                                  12560020
125700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 12570020
125800                                                                  12580020
125900             PERFORM 3200-RESET-ATTRIBUTES                        12590020
126000                                                                  12600020
126100                                                                  12610020
126200         WHEN DP020-SRC-AID = DP016-ENTER                         12620020
126300                                                                  12630020
126400             PERFORM 2160-CHECK-FOR-JUMP-BROWSE                   12640020
126500                                                                  12650020
126600             IF PS-NO-ERROR                                       12660020
126700                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             12670020
126800             END-IF                                               12680020
126900                                                                  12690020
127000                                                                  12700020
127100         WHEN OTHER                                               12710020
127200             SET DP013-CICS-ABEND                                 12720020
127300                 DP013-ROLLBACK                                   12730020
127400                 DP013-XCTL-DISPLAY-RESTART                       12740020
127500                                 TO TRUE                          12750020
127600             MOVE '2100-CHECK-FUNCTION-KEY'                       12760020
127700                                 TO DP013-PARAGRAPH               12770020
127800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      12780020
127900                                 TO DP013-MESSAGE-TEXT (1)        12790020
128000                                                                  12800020
128100             PERFORM DP013-0000-PROCESS-ABEND                     12810020
128200     END-EVALUATE.                                                12820020
128300                                                                  12830020
128400 2110-BROWSE-BACKWARD.                                            12840020
128500                                                                  12850020
128600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    12860020
128700         GIVING PV-TOP-ITEM.                                      12870020
128800                                                                  12880020
128900     IF PV-TOP-ITEM NOT > +1                                      12890020
129000         MOVE +1                 TO PV-TOP-ITEM                   12900020
129100         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              12910020
129200         SET DP020-MSG-INFORMATIONAL                              12920020
129300                                 TO TRUE.                         12930020
129400                                                                  12940020
129500 2120-BROWSE-FORWARD.                                             12950020
129600                                                                  12960020
129700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              12970020
129800         GIVING PV-TOP-ITEM.                                      12980020
129900                                                                  12990020
130000     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    13000020
130100         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            13010020
130200                                 TO PV-TOP-ITEM                   13020020
130300         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              13030020
130400         SET DP020-MSG-INFORMATIONAL                              13040020
130500                                 TO TRUE                          13050020
130600     ELSE                                                         13060020
130700         COMPUTE PV-BOTTOM-ITEM =                                 13070020
130800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 13080020
130900         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             13090020
131000             MOVE PC-TSYMSG-00070                                 13100020
131100                                 TO DP020-MSG-NUMBER              13110020
131200             SET DP020-MSG-INFORMATIONAL                          13120020
131300                                 TO TRUE.                         13130020
131400 2140-DESELECT-ALL-ITEMS.                                         13140020
131500                                                                  13150020
131600     MOVE +1                     TO ASC-BLK-SUB.                  13160020
131700                                                                  13170020
131800     PERFORM 2141-CLEAR-SELECTED-INDS                             13180020
131900             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    13190020
132000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13200020
132100                                                                  13210020
132200     ADD +1                      TO ASC-BLK-SUB.                  13220020
132300                                                                  13230020
132400     PERFORM 2141-CLEAR-SELECTED-INDS                             13240020
132500             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    13250020
132600             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           13260020
132700                                                                  13270020
132800     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              13280020
132900                                 TO PV-LIST-ITEM-NUMBER.          13290020
133000                                                                  13300020
133100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13310020
133200             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).13320020
133300                                                                  13330020
133400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13340020
133500              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)13350020
133600         MOVE +1                 TO ASC-BLK-SUB                   13360020
133700                                                                  13370020
133800         PERFORM 5100-WRITE-TEMP-STORAGE                          13380020
133900                                                                  13390020
134000         MOVE +1                 TO PV-BLOCK-NUMBER               13400020
134100                                                                  13410020
134200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13420020
134300                                       PV-FIRST-BLOCK-IN-ARRAY - 113430020
134400                                                                  13440020
134500         PERFORM                                                  13450020
134600           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         13460020
134700                                                                  13470020
134800                 PERFORM 4410-READ-TEMP-STORAGE                   13480020
134900                                                                  13490020
135000                 PERFORM 2141-CLEAR-SELECTED-INDS                 13500020
135100                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13510020
135200                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13520020
135300                                                                  13530020
135400                 PERFORM 5100-WRITE-TEMP-STORAGE                  13540020
135500                                                                  13550020
135600                 ADD +1          TO PV-BLOCK-NUMBER               13560020
135700                                                                  13570020
135800         END-PERFORM                                              13580020
135900                                                                  13590020
136000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13600020
136100                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY13610020
136200                                                                  13620020
136300         PERFORM                                                  13630020
136400           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         13640020
136500                                         ASC-HIGHEST-BLOCK-WRITTEN13650020
136600                                                                  13660020
136700                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      13670020
136800                                 TO PV-BLOCK-NUMBER               13680020
136900                                                                  13690020
137000                 PERFORM 4410-READ-TEMP-STORAGE                   13700020
137100                                                                  13710020
137200                 PERFORM 2141-CLEAR-SELECTED-INDS                 13720020
137300                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        13730020
137400                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL13740020
137500                                                                  13750020
137600                 PERFORM 5100-WRITE-TEMP-STORAGE                  13760020
137700                                                                  13770020
137800                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        13780020
137900                                                                  13790020
138000         END-PERFORM                                              13800020
138100                                                                  13810020
138200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13820020
138300                                 TO PV-BLOCK-NUMBER               13830020
138400                                                                  13840020
138500         PERFORM 4410-READ-TEMP-STORAGE                           13850020
138600                                                                  13860020
138700     END-IF.                                                      13870020
138800                                                                  13880020
138900     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  13890020
139000                                    ASC-START-OF-SELECTED-RANGE   13900020
139100                                    ASC-END-OF-SELECTED-RANGE.    13910020
139200                                                                  13920020
139300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13930020
139400                                                                  13940020
139500 2141-CLEAR-SELECTED-INDS.                                        13950020
139600                                                                  13960020
139700     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO13970020
139800        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           13980020
139900            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          13990020
140000                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     14000020
140100                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  14010020
140200                                 TO TRUE.                         14020020
140300                                                                  14030020
140400 2150-SELECT-ALL-ITEMS.                                           14040020
140500                                                                  14050020
140600     MOVE +1                     TO ASC-BLK-SUB.                  14060020
140700                                                                  14070020
140800     PERFORM 2151-SET-SELECTED-INDS                               14080020
140900             VARYING ASC-ITEM-SUB FROM 1 BY 1                     14090020
141000             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14100020
141100                                                                  14110020
141200     ADD +1                      TO ASC-BLK-SUB.                  14120020
141300                                                                  14130020
141400     PERFORM 2151-SET-SELECTED-INDS                               14140020
141500             VARYING ASC-ITEM-SUB FROM 1 BY 1                     14150020
141600             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           14160020
141700                                                                  14170020
141800     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              14180020
141900                                 TO PV-LIST-ITEM-NUMBER.          14190020
142000                                                                  14200020
142100     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14210020
142200             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).14220020
142300                                                                  14230020
142400     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14240020
142500              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)14250020
142600         MOVE +1                 TO ASC-BLK-SUB                   14260020
142700                                                                  14270020
142800         PERFORM 5100-WRITE-TEMP-STORAGE                          14280020
142900                                                                  14290020
143000         MOVE +1                 TO PV-BLOCK-NUMBER               14300020
143100                                                                  14310020
143200         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14320020
143300                                       PV-FIRST-BLOCK-IN-ARRAY - 114330020
143400                                                                  14340020
143500         PERFORM                                                  14350020
143600           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         14360020
143700                                                                  14370020
143800                 PERFORM 4410-READ-TEMP-STORAGE                   14380020
143900                                                                  14390020
144000                 PERFORM 2151-SET-SELECTED-INDS                   14400020
144100                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14410020
144200                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14420020
144300                                                                  14430020
144400                 PERFORM 5100-WRITE-TEMP-STORAGE                  14440020
144500                                                                  14450020
144600                 ADD +1          TO PV-BLOCK-NUMBER               14460020
144700                                                                  14470020
144800         END-PERFORM                                              14480020
144900                                                                  14490020
145000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14500020
145100                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY14510020
145200                                                                  14520020
145300         PERFORM                                                  14530020
145400           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         14540020
145500                                         ASC-HIGHEST-BLOCK-WRITTEN14550020
145600                                                                  14560020
145700                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      14570020
145800                                 TO PV-BLOCK-NUMBER               14580020
145900                                                                  14590020
146000                 PERFORM 4410-READ-TEMP-STORAGE                   14600020
146100                                                                  14610020
146200                 PERFORM 2151-SET-SELECTED-INDS                   14620020
146300                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        14630020
146400                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL14640020
146500                                                                  14650020
146600                 PERFORM 5100-WRITE-TEMP-STORAGE                  14660020
146700                                                                  14670020
146800                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        14680020
146900                                                                  14690020
147000         END-PERFORM                                              14700020
147100                                                                  14710020
147200         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14720020
147300                                 TO PV-BLOCK-NUMBER               14730020
147400                                                                  14740020
147500         PERFORM 4410-READ-TEMP-STORAGE                           14750020
147600     END-IF.                                                      14760020
147700                                                                  14770020
147800     MOVE ASC-NUMBER-OF-ITEMS-READ                                14780020
147900                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 14790020
148000                                                                  14800020
148100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14810020
148200                                                                  14820020
148300 2151-SET-SELECTED-INDS.                                          14830020
148400                                                                  14840020
148500     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO14850020
148600        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              14860020
148700            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             14870020
148800                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        14880020
148900                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  14890020
149000                                 TO TRUE                          14900020
149100        END-IF                                                    14910020
149200     END-IF.                                                      14920020
149300                                                                  14930020
149400                                                                  14940020
149500 2160-CHECK-FOR-JUMP-BROWSE.                                      14950020
149600                                                                  14960020
149700     SET PS-NO-ERROR             TO TRUE.                         14970020
149800                                                                  14980020
149900     IF ASC-START-ITEM-REQUEST = SPACE                            14990020
150000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15000020
150100                                 TO PV-TOP-ITEM                   15010020
150200     ELSE                                                         15020020
150300         MOVE ASC-START-ITEM-REQUEST                              15030020
150400                                 TO DP010I-UNEDITED-FIELD         15040020
150500         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         15050020
150600         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       15060020
150700         SET DP010I-NEGATIVE-NOT-ALLOWED                          15070020
150800                                 TO TRUE                          15080020
150900                                                                  15090020
151100         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15110076
151110              USING DP010I-NUMERIC-EDIT-AREA                      15111076
151120                                                                  15112073
151200         IF NOT DP010I-ERROR-DETECTED                             15120020
151300             MOVE DP010I-NUMERIC-FIELD                            15130020
151400                                 TO ASC-START-ITEM-REQUEST-N      15140020
151500             IF ASC-START-ITEM-REQUEST-N > ZERO                   15150020
151600                IF ASC-START-ITEM-REQUEST-N >                     15160020
151700                                          ASC-NUMBER-OF-ITEMS-READ15170020
151800                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        15180020
151900                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ15190020
152000                                          - PC-ITEMS-PER-PANEL + 115200020
152100                    IF PV-TOP-ITEM < +1                           15210020
152200                        MOVE +1  TO PV-TOP-ITEM                   15220020
152300                        MOVE PC-TSYMSG-00070                      15230020
152400                                 TO DP020-MSG-NUMBER              15240020
152500                        SET DP020-MSG-INFORMATIONAL               15250020
152600                                 TO TRUE                          15260020
152700                    END-IF                                        15270020
152800                ELSE                                              15280020
152900                    MOVE ASC-START-ITEM-REQUEST-N                 15290020
153000                                 TO PV-TOP-ITEM                   15300020
153100                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        15310020
153200                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        15320020
153300                                            PC-ITEMS-PER-PANEL - 115330020
153400                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  15340020
153500                         MOVE PC-TSYMSG-00070                     15350020
153600                                 TO DP020-MSG-NUMBER              15360020
153700                         SET DP020-MSG-INFORMATIONAL              15370020
153800                                 TO TRUE                          15380020
153900                    END-IF                                        15390020
154000                END-IF                                            15400020
154100             ELSE                                                 15410020
154200                 MOVE PC-TSYMSG-00101                             15420020
154300                                 TO DP020-MSG-NUMBER              15430020
154400                 SET DP030-SET-CURSOR-APPL-1                      15440020
154500                                 TO TRUE                          15450020
154600                 MOVE -1         TO ASTRTITL                      15460020
154700                 MOVE DP015-UNP-NUM-BRT-MDT                       15470020
154800                                 TO ASTRTITA                      15480020
154900                 MOVE DP015-RED  TO ASTRTITC                      15490020
155000                 MOVE DP015-REVERSE                               15500020
155100                                 TO ASTRTITH                      15510020
155200                 SET PS-ERROR                                     15520020
155300                     DP020-MSG-FATAL                              15530020
155400                                 TO TRUE                          15540020
155500             END-IF                                               15550020
155600         ELSE                                                     15560020
155700             MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER             15570020
155800             SET DP030-SET-CURSOR-APPL-1                          15580020
155900                                 TO TRUE                          15590020
156000             MOVE -1             TO ASTRTITL                      15600020
156100             MOVE DP015-UNP-NUM-BRT-MDT                           15610020
156200                                 TO ASTRTITA                      15620020
156300             MOVE DP015-RED      TO ASTRTITC                      15630020
156400             MOVE DP015-REVERSE  TO ASTRTITH                      15640020
156500             SET PS-ERROR                                         15650020
156600                 DP020-MSG-FATAL TO TRUE                          15660020
156700         END-IF                                                   15670020
156800     END-IF.                                                      15680020
156900                                                                  15690020
157000 2170-REMOVE-COLOR-SIZE.                                          15700020
157100                                                                  15710020
157200     MOVE +1                     TO ASC-BLK-SUB.                  15720020
157300                                                                  15730020
157400     PERFORM 2171-CHANGE-COLOR-SIZE                               15740020
157500             VARYING ASC-ITEM-SUB FROM 1 BY 1                     15750020
157600             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           15760020
157700                                                                  15770020
157800     ADD +1                      TO ASC-BLK-SUB.                  15780020
157900                                                                  15790020
158000     PERFORM 2171-CHANGE-COLOR-SIZE                               15800020
158100             VARYING ASC-ITEM-SUB FROM 1 BY 1                     15810020
158200             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           15820020
158300                                                                  15830020
158400     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              15840020
158500                                 TO PV-LIST-ITEM-NUMBER.          15850020
158600                                                                  15860020
158700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15870020
158800             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).15880020
158900                                                                  15890020
159000     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15900020
159100              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)15910020
159200         MOVE +1                 TO ASC-BLK-SUB                   15920020
159300                                                                  15930020
159400         PERFORM 5100-WRITE-TEMP-STORAGE                          15940020
159500                                                                  15950020
159600         MOVE +1                 TO PV-BLOCK-NUMBER               15960020
159700                                                                  15970020
159800         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         15980020
159900                                       PV-FIRST-BLOCK-IN-ARRAY - 115990020
160000                                                                  16000020
160100         PERFORM                                                  16010020
160200           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         16020020
160300                                                                  16030020
160400                 PERFORM 4410-READ-TEMP-STORAGE                   16040020
160500                                                                  16050020
160600                 PERFORM 2171-CHANGE-COLOR-SIZE                   16060020
160700                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16070020
160800                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16080020
160900                                                                  16090020
161000                 PERFORM 5100-WRITE-TEMP-STORAGE                  16100020
161100                                                                  16110020
161200                 ADD +1          TO PV-BLOCK-NUMBER               16120020
161300                                                                  16130020
161400         END-PERFORM                                              16140020
161500                                                                  16150020
161600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16160020
161700                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY16170020
161800                                                                  16180020
161900         PERFORM                                                  16190020
162000           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         16200020
162100                                         ASC-HIGHEST-BLOCK-WRITTEN16210020
162200                                                                  16220020
162300                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      16230020
162400                                 TO PV-BLOCK-NUMBER               16240020
162500                                                                  16250020
162600                 PERFORM 4410-READ-TEMP-STORAGE                   16260020
162700                                                                  16270020
162800                 PERFORM 2171-CHANGE-COLOR-SIZE                   16280020
162900                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16290020
163000                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16300020
163100                                                                  16310020
163200                 PERFORM 5100-WRITE-TEMP-STORAGE                  16320020
163300                                                                  16330020
163400                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        16340020
163500                                                                  16350020
163600         END-PERFORM                                              16360020
163700                                                                  16370020
163800         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16380020
163900                                 TO PV-BLOCK-NUMBER               16390020
164000                                                                  16400020
164100         PERFORM 4410-READ-TEMP-STORAGE                           16410020
164200     END-IF.                                                      16420020
164300                                                                  16430020
164400     MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL.                       16440020
164500     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16450020
164600                                                                  16460020
164700 2171-CHANGE-COLOR-SIZE.                                          16470020
164800                                                                  16480020
164900     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO16490020
165000     AND ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                    16500020
165100* WHEN CHANGE THE COLOR DISPLAY IND IF THE COLOR KEY IS PRESSED   16510020
165200         IF DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                16520020
165300             IF ASC-DISP-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)         16530020
165400                 SET ASC-DONT-DISP-COLOR                          16540020
165500                     (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE          16550020
165600             ELSE                                                 16560020
165700                 SET ASC-DISP-COLOR                               16570020
165800                     (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE          16580020
165900             END-IF                                               16590020
166000         ELSE                                                     16600020
166100* WHEN CHANGE THE SIZE DISPLAY IND IF THE SIZE KEY IS PRESSED     16610020
166200             IF ASC-DISP-SIZE (ASC-BLK-SUB ASC-ITEM-SUB)          16620020
166300                 SET ASC-DONT-DISP-SIZE                           16630020
166400                     (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE          16640020
166500             ELSE                                                 16650020
166600                 SET ASC-DISP-SIZE                                16660020
166700                     (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE          16670020
166800             END-IF                                               16680020
166900         END-IF                                                   16690020
167000         SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                     16700020
167100                                 TO TRUE                          16710020
167200     END-IF.                                                      16720020
167300                                                                  16730020
167400 2200-MOVE-SCREEN-TO-COMMAREA.                                    16740020
167500                                                                  16750020
167600     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               16760020
167700     MOVE +1                     TO PV-SUB.                       16770020
167800                                                                  16780020
167900     PERFORM 3100-SET-SUBSCRIPTS.                                 16790020
168000                                                                  16800020
168100     IF ALOCATNL > ZERO                                           16810020
168200         MOVE ALOCATNI           TO ASC-LOCATION                  16820020
168300     ELSE                                                         16830020
168400         IF ALOCATNF = DP015-ERASE-EOF                            16840020
168500             MOVE SPACES         TO ASC-LOCATION                  16850020
168600         END-IF                                                   16860020
168700     END-IF.                                                      16870020
168800                                                                  16880020
168900     IF  ATKTOFFL > ZERO                                          16890020
169000         MOVE  ATKTOFFI          TO ASC-TKT-OFFICE                16900020
169100     ELSE                                                         16910020
169200         IF  ATKTOFFF = DP015-ERASE-EOF                           16920020
169300             MOVE SPACES         TO ASC-TKT-OFFICE                16930020
169400         END-IF                                                   16940020
169500     END-IF.                                                      16950020
169600                                                                  16960020
169700                                                                  16970020
169800*DH  IF ASSNCDEL > ZERO                                           16980022
169900*DH      MOVE ASSNCDEI           TO ASC-SEASON-CDE                16990022
170000*DH  ELSE                                                         17000022
170100*DH      IF ASSNCDEF = DP015-ERASE-EOF                            17010022
170200*DH          MOVE SPACES         TO ASC-SEASON-CDE                17020022
170300*DH      END-IF                                                   17030022
170400*DH  END-IF.                                                      17040022
170500                                                                  17050020
170600     IF  AXTKTSL > ZERO                                           17060020
170700         MOVE AXTKTSI            TO ASC-EXTRA-TKTS                17070020
170800     ELSE                                                         17080020
170900         IF  AXTKTSF = DP015-ERASE-EOF                            17090020
171000             MOVE SPACES         TO ASC-EXTRA-TKTS                17100020
171100         END-IF                                                   17110020
171200     END-IF.                                                      17120020
171300                                                                  17130020
171400     IF AXTKTPCL > ZERO                                           17140020
171500         MOVE AXTKTPCI           TO ASC-EXTRA-TKT-PCT             17150020
171600     ELSE                                                         17160020
171700         IF AXTKTPCF = DP015-ERASE-EOF                            17170020
171800             MOVE SPACES         TO ASC-EXTRA-TKT-PCT             17180020
171900         END-IF                                                   17190020
172000     END-IF.                                                      17200020
172100                                                                  17210020
172200                                                                  17220020
172300     IF ASTRTITL > ZERO                                           17230020
172400         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        17240020
172500     ELSE                                                         17250020
172600         IF ASTRTITF = DP015-ERASE-EOF                            17260020
172700             INITIALIZE ASC-START-ITEM-REQUEST                    17270020
172800         END-IF                                                   17280020
172900     END-IF.                                                      17290020
173000                                                                  17300020
173100     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          17310020
173200             VARYING PV-SUB  FROM 1 BY 1                          17320020
173300             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                17330020
173400                                                                  17340020
173500 2210-MOVE-LINES-TO-COMMAREA.                                     17350020
173600                                                                  17360020
173700     IF MR-SELECTL (PV-SUB) > ZERO                                17370020
173800         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  17380020
173900                                 TO TRUE                          17390020
174000         MOVE MR-SELECTI (PV-SUB)                                 17400020
174100                                 TO ASC-TEMP-SELECTED-SW          17410020
174200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17420020
174300     ELSE                                                         17430020
174400         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 17440020
174500             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 17450020
174600                                 TO TRUE                          17460020
174700             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          17470020
174800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17480020
174900         END-IF                                                   17490020
175000     END-IF.                                                      17500020
175100                                                                  17510020
175200     IF MR-QUANT-L        (PV-SUB) > ZERO                         17520020
175300         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  17530020
175400                                 TO TRUE                          17540020
175500         MOVE MR-QUANT        (PV-SUB)                            17550020
175600                                 TO  ASC-UNT-QTY                  17560020
175700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17570020
175800     ELSE                                                         17580020
175900         IF   MR-QUANT-A      (PV-SUB) = DP015-ERASE-EOF          17590020
176000             MOVE ZEROS          TO  ASC-UNT-QTY                  17600020
176100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     17610020
176200             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              17620020
176300                                 TO TRUE                          17630020
176400         END-IF                                                   17640020
176500     END-IF.                                                      17650020
176600                                                                  17660020
176700     ADD +1                      TO ASC-ITEM-SUB.                 17670020
176800                                                                  17680020
176900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         17690020
177000         ADD  +1                 TO ASC-BLK-SUB                   17700020
177100         MOVE +1                 TO ASC-ITEM-SUB                  17710020
177200     END-IF.                                                      17720020
177300                                                                  17730020
177400/                                                                 17740020
177500******************************************************************17750020
177600* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *17760020
177700* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *17770020
177800******************************************************************17780020
177900 2300-GET-NEXT-RECORD.                                            17790020
178000                                                                  17800020
178100     ADD +1                        TO ASC-SEL-SUB.                17810020
178200     IF ASC-SEL-SUB > PC016-MAX-ITEMS                             17820020
178300         ADD +1                    TO ASC-SEL-ITEM                17830020
178400         MOVE +1                   TO ASC-SEL-SUB                 17840020
178500     END-IF.                                                      17850020
178600     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 17860020
178700         PERFORM 9100-READ-SEL-QUEUE                              17870020
178800         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       17880020
179100             MOVE PC016-CL (ASC-SEL-SUB) TO  PURITM-CL-NBR        17910048
179200             MOVE PC016-GP-QTY (ASC-SEL-SUB)                      17920020
179300                                         TO  PURITM-GP-QTY        17930020
179400             MOVE PC016-GP-RTL-AMT (ASC-SEL-SUB)                  17940020
179500                                         TO  PURITM-GP-RTL-AMT    17950020
179600             MOVE PC016-UNT-RTL-PR-AMT (ASC-SEL-SUB)              17960020
179700                                         TO  PURITM-UNT-RTL-PR-AMT17970020
179800             MOVE PC016-ITM-NBR (ASC-SEL-SUB)                     17980020
179900                                         TO  PURITM-ITM-NBR       17990020
180000             MOVE PC016-VEND-STYL-NAME (ASC-SEL-SUB)              18000020
180100                                         TO  PURITM-VEND-STYL-NAME18010020
180200             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  18020020
180300                                         TO  PURITM-APP-PO-LNE-NBR18030020
180800             PERFORM 9200-REWRITE-LIST-QUEUE                      18080020
180900         ELSE                                                     18090020
181000              SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                 18100020
181100         END-IF                                                   18110020
181200     ELSE                                                         18120020
181300         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      18130020
181400     END-IF.                                                      18140020
181500                                                                  18150020
181600 3000-EDIT-DATA-IN-COMMAREA.                                      18160020
181700                                                                  18170020
181800     SET PS-NO-ERROR             TO TRUE.                         18180020
181900                                                                  18190020
182000     PERFORM 3200-RESET-ATTRIBUTES.                               18200020
182100                                                                  18210020
182200     MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              18220020
182300     MOVE ASC-KEY-FCLTY-ID        TO DK-FCLTY-ID.                 18230020
182400                                                                  18240020
185700     IF ASC-TKT-OFFICE NOT = SPACES                               18570020
185701*                                                                 18570170
185702*** DMH 2018/01/18 - BEGIN                                        18570270
185703*                                                                 18570370
185704         SET  PS-VALID-TICKET-OFFICE-NO  TO  TRUE                 18570470
185710         PERFORM 3010-VALIDATE-TKT-OFFICE                         18571070
185900         IF  PS-VALID-TICKET-OFFICE-NO                            18590070
185910*                                                                 18591070
185920*** DMH 2018/01/18 - BEGIN                                        18592070
185930*                                                                 18593070
186000             SET PS-ERROR                                         18600020
186100                 DP020-MSG-FATAL TO TRUE                          18610020
186200             MOVE PC-TSYMSG-00005                                 18620020
186300                                 TO DP020-MSG-NUMBER              18630020
186400             MOVE DP015-UNP-ALP-BRT-OFF                           18640020
186500                                 TO ATKTOFFA                      18650020
186600             MOVE DP015-RED      TO ATKTOFFC                      18660020
186700             MOVE DP015-REVERSE  TO ATKTOFFH                      18670020
186800             MOVE -1             TO ATKTOFFL                      18680020
186900             SET DP030-SET-CURSOR-APPL-1                          18690020
187000                                 TO TRUE                          18700020
187100         END-IF                                                   18710020
187200     ELSE                                                         18720020
187300         SET PS-ERROR                                             18730020
187400             DP020-MSG-FATAL TO TRUE                              18740020
187500         MOVE PC-TSYMSG-00007                                     18750020
187600                             TO DP020-MSG-NUMBER                  18760020
187700         MOVE DP015-UNP-ALP-BRT-OFF                               18770020
187800                             TO ATKTOFFA                          18780020
187900         MOVE DP015-RED      TO ATKTOFFC                          18790020
188000         MOVE DP015-REVERSE  TO ATKTOFFH                          18800020
188100         MOVE -1             TO ATKTOFFL                          18810020
188200         SET DP030-SET-CURSOR-APPL-1                              18820020
188300                             TO TRUE                              18830020
188400     END-IF.                                                      18840020
188500                                                                  18850020
188600     IF ASC-EXTRA-TKT-PCT NOT = SPACES                            18860020
188700         MOVE ASC-EXTRA-TKT-PCT TO DP010I-UNEDITED-FIELD          18870020
188800         MOVE LENGTH OF ASC-EXTRA-TKT-PCT                         18880020
188900                                 TO DP010I-MAXIMUM-DIGITS         18890020
189000         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       18900020
189100         SET DP010I-NEGATIVE-NOT-ALLOWED                          18910020
189200                                 TO TRUE                          18920020
189310         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18931076
189320              USING DP010I-NUMERIC-EDIT-AREA                      18932076
189400         IF  DP010I-ERROR-DETECTED                                18940020
189500             SET PS-ERROR                                         18950020
189600                 DP020-MSG-FATAL TO TRUE                          18960020
189700             MOVE PC-TSYMSG-00008                                 18970020
189800                                 TO DP020-MSG-NUMBER              18980020
189900             MOVE DP015-UNP-ALP-BRT-OFF                           18990020
190000                                 TO AXTKTPCA                      19000020
190100             MOVE DP015-RED      TO AXTKTPCC                      19010020
190200             MOVE DP015-REVERSE  TO AXTKTPCH                      19020020
190300             MOVE -1             TO AXTKTPCL                      19030020
190400             SET DP030-SET-CURSOR-APPL-1                          19040020
190500                                 TO TRUE                          19050020
190600         ELSE                                                     19060020
190700             MOVE DP010I-NUMERIC-FIELD                            19070020
190800                                 TO ASC-EXTRA-TKT-PCT-N           19080020
190900             MOVE ASC-EXTRA-TKT-PCT-N                             19090020
191000                                 TO AXTKTPCO                      19100020
191100             IF ASC-EXTRA-TKT-PCT-N >                             19110020
191200                               PC-MAX-EXTRA-TICKET-PERCENT        19120020
191300                 SET PS-ERROR                                     19130020
191400                     DP020-MSG-FATAL TO TRUE                      19140020
191500                 MOVE PC-TSYMSG-00005                             19150020
191600                                     TO DP020-MSG-NUMBER          19160020
191700                 MOVE DP015-UNP-ALP-BRT-OFF                       19170020
191800                                     TO AXTKTPCA                  19180020
191900                 MOVE DP015-RED      TO AXTKTPCC                  19190020
192000                 MOVE DP015-REVERSE  TO AXTKTPCH                  19200020
192100                 MOVE -1             TO AXTKTPCL                  19210020
192200                 SET DP030-SET-CURSOR-APPL-1                      19220020
192300                                     TO TRUE                      19230020
192400             END-IF                                               19240020
192500         END-IF                                                   19250020
192600     END-IF.                                                      19260020
192700                                                                  19270020
192800     IF ASC-EXTRA-TKTS NOT = SPACES                               19280020
192900         MOVE ASC-EXTRA-TKTS TO DP010I-UNEDITED-FIELD             19290020
193000         MOVE LENGTH OF ASC-EXTRA-TKTS                            19300020
193100                                 TO DP010I-MAXIMUM-DIGITS         19310020
193200         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       19320020
193300         SET DP010I-NEGATIVE-NOT-ALLOWED                          19330020
193400                                 TO TRUE                          19340020
193510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         19351076
193520              USING DP010I-NUMERIC-EDIT-AREA                      19352076
193600         IF  DP010I-ERROR-DETECTED                                19360020
193700             SET PS-ERROR                                         19370020
193800                 DP020-MSG-FATAL TO TRUE                          19380020
193900             MOVE PC-TSYMSG-00008                                 19390020
194000                                 TO DP020-MSG-NUMBER              19400020
194100             MOVE DP015-UNP-ALP-BRT-OFF                           19410020
194200                                 TO AXTKTSA                       19420020
194300             MOVE DP015-RED      TO AXTKTSC                       19430020
194400             MOVE DP015-REVERSE  TO AXTKTSH                       19440020
194500             MOVE -1             TO AXTKTSL                       19450020
194600             SET DP030-SET-CURSOR-APPL-1                          19460020
194700                                 TO TRUE                          19470020
194800         ELSE                                                     19480020
194900             MOVE DP010I-NUMERIC-FIELD                            19490020
195000                                 TO ASC-EXTRA-TKTS-N              19500020
195100             MOVE ASC-EXTRA-TKTS-N                                19510020
195200                                 TO AXTKTSO                       19520020
195300         END-IF                                                   19530020
195400     END-IF.                                                      19540020
195500                                                                  19550020
195600     IF ASC-EXTRA-TKTS NOT = SPACES AND                           19560020
195700        ASC-EXTRA-TKTS NOT = ZERO AND                             19570020
195800        ASC-EXTRA-TKT-PCT NOT = SPACES AND                        19580020
195900        ASC-EXTRA-TKT-PCT NOT = ZERO                              19590020
196000         SET PS-ERROR                                             19600020
196100             DP020-MSG-FATAL TO TRUE                              19610020
196200         MOVE PC-TSYMSG-00005                                     19620020
196300                             TO DP020-MSG-NUMBER                  19630020
196400         MOVE DP015-UNP-ALP-BRT-OFF                               19640020
196500                             TO AXTKTSA                           19650020
196600         MOVE DP015-RED      TO AXTKTSC                           19660020
196700         MOVE DP015-REVERSE  TO AXTKTSH                           19670020
196800         MOVE -1             TO AXTKTSL                           19680020
196900         SET DP030-SET-CURSOR-APPL-1                              19690020
197000                             TO TRUE                              19700020
197100         MOVE DP015-UNP-ALP-BRT-OFF                               19710020
197200                             TO AXTKTPCA                          19720020
197300         MOVE DP015-RED      TO AXTKTPCC                          19730020
197400         MOVE DP015-REVERSE  TO AXTKTPCH                          19740020
197500     END-IF.                                                      19750020
197600                                                                  19760020
197700     IF ASC-LOCATION = SPACES                                     19770020
197800         SET PS-ERROR                                             19780020
197900             DP020-MSG-FATAL TO TRUE                              19790020
198000         MOVE PC-TSYMSG-00007                                     19800020
198100                             TO DP020-MSG-NUMBER                  19810020
198200         MOVE DP015-UNP-ALP-BRT-OFF                               19820020
198300                             TO ALOCATNA                          19830020
198400         MOVE DP015-RED      TO ALOCATNC                          19840020
198500         MOVE DP015-REVERSE  TO ALOCATNH                          19850020
198600         MOVE -1             TO ALOCATNL                          19860020
198700         SET DP030-SET-CURSOR-APPL-1                              19870020
198800                             TO TRUE                              19880020
198900     END-IF.                                                      19890020
199000                                                                  19900020
199100                                                                  19910020
199200     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       19920020
199300     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       19930020
199400                                          ASC-ITEMS-DISPLAYED - 1.19940020
199500     PERFORM 3100-SET-SUBSCRIPTS.                                 19950020
199600                                                                  19960020
199700     MOVE SPACES TO PV-SAVE-TKT-FORMAT                            19970020
199800     PERFORM 3300-EDIT-SELECTIONS                                 19980020
199900             VARYING PV-SUB  FROM PV-SUB BY -1                    19990020
200000             UNTIL   PV-SUB < +1.                                 20000020
200100                                                                  20010020
200101                                                                  20010170
200102******************************************************************20010270
200103* VALIDATE THE TICKET OFFICE ENTERED IS VALID                    *20010370
200104* DMH 2018/01/18                                                 *20010470
200105******************************************************************20010570
200110 3010-VALIDATE-TKT-OFFICE.                                        20011070
200120                                                                  20012070
200121       MOVE ASC-TKT-OFFICE  TO  KRPRPM-SYS-PRC-FUNC-CDE.          20012170
200122       SET  PS-VALID-TICKET-OFFICE-NO  TO  TRUE                   20012270
200123                                                                  20012370
200130       EXEC SQL                                                   20013070
200140            SELECT  DISTINCT                                      20014070
200150                    SYS_PRC_FUNC_CDE                              20015070
200192              INTO                                                20019270
200193                   :KRPRPM-SYS-PRC-FUNC-CDE                       20019370
200198              FROM TKRPRPM                                        20019870
200200             WHERE INTFC_SYS_CDE    = 'AVY'                       20020070
200201               AND SYS_PRC_FUNC_CDE = :KRPRPM-SYS-PRC-FUNC-CDE    20020170
200205       END-EXEC.                                                  20020570
200206                                                                  20020670
200207     EVALUATE TRUE                                                20020770
200208         WHEN SQLCODE = ZERO                                      20020870
200209         WHEN SQLCODE = -811                                      20020970
200210              SET  PS-VALID-TICKET-OFFICE     TO  TRUE            20021070
200211                                                                  20021170
200212         WHEN SQLCODE = +100                                      20021270
200214              SET  PS-VALID-TICKET-OFFICE-NO  TO  TRUE            20021470
200215                                                                  20021570
200216         WHEN SQLWARN0 NOT = SPACES                               20021670
200217         WHEN SQLCODE  NOT = ZERO                                 20021770
200218              MOVE '3010-VALIDATE-TKT-OFFICE'                     20021870
200219                             TO DP013-PARAGRAPH                   20021970
200220              MOVE 'VALIDATE TICKET OFFICE'                       20022070
200221                             TO DP013-MESSAGE-TEXT (1)            20022170
200222              MOVE ASC-TKT-OFFICE                                 20022270
200223                             TO DP013-MESSAGE-TEXT (2)            20022370
200224              MOVE SQLCA     TO DP013-SQLCA                       20022470
200225              MOVE 'TKRPRPM' TO DP013-DB2-TABLE-NAME (1)          20022570
200227              SET DP013-DB2-ABEND                                 20022770
200228                  DP013-XCTL-DISPLAY-RESTART                      20022870
200229                             TO TRUE                              20022970
200230                                                                  20023070
200231              PERFORM DP013-0000-PROCESS-ABEND                    20023170
200232     END-EVALUATE.                                                20023270
200233                                                                  20023370
200234                                                                  20023470
200235                                                                  20023520
200240                                                                  20024070
200300 3020-VALIDATE-FORMAT-VS.                                         20030020
200400                                                                  20040020
200500       EXEC SQL                                                   20050020
200600            SELECT DISTINCT                                       20060020
200700                   A.TKT_FMT_ID,                                  20070020
200800                   A.TYP_CDE,                                     20080020
200900                   A.PAPER_TYP_ID,                                20090020
201000                   A.TKT_OFF_ADR_ID,                              20100020
201100                   B.EXTRA_TKTS_PCT,                              20110020
201200                   B.EXTRA_TKTS_NBR                               20120020
201300              INTO :PV-TKT-FMT-ID,                                20130020
201400                   :TKTFMT-TYP-CDE,                               20140020
201500                   :TKTFMT-PAPER-TYP-ID,                          20150020
201600                   :TKTFMT-TKT-OFF-ADR-ID,                        20160020
201700                   :PRTSTK-EXTRA-TKTS-PCT,                        20170020
201800                   :PRTSTK-EXTRA-TKTS-NBR                         20180020
201900              FROM TTKTFMT A,                                     20190020
202000                   TPRTSTK B                                      20200020
202100             WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID             20210020
202200               AND A.FCLTY_ID       = :DK-FCLTY-ID                20220020
202300               AND A.TKT_FMT_DESC   = :DK-TKT-FORMAT-VS           20230020
202400               AND A.TKT_OFF_ID     = :DK-TKT-OFFICE              20240020
202500               AND A.PAPER_TYP_ID   = B.PAPER_TYPE_ID             20250020
202600       END-EXEC.                                                  20260020
202700                                                                  20270020
202800     EVALUATE TRUE                                                20280020
202900         WHEN SQLCODE = ZERO                                      20290020
203000         WHEN SQLCODE = -811                                      20300020
203100              CONTINUE                                            20310020
203200                                                                  20320020
203300         WHEN SQLWARN0 NOT = SPACES                               20330020
203400         WHEN SQLCODE  NOT = ZERO                                 20340020
203500              MOVE '3020-VALIDATE-FORMAT'                         20350020
203600                             TO DP013-PARAGRAPH                   20360020
203700              MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'           20370020
203800                             TO DP013-MESSAGE-TEXT (1)            20380020
203900              MOVE DK-TKT-FORMAT-VS                               20390020
204000                             TO DP013-MESSAGE-TEXT (3)            20400020
204100              MOVE SQLCA     TO DP013-SQLCA                       20410020
204200              MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)          20420020
204300              MOVE 'TPRTSTK' TO DP013-DB2-TABLE-NAME (2)          20430020
204400              SET DP013-DB2-ABEND                                 20440020
204500                  DP013-XCTL-DISPLAY-RESTART                      20450020
204600                             TO TRUE                              20460020
204700                                                                  20470020
204800              PERFORM DP013-0000-PROCESS-ABEND                    20480020
204900     END-EVALUATE.                                                20490020
205000                                                                  20500020
205100                                                                  20510020
205200 3030-VALIDATE-FORMAT.                                            20520020
205300                                                                  20530020
205400       EXEC SQL                                                   20540020
205500            SELECT DISTINCT                                       20550020
205600                   A.TYP_CDE,                                     20560020
205700                   A.PAPER_TYP_ID,                                20570020
205800                   A.TKT_OFF_ADR_ID,                              20580020
205900                   B.EXTRA_TKTS_PCT,                              20590020
206000                   B.EXTRA_TKTS_NBR                               20600020
206100              INTO                                                20610020
206200                   :TKTFMT-TYP-CDE,                               20620020
206300                   :TKTFMT-PAPER-TYP-ID,                          20630020
206400                   :TKTFMT-TKT-OFF-ADR-ID,                        20640020
206500                   :PRTSTK-EXTRA-TKTS-PCT,                        20650020
206600                   :PRTSTK-EXTRA-TKTS-NBR                         20660020
206700              FROM TTKTFMT A,                                     20670020
206800                   TPRTSTK B                                      20680020
206900             WHERE A.OPER_UNT_ID    = :DK-OPER-UNT-ID             20690020
207000               AND A.FCLTY_ID       = :DK-FCLTY-ID                20700020
207100               AND A.TKT_FMT_ID     = :DK-TKT-FORMAT              20710020
207200               AND A.TKT_OFF_ID     = :DK-TKT-OFFICE              20720020
207300               AND A.PAPER_TYP_ID   = B.PAPER_TYPE_ID             20730020
207400       END-EXEC.                                                  20740020
207500                                                                  20750020
207600     EVALUATE TRUE                                                20760020
207700         WHEN SQLCODE = ZERO                                      20770020
207800         WHEN SQLCODE = -811                                      20780020
207900              CONTINUE                                            20790020
208000                                                                  20800020
208100         WHEN SQLWARN0 NOT = SPACES                               20810020
208200         WHEN SQLCODE  NOT = ZERO                                 20820020
208300              MOVE '3030-VALIDATE-FORMAT'                         20830020
208400                             TO DP013-PARAGRAPH                   20840020
208500              MOVE 'UNSUCCESSFUL SELECT OF TICKET TYPE'           20850020
208600                             TO DP013-MESSAGE-TEXT (1)            20860020
208700              MOVE DK-TKT-FORMAT                                  20870020
208800                             TO DP013-MESSAGE-TEXT (3)            20880020
208900              MOVE SQLCA     TO DP013-SQLCA                       20890020
209000              MOVE 'TTKTFMT' TO DP013-DB2-TABLE-NAME (1)          20900020
209100              MOVE 'TPRTSTK' TO DP013-DB2-TABLE-NAME (2)          20910020
209200              SET DP013-DB2-ABEND                                 20920020
209300                  DP013-XCTL-DISPLAY-RESTART                      20930020
209400                             TO TRUE                              20940020
209500                                                                  20950020
209600              PERFORM DP013-0000-PROCESS-ABEND                    20960020
209700     END-EVALUATE.                                                20970020
209800                                                                  20980020
209900                                                                  20990020
210000 3100-SET-SUBSCRIPTS.                                             21000020
210100                                                                  21010020
210200     COMPUTE ASC-ITEM-SUB =                                       21020020
210300                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.21030020
210400                                                                  21040020
210500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21050020
210600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21060020
210700         MOVE PC-MAX-BLOCKS-IN-ARRAY                              21070020
210800                                 TO ASC-BLK-SUB                   21080020
210900     ELSE                                                         21090020
211000         MOVE +1                 TO ASC-BLK-SUB                   21100020
211100     END-IF.                                                      21110020
211200                                                                  21120020
211300 3200-RESET-ATTRIBUTES.                                           21130020
211400                                                                  21140020
211500     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA                      21150020
211600                                    ALOCATNA                      21160020
211700                                    AXTKTSA                       21170020
211800                                    ATKTOFFA                      21180020
211900                                    AXTKTPCA.                     21190028
212100     MOVE DP015-GREEN            TO ASTRTITC                      21210020
212200                                    ALOCATNC                      21220020
212300                                    AXTKTSC                       21230020
212400                                    ATKTOFFC                      21240020
212500                                    AXTKTPCC.                     21250028
212700     MOVE DP015-UNDERLINE        TO ASTRTITH                      21270020
212800                                    ALOCATNH                      21280020
212900                                    AXTKTSH                       21290020
213000                                    ATKTOFFH                      21300020
213100                                    AXTKTPCH.                     21310028
213300                                                                  21330020
213400     IF DP020-NEXT-ACT-RETURN OR                                  21340020
213500        DP020-NEXT-ACT-READ-MAP                                   21350020
213600         PERFORM VARYING PV-SUB  FROM 1 BY 1                      21360020
213700                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             21370020
213800                 MOVE DP015-UNP-ALP-NOR-OFF                       21380020
213900                                 TO MR-SELECTA (PV-SUB)           21390020
214000                 MOVE DP015-UNP-NUM-NOR-OFF                       21400020
214100                                 TO MR-QUANT-A (PV-SUB)           21410020
214200                 MOVE DP015-GREEN                                 21420020
214300                                 TO MR-SELECTC (PV-SUB)           21430020
214400                                    MR-QUANT-C (PV-SUB)           21440020
214500                 MOVE DP015-UNDERLINE                             21450020
214600                                 TO MR-SELECTH (PV-SUB)           21460020
214700                                    MR-QUANT-H (PV-SUB)           21470020
214800         END-PERFORM                                              21480020
214900     ELSE                                                         21490020
215000         PERFORM VARYING PV-SUB  FROM 1 BY 1                      21500020
215100                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              21510020
215200                 MOVE DP015-UNP-ALP-NOR-OFF                       21520020
215300                                 TO MR-SELECTA (PV-SUB)           21530020
215400                 MOVE DP015-UNP-NUM-NOR-OFF                       21540020
215500                                 TO MR-QUANT-A (PV-SUB)           21550020
215600                 MOVE DP015-GREEN                                 21560020
215700                                 TO MR-SELECTC (PV-SUB)           21570020
215800                                    MR-QUANT-C (PV-SUB)           21580020
215900                                    MR-TKT-FORMAT-C (PV-SUB)      21590020
216000                 MOVE DP015-UNDERLINE                             21600020
216100                                 TO MR-SELECTH (PV-SUB)           21610020
216200                                    MR-QUANT-H (PV-SUB)           21620020
216300                                    MR-TKT-FORMAT-H (PV-SUB)      21630020
216400         END-PERFORM                                              21640020
216500     END-IF.                                                      21650020
216600                                                                  21660020
216700 3300-EDIT-SELECTIONS.                                            21670020
216800                                                                  21680020
216900     EVALUATE TRUE                                                21690020
217000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   21700020
217100                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     21710020
217200              CONTINUE                                            21720020
217300                                                                  21730020
217400         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        21740020
217500              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        21750020
217600                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  21760020
217700                  MOVE ASC-TEMP-SELECTED-SW                       21770020
217800                                        (ASC-BLK-SUB ASC-ITEM-SUB)21780020
217900                                 TO ASC-SELECTED-SW               21790020
218000                                        (ASC-BLK-SUB ASC-ITEM-SUB)21800020
218100              END-IF                                              21810020
218200                                                                  21820020
218300         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   21830020
218400                                                             SPACE21840020
218500              EVALUATE TRUE                                       21850020
218600                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     21860020
218700                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS21870020
218800                     MOVE SPACE  TO ASC-SELECTED-SW               21880020
218900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21890020
219000                                                                  21900020
219100                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     21910020
219200                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   21920020
219300                       MOVE SPACE                                 21930020
219400                                 TO ASC-SELECTED-SW               21940020
219500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     21950020
219600                                                                  21960020
219700                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     21970020
219800                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     21980020
219900                       MOVE SPACE                                 21990020
220000                                 TO ASC-SELECTED-SW               22000020
220100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22010020
220200             END-EVALUATE                                         22020020
220300                                                                  22030020
220400         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22040020
220500              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           22050020
220600                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   22060020
220700              END-IF                                              22070020
220800                                                                  22080020
220900              PERFORM 3310-EDIT-RANGE                             22090020
221000                                                                  22100020
221100         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            22110020
221200              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22120020
221300                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   22130020
221400              END-IF                                              22140020
221500                                                                  22150020
221600              PERFORM 3310-EDIT-RANGE                             22160020
221700                                                                  22170020
221800         WHEN OTHER                                               22180020
221900              MOVE PC-TSYMSG-00005                                22190020
222000                                 TO DP020-MSG-NUMBER              22200020
222100              SET PS-ERROR                                        22210020
222200                  DP020-MSG-FATAL                                 22220020
222300                  DP030-SET-CURSOR-APPL-1                         22230020
222400                                 TO TRUE                          22240020
222500              MOVE -1            TO MR-SELECTL (PV-SUB)           22250020
222600              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           22260020
222700              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           22270020
222800              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22280020
222900                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22290020
223000                  MOVE SPACE     TO ASC-SELECTED-SW               22300020
223100                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22310020
223200              END-IF                                              22320020
223300     END-EVALUATE.                                                22330020
223400                                                                  22340020
223500     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     22350020
223600         IF ASC-TKT-FORMAT (ASC-BLK-SUB ASC-ITEM-SUB)             22360020
223700                                = PV-SAVE-TKT-FORMAT              22370020
223800         OR PV-SAVE-TKT-FORMAT  = SPACES                          22380020
223900             MOVE ASC-TKT-FORMAT (ASC-BLK-SUB ASC-ITEM-SUB)       22390020
224000                                 TO PV-SAVE-TKT-FORMAT            22400020
224100         ELSE                                                     22410020
224200             SET PS-ERROR                                         22420020
224300                 DP020-MSG-FATAL                                  22430020
224400                 DP030-SET-CURSOR-APPL-1                          22440020
224500                                 TO TRUE                          22450020
224600             MOVE PC-TSYMSG-01419                                 22460020
224700                                 TO DP020-MSG-NUMBER              22470020
224800             MOVE -1             TO MR-TKT-FORMAT-L (PV-SUB)      22480020
224900             MOVE DP015-RED      TO MR-TKT-FORMAT-C (PV-SUB)      22490020
225000             MOVE DP015-REVERSE                                   22500020
225100                                 TO MR-TKT-FORMAT-H (PV-SUB)      22510020
225200             SET DP030-SET-CURSOR-APPL-1                          22520020
225300                                 TO TRUE                          22530020
225400         END-IF                                                   22540020
225500                                                                  22550020
225600         IF ASC-UNT-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       22560020
225700             MOVE ASC-UNT-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          22570020
225800                                 TO DP010I-UNEDITED-FIELD         22580020
225900             MOVE LENGTH OF ASC-UNT-QTY                           22590020
226000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22600020
226100                                   TO DP010I-MAXIMUM-DIGITS       22610020
226200             MOVE ZERO             TO DP010I-MAXIMUM-DECIMALS     22620020
226300             SET DP010I-NEGATIVE-NOT-ALLOWED                      22630020
226400                                   TO TRUE                        22640020
226510             CALL DP010I-NUMERIC-EDIT-ROUTINE                     22651076
226520                  USING DP010I-NUMERIC-EDIT-AREA                  22652076
226700             IF  DP010I-ERROR-DETECTED                            22670020
226800                 SET PS-ERROR                                     22680020
226900                     DP020-MSG-FATAL                              22690020
227000                     DP030-SET-CURSOR-APPL-1                      22700020
227100                                   TO TRUE                        22710020
227200                 MOVE PC-TSYMSG-00008                             22720020
227300                                   TO DP020-MSG-NUMBER            22730020
227400                 MOVE DP015-UNP-NUM-BRT-OFF                       22740020
227500                                   TO MR-QUANT-A (PV-SUB)         22750020
227600                 MOVE -1           TO MR-QUANT-L (PV-SUB)         22760020
227700                 MOVE DP015-RED    TO MR-QUANT-C (PV-SUB)         22770020
227800                 MOVE DP015-REVERSE                               22780020
227900                                   TO MR-QUANT-H (PV-SUB)         22790020
228000                 SET DP030-SET-CURSOR-APPL-1                      22800020
228100                                   TO TRUE                        22810020
228200                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     22820020
228300             ELSE                                                 22830020
228400                 MOVE DP010I-NUMERIC-FIELD                        22840020
228500                                   TO ASC-UNT-QTY-N               22850020
228600                                     (ASC-BLK-SUB ASC-ITEM-SUB)   22860020
228700             END-IF                                               22870020
228800         END-IF                                                   22880020
228900                                                                  22890020
229000         MOVE ASC-KEY-OPER-UNT-ID    TO DK-OPER-UNT-ID            22900020
229100         MOVE ASC-KEY-FCLTY-ID       TO DK-FCLTY-ID               22910020
229200         MOVE ASC-TKT-OFFICE         TO DK-TKT-OFFICE             22920020
229300                                                                  22930020
229400         MOVE ASC-TKT-FORMAT (ASC-BLK-SUB ASC-ITEM-SUB)           22940020
229500                                     TO DK-TKT-FORMAT             22950020
229600                                                                  22960020
229700         IF PS-ERROR                                              22970020
229800             CONTINUE                                             22980020
229900         ELSE                                                     22990020
230000             PERFORM 3030-VALIDATE-FORMAT                         23000020
230100             IF SQLCODE = ZERO                                    23010020
230200             OR SQLCODE = -811                                    23020020
230300                 MOVE TKTFMT-PAPER-TYP-ID                         23030020
230400                                 TO ASC-PAPER-TYP-ID              23040020
230500                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23050020
230600                 MOVE TKTFMT-TKT-OFF-ADR-ID                       23060020
230700                                 TO ASC-TKT-OFF-ADR-ID            23070020
230800                 MOVE PRTSTK-EXTRA-TKTS-PCT                       23080020
230900                                 TO ASC-LNE-XTKT-PCT              23090020
231000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23100020
231100                 MOVE PRTSTK-EXTRA-TKTS-NBR                       23110020
231200                                  TO ASC-LNE-XTKTS                23120020
231300                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23130020
231400             END-IF                                               23140020
231500         END-IF                                                   23150020
231600     END-IF.                                                      23160020
231700                                                                  23170020
231800     SUBTRACT +1 FROM PV-ITEM-IN-USE                              23180020
231900                      ASC-ITEM-SUB.                               23190020
232000                                                                  23200020
232100     IF ASC-ITEM-SUB < 1                                          23210020
232200         SUBTRACT +1 FROM ASC-BLK-SUB                             23220020
232300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23230020
232400     END-IF.                                                      23240020
232500                                                                  23250020
232600 3310-EDIT-RANGE.                                                 23260020
232700                                                                  23270020
232800     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 23280020
232900        IF ASC-START-OF-SELECTED-RANGE = ZERO                     23290020
233000            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  23300020
233100                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  23310020
233200            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   23320020
233300        ELSE                                                      23330020
233400            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23340020
233500                CONTINUE                                          23350020
233600            ELSE                                                  23360020
233700                MOVE PC-TSYMSG-00054                              23370020
233800                                 TO DP020-MSG-NUMBER              23380020
233900                SET DP020-MSG-FATAL                               23390020
234000                    PS-ERROR                                      23400020
234100                    DP030-SET-CURSOR-APPL-1                       23410020
234200                                 TO TRUE                          23420020
234300                MOVE -1          TO MR-SELECTL (PV-SUB)           23430020
234400                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           23440020
234500                MOVE DP015-UNDERLINE                              23450020
234600                                 TO MR-SELECTH (PV-SUB)           23460020
234700            END-IF                                                23470020
234800        END-IF                                                    23480020
234900     ELSE                                                         23490020
235000         IF ASC-END-OF-SELECTED-RANGE = ZERO                      23500020
235100             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23510020
235200                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23520020
235300             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     23530020
235400         ELSE                                                     23540020
235500             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        23550020
235600                 CONTINUE                                         23560020
235700             ELSE                                                 23570020
235800                MOVE PC-TSYMSG-00055                              23580020
235900                                 TO DP020-MSG-NUMBER              23590020
236000                SET DP020-MSG-FATAL                               23600020
236100                    PS-ERROR                                      23610020
236200                    DP030-SET-CURSOR-APPL-1                       23620020
236300                                 TO TRUE                          23630020
236400                MOVE -1          TO MR-SELECTL (PV-SUB)           23640020
236500             END-IF                                               23650020
236600         END-IF                                                   23660020
236700     END-IF.                                                      23670020
236800                                                                  23680020
236900 4000-BUILD-INITIAL-PANEL.                                        23690020
237000                                                                  23700020
237100     INITIALIZE ASC-BLOCK-ENTRIES (1)                             23710020
237200                ASC-BLOCK-ENTRIES (2).                            23720020
237300                                                                  23730020
237400     MOVE +1                       TO ASC-BLK-SUB.                23740020
237500     SET ASC-ITEMS-LEFT-ON-DB      TO TRUE.                       23750020
237600                                                                  23760020
237700     MOVE ZERO                     TO ASC-ITEM-SUB                23770020
237800                                      ASC-NUMBER-OF-ITEMS-READ    23780020
237900                                      ASC-NUMBER-OF-SELECTED-ITEMS23790020
238000                                      ASC-HIGHEST-BLOCK-WRITTEN   23800020
238100                                      ASC-START-OF-SELECTED-RANGE 23810020
238200                                      ASC-END-OF-SELECTED-RANGE   23820020
238300                                      ASC-ITEM-AT-TOP-OF-PANEL.   23830020
238400                                                                  23840020
238500     MOVE ASC-KEY-PO-REQ-NBR      TO DK-PO-REQ-NBR.               23850020
238600     MOVE ASC-KEY-OPER-UNT-ID     TO DK-OPER-UNT-ID.              23860020
238700     MOVE ASC-KEY-FCLTY-ID        TO DK-FCLTY-ID.                 23870020
238800                                                                  23880020
238900     PERFORM 4010-OPEN-CURSOR.                                    23890020
239000                                                                  23900020
239100     PERFORM 4300-READ-ITEMS-FROM-DB.                             23910020
239200                                                                  23920020
239300     PERFORM 4020-CLOSE-CURSOR.                                   23930020
239400                                                                  23940020
239500     MOVE +1                       TO PV-TOP-ITEM.                23950020
239600                                                                  23960020
241410******************************************************************24141022
241420* AS OF 3/14/2002, WE NO LONGER WISH TO PRINT THE SEASON CODE ON *24142022
241430* ANY OF THE TICKETS.  I AM COMMENTING OUT THE CODE FOR NOW SO   *24143022
241440* THAT WE CAN COME BACK TO IT JUST IN CASE THE TICKETING OFFICE  *24144022
241450* WANTS TO DISPLAY THE SEASON CODE ONCE AGAIN ON THE TICKETS.    *24145022
241460*                                                                *24146022
241461* SEASON CODE WAS COMMENTED OUT FOR PRETICKETING PRIOR TO 3/14.  *24146122
241462*                                                                *24146222
241470*                                 -- DAN HINTZ (NEW SKU PROJECT) *24147022
241480******************************************************************24148022
241500*DH  EXEC CICS                                                    24150022
241600*DH      ASKTIME ABSTIME (ST-ABSTIME)                             24160022
241700*DH  END-EXEC.                                                    24170022
241800*DH                                                               24180022
241900*DH  EXEC CICS                                                    24190022
242000*DH      FORMATTIME ABSTIME (ST-ABSTIME)                          24200022
242100*DH                 MMDDYY  (PV-DATE)                             24210022
242200*DH  END-EXEC.                                                    24220022
242300*DH                                                               24230022
242400*    IF PV-MONTH > PC-SIX                                         24240020
242500*        MOVE PC-FALL TO PV-SEASON-CODE-SEASON                    24250020
242600*        COMPUTE PV-SEASON-CODE-MONTH =                           24260020
242700*            PV-MONTH - 6                                         24270020
242800*    ELSE                                                         24280020
242900*        MOVE PC-SPRING TO PV-SEASON-CODE-SEASON                  24290020
243000*        MOVE PV-MONTH  TO PV-SEASON-CODE-MONTH                   24300020
243100*    END-IF                                                       24310020
243200*    MOVE PV-SECOND-DIGIT-OF-YEAR                                 24320020
243300*        TO PV-SEASON-CODE-SCND-DGT-OF-YR                         24330020
243400*    MOVE PV-SEASON-CODE                TO ASC-SEASON-CDE         24340020
243500*DH  MOVE SPACES                        TO ASC-SEASON-CDE         24350028
243510     MOVE SPACES                        TO ASC-LOCATION.          24351045
243600                                                                  24360020
243700     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          24370020
243800         SET DP020-NEXT-ACT-APPL-ERROR                            24380020
243900                                   TO TRUE                        24390020
244000         SET DP020-MSG-FATAL       TO TRUE                        24400020
244100         MOVE PC-TSYMSG-00050      TO DP020-MSG-NUMBER            24410020
244200     ELSE                                                         24420020
244300         MOVE -1                   TO ALOCATNL                    24430020
244400         SET DP030-SET-CURSOR-APPL-1                              24440020
244500                                   TO TRUE                        24450020
244600         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     24460020
244700     END-IF.                                                      24470020
244800                                                                  24480020
244900/                                                                 24490020
245000*----------------------------------------------------------------*24500020
245100* OPEN THE APPROPRIATE CURSOR                                    *24510020
245200*----------------------------------------------------------------*24520020
245300                                                                  24530020
245400 4010-OPEN-CURSOR.                                                24540020
245500                                                                  24550020
245600                                                                  24560020
245700     EXEC SQL                                                     24570020
245800         OPEN PRETICK_CURSOR                                      24580020
245900     END-EXEC.                                                    24590020
246000                                                                  24600020
246100     EVALUATE TRUE                                                24610020
246200         WHEN SQLCODE = +0                                        24620020
246300              CONTINUE                                            24630020
246400         WHEN SQLWARN0 NOT = SPACE                                24640020
246500         WHEN SQLCODE  NOT = +0                                   24650020
246600              MOVE '4010-OPEN-CURSOR'                             24660020
246700                               TO DP013-PARAGRAPH                 24670020
246800              MOVE 'OPEN PRETICK_CURSOR'                          24680020
246900                               TO DP013-MESSAGE-TEXT (1)          24690020
247000              MOVE SQLCA       TO DP013-SQLCA                     24700020
247100              MOVE 'TPTKREQ'   TO DP013-DB2-TABLE-NAME (1)        24710020
247200              MOVE 'TPURITM'   TO DP013-DB2-TABLE-NAME (2)        24720020
247400              MOVE 'TPTKLNE'   TO DP013-DB2-TABLE-NAME (3)        24740042
247500              SET DP013-DB2-ABEND                                 24750020
247600                               TO TRUE                            24760020
247700              PERFORM DP013-0000-PROCESS-ABEND                    24770020
247800     END-EVALUATE.                                                24780020
247900                                                                  24790020
248000/                                                                 24800020
248100*----------------------------------------------------------------*24810020
248200* CLOSE THE APPROPRIATE CURSOR                                   *24820020
248300*----------------------------------------------------------------*24830020
248400                                                                  24840020
248500 4020-CLOSE-CURSOR.                                               24850020
248600                                                                  24860020
248700     EXEC SQL                                                     24870020
248800         CLOSE PRETICK_CURSOR                                     24880020
248900     END-EXEC.                                                    24890020
249000                                                                  24900020
249100     EVALUATE TRUE                                                24910020
249200         WHEN SQLCODE = +0                                        24920020
249300              CONTINUE                                            24930020
249400         WHEN SQLWARN0 NOT = SPACE                                24940020
249500         WHEN SQLCODE  NOT = +0                                   24950020
249600              MOVE '4020-CLOSE-CURSOR'                            24960020
249700                                   TO DP013-PARAGRAPH             24970020
249800              MOVE 'CLOSE PRETICK_CURSOR'                         24980020
249900                                   TO DP013-MESSAGE-TEXT (1)      24990020
250000              MOVE SQLCA           TO DP013-SQLCA                 25000020
250100              MOVE 'TPTKREQ'       TO DP013-DB2-TABLE-NAME (1)    25010020
250200              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    25020020
250300              MOVE 'TPTKLNE'       TO DP013-DB2-TABLE-NAME (3)    25030020
250500              SET DP013-DB2-ABEND  TO TRUE                        25050020
250600              PERFORM DP013-0000-PROCESS-ABEND                    25060020
250700     END-EVALUATE.                                                25070020
250800                                                                  25080020
250900/                                                                 25090020
251000*----------------------------------------------------------------*25100020
251100*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *25110020
251200*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *25120020
251300*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *25130020
251400*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *25140020
251500*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *25150020
251600*                                                                *25160020
251700*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *25170020
251800*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *25180020
251900*    UPON INITIALIZATION.                                        *25190020
252000*----------------------------------------------------------------*25200020
252100                                                                  25210020
252200 4300-READ-ITEMS-FROM-DB.                                         25220020
252300                                                                  25230020
252400     PERFORM                                                      25240020
252500         VARYING PV-READ-COUNT                                    25250020
252600         FROM 1 BY 1                                              25260020
252700         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    25270020
252800            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         25280020
252900                                                                  25290020
253000         PERFORM 4310-FETCH                                       25300020
253100                                                                  25310020
253200         IF  ASC-ITEMS-LEFT-ON-DB                                 25320020
253300             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                25330020
253400                 ADD +1            TO ASC-ITEM-SUB                25340020
253500             ELSE                                                 25350020
253600                 ADD +1            TO ASC-BLK-SUB                 25360020
253700                 MOVE +1           TO ASC-ITEM-SUB                25370020
253800                                                                  25380020
253900                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         25390020
254000                     MOVE +1       TO ASC-BLK-SUB                 25400020
254100                     SET ASC-BLOCK-MODIFIED (1)                   25410020
254200                                   TO TRUE                        25420020
254300                     PERFORM 5100-WRITE-TEMP-STORAGE              25430020
254400                     MOVE ASC-BLOCK-ENTRIES                       25440020
254500                               (PC-MAX-BLOCKS-IN-ARRAY)           25450020
254600                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 25460020
254700                     ADD +1        TO ASC-BLK-SUB                 25470020
254800                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   25480020
254900                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      25490020
255000                                   TO TRUE                        25500020
255100                 END-IF                                           25510020
255200             END-IF                                               25520020
255300             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    25530020
255400             MOVE ASC-NUMBER-OF-ITEMS-READ                        25540020
255500                                   TO ASC-LIST-ITEM-NUMBER        25550020
255600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25560020
255700             MOVE PTKREQ-DEPT-NBR  TO ASC-DEPT-NBR                25570020
255800             MOVE PTKREQ-REQ-STAT-CDE                             25580020
255900                                   TO ASC-REQ-STAT-CDE            25590020
256000             MOVE PURITM-ITM-NBR   TO DK-ITM-NBR                  25600048
256001                                      ASC-ITM-NBR                 25600148
256002                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25600248
256003*        WHEN WE HAVE A VALID ITEM NUMBER FOR THE ITEM, WE CAN USE25600358
256004*        DATA THAT IS ON THE DOMAIN TABLES.  IF THE ITEM NUMBER IS25600458
256005*        ZERO, OR IF THE DATA IS NOT FOUND ON THE DOMAIN TABLES,  25600558
256006*        WE WILL CONTINUE TO USE THE INFORMATION FOUND ON TPURITM.25600658
256007             SET PS-DOMAIN-INFO-NOT-FOUND                         25600748
256008                                   TO TRUE                        25600848
256009             IF  PURITM-ITM-NBR > 0                               25600948
256010                 PERFORM 4320-GET-DOMAIN-DATA                     25601048
256011             END-IF                                               25601148
256012                                                                  25601248
256020             IF  PS-DOMAIN-INFO-FOUND                             25602048
256030                 MOVE XLT00004-SUB-CL-NBR                         25603048
256040                                   TO ASC-SUB-CLASS               25604048
256050                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25605048
256060                 MOVE XLT00004-MAJ-CL-NBR                         25606048
256070                                   TO ASC-MAJOR-CLASS             25607048
256080                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25608048
256081                 MOVE XLT00003-CSTM-CLOR-DESC                     25608148
256082                                   TO ASC-COLOR                   25608249
256083                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25608348
256084                 MOVE XLT00003-SIZE-DESC                          25608448
256085                                   TO ASC-SIZE                    25608549
256086                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25608648
256087                 MOVE XLT00004-VS-NBR                             25608748
256088                                   TO ASC-VEND-STYL               25608849
256089                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25608948
256090                 MOVE XLT00004-STKR-NBR TO PV-STICKER-99999       25609060
256091                 MOVE PV-STICKER-99999 TO PV-STICKER-NBR-ZZ999    25609162
256092                 MOVE PV-STICKER-NBR-ZZ999                        25609262
256093                                   TO ASC-STICKER-NBR             25609360
256096                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25609660
256097                 SET ASC-DISP-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)    25609760
256098                     ASC-DISP-SIZE  (ASC-BLK-SUB ASC-ITEM-SUB)    25609860
256099                                   TO TRUE                        25609960
256100             ELSE                                                 25610048
256520*    WE ARE GETTING THE MAJOR CLASS AND SUB CLASS FROM TPURITM   *25652026
256530*    USING THE CL_NBR COLUMN.  FOR EXAMPLE, CL_NBR OF 39 WOULD   *25653026
256540*    GIVE US A MAJOR CLASS OF 30, AND A SUB CLASS OF 39.         *25654026
256550                 MOVE PURITM-CL-NBR                               25655048
256551                                   TO PV-CL-NBR                   25655148
256560                                      ASC-SUB-CLASS               25656048
256570                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25657048
256580                 MOVE PV-CL-NBR-1  TO PV-MAJOR-CLASS-1            25658048
256590                 MOVE PV-MAJOR-CLASS                              25659048
256591                                   TO ASC-MAJOR-CLASS             25659148
256592                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25659248
256596                 MOVE PURITM-VEND-STYL-NAME                       25659649
256597                                   TO ASC-VEND-STYL               25659749
256598                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25659849
256599                 MOVE PURITM-COLOR-DESC                           25659949
256600                                   TO ASC-COLOR                   25660049
256601                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25660149
256602                 MOVE PURITM-SIZE-DESC                            25660249
256603                                   TO ASC-SIZE                    25660349
256604                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25660449
256605                 SET ASC-DISP-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)    25660549
256606                     ASC-DISP-SIZE  (ASC-BLK-SUB ASC-ITEM-SUB)    25660649
256607                                   TO TRUE                        25660749
256608             END-IF                                               25660849
256609                                                                  25660949
256610             IF PURITM-GP-QTY > 1                                 25661020
256700                 MOVE PURITM-GP-QTY TO ASC-GP-RTL-QTY             25670020
256800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25680020
256900                 MOVE PURITM-GP-RTL-AMT                           25690020
257000                                   TO ASC-GP-RTL                  25700020
257100                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25710020
257200             ELSE                                                 25720020
257300                 MOVE ZERO         TO ASC-GP-RTL-QTY              25730020
257400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25740020
257500                                      ASC-GP-RTL                  25750020
257600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25760020
257700             END-IF                                               25770020
257800             MOVE PURITM-UNT-RTL-PR-AMT                           25780020
257900                                   TO ASC-UNT-RTL-PR              25790020
258000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25800020
258100             MOVE PV-QUANTITY                                     25810020
258200                                   TO ASC-UNT-QTY-N               25820020
258300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25830020
258400********                                                          25840020
258500             MOVE PRTSTK-EXTRA-TKTS-PCT                           25850020
258600                                     TO ASC-LNE-XTKT-PCT          25860020
258700                                        (ASC-BLK-SUB ASC-ITEM-SUB)25870020
258800             MOVE PRTSTK-EXTRA-TKTS-NBR                           25880020
258900                                      TO ASC-LNE-XTKTS            25890020
259000                                        (ASC-BLK-SUB ASC-ITEM-SUB)25900020
259020             MOVE PC-UPC              TO ASC-UPC-NBR-TXT          25902026
259030                                        (ASC-BLK-SUB ASC-ITEM-SUB)25903026
259100*******                                                           25910020
259110             IF PURITM-ITM-NBR = ZERO                             25911049
259120                 MOVE '** NOT FOUND'                              25912049
259130                                   TO ASC-UPC-NBR                 25913050
259140                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25914049
259150             ELSE                                                 25915049
259160                 MOVE PURITM-ITM-NBR                              25916049
259170                                   TO DK-ITM-NBR                  25917049
259180                 PERFORM 4360-SELECT-VENDOR-UPC                   25918049
259190                 EVALUATE SQLCODE                                 25919049
259191                     WHEN ZERO                                    25919149
259192                         MOVE XLV00003-UPC-NBR                    25919249
259193                                   TO ASC-UPC-NBR-N               25919351
259194                                      (ASC-BLK-SUB ASC-ITEM-SUB)  25919449
259195                     WHEN OTHER                                   25919549
259196                         PERFORM 4370-SELECT-INTERNAL-UPC         25919649
259197                 END-EVALUATE                                     25919749
259198             END-IF                                               25919849
261200                                                                  26120020
261600             IF PTKLNE-TKT-DESC = PV-SAVE-TKT-DESC                26160020
261700                 MOVE PV-TKT-FMT-ID  TO ASC-TKT-FORMAT            26170020
261800                                        (ASC-BLK-SUB ASC-ITEM-SUB)26180020
261900             ELSE                                                 26190020
262000                 MOVE PTKLNE-TKT-DESC                             26200020
262100                                     TO DK-TKT-FORMAT-VS          26210020
262200                                        PV-SAVE-TKT-DESC          26220020
262300                 IF ASC-KEY-OPER-UNT-ID = 90                      26230020
262400                     MOVE 85         TO ASC-KEY-OPER-UNT-ID       26240020
262500                 END-IF                                           26250020
262600                                                                  26260020
262700                 MOVE ASC-KEY-OPER-UNT-ID                         26270020
262800                                     TO DK-OPER-UNT-ID            26280020
262900                 MOVE ASC-KEY-FCLTY-ID                            26290020
263000                                     TO DK-FCLTY-ID               26300020
263100                 IF ASC-TKT-OFFICE = SPACES                       26310020
263200                    MOVE 'TKT1'      TO ASC-TKT-OFFICE            26320020
263300                                        DK-TKT-OFFICE             26330020
263400                 ELSE                                             26340020
263500                    MOVE ASC-TKT-OFFICE                           26350020
263600                                     TO DK-TKT-OFFICE             26360020
263700                 END-IF                                           26370020
263800                                                                  26380020
263900                 PERFORM 3020-VALIDATE-FORMAT-VS                  26390020
264000                 IF SQLCODE = ZERO                                26400020
264100                 OR SQLCODE = -811                                26410020
264200                     MOVE PV-TKT-FMT-ID                           26420020
264300                                     TO ASC-TKT-FORMAT            26430020
264400                                        (ASC-BLK-SUB ASC-ITEM-SUB)26440020
264500                     MOVE TKTFMT-PAPER-TYP-ID                     26450020
264600                                     TO ASC-PAPER-TYP-ID          26460020
264700                                        (ASC-BLK-SUB ASC-ITEM-SUB)26470020
264800                     MOVE TKTFMT-TKT-OFF-ADR-ID                   26480020
264900                                     TO ASC-TKT-OFF-ADR-ID        26490020
265000                     MOVE PRTSTK-EXTRA-TKTS-PCT                   26500020
265100                                     TO ASC-LNE-XTKT-PCT          26510020
265200                                        (ASC-BLK-SUB ASC-ITEM-SUB)26520020
265300                     MOVE PRTSTK-EXTRA-TKTS-NBR                   26530020
265400                                      TO ASC-LNE-XTKTS            26540020
265500                                        (ASC-BLK-SUB ASC-ITEM-SUB)26550020
265600                 END-IF                                           26560020
265700             END-IF                                               26570020
265800             MOVE PURITM-PO-LNE-NBR                               26580020
265900                                   TO ASC-PO-LNE-NBR              26590020
266000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26600020
266100             MOVE PTKLNE-OPT-BLCK-CDE                             26610020
266200                                   TO ASC-OPT-BLK                 26620020
266300                                      (ASC-BLK-SUB ASC-ITEM-SUB)  26630020
266400         END-IF                                                   26640020
266500     END-PERFORM.                                                 26650020
266600                                                                  26660020
266700     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          26670020
266800         MOVE +1                   TO ASC-BLK-SUB                 26680020
266900         PERFORM 5100-WRITE-TEMP-STORAGE                          26690020
267000         ADD +1                    TO ASC-BLK-SUB                 26700020
267100         PERFORM 5100-WRITE-TEMP-STORAGE                          26710020
267200                                                                  26720020
267300         MOVE 1                    TO ASC-BLK-SUB                 26730020
267400                                      PV-BLOCK-NUMBER             26740020
267500         PERFORM 4410-READ-TEMP-STORAGE                           26750020
267600         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             26760020
267700             MOVE 2                TO ASC-BLK-SUB                 26770020
267800                                      PV-BLOCK-NUMBER             26780020
267900             PERFORM 4410-READ-TEMP-STORAGE                       26790020
268000         END-IF                                                   26800020
268100     END-IF.                                                      26810020
268200                                                                  26820020
268300                                                                  26830020
268400 4310-FETCH.                                                      26840020
268500                                                                  26850020
268600     EXEC SQL                                                     26860020
268700          FETCH PRETICK_CURSOR                                    26870020
268800           INTO :PTKREQ-DEPT-NBR                                  26880020
268900               ,:PTKREQ-REQ-STAT-CDE                              26890020
269000               ,:PURITM-CL-NBR                                    26900020
269200               ,:PURITM-GP-QTY                                    26920020
269300               ,:PURITM-GP-RTL-AMT                                26930020
269400               ,:PURITM-UNT-RTL-PR-AMT                            26940020
269500               ,:PV-QUANTITY                                      26950020
269600               ,:PURITM-ITM-NBR                                   26960020
269610               ,:PURITM-VEND-STYL-NAME                            26961049
269700               ,:PTKLNE-TKT-DESC                                  26970020
269800               ,:PTKLNE-OPT-BLCK-CDE                              26980020
269900               ,:PTKLNE-TKT-PLCMNT-CDE                            26990020
270000               ,:PURITM-COLOR-DESC                                27000020
270100               ,:PURITM-SIZE-DESC                                 27010020
270200               ,:PURITM-APP-PO-LNE-NBR                            27020020
270300               ,:PURITM-PO-LNE-NBR                                27030020
270400     END-EXEC.                                                    27040020
270500                                                                  27050020
270600     EVALUATE TRUE                                                27060020
270700         WHEN SQLCODE = +0                                        27070020
270800              CONTINUE                                            27080020
270900                                                                  27090020
271000         WHEN SQLCODE = +100                                      27100020
271100              SET ASC-NO-ITEMS-LEFT-ON-DB                         27110020
271200                                   TO TRUE                        27120020
271300                                                                  27130020
271400         WHEN SQLWARN0 NOT = SPACE                                27140020
271500         WHEN SQLCODE < +0                                        27150020
271600         WHEN SQLCODE > +0                                        27160020
271700              MOVE '4310-FETCH-CURSOR'                            27170020
271800                                   TO DP013-PARAGRAPH             27180020
271900              MOVE 'FETCH PRETICK_CURSOR'                         27190020
272000                                   TO DP013-MESSAGE-TEXT (1)      27200020
272100              MOVE DK-PO-REQ-NBR   TO DP013-MESSAGE-TEXT (2)      27210020
272200              MOVE SQLCA           TO DP013-SQLCA                 27220020
272300              MOVE 'TPTKREQ'       TO DP013-DB2-TABLE-NAME (1)    27230020
272400              MOVE 'TPURITM'       TO DP013-DB2-TABLE-NAME (2)    27240020
272600              MOVE 'TPTKLNE'       TO DP013-DB2-TABLE-NAME (3)    27260042
272700              SET DP013-DB2-ABEND  TO TRUE                        27270020
272800              PERFORM DP013-0000-PROCESS-ABEND                    27280020
272900     END-EVALUATE.                                                27290020
273000                                                                  27300020
273600                                                                  27360020
273610******************************************************************27361048
273620*    FETCH THE INFORMATION FROM THE XLT_SKU AND XLT_VND_STYL     *27362048
273630*    DOMAIN TABLES.                                              *27363048
273640******************************************************************27364048
273650 4320-GET-DOMAIN-DATA.                                            27365048
273660                                                                  27366048
273670     EXEC SQL                                                     27367048
273680          SELECT A.CSTM_CLOR_DESC                                 27368048
273690               , A.SIZE_DESC                                      27369048
273691               , B.MAJ_CL_NBR                                     27369148
273692               , B.SUB_CL_NBR                                     27369248
273693               , B.VS_NBR                                         27369348
273694               , B.STKR_NBR                                       27369449
273695            INTO :XLT00003-CSTM-CLOR-DESC                         27369549
273696               , :XLT00003-SIZE-DESC                              27369649
273697               , :XLT00004-MAJ-CL-NBR                             27369749
273698               , :XLT00004-SUB-CL-NBR                             27369849
273699               , :XLT00004-VS-NBR                                 27369949
273700               , :XLT00004-STKR-NBR                               27370049
273701            FROM XLT_SKU A                                        27370149
273702               , XLT_VND_STYL B                                   27370249
273703           WHERE A.ITM_NBR      = :DK-ITM-NBR                     27370349
273704             AND A.STYL_ID      = B.STYL_ID                       27370449
273705     END-EXEC.                                                    27370549
273706                                                                  27370649
273707     EVALUATE TRUE                                                27370749
273708         WHEN SQLCODE = ZERO                                      27370849
273709              SET PS-DOMAIN-INFO-FOUND                            27370949
273710                             TO TRUE                              27371049
273711         WHEN SQLCODE = +100                                      27371149
273712              SET PS-DOMAIN-INFO-NOT-FOUND                        27371249
273713                             TO TRUE                              27371349
273714         WHEN SQLWARN0 NOT = SPACES                               27371449
273715         WHEN SQLCODE  NOT = ZERO                                 27371549
273716              MOVE '4320-GET-DOMAIN-DATA'                         27371649
273717                             TO DP013-PARAGRAPH                   27371749
273718              MOVE 'UNSUCCESSFUL SELECT OF DOMAIN TABLE DATA'     27371849
273719                             TO DP013-MESSAGE-TEXT (1)            27371949
273720              MOVE SQLCA     TO DP013-SQLCA                       27372049
273721              MOVE 'XLT_SKU' TO DP013-DB2-TABLE-NAME (1)          27372149
273722              MOVE 'XLT_VND_STYL'                                 27372249
273723                             TO DP013-DB2-TABLE-NAME (2)          27372349
273724              SET DP013-DB2-ABEND                                 27372449
273725                  DP013-XCTL-DISPLAY-RESTART                      27372549
273726                             TO TRUE                              27372649
273727                                                                  27372749
273728              PERFORM DP013-0000-PROCESS-ABEND                    27372849
273729     END-EVALUATE.                                                27372949
273730                                                                  27373049
273731                                                                  27373149
273732****************************************************************  27373249
273733* FETCH THE VENDOR UPC FROM THE NEW XLV_UPC VIEW. THERE SHOULD *  27373349
273734* ONLY BE ONE VENDOR UCP BEING SENT EDI.  IF WE DO NOT FIND A  *  27373449
273735* VENDOR UPC, WE WILL FETCH THE INTERNAL UPC FROM THE VIEW AND *  27373549
273736* USE THAT ONE.                                                *  27373649
273737****************************************************************  27373749
273738 4360-SELECT-VENDOR-UPC.                                          27373849
273739                                                                  27373949
273740     INITIALIZE DCLXLV00003.                                      27374049
273750                                                                  27375049
273760     EXEC SQL                                                     27376049
273770          SELECT B.UPC_NBR                                        27377049
273780            INTO :XLV00003-UPC-NBR                                27378049
273790            FROM XLT_SKU A                                        27379049
273800               , XLV_UPC B                                        27380049
273900           WHERE A.ITM_NBR        = :DK-ITM-NBR                   27390049
274000             AND A.INTR_UPC_ID    = B.INTR_UPC_ID                 27400049
274100             AND B.UPC_TYP_CDE    = 'V'                           27410049
274200             AND EDI_ORD_IND    = 'Y'                             27420049
274300     END-EXEC.                                                    27430049
274400                                                                  27440049
274500     EVALUATE TRUE                                                27450049
274600         WHEN SQLCODE = ZERO                                      27460049
274700         WHEN SQLCODE = +100                                      27470049
274800         WHEN SQLCODE = -811                                      27480049
274900              CONTINUE                                            27490049
275000                                                                  27500049
275100         WHEN SQLWARN0 NOT = SPACES                               27510049
275200         WHEN SQLCODE  NOT = ZERO                                 27520049
275300              MOVE '4360-SELECT-VENDOR-UPC'                       27530049
275400                             TO DP013-PARAGRAPH                   27540049
275500              MOVE 'UNSUCCESSFUL SELECT OF VENDOR UPC'            27550049
275600                             TO DP013-MESSAGE-TEXT (1)            27560049
275700              MOVE PURITM-ITM-NBR                                 27570049
275800                             TO PV-ITM-NBR                        27580049
275900              STRING 'PURITM ITEM NUMBER = ' DELIMITED BY SIZE    27590049
276000                     PV-ITM-NBR-X            DELIMITED BY SIZE    27600049
276100                           INTO DP013-MESSAGE-TEXT (2)            27610049
276200              MOVE SQLCA     TO DP013-SQLCA                       27620049
276300              MOVE 'XLT_SKU' TO DP013-DB2-TABLE-NAME (1)          27630049
276400              MOVE 'XLV_UPC' TO DP013-DB2-TABLE-NAME (2)          27640049
276500              SET DP013-DB2-ABEND                                 27650049
276600                  DP013-XCTL-DISPLAY-RESTART                      27660049
276700                             TO TRUE                              27670049
276800              PERFORM DP013-0000-PROCESS-ABEND                    27680049
276900     END-EVALUATE.                                                27690049
277000                                                                  27700049
277100                                                                  27710049
277200****************************************************************  27720049
277300* FETCH THE INTERNAL UPC FROM THE XLV_UPC VIEW.  WE ARE USING  *  27730049
277400* 'FETCH FIRST ROW ONLY' TO FORCE DB2 TO BRING BACK ONLY ONE   *  27740049
277500* ROW FROM THE QUERY.  THIS METHOD IS MUCH MORE EFFICIENT THAN *  27750049
277600* CHECKING FOR A -811.  THIS METHOD IS NEW IN DB2V7.           *  27760049
277700****************************************************************  27770049
277800 4370-SELECT-INTERNAL-UPC.                                        27780049
277900                                                                  27790049
278000     INITIALIZE DCLXLV00003.                                      27800049
278100                                                                  27810049
278200     EXEC SQL                                                     27820049
278300          SELECT B.UPC_NBR                                        27830049
278400            INTO :XLV00003-UPC-NBR                                27840049
278500            FROM XLT_SKU A                                        27850049
278600               , XLV_UPC B                                        27860049
278700           WHERE A.ITM_NBR        = :DK-ITM-NBR                   27870049
278800             AND A.INTR_UPC_ID    = B.INTR_UPC_ID                 27880049
278900             AND B.UPC_TYP_CDE    = 'I'                           27890049
279000           FETCH FIRST ROW ONLY                                   27900049
279100     END-EXEC.                                                    27910049
279200                                                                  27920049
279300     EVALUATE TRUE                                                27930049
279400         WHEN SQLCODE = ZERO                                      27940049
279500              MOVE XLV00003-UPC-NBR                               27950049
279600                             TO ASC-UPC-NBR-N                     27960050
279610                                (ASC-BLK-SUB ASC-ITEM-SUB)        27961050
279700                                                                  27970049
279800         WHEN SQLWARN0 NOT = SPACES                               27980049
279900         WHEN SQLCODE  NOT = ZERO                                 27990049
280000              MOVE '4370-SELECT-INTERNAL-UPC'                     28000049
280100                             TO DP013-PARAGRAPH                   28010049
280200              MOVE 'UNSUCCESSFUL SELECT OF INTERNAL UPC'          28020049
280300                             TO DP013-MESSAGE-TEXT (1)            28030049
280400              MOVE PURITM-ITM-NBR                                 28040049
280500                             TO PV-ITM-NBR                        28050049
280600              STRING 'PURITM ITEM NUMBER = ' DELIMITED BY SIZE    28060049
280700                     PV-ITM-NBR-X            DELIMITED BY SIZE    28070049
280800                           INTO DP013-MESSAGE-TEXT (2)            28080049
280900              MOVE SQLCA     TO DP013-SQLCA                       28090049
281000              MOVE 'XLT_SKU' TO DP013-DB2-TABLE-NAME (1)          28100049
281100              MOVE 'XLV_UPC' TO DP013-DB2-TABLE-NAME (2)          28110049
281200              SET DP013-DB2-ABEND                                 28120049
281300                  DP013-XCTL-DISPLAY-RESTART                      28130049
281400                             TO TRUE                              28140049
281500              PERFORM DP013-0000-PROCESS-ABEND                    28150049
281600     END-EVALUATE.                                                28160049
281700                                                                  28170049
281800                                                                  28180049
281900***************************************************************   28190049
282000* THE FAMILY SHOE LABEL NEEDS THE SKU DESCRIPTION, AND THERE  *   28200049
282100* IS NOT ENOUGH ROOM IN THE COMMAREA.  WILL CALL THIS ONCE FOR*   28210049
282200* EACH SKU.                                                   *   28220049
282300***************************************************************   28230049
282400 4380-GET-SKU-DESCRIPTION.                                        28240049
282500                                                                  28250049
282600     EXEC SQL                                                     28260049
282700          SELECT                                                  28270049
282800                 A.SKU_DESC                                       28280049
283000            INTO                                                  28300049
283100                 :XLT00003-SKU-DESC                               28310049
283300            FROM XLT_SKU      A                                   28330049
283500           WHERE A.ITM_NBR           = :DK-ITM-NBR                28350049
283700     END-EXEC.                                                    28370049
283800                                                                  28380049
283900     EVALUATE TRUE                                                28390049
284000     WHEN SQLCODE = ZERO                                          28400049
284100     WHEN SQLCODE = -811                                          28410049
284200         CONTINUE                                                 28420049
284300     WHEN SQLCODE = +100                                          28430049
284400         MOVE SPACES TO XLT00003-SKU-DESC                         28440049
284500         MOVE ZEROS  TO XLT00004-STKR-NBR                         28450049
284600     WHEN OTHER                                                   28460049
284700          MOVE '4380-GET-SKU-DESCRIPTION'                         28470049
284800                              TO DP013-PARAGRAPH                  28480049
284900          MOVE 'UNSUCCESSFUL SELECT OF SKU INFORMATION'           28490049
285000                              TO DP013-MESSAGE-TEXT (1)           28500049
285100          MOVE PURITM-ITM-NBR TO PV-ITM-NBR                       28510049
285200          STRING 'PURITM ITEM NUMBER = ' DELIMITED BY SIZE        28520049
285300                     PV-ITM-NBR-X        DELIMITED BY SIZE        28530049
285400                            INTO  DP013-MESSAGE-TEXT (2)          28540049
285500          MOVE SQLCA          TO DP013-SQLCA                      28550049
285600          MOVE 'XLT_SKU'      TO DP013-DB2-TABLE-NAME (1)         28560049
285700          MOVE 'XLT_VND_STYL' TO DP013-DB2-TABLE-NAME (1)         28570049
285800          SET DP013-DB2-ABEND                                     28580049
285900              DP013-XCTL-DISPLAY-RESTART                          28590049
286000                              TO TRUE                             28600049
286100          PERFORM DP013-0000-PROCESS-ABEND                        28610049
286200     END-EVALUATE.                                                28620049
286300                                                                  28630049
286400                                                                  28640049
297100******************************************************************29710020
297200* MOVE THE ASC COMMAREA TO THE SCREEN FIELDS                      29720020
297300******************************************************************29730020
297400 4400-MOVE-COMMAREA-TO-SCREEN.                                    29740020
297500                                                                  29750020
297600     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         29760020
297700           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         29770020
297800           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            29780020
297900             MOVE +1             TO ASC-BLK-SUB                   29790020
298000                                                                  29800020
298100             PERFORM 5100-WRITE-TEMP-STORAGE                      29810020
298200                                                                  29820020
298300             ADD +1              TO ASC-BLK-SUB                   29830020
298400                                                                  29840020
298500             PERFORM 5100-WRITE-TEMP-STORAGE                      29850020
298600                                                                  29860020
298700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             29870020
298800                 GIVING PV-BLOCK-NUMBER                           29880020
298900                 REMAINDER PV-REMAINDER                           29890020
299000             IF PV-REMAINDER > ZERO                               29900020
299100                 ADD +1          TO PV-BLOCK-NUMBER               29910020
299200             END-IF                                               29920020
299300             MOVE +1             TO ASC-BLK-SUB                   29930020
299400                                                                  29940020
299500             PERFORM 4410-READ-TEMP-STORAGE                       29950020
299600                                                                  29960020
299700             ADD +1              TO ASC-BLK-SUB                   29970020
299800                                    PV-BLOCK-NUMBER               29980020
299900                                                                  29990020
300000             PERFORM 4410-READ-TEMP-STORAGE                       30000020
300100                                                                  30010020
300200     END-IF.                                                      30020020
300300                                                                  30030020
300400     MOVE +1                     TO ASC-BLK-SUB.                  30040020
300500     COMPUTE ASC-ITEM-SUB =                                       30050020
300600         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              30060020
300700                       + PC-ITEMS-PER-PANEL).                     30070020
300800                                                                  30080020
300900     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         30090020
301000         ADD +1                  TO ASC-BLK-SUB                   30100020
301100         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            30110020
301200     END-IF.                                                      30120020
301300                                                                  30130020
301400     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           30140020
301500         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                30150020
301600                                                                  30160020
301700     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        30170020
301800                                                                  30180020
301900     PERFORM 4420-FORMAT-LIST-LINES                               30190020
302000         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            30200020
302100         UNTIL   PV-SUB < +1.                                     30210020
302200                                                                  30220020
302300     COMPUTE ASC-ITEMS-DISPLAYED =                                30230020
302400                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).30240020
302500     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      30250020
302600                                    ASTRTITO.                     30260020
302700     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                30270020
302800                                 TO AENDITO.                      30280020
302900     MOVE ASC-NUMBER-OF-ITEMS-READ                                30290020
303000                                 TO ATOTITO.                      30300020
303100     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            30310020
303200                                 TO ASELITO.                      30320020
303300                                                                  30330020
303400     MOVE ASC-KEY-OPER-UNT-ID    TO AOPRUO.                       30340020
303500     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      30350020
303600     MOVE ASC-KEY-FCLTY-DESC     TO AFCLTDO.                      30360020
303700     MOVE ASC-LOCATION           TO ALOCATNO.                     30370020
303800     MOVE ASC-TKT-OFFICE         TO ATKTOFFO.                     30380020
303900*    MOVE ASC-SEASON-CDE         TO ASSNCDEO.                     30390020
304000*DH  MOVE SPACES                 TO ASSNCDEO.                     30400028
304100     MOVE ASC-EXTRA-TKTS         TO AXTKTSO.                      30410020
304200     MOVE ASC-EXTRA-TKT-PCT      TO AXTKTPCO.                     30420020
304300     MOVE ASC-DEPT-NBR           TO ADPTNBRO.                     30430020
304400     MOVE ASC-KEY-PO-NBR         TO APONBRO.                      30440020
304500     MOVE ASC-KEY-VENDOR-NAME    TO AVDRNMEO.                     30450020
304600                                                                  30460020
304700     IF DP020-MSG-NUMBER-X = SPACE                                30470020
304800        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    30480020
304900            MOVE PC-TSYMSG-00279 TO DP020-MSG-NUMBER              30490020
305000            SET DP020-MSG-INFORMATIONAL                           30500020
305100                                 TO TRUE                          30510020
305200        END-IF                                                    30520020
305300     END-IF.                                                      30530020
305400                                                                  30540020
305500 4410-READ-TEMP-STORAGE.                                          30550020
305600                                                                  30560020
305700     EXEC CICS READQ TS                                           30570020
305800               QUEUE (ASC-LIST-QUEUE-NAME)                        30580020
305900               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            30590020
306000               ITEM  (PV-BLOCK-NUMBER)                            30600020
306100               RESP  (PV-CICS-RESP)                               30610020
306200     END-EXEC.                                                    30620020
306300                                                                  30630020
306400     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     30640020
306500         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      30650020
306600         CONTINUE                                                 30660020
306700     ELSE                                                         30670020
306800         SET DP013-CICS-ABEND                                     30680020
306900             DP013-ROLLBACK   TO TRUE                             30690020
307000         MOVE '4410-READ-TEMP-STORAGE'                            30700020
307100                                 TO DP013-PARAGRAPH               30710020
307200         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   30720020
307300                                 TO DP013-MESSAGE-TEXT (1)        30730020
307400                                                                  30740020
307500         PERFORM DP013-0000-PROCESS-ABEND                         30750020
307600     END-IF.                                                      30760020
307700                                                                  30770020
307800     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     30780020
307900                                 TO TRUE.                         30790020
308000                                                                  30800020
308100     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          30810020
308200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               30820020
308300     END-IF.                                                      30830020
308400                                                                  30840020
308500 4420-FORMAT-LIST-LINES.                                          30850020
308600                                                                  30860020
308700     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       30870020
308800         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                30880020
308900         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     30890020
309000                                    MR-QUANT-A       (PV-SUB)     30900020
309100         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     30910020
309200                                    MR-LINE-NBR      (PV-SUB)     30920020
309300                                    MR-QUANT         (PV-SUB)     30930020
309400                                    MR-CLASS         (PV-SUB)     30940026
309500                                    MR-COLOR         (PV-SUB)     30950020
309600                                    MR-SIZE          (PV-SUB)     30960020
309700                                    MR-STYLE         (PV-SUB)     30970020
309800                                    MR-TKT-FORMAT    (PV-SUB)     30980020
309900                                    MR-RETAIL        (PV-SUB)     30990020
310000                                    MR-GP-RETAIL     (PV-SUB)     31000020
310010                                    MR-UPC-NBR-TXT   (PV-SUB)     31001026
310020                                    MR-UPC-NBR       (PV-SUB)     31002026
310100     ELSE                                                         31010020
310200         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     31020020
310300                                                             SPACE31030020
310400             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 31040020
310500                                 TO MR-SELECTI (PV-SUB)           31050020
310600         ELSE                                                     31060020
310700             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      31070020
310800                                 TO MR-SELECTI (PV-SUB)           31080020
310900         END-IF                                                   31090020
311000                                                                  31100020
311100         IF DP030-SET-CURSOR-TRAILER                              31110020
311200            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  31120020
311300                                                             SPACE31130020
311400               OR PV-SUB = 1                                      31140020
311500                SET DP030-SET-CURSOR-APPL-1                       31150020
311600                                 TO TRUE                          31160020
311700                MOVE -1          TO MR-SELECTL (PV-SUB)           31170020
311800            END-IF                                                31180020
311900         END-IF                                                   31190020
312000                                                                  31200020
312100         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            31210020
312200             MOVE ASC-PO-LNE-NBR     (ASC-BLK-SUB ASC-ITEM-SUB)   31220020
312300                                 TO MR-LINE-NBR-EDITED (PV-SUB)   31230020
312400             MOVE ASC-UNT-QTY-N      (ASC-BLK-SUB ASC-ITEM-SUB)   31240020
312500                                 TO MR-QUANT-EDITED    (PV-SUB)   31250020
312800             STRING ASC-MAJOR-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)    31280026
312900                    ' '                                           31290026
313000                    ASC-SUB-CLASS (ASC-BLK-SUB ASC-ITEM-SUB)      31300026
313100                    DELIMITED BY SIZE                             31310020
313200                               INTO MR-CLASS           (PV-SUB)   31320026
313300             IF ASC-DISP-COLOR (ASC-BLK-SUB ASC-ITEM-SUB)         31330020
313400                 MOVE ASC-COLOR      (ASC-BLK-SUB ASC-ITEM-SUB)   31340020
313500                                 TO MR-COLOR           (PV-SUB)   31350020
313600             ELSE                                                 31360020
313700                 MOVE SPACES     TO MR-COLOR           (PV-SUB)   31370020
313800             END-IF                                               31380020
313900                                                                  31390020
314000             IF ASC-DISP-SIZE (ASC-BLK-SUB ASC-ITEM-SUB)          31400020
314100                 MOVE ASC-SIZE       (ASC-BLK-SUB ASC-ITEM-SUB)   31410020
314200                                 TO MR-SIZE            (PV-SUB)   31420020
314300             ELSE                                                 31430020
314400                 MOVE SPACES     TO MR-SIZE            (PV-SUB)   31440020
314500             END-IF                                               31450020
314610**                                                                31461056
314620** HIGHLIGHT UPC IN YELLOW WHEN IT IS NOT FOUND                   31462056
314630**                                                                31463056
314640             IF  ASC-UPC-NBR (ASC-BLK-SUB ASC-ITEM-SUB) =         31464057
314650                                                    '** NOT FOUND'31465056
314660                 MOVE DP015-YELLOW                                31466056
314670                                 TO MR-UPC-NBR-C (PV-SUB)         31467057
314680             ELSE                                                 31468056
314690                 MOVE DP015-BLUE TO MR-UPC-NBR-C (PV-SUB)         31469057
314691             END-IF                                               31469156
314692                                                                  31469256
314700             MOVE ASC-VEND-STYL      (ASC-BLK-SUB ASC-ITEM-SUB)   31470020
314800                                 TO MR-STYLE           (PV-SUB)   31480020
314900             MOVE ASC-TKT-FORMAT     (ASC-BLK-SUB ASC-ITEM-SUB)   31490020
315000                                 TO MR-TKT-FORMAT      (PV-SUB)   31500020
315100             MOVE ASC-UNT-RTL-PR     (ASC-BLK-SUB ASC-ITEM-SUB)   31510020
315200                                 TO MR-RETAIL-EDITED   (PV-SUB)   31520020
315210******************************************************************31521026
315220*  IF THERE IS GROUP PRICING, FORMAT THE GROUP PRICE AS GROUP     31522026
315230*  QUANTITY, SLASH, GROUP PRICE (IE 3/7.00).  I AM USING TWO      31523026
315240*  DIFFERENT PRICE FIELDS TO ALLOW FOR GROUP PRICES 9.99 AND LOWER31524026
315250*  ALONG WITH GROUP PRICES 10.00 TO 99.99.  THIS WILL LINE UP THE 31525026
315260*  GROUP PRICE FIELD BETTER ON THE MAP.                           31526026
315270******************************************************************31527026
315280             IF ASC-GP-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 1     31528026
315290                 MOVE ASC-GP-RTL-QTY (ASC-BLK-SUB ASC-ITEM-SUB)   31529026
315291                                     TO PV-GP-QTY                 31529126
315292                 IF  ASC-GP-RTL (ASC-BLK-SUB ASC-ITEM-SUB) < 10.0031529226
315293                     MOVE ASC-GP-RTL (ASC-BLK-SUB ASC-ITEM-SUB)   31529326
315294                                     TO PV-GP-RTL-1               31529426
315295                     STRING  PC-SPACE                             31529526
315296                             PV-GP-QTY                            31529626
315297                             '/'                                  31529726
315298                             PV-GP-RTL-1                          31529826
315299                             DELIMITED BY SIZE                    31529926
315300                                   INTO MR-GP-RETAIL (PV-SUB)     31530026
315301                 ELSE                                             31530126
315302                     MOVE ASC-GP-RTL (ASC-BLK-SUB ASC-ITEM-SUB)   31530226
315303                                     TO PV-GP-RTL-2               31530326
315304                     STRING  PV-GP-QTY                            31530426
315305                             '/'                                  31530526
315306                             PV-GP-RTL-2                          31530626
315307                             DELIMITED BY SIZE                    31530726
315308                                   INTO MR-GP-RETAIL (PV-SUB)     31530826
315309                 END-IF                                           31530926
315310             ELSE                                                 31531026
315311                 MOVE SPACES         TO MR-GP-RETAIL (PV-SUB)     31531126
315312             END-IF                                               31531226
315313                                                                  31531326
316510             MOVE ASC-UPC-NBR-TXT    (ASC-BLK-SUB ASC-ITEM-SUB)   31651026
316520                                 TO MR-UPC-NBR-TXT     (PV-SUB)   31652026
316530             MOVE ASC-UPC-NBR        (ASC-BLK-SUB ASC-ITEM-SUB)   31653026
316540                                 TO MR-UPC-NBR         (PV-SUB)   31654026
316600         END-IF                                                   31660020
316700     END-IF.                                                      31670020
316800                                                                  31680020
316900     SUBTRACT +1 FROM ASC-ITEM-SUB.                               31690020
317000                                                                  31700020
317100     IF ASC-ITEM-SUB < +1                                         31710020
317200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  31720020
317300         MOVE +1                 TO ASC-BLK-SUB.                  31730020
317400                                                                  31740020
317500 4430-CHECK-FOR-BEGIN-AND-END.                                    31750020
317600                                                                  31760020
317700     IF ASC-START-OF-SELECTED-RANGE > ZERO                        31770020
317800        IF ASC-END-OF-SELECTED-RANGE = ZERO                       31780020
317900            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              31790020
318000            SET DP020-MSG-WARNING                                 31800020
318100                                 TO TRUE                          31810020
318200                                                                  31820020
318300            PERFORM 4431-POSITION-AT-WARNING                      31830020
318400                                                                  31840020
318500         END-IF                                                   31850020
318600     ELSE                                                         31860020
318700         IF ASC-END-OF-SELECTED-RANGE > ZERO                      31870020
318800             MOVE PC-TSYMSG-00053                                 31880020
318900                                 TO DP020-MSG-NUMBER              31890020
319000             SET DP020-MSG-WARNING                                31900020
319100                                 TO TRUE                          31910020
319200                                                                  31920020
319300             PERFORM 4431-POSITION-AT-WARNING                     31930020
319400                                                                  31940020
319500         END-IF                                                   31950020
319600     END-IF.                                                      31960020
319700                                                                  31970020
319800 4431-POSITION-AT-WARNING.                                        31980020
319900                                                                  31990020
320000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               32000020
320100                                                  PV-TOP-ITEM + 1.32010020
320200     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       32020020
320300         CONTINUE                                                 32030020
320400     ELSE                                                         32040020
320500         SET DP030-SET-CURSOR-APPL-1                              32050020
320600                                 TO TRUE                          32060020
320700         MOVE -1                 TO MR-SELECTL (PV-SUB)           32070020
320800         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           32080020
320900         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           32090020
321000     END-IF.                                                      32100020
321100                                                                  32110020
321200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.32120020
321300                                                                  32130020
321400     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       32140020
321500         CONTINUE                                                 32150020
321600     ELSE                                                         32160020
321700         SET DP030-SET-CURSOR-APPL-1                              32170020
321800                                 TO TRUE                          32180020
321900         MOVE -1                 TO MR-SELECTL (PV-SUB)           32190020
322000         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           32200020
322100         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           32210020
322200     END-IF.                                                      32220020
322300                                                                  32230020
322400******************************************************************32240020
322500* THIS MODULE INITIALIZES DRS (DYNAMIC REPORT SYSTEM) AND         32250020
322600* ESTABLISHES THE DESTINATION OF THE TICKETS BASED UPON THE       32260020
322700* TICKET OFFICE SELECTED.                                         32270020
322800******************************************************************32280020
322900                                                                  32290020
323000                                                                  32300020
323100 4500-PROCESS-TICKET-REQ.                                         32310020
323200                                                                  32320020
323300     MOVE PC-INIT TO DRS01-DRRB-FUNC.                             32330020
323400                                                                  32340020
323500     MOVE ASC-TKT-OFF-ADR-ID TO DRS02-DRIB-DEST                   32350020
323600     EVALUATE ASC-TKT-OFFICE                                      32360020
323700         WHEN 'XXX1'                                              32370020
323800         WHEN 'XXX2'                                              32380020
323900         WHEN 'XXX3'                                              32390020
324000         WHEN 'XXX4'                                              32400020
324100         WHEN 'XXX5'                                              32410020
324300             MOVE 'R'     TO DRS02-DRIB-CLASS                     32430020
324400             MOVE 'N'     TO DRS02-DRIB-HOLD                      32440020
324500             MOVE 'LOCAL' TO DRS02-DRIB-DEST                      32450020
324600     END-EVALUATE.                                                32460020
324700                                                                  32470020
324800     MOVE DRS02-DRIB-HEADER TO DRS01-COMM-DRIB-HDR.               32480020
324900     MOVE DRS02-DRIB-ATTRIB TO DRS01-COMM-DRIB-AT1.               32490020
325000                                                                  32500020
325100     PERFORM 4555-LINK-TO-DRS.                                    32510020
325200                                                                  32520020
325300* FIND THE SELECTED LINES, AND PRINT THE TICKETS                  32530020
325310     INITIALIZE PV-LINES-NOT-PRINTED.                             32531053
325400     PERFORM 4505-PROCESS-TICKET-REQ.                             32540020
325500                                                                  32550020
325600     MOVE PC-TERM TO DRS01-DRRB-FUNC.                             32560020
325700     PERFORM 4555-LINK-TO-DRS.                                    32570020
325710     IF  PV-LINES-NOT-PRINTED > 0                                 32571053
325720         MOVE PC-TSYMSG-03037    TO DP020-MSG-NUMBER              32572053
325730     ELSE                                                         32573053
325800         MOVE PC-TSYMSG-00098    TO DP020-MSG-NUMBER              32580053
325810     END-IF.                                                      32581053
325900                                                                  32590020
326000******************************************************************32600020
326100* THIS MODULE CREATES DATA STREAMS FOR BUILDING ONE.  BUILDING    32610020
326200* ONE DATA STREAMS ARE CREATED IN HEADER, ONE TO MANY DETAILS AND 32620020
326300* TRAILER FORMAT.                                                 32630020
326400******************************************************************32640020
326500                                                                  32650020
326600 4505-PROCESS-TICKET-REQ.                                         32660020
326700                                                                  32670020
326800* MAKE SURE LIST QUEUE IS REFRESHED                               32680020
326900     MOVE +1                     TO ASC-BLK-SUB.                  32690020
327000     PERFORM 5100-WRITE-TEMP-STORAGE.                             32700020
327100     ADD +1                      TO ASC-BLK-SUB.                  32710020
327200     PERFORM 5100-WRITE-TEMP-STORAGE.                             32720020
327300                                                                  32730020
327400     PERFORM 6010-DELETE-SEL-QUEUE.                               32740020
327500                                                                  32750020
327600     SET ASC-UPDATE-TSQ          TO TRUE.                         32760020
327700     SET PC016-IDX               TO 1.                            32770020
327800     INITIALIZE PC016-SELECTED-ITEM-ARRAY.                        32780020
327900                                                                  32790020
328000* PROCESS TICKETS                                                 32800020
328100     MOVE ASC-KEY-PO-NBR-N                                        32810020
328200                        TO PV-KEY-PO-NBR                          32820020
328300     MOVE 000           TO PV-KEY-REC-SEQ-NBR                     32830020
328400     MOVE PV-JOB-ID     TO MP049O-HDR-JOB-ID.                     32840020
328500     SET PS-CREATE-HEADER TO TRUE.                                32850020
328600     PERFORM VARYING PV-ITEM  FROM 1 BY 1                         32860020
328700             UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN          32870020
328800       PERFORM 6112-READ-LIST-QUEUE                               32880020
328900       PERFORM                                                    32890020
329000       VARYING LQW-IDX  FROM 1 BY 1                               32900020
329100       UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                    32910020
329200               LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO              32920020
329300                                                                  32930020
329400         IF LQW-SELECT (LQW-IDX)                                  32940020
329410             IF LQW-UPC-12 (LQW-IDX) = '** NOT FOUND'             32941053
329420                 ADD 1          TO PV-LINES-NOT-PRINTED           32942053
329430             ELSE                                                 32943053
329500                 PERFORM 4525-COMPUTE-TICKET-REQ                  32950053
329600                 INITIALIZE PV-QUANTITY-SEQ-NMBR                  32960053
329700                 MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                  32970053
329800                                TO PV-PO-LINE-NMBR-DETAIL         32980020
329900                 PERFORM 4515-CREATE-DTL-LINE                     32990053
329910             END-IF                                               32991053
330000         END-IF                                                   33000020
330100       END-PERFORM                                                33010020
330200     END-PERFORM.                                                 33020020
330300                                                                  33030020
330400     PERFORM 4550-MOVE-TRAILER-RECORD.                            33040020
330500     PERFORM 4555-LINK-TO-DRS.                                    33050020
330600                                                                  33060020
330700                                                                  33070020
330800                                                                  33080020
330900******************************************************************33090020
331000* THIS MODULE CREATES A DETAIL LINE WHICH IS SENT TO DRS (DYNAMIC 33100020
331100* REPORT SYSTEM).  IF THE TICKET QUANTITY EXCEEDS THE 9999 LIMIT  33110020
331200* A SECOND DETAIL LINE IS CREATED WITH A UNIQUE CONTROL NUMBER.   33120020
331300* THE UNIQUE CONTROL NUMBER IS REQUIRED BECAUSE CURRENT SYSTEM    33130020
331400* CONSTRAINTS ON THE DENNISON TICKETING SYSTEM WILL NOT HANDLE    33140020
331500* MULTIPLE DETAIL LINES WITH THE SAME CONTROL NUMBER.             33150020
331600******************************************************************33160020
331700                                                                  33170020
331800 4515-CREATE-DTL-LINE.                                            33180020
331900     PERFORM                                                      33190020
332000         UNTIL PV-TICKET-QUANTITY                                 33200020
332100                   < PC-MAX-PC-TICKET-QUANTITY                    33210020
332200         MOVE PC-MAX-PC-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS     33220020
332300         PERFORM 4540-BUILD-TICKET-DTL-REC                        33230020
332400         MOVE PC-PUT TO DRS01-DRRB-FUNC                           33240020
332500         PERFORM 4555-LINK-TO-DRS                                 33250020
332600         COMPUTE PV-TICKET-QUANTITY =                             33260020
332700          PV-TICKET-QUANTITY - PC-MAX-PC-TICKET-QUANTITY          33270020
332800         ADD 1 TO PV-QUANTITY-SEQ-NMBR                            33280020
332900     END-PERFORM.                                                 33290020
333000                                                                  33300020
333100     IF PV-TICKET-QUANTITY NOT = ZERO                             33310020
333200         MOVE PV-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS            33320020
333300         PERFORM 4540-BUILD-TICKET-DTL-REC                        33330020
333400         MOVE PC-PUT TO DRS01-DRRB-FUNC                           33340020
333500         PERFORM 4555-LINK-TO-DRS                                 33350020
333600     END-IF.                                                      33360020
333700                                                                  33370020
333800******************************************************************33380020
333900* THIS MODULE CREATES A TOTAL LINE WHICH IS SENT TO DRS (DYNAMIC  33390020
334000* REPORT SYSTEM).  IF THE TICKET QUANTITY EXCEEDS THE 9999 LIMIT  33400020
334100* A SECOND DETAIL LINE IS CREATED WITH A UNIQUE CONTROL NUMBER.   33410020
334200* THE UNIQUE CONTROL NUMBER IS REQUIRED BECAUSE CURRENT SYSTEM    33420020
334300* CONSTRAINTS ON THE DENNISON TICKETING SYSTEM WILL NOT HANDLE    33430020
334400* MULTIPLE DETAIL LINES WITH THE SAME CONTROL NUMBER.             33440020
334500******************************************************************33450020
334600                                                                  33460020
334700 4520-CREATE-TOTAL-DTL.                                           33470020
334800     PERFORM                                                      33480020
334900         UNTIL PV-TOTAL-TICKET-QUANTITY                           33490020
335000                   < PC-MAX-PC-TICKET-QUANTITY                    33500020
335100         MOVE PC-MAX-PC-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS     33510020
335200         PERFORM 4540-BUILD-TICKET-DTL-REC                        33520020
335300         MOVE PC-PUT TO DRS01-DRRB-FUNC                           33530020
335400         PERFORM 4555-LINK-TO-DRS                                 33540020
335500         COMPUTE PV-TOTAL-TICKET-QUANTITY =                       33550020
335600          PV-TOTAL-TICKET-QUANTITY - PC-MAX-PC-TICKET-QUANTITY    33560020
335700         ADD 1 TO PV-QUANTITY-SEQ-NMBR                            33570020
335800     END-PERFORM.                                                 33580020
335900                                                                  33590020
336000     IF PV-TOTAL-TICKET-QUANTITY NOT = ZERO                       33600020
336100         MOVE PV-TOTAL-TICKET-QUANTITY TO PV-NMBR-OF-TICKETS      33610020
336200         PERFORM 4540-BUILD-TICKET-DTL-REC                        33620020
336300         MOVE PC-PUT TO DRS01-DRRB-FUNC                           33630020
336400         PERFORM 4555-LINK-TO-DRS                                 33640020
336500     END-IF.                                                      33650020
336600                                                                  33660020
336700******************************************************************33670020
336800* THIS MODULE COMPUTES THE NUMBER OF TICKETS REQUIRED FOR EACH    33680020
336900* LINE ITEM SELECTED FOR TICKETS.  THERE IS A DEFAULT VALUE FOR   33690020
337000* EACH TICKET FORMAT WHICH MAY BE OVERRIDDEN BY THE USER.  THE    33700020
337100* EVALUATE FIRST DETERMINES IF THE USER KEYED AN EXTRA TICKET     33710020
337200* COUNT OR PERCENT.  IF THEY DID, THIS VALUE IS USED, OTHERWISE   33720020
337300* THE DEFAULT IS USED.                                            33730020
337400******************************************************************33740020
337500                                                                  33750020
337600 4525-COMPUTE-TICKET-REQ.                                         33760020
337700     INSPECT LQW-UNT-QTY (LQW-IDX) TALLYING PV-ID FOR ALL ' '     33770020
337800         REPLACING ALL ' ' BY ZEROS.                              33780020
337900     EVALUATE TRUE                                                33790020
338000         WHEN ASC-EXTRA-TKTS NOT = SPACES AND                     33800020
338100              ASC-EXTRA-TKTS NOT = ZEROES                         33810020
338200             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 33820020
338300                ASC-EXTRA-TKTS-N + LQW-UNT-QTY (LQW-IDX)          33830020
338400         WHEN ASC-EXTRA-TKTS NOT = SPACES AND                     33840020
338500              ASC-EXTRA-TKTS  = ZEROES                            33850020
338600             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 33860020
338700                 LQW-UNT-QTY (LQW-IDX)                            33870020
338800         WHEN ASC-EXTRA-TKT-PCT NOT = SPACES AND                  33880020
338900              ASC-EXTRA-TKT-PCT NOT = ZEROES AND                  33890020
339000              LQW-UNT-QTY (LQW-IDX) > ZERO                        33900020
339100             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 33910020
339200                (ASC-EXTRA-TKT-PCT-N  * LQW-UNT-QTY (LQW-IDX))    33920020
339300                   / 100 + LQW-UNT-QTY (LQW-IDX)                  33930020
339400         WHEN LQW-LNE-XTKTS (LQW-IDX) = ZERO AND                  33940020
339500              LQW-UNT-QTY (LQW-IDX) > ZERO                        33950020
339600             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 33960020
339700             (LQW-LNE-XTKT-PCT (LQW-IDX) * LQW-UNT-QTY (LQW-IDX)) 33970020
339800                          / 100 + LQW-UNT-QTY (LQW-IDX)           33980020
339900         WHEN OTHER                                               33990020
340000             COMPUTE PV-TICKET-QUANTITY ROUNDED =                 34000020
340100                LQW-LNE-XTKTS (LQW-IDX)                           34010020
340200                   + LQW-UNT-QTY (LQW-IDX)                        34020020
340300     END-EVALUATE.                                                34030020
340400                                                                  34040020
340500     COMPUTE PV-TOTAL-TICKET-QUANTITY =                           34050020
340600         PV-TOTAL-TICKET-QUANTITY + PV-TICKET-QUANTITY.           34060020
340700                                                                  34070020
340800******************************************************************34080020
340900* THIS MODULE BUILDS A HEADER DATA STREAM WHICH IS SENT TO THE    34090020
341000* DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).      34100020
341100* THE FOLLOWING TICKET FORMATS ARE CONVERTED TO MATCH THE FORMATS 34110020
341200* AS DEFINED ON THE DENNISON TICKETING SYSTEM:  T9180 BECOMES     34120020
341300* T9180D AND L9150 BECOMES L9150C.                                34130020
341400******************************************************************34140020
341500                                                                  34150020
341600 4535-BUILD-HDR-RECORD.                                           34160020
341900     IF (LQW-TKT-FORMAT (LQW-IDX) = 'LABEL') AND                  34190027
342000        (LQW-GP-RTL-QTY (LQW-IDX) > ZERO)                         34200020
342100         MOVE 'LABEL  '                                           34210027
342200                    TO MP049O-HDR-FORMAT-NAME                     34220020
342300         MOVE 'LABEL   '                                          34230020
342400                    TO MP049O-HDR-STOCK-TYPE                      34240020
342500         SET PS-MULTI-PRICE-HEADER TO TRUE                        34250020
342600                                                                  34260020
342700     ELSE                                                         34270020
343100         IF (LQW-TKT-FORMAT (LQW-IDX) = 'EASYOF' OR               34310020
343300             LQW-TKT-FORMAT (LQW-IDX) = 'ESYGWP' OR               34330027
343310             LQW-TKT-FORMAT (LQW-IDX) = 'GUMSOC') AND             34331027
343400            (LQW-GP-RTL-QTY (LQW-IDX) > ZERO)                     34340020
343500             MOVE 'EASYOF '                                       34350041
343600                        TO MP049O-HDR-FORMAT-NAME                 34360020
343700             MOVE 'EASYOF  '                                      34370020
343800                        TO MP049O-HDR-STOCK-TYPE                  34380020
343900             SET PS-MULTI-PRICE-HEADER TO TRUE                    34390020
344000                                                                  34400020
344100         ELSE                                                     34410020
344200             MOVE LQW-TKT-FORMAT (LQW-IDX)                        34420020
344300                        TO MP049O-HDR-FORMAT-NAME                 34430020
344400             MOVE LQW-PAPER-TYP-ID (LQW-IDX)                      34440020
344500                        TO MP049O-HDR-STOCK-TYPE                  34450020
344600         END-IF                                                   34460020
344700     END-IF.                                                      34470020
344800     MOVE SPACES               TO DRS01-COMM-CTL.                 34480020
344900     MOVE MP049O-HEADER-RECORD TO DRS01-COMM-DATA.                34490020
345000     MOVE PC-PUT               TO DRS01-DRRB-FUNC.                34500020
345100     PERFORM 4555-LINK-TO-DRS.                                    34510020
345200                                                                  34520020
345300******************************************************************34530020
345400* THIS MODULE EVALUATES WHICH DATA STREAM FORMAT WILL BE BUILT    34540020
345500* FOR THE TICKET FORMAT SELECTED AND SENDS CONTROL TO THE         34550020
345600* APPROPRIATE MODULE.                                             34560020
345700******************************************************************34570020
345800                                                                  34580020
345900 4540-BUILD-TICKET-DTL-REC.                                       34590020
346000     EVALUATE LQW-TKT-FORMAT (LQW-IDX)                            34600020
346100*    EVALUATE PV-TKT-FMT-DESC                                     34610020
346400         WHEN 'ID'                                                34640020
346700             PERFORM 4610-BLD-ID-LABEL-DTL                        34670020
346800         WHEN 'EASYOF'                                            34680020
346900         WHEN 'GUMSOC'                                            34690020
347000         WHEN 'ESYGWP'                                            34700020
347400             PERFORM 4620-BLD-EASY-OFF-LABEL-DTL                  34740020
347500         WHEN 'JEWST'                                             34750020
347600             PERFORM 4630-BLD-JEWST-LABEL-DTL                     34760020
347700         WHEN 'LABEL'                                             34770020
348100             PERFORM 4640-BLD-LABEL-LABEL-DTL                     34810020
348200         WHEN 'TAG'                                               34820020
348300         WHEN 'TAGGWP'                                            34830020
348400         WHEN 'HTAG'                                              34840020
348500         WHEN 'HNGSOC'                                            34850020
348600             PERFORM 4650-BLD-TAG-LABEL-DTL                       34860020
348700         WHEN 'SUPRES'                                            34870020
348800             PERFORM 4660-BLD-SUPRESS-LABEL-DTL                   34880020
348900         WHEN 'FAMILY'                                            34890020
349000             PERFORM 4670-BLD-FAMILY-LABEL-DTL                    34900020
349100         WHEN 'SHOSUP'                                            34910020
349200             PERFORM 4675-BLD-SUPRES-SHOE-LABEL-DTL               34920020
349410         WHEN 'PRICE '                                            34941027
349420             PERFORM 4685-BLD-PRICE-LABEL-DTL                     34942027
349900     END-EVALUATE.                                                34990020
350000     IF PS-CREATE-HEADER                                          35000020
350100         MOVE DRS01-COMMAREA TO PV-SAVE-COMM-DATA                 35010020
350200         PERFORM 4535-BUILD-HDR-RECORD                            35020020
350300         SET PS-HEADER-CREATED TO TRUE                            35030020
350400         MOVE PV-SAVE-COMM-DATA TO DRS01-COMMAREA                 35040020
350500     END-IF.                                                      35050020
350600                                                                  35060020
350700******************************************************************35070020
350800* THIS MODULE MOVES A TRAILER DATA STREAM WHICH IS SENT TO THE    35080020
350900* DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).      35090020
351000******************************************************************35100020
351100                                                                  35110020
351200 4550-MOVE-TRAILER-RECORD.                                        35120020
351300     MOVE SPACES                        TO DRS01-COMM-CTL.        35130020
351400     MOVE MP049O-TICKET-TRAILER-RECORD  TO DRS01-COMM-DATA.       35140020
351500     MOVE PC-PUT                        TO DRS01-DRRB-FUNC.       35150020
351600                                                                  35160020
351700******************************************************************35170020
351800* THIS MODULE EXECUTES A LINK TO DRS (DYNAMIC REPORT SYSTEM).     35180020
351900******************************************************************35190020
352000                                                                  35200020
352100 4555-LINK-TO-DRS.                                                35210020
352200                                                                  35220020
352300     EXEC CICS                                                    35230020
352400         LINK                                                     35240020
352500             PROGRAM   ('DRS1INTC')                               35250020
352600             COMMAREA  (DRS01-COMMAREA)                           35260020
352700     END-EXEC.                                                    35270020
352800                                                                  35280020
352900     EVALUATE TRUE                                                35290020
353000         WHEN DRS01-DRRB-RC = ZERO                                35300020
353100             CONTINUE                                             35310020
353200         WHEN OTHER                                               35320020
353300             MOVE '4555-LINK-TO-DRS'    TO DP013-PARAGRAPH        35330020
353400             SET DP013-OTHER-ABEND      TO TRUE                   35340020
353500             MOVE DRS01-DRRB-FUNC       TO PV-DRS-DRRB-FUNC       35350020
353600             MOVE DRS01-DRRB-RID        TO PV-DRS-DRRB-RID        35360020
353700             MOVE DRS01-DRRD-OPTIONS    TO PV-DRS-DRRB-OPTIONS    35370020
353800             MOVE DRS01-DRRB-RC         TO PV-DRS-DRRB-RC         35380020
353900             MOVE DRS01-DRRB-ATTR-ERROR TO PV-DRS-ATTR-ERROR      35390020
354000             MOVE DRS01-DRRB-DRDC       TO PV-DRS-DRRB-DRDC       35400020
354100             MOVE DRS01-DRRB01-LINES    TO PV-DRS-DRRB-LINES      35410020
354200             MOVE PV-DRS-ABEND-DISPLAY-LINE1                      35420020
354300                                        TO DP013-MESSAGE-TEXT (1) 35430020
354400             MOVE PV-DRS-ABEND-DISPLAY-LINE2                      35440020
354500                                        TO DP013-MESSAGE-TEXT (2) 35450020
354600             PERFORM DP013-0000-PROCESS-ABEND                     35460020
354700     END-EVALUATE.                                                35470020
354800                                                                  35480020
354900                                                                  35490020
358200******************************************************************35820020
358300* THIS MODULE BUILDS THE DATA STREAM FOR A COMPANION TICKET WITH  35830020
358400* ONE DESCRIPTION LINE (SHOE STICKER) WHICH IS SENT TO THE        35840020
358500* DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).      35850020
358600******************************************************************35860020
358700                                                                  35870020
358800 4610-BLD-ID-LABEL-DTL.                                           35880020
363700     IF PS-CREATE-HEADER                                          36370027
363800         MOVE PC-HHP                  TO MP049O-ID-TASK           36380027
363900     ELSE                                                         36390027
364000         MOVE PC-PRINT                TO MP049O-ID-TASK           36400027
364100     END-IF.                                                      36410027
364200     MOVE PV-PO-REC-SEQ               TO MP049O-ID-RECEIVER.      36420027
364300     MOVE ASC-KEY-VENDOR-NAME         TO MP049O-ID-VNDR-NAME.     36430027
364400     MOVE ASC-LOCATION                TO MP049O-ID-LOCATION.      36440027
364600     MOVE LQW-STICKER-NBR (LQW-IDX)   TO MP049O-ID-STICKERNO.     36460027
364800     MOVE PV-NMBR-OF-TICKETS          TO PV-NMBR-OF-TICKETS-4-DGT 36480027
364900                                         MP049O-ID-SYS-QTY.       36490027
365000     MOVE PV-NMBR-OF-TICKETS-4-DGT    TO MP049O-ID-QTY.           36500027
365100     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)  TO MP049O-ID-PO-LINE.       36510027
365200     MOVE SPACES                      TO DRS01-COMM-CTL.          36520027
365300     MOVE MP049O-DETAIL-ID            TO DRS01-COMM-DATA.         36530027
365500                                                                  36550020
365600******************************************************************36560020
365700* THIS MODULE BUILDS THE DATA STREAM FOR EASY OFF STICKER LABELS  36570020
365800* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 36580020
365900* REPORT SYSTEM).  NOTE!  IF THE SKU IS NOT SETUP, THE DEFAULT    36590020
366000* IS TO PRINT TEN TICKETS SHOWING ONLY THE SKU NUMBER.            36600020
366100******************************************************************36610020
366200                                                                  36620020
366300 4620-BLD-EASY-OFF-LABEL-DTL.                                     36630020
366400     IF LQW-TKT-FORMAT (LQW-IDX) = 'ESYGWP'                       36640020
366500         IF PS-CREATE-HEADER                                      36650020
366600             MOVE PC-HHP              TO MP049O-EASYGWP-TASK      36660020
366700         ELSE                                                     36670020
366800             MOVE PC-HP               TO MP049O-EASYGWP-TASK      36680020
366900         END-IF                                                   36690020
367000         MOVE PV-PO-REC-SEQ           TO MP049O-EASYGWP-RECEIVER  36700020
367100         MOVE ASC-KEY-VENDOR-NAME     TO MP049O-EASYGWP-VNDR-NAME 36710020
367200         MOVE ASC-LOCATION            TO MP049O-EASYGWP-LOCATION  36720020
367300         MOVE ASC-DEPT-NBR            TO MP049O-EASYGWP-DEPT      36730020
367400         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           36740027
367410                                      TO MP049O-EASYGWP-CLASS     36741027
367500         MOVE LQW-SUB-CLASS (LQW-IDX) TO MP049O-EASYGWP-SUB-CLASS 36750027
367700         MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                         36770020
367800                                      TO MP049O-EASYGWP-RETAIL    36780020
368400         MOVE LQW-UPC (LQW-IDX)       TO MP049O-EASYGWP-UPC       36840020
368410         MOVE LQW-VEND-STYL(LQW-IDX)  TO MP049O-EASYGWP-STYLE     36841027
368500                                                                  36850020
368600         MOVE PV-NMBR-OF-TICKETS      TO PV-NMBR-OF-TICKETS-4-DGT 36860027
368700                                         MP049O-EASYGWP-SYS-QTY   36870027
368800         MOVE PV-NMBR-OF-TICKETS-4-DGT                            36880027
368810                                      TO MP049O-EASYGWP-QTY       36881027
368900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        36890020
369000                                    TO PV-NUMBER-OF-SELECTED-ITEMS36900027
369100         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         36910020
369200                                      TO MP049O-EASYGWP-TOTAL-SKU 36920020
369300         MOVE SPACES                  TO DRS01-COMM-CTL           36930020
369400         MOVE MP049O-DETAIL-EASYGWP   TO DRS01-COMM-DATA          36940020
369500     ELSE                                                         36950020
374000         IF PS-CREATE-HEADER                                      37400027
374100             MOVE PC-HHP              TO MP049O-EASYOFF-TASK      37410027
374200         ELSE                                                     37420027
374300             MOVE PC-HP               TO MP049O-EASYOFF-TASK      37430027
374400         END-IF                                                   37440027
374500         MOVE PV-PO-REC-SEQ           TO MP049O-EASYOFF-RECEIVER  37450027
374600         MOVE ASC-KEY-VENDOR-NAME     TO MP049O-EASYOFF-VNDR-NAME 37460027
374700         MOVE ASC-LOCATION            TO MP049O-EASYOFF-LOCATION  37470027
374800         MOVE ASC-DEPT-NBR            TO MP049O-EASYOFF-DEPT      37480027
374900         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           37490027
374910                                      TO MP049O-EASYOFF-CLASS     37491027
375000         MOVE LQW-SUB-CLASS (LQW-IDX) TO MP049O-EASYOFF-SUB-CLASS 37500027
375500*DH      MOVE ASC-SEASON-CDE      TO MP049O-EASYOFF-SEASON        37550035
375600         MOVE LQW-UNT-RTL-PR-X  (LQW-IDX)                         37560035
375700                                  TO MP049O-EASYOFF-RETAIL        37570035
375710         IF ((LQW-GP-RTL-QTY (LQW-IDX) = ZERO)                    37571035
375720                   OR                                             37572035
375730             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   37573035
375740             MOVE SPACES          TO MP049O-EASYOFF-MULTICOUNT    37574035
375750         ELSE                                                     37575035
375760             MOVE LQW-GP-RTL-QTY (LQW-IDX)                        37576035
375770                                  TO  PV-GP-QTY-1                 37577035
375780             MOVE PV-GP-QTY-SLASH                                 37578035
375790                                  TO MP049O-EASYOFF-MULTICOUNT    37579035
375791         END-IF                                                   37579135
375792                                                                  37579235
375793         IF ((LQW-GP-RTL (LQW-IDX) = ZERO)                        37579335
375794                   OR                                             37579435
375795             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   37579535
375796             MOVE SPACES          TO MP049O-EASYOFF-MULTIPRICE    37579635
375797         ELSE                                                     37579735
375798             IF LQW-GP-RTL (LQW-IDX) < 10.00                      37579835
375799                MOVE LQW-GP-RTL   (LQW-IDX)                       37579935
375800                                  TO PV-GP-RTL-DOLLAR-1           37580035
375801                MOVE PV-GP-RTL-DOLLAR-1                           37580135
375802                                  TO MP049O-EASYOFF-MULTIPRICE    37580235
375803             ELSE                                                 37580335
375804                MOVE LQW-GP-RTL   (LQW-IDX)                       37580435
375805                                  TO PV-GP-RTL-DOLLAR-2           37580535
375806                MOVE PV-GP-RTL-DOLLAR-2                           37580635
375807                                  TO MP049O-EASYOFF-MULTIPRICE    37580735
375808             END-IF                                               37580835
375810         END-IF                                                   37581027
375900         MOVE LQW-UPC (LQW-IDX)       TO MP049O-EASYOFF-UPC       37590027
375910         MOVE LQW-VEND-STYL(LQW-IDX)  TO MP049O-EASYOFF-STYLE     37591027
376000         MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                          37600027
376100                                      TO MP049O-EASYOFF-PO-LINE   37610027
376200                                                                  37620027
376400         MOVE PV-NMBR-OF-TICKETS      TO PV-NMBR-OF-TICKETS-4-DGT 37640027
376500                                         MP049O-EASYOFF-SYS-QTY   37650027
376600         MOVE PV-NMBR-OF-TICKETS-4-DGT                            37660027
376610                                      TO MP049O-EASYOFF-QTY       37661027
376700         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        37670027
376800                                    TO PV-NUMBER-OF-SELECTED-ITEMS37680027
376900         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         37690027
377000                                      TO MP049O-EASYOFF-TOTAL-SKU 37700027
377100         MOVE SPACES                  TO DRS01-COMM-CTL           37710027
377200         MOVE MP049O-DETAIL-EASYOFF   TO DRS01-COMM-DATA          37720027
377400     END-IF.                                                      37740020
377500                                                                  37750020
377600******************************************************************37760020
377700* THIS MODULE BUILDS THE DATA STREAM FOR SMALL GUM LABELS WHICH   37770020
377800* IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC       37780020
377900* REPORT SYSTEM).  NOTE!  IF THE SKU IS NOT SETUP, THE DEFAULT    37790020
378000* IS TO PRINT TEN TICKETS SHOWING ONLY THE SKU NUMBER.            37800020
378100******************************************************************37810020
378200                                                                  37820020
378300 4630-BLD-JEWST-LABEL-DTL.                                        37830020
378400     IF PS-CREATE-HEADER                                          37840020
378500         MOVE PC-HHP              TO MP049O-JEWST-TASK            37850020
378600     ELSE                                                         37860020
378700         MOVE PC-HP               TO MP049O-JEWST-TASK            37870020
378800     END-IF.                                                      37880020
378900     MOVE PV-PO-REC-SEQ           TO MP049O-JEWST-RECEIVER.       37890020
379000     MOVE ASC-KEY-VENDOR-NAME     TO MP049O-JEWST-VNDR-NAME.      37900020
379100     MOVE ASC-LOCATION            TO MP049O-JEWST-LOCATION.       37910020
379200     MOVE ASC-DEPT-NBR            TO MP049O-JEWST-DEPT.           37920020
379300     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               37930027
379310                                  TO MP049O-JEWST-CLASS.          37931027
379400     MOVE LQW-SUB-CLASS (LQW-IDX) TO MP049O-JEWST-SUB-CLASS.      37940027
379500     MOVE LQW-UPC (LQW-IDX)       TO MP049O-JEWST-UPC.            37950020
379510     MOVE LQW-VEND-STYL(LQW-IDX)  TO MP049O-JEWST-STYLE.          37951027
379600     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              37960020
379700                                  TO MP049O-JEWST-PO-LINE.        37970020
379800     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37980020
379900                                  TO PV-NUMBER-OF-SELECTED-ITEMS. 37990035
380000     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             38000020
380100                                  TO MP049O-JEWST-TOTAL-SKU.      38010035
380700*DH  MOVE ASC-SEASON-CDE       TO MP049O-JEWST-SEASON.            38070035
380800     MOVE LQW-UNT-RTL-PR-X (LQW-IDX)                              38080035
380900                                   TO MP049O-JEWST-RETAIL.        38090035
381100     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    38110020
381200                                      MP049O-JEWST-SYS-QTY.       38120020
381300     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-JEWST-QTY.           38130020
381400     MOVE SPACES                   TO DRS01-COMM-CTL.             38140020
381500     MOVE MP049O-DETAIL-JEWST      TO DRS01-COMM-DATA.            38150020
381600                                                                  38160020
381700******************************************************************38170020
381800* THIS MODULE BUILDS THE DATA STREAMS FOR THE VENDOR UPC GUM LABEL38180020
381900* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 38190020
382000* REPORT SYSTEM).  NOTE!  IF THE SKU IS NOT SETUP, THE DEFAULT IS 38200020
382100* TO PRINT TEN TICKETS SHOWING ONLY THE SKU AND A UPC CODE OF ALL 38210020
382200* ZEROS.                                                          38220020
382300******************************************************************38230020
382400                                                                  38240020
382500 4640-BLD-LABEL-LABEL-DTL.                                        38250020
388800     IF PS-CREATE-HEADER                                          38880026
388900         MOVE PC-HHP               TO MP049O-LABEL-TASK           38890026
389000     ELSE                                                         38900026
389100         MOVE PC-HP                TO MP049O-LABEL-TASK           38910026
389200     END-IF.                                                      38920026
389300     MOVE PV-PO-REC-SEQ            TO MP049O-LABEL-RECEIVER.      38930026
389400     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-LABEL-VNDR-NAME.     38940026
389500     MOVE ASC-LOCATION             TO MP049O-LABEL-LOCATION.      38950026
389600     MOVE ASC-DEPT-NBR             TO MP049O-LABEL-DEPT.          38960026
389700     MOVE LQW-MAJOR-CLASS(LQW-IDX) TO MP049O-LABEL-CLASS.         38970026
389710     MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-LABEL-SUB-CLASS.     38971026
389900     MOVE LQW-UPC (LQW-IDX)        TO MP049O-LABEL-UPC.           38990026
390000     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              39000026
390100                                   TO MP049O-LABEL-PO-LINE.       39010026
390200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            39020026
390300                                   TO PV-NUMBER-OF-SELECTED-ITEMS.39030026
390400     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             39040026
390500                                   TO MP049O-LABEL-TOTAL-SKU.     39050026
390600                                                                  39060026
391500     MOVE LQW-VEND-STYL (LQW-IDX)                                 39150035
391600                               TO MP049O-LABEL-STYLE.             39160035
391700     IF LQW-DISP-SIZE (LQW-IDX)                                   39170035
391800         MOVE LQW-SIZE (LQW-IDX)                                  39180035
391900                               TO MP049O-LABEL-SIZE               39190035
392000     ELSE                                                         39200035
392100         MOVE SPACES           TO MP049O-LABEL-SIZE               39210035
392200     END-IF.                                                      39220035
392300*DH  MOVE ASC-SEASON-CDE       TO MP049O-LABEL-SEASON             39230035
392400     IF LQW-DISP-COLOR (LQW-IDX)                                  39240035
392500         MOVE LQW-COLOR (LQW-IDX)                                 39250035
392600                               TO MP049O-LABEL-COLOR              39260035
392700     ELSE                                                         39270035
392800         MOVE SPACES           TO MP049O-LABEL-COLOR              39280035
392900     END-IF.                                                      39290035
393000     MOVE LQW-OPT-BLK (LQW-IDX)                                   39300035
393100                               TO MP049O-LABEL-OPTION-BLK         39310035
393200     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             39320035
393300                               TO MP049O-LABEL-RETAIL             39330035
393310     IF ((LQW-GP-RTL-QTY (LQW-IDX) = ZERO)                        39331035
393320               OR                                                 39332035
393330         (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                       39333035
393340         MOVE SPACES           TO MP049O-LABEL-MULTICOUNT         39334035
393350     ELSE                                                         39335035
393360         MOVE LQW-GP-RTL-QTY (LQW-IDX)                            39336035
393370                               TO PV-GP-QTY-1                     39337035
393380         MOVE PV-GP-QTY-SLASH                                     39338035
393390                               TO MP049O-LABEL-MULTICOUNT         39339035
393391     END-IF.                                                      39339135
393392                                                                  39339235
393393     IF ((LQW-GP-RTL (LQW-IDX) = ZERO)                            39339335
393394               OR                                                 39339435
393395         (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                       39339535
393396         MOVE SPACES           TO MP049O-LABEL-MULTIPRICE         39339635
393397     ELSE                                                         39339735
393398         IF LQW-GP-RTL (LQW-IDX) < 10.00                          39339835
393399            MOVE LQW-GP-RTL   (LQW-IDX)                           39339935
393400                               TO PV-GP-RTL-DOLLAR-1              39340035
393401            MOVE PV-GP-RTL-DOLLAR-1                               39340135
393402                               TO MP049O-LABEL-MULTIPRICE         39340235
393403         ELSE                                                     39340335
393404            MOVE LQW-GP-RTL   (LQW-IDX)                           39340435
393405                               TO PV-GP-RTL-DOLLAR-2              39340535
393406            MOVE PV-GP-RTL-DOLLAR-2                               39340635
393407                               TO MP049O-LABEL-MULTIPRICE         39340735
393408         END-IF                                                   39340835
393500     END-IF.                                                      39350026
393600                                                                  39360026
393700     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    39370026
393800                                      MP049O-LABEL-SYS-QTY.       39380026
393900     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-LABEL-QTY.           39390026
394000     MOVE MP049O-DETAIL-LABEL      TO DRS01-COMM-DATA.            39400026
394400     MOVE SPACES                   TO DRS01-COMM-CTL.             39440020
394500                                                                  39450020
394600******************************************************************39460020
394700* THIS MODULE BUILDS THE DATA STREAMS FOR THE VENDOR UPC HANG TAG 39470020
394800* AND VENDOR UPC SALE HANG TAG WHICH IS SENT TO THE DENNISON      39480020
394900* TICKETING SYSTEM VIA DRS (DYNAMIC REPORT SYSTEM).  NOTE!  IF    39490020
395000* THE SKU IS NOT SETUP, THE DEFAULT IS TO PRINT TEN TICKETS       39500020
395100* SHOWING ONLY THE SKU AND UPC CODE.                              39510020
395200******************************************************************39520020
395300                                                                  39530020
395400 4650-BLD-TAG-LABEL-DTL.                                          39540020
395500     IF LQW-TKT-FORMAT (LQW-IDX) = 'TAGGWP'                       39550020
395600         IF PS-CREATE-HEADER                                      39560020
395700             MOVE PC-HHP               TO MP049O-TAGGWP-TASK      39570020
395800         ELSE                                                     39580020
395900             MOVE PC-HP                TO MP049O-TAGGWP-TASK      39590020
396000         END-IF                                                   39600020
396100         MOVE PV-PO-REC-SEQ            TO MP049O-TAGGWP-RECEIVER  39610020
396200         MOVE ASC-KEY-VENDOR-NAME      TO MP049O-TAGGWP-VNDR-NAME 39620020
396300         MOVE ASC-LOCATION             TO MP049O-TAGGWP-LOCATION  39630020
396400         MOVE ASC-DEPT-NBR             TO MP049O-TAGGWP-DEPT      39640020
396500         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           39650027
396510                                       TO MP049O-TAGGWP-CLASS     39651027
396600         MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-TAGGWP-SUB-CLASS 39660027
396700         MOVE LQW-UPC (LQW-IDX)        TO MP049O-TAGGWP-UPC       39670020
396800*        MOVE LQW-UNT-RTL-PRICE-3 (LQW-IDX)                       39680020
396900         MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                         39690020
397000                                       TO MP049O-TAGGWP-RETAIL    39700020
397100         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        39710020
397200                                  TO PV-NUMBER-OF-SELECTED-ITEMS  39720020
397300         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         39730020
397400                                  TO MP049O-TAGGWP-TOTAL-SKU      39740020
398300*DH      MOVE ASC-SEASON-CDE        TO MP049O-TAGGWP-SEASON       39830035
398400         MOVE LQW-VEND-STYL (LQW-IDX) TO MP049O-TAGGWP-STYLE      39840035
398500         IF LQW-DISP-SIZE (LQW-IDX)                               39850035
398600             MOVE LQW-SIZE (LQW-IDX)                              39860035
398700                                   TO MP049O-TAGGWP-SIZE          39870035
398800         ELSE                                                     39880035
398900             MOVE SPACES           TO MP049O-TAGGWP-SIZE          39890035
399000         END-IF                                                   39900035
399100         IF LQW-DISP-COLOR (LQW-IDX)                              39910035
399200             MOVE LQW-COLOR (LQW-IDX)                             39920035
399300                                   TO MP049O-TAGGWP-COLOR         39930035
399400         ELSE                                                     39940035
399500             MOVE SPACES           TO MP049O-TAGGWP-COLOR         39950035
399600         END-IF                                                   39960035
399700         MOVE LQW-OPT-BLK (LQW-IDX)                               39970035
399800                                TO MP049O-TAGGWP-OPTION-BLK       39980035
400200         MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT40020020
400300                                          MP049O-TAGGWP-SYS-QTY   40030020
400400         MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-TAGGWP-QTY       40040020
400500         MOVE SPACES                    TO DRS01-COMM-CTL         40050020
400600         MOVE MP049O-DETAIL-TAGGWP      TO DRS01-COMM-DATA        40060020
400700     ELSE                                                         40070020
400800         IF PS-CREATE-HEADER                                      40080020
400900             MOVE PC-HHP               TO MP049O-TAG-TASK         40090020
401000         ELSE                                                     40100020
401100             MOVE PC-HP                TO MP049O-TAG-TASK         40110020
401200         END-IF                                                   40120020
401300         MOVE PV-PO-REC-SEQ            TO MP049O-TAG-RECEIVER     40130020
401400         MOVE ASC-KEY-VENDOR-NAME      TO MP049O-TAG-VNDR-NAME    40140020
401500         MOVE ASC-LOCATION             TO MP049O-TAG-LOCATION     40150020
401600         MOVE ASC-DEPT-NBR             TO MP049O-TAG-DEPT         40160020
401700         MOVE LQW-MAJOR-CLASS (LQW-IDX)                           40170027
401710                                       TO MP049O-TAG-CLASS        40171027
401800         MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-TAG-SUB-CLASS    40180027
401900         MOVE LQW-UPC (LQW-IDX)        TO MP049O-TAG-UPC          40190020
402000         MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                          40200020
402100                                       TO MP049O-TAG-PO-LINE      40210020
402200         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        40220020
402300                                  TO PV-NUMBER-OF-SELECTED-ITEMS  40230020
402400         MOVE PV-NUMBER-OF-SELECTED-ITEMS                         40240020
402500                                  TO MP049O-TAG-TOTAL-SKU         40250020
403700*DH      MOVE ASC-SEASON-CDE        TO MP049O-TAG-SEASON          40370035
403800         MOVE LQW-VEND-STYL (LQW-IDX) TO MP049O-TAG-STYLE         40380035
403900         IF LQW-DISP-SIZE (LQW-IDX)                               40390035
404000             MOVE LQW-SIZE (LQW-IDX)                              40400035
404100                                   TO MP049O-TAG-SIZE             40410035
404200         ELSE                                                     40420035
404300             MOVE SPACES           TO MP049O-TAG-SIZE             40430035
404400         END-IF                                                   40440035
404500         IF LQW-DISP-COLOR (LQW-IDX)                              40450035
404600             MOVE LQW-COLOR (LQW-IDX)                             40460035
404700                                   TO MP049O-TAG-COLOR            40470035
404800         ELSE                                                     40480035
404900             MOVE SPACES           TO MP049O-TAG-COLOR            40490035
405000         END-IF                                                   40500035
405100         MOVE LQW-OPT-BLK (LQW-IDX)                               40510035
405200                                    TO MP049O-TAG-OPTION-BLK      40520035
405300         MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                         40530035
405400                                    TO MP049O-TAG-RETAIL          40540035
405500                                                                  40550035
405600         IF ((LQW-GP-RTL-QTY (LQW-IDX) = ZERO)                    40560035
405700                   OR                                             40570035
405800             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   40580035
405900             MOVE SPACES TO MP049O-TAG-MULTICOUNT                 40590035
406000         ELSE                                                     40600035
406100             MOVE LQW-GP-RTL-QTY   (LQW-IDX)                      40610035
406200                 TO  PV-GP-QTY-1                                  40620035
406300             MOVE PV-GP-QTY-SLASH                                 40630035
406400                 TO MP049O-TAG-MULTICOUNT                         40640035
406500         END-IF                                                   40650035
406600                                                                  40660035
406700         IF ((LQW-GP-RTL (LQW-IDX) = ZERO)                        40670035
406800                   OR                                             40680035
406900             (LQW-UNT-RTL-PR (LQW-IDX) = ZERO))                   40690035
407000             MOVE SPACES TO MP049O-TAG-MULTIPRICE                 40700035
407100         ELSE                                                     40710035
407200             IF LQW-GP-RTL (LQW-IDX) < 10.00                      40720035
407300                MOVE LQW-GP-RTL   (LQW-IDX)                       40730035
407400                                   TO PV-GP-RTL-DOLLAR-1          40740035
407500                MOVE PV-GP-RTL-DOLLAR-1                           40750035
407600                                   TO MP049O-TAG-MULTIPRICE       40760035
407610             ELSE                                                 40761035
407620                MOVE LQW-GP-RTL   (LQW-IDX)                       40762035
407630                                   TO PV-GP-RTL-DOLLAR-2          40763035
407640                MOVE PV-GP-RTL-DOLLAR-2                           40764035
407650                                   TO MP049O-TAG-MULTIPRICE       40765035
407660             END-IF                                               40766035
407700         END-IF                                                   40770020
407800                                                                  40780020
407900         MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT40790020
408000                                          MP049O-TAG-SYS-QTY      40800020
408100         MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-TAG-QTY          40810020
408200         MOVE SPACES                    TO DRS01-COMM-CTL         40820020
408300         MOVE MP049O-DETAIL-TAG         TO DRS01-COMM-DATA        40830020
408400     END-IF.                                                      40840020
408500                                                                  40850020
408600******************************************************************40860020
408700* THIS MODULE BUILDS THE DATA STREAM FOR SUPRESSED LABELS WHICH   40870020
408800* IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC       40880020
408900* REPORT SYSTEM).  NOTE!  IF THE SKU IS NOT SETUP, THE DEFAULT    40890020
409000* IS TO PRINT TEN TICKETS SHOWING ONLY THE SKU NUMBER.            40900020
409100******************************************************************40910020
409200                                                                  40920020
409300 4660-BLD-SUPRESS-LABEL-DTL.                                      40930020
409400                                                                  40940020
409500     IF PS-CREATE-HEADER                                          40950020
409600         MOVE PC-HHP               TO MP049O-SUPRES-TASK          40960020
409700     ELSE                                                         40970020
409800         MOVE PC-HP                TO MP049O-SUPRES-TASK          40980020
409900     END-IF.                                                      40990020
410000     MOVE PV-PO-REC-SEQ            TO MP049O-SUPRES-RECEIVER.     41000020
410100     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-SUPRES-VNDR-NAME.    41010020
410200     MOVE ASC-LOCATION             TO MP049O-SUPRES-LOCATION.     41020020
410300     MOVE ASC-DEPT-NBR             TO MP049O-SUPRES-DEPT.         41030020
410400     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               41040027
410401                                   TO MP049O-SUPRES-CLASS.        41040127
410410     MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-SUPRES-SUB-CLASS.    41041027
410500                                                                  41050020
410900     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             41090035
411000                                   TO MP049O-SUPRES-RETAIL.       41100035
411200                                                                  41120020
411300     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              41130020
411400                                   TO MP049O-SUPRES-PO-LINE.      41140020
411500                                                                  41150020
411600     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    41160020
411700                                      MP049O-SUPRES-SYS-QTY.      41170020
411800     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-SUPRES-QTY.          41180020
411900     MOVE SPACES                   TO DRS01-COMM-CTL.             41190020
412000     MOVE MP049O-DETAIL-SUPRES     TO DRS01-COMM-DATA.            41200020
412100                                                                  41210020
412200******************************************************************41220020
412300* THIS MODULE BUILDS THE DATA STREAM FOR FAMILY LABELS WHICH      41230020
412400* IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC       41240020
412500* REPORT SYSTEM).  NOTE!  IF THE SKU IS NOT SETUP, THE DEFAULT    41250020
412600* IS TO PRINT TEN TICKETS SHOWING ONLY THE SKU NUMBER.            41260020
412700******************************************************************41270020
412800                                                                  41280020
412900 4670-BLD-FAMILY-LABEL-DTL.                                       41290020
413000                                                                  41300020
413100     IF PS-CREATE-HEADER                                          41310020
413200         MOVE PC-HHP               TO MP049O-FAMILY-TASK          41320020
413300     ELSE                                                         41330020
413400         MOVE PC-HP                TO MP049O-FAMILY-TASK          41340020
413500     END-IF.                                                      41350020
413600     MOVE PV-PO-REC-SEQ            TO MP049O-FAMILY-RECEIVER.     41360020
413700     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-FAMILY-VNDR-NAME.    41370020
413800     MOVE ASC-LOCATION             TO MP049O-FAMILY-LOCATION.     41380020
413900     MOVE ASC-DEPT-NBR             TO MP049O-FAMILY-DEPT.         41390020
414000     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               41400027
414010                                   TO MP049O-FAMILY-CLASS.        41401027
414100     MOVE LQW-SUB-CLASS (LQW-IDX)  TO MP049O-FAMILY-SUB-CLASS.    41410027
414200     MOVE LQW-UPC (LQW-IDX)        TO MP049O-FAMILY-UPC.          41420020
415100     MOVE LQW-VEND-STYL (LQW-IDX)                                 41510035
415200                                   TO MP049O-FAMILY-STYLE.        41520035
415300     IF LQW-DISP-SIZE (LQW-IDX)                                   41530035
415400         MOVE LQW-SIZE (LQW-IDX)                                  41540035
415500                                   TO MP049O-FAMILY-SIZE          41550020
415600     ELSE                                                         41560035
415700         MOVE SPACES               TO MP049O-FAMILY-SIZE          41570035
415800     END-IF.                                                      41580035
415900     IF LQW-DISP-COLOR (LQW-IDX)                                  41590035
416000         MOVE LQW-COLOR (LQW-IDX)                                 41600035
416100                                   TO MP049O-FAMILY-COLOR         41610020
416200     ELSE                                                         41620035
416300         MOVE SPACES               TO MP049O-FAMILY-COLOR         41630035
416400     END-IF.                                                      41640035
416500     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             41650035
416600                                   TO MP049O-FAMILY-RETAIL.       41660035
416700     MOVE LQW-ITM-NBR (LQW-IDX)    TO DK-ITM-NBR.                 41670054
417000     PERFORM 4380-GET-SKU-DESCRIPTION.                            41700020
417100     MOVE XLT00003-SKU-DESC        TO MP049O-FAMILY-SHOE-NAME.    41710049
417200                                                                  41720020
417300     MOVE LQW-STICKER-NBR (LQW-IDX)                               41730020
417400                                   TO MP049O-FAMILY-STICKERNO.    41740020
417500     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              41750020
417600                                   TO MP049O-FAMILY-PO-LINE.      41760020
417700     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            41770020
417800                                   TO PV-NUMBER-OF-SELECTED-ITEMS 41780020
417900     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             41790020
418000                                   TO MP049O-FAMILY-TOTAL-SKU     41800020
418100                                                                  41810020
418200     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    41820020
418300                                      MP049O-FAMILY-SYS-QTY.      41830020
418400     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-FAMILY-QTY.          41840020
418500     MOVE SPACES                   TO DRS01-COMM-CTL.             41850020
418600     MOVE MP049O-DETAIL-FAMILY     TO DRS01-COMM-DATA.            41860020
418700                                                                  41870020
418800******************************************************************41880020
418900* THIS MODULE BUILDS THE DATA STREAM FOR SUPPRESSED SHOE LABELS   41890020
419000* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 41900020
419100* REPORT SYSTEM).  NOTE!  IF THE SKU IS NOT SETUP, THE DEFAULT    41910020
419200* IS TO PRINT TEN TICKETS SHOWING ONLY THE SKU NUMBER.            41920020
419300******************************************************************41930020
419400                                                                  41940020
419500 4675-BLD-SUPRES-SHOE-LABEL-DTL.                                  41950020
419600                                                                  41960020
419700     IF PS-CREATE-HEADER                                          41970020
419800         MOVE PC-HHP            TO MP049O-SUPRES-SHOE-TASK        41980020
419900     ELSE                                                         41990020
420000         MOVE PC-HP             TO MP049O-SUPRES-SHOE-TASK        42000020
420100     END-IF.                                                      42010020
420200     MOVE PV-PO-REC-SEQ         TO MP049O-SUPRES-SHOE-RECEIVER.   42020020
420300     MOVE ASC-KEY-VENDOR-NAME   TO MP049O-SUPRES-SHOE-VNDR-NAME.  42030020
420400     MOVE ASC-LOCATION          TO MP049O-SUPRES-SHOE-LOCATION.   42040020
420500     MOVE ASC-DEPT-NBR          TO MP049O-SUPRES-SHOE-DEPT.       42050020
420600     MOVE LQW-MAJOR-CLASS (LQW-IDX)                               42060027
420601                                TO MP049O-SUPRES-SHOE-CLASS.      42060127
420610     MOVE LQW-SUB-CLASS (LQW-IDX)                                 42061027
420620                                TO MP049O-SUPRES-SHOE-SUB-CLASS.  42062027
421200     MOVE LQW-VEND-STYL (LQW-IDX)                                 42120035
421300                                TO MP049O-SUPRES-SHOE-STYLE.      42130035
421400     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             42140035
421500                                TO MP049O-SUPRES-SHOE-RETAIL.     42150035
421900     MOVE LQW-STICKER-NBR (LQW-IDX)                               42190020
422000                                TO MP049O-SUPRES-SHOE-STICKERNO.  42200020
422100     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              42210020
422200                                TO MP049O-SUPRES-SHOE-PO-LINE.    42220020
422300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            42230020
422400                                TO PV-NUMBER-OF-SELECTED-ITEMS.   42240020
422500     MOVE PV-NUMBER-OF-SELECTED-ITEMS                             42250020
422600                                TO MP049O-SUPRES-SHOE-TOTAL-SKU.  42260020
422700                                                                  42270020
422800     MOVE PV-NMBR-OF-TICKETS    TO PV-NMBR-OF-TICKETS-4-DGT       42280020
422900                                   MP049O-SUPRES-SHOE-SYS-QTY.    42290020
423000     MOVE PV-NMBR-OF-TICKETS-4-DGT                                42300020
423100                                TO MP049O-SUPRES-SHOE-QTY.        42310020
423200     MOVE SPACES                TO DRS01-COMM-CTL.                42320020
423300     MOVE MP049O-DETAIL-SUPRES-SHOE                               42330020
423400                                TO DRS01-COMM-DATA.               42340020
423500                                                                  42350020
426400******************************************************************42640027
426500* THIS MODULE BUILDS THE DATA STREAM FOR THE PRICE TICKET FORMAT  42650027
426600* WHICH IS SENT TO THE DENNISON TICKETING SYSTEM VIA DRS (DYNAMIC 42660027
426700* REPORT SYSTEM).                                                 42670027
426800******************************************************************42680027
426900                                                                  42690027
427000 4685-BLD-PRICE-LABEL-DTL.                                        42700027
427100                                                                  42710027
427200     IF PS-CREATE-HEADER                                          42720027
427300         MOVE PC-HHP               TO MP049O-PRICE-TASK           42730027
427400     ELSE                                                         42740027
427500         MOVE PC-HP                TO MP049O-PRICE-TASK           42750027
427600     END-IF.                                                      42760027
427700     MOVE PV-PO-REC-SEQ            TO MP049O-PRICE-RECEIVER.      42770027
427800     MOVE ASC-KEY-VENDOR-NAME      TO MP049O-PRICE-VNDR-NAME.     42780027
427900     MOVE ASC-LOCATION             TO MP049O-PRICE-LOCATION.      42790027
428000                                                                  42800027
428100     MOVE LQW-UNT-RTL-PRICE (LQW-IDX)                             42810027
428200                                   TO MP049O-PRICE-RETAIL         42820027
428300                                                                  42830027
428400     MOVE LQW-PO-LNE-NBR-X (LQW-IDX)                              42840027
428500                                   TO MP049O-PRICE-PO-LINE.       42850027
428600                                                                  42860027
428700     MOVE PV-NMBR-OF-TICKETS       TO PV-NMBR-OF-TICKETS-4-DGT    42870027
428800                                      MP049O-PRICE-SYS-QTY.       42880027
428900     MOVE PV-NMBR-OF-TICKETS-4-DGT TO MP049O-PRICE-QTY.           42890027
429000     MOVE SPACES                   TO DRS01-COMM-CTL.             42900027
429100     MOVE MP049O-DETAIL-PRICE      TO DRS01-COMM-DATA.            42910044
429200                                                                  42920027
439700 5100-WRITE-TEMP-STORAGE.                                         43970020
439800                                                                  43980020
439900     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    43990020
440000                                 TO PV-LIST-ITEM-NUMBER.          44000020
440100     COMPUTE PV-BLOCK-NUMBER = 1 +                                44010020
440200                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).44020020
440300                                                                  44030020
440400     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           44040020
440500        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       44050020
440600                                                                  44060020
440700            PERFORM 5105-REWRITE-ASC-LISTQ                        44070020
440800                                                                  44080020
440900        END-IF                                                    44090020
441000     ELSE                                                         44100020
441100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       44110020
441200                                     ASC-HIGHEST-BLOCK-WRITTEN + 144120020
441300         PERFORM 5110-WRITE-ASC-LISTQ                             44130020
441400                                                                  44140020
441500         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     44150020
441600     END-IF.                                                      44160020
441700                                                                  44170020
441800     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     44180020
441900                                 TO TRUE.                         44190020
442000                                                                  44200020
442100 5105-REWRITE-ASC-LISTQ.                                          44210020
442200                                                                  44220020
442300     EXEC CICS WRITEQ TS                                          44230020
442400               QUEUE   (ASC-LIST-QUEUE-NAME)                      44240020
442500               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           44250020
442600               ITEM    (PV-BLOCK-NUMBER)                          44260020
442700               REWRITE                                            44270020
442800               RESP    (PV-CICS-RESP)                             44280020
442900     END-EXEC.                                                    44290020
443000                                                                  44300020
443100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       44310020
443200         SET DP013-CICS-ABEND                                     44320020
443300             DP013-ROLLBACK   TO TRUE                             44330020
443400         MOVE '5105-REWRITE-ASC-LISTQ'                            44340020
443500                                 TO DP013-PARAGRAPH               44350020
443600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'44360020
443700                                 TO DP013-MESSAGE-TEXT (1)        44370020
443800         PERFORM DP013-0000-PROCESS-ABEND                         44380020
443900     END-IF.                                                      44390020
444000                                                                  44400020
444100 5110-WRITE-ASC-LISTQ.                                            44410020
444200                                                                  44420020
444300     EXEC CICS WRITEQ TS                                          44430020
444400               QUEUE (ASC-LIST-QUEUE-NAME)                        44440020
444500               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            44450020
444600               ITEM  (PV-BLOCK-NUMBER)                            44460020
444700               RESP  (PV-CICS-RESP)                               44470020
444800     END-EXEC.                                                    44480020
444900                                                                  44490020
445000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      44500020
445100         SET DP013-CICS-ABEND                                     44510020
445200             DP013-ROLLBACK   TO TRUE                             44520020
445300         MOVE '5110-WRITE-ASC-LISTQ'                              44530020
445400                                 TO DP013-PARAGRAPH               44540020
445500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  44550020
445600                                 TO DP013-MESSAGE-TEXT (1)        44560020
445700         PERFORM DP013-0000-PROCESS-ABEND                         44570020
445800     END-IF.                                                      44580020
445900                                                                  44590020
446000                                                                  44600020
446100 5205-WRITE-SEL-QUEUE.                                            44610020
446200                                                                  44620020
446300     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            44630020
446400                                 TO PC016-SELECTED-ITEMS.         44640020
446500                                                                  44650020
446600     EXEC CICS WRITEQ TS                                          44660020
446700               QUEUE (ASC-SEL-QUEUE-NAME)                         44670020
446800               FROM  (PC016-TS-SEL-REC)                           44680020
446900               ITEM  (PV-SEL-QUEUE-ITEM)                          44690020
447000               RESP  (PV-CICS-RESP)                               44700020
447100     END-EXEC.                                                    44710020
447200                                                                  44720020
447300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       44730020
447400         SET DP013-CICS-ABEND                                     44740020
447500             DP013-ROLLBACK   TO TRUE                             44750020
447600         MOVE '5205-WRITE-SEL-QUEUE'                              44760020
447700                                 TO DP013-PARAGRAPH               44770020
447800         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   44780020
447900                                 TO DP013-MESSAGE-TEXT (1)        44790020
448000         PERFORM DP013-0000-PROCESS-ABEND                         44800020
448100     END-IF.                                                      44810020
448200                                                                  44820020
448300 5300-SEARCH-FOR-SELECTION.                                       44830020
448400                                                                  44840020
448500     PERFORM 6112-READ-LIST-QUEUE.                                44850020
448600                                                                  44860020
448700     IF PV-CICS-RESP = DFHRESP (NORMAL)                           44870020
448800         PERFORM                                                  44880020
448900         VARYING LQW-IDX  FROM 1 BY 1                             44890020
449000         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  44900020
449100                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            44910020
449200                                                                  44920020
449300             IF LQW-SELECT (LQW-IDX)                              44930020
449400                 IF PS-PKITEM-FOUND                               44940020
449500                     SET PS-ERROR                                 44950020
449600                                 TO TRUE                          44960020
449700                 END-IF                                           44970020
449800             END-IF                                               44980020
449900         END-PERFORM                                              44990020
450000     END-IF.                                                      45000020
450100                                                                  45010020
450200                                                                  45020020
450300 6000-REFRESH-PANEL-FROM-TEMP.                                    45030020
450400                                                                  45040020
450500     IF ASC-UPDATE-TSQ                                            45050020
450600         SET ASC-NO-TSQ-UPDATE   TO TRUE                          45060020
450700         MOVE ZERO               TO PV-SAVE-ITEM                  45070020
450800                                    PV-SEL-QUEUE-ITEM             45080020
450900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        45090020
451000                                 TO PV-HOLD-SELECTED-ITEMS        45100020
451100         PERFORM 6100-UPDATE-TSQ                                  45110020
451200           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS45120020
451300                                                                  45130020
451400         PERFORM 6010-DELETE-SEL-QUEUE                            45140020
451500                                                                  45150020
451600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         45160020
451700                    ASC-BLOCK-ENTRIES (2)                         45170020
451800                                                                  45180020
451900         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 45190020
452000                GIVING    PV-BLOCK-NUMBER                         45200020
452100                REMAINDER PV-REMAINDER                            45210020
452200                                                                  45220020
452300         IF PV-REMAINDER > ZERO                                   45230020
452400             ADD +1              TO PV-BLOCK-NUMBER               45240020
452500         END-IF                                                   45250020
452600                                                                  45260020
452700         MOVE +1                 TO ASC-BLK-SUB                   45270020
452800                                                                  45280020
452900         PERFORM 4410-READ-TEMP-STORAGE                           45290020
453000                                                                  45300020
453100         ADD +1                  TO ASC-BLK-SUB                   45310020
453200                            PV-BLOCK-NUMBER                       45320020
453300         PERFORM 4410-READ-TEMP-STORAGE                           45330020
453400                                                                  45340020
453500     END-IF.                                                      45350020
453600                                                                  45360020
453700 6010-DELETE-SEL-QUEUE.                                           45370020
453800                                                                  45380020
453900     EXEC CICS DELETEQ TS                                         45390020
454000               QUEUE (ASC-SEL-QUEUE-NAME)                         45400020
454100               RESP  (PV-CICS-RESP)                               45410020
454200     END-EXEC.                                                    45420020
454300                                                                  45430020
454400     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     45440020
454500         (PV-CICS-RESP = DFHRESP (QIDERR)))                       45450020
454600         CONTINUE                                                 45460020
454700     ELSE                                                         45470020
454800         SET DP013-CICS-ABEND                                     45480020
454900             DP013-ROLLBACK   TO TRUE                             45490020
455000         MOVE '6010-DELETE-SEL-QUEUE'                             45500020
455100                                 TO DP013-PARAGRAPH               45510020
455200         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  45520020
455300                                 TO DP013-MESSAGE-TEXT (1)        45530020
455400         PERFORM DP013-0000-PROCESS-ABEND                         45540020
455500     END-IF.                                                      45550020
455600                                                                  45560020
455700 6100-UPDATE-TSQ.                                                 45570020
455800                                                                  45580020
455900     ADD 1                       TO PV-SEL-QUEUE-ITEM.            45590020
456000                                                                  45600020
456100     PERFORM 6105-READ-SEL-QUEUE.                                 45610020
456200                                                                  45620020
456300     PERFORM                                                      45630020
456400     VARYING PC016-IDX  FROM 1 BY 1                               45640020
456500     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       45650020
456600             PC016-IDX > PC016-MAX-ITEMS                          45660020
456700                                                                  45670020
456800         IF PC016-ACTION-SW (PC016-IDX) > SPACE                   45680020
456900            PERFORM 6110-PROCESS-ITEMS                            45690020
457000         END-IF                                                   45700020
457100                                                                  45710020
457200         ADD +1                  TO PV-ITEMS-PROCESSED            45720020
457300     END-PERFORM.                                                 45730020
457400                                                                  45740020
457500     PERFORM 6111-WRITE-LIST-QUEUE.                               45750020
457600                                                                  45760020
457700                                                                  45770020
457800 6105-READ-SEL-QUEUE.                                             45780020
457900                                                                  45790020
458000     EXEC CICS READQ TS                                           45800020
458100               QUEUE (ASC-SEL-QUEUE-NAME)                         45810020
458200               INTO  (PC016-TS-SEL-REC)                           45820020
458300               ITEM  (PV-SEL-QUEUE-ITEM)                          45830020
458400               RESP  (PV-CICS-RESP)                               45840020
458500     END-EXEC.                                                    45850020
458600                                                                  45860020
458700     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       45870020
458800         SET DP013-CICS-ABEND                                     45880020
458900             DP013-ROLLBACK   TO TRUE                             45890020
459000         MOVE '6105-READ-SEL-QUEUE'                               45900020
459100                                 TO DP013-PARAGRAPH               45910020
459200         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    45920020
459300                                 TO DP013-MESSAGE-TEXT (1)        45930020
459400         PERFORM DP013-0000-PROCESS-ABEND                         45940020
459500     END-IF.                                                      45950020
459600                                                                  45960020
459700 6110-PROCESS-ITEMS.                                              45970020
459800                                                                  45980020
459900     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          45990020
460000                                            / PC-ITEMS-PER-PANEL).46000020
460100                                                                  46010020
460200     IF PV-ITEM NOT = PV-SAVE-ITEM                                46020020
460300        IF PV-SAVE-ITEM NOT = ZERO                                46030020
460400                                                                  46040020
460500            PERFORM 6111-WRITE-LIST-QUEUE                         46050020
460600                                                                  46060020
460700        END-IF                                                    46070020
460800        MOVE PV-ITEM             TO PV-SAVE-ITEM                  46080020
460900                                                                  46090020
461000        PERFORM 6112-READ-LIST-QUEUE                              46100020
461100                                                                  46110020
461200     END-IF.                                                      46120020
461300                                                                  46130020
461400     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX) -                   46140020
461500                                    LQW-LIST-ITEM-NUMBER (1)) + 1.46150020
461600     SET LQW-DESELECT (PV-SUB)   TO TRUE                          46160020
461700     MOVE LQW-SELECTED-SW (PV-SUB)                                46170020
461800                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).46180020
461900                                                                  46190020
462000     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                46200020
462100                                                                  46210020
462200 6111-WRITE-LIST-QUEUE.                                           46220020
462300                                                                  46230020
462400     EXEC CICS WRITEQ TS                                          46240020
462500               QUEUE (ASC-LIST-QUEUE-NAME)                        46250020
462600               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   46260020
462700               ITEM  (PV-SAVE-ITEM)                               46270020
462800               REWRITE                                            46280020
462900               RESP  (PV-CICS-RESP)                               46290020
463000     END-EXEC.                                                    46300020
463100                                                                  46310020
463200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       46320020
463300         SET DP013-CICS-ABEND                                     46330020
463400             DP013-ROLLBACK   TO TRUE                             46340020
463500         MOVE '6111-WRITE-LIST-QUEUE'                             46350020
463600                                 TO DP013-PARAGRAPH               46360020
463700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'46370020
463800                                 TO DP013-MESSAGE-TEXT(1)         46380020
463900         PERFORM DP013-0000-PROCESS-ABEND                         46390020
464000     END-IF.                                                      46400020
464100                                                                  46410020
464200 6112-READ-LIST-QUEUE.                                            46420020
464300                                                                  46430020
464400     EXEC CICS READQ TS                                           46440020
464500               QUEUE (ASC-LIST-QUEUE-NAME)                        46450020
464600               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   46460020
464700               ITEM  (PV-ITEM)                                    46470020
464800               RESP  (PV-CICS-RESP)                               46480020
464900     END-EXEC.                                                    46490020
465000                                                                  46500020
465100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       46510020
465200         SET DP013-CICS-ABEND                                     46520020
465300             DP013-ROLLBACK   TO TRUE                             46530020
465400         MOVE '6112-READ-LIST-QUEUE'                              46540020
465500                                 TO DP013-PARAGRAPH               46550020
465600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   46560020
465700                                 TO DP013-MESSAGE-TEXT(1)         46570020
465800         PERFORM DP013-0000-PROCESS-ABEND                         46580020
465900     END-IF.                                                      46590020
488300                                                                  48830020
488400                                                                  48840020
488500******************************************************************48850020
488600*  UPDATE THE STATUS TO INPROCESS ('I') - ONLY DONE THE FIRST TIME48860020
488700*  A LINE FROM THE REQUEST IS SENT TO THE PRINTER                 48870020
488800******************************************************************48880020
488900 7300-UPDATE-STATUS-CODE.                                         48890020
489000                                                                  48900020
489100     PERFORM                                                      48910020
489200         WITH TEST AFTER                                          48920020
489300         VARYING PV-SELECT-COUNTER                                48930020
489400         FROM 1 BY 1                                              48940020
489500         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              48950020
489600            OR  (SQLCODE = ZERO))                                 48960020
489700                                                                  48970020
489800         EXEC SQL                                                 48980020
489900             UPDATE TPTKREQ                                       48990020
490000             SET    REQ_STAT_CDE = 'I'                            49000020
490100               ,    PRT_RQSTR_ID = :ASC-TKT-OFFICE                49010020
490200               ,    ACTL_PRT_DTE = CURRENT DATE                   49020020
490300             WHERE  PO_REQ_NBR  = :ASC-KEY-PO-REQ-NBR             49030020
490400         END-EXEC                                                 49040020
490500                                                                  49050020
490600         EVALUATE TRUE                                            49060020
490700             WHEN SQLCODE = -904                                  49070020
490800             WHEN SQLCODE = -913                                  49080020
490900             WHEN SQLCODE = +0                                    49090020
491000                 CONTINUE                                         49100020
491100             WHEN SQLWARN0 NOT = SPACES                           49110020
491200             WHEN SQLCODE < ZERO                                  49120020
491300             WHEN SQLCODE > ZERO                                  49130020
491400                  MOVE '7300-UPDATE-STATUS-CODE'                  49140020
491500                                     TO DP013-PARAGRAPH           49150020
491600                  MOVE 'UPDATE REQUEST STAT CODE TO INPROCESS'    49160020
491700                                     TO DP013-MESSAGE-TEXT (1)    49170020
491800                  MOVE ASC-KEY-PO-REQ-NBR                         49180020
491900                                     TO DP013-MESSAGE-TEXT (2)    49190020
492000                  MOVE SQLCA         TO DP013-SQLCA               49200020
492100                  MOVE 'TPTKREQ'     TO DP013-DB2-TABLE-NAME (1)  49210020
492200                  SET DP013-DB2-ABEND                             49220020
492300                                     TO TRUE                      49230020
492400                  SET DP013-ROLLBACK                              49240020
492500                                     TO TRUE                      49250020
492600                  PERFORM 9999-WRITE-CICS-LOG-MSG                 49260020
492700         END-EVALUATE                                             49270020
492800     END-PERFORM.                                                 49280020
492900                                                                  49290020
493000     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       49300020
493100         MOVE '7300-UPDATE-STATUS-CODE'                           49310020
493200                                     TO DP013-PARAGRAPH           49320020
493300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO UPDATE'     49330020
493400                                     TO DP013-MESSAGE-TEXT (1)    49340020
493500         MOVE 'THE STATUS CODE TO IMPROCESS.  KEYS = '            49350020
493600                                     TO DP013-MESSAGE-TEXT (2)    49360020
493700         MOVE ASC-KEY-PO-REQ-NBR     TO DP013-MESSAGE-TEXT (3)    49370020
493800         MOVE SQLCA                  TO DP013-SQLCA               49380020
493900         MOVE 'TPTKREQ'              TO DP013-DB2-TABLE-NAME (1)  49390020
494000         SET DP013-DB2-ABEND         TO TRUE                      49400020
494100         SET DP013-ROLLBACK          TO TRUE                      49410020
494200         PERFORM 9999-WRITE-CICS-LOG-MSG                          49420020
494300     END-IF.                                                      49430020
494400                                                                  49440020
494500                                                                  49450020
494600******************************************************************49460020
494700*  SELECT THE PRINT REQUEST ID TO GET THE TICKET OFFICE.  THIS    49470020
494800*  FIELD IS USED TO KEEP TRACK OF WHICH TICKET OFFICE IS PRINTING 49480020
494900*  WHICH REQUEST.                                                 49490020
495000******************************************************************49500020
495100 7400-GET-TICKET-OFFICE.                                          49510020
495200                                                                  49520020
495300     PERFORM                                                      49530020
495400         WITH TEST AFTER                                          49540020
495500         VARYING PV-SELECT-COUNTER                                49550020
495600         FROM 1 BY 1                                              49560020
495700         UNTIL ((PV-SELECT-COUNTER > PC-MAX-RETRIES)              49570020
495800            OR  (SQLCODE = +100)                                  49580020
495900            OR  (SQLCODE = ZERO))                                 49590020
496000                                                                  49600020
496100         EXEC SQL                                                 49610020
496200             SELECT PRT_RQSTR_ID                                  49620020
496300             INTO  :ASC-PRINT-TKT-OFFICE                          49630020
496400             FROM   TPTKREQ                                       49640020
496500              WHERE  PO_REQ_NBR  = :ASC-KEY-PO-REQ-NBR            49650020
496600         END-EXEC                                                 49660020
496700                                                                  49670020
496800         EVALUATE TRUE                                            49680020
496900             WHEN SQLCODE = -904                                  49690020
497000             WHEN SQLCODE = -913                                  49700020
497100             WHEN SQLCODE = +0                                    49710020
497200                 CONTINUE                                         49720020
497300             WHEN SQLWARN0 NOT = SPACES                           49730020
497400             WHEN SQLCODE < ZERO                                  49740020
497500             WHEN SQLCODE > ZERO                                  49750020
497600                  MOVE '7400-GET-TICKET-OFFICE'                   49760020
497700                                     TO DP013-PARAGRAPH           49770020
497800                  MOVE 'SELECT TICKET OFFICE'                     49780020
497900                                     TO DP013-MESSAGE-TEXT (1)    49790020
498000                  MOVE ASC-KEY-PO-REQ-NBR                         49800020
498100                                     TO DP013-MESSAGE-TEXT (2)    49810020
498200                  MOVE SQLCA         TO DP013-SQLCA               49820020
498300                  MOVE 'TPTKREQ'     TO DP013-DB2-TABLE-NAME (1)  49830020
498400                  SET DP013-DB2-ABEND                             49840020
498500                                     TO TRUE                      49850020
498600                  SET DP013-ROLLBACK                              49860020
498700                                     TO TRUE                      49870020
498800                  PERFORM 9999-WRITE-CICS-LOG-MSG                 49880020
498900         END-EVALUATE                                             49890020
499000     END-PERFORM.                                                 49900020
499100                                                                  49910020
499200     IF  PV-SELECT-COUNTER > PC-MAX-RETRIES                       49920020
499300         MOVE '7400-GET-TICKET-OFFICE'                            49930020
499400                                     TO DP013-PARAGRAPH           49940020
499500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     49950020
499600                                     TO DP013-MESSAGE-TEXT (1)    49960020
499700         MOVE 'THE TICKET OFFICE KEYS = '                         49970020
499800                                     TO DP013-MESSAGE-TEXT (2)    49980020
499900         MOVE ASC-KEY-PO-REQ-NBR     TO DP013-MESSAGE-TEXT (3)    49990020
500000         MOVE SQLCA                  TO DP013-SQLCA               50000020
500100         MOVE 'TPTKREQ'              TO DP013-DB2-TABLE-NAME (1)  50010020
500200         SET DP013-DB2-ABEND         TO TRUE                      50020020
500300         SET DP013-ROLLBACK          TO TRUE                      50030020
500400         PERFORM 9999-WRITE-CICS-LOG-MSG                          50040020
500500     END-IF.                                                      50050020
500600                                                                  50060020
500700***************************************************************** 50070020
500800** THIS PARAGRAPH FORMATS A PO COPIES REPORT JOB               ** 50080020
500900** AND WRITES IT TO THE INTERNAL READER.                       ** 50090020
501000***************************************************************** 50100020
501100 8000-START-PO-PRINT-PGM.                                         50110020
501200                                                                  50120020
501300     MOVE ASC-KEY-PO-REQ-NBR     TO VL010-PO-REQ-NBR.             50130020
501400                                                                  50140020
501500     MOVE ASC-KEY-PO-NBR-N       TO VL010-PO-NBR.                 50150020
501600     MOVE DP020-SRC-TASK-NUMBER  TO VL010-TASK-ID.                50160020
501700                                                                  50170020
501800     IF ASC-LOCATION = 'TEST'                                     50180020
501900         MOVE PC-TEST-PRINTER        TO VL010-DEST                50190020
502000     ELSE                                                         50200020
502100         MOVE PC-TKT-PRINTER         TO VL010-DEST                50210070
502200     END-IF.                                                      50220020
502300                                                                  50230020
502400     MOVE LENGTH OF VL010-PO-PRINT-COMMAREA                       50240020
502500                                 TO PV-COMMAREA-LENGTH.           50250020
502600     EXEC CICS                                                    50260020
502700         START                                                    50270020
502800             TRANSID (PC-PO-PRINT-TRANID)                         50280020
502900             FROM    (VL010-PO-PRINT-COMMAREA)                    50290020
503000             LENGTH  (PV-COMMAREA-LENGTH)                         50300020
503100             RESP    (PV-CICS-RESP)                               50310020
503200     END-EXEC.                                                    50320020
503300                                                                  50330020
503400     EVALUATE TRUE                                                50340020
503500         WHEN PV-CICS-RESP = DFHRESP (NORMAL)                     50350020
503600             CONTINUE                                             50360020
503700         WHEN OTHER                                               50370020
503800             SET DP013-LOGIC-ABEND                                50380020
503900                 DP013-ROLLBACK        TO TRUE                    50390020
504000             MOVE '8000-START-PO-PRINT-PGM'                       50400020
504100                                       TO DP013-PARAGRAPH         50410020
504200             MOVE 'ATTEMPTING TO START PO-PRINT PROGRAM'          50420020
504300                                       TO DP013-MESSAGE-TEXT (1)  50430020
504400             PERFORM DP013-0000-PROCESS-ABEND                     50440020
504500     END-EVALUATE.                                                50450020
504600                                                                  50460020
504700/                                                                 50470020
504800******************************************************************50480020
504900* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *50490020
505000******************************************************************50500020
505100 9100-READ-SEL-QUEUE.                                             50510020
505200     EXEC CICS                                                    50520020
505300         READQ TS                                                 50530020
505400             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        50540020
505500             INTO  (PC016-TS-SEL-REC)                             50550020
505600             ITEM  (ASC-SEL-ITEM)                                 50560020
505700             RESP  (PV-CICS-RESP)                                 50570020
505800     END-EXEC.                                                    50580020
505900                                                                  50590020
506000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        50600020
506100         CONTINUE                                                 50610020
506200     ELSE                                                         50620020
506300         SET DP013-LOGIC-ABEND                                    50630020
506400             DP013-ROLLBACK        TO TRUE                        50640020
506500         MOVE '9100-READ-SEL-QUEUE'                               50650020
506600                                   TO DP013-PARAGRAPH             50660020
506700         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    50670020
506800                                   TO DP013-MESSAGE-TEXT (1)      50680020
506900         PERFORM DP013-0000-PROCESS-ABEND                         50690020
507000     END-IF.                                                      50700020
507100                                                                  50710020
507200/                                                                 50720020
507300******************************************************************50730020
507400* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *50740020
507500******************************************************************50750020
507600 9200-REWRITE-LIST-QUEUE.                                         50760020
507700     EXEC CICS                                                    50770020
507800          WRITEQ TS                                               50780020
507900              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     50790020
508000              FROM    (PC016-TS-SEL-REC)                          50800020
508100              ITEM    (ASC-SEL-ITEM)                              50810020
508200              RESP    (PV-CICS-RESP)                              50820020
508300              REWRITE                                             50830020
508400     END-EXEC.                                                    50840020
508500                                                                  50850020
508600     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    50860020
508700         SET DP013-CICS-ABEND                                     50870020
508800             DP013-ROLLBACK        TO TRUE                        50880020
508900         MOVE '9200-REWRITE-LIST-QUEUE'                           50890020
509000                                   TO DP013-PARAGRAPH             50900020
509100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   50910020
509200                                   TO DP013-MESSAGE-TEXT (1)      50920020
509300         PERFORM DP013-0000-PROCESS-ABEND                         50930020
509400     END-IF.                                                      50940020
509500                                                                  50950020
509600/                                                                 50960020
509700******************************************************************50970020
509800*    ABEND PROCESSING                                             50980020
509900******************************************************************50990020
510000     COPY DPPD013.                                                51000064
510100                                                                  51010020
510200 9999-WRITE-CICS-LOG-MSG.                                         51020020
510300     MOVE PC-CURRENT-PROGRAM-NAME  TO DP013-PROGRAM.              51030020
510400     MOVE DFHEIBLK                 TO DP013-DFHEIBLK.             51040020
510500     INITIALIZE DP013-SRC-TASK-NUMBER                             51050020
510600                DP013-STACK.                                      51060020
510700     SET DP013-LINK-RETURN         TO TRUE.                       51070020
510800                                                                  51080020
510900     EXEC CICS                                                    51090020
511000         XCTL                                                     51100020
511100             PROGRAM   (DP013-NAME)                               51110020
511200             COMMAREA  (DP013-PARAMETERS)                         51120020
511300             LENGTH    (DP013-LENGTH)                             51130020
511400     END-EXEC.                                                    51140020
511500                                                                  51150020
