000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    IQKCS414.                                         00040099
000500 AUTHOR.        PAUL OMAN.                                        00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  07-23-04.                                         00070099
000800 DATE-COMPILED.                                                   00080099
000900*--------------------------------------------------------------*  00090099
001000*    I414 - IQ - SKU / STORE INQUIRY                           *  00100099
001100*                                                              *  00110099
001200*    CURRENTLY THE SCREEN CAN BE GOTTEN TO AS FOLLOWS:         *  00120099
001300*                                                              *  00130099
001400*        F17 FROM IQLSKU   - IQKCS408                          *  00140099
001500*            FORMAT INDICATOR IS SPACE                         *  00150099
001600*                                                              *  00160099
001700*        F23 FROM IQSVEND  - IQKCS401                          *  00170099
001800*            FORMAT INDICATOR IS SPACE                         *  00180099
001900*                                                              *  00190099
002000*  FUNCTION OF THE KEYS IS AS FOLLOWS:                         *  00200099
002100*      F14 - RETRIEVE ONHAND INFORMATION                       *  00210099
002200*      F18 - PRINT MONARCH LABEL FOR UPC                       *  00220099
002300*      F19 - SHOW PREVIOUS DETAIL RECORD                       *  00230099
002400*      F20 - SHOW NEXT DETAIL RECORD                           *  00240099
002500*                                                              *  00250099
002600*--------------------------------------------------------------*  00260099
002700* DATE:        11/01/2012                                         00270099
002800* WR/IR#:      CRQ000000034042                                    00280099
002900* PROGRAMMER:  COGNIZANT                                          00290099
003000* DESCRIPTION: INTRODUCED STORE NUMBER VALIDATION LOGIC AND       00300099
003100* CORRECT UPC & SKU MSG LOGIC.                                    00310099
003200******************************************************************00320099
003300* DATE:        01/24/2013                                         00330099
003400* WR/IR#:      CRQ000000039574                                    00340099
003500* PROGRAMMER:  COGNIZANT                                          00350099
003600* DESCRIPTION: ADDED STORE,UPC AND SKU NUMBER VALIDATION LOGIC.   00360099
003700******************************************************************00370099
003800* DATE:        03/19/2013                                         00380099
003900* WR/IR#:      CHG0053622                                         00390099
004000* PROGRAMMER:  JIM ARENDT                                         00400099
004100* DESCRIPTION: ADDED CODE TO CHECK IF THE STORE, DEPARTMENT AND   00410099
004200*              STYLE ARE RFID ELIGIBLE.  IF THEY ARE, THE VALUE   00420099
004300*              '*RFID*' WILL BE DISPLAYED.                        00430099
004400*              CHANGES DENOTED BY 0313 PREFIX.                    00440099
004500******************************************************************00450099
004600* DATE:        06/22/2013                                         00460099
004700* WR/IR#:      CHG0056705                                         00470099
004800* PROGRAMMER:  JIM ARENDT                                         00480099
004900* DESCRIPTION: CHANGED PROGRAM TO DO RFID CHECK BY CALLING SUB-   00490099
005000*              ROUTINE RIKUT016 INSTEAD OF READING DB2 TABLE      00500099
005100*              WST_ATTR_ELEM.                                     00510099
005200*              CHANGES DENOTED BY 0530 PREFIX.                    00520099
005300******************************************************************00530099
005400* DATE:        05/29/2014                                         00540099
005500* WR/IR#:      CHG0083644                                         00550099
005600* PROGRAMMER:  JIM ARENDT                                         00560099
005700* DESCRIPTION: WHEN CALLING SUB-ROUTINE RIKUT016, REMOVED THE     00570099
005800*              PASSING OF DC-NUMBER.                              00580099
005900******************************************************************00590099
006000* DATE:        06/27/2014                                         00600099
006100* WR/IR#:      CHG0085464                                         00610099
006200* PROGRAMMER:  JIM ARENDT                                         00620099
006300* DESCRIPTION: ABOVE CHANGES MOVED WITH NEW CHANGE REQUEST NBR.   00630099
006400******************************************************************00640099
006500* DATE:        06/05/2015                                         00650099
006600* WR/IR#:      CHG0115091                                         00660099
006700* PROGRAMMER:  JIM HUNTER                                         00670099
006800* DESCRIPTION: CALL THE RIT_RFID_STR_VRFN TABLE INSTEAD OF THE    00680099
006900*              RIT_STR_DEPT_VND TABLE WHEN DETERMINING IF A       00690099
007000*              SKU IS AN RFID SKU.                                00700099
007100******************************************************************00710099
007200* DATE:        09/03/2015                                         00720099
007300* WR/IR#:      CHG0120561                                         00730099
007400* PROGRAMMER:  COGNIZANT                                          00740099
007500* DESCRIPTION: INTRODUCED STORE NUMBER VALIDATION - TO DISPLAY    00750099
007600*              AN ERROR MESSAGE WHEN INVALID STORE NUMBER         00760099
007700*              ENTERED IN STORE NUMBER FIELD                      00770099
007702******************************************************************00770299
007703* DATE:        08/29/2021                                         00770399
007704* WR/IR#:      CHG0260504                                         00770499
007705* PROGRAMMER:  GERMAN BANDA                                       00770599
007706* DESCRIPTION: ADDED NEW FIELDS THAT DISPLAY WHEN F14=OH QTY      00770699
007707*              LAST UNLD QTY: SKU QUANTITY FROM LAST TRAILER      00770799
007708*              UNLOAD                                             00770899
007709*              LAST UNLD SCANNED -DISPLAYS WHEN THE LAST UNLD QTY 00770999
007710*               WAS A SCAN FROM A TRAILER OR A TRAILER MISLOAD    00771099
007711*               THAT WAS SCANNED TRN_TYP_CDE 'UN' OR 'MM'         00771199
007712*               FOLLOWED BY THE DATE                              00771299
007713*              LAST UNLD ASSUMPT -DISPLAYS WHEN THE LAST UNLD QTY 00771399
007714*               WAS AN ASSUMPITVE RECEIPT TRN_TYP_CDE = 'AU'      00771499
007715*               FOLLOWED BY THE DATE                              00771599
007716******************************************************************00771699
007717*---------------------------------------------------------------* 00771799
007718* DATE:        09/14/2021                                         00771899
007719* WR/IR#:      CHG0261678                                         00771999
007720* PROGRAMMER:  GERMAN BANDA                                       00772099
007721* DESCRIPTION: CHANGE CALL OF DPKUT100 TO                         00772199
007722*              CALL DP010I-NUMERIC-EDIT-ROUTINE                   00772299
007723*              MAKING THE CALL DYNAMIC VS STATIC                  00772399
007724*---------------------------------------------------------------* 00772499
007702******************************************************************00772599
007703* DATE:        08/29/2022                                         00772699
007704* WR/IR#:      CHG0274371                                         00772799
007705* PROGRAMMER:  JIM HUNTER                                         00772899
007706* DESCRIPTION: REMOVING ALL REFERENCES TO RFID, WHICH HAS BEEN    00772999
007707*              OBSOLETE FOR YEARS - TABLE, COPYBOOK AND LOGIC.    00773099
007716******************************************************************00773999
CICS  * CHANGED 11/01/2022    BY JIM HUNTER      WR: CHG0277565         00774099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00774199
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00774299
CICS  ******************************************************************00774399
007725                                                                  00774499
007726 ENVIRONMENT DIVISION.                                            00774599
007727                                                                  00774699
007728 DATA DIVISION.                                                   00774799
007729                                                                  00774899
007730 WORKING-STORAGE SECTION.                                         00774999
007731                                                                  00775099
007732 01  PC-PROGRAM-CONSTANTS.                                        00775199
007733     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'IQ414A  '.  00775299
007734     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'IQKM414 '.  00775399
007735     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'IQKCS414'.  00775499
007736     05  PC-TSYMSG-NUMBERS.                                       00775599
007737         10  PC-TSYMSG-00008       PIC  9(05)  VALUE  00008.      00775699
007738         10  PC-TSYMSG-00017       PIC  9(05)  VALUE  00017.      00775799
007739         10  PC-TSYMSG-00036       PIC  9(05)  VALUE  00036.      00775899
007740         10  PC-TSYMSG-00050       PIC  9(05)  VALUE  00050.      00775999
007741         10  PC-TSYMSG-00069       PIC  9(05)  VALUE  00069.      00776099
007742         10  PC-TSYMSG-00070       PIC  9(05)  VALUE  00070.      00776199
007743         10  PC-TSYMSG-00073       PIC  9(05)  VALUE  00073.      00776299
007745         10  PC-TSYMSG-00100       PIC  9(05)  VALUE  00100.      00776399
007746         10  PC-TSYMSG-00695       PIC  9(05)  VALUE  00695.      00776499
007747         10  PC-TSYMSG-01063       PIC  9(05)  VALUE  01063.      00776599
007750         10  PC-TSYMSG-03388       PIC  9(05)  VALUE  03388.      00776699
007753         10  PC-TSYMSG-99901       PIC  9(05)  VALUE  99901.      00776799
007754         10  PC-TSYMSG-00334       PIC  9(05)  VALUE  00334.      00776899
007755         10  PC-TSYMSG-03734       PIC  9(05)  VALUE  03734.      00776999
007756     05  PC-CORPORATE-LOCATION     PIC  9(04)  VALUE 90.          00777099
007757     05  PC-IQKCS401-FORMAT-IND    PIC  X(01)  VALUE ' '.         00777199
007758     05  PC-IQKCS408-FORMAT-IND    PIC  X(01)  VALUE '2'.         00777299
007759     05  PC-RED                    PIC  X(10)  VALUE 'RED'.       00777399
007760     05  PC-YELLOW                 PIC  X(10)  VALUE 'YELLOW'.    00777499
007761     05  PC-WHITE                  PIC  X(10)  VALUE 'WHITE'.     00777599
007762     05  PC-XMKCS001               PIC  X(08)  VALUE 'XMKCS001'.  00777699
007763     05  PC-XMKCS004               PIC  X(08)  VALUE 'XMKCS004'.  00777799
007764     05  PC-DEFAULT-DATE-0         PIC  X(10)  VALUE '0000-00-00'.00777899
007765     05  PC-STATUS-25              PIC  X(02)  VALUE  '25'.       00777999
007766     05  PC-AU                     PIC  X(02)  VALUE  'AU'.       00778099
007767     05  PC-MM                     PIC  X(02)  VALUE  'MM'.       00778199
007768     05  PC-UN                     PIC  X(02)  VALUE  'UN'.       00778299
007769                                                                  00778399
007770 01  DK-VARIABLES.                                                00778499
007771     05  DK-LOCATION-NBR           PIC S9(04)  VALUE  0 COMP.     00778599
007772     05  DK-LOC-NBR-PIC9           PIC  9(04)  VALUE  0.          00778699
007773     05  DK-STORE-NBR-PIC9         PIC  9(04)  VALUE  0.          00778799
007774     05  DK-ENT-ID-PIC9            PIC  9(10)  VALUE  0.          00778899
007775     05  DK-UPC-NBR-PIC9           PIC  9(15)  VALUE  0.          00778999
007776     05  DK-INTR-UPC-ID-PIC9       PIC  9(10)  VALUE  0.          00779099
007777     05  DK-UPC-NBR                PIC S9(15)  VALUE  0 COMP-3.   00779199
007778     05  DK-SKU-NBR                PIC S9(09)  VALUE  0.          00779299
007783                                                                  00779399
007784 01  PV-VARIABLES.                                                00779499
007785     05  PV-CICS-RESP              PIC S9(04)  VALUE  0 COMP.     00779599
007786     05  PV-WORK-DATE              PIC  X(10)  VALUE  SPACES.     00779699
007787     05  PV-STAT-CHNGD-DATE        PIC  X(10)  VALUE  SPACES.     00779799
007788     05  PV-VENDOR-NAME            PIC  X(20)  VALUE  SPACES.     00779899
007789     05  PV-STATUS-CODE            PIC  X(02)  VALUE  SPACES.     00779999
007790     05  PV-PRICE-CHG-DATE         PIC  X(10)  VALUE  SPACES.     00780099
007791     05  PV-GP-RTL-AMT-NULL        PIC S9(04)  VALUE  0 COMP.     00780199
007793     05  PV-INTRNST-TMST-NULL      PIC S9(04)  VALUE  0 COMP.     00780299
007800     05  PV-STORE-NUMBER           PIC S9(04)  VALUE  0 COMP.     00781099
007900     05  PV-INTR-UPC-ID            PIC S9(09)  VALUE  0 COMP.     00790099
008000     05  PV-CICS-RESPONSE          PIC S9(09)  VALUE  0 COMP.     00800099
008100     05  PV-CICS-RESPONSE-9        PIC S9(09)  VALUE  0.          00810099
008200     05  PV-COMMAREA-LENGTH        PIC S9(04)  VALUE  0 COMP.     00820099
008300     05  PV-UNT-RTL-AMT            PIC S9(07)V99 VALUE 0 COMP-3.  00830099
008400     05  PV-GP-RTL-AMT             PIC S9(07)V99 VALUE 0 COMP-3.  00840099
008500     05  PV-ORIG-RTL-AMT           PIC S9(07)V99 VALUE 0 COMP-3.  00850099
008600     05  PV-LOW-RTL-AMT            PIC S9(07)V99 VALUE 0 COMP-3.  00860099
008700     05  PV-SETUP-DATE             PIC  X(10)    VALUE SPACES.    00870099
008800     05  PV-ONHAND-QTY             PIC S9(09)    VALUE 0 COMP-3.  00880099
008900     05  PV-STORE-EXPECTED-QTY     PIC S9(09)    VALUE 0 COMP-3.  00890099
009000     05  PV-INTRANSIT-QTY          PIC S9(09)    VALUE 0 COMP-3.  00900099
009100     05  PV-WORK-QTY-X             PIC  X(07)    VALUE SPACES.    00910099
009200     05  PV-WORK-QTY-Z REDEFINES PV-WORK-QTY-X  PIC -(7).         00920099
009300     05  PV-WORK-QTY-9 REDEFINES PV-WORK-QTY-X  PIC ------9.      00930099
009400                                                                  00940099
009410     05  PV-UNLOAD-QTY             PIC  9(09)  VALUE 0.           00941099
009620     05  PV-ITRNST-DATE            PIC  X(10)  VALUE SPACES.      00962099
009630     05  PV-PROCESS-DATE           PIC  X(10)  VALUE SPACES.      00963099
009700                                                                  00970099
009800     05  PV-SYSTEM-ID.                                            00980099
009900         10  FILLER                     PIC X(04) VALUE SPACES.   00990099
010000         10  PV-REGION-IND              PIC X(01).                01000099
010100             88  PV-TEST-CICS                VALUE 'T'.           01010099
010200             88  PV-QA-CICS                  VALUE 'Q'.           01020099
010300             88  PV-PROD-CICS                VALUE 'P'.           01030099
010400             88  PV-LEARN-CICS               VALUE 'L'.           01040099
010500         10  FILLER                     PIC X(01)  VALUE SPACES.  01050099
010510     05  PV-STKR-ID-9          PIC S9(09) COMP-3 VALUE 0.         01051099
010520     05  PV-STKR-ID            PIC  9(04)        VALUE 0.         01052099
010540     05  PV-DUMMY-NBR          PIC S9(04) COMP SYNC VALUE +0.     01054099
010550     05  PV-SQLCODE            PIC +9(09) VALUE ZERO.             01055099
010560     05  PV-ERROR-TEXT         PIC  X(100) VALUE SPACE.           01056099
134900     05  PV-DISPLAY-ENT        PIC  9(09)  VALUE ZERO.            13490099
134901                                                                  13490199
134902 01  PS-PROGRAM-SWITCHES.                                         13490299
134903     05  PS-ERROR-SW               PIC  X(01)  VALUE  'N'.        13490399
134904         88  PS-ERROR                          VALUE  'Y'.        13490499
134905         88  PS-NO-ERROR                       VALUE  'N'.        13490599
134906     05  PS-COMMAREA-SW            PIC  X(01)  VALUE  'N'.        13490699
134907         88  PS-COMMAREA-VALID                 VALUE  'Y'.        13490799
134908         88  PS-COMMAREA-NOT-VALID             VALUE  'N'.        13490899
134909     05  PS-UPC-FOUND-SW           PIC  X(01)  VALUE  'N'.        13490999
134910         88  PS-UPC-FOUND                      VALUE  'Y'.        13491099
134911         88  PS-UPC-NOT-FOUND                  VALUE  'N'.        13491199
134912     05  PS-SKU-FOUND-SW           PIC  X(01)  VALUE  'N'.        13491299
134913         88  PS-SKU-FOUND                      VALUE  'Y'.        13491399
134914         88  PS-SKU-NOT-FOUND                  VALUE  'N'.        13491499
134915     05  PS-CURRENT-RETAIL-SW      PIC  X(01)  VALUE  'N'.        13491599
134916         88  PS-CURRENT-RETAIL-FOUND           VALUE  'Y'.        13491699
134917         88  PS-CURRENT-RETAIL-NOT-FOUND       VALUE  'N'.        13491799
134918     05  PS-LIST-END-SW            PIC  X(01)  VALUE  'N'.        13491899
134919         88  PS-LIST-END                       VALUE  'Y'.        13491999
134920         88  PS-NO-LIST-END                    VALUE  'N'.        13492099
134921     05  PS-LOCATION-SW            PIC  X(01)  VALUE  'N'.        13492199
134922         88  PS-LOCATION-FOUND                 VALUE  'Y'.        13492299
134923         88  PS-LOCATION-NOT-FOUND             VALUE  'N'.        13492399
134924     05  PS-NEW-SKU-FOUND-SW       PIC  X(01)  VALUE  'N'.        13492499
134925         88  PS-NEW-SKU-FOUND                  VALUE  'Y'.        13492599
134926     05  PS-NEW-UPC-FOUND-SW       PIC  X(01)  VALUE  'N'.        13492699
134927         88  PS-NEW-UPC-FOUND                  VALUE  'Y'.        13492799
134928     05  PS-FIRST-TIME-SW          PIC  X(01)  VALUE  'N'.        13492899
134929         88  PS-FIRST-TIME                     VALUE  'Y'.        13492999
134933     05  PS-VENDOR-FOUND-SW        PIC  X(01)  VALUE  'N'.        13493399
134934         88  PS-VENDOR-FOUND                   VALUE  'Y'.        13493499
134935         88  PS-VENDOR-NOT-FOUND               VALUE  'N'.        13493599
134936     05  PS-STREXP-END-SW          PIC  X(01)  VALUE  'N'.        13493699
134937         88  PS-STREXP-END-YES                 VALUE  'Y'.        13493799
134938         88  PS-STREXP-END-NO                  VALUE  'N'.        13493899
134939     05  PS-FIRST-FETCH-SW         PIC  X(01)  VALUE  'N'.        13493999
134940         88  PS-FIRST-FETCH-YES                VALUE  'Y'.        13494099
134941         88  PS-FIRST-FETCH-NO                 VALUE  'N'.        13494199
134942                                                                  13494299
134943 01  PM-PROGRAM-MESSAGES.                                         13494399
134944     05  PM-ABEND-INFO-A.                                         13494499
134945         10  FILLER                PIC X(15)   VALUE              13494599
134946                                   'DP020-SRC-AID: '.             13494699
134947         10  PM-A-SRC-AID          PIC X(02)   VALUE  SPACE.      13494799
134948         10  FILLER                PIC X(19)   VALUE              13494899
134949                                   '. DP020-FK-ACTION: '.         13494999
134950         10  PM-A-FK-ACTION        PIC X(01)   VALUE  SPACE.      13495099
134951         10  FILLER                PIC X(22)   VALUE              13495199
134952                                   '. DP020-FK-DISPN-IND: '.      13495299
134953         10  PM-A-FK-DISPN         PIC X(01)   VALUE  SPACE.      13495399
134954         10  FILLER                PIC X(01)   VALUE '.'.         13495499
134955         10  FILLER                PIC X(19)   VALUE SPACE.       13495599
134956                                                                  13495699
134957                                                                  13495799
134958*--------------------------------------------------------------*  13495899
134959*    MAP LAYOUT                                                *  13495999
134960*--------------------------------------------------------------*  13496099
134961                                                                  13496199
134962     COPY IQKM414.                                                13496299
134963                                                                  13496399
134964**   LAYOUT FOR TEMPORARY STORAGE SELECT QUEUE.                   13496499
134965     COPY IQWS014.                                                13496599
134966                                                                  13496699
134970**   COMMAREA USED TO CALL XMKCS001.                              13497099
134971     COPY XMWS003.                                                13497199
134972                                                                  13497299
134973**   COMMAREA USED TO CALL XMKCS004.                              13497399
134974     COPY XMWS002.                                                13497499
134975                                                                  13497599
134976**   COMMAREA USED TO CALL XLKCS074.                              13497699
134977     COPY XLWS074.                                                13497799
134978                                                                  13497899
134979*--------------------------------------------------------------*  13497999
134980*    ATTRIBUTE SETTINGS COPYBOOK.                              *  13498099
134981*--------------------------------------------------------------*  13498199
134982                                                                  13498299
134985     COPY DPWS015.                                                13498599
134986                                                                  13498699
134995*--------------------------------------------------------------*  13499599
134996*    FUNCTION KEYS COPYBOOK                                    *  13499699
134997*--------------------------------------------------------------*  13499799
134998                                                                  13499899
134999     COPY DPWS016.                                                13499999
135000                                                                  13500099
135001****************************************************************  13500199
135002*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC      *  13500299
135003*    EDIT SUB-ROUTINE (DPKUT100).                              *  13500399
135004****************************************************************  13500499
135005     COPY DPWS010I.                                               13500599
135006                                                                  13500699
135007****************************************************************  13500799
135008*    THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS         *  13500899
135009*    ARCHITECTURE API (BLACK BOX) SUB-ROUTINE.                 *  13500999
135010****************************************************************  13501099
135011     COPY DPWS030.                                                13501199
CICS       COPY DPWS930.                                                13501299
135012                                                                  13501399
135013****************************************************************  13501499
135014*    STANDARD COMMAREA.                                           13501599
135015****************************************************************  13501699
135016                                                                  13501799
135017     COPY DPWS020.                                                13501899
135018     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                13501999
135019                                                                  13502099
135020****************************************************************  13502199
135021*    INTER-APPLICATION COMMAREA.                                  13502299
135022****************************************************************  13502399
135023                                                                  13502499
135024         10  INTER-APPL-COMM-AREA PIC X(200).                     13502599
135025     COPY IQWS016.                                                13502699
135026****************************************************************  13502799
135027*    SPECIFIC COMMMAREA FOR IQKCS414. CAN BE UP TO 2866.          13502899
135028*    CURRENTLY IT IS 310 BYTES.                                   13502999
135029****************************************************************  13503099
135030         10  ASC-SPECIFIC-COMMAREA.                               13503199
135031             15  ASC-REQ-TM                PIC  X(08).            13503299
135032             15  ASC-STR-COUNT             PIC S9(07) COMP-3.     13503399
135033             15  ASC-COMPANY-IND           PIC  X(03).            13503499
135034             15  ASC-STATUS                PIC  X(02).            13503599
135035             15  ASC-CLEARANCE-SW          PIC  X(01).            13503699
135036                 88  ASC-CLEARANCE                    VALUE 'Y'.  13503799
135037                 88  ASC-NON-CLEARANCE                VALUE 'N'.  13503899
135038             15  ASC-LOCATION-NBR-X.                              13503999
135039                 20  ASC-LOCATION-NBR      PIC  9(04).            13504099
135040             15  ASC-UPC-NBR                 PIC  9(15).          13504199
135041             15  ASC-UPC-NBR-DEF REDEFINES                        13504299
135042                            ASC-UPC-NBR.                          13504399
135043                 20  ASC-UPC-FILLER          PIC  9(02).          13504499
135044                 20  ASC-UPC-NBR-01-X.                            13504599
135045                     25  ASC-UPC-NBR-01      PIC  9(02).          13504699
135046                 20  ASC-UPC-NBR-02-X.                            13504799
135047                     25  ASC-UPC-NBR-02  PIC  9(05).              13504899
135048                 20  ASC-UPC-NBR-03-X.                            13504999
135049                     25  ASC-UPC-NBR-03  PIC  9(05).              13505099
135050                 20  ASC-UPC-NBR-04-X.                            13505199
135051                     25  ASC-UPC-NBR-04  PIC  9(01).              13505299
135052             15  ASC-SKU-NBR             PIC  9(09).              13505399
135053             15  ASC-SKU-NBR-DEF REDEFINES                        13505499
135054                            ASC-SKU-NBR.                          13505599
135055                 20  ASC-SKU-FILLER      PIC  9(01).              13505699
135056                 20  ASC-SKU-NBR-X.                               13505799
135057                     25  ASC-SKU-NBR-8   PIC  9(08).              13505899
135058             15  ASC-DEPT-NBR            PIC  9(04).              13505999
135059             15  ASC-MAJ-CL-NBR          PIC  9(04).              13506099
135060             15  ASC-SUB-CL-NBR          PIC  9(04).              13506199
135061             15  ASC-RETAIL-PRICE        PIC S9(07)V99 COMP-3.    13506299
135062             15  ASC-COLOR-DESC          PIC  X(10).              13506399
135063             15  ASC-SIZE-DESC           PIC  X(10).              13506499
135064             15  ASC-INTR-UPC-ID         PIC S9(09) COMP.         13506599
135065             15  ASC-LIST-QUEUE-NAME.                             13506699
135066                 20  ASC-LIST-TERM-ID       PIC  X(04).           13506799
135067                 20  ASC-LIST-TASK-NUMBER   PIC S9(05)            13506899
135068                                                         COMP-3.  13506999
135069                 20  ASC-LIST-SEQ           PIC  9(01).           13507099
135070             15  ASC-SEL-QUEUE-NAME.                              13507199
135071                 20  ASC-SEL-TERM-ID        PIC  X(04).           13507299
135072                 20  ASC-SEL-TASK-NUMBER    PIC S9(05)            13507399
135073                                                         COMP-3.  13507499
135074                 20  ASC-SEL-SEQ            PIC  9(01).           13507599
135075                                                                  13507699
135076             15  ASC-SEL-QUEUE-NAME-IN.                           13507799
135077                 20  ASC-SEL-TERM-ID-IN  PIC X(04).               13507899
135078                 20  ASC-SEL-TASK-NUMBER-IN                       13507999
135079                                      PIC S9(05) COMP-3.          13508099
135080                 20  ASC-SEL-SEQ-IN      PIC 9(01).               13508199
135081             15  ASC-USE-SELECTION-QUEUE-IND                      13508299
135082                                           PIC  X(01).            13508399
135083                 88  ASC-USE-SELECTION-QUEUE          VALUE 'Y'.  13508499
135084             15  ASC-START-ITEM-REQUEST.                          13508599
135085                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  13508699
135086             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    13508799
135087             15  ASC-HIGHEST-BLOCK-WRITTEN PIC S9(04)  COMP.      13508899
135088             15  ASC-SEL-SUB               PIC S9(04)  COMP.      13508999
135089             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      13509099
135090             15  ASC-STR-NBR               PIC S9(04)  COMP.      13509199
135091             15  ASC-SKU-DESC              PIC  X(30).            13509299
135092             15  ASC-VS-NBR                PIC  X(20).            13509399
135093             15  ASC-STKR-NBR              PIC S9(09)    COMP.    13509499
135094             15  ASC-GP-RTL-AMT            PIC S9(07)V99 COMP-3.  13509599
135095             15  ASC-ORIG-RTL-AMT          PIC S9(07)V99 COMP-3.  13509699
135096             15  ASC-LOW-RTL-AMT           PIC S9(07)V99 COMP-3.  13509799
135097             15  ASC-UNT-RTL-CHG-DTE       PIC  X(10).            13509899
135098             15  ASC-UPC-STAT-CHG-DTE      PIC  X(10).            13509999
135099             15  ASC-LOC-NM                PIC  X(20).            13510099
135100             15  ASC-VENDOR-NAME           PIC  X(20).            13510199
135101             15  ASC-DATA-MOVED-SW         PIC  X(01).            13510299
135102                 88  ASC-DATA-MOVED                   VALUE 'Y'.  13510399
135103                 88  ASC-NO-DATA-MOVED                VALUE 'N'.  13510499
135104             15  ASC-ON-HAND               PIC  X(07).            13510599
135105             15  ASC-ON-ORDER              PIC  X(07).            13510699
135106             15  ASC-LAST-RCVD-DATE        PIC  X(10).            13510799
135107             15  ASC-LAST-SALE-DATE        PIC  X(10).            13510899
135108             15  ASC-LAST-UNLD-DATE        PIC  X(10).            13510999
135109             15  ASC-STORE-ON-HAND         PIC  X(07).            13511099
135110             15  ASC-IN-TRANSIT-QTY        PIC  X(07).            13511199
135111             15  ASC-LAST-UNLD-QTY         PIC  X(07).            13511299
135112             15  ASC-DC-NBR                PIC  9(04).            13511399
135113             15  ASC-STR-UNLOAD-SW         PIC  X(02).            13511499
135114                 88  ASC-STR-UNLOAD-NO                VALUE 'NO'. 13511599
135115                 88  ASC-STR-UNLOAD-SCAN              VALUE 'UN'. 13511699
135116                 88  ASC-STR-UNLOAD-ASSM              VALUE 'AU'. 13511799
135117         10  FILLER                        PIC  X(2537).          13511899
135118                                                                  13511999
135119*--------------------------------------------------------------*  13512099
135120*    ABEND PROCESSING COPYBOOK.                                *  13512199
135121*--------------------------------------------------------------*  13512299
135122                                                                  13512399
135123     COPY DPWS013.                                                13512499
135124                                                                  13512599
135125                                                                  13512699
135126*--------------------------------------------------------------*  13512799
135127*    DOMAIN DB2 TABLES                                         *  13512899
135128*    XST00001 - XST_LOC  - LOCATION TABLE                      *  13512999
135129*    XST00003 - XST_DIST - DISTRICT TABLE                      *  13513099
135130*    XST00004 - XST_DIST_REGN - DISTRICT REGION TABLE          *  13513199
135131*    XST00005 - XST_REGN      - REGION TABLE                   *  13513299
135132*    XST00008 - XST_SKU_LOC   - SKU LOCATION TABLE             *  13513399
135133*    XST00010 - XST_SKU       - SKU TABLE                      *  13513499
135135*    XST00012 - XST_UPC       - UPC TABLE                      *  13513599
135136*    XST00013 - XST_VND_STYL  - VENDOR STYLE                   *  13513699
135137*    XST00018 - XST_VND       - VENDOR                         *  13513799
135138*    XST00020 - XST_DC_LOC_ASGMT - DC LOCATION ASSIGNMENT      *  13513899
135139*                                                              *  13513999
135140*    TSK      - FASHION SKU                                    *  13514099
135141*    TUPCPLS  - PHYSICAL LOCATION STATUS                       *  13514199
135142*    TUPCSKU  - UPC - SKU XREF                                 *  13514299
135144*                                                              *  13514499
135145*--------------------------------------------------------------*  13514599
135146                                                                  13514699
135147     EXEC SQL                                                     13514799
135148          INCLUDE XST00001                                        13514899
135149     END-EXEC.                                                    13514999
135150                                                                  13515099
135151     EXEC SQL                                                     13515199
135152          INCLUDE XST00003                                        13515299
135153     END-EXEC.                                                    13515399
135154                                                                  13515499
135155     EXEC SQL                                                     13515599
135156          INCLUDE XST00004                                        13515699
135157     END-EXEC.                                                    13515799
135158                                                                  13515899
135159     EXEC SQL                                                     13515999
135160          INCLUDE XST00005                                        13516099
135161     END-EXEC.                                                    13516199
135162                                                                  13516299
135163     EXEC SQL                                                     13516399
135164          INCLUDE XST00008                                        13516499
135165     END-EXEC.                                                    13516599
135166                                                                  13516699
135167     EXEC SQL                                                     13516799
135168          INCLUDE XST00010                                        13516899
135169     END-EXEC.                                                    13516999
135170                                                                  13517099
135175     EXEC SQL                                                     13517599
135176          INCLUDE XST00012                                        13517699
135177     END-EXEC.                                                    13517799
135178                                                                  13517899
135179     EXEC SQL                                                     13517999
135180          INCLUDE XST00013                                        13518099
135181     END-EXEC.                                                    13518199
135182                                                                  13518299
135183     EXEC SQL                                                     13518399
135184          INCLUDE XST00018                                        13518499
135185     END-EXEC.                                                    13518599
135186                                                                  13518699
135187     EXEC SQL                                                     13518799
135188          INCLUDE XST00020                                        13518899
135189     END-EXEC.                                                    13518999
135190                                                                  13519099
135191     EXEC SQL                                                     13519199
135192          INCLUDE TSK                                             13519299
135193     END-EXEC.                                                    13519399
135194                                                                  13519499
135195     EXEC SQL                                                     13519599
135196          INCLUDE TUPCPLS                                         13519699
135197     END-EXEC.                                                    13519799
135198                                                                  13519899
135199     EXEC SQL                                                     13519999
135200          INCLUDE TUPCSKU                                         13520099
135201     END-EXEC.                                                    13520199
135206                                                                  13520699
135211     EXEC SQL                                                     13521199
135212          INCLUDE PCT00015                                        13521299
135213     END-EXEC.                                                    13521399
135214                                                                  13521499
135215     EXEC SQL                                                     13521599
135216          INCLUDE SQLCA                                           13521699
135217     END-EXEC.                                                    13521799
135218                                                                  13521899
135219     EXEC SQL                                                     13521999
135220        DECLARE STR_EXP_CURSOR CURSOR FOR                         13522099
135259         SELECT SUM(A.TRN_CLSN_PRCG_QTY )                         13525999
135260              , DATE(A.IN_TRNST_TRN_TMST)                         13526099
135261              , A.TRN_TYP_CDE                                     13526199
135262         FROM PCT_TRN_CLSN_DTL A                                  13526299
135267           WHERE A.INTR_UPC_ID = :PCT00015-INTR-UPC-ID            13526799
135268           AND A.LOC_NBR       = :PCT00015-LOC-NBR                13526899
135269           AND A.TRN_CLSN_CDE = 'SE'                              13526999
135270           AND A.TRN_TYP_CDE IN ('UN','AU','MM')                  13527099
135271           AND DATE(A.IN_TRNST_TRN_TMST) =                        13527199
135272             (SELECT MAX (DATE(C.IN_TRNST_TRN_TMST))              13527299
135273             FROM PCT_TRN_CLSN_DTL C                              13527399
135274             WHERE C.INTR_UPC_ID = A.INTR_UPC_ID                  13527499
135275               AND C.LOC_NBR = A.LOC_NBR                          13527599
135276               AND C.TRN_CLSN_CDE = A.TRN_CLSN_CDE                13527699
135277               AND C.TRN_TYP_CDE IN ('UN','AU','MM'))             13527799
135279          GROUP BY DATE(A.IN_TRNST_TRN_TMST), A.TRN_TYP_CDE       13527999
135280         ORDER BY DATE(A.IN_TRNST_TRN_TMST) DESC                  13528099
135281        WITH UR                                                   13528199
135282     END-EXEC.                                                    13528299
135283 LINKAGE SECTION.                                                 13528399
135284                                                                  13528499
135285 01  DFHCOMMAREA.                                                 13528599
135286     05  FILLER                         OCCURS  1 TO 4072 TIMES   13528699
135287                                        DEPENDING ON EIBCALEN.    13528799
135288         10  FILLER                     PIC X.                    13528899
135289                                                                  13528999
135290                                                                  13529099
135291 PROCEDURE DIVISION.                                              13529199
135292****************************************************************  13529299
135293** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. *  13529399
135294** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  *  13529499
135295** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            *  13529599
135296**                                                             *  13529699
135297** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  *  13529799
135298** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       *  13529899
135299****************************************************************  13529999
135300 0000-MAIN-MODULE.                                                13530099
135301                                                                  13530199
135302     INITIALIZE DP030-CICS-API-FIELDS.                            13530299
135303     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       13530399
135304     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          13530499
135305     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         13530599
135306     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       13530699
135307     MOVE LENGTH OF IQ414AI        TO DP030-MAP-LENGTH (1).       13530799
135308     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     13530899
135309     PERFORM 0001-CALL-CICS-ARCH-API.                             13530999
135310     PERFORM 1000-CONTROL-PROCESSING                              13531099
135311                                                                  13531199
135312     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     13531299
135313     PERFORM 0001-CALL-CICS-ARCH-API.                             13531399
135314                                                                  13531499
135315 0001-CALL-CICS-ARCH-API.                                         13531599
135316                                                                  13531699
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      13531799
135318                                    DFHCOMMAREA                   13531899
135319                                    DP030-CICS-API-FIELDS         13531999
135320                                    DP020-STANDARD-COMMAREA       13532099
135321                                    IQ414AI.                      13532199
135322                                                                  13532299
135323     IF  DP030-RC-CALL-SUCCESSFUL                                 13532399
135324         CONTINUE                                                 13532499
135325     ELSE                                                         13532599
135326         SET DP013-NO-ROLLBACK                                    13532699
135327             DP013-XCTL-DISPLAY-RESTART                           13532799
135328             DP013-CICS-ABEND      TO TRUE                        13532899
135329         MOVE 'BEFORE 0000-MAIN-MODULE'                           13532999
135330                                   TO DP013-PARAGRAPH             13533099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O13533199
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      13533299
135335         MOVE DP030-RETURN-CODE                                   13533799
135336                                   TO DP013-MESSAGE-TEXT (3)      13533899
135337         PERFORM DP013-0000-PROCESS-ABEND                         13533999
135338     END-IF.                                                      13534099
135339                                                                  13534199
135340*--------------------------------------------------------------*  13534299
135341*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT *  13534399
135342*    COURSE OF ACTION IS FOR THIS TRANSACTION.                 *  13534499
135343*--------------------------------------------------------------*  13534599
135344                                                                  13534699
135345 1000-CONTROL-PROCESSING.                                         13534799
135346                                                                  13534899
135347     EVALUATE TRUE                                                13534999
135348         WHEN DP020-NEXT-ACT-INITIAL                              13535099
135349             INITIALIZE ASC-SPECIFIC-COMMAREA                     13535199
135350             SET PS-FIRST-TIME TO TRUE                            13535299
135351             PERFORM 1100-PROCESS-INTER-APPL-COMM                 13535399
135352***-----$TEMPLATE NOTE$-----------------------------------------  13535499
135353*    IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING            13535599
135354*    APPLICATION, SETUP APPROPRIATE MESSAGE AND SEVERITY AND      13535699
135355*    SET APPL-ERROR TO TRUE, THIS WILL RETURN TO CALLING          13535799
135356*    APPLICATION WHEN API CALLED.                                 13535899
135357***-------------------------------------------------------------  13535999
135358             IF  PS-COMMAREA-NOT-VALID                            13536099
135359                 MOVE PC-TSYMSG-99901                             13536199
135360                                   TO DP020-MSG-NUMBER            13536299
135361                 SET DP020-MSG-FATAL                              13536399
135362                                   TO TRUE                        13536499
135363                 SET DP020-NEXT-ACT-APPL-ERROR                    13536599
135364                                   TO TRUE                        13536699
135365             ELSE                                                 13536799
135366                PERFORM 4000-BUILD-INITIAL-PANEL                  13536899
135367             END-IF                                               13536999
135368                                                                  13537099
135369         WHEN DP020-NEXT-ACT-READ-MAP                             13537199
135370             PERFORM 2000-FKEY-PROCESSING                         13537299
135371                                                                  13537399
135372         WHEN DP020-NEXT-ACT-RETURN                               13537499
135373             PERFORM 3200-RESET-ATTRIBUTES                        13537599
135374             MOVE -1                   TO ACSRUPCL                13537699
135375             SET DP030-SET-CURSOR-APPL-1  TO TRUE                 13537799
135376                                                                  13537899
135377         WHEN OTHER                                               13537999
135378             SET DP013-LOGIC-ABEND                                13538099
135379                 DP013-NO-ROLLBACK TO TRUE                        13538199
135380             MOVE '1000-CONTROL-PROCESSING'                       13538299
135381                                   TO  DP013-PARAGRAPH            13538399
135382             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   13538499
135383                                   TO  DP013-MESSAGE-TEXT(1)      13538599
135384             MOVE DP020-NEXT-APPL-ACTIVITY                        13538699
135385                                   TO DP013-MESSAGE-TEXT(2)       13538799
135386             PERFORM DP013-0000-PROCESS-ABEND                     13538899
135387     END-EVALUATE.                                                13538999
135388                                                                  13539099
135389*--------------------------------------------------------------*  13539199
135390*    PARAGRAPH IS USED WHEN COMING TO THIS PROGRAM FROM ANOTHER*  13539299
135391*    POSSIBLY PASSING DATA IN.                                 *  13539399
135392*                                                              *  13539499
135393* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR  *  13539599
135394* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.            *  13539699
135395*--------------------------------------------------------------*  13539799
135396                                                                  13539899
135397 1100-PROCESS-INTER-APPL-COMM.                                    13539999
135398                                                                  13540099
135399     SET PS-COMMAREA-VALID           TO TRUE.                     13540199
135400     EVALUATE DP020-INT-APPL-FORMAT-IND                           13540299
135401         WHEN PC-IQKCS401-FORMAT-IND                              13540399
135402            IF IQ016-STORE-NO = PC-CORPORATE-LOCATION             13540499
135403                MOVE 0  TO ASC-LOCATION-NBR                       13540599
135404            ELSE                                                  13540699
135405                MOVE IQ016-STORE-NO   TO ASC-LOCATION-NBR         13540799
135406            END-IF                                                13540899
135407*                                                                 13540999
135408            IF IQ016-UPC-NO  IS NUMERIC                           13541099
135409                MOVE IQ016-UPC-NO      TO ASC-UPC-NBR             13541199
135410                                           DK-UPC-NBR             13541299
135411            ELSE                                                  13541399
135412                MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER         13541499
135413                MOVE DP015-UNP-ALP-BRT-MDT                        13541599
135414                                      TO AUPC01A                  13541699
135415                                         AUPC02A                  13541799
135416                                         AUPC03A                  13541899
135417                                         AUPC04A                  13541999
135418                MOVE DP015-RED        TO AUPC01C                  13542099
135419                MOVE DP015-REVERSE    TO AUPC01H                  13542199
135420                MOVE -1               TO AUPC01L                  13542299
135421                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13542399
135422                SET PS-ERROR                                      13542499
135423                         DP020-MSG-FATAL   TO TRUE                13542599
135424            END-IF                                                13542699
135425                                                                  13542799
135426            IF IQ016-SKU-NBR IS NUMERIC                           13542899
135427                MOVE IQ016-SKU-NBR    TO ASC-SKU-NBR              13542999
135428                                          DK-SKU-NBR              13543099
135429            ELSE                                                  13543199
135430                MOVE PC-TSYMSG-00695  TO DP020-MSG-NUMBER         13543299
135431                MOVE DP015-UNP-ALP-BRT-MDT TO ASKUNBRA            13543399
135432                MOVE DP015-RED        TO ASKUNBRC                 13543499
135433                MOVE DP015-REVERSE    TO ASKUNBRH                 13543599
135434                MOVE -1               TO ASKUNBRL                 13543699
135435                SET DP030-SET-CURSOR-APPL-1 TO TRUE               13543799
135436                SET PS-ERROR                                      13543899
135437                     DP020-MSG-FATAL   TO TRUE                    13543999
135438            END-IF                                                13544099
135439*                                                                 13544199
135440         WHEN PC-IQKCS408-FORMAT-IND                              13544299
135441              SET ASC-USE-SELECTION-QUEUE TO TRUE                 13544399
135442              IF IQ016-STORE-NO = PC-CORPORATE-LOCATION           13544499
135443                 MOVE 0 TO ASC-LOCATION-NBR                       13544599
135444              ELSE                                                13544699
135445                 MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR          13544799
135446              END-IF                                              13544899
135447              MOVE IQ016-NUMBER-OF-SELECTED-ITEMS TO              13544999
135448                                ASC-NUMBER-OF-TS-ITEMS            13545099
135449              MOVE IQ016-SEL-QUEUE-NAME           TO              13545199
135450                                ASC-SEL-QUEUE-NAME-IN             13545299
135451              PERFORM 1120-PREPARE-LIST-ENTRY                     13545399
135452                                                                  13545499
135453         WHEN OTHER                                               13545599
135454              SET PS-COMMAREA-NOT-VALID TO TRUE                   13545699
135455                                                                  13545799
135456     END-EVALUATE.                                                13545899
135457                                                                  13545999
135458*--------------------------------------------------------------*  13546099
135459*    ENTRY IS FROM A LIST.                                     *  13546199
135460*                                                              *  13546299
135461*--------------------------------------------------------------*  13546399
135462                                                                  13546499
135463 1120-PREPARE-LIST-ENTRY.                                         13546599
135464                                                                  13546699
135465     MOVE IQ014-MAX-ITEMS TO ASC-SEL-SUB.                         13546799
135466     MOVE ZERO            TO ASC-SEL-ITEM.                        13546899
135467     PERFORM 2300-GET-NEXT-RECORD.                                13546999
135468                                                                  13547099
135469*--------------------------------------------------------------*  13547199
135470* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY      *  13547299
135471* ACTIONS SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON    *  13547399
135472* REGARDLESS OF EDITS.                                         *  13547499
135473*--------------------------------------------------------------*  13547599
135474                                                                  13547699
135475 2000-FKEY-PROCESSING.                                            13547799
135476                                                                  13547899
135477     EVALUATE TRUE                                                13547999
135478                                                                  13548099
135479         WHEN DP020-SRC-AID = DP016-CLEAR                         13548199
135480              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  13548299
135481                                                                  13548399
135482         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     13548499
135483*             INITIALIZE ASC-SPECIFIC-COMMAREA                    13548599
135484              SET PS-FIRST-TIME TO TRUE                           13548699
135485              PERFORM 1100-PROCESS-INTER-APPL-COMM                13548799
135486                                                                  13548899
135487              PERFORM 4000-BUILD-INITIAL-PANEL                    13548999
135488*             PERFORM 3200-RESET-ATTRIBUTES                       13549099
135489                                                                  13549199
135490         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             13549299
135491**            F20  DISPLAY NEXT RECORD                            13549399
135492              IF ASC-USE-SELECTION-QUEUE                          13549499
135493                 PERFORM 2300-GET-NEXT-RECORD                     13549599
135494                 IF PS-LIST-END                                   13549699
135495                     SET PS-NO-LIST-END TO TRUE                   13549799
135496                 ELSE                                             13549899
135497                     PERFORM 2050-DELETE-LIST-QUEUE               13549999
135498                     PERFORM 3200-RESET-ATTRIBUTES                13550099
135499                     PERFORM 4000-BUILD-INITIAL-PANEL             13550199
135500                 END-IF                                           13550299
135501              ELSE                                                13550399
135502*                --- BOTTOM OF LIST ---                           13550499
135503                 MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER         13550599
135504                 SET DP020-MSG-INFORMATIONAL TO TRUE              13550699
135505              END-IF                                              13550799
135506                                                                  13550899
135507         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             13550999
135508**            F19  DISPLAY PREVIOUS RECORD                        13551099
135509              IF ASC-USE-SELECTION-QUEUE                          13551199
135510                 PERFORM 2310-GET-PREV-RECORD                     13551299
135511                 IF PS-LIST-END                                   13551399
135512                     SET PS-NO-LIST-END TO TRUE                   13551499
135513                 ELSE                                             13551599
135514                     PERFORM 2050-DELETE-LIST-QUEUE               13551699
135515                     PERFORM 3200-RESET-ATTRIBUTES                13551799
135516                     PERFORM 4000-BUILD-INITIAL-PANEL             13551899
135517                 END-IF                                           13551999
135518              ELSE                                                13552099
135519                 MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER         13552199
135520                 SET DP020-MSG-INFORMATIONAL TO TRUE              13552299
135521              END-IF                                              13552399
135522                                                                  13552499
135523         WHEN OTHER                                               13552599
135524              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                13552699
135525              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  13552799
135526              PERFORM 4000-BUILD-INITIAL-PANEL                    13552899
135527              IF PS-NO-ERROR                                      13552999
135528                 SET DP030-CONTINUE-GO TO TRUE                    13553099
135529                 PERFORM 2100-CHECK-FUNCTION-KEY                  13553199
135530              ELSE                                                13553299
135531                  SET DP030-OVERRIDE-GO TO TRUE                   13553399
135532              END-IF                                              13553499
135533     END-EVALUATE.                                                13553599
135534                                                                  13553699
135535*--------------------------------------------------------------*  13553799
135536*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                   *  13553899
135537*--------------------------------------------------------------*  13553999
135538 2050-DELETE-LIST-QUEUE.                                          13554099
135539                                                                  13554199
135540     EXEC CICS                                                    13554299
135541         DELETEQ TS                                               13554399
135542             QUEUE (ASC-LIST-QUEUE-NAME)                          13554499
135543             RESP  (PV-CICS-RESP)                                 13554599
135544     END-EXEC.                                                    13554699
135545                                                                  13554799
135546     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       13554899
135547        (PV-CICS-RESP = DFHRESP(QIDERR))                          13554999
135548         CONTINUE                                                 13555099
135549     ELSE                                                         13555199
135550         SET DP013-CICS-ABEND      TO TRUE                        13555299
135551         SET DP013-NO-ROLLBACK     TO TRUE                        13555399
135552                                                                  13555499
135553         MOVE '2050-DELETE-LIST-QUEUE'                            13555599
135554                                   TO DP013-PARAGRAPH             13555699
135555         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    13555799
135556                                   TO DP013-MESSAGE-TEXT (1)      13555899
135557         PERFORM DP013-0000-PROCESS-ABEND                         13555999
135558     END-IF.                                                      13556099
135559                                                                  13556199
135560     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  13556299
135561                                                                  13556399
135562****************************************************************  13556499
135563*    ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED  *  13556599
135564*    FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE       *  13556699
135565*    RETURNED FROM THE CICS ARCHITECTURE API.                  *  13556799
135566****************************************************************  13556899
135567 2100-CHECK-FUNCTION-KEY.                                         13556999
135568                                                                  13557099
135569     EVALUATE TRUE                                                13557199
135570         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13557299
135571**  F14       DISPLAY ONHAND QUANTITIES                           13557399
135572              PERFORM 7000-CALL-XMKCS001                          13557499
135573              PERFORM 7400-CALL-XLKCS074                          13557599
135574                                                                  13557699
135575              COMPUTE PV-WORK-QTY-9 = PV-ONHAND-QTY -             13557799
135576                                      PV-STORE-EXPECTED-QTY       13557899
135577                                                                  13557999
135578              MOVE PV-WORK-QTY-X     TO ASTROHO                   13558099
135579                                        ASC-STORE-ON-HAND         13558199
135580              MOVE PV-INTRANSIT-QTY  TO PV-WORK-QTY-9             13558299
135581              MOVE PV-WORK-QTY-X     TO AINTRANO                  13558399
135582                                        ASC-IN-TRANSIT-QTY        13558499
135583                                                                  13558599
135590              PERFORM 7600-CHECK-LAST-RCPT                        13559099
165500**GB TEST                                                         16550099
165504              MOVE PV-UNLOAD-QTY    TO PV-WORK-QTY-9              16550499
165505              MOVE PV-WORK-QTY-X    TO AUNLQTYO                   16550599
165506                                       ASC-LAST-UNLD-QTY          16550699
165511                                                                  16551199
165512              MOVE PV-PROCESS-DATE  TO ASTRUNLO                   16551299
165513                                      ASC-LAST-UNLD-DATE          16551399
165514                                                                  16551499
165515              IF ASC-STR-UNLOAD-SCAN                              16551599
165516                 MOVE 'LAST UNLD SCANNED:'   TO AUNLDSTO          16551699
165517              ELSE                                                16551799
165518                 IF ASC-STR-UNLOAD-ASSM                           16551899
165519                    MOVE 'LAST UNLD ASSUMPT:'   TO AUNLDSTO       16551999
165520                 ELSE                                             16552099
165521                    MOVE 'LAST UNLOAD......:'  TO AUNLDSTO        16552199
165522                 END-IF                                           16552299
165523              END-IF                                              16552399
165524**GB TEST                                                         16552499
165562         WHEN DP020-SRC-AID = DP016-ENTER                         16556299
165563              PERFORM 4000-BUILD-INITIAL-PANEL                    16556399
165564                                                                  16556499
165565         WHEN OTHER                                               16556599
165566              SET DP013-NO-ROLLBACK                               16556699
165567                  DP013-XCTL-DISPLAY-RESTART                      16556799
165568                  DP013-CICS-ABEND  TO TRUE                       16556899
165569              MOVE '2100-CHECK-FUNCTION-KEY'                      16556999
165570                                    TO DP013-PARAGRAPH            16557099
165571              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     16557199
165572                                    TO DP013-MESSAGE-TEXT (1)     16557299
165573              STRING 'OR CODE MISSING FROM THIS '                 16557399
165574                     'PROGRAM TO PROCESS:'                        16557499
165575                      DELIMITED BY SIZE                           16557599
165576                      INTO DP013-MESSAGE-TEXT (2)                 16557699
165577              MOVE DP020-SRC-AID    TO PM-A-SRC-AID               16557799
165578              MOVE DP020-FK-ACTION (DP020-SRC-AID)                16557899
165579                                    TO PM-A-FK-ACTION             16557999
165580              MOVE DP020-FK-DISPN-IND (DP020-SRC-AID)             16558099
165581                                    TO PM-A-FK-DISPN              16558199
165582              MOVE PM-ABEND-INFO-A  TO DP013-MESSAGE-TEXT (3)     16558299
165583              MOVE 'REVIEW PFKEYS SETUP FOR THIS MNEMONIC.'       16558399
165584                                    TO DP013-MESSAGE-TEXT (4)     16558499
165585              PERFORM DP013-0000-PROCESS-ABEND                    16558599
165586     END-EVALUATE.                                                16558699
165587                                                                  16558799
165588                                                                  16558899
165589                                                                  16558999
165590*--------------------------------------------------------------*  16559099
165591* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS *  16559199
165592* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN *  16559299
165593* THE APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.        *  16559399
165594*--------------------------------------------------------------*  16559499
165595                                                                  16559599
165596 2200-MOVE-SCREEN-TO-COMMAREA.                                    16559699
165597                                                                  16559799
165598     IF AUPC01L > ZERO                                            16559899
165599        SET PS-NEW-UPC-FOUND      TO TRUE                         16559999
165600        MOVE AUPC01I              TO ASC-UPC-NBR-01-X             16560099
165601        IF IQ016-STORE-NO = PC-CORPORATE-LOCATION                 16560199
165602            MOVE 0 TO ASC-LOCATION-NBR                            16560299
165603        ELSE                                                      16560399
165604            MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR               16560499
165605        END-IF                                                    16560599
165606     ELSE                                                         16560699
165607         IF AUPC01F = DP015-ERASE-EOF                             16560799
165608            MOVE SPACE            TO ASC-UPC-NBR-01-X             16560899
165609         END-IF                                                   16560999
165610     END-IF.                                                      16561099
165611                                                                  16561199
165612     IF AUPC02L > ZERO                                            16561299
165613        SET PS-NEW-UPC-FOUND      TO TRUE                         16561399
165614        MOVE AUPC02I              TO ASC-UPC-NBR-02-X             16561499
165615        IF IQ016-STORE-NO = PC-CORPORATE-LOCATION                 16561599
165616            MOVE 0 TO ASC-LOCATION-NBR                            16561699
165617        ELSE                                                      16561799
165618            MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR               16561899
165619        END-IF                                                    16561999
165620     ELSE                                                         16562099
165621         IF AUPC02F = DP015-ERASE-EOF                             16562199
165622            MOVE SPACE            TO ASC-UPC-NBR-02-X             16562299
165623         END-IF                                                   16562399
165624     END-IF.                                                      16562499
165625                                                                  16562599
165626     IF AUPC03L > ZERO                                            16562699
165627        SET PS-NEW-UPC-FOUND      TO TRUE                         16562799
165628        MOVE AUPC03I              TO ASC-UPC-NBR-03-X             16562899
165629        IF IQ016-STORE-NO = PC-CORPORATE-LOCATION                 16562999
165630            MOVE 0 TO ASC-LOCATION-NBR                            16563099
165631        ELSE                                                      16563199
165632            MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR               16563299
165633        END-IF                                                    16563399
165634     ELSE                                                         16563499
165635         IF AUPC03F = DP015-ERASE-EOF                             16563599
165636            MOVE SPACE            TO ASC-UPC-NBR-03-X             16563699
165637         END-IF                                                   16563799
165638     END-IF.                                                      16563899
165639                                                                  16563999
165640     IF AUPC04L > ZERO                                            16564099
165641        SET PS-NEW-UPC-FOUND      TO TRUE                         16564199
165642        MOVE AUPC04I              TO ASC-UPC-NBR-04-X             16564299
165643        IF IQ016-STORE-NO = PC-CORPORATE-LOCATION                 16564399
165644            MOVE 0 TO ASC-LOCATION-NBR                            16564499
165645        ELSE                                                      16564599
165646            MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR               16564699
165647        END-IF                                                    16564799
165648     ELSE                                                         16564899
165649         IF AUPC04F = DP015-ERASE-EOF                             16564999
165650            MOVE SPACE            TO ASC-UPC-NBR-04-X             16565099
165651         END-IF                                                   16565199
165652     END-IF.                                                      16565299
165653                                                                  16565399
165654     IF ASKUNBRL > ZERO                                           16565499
165655        SET PS-NEW-SKU-FOUND TO TRUE                              16565599
165656        MOVE ASKUNBRI            TO ASC-SKU-NBR-X                 16565699
165657        IF IQ016-STORE-NO = PC-CORPORATE-LOCATION                 16565799
165658            MOVE 0 TO ASC-LOCATION-NBR                            16565899
165659        ELSE                                                      16565999
165660            MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR               16566099
165661        END-IF                                                    16566199
165662     ELSE                                                         16566299
165663         IF ASKUNBRF = DP015-ERASE-EOF                            16566399
165664             MOVE SPACE           TO ASC-SKU-NBR-X                16566499
165665         END-IF                                                   16566599
165666     END-IF.                                                      16566699
165667                                                                  16566799
165668     IF ASTRNBRL > ZERO                                           16566899
165669        MOVE ASTRNBRI             TO ASC-LOCATION-NBR-X           16566999
165670        IF ASC-UPC-NBR > 0                                        16567099
165671            SET PS-NEW-UPC-FOUND TO TRUE                          16567199
165672        ELSE                                                      16567299
165673            IF ASC-SKU-NBR > 0                                    16567399
165674                SET PS-NEW-SKU-FOUND TO TRUE                      16567499
165675            END-IF                                                16567599
165676        END-IF                                                    16567699
165677     ELSE                                                         16567799
165678         IF ASTRNBRF = DP015-ERASE-EOF                            16567899
165679            MOVE SPACE            TO ASC-LOCATION-NBR-X           16567999
165680         END-IF                                                   16568099
165681     END-IF.                                                      16568199
165682                                                                  16568299
165683 2300-GET-NEXT-RECORD.                                            16568399
165684     ADD +1                        TO ASC-SEL-SUB.                16568499
165685     IF  ASC-SEL-SUB > IQ014-MAX-ITEMS                            16568599
165686         ADD +1                    TO ASC-SEL-ITEM                16568699
165687         MOVE +1                   TO ASC-SEL-SUB                 16568799
165688     END-IF.                                                      16568899
165689     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                16568999
165690         PERFORM 9100-READ-SEL-QUEUE                              16569099
165691         IF  IQ014-MAJ-CL (ASC-SEL-SUB) > ZERO                    16569199
165692             SET PS-NEW-UPC-FOUND TO TRUE                         16569299
165693             MOVE IQ014-UPC-NBR     (ASC-SEL-SUB)                 16569399
165694                                   TO ASC-UPC-NBR                 16569499
165695                                      DK-UPC-NBR                  16569599
165696             MOVE IQ014-SKU-CNT     (ASC-SEL-SUB)                 16569699
165697                                   TO ASC-SKU-NBR                 16569799
165698                                      DK-SKU-NBR                  16569899
165699             PERFORM 9200-REWRITE-LIST-QUEUE                      16569999
165700         ELSE                                                     16570099
165701             SUBTRACT +1 FROM ASC-SEL-SUB                         16570199
165702*            --- BOTTOM OF LIST ---                               16570299
165703             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            16570399
165704             SET DP020-MSG-INFORMATIONAL                          16570499
165705                 PS-LIST-END       TO TRUE                        16570599
165706         END-IF                                                   16570699
165707     ELSE                                                         16570799
165708         SUBTRACT +1 FROM ASC-SEL-ITEM                            16570899
165709         MOVE IQ014-MAX-ITEMS      TO ASC-SEL-SUB                 16570999
165710         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            16571099
165711         SET DP020-MSG-INFORMATIONAL                              16571199
165712             PS-LIST-END           TO TRUE                        16571299
165713     END-IF.                                                      16571399
165714                                                                  16571499
165715 2310-GET-PREV-RECORD.                                            16571599
165716     SUBTRACT +1                 FROM ASC-SEL-SUB.                16571699
165717     IF ASC-SEL-SUB < +1                                          16571799
165718         SUBTRACT +1             FROM ASC-SEL-ITEM                16571899
165719         MOVE IQ014-MAX-ITEMS      TO ASC-SEL-SUB                 16571999
165720     END-IF.                                                      16572099
165721                                                                  16572199
165722     MOVE IQ016-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME-IN       16572299
165723     IF ASC-SEL-ITEM > ZERO                                       16572399
165724         PERFORM 9100-READ-SEL-QUEUE                              16572499
165725         SET PS-NEW-UPC-FOUND TO TRUE                             16572599
165726         MOVE IQ014-UPC-NBR     (ASC-SEL-SUB)                     16572699
165727                               TO ASC-UPC-NBR                     16572799
165728                                  DK-UPC-NBR                      16572899
165729         MOVE IQ014-SKU-CNT     (ASC-SEL-SUB)                     16572999
165730                               TO ASC-SKU-NBR                     16573099
165731                                  DK-SKU-NBR                      16573199
165732         PERFORM 9200-REWRITE-LIST-QUEUE                          16573299
165733     ELSE                                                         16573399
165734         MOVE +1 TO  ASC-SEL-SUB                                  16573499
165735                     ASC-SEL-ITEM                                 16573599
165736*        --- TOP OF LIST ---                                      16573699
165737         MOVE PC-TSYMSG-00069  TO DP020-MSG-NUMBER                16573799
165738         SET DP020-MSG-INFORMATIONAL                              16573899
165739             PS-LIST-END       TO TRUE                            16573999
165740     END-IF.                                                      16574099
165741                                                                  16574199
165742                                                                  16574299
165743*--------------------------------------------------------------*  16574399
165744* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-*  16574499
165745* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO *  16574599
165746* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE   *  16574699
165747* DONE IN THE DESTINATION PROGRAM, NOT HERE.                   *  16574799
165748*--------------------------------------------------------------*  16574899
165749                                                                  16574999
165750 3000-EDIT-DATA-IN-COMMAREA.                                      16575099
165751                                                                  16575199
165752     PERFORM 3200-RESET-ATTRIBUTES.                               16575299
165753                                                                  16575399
165754     PERFORM 3030-VALIDATE-DIRECT-UPC.                            16575499
165755                                                                  16575599
165756     IF  PS-NO-ERROR                                              16575699
165757         MOVE -1                   TO ACSRUPCL                    16575799
165758         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     16575899
165759     END-IF.                                                      16575999
165760                                                                  16576099
165761                                                                  16576199
165762****************************************************************  16576299
165763*    ENSURE THAT EACH OF THE FOUR PARTS OF THE UPC NUMBER      *  16576399
165764*    ARE NUMERIC.                                              *  16576499
165765*    ALSO ENSURE THAT THE SKU NUMBER IS AN EIGHT-DIGIT NUMERIC *  16576599
165766*    NUMBER.                                                   *  16576699
165767****************************************************************  16576799
165768 3030-VALIDATE-DIRECT-UPC.                                        16576899
165769                                                                  16576999
165770     MOVE 0 TO ASC-UPC-FILLER                                     16577099
165771     MOVE ASC-UPC-NBR-01-X     TO DP010I-UNEDITED-FIELD           16577199
165772     MOVE 2                    TO DP010I-MAXIMUM-DIGITS           16577299
165773     MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS         16577399
165774     SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                      16577499
165776     CALL DP010I-NUMERIC-EDIT-ROUTINE                             16577699
165777                         USING DP010I-NUMERIC-EDIT-AREA           16577799
165778     IF DP010I-ERROR-DETECTED                                     16577899
165779        MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                 16577999
165780        MOVE DP015-UNP-ALP-BRT-MDT                                16578099
165781                              TO AUPC01A                          16578199
165782                                 AUPC02A                          16578299
165783                                 AUPC03A                          16578399
165784                                 AUPC04A                          16578499
165785        MOVE DP015-RED        TO AUPC01C                          16578599
165786        MOVE DP015-REVERSE    TO AUPC01H                          16578699
165787        MOVE -1               TO AUPC01L                          16578799
165788        SET DP030-SET-CURSOR-APPL-1 TO TRUE                       16578899
165789        SET PS-ERROR                                              16578999
165790            DP020-MSG-FATAL   TO TRUE                             16579099
165791     ELSE                                                         16579199
165792        MOVE DP010I-NUMERIC-FIELD                                 16579299
165793                              TO ASC-UPC-NBR-01                   16579399
165794        MOVE ASC-UPC-NBR-01     TO AUPC01O                        16579499
165795                                                                  16579599
165796     END-IF.                                                      16579699
165797                                                                  16579799
165798     IF PS-NO-ERROR                                               16579899
165799        MOVE ASC-UPC-NBR-02-X     TO DP010I-UNEDITED-FIELD        16579999
165800        MOVE 5                    TO DP010I-MAXIMUM-DIGITS        16580099
165801        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16580199
165802        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16580299
165804        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16580499
165805                         USING DP010I-NUMERIC-EDIT-AREA           16580599
165806        IF DP010I-ERROR-DETECTED                                  16580699
165807           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              16580799
165808           MOVE DP015-UNP-ALP-BRT-MDT                             16580899
165809                                 TO AUPC01A                       16580999
165810                                    AUPC02A                       16581099
165811                                    AUPC03A                       16581199
165812                                    AUPC04A                       16581299
165813           MOVE DP015-RED        TO AUPC02C                       16581399
165814           MOVE DP015-REVERSE    TO AUPC02H                       16581499
165815           MOVE -1               TO AUPC02L                       16581599
165816           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16581699
165817           SET PS-ERROR                                           16581799
165818               DP020-MSG-FATAL   TO TRUE                          16581899
165819        ELSE                                                      16581999
165820           MOVE DP010I-NUMERIC-FIELD                              16582099
165821                                 TO ASC-UPC-NBR-02                16582199
165822           MOVE ASC-UPC-NBR-02     TO AUPC02O                     16582299
165823                                                                  16582399
165824     END-IF.                                                      16582499
165825                                                                  16582599
165826     IF PS-NO-ERROR                                               16582699
165827        MOVE ASC-UPC-NBR-03-X     TO DP010I-UNEDITED-FIELD        16582799
165828        MOVE 5                    TO DP010I-MAXIMUM-DIGITS        16582899
165829        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16582999
165830        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16583099
165832        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16583299
165833                         USING DP010I-NUMERIC-EDIT-AREA           16583399
165834        IF DP010I-ERROR-DETECTED                                  16583499
165835           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              16583599
165836           MOVE DP015-UNP-ALP-BRT-MDT                             16583699
165837                                 TO AUPC01A                       16583799
165838                                    AUPC02A                       16583899
165839                                    AUPC03A                       16583999
165840                                    AUPC04A                       16584099
165841           MOVE DP015-RED        TO AUPC03C                       16584199
165842           MOVE DP015-REVERSE    TO AUPC03H                       16584299
165843           MOVE -1               TO AUPC03L                       16584399
165844           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16584499
165845           SET PS-ERROR                                           16584599
165846               DP020-MSG-FATAL   TO TRUE                          16584699
165847        ELSE                                                      16584799
165848           MOVE DP010I-NUMERIC-FIELD                              16584899
165849                                 TO ASC-UPC-NBR-03                16584999
165850           MOVE ASC-UPC-NBR-03     TO AUPC03O                     16585099
165851                                                                  16585199
165852     END-IF.                                                      16585299
165853                                                                  16585399
165854     IF PS-NO-ERROR                                               16585499
165855        MOVE ASC-UPC-NBR-04-X     TO DP010I-UNEDITED-FIELD        16585599
165856        MOVE 1                    TO DP010I-MAXIMUM-DIGITS        16585699
165857        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16585799
165858        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16585899
165860        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16586099
165861                         USING DP010I-NUMERIC-EDIT-AREA           16586199
165862        IF DP010I-ERROR-DETECTED                                  16586299
165863           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              16586399
165864           MOVE DP015-UNP-ALP-BRT-MDT                             16586499
165865                                 TO AUPC01A                       16586599
165866                                    AUPC02A                       16586699
165867                                    AUPC03A                       16586799
165868                                    AUPC04A                       16586899
165869           MOVE DP015-RED        TO AUPC04C                       16586999
165870           MOVE DP015-REVERSE    TO AUPC04H                       16587099
165871           MOVE -1               TO AUPC04L                       16587199
165872           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16587299
165873           SET PS-ERROR                                           16587399
165874               DP020-MSG-FATAL   TO TRUE                          16587499
165875        ELSE                                                      16587599
165876           MOVE DP010I-NUMERIC-FIELD                              16587699
165877                                 TO ASC-UPC-NBR-04                16587799
165878           MOVE ASC-UPC-NBR-04     TO AUPC04O                     16587899
165879                                                                  16587999
165880     END-IF.                                                      16588099
165881                                                                  16588199
165882     IF ASC-LOCATION-NBR-X IS NOT NUMERIC                         16588299
165883        MOVE ASC-LOCATION-NBR-X   TO DP010I-UNEDITED-FIELD        16588399
165884        MOVE 4                    TO DP010I-MAXIMUM-DIGITS        16588499
165885        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16588599
165886        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16588699
165888        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16588899
165889                         USING DP010I-NUMERIC-EDIT-AREA           16588999
165890        IF DP010I-ERROR-DETECTED                                  16589099
165891           MOVE PC-TSYMSG-00334  TO DP020-MSG-NUMBER              16589199
165892           PERFORM 3180-LOCATION-ERROR                            16589299
165893        END-IF                                                    16589399
165894     END-IF.                                                      16589499
165895                                                                  16589599
165896     IF PS-NO-ERROR                                               16589699
165897        MOVE ASC-LOCATION-NBR-X   TO DP010I-UNEDITED-FIELD        16589799
165898        MOVE 4                    TO DP010I-MAXIMUM-DIGITS        16589899
165899        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16589999
165900        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16590099
165902        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16590299
165903                         USING DP010I-NUMERIC-EDIT-AREA           16590399
165904        IF DP010I-ERROR-DETECTED                                  16590499
165905           MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER              16590599
165906           PERFORM 3180-LOCATION-ERROR                            16590699
165907        ELSE                                                      16590799
165908           MOVE DP010I-NUMERIC-FIELD                              16590899
165909                                 TO ASC-LOCATION-NBR              16590999
165910           MOVE ASC-LOCATION-NBR   TO ASTRNBRO                    16591099
165911                                                                  16591199
165912     END-IF.                                                      16591299
165913                                                                  16591399
165914     IF ASC-SKU-NBR-X IS NOT NUMERIC                              16591499
165915        MOVE ASC-SKU-NBR-X        TO DP010I-UNEDITED-FIELD        16591599
165916        MOVE 8                    TO DP010I-MAXIMUM-DIGITS        16591699
165917        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16591799
165918        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16591899
165920        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16592099
165921                         USING DP010I-NUMERIC-EDIT-AREA           16592199
165922        IF DP010I-ERROR-DETECTED                                  16592299
165923           MOVE PC-TSYMSG-00695       TO DP020-MSG-NUMBER         16592399
165924           MOVE DP015-UNP-ALP-BRT-MDT TO ASKUNBRA                 16592499
165925           MOVE DP015-RED        TO ASKUNBRC                      16592599
165926           MOVE DP015-REVERSE    TO ASKUNBRH                      16592699
165927           MOVE -1               TO ASKUNBRL                      16592799
165928           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16592899
165929           SET PS-ERROR                                           16592999
165930               DP020-MSG-FATAL   TO TRUE                          16593099
165931        END-IF                                                    16593199
165932     END-IF.                                                      16593299
165933                                                                  16593399
165934     IF PS-NO-ERROR                                               16593499
165935        MOVE ZERO                 TO ASC-SKU-FILLER               16593599
165936        MOVE ASC-SKU-NBR-X        TO DP010I-UNEDITED-FIELD        16593699
165937        MOVE 8                    TO DP010I-MAXIMUM-DIGITS        16593799
165938        MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS      16593899
165939        SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                   16593999
165941        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16594199
165942                         USING DP010I-NUMERIC-EDIT-AREA           16594299
165943        IF DP010I-ERROR-DETECTED                                  16594399
165944           MOVE PC-TSYMSG-00695  TO DP020-MSG-NUMBER              16594499
165945           MOVE DP015-UNP-ALP-BRT-MDT TO ASKUNBRA                 16594599
165946           MOVE DP015-RED        TO ASKUNBRC                      16594699
165947           MOVE DP015-REVERSE    TO ASKUNBRH                      16594799
165948           MOVE -1               TO ASKUNBRL                      16594899
165949           SET DP030-SET-CURSOR-APPL-1 TO TRUE                    16594999
165950           SET PS-ERROR                                           16595099
165951               DP020-MSG-FATAL   TO TRUE                          16595199
165952        ELSE                                                      16595299
165953           MOVE DP010I-NUMERIC-FIELD                              16595399
165954                                 TO ASC-SKU-NBR-8                 16595499
165955           MOVE ASC-SKU-NBR-8    TO ASKUNBRO                      16595599
165956                                                                  16595699
165957     END-IF.                                                      16595799
165958                                                                  16595899
165959     IF PS-NO-ERROR                                               16595999
165960        IF ASC-UPC-NBR = ZEROS AND ASC-SKU-NBR = ZEROS            16596099
165961           MOVE PC-TSYMSG-00036  TO DP020-MSG-NUMBER              16596199
165962           PERFORM 3060-UPC-ERROR                                 16596299
165963           PERFORM 3070-SKU-ERROR                                 16596399
165964        ELSE                                                      16596499
165965           IF ASC-UPC-NBR > ZERO                                  16596599
165966               MOVE ASC-UPC-NBR TO DK-UPC-NBR                     16596699
165967           ELSE                                                   16596799
165968               IF ASC-SKU-NBR > ZERO                              16596899
165969                   MOVE ASC-SKU-NBR TO DK-SKU-NBR                 16596999
165970               END-IF                                             16597099
165971           END-IF                                                 16597199
165972        END-IF                                                    16597299
165973     END-IF.                                                      16597399
165974                                                                  16597499
165975     IF PS-NO-ERROR                                               16597599
165976        IF ASC-LOCATION-NBR = ZEROS                               16597699
165977           MOVE ASC-LOC-NM TO ASTRNMO                             16597799
165978        ELSE                                                      16597899
165979          IF ASC-LOCATION-NBR-X IS NOT NUMERIC                    16597999
165980             MOVE PC-TSYMSG-00334  TO DP020-MSG-NUMBER            16598099
165981             PERFORM 3180-LOCATION-ERROR                          16598199
165982          ELSE                                                    16598299
165983             MOVE ASC-LOCATION-NBR TO DK-LOCATION-NBR             16598399
165984             PERFORM 3480-VALIDATE-LOCATION                       16598499
165985          END-IF                                                  16598599
165986           IF PS-LOCATION-NOT-FOUND                               16598699
165987              MOVE SPACES           TO ASTRNMO                    16598799
165988              MOVE PC-TSYMSG-00017  TO DP020-MSG-NUMBER           16598899
165989              PERFORM 3180-LOCATION-ERROR                         16598999
165990           ELSE                                                   16599099
165991              MOVE XST00001-LOC-NM TO ASC-LOC-NM                  16599199
165992              MOVE XST00020-DC-NBR TO ASC-DC-NBR                  16599299
165993           END-IF                                                 16599399
165994        END-IF                                                    16599499
165995     END-IF.                                                      16599599
165996                                                                  16599699
165997 3060-UPC-ERROR.                                                  16599799
165998                                                                  16599899
165999     INITIALIZE ASC-SPECIFIC-COMMAREA.                            16599999
166000     IF IQ016-STORE-NO = PC-CORPORATE-LOCATION                    16600099
166001         MOVE 0 TO ASC-LOCATION-NBR                               16600199
166002     ELSE                                                         16600299
166003         MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR                  16600399
166004     END-IF.                                                      16600499
166005     MOVE AUPC01O          TO ASC-UPC-NBR-01.                     16600599
166006     MOVE AUPC02O          TO ASC-UPC-NBR-02.                     16600699
166007     MOVE AUPC03O          TO ASC-UPC-NBR-03.                     16600799
166008     MOVE AUPC04O          TO ASC-UPC-NBR-04.                     16600899
166009     SET PS-ERROR                                                 16600999
166010         DP020-MSG-FATAL   TO TRUE.                               16601099
166011     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         16601199
166012                                                                  16601299
166013     MOVE DP015-RED        TO AUPC01C                             16601399
166014                              AUPC02C                             16601499
166015                              AUPC03C                             16601599
166016                              AUPC04C.                            16601699
166017     MOVE DP015-REVERSE    TO AUPC01H                             16601799
166018                              AUPC02H                             16601899
166019                              AUPC03H                             16601999
166020                              AUPC04H.                            16602099
166021     MOVE -1               TO AUPC01L.                            16602199
166022                                                                  16602299
166023 3070-SKU-ERROR.                                                  16602399
166024                                                                  16602499
166025     INITIALIZE ASC-SPECIFIC-COMMAREA.                            16602599
166026     IF IQ016-STORE-NO = PC-CORPORATE-LOCATION                    16602699
166027         MOVE 0 TO ASC-LOCATION-NBR                               16602799
166028     ELSE                                                         16602899
166029         MOVE IQ016-STORE-NO TO ASC-LOCATION-NBR                  16602999
166030     END-IF.                                                      16603099
166031     MOVE ASKUNBRO         TO ASC-SKU-NBR.                        16603199
166032     SET PS-ERROR                                                 16603299
166033         DP020-MSG-FATAL   TO TRUE.                               16603399
166034     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         16603499
166035                                                                  16603599
166036     MOVE DP015-RED        TO ASKUNBRC.                           16603699
166037     MOVE DP015-REVERSE    TO ASKUNBRH.                           16603799
166038     MOVE -1               TO ASKUNBRL.                           16603899
166039                                                                  16603999
166040 3180-LOCATION-ERROR.                                             16604099
166041                                                                  16604199
166042     SET PS-ERROR                                                 16604299
166043         DP020-MSG-FATAL   TO TRUE.                               16604399
166044     MOVE DP015-UNP-ALP-BRT-OFF                                   16604499
166045                           TO ASTRNBRA.                           16604599
166046     MOVE DP015-RED        TO ASTRNBRC.                           16604699
166047     MOVE DP015-REVERSE    TO ASTRNBRH.                           16604799
166048     MOVE -1               TO ASTRNBRL.                           16604899
166049     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         16604999
166050                                                                  16605099
166051****************************************************************  16605199
166052*    MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS     *  16605299
166053*    ON THE MAP.                                               *  16605399
166054****************************************************************  16605499
166055                                                                  16605599
166056 3200-RESET-ATTRIBUTES.                                           16605699
166057                                                                  16605799
166058     MOVE DP015-PRO-NOR-OFF        TO ADPTNBRA                    16605899
166059                                      AMAJCLSA                    16605999
166060                                      ASUBCLSA                    16606099
166062                                      ASTRNMA                     16606299
166063                                      ADESCA                      16606399
166064                                      ASIZEA                      16606499
166065                                      ACOLORA                     16606599
166066                                      ASTATUSA                    16606699
166067                                      ASTADSCA                    16606799
166068                                      AVNDNMA                     16606899
166069                                      ATKTCLRA                    16606999
166070                                      AVNDSTYA                    16607099
166071                                      ASTACHGA                    16607199
166072                                      ABOXIDA                     16607299
166073                                      ACURRTLA                    16607399
166074                                      APRCCHGA                    16607499
166075                                      AGRPRTLA                    16607599
166076                                      AORGRTLA                    16607699
166077                                      ALOWRTLA                    16607799
166078                                      AONQTYA                     16607899
166079                                      ASTROHA                     16607999
166080                                      ARCPDTEA                    16608099
166081                                      AONORDRA                    16608199
166082                                      AINTRANA                    16608299
166083                                      ASALDTEA                    16608399
166084                                      AUNLQTYA                    16608499
166085                                      ASTRUNLA                    16608599
166086                                      AUNLDSTA.                   16608699
166087     MOVE DP015-UNP-ALP-NOR-OFF    TO AUPC01A                     16608799
166088                                      AUPC02A                     16608899
166089                                      AUPC03A                     16608999
166090                                      AUPC04A                     16609099
166091                                      ASKUNBRA                    16609199
166092                                      ASTRNBRA.                   16609299
166093                                                                  16609399
166094     MOVE DP015-BLUE               TO ADPTNBRC                    16609499
166095                                      AMAJCLSC                    16609599
166096                                      ASUBCLSC                    16609699
166097                                      ASTRNMC                     16609799
166098                                      ADESCC                      16609899
166099                                      ASIZEC                      16609999
166100                                      ACOLORC                     16610099
166101                                      ASTATUSC                    16610199
166102                                      ASTADSCC                    16610299
166103                                      AVNDNMC                     16610399
166104                                      AVNDSTYC                    16610499
166105                                      ASTACHGC                    16610599
166106                                      ABOXIDC                     16610699
166107                                      ACURRTLC                    16610799
166108                                      AGRPRTLC                    16610899
166109                                      AORGRTLC                    16610999
166110                                      ALOWRTLC                    16611099
166111                                      AONQTYC                     16611199
166112                                      ASTROHC                     16611299
166113                                      ARCPDTEC                    16611399
166114                                      AONORDRC                    16611499
166115                                      AINTRANC                    16611599
166116                                      ASALDTEC                    16611699
166117                                      AUNLQTYC                    16611799
166118                                      ASTRUNLC.                   16611899
166119     MOVE DP015-GREEN              TO AUPC01C                     16611999
166120                                      AUPC02C                     16612099
166121                                      AUPC03C                     16612199
166122                                      AUPC04C                     16612299
166123                                      ASKUNBRC                    16612399
166124                                      ASTRNBRC.                   16612499
166125                                                                  16612599
166127                                                                  16612799
166128     MOVE DP015-UNDERLINE          TO AUPC01H                     16612899
166129                                      AUPC02H                     16612999
166130                                      AUPC03H                     16613099
166131                                      AUPC04H                     16613199
166132                                      ASKUNBRH                    16613299
166133                                      ASTRNBRH.                   16613399
166134                                                                  16613499
166135                                                                  16613599
166136*--------------------------------------------------------------*  16613699
166137*                                                              *  16613799
166138*                                                              *  16613899
166139*--------------------------------------------------------------*  16613999
166140 3480-VALIDATE-LOCATION.                                          16614099
166141                                                                  16614199
166142     EXEC SQL                                                     16614299
166143         SELECT  LOC.LOC_NBR                                      16614399
166144                ,LOC.LOC_TYP_CDE                                  16614499
166145                ,LOC.LOC_NM                                       16614599
166146                ,ASG.DC_NBR                                       16614699
166147           INTO  :XST00001-LOC-NBR                                16614799
166148                ,:XST00001-LOC-TYP-CDE                            16614899
166149                ,:XST00001-LOC-NM                                 16614999
166150                ,:XST00020-DC-NBR                                 16615099
166151           FROM  XST_LOC          LOC                             16615199
166160                ,XST_DC_LOC_ASGMT ASG                             16616099
166161          WHERE  LOC.LOC_NBR  = ASG.LOC_NBR                       16616199
166162            AND  LOC.LOC_NBR  = :DK-LOCATION-NBR                  16616299
166163            AND (LOC.OCPNC_DTE <= CURRENT DATE                    16616399
166164             OR  LOC.OCPNC_DTE IS NULL)                           16616499
166165            AND (LOC.CLO_DTE >= CURRENT DATE                      16616599
166166             OR  LOC.CLO_DTE IS NULL)                             16616699
166167            AND  ASG.EFF_BEG_DTE =                                16616799
166168                 (SELECT MAX(EFF_BEG_DTE)                         16616899
166169                    FROM XST_DC_LOC_ASGMT R                       16616999
166170                   WHERE R.LOC_NBR      = :DK-LOCATION-NBR        16617099
166171                     AND R.EFF_BEG_DTE <= CURRENT DATE)           16617199
166172           WITH  UR                                               16617299
166173     END-EXEC.                                                    16617399
166174                                                                  16617499
166175     EVALUATE SQLCODE                                             16617599
166176         WHEN +0                                                  16617699
166177              SET PS-LOCATION-FOUND     TO TRUE                   16617799
166178                                                                  16617899
166179         WHEN +100                                                16617999
166180              SET PS-LOCATION-NOT-FOUND TO TRUE                   16618099
166181                                                                  16618199
166182         WHEN OTHER                                               16618299
166183              MOVE '3480-VALIDATE-LOCATION' TO DP013-PARAGRAPH    16618399
166184              SET   DP013-DB2-ABEND                               16618499
166185                    DP013-XCTL-DISPLAY-RESTART TO TRUE            16618599
166186              MOVE  SQLCA            TO DP013-SQLCA               16618699
166187              MOVE  'XST_LOC'        TO DP013-DB2-TABLE-NAME (1)  16618799
166188              MOVE  'XST_DC_LOC_ASGMT'                            16618899
166189                                     TO DP013-DB2-TABLE-NAME (2)  16618999
166190              MOVE  DK-LOCATION-NBR  TO DK-LOC-NBR-PIC9           16619099
166191              STRING 'SELECT ON '                                 16619199
166192                      DP013-DB2-TABLE-NAME (1)                    16619299
166193                      DP013-DB2-TABLE-NAME (2)                    16619399
166194                     ' TABLE HAD BAD SQLCODE '                    16619499
166195                      DELIMITED BY SIZE                           16619599
166196                      INTO DP013-MESSAGE-TEXT (1)                 16619699
166197              STRING 'KEYS ARE - LOC - '                          16619799
166198                      DK-LOC-NBR-PIC9                             16619899
166199                      DELIMITED BY SIZE                           16619999
166200                      INTO DP013-MESSAGE-TEXT (2)                 16620099
166201              PERFORM DP013-0000-PROCESS-ABEND                    16620199
166202                                                                  16620299
166203     END-EVALUATE.                                                16620399
166204                                                                  16620499
166205                                                                  16620599
166206*--------------------------------------------------------------*  16620699
166207*   POSITION THE CURSOR AT THE APPROPRIATE FIELD.              *  16620799
166208*   IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL,     *  16620899
166209*   MOVE IT HERE.                                              *  16620999
166210*--------------------------------------------------------------*  16621099
166211 4000-BUILD-INITIAL-PANEL.                                        16621199
166212                                                                  16621299
166213     SET DP030-SET-CURSOR-APPL-1   TO TRUE                        16621399
166214     MOVE -1                       TO ACSRUPCL.                   16621499
166215                                                                  16621599
166216     MOVE DP015-UNP-ALP-NOR-OFF    TO AUPC01A                     16621699
166217                                      AUPC02A                     16621799
166218                                      AUPC03A                     16621899
166219                                      AUPC04A                     16621999
166220                                      ASKUNBRA.                   16622099
166221                                                                  16622199
166222     MOVE ASC-UPC-NBR              TO DK-UPC-NBR.                 16622299
166223     MOVE ASC-SKU-NBR              TO XST00010-SKU-NBR.           16622399
166224                                                                  16622499
166225     IF PS-NEW-UPC-FOUND OR PS-NEW-SKU-FOUND OR PS-FIRST-TIME     16622599
166226         IF ASC-UPC-NBR IS NUMERIC AND PS-NEW-UPC-FOUND           16622699
166227             PERFORM 4100-SELECT-UPC                              16622799
166228         ELSE                                                     16622899
166229             IF ASC-SKU-NBR IS NUMERIC AND PS-NEW-SKU-FOUND       16622999
166230                 PERFORM 4110-SELECT-SKU                          16623099
166231             ELSE                                                 16623199
166232                 IF PS-FIRST-TIME                                 16623299
166233                    IF ASC-UPC-NBR > ZEROS                        16623399
166234                        PERFORM 4100-SELECT-UPC                   16623499
166235                    ELSE                                          16623599
166236                        IF ASC-SKU-NBR > ZEROS                    16623699
166237                            PERFORM 4110-SELECT-SKU               16623799
166238                        END-IF                                    16623899
166239                    END-IF                                        16623999
166240                 END-IF                                           16624099
166241             END-IF                                               16624199
166242         END-IF                                                   16624299
166243         PERFORM 4300-MOVE-UPC-SKU-DATA                           16624399
166244     ELSE                                                         16624499
166245         PERFORM 4400-MOVE-MAP-DATA                               16624599
166246     END-IF.                                                      16624699
166247                                                                  16624799
166248*--------------------------------------------------------------*  16624899
166249*                                                              *  16624999
166250*--------------------------------------------------------------*  16625099
166251                                                                  16625199
166252 4100-SELECT-UPC.                                                 16625299
166253                                                                  16625399
166254     EXEC SQL                                                     16625499
166255         SELECT  UPC.UPC_NBR                                      16625599
166256                ,VNDSTYL.DEPT_NBR                                 16625699
166257                ,VNDSTYL.MAJ_CL_NBR                               16625799
166258                ,VNDSTYL.SUB_CL_NBR                               16625899
166259                ,VNDSTYL.STYL_ID                                  16625999
166260                ,VNDSTYL.VS_NBR                                   16626099
166261                ,VNDSTYL.LBL_NM                                   16626199
166262                ,VNDSTYL.STKR_NBR                                 16626299
166263                ,VNDSTYL.ENT_ID                                   16626399
166264                ,SKU.SIZE_DESC                                    16626499
166265                ,SKU.SKU_NBR                                      16626599
166266                ,SKU.SKU_DESC                                     16626699
166267                ,SKU.NRF_CLOR_DESC                                16626799
166268                ,SKU.INTR_UPC_ID                                  16626899
166269                ,SKU.REGN_PRIC_IND                                16626999
166270            INTO                                                  16627099
166271                 :XST00012-UPC-NBR                                16627199
166272                ,:XST00013-DEPT-NBR                               16627299
166273                ,:XST00013-MAJ-CL-NBR                             16627399
166274                ,:XST00013-SUB-CL-NBR                             16627499
166275                ,:XST00013-STYL-ID                                16627599
166276                ,:XST00013-VS-NBR                                 16627699
166277                ,:XST00013-LBL-NM                                 16627799
166278                ,:XST00013-STKR-NBR                               16627899
166279                ,:XST00013-ENT-ID                                 16627999
166280                ,:XST00010-SIZE-DESC                              16628099
166281                ,:XST00010-SKU-NBR                                16628199
166282                ,:XST00010-SKU-DESC                               16628299
166283                ,:XST00010-NRF-CLOR-DESC                          16628399
166284                ,:XST00010-INTR-UPC-ID                            16628499
166285                ,:XST00010-REGN-PRIC-IND                          16628599
166286           FROM  XST_VND_STYL  VNDSTYL                            16628699
166287                ,XST_SKU       SKU                                16628799
166288                ,XST_UPC       UPC                                16628899
166289          WHERE  UPC.UPC_NBR       = :DK-UPC-NBR                  16628999
166290            AND (UPC.UPC_TYP_CDE   = 'I'                          16629099
166291             OR  UPC.UPC_TYP_CDE   = 'V')                         16629199
166292            AND  UPC.LAST_ACTN_CDE <> 'D'                         16629299
166293            AND  UPC.INTR_UPC_ID   =  SKU.INTR_UPC_ID             16629399
166294            AND  SKU.STYL_ID       =  VNDSTYL.STYL_ID             16629499
166295           WITH  UR                                               16629599
166296                                                                  16629699
166297     END-EXEC.                                                    16629799
166298                                                                  16629899
166299     EVALUATE TRUE                                                16629999
166300       WHEN SQLCODE = ZERO                                        16630099
166301            SET PS-UPC-FOUND          TO TRUE                     16630199
166302            IF XST00013-LBL-NM = SPACES                           16630299
166303               PERFORM 4120-FIND-VENDOR-NAME                      16630399
166304            ELSE                                                  16630499
166305               MOVE XST00013-LBL-NM      TO PV-VENDOR-NAME        16630599
166306            END-IF                                                16630699
166307                                                                  16630799
166308       WHEN SQLCODE = +100                                        16630899
166309            SET PS-UPC-NOT-FOUND      TO TRUE                     16630999
166310                                                                  16631099
166311       WHEN OTHER                                                 16631199
166312            MOVE '4100-SELECT-UPC       ' TO DP013-PARAGRAPH      16631299
166313            MOVE SQLCA          TO DP013-SQLCA                    16631399
166314            MOVE 'XST_VND_STYL  ' TO DP013-DB2-TABLE-NAME (1)     16631499
166315            MOVE 'XST_SKU       ' TO DP013-DB2-TABLE-NAME (2)     16631599
166316            MOVE 'XST_UPC       ' TO DP013-DB2-TABLE-NAME (3)     16631699
166317            STRING 'SELECT ON '                                   16631799
166318                    DP013-DB2-TABLE-NAME (1)                      16631899
166319                    DP013-DB2-TABLE-NAME (2)                      16631999
166320                    DP013-DB2-TABLE-NAME (3)                      16632099
166321                   ' HAD BAD SQLCODE'                             16632199
166322                    DELIMITED BY SIZE                             16632299
166323                    INTO DP013-MESSAGE-TEXT (1)                   16632399
166324            MOVE DK-UPC-NBR TO DK-UPC-NBR-PIC9                    16632499
166325            STRING 'KEYS ARE - UPC - '                            16632599
166326                    DK-UPC-NBR-PIC9                               16632699
166327                    DELIMITED BY SIZE                             16632799
166328                    INTO DP013-MESSAGE-TEXT (2)                   16632899
166329            SET DP013-DB2-ABEND TO TRUE                           16632999
166330            PERFORM DP013-0000-PROCESS-ABEND                      16633099
166331                                                                  16633199
166332     END-EVALUATE.                                                16633299
166333                                                                  16633399
166334*--------------------------------------------------------------*  16633499
166335*                                                              *  16633599
166336*--------------------------------------------------------------*  16633699
166337                                                                  16633799
166338 4110-SELECT-SKU.                                                 16633899
166339                                                                  16633999
166340     EXEC SQL                                                     16634099
166341         SELECT  UPC.UPC_NBR                                      16634199
166342                ,VNDSTYL.DEPT_NBR                                 16634299
166343                ,VNDSTYL.MAJ_CL_NBR                               16634399
166344                ,VNDSTYL.SUB_CL_NBR                               16634499
166345                ,VNDSTYL.STYL_ID                                  16634599
166346                ,VNDSTYL.VS_NBR                                   16634699
166347                ,VNDSTYL.LBL_NM                                   16634799
166348                ,VNDSTYL.STKR_NBR                                 16634899
166349                ,VNDSTYL.ENT_ID                                   16634999
166350                ,SKU.SIZE_DESC                                    16635099
166351                ,SKU.SKU_NBR                                      16635199
166352                ,SKU.SKU_DESC                                     16635299
166353                ,SKU.NRF_CLOR_DESC                                16635399
166354                ,SKU.INTR_UPC_ID                                  16635499
166355                ,SKU.REGN_PRIC_IND                                16635599
166356            INTO                                                  16635699
166357                 :XST00012-UPC-NBR                                16635799
166358                ,:XST00013-DEPT-NBR                               16635899
166359                ,:XST00013-MAJ-CL-NBR                             16635999
166360                ,:XST00013-SUB-CL-NBR                             16636099
166361                ,:XST00013-STYL-ID                                16636199
166362                ,:XST00013-VS-NBR                                 16636299
166363                ,:XST00013-LBL-NM                                 16636399
166364                ,:XST00013-STKR-NBR                               16636499
166365                ,:XST00013-ENT-ID                                 16636599
166366                ,:XST00010-SIZE-DESC                              16636699
166367                ,:XST00010-SKU-NBR                                16636799
166368                ,:XST00010-SKU-DESC                               16636899
166369                ,:XST00010-NRF-CLOR-DESC                          16636999
166370                ,:XST00010-INTR-UPC-ID                            16637099
166371                ,:XST00010-REGN-PRIC-IND                          16637199
166372           FROM  XST_VND_STYL  VNDSTYL                            16637299
166373                ,XST_SKU       SKU                                16637399
166374                ,XST_UPC       UPC                                16637499
166375          WHERE  VNDSTYL.STYL_ID   =  SKU.STYL_ID                 16637599
166376            AND  SKU.INTR_UPC_ID   =  UPC.INTR_UPC_ID             16637699
166377            AND  SKU.SKU_NBR       = :XST00010-SKU-NBR            16637799
166378            AND  UPC.UPC_TYP_CDE   = 'I'                          16637899
166379           WITH  UR                                               16637999
166380     END-EXEC.                                                    16638099
166381                                                                  16638199
166382     EVALUATE TRUE                                                16638299
166383       WHEN SQLCODE = ZERO                                        16638399
166384            SET PS-SKU-FOUND          TO TRUE                     16638499
166385            IF XST00013-LBL-NM = SPACES                           16638599
166386               PERFORM 4120-FIND-VENDOR-NAME                      16638699
166387            ELSE                                                  16638799
166388               MOVE XST00013-LBL-NM      TO PV-VENDOR-NAME        16638899
166389            END-IF                                                16638999
166390                                                                  16639099
166391       WHEN SQLCODE = +100                                        16639199
166392            SET PS-SKU-NOT-FOUND      TO TRUE                     16639299
166393                                                                  16639399
166394       WHEN OTHER                                                 16639499
166395            MOVE '4110-SELECT-SKU       ' TO DP013-PARAGRAPH      16639599
166396            MOVE SQLCA          TO DP013-SQLCA                    16639699
166397            MOVE 'XST_VND_STYL  ' TO DP013-DB2-TABLE-NAME (1)     16639799
166398            MOVE 'XST_SKU       ' TO DP013-DB2-TABLE-NAME (2)     16639899
166399            MOVE 'XST_UPC       ' TO DP013-DB2-TABLE-NAME (3)     16639999
166400            STRING 'SELECT ON '                                   16640099
166401                    DP013-DB2-TABLE-NAME (1)                      16640199
166402                    DP013-DB2-TABLE-NAME (2)                      16640299
166403                    DP013-DB2-TABLE-NAME (3)                      16640399
166404                   ' HAD BAD SQLCODE'                             16640499
166405                    DELIMITED BY SIZE                             16640599
166406                    INTO DP013-MESSAGE-TEXT (1)                   16640699
166407            STRING 'KEYS ARE - UPC - '                            16640799
166408                    DK-SKU-NBR                                    16640899
166409                    DELIMITED BY SIZE                             16640999
166410                    INTO DP013-MESSAGE-TEXT (2)                   16641099
166411            SET DP013-DB2-ABEND TO TRUE                           16641199
166412            PERFORM DP013-0000-PROCESS-ABEND                      16641299
166413                                                                  16641399
166414     END-EVALUATE.                                                16641499
166415                                                                  16641599
166416*--------------------------------------------------------------*  16641699
166417*                                                              *  16641799
166418*--------------------------------------------------------------*  16641899
166419                                                                  16641999
166420 4120-FIND-VENDOR-NAME.                                           16642099
166421                                                                  16642199
166422     EXEC SQL                                                     16642299
166423         SELECT                                                   16642399
166424                 VND.ENT_NM_DESC                                  16642499
166425                                                                  16642599
166426            INTO                                                  16642699
166427                 :XST00018-ENT-NM-DESC                            16642799
166428                                                                  16642899
166429           FROM  XST_VND       VND                                16642999
166430                                                                  16643099
166431          WHERE  VND.ENT_ID = :XST00013-ENT-ID                    16643199
166432                                                                  16643299
166433     END-EXEC.                                                    16643399
166434                                                                  16643499
166435     EVALUATE TRUE                                                16643599
166436       WHEN SQLCODE = ZERO                                        16643699
166437            IF XST00018-ENT-NM-DESC = SPACES                      16643799
166438               MOVE 'NO VENDOR NAME' TO PV-VENDOR-NAME            16643899
166439            ELSE                                                  16643999
166440               MOVE XST00018-ENT-NM-DESC TO PV-VENDOR-NAME        16644099
166441            END-IF                                                16644199
166442                                                                  16644299
166443       WHEN SQLCODE = +100                                        16644399
166444            MOVE 'NO VENDOR NAME' TO PV-VENDOR-NAME               16644499
166445                                                                  16644599
166446       WHEN OTHER                                                 16644699
166447            MOVE '4120-FIND-VENDOR-NAME ' TO DP013-PARAGRAPH      16644799
166448            MOVE SQLCA          TO DP013-SQLCA                    16644899
166449            MOVE 'XST_VND       ' TO DP013-DB2-TABLE-NAME (1)     16644999
166450            STRING 'SELECT ON '                                   16645099
166451                    DP013-DB2-TABLE-NAME (1)                      16645199
166452                   ' HAD BAD SQLCODE'                             16645299
166453                    DELIMITED BY SIZE                             16645399
166454                    INTO DP013-MESSAGE-TEXT (1)                   16645499
166455            MOVE XST00013-ENT-ID TO DK-ENT-ID-PIC9                16645599
166456            STRING 'KEYS ARE - ENT ID - '                         16645699
166457                    DK-ENT-ID-PIC9                                16645799
166458                    DELIMITED BY SIZE                             16645899
166459                    INTO DP013-MESSAGE-TEXT (2)                   16645999
166460            SET DP013-DB2-ABEND TO TRUE                           16646099
166461            PERFORM DP013-0000-PROCESS-ABEND                      16646199
166462                                                                  16646299
166463     END-EVALUATE.                                                16646399
166464                                                                  16646499
166465                                                                  16646599
166466                                                                  16646699
166467*--------------------------------------------------------------*  16646799
166468*    ORIGINAL RETAIL AND LOWEST RETAIL ARE RETRIEVED BY USING  *  16646899
166469*        XMKCS002.                                             *  16646999
166470*                                                              *  16647099
166471*    IF THE REGION PRICE INDICATOR IS SET TO "Y"               *  16647199
166472*       TRY TO READ THE XST_SKU_LOC ROW FOR THAT SPECIFIC      *  16647299
166473*       STORE.  IF IT IS FOUND, THAT'S THE CURRENT RETAIL TO   *  16647399
166474*       DISPLAY ON THE SCREEN.  IF IT ISN'T FOUND, READ THE    *  16647499
166475*       ROW FOR STORE 0 AND DISPLAY THAT PRICE FOR CURRENT     *  16647599
166476*       RETAIL.                                                *  16647699
166477*    ELSE                                                      *  16647799
166478*       READ THE ROW FOR STORE 0 AND DISPLAY THAT PRICE FOR    *  16647899
166479*       THE CURRENT RETAIL.                                    *  16647999
166480*                                                              *  16648099
166481*--------------------------------------------------------------*  16648199
166482 4200-FIND-CURRENT-RETAIL.                                        16648299
166483                                                                  16648399
166484     MOVE XST00010-INTR-UPC-ID TO PV-INTR-UPC-ID.                 16648499
166485                                                                  16648599
166486     IF (ASC-LOCATION-NBR IS NOT NUMERIC) AND                     16648699
166487      (XST00010-REGN-PRIC-IND = 'Y')                              16648799
166488        MOVE PC-TSYMSG-00334  TO DP020-MSG-NUMBER                 16648899
166489        PERFORM 3180-LOCATION-ERROR                               16648999
166490     ELSE                                                         16649099
166491     IF XST00010-REGN-PRIC-IND = 'Y'                              16649199
166492        MOVE ASC-LOCATION-NBR TO PV-STORE-NUMBER                  16649299
166493                                                                  16649399
166494        PERFORM 4220-SELECT-CURRENT-RETAIL                        16649499
166495        IF PS-CURRENT-RETAIL-FOUND                                16649599
166496           IF ASC-LOCATION-NBR NOT = PC-CORPORATE-LOCATION        16649699
166497              AND PV-STATUS-CODE = PC-STATUS-25                   16649799
166498                MOVE '20' TO  PV-STATUS-CODE                      16649899
166499           END-IF                                                 16649999
166500        ELSE                                                      16650099
166501           MOVE 0 TO PV-STORE-NUMBER                              16650199
166502           PERFORM 4220-SELECT-CURRENT-RETAIL                     16650299
166503           IF ASC-LOCATION-NBR NOT = PC-CORPORATE-LOCATION        16650399
166504              AND PV-STATUS-CODE = PC-STATUS-25                   16650499
166505                MOVE '20' TO  PV-STATUS-CODE                      16650599
166506           END-IF                                                 16650699
166507        END-IF                                                    16650799
166508     ELSE                                                         16650899
166509        MOVE 0 TO PV-STORE-NUMBER                                 16650999
166510        PERFORM 4220-SELECT-CURRENT-RETAIL                        16651099
166511     END-IF                                                       16651199
166512     END-IF.                                                      16651299
166513                                                                  16651399
166514*--------------------------------------------------------------*  16651499
166515*    NOTE: STORE 0 IS ALWAYS PRESENT FOR ALL UPCS.             *  16651599
166516*          THERE MAY BE OR MAY NOT BE ROWS FOR STORES FOR A    *  16651699
166517*          SPECIFIC UPC.                                       *  16651799
166518*                                                              *  16651899
166519*--------------------------------------------------------------*  16651999
166520 4220-SELECT-CURRENT-RETAIL.                                      16652099
166521                                                                  16652199
166522     MOVE SPACES TO XST00008-UNT-RTL-CHG-DTE                      16652299
166523                    XST00008-UPC-STAT-CHG-DTE.                    16652399
166524                                                                  16652499
166525     EXEC SQL                                                     16652599
166526        SELECT LOC_SKU_STAT_CDE                                   16652699
166527              ,UNT_RTL_AMT                                        16652799
166528              ,UNT_RTL_CHG_DTE                                    16652899
166529              ,UPC_STAT_CHG_DTE                                   16652999
166530              ,GP_RTL_AMT                                         16653099
166531              ,BEG_TMST                                           16653199
166532          INTO :XST00008-LOC-SKU-STAT-CDE                         16653299
166533              ,:XST00008-UNT-RTL-AMT                              16653399
166534              ,:XST00008-UNT-RTL-CHG-DTE                          16653499
166535              ,:XST00008-UPC-STAT-CHG-DTE                         16653599
166536              ,:XST00008-GP-RTL-AMT  :PV-GP-RTL-AMT-NULL          16653699
166537              ,:XST00008-BEG-TMST                                 16653799
166538          FROM XST_SKU_LOC                                        16653899
166539         WHERE INTR_UPC_ID = :PV-INTR-UPC-ID                      16653999
166540           AND LOC_NBR     = :PV-STORE-NUMBER                     16654099
166541           AND ((BEG_TMST <= CURRENT TIMESTAMP                    16654199
166542           AND   END_TMST >= CURRENT TIMESTAMP)                   16654299
166543            OR  (BEG_TMST <= CURRENT TIMESTAMP                    16654399
166544           AND   END_TMST IS NULL))                               16654499
166545     END-EXEC                                                     16654599
166546                                                                  16654699
166547     EVALUATE TRUE                                                16654799
166548         WHEN SQLCODE = ZERO                                      16654899
166549              SET PS-CURRENT-RETAIL-FOUND TO TRUE                 16654999
166550              MOVE XST00008-LOC-SKU-STAT-CDE                      16655099
166551                                    TO PV-STATUS-CODE             16655199
166552              MOVE XST00008-UNT-RTL-AMT                           16655299
166553                                     TO PV-UNT-RTL-AMT            16655399
166554              IF PV-GP-RTL-AMT-NULL = -1                          16655499
166555                 MOVE 0 TO PV-GP-RTL-AMT                          16655599
166556              ELSE                                                16655699
166557                 MOVE XST00008-GP-RTL-AMT TO PV-GP-RTL-AMT        16655799
166558              END-IF                                              16655899
166559                                                                  16655999
166560         WHEN SQLCODE = +100                                      16656099
166561              SET PS-CURRENT-RETAIL-NOT-FOUND TO TRUE             16656199
166562              MOVE 0 TO PV-UNT-RTL-AMT                            16656299
166563                        PV-GP-RTL-AMT                             16656399
166564                                                                  16656499
166565         WHEN OTHER                                               16656599
166566              MOVE '4220-SELECT-CURRENT-RETAIL' TO                16656699
166567                                        DP013-PARAGRAPH           16656799
166568              SET  DP013-DB2-ABEND                                16656899
166569                   DP013-XCTL-DISPLAY-RESTART TO TRUE             16656999
166570              MOVE SQLCA            TO DP013-SQLCA                16657099
166571              MOVE 'XST_SKU_LOC  ' TO DP013-DB2-TABLE-NAME (1)    16657199
166572              STRING 'SELECT STATUS FROM '                        16657299
166573                      DP013-DB2-TABLE-NAME (1)                    16657399
166574                     ' TABLE HAD BAD SQLCODE '                    16657499
166575                     ' - '                                        16657599
166576                      DELIMITED BY SIZE                           16657699
166577                      INTO DP013-MESSAGE-TEXT (1)                 16657799
166578              MOVE PV-INTR-UPC-ID  TO DK-INTR-UPC-ID-PIC9         16657899
166579              MOVE PV-STORE-NUMBER TO DK-STORE-NBR-PIC9           16657999
166580              STRING 'KEYS ARE - INTR UPC ID - '                  16658099
166581                      DK-INTR-UPC-ID-PIC9                         16658199
166582                     ' STORE NBR - '                              16658299
166583                      DK-STORE-NBR-PIC9                           16658399
166584                      DELIMITED BY SIZE                           16658499
166585                      INTO DP013-MESSAGE-TEXT (2)                 16658599
166586              PERFORM DP013-0000-PROCESS-ABEND                    16658699
166587                                                                  16658799
166588     END-EVALUATE.                                                16658899
166589                                                                  16658999
166590*----------------------------------------------------------------*16659099
166591*                                                                 16659199
166592*----------------------------------------------------------------*16659299
166593 4300-MOVE-UPC-SKU-DATA.                                          16659399
166594                                                                  16659499
166595     SET ASC-NO-DATA-MOVED          TO TRUE.                      16659599
166596     IF PS-UPC-FOUND OR PS-SKU-FOUND                              16659699
166597        SET ASC-DATA-MOVED          TO TRUE                       16659799
166598        MOVE XST00012-UPC-NBR       TO ASC-UPC-NBR                16659899
166599        MOVE XST00013-DEPT-NBR      TO ASC-DEPT-NBR               16659999
166600        MOVE XST00013-MAJ-CL-NBR    TO ASC-MAJ-CL-NBR             16660099
166601        MOVE XST00013-SUB-CL-NBR    TO ASC-SUB-CL-NBR             16660199
166602        MOVE XST00010-SIZE-DESC     TO ASC-SIZE-DESC              16660299
166603        MOVE XST00010-NRF-CLOR-DESC TO ASC-COLOR-DESC             16660399
166604        MOVE XST00010-SKU-DESC      TO ASC-SKU-DESC               16660499
166605        MOVE XST00010-SKU-NBR       TO ASC-SKU-NBR                16660599
166606        MOVE XST00010-INTR-UPC-ID   TO ASC-INTR-UPC-ID            16660699
166607                                                                  16660799
166608        MOVE PV-VENDOR-NAME         TO ASC-VENDOR-NAME            16660899
166609                                                                  16660999
166610        MOVE XST00013-VS-NBR        TO ASC-VS-NBR                 16661099
166611        MOVE XST00013-STKR-NBR      TO ASC-STKR-NBR               16661199
166612                                                                  16661299
166613                                                                  16661399
166614        PERFORM 7200-CALL-XMKCS004                                16661499
166615                                                                  16661599
166616        PERFORM 4200-FIND-CURRENT-RETAIL                          16661699
166617                                                                  16661799
166618        MOVE PV-STATUS-CODE         TO ASC-STATUS                 16661899
166619                                                                  16661999
166620        MOVE PV-UNT-RTL-AMT   TO ASC-RETAIL-PRICE                 16662099
166621                                                                  16662199
166622        MOVE PV-GP-RTL-AMT     TO ASC-GP-RTL-AMT                  16662299
166623        MOVE PV-ORIG-RTL-AMT   TO ASC-ORIG-RTL-AMT                16662399
166624        MOVE PV-LOW-RTL-AMT    TO ASC-LOW-RTL-AMT                 16662499
166625                                                                  16662599
166626        PERFORM 4500-FORMAT-TICKET-COLOR                          16662699
166627                                                                  16662799
166628*       *------------------------------------------------------*  16662899
166629*       *  IF THE SETUP IS EQUAL TO THE UNIT RETAIL CHANGE     *  16662999
166630*       *  DATE AND UPC STATUS CHANGE DATE, THERE HAVEN'T BEEN *  16663099
166631*       *  ANY PRICE CHANGES SO DISPLAY ALL ZEROS.             *  16663199
166632*       *                                                      *  16663299
166633*       *------------------------------------------------------*  16663399
166634        IF PV-SETUP-DATE =  XST00008-UNT-RTL-CHG-DTE AND          16663499
166635           PV-SETUP-DATE =  XST00008-UPC-STAT-CHG-DTE             16663599
166636           MOVE PC-DEFAULT-DATE-0  TO ASC-UNT-RTL-CHG-DTE         16663699
166637                                      ASC-UPC-STAT-CHG-DTE        16663799
166638        ELSE                                                      16663899
166639           MOVE XST00008-UNT-RTL-CHG-DTE  TO ASC-UNT-RTL-CHG-DTE  16663999
166640           MOVE XST00008-UPC-STAT-CHG-DTE TO ASC-UPC-STAT-CHG-DTE 16664099
166641        END-IF                                                    16664199
166642                                                                  16664299
166643*--------------------------------------------------------------*  16664399
166644*       WHEN FIRST READING A UPC, ALWAY CLEAR THE FIELDS       *  16664499
166645*            POPULATED BY F14.                                 *  16664599
166646*--------------------------------------------------------------*  16664699
166647        MOVE 0 TO PV-WORK-QTY-Z                                   16664799
166648        MOVE PV-WORK-QTY-X  TO ASC-ON-HAND                        16664899
166649                               ASC-ON-ORDER                       16664999
166650                               ASC-STORE-ON-HAND                  16665099
166651                               ASC-IN-TRANSIT-QTY                 16665199
166652                               ASC-LAST-UNLD-QTY                  16665299
166653        MOVE SPACES         TO ASC-LAST-RCVD-DATE                 16665399
166654                               ASC-LAST-SALE-DATE                 16665499
166655                               ASC-LAST-UNLD-DATE                 16665599
166656                               ASC-STR-UNLOAD-SW                  16665699
166657                                                                  16665799
166658        IF ASC-LOCATION-NBR-X IS NOT NUMERIC                      16665899
166659           MOVE PC-TSYMSG-00334  TO DP020-MSG-NUMBER              16665999
166660           PERFORM 3180-LOCATION-ERROR                            16666099
166661         ELSE                                                     16666199
166662           MOVE ASC-LOCATION-NBR TO DK-LOCATION-NBR               16666299
166663           PERFORM 3480-VALIDATE-LOCATION                         16666399
166664        END-IF                                                    16666499
166665        IF PS-LOCATION-NOT-FOUND                                  16666599
166666           MOVE SPACES TO ASC-LOC-NM                              16666699
166667           MOVE ZEROES TO ASC-DC-NBR                              16666799
166668        ELSE                                                      16666899
166669           MOVE XST00001-LOC-NM TO ASC-LOC-NM                     16666999
166670           MOVE XST00020-DC-NBR TO ASC-DC-NBR                     16667099
166671        END-IF                                                    16667199
166672     END-IF.                                                      16667299
166673                                                                  16667399
166674     PERFORM 4400-MOVE-MAP-DATA.                                  16667499
166675                                                                  16667599
166676*----------------------------------------------------------------*16667699
166677*                                                                 16667799
166678*----------------------------------------------------------------*16667899
166679 4400-MOVE-MAP-DATA.                                              16667999
166680                                                                  16668099
166681     IF ASC-DATA-MOVED                                            16668199
166682         MOVE ASC-UPC-NBR-01         TO AUPC01O                   16668299
166683         MOVE ASC-UPC-NBR-02         TO AUPC02O                   16668399
166684         MOVE ASC-UPC-NBR-03         TO AUPC03O                   16668499
166685         MOVE ASC-UPC-NBR-04         TO AUPC04O                   16668599
166686                                                                  16668699
176513         MOVE ASC-DEPT-NBR           TO ADPTNBRO                  17651399
176514         MOVE ASC-MAJ-CL-NBR         TO AMAJCLSO                  17651499
176515         MOVE ASC-SUB-CL-NBR         TO ASUBCLSO                  17651599
176516         MOVE ASC-SKU-NBR-8          TO ASKUNBRO                  17651699
176517         MOVE ASC-SKU-DESC           TO ADESCO                    17651799
176518         MOVE ASC-SIZE-DESC          TO ASIZEO                    17651899
176519         MOVE ASC-COLOR-DESC         TO ACOLORO                   17651999
176520                                                                  17652099
176521         MOVE ASC-VENDOR-NAME        TO AVNDNMO                   17652199
176522                                                                  17652299
176523         MOVE ASC-VS-NBR             TO AVNDSTYO                  17652399
176524         MOVE ASC-STKR-NBR           TO PV-STKR-ID-9              17652499
176525         MOVE PV-STKR-ID-9           TO PV-STKR-ID                17652599
176526         MOVE PV-STKR-ID             TO ABOXIDO                   17652699
176527                                                                  17652799
176528         MOVE ASC-STATUS             TO ASTATUSO                  17652899
176529                                                                  17652999
176530         MOVE ASC-RETAIL-PRICE       TO ACURRTLO                  17653099
176531                                                                  17653199
176532         MOVE ASC-GP-RTL-AMT         TO AGRPRTLO                  17653299
176533         MOVE ASC-ORIG-RTL-AMT       TO AORGRTLO                  17653399
176534         MOVE ASC-LOW-RTL-AMT        TO ALOWRTLO                  17653499
176535                                                                  17653599
176536         MOVE ASC-UNT-RTL-CHG-DTE    TO APRCCHGO                  17653699
176537         MOVE ASC-UPC-STAT-CHG-DTE   TO ASTACHGO                  17653799
176538                                                                  17653899
176539         MOVE ASC-LOCATION-NBR       TO ASTRNBRO                  17653999
176540         MOVE ASC-LOC-NM             TO ASTRNMO                   17654099
176541                                                                  17654199
176542         MOVE ASC-ON-HAND            TO AONQTYO                   17654299
176543         MOVE ASC-ON-ORDER           TO AONORDRO                  17654399
176544         MOVE ASC-STORE-ON-HAND      TO ASTROHO                   17654499
176545         MOVE ASC-IN-TRANSIT-QTY     TO AINTRANO                  17654599
176546         MOVE ASC-LAST-RCVD-DATE     TO ARCPDTEO                  17654699
176547         MOVE ASC-LAST-SALE-DATE     TO ASALDTEO                  17654799
176548**GB TEST                                                         17654899
176549         MOVE ASC-LAST-UNLD-QTY      TO AUNLQTYO                  17654999
176550         MOVE ASC-LAST-UNLD-DATE     TO ASTRUNLO                  17655099
176551                                                                  17655199
176552         IF ASC-STR-UNLOAD-SCAN                                   17655299
176553            MOVE 'LAST UNLD SCANNED:'   TO AUNLDSTO               17655399
176554         ELSE                                                     17655499
176555            IF ASC-STR-UNLOAD-ASSM                                17655599
176556               MOVE 'LAST UNLD ASSUMPT:'   TO AUNLDSTO            17655699
176557            ELSE                                                  17655799
176558                MOVE 'LAST UNLOAD......:'  TO AUNLDSTO            17655899
176559            END-IF                                                17655999
176560         END-IF                                                   17656099
176561**GB TEST                                                         17656199
176562         EVALUATE ASC-STATUS                                      17656299
176563             WHEN '10'                                            17656399
176564                  MOVE 'NEW   '          TO ASTADSCO              17656499
176565             WHEN '20'                                            17656599
176566                  MOVE 'ACTIVE'          TO ASTADSCO              17656699
176567             WHEN '25'                                            17656799
176568                  MOVE 'MIXED'           TO ASTADSCO              17656899
176569             WHEN '30'                                            17656999
176570                  MOVE 'CLEAR '          TO ASTADSCO              17657099
176571             WHEN '40'                                            17657199
176572                  MOVE 'PROMO '          TO ASTADSCO              17657299
176573             WHEN '90'                                            17657399
176574                  MOVE 'DISCON'          TO ASTADSCO              17657499
176575             WHEN '98'                                            17657599
176576                  MOVE 'RENUM '          TO ASTADSCO              17657699
176577             WHEN OTHER                                           17657799
176578                  MOVE 'UNKNWN'          TO ASTADSCO              17657899
176579         END-EVALUATE                                             17657999
176580     ELSE                                                         17658099
176581         PERFORM 4450-CLEAR-FIELDS                                17658199
176582         IF ASC-UPC-NBR IS NOT NUMERIC                            17658299
176583             MOVE ASC-UPC-NBR-01           TO AUPC01O             17658399
176584             MOVE ASC-UPC-NBR-02           TO AUPC02O             17658499
176585             MOVE ASC-UPC-NBR-03           TO AUPC03O             17658599
176586             MOVE ASC-UPC-NBR-04           TO AUPC04O             17658699
176587             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            17658799
176588             PERFORM 3060-UPC-ERROR                               17658899
176589         ELSE                                                     17658999
176590         IF ASC-UPC-NBR > ZEROS AND PS-NEW-UPC-FOUND              17659099
176591             MOVE ASC-UPC-NBR-01           TO AUPC01O             17659199
176592             MOVE ASC-UPC-NBR-02           TO AUPC02O             17659299
176593             MOVE ASC-UPC-NBR-03           TO AUPC03O             17659399
176594             MOVE ASC-UPC-NBR-04           TO AUPC04O             17659499
176595             MOVE PC-TSYMSG-00100  TO DP020-MSG-NUMBER            17659599
176596             PERFORM 3060-UPC-ERROR                               17659699
176597         ELSE                                                     17659799
176598             IF ASC-SKU-NBR IS NUMERIC AND PS-NEW-SKU-FOUND       17659899
176599                 MOVE ZEROS                    TO ASC-UPC-NBR     17659999
176600                 MOVE ASC-SKU-NBR-8            TO ASKUNBRO        17660099
176601                 MOVE PC-TSYMSG-00073  TO DP020-MSG-NUMBER        17660199
176602                 PERFORM 3070-SKU-ERROR                           17660299
176603             ELSE                                                 17660399
176604                     IF ASC-SKU-NBR IS NOT NUMERIC                17660499
176605                        MOVE ASC-SKU-NBR-8    TO ASKUNBRO         17660599
176606                        MOVE PC-TSYMSG-00695  TO DP020-MSG-NUMBER 17660699
176607                        PERFORM 3070-SKU-ERROR                    17660799
176608                     END-IF                                       17660899
176609             END-IF                                               17660999
176610         END-IF                                                   17661099
176611      END-IF                                                      17661199
176612     END-IF.                                                      17661299
176613                                                                  17661399
185572                                                                  18557299
185573****************************************************************  18557399
185574* CLEAR SCREEN FIELDS WHEN THERE IS AN ERROR                   *  18557499
185575****************************************************************  18557599
185576 4450-CLEAR-FIELDS.                                               18557699
185577                                                                  18557799
185578     INITIALIZE AUPC01O                                           18557899
185579                AUPC02O                                           18557999
185580                AUPC03O                                           18558099
185581                AUPC04O                                           18558199
185583                ADPTNBRO                                          18558399
185584                AMAJCLSO                                          18558499
185585                ASUBCLSO                                          18558599
185586                ASKUNBRO                                          18558699
185587                ADESCO                                            18558799
185588                ASIZEO                                            18558899
185589                ACOLORO                                           18558999
185590                ATKTCLRO                                          18559099
185591                AVNDNMO                                           18559199
185592                AVNDSTYO                                          18559299
185593                ABOXIDO                                           18559399
185594                ASTATUSO                                          18559499
185595                ACURRTLI                                          18559599
185596                AGRPRTLI                                          18559699
185597                AORGRTLI                                          18559799
185598                ALOWRTLI                                          18559899
185599                APRCCHGO                                          18559999
185600                ASTACHGO                                          18560099
185601                ASTRNBRO                                          18560199
185602                ASTRNMO                                           18560299
185603                AONQTYO                                           18560399
185604                AONORDRO                                          18560499
185605                ASTROHO                                           18560599
185606                AINTRANO                                          18560699
185607                ARCPDTEO                                          18560799
185608                ASALDTEO                                          18560899
185609                ASTADSCO                                          18560999
185610                AUNLQTYO                                          18561099
185611                ASTRUNLO                                          18561199
185612                AUNLDSTO.                                         18561299
185613                                                                  18561399
185614*--------------------------------------------------------------*  18561499
185615*    THE TICKET COLOR IS ALWAYS WHITE FOR ANY STATUS OTHER     *  18561599
185616*        THAN '30' CLEARANCE.                                  *  18561699
185617*                                                              *  18561799
185618*    FOR CLEARANCE ITEMS ("30"), WHEN THE STATUS CHANGE DATE   *  18561899
185619*        AND THE PRICE CHANGE DATE AREN'T EQUAL, THIS          *  18561999
185620*        INDICATES A CONTINUOUS MARKDOWN.  THIS HELPS IDENTIFY *  18562099
185621*        SKUS THAT SHOULD HAVE RED TICKETS.                    *  18562199
185622*                                                              *  18562299
185623*--------------------------------------------------------------*  18562399
185624                                                                  18562499
185625 4500-FORMAT-TICKET-COLOR.                                        18562599
185626                                                                  18562699
185627     EVALUATE PV-STATUS-CODE                                      18562799
185628         WHEN '30'                                                18562899
185629              IF XST00008-UNT-RTL-CHG-DTE >                       18562999
185630                                XST00008-UPC-STAT-CHG-DTE         18563099
185631                 MOVE PC-RED    TO ATKTCLRO                       18563199
185632                 MOVE DP015-RED TO ATKTCLRC                       18563299
185633              ELSE                                                18563399
185634                 MOVE PC-YELLOW    TO ATKTCLRO                    18563499
185635                 MOVE DP015-YELLOW TO ATKTCLRC                    18563599
185636              END-IF                                              18563699
185637                                                                  18563799
185638         WHEN OTHER                                               18563899
185639              MOVE PC-WHITE    TO ATKTCLRO                        18563999
185640              MOVE DP015-WHITE TO ATKTCLRC                        18564099
185641                                                                  18564199
185642     END-EVALUATE.                                                18564299
185643                                                                  18564399
187445*--------------------------------------------------------------*  18744599
187446*    XMKCS001 RETRIEVES THE ON HAND, ON ORDER QUANTITIES,      *  18744699
187447*        LAST RECEIVED DATE AND LAST SALE DATE.                *  18744799
187448*                                                              *  18744899
187449*--------------------------------------------------------------*  18744999
187450                                                                  18745099
187451 7000-CALL-XMKCS001.                                              18745199
187460                                                                  18746099
187470     INITIALIZE XM003-ITEM-COMMAREA.                              18747099
187480     SET XM003-ONORDER-YES TO TRUE.                               18748099
187490     SET XM003-ONHAND-YES  TO TRUE.                               18749099
187500                                                                  18750099
187600     MOVE ASC-LOCATION-NBR TO XM003-KEY-STR-NBR.                  18760099
187700     MOVE ASC-SKU-NBR TO XM003-KEY-SKU.                           18770099
187800     MOVE LENGTH OF XM003-ITEM-COMMAREA TO PV-COMMAREA-LENGTH.    18780099
187900                                                                  18790099
188000     EXEC CICS                                                    18800099
188100          LINK                                                    18810099
188200               PROGRAM (PC-XMKCS001)                              18820099
188300              COMMAREA (XM003-ITEM-COMMAREA)                      18830099
188400                LENGTH (PV-COMMAREA-LENGTH)                       18840099
188500                  RESP (PV-CICS-RESPONSE)                         18850099
188600     END-EXEC.                                                    18860099
188700                                                                  18870099
188800     EVALUATE TRUE                                                18880099
188900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 18890099
189000              EVALUATE TRUE                                       18900099
189100                  WHEN XM003-SUCCESSFUL                           18910099
189200                       MOVE XM003-ONHAND    TO PV-WORK-QTY-9      18920099
189300                                               PV-ONHAND-QTY      18930099
189400                       MOVE PV-WORK-QTY-X   TO AONQTYO            18940099
189500                                               ASC-ON-HAND        18950099
189600                       MOVE XM003-ONORDER   TO PV-WORK-QTY-9      18960099
189700                       MOVE PV-WORK-QTY-X   TO AONORDRO           18970099
189800                                               ASC-ON-ORDER       18980099
189900                                                                  18990099
190000                       MOVE XM003-LAST-RCVD-DATE TO ARCPDTEO      19000099
190100                                               ASC-LAST-RCVD-DATE 19010099
190200                       MOVE XM003-LAST-SALE-DATE TO ASALDTEO      19020099
190300                                               ASC-LAST-SALE-DATE 19030099
190400                                                                  19040099
190500                  WHEN OTHER                                      19050099
190600                       IF XM003-RETURN-SQLCODE = +100             19060099
190700                          MOVE 0 TO PV-WORK-QTY-9                 19070099
190800                                    PV-ONHAND-QTY                 19080099
190900                          MOVE PV-WORK-QTY-X   TO AONQTYO         19090099
191000                                                  ASC-ON-HAND     19100099
191100                          MOVE 0               TO PV-WORK-QTY-9   19110099
191200                          MOVE PV-WORK-QTY-X   TO AONORDRO        19120099
191300                                                  ASC-ON-ORDER    19130099
191400                                                                  19140099
191500                          MOVE SPACES TO ARCPDTEO                 19150099
191600                                         ASALDTEO                 19160099
191700                                         ASC-LAST-RCVD-DATE       19170099
191800                                         ASC-LAST-SALE-DATE       19180099
191900                       ELSE                                       19190099
192000                         MOVE 0 TO PV-WORK-QTY-9                  19200099
192100                                   PV-ONHAND-QTY                  19210099
192110                         MOVE PV-WORK-QTY-X   TO AONQTYO          19211099
192111                                                 ASC-ON-HAND      19211199
192112                         MOVE 0               TO PV-WORK-QTY-9    19211299
192113                         MOVE PV-WORK-QTY-X   TO AONORDRO         19211399
192114                                                 ASC-ON-ORDER     19211499
192115                                                                  19211599
192116                         MOVE SPACES TO ARCPDTEO                  19211699
192117                                        ASALDTEO                  19211799
192118                                        ASC-LAST-RCVD-DATE        19211899
192119                                        ASC-LAST-SALE-DATE        19211999
192120                         MOVE PC-TSYMSG-03388 TO DP020-MSG-NUMBER 19212099
192130                         SET DP020-MSG-WARNING   TO TRUE          19213099
192140                       END-IF                                     19214099
192150                                                                  19215099
192160              END-EVALUATE                                        19216099
192170                                                                  19217099
192180         WHEN OTHER                                               19218099
192190              MOVE PV-CICS-RESPONSE TO PV-CICS-RESPONSE-9         19219099
192200              STRING 'INVALID CICS RETURN CODE ON CALL '          19220099
192300                     'TO XMKCS001 - '                             19230099
192400                      PV-CICS-RESPONSE-9                          19240099
192500                      DELIMITED BY SIZE                           19250099
192600                      INTO DP013-MESSAGE-TEXT (2)                 19260099
192700              PERFORM 7100-FORMAT-ERROR                           19270099
192800                                                                  19280099
192900     END-EVALUATE.                                                19290099
193000                                                                  19300099
193100                                                                  19310099
193200*--------------------------------------------------------------*  19320099
193300*                                                              *  19330099
193400*                                                              *  19340099
193500*--------------------------------------------------------------*  19350099
193600                                                                  19360099
193700 7100-FORMAT-ERROR.                                               19370099
193800                                                                  19380099
193900     MOVE '7000-CALL-XMKCS001        '                            19390099
194000                                  TO DP013-PARAGRAPH.             19400099
194100     MOVE 'RETRIEVE ONHAND, ON ORDER QUANTITIES ERROR'            19410099
194200                      TO DP013-MESSAGE-TEXT (1).                  19420099
194300     SET   DP013-DB2-ABEND                                        19430099
194400           DP013-XCTL-DISPLAY-RESTART TO TRUE.                    19440099
194500     PERFORM DP013-0000-PROCESS-ABEND.                            19450099
194600                                                                  19460099
194700*--------------------------------------------------------------*  19470099
194800*    XMKCS004 RETRIEVES THE ORIGINAL RETAIL AND LOWEST RETAIL  *  19480099
194900*        AMOUNTS FROM FASHION.                                 *  19490099
195000*                                                              *  19500099
195100*--------------------------------------------------------------*  19510099
195200                                                                  19520099
195300 7200-CALL-XMKCS004.                                              19530099
195400                                                                  19540099
195500     INITIALIZE XM002-ITEM-COMMAREA.                              19550099
195600                                                                  19560099
195700     MOVE ASC-SKU-NBR TO XM002-SKU.                               19570099
195800     MOVE LENGTH OF XM002-ITEM-COMMAREA TO PV-COMMAREA-LENGTH.    19580099
195900                                                                  19590099
196000     EXEC CICS                                                    19600099
196100          LINK                                                    19610099
196200               PROGRAM (PC-XMKCS004)                              19620099
196300              COMMAREA (XM002-ITEM-COMMAREA)                      19630099
196400                LENGTH (PV-COMMAREA-LENGTH)                       19640099
196500                  RESP (PV-CICS-RESPONSE)                         19650099
196600     END-EXEC.                                                    19660099
196700                                                                  19670099
196800     EVALUATE TRUE                                                19680099
196900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 19690099
197000              EVALUATE TRUE                                       19700099
197100                  WHEN XM002-SUCCESSFUL                           19710099
197200                       MOVE XM002-ORIG-UNT-RTL-AMT TO             19720099
197300                                               PV-ORIG-RTL-AMT    19730099
197400                       MOVE XM002-LOWST-UNT-RTL-AMT TO ALOWRTLO   19740099
197500                                               PV-LOW-RTL-AMT     19750099
197600                       MOVE XM002-SETUP-DATE TO PV-SETUP-DATE     19760099
197700                                                                  19770099
197800                  WHEN OTHER                                      19780099
197900                       MOVE 0  TO PV-ORIG-RTL-AMT                 19790099
198000                                  PV-LOW-RTL-AMT                  19800099
198100                       MOVE SPACES TO PV-SETUP-DATE               19810099
198200                       IF XM002-RETURN-SQLCODE = -911 OR          19820099
198300                                                 -913             19830099
198400                          MOVE PC-TSYMSG-01063 TO                 19840099
198500                                         DP020-MSG-NUMBER         19850099
198600                          SET DP020-MSG-INFORMATIONAL TO TRUE     19860099
198700                       END-IF                                     19870099
198800                                                                  19880099
198900              END-EVALUATE                                        19890099
199000                                                                  19900099
199100         WHEN OTHER                                               19910099
199200              MOVE PV-CICS-RESPONSE TO PV-CICS-RESPONSE-9         19920099
199300              STRING 'INVALID CICS RETURN CODE ON CALL '          19930099
199400                     'TO XMKCS004 - '                             19940099
199500                      PV-CICS-RESPONSE-9                          19950099
199600                      DELIMITED BY SIZE                           19960099
199700                      INTO DP013-MESSAGE-TEXT (2)                 19970099
199800              PERFORM 7500-FORMAT-ERROR                           19980099
199900                                                                  19990099
200000     END-EVALUATE.                                                20000099
200100                                                                  20010099
200200                                                                  20020099
200300*--------------------------------------------------------------*  20030099
200400*                                                              *  20040099
200500*                                                              *  20050099
200600*--------------------------------------------------------------*  20060099
200700                                                                  20070099
200800 7300-FORMAT-ERROR.                                               20080099
200900                                                                  20090099
201000     MOVE '7200-CALL-XMKCS004        '                            20100099
201100                                  TO DP013-PARAGRAPH.             20110099
201200     MOVE 'RETRIEVE ORIGINAL AND LOWEST RETAIL AMOUNT ERROR'      20120099
201300                      TO DP013-MESSAGE-TEXT (1).                  20130099
201400     SET   DP013-DB2-ABEND                                        20140099
201500           DP013-XCTL-DISPLAY-RESTART TO TRUE.                    20150099
201600     PERFORM DP013-0000-PROCESS-ABEND.                            20160099
201700                                                                  20170099
201800*--------------------------------------------------------------*  20180099
201900*    XLKCS074 RETRIEVES THE INTRANSIT QUANTITY AND STORE       *  20190099
202000*        EXPECTED QUANTITY.                                    *  20200099
202100*                                                              *  20210099
202200*--------------------------------------------------------------*  20220099
202300                                                                  20230099
202400 7400-CALL-XLKCS074.                                              20240099
202500                                                                  20250099
202600     INITIALIZE XL074-ITEM-COMMAREA.                              20260099
202700     SET XL074-BY-SKU   TO TRUE.                                  20270099
202800     IF ASC-LOCATION-NBR = 0                                      20280099
202900        SET XL074-BY-ALL-LOCATIONS TO TRUE                        20290099
203000     ELSE                                                         20300099
203100        SET XL074-BY-STORE TO TRUE                                20310099
203200        MOVE ASC-LOCATION-NBR TO XL074-KEY-LOC-NBR                20320099
203300     END-IF.                                                      20330099
203400                                                                  20340099
203500     MOVE ASC-SKU-NBR TO XL074-KEY-SKU.                           20350099
203600                                                                  20360099
203700     CALL XL074-ONLINE-PGM USING DFHEIBLK                         20370099
203800                                 XL074-COMMAREA                   20380099
203900                                 XL074-ITEM-COMMAREA.             20390099
204000                                                                  20400099
204100     EVALUATE TRUE                                                20410099
204200         WHEN XL074-SUCCESSFUL                                    20420099
204300              MOVE XL074-SE-QTY TO PV-STORE-EXPECTED-QTY          20430099
204400              MOVE XL074-IT-QTY TO PV-INTRANSIT-QTY               20440099
204500                                                                  20450099
204600         WHEN XL074-SQL-ERROR                                     20460099
204700              MOVE XL074-KEY-SKU TO DK-SKU-NBR                    20470099
204800              STRING 'INVALID RETURN CODE FROM XLKCS074 '         20480099
204900                      XL074-SQLCODE                               20490099
205000                     ' - '                                        20500099
205100                      DK-SKU-NBR                                  20510099
205200                     ' - '                                        20520099
205300                      DELIMITED BY SIZE                           20530099
205400                      INTO DP013-MESSAGE-TEXT (2)                 20540099
205500              PERFORM 7500-FORMAT-ERROR                           20550099
205600                                                                  20560099
205700         WHEN OTHER                                               20570099
205800              MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER            20580099
205900              SET DP020-MSG-INFORMATIONAL TO TRUE                 20590099
206000                                                                  20600099
206100     END-EVALUATE.                                                20610099
206200                                                                  20620099
206300                                                                  20630099
206400*--------------------------------------------------------------*  20640099
206500*                                                              *  20650099
206600*                                                              *  20660099
206700*--------------------------------------------------------------*  20670099
206800                                                                  20680099
206900 7500-FORMAT-ERROR.                                               20690099
207000                                                                  20700099
207100     MOVE '7400-CALL-XLKCS074        '                            20710099
207200                                  TO DP013-PARAGRAPH.             20720099
207300     STRING 'RETRIEVE INTRANSIT AND STORE EXPECTED QTY ERROR'     20730099
207400            'IN PARAGRAPH '                                       20740099
207500             XL074-ERROR-PARAGRAPH-NBR                            20750099
207600             DELIMITED BY SIZE                                    20760099
207700             INTO DP013-MESSAGE-TEXT (1).                         20770099
207800     SET   DP013-DB2-ABEND                                        20780099
207900           DP013-XCTL-DISPLAY-RESTART TO TRUE.                    20790099
208000     MOVE XL074-SQLCA   TO SQLCA.                                 20800099
208100     MOVE XL074-SQLCODE TO SQLCODE.                               20810099
208200     PERFORM DP013-0000-PROCESS-ABEND.                            20820099
208300                                                                  20830099
208400                                                                  20840099
208410******************************************************************20841099
208411* SELECT LAST ITEM RECEIPT TYPE, DATE AND QUANTITY                20841199
208412* UN - STORE UNLOAD (STORE SCAN)                                  20841299
208413* AU - ASSUMPTIVE RECEIPT                                         20841399
208414******************************************************************20841499
208420 7600-CHECK-LAST-RCPT.                                            20842099
208421     MOVE  +0                   TO PV-UNLOAD-QTY.                 20842199
208422     MOVE  SPACES               TO PCT00015-IN-TRNST-TRN-TMST.    20842299
208424     SET ASC-STR-UNLOAD-NO      TO TRUE.                          20842499
208425     SET PS-FIRST-FETCH-YES     TO TRUE.                          20842599
208430     MOVE XL074-INTR-UPC        TO PCT00015-INTR-UPC-ID           20843099
208431     MOVE ASC-LOCATION-NBR      TO PCT00015-LOC-NBR               20843199
208432     SET PS-STREXP-END-NO       TO TRUE.                          20843299
208440     PERFORM 7700-OPEN-CURSOR.                                    20844099
208441     PERFORM 7800-FETCH-EXPECTED                                  20844199
208442                UNTIL PS-STREXP-END-YES.                          20844299
208443     PERFORM 7900-CLOSE-CURSOR.                                   20844399
208530***************************************************************** 20853099
208531* 7700-OPEN-CURSOR.                                               20853199
208532***************************************************************** 20853299
208533 7700-OPEN-CURSOR.                                                20853399
208534                                                                  20853499
208535     EXEC SQL                                                     20853599
208536         OPEN STR_EXP_CURSOR                                      20853699
208537     END-EXEC.                                                    20853799
208538                                                                  20853899
208539     EVALUATE TRUE                                                20853999
208540         WHEN SQLCODE = +0                                        20854099
208541             CONTINUE                                             20854199
208543         WHEN OTHER                                               20854399
208544              MOVE '7700-OPEN-CURSOR ' TO DP013-PARAGRAPH         20854499
208545              SET   DP013-DB2-ABEND                               20854599
208546                    DP013-XCTL-DISPLAY-RESTART TO TRUE            20854699
208547              MOVE  SQLCA             TO DP013-SQLCA              20854799
208548              MOVE  'PCT_TRN_CLSN_DTL' TO DP013-DB2-TABLE-NAME (1)20854899
208549              STRING 'OPEN ON '                                   20854999
208550                      DP013-DB2-TABLE-NAME (1)                    20855099
208551                     ' TABLE HAD BAD SQLCODE '                    20855199
208552                      DELIMITED BY SIZE                           20855299
208553                      INTO DP013-MESSAGE-TEXT (1)                 20855399
208554              PERFORM DP013-0000-PROCESS-ABEND                    20855499
208555                                                                  20855599
208561     END-EVALUATE.                                                20856199
208562/                                                                 20856299
208563***************************************************************** 20856399
208564* 7800-FETCH-EXPECTED.                                            20856499
208565***************************************************************** 20856599
208566 7800-FETCH-EXPECTED.                                             20856699
208567                                                                  20856799
208568     EXEC SQL                                                     20856899
208569         FETCH STR_EXP_CURSOR                                     20856999
208570          INTO  :PCT00015-TRN-CLSN-PRCG-QTY                       20857099
208571              , :PV-ITRNST-DATE                                   20857199
208573              , :PCT00015-TRN-TYP-CDE                             20857399
208577     END-EXEC.                                                    20857799
208578                                                                  20857899
208579     EVALUATE TRUE                                                20857999
208580         WHEN SQLCODE = +0                                        20858099
208581           IF PS-FIRST-FETCH-YES                                  20858199
208582              MOVE PV-ITRNST-DATE                                 20858299
208583                               TO PV-PROCESS-DATE                 20858399
208584              SET PS-FIRST-FETCH-NO TO TRUE                       20858499
208585           END-IF                                                 20858599
208586           IF PV-ITRNST-DATE = PV-PROCESS-DATE                    20858699
208587             IF PCT00015-TRN-TYP-CDE = PC-UN OR PC-MM             20858799
208588               COMPUTE PCT00015-TRN-CLSN-PRCG-QTY  =              20858899
208589                   PCT00015-TRN-CLSN-PRCG-QTY  * -1               20858999
208590               COMPUTE PV-UNLOAD-QTY  = PV-UNLOAD-QTY +           20859099
208591                      PCT00015-TRN-CLSN-PRCG-QTY                  20859199
208592               SET ASC-STR-UNLOAD-SCAN TO TRUE                    20859299
208593             ELSE                                                 20859399
208594                COMPUTE PV-UNLOAD-QTY  = PV-UNLOAD-QTY +          20859499
208595                        PCT00015-TRN-CLSN-PRCG-QTY                20859599
208596                MOVE PCT00015-TRN-TYP-CDE TO ASC-STR-UNLOAD-SW    20859699
208597             END-IF                                               20859799
208598           END-IF                                                 20859899
208599         WHEN SQLCODE = +100                                      20859999
208600             SET PS-STREXP-END-YES TO TRUE                        20860099
208601         WHEN OTHER                                               20860199
208602              MOVE '7800-FETCH-EXPECTED ' TO DP013-PARAGRAPH      20860299
208603              SET   DP013-DB2-ABEND                               20860399
208604                    DP013-XCTL-DISPLAY-RESTART TO TRUE            20860499
208605              MOVE  SQLCA             TO DP013-SQLCA              20860599
208606              MOVE  'PCT_TRN_CLSN_DTL' TO DP013-DB2-TABLE-NAME (1)20860699
208607              STRING 'SELECT ON '                                 20860799
208608                      DP013-DB2-TABLE-NAME (1)                    20860899
208609                     ' TABLE HAD BAD SQLCODE '                    20860999
208610                      DELIMITED BY SIZE                           20861099
208611                      INTO DP013-MESSAGE-TEXT (1)                 20861199
208612              PERFORM DP013-0000-PROCESS-ABEND                    20861299
208613                                                                  20861399
208614     END-EVALUATE.                                                20861499
208615/                                                                 20861599
208616***************************************************************** 20861699
208617* 7900-CLOSE-CURSOR.                                              20861799
208618***************************************************************** 20861899
208619 7900-CLOSE-CURSOR.                                               20861999
208620                                                                  20862099
208621     EXEC SQL                                                     20862199
208622         CLOSE STR_EXP_CURSOR                                     20862299
208623     END-EXEC.                                                    20862399
208624                                                                  20862499
208625     EVALUATE TRUE                                                20862599
208626         WHEN SQLCODE = +0                                        20862699
208627             CONTINUE                                             20862799
208628         WHEN OTHER                                               20862899
208629              MOVE '7900-CLOSE-CURSOR   ' TO DP013-PARAGRAPH      20862999
208630              SET   DP013-DB2-ABEND                               20863099
208631                    DP013-XCTL-DISPLAY-RESTART TO TRUE            20863199
208632              MOVE  SQLCA             TO DP013-SQLCA              20863299
208633              MOVE  'PCT_TRN_CLSN_DTL' TO DP013-DB2-TABLE-NAME (1)20863399
208634              STRING 'CLOSE CURSOR'                               20863499
208635                      DP013-DB2-TABLE-NAME (1)                    20863599
208636                     ' TABLE HAD BAD SQLCODE '                    20863699
208637                      DELIMITED BY SIZE                           20863799
208638                      INTO DP013-MESSAGE-TEXT (1)                 20863899
208639              PERFORM DP013-0000-PROCESS-ABEND                    20863999
208640                                                                  20864099
208641     END-EVALUATE.                                                20864199
208642                                                                  20864299
208643*--------------------------------------------------------------*  20864399
208650* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.     *  20865099
208700*--------------------------------------------------------------*  20870099
208800                                                                  20880099
208900 9100-READ-SEL-QUEUE.                                             20890099
209000     EXEC CICS                                                    20900099
209100         READQ TS                                                 20910099
209200             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        20920099
209300             INTO  (IQ014-MESSAGE-SEL-REC)                        20930099
209400             ITEM  (ASC-SEL-ITEM)                                 20940099
209500             RESP  (PV-CICS-RESP)                                 20950099
209600     END-EXEC.                                                    20960099
209700                                                                  20970099
209800     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           20980099
209900         CONTINUE                                                 20990099
210000     ELSE                                                         21000099
210100         SET DP013-LOGIC-ABEND                                    21010099
210200             DP013-NO-ROLLBACK     TO TRUE                        21020099
210300         MOVE '9100-READ-SEL-QUEUE'                               21030099
210400                                   TO DP013-PARAGRAPH             21040099
210500         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   21050099
210600                                   TO DP013-MESSAGE-TEXT (1)      21060099
210700         PERFORM DP013-0000-PROCESS-ABEND                         21070099
210800     END-IF.                                                      21080099
210900*--------------------------------------------------------------*  21090099
211000* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.     *  21100099
211100*--------------------------------------------------------------*  21110099
211200 9200-REWRITE-LIST-QUEUE.                                         21120099
211300     EXEC CICS                                                    21130099
211400          WRITEQ TS                                               21140099
211500              QUEUE  (ASC-SEL-QUEUE-NAME-IN)                      21150099
211600              FROM   (IQ014-MESSAGE-SEL-REC)                      21160099
211700              ITEM   (ASC-SEL-ITEM)                               21170099
211800              RESP   (PV-CICS-RESP)                               21180099
211900              REWRITE                                             21190099
212000     END-EXEC.                                                    21200099
212100                                                                  21210099
212200     IF  PV-CICS-RESP NOT = DFHRESP(NORMAL)                       21220099
212300         SET DP013-CICS-ABEND                                     21230099
212400             DP013-NO-ROLLBACK     TO TRUE                        21240099
212500         MOVE '9200-REWRITE-LIST-QUEUE'                           21250099
212600                                   TO DP013-PARAGRAPH             21260099
212700         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   21270099
212800                                   TO DP013-MESSAGE-TEXT (1)      21280099
212900         PERFORM DP013-0000-PROCESS-ABEND                         21290099
213000     END-IF.                                                      21300099
213100                                                                  21310099
213200*--------------------------------------------------------------*  21320099
213300*    ABEND PROCESSOR MODULE                                    *  21330099
213400*--------------------------------------------------------------*  21340099
213500                                                                  21350099
213600     COPY DPPD013.                                                21360099
