000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     DBKDM006.                                        00020000
000300 AUTHOR.         CRAIG MARTIN.                                    00030000
000400                                                                  00040006
000500 ENVIRONMENT DIVISION.                                            00050007
000600 CONFIGURATION SECTION.                                           00060007
000700 SOURCE-COMPUTER.        IBM.                                     00070007
000800 OBJECT-COMPUTER.        IBM.                                     00080007
000900 INPUT-OUTPUT SECTION.                                            00090007
001000                                                                  00100007
001100***********************************************************       00110064
001101*    THIS PROGRAM DISPLAYS THE DB2 TABLE DESCRIPTION              00110191
001110***********************************************************       00111091
001200* 09/10  LARRY SCHLEICHER                                         00120091
001300*     ADDED THE IDENTITY COLUMN INFORMATION TO THE LISTING.       00130091
001410***********************************************************       00141091
001420* 03/08  LARRY SCHLEICHER                                         00142091
001430*     ADDED SUPPORT FOR DB2 VERSION 8.  ALLOW THE LENGTH          00143091
001440*     OF TABLE NAMES TO INCREASE FROM 18 CHARACTERS TO 128.       00144091
001500***********************************************************       00150064
001510* 05/08  LARRY SCHLEICHER                                         00151088
001520*     CHANGED THE SETTING OF THE CURSOR FROM THE CMNEKTAB         00152087
001530*     FIELD TO THE CMNEKCRE FIELD.                                00153087
001531***********************************************************       00153199
001532* 03/14  BETSY JEFFERY                                            00153299
001533*     INCREASED THE SIZE OF THE TEMPORARY FILE NAME TO            00153399
001534*     MULTI-LOGON ISPF REQUIREMENTS.                              00153499
001540***********************************************************       00154087
001600 FILE-CONTROL.                                                    00160007
001700                                                                  00170007
001800     SELECT BROWSE-FILE ASSIGN TO TABDDATA.                       00180007
001900                                                                  00190007
002000 DATA DIVISION.                                                   00200007
002100 FILE SECTION.                                                    00210007
002200 FD  BROWSE-FILE                                                  00220007
002300     RECORDING MODE IS F                                          00230007
002400     LABEL RECORDS ARE STANDARD                                   00240007
002500     RECORD CONTAINS 080 CHARACTERS                               00250007
002600     BLOCK CONTAINS 0 RECORDS                                     00260007
002700     DATA RECORD IS BROWSE-RECORD.                                00270007
002800 01  BROWSE-RECORD           PIC X(080).                          00280007
002900                                                                  00290007
003000*                                                                 00300007
003100     EJECT                                                        00310007
003200 WORKING-STORAGE SECTION.                                         00320007
003300*                                                                 00330007
003310 01  WS-CK-CONDITION   PIC X(7400).                               00331092
003320 01  WS-CK-CONDITION-DATA REDEFINES WS-CK-CONDITION.              00332093
003330     05  WS-CK-CONDITION-CHARS OCCURS 7400 TIMES                  00333093
003340                                 INDEXED BY CK-IDX.               00334092
003350         10  WS-CK-CONDITION-CHAR  PIC X(1).                      00335093
003360 01  CK-PTR            PIC 9(6).                                  00336096
003400 01  WS-UNSTRING-01    PIC X(1).                                  00340050
003500                                                                  00350051
003600 01  WS-ROW-NO         PIC  -,---,---,---,--9.                    00360051
003700 01  WS-ROW-NO-ALPH                                               00370051
003800       REDEFINES WS-ROW-NO         PIC X(17).                     00380051
003900                                                                  00390051
004000 01  WS-FIRSTKEYCARDF  PIC  -,---,---,---,--9.                    00400051
004100 01  WS-FIRSTKEYCARDF-ALPH                                        00410051
004200       REDEFINES WS-FIRSTKEYCARDF  PIC X(17).                     00420051
004300                                                                  00430051
004400 01  WS-FULLKEYCARDF   PIC  -,---,---,---,--9.                    00440051
004500 01  WS-FULLKEYCARDF-ALPH                                         00450051
004600       REDEFINES WS-FULLKEYCARDF   PIC X(17).                     00460051
004700                                                                  00470051
004710 01  WS-TABLE-NAME-1   PIC X(70)  VALUE SPACES.                   00471080
004711 01  WS-TABLE-NAME-2   PIC X(70)  VALUE SPACE.                    00471180
004720                                                                  00472079
004800 01  REPORT-TITLE1.                                               00480007
004900     05  PIC X(20)  VALUE  SPACES.                                00490007
005000     05  PIC X(28)  VALUE  'DB2 TABLE DESCRIPTION'.               00500007
005100     05  PIC X(20)  VALUE  SPACES.                                00510012
005200                                                                  00520007
005300 01  NO-MATCH-INFO.                                               00530007
005400     05  PIC X(02)  VALUE  SPACES.                                00540007
005500     05  PIC X(33)  VALUE  'NO DB2 TABLE MATCHED FOR CREATOR'.    00550007
005600     05  NO-MATCH-INFO-CREATOR         PIC X(08)   VALUE SPACES.  00560007
005700     05  PIC X(15)  VALUE  'AND TABLE NAME'.                      00570007
005800     05  NO-MATCH-INFO-TABLE-NAME      PIC X(22)   VALUE SPACES.  00580054
005900                                                                  00590007
006000 01  REPORT-TITLE2.                                               00600061
006100     05  PIC X(03)  VALUE  SPACES.                                00610061
006200     05  PIC X(15)  VALUE  'DATABASE     = '.                     00620061
006300     05  TITLE-DATABASE                PIC X(08)   VALUE SPACES.  00630061
006400     05  PIC X(14)  VALUE  SPACES.                                00640061
006500     05  PIC X(13)  VALUE  'TABLESPACE = '.                       00650061
006600     05  TITLE-TABLESPACE              PIC X(08)   VALUE SPACES.  00660061
006700     05  PIC X(02)  VALUE  SPACES.                                00670061
006800     05  TITLE-TABLESPACE-TYPE         PIC X(13)   VALUE SPACES.  00680061
006900                                                                  00690057
007000 01  REPORT-TITLE3P.                                              00700000
007100     05  PIC X(03)  VALUE  SPACES.                                00710041
007200     05  PIC X(16)  VALUE                                         00720000
007300     'PARTITIONS   =  '.                                          00730000
007400*    05  PIC X(22)  VALUE                                         00740000
007500*    'NUMBER OF PARTITIONS ='.                                    00750000
007600     05  PART-NO    PIC  Z99.                                     00760000
007700     05  PART-NO-X  REDEFINES                                     00770000
007800         PART-NO    PIC  XXX.                                     00780000
007900     05  PIC X(18)  VALUE  SPACES.                                00790000
008000*    05  PIC X(13)  VALUE                                         00800000
008100*    'LOCKSIZE   = '.                                             00810000
008200*    05  LOCKRULE-P  PIC  XXXX.                                   00820000
008300*    05  PIC X(06)  VALUE  SPACES.                                00830000
008400     05  PIC X(13)  VALUE                                         00840000
008500     'BPOOL      = '.                                             00850000
008600     05  BPOOL-NO-P  PIC  XXXXXXXX.                               00860000
008700                                                                  00870000
008800 01  REPORT-TITLE3S.                                              00880000
008900     05  PIC X(03)  VALUE  SPACES.                                00890041
009000     05  PIC X(14)  VALUE                                         00900000
009100     'SEGSIZE      ='.                                            00910000
009200     05  SEGSIZE-NO  PIC  Z99.                                    00920000
009300     05  SEGSIZE-NO-X  REDEFINES                                  00930000
009400         SEGSIZE-NO    PIC  XXX.                                  00940000
009500     05  PIC X(17)  VALUE  SPACES.                                00950000
009600*    05  PIC X(11)  VALUE                                         00960000
009700*    'LOCKSIZE = '.                                               00970000
009800*    05  LOCKRULE-S  PIC  XXXX.                                   00980000
009900     05  PIC X(03)  VALUE  SPACES.                                00990000
010000     05  PIC X(13)  VALUE                                         01000000
010100     'BPOOL      = '.                                             01010000
010200     05  BPOOL-NO-S  PIC  XXXXXXXX.                               01020000
010300                                                                  01030000
010400 01  REPORT-TITLE4.                                               01040000
010500     05  FILLER   PIC X(03)  VALUE  SPACES.                       01050041
010600     05  FILLER   PIC X(15)  VALUE                                01060000
010700     'ROW COUNT    = '.                                           01070000
010800     05  ROW-NO   PIC X(17)  VALUE SPACES.                        01080045
010900     05  FILLER   PIC X(05)  VALUE  SPACES.                       01090047
011000     05  FILLER   PIC X(13)  VALUE                                01100047
011100     'STATS DATE = '.                                             01110000
011200     05  RS-DATE    PIC  XXXXXXXXXX.                              01120000
011300                                                                  01130000
011400 01  REPORT-TITLE45.                                              01140000
011500     05  PIC X(03)  VALUE  SPACES.                                01150041
011600     05  PIC X(15)  VALUE                                         01160000
011700     'ACTIVE PAGES = '.                                           01170000
011800     05  ACT-PAGE   PIC  Z,ZZZ,ZZZ,ZZ9.                           01180049
011900     05  PIC X(09)  VALUE  SPACES.                                01190050
012000     05  PIC X(13)  VALUE                                         01200000
012100     'DCLGEN NAME= '.                                             01210000
012200     05  DCLGEN-NM  PIC  X(27) VALUE SPACES.                      01220054
012300                                                                  01230000
012400 01  REPORT-TITLECKM.                                             01240000
012500     05  PIC X(03)  VALUE  SPACES.                                01250041
012600     05  PIC X(15)  VALUE                                         01260000
012700     'PCTFREE      = '.                                           01270000
012800     05  PCTFREE-NO PIC  ZZ9.                                     01280000
012900     05  PIC X(19)  VALUE  SPACES.                                01290000
013000     05  PIC X(13)  VALUE                                         01300000
013100     '# COLUMNS  = '.                                             01310000
013200     05  COL-COUNTA PIC  ZZZZ9.                                   01320000
013300                                                                  01330000
013400 01  REPORT-TITLECKK.                                             01340000
013500     05  PIC X(03)  VALUE  SPACES.                                01350041
013600     05  PIC X(15)  VALUE                                         01360000
013700     'CHECKS       = '.                                           01370000
013800     05  CHECKS-B   PIC  ZZ9.                                     01380000
013900     05  PIC X(19)  VALUE  SPACES.                                01390000
014000     05  PIC X(13)  VALUE                                         01400000
014100     '# COLUMNS  = '.                                             01410000
014200     05  COL-COUNTB PIC  ZZZZ9.                                   01420000
014300                                                                  01430000
014400 01  REPORT-TITLECK.                                              01440000
014500     05  PIC X(03)  VALUE  SPACES.                                01450041
014600     05  PIC X(15)  VALUE                                         01460000
014700     'CHECKS       = '.                                           01470000
014800     05  CHECKS-A   PIC  ZZ9.                                     01480000
014900                                                                  01490000
015000 01  REPORT-TITLE4A.                                              01500000
015100     05  PIC X(03)  VALUE  SPACES.                                01510041
015200     05  PIC X(15)  VALUE                                         01520000
015300     'ROW LENGTH   = '.                                           01530000
015400     05  REC-LEN    PIC  ZZZZ9.                                   01540000
015500*    05  REC-LEN    PIC  ZZZ,ZZZ,ZZ9.                             01550000
015600     05  PIC X(17)  VALUE  SPACES.                                01560000
015700     05  PIC X(13)  VALUE                                         01570000
015800     'LOCKSIZE   = '.                                             01580000
015900     05  LOCKRULE    PIC  XXXX.                                   01590000
016000                                                                  01600000
016100 01  REPORT-TITLE4FP.                                             01610000
016200     05  PIC X(03)  VALUE  SPACES.                                01620041
016300     05  PIC X(15)  VALUE                                         01630000
016400     'FREEPAGE     = '.                                           01640000
016500     05  FREEPG-NO  PIC  ZZ9.                                     01650000
016600     05  PIC X(19)  VALUE  SPACES.                                01660072
016700     05  PIC X(13)  VALUE                                         01670000
016800     'COMPRESS   = '.                                             01680000
016900     05  CMPRESS    PIC  XXX.                                     01690000
017000                                                                  01700000
017100 01  REPORT-TITLEIFP.                                             01710000
017200     05  PIC X(02)  VALUE  SPACES.                                01720000
017300     05  PIC X(11)  VALUE  SPACES.                                01730000
017400     05  PIC X(10)  VALUE                                         01740000
017500     'FREEPAGE ='.                                                01750000
017600     05  FREEPG-NO-I PIC  ZZ9.                                    01760000
017700     05  PIC X(08)  VALUE  SPACES.                                01770072
017800     05  PIC X(09)  VALUE                                         01780000
017900     'PCTFREE ='.                                                 01790000
018000     05  PCTFREE-NO-I PIC  ZZ9.                                   01800000
018100                                                                  01810000
018200 01  REPORT-TITLE6.                                               01820000
018300     05  PIC X(11)  VALUE 'COLUMN NAME'.                          01830073
018400     05  PIC X(22)  VALUE  SPACES.                                01840074
018500     05  PIC X(04)  VALUE 'TYPE'.                                 01850073
018600     05  PIC X(03)  VALUE  SPACES.                                01860074
018700     05  PIC X(06)  VALUE 'LENGTH'.                               01870073
018800     05  PIC X(02)  VALUE  SPACES.                                01880073
018900     05  PIC X(05)  VALUE 'SCALE'.                                01890073
019000     05  PIC X(03)  VALUE  SPACES.                                01900073
019100     05  PIC X(15)  VALUE 'NULL RULE'.                            01910000
019200                                                                  01920000
019300 01  REPORT-TITLE7.                                               01930000
019400     05  PIC X(30)  VALUE  ALL '_'.                               01940073
019500     05  PIC X(02)  VALUE  SPACE.                                 01950000
019600     05  PIC X(07)  VALUE  ALL '_'.                               01960000
019700     05  PIC X(01)  VALUE  SPACE.                                 01970074
019800     05  PIC X(06)  VALUE  ALL '_'.                               01980073
019900     05  PIC X(02)  VALUE  SPACE.                                 01990000
020000     05  PIC X(05)  VALUE  ALL '_'.                               02000073
020100     05  PIC X(02)  VALUE  SPACE.                                 02010000
020200     05  PIC X(21)  VALUE  ALL '_'.                               02020000
020300                                                                  02030000
020400 01  REPORT-LINE                                   VALUE SPACES.  02040000
020500      05 RPT-COLUMN-NAME                PIC X(30).                02050073
020600      05                                PIC X(02).                02060000
020700      05 RPT-TYPE                       PIC X(08).                02070000
020800      05                                PIC X(01).                02080000
020900      05 RPT-LENGTH                     PIC ZZZZ9.                02090000
021000      05                                PIC X(05).                02100073
021100      05 RPT-SCALE                      PIC Z9.                   02110000
021200      05                                PIC X(02).                02120073
021300      05 RPT-NULL-RULE                  PIC X(21).                02130073
021400      05                                PIC X(01).                02140000
021500      05 RPT-DEFAULT                    PIC X(03).                02150000
021600                                                                  02160000
021700 01  PK-COLUMN-LINE.                                              02170000
021800     05  PIC X(05)  VALUE  SPACES.                                02180000
021900     05  PK-COMMA                 PIC X(01)  VALUE ','.           02190000
022000     05  PK-COLUMN-NAME           PIC X(18)  VALUE SPACES.        02200000
022100                                                                  02210000
022200 01  FK-INFO-LINE.                                                02220000
022300     05  PIC X(02)       VALUE  SPACES.                           02230000
022400     05  FK-COUNT        PIC Z9.                                  02240000
022500     05  FK-COUNT-X      REDEFINES                                02250000
022600         FK-COUNT        PIC XX.                                  02260000
022700     05  PIC X(17)       VALUE  ' PARENT TABLE(S) '.              02270075
022800     05  PIC X(26)       VALUE  'ARE DEFINED TO THIS TABLE'.      02280076
022900     05  FK-INFO-COLON   PIC X.                                   02290000
023000                                                                  02300000
023100 01  PC-INFO-LINE.                                                02310000
023200     05  PIC X(02)       VALUE  SPACES.                           02320000
023300     05  PC-COUNT        PIC Z9.                                  02330000
023400     05  PC-COUNT-X      REDEFINES                                02340000
023500         PC-COUNT        PIC XX.                                  02350000
023600     05  PIC X(16)       VALUE  ' OTHER TABLE(S)'.                02360000
023700     05  PIC X(27)       VALUE  'ARE CHILDREN TO THIS TABLE'.     02370051
023800     05  PC-INFO-COLON   PIC X.                                   02380000
023900                                                                  02390000
024000 01  FK-COLUMN-LINE.                                              02400000
024100     05  PIC X(05)       VALUE  SPACES.                           02410000
024200     05  FK-COMMA        PIC X  VALUE  ','.                       02420000
024300     05  FK-COLUMN-NAME  PIC X(74)      VALUE SPACES.             02430071
024400                                                                  02440000
024500 01  IX-COLUMN-LINE.                                              02450000
024600     05  PIC X(05)       VALUE  SPACES.                           02460000
024700     05  IX-COMMA        PIC X  VALUE  ','.                       02470000
024800     05  IX-COLUMN-NAME  PIC X(30)      VALUE SPACES.             02480073
024900     05  PIC X(02)       VALUE  SPACES.                           02490000
025000     05  IX-ORDER-NAME   PIC X(4)       VALUE SPACES.             02500000
025100                                                                  02510070
025200 01  REL-TABLE-INFO.                                              02520070
025300     05  PIC X(02)       VALUE  SPACES.                           02530070
025400     05  REL-TBNAME      PIC X(28)  VALUE  SPACES.                02540070
025500     05  PIC X(02)       VALUE  SPACES.                           02550070
025600     05  REL-RELNAME     PIC X(08)  VALUE  SPACES.                02560070
025700     05  PIC X(02)       VALUE  SPACES.                           02570070
025800     05  REL-COLNAME     PIC X(42)  VALUE  SPACES.                02580070
025900                                                                  02590000
026000 01  IX-INFO-LINE.                                                02600000
026100     05  PIC X(02)       VALUE  SPACES.                           02610000
026200     05  PIC X(10)       VALUE 'THERE ARE'.                       02620000
026300     05  IX-COUNT        PIC Z9.                                  02630000
026400     05  IX-COUNT-X      REDEFINES                                02640000
026500         IX-COUNT        PIC XX.                                  02650000
026600     05  PIC X(15)       VALUE  ' INDEX/INDICES'.                 02660000
026700     05  PIC X(14)       VALUE  'IN THIS TABLE'.                  02670000
026800     05  IX-INFO-COLON   PIC X.                                   02680000
026900                                                                  02690000
027000 01  TRIG-INFO-LINE.                                              02700000
027100     05  PIC X(02)       VALUE  SPACES.                           02710000
027200     05  PIC X(10)       VALUE 'THERE ARE'.                       02720000
027300     05  TRIG-COUNT      PIC Z9.                                  02730000
027400     05  TRIG-COUNT-X    REDEFINES                                02740000
027500         TRIG-COUNT      PIC XX.                                  02750000
027600     05  PIC X(20)       VALUE  ' TRIGGERS DEPENDENT '.           02760000
027700     05  PIC X(14)       VALUE  'ON THIS TABLE'.                  02770000
027800     05  TRIG-INFO-COLON PIC X.                                   02780000
027900                                                                  02790000
028000 01  CHECK-INFO-LINE.                                             02800000
028100     05  PIC X(02)       VALUE  SPACES.                           02810000
028200     05  PIC X(48)                                                02820000
028300          VALUE 'COLUMN CHECK CONSTRAINTS FOR THIS TABLE ARE :'.  02830000
028400     05  PIC X(83)       VALUE  SPACES.                           02840000
028500                                                                  02850000
028600 01  CHECK-DATA-LINE1.                                            02860000
028700     05  PIC X(04)       VALUE  SPACES.                           02870099
028800     05  PIC X(18)       VALUE 'CHECK CONDITION : '.              02880000
028900     05  CK-CONDITION    PIC X(110) VALUE SPACES.                 02890000
029000                                                                  02900000
029010 01  CHECK-DATA-LINE2.                                            02901092
029020     05  PIC X(22)       VALUE  SPACES.                           02902092
029040     05  CK-CONDITION2   PIC X(110) VALUE SPACES.                 02904092
029050                                                                  02905092
029100                                                                  02910000
029200 01  IX-COMMENT-LINE.                                             02920000
029300     05  PIC X(02)       VALUE  SPACES.                           02930000
029400     05  PIC X(11)       VALUE  SPACES.                           02940000
029500     05  PIC X(10)       VALUE  'COMMENT = '.                     02950000
029600     05  IX-COMMENT  PIC X(100) VALUE SPACES.                     02960000
029700     05  PIC X(20)       VALUE  SPACES.                           02970000
029800                                                                  02980000
029900 01  IX-BP-LINE.                                                  02990000
030000     05  PIC X(02)       VALUE  SPACES.                           03000000
030100     05  PIC X(11)       VALUE  SPACES.                           03010000
030200     05  PIC X(08)  VALUE                                         03020000
030300     'BPOOL = '.                                                  03030000
030400     05  IX-BPOOL-NO    PIC  XXXXXXXX.                            03040000
030500     05  PIC X(05)       VALUE  SPACES.                           03050072
030600     05  PIC X(13)  VALUE 'INDEXSPACE = '.                        03060000
030700     05  IX-SPACE-NME   PIC  X(24).                               03070071
030800                                                                  03080000
030900 01  IX-CARD-LINE.                                                03090051
031000     05  PIC X(13)       VALUE  SPACES.                           03100032
031100     05  PIC X(15)       VALUE                                    03110032
031200     'FIRSTKEYCARD = '.                                           03120032
031300     05  PIC X(06)       VALUE  SPACES.                           03130072
031400     05  IX-FIRSTKEYCARDF  PIC X(17) VALUE SPACES.                03140045
031500                                                                  03150072
031600 01  IX-CARD-LINE2.                                               03160072
031700     05  PIC X(13)       VALUE  SPACES.                           03170072
031800     05  PIC X(14)       VALUE                                    03180032
031900     'FULLKEYCARD = '.                                            03190072
032000     05  PIC X(07)       VALUE  SPACES.                           03200072
032100     05  IX-FULLKEYCARDF   PIC X(17) VALUE SPACES.                03210045
032200                                                                  03220032
032300 01  IX-CLRATIO-LINE.                                             03230032
032400     05  PIC X(02)       VALUE  SPACES.                           03240032
032500     05  PIC X(11)       VALUE  SPACES.                           03250032
032600     05  PIC X(15)  VALUE                                         03260032
032700     'CLUSTERRATIO = '.                                           03270032
032800     05  PIC X(06)       VALUE  SPACES.                           03280073
032900     05  IX-CLRATIO     PIC Z99.                                  03290032
033000                                                                  03300032
033100 01  VIEW-INFO-LINE.                                              03310032
033200     05  PIC X(02)       VALUE  SPACES.                           03320000
033300     05  PIC X(10)       VALUE 'THERE ARE'.                       03330000
033400     05  VIEW-COUNT      PIC ZZZZ9.                               03340028
033500     05  VIEW-COUNT-X    REDEFINES                                03350000
033600         VIEW-COUNT      PIC XXXXX.                               03360027
033700     05  PIC X(17)       VALUE  ' VIEWS DEPENDENT '.              03370000
033800     05  PIC X(14)       VALUE  'ON THIS TABLE'.                  03380000
033900     05  VIEW-INFO-COLON PIC X.                                   03390000
034000                                                                  03400000
034100 01  VIEW-LINE.                                                   03410000
034200     05  FILLER          PIC X(05)       VALUE  SPACES.           03420000
034300     05  VIEW-COMMA      PIC X(01)       VALUE  ','.              03430000
034400     05  VIEW-NAME       PIC X(27)       VALUE SPACES.            03440000
034500                                                                  03450000
034600 01  ISP-FUNCTIONS.                                               03460000
034700     05  ISP-DISPLAY     PIC X(8) VALUE 'DISPLAY'.                03470000
034800     05  ISP-ADDPOP      PIC X(8) VALUE 'ADDPOP  '.               03480000
034900     05  ISP-REMPOP      PIC X(8) VALUE 'REMPOP  '.               03490000
035000     05  ISP-VDEFINE     PIC X(8) VALUE 'VDEFINE'.                03500000
035100     05  ISP-VDELETE     PIC X(8) VALUE 'VDELETE'.                03510000
035200     05  ISP-VGET        PIC X(8) VALUE 'VGET'.                   03520000
035300     05  ISP-VPUT        PIC X(8) VALUE 'VPUT'.                   03530000
035400     05  ISP-VRESET      PIC X(8) VALUE 'VRESET'.                 03540000
035500     05  ISP-VCOPY       PIC X(8) VALUE 'VCOPY'.                  03550000
035600     05  ISP-VREPLACE    PIC X(8) VALUE 'VREPLACE'.               03560000
035700     05  ISP-TBOPEN      PIC X(8) VALUE 'TBOPEN'.                 03570000
035800     05  ISP-TBCREATE    PIC X(8) VALUE 'TBCREATE'.               03580000
035900     05  ISP-TBCLOSE     PIC X(8) VALUE 'TBCLOSE'.                03590000
036000     05  ISP-TBEND       PIC X(8) VALUE 'TBEND  '.                03600000
036100     05  ISP-TBDISPL     PIC X(8) VALUE 'TBDISPL'.                03610000
036200     05  ISP-TBSORT      PIC X(8) VALUE 'TBSORT'.                 03620000
036300     05  ISP-TBTOP       PIC X(8) VALUE 'TBTOP'.                  03630000
036400     05  ISP-TBBOTTOM    PIC X(8) VALUE 'TBBOTTOM'.               03640000
036500     05  ISP-TBSKIP      PIC X(8) VALUE 'TBSKIP'.                 03650000
036600     05  ISP-TBADD       PIC X(8) VALUE 'TBADD '.                 03660000
036700     05  ISP-TBPUT       PIC X(8) VALUE 'TBPUT '.                 03670000
036800     05  ISP-TBMOD       PIC X(8) VALUE 'TBMOD '.                 03680000
036900     05  ISP-TBDELETE    PIC X(8) VALUE 'TBDELETE'.               03690000
037000     05  ISP-TBEXIST     PIC X(8) VALUE 'TBEXIST '.               03700000
037100     05  ISP-TBSCAN      PIC X(8) VALUE 'TBSCAN'.                 03710000
037200     05  ISP-TBPAD       PIC 9(8) COMP VALUE 0.                   03720000
037300     05  ISP-NEWCOPY     PIC X(8) VALUE 'NEWCOPY'.                03730000
037400     05  ISP-FTOPEN      PIC X(8) VALUE 'FTOPEN'.                 03740000
037500     05  ISP-FTINCL      PIC X(8) VALUE 'FTINCL'.                 03750000
037600     05  ISP-FTCLOSE     PIC X(8) VALUE 'FTCLOSE'.                03760000
037700     05  ISP-SELECT      PIC X(8) VALUE 'SELECT'.                 03770000
037800     05  ISP-BROWSE      PIC X(8) VALUE 'BROWSE'.                 03780000
037900     05  ISP-SETMSG      PIC X(8) VALUE 'SETMSG'.                 03790000
038000     05  ISP-CONTROL     PIC X(8) VALUE 'CONTROL'.                03800000
038100     05  ISP-NONDISPL    PIC X(8) VALUE 'NONDISPL'.               03810000
038200     05  ISP-SPLIT       PIC X(8) VALUE 'SPLIT'.                  03820000
038300     05  ISP-DISABLE     PIC X(8) VALUE 'DISABLE'.                03830000
038400     05  ISP-ENABLE      PIC X(8) VALUE 'ENABLE'.                 03840000
038500     05  ISP-NO          PIC X(8) VALUE 'NO'.                     03850000
038600     05  ISP-YES         PIC X(8) VALUE 'YES'.                    03860000
038700*                                                                 03870000
038800 01  ISP-MISC-DEFS.                                               03880000
038900     05  ISP-FORMAT      PIC X(8) VALUE 'CHAR'.                   03890000
039000     05  ISP-MOVE        PIC X(8) VALUE 'MOVE'.                   03900000
039100     05  ISP-WRITE       PIC X(8) VALUE 'WRITE'.                  03910000
039200     05  ISP-NOWRITE     PIC X(8) VALUE 'NOWRITE'.                03920000
039300     05  ISP-REPLACE     PIC X(8) VALUE 'REPLACE'.                03930000
039400     05  ISP-ORDERED     PIC X(8) VALUE 'ORDERED'.                03940000
039500     05  ISP-SHARED      PIC X(8) VALUE 'SHARED'.                 03950000
039600     05  ISP-PROFILE     PIC X(8) VALUE 'PROFILE'.                03960000
039700     05  ISP-ASIS        PIC X(8) VALUE 'ASIS'.                   03970000
039800     05  ISP-NOREAD      PIC X(8) VALUE 'NOREAD'.                 03980000
039900     05  ISP-NEXT        PIC X(8) VALUE 'NEXT'.                   03990000
040000     05  ISP-TEMP        PIC X(8) VALUE 'TEMP'.                   04000000
040100     05  ISP-PANEL       PIC X(8) VALUE  SPACES.                  04010000
040200     05  ISP-DUMMY       PIC X(8) VALUE  SPACES.                  04020000
040300     05  ISP-MSG         PIC X(8) VALUE  'CMN000  '.              04030000
040400     05  ISP-CSR         PIC X(8) VALUE  SPACES.                  04040000
040500     05  ISP-FIELD       PIC X(8) VALUE  SPACES.                  04050000
040600     05  ISP-SKEL        PIC X(8) VALUE  SPACES.                  04060000
040700     05  ISP-ERRORS      PIC X(8) VALUE 'ERRORS'.                 04070000
040800     05  ISP-RETURN      PIC X(8) VALUE 'RETURN'.                 04080000
040900     05  ISP-CANCEL      PIC X(8) VALUE 'CANCEL'.                 04090000
041000     05  ISP-SAVE        PIC X(8) VALUE 'SAVE'.                   04100000
041100     05  ISP-RESTORE     PIC X(8) VALUE 'RESTORE'.                04110000
041200     05  TBL-LIST-GT     PIC X(4) VALUE '(GT)'.                   04120000
041300*                                                                 04130000
041400***  DEFINE DATA TYPE PARAMETER FOR VARIABLE DEFINE SERVICE CALL. 04140000
041500*                                                                 04150000
041600 01  CHAR                PIC X(08)     VALUE 'CHAR    '.          04160000
041700                                                                  04170007
041800*                                                                 04180007
041900*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              04190007
042000*                                                                 04200007
042100     COPY DPWS023.                                                04210007
042200                                                                  04220007
042300*                                                                 04230007
042400*  PARAMETER LIST FOR THE ISPF PRINT PANEL ROUTINE                04240007
042500*                                                                 04250007
042600     COPY DPWS300.                                                04260007
042700                                                                  04270007
042800 01  VAR-SMSG                    PIC X(24)   VALUE SPACES.        04280023
042900 01  FILLER                      REDEFINES VAR-SMSG.              04290023
043000     05  VAR-SMSG-FILLER         PIC X(20).                       04300023
043100     05  VAR-SMSG-SQLCODE        PIC 9(4).                        04310023
043200 01  VAR-LMSG                    PIC X(72)   VALUE SPACES.        04320023
043300 01  PV-PROGRAM-VARIABLES.                                        04330007
043400     05  VAR-ZTEMPF              PIC X(44)   VALUE SPACES.        04340000
043500     05  VAR-DSNAME              PIC X(46)   VALUE SPACES.        04350000
043600     05  VAR-VOLUME              PIC X(06)   VALUE SPACES.        04360000
043700     05  VAR-PASSWORD            PIC X(08)   VALUE SPACES.        04370000
043800     05  PV-DYNALC-ROUTINE-ERROR-MSG.                             04380007
043900         10  FILLER              PIC X(13)    VALUE               04390007
044000             'DYNALC ERROR '.                                     04400007
044100         10  PV-DR-RETURN-CODE   PIC 9999     VALUE ZEROS.        04410007
044200         10  FILLER              PIC X(2)     VALUE '; '.         04420007
044300         10  PV-DR-DDNAME        PIC X(8)     VALUE SPACES.       04430007
044400         10  FILLER              PIC X(5)     VALUE ' DD; '.      04440007
044500         10  PV-DR-ERROR-DESC    PIC X(41)    VALUE SPACES.       04450007
044600     05  PV-BROWSE-DSNAME        PIC X(44)   VALUE SPACES.        04460021
044700     05  PV-COUNTR               PIC S9(4)   COMP.                04470000
044800     05  PV-FIELD-LENGTH         PIC 9(8)     VALUE ZEROS         04480024
044900                                              COMP SYNC.          04490024
045000*                                                                 04500000
045100***  DEFINE STORAGE FOR DIALOG VARIABLES.                         04510000
045200*                                                                 04520000
045300 01  VAR-CMNEKTAB        PIC X(43)     VALUE SPACES.              04530060
045400 01  VAR-CMNEKTAB-REDEF    REDEFINES VAR-CMNEKTAB.                04540000
045500     10  WS-FIRST3                 PIC X(03).                     04550000
045600     10  FILLER                    PIC X(40).                     04560060
045700 01  VAR-CMNEKTAB-REDEF2   REDEFINES VAR-CMNEKTAB.                04570000
045800     10  WS-FIRST2                 PIC X(02).                     04580000
045900     10  FILLER                    PIC X(41).                     04590060
046000                                                                  04600053
046100 01  VAR-CMNEKTB2        PIC X(43)     VALUE SPACES.              04610060
046200                                                                  04620054
046300 01  VAR-CMNEKTB3        PIC X(42)     VALUE SPACES.              04630060
046400                                                                  04640059
046500 01  VAR-128-TABLE-NAME  PIC X(128)    VALUE SPACES.              04650059
046600                                                                  04660053
046700 01  VAR-CMNEKCRE        PIC X(08)     VALUE SPACES.              04670000
046800 01  VAR-CMNEKCRE-REDEF1   REDEFINES VAR-CMNEKCRE.                04680000
046900     10  FILLER                    PIC X(03).                     04690099
046910     10  WS-POS4                   PIC X(01).                     04691099
047000     10  WS-POS56                  PIC X(02).                     04700000
047100     10  FILLER                    PIC X(02).                     04710000
047200                                                                  04720000
047300 01  VAR-CMNEKCRE-REDEF2   REDEFINES VAR-CMNEKCRE.                04730000
047400     10  FILLER                    PIC X(06).                     04740000
047500     10  WS-POS78                  PIC X(02).                     04750000
047600                                                                  04760000
047700 01  VAR-CMNEKCRE-REDEF3   REDEFINES VAR-CMNEKCRE.                04770000
047800     10  FILLER                    PIC X(05).                     04780000
047900     10  WS-POS67                  PIC X(02).                     04790000
048000     10  FILLER                    PIC X(01).                     04800000
048100                                                                  04810000
048200                                                                  04820000
048300 01  FREE-SPACE          PIC X(80)     VALUE SPACES.              04830000
048400 01  WK-RS-DATE-TIME.                                             04840000
048500     05  WK-RS-DATE                PIC X(10).                     04850000
048600     05  WK-RS-TIME                PIC X(16).                     04860000
048700 01  FK-COUNTER                    PIC S9(2) VALUE ZERO           04870000
048800                                             COMP.                04880000
048900 01  IX-COUNTER                    PIC S9(2) VALUE ZERO           04890000
049000                                             COMP.                04900000
049100 01  TRIG-COUNTER                  PIC S9(2) VALUE ZERO           04910000
049200                                             COMP.                04920000
049300 01  VIEW-COUNTER                  PIC S9(2) VALUE ZERO           04930000
049400                                             COMP.                04940000
049500 01  CK-COUNTER                    PIC S9(2) VALUE ZERO           04950000
049600                                             COMP.                04960000
049700 01  ABEND-CODE                    PIC S9(4) VALUE ZERO           04970000
049800                                             COMP.                04980000
049900     88  ABEND-4013                          VALUE 4013.          04990000
050000                                                                  05000000
050100 01  WS-PSOFT-PREFIX     PIC X(02)     VALUE SPACES.              05010000
050200                                                                  05020000
050300 01  PS-PRINT-SWITCH               PIC X(1)  VALUE 'N'.           05030000
050400     88  PS-EOF-PRINT                        VALUE 'Y'.           05040000
050500     88  PS-NOT-EOF-PRINT                    VALUE 'N'.           05050000
050600 01  PS-TABLE-VALIDITY             PIC X(1)  VALUE 'N'.           05060000
050700     88  PS-TABLE-IS-VALID                   VALUE 'Y'.           05070000
050800     88  PS-TABLE-IS-NOT-VALID               VALUE 'N'.           05080000
050900 01  PS-ALLOCATE-SW                PIC X(1)  VALUE 'N'.           05090000
051000     88  PS-IS-ALLOCATED                     VALUE 'Y'.           05100000
051100     88  PS-IS-NOT-ALLOCATED                 VALUE 'N'.           05110000
051200 01  PS-DB2-ERROR-INDICATOR        PIC X(1)  VALUE 'N'.           05120000
051300     88  PS-DB2-ERROR                        VALUE 'Y'.           05130000
051400     88  PS-NO-DB2-ERROR                     VALUE 'N'.           05140000
051500 01  PS-USER-INPUT                 PIC X(1)  VALUE 'N'.           05150000
051600     88  PS-USER-INPUT-VALID                 VALUE 'Y'.           05160000
051700     88  PS-USER-INPUT-NOT-VALID             VALUE 'N'.           05170000
051800 01  PS-PKEY                       PIC X(1)  VALUE 'N'.           05180000
051900     88  PS-PKEY-DEFINED                     VALUE 'Y'.           05190000
052000     88  PS-PKEY-NOT-DEFINED                 VALUE 'N'.           05200000
052100 01  PS-KEY-COLUMN-SELECT          PIC X(1)  VALUE 'N'.           05210000
052200     88  PS-KEY-COLUMN-SELECTED              VALUE 'Y'.           05220000
052300     88  PS-KEY-COLUMN-NOT-SELECTED          VALUE 'N'.           05230000
052400 01  WS-FIRSTCK-SW                 PIC X(1)  VALUE 'Y'.           05240000
052500     88  FIRSTCK                             VALUE 'Y'.           05250000
052600     88  NOT-FIRSTCK                         VALUE 'N'.           05260000
052700 01  WS-END-COLCKS-SW              PIC X(1)  VALUE 'N'.           05270000
052800     88  END-COLCKS                          VALUE 'Y'.           05280000
052900     88  PROCESS-CKS                         VALUE 'N'.           05290000
053000                                                                  05300000
053100**                                                                05310000
053200 01  PROGRAM-CONSTANTS.                                           05320000
053300     05  PC-CURRENT-PROGRAM-NAME   PIC X(08)  VALUE 'DBKDM006'.   05330008
053400     05  PC-BROWSE-DDNAME          PIC X(08)  VALUE 'TABDDATA'.   05340021
053500     05  PC-BROWSE-DSNAME-SUFFIX   PIC X(05)  VALUE '.TABD'.      05350022
053600     05  PC-MAX-RETRIES            PIC S9(3)  VALUE +3            05360000
053700                                              COMP-3.             05370000
053800     05  PC-COMMIT-MAX             PIC S9(3)  VALUE +49           05380000
053900                                              COMP-3.             05390000
054000*                                                                 05400000
054100 01  COMMON-NAMELIST.                                             05410000
054200     05  NAM-ZTEMPF      PIC X(08)     VALUE 'ZTEMPF'.            05420000
054300     05  NAM-SMSG        PIC X(08)     VALUE 'SMSG'.              05430000
054400     05  NAM-LMSG        PIC X(08)     VALUE 'LMSG'.              05440000
054500*                                                                 05450000
054600***  DEFINE DIALOG VARIABLE NAMES FOR DIALOG SERVICE CALLS.       05460000
054700*                                                                 05470000
054800 01  NAM-CMNEKTAB        PIC X(08)     VALUE 'CMNEKTAB'.          05480000
054900 01  NAM-CMNEKCRE        PIC X(08)     VALUE 'CMNEKCRE'.          05490000
055000 01  NAM-CMNEKTB2        PIC X(08)     VALUE 'CMNEKTB2'.          05500053
055100 01  NAM-CMNEKTB3        PIC X(08)     VALUE 'CMNEKTB3'.          05510059
055200*                                                                 05520000
055300***                                                               05530000
055400************************************************************      05540000
055500*    SYSIBM.SYSTABLESPACE DCLGEN                           *      05550000
055600************************************************************      05560000
055700     EXEC SQL                                                     05570000
055800         INCLUDE SYSTABSP                                         05580000
055900     END-EXEC.                                                    05590000
056000*                                                                 05600000
056100***                                                               05610000
056200************************************************************      05620000
056300*    SYSIBM.SYSTABLES DCLGEN                               *      05630000
056400************************************************************      05640000
056500     EXEC SQL                                                     05650000
056600         INCLUDE SYSTABLE                                         05660000
056700     END-EXEC.                                                    05670000
056800*                                                                 05680000
056900***                                                               05690000
057000************************************************************      05700000
057100*    SYSIBM.SYSTABLEPART DCLGEN                            *      05710000
057200************************************************************      05720000
057300     EXEC SQL                                                     05730000
057400         INCLUDE SYSTABPT                                         05740000
057500     END-EXEC.                                                    05750000
057600*                                                                 05760000
057700***                                                               05770000
057800************************************************************      05780000
057900*    SYSIBM.SYSCOLUMNS DCLGEN                              *      05790000
058000************************************************************      05800000
058100     EXEC SQL                                                     05810000
058200         INCLUDE SYSCOL                                           05820000
058300     END-EXEC.                                                    05830000
058400*                                                                 05840000
058500************************************************************      05850000
058600*    SYSIBM.SYSRELS DCLGEN                                 *      05860000
058700************************************************************      05870000
058800     EXEC SQL                                                     05880000
058900         INCLUDE SYSRELS                                          05890000
059000     END-EXEC.                                                    05900000
059100*                                                                 05910000
059200************************************************************      05920000
059300*    SYSIBM.SYSFOREIGNKEYS DCLGEN                          *      05930000
059400************************************************************      05940000
059500     EXEC SQL                                                     05950000
059600         INCLUDE SYSFKEYS                                         05960000
059700     END-EXEC.                                                    05970000
059800*                                                                 05980000
059900************************************************************      05990000
060000*    SYSIBM.SYSINDEXES DCLGEN                              *      06000000
060100************************************************************      06010000
060200     EXEC SQL                                                     06020000
060300         INCLUDE SYSINDEX                                         06030000
060400     END-EXEC.                                                    06040000
060500*                                                                 06050000
060600************************************************************      06060000
060700*    SYSIBM.SYSINDEXPART DCLGEN                            *      06070000
060800************************************************************      06080000
060900     EXEC SQL                                                     06090000
061000         INCLUDE SYSIXPT                                          06100000
061100     END-EXEC.                                                    06110000
061200*                                                                 06120000
061300************************************************************      06130000
061400*    SYSIBM.SYSKEYS DCLGEN                                 *      06140000
061500************************************************************      06150000
061600     EXEC SQL                                                     06160000
061700         INCLUDE SYSKEY                                           06170000
061800     END-EXEC.                                                    06180000
061900*                                                                 06190000
062000************************************************************      06200000
062100*    SYSIBM.SYSVIEWDEP DCLGEN                              *      06210000
062200************************************************************      06220000
062300     EXEC SQL                                                     06230000
062400         INCLUDE SYSVWDEP                                         06240000
062500     END-EXEC.                                                    06250000
062600*                                                                 06260000
062700************************************************************      06270000
062800*    DBT_DCLGEN_XREF   DCLGEN   - DB2PMVS ONLY             *      06280000
062900************************************************************      06290000
063000     EXEC SQL                                                     06300000
063100         INCLUDE DBT00001                                         06310000
063200     END-EXEC.                                                    06320000
063300*                                                                 06330000
063400************************************************************      06340000
063500*    SYSTRIGGERS                                           *      06350000
063600************************************************************      06360000
063700     EXEC SQL                                                     06370000
063800         INCLUDE SYSTRIGG                                         06380000
063900     END-EXEC.                                                    06390000
064000*                                                                 06400000
064100************************************************************      06410000
064200*    SYSCHECKDEP                                           *      06420000
064300************************************************************      06430000
064400     EXEC SQL                                                     06440000
064500         INCLUDE SYSCKDEP                                         06450000
064600     END-EXEC.                                                    06460000
064700*                                                                 06470000
064800************************************************************      06480000
064900*    SYSCHECKS                                             *      06490000
065000************************************************************      06500000
065100     EXEC SQL                                                     06510000
065200         INCLUDE SYSCHECK                                         06520000
065300     END-EXEC.                                                    06530000
065400*                                                                 06540000
065500************************************************************      06550000
065600*    DECLARE SYSCOLUMNS_CURSOR CURSOR                      *      06560000
065700************************************************************      06570000
065800*                                                                 06580000
065900     EXEC SQL                                                     06590000
066000      DECLARE SYSCOLUMNS_CURSOR CURSOR FOR                        06600000
066100      SELECT    NAME                                              06610000
066200               ,COLNO                                             06620000
066300               ,COLTYPE                                           06630000
066400               ,LENGTH                                            06640000
066500               ,SCALE                                             06650000
066600               ,NULLS                                             06660000
066700               ,DEFAULT                                           06670000
066800               ,KEYSEQ                                            06680000
066900               ,DEFAULTVALUE                                      06690000
067000      FROM      SYSIBM.SYSCOLUMNS                                 06700000
067100      WHERE     TBNAME    = :VAR-128-TABLE-NAME                   06710054
067200      AND       TBCREATOR = :VAR-CMNEKCRE                         06720000
067300      ORDER BY  COLNO                                             06730000
067400                                                                  06740000
067500   END-EXEC.                                                      06750000
067600     EJECT                                                        06760000
067700************************************************************      06770000
067800*    DECLARE SYSRELS_CURSOR CURSOR                         *      06780000
067900************************************************************      06790000
068000*                                                                 06800000
068100     EXEC SQL                                                     06810000
068200      DECLARE SYSRELS_CURSOR CURSOR FOR                           06820000
068300      SELECT    RELNAME                                           06830000
068400               ,REFTBNAME                                         06840000
068500               ,REFTBCREATOR                                      06850000
068600               ,DELETERULE                                        06860000
068700      FROM      SYSIBM.SYSRELS                                    06870000
068800      WHERE     TBNAME    = :VAR-128-TABLE-NAME                   06880054
068900      AND       CREATOR   = :VAR-CMNEKCRE                         06890000
069000      ORDER BY  RELNAME                                           06900000
069100               ,REFTBCREATOR                                      06910000
069200               ,REFTBNAME                                         06920000
069300      WITH UR                                                     06930032
069400   END-EXEC.                                                      06940000
069500     EJECT                                                        06950000
069600************************************************************      06960000
069700*    DECLARE SYSR_CURSOR CURSOR                            *      06970000
069800************************************************************      06980000
069900*                                                                 06990000
070000     EXEC SQL                                                     07000000
070100      DECLARE SYSR_CURSOR CURSOR FOR                              07010000
070200      SELECT    R.TBNAME                                          07020000
070300               ,R.RELNAME                                         07030000
070400               ,F.COLNAME                                         07040000
070500      FROM      SYSIBM.SYSRELS R                                  07050000
070600               ,SYSIBM.SYSFOREIGNKEYS F                           07060000
070700      WHERE     R.REFTBNAME = :VAR-128-TABLE-NAME                 07070054
070800        AND     R.REFTBCREATOR = :VAR-CMNEKCRE                    07080031
070900        AND     F.CREATOR = :VAR-CMNEKCRE                         07090031
071000        AND     R.RELNAME      = F.RELNAME                        07100031
071100        AND     R.TBNAME       = F.TBNAME                         07110031
071200        AND     F.COLSEQ       = 1                                07120068
071300      ORDER BY  R.TBNAME                                          07130000
071400      WITH UR                                                     07140032
071500   END-EXEC.                                                      07150000
071600     EJECT                                                        07160000
071700************************************************************      07170000
071800*    DECLARE PK_COLUMNS_CURSOR CURSOR                      *      07180000
071900************************************************************      07190000
072000*                                                                 07200000
072100     EXEC SQL                                                     07210000
072200      DECLARE PK_COLUMNS_CURSOR CURSOR FOR                        07220000
072300      SELECT    NAME                                              07230000
072400               ,KEYSEQ                                            07240000
072500      FROM      SYSIBM.SYSCOLUMNS                                 07250000
072600      WHERE     TBNAME    = :VAR-128-TABLE-NAME                   07260054
072700      AND       TBCREATOR = :VAR-CMNEKCRE                         07270000
072800      AND       KEYSEQ ^= 0                                       07280000
072900      ORDER BY  KEYSEQ                                            07290000
073000      WITH UR                                                     07300032
073100                                                                  07310000
073200   END-EXEC.                                                      07320000
073300     EJECT                                                        07330000
073400************************************************************      07340000
073500*    DECLARE FK_COLUMNS_CURSOR CURSOR                      *      07350000
073600************************************************************      07360000
073700*                                                                 07370000
073800     EXEC SQL                                                     07380000
073900      DECLARE FK_COLUMNS_CURSOR CURSOR FOR                        07390000
074000      SELECT    COLNAME                                           07400000
074100               ,COLSEQ                                            07410000
074200      FROM      SYSIBM.SYSFOREIGNKEYS                             07420000
074300      WHERE     TBNAME    = :VAR-128-TABLE-NAME                   07430054
074400      AND       CREATOR = :VAR-CMNEKCRE                           07440000
074500      AND       RELNAME = :SYSRELS-RELNAME                        07450000
074600      ORDER BY  COLSEQ                                            07460000
074700      WITH UR                                                     07470032
074800                                                                  07480000
074900   END-EXEC.                                                      07490000
075000     EJECT                                                        07500000
075100************************************************************      07510000
075200*    DECLARE VIEWS_CURSOR CURSOR                                  07520000
075300************************************************************      07530000
075400*                                                                 07540000
075500     EXEC SQL                                                     07550000
075600      DECLARE VIEWS_CURSOR CURSOR FOR                             07560000
075700       SELECT DNAME                                               07570000
075800            , DCREATOR                                            07580000
075900       FROM SYSIBM.SYSVIEWDEP                                     07590000
076000       WHERE BNAME       = :VAR-128-TABLE-NAME                    07600054
076100         AND BCREATOR    = :VAR-CMNEKCRE                          07610000
076200         AND BTYPE       = 'T'                                    07620000
076300       ORDER BY DNAME                                             07630000
076400      WITH UR                                                     07640032
076500                                                                  07650000
076600   END-EXEC.                                                      07660000
076700     EJECT                                                        07670000
076800************************************************************      07680000
076900*    DECLARE SYSINDEXES_CURSOR CURSOR                      *      07690000
077000************************************************************      07700000
077100*                                                                 07710000
077200     EXEC SQL                                                     07720000
077300      DECLARE SYSINDX_CURSOR CURSOR FOR                           07730000
077400      SELECT  NAME                                                07740000
077500             ,CREATOR                                             07750000
077600             ,UNIQUERULE                                          07760000
077700             ,CLUSTERING                                          07770000
077800             ,INDEXSPACE                                          07780000
077900             ,CLUSTERRATIO                                        07790000
078000             ,BPOOL                                               07800000
078100             ,REMARKS                                             07810000
078200             ,FIRSTKEYCARDF                                       07820032
078300             ,FULLKEYCARDF                                        07830032
078400      FROM   SYSIBM.SYSINDEXES                                    07840000
078500      WHERE     TBNAME    = :VAR-128-TABLE-NAME                   07850054
078600      AND       TBCREATOR   = :VAR-CMNEKCRE                       07860000
078700      ORDER BY  NAME                                              07870000
078800               ,CREATOR                                           07880000
078900      WITH UR                                                     07890032
079000   END-EXEC.                                                      07900000
079100     EJECT                                                        07910000
079200************************************************************      07920000
079300*    DECLARE SYSTRIG_CURSOR CURSOR                                07930000
079400************************************************************      07940000
079500*                                                                 07950000
079600     EXEC SQL                                                     07960000
079700      DECLARE SYSTRIG_CURSOR CURSOR FOR                           07970000
079800      SELECT  NAME                                                07980000
079900             ,TRIGTIME                                            07990000
080000             ,TRIGEVENT                                           08000000
080100             ,GRANULARITY                                         08010000
080200      FROM   SYSIBM.SYSTRIGGERS                                   08020000
080300      WHERE  TBNAME      = :VAR-128-TABLE-NAME                    08030054
080400        AND  TBOWNER     = :VAR-CMNEKCRE                          08040000
080500      ORDER BY  CREATEDTS                                         08050000
080600      WITH UR                                                     08060032
080700   END-EXEC.                                                      08070000
080800     EJECT                                                        08080000
080900************************************************************      08090000
081000*    DECLARE IX_COLUMNS_CURSOR CURSOR                      *      08100000
081100************************************************************      08110000
081200*                                                                 08120000
081300     EXEC SQL                                                     08130000
081400      DECLARE IX_COLUMNS_CURSOR CURSOR FOR                        08140000
081500      SELECT    COLNAME                                           08150000
081600               ,COLSEQ                                            08160000
081700               ,ORDERING                                          08170000
081800      FROM      SYSIBM.SYSKEYS                                    08180000
081900      WHERE     IXNAME    = :SYSINDEX-NAME                        08190000
082000      AND       IXCREATOR = :SYSINDEX-CREATOR                     08200000
082100      ORDER BY  COLSEQ                                            08210000
082200      WITH UR                                                     08220032
082300                                                                  08230000
082400   END-EXEC.                                                      08240000
082500     EJECT                                                        08250000
082600************************************************************      08260000
082700*    DECLARE SYSIXPT_CURSOR CURSOR                         *      08270000
082800************************************************************      08280000
082900*                                                                 08290000
083000     EXEC SQL                                                     08300000
083100      DECLARE SYSIXPT_CURSOR CURSOR FOR                           08310000
083200      SELECT    PARTITION                                         08320000
083300               ,FREEPAGE                                          08330000
083400               ,PCTFREE                                           08340000
083500      FROM      SYSIBM.SYSINDEXPART                               08350000
083600      WHERE     IXNAME    = :SYSINDEX-NAME                        08360000
083700      AND       IXCREATOR = :SYSINDEX-CREATOR                     08370000
083800      ORDER BY  PARTITION                                         08380000
083900      WITH UR                                                     08390032
084000                                                                  08400000
084100   END-EXEC.                                                      08410000
084200     EJECT                                                        08420000
084300************************************************************      08430000
084400*    DECLARE SYSCHK_CURSOR CURSOR                                 08440000
084500************************************************************      08450000
084600*                                                                 08460000
084700     EXEC SQL                                                     08470000
084800      DECLARE SYSCHK_CURSOR CURSOR FOR                            08480000
084900      SELECT CHECKNAME, CHECKCONDITION                            08490000
085000        FROM SYSIBM.SYSCHECKS                                     08500000
085100       WHERE TBNAME           =  :VAR-128-TABLE-NAME              08510054
085200         AND TBOWNER          =  :VAR-CMNEKCRE                    08520000
085300      ORDER BY CHECKNAME                                          08530000
085400      WITH UR                                                     08540032
085500                                                                  08550000
085600   END-EXEC.                                                      08560000
085700                                                                  08570018
085800************************************************************      08580000
085900*    SQL COMMUNICATIONS AREA DCLGEN                        *      08590000
086000************************************************************      08600000
086100*                                                                 08610000
086200     EXEC SQL                                                     08620000
086300         INCLUDE SQLCA                                            08630000
086400     END-EXEC.                                                    08640000
086500*                                                                 08650000
086600*                                                                 08660000
086700 PROCEDURE DIVISION.                                              08670000
086800                                                                  08680000
086900************************************************************      08690000
087000*    VDEFINES FOR PANEL                                    *      08700000
087100************************************************************      08710000
087200     MOVE LENGTH OF VAR-ZTEMPF TO PV-FIELD-LENGTH.                08720025
087300     CALL 'ISPLINK' USING ISP-VDEFINE NAM-ZTEMPF VAR-ZTEMPF       08730025
087400                          ISP-FORMAT PV-FIELD-LENGTH.             08740025
087500     MOVE LENGTH OF VAR-SMSG TO PV-FIELD-LENGTH.                  08750025
087600     CALL 'ISPLINK' USING ISP-VDEFINE NAM-SMSG VAR-SMSG           08760025
087700                          ISP-FORMAT PV-FIELD-LENGTH.             08770025
087800     MOVE LENGTH OF VAR-LMSG TO PV-FIELD-LENGTH.                  08780025
087900     CALL 'ISPLINK' USING ISP-VDEFINE NAM-LMSG VAR-LMSG           08790025
088000                          ISP-FORMAT PV-FIELD-LENGTH.             08800025
088100     MOVE LENGTH OF VAR-CMNEKTAB TO PV-FIELD-LENGTH.              08810025
088200     CALL 'ISPLINK' USING ISP-VDEFINE                             08820025
088300         NAM-CMNEKTAB  VAR-CMNEKTAB  CHAR  PV-FIELD-LENGTH.       08830025
088400     MOVE LENGTH OF VAR-CMNEKTB2 TO PV-FIELD-LENGTH.              08840053
088500     CALL 'ISPLINK' USING ISP-VDEFINE                             08850053
088600         NAM-CMNEKTB2  VAR-CMNEKTB2  CHAR  PV-FIELD-LENGTH.       08860053
088700     MOVE LENGTH OF VAR-CMNEKTB3 TO PV-FIELD-LENGTH.              08870059
088800     CALL 'ISPLINK' USING ISP-VDEFINE                             08880059
088900         NAM-CMNEKTB3  VAR-CMNEKTB3  CHAR  PV-FIELD-LENGTH.       08890059
089000     MOVE LENGTH OF VAR-CMNEKCRE TO PV-FIELD-LENGTH.              08900025
089100     CALL 'ISPLINK' USING ISP-VDEFINE                             08910025
089200         NAM-CMNEKCRE  VAR-CMNEKCRE  CHAR  PV-FIELD-LENGTH.       08920025
089300                                                                  08930000
089400************************************************************      08940000
089500*    VGETS FROM PROFILES                                   *      08950000
089600************************************************************      08960000
089700                                                                  08970000
089800     CALL 'ISPLINK' USING ISP-VGET NAM-ZTEMPF ISP-SHARED.         08980000
089900     MOVE SPACES TO ISP-MSG.                                      08990000
090000                                                                  09000007
090100     INSPECT VAR-ZTEMPF TALLYING PV-COUNTR FOR CHARACTERS         09010007
090200                 BEFORE INITIAL '.CNTL'.                          09020007
090300     MOVE VAR-ZTEMPF (1:PV-COUNTR)  TO PV-BROWSE-DSNAME.          09030021
090400     ADD 1 TO PV-COUNTR.                                          09040007
090500     MOVE PC-BROWSE-DSNAME-SUFFIX TO                              09050020
090600               PV-BROWSE-DSNAME (PV-COUNTR:5).                    09060021
090700                                                                  09070000
090800     PERFORM 1700-DISPLAY-PANEL THRU 1700-EXIT UNTIL              09080000
090900          RETURN-CODE NOT = 0.                                    09090000
091000                                                                  09100000
091100     IF PS-IS-ALLOCATED                                           09110013
091200         PERFORM 9100-DELETE-FILE                                 09120013
091300     END-IF.                                                      09130013
091400                                                                  09140000
091500     GOBACK.                                                      09150000
091600                                                                  09160000
091700************************************************************      09170000
091800*    DISPLAY THE PANEL                                     *      09180000
091900************************************************************      09190000
092000*                                                                 09200000
092100 1700-DISPLAY-PANEL.                                              09210000
092200                                                                  09220000
092220                                                                  09222099
092300     MOVE 'CMNEKCRE' TO ISP-CSR.                                  09230086
092400     MOVE 'CMNEKR2' TO ISP-PANEL.                                 09240000
092500     CALL 'ISPLINK' USING ISP-DISPLAY,                            09250000
092600                          ISP-PANEL,                              09260000
092700                          ISP-MSG,                                09270000
092800                          ISP-CSR.                                09280000
092900                                                                  09290000
093000     MOVE SPACES TO ISP-MSG.                                      09300000
093100     MOVE SPACES TO VAR-SMSG.                                     09310000
093200     MOVE SPACES TO VAR-LMSG.                                     09320000
093300                                                                  09330000
093400     IF RETURN-CODE NOT = 0                                       09340000
093500         GO TO 1700-EXIT.                                         09350000
093600                                                                  09360000
093700     PERFORM 2100-EDIT-INPUT THRU 2100-EXIT.                      09370000
093800     IF PS-USER-INPUT-NOT-VALID                                   09380000
093900         GO TO 1700-EXIT.                                         09390000
094000                                                                  09400000
094100     IF PS-IS-NOT-ALLOCATED                                       09410008
094200         PERFORM 3000-ALLOCATE-TEMP-FILE                          09420007
094300     END-IF.                                                      09430007
094400                                                                  09440000
094500     IF PS-IS-ALLOCATED                                           09450000
094600         OPEN OUTPUT BROWSE-FILE                                  09460000
094700         WRITE BROWSE-RECORD FROM REPORT-TITLE1                   09470000
094800         MOVE SPACES TO BROWSE-RECORD                             09480000
094900         WRITE BROWSE-RECORD                                      09490000
095000         PERFORM 4000-DB2-TABLE-FUNCTIONS                         09500000
095100             THRU 4000-EXIT                                       09510000
095200         MOVE SPACES TO BROWSE-RECORD                             09520000
095300         WRITE BROWSE-RECORD                                      09530000
095400         CLOSE BROWSE-FILE                                        09540015
095500     END-IF.                                                      09550015
095600                                                                  09560000
095700     IF ((PS-IS-ALLOCATED)                                        09570015
095800             AND (PS-NO-DB2-ERROR))                               09580015
095900         PERFORM 8000-BROWSE-FILE                                 09590008
096000     END-IF.                                                      09600008
096100                                                                  09610000
096200 1700-EXIT.                                                       09620000
096300     EXIT.                                                        09630000
096400     EJECT                                                        09640000
096500************************************************************      09650000
096600* SET SWITCHES TO INDICATE WHAT OPTION HAS BEEN SPECIFIED  *      09660000
096700* BY THE USER                                              *      09670000
096800************************************************************      09680000
096900 2100-EDIT-INPUT.                                                 09690000
097000                                                                  09700000
097100     SET PS-NOT-EOF-PRINT TO TRUE.                                09710000
097200     SET PS-NO-DB2-ERROR TO TRUE.                                 09720000
097300     MOVE 'Y' TO PS-USER-INPUT.                                   09730000
097400                                                                  09740000
097500     IF (VAR-CMNEKTAB = SPACES  AND                               09750054
097600         VAR-CMNEKTB2 = SPACES  AND                               09760059
097700         VAR-CMNEKTB3 = SPACES) OR                                09770059
097800        VAR-CMNEKCRE = SPACES                                     09780000
097900          MOVE 'N' TO PS-USER-INPUT                               09790000
098000          MOVE 'SPECIFY REQUIRED PARM' TO VAR-SMSG                09800000
098100          MOVE                                                    09810000
098200          'SUPPLY THE NAME OF THE DB2 TABLE AND ITS CREATOR'      09820000
098300              TO VAR-LMSG                                         09830000
098400          MOVE 'CMN000  ' TO ISP-MSG                              09840000
098500     ELSE                                                         09850000
098600         MOVE 'Y' TO PS-USER-INPUT                                09860063
098700         IF VAR-CMNEKTB2 NOT = SPACES                             09870063
098800             STRING VAR-CMNEKTAB        DELIMITED BY ' ',         09880063
098900                    VAR-CMNEKTB2        DELIMITED BY ' '          09890063
099000                 INTO VAR-128-TABLE-NAME                          09900063
099100             IF VAR-CMNEKTB3 NOT = SPACES                         09910063
099200                 STRING VAR-128-TABLE-NAME  DELIMITED BY ' '      09920063
099300                        VAR-CMNEKTB3        DELIMITED BY ' '      09930063
099400                     INTO VAR-128-TABLE-NAME                      09940063
099500             END-IF                                               09950063
099600         ELSE                                                     09960063
099700             IF VAR-CMNEKTB3 NOT = SPACES                         09970063
099800                 STRING VAR-CMNEKTAB        DELIMITED BY ' ',     09980063
099900                        VAR-CMNEKTB3        DELIMITED BY ' '      09990063
100000                     INTO VAR-128-TABLE-NAME                      10000063
100100             ELSE                                                 10010063
100200                 MOVE VAR-CMNEKTAB   TO VAR-128-TABLE-NAME        10020063
100300             END-IF                                               10030084
100310         END-IF                                                   10031084
100400     END-IF.                                                      10040063
100500 2100-EXIT.                                                       10050000
100600     EXIT.                                                        10060000
100700     EJECT                                                        10070000
100800************************************************************      10080000
100900* USE DYNALLOC TO ALLOCATE TEMP FILE THAT WILL BE DISPLAYED*      10090000
101000************************************************************      10100000
101100 3000-ALLOCATE-TEMP-FILE.                                         10110000
101200     PERFORM 9100-DELETE-FILE.                                    10120007
101300                                                                  10130014
101400     IF ((DP023-LASTRC = ZERO)                                    10140008
101500             OR (DP023-LASTRC = DP023-RC-DATASET-DOESNT-EXIST))   10150008
101600         INITIALIZE DP023-DYNALC-PARMS                            10160008
101700         MOVE PC-BROWSE-DDNAME TO DP023-DDNAME                    10170021
101800         MOVE PV-BROWSE-DSNAME TO DP023-DSNAME                    10180021
101900         SET DP023-DISP-NEW TO TRUE                               10190008
102000         SET DP023-FREE-CLOSE-NO TO TRUE                          10200008
102100         SET DP023-RECFM-FIXED-BLOCK TO TRUE                      10210008
102200         MOVE LENGTH OF BROWSE-RECORD TO DP023-RECSZ              10220026
102300         MOVE 2000 TO DP023-RECOUNT                               10230008
102400                                                                  10240008
102500         SET DP023-DISABLE-DISPLAY-ABEND TO TRUE                  10250008
102600                                                                  10260008
102700         PERFORM DP023-0000-DYNALC                                10270008
102800         IF DP023-LASTRC = ZERO                                   10280008
102900             SET PS-IS-ALLOCATED TO TRUE                          10290008
103000         ELSE                                                     10300008
103100             SET PS-IS-NOT-ALLOCATED TO TRUE                      10310008
103200             MOVE DP023-DDNAME TO PV-DR-DDNAME                    10320008
103300             MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE       10330008
103400             MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC      10340008
103500             MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG         10350008
103600             MOVE 'CMN000  ' TO ISP-MSG                           10360008
103700         END-IF                                                   10370008
103800     ELSE                                                         10380008
103900         SET PS-IS-NOT-ALLOCATED TO TRUE                          10390008
104000         MOVE DP023-DDNAME TO PV-DR-DDNAME                        10400008
104100         MOVE DP023-RC (DP023-SUB) TO PV-DR-RETURN-CODE           10410008
104200         MOVE DP023-DESC (DP023-SUB) TO PV-DR-ERROR-DESC          10420008
104300         MOVE PV-DYNALC-ROUTINE-ERROR-MSG TO VAR-LMSG             10430008
104400         MOVE 'CMN000  ' TO ISP-MSG                               10440008
104500     END-IF.                                                      10450008
104600                                                                  10460007
104700************************************************************      10470000
104800* MAIN-LINE LOGIC                                          *      10480000
104900************************************************************      10490000
105000 4000-DB2-TABLE-FUNCTIONS.                                        10500000
105100                                                                  10510000
105200     MOVE 'N' TO WS-END-COLCKS-SW.                                10520000
105300     MOVE 'Y' TO WS-FIRSTCK-SW.                                   10530000
105400     MOVE 'N' TO PS-TABLE-VALIDITY.                               10540000
105500     PERFORM 4100-SELECT-SYSTABLES THRU 4100-EXIT.                10550000
105600                                                                  10560000
105700     IF PS-DB2-ERROR OR                                           10570000
105800        PS-TABLE-IS-NOT-VALID                                     10580000
105900         GO TO 4000-EXIT.                                         10590000
106000                                                                  10600000
106100     PERFORM 4200-OPEN-SYSCOLUMNS-CURSOR                          10610000
106200         THRU 4200-EXIT.                                          10620000
106300     IF PS-DB2-ERROR                                              10630000
106400         GO TO 4000-EXIT.                                         10640000
106500                                                                  10650000
106600     MOVE 'N' TO PS-PKEY.                                         10660000
106700     PERFORM 4300-FETCH-SYSCOLUMNS THRU 4300-EXIT                 10670000
106800         UNTIL SQLCODE NOT = ZERO.                                10680000
106900     IF PS-DB2-ERROR                                              10690000
107000         GO TO 4000-EXIT.                                         10700000
107100                                                                  10710000
107200     PERFORM 4400-CLOSE-SYSCOLUMNS-CURSOR                         10720000
107300         THRU 4400-EXIT.                                          10730000
107400     IF PS-DB2-ERROR                                              10740000
107500         GO TO 4000-EXIT.                                         10750000
107600                                                                  10760000
107700     MOVE SPACES TO BROWSE-RECORD.                                10770000
107800     WRITE BROWSE-RECORD.                                         10780000
107900                                                                  10790000
108000     IF PS-PKEY-NOT-DEFINED                                       10800000
108100         MOVE '  NO PRIMARY KEY IS DEFINED FOR THIS TABLE'        10810000
108200             TO BROWSE-RECORD                                     10820000
108300         WRITE BROWSE-RECORD                                      10830000
108400     ELSE                                                         10840000
108500         MOVE '  THE PRIMARY KEY FOR THIS TABLE IS DEFINED AS'    10850000
108600             TO BROWSE-RECORD                                     10860000
108700         WRITE BROWSE-RECORD                                      10870000
108800         PERFORM 4500-OPEN-PK-COLUMNS-CURSOR                      10880000
108900             THRU 4500-EXIT                                       10890000
109000         IF PS-DB2-ERROR                                          10900000
109100             GO TO 4000-EXIT                                      10910000
109200         END-IF                                                   10920000
109300         MOVE 'N' TO PS-KEY-COLUMN-SELECT                         10930000
109400         PERFORM 4600-FETCH-PK-COLUMNS THRU 4600-EXIT             10940000
109500             UNTIL SQLCODE NOT = ZERO                             10950000
109600         IF PS-DB2-ERROR                                          10960000
109700             GO TO 4000-EXIT                                      10970000
109800         END-IF                                                   10980000
109900         PERFORM 4700-CLOSE-PK-COLUMNS-CURSOR                     10990000
110000             THRU 4700-EXIT                                       11000000
110100         IF PS-DB2-ERROR                                          11010000
110200             GO TO 4000-EXIT                                      11020000
110300         END-IF                                                   11030000
110400     END-IF.                                                      11040000
110500                                                                  11050000
110600     MOVE SPACES TO BROWSE-RECORD.                                11060000
110700     WRITE BROWSE-RECORD.                                         11070000
110800                                                                  11080000
110900     PERFORM 4750-SELECT-FK-COUNT THRU 4750-EXIT.                 11090000
111000                                                                  11100000
111100     IF PS-DB2-ERROR                                              11110000
111200         GO TO 4000-EXIT.                                         11120000
111300                                                                  11130000
111400     IF FK-COUNTER NOT = ZERO                                     11140000
111500         MOVE FK-COUNTER TO FK-COUNT                              11150000
111600         MOVE ':' TO FK-INFO-COLON                                11160000
111700     ELSE                                                         11170000
111800         MOVE 'NO' TO FK-COUNT-X                                  11180000
111900         MOVE SPACE TO FK-INFO-COLON.                             11190000
112000     WRITE BROWSE-RECORD FROM FK-INFO-LINE.                       11200000
112100                                                                  11210000
112200     MOVE SPACES TO BROWSE-RECORD.                                11220000
112300     WRITE BROWSE-RECORD.                                         11230000
112400                                                                  11240000
112500     IF FK-COUNTER NOT = ZERO                                     11250000
112600         PERFORM 4800-OPEN-SYSRELS-CURSOR                         11260000
112700             THRU 4800-EXIT                                       11270000
112800         IF PS-DB2-ERROR                                          11280000
112900             GO TO 4000-EXIT                                      11290000
113000         END-IF                                                   11300000
113100         PERFORM 4820-FETCH-SYSRELS                               11310000
113200             THRU 4820-EXIT FK-COUNTER TIMES                      11320000
113300         IF PS-DB2-ERROR                                          11330000
113400             GO TO 4000-EXIT                                      11340000
113500         END-IF                                                   11350000
113600         PERFORM 4840-CLOSE-SYSRELS-CURSOR                        11360000
113700             THRU 4840-EXIT                                       11370000
113800         IF PS-DB2-ERROR                                          11380000
113900             GO TO 4000-EXIT                                      11390000
114000         END-IF.                                                  11400000
114100                                                                  11410000
114200     MOVE SPACES TO BROWSE-RECORD.                                11420000
114300     WRITE BROWSE-RECORD.                                         11430000
114400                                                                  11440000
114500     PERFORM 4770-SELECT-FK-COUNT THRU 4770-EXIT.                 11450000
114600     IF PS-DB2-ERROR                                              11460000
114700         GO TO 4000-EXIT.                                         11470000
114800                                                                  11480000
114900     IF FK-COUNTER NOT = ZERO                                     11490000
115000         MOVE FK-COUNTER TO PC-COUNT                              11500000
115100         MOVE ':' TO PC-INFO-COLON                                11510000
115200     ELSE                                                         11520000
115300         MOVE 'NO' TO PC-COUNT-X                                  11530000
115400         MOVE SPACE TO PC-INFO-COLON.                             11540000
115500     WRITE BROWSE-RECORD FROM PC-INFO-LINE.                       11550000
115600     MOVE SPACES TO BROWSE-RECORD.                                11560000
115700     WRITE BROWSE-RECORD.                                         11570000
115800                                                                  11580000
115900     IF FK-COUNTER NOT = ZERO                                     11590000
116000         PERFORM 6800-OPEN-SYSR-CURSOR                            11600000
116100             THRU 6800-EXIT                                       11610000
116200         IF PS-DB2-ERROR                                          11620000
116300             GO TO 4000-EXIT                                      11630000
116400         END-IF                                                   11640000
116500         PERFORM 6820-FETCH-SYSR                                  11650000
116600             THRU 6820-EXIT FK-COUNTER TIMES                      11660000
116700         IF PS-DB2-ERROR                                          11670000
116800             GO TO 4000-EXIT                                      11680000
116900         END-IF                                                   11690000
117000         PERFORM 6840-CLOSE-SYSR-CURSOR                           11700000
117100             THRU 6840-EXIT                                       11710000
117200         IF PS-DB2-ERROR                                          11720000
117300             GO TO 4000-EXIT                                      11730000
117400         END-IF.                                                  11740000
117500                                                                  11750000
117600     MOVE SPACES TO BROWSE-RECORD.                                11760000
117700     WRITE BROWSE-RECORD.                                         11770000
117800                                                                  11780000
117900**                                                                11790029
118000     PERFORM 5110-SELECT-VIEW-COUNT THRU 5110-EXIT.               11800000
118100     IF PS-DB2-ERROR                                              11810000
118200         GO TO 4000-EXIT.                                         11820000
118300                                                                  11830000
118400     IF VIEW-COUNTER NOT = ZERO                                   11840000
118500         MOVE VIEW-COUNTER TO VIEW-COUNT                          11850000
118600         MOVE ' '          TO VIEW-INFO-COLON                     11860030
118700*        MOVE ':'          TO VIEW-INFO-COLON                     11870030
118800     ELSE                                                         11880000
118900         MOVE 'NO'         TO VIEW-COUNT-X                        11890000
119000         MOVE SPACE        TO VIEW-INFO-COLON                     11900000
119100     END-IF.                                                      11910000
119200                                                                  11920000
119300     WRITE BROWSE-RECORD FROM VIEW-INFO-LINE.                     11930000
119400     MOVE SPACES TO BROWSE-RECORD.                                11940000
119500     WRITE BROWSE-RECORD.                                         11950000
119600                                                                  11960000
119700*    IF VIEW-COUNTER NOT = ZERO                                   11970029
119800*        PERFORM 5120-OPEN-VIEWS-CURSOR                           11980029
119900*            THRU 5120-EXIT                                       11990029
120000*        IF PS-DB2-ERROR                                          12000029
120100*            GO TO 4000-EXIT                                      12010029
120200*        END-IF                                                   12020029
120300*        MOVE 'N' TO PS-KEY-COLUMN-SELECT                         12030029
120400*        PERFORM 5130-FETCH-VIEWS                                 12040029
120500*            THRU 5130-EXIT VIEW-COUNTER TIMES                    12050029
120600*        IF PS-DB2-ERROR                                          12060029
120700*            GO TO 4000-EXIT                                      12070029
120800*        END-IF                                                   12080029
120900*        PERFORM 5140-CLOSE-VIEWS-CURSOR                          12090029
121000*            THRU 5140-EXIT                                       12100029
121100*        IF PS-DB2-ERROR                                          12110029
121200*            GO TO 4000-EXIT                                      12120029
121300*        END-IF.                                                  12130029
121400*                                                                 12140029
121500     MOVE SPACES TO BROWSE-RECORD.                                12150000
121600     WRITE BROWSE-RECORD.                                         12160000
121700                                                                  12170000
121800     PERFORM 4760-SELECT-IX-COUNT THRU 4760-EXIT.                 12180000
121900     IF PS-DB2-ERROR                                              12190000
122000         GO TO 4000-EXIT.                                         12200000
122100                                                                  12210000
122200     IF IX-COUNTER NOT = ZERO                                     12220000
122300         MOVE IX-COUNTER TO IX-COUNT                              12230000
122400         MOVE ':' TO IX-INFO-COLON                                12240000
122500     ELSE                                                         12250000
122600         MOVE 'NO' TO IX-COUNT-X                                  12260000
122700         MOVE SPACE TO IX-INFO-COLON.                             12270000
122800     WRITE BROWSE-RECORD FROM IX-INFO-LINE.                       12280000
122900                                                                  12290000
123000     MOVE SPACES TO BROWSE-RECORD.                                12300000
123100     WRITE BROWSE-RECORD.                                         12310000
123200                                                                  12320000
123300     IF IX-COUNTER NOT = ZERO                                     12330000
123400         PERFORM 5800-OPEN-SYSINDEX-CURSOR                        12340000
123500             THRU 5800-EXIT                                       12350000
123600         IF PS-DB2-ERROR                                          12360000
123700             GO TO 4000-EXIT                                      12370000
123800         END-IF                                                   12380000
123900         PERFORM 5820-FETCH-SYSINDX                               12390000
124000             THRU 5820-EXIT IX-COUNTER TIMES                      12400000
124100         IF PS-DB2-ERROR                                          12410000
124200             GO TO 4000-EXIT                                      12420000
124300         END-IF                                                   12430000
124400         PERFORM 5840-CLOSE-SYSINDEX-CURSOR                       12440000
124500             THRU 5840-EXIT                                       12450000
124600         IF PS-DB2-ERROR                                          12460000
124700             GO TO 4000-EXIT                                      12470000
124800         END-IF.                                                  12480000
124900                                                                  12490000
125000         MOVE SPACES TO BROWSE-RECORD.                            12500000
125100         WRITE BROWSE-RECORD.                                     12510000
125200                                                                  12520000
125300         PERFORM 4773-SELECT-TRIG-COUNT THRU 4773-EXIT.           12530000
125400         IF PS-DB2-ERROR                                          12540000
125500            GO TO 4000-EXIT.                                      12550000
125600                                                                  12560000
125700         IF TRIG-COUNTER NOT = ZERO                               12570000
125800            MOVE TRIG-COUNTER TO TRIG-COUNT                       12580000
125900            MOVE ':'          TO TRIG-INFO-COLON                  12590000
126000         ELSE                                                     12600000
126100            MOVE 'NO' TO TRIG-COUNT-X                             12610000
126200            MOVE SPACE TO TRIG-INFO-COLON                         12620000
126300         END-IF.                                                  12630000
126400         WRITE BROWSE-RECORD FROM TRIG-INFO-LINE.                 12640000
126500                                                                  12650000
126600         MOVE SPACES TO BROWSE-RECORD.                            12660000
126700         WRITE BROWSE-RECORD.                                     12670000
126800                                                                  12680000
126900         IF TRIG-COUNTER NOT = ZERO                               12690000
127000            PERFORM 7800-OPEN-SYSTRIG-CURSOR                      12700000
127100               THRU 7800-EXIT                                     12710000
127200            IF PS-DB2-ERROR                                       12720000
127300               GO TO 4000-EXIT                                    12730000
127400            END-IF                                                12740000
127500            PERFORM 7820-FETCH-SYSTRIG                            12750000
127600               THRU 7820-EXIT TRIG-COUNTER TIMES                  12760000
127700            IF PS-DB2-ERROR                                       12770000
127800               GO TO 4000-EXIT                                    12780000
127900            END-IF                                                12790000
128000            PERFORM 7840-CLOSE-SYSTRIG-CURSOR                     12800000
128100               THRU 7840-EXIT                                     12810000
128200            IF PS-DB2-ERROR                                       12820000
128300               GO TO 4000-EXIT                                    12830000
128400            END-IF                                                12840000
128500         END-IF.                                                  12850000
128600                                                                  12860000
128700      IF PROCESS-CKS                                              12870000
128800         PERFORM 7900-OPEN-COL-CKS                                12880000
128900            THRU 7900-EXIT                                        12890000
129000               IF PS-DB2-ERROR                                    12900000
129100                  GO TO 4000-EXIT                                 12910000
129200               END-IF                                             12920000
129300         PERFORM 7905-FETCH-COL-CKS                               12930000
129400            THRU 7905-EXIT UNTIL END-COLCKS                       12940000
129500               IF PS-DB2-ERROR                                    12950000
129600                  GO TO 4000-EXIT                                 12960000
129700               END-IF                                             12970000
129800         PERFORM 7990-CLOSE-COL-CKS                               12980000
129900            THRU 7990-EXIT                                        12990000
130000               IF PS-DB2-ERROR                                    13000000
130100                  GO TO 4000-EXIT                                 13010000
130200               END-IF                                             13020000
130300      END-IF.                                                     13030000
130400                                                                  13040000
130500                                                                  13050000
130600 4000-EXIT.                                                       13060000
130700     EXIT.                                                        13070000
130800     EJECT                                                        13080000
130900************************************************************      13090000
131000* SELECT THE ROW FROM SYSIBM.SYSTABLES                     *      13100000
131100************************************************************      13110000
131200 4100-SELECT-SYSTABLES.                                           13120000
131300                                                                  13130000
131400     INITIALIZE DCLSYSTABLES.                                     13140000
131500                                                                  13150000
131600     EXEC SQL                                                     13160000
131700         SELECT                                                   13170000
131800                DBNAME                                            13180000
131900               ,TSNAME                                            13190000
132000               ,CARDF                                             13200000
132100               ,REMARKS                                           13210000
132200               ,RECLENGTH                                         13220000
132300               ,STATSTIME                                         13230000
132400               ,COLCOUNT                                          13240000
132500               ,CHECKS                                            13250000
132600         INTO                                                     13260000
132700               :SYSTBL-DBNAME                                     13270099
132800              ,:SYSTBL-TSNAME                                     13280099
132900              ,:SYSTBL-CARDF                                      13290099
133000              ,:SYSTBL-REMARKS                                    13300099
133100              ,:SYSTBL-RECLENGTH                                  13310099
133200              ,:SYSTBL-STATSTIME                                  13320099
133300              ,:SYSTBL-COLCOUNT                                   13330099
133400              ,:SYSTBL-CHECKS                                     13340099
133500         FROM  SYSIBM.SYSTABLES                                   13350000
133600         WHERE NAME    =  :VAR-128-TABLE-NAME                     13360054
133700         AND   CREATOR =  :VAR-CMNEKCRE                           13370000
133800        WITH UR                                                   13380032
133900     END-EXEC.                                                    13390000
134000                                                                  13400000
134100     IF SQLCODE = ZERO                                            13410000
134200         MOVE SPACES TO BROWSE-RECORD                             13420000
134300         MOVE VAR-128-TABLE-NAME (1:58)  TO WS-TABLE-NAME-1       13430079
134301         MOVE VAR-128-TABLE-NAME (59:70) TO WS-TABLE-NAME-2       13430179
134310         STRING  '   TABLE = '        DELIMITED BY SIZE,          13431079
134400                 VAR-CMNEKCRE         DELIMITED BY ' ',           13440000
134500                 '.'                  DELIMITED BY SIZE,          13450000
134600                 WS-TABLE-NAME-1      DELIMITED BY ' '            13460079
134700             INTO BROWSE-RECORD                                   13470000
134800         WRITE BROWSE-RECORD                                      13480000
134801         MOVE SPACES  TO BROWSE-RECORD                            13480181
134810         IF WS-TABLE-NAME-2 > SPACES                              13481079
134820             STRING  '           '        DELIMITED BY SIZE,      13482079
134850                     WS-TABLE-NAME-2      DELIMITED BY ' '        13485079
134860                 INTO BROWSE-RECORD                               13486079
134870             WRITE BROWSE-RECORD                                  13487079
134880         END-IF                                                   13488079
134900         MOVE SPACES  TO BROWSE-RECORD                            13490055
135000         STRING  '   TABLE DESC   = '   DELIMITED BY SIZE,        13500055
135100                 SYSTBL-REMARKS-TEXT DELIMITED BY '      '        13510099
135200             INTO BROWSE-RECORD                                   13520054
135300         WRITE BROWSE-RECORD                                      13530054
135400         MOVE SYSTBL-DBNAME-TEXT TO TITLE-DATABASE                13540099
135500         MOVE SYSTBL-TSNAME-TEXT TO TITLE-TABLESPACE              13550099
135600         PERFORM 4150-SELECT-SYSTABLESPACE THRU 4150-EXIT         13560000
135700         IF SYSTABSP-TYPE = 'L'                                   13570000
135800             MOVE 'TYPE  = LARGE' TO TITLE-TABLESPACE-TYPE        13580000
135900         ELSE                                                     13590000
136000             IF SYSTABSP-TYPE = 'O'                               13600043
136100                 MOVE 'TYPE  = LOB' TO TITLE-TABLESPACE-TYPE      13610043
136200             ELSE                                                 13620043
136300                 MOVE SPACES TO TITLE-TABLESPACE-TYPE             13630043
136400             END-IF                                               13640044
136500         END-IF                                                   13650000
136600         WRITE BROWSE-RECORD FROM REPORT-TITLE2                   13660000
136700         IF SYSTABSP-PARTITIONS = 0                               13670000
136800             MOVE SYSTABSP-SEGSIZE TO SEGSIZE-NO                  13680000
136900             IF SYSTABSP-LOCKRULE = 'A'                           13690000
137000                 MOVE 'ANY '  TO LOCKRULE                         13700000
137100*                MOVE 'ANY '  TO LOCKRULE-S                       13710000
137200             ELSE                                                 13720000
137300             IF SYSTABSP-LOCKRULE = 'P'                           13730000
137400                 MOVE 'PAGE'  TO LOCKRULE                         13740000
137500             ELSE                                                 13750000
137600             IF SYSTABSP-LOCKRULE = 'R'                           13760000
137700                 MOVE 'ROW '  TO LOCKRULE                         13770000
137800             ELSE                                                 13780000
137900             IF SYSTABSP-LOCKRULE = 'S'                           13790000
138000                 MOVE 'TS  '  TO LOCKRULE                         13800000
138100             ELSE                                                 13810000
138200                 MOVE 'TBL '  TO LOCKRULE                         13820000
138300             END-IF                                               13830000
138400             END-IF                                               13840000
138500             END-IF                                               13850000
138600             END-IF                                               13860000
138700             MOVE SYSTABSP-BPOOL    TO BPOOL-NO-S                 13870000
138800             WRITE BROWSE-RECORD FROM REPORT-TITLE3S              13880000
138900             PERFORM 4160-SELECT-SYSTABLEPART THRU 4160-EXIT      13890000
139000             MOVE SYSTBPT-FREEPAGE TO FREEPG-NO                   13900057
139100             IF SYSTBPT-COMPRESS = 'Y'                            13910057
139200                 MOVE 'YES'  TO CMPRESS                           13920000
139300             ELSE                                                 13930000
139400                 MOVE 'NO '  TO CMPRESS                           13940000
139500             END-IF                                               13950000
139600             WRITE BROWSE-RECORD FROM REPORT-TITLE4FP             13960000
139700         ELSE                                                     13970000
139800             MOVE SYSTABSP-PARTITIONS TO PART-NO                  13980000
139900             IF SYSTABSP-LOCKRULE = 'A'                           13990000
140000                 MOVE 'ANY '  TO LOCKRULE                         14000000
140100             ELSE                                                 14010000
140200             IF SYSTABSP-LOCKRULE = 'P'                           14020000
140300                 MOVE 'PAGE'  TO LOCKRULE                         14030000
140400             ELSE                                                 14040000
140500             IF SYSTABSP-LOCKRULE = 'R'                           14050000
140600                 MOVE 'ROW '  TO LOCKRULE                         14060000
140700             ELSE                                                 14070000
140800             IF SYSTABSP-LOCKRULE = 'S'                           14080000
140900                 MOVE 'TS  '  TO LOCKRULE                         14090000
141000             ELSE                                                 14100000
141100                 MOVE 'TBL '  TO LOCKRULE                         14110000
141200             END-IF                                               14120000
141300             END-IF                                               14130000
141400             END-IF                                               14140000
141500             END-IF                                               14150000
141600             MOVE SYSTABSP-BPOOL    TO BPOOL-NO-P                 14160000
141700             WRITE BROWSE-RECORD FROM REPORT-TITLE3P              14170000
141800         END-IF                                                   14180000
141900         MOVE SYSTBL-COLCOUNT TO COL-COUNTA, COL-COUNTB           14190099
142000                                                                  14200045
142100         MOVE SYSTBL-CARDF TO WS-ROW-NO                           14210099
142200         UNSTRING WS-ROW-NO-ALPH                                  14220045
142300           DELIMITED BY ALL SPACE                                 14230045
142400             INTO WS-UNSTRING-01, ROW-NO                          14240045
142500                                                                  14250045
142600         MOVE SYSTBL-STATSTIME TO WK-RS-DATE-TIME                 14260099
142700         MOVE WK-RS-DATE         TO RS-DATE                       14270000
142800         WRITE BROWSE-RECORD FROM REPORT-TITLE4                   14280000
142900**                                                                14290000
143000         MOVE SYSTBL-RECLENGTH TO REC-LEN                         14300099
143100         WRITE BROWSE-RECORD FROM REPORT-TITLE4A                  14310000
143200**                                                                14320000
143300         PERFORM 4125-GET-DCLGEN-NAME THRU                        14330000
143400                 4125-EXIT                                        14340000
143500         MOVE SPACES TO BROWSE-RECORD                             14350000
143600         MOVE SYSTABSP-NACTIVE TO ACT-PAGE                        14360000
143700         WRITE BROWSE-RECORD FROM REPORT-TITLE45                  14370000
143800**                                                                14380000
143900                                                                  14390000
144000         MOVE SPACES TO BROWSE-RECORD                             14400000
144100                                                                  14410000
144200         IF SYSTABSP-PARTITIONS = 0                               14420000
144300            MOVE SYSTBPT-PCTFREE   TO PCTFREE-NO                  14430057
144400            WRITE BROWSE-RECORD FROM REPORT-TITLECKM              14440000
144500            MOVE SPACES TO BROWSE-RECORD                          14450000
144600            MOVE SYSTBL-CHECKS TO CHECKS-A, CHECKS-B              14460099
144700            WRITE BROWSE-RECORD FROM REPORT-TITLECK               14470000
144800         ELSE                                                     14480000
144900            MOVE SYSTBPT-PCTFREE   TO PCTFREE-NO                  14490057
145000            MOVE SYSTBL-CHECKS TO CHECKS-A, CHECKS-B              14500099
145100            WRITE BROWSE-RECORD FROM REPORT-TITLECKK              14510000
145200         END-IF                                                   14520000
145300                                                                  14530000
145400**                                                                14540000
145500         MOVE SPACES TO BROWSE-RECORD                             14550000
145600         WRITE BROWSE-RECORD                                      14560000
145700         WRITE BROWSE-RECORD FROM REPORT-TITLE6                   14570000
145800         WRITE BROWSE-RECORD FROM REPORT-TITLE7                   14580000
145900         MOVE 'Y' TO PS-TABLE-VALIDITY                            14590000
146000         GO TO 4100-EXIT.                                         14600000
146100     IF SQLCODE = +100                                            14610000
146200         MOVE VAR-CMNEKCRE TO NO-MATCH-INFO-CREATOR               14620000
146300         MOVE VAR-128-TABLE-NAME TO NO-MATCH-INFO-TABLE-NAME      14630054
146400         WRITE BROWSE-RECORD FROM NO-MATCH-INFO                   14640000
146500     ELSE                                                         14650000
146600         SET PS-DB2-ERROR TO TRUE                                 14660000
146700         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      14670000
146800         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         14680000
146900         MOVE                                                     14690000
147000         '4100-SELECT-SYSTABLES ABEND, CONTACT DATA RESOURCE'     14700000
147100             TO VAR-LMSG                                          14710000
147200         MOVE 'CMN000  ' TO ISP-MSG.                              14720000
147300                                                                  14730000
147400  4100-EXIT.                                                      14740000
147500     EXIT.                                                        14750000
147600     EJECT                                                        14760000
147700************************************************************      14770000
147800* GET THE DCLGEN NAME FROM THE DBT_DCGLEN_XREF TABLE. IF   *      14780000
147900*  IT DOES NOT EXIST IN TABLE AND IS A PEOPLESOFT TABLE    *      14790000
148000*  (PS_) THEN DISPLAY "N/A" ELSE DCLGEN IS SAME AS TABLE   *      14800000
148100*  NAME.                                                   *      14810000
148200************************************************************      14820000
148300 4125-GET-DCLGEN-NAME.                                            14830000
148400                                                                  14840000
148500     INITIALIZE DCLDBT00001.                                      14850000
148600                                                                  14860000
148700     MOVE SPACES TO WS-PSOFT-PREFIX.                              14870000
148710     IF WS-POS4 NOT =  'P'                                        14871099
148720         MOVE 'N/A'        TO DCLGEN-NM                           14872099
148730         GO TO 4125-EXIT                                          14873099
148740     END-IF.                                                      14874099
148800                                                                  14880000
148900     IF WS-POS56  = 'FI' OR                                       14890085
148910        WS-POS56  = 'HR' OR                                       14891085
148920        WS-POS56  = 'ZC' OR                                       14892085
148930        WS-POS56  = 'ZE' OR                                       14893085
148940        WS-POS56  = 'ZP'                                          14894085
149000         MOVE WS-POS56  TO   WS-PSOFT-PREFIX                      14900085
149100     ELSE                                                         14910000
149500         IF WS-POS78     = 'FI' OR                                14950085
149510            WS-POS78     = 'HR' OR                                14951085
149520            WS-POS78     = 'ZC' OR                                14952085
149530            WS-POS78     = 'ZE' OR                                14953085
149540            WS-POS78     = 'ZP'                                   14954085
149600             MOVE WS-POS78 TO  WS-PSOFT-PREFIX                    14960085
149700         ELSE                                                     14970085
150100             IF WS-POS67  =  'FI' OR                              15010085
150110                WS-POS67  =  'HR' OR                              15011085
150120                WS-POS67  =  'ZC' OR                              15012085
150130                WS-POS67  =  'ZE' OR                              15013085
150140                WS-POS67  =  'ZP'                                 15014085
150200                 MOVE WS-POS67 TO WS-PSOFT-PREFIX                 15020085
150600             ELSE                                                 15060085
150700                 MOVE SPACES TO WS-PSOFT-PREFIX                   15070085
151100             END-IF                                               15110000
151200         END-IF                                                   15120000
151300     END-IF.                                                      15130000
151400                                                                  15140000
151500     EXEC SQL                                                     15150000
151600         SELECT DCLGEN_NM                                         15160000
151700         INTO  :DBT00001-DCLGEN-NM                                15170000
151800         FROM  DB2PMVS.DB2PDBA.DBT_DCLGEN_XREF                    15180000
151900         WHERE  OBJ_NM      =  :VAR-128-TABLE-NAME                15190054
152000           AND (OBJ_QUAL_NM =  :WS-PSOFT-PREFIX                   15200000
152100            OR  OBJ_QUAL_NM IS NULL)                              15210000
152200        WITH UR                                                   15220032
152300     END-EXEC.                                                    15230000
152400                                                                  15240000
152500     IF SQLCODE = +100                                            15250000
152600        IF WS-PSOFT-PREFIX = 'FI' OR 'HR'                         15260000
152700           OR    WS-FIRST2 = 'PS'                                 15270000
152800              MOVE 'N/A'        TO DCLGEN-NM                      15280000
152900        ELSE                                                      15290000
153000           MOVE VAR-128-TABLE-NAME TO DCLGEN-NM                   15300054
153100        END-IF                                                    15310000
153200     ELSE                                                         15320000
153300       IF SQLCODE = 0                                             15330000
153400           MOVE DBT00001-DCLGEN-NM TO DCLGEN-NM                   15340000
153500       ELSE                                                       15350000
153600         SET PS-DB2-ERROR TO TRUE                                 15360000
153700         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      15370000
153800         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         15380000
153900         MOVE                                                     15390000
154000         '4125-GET-DCLGEN-NAME ABEND, CONTACT A DBA'              15400090
154010***          SQLERRMC                                             15401090
154100             TO VAR-LMSG                                          15410000
154200         MOVE 'CMN000  ' TO ISP-MSG                               15420000
154300       END-IF                                                     15430000
154400     END-IF.                                                      15440000
154500                                                                  15450000
154600  4125-EXIT.                                                      15460000
154700     EXIT.                                                        15470000
154800     EJECT                                                        15480000
154900************************************************************      15490000
155000* SELECT THE ROW FROM SYSIBM.SYSTABLESPACE                 *      15500000
155100************************************************************      15510000
155200 4150-SELECT-SYSTABLESPACE.                                       15520000
155300                                                                  15530000
155400     INITIALIZE DCLSYSTABLESPACE.                                 15540000
155500                                                                  15550000
155600     EXEC SQL                                                     15560000
155700         SELECT                                                   15570000
155800                BPOOL                                             15580078
155900               ,PARTITIONS                                        15590000
156000               ,LOCKRULE                                          15600000
156100               ,SEGSIZE                                           15610000
156200               ,TYPE                                              15620000
156300               ,NACTIVE                                           15630000
156400         INTO                                                     15640000
156510               :SYSTABSP-BPOOL                                    15651078
156600              ,:SYSTABSP-PARTITIONS                               15660000
156700              ,:SYSTABSP-LOCKRULE                                 15670000
156800              ,:SYSTABSP-SEGSIZE                                  15680000
156900              ,:SYSTABSP-TYPE                                     15690000
157000              ,:SYSTABSP-NACTIVE                                  15700000
157100         FROM  SYSIBM.SYSTABLESPACE                               15710000
157200         WHERE NAME    =  :SYSTBL-TSNAME                          15720099
157300         AND   DBNAME  =  :SYSTBL-DBNAME                          15730099
157400        WITH UR                                                   15740032
157500     END-EXEC.                                                    15750000
157600                                                                  15760000
157700     IF SQLCODE NOT = ZERO                                        15770000
157800         SET PS-DB2-ERROR TO TRUE                                 15780000
157900         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      15790000
158000         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         15800000
158100         MOVE                                                     15810000
158200         '4150-SELECT-SYSTABLESPACE ABEND, CONTACT DATA RESOURCE' 15820000
158300             TO VAR-LMSG                                          15830000
158400         MOVE 'CMN000  ' TO ISP-MSG.                              15840000
158500                                                                  15850000
158600  4150-EXIT.                                                      15860000
158700     EXIT.                                                        15870000
158800     EJECT                                                        15880000
158900************************************************************      15890000
159000* SELECT THE ROW FROM SYSIBM.SYSTABLEPART                  *      15900000
159100************************************************************      15910000
159200 4160-SELECT-SYSTABLEPART.                                        15920000
159300                                                                  15930000
159400     INITIALIZE DCLSYSTABLEPART.                                  15940000
159500                                                                  15950000
159600     EXEC SQL                                                     15960000
159700         SELECT                                                   15970000
159800                FREEPAGE                                          15980000
159900               ,PCTFREE                                           15990000
160000               ,COMPRESS                                          16000000
160100         INTO                                                     16010000
160200               :SYSTBPT-FREEPAGE                                  16020057
160300              ,:SYSTBPT-PCTFREE                                   16030057
160400              ,:SYSTBPT-COMPRESS                                  16040057
160500         FROM  SYSIBM.SYSTABLEPART                                16050000
160600         WHERE TSNAME  =  :SYSTBL-TSNAME                          16060099
160700         AND   DBNAME  =  :SYSTBL-DBNAME                          16070099
160800        WITH UR                                                   16080032
160900     END-EXEC.                                                    16090000
161000                                                                  16100000
161100     IF SQLCODE NOT = ZERO                                        16110000
161200         SET PS-DB2-ERROR TO TRUE                                 16120000
161300         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      16130000
161400         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         16140000
161500         MOVE                                                     16150000
161600         '4160-SELECT-SYSTABLEPART ABEND, CONTACT DATA RESOURCE'  16160000
161700             TO VAR-LMSG                                          16170000
161800         MOVE 'CMN000  ' TO ISP-MSG.                              16180000
161900                                                                  16190000
162000  4160-EXIT.                                                      16200000
162100     EXIT.                                                        16210000
162200     EJECT                                                        16220000
162300************************************************************      16230000
162400* OPEN SYSCOLUMNS_CURSOR CURSOR                            *      16240000
162500************************************************************      16250000
162600 4200-OPEN-SYSCOLUMNS-CURSOR.                                     16260000
162700                                                                  16270000
162800      EXEC SQL                                                    16280000
162900          OPEN SYSCOLUMNS_CURSOR                                  16290000
163000      END-EXEC.                                                   16300000
163100                                                                  16310000
163200      IF SQLCODE NOT = 0                                          16320000
163300          SET PS-DB2-ERROR TO TRUE                                16330000
163400          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     16340000
163500          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        16350000
163600          MOVE '4200-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    16360000
163700               TO VAR-LMSG                                        16370000
163800          MOVE 'CMN000  ' TO ISP-MSG.                             16380000
163900                                                                  16390000
164000 4200-EXIT.                                                       16400000
164100     EXIT.                                                        16410000
164200     EJECT                                                        16420000
164300************************************************************      16430000
164400* FETCH THE ROWS FROM SYSIBM.SYSCOLUMNS                    *      16440000
164500************************************************************      16450000
164600 4300-FETCH-SYSCOLUMNS.                                           16460000
164700                                                                  16470000
164800     INITIALIZE DCLSYSCOLUMNS.                                    16480000
164900                                                                  16490000
165000     EXEC SQL                                                     16500000
165100         FETCH SYSCOLUMNS_CURSOR                                  16510000
165200         INTO                                                     16520000
165300               :SYSCOL-NAME                                       16530000
165400              ,:SYSCOL-COLNO                                      16540000
165500              ,:SYSCOL-COLTYPE                                    16550000
165600              ,:SYSCOL-LENGTH                                     16560000
165700              ,:SYSCOL-SCALE                                      16570000
165800              ,:SYSCOL-NULLS                                      16580000
165900              ,:SYSCOL-DEFAULT                                    16590000
166000              ,:SYSCOL-KEYSEQ                                     16600000
166100              ,:SYSCOL-DEFAULTVALUE                               16610000
166200     END-EXEC.                                                    16620000
166300                                                                  16630000
166400     MOVE SPACE                    TO RPT-DEFAULT.                16640000
166500                                                                  16650000
166600     IF SQLCODE = ZERO                                            16660000
166700         MOVE SYSCOL-NAME-TEXT TO RPT-COLUMN-NAME                 16670000
166800         MOVE SYSCOL-COLTYPE TO RPT-TYPE                          16680000
166900         MOVE SYSCOL-LENGTH TO RPT-LENGTH                         16690000
167000         MOVE SYSCOL-SCALE TO RPT-SCALE                           16700000
167100         IF SYSCOL-NULLS = 'Y'                                    16710000
167200             MOVE SPACES TO RPT-NULL-RULE                         16720000
167300         ELSE                                                     16730000
167400         IF SYSCOL-DEFAULT = 'Y'                                  16740000
167500                        OR = 'B'                                  16750000
167600             MOVE 'NOT NULL WITH DEFAULT' TO RPT-NULL-RULE        16760000
167700         ELSE                                                     16770000
167800         IF SYSCOL-DEFAULT = '1'                                  16780000
167900                        OR = '2'                                  16790000
168000                        OR = '3'                                  16800000
168100                        OR = '4'                                  16810000
168200             MOVE 'NOT NULL USER DEFAULT'  TO RPT-NULL-RULE       16820000
168300             MOVE SYSCOL-DEFAULTVALUE-TEXT TO RPT-DEFAULT         16830000
168400         ELSE                                                     16840000
168402         IF SYSCOL-DEFAULT = 'I'                                  16840290
168403            MOVE 'IDENTITY-GEN ALWAYS' TO RPT-NULL-RULE           16840390
168404         ELSE                                                     16840490
168405                                                                  16840590
168406         IF SYSCOL-DEFAULT = 'J'                                  16840690
168407            MOVE 'IDENTITY-GEN DEFAULT' TO RPT-NULL-RULE          16840790
168450         ELSE                                                     16845090
168500             MOVE 'NOT NULL' TO RPT-NULL-RULE                     16850000
168600         END-IF                                                   16860000
168610         END-IF                                                   16861090
168620         END-IF                                                   16862090
168700         END-IF                                                   16870000
168800         END-IF                                                   16880000
168900         WRITE BROWSE-RECORD FROM REPORT-LINE                     16890000
169000         IF SYSCOL-KEYSEQ NOT = ZERO                              16900000
169100             MOVE 'Y' TO PS-PKEY                                  16910000
169200         END-IF                                                   16920000
169300     ELSE                                                         16930000
169400     IF SQLCODE NOT = +100                                        16940000
169500         SET PS-DB2-ERROR TO TRUE                                 16950000
169600         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      16960000
169700         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         16970000
169800         MOVE                                                     16980000
169900         '4300-FETCH-SYSCOLUMNS ABEND, CONTACT DATA RESOURCE'     16990000
170000             TO VAR-LMSG                                          17000000
170100         MOVE 'CMN000  ' TO ISP-MSG.                              17010000
170200                                                                  17020000
170300  4300-EXIT.                                                      17030000
170400     EXIT.                                                        17040000
170500     EJECT                                                        17050000
170600************************************************************      17060000
170700* CLOSE SYSCOLUMNS_CURSOR                                  *      17070000
170800************************************************************      17080000
170900 4400-CLOSE-SYSCOLUMNS-CURSOR.                                    17090000
171000                                                                  17100000
171100     EXEC SQL                                                     17110000
171200         CLOSE SYSCOLUMNS_CURSOR                                  17120000
171300     END-EXEC.                                                    17130000
171400                                                                  17140000
171500     IF SQLCODE NOT = ZERO                                        17150000
171600         SET PS-DB2-ERROR TO TRUE                                 17160000
171700         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      17170000
171800         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         17180000
171900         MOVE '4400-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    17190000
172000              TO VAR-LMSG                                         17200000
172100         MOVE 'CMN000  ' TO ISP-MSG.                              17210000
172200*                                                                 17220000
172300 4400-EXIT.                                                       17230000
172400     EXIT.                                                        17240000
172500     EJECT                                                        17250000
172600************************************************************      17260000
172700* OPEN PK_COLUMNS_CURSOR CURSOR                            *      17270000
172800************************************************************      17280000
172900 4500-OPEN-PK-COLUMNS-CURSOR.                                     17290000
173000                                                                  17300000
173100      EXEC SQL                                                    17310000
173200          OPEN PK_COLUMNS_CURSOR                                  17320000
173300      END-EXEC.                                                   17330000
173400                                                                  17340000
173500      IF SQLCODE NOT = 0                                          17350000
173600          SET PS-DB2-ERROR TO TRUE                                17360000
173700          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     17370000
173800          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        17380000
173900          MOVE '4500-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    17390000
174000               TO VAR-LMSG                                        17400000
174100          MOVE 'CMN000  ' TO ISP-MSG.                             17410000
174200                                                                  17420000
174300 4500-EXIT.                                                       17430000
174400     EXIT.                                                        17440000
174500     EJECT                                                        17450000
174600************************************************************      17460000
174700* FETCH THE ROWS FROM SYSIBM.SYSCOLUMNS                    *      17470000
174800************************************************************      17480000
174900 4600-FETCH-PK-COLUMNS.                                           17490000
175000                                                                  17500000
175100     INITIALIZE DCLSYSCOLUMNS.                                    17510000
175200                                                                  17520000
175300     EXEC SQL                                                     17530000
175400         FETCH PK_COLUMNS_CURSOR                                  17540000
175500         INTO                                                     17550000
175600               :SYSCOL-NAME                                       17560000
175700              ,:SYSCOL-KEYSEQ                                     17570000
175800     END-EXEC.                                                    17580000
175900                                                                  17590000
176000     IF SQLCODE = ZERO                                            17600000
176100         IF PS-KEY-COLUMN-SELECTED                                17610000
176200             MOVE ',' TO PK-COMMA                                 17620000
176300         ELSE                                                     17630000
176400             MOVE SPACE TO PK-COMMA                               17640000
176500             MOVE 'Y' TO PS-KEY-COLUMN-SELECT                     17650000
176600         END-IF                                                   17660000
176700         MOVE SYSCOL-NAME-TEXT TO PK-COLUMN-NAME                  17670000
176800         WRITE BROWSE-RECORD FROM PK-COLUMN-LINE                  17680000
176900     ELSE                                                         17690000
177000     IF SQLCODE NOT = +100                                        17700000
177100         SET PS-DB2-ERROR TO TRUE                                 17710000
177200         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      17720000
177300         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         17730000
177400         MOVE                                                     17740000
177500         '4600-FETCH-PK-COLUMNS ABEND, CONTACT DATA RESOURCE'     17750000
177600             TO VAR-LMSG                                          17760000
177700         MOVE 'CMN000  ' TO ISP-MSG.                              17770000
177800                                                                  17780000
177900  4600-EXIT.                                                      17790000
178000     EXIT.                                                        17800000
178100     EJECT                                                        17810000
178200************************************************************      17820000
178300* CLOSE PK_COLUMNS_CURSOR                                  *      17830000
178400************************************************************      17840000
178500 4700-CLOSE-PK-COLUMNS-CURSOR.                                    17850000
178600                                                                  17860000
178700     EXEC SQL                                                     17870000
178800         CLOSE PK_COLUMNS_CURSOR                                  17880000
178900     END-EXEC.                                                    17890000
179000                                                                  17900000
179100     IF SQLCODE NOT = ZERO                                        17910000
179200         SET PS-DB2-ERROR TO TRUE                                 17920000
179300         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      17930000
179400         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         17940000
179500         MOVE '4700-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    17950000
179600              TO VAR-LMSG                                         17960000
179700         MOVE 'CMN000  ' TO ISP-MSG.                              17970000
179800                                                                  17980000
179900 4700-EXIT.                                                       17990000
180000     EXIT.                                                        18000000
180100     EJECT                                                        18010000
180200************************************************************      18020000
180300* SELECT THE FK COUNT FROM SYSIBM.SYSRELS                  *      18030000
180400************************************************************      18040000
180500 4750-SELECT-FK-COUNT.                                            18050000
180600                                                                  18060000
180700     MOVE ZERO TO FK-COUNTER.                                     18070000
180800                                                                  18080000
180900     EXEC SQL                                                     18090000
181000         SELECT                                                   18100000
181100                COUNT(*)                                          18110000
181200         INTO                                                     18120000
181300               :FK-COUNTER                                        18130000
181400         FROM  SYSIBM.SYSRELS                                     18140000
181500         WHERE TBNAME  =  :VAR-128-TABLE-NAME                     18150054
181600         AND   CREATOR =  :VAR-CMNEKCRE                           18160000
181700        WITH UR                                                   18170032
181800     END-EXEC.                                                    18180000
181900                                                                  18190000
182000     IF SQLCODE NOT = ZERO                                        18200000
182100         SET PS-DB2-ERROR TO TRUE                                 18210000
182200         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      18220000
182300         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         18230000
182400         MOVE                                                     18240000
182500         '4750-SELECT-COUNT  ABEND, CONTACT DATA RESOURCE'        18250000
182600             TO VAR-LMSG                                          18260000
182700         MOVE 'CMN000  ' TO ISP-MSG.                              18270000
182800                                                                  18280000
182900  4750-EXIT.                                                      18290000
183000     EXIT.                                                        18300000
183100     EJECT                                                        18310000
183200************************************************************      18320000
183300* SELECT THE INDEX COUNT FROM SYSIBM.SYSINDEXES            *      18330000
183400************************************************************      18340000
183500 4760-SELECT-IX-COUNT.                                            18350000
183600                                                                  18360000
183700     MOVE ZERO TO IX-COUNTER.                                     18370000
183800                                                                  18380000
183900     EXEC SQL                                                     18390000
184000         SELECT                                                   18400000
184100                COUNT(*)                                          18410000
184200         INTO                                                     18420000
184300               :IX-COUNTER                                        18430000
184400         FROM  SYSIBM.SYSINDEXES                                  18440000
184500         WHERE TBNAME  =  :VAR-128-TABLE-NAME                     18450054
184600         AND  TBCREATOR =  :VAR-CMNEKCRE                          18460000
184700        WITH UR                                                   18470032
184800     END-EXEC.                                                    18480000
184900                                                                  18490000
185000     IF SQLCODE NOT = ZERO                                        18500000
185100         SET PS-DB2-ERROR TO TRUE                                 18510000
185200         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      18520000
185300         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         18530000
185400         MOVE                                                     18540000
185500         '4760-SELECT-COUNT  ABEND, CONTACT DATA RESOURCE'        18550000
185600             TO VAR-LMSG                                          18560000
185700         MOVE 'CMN000  ' TO ISP-MSG.                              18570000
185800                                                                  18580000
185900  4760-EXIT.                                                      18590000
186000     EXIT.                                                        18600000
186100     EJECT                                                        18610000
186200************************************************************      18620000
186300* SELECT THE FK COUNT FROM SYSIBM.SYSRELS                  *      18630000
186400************************************************************      18640000
186500 4770-SELECT-FK-COUNT.                                            18650000
186600                                                                  18660000
186700     MOVE ZERO TO FK-COUNTER.                                     18670000
186800                                                                  18680000
186900     EXEC SQL                                                     18690000
187000         SELECT                                                   18700000
187100                COUNT(*)                                          18710000
187200         INTO                                                     18720000
187300               :FK-COUNTER                                        18730000
187400         FROM  SYSIBM.SYSRELS                                     18740000
187500         WHERE REFTBNAME = :VAR-128-TABLE-NAME                    18750054
187600           AND                                                    18760000
187700         REFTBCREATOR = :VAR-CMNEKCRE                             18770000
187800        WITH UR                                                   18780032
187900     END-EXEC.                                                    18790000
188000                                                                  18800000
188100     IF SQLCODE NOT = ZERO                                        18810000
188200         SET PS-DB2-ERROR TO TRUE                                 18820000
188300         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      18830000
188400         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         18840000
188500         MOVE                                                     18850000
188600         '4770-SELECT-COUNT  ABEND, CONTACT DATA RESOURCE'        18860000
188700             TO VAR-LMSG                                          18870000
188800         MOVE 'CMN000  ' TO ISP-MSG.                              18880000
188900                                                                  18890000
189000  4770-EXIT.                                                      18900000
189100     EXIT.                                                        18910000
189200     EJECT                                                        18920000
189300************************************************************      18930000
189400* SELECT THE TRIGGER COUNT FROM SYSIBM.TRIGGERS                   18940000
189500************************************************************      18950000
189600 4773-SELECT-TRIG-COUNT.                                          18960000
189700                                                                  18970000
189800     MOVE ZERO  TO TRIG-COUNTER.                                  18980000
189900                                                                  18990000
190000     EXEC SQL                                                     19000000
190100         SELECT    COUNT(*)                                       19010000
190200           INTO    :TRIG-COUNTER                                  19020000
190300           FROM    SYSIBM.SYSTRIGGERS                             19030000
190400          WHERE    TBNAME    = :VAR-128-TABLE-NAME                19040054
190500            AND    TBOWNER   = :VAR-CMNEKCRE                      19050000
190600        WITH UR                                                   19060032
190700     END-EXEC.                                                    19070000
190800                                                                  19080000
190900     IF SQLCODE NOT = ZERO                                        19090000
191000         SET PS-DB2-ERROR TO TRUE                                 19100000
191100         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      19110000
191200         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         19120000
191300         MOVE                                                     19130000
191400         '4773-SELECT-COUNT  ABEND, CONTACT DATA RESOURCE'        19140000
191500             TO VAR-LMSG                                          19150000
191600         MOVE 'CMN000  ' TO ISP-MSG.                              19160000
191700                                                                  19170000
191800  4773-EXIT.                                                      19180000
191900     EXIT.                                                        19190000
192000     EJECT                                                        19200000
192100************************************************************      19210000
192200* OPEN SYSRELS_CURSOR CURSOR                               *      19220000
192300************************************************************      19230000
192400 4800-OPEN-SYSRELS-CURSOR.                                        19240000
192500                                                                  19250000
192600      EXEC SQL                                                    19260000
192700          OPEN SYSRELS_CURSOR                                     19270000
192800      END-EXEC.                                                   19280000
192900                                                                  19290000
193000      IF SQLCODE NOT = 0                                          19300000
193100          SET PS-DB2-ERROR TO TRUE                                19310000
193200          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     19320000
193300          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        19330000
193400          MOVE '4800-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    19340000
193500               TO VAR-LMSG                                        19350000
193600          MOVE 'CMN000  ' TO ISP-MSG.                             19360000
193700                                                                  19370000
193800 4800-EXIT.                                                       19380000
193900     EXIT.                                                        19390000
194000     EJECT                                                        19400000
194100************************************************************      19410000
194200* FETCH THE ROWS FROM SYSIBM.SYSRELS                       *      19420000
194300************************************************************      19430000
194400 4820-FETCH-SYSRELS.                                              19440000
194500                                                                  19450000
194600     INITIALIZE DCLSYSRELS.                                       19460000
194700                                                                  19470000
194800     EXEC SQL                                                     19480000
194900         FETCH SYSRELS_CURSOR                                     19490000
195000         INTO                                                     19500000
195100               :SYSRELS-RELNAME                                   19510000
195200              ,:SYSRELS-REFTBNAME                                 19520000
195300              ,:SYSRELS-REFTBCREATOR                              19530000
195400              ,:SYSRELS-DELETERULE                                19540000
195500     END-EXEC.                                                    19550000
195600                                                                  19560000
195700     IF SQLCODE = ZERO                                            19570000
195800         MOVE SPACE TO BROWSE-RECORD                              19580000
195900         IF SYSRELS-DELETERULE = 'R'                              19590000
196000             STRING '  '                   DELIMITED BY SIZE,     19600000
196100                    SYSRELS-RELNAME-TEXT   DELIMITED BY SPACE,    19610066
196200                    ' REFERENCES '         DELIMITED BY SIZE,     19620000
196300                    SYSRELS-REFTBCREATOR-TEXT                     19630066
196400                                           DELIMITED BY ' ',      19640066
196500                    '.'                    DELIMITED BY SIZE      19650000
196600                    SYSRELS-REFTBNAME-TEXT DELIMITED BY '   ',    19660000
196700                    ' ON DELETE RESTRICT'  DELIMITED BY SIZE      19670000
196800             INTO BROWSE-RECORD                                   19680000
196900         ELSE                                                     19690000
197000         IF SYSRELS-DELETERULE = 'C'                              19700000
197100             STRING '  '                   DELIMITED BY SIZE,     19710000
197200                    SYSRELS-RELNAME-TEXT   DELIMITED BY SPACE,    19720066
197300                    ' REFERENCES '         DELIMITED BY SIZE,     19730000
197400                    SYSRELS-REFTBCREATOR-TEXT                     19740066
197500                                           DELIMITED BY ' ',      19750066
197600                    '.'                    DELIMITED BY SIZE      19760000
197700                    SYSRELS-REFTBNAME-TEXT DELIMITED BY '   ',    19770000
197800                    ' ON DELETE CASCADE'   DELIMITED BY SIZE      19780000
197900             INTO BROWSE-RECORD                                   19790000
198000         ELSE                                                     19800000
198100             STRING '  '                   DELIMITED BY SIZE,     19810000
198200                    SYSRELS-RELNAME-TEXT   DELIMITED BY SPACE,    19820066
198300                    ' REFERENCES '         DELIMITED BY SIZE,     19830000
198400                    SYSRELS-REFTBCREATOR-TEXT                     19840066
198500                                           DELIMITED BY ' ',      19850066
198600                    '.'                    DELIMITED BY SIZE      19860000
198700                    SYSRELS-REFTBNAME-TEXT DELIMITED BY '   ',    19870000
198800                    ' ON DELETE SET NULL'  DELIMITED BY SIZE      19880000
198900             INTO BROWSE-RECORD                                   19890000
199000         END-IF                                                   19900000
199100         END-IF                                                   19910000
199200         WRITE BROWSE-RECORD                                      19920000
199300         PERFORM 4860-PUT-FK-COLUMNS THRU 4860-EXIT               19930000
199400     ELSE                                                         19940000
199500     IF SQLCODE NOT = +100                                        19950000
199600         SET PS-DB2-ERROR TO TRUE                                 19960000
199700         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      19970000
199800         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         19980000
199900         MOVE                                                     19990000
200000         '4820-FETCH-SYSRELS ABEND, CONTACT DATA RESOURCE'        20000000
200100             TO VAR-LMSG                                          20010000
200200         MOVE 'CMN000  ' TO ISP-MSG.                              20020000
200300                                                                  20030000
200400  4820-EXIT.                                                      20040000
200500     EXIT.                                                        20050000
200600     EJECT                                                        20060000
200700************************************************************      20070000
200800* CLOSE SYSRELS_CURSOR                                     *      20080000
200900************************************************************      20090000
201000 4840-CLOSE-SYSRELS-CURSOR.                                       20100000
201100                                                                  20110000
201200     EXEC SQL                                                     20120000
201300         CLOSE SYSRELS_CURSOR                                     20130000
201400     END-EXEC.                                                    20140000
201500                                                                  20150000
201600     IF SQLCODE NOT = ZERO                                        20160000
201700         SET PS-DB2-ERROR TO TRUE                                 20170000
201800         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      20180000
201900         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         20190000
202000         MOVE '4840-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    20200000
202100              TO VAR-LMSG                                         20210000
202200         MOVE 'CMN000  ' TO ISP-MSG.                              20220000
202300                                                                  20230000
202400 4840-EXIT.                                                       20240000
202500     EXIT.                                                        20250000
202600     EJECT                                                        20260000
202700 4860-PUT-FK-COLUMNS.                                             20270000
202800                                                                  20280000
202900     PERFORM 4920-OPEN-PK-COLUMNS-CURSOR                          20290000
203000         THRU 4920-EXIT.                                          20300000
203100     IF PS-DB2-ERROR                                              20310000
203200         GO TO 4000-EXIT.                                         20320000
203300                                                                  20330000
203400     MOVE 'N' TO PS-KEY-COLUMN-SELECT.                            20340000
203500     PERFORM 4940-FETCH-FK-COLUMNS                                20350000
203600         THRU 4940-EXIT UNTIL SQLCODE NOT = ZERO.                 20360000
203700     IF PS-DB2-ERROR                                              20370000
203800         GO TO 4000-EXIT.                                         20380000
203900                                                                  20390000
204000     PERFORM 4960-CLOSE-FK-COLUMNS-CURSOR                         20400000
204100         THRU 4960-EXIT.                                          20410000
204200                                                                  20420000
204300 4860-EXIT.                                                       20430000
204400     EXIT.                                                        20440000
204500     EJECT                                                        20450000
204600************************************************************      20460000
204700* OPEN FK_COLUMNS_CURSOR CURSOR                            *      20470000
204800************************************************************      20480000
204900 4920-OPEN-PK-COLUMNS-CURSOR.                                     20490000
205000                                                                  20500000
205100      EXEC SQL                                                    20510000
205200          OPEN FK_COLUMNS_CURSOR                                  20520000
205300      END-EXEC.                                                   20530000
205400                                                                  20540000
205500      IF SQLCODE NOT = 0                                          20550000
205600          SET PS-DB2-ERROR TO TRUE                                20560000
205700          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     20570000
205800          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        20580000
205900          MOVE '4920-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    20590000
206000               TO VAR-LMSG                                        20600000
206100          MOVE 'CMN000  ' TO ISP-MSG.                             20610000
206200                                                                  20620000
206300 4920-EXIT.                                                       20630000
206400     EXIT.                                                        20640000
206500     EJECT                                                        20650000
206600************************************************************      20660000
206700* FETCH THE ROWS FROM SYSIBM.SYSFOREIGNKEYS                *      20670000
206800************************************************************      20680000
206900 4940-FETCH-FK-COLUMNS.                                           20690000
207000                                                                  20700000
207100     INITIALIZE DCLSYSFOREIGNKEYS.                                20710000
207200                                                                  20720000
207300     EXEC SQL                                                     20730000
207400         FETCH FK_COLUMNS_CURSOR                                  20740000
207500         INTO                                                     20750000
207600               :SYSFKEYS-COLNAME                                  20760000
207700              ,:SYSFKEYS-COLSEQ                                   20770000
207800     END-EXEC.                                                    20780000
207900                                                                  20790000
208000     IF SQLCODE = ZERO                                            20800000
208100         IF PS-KEY-COLUMN-NOT-SELECTED                            20810000
208200             MOVE SPACE TO FK-COMMA                               20820000
208300             MOVE 'Y' TO PS-KEY-COLUMN-SELECT                     20830000
208400         ELSE                                                     20840000
208500             MOVE ',' TO FK-COMMA                                 20850000
208600         END-IF                                                   20860000
208700         MOVE SYSFKEYS-COLNAME-TEXT TO FK-COLUMN-NAME             20870000
208800         WRITE BROWSE-RECORD FROM FK-COLUMN-LINE                  20880000
208900     ELSE                                                         20890000
209000     IF SQLCODE = +100                                            20900000
209100         MOVE SPACE TO BROWSE-RECORD                              20910000
209200         WRITE BROWSE-RECORD                                      20920000
209300     ELSE                                                         20930000
209400         SET PS-DB2-ERROR TO TRUE                                 20940000
209500         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      20950000
209600         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         20960000
209700         MOVE                                                     20970000
209800         '4940-FETCH-FK-COLUMNS ABEND, CONTACT DATA RESOURCE'     20980000
209900             TO VAR-LMSG                                          20990000
210000         MOVE 'CMN000  ' TO ISP-MSG.                              21000000
210100                                                                  21010000
210200  4940-EXIT.                                                      21020000
210300     EXIT.                                                        21030000
210400     EJECT                                                        21040000
210500************************************************************      21050000
210600* CLOSE FK_COLUMNS_CURSOR                                  *      21060000
210700************************************************************      21070000
210800 4960-CLOSE-FK-COLUMNS-CURSOR.                                    21080000
210900                                                                  21090000
211000     EXEC SQL                                                     21100000
211100         CLOSE FK_COLUMNS_CURSOR                                  21110000
211200     END-EXEC.                                                    21120000
211300                                                                  21130000
211400     IF SQLCODE NOT = ZERO                                        21140000
211500         SET PS-DB2-ERROR TO TRUE                                 21150000
211600         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      21160000
211700         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         21170000
211800         MOVE '4960-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    21180000
211900              TO VAR-LMSG                                         21190000
212000         MOVE 'CMN000  ' TO ISP-MSG.                              21200000
212100                                                                  21210000
212200 4960-EXIT.                                                       21220000
212300     EXIT.                                                        21230000
212400     EJECT                                                        21240000
212500************************************************************      21250000
212600* SELECT THE VIEW COUNT FROM SYSIBM.SYSVIEWDEP             *      21260000
212700************************************************************      21270000
212800 5110-SELECT-VIEW-COUNT.                                          21280000
212900                                                                  21290000
213000     MOVE ZERO TO VIEW-COUNTER.                                   21300000
213100                                                                  21310000
213200     EXEC SQL                                                     21320000
213300         SELECT COUNT(DISTINCT DNAME)                             21330088
213400         INTO  :VIEW-COUNTER                                      21340000
213500         FROM  SYSIBM.SYSVIEWDEP                                  21350000
213600         WHERE BNAME    = :VAR-128-TABLE-NAME                     21360054
213700           AND BCREATOR = :VAR-CMNEKCRE                           21370000
213800        WITH UR                                                   21380032
213900     END-EXEC.                                                    21390000
214000                                                                  21400000
214100     IF SQLCODE NOT = ZERO                                        21410000
214200         SET PS-DB2-ERROR TO TRUE                                 21420000
214300         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      21430000
214400         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         21440000
214500         MOVE                                                     21450000
214600         '5100-SELECT-VIEW-COUNT  ABEND, CONTACT DATA RESOURCE'   21460000
214700             TO VAR-LMSG                                          21470000
214800         MOVE 'CMN000  ' TO ISP-MSG.                              21480000
214900                                                                  21490000
215000 5110-EXIT.                                                       21500000
215100     EXIT.                                                        21510000
215200     EJECT                                                        21520000
215300************************************************************      21530000
215400* OPEN VIEWS_CURSOR CURSOR                                 *      21540000
215500************************************************************      21550000
215600 5120-OPEN-VIEWS-CURSOR.                                          21560000
215700                                                                  21570000
215800      EXEC SQL                                                    21580000
215900          OPEN VIEWS_CURSOR                                       21590000
216000      END-EXEC.                                                   21600000
216100                                                                  21610000
216200      IF SQLCODE NOT = 0                                          21620000
216300          SET PS-DB2-ERROR TO TRUE                                21630000
216400          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     21640000
216500          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        21650000
216600          MOVE '5120-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    21660000
216700               TO VAR-LMSG                                        21670000
216800          MOVE 'CMN000  ' TO ISP-MSG.                             21680000
216900                                                                  21690000
217000 5120-EXIT.                                                       21700000
217100     EXIT.                                                        21710000
217200     EJECT                                                        21720000
217300************************************************************      21730000
217400* FETCH THE ROWS FROM SYSIBM.SYSVIEWDEP                    *      21740000
217500************************************************************      21750000
217600 5130-FETCH-VIEWS.                                                21760000
217700                                                                  21770000
217800     INITIALIZE DCLSYSVIEWDEP.                                    21780000
217900                                                                  21790000
218000     EXEC SQL                                                     21800000
218100         FETCH VIEWS_CURSOR                                       21810000
218200          INTO :SYSVWDEP-DNAME                                    21820000
218300             , :SYSVWDEP-DCREATOR                                 21830000
218400     END-EXEC.                                                    21840000
218500                                                                  21850000
218600     IF SQLCODE = ZERO                                            21860000
218700         IF PS-KEY-COLUMN-NOT-SELECTED                            21870000
218800             MOVE SPACE TO VIEW-COMMA                             21880000
218900             MOVE 'Y' TO PS-KEY-COLUMN-SELECT                     21890000
219000         ELSE                                                     21900000
219100             MOVE ',' TO VIEW-COMMA                               21910000
219200         END-IF                                                   21920000
219300         MOVE SPACES TO VIEW-NAME                                 21930000
219400         STRING SYSVWDEP-DCREATOR-TEXT  DELIMITED BY ' ',         21940066
219500                '.'                 DELIMITED BY SIZE,            21950000
219600                SYSVWDEP-DNAME-TEXT DELIMITED BY ' '              21960000
219700         INTO VIEW-NAME                                           21970000
219800         WRITE BROWSE-RECORD FROM VIEW-LINE                       21980000
219900     ELSE                                                         21990000
220000     IF SQLCODE = +100                                            22000000
220100         MOVE SPACE TO BROWSE-RECORD                              22010000
220200         WRITE BROWSE-RECORD                                      22020000
220300     ELSE                                                         22030000
220400         SET PS-DB2-ERROR TO TRUE                                 22040000
220500         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      22050000
220600         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         22060000
220700         MOVE                                                     22070000
220800         '5130-FETCH  ABEND, CONTACT DATA RESOURCE'               22080000
220900             TO VAR-LMSG                                          22090000
221000         MOVE 'CMN000  ' TO ISP-MSG.                              22100000
221100                                                                  22110000
221200 5130-EXIT.                                                       22120000
221300     EXIT.                                                        22130000
221400     EJECT                                                        22140000
221500************************************************************      22150000
221600* CLOSE VIEWS_CURSOR                                       *      22160000
221700************************************************************      22170000
221800 5140-CLOSE-VIEWS-CURSOR.                                         22180000
221900                                                                  22190000
222000     EXEC SQL                                                     22200000
222100         CLOSE VIEWS_CURSOR                                       22210000
222200     END-EXEC.                                                    22220000
222300                                                                  22230000
222400     IF SQLCODE NOT = ZERO                                        22240000
222500         SET PS-DB2-ERROR TO TRUE                                 22250000
222600         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      22260000
222700         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         22270000
222800         MOVE '5140-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    22280000
222900              TO VAR-LMSG                                         22290000
223000         MOVE 'CMN000  ' TO ISP-MSG.                              22300000
223100                                                                  22310000
223200 5140-EXIT.                                                       22320000
223300     EXIT.                                                        22330000
223400     EJECT                                                        22340000
223500************************************************************      22350000
223600* OPEN SYSINDX_CURSOR CURSOR                               *      22360000
223700************************************************************      22370000
223800 5800-OPEN-SYSINDEX-CURSOR.                                       22380000
223900                                                                  22390000
224000      EXEC SQL                                                    22400000
224100          OPEN SYSINDX_CURSOR                                     22410000
224200      END-EXEC.                                                   22420000
224300                                                                  22430000
224400      IF SQLCODE NOT = 0                                          22440000
224500          SET PS-DB2-ERROR TO TRUE                                22450000
224600          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     22460000
224700          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        22470000
224800          MOVE '5800-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    22480000
224900               TO VAR-LMSG                                        22490000
225000          MOVE 'CMN000  ' TO ISP-MSG.                             22500000
225100                                                                  22510000
225200 5800-EXIT.                                                       22520000
225300     EXIT.                                                        22530000
225400     EJECT                                                        22540000
225500************************************************************      22550000
225600* FETCH THE ROWS FROM SYSIBM.SYSINDEXES                    *      22560000
225700************************************************************      22570000
225800 5820-FETCH-SYSINDX.                                              22580000
225900                                                                  22590000
226000     INITIALIZE DCLSYSINDEXES.                                    22600000
226100                                                                  22610000
226200     EXEC SQL                                                     22620000
226300         FETCH SYSINDX_CURSOR                                     22630000
226400         INTO                                                     22640000
226500               :SYSINDEX-NAME                                     22650000
226600              ,:SYSINDEX-CREATOR                                  22660000
226700              ,:SYSINDEX-UNIQUERULE                               22670000
226800              ,:SYSINDEX-CLUSTERING                               22680000
226900              ,:SYSINDEX-INDEXSPACE                               22690000
227000              ,:SYSINDEX-CLUSTERRATIO                             22700000
227100              ,:SYSINDEX-BPOOL                                    22710000
227200              ,:SYSINDEX-REMARKS                                  22720000
227300              ,:SYSINDEX-FIRSTKEYCARDF                            22730032
227400              ,:SYSINDEX-FULLKEYCARDF                             22740032
227500     END-EXEC.                                                    22750000
227600                                                                  22760000
227700     IF SQLCODE = ZERO                                            22770000
227800           MOVE SPACE TO BROWSE-RECORD                            22780000
227900           PERFORM 5850-PUT-CLUSTER-INFO THRU 5850-EXIT           22790000
228000           PERFORM 5900-PUT-IX-COLUMNS THRU 5900-EXIT             22800000
228100     ELSE                                                         22810000
228200     IF SQLCODE NOT = +100                                        22820000
228300         SET PS-DB2-ERROR TO TRUE                                 22830000
228400         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      22840000
228500         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         22850000
228600         MOVE                                                     22860000
228700         '5820-FETCH-SYSINDX ABEND, CONTACT DATA RESOURCE'        22870000
228800             TO VAR-LMSG                                          22880000
228900         MOVE 'CMN000  ' TO ISP-MSG.                              22890000
229000                                                                  22900000
229100  5820-EXIT.                                                      22910000
229200     EXIT.                                                        22920000
229300     EJECT                                                        22930000
229400************************************************************      22940000
229500* CLOSE SYSINDX_CURSOR                                     *      22950000
229600************************************************************      22960000
229700 5840-CLOSE-SYSINDEX-CURSOR.                                      22970000
229800                                                                  22980000
229900     EXEC SQL                                                     22990000
230000         CLOSE SYSINDX_CURSOR                                     23000000
230100     END-EXEC.                                                    23010000
230200                                                                  23020000
230300     IF SQLCODE NOT = ZERO                                        23030000
230400         SET PS-DB2-ERROR TO TRUE                                 23040000
230500         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      23050000
230600         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         23060000
230700         MOVE '5840-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    23070000
230800              TO VAR-LMSG                                         23080000
230900         MOVE 'CMN000  ' TO ISP-MSG.                              23090000
231000                                                                  23100000
231100 5840-EXIT.                                                       23110000
231200     EXIT.                                                        23120000
231300     EJECT                                                        23130000
231400 5850-PUT-CLUSTER-INFO.                                           23140000
231500                                                                  23150000
231600     IF SYSINDEX-UNIQUERULE = 'D'                                 23160000
231700         IF SYSINDEX-CLUSTERING = 'Y'                             23170000
231800             STRING  '  '             DELIMITED BY SIZE,          23180000
231900             SYSINDEX-NAME-TEXT       DELIMITED BY SPACE,         23190000
232000            ' - NON-UNIQUE AND CLUSTERING'                        23200000
232100                                      DELIMITED BY SIZE           23210000
232200         INTO BROWSE-RECORD                                       23220000
232300         ELSE                                                     23230000
232400             STRING  '  '             DELIMITED BY SIZE,          23240000
232500             SYSINDEX-NAME-TEXT       DELIMITED BY SPACE,         23250000
232600            ' - NON-UNIQUE AND NON-CLUSTERING',                   23260000
232700                                        DELIMITED BY SIZE         23270000
232800         INTO BROWSE-RECORD                                       23280000
232900         END-IF                                                   23290000
233000     ELSE                                                         23300000
233100     IF SYSINDEX-UNIQUERULE = 'N'                                 23310000
233200         IF SYSINDEX-CLUSTERING = 'Y'                             23320000
233300           STRING      '  '               DELIMITED BY SIZE,      23330000
233400               SYSINDEX-NAME-TEXT         DELIMITED BY SPACE,     23340000
233500               ' - UNIQUE WHERE NOT NULL AND CLUSTERING'          23350000
233600                                          DELIMITED BY SIZE       23360000
233700           INTO BROWSE-RECORD                                     23370000
233800         ELSE                                                     23380000
233900           STRING      '  '               DELIMITED BY SIZE,      23390000
234000               SYSINDEX-NAME-TEXT         DELIMITED BY SPACE,     23400000
234100               ' - UNIQUE WHERE NOT NULL AND NON-CLUSTERING'      23410000
234200                                          DELIMITED BY SIZE       23420000
234300           INTO BROWSE-RECORD                                     23430000
234400        END-IF                                                    23440000
234500     ELSE                                                         23450000
234600     IF SYSINDEX-CLUSTERING = 'Y'                                 23460000
234700           STRING      '  '               DELIMITED BY SIZE,      23470000
234800               SYSINDEX-NAME-TEXT         DELIMITED BY SPACE,     23480000
234900               ' - UNIQUE AND CLUSTERING' DELIMITED BY SIZE       23490000
235000           INTO BROWSE-RECORD                                     23500000
235100     ELSE                                                         23510000
235200           STRING      '  '               DELIMITED BY SIZE,      23520000
235300               SYSINDEX-NAME-TEXT         DELIMITED BY SPACE,     23530000
235400               ' - UNIQUE AND NON-CLUSTERING'                     23540000
235500                                          DELIMITED BY SIZE       23550000
235600           INTO BROWSE-RECORD.                                    23560000
235700     WRITE BROWSE-RECORD.                                         23570000
235800                                                                  23580000
235900     MOVE SYSINDEX-REMARKS-TEXT TO IX-COMMENT.                    23590000
236000     IF IX-COMMENT > ' '                                          23600000
236100        WRITE BROWSE-RECORD        FROM IX-COMMENT-LINE           23610000
236200     END-IF.                                                      23620000
236300                                                                  23630000
236400     MOVE SYSINDEX-BPOOL        TO IX-BPOOL-NO.                   23640000
236500     MOVE SYSINDEX-INDEXSPACE-TEXT   TO IX-SPACE-NME.             23650065
236600     WRITE BROWSE-RECORD        FROM IX-BP-LINE.                  23660000
236700                                                                  23670000
236800     MOVE SYSINDEX-FIRSTKEYCARDF TO WS-FIRSTKEYCARDF.             23680034
236900     MOVE SYSINDEX-FULLKEYCARDF  TO WS-FULLKEYCARDF.              23690034
237000                                                                  23700034
237100     UNSTRING WS-FIRSTKEYCARDF-ALPH                               23710039
237200       DELIMITED BY ALL SPACE                                     23720039
237300         INTO WS-UNSTRING-01, IX-FIRSTKEYCARDF.                   23730039
237400                                                                  23740038
237500     UNSTRING WS-FULLKEYCARDF-ALPH                                23750039
237600       DELIMITED BY ALL SPACE                                     23760039
237700         INTO WS-UNSTRING-01, IX-FULLKEYCARDF.                    23770039
237800                                                                  23780038
237900     WRITE BROWSE-RECORD        FROM IX-CARD-LINE.                23790038
238000     WRITE BROWSE-RECORD        FROM IX-CARD-LINE2.               23800072
238100                                                                  23810038
238200     MOVE SYSINDEX-CLUSTERRATIO TO IX-CLRATIO.                    23820038
238300     WRITE BROWSE-RECORD        FROM IX-CLRATIO-LINE.             23830000
238400                                                                  23840000
238500     PERFORM 5860-OPEN-SYSIXPT-CURSOR                             23850000
238600         THRU 5860-EXIT.                                          23860000
238700     IF PS-DB2-ERROR                                              23870000
238800         GO TO 4000-EXIT.                                         23880000
238900                                                                  23890000
239000     MOVE 'N' TO PS-KEY-COLUMN-SELECT.                            23900000
239100     PERFORM 5870-FETCH-SYSIXPT-DATA                              23910000
239200         THRU 5870-EXIT UNTIL SQLCODE NOT = ZERO.                 23920000
239300     IF PS-DB2-ERROR                                              23930000
239400         GO TO 4000-EXIT.                                         23940000
239500                                                                  23950000
239600     PERFORM 5880-CLOSE-SYSIXPT-CURSOR                            23960000
239700         THRU 5880-EXIT.                                          23970000
239800                                                                  23980000
239900 5850-EXIT.                                                       23990000
240000     EXIT.                                                        24000000
240100     EJECT                                                        24010000
240200************************************************************      24020000
240300* OPEN SYSIXPT_CURSOR CURSOR                               *      24030000
240400************************************************************      24040000
240500 5860-OPEN-SYSIXPT-CURSOR.                                        24050000
240600                                                                  24060000
240700      EXEC SQL                                                    24070000
240800          OPEN SYSIXPT_CURSOR                                     24080000
240900      END-EXEC.                                                   24090000
241000                                                                  24100000
241100      IF SQLCODE NOT = 0                                          24110000
241200          SET PS-DB2-ERROR TO TRUE                                24120000
241300          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     24130000
241400          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        24140000
241500          MOVE '5860-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    24150000
241600               TO VAR-LMSG                                        24160000
241700          MOVE 'CMN000  ' TO ISP-MSG.                             24170000
241800                                                                  24180000
241900 5860-EXIT.                                                       24190000
242000     EXIT.                                                        24200000
242100     EJECT                                                        24210000
242200************************************************************      24220000
242300* FETCH THE ROWS FROM SYSIBM.SYSIXPT                       *      24230000
242400************************************************************      24240000
242500 5870-FETCH-SYSIXPT-DATA.                                         24250000
242600                                                                  24260000
242700     INITIALIZE DCLSYSINDEXPART.                                  24270000
242800                                                                  24280000
242900     EXEC SQL                                                     24290000
243000         FETCH SYSIXPT_CURSOR                                     24300000
243100         INTO                                                     24310000
243200               :SYSIXPT-PARTITION                                 24320000
243300              ,:SYSIXPT-FREEPAGE                                  24330000
243400              ,:SYSIXPT-PCTFREE                                   24340000
243500     END-EXEC.                                                    24350000
243600                                                                  24360000
243700     IF SQLCODE = ZERO                                            24370000
243800        IF SYSIXPT-PARTITION = ZERO                               24380000
243900           MOVE SYSIXPT-FREEPAGE TO FREEPG-NO-I                   24390000
244000           MOVE SYSIXPT-PCTFREE  TO PCTFREE-NO-I                  24400000
244100           WRITE BROWSE-RECORD FROM REPORT-TITLEIFP               24410000
244200        ELSE                                                      24420000
244300           CONTINUE                                               24430000
244400        END-IF                                                    24440000
244500     ELSE                                                         24450000
244600     IF SQLCODE = +100                                            24460000
244700         CONTINUE                                                 24470000
244800     ELSE                                                         24480000
244900         SET PS-DB2-ERROR TO TRUE                                 24490000
245000         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      24500000
245100         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         24510000
245200         MOVE                                                     24520000
245300         '5870-FETCH-SYSIXPT ABEND, CONTACT DATA RESOURCE'        24530000
245400             TO VAR-LMSG                                          24540000
245500         MOVE 'CMN000  ' TO ISP-MSG.                              24550000
245600                                                                  24560000
245700 5870-EXIT.                                                       24570000
245800     EXIT.                                                        24580000
245900     EJECT                                                        24590000
246000************************************************************      24600000
246100* CLOSE SYSIXPT_CURSOR                                     *      24610000
246200************************************************************      24620000
246300 5880-CLOSE-SYSIXPT-CURSOR.                                       24630000
246400                                                                  24640000
246500     EXEC SQL                                                     24650000
246600         CLOSE SYSIXPT_CURSOR                                     24660000
246700     END-EXEC.                                                    24670000
246800                                                                  24680000
246900     IF SQLCODE NOT = ZERO                                        24690000
247000         SET PS-DB2-ERROR TO TRUE                                 24700000
247100         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      24710000
247200         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         24720000
247300         MOVE '5880-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    24730000
247400              TO VAR-LMSG                                         24740000
247500         MOVE 'CMN000  ' TO ISP-MSG.                              24750000
247600                                                                  24760000
247700 5880-EXIT.                                                       24770000
247800     EXIT.                                                        24780000
247900     EJECT                                                        24790000
248000 5900-PUT-IX-COLUMNS.                                             24800000
248100                                                                  24810000
248200     PERFORM 5920-OPEN-IX-COLUMNS-CURSOR                          24820000
248300         THRU 5920-EXIT.                                          24830000
248400     IF PS-DB2-ERROR                                              24840000
248500         GO TO 4000-EXIT.                                         24850000
248600                                                                  24860000
248700     MOVE 'N' TO PS-KEY-COLUMN-SELECT.                            24870000
248800     PERFORM 5940-FETCH-IX-COLUMNS                                24880000
248900         THRU 5940-EXIT UNTIL SQLCODE NOT = ZERO.                 24890000
249000     IF PS-DB2-ERROR                                              24900000
249100         GO TO 4000-EXIT.                                         24910000
249200                                                                  24920000
249300     PERFORM 5960-CLOSE-IX-COLUMNS-CURSOR                         24930000
249400         THRU 5960-EXIT.                                          24940000
249500                                                                  24950000
249600 5900-EXIT.                                                       24960000
249700     EXIT.                                                        24970000
249800     EJECT                                                        24980000
249900************************************************************      24990000
250000* OPEN IX_COLUMNS_CURSOR CURSOR                            *      25000000
250100************************************************************      25010000
250200 5920-OPEN-IX-COLUMNS-CURSOR.                                     25020000
250300                                                                  25030000
250400      EXEC SQL                                                    25040000
250500          OPEN IX_COLUMNS_CURSOR                                  25050000
250600      END-EXEC.                                                   25060000
250700                                                                  25070000
250800      IF SQLCODE NOT = 0                                          25080000
250900          SET PS-DB2-ERROR TO TRUE                                25090000
251000          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     25100000
251100          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        25110000
251200          MOVE '5920-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    25120000
251300               TO VAR-LMSG                                        25130000
251400          MOVE 'CMN000  ' TO ISP-MSG.                             25140000
251500                                                                  25150000
251600 5920-EXIT.                                                       25160000
251700     EXIT.                                                        25170000
251800     EJECT                                                        25180000
251900************************************************************      25190000
252000* FETCH THE ROWS FROM SYSIBM.SYSKEYS                       *      25200000
252100************************************************************      25210000
252200 5940-FETCH-IX-COLUMNS.                                           25220000
252300                                                                  25230000
252400     INITIALIZE DCLSYSKEYS.                                       25240000
252500                                                                  25250000
252600     EXEC SQL                                                     25260000
252700         FETCH IX_COLUMNS_CURSOR                                  25270000
252800         INTO                                                     25280000
252900               :SYSKEY-COLNAME                                    25290000
253000              ,:SYSKEY-COLSEQ                                     25300000
253100              ,:SYSKEY-ORDERING                                   25310000
253200     END-EXEC.                                                    25320000
253300                                                                  25330000
253400     IF SQLCODE = ZERO                                            25340000
253500         IF PS-KEY-COLUMN-NOT-SELECTED                            25350000
253600             MOVE SPACE TO IX-COMMA                               25360000
253700             MOVE 'Y' TO PS-KEY-COLUMN-SELECT                     25370000
253800         ELSE                                                     25380000
253900             MOVE ',' TO IX-COMMA                                 25390000
254000         END-IF                                                   25400000
254100         MOVE SYSKEY-COLNAME-TEXT TO IX-COLUMN-NAME               25410000
254200         IF SYSKEY-ORDERING = 'A'                                 25420000
254300             MOVE 'ASC ' TO IX-ORDER-NAME                         25430000
254400         END-IF                                                   25440000
254500         IF SYSKEY-ORDERING = 'D'                                 25450000
254600             MOVE 'DESC' TO IX-ORDER-NAME                         25460000
254700         END-IF                                                   25470000
254800         WRITE BROWSE-RECORD FROM IX-COLUMN-LINE                  25480000
254900     ELSE                                                         25490000
255000     IF SQLCODE = +100                                            25500000
255100         MOVE SPACE TO BROWSE-RECORD                              25510000
255200         WRITE BROWSE-RECORD                                      25520000
255300     ELSE                                                         25530000
255400         SET PS-DB2-ERROR TO TRUE                                 25540000
255500         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      25550000
255600         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         25560000
255700         MOVE                                                     25570000
255800         '5940-FETCH-FK-COLUMNS ABEND, CONTACT DATA RESOURCE'     25580000
255900             TO VAR-LMSG                                          25590000
256000         MOVE 'CMN000  ' TO ISP-MSG.                              25600000
256100                                                                  25610000
256200  5940-EXIT.                                                      25620000
256300     EXIT.                                                        25630000
256400     EJECT                                                        25640000
256500************************************************************      25650000
256600* CLOSE IX_COLUMNS_CURSOR                                  *      25660000
256700************************************************************      25670000
256800 5960-CLOSE-IX-COLUMNS-CURSOR.                                    25680000
256900                                                                  25690000
257000     EXEC SQL                                                     25700000
257100         CLOSE IX_COLUMNS_CURSOR                                  25710000
257200     END-EXEC.                                                    25720000
257300                                                                  25730000
257400     IF SQLCODE NOT = ZERO                                        25740000
257500         SET PS-DB2-ERROR TO TRUE                                 25750000
257600         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      25760000
257700         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         25770000
257800         MOVE '5960-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    25780000
257900              TO VAR-LMSG                                         25790000
258000         MOVE 'CMN000  ' TO ISP-MSG.                              25800000
258100                                                                  25810000
258200 5960-EXIT.                                                       25820000
258300     EXIT.                                                        25830000
258400     EJECT                                                        25840000
258500************************************************************      25850000
258600* OPEN SYSR_CURSOR CURSOR                                  *      25860000
258700************************************************************      25870000
258800 6800-OPEN-SYSR-CURSOR.                                           25880000
258900                                                                  25890000
259000      EXEC SQL                                                    25900000
259100          OPEN SYSR_CURSOR                                        25910000
259200      END-EXEC.                                                   25920000
259300                                                                  25930000
259400      IF SQLCODE NOT = 0                                          25940000
259500          SET PS-DB2-ERROR TO TRUE                                25950000
259600          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     25960000
259700          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        25970000
259800          MOVE '6800-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    25980000
259900               TO VAR-LMSG                                        25990000
260000          MOVE 'CMN000  ' TO ISP-MSG.                             26000000
260100                                                                  26010000
260200 6800-EXIT.                                                       26020000
260300     EXIT.                                                        26030000
260400     EJECT                                                        26040000
260500************************************************************      26050000
260600* FETCH THE ROWS FROM SYSIBM.SYSRELS                       *      26060000
260700************************************************************      26070000
260800 6820-FETCH-SYSR.                                                 26080000
260900                                                                  26090000
261000     INITIALIZE DCLSYSRELS.                                       26100000
261100     INITIALIZE DCLSYSFOREIGNKEYS.                                26110000
261200                                                                  26120000
261300     EXEC SQL                                                     26130000
261400         FETCH SYSR_CURSOR                                        26140000
261500         INTO                                                     26150000
261600               :SYSRELS-TBNAME                                    26160000
261700              ,:SYSRELS-RELNAME                                   26170000
261800              ,:SYSFKEYS-COLNAME                                  26180000
261900     END-EXEC.                                                    26190000
262000                                                                  26200000
262100     IF SQLCODE = ZERO                                            26210000
262200         MOVE SPACE TO REL-TABLE-INFO                             26220070
262300         MOVE SYSRELS-TBNAME-TEXT    TO REL-TBNAME                26230070
262400         MOVE SYSRELS-RELNAME-TEXT   TO REL-RELNAME               26240070
262500         MOVE SYSFKEYS-COLNAME-TEXT  TO REL-COLNAME               26250070
262600         MOVE REL-TABLE-INFO         TO BROWSE-RECORD             26260070
262700         WRITE BROWSE-RECORD                                      26270000
262800     ELSE                                                         26280000
262900     IF SQLCODE NOT = +100                                        26290000
263000         SET PS-DB2-ERROR TO TRUE                                 26300000
263100         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      26310000
263200         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         26320000
263300         MOVE                                                     26330000
263400         '6820-FETCH-SYSR ABEND, CONTACT DATA RESOURCE'           26340000
263500             TO VAR-LMSG                                          26350000
263600         MOVE 'CMN000  ' TO ISP-MSG.                              26360000
263700                                                                  26370000
263800  6820-EXIT.                                                      26380000
263900     EXIT.                                                        26390000
264000     EJECT                                                        26400000
264100************************************************************      26410000
264200* CLOSE SYSR_CURSOR                                        *      26420000
264300************************************************************      26430000
264400 6840-CLOSE-SYSR-CURSOR.                                          26440000
264500                                                                  26450000
264600     EXEC SQL                                                     26460000
264700         CLOSE SYSR_CURSOR                                        26470000
264800     END-EXEC.                                                    26480000
264900                                                                  26490000
265000     IF SQLCODE NOT = ZERO                                        26500000
265100         SET PS-DB2-ERROR TO TRUE                                 26510000
265200         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      26520000
265300         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         26530000
265400         MOVE '6840-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    26540000
265500              TO VAR-LMSG                                         26550000
265600         MOVE 'CMN000  ' TO ISP-MSG.                              26560000
265700                                                                  26570000
265800 6840-EXIT.                                                       26580000
265900     EXIT.                                                        26590000
266000     EJECT                                                        26600000
266100                                                                  26610000
266200************************************************************      26620000
266300* OPEN SYSTRIG_CURSOR CURSOR                               *      26630000
266400************************************************************      26640000
266500 7800-OPEN-SYSTRIG-CURSOR.                                        26650000
266600                                                                  26660000
266700      EXEC SQL                                                    26670000
266800          OPEN SYSTRIG_CURSOR                                     26680000
266900      END-EXEC.                                                   26690000
267000                                                                  26700000
267100      IF SQLCODE NOT = 0                                          26710000
267200          SET PS-DB2-ERROR TO TRUE                                26720000
267300          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     26730000
267400          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        26740000
267500          MOVE '7800-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    26750000
267600               TO VAR-LMSG                                        26760000
267700          MOVE 'CMN000  ' TO ISP-MSG.                             26770000
267800                                                                  26780000
267900 7800-EXIT.                                                       26790000
268000     EXIT.                                                        26800000
268100     EJECT                                                        26810000
268200                                                                  26820000
268300************************************************************      26830000
268400* FETCH THE ROWS FROM SYSIBM.SYSTRIGGERS                   *      26840000
268500************************************************************      26850000
268600 7820-FETCH-SYSTRIG.                                              26860000
268700                                                                  26870000
268800     INITIALIZE DCLSYSTRIGGERS.                                   26880000
268900                                                                  26890000
269000     EXEC SQL                                                     26900000
269100         FETCH SYSTRIG_CURSOR                                     26910000
269200         INTO                                                     26920000
269300               :SYSTRIGG-NAME                                     26930000
269400              ,:SYSTRIGG-TRIGTIME                                 26940000
269500              ,:SYSTRIGG-TRIGEVENT                                26950000
269600              ,:SYSTRIGG-GRANULARITY                              26960000
269700     END-EXEC.                                                    26970000
269800                                                                  26980000
269900     IF SQLCODE = ZERO                                            26990000
270000           MOVE SPACE TO BROWSE-RECORD                            27000000
270100           PERFORM 7830-PUT-TRIGGER-INFO THRU 7830-EXIT           27010000
270200     ELSE                                                         27020000
270300     IF SQLCODE NOT = +100                                        27030000
270400         SET PS-DB2-ERROR TO TRUE                                 27040000
270500         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      27050000
270600         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         27060000
270700         MOVE                                                     27070000
270800         '7820-FETCH-SYSTRIG ABEND, CONTACT DATA RESOURCE'        27080000
270900             TO VAR-LMSG                                          27090000
271000         MOVE 'CMN000  ' TO ISP-MSG.                              27100000
271100                                                                  27110000
271200  7820-EXIT.                                                      27120000
271300     EXIT.                                                        27130000
271400     EJECT                                                        27140000
271500************************************************************      27150000
271600* DISPLAY BROWSE-FILE                                      *      27160000
271700************************************************************      27170000
271800 7830-PUT-TRIGGER-INFO.                                           27180000
271900                                                                  27190000
272000     IF SYSTRIGG-GRANULARITY = 'S'                                27200000
272100         IF SYSTRIGG-TRIGTIME = 'B'                               27210000
272200           IF SYSTRIGG-TRIGEVENT = 'I'                            27220000
272300             STRING '  '            DELIMITED BY SIZE,            27230000
272400             SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,           27240066
272500             ' IS EXECUTED ONCE PER STATEMENT'                    27250000
272600                                    DELIMITED BY SIZE,            27260000
272700             ' BEFORE AN INSERT'    DELIMITED BY SIZE             27270000
272800             INTO BROWSE-RECORD                                   27280000
272900           ELSE                                                   27290000
273000             IF SYSTRIGG-TRIGEVENT = 'U'                          27300000
273100               STRING '  '            DELIMITED BY SIZE,          27310000
273200               SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,         27320066
273300               ' IS EXECUTED ONCE PER STATEMENT'                  27330000
273400                                      DELIMITED BY SIZE,          27340000
273500               ' BEFORE AN UPDATE'    DELIMITED BY SIZE           27350000
273600               INTO BROWSE-RECORD                                 27360000
273700             ELSE                                                 27370000
273800               IF SYSTRIGG-TRIGEVENT = 'D'                        27380000
273900                 STRING '  '            DELIMITED BY SIZE,        27390000
274000                 SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,       27400066
274100                 ' IS EXECUTED ONCE PER STATEMENT'                27410000
274200                                        DELIMITED BY SIZE,        27420000
274300                 ' BEFORE A DELETE '    DELIMITED BY SIZE         27430000
274400                 INTO BROWSE-RECORD                               27440000
274500               END-IF                                             27450000
274600             END-IF                                               27460000
274700           END-IF                                                 27470000
274800         ELSE                                                     27480000
274900           IF SYSTRIGG-TRIGTIME = 'A'                             27490000
275000             IF SYSTRIGG-TRIGEVENT = 'I'                          27500000
275100               STRING '  '            DELIMITED BY SIZE,          27510000
275200               SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,         27520066
275300               ' IS EXECUTED ONCE PER STATEMENT'                  27530000
275400                                      DELIMITED BY SIZE,          27540000
275500               ' AFTER AN INSERT'     DELIMITED BY SIZE           27550000
275600               INTO BROWSE-RECORD                                 27560000
275700             ELSE                                                 27570000
275800               IF SYSTRIGG-TRIGEVENT = 'U'                        27580000
275900                 STRING '  '            DELIMITED BY SIZE,        27590000
276000                 SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,       27600066
276100                 ' IS EXECUTED ONCE PER STATEMENT'                27610000
276200                                        DELIMITED BY SIZE,        27620000
276300                 ' AFTER AN UPDATE'     DELIMITED BY SIZE         27630000
276400                 INTO BROWSE-RECORD                               27640000
276500               ELSE                                               27650000
276600                 IF SYSTRIGG-TRIGEVENT = 'D'                      27660000
276700                   STRING '  '            DELIMITED BY SIZE,      27670000
276800                   SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,     27680066
276900                   ' IS EXECUTED ONCE PER STATEMENT'              27690000
277000                                          DELIMITED BY SIZE,      27700000
277100                   ' AFTER A DELETE '     DELIMITED BY SIZE       27710000
277200                   INTO BROWSE-RECORD                             27720000
277300                 END-IF                                           27730000
277400               END-IF                                             27740000
277500             END-IF                                               27750000
277600           END-IF                                                 27760000
277700         END-IF                                                   27770000
277800**************************************************************    27780000
277900     ELSE                                                         27790000
278000       IF SYSTRIGG-GRANULARITY = 'R'                              27800000
278100         IF SYSTRIGG-TRIGTIME = 'B'                               27810000
278200           IF SYSTRIGG-TRIGEVENT = 'I'                            27820000
278300             STRING '  '            DELIMITED BY SIZE,            27830000
278400             SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,           27840066
278500             ' IS EXECUTED ONCE PER ROW'                          27850000
278600                                    DELIMITED BY SIZE,            27860000
278700             ' BEFORE AN INSERT'    DELIMITED BY SIZE             27870000
278800             INTO BROWSE-RECORD                                   27880000
278900           ELSE                                                   27890000
279000             IF SYSTRIGG-TRIGEVENT = 'U'                          27900000
279100               STRING '  '            DELIMITED BY SIZE,          27910000
279200               SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,         27920066
279300               ' IS EXECUTED ONCE PER ROW'                        27930000
279400                                      DELIMITED BY SIZE,          27940000
279500               ' BEFORE AN UPDATE'    DELIMITED BY SIZE           27950000
279600               INTO BROWSE-RECORD                                 27960000
279700             ELSE                                                 27970000
279800               IF SYSTRIGG-TRIGEVENT = 'D'                        27980000
279900                 STRING '  '            DELIMITED BY SIZE,        27990000
280000                 SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,       28000066
280100                 ' IS EXECUTED ONCE PER ROW'                      28010000
280200                                        DELIMITED BY SIZE,        28020000
280300                 ' BEFORE A DELETE '    DELIMITED BY SIZE         28030000
280400                 INTO BROWSE-RECORD                               28040000
280500               END-IF                                             28050000
280600             END-IF                                               28060000
280700           END-IF                                                 28070000
280800         ELSE                                                     28080000
280900           IF SYSTRIGG-TRIGTIME = 'A'                             28090000
281000             IF SYSTRIGG-TRIGEVENT = 'I'                          28100000
281100               STRING '  '            DELIMITED BY SIZE,          28110000
281200               SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,         28120066
281300               ' IS EXECUTED ONCE PER ROW'                        28130000
281400                                      DELIMITED BY SIZE,          28140000
281500               ' AFTER AN INSERT'     DELIMITED BY SIZE           28150000
281600               INTO BROWSE-RECORD                                 28160000
281700             ELSE                                                 28170000
281800               IF SYSTRIGG-TRIGEVENT = 'U'                        28180000
281900                 STRING '  '            DELIMITED BY SIZE,        28190000
282000                 SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,       28200066
282100                 ' IS EXECUTED ONCE PER ROW'                      28210000
282200                                        DELIMITED BY SIZE,        28220000
282300                 ' AFTER AN UPDATE'     DELIMITED BY SIZE         28230000
282400                 INTO BROWSE-RECORD                               28240000
282500               ELSE                                               28250000
282600                 IF SYSTRIGG-TRIGEVENT = 'D'                      28260000
282700                   STRING '  '            DELIMITED BY SIZE,      28270000
282800                   SYSTRIGG-NAME-TEXT     DELIMITED BY SPACE,     28280066
282900                   ' IS EXECUTED ONCE PER ROW'                    28290000
283000                                          DELIMITED BY SIZE,      28300000
283100                   ' AFTER A DELETE '     DELIMITED BY SIZE       28310000
283200                   INTO BROWSE-RECORD                             28320000
283300                 END-IF                                           28330000
283400               END-IF                                             28340000
283500             END-IF                                               28350000
283600           END-IF                                                 28360000
283700         END-IF                                                   28370000
283800       END-IF                                                     28380000
283900     END-IF.                                                      28390000
284000                                                                  28400000
284100     WRITE BROWSE-RECORD.                                         28410000
284200     MOVE SPACES TO BROWSE-RECORD.                                28420000
284300                                                                  28430000
284400                                                                  28440000
284500  7830-EXIT.                                                      28450000
284600     EXIT.                                                        28460000
284700     EJECT                                                        28470000
284800************************************************************      28480000
284900* CLOSE SYSINDX_CURSOR                                     *      28490000
285000************************************************************      28500000
285100 7840-CLOSE-SYSTRIG-CURSOR.                                       28510000
285200                                                                  28520000
285300     EXEC SQL                                                     28530000
285400         CLOSE SYSTRIG_CURSOR                                     28540000
285500     END-EXEC.                                                    28550000
285600                                                                  28560000
285700     IF SQLCODE NOT = ZERO                                        28570000
285800         SET PS-DB2-ERROR TO TRUE                                 28580000
285900         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      28590000
286000         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         28600000
286100         MOVE '7840-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    28610000
286200              TO VAR-LMSG                                         28620000
286300         MOVE 'CMN000  ' TO ISP-MSG.                              28630000
286400                                                                  28640000
286500 7840-EXIT.                                                       28650000
286600     EXIT.                                                        28660000
286700     EJECT                                                        28670000
286800************************************************************      28680000
286900* OPEN SYSCHK_CURSOR CURSOR                               *       28690000
287000************************************************************      28700000
287100 7900-OPEN-COL-CKS.                                               28710000
287200                                                                  28720000
287300      EXEC SQL                                                    28730000
287400          OPEN SYSCHK_CURSOR                                      28740000
287500      END-EXEC.                                                   28750000
287600                                                                  28760000
287700      IF SQLCODE NOT = 0                                          28770000
287800          SET PS-DB2-ERROR TO TRUE                                28780000
287900          MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                     28790000
288000          MOVE SQLCODE TO VAR-SMSG-SQLCODE                        28800000
288100          MOVE '7900-OPEN CURSOR ABEND, CONTACT DATA RESOURCE'    28810000
288200               TO VAR-LMSG                                        28820000
288300          MOVE 'CMN000  ' TO ISP-MSG.                             28830000
288400                                                                  28840000
288500 7900-EXIT.                                                       28850000
288600     EXIT.                                                        28860000
288700     EJECT                                                        28870000
288800                                                                  28880000
288900************************************************************      28890000
289000* FETCH THE ROWS FROM SYSIBM.SYSCHECKS AND SYSCHECKDEP     *      28900000
289100************************************************************      28910000
289200 7905-FETCH-COL-CKS.                                              28920000
289300                                                                  28930000
289400     INITIALIZE DCLSYSCKDEP.                                      28940000
289500     INITIALIZE DCLSYSCHECK.                                      28950000
289600                                                                  28960000
289700     EXEC SQL                                                     28970000
289800         FETCH SYSCHK_CURSOR                                      28980000
289900         INTO  :SYSCHECK-CHECKNAME                                28990000
290000              ,:SYSCHECK-CHECKCONDITION                           29000000
290100     END-EXEC.                                                    29010000
290200                                                                  29020000
290300     IF SQLCODE = ZERO                                            29030000
290400        IF FIRSTCK                                                29040000
290500           MOVE SPACES           TO BROWSE-RECORD                 29050000
290600           WRITE                    BROWSE-RECORD                 29060000
290700           WRITE BROWSE-RECORD FROM CHECK-INFO-LINE               29070000
290800           MOVE 'N'              TO WS-FIRSTCK-SW                 29080000
290900        END-IF                                                    29090000
291000        MOVE SPACES           TO BROWSE-RECORD                    29100000
291011        IF SYSCHECK-CHECKCONDITION-LEN < 58                       29101199
291020            MOVE SYSCHECK-CHECKCONDITION-TEXT TO                  29102092
291030                  CK-CONDITION                                    29103092
291040            WRITE BROWSE-RECORD FROM CHECK-DATA-LINE1             29104092
291050        ELSE                                                      29105092
291060            MOVE SYSCHECK-CHECKCONDITION-TEXT TO                  29106092
291070                  WS-CK-CONDITION                                 29107092
291080            PERFORM VARYING CK-IDX FROM 58 BY -1                  29108099
291090            UNTIL WS-CK-CONDITION-CHARS(CK-IDX) = ','             29109092
291091            END-PERFORM                                           29109193
291094            SET CK-PTR TO CK-IDX                                  29109496
291095            MOVE WS-CK-CONDITION-DATA  (1:CK-PTR)   TO            29109596
291200              CK-CONDITION                                        29120000
291300            WRITE BROWSE-RECORD FROM CHECK-DATA-LINE1             29130092
291301            MOVE SPACES           TO BROWSE-RECORD                29130192
291302            MOVE WS-CK-CONDITION-DATA (CK-PTR:7400)   TO          29130296
291303              CK-CONDITION2                                       29130392
291304            WRITE BROWSE-RECORD FROM CHECK-DATA-LINE2             29130492
291310        END-IF                                                    29131092
291400                                                                  29140000
291500     ELSE                                                         29150000
291600       IF SQLCODE  =  +100                                        29160000
291700           MOVE 'Y' TO WS-END-COLCKS-SW                           29170000
291800       ELSE                                                       29180000
291900         SET PS-DB2-ERROR TO TRUE                                 29190000
292000         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      29200000
292100         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         29210000
292200         MOVE                                                     29220000
292300         '7905-FETCH-COL-CKS ABEND, CONTACT DATA RESOURCE'        29230000
292400             TO VAR-LMSG                                          29240000
292500         MOVE 'CMN000  ' TO ISP-MSG                               29250000
292600       END-IF                                                     29260000
292700     END-IF.                                                      29270000
292800                                                                  29280000
292900  7905-EXIT.                                                      29290000
293000     EXIT.                                                        29300000
293100     EJECT                                                        29310000
293200************************************************************      29320000
293300* CLOSE SYSINDX_CURSOR                                     *      29330000
293400************************************************************      29340000
293500 7990-CLOSE-COL-CKS.                                              29350000
293600                                                                  29360000
293700     EXEC SQL                                                     29370000
293800         CLOSE SYSCHK_CURSOR                                      29380000
293900     END-EXEC.                                                    29390000
294000                                                                  29400000
294100     IF SQLCODE NOT = ZERO                                        29410000
294200         SET PS-DB2-ERROR TO TRUE                                 29420000
294300         MOVE 'SQLCODE =' TO VAR-SMSG-FILLER                      29430000
294400         MOVE SQLCODE TO VAR-SMSG-SQLCODE                         29440000
294500         MOVE '7990-CLOSE CURSOR ABEND, CONTACT DATA RESOURCE'    29450000
294600              TO VAR-LMSG                                         29460000
294700         MOVE 'CMN000  ' TO ISP-MSG.                              29470000
294800                                                                  29480000
294900 7990-EXIT.                                                       29490000
295000     EXIT.                                                        29500000
295100     EJECT                                                        29510000
295200************************************************************      29520000
295300* DISPLAY BROWSE-FILE                                      *      29530000
295400************************************************************      29540000
295500 8000-BROWSE-FILE.                                                29550000
295600     MOVE ZERO TO PV-COUNTR.                                      29560008
295700     INSPECT PV-BROWSE-DSNAME TALLYING PV-COUNTR FOR              29570021
295800                 CHARACTERS BEFORE INITIAL '.'.                   29580008
295900     ADD 2 TO PV-COUNTR.                                          29590008
296000*BLJ MOVE PV-BROWSE-DSNAME (PV-COUNTR:13) TO VAR-DSNAME.          29600099
296010     MOVE PV-BROWSE-DSNAME (PV-COUNTR:21) TO VAR-DSNAME.          29601099
296100     MOVE 'CMNEKR2D' TO ISP-PANEL.                                29610008
296200     CALL 'ISPLINK' USING ISP-BROWSE,                             29620008
296300                          VAR-DSNAME,                             29630008
296400                          VAR-VOLUME,                             29640008
296500                          VAR-PASSWORD,                           29650008
296600                          ISP-PANEL.                              29660008
296700*                                                                 29670007
296800*  CALL THE COMMON PRINT REQUEST PANEL PROGRAM TO ALLOW THE OPTION29680007
296900*  OF PRINTING THE FILE THAT WAS JUST BROWSED.                    29690007
297000*                                                                 29700007
297100     INITIALIZE DP300-ISPF-PRINT-PARMS.                           29710008
297200     MOVE PC-CURRENT-PROGRAM-NAME TO                              29720008
297300               DP300-CALLING-PROGRAM-NAME.                        29730008
297400     MOVE 1 TO DP300-CALLING-REPORT-NUMBER.                       29740011
297500     MOVE PV-BROWSE-DSNAME TO DP300-FILE-DSNAME.                  29750021
297600     SET DP300-FR-FIXED-BLOCK TO TRUE.                            29760016
297700     MOVE 80 TO DP300-FILE-LRECL.                                 29770016
297800     SET DP300-PT-PRINT-TITLE-LINE                                29780016
297900         DP300-RH-REPEAT-HEADINGS TO TRUE.                        29790016
298000     MOVE 2 TO DP300-HEADING-LINE-COUNT.                          29800016
298100     CALL DP300-ISPF-PRINT-REQ-PROGRAM                            29810008
298200               USING DP300-ISPF-PRINT-PARMS.                      29820008
298300     MOVE 'CMN000  ' TO ISP-MSG                                   29830008
298400     MOVE DP300-ERROR-MESSAGE TO VAR-LMSG.                        29840008
298500     IF DP300-RI-PRINT-REQUESTED                                  29850008
298600         MOVE DP300-ERROR-MESSAGE TO VAR-SMSG                     29860008
298700     END-IF.                                                      29870008
298800                                                                  29880008
298900************************************************************      29890000
299000* DELETE BROWSE FILE                                       *      29900000
299100************************************************************      29910000
299200 9100-DELETE-FILE.                                                29920000
299300     INITIALIZE DP023-DYNALC-PARMS.                               29930007
299400     MOVE PC-BROWSE-DDNAME TO DP023-DDNAME.                       29940021
299500     MOVE PV-BROWSE-DSNAME TO DP023-DSNAME.                       29950021
299600     SET DP023-DISP-DELETE TO TRUE.                               29960007
299700     SET DP023-FREE-CLOSE-NO TO TRUE.                             29970007
299800     SET DP023-RECFM-FIXED-BLOCK TO TRUE.                         29980007
299900     MOVE LENGTH OF BROWSE-RECORD TO DP023-RECSZ.                 29990026
300000     MOVE ZEROES TO DP023-RECOUNT.                                30000026
300100                                                                  30010007
300200     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     30020007
300300                                                                  30030007
300400     PERFORM DP023-0000-DYNALC.                                   30040007
300500                                                                  30050007
300600     SET PS-IS-NOT-ALLOCATED TO TRUE.                             30060008
300700                                                                  30070007
300800*                                                                 30080007
300900*  DYNAMIC ALLOCATION ROUTINE                                     30090007
301000*                                                                 30100007
301100     COPY DPPD023.                                                30110007
