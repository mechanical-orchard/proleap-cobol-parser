000100*                                                                 06/20/94
000200*                                                                 DPKCS017
000300*                                                                    LV001
000400 IDENTIFICATION DIVISION.                                         DPKCS017
000500                                                                  DPKCS017
000600 PROGRAM-ID.    DPKCS017.                                         DPKCS017
000700 AUTHOR.        DAN FRANKLIN.                                     DPKCS017
000800 INSTALLATION.  KOHLS DEPARTMENT STORES.                          DPKCS017
000900 DATE-WRITTEN.  09-25-90.                                         DPKCS017
001000 DATE-COMPILED.                                                   DPKCS017
001100                                                                  DPKCS017
001200***************************************************************** DPKCS017
001300*    FUNCTION KEY ASSIGNMENT (Z017)                               DPKCS017
001400*                                                                 DPKCS017
001500*    THIS PROGRAM WILL ALLOW A USER TO DETERMINE WHAT FUNCTION    DPKCS017
001600*    KEYS SHOULD BE AVAILABLE FOR A CERTAIN MNEMONIC.  BASED ON   DPKCS017
001700*    THE MNEMONIC PASSED TO THIS PROGRAM OR ENTERED BY THE USER,  DPKCS017
001800*    THE PROGRAM WILL SHOW ALL THE AVAILABLE FUNCTION KEYS AND    DPKCS017
001900*    WHICH ONES THE MNEMONIC ALREADY USES (HIGHLIGHTED IN PINK).  DPKCS017
002000*    THE USER CAN EITHER ADD, UPDATE OR DELETE THE SPECIFIC       DPKCS017
002100*    FUNCTION KEYS THAT THE MNEMONIC IS TO USE.  THESE SPECIFIC   DPKCS017
002200*    KEYS USED BY EACH MNEMONIC ARE STORED ON THE TCICSROUTE      DPKCS017
002300*    TABLE.  FUNCTION KEYS THAT ARE COMMON AMONG ALL MNEMONICS    DPKCS017
002400*    (<CLEAR>, <ENTER>, PA2, ETC.) ARE CALLED SYSTEM WIDE FUNCTION      17
002500*    KEYS.  THESE COMMON KEYS ARE ALSO FOUND ON THE TCICSROUTE    DPKCS017
002600*    TABLE, BUT THE USER WILL NOT BE ALLOWED TO UPDATE THEM.      DPKCS017
002700***************************************************************** DPKCS017
002800*    10/15/91 - 1220 - MADE BY DAN FRANKLIN                       DPKCS017
002900*                                                                 DPKCS017
003000*    ALLOW ACTION CODES OF 'A', 'B', 'C', AND 'D'                 DPKCS017
003100***************************************************************** DPKCS017
003200*    10/31/91 - 1220 - MADE BY DAN FRANKLIN                       DPKCS017
003300*                                                                 DPKCS017
003400*    ALLOW ACTION CODES OF 'E' AND 'F'                            DPKCS017
003500***************************************************************** DPKCS017
003600*    04/16/92 - 1614 - MADE BY M. FURLICK                         DPKCS017
003700*                                                                 DPKCS017
003800*    USE STATUS FIELD INSTEAD OF COLOR CODING;                    DPKCS017
003900*    ADD ACTION DESCRIPTION TO INTERPRET CODE;                    DPKCS017
004000*    ADD ALTERNATE LABEL - ENTERABLE;                             DPKCS017
004100*    ADD INTER-APPLICATION COMMAREA FORMAT INDIDCATOR - ENTERABLE;DPKCS017
004200*    MAJOR SCREEN REFORMAT - ALLOW SCROLLING;                     DPKCS017
004300*    ADD FUNCTIONALITY FOR MENUES - ATOMATICALLY ASSIGN REQUIRED  DPKCS017
004400*        MENU FUNCTION KEYS;                                      DPKCS017
004500*    IMPLEMENT DETAIL LEVEL SCROLLING (TSQ B LOGIC).              DPKCS017
004600***************************************************************** DPKCS017
004700*    03/22/96 -      - MADE BY CHERI MASTEL, TKMA235              DPKCS017
004800*                                                                       17
004900*    1) ADDED LOGIC FOR CICS24X7 PROCESSING; ARCHITECTURE                 
005000*       CHANGES TO ALLOW CICS TO BE UP 24HRS/DAY, 7DAYS/WEEK.             
005100*       * IF ANY ROWS ON THE TCICSROUTE TABLE ARE UPDATED,                
005200*         INSERTED, OR DELETED, UPDATE THE UPD_VSAM_IND FIELD ON          
005300*         THE TMNEMONIC TABLE TO A "Y".                                   
005400*    2) ALSO ADDED LOGIC FOR FUNCTION KEY PROJECT:                        
005500*       * MODIFIED THE MAP (DPKM017) AND PROGRAM TO DISPLAY "DISP"        
005600*         FIELD AFTER "ACTION" FIELD.                                     
005700*       * UPDATE THE FUNC_KY_DSIPN_IND FIELD ON THE TCICSROUTE            
005800*         TABLE TO 'L'(LOCAL), 'G'(GO), 'R'(RETURN),                      
005900*         AS APPROPRIATE.                                                 
006000***************************************************************** DPKCS017
006100                                                                  DPKCS017
006200*                                                                 DPKCS017
006300*                                                                 DPKCS017
006400*                                                                 DPKCS017
006500 ENVIRONMENT DIVISION.                                            DPKCS017
006600*                                                                 DPKCS017
006700*                                                                 DPKCS017
006800*                                                                 DPKCS017
006900 DATA DIVISION.                                                   DPKCS017
007000*                                                                 DPKCS017
007100*                                                                 DPKCS017
007200 WORKING-STORAGE SECTION.                                         DPKCS017
007300                                                                  DPKCS017
007400 01  IV-INDICATOR-VARIABLES.                                      DPKCS017
007500     05  IV-PANEL-TITLE-NAME            PIC S9(04)   VALUE +0     DPKCS017
007600                                                     COMP SYNC.   DPKCS017
007700     05  IV-MNEMONIC-CODE               PIC S9(04)   VALUE +0     DPKCS017
007800                                                     COMP SYNC.   DPKCS017
007900                                                                  DPKCS017
008000 01  PC-PROGRAM-CONSTANTS.                                        DPKCS017
008100     05  PC-NAVIGATOR-TRAN-ID           PIC X(04)    VALUE 'Z008'.DPKCS017
008200     05  PC-MAXIMUM-COMMAREA-LENGTH     PIC S9(04)   VALUE +4072  DPKCS017
008300                                                     COMP SYNC.   DPKCS017
008400     05  PC-NULL-INDICATOR              PIC S9(04)   VALUE -1     DPKCS017
008500                                                     COMP SYNC.   DPKCS017
008600     05  PC-LOCAL-FKEY-START            PIC S9(04)   VALUE +17    DPKCS017
008700                                                     COMP SYNC.   DPKCS017
008800     05  PC-LOCAL-FKEY-ADJUST           PIC S9(03)   VALUE +16    DPKCS017
008900                                                     COMP-3.      DPKCS017
009000     05  PC-CURRENT-MAP-NAME            PIC X(08)    VALUE        DPKCS017
009100     'DP017A  '.                                                  DPKCS017
009200     05  PC-CURRENT-MAPSET-NAME         PIC X(08)    VALUE        DPKCS017
009300     'DPKM017 '.                                                  DPKCS017
009400     05  PC-CURRENT-PROGRAM-NAME        PIC X(08)    VALUE        DPKCS017
009500     'DPKCS017'.                                                  DPKCS017
009600     05  PC-ACKNOWLEDGE-CODE            PIC X(04)    VALUE 'CMIA'.DPKCS017
009700     05  PC-DELETE-CONFIRMATION-STATUS.                                 17
009800         10  PC-CONFIRMED               PIC X(01)    VALUE 'Y'.   DPKCS017
009900         10  PC-NOT-CONFIRMED           PIC X(01)    VALUE 'N'.   DPKCS017
010000     05  PC-EDIT-SELECT-VALID-VALUES.                                   17
010100         10  PC-SELECT                  PIC X(01)    VALUE 'S'.   DPKCS017
010200     05  PC-EDIT-ACTION-VALID-VALUES.                                   17
010300         10  PC-GO-TO-MNEMONIC          PIC X(01)    VALUE '1'.   DPKCS017
010400         10  PC-RETURN                  PIC X(01)    VALUE '2'.   DPKCS017
010500         10  PC-CONFIRM                 PIC X(01)    VALUE '3'.   DPKCS017
010600         10  PC-NAV-REFRESH             PIC X(01)    VALUE '4'.   DPKCS017
010700         10  PC-PREVPAGE                PIC X(01)    VALUE '5'.   DPKCS017
010800         10  PC-NEXTPAGE                PIC X(01)    VALUE '6'.   DPKCS017
010900         10  PC-1ST-PAGE                PIC X(01)    VALUE '7'.   DPKCS017
011000         10  PC-LOCAL-FUNC-KEY          PIC X(01)    VALUE '8'.   DPKCS017
011100         10  PC-DSEL-ALL                PIC X(01)    VALUE '9'.   DPKCS017
011200         10  PC-SEL-ALL                 PIC X(01)    VALUE 'A'.   DPKCS017
011300         10  PC-LOCAL-GOTO              PIC X(01)    VALUE 'B'.   DPKCS017
011400         10  PC-FK-LEFT                 PIC X(01)    VALUE 'C'.   DPKCS017
011500         10  PC-FK-RIGHT                PIC X(01)    VALUE 'D'.   DPKCS017
011600         10  PC-FK-PREV-SELECTION       PIC X(01)    VALUE 'E'.   DPKCS017
011700         10  PC-FK-NEXT-SELECTION       PIC X(01)    VALUE 'F'.   DPKCS017
011800         10  PC-LOCAL-RETURN            PIC X(01)    VALUE 'G'.   DPKCS017
011900         10  PC-N                       PIC X(01)    VALUE 'N'.         17
012000         10  PC-LOCAL-01                PIC X(01)    VALUE 'O'.         17
012100         10  PC-LOCAL-02                PIC X(01)    VALUE 'P'.         17
012200         10  PC-LOCAL-03                PIC X(01)    VALUE 'Q'.         17
012300         10  PC-LOCAL-04                PIC X(01)    VALUE 'R'.         17
012400         10  PC-LOCAL-05                PIC X(01)    VALUE 'S'.         17
012500         10  PC-LOCAL-06                PIC X(01)    VALUE 'T'.         17
012600         10  PC-LOCAL-07                PIC X(01)    VALUE 'U'.         17
012700         10  PC-LOCAL-08                PIC X(01)    VALUE 'V'.         17
012800         10  PC-LOCAL-09                PIC X(01)    VALUE 'W'.         17
012900         10  PC-LOCAL-10                PIC X(01)    VALUE 'X'.         17
013000         10  PC-LOCAL-11                PIC X(01)    VALUE 'Y'.         17
013100         10  PC-LOCAL-12                PIC X(01)    VALUE 'Z'.         17
013200     05  PC-EDIT-DISP-VALID-VALUES.                                     17
013300         10  PC-DISP-L-LOCAL            PIC X(01)    VALUE 'L'.         17
013400         10  PC-DISP-G-GO               PIC X(01)    VALUE 'G'.         17
013500         10  PC-DISP-R-RETURN           PIC X(01)    VALUE 'R'.         17
013600     05  PC-EDIT-STACK-VALID-VALUES.                                    17
013700         10  PC-STACK                   PIC X(01)    VALUE 'Y'.   DPKCS017
013800         10  PC-NO-STACK                PIC X(01)    VALUE 'N'.   DPKCS017
013900     05  PC-Y                           PIC X(01)    VALUE 'Y'.   DPKCS017
014000     05  PC-REFORMAT-TMESTP-CHARACTERS.                                 17
014100         10  PC-DASH                    PIC X(01)    VALUE '-'.   DPKCS017
014200         10  PC-DOT                     PIC X(01)    VALUE '.'.   DPKCS017
014300     05  PC-TAIDKEY-SYSWIDE-OPTIONS.                                    17
014400         10  PC-SYSWIDE                 PIC X(01)    VALUE 'Y'.   DPKCS017
014500         10  PC-NOT-SYSWIDE             PIC X(01)    VALUE 'N'.   DPKCS017
014600     05  PC-MNEMONIC-TYPE-OPTIONS.                                      17
014700         10  PC-MNDTRY                  PIC X(01)    VALUE 'Y'.   DPKCS017
014800         10  PC-NOT-MNDTRY              PIC X(01)    VALUE 'N'.   DPKCS017
014900     05  PC-MAINTENANCE-RESULT-OPTIONS.                                 17
015000         10  PC-CREATED                 PIC X(01)    VALUE '1'.   DPKCS017
015100         10  PC-UPDATED                 PIC X(01)    VALUE '2'.   DPKCS017
015200         10  PC-DELETED                 PIC X(01)    VALUE '3'.   DPKCS017
015300         10  PC-SELECTED                PIC X(01)    VALUE '4'.   DPKCS017
015400         10  PC-ERROR                   PIC X(01)    VALUE '5'.   DPKCS017
015500     05  PC-INVALID                     PIC X(08)    VALUE        DPKCS017
015600                                                     'INVALID '.  DPKCS017
015700     05  PC-STATUS-ACTIVE               PIC X(08)    VALUE        DPKCS017
015800                                                     'ACTIVE'.    DPKCS017
015900     05  PC-STATUS-INACTIVE             PIC X(08)    VALUE        DPKCS017
016000                                                     'INACTIVE'.  DPKCS017
016100     05  PC-MAX-ITEMS-ON-SCREEN         PIC S9(04)   VALUE +12    DPKCS017
016200                                                     COMP SYNC.   DPKCS017
016300     05  PC-MAX-FKEYS                   PIC S9(04)   VALUE +29    DPKCS017
016400                                                     COMP SYNC.   DPKCS017
016500     05  PC-ERASE-EOF-COMP              PIC S9(04)   VALUE +128   DPKCS017
016600                                                     COMP SYNC.   DPKCS017
016700     05  FILLER REDEFINES PC-ERASE-EOF-COMP.                      DPKCS017
016800         10  FILLER                     PIC X(01).                DPKCS017
016900         10  PC-ERASE-EOF               PIC X(01).                DPKCS017
017000     05  PC-CURSOR-POSITIONING.                                         17
017100         10  PC-CURSOR-POS              PIC S9(01)   VALUE -1.    DPKCS017
017200         10  PC-NO-CURSOR               PIC S9(01)   VALUE ZERO.  DPKCS017
017300                                                                  DPKCS017
017400 01  PC-SYSTEM-MESSAGES.                                          DPKCS017
017500     05  PC-TSYMSG-00004                PIC 9(5)     VALUE 00004. DPKCS017
017600     05  PC-TSYMSG-00005                PIC 9(5)     VALUE 00005. DPKCS017
017700     05  PC-TSYMSG-00007                PIC 9(5)     VALUE 00007. DPKCS017
017800     05  PC-TSYMSG-00034                PIC 9(5)     VALUE 00034. DPKCS017
017900     05  PC-TSYMSG-00045                PIC 9(5)     VALUE 00045. DPKCS017
018000     05  PC-TSYMSG-00070                PIC 9(5)     VALUE 00070. DPKCS017
018100     05  PC-TSYMSG-00115                PIC 9(5)     VALUE 00115. DPKCS017
018200     05  PC-TSYMSG-00118                PIC 9(5)     VALUE 00118. DPKCS017
018300     05  PC-TSYMSG-00148                PIC 9(5)     VALUE 00148. DPKCS017
018400     05  PC-TSYMSG-00259                PIC 9(5)     VALUE 00259. DPKCS017
018500     05  PC-TSYMSG-00260                PIC 9(5)     VALUE 00260. DPKCS017
018600     05  PC-TSYMSG-00261                PIC 9(5)     VALUE 00261. DPKCS017
018700     05  PC-TSYMSG-00262                PIC 9(5)     VALUE 00262. DPKCS017
018800     05  PC-TSYMSG-00263                PIC 9(5)     VALUE 00263. DPKCS017
018900     05  PC-TSYMSG-00264                PIC 9(5)     VALUE 00264. DPKCS017
019000     05  PC-TSYMSG-00265                PIC 9(5)     VALUE 00265. DPKCS017
019100     05  PC-TSYMSG-00831                PIC 9(5)     VALUE 00831. DPKCS017
019200     05  PC-TSYMSG-01177                PIC 9(5)     VALUE 01177. DPKCS017
019300     05  PC-TSYMSG-01221                PIC 9(5)     VALUE 01221. DPKCS017
019400     05  PC-TSYMSG-01222                PIC 9(5)     VALUE 01222. DPKCS017
019500     05  PC-TSYMSG-01223                PIC 9(5)     VALUE 01223. DPKCS017
019600     05  PC-TSYMSG-01224                PIC 9(5)     VALUE 01224. DPKCS017
019700     05  PC-TSYMSG-01225                PIC 9(5)     VALUE 01225. DPKCS017
019800     05  PC-TSYMSG-01226                PIC 9(5)     VALUE 01226. DPKCS017
019900     05  PC-TSYMSG-01227                PIC 9(5)     VALUE 01227. DPKCS017
020000                                                                  DPKCS017
020100 01  PM-PROGRAM-MESSAGES.                                         DPKCS017
020200     05  PM-PROGRAM-MESSAGE-2           PIC X(78)    VALUE        DPKCS017
020300     'ERROR TRYING TO SELECT A ROW FROM TMNEMONIC TABLE - SQLCODE DPKCS017
020400-    ''.                                                          DPKCS017
020500     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-2.                   DPKCS017
020600         10  FILLER                     PIC X(60).                DPKCS017
020700         10  PM-SQLCODE-2               PIC Z(08)9-.              DPKCS017
020800         10  FILLER                     PIC X(08).                DPKCS017
020900     05  PM-PROGRAM-MESSAGE-3           PIC X(78)    VALUE        DPKCS017
021000     'ERROR TRYING TO OPEN CURSOR FOR TAIDKEY TABLE - SQLCODE '.  DPKCS017
021100     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-3.                   DPKCS017
021200         10  FILLER                     PIC X(56).                DPKCS017
021300         10  PM-SQLCODE-3               PIC Z(08)9-.              DPKCS017
021400         10  FILLER                     PIC X(12).                DPKCS017
021500     05  PM-PROGRAM-MESSAGE-4           PIC X(78)    VALUE        DPKCS017
021600     'ERROR TRYING TO FETCH A ROW FROM TAIDKEY TABLE - SQLCODE '. DPKCS017
021700     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-4.                   DPKCS017
021800         10  FILLER                     PIC X(57).                DPKCS017
021900         10  PM-SQLCODE-4               PIC Z(08)9-.              DPKCS017
022000         10  FILLER                     PIC X(11).                DPKCS017
022100     05  PM-PROGRAM-MESSAGE-5           PIC X(78)    VALUE        DPKCS017
022200     'ERROR TRYING TO CLOSE CURSOR FOR TAIDKEY TABLE - SQLCODE '. DPKCS017
022300     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-5.                   DPKCS017
022400         10  FILLER                     PIC X(57).                DPKCS017
022500         10  PM-SQLCODE-5               PIC Z(08)9-.              DPKCS017
022600         10  FILLER                     PIC X(11).                DPKCS017
022700     05  PM-PROGRAM-MESSAGE-6           PIC X(78)    VALUE        DPKCS017
022800     'ERROR TRYING TO SELECT A ROW FROM TCICSROUTE TABLE - SQLCODEDPKCS017
022900-    ' '.                                                         DPKCS017
023000     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-6.                   DPKCS017
023100         10  FILLER                     PIC X(61).                DPKCS017
023200         10  PM-SQLCODE-6               PIC Z(08)9-.              DPKCS017
023300         10  FILLER                     PIC X(07).                DPKCS017
023400     05  PM-PROGRAM-MESSAGE-8           PIC X(78)    VALUE        DPKCS017
023500     'ERROR TRYING TO SELECT A ROW FROM TAIDKEY TABLE - SQLCODE '.DPKCS017
023600     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-8.                   DPKCS017
023700         10  FILLER                     PIC X(58).                DPKCS017
023800         10  PM-SQLCODE-8               PIC Z(08)9-.              DPKCS017
023900         10  FILLER                     PIC X(10).                DPKCS017
024000     05  PM-PROGRAM-MESSAGE-10          PIC X(78)    VALUE        DPKCS017
024100     'ERROR TRYING TO DELETE A ROW FROM TCICSROUTE TABLE - SQLCODEDPKCS017
024200-    ' '.                                                         DPKCS017
024300     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-10.                  DPKCS017
024400         10  FILLER                     PIC X(61).                DPKCS017
024500         10  PM-SQLCODE-10              PIC Z(08)9-.              DPKCS017
024600         10  FILLER                     PIC X(07).                DPKCS017
024700     05  PM-PROGRAM-MESSAGE-19          PIC X(78)    VALUE        DPKCS017
024800     'NON-NAVIGATIONAL MNEMONIC FOUND ON TMNEMONIC TABLE'.        DPKCS017
024900     05  PM-PROGRAM-MESSAGE-22          PIC X(78)    VALUE        DPKCS017
025000     'ERROR TRYING TO INSERT A ROW INTO TCICSROUTE TABLE - SQLCODEDPKCS017
025100-    ' '.                                                         DPKCS017
025200     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-22.                  DPKCS017
025300         10  FILLER                     PIC X(61).                DPKCS017
025400         10  PM-SQLCODE-22              PIC Z(08)9-.              DPKCS017
025500         10  FILLER                     PIC X(07).                DPKCS017
025600     05  PM-PROGRAM-MESSAGE-24          PIC X(78)    VALUE        DPKCS017
025700     'ERROR TRYING TO UPDATE A ROW FROM TCICSROUTE TABLE - SQLCODEDPKCS017
025800-    ' '.                                                         DPKCS017
025900     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-24.                  DPKCS017
026000         10  FILLER                     PIC X(61).                DPKCS017
026100         10  PM-SQLCODE-24              PIC Z(08)9-.              DPKCS017
026200         10  FILLER                     PIC X(07).                DPKCS017
026300     05  PM-PROGRAM-MESSAGE-26          PIC X(78)    VALUE        DPKCS017
026400     'DELETE REQUESTED FOR A FUNCTION KEY THAT IS NOT ACTIVE'.    DPKCS017
026500     05  PM-PROGRAM-MESSAGE-28          PIC X(78)    VALUE        DPKCS017
026600     'INVALID NEXT APPLICATION ACTIVITY RECEIVED'.                DPKCS017
026700     05  PM-PROGRAM-MESSAGE-31          PIC X(78)    VALUE        DPKCS017
026800     'ERROR TRYING TO ACCESS TEMP STORAGE QUEUE "B" - RESP = '.   DPKCS017
026900     05  FILLER REDEFINES PM-PROGRAM-MESSAGE-31.                  DPKCS017
027000         10  FILLER                     PIC X(61).                DPKCS017
027100         10  PM-RESP-31                 PIC Z(08)9-.              DPKCS017
027200         10  FILLER                     PIC X(07).                DPKCS017
027300     05  PM-PROGRAM-MESSAGE-T.                                    DPKCS017
027400         10  FILLER                     PIC X(07)    VALUE        DPKCS017
027500             'TMESTP='.                                                 17
027600         10  PM-TMESTP                  PIC X(26).                DPKCS017
027700         10  FILLER                     PIC X(01)    VALUE '.'.   DPKCS017
027800                                                                  DPKCS017
027900 01  PC-FKEY-ACTION-DESCRIPTIONS.                                 DPKCS017
028000     05  FILLER                     PIC X(9) VALUE '1GO TO   '.   DPKCS017
028100     05  FILLER                     PIC X(9) VALUE '2RETURN  '.   DPKCS017
028200     05  FILLER                     PIC X(9) VALUE '3CONFIRM '.   DPKCS017
028300     05  FILLER                     PIC X(9) VALUE '4REFRESH '.   DPKCS017
028400     05  FILLER                     PIC X(9) VALUE '5PREVPAGE'.   DPKCS017
028500     05  FILLER                     PIC X(9) VALUE '6NEXTPAGE'.   DPKCS017
028600     05  FILLER                     PIC X(9) VALUE '71ST PAGE'.   DPKCS017
028700     05  FILLER                     PIC X(9) VALUE '8LOCALKEY'.   DPKCS017
028800     05  FILLER                     PIC X(9) VALUE '9DESELECT'.   DPKCS017
028900     05  FILLER                     PIC X(9) VALUE 'ASLECTALL'.   DPKCS017
029000     05  FILLER                     PIC X(9) VALUE 'BLOCAL GO'.   DPKCS017
029100     05  FILLER                     PIC X(9) VALUE 'CLEFT    '.   DPKCS017
029200     05  FILLER                     PIC X(9) VALUE 'DRIGHT   '.   DPKCS017
029300     05  FILLER                     PIC X(9) VALUE 'EPREV SEL'.   DPKCS017
029400     05  FILLER                     PIC X(9) VALUE 'FNEXT SEL'.   DPKCS017
029500     05  FILLER                     PIC X(9) VALUE 'GLOCALRET'.   DPKCS017
029600     05  FILLER                     PIC X(9) VALUE 'OLOCAL-01'.   DPKCS017
029700     05  FILLER                     PIC X(9) VALUE 'PLOCAL-02'.   DPKCS017
029800     05  FILLER                     PIC X(9) VALUE 'QLOCAL-03'.   DPKCS017
029900     05  FILLER                     PIC X(9) VALUE 'RLOCAL-04'.   DPKCS017
030000     05  FILLER                     PIC X(9) VALUE 'SLOCAL-05'.   DPKCS017
030100     05  FILLER                     PIC X(9) VALUE 'TLOCAL-06'.   DPKCS017
030200     05  FILLER                     PIC X(9) VALUE 'ULOCAL-07'.   DPKCS017
030300     05  FILLER                     PIC X(9) VALUE 'VLOCAL-08'.   DPKCS017
030400     05  FILLER                     PIC X(9) VALUE 'WLOCAL-09'.   DPKCS017
030500     05  FILLER                     PIC X(9) VALUE 'XLOCAL-10'.   DPKCS017
030600     05  FILLER                     PIC X(9) VALUE 'YLOCAL-11'.   DPKCS017
030700     05  FILLER                     PIC X(9) VALUE 'ZLOCAL-12'.   DPKCS017
030800     05  FILLER                     PIC X(9) VALUE  HIGH-VALUE.   DPKCS017
030900 01  FILLER  REDEFINES  PC-FKEY-ACTION-DESCRIPTIONS.              DPKCS017
031000     05  PT-FKEY-TABLE OCCURS 29 INDEXED BY PT-FT-IND.            DPKCS017
031100         10  PT-FT-ACT                  PIC X.                    DPKCS017
031200         10  PT-FT-DESC                 PIC X(8).                 DPKCS017
031300                                                                  DPKCS017
031400 01  PS-PROGRAM-SUBSCRIPTS.                                       DPKCS017
031500     05  PS-SUB                         PIC S9(04)   VALUE +0     DPKCS017
031600                                                     COMP SYNC.   DPKCS017
031700     05  PS-SAVE-SUB                    PIC S9(04)   VALUE +0     DPKCS017
031800                                                     COMP SYNC.   DPKCS017
031900                                                                  DPKCS017
032000 01  PS-PROGRAM-SWITCHES.                                         DPKCS017
032100     05  PS-MAP-SEND-TYPE               PIC X(01)    VALUE '1'.   DPKCS017
032200         88  PS-SEND-MAP-N-DATA-FRSET                VALUE '1'.   DPKCS017
032300         88  PS-SEND-MAP-N-DATA-FRSET-CPOSN          VALUE '2'.   DPKCS017
032400         88  PS-SEND-DATA-ONLY-FRSET                 VALUE '3'.   DPKCS017
032500         88  PS-SEND-DATA-ONLY                       VALUE '4'.   DPKCS017
032600         88  PS-SEND-DATA-ONLY-ERASEAUP              VALUE '5'.   DPKCS017
032700         88  PS-SEND-MAP-ONLY-FRSET                  VALUE '6'.   DPKCS017
032800     05  PS-NEW-MNEMONIC-REQUESTED-SW   PIC X(01)    VALUE 'N'.   DPKCS017
032900         88  PS-NEW-MNEMONIC-REQUESTED               VALUE 'Y'.   DPKCS017
033000         88  PS-NEW-MNEMONIC-NOT-REQUESTED           VALUE 'N'.   DPKCS017
033100     05  PS-LOCAL-FUNCTION-KEY-SW       PIC X(01)    VALUE 'N'.   DPKCS017
033200         88  PS-LOCAL-FUNCTION-KEY                   VALUE 'Y'.   DPKCS017
033300         88  PS-NO-LOCAL-FUNCTION-KEY                VALUE 'N'.   DPKCS017
033400     05  PS-ERROR-SW                    PIC X(01)    VALUE 'N'.   DPKCS017
033500         88  PS-ERROR                                VALUE 'Y'.   DPKCS017
033600         88  PS-NO-ERROR                             VALUE 'N'.   DPKCS017
033700     05  PS-INSERT-UPDATE-SW            PIC X(01)    VALUE 'N'.   DPKCS017
033800         88  PS-INSERT                               VALUE 'Y'.   DPKCS017
033900         88  PS-UPDATE                               VALUE 'N'.   DPKCS017
034000     05  PS-ITEM-SELECTED-SW            PIC X(01)    VALUE 'N'.   DPKCS017
034100         88  PS-ITEM-SELECTED                        VALUE 'Y'.   DPKCS017
034200         88  PS-NO-ITEM-SELECTED                     VALUE 'N'.   DPKCS017
034300     05  PS-EDITING-ACT-SW              PIC X(01)    VALUE 'N'.   DPKCS017
034400         88  PS-EDITING-ACT                          VALUE 'Y'.   DPKCS017
034500         88  PS-NO-EDITING-ACT                       VALUE 'N'.   DPKCS017
034600     05  PS-WARNING-SWITCH              PIC X(01)    VALUE 'N'.   DPKCS017
034700         88  PS-WARNING                              VALUE 'Y'.   DPKCS017
034800         88  PS-NO-WARNING                           VALUE 'N'.   DPKCS017
034900                                                                  DPKCS017
035000 01  PV-PROGRAM-VARIABLES.                                        DPKCS017
035100     05  PV-MNEMONIC                    PIC X(08)    VALUE SPACES.DPKCS017
035200     05  PV-MESSAGE                     PIC X(78)    VALUE SPACES.DPKCS017
035300     05  PV-CICS-RESPONSE               PIC S9(04)   VALUE +0     DPKCS017
035400                                                     COMP SYNC.   DPKCS017
035500     05  PV-RESP                        PIC S9(04)   VALUE +0     DPKCS017
035600                                                     COMP SYNC.   DPKCS017
035700     05  PV-HOLD-SCR-SUB                PIC S9(04)   VALUE +0     DPKCS017
035800                                                     COMP SYNC.   DPKCS017
035900     05  PV-TSUB                        PIC S9(04)   VALUE +0     DPKCS017
036000                                                     COMP SYNC.   DPKCS017
036100     05  PV-TMESTP                      PIC X(26)    VALUE SPACES.DPKCS017
036200     05  PV-TMESTP-REFORMAT-CHAR                                        17
036300         REDEFINES                                                      17
036400         PV-TMESTP.                                                     17
036500         10  PV-TRC-CCYY                PIC 9(04).                      17
036600         10  PV-TRC-DASH1               PIC X(01).                      17
036700         10  PV-TRC-MM                  PIC 9(02).                      17
036800         10  PV-TRC-DASH2               PIC X(01).                      17
036900         10  PV-TRC-DD                  PIC 9(02).                      17
037000         10  PV-TRC-DASH3               PIC X(01).                      17
037100         10  PV-TRC-HR                  PIC 9(02).                      17
037200         10  PV-TRC-DOT1                PIC X(01).                      17
037300         10  PV-TRC-MN                  PIC 9(02).                      17
037400         10  PV-TRC-DOT2                PIC X(01).                      17
037500         10  PV-TRC-SC                  PIC 9(02).                      17
037600         10  PV-TRC-DOT3                PIC X(01).                      17
037700         10  PV-TRC-TK                  PIC 9(06).                      17
037800     05  PV-TMESTP-REFORMAT-SHORT-X20.                                  17
037900         15  PV-TRS-CCYY                PIC 9(04).                      17
038000         15  PV-TRS-MM                  PIC 9(02).                      17
038100         15  PV-TRS-DD                  PIC 9(02).                      17
038200         15  PV-TRS-HR                  PIC 9(02).                      17
038300         15  PV-TRS-MN                  PIC 9(02).                      17
038400         15  PV-TRS-SC                  PIC 9(02).                      17
038500         15  PV-TRS-TK                  PIC 9(06).                      17
038600     05  PV-ACT                         PIC X(01)    VALUE SPACES.DPKCS017
038700     05  PV-DISP                        PIC X(01)    VALUE SPACES.DPKCS017
038800     05  PV-STK                         PIC X(01)    VALUE SPACES.DPKCS017
038900     05  PV-LABEL                       PIC X(08)    VALUE SPACES.DPKCS017
039000     05  PV-LABEL2                      PIC X(08)    VALUE SPACES.DPKCS017
039100     05  PV-FORMAT                      PIC X(01)    VALUE SPACES.DPKCS017
039200     05  PV-SEQUENCE-NMBR               PIC 9(02)    VALUE ZEROES.DPKCS017
039300     05  FILLER REDEFINES PV-SEQUENCE-NMBR.                       DPKCS017
039400         10  PV-SEQUENCE-NMBR-CHAR      PIC X(02).                DPKCS017
039500     05  PV-FORMAT-CODE                 PIC X(04)    VALUE 'FKEY'.DPKCS017
039600     05  PV-ACCEPTED-FORMAT-CODE        PIC X(04)    VALUE SPACES.DPKCS017
039700         88  PV-FKEY-FORMAT-CODE                     VALUE 'FKEY'.DPKCS017
039800         88  PV-CMIA-FORMAT-CODE                     VALUE 'CMIA'.DPKCS017
039900         88  PV-MITM-FORMAT-CODE                     VALUE 'MITM'.DPKCS017
040000     05  PV-TOP-ITEM-ON-SCREEN          PIC S9(04)   COMP.        DPKCS017
040100     05  PV-REWRITE-SW                  PIC X        VALUE 'N'.   DPKCS017
040200         88  PV-REWRITE                              VALUE 'Y'.   DPKCS017
040300         88  PV-DONT-REWRITE                         VALUE 'N'.   DPKCS017
040400     05  PV-FKEY-TABLE.                                           DPKCS017
040500         10  PV-FKEY  OCCURS  12 TIMES  PIC S9(03)   COMP-3.      DPKCS017
040600     05  PV-FIND-ACT                    PIC X(01)    VALUE SPACE. DPKCS017
040700 EJECT                                                            DPKCS017
040800*---------------------------------------------------------------* DPKCS017
040900*    WORKING STORAGE INCLUDE MEMBER USED WITH INCLUDE DPPD005   * DPKCS017
041000*---------------------------------------------------------------* DPKCS017
041100     COPY DPWS006.                                                DPKCS017
041200 EJECT                                                            DPKCS017
041300***************************************************************** DPKCS017
041400*    STANDARD COMMAREA.                                           DPKCS017
041500***************************************************************** DPKCS017
041600                                                                  DPKCS017
041700     COPY DPWS020.                                                DPKCS017
041800     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                DPKCS017
041900                                                                  DPKCS017
042000***************************************************************** DPKCS017
042100*    INTER-APPLICATION COMMAREA.                                  DPKCS017
042200***************************************************************** DPKCS017
042300                                                                  DPKCS017
042400         10  INTER-APPL-COMM-AREA       PIC X(200).               DPKCS017
042500     COPY DPWS050.                                                DPKCS017
042600     COPY DPWS051.                                                DPKCS017
042700     COPY DPWS052.                                                DPKCS017
042800     COPY DPWS055.                                                DPKCS017
042900                                                                  DPKCS017
043000***************************************************************** DPKCS017
043100*    SPECIFIC COMMMAREA FOR DPKCS017.                             DPKCS017
043200***************************************************************** DPKCS017
043300                                                                  DPKCS017
043400     10  DP017-SPECIFIC-COMMAREA.                                 DPKCS017
043500         15  FILLER                      PIC X(02).               DPKCS017
043600         15  DP017-CURRENT-SCREEN-IMAGE.                          DPKCS017
043700             20  DP017-SCREEN-TRAN-ID    PIC X(04).               DPKCS017
043800             20  DP017-SCREEN-MNEMONIC   PIC X(08).               DPKCS017
043900             20  DP017-SCREEN-MNEMONIC-TITLE                      DPKCS017
044000                                         PIC X(25).               DPKCS017
044100             20  DP017-SCR-TYP-CDE       PIC X.                   DPKCS017
044200             20  DP017-SCREEN-FKEYS.                              DPKCS017
044300                 25  DP017-SCREEN-FUNCTION-KEYS OCCURS 29 TIMES.  DPKCS017
044400                     30  DP017-SCR-SEL                            DPKCS017
044500                                         PIC X(01).               DPKCS017
044600                     30  DP017-SCR-SELA                           DPKCS017
044700                                         PIC X(01).               DPKCS017
044800                     30  DP017-SCR-SELH                           DPKCS017
044900                                         PIC X(01).               DPKCS017
045000                     30  DP017-SCR-SELC                           DPKCS017
045100                                         PIC X(01).               DPKCS017
045200                     30  DP017-SCR-SELL                           DPKCS017
045300                                         PIC S9(1).               DPKCS017
045400                                                                  DPKCS017
045500                     30  DP017-SCR-TAG                            DPKCS017
045600                                         PIC X(03).               DPKCS017
045700                     30  DP017-SCR-STATUS                         DPKCS017
045800                                         PIC X(08).               DPKCS017
045900                     30  DP017-SCR-ACTION                         DPKCS017
046000                                         PIC X(01).               DPKCS017
046100                     30  DP017-SCR-ACTIONA                        DPKCS017
046200                                         PIC X(01).               DPKCS017
046300                     30  DP017-SCR-ACTIONH                        DPKCS017
046400                                         PIC X(01).               DPKCS017
046500                     30  DP017-SCR-ACTIONC                        DPKCS017
046600                                         PIC X(01).               DPKCS017
046700                     30  DP017-SCR-ACTIONL                        DPKCS017
046800                                         PIC S9(1).               DPKCS017
046900                                                                  DPKCS017
047000                     30  DP017-SCR-ACTION-DESC                    DPKCS017
047100                                         PIC X(10).               DPKCS017
047200                                                                  DPKCS017
047300                     30  DP017-SCR-DISP  PIC X(01).               DPKCS017
047400                     30  DP017-SCR-DISPA PIC X(01).               DPKCS017
047500                     30  DP017-SCR-DISPH PIC X(01).               DPKCS017
047600                     30  DP017-SCR-DISPC PIC X(01).               DPKCS017
047700                     30  DP017-SCR-DISPL PIC S9(1).               DPKCS017
047800                                                                  DPKCS017
047900                     30  DP017-SCR-LABEL                          DPKCS017
048000                                         PIC X(08).               DPKCS017
048100                     30  DP017-SCR-LABELA                         DPKCS017
048200                                         PIC X(01).               DPKCS017
048300                     30  DP017-SCR-LABELH                         DPKCS017
048400                                         PIC X(01).               DPKCS017
048500                     30  DP017-SCR-LABELC                         DPKCS017
048600                                         PIC X(01).               DPKCS017
048700                     30  DP017-SCR-LABELL                               17
048800                                         PIC S9(1).                     17
048900                                                                  DPKCS017
049000                     30  DP017-SCR-MNEMONIC                       DPKCS017
049100                                         PIC X(08).               DPKCS017
049200                     30  DP017-SCR-MNEMONICA                      DPKCS017
049300                                         PIC X(01).               DPKCS017
049400                     30  DP017-SCR-MNEMONICH                      DPKCS017
049500                                         PIC X(01).               DPKCS017
049600                     30  DP017-SCR-MNEMONICC                      DPKCS017
049700                                         PIC X(01).               DPKCS017
049800                     30  DP017-SCR-MNEMONICL                      DPKCS017
049900                                         PIC S9(1).               DPKCS017
050000                                                                  DPKCS017
050100                     30  DP017-SCR-FORMAT                         DPKCS017
050200                                         PIC X(01).               DPKCS017
050300                     30  DP017-SCR-FORMATA                        DPKCS017
050400                                         PIC X(01).               DPKCS017
050500                     30  DP017-SCR-FORMATH                        DPKCS017
050600                                         PIC X(01).               DPKCS017
050700                     30  DP017-SCR-FORMATC                        DPKCS017
050800                                         PIC X(01).               DPKCS017
050900                     30  DP017-SCR-FORMATL                        DPKCS017
051000                                         PIC S9(1).               DPKCS017
051100                                                                  DPKCS017
051200                     30  DP017-SCR-STK                            DPKCS017
051300                                         PIC X(01).               DPKCS017
051400                     30  DP017-SCR-STKA                           DPKCS017
051500                                         PIC X(01).               DPKCS017
051600                     30  DP017-SCR-STKH                           DPKCS017
051700                                         PIC X(01).               DPKCS017
051800                     30  DP017-SCR-STKC                           DPKCS017
051900                                         PIC X(01).               DPKCS017
052000                     30  DP017-SCR-STKL                           DPKCS017
052100                                         PIC S9(1).               DPKCS017
052200                                                                  DPKCS017
052300                     30  DP017-SCR-TMESTP                         DPKCS017
052400                                         PIC X(20).               DPKCS017
052500                                                                  DPKCS017
052600         15  DP017-FK-SEQUENCE-NUMBER    PIC S9(04)  COMP.        DPKCS017
052700         15  DP017-SELECTED-MAINT-RESULT PIC X(01).               DPKCS017
052800         15  DP017-CONFIRM-REQUESTED-SW  PIC X(01).               DPKCS017
052900         15  DP017-SCR-SUB               PIC S9(04)  COMP.        DPKCS017
053000         15  DP017-MN-ITEM               PIC S9(04)  COMP.        DPKCS017
053100         15  DP017-MN-SUB                PIC S9(04)  COMP.        DPKCS017
053200         15  DP017-USE-TSQB-SW           PIC X.                   DPKCS017
053300             88  DP017-USE-TSQB                      VALUE 'Y'.   DPKCS017
053400             88  DP017-NO-TSQB                       VALUE 'N'.   DPKCS017
053500         15  DP017-HOLD-INTER-APPL-COMMAREA                       DPKCS017
053600                                         PIC X(200).              DPKCS017
053700         15  FILLER  REDEFINES  DP017-HOLD-INTER-APPL-COMMAREA.   DPKCS017
053800             20  DP017-INTER-APPL-FMT-CODE                        DPKCS017
053900                                         PIC X(04).               DPKCS017
054000             20  DP017-INTER-APPL-ACK-CODE                        DPKCS017
054100                                         PIC X(04).               DPKCS017
054200             20  DP017-INITIAL-CMIA.                              DPKCS017
054300                 25  DP017-MNEMONIC      PIC X(08).               DPKCS017
054400                 25  DP017-TRAN-ID       PIC X(04).               DPKCS017
054500                 25  DP017-TITLE         PIC X(30).               DPKCS017
054600                 25  DP017-CMIA-MAINT-RESULT                      DPKCS017
054700                                         PIC X(01).               DPKCS017
054800                 25  FILLER              PIC X(10).               DPKCS017
054900             20  DP017-INITIAL-FKEY REDEFINES DP017-INITIAL-CMIA. DPKCS017
055000                 25  FILLER              PIC X(08).               DPKCS017
055100                 25  DP017-SEQUENCE-NUMBER                        DPKCS017
055200                                         PIC S9(02)  COMP.        DPKCS017
055300                 25  DP017-FKEY-MNEMONIC PIC X(08).               DPKCS017
055400                 25  DP017-FKEY-MAINT-RESULT                      DPKCS017
055500                                         PIC X(01).               DPKCS017
055600                 25  FILLER              PIC X(34).               DPKCS017
055700             20  DP017-INITIAL-MITM REDEFINES DP017-INITIAL-CMIA. DPKCS017
055800                 25  DP017-MENU-NAME     PIC X(08).               DPKCS017
055900                 25  DP017-ITEM-MNEMONIC PIC X(08).               DPKCS017
056000                 25  DP017-ITEM-SEQUENCE-NUMBER                   DPKCS017
056100                                         PIC S9(04)  COMP.        DPKCS017
056200                 25  DP017-ITEM-TRAN-ID  PIC X(04).               DPKCS017
056300                 25  DP017-ITEM-TITLE    PIC X(30).               DPKCS017
056400                 25  DP017-MITM-MAINT-RESULT                      DPKCS017
056500                                         PIC X(01).               DPKCS017
056600     EJECT                                                        DPKCS017
056700***************************************************************** DPKCS017
056800*    SYSTEM MESSAGES                                              DPKCS017
056900***************************************************************** DPKCS017
057000                                                                  DPKCS017
057100     COPY DPRD507I.                                               DPKCS017
057200                                                                  DPKCS017
057300***************************************************************** DPKCS017
057400*    TSQB LAYOUT                                                  DPKCS017
057500***************************************************************** DPKCS017
057600                                                                  DPKCS017
057700     COPY DPWS002.                                                DPKCS017
057800                                                                  DPKCS017
057900***************************************************************** DPKCS017
058000*    ABEND PROCESSING COPYBOOK.                                   DPKCS017
058100***************************************************************** DPKCS017
058200                                                                  DPKCS017
058300     COPY DPWS013.                                                DPKCS017
058400                                                                  DPKCS017
058500***************************************************************** DPKCS017
058600*    ATTRIBUTE SETTINGS COPYBOOK.                                 DPKCS017
058700***************************************************************** DPKCS017
058800                                                                  DPKCS017
058900     COPY DPWS015.                                                DPKCS017
059000                                                                  DPKCS017
059100***************************************************************** DPKCS017
059200*    CURRENT DATE AND TIME COPYBOOK.                              DPKCS017
059300***************************************************************** DPKCS017
059400                                                                  DPKCS017
059500     COPY DPWS017.                                                DPKCS017
059600                                                                  DPKCS017
059700***************************************************************** DPKCS017
059800*    TOGGLE FUNCTION KEY LINES COPYBOOK.                          DPKCS017
059900***************************************************************** DPKCS017
060000                                                                  DPKCS017
060100     COPY DPWS009.                                                DPKCS017
060200                                                                  DPKCS017
060300***************************************************************** DPKCS017
060400*    FUNCTION KEYS COPYBOOK.                                      DPKCS017
060500***************************************************************** DPKCS017
060600                                                                  DPKCS017
060700     COPY DPWS016.                                                DPKCS017
060800                                                                  DPKCS017
060900***************************************************************** DPKCS017
061000*    DPKUT045 COPYBOOK.                                           DPKCS017
061100***************************************************************** DPKCS017
061200                                                                  DPKCS017
061300     COPY DPWS045.                                                DPKCS017
061400                                                                  DPKCS017
061500***************************************************************** DPKCS017
061600*    STANDARD ATTENTION IDENTIFIER LIST                           DPKCS017
061700***************************************************************** DPKCS017
061800                                                                  DPKCS017
061900     COPY DFHAID.                                                 DPKCS017
062000                                                                  DPKCS017
062100***************************************************************** DPKCS017
062200*    STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST        DPKCS017
062300***************************************************************** DPKCS017
062400                                                                  DPKCS017
062500     COPY DFHBMSCA.                                               DPKCS017
062600     EJECT                                                        DPKCS017
062700***************************************************************** DPKCS017
062800*    MAP LAYOUT                                                   DPKCS017
062900***************************************************************** DPKCS017
063000                                                                  DPKCS017
063100     COPY DPKM017.                                                DPKCS017
063200                                                                  DPKCS017
063300 01  MD-MAP-DATA-AREA REDEFINES DP017AO.                          DPKCS017
063400     05  FILLER                 PIC X(12).                        DPKCS017
063500     05  DPKM017-ADATEL         PIC S9(04) COMP.                  DPKCS017
063600     05  DPKM017-ADATEA         PIC X(01).                        DPKCS017
063700     05  FILLER                 PIC X(02).                        DPKCS017
063800     05  DPKM017-ADATEI         PIC X(10).                        DPKCS017
063900     05  DPKM017-ATIMEL         PIC S9(04) COMP.                  DPKCS017
064000     05  DPKM017-ATIMEA         PIC X(01).                        DPKCS017
064100     05  FILLER                 PIC X(02).                        DPKCS017
064200     05  DPKM017-ATIMEI         PIC X(08).                        DPKCS017
064300     05  DPKM017-ATITLEL        PIC S9(04) COMP.                  DPKCS017
064400     05  DPKM017-ATITLEA        PIC X(01).                        DPKCS017
064500     05  FILLER                 PIC X(02).                        DPKCS017
064600     05  DPKM017-ATITLEI        PIC X(30).                        DPKCS017
064700     05  DPKM017-ANETNAML       PIC S9(04) COMP.                  DPKCS017
064800     05  DPKM017-ANATNAMA       PIC X(01).                        DPKCS017
064900     05  FILLER                 PIC X(02).                        DPKCS017
065000     05  DPKM017-ANETNAMI       PIC X(08).                        DPKCS017
065100     05  DPKM017-AMNEMICL       PIC S9(04) COMP.                  DPKCS017
065200     05  DPKM017-AMNEMICA       PIC X(01).                        DPKCS017
065300     05  FILLER                 PIC X(02).                        DPKCS017
065400     05  DPKM017-AMNEMICI       PIC X(08).                        DPKCS017
065500     05  DPKM017-ATRANIDL       PIC S9(04) COMP.                  DPKCS017
065600     05  DPKM017-ATRANIDA       PIC X(01).                        DPKCS017
065700     05  FILLER                 PIC X(02).                        DPKCS017
065800     05  DPKM017-ATRANIDI       PIC X(04).                        DPKCS017
065900     05  DPKM017-AMNOMICL       PIC S9(04) COMP.                  DPKCS017
066000     05  DPKM017-AMNOMICA       PIC X(01).                        DPKCS017
066100     05  FILLER                 PIC X(02).                        DPKCS017
066200     05  DPKM017-AMNOMICI       PIC X(08).                        DPKCS017
066300     05  DPKM017-ANAMEL         PIC S9(04) COMP.                  DPKCS017
066400     05  DPKM017-ANAMEA         PIC X(01).                        DPKCS017
066500     05  FILLER                 PIC X(02).                        DPKCS017
066600     05  DPKM017-ANAMEI         PIC X(30).                        DPKCS017
066700                                                                  DPKCS017
066800     05  DPKM017-ASELCTI.                                         DPKCS017
066900         10  DPKM017-SELECTION-ENTRIES OCCURS 12 TIMES.           DPKCS017
067000             15  DPKM017-ASELL  PIC S9(04) COMP.                  DPKCS017
067100             15  DPKM017-ASELA  PIC X(01).                        DPKCS017
067200             15  DPKM017-ASELC  PIC X(01).                        DPKCS017
067300             15  DPKM017-ASELH  PIC X(01).                        DPKCS017
067400             15  DPKM017-ASELI  PIC X(01).                        DPKCS017
067500                                                                  DPKCS017
067600             15  DPKM017-AFKEYL PIC S9(04) COMP.                  DPKCS017
067700             15  DPKM017-AFKEYA PIC X(01).                        DPKCS017
067800             15  FILLER         PIC X(02).                        DPKCS017
067900             15  DPKM017-AFKEYI PIC X(03).                        DPKCS017
068000                                                                  DPKCS017
068100             15  DPKM017-ASTATL PIC S9(04) COMP.                  DPKCS017
068200             15  DPKM017-ASTATA PIC X(01).                        DPKCS017
068300             15  FILLER         PIC X(02).                        DPKCS017
068400             15  DPKM017-ASTATI PIC X(08).                        DPKCS017
068500                                                                  DPKCS017
068600             15  DPKM017-AACTL  PIC S9(04) COMP.                  DPKCS017
068700             15  DPKM017-AACTA  PIC X(01).                        DPKCS017
068800             15  DPKM017-AACTC  PIC X(01).                        DPKCS017
068900             15  DPKM017-AACTH  PIC X(01).                        DPKCS017
069000             15  DPKM017-AACTI  PIC X(01).                        DPKCS017
069100                                                                  DPKCS017
069200             15  DPKM017-AACTDL PIC S9(04) COMP.                  DPKCS017
069300             15  DPKM017-AACTDA PIC X(01).                        DPKCS017
069400             15  FILLER         PIC X(02).                        DPKCS017
069500             15  DPKM017-AACTDI PIC X(10).                        DPKCS017
069600                                                                  DPKCS017
069700             15  DPKM017-ADISPL PIC S9(04) COMP.                  DPKCS017
069800             15  DPKM017-ADISPA PIC X(01).                        DPKCS017
069900             15  DPKM017-ADISPC PIC X(01).                        DPKCS017
070000             15  DPKM017-ADISPH PIC X(01).                        DPKCS017
070100             15  DPKM017-ADISPI PIC X(01).                        DPKCS017
070200                                                                  DPKCS017
070300             15  DPKM017-ALABLL PIC S9(04) COMP.                  DPKCS017
070400             15  DPKM017-ALABLA PIC X(01).                        DPKCS017
070500             15  DPKM017-ALABLC PIC X(01).                        DPKCS017
070600             15  DPKM017-ALABLH PIC X(01).                        DPKCS017
070700             15  DPKM017-ALABLI PIC X(08).                        DPKCS017
070800                                                                  DPKCS017
070900             15  DPKM017-AMNEML PIC S9(04) COMP.                  DPKCS017
071000             15  DPKM017-AMNEMA PIC X(01).                        DPKCS017
071100             15  DPKM017-AMNEMC PIC X(01).                        DPKCS017
071200             15  DPKM017-AMNEMH PIC X(01).                        DPKCS017
071300             15  DPKM017-AMNEMI PIC X(08).                        DPKCS017
071400                                                                  DPKCS017
071500             15  DPKM017-AFORML PIC S9(04) COMP.                  DPKCS017
071600             15  DPKM017-AFORMA PIC X(01).                        DPKCS017
071700             15  DPKM017-AFORMC PIC X(01).                        DPKCS017
071800             15  DPKM017-AFORMH PIC X(01).                        DPKCS017
071900             15  DPKM017-AFORMI PIC X(01).                        DPKCS017
072000                                                                  DPKCS017
072100             15  DPKM017-ASTKL  PIC S9(04) COMP.                  DPKCS017
072200             15  DPKM017-ASTKA  PIC X(01).                        DPKCS017
072300             15  DPKM017-ASTKC  PIC X(01).                        DPKCS017
072400             15  DPKM017-ASTKH  PIC X(01).                        DPKCS017
072500             15  DPKM017-ASTKI  PIC X(01).                        DPKCS017
072600                                                                  DPKCS017
072700     05  DPKM017-AMSGL          PIC S9(04) COMP.                  DPKCS017
072800     05  DPKM017-AMSGA          PIC X(01).                        DPKCS017
072900     05  FILLER                 PIC X(02).                        DPKCS017
073000     05  DPKM017-AMSGI          PIC X(78).                        DPKCS017
073100     05  DPKM017-ANAVCMDL       PIC S9(04) COMP.                  DPKCS017
073200     05  DPKM017-ANAVCMDA       PIC X(01).                        DPKCS017
073300     05  FILLER                 PIC X(02).                        DPKCS017
073400     05  DPKM017-ANAVCMDI       PIC X(08).                        DPKCS017
073500     05  DPKM017-ANAVKEYL       PIC S9(04) COMP.                  DPKCS017
073600     05  DPKM017-ANAVKEYA       PIC X(01).                        DPKCS017
073700     05  FILLER                 PIC X(02).                        DPKCS017
073800     05  DPKM017-ANAVKEYI       PIC X(25).                        DPKCS017
073900     05  DPKM017-AFKLIN1L       PIC S9(04) COMP.                  DPKCS017
074000     05  DPKM017-AFKLIN1A       PIC X(01).                        DPKCS017
074100     05  FILLER                 PIC X(02).                        DPKCS017
074200     05  DPKM017-AFKLIN1I       PIC X(78).                        DPKCS017
074300     05  DPKM017-AFKLIN2L       PIC S9(04) COMP.                  DPKCS017
074400     05  DPKM017-AFKLIN2A       PIC X(01).                        DPKCS017
074500     05  FILLER                 PIC X(02).                        DPKCS017
074600     05  DPKM017-AFKLIN2I       PIC X(78).                        DPKCS017
074700                                                                  DPKCS017
074800 EJECT                                                            DPKCS017
074900***************************************************************** DPKCS017
075000*    DB2 COMMUNICATION AREA                                       DPKCS017
075100***************************************************************** DPKCS017
075200                                                                  DPKCS017
075300     EXEC SQL                                                     DPKCS017
075400         INCLUDE SQLCA                                            DPKCS017
075500     END-EXEC.                                                    DPKCS017
075600                                                                  DPKCS017
075700***************************************************************** DPKCS017
075800*    FUNCTION KEY TABLE - TAIDKEY                                 DPKCS017
075900***************************************************************** DPKCS017
076000                                                                  DPKCS017
076100     EXEC SQL                                                     DPKCS017
076200         INCLUDE TAIDKEY                                          DPKCS017
076300     END-EXEC.                                                    DPKCS017
076400                                                                  DPKCS017
076500***************************************************************** DPKCS017
076600*    MNEMONIC FUNCTION KEY TABLE - TCICSROUTE                     DPKCS017
076700***************************************************************** DPKCS017
076800                                                                  DPKCS017
076900     EXEC SQL                                                     DPKCS017
077000         INCLUDE TCICSRTE                                         DPKCS017
077100     END-EXEC.                                                    DPKCS017
077200                                                                  DPKCS017
077300***************************************************************** DPKCS017
077400*    MNEMONIC TRANS ID TABLE - TMNEMONIC                          DPKCS017
077500***************************************************************** DPKCS017
077600                                                                  DPKCS017
077700     EXEC SQL                                                     DPKCS017
077800         INCLUDE TMNMNC                                           DPKCS017
077900     END-EXEC.                                                    DPKCS017
078000                                                                  DPKCS017
078100***************************************************************** DPKCS017
078200*    MENU ITEM TABLE  -  TMENUITEM                                DPKCS017
078300***************************************************************** DPKCS017
078400                                                                  DPKCS017
078500     EXEC SQL                                                     DPKCS017
078600         INCLUDE TMNUITM                                          DPKCS017
078700     END-EXEC.                                                    DPKCS017
078800                                                                  DPKCS017
078900***************************************************************** DPKCS017
079000*    FUNCTION KEY CURSOR - TAIDKEY                                DPKCS017
079100***************************************************************** DPKCS017
079200                                                                  DPKCS017
079300                                                                  DPKCS017
079400     EXEC SQL                                                     DPKCS017
079500         DECLARE TAIDKEY-CURSOR CURSOR FOR                        DPKCS017
079600             SELECT AID_SEQUENCE_NMBR,                            DPKCS017
079700                    AID_KEY_NAME,                                 DPKCS017
079800                    STNRD_ACTION_CODE,                            DPKCS017
079900                    SYSWIDE_USE_INDCT,                            DPKCS017
080000                    MNDTRY_MNMNC_INDCT,                           DPKCS017
080100                    MNEMONIC_CODE                                 DPKCS017
080200             FROM TAIDKEY                                         DPKCS017
080300             WHERE  SCRN_TYP_CDE = :DP017-SCR-TYP-CDE             DPKCS017
080400     END-EXEC.                                                    DPKCS017
080500     EJECT                                                        DPKCS017
080600 LINKAGE SECTION.                                                 DPKCS017
080700                                                                  DPKCS017
080800 01  DFHCOMMAREA.                                                 DPKCS017
080900     05  FILLER                         OCCURS  1 TO 4072 TIMES   DPKCS017
081000                                        DEPENDING ON EIBCALEN.    DPKCS017
081100         10  FILLER                     PIC X.                    DPKCS017
081200*                                                                 DPKCS017
081300*                                                                 DPKCS017
081400 EJECT                                                            DPKCS017
081500                                                                  DPKCS017
081600 PROCEDURE DIVISION.                                              DPKCS017
081700******************************************************************DPKCS017
081800*    PROCESS THIS TRANSACTION IF  THE COMMAREA IS VALID.          DPKCS017
081900******************************************************************DPKCS017
082000                                                                  DPKCS017
082100     PERFORM DP015-0000-CHECK-COMMAREA.                           DPKCS017
082200                                                                  DPKCS017
082300     IF  DP020-SRC-RETURN-W-TRAN-ID                               DPKCS017
082400         PERFORM B100-CONTROL-PROCESSING                          DPKCS017
082500     END-IF.                                                      DPKCS017
082600                                                                  DPKCS017
082700     PERFORM DP003-0000-RETURN-TO-CICS.                           DPKCS017
082800 EJECT                                                            DPKCS017
082900                                                                  DPKCS017
083000 B100-CONTROL-PROCESSING.                                         DPKCS017
083100******************************************************************DPKCS017
083200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT    DPKCS017
083300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                    DPKCS017
083400*                                                                 DPKCS017
083500******************************************************************DPKCS017
083600                                                                  DPKCS017
083700     EVALUATE TRUE                                                DPKCS017
083800                                                                  DPKCS017
083900         WHEN DP020-NEXT-ACT-INITIAL                              DPKCS017
084000*            *****************************************************DPKCS017
084100*            * NEXT ACTION: INITIAL                               DPKCS017
084200*            *****************************************************DPKCS017
084300             INITIALIZE DP017-SPECIFIC-COMMAREA                   DPKCS017
084400             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS017
084500             SET DP020-MSG-INFORMATIONAL  TO TRUE                 DPKCS017
084600                                                                  DPKCS017
084700             MOVE PC-NOT-CONFIRMED     TO                         DPKCS017
084800                  DP017-CONFIRM-REQUESTED-SW                      DPKCS017
084900                                                                  DPKCS017
085000             MOVE INTER-APPL-COMM-AREA                            DPKCS017
085100                               TO  DP017-HOLD-INTER-APPL-COMMAREA DPKCS017
085200                                                                  DPKCS017
085300             IF  DP020-NAV-KEY-DATA GREATER THAN SPACES           DPKCS017
085400                 MOVE DP020-NAV-KEY-DATA                          DPKCS017
085500                               TO  DP017-SCREEN-MNEMONIC          DPKCS017
085600                 MOVE 1        TO  DP017-SCR-SUB                  DPKCS017
085700                 PERFORM E100-SEND-INITIAL-SCREEN                 DPKCS017
085800             ELSE                                                 DPKCS017
085900                 PERFORM D500-OBTAIN-FIRST-MNEMONIC               DPKCS017
086000             END-IF                                               DPKCS017
086100                                                                  DPKCS017
086200         WHEN DP020-NEXT-ACT-READ-MAP                             DPKCS017
086300*            *****************************************************DPKCS017
086400*            * NEXT ACTION: READ MAP                              DPKCS017
086500*            *****************************************************DPKCS017
086600             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  DPKCS017
086700             PERFORM C100-PROCESS-MAP                             DPKCS017
086800                                                                  DPKCS017
086900         WHEN DP020-NEXT-ACT-RETURN                               DPKCS017
087000*            *****************************************************DPKCS017
087100*            * NEXT ACTION: RETURN                                DPKCS017
087200*            *****************************************************DPKCS017
087300             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS017
087400                                                                  DPKCS017
087500             MOVE PC-NOT-CONFIRMED TO DP017-CONFIRM-REQUESTED-SW  DPKCS017
087600                                                                  DPKCS017
087700             MOVE DP017-HOLD-INTER-APPL-COMMAREA                  DPKCS017
087800                               TO  INTER-APPL-COMM-AREA           DPKCS017
087900                                                                  DPKCS017
088000             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS017
088100             PERFORM F200-DISPLAY-PANEL                           DPKCS017
088200                                                                  DPKCS017
088300         WHEN DP020-NEXT-ACT-ERROR                                DPKCS017
088400*            *****************************************************DPKCS017
088500*            * NEXT ACTION: READ MAP                              DPKCS017
088600*            *****************************************************DPKCS017
088700             MOVE DP020-MSG-MESSAGE TO PV-MESSAGE                 DPKCS017
088800             MOVE PC-NOT-CONFIRMED  TO DP017-CONFIRM-REQUESTED-SW DPKCS017
088900                                                                  DPKCS017
089000             IF  DP020-NAV-MNEMONIC = SPACES                      DPKCS017
089100                MOVE SPACES          TO ANAVCMDO                  DPKCS017
089200                MOVE DP015-UNDERLINE TO ANAVCMDH                  DPKCS017
089300                MOVE DP015-GREEN     TO ANAVCMDC                  DPKCS017
089400             ELSE                                                 DPKCS017
089500                MOVE DP015-REVERSE   TO ANAVCMDH                  DPKCS017
089600                MOVE DP015-RED       TO ANAVCMDC                  DPKCS017
089700             END-IF                                               DPKCS017
089800                                                                  DPKCS017
089900             MOVE PC-CURSOR-POS TO ANAVCMDL                             17
090000             MOVE PV-MESSAGE    TO DP020-MSG-MESSAGE                    17
090100                                                                  DPKCS017
090200             SET PS-ERROR                TO TRUE                  DPKCS017
090300             SET PS-SEND-DATA-ONLY-FRSET TO TRUE                  DPKCS017
090400                                                                  DPKCS017
090500             PERFORM F200-DISPLAY-PANEL                           DPKCS017
090600                                                                  DPKCS017
090700         WHEN OTHER                                               DPKCS017
090800*            *****************************************************DPKCS017
090900*            * NEXT ACTION: "OTHER" UNDEFINED                     DPKCS017
091000*            *****************************************************DPKCS017
091100             SET DP013-LOGIC-ABEND TO TRUE                        DPKCS017
091200             SET DP013-NO-ROLLBACK TO TRUE                        DPKCS017
091300                                                                  DPKCS017
091400             MOVE 'B100-CONTROL-PROCESSING' TO                    DPKCS017
091500                  DP013-PARAGRAPH                                 DPKCS017
091600             MOVE PM-PROGRAM-MESSAGE-28     TO                    DPKCS017
091700                  DP013-MESSAGE-TEXT(1)                           DPKCS017
091800                                                                  DPKCS017
091900             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
092000                                                                  DPKCS017
092100     END-EVALUATE.                                                DPKCS017
092200 EJECT                                                            DPKCS017
092300                                                                  DPKCS017
092400 C100-PROCESS-MAP.                                                DPKCS017
092500******************************************************************DPKCS017
092600*    RECEIVE THE MAP.                                             DPKCS017
092700*    MOVE THE SCREEN VARIABLES TO THE COMMAREA.                   DPKCS017
092800*    IF THE FUNCTION KEY HIT WAS NOT A LOCAL KEY, START THE       DPKCS017
092900*    NAVIGATOR AND LEAVE THIS TRANSACTION.                        DPKCS017
093000*    IF THE USER HIT <ENTER> AND ENTERED A MNEMONIC IN THE COMMANDDPKCS017
093100*    LINE, START THE NAVIGATOR AND LEAVE THIS TRANSACTION,        DPKCS017
093200*    OTHERWISE CONTINUE PROCESSING BASED ON THE FUNCTION KEY THAT DPKCS017
093300*    WAS HIT.                                                     DPKCS017
093400*                                                                 DPKCS017
093500*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS017
093600******************************************************************DPKCS017
093700                                                                  DPKCS017
093800     PERFORM DP007-0000-GET-PANEL.                                DPKCS017
093900     PERFORM D100-MOVE-SCREEN-TO-COMMAREA.                        DPKCS017
094000                                                                  DPKCS017
094100     IF  (DP020-FK-GO-TO-TRAN(DP020-SRC-AID)                      DPKCS017
094200     OR  (DP020-SRC-AID EQUAL DP016-ENTER                         DPKCS017
094300     AND  DP020-NAV-MNEMONIC GREATER THAN SPACES))                DPKCS017
094400          MOVE INTER-APPL-COMM-AREA                               DPKCS017
094500                               TO  DP017-HOLD-INTER-APPL-COMMAREA DPKCS017
094600          MOVE DP017-SCREEN-MNEMONIC                              DPKCS017
094700                               TO  DP055-MNEMONIC                 DPKCS017
094800          PERFORM DP015-1000-START-NAVIGATOR                      DPKCS017
094900     ELSE                                                         DPKCS017
095000          PERFORM D300-LOCAL-FKEY-CONTROL                         DPKCS017
095100     END-IF.                                                      DPKCS017
095200                                                                  DPKCS017
095300 EJECT                                                            DPKCS017
095400                                                                  DPKCS017
095500 D100-MOVE-SCREEN-TO-COMMAREA.                                    DPKCS017
095600******************************************************************DPKCS017
095700*    SET A SWITCH IF  THE USER ENTERED A NEW MNEMONIC IN THE KEY  DPKCS017
095800*    FIELD.  OTHERWISE, IF  THE USER DID NOT ENTER 'CONFIRM' OR   DPKCS017
095900*    'CLEAR' IN THE COMMAND LINE, OR HIT THE CLEAR KEY, MOVE THE  DPKCS017
096000*    FIELDS FROM THE SCREEN TO THE COMMAREA.                      DPKCS017
096100*                                                                 DPKCS017
096200*    PERFORMED BY C100-PROCESS-MAP.                               DPKCS017
096300******************************************************************DPKCS017
096400                                                                  DPKCS017
096500     SET PS-NEW-MNEMONIC-NOT-REQUESTED TO TRUE.                   DPKCS017
096600                                                                  DPKCS017
096700     IF (ANAVKEYL > 0                                             DPKCS017
096800     AND DP020-SRC-AID EQUAL DP016-ENTER)                         DPKCS017
096900         SET PS-NEW-MNEMONIC-REQUESTED TO TRUE                    DPKCS017
097000     ELSE                                                         DPKCS017
097100         IF (DP020-SRC-AID NOT = DP016-PF5                        DPKCS017
097200         AND DP020-SRC-AID NOT = DP016-PF3                        DPKCS017
097300         AND DP020-SRC-AID NOT = DP016-CLEAR)                     DPKCS017
097400             MOVE DP017-SCR-SUB                                   DPKCS017
097500                               TO  PV-TOP-ITEM-ON-SCREEN          DPKCS017
097600                                   PV-HOLD-SCR-SUB                DPKCS017
097700             PERFORM E200-CHECK-FIELDS-FOR-ENTRY                  DPKCS017
097800                 VARYING PS-SUB FROM 1 BY 1                       DPKCS017
097900                 UNTIL PS-SUB > PC-MAX-ITEMS-ON-SCREEN            DPKCS017
098000             MOVE PV-HOLD-SCR-SUB                                 DPKCS017
098100                               TO  DP017-SCR-SUB                  DPKCS017
098200         END-IF                                                   DPKCS017
098300     END-IF.                                                      DPKCS017
098400                                                                  DPKCS017
098500 EJECT                                                            DPKCS017
098600                                                                  DPKCS017
098700 D300-LOCAL-FKEY-CONTROL.                                         DPKCS017
098800******************************************************************DPKCS017
098900*    TAKE THE APPROPRIATE COURSE OF ACTION BASED ON WHAT THE      DPKCS017
099000*    FUNCTION KEY THAT THE USER HAS HIT.                          DPKCS017
099100*                                                                 DPKCS017
099200*    PERFORMED BY C100-PROCESS-MAP.                               DPKCS017
099300******************************************************************DPKCS017
099400                                                                  DPKCS017
099500     EVALUATE TRUE                                                DPKCS017
099600                                                                  DPKCS017
099700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     DPKCS017
099800*            *****************************************************DPKCS017
099900*            * LOCAL FUNCTION KEY: REFRESH                        DPKCS017
100000*            *****************************************************DPKCS017
100100             MOVE PC-NOT-CONFIRMED TO DP017-CONFIRM-REQUESTED-SW  DPKCS017
100200             INITIALIZE DP017-SCREEN-FKEYS                        DPKCS017
100300             MOVE 1            TO  DP017-SCR-SUB                  DPKCS017
100400             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS017
100500             PERFORM E100-SEND-INITIAL-SCREEN                     DPKCS017
100600                                                                  DPKCS017
100700         WHEN DP020-FK-CONFIRM(DP020-SRC-AID)                     DPKCS017
100800*            *****************************************************DPKCS017
100900*            * LOCAL FUNCTION KEY: CONFIRM                        DPKCS017
101000*            *****************************************************DPKCS017
101100             IF  DP017-CONFIRM-REQUESTED-SW = PC-CONFIRMED        DPKCS017
101200                 PERFORM E300-PROCESS-DELETES                     DPKCS017
101300                 PERFORM F500-UPDATE-TSQB                         DPKCS017
101400             ELSE                                                 DPKCS017
101500                 MOVE PC-TSYMSG-00118  TO DP020-MSG-NUMBER        DPKCS017
101600                 SET DP020-MSG-WARNING TO TRUE                    DPKCS017
101700             END-IF                                               DPKCS017
101800             MOVE PC-NOT-CONFIRMED TO DP017-CONFIRM-REQUESTED-SW  DPKCS017
101900             PERFORM F200-DISPLAY-PANEL                           DPKCS017
102000                                                                  DPKCS017
102100         WHEN DP020-SRC-AID = DP016-PF13                          DPKCS017
102200*            *****************************************************DPKCS017
102300*            * LOCAL FUNCTION KEY: <F13>  (ADD/UPDATE)            DPKCS017
102400*            *****************************************************DPKCS017
102500             MOVE PC-NOT-CONFIRMED TO DP017-CONFIRM-REQUESTED-SW  DPKCS017
102600             SET PS-NO-ERROR       TO TRUE                              17
102700             PERFORM Y000-COMPUTE-PS-SUB                                17
102800             PERFORM E800-CHECK-IF-ROW-SELECTED                   DPKCS017
102900                 PC-MAX-ITEMS-ON-SCREEN TIMES                     DPKCS017
103000             PERFORM E400-PREPARE-TO-EDIT                         DPKCS017
103100             IF  PS-ERROR                                         DPKCS017
103200                 SET DP020-MSG-FATAL TO TRUE                      DPKCS017
103300             ELSE                                                 DPKCS017
103400                 PERFORM E600-PROCESS-ADDS-UPDATES                DPKCS017
103500                     VARYING PS-SUB                                     17
103600                     FROM    PC-MAX-FKEYS                               17
103700                     BY       -1                                        17
103800                     UNTIL PS-SUB = 0                             DPKCS017
103900                 IF  PS-ERROR                                     DPKCS017
104000                     EXEC CICS                                    DPKCS017
104100                         SYNCPOINT                                DPKCS017
104200                         ROLLBACK                                 DPKCS017
104300                     END-EXEC                                     DPKCS017
104400                 ELSE                                             DPKCS017
104500                     IF  PS-ITEM-SELECTED                         DPKCS017
104600                         MOVE PC-TSYMSG-00034       TO            DPKCS017
104700                              DP020-MSG-NUMBER                    DPKCS017
104800                         MOVE PC-UPDATED            TO            DPKCS017
104900                              DP017-SELECTED-MAINT-RESULT         DPKCS017
105000                     END-IF                                       DPKCS017
105100                                                                  DPKCS017
105200                     SET DP020-MSG-INFORMATIONAL TO TRUE          DPKCS017
105300                 END-IF                                           DPKCS017
105400                 PERFORM F500-UPDATE-TSQB                         DPKCS017
105500             END-IF                                               DPKCS017
105600             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS017
105700             PERFORM F200-DISPLAY-PANEL                           DPKCS017
105800                                                                  DPKCS017
105900         WHEN DP020-SRC-AID = DP016-PF16                          DPKCS017
106000*            *****************************************************DPKCS017
106100*            * LOCAL FUNCTION KEY: <F16>  (DELETE)                DPKCS017
106200*            *****************************************************DPKCS017
106300             MOVE PC-NOT-CONFIRMED TO DP017-CONFIRM-REQUESTED-SW  DPKCS017
106400             SET PS-NO-ERROR         TO TRUE                      DPKCS017
106500             SET PS-NO-ITEM-SELECTED TO TRUE                      DPKCS017
106600             PERFORM Y000-COMPUTE-PS-SUB                                17
106700             PERFORM E800-CHECK-IF-ROW-SELECTED                   DPKCS017
106800                 PC-MAX-ITEMS-ON-SCREEN TIMES                     DPKCS017
106900             IF  PS-NO-ERROR                                      DPKCS017
107000                 PERFORM E700-EDIT-DELETE-REQUEST                 DPKCS017
107100                     VARYING PS-SUB                                     17
107200                     FROM    PC-MAX-FKEYS                               17
107300                     BY       -1                                        17
107400                     UNTIL PS-SUB = 0                             DPKCS017
107500                 IF  PS-ERROR                                     DPKCS017
107600                     PERFORM G200-MOVE-COMMAREA-TO-SCREEN         DPKCS017
107700                     SET DP020-MSG-FATAL TO TRUE                  DPKCS017
107800                 ELSE                                             DPKCS017
107900                     IF  PS-ITEM-SELECTED                         DPKCS017
108000                         MOVE PC-CONFIRMED                        DPKCS017
108100                               TO  DP017-CONFIRM-REQUESTED-SW     DPKCS017
108200                         MOVE PC-TSYMSG-00004                     DPKCS017
108300                               TO  DP020-MSG-NUMBER               DPKCS017
108400                         SET DP020-MSG-INFORMATIONAL TO TRUE      DPKCS017
108500                     END-IF                                       DPKCS017
108600                 END-IF                                           DPKCS017
108700             END-IF                                               DPKCS017
108800             PERFORM F200-DISPLAY-PANEL                           DPKCS017
108900                                                                  DPKCS017
109000         WHEN DP020-FK-NEXT-SELECTION(DP020-SRC-AID)              DPKCS017
109100*            *****************************************************DPKCS017
109200*            * LOCAL FUNCTION KEY: NEXT SELECTION                 DPKCS017
109300*            *****************************************************DPKCS017
109400              IF  DP017-USE-TSQB                                  DPKCS017
109500                  SET PS-SEND-MAP-N-DATA-FRSET TO TRUE            DPKCS017
109600                  PERFORM D600-GET-NEXT-MNEMONIC                  DPKCS017
109700              ELSE                                                DPKCS017
109800                 MOVE PC-TSYMSG-00045                             DPKCS017
109900                               TO  DP020-MSG-NUMBER               DPKCS017
110000                 SET DP020-MSG-FATAL                              DPKCS017
110100                               TO  TRUE                           DPKCS017
110200                 PERFORM F200-DISPLAY-PANEL                       DPKCS017
110300              END-IF                                              DPKCS017
110400                                                                  DPKCS017
110500         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  DPKCS017
110600*            *****************************************************DPKCS017
110700*            * LOCAL FUNCTION KEY: FIRST PAGE                     DPKCS017
110800*            *****************************************************DPKCS017
110900              MOVE 1           TO  DP017-SCR-SUB                  DPKCS017
111000              PERFORM G200-MOVE-COMMAREA-TO-SCREEN                DPKCS017
111100              PERFORM F200-DISPLAY-PANEL                          DPKCS017
111200                                                                  DPKCS017
111300         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   DPKCS017
111400*            *****************************************************DPKCS017
111500*            * LOCAL FUNCTION KEY: PREV PAGE                      DPKCS017
111600*            *****************************************************DPKCS017
111700              PERFORM E400-PREPARE-TO-EDIT                        DPKCS017
111800              IF  PS-ERROR                                        DPKCS017
111900                  SET DP020-MSG-FATAL TO TRUE                     DPKCS017
112000              ELSE                                                DPKCS017
112100                  SUBTRACT PC-MAX-ITEMS-ON-SCREEN                 DPKCS017
112200                             FROM  DP017-SCR-SUB                  DPKCS017
112300                  IF   DP017-SCR-SUB LESS THAN 1                  DPKCS017
112400                      MOVE 1       TO  DP017-SCR-SUB              DPKCS017
112500                  END-IF                                          DPKCS017
112600              END-IF                                              DPKCS017
112700              PERFORM G200-MOVE-COMMAREA-TO-SCREEN                DPKCS017
112800              PERFORM F200-DISPLAY-PANEL                          DPKCS017
112900                                                                  DPKCS017
113000         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   DPKCS017
113100*            *****************************************************DPKCS017
113200*            * LOCAL FUNCTION KEY: NEXT PAGE                      DPKCS017
113300*            *****************************************************DPKCS017
113400              PERFORM E400-PREPARE-TO-EDIT                        DPKCS017
113500              IF  PS-ERROR                                        DPKCS017
113600                  SET DP020-MSG-FATAL TO TRUE                     DPKCS017
113700              ELSE                                                DPKCS017
113800                  ADD PC-MAX-ITEMS-ON-SCREEN                      DPKCS017
113900                               TO  DP017-SCR-SUB                  DPKCS017
114000                  IF  DP017-SCR-SUB GREATER THAN PC-MAX-FKEYS     DPKCS017
114100                      SUBTRACT PC-MAX-ITEMS-ON-SCREEN             DPKCS017
114200                             FROM  DP017-SCR-SUB                  DPKCS017
114300                  END-IF                                          DPKCS017
114400              END-IF                                              DPKCS017
114500              PERFORM G200-MOVE-COMMAREA-TO-SCREEN                DPKCS017
114600              PERFORM F200-DISPLAY-PANEL                          DPKCS017
114700                                                                  DPKCS017
114800         WHEN DP020-SRC-AID = DP016-PA2                           DPKCS017
114900*            *****************************************************DPKCS017
115000*            * LOCAL FUNCTION KEY: PA2                            DPKCS017
115100*            *****************************************************DPKCS017
115200             PERFORM DP009-0000-LOAD-FK-LINES                     DPKCS017
115300             PERFORM DP017-0000-GET-CURR-DATE-TIME                DPKCS017
115400             SET PS-SEND-DATA-ONLY TO TRUE                        DPKCS017
115500             MOVE PC-CURSOR-POS TO ANAVCMDL                             17
115600             PERFORM DP008-0000-WRITE-PANEL                       DPKCS017
115700                                                                  DPKCS017
115800         WHEN DP020-SRC-AID = DP016-CLEAR                         DPKCS017
115900*            *****************************************************DPKCS017
116000*            * LOCAL FUNCTION KEY: <CLEAR>                        DPKCS017
116100*            *****************************************************DPKCS017
116200             MOVE PC-NOT-CONFIRMED TO DP017-CONFIRM-REQUESTED-SW  DPKCS017
116300             SET PS-SEND-MAP-N-DATA-FRSET TO TRUE                 DPKCS017
116400             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS017
116500             PERFORM F200-DISPLAY-PANEL                           DPKCS017
116600                                                                  DPKCS017
116700         WHEN DP020-SRC-AID = DP016-ENTER                         DPKCS017
116800*            *****************************************************DPKCS017
116900*            * LOCAL FUNCTION KEY: <ENTER>                        DPKCS017
117000*            *****************************************************DPKCS017
117100             MOVE PC-NOT-CONFIRMED TO DP017-CONFIRM-REQUESTED-SW  DPKCS017
117200             SET PS-NO-ERROR       TO TRUE                              17
117300             PERFORM Y000-COMPUTE-PS-SUB                                17
117400             PERFORM E800-CHECK-IF-ROW-SELECTED                   DPKCS017
117500                 PC-MAX-ITEMS-ON-SCREEN TIMES                     DPKCS017
117600             PERFORM E400-PREPARE-TO-EDIT                         DPKCS017
117700             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS017
117800             PERFORM F200-DISPLAY-PANEL                           DPKCS017
117900                                                                  DPKCS017
118000         WHEN DP020-FK-RETURN(DP020-SRC-AID)                      DPKCS017
118100*            *****************************************************DPKCS017
118200*            * LOCAL FUNCTION KEY: <RETURN>                       DPKCS017
118300*            *****************************************************DPKCS017
118400             PERFORM E101-COMPUTE-PROCESSED-ITEMS                 DPKCS017
118500             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS017
118600                                                                  DPKCS017
118700         WHEN OTHER                                               DPKCS017
118800*            *****************************************************DPKCS017
118900*            * LOCAL FUNCTION KEY: "OTHER" UNDEFINED              DPKCS017
119000*            *****************************************************DPKCS017
119100             MOVE PC-TSYMSG-00045                                 DPKCS017
119200                               TO  DP020-MSG-NUMBER               DPKCS017
119300             SET DP020-MSG-FATAL                                  DPKCS017
119400                               TO  TRUE                           DPKCS017
119500             PERFORM F200-DISPLAY-PANEL                           DPKCS017
119600                                                                  DPKCS017
119700     END-EVALUATE.                                                DPKCS017
119800                                                                  DPKCS017
119900 EJECT                                                            DPKCS017
120000                                                                  DPKCS017
120100 D500-OBTAIN-FIRST-MNEMONIC.                                      DPKCS017
120200******************************************************************DPKCS017
120300*    READ THE TSQB RECORD FOR THE FIRST TIME, UPDATE THE ACTIVITY DPKCS017
120400*    SWITCH.                                                      DPKCS017
120500*                                                                 DPKCS017
120600*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
120700******************************************************************DPKCS017
120800                                                                  DPKCS017
120900     MOVE 1                    TO  DP017-SCR-SUB.                 DPKCS017
121000                                                                  DPKCS017
121100     IF  DP020-INT-APPL-FORMAT-IND EQUAL '1'                      DPKCS017
121200         MOVE DP055-MNEMONIC   TO  DP017-SCREEN-MNEMONIC          DPKCS017
121300         SET DP017-NO-TSQB     TO  TRUE                           DPKCS017
121400     ELSE                                                         DPKCS017
121500         SET DP017-USE-TSQB    TO  TRUE                           DPKCS017
121600         MOVE 1                TO  DP017-MN-ITEM                  DPKCS017
121700                                   DP017-MN-SUB                   DPKCS017
121800         PERFORM D700-READ-TSQB-QUEUE                             DPKCS017
121900         IF  PV-RESP EQUAL DFHRESP(QIDERR)                        DPKCS017
122000             MOVE PC-TSYMSG-00148                                 DPKCS017
122100                               TO  DP020-MSG-NUMBER               DPKCS017
122200             SET DP020-MSG-FATAL                                  DPKCS017
122300                               TO  TRUE                           DPKCS017
122400             MOVE DP016-PF3    TO  DP020-SRC-AID                  DPKCS017
122500             PERFORM DP015-1000-START-NAVIGATOR                   DPKCS017
122600         ELSE                                                     DPKCS017
122700             MOVE DP002-MNEMONIC (1)                              DPKCS017
122800                               TO  DP017-SCREEN-MNEMONIC          DPKCS017
122900             SET DP002-INQ (1) TO  TRUE                           DPKCS017
123000             PERFORM D800-REWRITE-TSQB-QUEUE                      DPKCS017
123100         END-IF                                                   DPKCS017
123200     END-IF.                                                      DPKCS017
123300                                                                  DPKCS017
123400     IF  DP020-MSG-FATAL                                          DPKCS017
123500         CONTINUE                                                 DPKCS017
123600     ELSE                                                         DPKCS017
123700         PERFORM E100-SEND-INITIAL-SCREEN                         DPKCS017
123800     END-IF.                                                      DPKCS017
123900                                                                  DPKCS017
124000 EJECT                                                            DPKCS017
124100                                                                  DPKCS017
124200 D600-GET-NEXT-MNEMONIC.                                          DPKCS017
124300******************************************************************DPKCS017
124400*    READ THE TSQB RECORD, CHECK IF  THERE ARE ANY MORE MNEMONICS DPKCS017
124500*    TO PROCESS.  HANDLE ACCORDINGLY.                             DPKCS017
124600*                                                                 DPKCS017
124700*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
124800******************************************************************DPKCS017
124900                                                                  DPKCS017
125000     INITIALIZE DP017-SCREEN-FKEYS.                               DPKCS017
125100     ADD 1                     TO  DP017-MN-SUB.                  DPKCS017
125200     IF   DP017-MN-SUB GREATER THAN DP002-MAX-ITEMS               DPKCS017
125300         ADD 1                 TO  DP017-MN-ITEM                  DPKCS017
125400         MOVE 1                TO  DP017-MN-SUB                   DPKCS017
125500     END-IF.                                                      DPKCS017
125600                                                                  DPKCS017
125700     PERFORM D700-READ-TSQB-QUEUE.                                DPKCS017
125800     IF (PV-RESP EQUAL DFHRESP(NOTFND)                            DPKCS017
125900     OR  DP002-MNEMONIC (DP017-MN-SUB) EQUAL SPACES)              DPKCS017
126000         SUBTRACT 1          FROM  DP017-MN-SUB                   DPKCS017
126100         MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER               DPKCS017
126200         SET DP020-MSG-INFORMATIONAL                              DPKCS017
126300                               TO  TRUE                           DPKCS017
126400     ELSE                                                         DPKCS017
126500         MOVE DP002-MNEMONIC (DP017-MN-SUB)                       DPKCS017
126600                               TO  DP017-SCREEN-MNEMONIC          DPKCS017
126700         SET DP002-INQ (DP017-MN-SUB)                             DPKCS017
126800                               TO  TRUE                           DPKCS017
126900         MOVE 1                TO  DP017-SCR-SUB                  DPKCS017
127000     END-IF.                                                      DPKCS017
127100                                                                  DPKCS017
127200     PERFORM D800-REWRITE-TSQB-QUEUE.                             DPKCS017
127300     PERFORM E100-SEND-INITIAL-SCREEN.                            DPKCS017
127400                                                                  DPKCS017
127500 EJECT                                                            DPKCS017
127600                                                                  DPKCS017
127700 D700-READ-TSQB-QUEUE.                                            DPKCS017
127800******************************************************************DPKCS017
127900*    READ THE TSQB RECORD.                                        DPKCS017
128000*                                                                 DPKCS017
128100*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
128200*                 D600                                            DPKCS017
128300******************************************************************DPKCS017
128400                                                                  DPKCS017
128500     EXEC CICS                                                    DPKCS017
128600          READQ TS                                                DPKCS017
128700          QUEUE(DP055-TSQB-QUEUE-NAME)                            DPKCS017
128800          INTO(DP002-ARCH-MAINT-TSQB-REC)                         DPKCS017
128900          LENGTH(DP055-TSQB-QUEUE-LENGTH)                         DPKCS017
129000          ITEM(DP017-MN-ITEM)                                     DPKCS017
129100          RESP(PV-RESP)                                           DPKCS017
129200     END-EXEC.                                                    DPKCS017
129300                                                                  DPKCS017
129400     IF (PV-RESP EQUAL DFHRESP(NORMAL)                            DPKCS017
129500     OR  PV-RESP EQUAL DFHRESP(NOTFND)                            DPKCS017
129600     OR  PV-RESP EQUAL DFHRESP(QIDERR))                           DPKCS017
129700         CONTINUE                                                 DPKCS017
129800     ELSE                                                         DPKCS017
129900         MOVE PV-RESP          TO  PM-RESP-31                     DPKCS017
130000         SET DP013-LOGIC-ABEND TO  TRUE                           DPKCS017
130100         SET DP013-NO-ROLLBACK TO  TRUE                           DPKCS017
130200         MOVE 'D700-READ-TSQB-QUEUE'                              DPKCS017
130300                               TO  DP013-PARAGRAPH                DPKCS017
130400         MOVE PM-PROGRAM-MESSAGE-31                               DPKCS017
130500                               TO  DP013-MESSAGE-TEXT (1)         DPKCS017
130600         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS017
130700     END-IF.                                                      DPKCS017
130800                                                                  DPKCS017
130900 EJECT                                                            DPKCS017
131000                                                                  DPKCS017
131100 D800-REWRITE-TSQB-QUEUE.                                         DPKCS017
131200******************************************************************DPKCS017
131300*    REWRITE THE TSQB RECORD.                                     DPKCS017
131400*                                                                 DPKCS017
131500*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
131600*                 D600                                            DPKCS017
131700******************************************************************DPKCS017
131800                                                                  DPKCS017
131900     EXEC CICS                                                    DPKCS017
132000          WRITEQ TS                                               DPKCS017
132100          QUEUE(DP055-TSQB-QUEUE-NAME)                            DPKCS017
132200          FROM(DP002-ARCH-MAINT-TSQB-REC)                         DPKCS017
132300          LENGTH(DP055-TSQB-QUEUE-LENGTH)                         DPKCS017
132400          ITEM(DP017-MN-ITEM)                                     DPKCS017
132500          RESP(PV-RESP)                                           DPKCS017
132600          REWRITE                                                 DPKCS017
132700     END-EXEC.                                                    DPKCS017
132800                                                                  DPKCS017
132900     IF   PV-RESP NOT EQUAL DFHRESP(NORMAL)                       DPKCS017
133000         MOVE PV-RESP          TO  PM-RESP-31                     DPKCS017
133100         SET DP013-LOGIC-ABEND TO  TRUE                           DPKCS017
133200         SET DP013-NO-ROLLBACK TO  TRUE                           DPKCS017
133300         MOVE 'D800-REWRITE-TSQB-QUEUE'                           DPKCS017
133400                               TO  DP013-PARAGRAPH                DPKCS017
133500         MOVE PM-PROGRAM-MESSAGE-31                               DPKCS017
133600                               TO  DP013-MESSAGE-TEXT (1)         DPKCS017
133700         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS017
133800     END-IF.                                                      DPKCS017
133900                                                                  DPKCS017
134000 EJECT                                                            DPKCS017
134100                                                                  DPKCS017
134200 E100-SEND-INITIAL-SCREEN.                                        DPKCS017
134300******************************************************************DPKCS017
134400*    SET UP AND SEND THE MAP FOR THE NEW MNEMONIC.                DPKCS017
134500*                                                                 DPKCS017
134600*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS017
134700*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
134800******************************************************************DPKCS017
134900                                                                  DPKCS017
135000     PERFORM F100-RETRIEVE-DATA-FOR-SCREEN.                       DPKCS017
135100     IF  DP020-NEXT-ACT-APPL-ERROR                                      17
135200         PERFORM E101-COMPUTE-PROCESSED-ITEMS                           17
135300     ELSE                                                         DPKCS017
135400         PERFORM F200-DISPLAY-PANEL                               DPKCS017
135500     END-IF.                                                      DPKCS017
135600                                                                  DPKCS017
135700 EJECT                                                            DPKCS017
135800                                                                  DPKCS017
135900 E101-COMPUTE-PROCESSED-ITEMS.                                          17
136000******************************************************************DPKCS017
136100*    COMPUTE NUMBER-PROCESSED-ITEMS.                              DPKCS017
136200******************************************************************DPKCS017
136300     IF  DP017-USE-TSQB                                                 17
136400         COMPUTE DP055-NUMBER-PROCESSED-ITEMS =                         17
136500             ((DP017-MN-ITEM - 1) * DP002-MAX-ITEMS) +                  17
136600                                                    DP017-MN-SUB        17
136700     ELSE                                                               17
136800         MOVE ZERO TO DP055-NUMBER-PROCESSED-ITEMS                      17
136900     END-IF.                                                            17
137000                                                                  DPKCS017
137100 EJECT                                                            DPKCS017
137200                                                                  DPKCS017
137300 E200-CHECK-FIELDS-FOR-ENTRY.                                           17
137400******************************************************************DPKCS017
137500*    CHECK EACH UNPROTECTED FIELD AND SEE IF THE USER ENTERED     DPKCS017
137600*    ANYTHING INTO THEM.                                          DPKCS017
137700*                                                                 DPKCS017
137800*    PERFORMED BY D100-MOVE-SCREEN-TO-COMMAREA.                   DPKCS017
137900******************************************************************DPKCS017
138000                                                                  DPKCS017
138100*    *************************************************************DPKCS017
138200*    * SELECTION                                                  DPKCS017
138300*    *************************************************************DPKCS017
138400     IF  DPKM017-ASELL(PS-SUB) > 0                                DPKCS017
138500         MOVE DPKM017-ASELI(PS-SUB)                               DPKCS017
138600                               TO  DP017-SCR-SEL(DP017-SCR-SUB)   DPKCS017
138700     ELSE                                                         DPKCS017
138800         IF  DPKM017-ASELA(PS-SUB) = PC-ERASE-EOF                 DPKCS017
138900             MOVE SPACES       TO  DP017-SCR-SEL(DP017-SCR-SUB)   DPKCS017
139000         END-IF                                                   DPKCS017
139100     END-IF.                                                      DPKCS017
139200                                                                  DPKCS017
139300*    *************************************************************DPKCS017
139400*    * ACTION                                                           17
139500*    *************************************************************DPKCS017
139600     IF  DPKM017-AACTL(PS-SUB) > 0                                DPKCS017
139700         MOVE DPKM017-AACTI(PS-SUB)                               DPKCS017
139800                           TO DP017-SCR-ACTION(DP017-SCR-SUB)     DPKCS017
139900                              PV-FIND-ACT                         DPKCS017
140000         PERFORM J110-GET-ACTION-DESCRIPTION                            17
140100     ELSE                                                         DPKCS017
140200         IF  DPKM017-AACTA(PS-SUB) = PC-ERASE-EOF                 DPKCS017
140300             MOVE SPACES   TO DP017-SCR-ACTION(DP017-SCR-SUB)     DPKCS017
140400         END-IF                                                   DPKCS017
140500     END-IF.                                                      DPKCS017
140600                                                                  DPKCS017
140700*    *************************************************************DPKCS017
140800*    * DISPOSITION                                                      17
140900*    *************************************************************DPKCS017
141000     IF  DPKM017-ADISPL(PS-SUB) > 0                               DPKCS017
141100         MOVE DPKM017-ADISPI(PS-SUB) TO DP017-SCR-DISP                  17
141200                                                  (DP017-SCR-SUB)       17
141300     ELSE                                                         DPKCS017
141400         IF  DPKM017-ADISPA(PS-SUB) = PC-ERASE-EOF                      17
141500             MOVE SPACES             TO DP017-SCR-DISP                  17
141600                                                  (DP017-SCR-SUB)       17
141700         END-IF                                                   DPKCS017
141800     END-IF.                                                      DPKCS017
141900                                                                  DPKCS017
142000*    *************************************************************DPKCS017
142100*    * LABEL                                                            17
142200*    *************************************************************DPKCS017
142300     IF  DPKM017-ALABLL(PS-SUB) > 0                               DPKCS017
142400         MOVE DPKM017-ALABLI(PS-SUB)                              DPKCS017
142500                              TO DP017-SCR-LABEL(DP017-SCR-SUB)         17
142600     ELSE                                                         DPKCS017
142700         IF  DPKM017-ALABLA(PS-SUB) = PC-ERASE-EOF                DPKCS017
142800             MOVE SPACES      TO DP017-SCR-LABEL(DP017-SCR-SUB)         17
142900         END-IF                                                   DPKCS017
143000     END-IF.                                                      DPKCS017
143100                                                                  DPKCS017
143200*    *************************************************************DPKCS017
143300*    * MNEMONIC                                                         17
143400*    *************************************************************DPKCS017
143500     IF  DPKM017-AMNEML(PS-SUB) > 0                               DPKCS017
143600         MOVE DPKM017-AMNEMI(PS-SUB)                                    17
143700                              TO DP017-SCR-MNEMONIC(DP017-SCR-SUB)      17
143800     ELSE                                                         DPKCS017
143900         IF  DPKM017-AMNEMA(PS-SUB) = PC-ERASE-EOF                DPKCS017
144000             MOVE SPACES      TO DP017-SCR-MNEMONIC(DP017-SCR-SUB)      17
144100         END-IF                                                   DPKCS017
144200     END-IF.                                                      DPKCS017
144300                                                                  DPKCS017
144400*    *************************************************************DPKCS017
144500*    * FORMAT                                                           17
144600*    *************************************************************DPKCS017
144700     IF  DPKM017-AFORML(PS-SUB) > 0                               DPKCS017
144800         MOVE DPKM017-AFORMI(PS-SUB)                              DPKCS017
144900                              TO DP017-SCR-FORMAT(DP017-SCR-SUB)  DPKCS017
145000     ELSE                                                         DPKCS017
145100         IF  DPKM017-AFORMA(PS-SUB) = PC-ERASE-EOF                DPKCS017
145200             MOVE SPACES      TO DP017-SCR-FORMAT(DP017-SCR-SUB)        17
145300         END-IF                                                   DPKCS017
145400     END-IF.                                                      DPKCS017
145500                                                                  DPKCS017
145600*    *************************************************************DPKCS017
145700*    * STACK                                                            17
145800*    *************************************************************DPKCS017
145900     IF  DPKM017-ASTKL(PS-SUB) > 0                                DPKCS017
146000         MOVE DPKM017-ASTKI(PS-SUB)                               DPKCS017
146100                              TO DP017-SCR-STK(DP017-SCR-SUB)     DPKCS017
146200     ELSE                                                         DPKCS017
146300         IF  DPKM017-ASTKA(PS-SUB) = PC-ERASE-EOF                 DPKCS017
146400             MOVE SPACES      TO DP017-SCR-STK(DP017-SCR-SUB)           17
146500         END-IF                                                   DPKCS017
146600     END-IF.                                                      DPKCS017
146700                                                                  DPKCS017
146800     ADD 1 TO  DP017-SCR-SUB.                                           17
146900                                                                  DPKCS017
147000 EJECT                                                            DPKCS017
147100                                                                  DPKCS017
147200 E300-PROCESS-DELETES.                                            DPKCS017
147300******************************************************************DPKCS017
147400*    DELETE EACH SELECTED FUNCTION KEY FROM THE TCICSROUTE TABLE. DPKCS017
147500*                                                                 DPKCS017
147600*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
147700******************************************************************DPKCS017
147800                                                                  DPKCS017
147900     SET PS-NO-ERROR TO TRUE.                                     DPKCS017
148000                                                                  DPKCS017
148100     PERFORM F300-DELETE                                          DPKCS017
148200         VARYING PS-SUB                                                 17
148300         FROM    PC-MAX-FKEYS                                           17
148400         BY       -1                                                    17
148500         UNTIL PS-SUB = 0.                                        DPKCS017
148600                                                                  DPKCS017
148700     IF  PS-ERROR                                                 DPKCS017
148800         SET DP020-MSG-FATAL TO TRUE                              DPKCS017
148900                                                                  DPKCS017
149000         EXEC CICS                                                DPKCS017
149100             SYNCPOINT                                            DPKCS017
149200             ROLLBACK                                             DPKCS017
149300         END-EXEC                                                 DPKCS017
149400                                                                  DPKCS017
149500     ELSE                                                         DPKCS017
149600                                                                  DPKCS017
149700         MOVE PC-TSYMSG-00115 TO DP020-MSG-NUMBER                 DPKCS017
149800         SET DP020-MSG-INFORMATIONAL TO TRUE                      DPKCS017
149900                                                                  DPKCS017
150000         PERFORM Z980-UPDT-TMNEMONIC-ROW                          DPKCS017
150100     END-IF.                                                      DPKCS017
150200                                                                  DPKCS017
150300     PERFORM G200-MOVE-COMMAREA-TO-SCREEN.                        DPKCS017
150400                                                                  DPKCS017
150500 EJECT                                                            DPKCS017
150600                                                                  DPKCS017
150700 E400-PREPARE-TO-EDIT.                                            DPKCS017
150800******************************************************************DPKCS017
150900*    PREPARE THE SUBSCRIPTS AND INVOKE THE EDIT ROUTINE.          DPKCS017
151000*                                                                 DPKCS017
151100*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
151200******************************************************************DPKCS017
151300                                                                  DPKCS017
151400     MOVE DP017-SCR-SUB        TO  PV-HOLD-SCR-SUB.               DPKCS017
151500     PERFORM Y000-COMPUTE-PS-SUB.                                       17
151600     PERFORM E500-EDIT-ADD-UPDATE-REQUEST                         DPKCS017
151700             PC-MAX-ITEMS-ON-SCREEN TIMES.                        DPKCS017
151800                                                                  DPKCS017
151900     MOVE PV-HOLD-SCR-SUB      TO  DP017-SCR-SUB.                 DPKCS017
152000                                                                  DPKCS017
152100     IF  DP017-SCR-SUB GREATER THAN 12 AND LESS THAN 25           DPKCS017
152200*        *********************************************************DPKCS017
152300*        * PRESENTLY ON THE 2ND OF THREE SCREENS;                 DPKCS017
152400*        * THE FKEYS ON THIS SCREEN ARE THE ONLY ONES WHICH       DPKCS017
152500*        * MAY BE UNIQUELY ASSIGNED FOR EACH APPLICATION.         DPKCS017
152600*        * EDIT FOR DUPLICATES ON THIS SCREEN; DUPS NOT ALLOWED.  DPKCS017
152700*        *********************************************************DPKCS017
152800         INITIALIZE PV-FKEY-TABLE                                 DPKCS017
152900         MOVE DP017-SCR-SUB    TO  PV-HOLD-SCR-SUB                DPKCS017
153000         PERFORM E410-DUP-SETUP PC-MAX-ITEMS-ON-SCREEN TIMES      DPKCS017
153100     END-IF.                                                      DPKCS017
153200                                                                  DPKCS017
153300 EJECT                                                            DPKCS017
153400                                                                  DPKCS017
153500 E410-DUP-SETUP.                                                  DPKCS017
153600******************************************************************DPKCS017
153700*    COUNT THE NUMBER OF TIMES A LOCAL KEY IS REQUESTED.          DPKCS017
153800*                                                                 DPKCS017
153900*    PERFORMED BY E400                                            DPKCS017
154000******************************************************************DPKCS017
154100                                                                  DPKCS017
154200     SET PT-FT-IND             TO  PC-LOCAL-FKEY-START.           DPKCS017
154300                                                                  DPKCS017
154400     SEARCH PT-FKEY-TABLE                                         DPKCS017
154500         VARYING PT-FT-IND                                        DPKCS017
154600                                                                  DPKCS017
154700             WHEN PT-FT-ACT(PT-FT-IND) EQUAL                      DPKCS017
154800                  DP017-SCR-ACTION (PV-HOLD-SCR-SUB)              DPKCS017
154900                                                                  DPKCS017
155000                  IF (DP017-SCR-STATUS (PV-HOLD-SCR-SUB)          DPKCS017
155100                      EQUAL PC-STATUS-ACTIVE                      DPKCS017
155200                  OR  DP017-SCR-SEL (PV-HOLD-SCR-SUB)             DPKCS017
155300                      EQUAL PC-SELECT)                            DPKCS017
155400                                                                  DPKCS017
155500                      SET PV-TSUB  TO  PT-FT-IND                  DPKCS017
155600                      SUBTRACT PC-LOCAL-FKEY-ADJUST               DPKCS017
155700                             FROM  PV-TSUB                        DPKCS017
155800                      ADD 1    TO  PV-FKEY (PV-TSUB)              DPKCS017
155900                                                                  DPKCS017
156000                      IF  PV-FKEY (PV-TSUB) GREATER THAN 1        DPKCS017
156100                          SET PS-ERROR                            DPKCS017
156200                               TO TRUE                            DPKCS017
156300                          SET DP020-MSG-FATAL                     DPKCS017
156400                               TO TRUE                            DPKCS017
156500                          MOVE PC-TSYMSG-00265                    DPKCS017
156600                               TO DP020-MSG-NUMBER                DPKCS017
156700                          MOVE DP015-RED                          DPKCS017
156800                               TO  DP017-SCR-SELC(PV-HOLD-SCR-SUB)DPKCS017
156900                          MOVE DP015-REVERSE                      DPKCS017
157000                               TO  DP017-SCR-SELH(PV-HOLD-SCR-SUB)DPKCS017
157100                          MOVE PC-CURSOR-POS                            17
157200                               TO  DP017-SCR-SELL(PV-HOLD-SCR-SUB)DPKCS017
157300                      END-IF                                      DPKCS017
157400                  END-IF                                          DPKCS017
157500                                                                  DPKCS017
157600             WHEN PT-FT-ACT(PT-FT-IND) = HIGH-VALUE               DPKCS017
157700                  CONTINUE                                        DPKCS017
157800     END-SEARCH.                                                  DPKCS017
157900                                                                  DPKCS017
158000     ADD 1                     TO  PV-HOLD-SCR-SUB.               DPKCS017
158100                                                                  DPKCS017
158200 EJECT                                                            DPKCS017
158300                                                                  DPKCS017
158400 E500-EDIT-ADD-UPDATE-REQUEST.                                    DPKCS017
158500******************************************************************DPKCS017
158600*    IF THE VALUE IN "SEL" SELECTION FIELD ON THIS ROW OF         DPKCS017
158700*    THE SCREEN IS VALID,                                         DPKCS017
158800*    PERFORM EDITS ON EACH OF THE ENTERABLE FIELDS ON THIS ROW OF DPKCS017
158900*    THE SCREEN.                                                  DPKCS017
159000*                                                                 DPKCS017
159100*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
159200******************************************************************DPKCS017
159300                                                                  DPKCS017
159400     IF  DP017-SCR-SELA(PS-SUB) EQUAL DP015-ASK-DRK-OFF                 17
159500         MOVE DP015-HL-OFF     TO  DP017-SCR-SELH(PS-SUB)               17
159600     ELSE                                                               17
159700         MOVE DP015-GREEN      TO  DP017-SCR-SELC(PS-SUB)         DPKCS017
159800                                   DP017-SCR-ACTIONC(PS-SUB)      DPKCS017
159900                                   DP017-SCR-DISPC(PS-SUB)              17
160000                                   DP017-SCR-LABELC(PS-SUB)             17
160100                                   DP017-SCR-MNEMONICC(PS-SUB)    DPKCS017
160200                                   DP017-SCR-FORMATC(PS-SUB)      DPKCS017
160300                                   DP017-SCR-STKC(PS-SUB)         DPKCS017
160400         MOVE DP015-UNDERLINE  TO  DP017-SCR-SELH(PS-SUB)         DPKCS017
160500                                   DP017-SCR-ACTIONH(PS-SUB)      DPKCS017
160600                                   DP017-SCR-DISPH(PS-SUB)              17
160700                                   DP017-SCR-LABELH(PS-SUB)             17
160800                                   DP017-SCR-MNEMONICH(PS-SUB)    DPKCS017
160900                                   DP017-SCR-FORMATH(PS-SUB)      DPKCS017
161000                                   DP017-SCR-STKH(PS-SUB)         DPKCS017
161100         MOVE PC-NO-CURSOR     TO  DP017-SCR-SELL(PS-SUB)         DPKCS017
161200                                   DP017-SCR-ACTIONL(PS-SUB)      DPKCS017
161300                                   DP017-SCR-DISPL(PS-SUB)              17
161400                                   DP017-SCR-LABELL(PS-SUB)             17
161500                                   DP017-SCR-MNEMONICL(PS-SUB)    DPKCS017
161600                                   DP017-SCR-FORMATL(PS-SUB)      DPKCS017
161700                                   DP017-SCR-STKL(PS-SUB)         DPKCS017
161800     END-IF.                                                      DPKCS017
161900                                                                  DPKCS017
162000     IF  DP017-SCR-SEL(PS-SUB) = PC-SELECT                        DPKCS017
162100         PERFORM F400-EDIT-SELECTED-FKEY                          DPKCS017
162200     ELSE                                                         DPKCS017
162300         IF  DP017-SCR-SEL(PS-SUB) GREATER THAN SPACES            DPKCS017
162400             SET PS-ERROR         TO TRUE                               17
162500             SET DP020-MSG-FATAL  TO TRUE                               17
162600             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                   17
162700             MOVE DP015-RED       TO DP017-SCR-SELC(PS-SUB)             17
162800             MOVE DP015-REVERSE   TO DP017-SCR-SELH(PS-SUB)             17
162900             MOVE PC-CURSOR-POS   TO DP017-SCR-SELL(PS-SUB)             17
163000         END-IF                                                   DPKCS017
163100     END-IF.                                                      DPKCS017
163200                                                                  DPKCS017
163300     SUBTRACT 1              FROM  PS-SUB.                        DPKCS017
163400                                                                  DPKCS017
163500 EJECT                                                            DPKCS017
163600                                                                  DPKCS017
163700 E600-PROCESS-ADDS-UPDATES.                                       DPKCS017
163800******************************************************************DPKCS017
163900*    IF THERE IS NO TIMESTAMP INFORMATION FOR THE SELECTED        DPKCS017
164000*    FUNCTION KEY, ADD IT TO THE TCICSROUTE TABLE, OTHERWISE      DPKCS017
164100*    UPDATE THE EXISTING ROW FOR THIS FUNCTION KEY ON THE         DPKCS017
164200*    TCICSROUTE TABLE.                                            DPKCS017
164300*                                                                 DPKCS017
164400*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
164500******************************************************************DPKCS017
164600                                                                  DPKCS017
164700     IF  DP017-SCR-SEL(PS-SUB) = PC-SELECT                        DPKCS017
164800         SET PS-ITEM-SELECTED TO TRUE                             DPKCS017
164900                                                                  DPKCS017
165000         IF  DP017-SCR-TMESTP(PS-SUB) = SPACES                    DPKCS017
165100             PERFORM Z800-INSERT-TCICSROUTE-ROW                   DPKCS017
165200             SET PS-INSERT TO TRUE                                DPKCS017
165300         ELSE                                                     DPKCS017
165400             PERFORM Z900-UPDATE-TCICSROUTE-ROW                   DPKCS017
165500             SET PS-UPDATE TO TRUE                                DPKCS017
165600         END-IF                                                   DPKCS017
165700                                                                  DPKCS017
165800         IF  SQLCODE = +0                                         DPKCS017
165900             PERFORM Z500-SELECT-TCICSROUTE-ROW                   DPKCS017
166000             MOVE SPACES          TO  DP017-SCR-SEL (PS-SUB)            17
166100             MOVE DP015-GREEN     TO  DP017-SCR-FORMATC(PS-SUB)         17
166200             MOVE DP015-UNDERLINE TO  DP017-SCR-FORMATH(PS-SUB)         17
166300             MOVE PC-NO-CURSOR    TO  DP017-SCR-FORMATL(PS-SUB)         17
166400             SET PS-NO-WARNING    TO  TRUE                              17
166500             SET PV-REWRITE       TO  TRUE                              17
166600                                                                  DPKCS017
166700             IF  SQLCODE = +0                                     DPKCS017
166800                 MOVE PC-STATUS-ACTIVE                            DPKCS017
166900                                  TO  DP017-SCR-STATUS(PS-SUB)          17
167000                 PERFORM Z980-UPDT-TMNEMONIC-ROW                        17
167100             ELSE                                                 DPKCS017
167200                 SET DP013-DB2-ABEND TO TRUE                      DPKCS017
167300                 SET DP013-ROLLBACK  TO TRUE                      DPKCS017
167400                                                                  DPKCS017
167500                 IF  PS-INSERT                                    DPKCS017
167600                     MOVE 'E600-PROCESS-ADDS-UPDATES - INSERT' TO DPKCS017
167700                          DP013-PARAGRAPH                         DPKCS017
167800                 ELSE                                             DPKCS017
167900                     MOVE 'E600-PROCESS-ADDS-UPDATES - UPDATE' TO DPKCS017
168000                          DP013-PARAGRAPH                         DPKCS017
168100                 END-IF                                           DPKCS017
168200                                                                  DPKCS017
168300                 MOVE SQLCODE                       TO            DPKCS017
168400                      PM-SQLCODE-6                                DPKCS017
168500                 MOVE SQLCA                         TO            DPKCS017
168600                      DP013-SQLCA                                 DPKCS017
168700                 MOVE PM-PROGRAM-MESSAGE-6          TO            DPKCS017
168800                      DP013-MESSAGE-TEXT(1)                       DPKCS017
168900                 MOVE PV-TMESTP                     TO                  17
169000                      PM-TMESTP                                         17
169100                 MOVE PM-PROGRAM-MESSAGE-T          TO                  17
169200                      DP013-MESSAGE-TEXT(2)                             17
169300                                                                  DPKCS017
169400                 PERFORM DP013-0000-PROCESS-ABEND                 DPKCS017
169500             END-IF                                               DPKCS017
169600                                                                  DPKCS017
169700         ELSE                                                     DPKCS017
169800             SET PS-ERROR TO TRUE                                 DPKCS017
169900                                                                  DPKCS017
170000             PERFORM Z500-SELECT-TCICSROUTE-ROW                   DPKCS017
170100                                                                  DPKCS017
170200             IF  SQLCODE = +0                                     DPKCS017
170300                 SET DP020-MSG-WARNING TO TRUE                    DPKCS017
170400             ELSE                                                 DPKCS017
170500                 SET DP013-DB2-ABEND   TO TRUE                    DPKCS017
170600                 SET DP013-ROLLBACK    TO TRUE                    DPKCS017
170700                                                                  DPKCS017
170800                 IF  PS-INSERT                                    DPKCS017
170900                     MOVE 'E600-PROCESS-ADDS-UPDATES - INSERT' TO DPKCS017
171000                          DP013-PARAGRAPH                         DPKCS017
171100                 ELSE                                             DPKCS017
171200                     MOVE 'E600-PROCESS-ADDS-UPDATES - UPDATE' TO DPKCS017
171300                          DP013-PARAGRAPH                         DPKCS017
171400                 END-IF                                           DPKCS017
171500                                                                  DPKCS017
171600                 MOVE SQLCODE           TO PM-SQLCODE-6                 17
171700                 MOVE SQLCA             TO DP013-SQLCA                  17
171800                 MOVE PM-PROGRAM-MESSAGE-6                              17
171900                                        TO DP013-MESSAGE-TEXT(1)        17
172000                 MOVE PV-TMESTP         TO PM-TMESTP                    17
172100                 MOVE PM-PROGRAM-MESSAGE-T                              17
172200                                        TO DP013-MESSAGE-TEXT(2)        17
172300                 PERFORM DP013-0000-PROCESS-ABEND                 DPKCS017
172400             END-IF                                               DPKCS017
172500         END-IF                                                   DPKCS017
172600     END-IF.                                                      DPKCS017
172700                                                                  DPKCS017
172800 EJECT                                                            DPKCS017
172900                                                                  DPKCS017
173000 E700-EDIT-DELETE-REQUEST.                                        DPKCS017
173100******************************************************************DPKCS017
173200*    IF THE USER WANTS TO DELETE AN EXISTING FUNCTION KEY FROM    DPKCS017
173300*    THE TCICSROUTE TABLE, MAKE SURE THAT:                        DPKCS017
173400*    1) THE FUNCTION KEY IS "ACTIVE"                              DPKCS017
173500*       (IN OTHER WORDS, THAT IT EXISTS ON THE TCICSROUTE TABLE). DPKCS017
173600*    2) THAT THE KEY IS NOT USED SYSTEM WIDE                            17
173700*       (IN OTHER WORDS, CHECK THE VALUE OF THE SYSWIDE_USE_INDT  DPKCS017
173800*       D SYSTEM WIDE.                                            DPKCS017
173900*                                                                 DPKCS017
174000*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
174100******************************************************************DPKCS017
174200                                                                  DPKCS017
174300     IF  DP017-SCR-SEL(PS-SUB) = PC-SELECT                        DPKCS017
174400         SET PS-ITEM-SELECTED TO TRUE                             DPKCS017
174500     ELSE                                                         DPKCS017
174600         IF  DP017-SCR-SEL(PS-SUB) GREATER THAN SPACES            DPKCS017
174700             SET PS-ERROR         TO TRUE                               17
174800             SET DP020-MSG-FATAL  TO TRUE                         DPKCS017
174900             MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER             DPKCS017
175000             MOVE DP015-RED       TO DP017-SCR-SELC(PS-SUB)             17
175100             MOVE DP015-REVERSE   TO DP017-SCR-SELH(PS-SUB)             17
175200             MOVE PC-CURSOR-POS   TO DP017-SCR-SELL(PS-SUB)             17
175300         END-IF                                                   DPKCS017
175400     END-IF.                                                      DPKCS017
175500                                                                  DPKCS017
175600 EJECT                                                            DPKCS017
175700                                                                  DPKCS017
175800 E800-CHECK-IF-ROW-SELECTED.                                      DPKCS017
175900******************************************************************DPKCS017
176000*    VERIFY THAT VALUE IN "SEL" SELECTION FIELD ON THIS ROW OF    DPKCS017
176100*    THE SCREEN IS VALID:                                         DPKCS017
176200*    SPACE - THIS ROW HAS NOT BEEN SELECTED.                      DPKCS017
176300*    S     - THIS ROW HAS BEEN SELECTED.                          DPKCS017
176400*                                                                 DPKCS017
176500*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS017
176600*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
176700******************************************************************DPKCS017
176800                                                                  DPKCS017
176900     IF (DP017-SCR-SEL(PS-SUB) EQUAL PC-SELECT                    DPKCS017
177000     OR  DP017-SCR-SEL(PS-SUB) NOT GREATER THAN SPACES)           DPKCS017
177100         MOVE DP015-GREEN      TO  DP017-SCR-SELC (PS-SUB)        DPKCS017
177200         MOVE DP015-UNDERLINE  TO  DP017-SCR-SELH(PS-SUB)         DPKCS017
177300         MOVE PC-NO-CURSOR     TO  DP017-SCR-SELL(PS-SUB)         DPKCS017
177400     ELSE                                                         DPKCS017
177500         SET PS-ERROR TO TRUE                                     DPKCS017
177600         SET DP020-MSG-FATAL   TO  TRUE                           DPKCS017
177700         MOVE PC-TSYMSG-00005  TO  DP020-MSG-NUMBER               DPKCS017
177800         MOVE DP015-RED        TO  DP017-SCR-SELC(PS-SUB)         DPKCS017
177900         MOVE DP015-REVERSE    TO  DP017-SCR-SELH(PS-SUB)         DPKCS017
178000         MOVE PC-CURSOR-POS    TO  DP017-SCR-SELL(PS-SUB)         DPKCS017
178100     END-IF.                                                      DPKCS017
178200                                                                  DPKCS017
178300     SUBTRACT 1              FROM  PS-SUB.                        DPKCS017
178400                                                                  DPKCS017
178500 EJECT                                                            DPKCS017
178600                                                                  DPKCS017
178700 F100-RETRIEVE-DATA-FOR-SCREEN.                                   DPKCS017
178800******************************************************************DPKCS017
178900*    READ THE TMNEMONIC TABLE TO SEE IF THE REQUESTED MNEMONIC    DPKCS017
179000*    IS VALID.  IF IT IS VALID, READ THE TAIDKEY AND TCICSROUTE   DPKCS017
179100*    TABLES AND SAVE ALL THE NECESSARY INFORMATION IN THE         DPKCS017
179200*    COMMAREA.                                                    DPKCS017
179300*                                                                 DPKCS017
179400*    PERFORMED BY E100-SEND-INITIAL-SCREEN.                       DPKCS017
179500******************************************************************DPKCS017
179600                                                                  DPKCS017
179700*    *************************************************************DPKCS017
179800*    * ACCESS DB2 TABLE: TMNEMONIC                                DPKCS017
179900*    *************************************************************DPKCS017
180000     MOVE DP017-SCREEN-MNEMONIC TO PV-MNEMONIC.                   DPKCS017
180100     PERFORM Z100-SELECT-TMNEMONIC-ROW.                           DPKCS017
180200     IF  SQLCODE = +0                                                   17
180300         MOVE TMNEMONIC-TRANS-ID-CODE                                   17
180400                                   TO DP017-SCREEN-TRAN-ID              17
180500         MOVE TMNEMONIC-SCRN-TYP-CDE                                    17
180600                                   TO DP017-SCR-TYP-CDE                 17
180700         IF  IV-PANEL-TITLE-NAME = PC-NULL-INDICATOR                    17
180800             MOVE SPACES           TO DP017-SCREEN-MNEMONIC-TITLE       17
180900         ELSE                                                           17
181000             MOVE TMNEMONIC-PANEL-TITLE-NAME                            17
181100                                   TO DP017-SCREEN-MNEMONIC-TITLE       17
181200         END-IF                                                         17
181300                                                                  DPKCS017
181400*        *********************************************************DPKCS017
181500*        * ACCESS DB2 TABLE: TAIDKEY, TCICSROUTE                  DPKCS017
181600*        *********************************************************DPKCS017
181700         PERFORM Z200-OPEN-TAIDKEY-CURSOR                         DPKCS017
181800         PERFORM Z300-FETCH-TAIDKEY-CURSOR                        DPKCS017
181900         PERFORM G100-LOOP-TO-POPULATE-SCREEN                     DPKCS017
182000             UNTIL SQLCODE = +100                                 DPKCS017
182100         PERFORM Z400-CLOSE-TAIDKEY-CURSOR                        DPKCS017
182200         MOVE SPACES               TO ANAVKEYO                          17
182300                                                                  DPKCS017
182400     ELSE                                                               17
182500         SET PS-ERROR              TO TRUE                              17
182600         SET DP020-MSG-FATAL       TO TRUE                              17
182700         MOVE PC-TSYMSG-00148      TO DP020-MSG-NUMBER                  17
182800                                                                  DPKCS017
182900         SET DP020-NEXT-ACT-APPL-ERROR                            DPKCS017
183000                                   TO TRUE                              17
183100         IF  DP020-INT-APPL-FORMAT-IND EQUAL '2'                  DPKCS017
183200             SET DP002-ERR (DP017-MN-SUB)                         DPKCS017
183300                                   TO TRUE                              17
183400             PERFORM D800-REWRITE-TSQB-QUEUE                      DPKCS017
183500         END-IF                                                   DPKCS017
183600         PERFORM DP015-1000-START-NAVIGATOR                       DPKCS017
183700     END-IF.                                                      DPKCS017
183800                                                                  DPKCS017
183900 EJECT                                                            DPKCS017
184000                                                                  DPKCS017
184100 F200-DISPLAY-PANEL.                                              DPKCS017
184200******************************************************************DPKCS017
184300*    FILL THE MAP WITH THE NECESSARY DATA AND WRITE IT OUT.       DPKCS017
184400*                                                                 DPKCS017
184500*    PERFORMED BY B100-CONTROL-PROCESSING.                        DPKCS017
184600*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
184700*    PERFORMED BY E100-SEND-INITIAL-SCREEN.                       DPKCS017
184800******************************************************************DPKCS017
184900                                                                  DPKCS017
185000     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       DPKCS017
185100                                                                  DPKCS017
185200     IF  PS-SEND-MAP-N-DATA-FRSET                                 DPKCS017
185300         PERFORM DP002-0000-FORMAT-TITLE-LINES                    DPKCS017
185400     END-IF.                                                      DPKCS017
185500                                                                  DPKCS017
185600     IF  PS-ERROR                                                 DPKCS017
185700         CONTINUE                                                 DPKCS017
185800     ELSE                                                         DPKCS017
185900         IF (PS-NEW-MNEMONIC-REQUESTED                            DPKCS017
186000         OR  PS-SEND-MAP-N-DATA-FRSET)                            DPKCS017
186100             PERFORM G200-MOVE-COMMAREA-TO-SCREEN                 DPKCS017
186200         END-IF                                                   DPKCS017
186300     END-IF.                                                      DPKCS017
186400                                                                  DPKCS017
186500     PERFORM DP005-0000-FORMAT-MSG-LINES.                         DPKCS017
186600                                                                  DPKCS017
186700     IF  PS-SEND-MAP-N-DATA-FRSET                                 DPKCS017
186800         PERFORM DP009-0000-LOAD-FK-LINES                         DPKCS017
186900     END-IF.                                                      DPKCS017
187000                                                                  DPKCS017
187100     IF (PS-NO-ERROR                                              DPKCS017
187200     AND PS-NO-WARNING)                                           DPKCS017
187300         MOVE PC-CURSOR-POS TO DPKM017-ASELL(1)                   DPKCS017
187400     END-IF.                                                      DPKCS017
187500                                                                  DPKCS017
187600     PERFORM DP008-0000-WRITE-PANEL.                              DPKCS017
187700                                                                  DPKCS017
187800 EJECT                                                            DPKCS017
187900                                                                  DPKCS017
188000 F300-DELETE.                                                     DPKCS017
188100******************************************************************DPKCS017
188200*    DELETE THE ROW FROM THE TCICSROUTE TABLE FOR THE SELECTED    DPKCS017
188300*    FUNCTION KEY.                                                DPKCS017
188400*                                                                 DPKCS017
188500*    PERFORMED BY E300-PROCESS-DELETES.                           DPKCS017
188600******************************************************************DPKCS017
188700                                                                  DPKCS017
188800     IF  DP017-SCR-SEL(PS-SUB) = PC-SELECT                        DPKCS017
188900         IF  DP017-SCR-STATUS(PS-SUB) = PC-STATUS-ACTIVE          DPKCS017
189000             PERFORM Z700-DELETE-TCICSROUTE-ROW                   DPKCS017
189100                                                                  DPKCS017
189200             IF  SQLCODE = +100                                   DPKCS017
189300                 SET PS-ERROR TO TRUE                             DPKCS017
189400             ELSE                                                 DPKCS017
189500                 SET PV-REWRITE TO TRUE                           DPKCS017
189600                 PERFORM Z600-SELECT-TAIDKEY-ROW                  DPKCS017
189700                 PERFORM H100-POPULATE-SCR-COMMAREA               DPKCS017
189800                 MOVE SPACES   TO  DP017-SCR-STATUS  (PS-SUB)     DPKCS017
189900                                   DP017-SCR-SEL     (PS-SUB)     DPKCS017
190000                                   DP017-SCR-ACTION  (PS-SUB)     DPKCS017
190100                                   DP017-SCR-ACTION-DESC (PS-SUB) DPKCS017
190200                                   DP017-SCR-DISP    (PS-SUB)     DPKCS017
190300                                   DP017-SCR-LABEL   (PS-SUB)     DPKCS017
190400                                   DP017-SCR-MNEMONIC(PS-SUB)     DPKCS017
190500                                   DP017-SCR-FORMAT  (PS-SUB)     DPKCS017
190600                                   DP017-SCR-STK     (PS-SUB)     DPKCS017
190700             END-IF                                               DPKCS017
190800         END-IF                                                   DPKCS017
190900     END-IF.                                                      DPKCS017
191000                                                                  DPKCS017
191100 EJECT                                                            DPKCS017
191200                                                                  DPKCS017
191300 F400-EDIT-SELECTED-FKEY.                                         DPKCS017
191400******************************************************************DPKCS017
191500*    EDIT THE ENTERABLE FIELDS FOR EACH FUNCTION KEY SELECTED.    DPKCS017
191600*    THE COMBINATION OF VALUES IN THE ACTION AND DISPOSITION      DPKCS017
191700*    FIELDS DRIVES THE OTHER EDITS.                               DPKCS017
191800*                                                                 DPKCS017
191900*    PERFORMED BY E500-EDIT-ADD-UPDATE-REQUEST.                   DPKCS017
192000******************************************************************DPKCS017
192100                                                                  DPKCS017
192200     PERFORM Z600-SELECT-TAIDKEY-ROW.                             DPKCS017
192300     MOVE DP015-GREEN           TO  DP017-SCR-FORMATC(PS-SUB).    DPKCS017
192400     MOVE DP015-UNDERLINE       TO  DP017-SCR-FORMATH(PS-SUB).    DPKCS017
192500     MOVE PC-NO-CURSOR          TO  DP017-SCR-FORMATL(PS-SUB).    DPKCS017
192600                                                                  DPKCS017
192700*    *************************************************************DPKCS017
192800*    * INDIVIDUAL FIELD EDIT ON THE 'ACTION' FIELD.               DPKCS017
192900*    * REQUIRED FIELD.                                            DPKCS017
193000*    *************************************************************DPKCS017
193100     IF  (DP017-SCR-ACTION(PS-SUB) EQUAL PC-GO-TO-MNEMONIC              17
193200                                      OR PC-RETURN                      17
193300                                      OR PC-CONFIRM                     17
193400                                      OR PC-NAV-REFRESH                 17
193500                                      OR PC-PREVPAGE                    17
193600                                      OR PC-NEXTPAGE                    17
193700                                      OR PC-1ST-PAGE                    17
193800                                      OR PC-LOCAL-FUNC-KEY              17
193900                                      OR PC-DSEL-ALL                    17
194000                                      OR PC-SEL-ALL                     17
194100                                      OR PC-LOCAL-GOTO                  17
194200                                      OR PC-FK-LEFT                     17
194300                                      OR PC-FK-RIGHT                    17
194400                                      OR PC-FK-PREV-SELECTION           17
194500                                      OR PC-FK-NEXT-SELECTION           17
194600                                      OR PC-LOCAL-RETURN                17
194700                                      OR PC-LOCAL-01                    17
194800                                      OR PC-LOCAL-02                    17
194900                                      OR PC-LOCAL-03                    17
195000                                      OR PC-LOCAL-04                    17
195100                                      OR PC-LOCAL-05                    17
195200                                      OR PC-LOCAL-06                    17
195300                                      OR PC-LOCAL-07                    17
195400                                      OR PC-LOCAL-08                    17
195500                                      OR PC-LOCAL-09                    17
195600                                      OR PC-LOCAL-10                    17
195700                                      OR PC-LOCAL-11                    17
195800                                      OR PC-LOCAL-12)                   17
195900         PERFORM F410-EDIT-SPECIFIC-ACTIONS                             17
196000     ELSE                                                               17
196100*        *********************************************************DPKCS017
196200*        * INVALID ENTRY                                                17
196300*        *********************************************************DPKCS017
196400         SET PS-ERROR         TO TRUE                                   17
196500         SET DP020-MSG-FATAL  TO TRUE                                   17
196600         MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER                       17
196700         MOVE DP015-RED       TO DP017-SCR-ACTIONC(PS-SUB)              17
196800         MOVE DP015-REVERSE   TO DP017-SCR-ACTIONH(PS-SUB)              17
196900         MOVE PC-CURSOR-POS   TO DP017-SCR-ACTIONL(PS-SUB).             17
197000 EJECT                                                            DPKCS017
197100                                                                          
197200 F410-EDIT-SPECIFIC-ACTIONS.                                            17
197300******************************************************************DPKCS017
197400*    EDIT BASED ON WHAT WAS ENTERED IN THE 'ACTION' FIELD.        DPKCS017
197500******************************************************************DPKCS017
197600         IF  (DP017-SCR-ACTION(PS-SUB) >= PC-LOCAL-01                   17
197700         AND  DP017-SCR-ACTION(PS-SUB) <= PC-LOCAL-12)                  17
197800             PERFORM F430-EDIT-WITH-NEW-DISP-FIELD                        
197900         ELSE                                                           17
198000             IF  DP017-SCR-DISP(PS-SUB) GREATER THAN SPACES             17
198100*                *************************************************      17
198200*                * DISPOSITION CAN ONLY BE ENTERED FOR LOCAL-01         17
198300*                * THROUGH LOCAL-12                                     17
198400*                *************************************************      17
198500                 MOVE DP015-RED       TO DP017-SCR-DISPC(PS-SUB)        17
198600                                         DP017-SCR-ACTIONC(PS-SUB)      17
198700                 MOVE DP015-REVERSE   TO DP017-SCR-DISPH(PS-SUB)        17
198800                                         DP017-SCR-ACTIONH(PS-SUB)      17
198900                 MOVE PC-CURSOR-POS   TO DP017-SCR-DISPL(PS-SUB)        17
199000                 MOVE PC-TSYMSG-01221 TO DP020-MSG-NUMBER               17
199100                 SET PS-ERROR         TO TRUE                           17
199200                 SET DP020-MSG-FATAL  TO TRUE                           17
199300             ELSE                                                       17
199400                 PERFORM F420-EDIT-WITHOUT-DISP-FIELD                     
199500             END-IF                                                     17
199600         END-IF.                                                        17
199700                                                                          
199800 F420-EDIT-WITHOUT-DISP-FIELD.                                            
199900******************************************************************DPKCS017
200000*    EDITS WHICH EXISTED BEFORE ADDITION OF THE 'DISP' FIELD.     DPKCS017
200100******************************************************************DPKCS017
200200     IF  DP017-SCR-FORMAT(PS-SUB) GREATER THAN SPACES             DPKCS017
200300         IF (DP017-SCR-ACTION(PS-SUB) EQUAL PC-GO-TO-MNEMONIC     DPKCS017
200400         OR  DP017-SCR-ACTION(PS-SUB) EQUAL PC-LOCAL-GOTO)        DPKCS017
200500             SET PS-NO-WARNING  TO  TRUE                          DPKCS017
200600             PERFORM Z550-SELECT-TCICSROUTE-ROW                   DPKCS017
200700             PERFORM Z560-SELECT-TMENUITEM-ROW                    DPKCS017
200800             IF  PS-WARNING                                       DPKCS017
200900                 MOVE DP015-YELLOW  TO  DP017-SCR-FORMATC(PS-SUB) DPKCS017
201000                 MOVE DP015-REVERSE TO  DP017-SCR-FORMATH(PS-SUB) DPKCS017
201100                 MOVE PC-CURSOR-POS TO  DP017-SCR-FORMATL(PS-SUB) DPKCS017
201200                 MOVE PC-TSYMSG-00259                             DPKCS017
201300                                    TO  DP020-MSG-NUMBER                17
201400                 SET DP020-MSG-WARNING                            DPKCS017
201500                                    TO  TRUE                      DPKCS017
201600             END-IF                                               DPKCS017
201700         ELSE                                                     DPKCS017
201800             MOVE DP015-RED         TO  DP017-SCR-FORMATC(PS-SUB)       17
201900             MOVE DP015-REVERSE     TO  DP017-SCR-FORMATH(PS-SUB)       17
202000             MOVE PC-CURSOR-POS     TO  DP017-SCR-FORMATL(PS-SUB)       17
202100             MOVE PC-TSYMSG-00260   TO  DP020-MSG-NUMBER                17
202200             SET PS-ERROR           TO  TRUE                            17
202300             SET DP020-MSG-FATAL    TO  TRUE                            17
202400         END-IF                                                         17
202500     END-IF.                                                      DPKCS017
202600                                                                  DPKCS017
202700     IF (DP017-SCR-ACTION(PS-SUB) = PC-GO-TO-MNEMONIC             DPKCS017
202800     OR  DP017-SCR-ACTION(PS-SUB) = PC-LOCAL-GOTO)                DPKCS017
202900                                                                  DPKCS017
203000         IF (DP017-SCR-STK(PS-SUB) NOT = PC-STACK                 DPKCS017
203100         AND DP017-SCR-STK(PS-SUB) NOT = PC-NO-STACK)             DPKCS017
203200             SET PS-ERROR           TO TRUE                             17
203300             SET DP020-MSG-FATAL    TO TRUE                             17
203400             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER                 17
203500             MOVE DP015-RED         TO DP017-SCR-STKC(PS-SUB)           17
203600             MOVE DP015-REVERSE     TO DP017-SCR-STKH(PS-SUB)           17
203700             MOVE PC-CURSOR-POS     TO DP017-SCR-STKL(PS-SUB)           17
203800         ELSE                                                           17
203900             MOVE DP017-SCR-MNEMONIC(PS-SUB)                            17
204000                                    TO PV-MNEMONIC                      17
204100             PERFORM Z100-SELECT-TMNEMONIC-ROW                    DPKCS017
204200             IF  SQLCODE = +0                                     DPKCS017
204300                 MOVE TMNEMONIC-TRANS-ID-CODE                           17
204400                                    TO DP017-TRAN-ID                    17
204500             ELSE                                                 DPKCS017
204600                 SET PS-ERROR       TO TRUE                             17
204700                 SET DP020-MSG-FATAL                              DPKCS017
204800                                    TO TRUE                             17
204900                 MOVE PC-TSYMSG-00148                             DPKCS017
205000                                    TO DP020-MSG-NUMBER                 17
205100                 MOVE DP015-RED     TO DP017-SCR-MNEMONICC(PS-SUB)DPKCS017
205200                 MOVE DP015-REVERSE TO DP017-SCR-MNEMONICH(PS-SUB)DPKCS017
205300                 MOVE PC-CURSOR-POS TO DP017-SCR-MNEMONICL(PS-SUB)      17
205400             END-IF                                               DPKCS017
205500         END-IF                                                   DPKCS017
205600                                                                  DPKCS017
205700     ELSE                                                         DPKCS017
205800                                                                  DPKCS017
205900         IF (DP017-SCR-ACTION(PS-SUB) = PC-LOCAL-FUNC-KEY)        DPKCS017
206000         OR (DP017-SCR-ACTION(PS-SUB) = PC-LOCAL-RETURN)          DPKCS017
206100         OR (DP017-SCR-ACTION(PS-SUB) = PC-SEL-ALL)               DPKCS017
206200         OR (DP017-SCR-ACTION(PS-SUB) = PC-FK-LEFT)               DPKCS017
206300         OR (DP017-SCR-ACTION(PS-SUB) = PC-FK-RIGHT)              DPKCS017
206400         OR (DP017-SCR-ACTION(PS-SUB) = PC-FK-PREV-SELECTION)     DPKCS017
206500         OR (DP017-SCR-ACTION(PS-SUB) = PC-FK-NEXT-SELECTION)     DPKCS017
206600                                                                  DPKCS017
206700             IF  DP017-SCR-STK(PS-SUB) NOT = SPACES               DPKCS017
206800                 SET PS-ERROR         TO TRUE                           17
206900                 SET DP020-MSG-FATAL  TO  TRUE                          17
207000                 MOVE PC-TSYMSG-00262 TO  DP020-MSG-NUMBER              17
207100                 MOVE DP015-RED       TO  DP017-SCR-STKC(PS-SUB)        17
207200                 MOVE DP015-REVERSE   TO  DP017-SCR-STKH(PS-SUB)        17
207300                 MOVE PC-CURSOR-POS   TO  DP017-SCR-STKL(PS-SUB)        17
207400             ELSE                                                 DPKCS017
207500                 MOVE DP017-SCR-MNEMONIC(PS-SUB) TO               DPKCS017
207600                          PV-MNEMONIC                             DPKCS017
207700                                                                  DPKCS017
207800                 PERFORM Z100-SELECT-TMNEMONIC-ROW                DPKCS017
207900                                                                  DPKCS017
208000                 IF  SQLCODE = +0                                 DPKCS017
208100                     SET PS-ERROR TO TRUE                         DPKCS017
208200                     MOVE PM-PROGRAM-MESSAGE-19 TO                DPKCS017
208300                              DP020-MSG-MESSAGE                   DPKCS017
208400                     MOVE DP015-RED                               DPKCS017
208500                               TO  DP017-SCR-MNEMONICC(PS-SUB)    DPKCS017
208600                     MOVE DP015-REVERSE                           DPKCS017
208700                               TO  DP017-SCR-MNEMONICH(PS-SUB)    DPKCS017
208800                     MOVE PC-CURSOR-POS                           DPKCS017
208900                               TO  DP017-SCR-MNEMONICL(PS-SUB)    DPKCS017
209000                 END-IF                                           DPKCS017
209100                                                                  DPKCS017
209200             END-IF                                               DPKCS017
209300                                                                  DPKCS017
209400         ELSE                                                     DPKCS017
209500                                                                  DPKCS017
209600             IF  ((DP017-SCR-ACTION(PS-SUB) =    PC-RETURN        DPKCS017
209700                                              OR PC-CONFIRM       DPKCS017
209800                                              OR PC-NAV-REFRESH   DPKCS017
209900                                              OR PC-PREVPAGE      DPKCS017
210000                                              OR PC-NEXTPAGE      DPKCS017
210100                                              OR PC-1ST-PAGE      DPKCS017
210200                                              OR PC-DSEL-ALL)     DPKCS017
210300             OR (DP017-SCR-ACTION(PS-SUB) ALPHABETIC              DPKCS017
210400             AND DP017-SCR-ACTION(PS-SUB) GREATER THAN PC-N)      DPKCS017
210500             AND PS-SUB GREATER THAN 12 AND LESS THAN 25)         DPKCS017
210600                                                                  DPKCS017
210700                 IF (TAIDKEY-STNRD-ACTION-CODE =                  DPKCS017
210800                     DP017-SCR-ACTION(PS-SUB)                     DPKCS017
210900                 OR (PS-SUB GREATER THAN 12 AND LESS THAN 25))    DPKCS017
211000                                                                  DPKCS017
211100                     MOVE DP017-SCR-MNEMONIC(PS-SUB) TO           DPKCS017
211200                          PV-MNEMONIC                             DPKCS017
211300                                                                  DPKCS017
211400                     PERFORM Z100-SELECT-TMNEMONIC-ROW            DPKCS017
211500                                                                  DPKCS017
211600                     IF  SQLCODE = +0                             DPKCS017
211700                         SET PS-ERROR TO TRUE                     DPKCS017
211800                         MOVE PM-PROGRAM-MESSAGE-19               DPKCS017
211900                               TO  DP020-MSG-MESSAGE              DPKCS017
212000                         MOVE DP015-RED                           DPKCS017
212100                               TO  DP017-SCR-MNEMONICC(PS-SUB)    DPKCS017
212200                         MOVE DP015-REVERSE                       DPKCS017
212300                               TO  DP017-SCR-MNEMONICH(PS-SUB)    DPKCS017
212400                         MOVE PC-CURSOR-POS                       DPKCS017
212500                               TO  DP017-SCR-MNEMONICL(PS-SUB)    DPKCS017
212600                     END-IF                                       DPKCS017
212700                 END-IF                                           DPKCS017
212800                                                                  DPKCS017
212900             ELSE                                                 DPKCS017
213000                 IF  PS-SUB GREATER THAN 12                       DPKCS017
213100                     MOVE PC-TSYMSG-00263                         DPKCS017
213200                                     TO DP020-MSG-NUMBER                17
213300                 ELSE                                             DPKCS017
213400                     MOVE PC-TSYMSG-00264                         DPKCS017
213500                                     TO DP020-MSG-NUMBER                17
213600                 END-IF                                           DPKCS017
213700                 SET DP020-MSG-FATAL TO TRUE                      DPKCS017
213800                 SET PS-ERROR        TO TRUE                            17
213900                 SET PS-EDITING-ACT  TO TRUE                            17
214000                 MOVE DP015-RED      TO DP017-SCR-SELC(PS-SUB)          17
214100                 MOVE DP015-REVERSE  TO DP017-SCR-SELH(PS-SUB)          17
214200                 MOVE PC-CURSOR-POS  TO DP017-SCR-SELL(PS-SUB)          17
214300             END-IF                                               DPKCS017
214400                                                                  DPKCS017
214500         END-IF                                                   DPKCS017
214600                                                                  DPKCS017
214700     END-IF.                                                      DPKCS017
214800                                                                  DPKCS017
214900     MOVE DP015-GREEN          TO  DP017-SCR-LABELC(PS-SUB).      DPKCS017
215000     MOVE DP015-UNDERLINE      TO  DP017-SCR-LABELH(PS-SUB).      DPKCS017
215100     MOVE PC-NO-CURSOR         TO  DP017-SCR-LABELL(PS-SUB).      DPKCS017
215200                                                                  DPKCS017
215300     IF  DP017-SCR-LABEL (PS-SUB) GREATER THAN SPACES             DPKCS017
215400         MOVE DP017-SCR-LABEL (PS-SUB)                            DPKCS017
215500                               TO  PV-LABEL                       DPKCS017
215600         PERFORM Z150-SELECT-TMNEMONIC-BY-LABEL                   DPKCS017
215700                                                                  DPKCS017
215800         IF  SQLCODE EQUAL ZERO                                         17
215900             SET PS-ERROR         TO TRUE                               17
216000             SET DP020-MSG-FATAL  TO TRUE                               17
216100             MOVE PC-CURSOR-POS   TO DP017-SCR-LABELL(PS-SUB)           17
216200             MOVE DP015-RED       TO DP017-SCR-LABELC(PS-SUB)           17
216300             MOVE DP015-REVERSE   TO DP017-SCR-LABELH(PS-SUB)           17
216400             MOVE PC-TSYMSG-00261 TO DP020-MSG-NUMBER                   17
216500         END-IF                                                   DPKCS017
216600                                                                  DPKCS017
216700     END-IF.                                                      DPKCS017
216800                                                                  DPKCS017
216900 EJECT                                                            DPKCS017
217000                                                                  DPKCS017
217100 F430-EDIT-WITH-NEW-DISP-FIELD.                                         17
217200******************************************************************DPKCS017
217300*    EDIT BASED ON WHAT WAS ENTERED IN THE 'ACTION' FIELD,        DPKCS017
217400*    IN COMBINATION WITH WHAT WAS ENTERED IN THE 'DISP' FIELD.          17
217500*                                                                       17
217600*    NEW 'DISP' FIELD EDITS:                                      DPKCS017
217700*    * REQUIRED IF 'ACTION' IS LOCAL-01 THRU LOCAL-12 (O THRU Z). DPKCS017
217800*    * CANNOT BE ENTERED IF 'ACTION' IS ANYTHING BUT LOCAL-01     DPKCS017
217900*      THRU LOCAL-12.                                             DPKCS017
218000*    * POSSIBLE VALUES: 'L', 'G', OR 'R' FOR 'LOCAL', 'GO', OR    DPKCS017
218100*      'RETURN' RESPECTIVELY.                                     DPKCS017
218200*                                                                 DPKCS017
218300*    * IF 'L' (LOCAL):                                            DPKCS017
218400*      * EDIT SIMILAR TO CURRENT 'LOCAL' KEY EDITS.               DPKCS017
218500*      * 'MNEMONIC', 'STACK', 'FMT IND' ARE NOT ALLOWED.          DPKCS017
218600*                                                                 DPKCS017
218700*    * IF 'G' (GO):                                               DPKCS017
218800*      * EDIT SHOULD BE SAME AS CURRENT 'LOCAL-GO' EDITS.         DPKCS017
218900*      * 'MNEMONIC' MUST BE ENTERED AND VALID.                    DPKCS017
219000*      * 'STACK IND' MUST BE 'Y' OR 'N'.                          DPKCS017
219100*      * 'FMT IND' IS ALLOWED.                                    DPKCS017
219200*                                                                 DPKCS017
219300*    * IF 'R' (RETURN):                                           DPKCS017
219400*      * SIMILAR TO CURRENT 'LOCAL-GO' EXCEPT A MNEMONIC MUST NOT DPKCS017
219500*        BE ENTERED.                                              DPKCS017
219600*      * CHANGE FROM CURRENT 'LOCAL-RETURN' EDITS IS THAT A FORMATDPKCS017
219700*        INDICATOR CAN BE ENTERED.  CURRENTLY, THE LOCAL-RETURN   DPKCS017
219800*        EDITS PROHIBIT THE ENTRY OF A FORMAT INDICATOR.          DPKCS017
219900*      * 'MNEMONIC' MUST NOT BE ENTERED.                          DPKCS017
220000*      * 'STACK IND' MUST NOT BE ENTERED.                         DPKCS017
220100******************************************************************DPKCS017
220200     MOVE DP015-GREEN            TO DP017-SCR-DISPC(PS-SUB).      DPKCS017
220300     MOVE DP015-UNDERLINE        TO DP017-SCR-DISPH(PS-SUB).      DPKCS017
220400     MOVE PC-NO-CURSOR           TO DP017-SCR-DISPL(PS-SUB).      DPKCS017
220500                                                                  DPKCS017
220600     IF  DP017-SCR-DISP(PS-SUB) = SPACES                                17
220700*        *********************************************************      17
220800*        * ENTRY IN DISP FIELD REQUIRED DUE TO VALUE IN                 17
220900*        * ACTION FIELD.                                                17
221000*        *********************************************************      17
221100         MOVE DP015-RED       TO  DP017-SCR-DISPC(PS-SUB)               17
221200         MOVE DP015-REVERSE   TO  DP017-SCR-DISPH(PS-SUB)               17
221300         MOVE PC-CURSOR-POS   TO  DP017-SCR-DISPL(PS-SUB)               17
221400         MOVE PC-TSYMSG-01222 TO  DP020-MSG-NUMBER                      17
221500         SET PS-ERROR         TO  TRUE                                  17
221600         SET DP020-MSG-FATAL  TO  TRUE                                  17
221700     ELSE                                                               17
221800         IF  DP017-SCR-DISP(PS-SUB) = PC-DISP-L-LOCAL                   17
221900             PERFORM F440-EDIT-FOR-DISP-LOCAL                           17
222000         ELSE                                                           17
222100             IF  DP017-SCR-DISP(PS-SUB) = PC-DISP-G-GO                  17
222200                 PERFORM F450-EDIT-FOR-DISP-GO                          17
222300             ELSE                                                       17
222400                 IF  DP017-SCR-DISP(PS-SUB) = PC-DISP-R-RETURN          17
222500                     PERFORM F460-EDIT-FOR-DISP-RETURN                  17
222600                 ELSE                                                   17
222700*                    *********************************************      17
222800*                    * INVALID ENTRY                                    17
222900*                    *********************************************      17
223000                     MOVE DP015-RED       TO DP017-SCR-DISPC            17
223100                                                          (PS-SUB)      17
223200                     MOVE DP015-REVERSE   TO DP017-SCR-DISPH            17
223300                                                          (PS-SUB)      17
223400                     MOVE PC-CURSOR-POS   TO DP017-SCR-DISPL            17
223500                                                          (PS-SUB)      17
223600                     MOVE PC-TSYMSG-00005 TO DP020-MSG-NUMBER           17
223700                     SET PS-ERROR         TO TRUE                       17
223800                     SET DP020-MSG-FATAL  TO TRUE                       17
223900                 END-IF                                                 17
224000             END-IF                                                     17
224100         END-IF                                                         17
224200     END-IF.                                                            17
224300 EJECT                                                            DPKCS017
224400                                                                  DPKCS017
224500 F440-EDIT-FOR-DISP-LOCAL.                                              17
224600******************************************************************DPKCS017
224700*    SPECIFIC EDITS FOR 'DISP' FIELD VALUE: LOCAL                 DPKCS017
224800*      * EDIT SIMILAR TO CURRENT 'LOCAL' KEY EDITS.               DPKCS017
224900*      * 'MNEMONIC', 'STACK', 'FMT IND' ARE NOT ALLOWED.          DPKCS017
225000******************************************************************DPKCS017
225100                                                                  DPKCS017
225200     IF DP017-SCR-MNEMONIC(PS-SUB) GREATER THAN SPACES                    
225300*        *********************************************************      17
225400*        * INVALID COMBINATION OF FIELDS ENTERED FOR CHOSEN             17
225500*        * FUNCTION:                                                    17
225600*        * NO ENTRY ALLOWED IN MNEMONIC FIELD DUE TO VALUE IN           17
225700*        * DISP FIELD.                                                  17
225800*        *********************************************************      17
225900         MOVE DP015-RED       TO  DP017-SCR-MNEMONICC(PS-SUB)           17
226000         MOVE DP015-REVERSE   TO  DP017-SCR-MNEMONICH(PS-SUB)           17
226100         MOVE PC-CURSOR-POS   TO  DP017-SCR-MNEMONICL(PS-SUB)           17
226200*        MOVE PC-TSYMSG-00831 TO  DP020-MSG-NUMBER                      17
226300         MOVE PC-TSYMSG-01223 TO  DP020-MSG-NUMBER                      17
226400         SET PS-ERROR         TO  TRUE                                  17
226500         SET DP020-MSG-FATAL  TO  TRUE                                  17
226600     END-IF.                                                              
226700                                                                          
226800     IF DP017-SCR-STK(PS-SUB) GREATER THAN SPACES                         
226900*        *********************************************************      17
227000*        * INVALID COMBINATION OF FIELDS ENTERED FOR CHOSEN             17
227100*        * FUNCTION:                                                    17
227200*        * NO ENTRY ALLOWED IN STACK FIELD DUE TO VALUE IN              17
227300*        * DISP FIELD.                                                  17
227400*        *********************************************************      17
227500         MOVE DP015-RED       TO  DP017-SCR-STKC(PS-SUB)                17
227600         MOVE DP015-REVERSE   TO  DP017-SCR-STKH(PS-SUB)                17
227700         MOVE PC-CURSOR-POS   TO  DP017-SCR-STKL(PS-SUB)                17
227800*        MOVE PC-TSYMSG-00831 TO  DP020-MSG-NUMBER                      17
227900*        MOVE PC-TSYMSG-01225 TO  DP020-MSG-NUMBER                      17
228000         MOVE PC-TSYMSG-00262 TO  DP020-MSG-NUMBER                      17
228100         SET PS-ERROR         TO  TRUE                                  17
228200         SET DP020-MSG-FATAL  TO  TRUE                                  17
228300     END-IF.                                                              
228400                                                                          
228500     IF DP017-SCR-FORMAT(PS-SUB) GREATER THAN SPACES                      
228600*        *********************************************************      17
228700*        * INVALID COMBINATION OF FIELDS ENTERED FOR CHOSEN             17
228800*        * FUNCTION:                                                    17
228900*        * NO ENTRY ALLOWED IN FORMAT FIELD DUE TO VALUE IN             17
229000*        * DISP FIELD.                                                  17
229100*        *********************************************************      17
229200         MOVE DP015-RED       TO  DP017-SCR-FORMATC(PS-SUB)             17
229300         MOVE DP015-REVERSE   TO  DP017-SCR-FORMATH(PS-SUB)             17
229400         MOVE PC-CURSOR-POS   TO  DP017-SCR-FORMATL(PS-SUB)             17
229500         MOVE PC-TSYMSG-01227 TO  DP020-MSG-NUMBER                      17
229600         SET PS-ERROR         TO  TRUE                                  17
229700         SET DP020-MSG-FATAL  TO  TRUE                                  17
229800     END-IF.                                                              
229900                                                                        17
230000     PERFORM F470-EDIT-THE-LABEL.                                       17
230100                                                                        17
230200 EJECT                                                            DPKCS017
230300                                                                  DPKCS017
230400 F450-EDIT-FOR-DISP-GO.                                                 17
230500******************************************************************DPKCS017
230600*    SPECIFIC EDITS FOR 'DISP' FIELD VALUE: GO                    DPKCS017
230700*      * EDIT SHOULD BE SAME AS CURRENT 'LOCAL-GO' EDITS.         DPKCS017
230800*      * 'MNEMONIC' MUST BE ENTERED AND VALID.                    DPKCS017
230900*      * 'STACK IND' MUST BE 'Y' OR 'N'.                          DPKCS017
231000*      * 'FMT IND' IS ALLOWED.                                    DPKCS017
231100******************************************************************DPKCS017
231200                                                                  DPKCS017
231300     IF  DP017-SCR-STK(PS-SUB) > SPACES                                 17
231400         IF  DP017-SCR-STK(PS-SUB) = PC-STACK                           17
231500         OR  DP017-SCR-STK(PS-SUB) = PC-NO-STACK                        17
231600             CONTINUE                                                   17
231700         ELSE                                                           17
231800*            *****************************************************      17
231900*            * INVALID ENTRY                                            17
232000*            *****************************************************      17
232100             MOVE DP015-RED       TO  DP017-SCR-STKC(PS-SUB)            17
232200             MOVE DP015-REVERSE   TO  DP017-SCR-STKH(PS-SUB)            17
232300             MOVE PC-CURSOR-POS   TO  DP017-SCR-STKL(PS-SUB)            17
232400             MOVE PC-TSYMSG-00005 TO  DP020-MSG-NUMBER                  17
232500             SET PS-ERROR         TO  TRUE                              17
232600             SET DP020-MSG-FATAL  TO  TRUE                              17
232700         END-IF                                                         17
232800     ELSE                                                               17
232900*        *********************************************************      17
233000*        * REQUIRED ENTRY                                               17
233100*        *********************************************************      17
233200         MOVE DP015-RED       TO  DP017-SCR-STKC(PS-SUB)                17
233300         MOVE DP015-REVERSE   TO  DP017-SCR-STKH(PS-SUB)                17
233400         MOVE PC-CURSOR-POS   TO  DP017-SCR-STKL(PS-SUB)                17
233500         MOVE PC-TSYMSG-00007 TO  DP020-MSG-NUMBER                      17
233600         SET PS-ERROR         TO  TRUE                                  17
233700         SET DP020-MSG-FATAL  TO  TRUE                                  17
233800     END-IF.                                                            17
233900                                                                        17
234000     MOVE DP017-SCR-MNEMONIC(PS-SUB)  TO PV-MNEMONIC.                   17
234100     IF  PV-MNEMONIC > SPACES                                           17
234200         PERFORM Z100-SELECT-TMNEMONIC-ROW                              17
234300         IF  SQLCODE = +0                                               17
234400             MOVE TMNEMONIC-TRANS-ID-CODE TO DP017-TRAN-ID              17
234500*?           SET PS-ERROR                 TO TRUE                       17
234600*?           MOVE PM-PROGRAM-MESSAGE-19   TO DP020-MSG-MESSAGE          17
234700*?           MOVE DP015-RED      TO  DP017-SCR-MNEMONICC(PS-SUB)        17
234800*?           MOVE DP015-REVERSE  TO  DP017-SCR-MNEMONICH(PS-SUB)        17
234900*?           MOVE PC-CURSOR-POS  TO  DP017-SCR-MNEMONICL(PS-SUB)        17
235000         ELSE                                                           17
235100*            *****************************************************      17
235200*            * MNEMONIC MUST BE VALID                                   17
235300*            *****************************************************      17
235400             SET PS-ERROR TO TRUE                                       17
235500             SET DP020-MSG-FATAL   TO  TRUE                             17
235600             MOVE PC-TSYMSG-00148  TO  DP020-MSG-NUMBER                 17
235700             MOVE DP015-RED        TO  DP017-SCR-MNEMONICC(PS-SUB)      17
235800             MOVE DP015-REVERSE    TO  DP017-SCR-MNEMONICH(PS-SUB)      17
235900             MOVE PC-CURSOR-POS    TO  DP017-SCR-MNEMONICL(PS-SUB)      17
236000         END-IF                                                         17
236100     ELSE                                                               17
236200*        *********************************************************      17
236300*        * MNEMONIC MUST BE ENTERED                                     17
236400*        *********************************************************      17
236500         MOVE DP015-RED       TO DP017-SCR-MNEMONICC(PS-SUB)            17
236600         MOVE DP015-REVERSE   TO DP017-SCR-MNEMONICH(PS-SUB)            17
236700         MOVE PC-CURSOR-POS   TO DP017-SCR-MNEMONICL(PS-SUB)            17
236800         MOVE PC-TSYMSG-01224 TO DP020-MSG-NUMBER                       17
236900         SET PS-ERROR         TO TRUE                                   17
237000         SET DP020-MSG-FATAL  TO TRUE                                   17
237100     END-IF.                                                            17
237200                                                                        17
237300     PERFORM F470-EDIT-THE-LABEL.                                       17
237400                                                                        17
237500 EJECT                                                            DPKCS017
237600                                                                  DPKCS017
237700 F460-EDIT-FOR-DISP-RETURN.                                             17
237800******************************************************************DPKCS017
237900*    SPECIFIC EDITS FOR 'DISP' FIELD VALUE: RETURN                DPKCS017
238000*      * SIMILAR TO CURRENT 'LOCAL-GO' EXCEPT A MNEMONIC MUST NOT DPKCS017
238100*        BE ENTERED.                                              DPKCS017
238200*      * CHANGE FROM CURRENT 'LOCAL-RETURN' EDITS IS THAT A FORMATDPKCS017
238300*        INDICATOR CAN BE ENTERED.  CURRENTLY, THE LOCAL-RETURN   DPKCS017
238400*        EDITS PROHIBIT THE ENTRY OF A FORMAT INDICATOR.          DPKCS017
238500*      * 'MNEMONIC' MUST NOT BE ENTERED.                          DPKCS017
238600*      * 'STACK IND' MUST NOT BE ENTERED.                         DPKCS017
238700******************************************************************DPKCS017
238800                                                                  DPKCS017
238900     IF  DP017-SCR-MNEMONIC(PS-SUB)  >  SPACES                          17
239000*        *********************************************************      17
239100*        * INVALID COMBINATION OF FIELDS ENTERED FOR                    17
239200*        * CHOSEN FUNCTION:                                             17
239300*        * MNEMONIC MUST NOT BE ENTERED FOR DISPOSITION R.              17
239400*        *********************************************************      17
239500         MOVE DP015-RED       TO DP017-SCR-MNEMONICC(PS-SUB)            17
239600         MOVE DP015-REVERSE   TO DP017-SCR-MNEMONICH(PS-SUB)            17
239700         MOVE PC-CURSOR-POS   TO DP017-SCR-MNEMONICL(PS-SUB)            17
239800         MOVE PC-TSYMSG-01223 TO DP020-MSG-NUMBER                       17
239900         SET PS-ERROR         TO TRUE                                   17
240000         SET DP020-MSG-FATAL  TO TRUE                                   17
240100     END-IF.                                                            17
240200                                                                        17
240300     IF  DP017-SCR-STK(PS-SUB)  >  SPACES                               17
240400*        *********************************************************DPKCS017
240500*        * INVALID COMBINATION OF FIELDS ENTERED FOR                    17
240600*        * CHOSEN FUNCTION:                                             17
240700*        * STACK MUST NOT BE ENTERED FOR DISPOSITION R.                 17
240800*        *********************************************************DPKCS017
240900         MOVE DP015-RED       TO DP017-SCR-STKC (PS-SUB)                17
241000         MOVE DP015-REVERSE   TO DP017-SCR-STKH (PS-SUB)                17
241100         MOVE PC-CURSOR-POS   TO DP017-SCR-STKL (PS-SUB)                17
241200         MOVE PC-TSYMSG-01225 TO DP020-MSG-NUMBER                       17
241300         SET PS-ERROR         TO TRUE                                   17
241400         SET DP020-MSG-FATAL  TO TRUE                                   17
241500      END-IF.                                                           17
241600                                                                  DPKCS017
241700     PERFORM F470-EDIT-THE-LABEL.                                       17
241800                                                                        17
241900 EJECT                                                            DPKCS017
242000                                                                        17
242100 F470-EDIT-THE-LABEL.                                                   17
242200******************************************************************DPKCS017
242300*    EDIT THE LABEL.                                              DPKCS017
242400******************************************************************DPKCS017
242500     MOVE DP015-GREEN            TO  DP017-SCR-LABELC(PS-SUB).          17
242600     MOVE DP015-UNDERLINE        TO  DP017-SCR-LABELH(PS-SUB).          17
242700     MOVE PC-NO-CURSOR           TO  DP017-SCR-LABELL(PS-SUB).          17
242800                                                                        17
242900     IF  DP017-SCR-LABEL (PS-SUB) GREATER THAN SPACES                   17
243000         MOVE DP017-SCR-LABEL (PS-SUB)                                  17
243100                                 TO  PV-LABEL                           17
243200         PERFORM Z150-SELECT-TMNEMONIC-BY-LABEL                         17
243300                                                                        17
243400         IF  SQLCODE EQUAL ZERO                                         17
243500             SET PS-ERROR         TO TRUE                               17
243600             SET DP020-MSG-FATAL  TO TRUE                               17
243700             MOVE PC-CURSOR-POS   TO DP017-SCR-LABELL(PS-SUB)           17
243800             MOVE DP015-RED       TO DP017-SCR-LABELC(PS-SUB)           17
243900             MOVE DP015-REVERSE   TO DP017-SCR-LABELH(PS-SUB)           17
244000             MOVE PC-TSYMSG-00261 TO DP020-MSG-NUMBER                   17
244100         END-IF                                                   DPKCS017
244200     ELSE                                                               17
244300*        *********************************************************DPKCS017
244400*        * REQUIRED ENTRY                                               17
244500*        *********************************************************DPKCS017
244600         SET PS-ERROR TO TRUE                                           17
244700         SET DP020-MSG-FATAL  TO TRUE                                   17
244800         MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER                       17
244900         MOVE DP015-RED       TO DP017-SCR-LABELC(PS-SUB)               17
245000         MOVE DP015-REVERSE   TO DP017-SCR-LABELH(PS-SUB)               17
245100         MOVE PC-CURSOR-POS   TO DP017-SCR-LABELL(PS-SUB)               17
245200     END-IF.                                                            17
245300                                                                        17
245400 EJECT                                                            DPKCS017
245500                                                                        17
245600 F500-UPDATE-TSQB.                                                DPKCS017
245700******************************************************************DPKCS017
245800*    AFTER AN ADD, UPDATE, OR DELETE, UPDATE THE INTER APPLICATIONDPKCS017
245900*    COMMAREA WITH THE MAINTENANCE RESULT.                        DPKCS017
246000*                                                                 DPKCS017
246100*    PERFORMED BY D300-LOCAL-FKEY-CONTROL.                        DPKCS017
246200******************************************************************DPKCS017
246300                                                                  DPKCS017
246400     IF  PV-REWRITE                                               DPKCS017
246500         IF  DP017-USE-TSQB                                       DPKCS017
246600             PERFORM D700-READ-TSQB-QUEUE                         DPKCS017
246700             SET DP002-UPD (DP017-MN-SUB)                         DPKCS017
246800                               TO  TRUE                           DPKCS017
246900             PERFORM D800-REWRITE-TSQB-QUEUE                      DPKCS017
247000         ELSE                                                     DPKCS017
247100             SET DP055-UPDATED TO  TRUE                           DPKCS017
247200             MOVE INTER-APPL-COMM-AREA                            DPKCS017
247300                               TO  DP017-HOLD-INTER-APPL-COMMAREA DPKCS017
247400         END-IF                                                   DPKCS017
247500     END-IF.                                                      DPKCS017
247600                                                                  DPKCS017
247700 EJECT                                                            DPKCS017
247800                                                                  DPKCS017
247900 G100-LOOP-TO-POPULATE-SCREEN.                                    DPKCS017
248000******************************************************************DPKCS017
248100*    * READ THROUGH THE ENTIRE TAIDKEY TABLE, AND THE APPROPRIATE DPKCS017
248200*      ROWS ON THE TCICSROUTE TABLE.                                    17
248300*    * MOVE THE INFORMATION FROM BOTH TABLES TO THE COMMAREA.           17
248400******************************************************************DPKCS017
248500                                                                  DPKCS017
248600     MOVE TAIDKEY-AID-SEQUENCE-NMBR TO PS-SUB.                    DPKCS017
248700                                                                  DPKCS017
248800     PERFORM H100-POPULATE-SCR-COMMAREA.                          DPKCS017
248900     PERFORM Z300-FETCH-TAIDKEY-CURSOR.                           DPKCS017
249000 EJECT                                                            DPKCS017
249100                                                                  DPKCS017
249200 G200-MOVE-COMMAREA-TO-SCREEN.                                    DPKCS017
249300******************************************************************DPKCS017
249400*    MOVE DATA FROM THE COMMAREA TO THE SCREEN.                   DPKCS017
249500*                                                                 DPKCS017
249600*    PERFORMED BY F200-DISPLAY-PANEL.                             DPKCS017
249700******************************************************************DPKCS017
249800                                                                  DPKCS017
249900     MOVE DP017-SCREEN-TRAN-ID        TO DPKM017-ATRANIDI.        DPKCS017
250000     MOVE DP017-SCREEN-MNEMONIC       TO DPKM017-AMNOMICI.        DPKCS017
250100     MOVE DP017-SCREEN-MNEMONIC-TITLE TO DPKM017-ANAMEI.          DPKCS017
250200                                                                  DPKCS017
250300     IF   DP017-SCR-SUB LESS THAN PC-MAX-FKEYS                    DPKCS017
250400         CONTINUE                                                 DPKCS017
250500     ELSE                                                         DPKCS017
250600         SUBTRACT PC-MAX-ITEMS-ON-SCREEN                          DPKCS017
250700                             FROM  DP017-SCR-SUB                  DPKCS017
250800     END-IF.                                                      DPKCS017
250900     MOVE DP017-SCR-SUB        TO  PV-HOLD-SCR-SUB.               DPKCS017
251000                                                                  DPKCS017
251100     PERFORM                                                      DPKCS017
251200         VARYING PS-SUB FROM 1 BY 1                               DPKCS017
251300         UNTIL PS-SUB > PC-MAX-ITEMS-ON-SCREEN                    DPKCS017
251400                                                                  DPKCS017
251500         IF  DP017-SCR-SUB GREATER PC-MAX-FKEYS                   DPKCS017
251600             MOVE SPACES       TO  DPKM017-ASELI  (PS-SUB)        DPKCS017
251700                                   DPKM017-AFKEYI (PS-SUB)        DPKCS017
251800                                   DPKM017-ASTATI (PS-SUB)        DPKCS017
251900                                   DPKM017-AACTI  (PS-SUB)        DPKCS017
252000                                   DPKM017-AACTDI (PS-SUB)        DPKCS017
252100                                   DPKM017-ADISPI (PS-SUB)        DPKCS017
252200                                   DPKM017-ALABLI (PS-SUB)        DPKCS017
252300                                   DPKM017-AMNEMI (PS-SUB)        DPKCS017
252400                                   DPKM017-AFORMI (PS-SUB)        DPKCS017
252500                                   DPKM017-ASTKI  (PS-SUB)        DPKCS017
252600             MOVE DP015-ASK-NOR-OFF                               DPKCS017
252700                               TO  DPKM017-ASELA  (PS-SUB)        DPKCS017
252800                                   DPKM017-AACTA  (PS-SUB)        DPKCS017
252900                                   DPKM017-ADISPA (PS-SUB)        DPKCS017
253000                                   DPKM017-ALABLA (PS-SUB)        DPKCS017
253100                                   DPKM017-AMNEMA (PS-SUB)        DPKCS017
253200                                   DPKM017-AFORMA (PS-SUB)        DPKCS017
253300                                   DPKM017-ASTKA  (PS-SUB)        DPKCS017
253400             MOVE DP015-HL-OFF                                    DPKCS017
253500                               TO  DPKM017-ASELH  (PS-SUB)        DPKCS017
253600                                   DPKM017-AACTH  (PS-SUB)        DPKCS017
253700                                   DPKM017-ADISPH (PS-SUB)        DPKCS017
253800                                   DPKM017-ALABLH (PS-SUB)        DPKCS017
253900                                   DPKM017-AMNEMH (PS-SUB)        DPKCS017
254000                                   DPKM017-AFORMH (PS-SUB)        DPKCS017
254100                                   DPKM017-ASTKH  (PS-SUB)        DPKCS017
254200         ELSE                                                     DPKCS017
254300             MOVE DP017-SCR-SEL(DP017-SCR-SUB)                    DPKCS017
254400                               TO  DPKM017-ASELI(PS-SUB)          DPKCS017
254500             MOVE DP017-SCR-SELA(DP017-SCR-SUB)                   DPKCS017
254600                               TO  DPKM017-ASELA(PS-SUB)          DPKCS017
254700             MOVE DP017-SCR-SELH(DP017-SCR-SUB)                   DPKCS017
254800                               TO  DPKM017-ASELH(PS-SUB)          DPKCS017
254900             MOVE DP017-SCR-SELC(DP017-SCR-SUB)                   DPKCS017
255000                               TO  DPKM017-ASELC(PS-SUB)          DPKCS017
255100             MOVE DP017-SCR-SELL(DP017-SCR-SUB)                   DPKCS017
255200                               TO  DPKM017-ASELL(PS-SUB)          DPKCS017
255300                                                                  DPKCS017
255400             MOVE DP017-SCR-TAG(DP017-SCR-SUB)                    DPKCS017
255500                               TO  DPKM017-AFKEYI (PS-SUB)        DPKCS017
255600                                                                  DPKCS017
255700             MOVE DP017-SCR-STATUS(DP017-SCR-SUB)                 DPKCS017
255800                               TO  DPKM017-ASTATI (PS-SUB)        DPKCS017
255900                                                                  DPKCS017
256000             MOVE DP017-SCR-ACTION(DP017-SCR-SUB)                 DPKCS017
256100                               TO  DPKM017-AACTI  (PS-SUB)        DPKCS017
256200             MOVE DP017-SCR-ACTIONA(DP017-SCR-SUB)                DPKCS017
256300                               TO  DPKM017-AACTA  (PS-SUB)        DPKCS017
256400             MOVE DP017-SCR-ACTIONH(DP017-SCR-SUB)                DPKCS017
256500                               TO  DPKM017-AACTH  (PS-SUB)        DPKCS017
256600             MOVE DP017-SCR-ACTIONC(DP017-SCR-SUB)                DPKCS017
256700                               TO  DPKM017-AACTC  (PS-SUB)        DPKCS017
256800             MOVE DP017-SCR-ACTIONL(DP017-SCR-SUB)                DPKCS017
256900                               TO  DPKM017-AACTL  (PS-SUB)        DPKCS017
257000                                                                  DPKCS017
257100             MOVE DP017-SCR-ACTION-DESC(DP017-SCR-SUB)            DPKCS017
257200                               TO  DPKM017-AACTDI (PS-SUB)        DPKCS017
257300                                                                  DPKCS017
257400             MOVE DP017-SCR-DISP (DP017-SCR-SUB)                  DPKCS017
257500                               TO  DPKM017-ADISPI (PS-SUB)        DPKCS017
257600             MOVE DP017-SCR-DISPA (DP017-SCR-SUB)                 DPKCS017
257700                               TO  DPKM017-ADISPA (PS-SUB)        DPKCS017
257800             MOVE DP017-SCR-DISPH (DP017-SCR-SUB)                 DPKCS017
257900                               TO  DPKM017-ADISPH (PS-SUB)        DPKCS017
258000             MOVE DP017-SCR-DISPC (DP017-SCR-SUB)                 DPKCS017
258100                               TO  DPKM017-ADISPC (PS-SUB)        DPKCS017
258200             MOVE DP017-SCR-DISPL (DP017-SCR-SUB)                 DPKCS017
258300                               TO  DPKM017-ADISPL (PS-SUB)        DPKCS017
258400                                                                  DPKCS017
258500             MOVE DP017-SCR-LABEL(DP017-SCR-SUB)                  DPKCS017
258600                               TO  DPKM017-ALABLI (PS-SUB)        DPKCS017
258700             MOVE DP017-SCR-LABELA(DP017-SCR-SUB)                 DPKCS017
258800                               TO  DPKM017-ALABLA (PS-SUB)        DPKCS017
258900             MOVE DP017-SCR-LABELH(DP017-SCR-SUB)                 DPKCS017
259000                               TO  DPKM017-ALABLH (PS-SUB)        DPKCS017
259100             MOVE DP017-SCR-LABELC(DP017-SCR-SUB)                 DPKCS017
259200                               TO  DPKM017-ALABLC (PS-SUB)        DPKCS017
259300             MOVE DP017-SCR-LABELL(DP017-SCR-SUB)                 DPKCS017
259400                               TO  DPKM017-ALABLL (PS-SUB)        DPKCS017
259500                                                                  DPKCS017
259600             MOVE DP017-SCR-MNEMONIC(DP017-SCR-SUB)               DPKCS017
259700                               TO  DPKM017-AMNEMI (PS-SUB)        DPKCS017
259800             MOVE DP017-SCR-MNEMONICA(DP017-SCR-SUB)              DPKCS017
259900                               TO  DPKM017-AMNEMA (PS-SUB)        DPKCS017
260000             MOVE DP017-SCR-MNEMONICH(DP017-SCR-SUB)              DPKCS017
260100                               TO  DPKM017-AMNEMH (PS-SUB)        DPKCS017
260200             MOVE DP017-SCR-MNEMONICC(DP017-SCR-SUB)              DPKCS017
260300                               TO  DPKM017-AMNEMC (PS-SUB)        DPKCS017
260400             MOVE DP017-SCR-MNEMONICL(DP017-SCR-SUB)              DPKCS017
260500                               TO  DPKM017-AMNEML (PS-SUB)        DPKCS017
260600                                                                  DPKCS017
260700             MOVE DP017-SCR-FORMAT(DP017-SCR-SUB)                 DPKCS017
260800                               TO  DPKM017-AFORMI (PS-SUB)        DPKCS017
260900             MOVE DP017-SCR-FORMATA(DP017-SCR-SUB)                DPKCS017
261000                               TO  DPKM017-AFORMA (PS-SUB)        DPKCS017
261100             MOVE DP017-SCR-FORMATH(DP017-SCR-SUB)                DPKCS017
261200                               TO  DPKM017-AFORMH (PS-SUB)        DPKCS017
261300             MOVE DP017-SCR-FORMATC(DP017-SCR-SUB)                DPKCS017
261400                               TO  DPKM017-AFORMC (PS-SUB)        DPKCS017
261500             MOVE DP017-SCR-FORMATL(DP017-SCR-SUB)                DPKCS017
261600                               TO  DPKM017-AFORML (PS-SUB)        DPKCS017
261700                                                                  DPKCS017
261800             MOVE DP017-SCR-STK(DP017-SCR-SUB)                    DPKCS017
261900                               TO  DPKM017-ASTKI  (PS-SUB)        DPKCS017
262000             MOVE DP017-SCR-STKA(DP017-SCR-SUB)                   DPKCS017
262100                               TO  DPKM017-ASTKA  (PS-SUB)        DPKCS017
262200             MOVE DP017-SCR-STKH(DP017-SCR-SUB)                   DPKCS017
262300                               TO  DPKM017-ASTKH  (PS-SUB)        DPKCS017
262400             MOVE DP017-SCR-STKC(DP017-SCR-SUB)                   DPKCS017
262500                               TO  DPKM017-ASTKC  (PS-SUB)        DPKCS017
262600             MOVE DP017-SCR-STKL(DP017-SCR-SUB)                   DPKCS017
262700                               TO  DPKM017-ASTKL  (PS-SUB)        DPKCS017
262800                                                                  DPKCS017
262900         END-IF                                                   DPKCS017
263000                                                                  DPKCS017
263100         ADD 1                 TO  DP017-SCR-SUB                  DPKCS017
263200                                                                  DPKCS017
263300     END-PERFORM.                                                 DPKCS017
263400                                                                  DPKCS017
263500     MOVE PV-HOLD-SCR-SUB      TO  DP017-SCR-SUB.                 DPKCS017
263600                                                                  DPKCS017
263700 EJECT                                                            DPKCS017
263800 H100-POPULATE-SCR-COMMAREA.                                      DPKCS017
263900******************************************************************DPKCS017
264000*    * SETUP SCREEN ATTRIBUTES BASED ON VALUES IN THE                   17
264100*      TAIDKEY TABLE.                                                   17
264200*                                                                 DPKCS017
264300*    * SELECT THE ROW FROM THE TCICSROUTE TABLE THAT MATCHES THE        17
264400*      CURRENT FUNCTION KEY AND THE SCREEN MNEMONIC.                    17
264500*      * IF THE ROW IS FOUND:                                           17
264600*        1) SET THE 'ACTIVE' SWITCH ON.                                 17
264700*        2) POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM             17
264800*           THE TCICSROUTE TABLE.                                       17
264900*      * IF THE ROW IS NOT FOUND:                                       17
265000*        1) SET THE 'ACTIVE' SWITCH OFF.                                17
265100*        2) POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM             17
265200*           THE TAIDKEY TABLE.                                          17
265300*                                                                       17
265400*    PERFORMED BY E200-CHECK-FIELDS-FOR-ENTRY.                    DPKCS017
265500*    PERFORMED BY E300-PROCESS-DELETES.                           DPKCS017
265600*    PERFORMED BY G100-LOOP-TO-POPULATE-SCREEN.                   DPKCS017
265700******************************************************************DPKCS017
265800                                                                  DPKCS017
265900     MOVE DP015-GREEN          TO  DP017-SCR-SELC(PS-SUB)               17
266000                                   DP017-SCR-STKC(PS-SUB)               17
266100                                   DP017-SCR-FORMATC(PS-SUB)            17
266200                                   DP017-SCR-LABELC(PS-SUB)             17
266300                                   DP017-SCR-DISPC(PS-SUB)              17
266400                                   DP017-SCR-ACTIONC(PS-SUB)            17
266500                                   DP017-SCR-MNEMONICC(PS-SUB).         17
266600                                                                  DPKCS017
266700     IF  TAIDKEY-SYSWIDE-USE-INDCT EQUAL PC-SYSWIDE               DPKCS017
266800*        *********************************************************DPKCS017
266900*        * THIS FKEY IS USED SYSTEM-WIDE;                         DPKCS017
267000*        * ITS CHARACTERISTICS CANNOT BE CHANGED;                 DPKCS017
267100*        * PROTECT ITS SELECTION FIELD.                           DPKCS017
267200*        *********************************************************DPKCS017
267300         MOVE DP015-ASK-DRK-OFF                                   DPKCS017
267400                               TO  DP017-SCR-SELA(PS-SUB)               17
267500         MOVE DP015-HL-OFF     TO  DP017-SCR-SELH(PS-SUB)               17
267600     ELSE                                                         DPKCS017
267700*        *********************************************************DPKCS017
267800*        * ALLOW THIS FKEY TO BE SELECTED FOR ADD/UPDATE OR DELETEDPKCS017
267900*        *********************************************************DPKCS017
268000         MOVE DP015-UNP-ALP-NOR-OFF                               DPKCS017
268100                               TO  DP017-SCR-SELA(PS-SUB)               17
268200         MOVE DP015-UNDERLINE  TO  DP017-SCR-SELH(PS-SUB)               17
268300     END-IF.                                                      DPKCS017
268400                                                                  DPKCS017
268500     IF  TAIDKEY-MNDTRY-MNMNC-INDCT EQUAL PC-MNDTRY               DPKCS017
268600*        *********************************************************DPKCS017
268700*        * THIS FKEY, WHEN USED, HAS PRE-DEFINED (MANDATORY)      DPKCS017
268800*        * CHARACTERISTICS WHICH CANNOT BE CHANGED;                     17
268900*        * PROTECT THE FIELDS FOR THESE CHARACTERISTICS.          DPKCS017
269000*        *********************************************************DPKCS017
269100         MOVE DP015-ASK-NOR-OFF TO  DP017-SCR-STKA(PS-SUB)              17
269200                                    DP017-SCR-FORMATA(PS-SUB)           17
269300                                    DP017-SCR-LABELA(PS-SUB)            17
269400                                    DP017-SCR-DISPA(PS-SUB)             17
269500                                    DP017-SCR-ACTIONA(PS-SUB)           17
269600                                    DP017-SCR-MNEMONICA(PS-SUB)         17
269700                                                                  DPKCS017
269800         MOVE DP015-HL-OFF      TO  DP017-SCR-STKH(PS-SUB)              17
269900                                    DP017-SCR-FORMATH(PS-SUB)           17
270000                                    DP017-SCR-LABELH(PS-SUB)            17
270100                                    DP017-SCR-DISPH(PS-SUB)             17
270200                                    DP017-SCR-ACTIONH(PS-SUB)           17
270300                                    DP017-SCR-MNEMONICH(PS-SUB)         17
270400                                                                  DPKCS017
270500         MOVE DP015-BLUE        TO  DP017-SCR-ACTIONC(PS-SUB)           17
270600                                    DP017-SCR-DISPC(PS-SUB)             17
270700                                    DP017-SCR-STKC(PS-SUB)              17
270800                                    DP017-SCR-FORMATC(PS-SUB)           17
270900                                    DP017-SCR-LABELC(PS-SUB)            17
271000                                    DP017-SCR-MNEMONICC(PS-SUB)         17
271100     ELSE                                                               17
271200*        *********************************************************DPKCS017
271300*        * ALLOW THESE CHARACTERISTICS TO BE CHANGED              DPKCS017
271400*        *********************************************************DPKCS017
271500         MOVE DP015-UNP-ALP-NOR-OFF                                     17
271600                                TO  DP017-SCR-STKA(PS-SUB)              17
271700                                    DP017-SCR-FORMATA(PS-SUB)           17
271800                                    DP017-SCR-DISPA(PS-SUB)             17
271900                                    DP017-SCR-LABELA(PS-SUB)            17
272000                                    DP017-SCR-ACTIONA(PS-SUB)           17
272100                                    DP017-SCR-MNEMONICA(PS-SUB)         17
272200         MOVE DP015-UNDERLINE   TO  DP017-SCR-STKH(PS-SUB)              17
272300                                    DP017-SCR-FORMATH(PS-SUB)           17
272400                                    DP017-SCR-LABELH(PS-SUB)            17
272500                                    DP017-SCR-ACTIONH(PS-SUB)           17
272600                                    DP017-SCR-DISPH(PS-SUB)             17
272700                                    DP017-SCR-MNEMONICH(PS-SUB)         17
272800     END-IF.                                                      DPKCS017
272900                                                                  DPKCS017
273000     MOVE TAIDKEY-AID-KEY-NAME TO  DP017-SCR-TAG(PS-SUB).         DPKCS017
273100                                                                  DPKCS017
273200******************************************************************DPKCS017
273300*    * SELECT THE ROW FROM THE TCICSROUTE TABLE THAT MATCHES THE        17
273400*      CURRENT FUNCTION KEY AND THE SCREEN MNEMONIC.                    17
273500*    * IF THE ROW IS FOUND:                                             17
273600*      1) SET THE 'ACTIVE' SWITCH ON.                                   17
273700*      2) MOVE POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM          17
273800*         THE TCICSROUTE TABLE.                                         17
273900*    * IF THE ROW IS NOT FOUND:                                         17
274000*      1) SET THE 'ACTIVE' SWITCH OFF.                                  17
274100*      2) MOVE POPULATE THIS FKEY ON THE SCREEN WITH DATA FROM          17
274200*         THE TAIDKEY TABLE.                                            17
274300******************************************************************DPKCS017
274400     PERFORM Z500-SELECT-TCICSROUTE-ROW.                          DPKCS017
274500     IF SQLCODE = +0                                                    17
274600         MOVE PC-STATUS-ACTIVE TO  DP017-SCR-STATUS(PS-SUB)             17
274700         PERFORM H120-MOVE-ROUTE-TO-COMMAREA                            17
274800     ELSE                                                               17
274900         MOVE SPACES           TO  DP017-SCR-STATUS(PS-SUB)             17
275000         PERFORM H110-MOVE-AID-TO-COMMAREA                              17
275100     END-IF.                                                            17
275200     EJECT                                                        DPKCS017
275300                                                                  DPKCS017
275400 H110-MOVE-AID-TO-COMMAREA.                                       DPKCS017
275500******************************************************************DPKCS017
275600*    MOVE DATA FROM THE TAIDKEY ROW TO THE COMMAREA.              DPKCS017
275700*    (THIS ROW WAS NOT FOUND ON THE TCICSROUTE TABLE,                   17
275800*     SO POPULATE THE SCREEN WITH INFORMATION FROM TAIDKEY.)            17
275900******************************************************************DPKCS017
276000                                                                  DPKCS017
276100     MOVE TAIDKEY-STNRD-ACTION-CODE                               DPKCS017
276200                               TO  DP017-SCR-ACTION(PS-SUB)             17
276300                                   PV-FIND-ACT.                         17
276400     PERFORM J100-GET-ACTION-DESCRIPTION.                               17
276500                                                                  DPKCS017
276600     IF  IV-MNEMONIC-CODE NOT EQUAL PC-NULL-INDICATOR             DPKCS017
276700         MOVE TAIDKEY-MNEMONIC-CODE                               DPKCS017
276800                               TO  DP017-SCR-LABEL(PS-SUB)        DPKCS017
276900     END-IF.                                                      DPKCS017
277000                                                                  DPKCS017
277100     IF  ((TAIDKEY-STNRD-ACTION-CODE = PC-GO-TO-MNEMONIC)         DPKCS017
277200       OR (TAIDKEY-STNRD-ACTION-CODE = PC-LOCAL-GOTO))            DPKCS017
277300         MOVE PC-STACK TO DP017-SCR-STK(PS-SUB)                   DPKCS017
277400         MOVE DP017-SCR-LABEL (PS-SUB)                            DPKCS017
277500                               TO DP017-SCR-MNEMONIC (PS-SUB)     DPKCS017
277600         MOVE SPACE            TO DP017-SCR-LABEL (PS-SUB)        DPKCS017
277700     ELSE                                                         DPKCS017
277800         MOVE SPACES           TO DP017-SCR-STK(PS-SUB)                 17
277900     END-IF.                                                      DPKCS017
278000                                                                  DPKCS017
278100 EJECT                                                            DPKCS017
278200 H120-MOVE-ROUTE-TO-COMMAREA.                                     DPKCS017
278300******************************************************************DPKCS017
278400*    MOVE DATA FROM THE TCICSROUTE ROW TO THE COMMAREA.           DPKCS017
278500******************************************************************DPKCS017
278600     MOVE TCICSROUTE-ACTION-CODE        TO                              17
278700                                       DP017-SCR-ACTION(PS-SUB)         17
278800                                       PV-FIND-ACT                      17
278900     PERFORM J100-GET-ACTION-DESCRIPTION                                17
279000     MOVE TCICSROUTE-FUNC-KY-DISPN-IND  TO                              17
279100                                       DP017-SCR-DISP(PS-SUB).          17
279200     MOVE TCICSROUTE-FUNC-KEY-LBL-NAME  TO                              17
279300                                       DP017-SCR-LABEL(PS-SUB).         17
279400     MOVE TCICSROUTE-DEST-MNEMONIC-CODE TO                              17
279500                                       DP017-SCR-MNEMONIC(PS-SUB).      17
279600     MOVE TCICSROUTE-IN-APLCTN-COMM-CDE TO                              17
279700                                       DP017-SCR-FORMAT(PS-SUB).        17
279800     MOVE TCICSROUTE-ROUTE-STACK-INDCT  TO                              17
279900                                       DP017-SCR-STK(PS-SUB).           17
280000     PERFORM Y100-REFORMAT-TIMESTAMP-SHORT.                             17
280100 EJECT                                                            DPKCS017
280200                                                                  DPKCS017
280300 J100-GET-ACTION-DESCRIPTION.                                           17
280400******************************************************************DPKCS017
280500*    SEARCH THE PROGRAM TABLE IN WORKING STORAGE FOR THE          DPKCS017
280600*    DESCRIPTION WHICH CORRESPONDS TO THE THE CURRENT "ACTION"    DPKCS017
280700*    FROM THE DB2 TAIDKEY TABLE -OR- THE DB2 TCICSROUTE TABLE           17
280800*    (AS STORED IN PV-FIND-ACT BEFORE CALLING THIS PARAGRAPH).          17
280900*                                                                       17
281000*    SEARCH USING PS-SUB (01 - 29)                                      17
281100******************************************************************DPKCS017
281200     SET PT-FT-IND TO  1.                                               17
281300     SEARCH PT-FKEY-TABLE                                               17
281400       VARYING PT-FT-IND                                                17
281500         WHEN PT-FT-ACT(PT-FT-IND) = PV-FIND-ACT                        17
281600              MOVE PT-FT-DESC (PT-FT-IND)                               17
281700                               TO  DP017-SCR-ACTION-DESC(PS-SUB)        17
281800         WHEN PT-FT-ACT(PT-FT-IND) = HIGH-VALUE                         17
281900              MOVE SPACES      TO  DP017-SCR-ACTION-DESC(PS-SUB)        17
282000         END-SEARCH.                                              DPKCS017
282100 EJECT                                                            DPKCS017
282200                                                                  DPKCS017
282300 J110-GET-ACTION-DESCRIPTION.                                           17
282400******************************************************************DPKCS017
282500*    SEARCH THE PROGRAM TABLE IN WORKING STORAGE FOR THE          DPKCS017
282600*    DESCRIPTION WHICH CORRESPONDS TO THE THE CURRENT "ACTION"    DPKCS017
282700*    FROM THE DB2 TAIDKEY TABLE -OR- THE DB2 TCICSROUTE TABLE           17
282800*    (AS STORED IN PV-FIND-ACT BEFORE CALLING THIS PARAGRAPH).          17
282900*                                                                       17
283000*    SEARCH USING DP017-SCR-SUB (01 - 12)                               17
283100******************************************************************DPKCS017
283200     SET PT-FT-IND TO  1.                                               17
283300     SEARCH PT-FKEY-TABLE                                               17
283400       VARYING PT-FT-IND                                                17
283500         WHEN PT-FT-ACT(PT-FT-IND) = PV-FIND-ACT                        17
283600              MOVE PT-FT-DESC (PT-FT-IND)                               17
283700                          TO DP017-SCR-ACTION-DESC(DP017-SCR-SUB)       17
283800         WHEN PT-FT-ACT(PT-FT-IND) = HIGH-VALUE                         17
283900              MOVE SPACES TO DP017-SCR-ACTION-DESC(DP017-SCR-SUB)       17
284000         END-SEARCH.                                              DPKCS017
284100 EJECT                                                            DPKCS017
284200                                                                  DPKCS017
284300 Y000-COMPUTE-PS-SUB.                                                   17
284400******************************************************************DPKCS017
284500*    COMPUTE PS-SUB.                                                    17
284600*    CHECK FOR MAXIMUM VALUE AND DECREMENT IF NEEDED,                   17
284700*    TO AVOID SUBSCRIPT OUT OF BOUNDS.                                  17
284800******************************************************************DPKCS017
284900                                                                  DPKCS017
285000     COMPUTE PS-SUB = DP017-SCR-SUB + PC-MAX-ITEMS-ON-SCREEN - 1. DPKCS017
285100     IF PS-SUB > PC-MAX-FKEYS                                           17
285200         MOVE PC-MAX-FKEYS TO PS-SUB.                                   17
285300                                                                        17
285400 EJECT                                                            DPKCS017
285500                                                                  DPKCS017
285600 Y100-REFORMAT-TIMESTAMP-SHORT.                                         17
285700******************************************************************DPKCS017
285800*    REFORMAT THE TIMESTAMP.                                      DPKCS017
285900*    * SHORTEN IT FROM 26 CHARACTERS TO 20 CHARACTERS FOR STORAGE DPKCS017
286000*      IN THE COMMAREA.                                                 17
286100*    * SHORTEN IT BY REMOVING THE DASHES AND DOTS.                DPKCS017
286200******************************************************************DPKCS017
286300     MOVE TCICSROUTE-LAST-UPDATE-TMESTP TO PV-TMESTP.                   17
286400     MOVE PV-TRC-CCYY                   TO PV-TRS-CCYY.           DPKCS017
286500     MOVE PV-TRC-MM                     TO PV-TRS-MM.             DPKCS017
286600     MOVE PV-TRC-DD                     TO PV-TRS-DD.             DPKCS017
286700     MOVE PV-TRC-HR                     TO PV-TRS-HR.             DPKCS017
286800     MOVE PV-TRC-MN                     TO PV-TRS-MN.             DPKCS017
286900     MOVE PV-TRC-SC                     TO PV-TRS-SC.             DPKCS017
287000     MOVE PV-TRC-TK                     TO PV-TRS-TK.             DPKCS017
287100     MOVE PV-TMESTP-REFORMAT-SHORT-X20  TO                              17
287200                                        DP017-SCR-TMESTP(PS-SUB).       17
287300 EJECT                                                            DPKCS017
287400                                                                  DPKCS017
287500 Y200-REFORMAT-TIMESTAMP.                                               17
287600******************************************************************DPKCS017
287700*    REFORMAT THE SHORTENED TIMESTAMP.                            DPKCS017
287800*    * REFORMAT FROM 20 CHRACTERS TO 26 CHARACTERS.               DPKCS017
287900*    * REFORMAT IT BY ADDING THE DASHES AND DOTS BACK IN.         DPKCS017
288000******************************************************************DPKCS017
288100     MOVE DP017-SCR-TMESTP(PS-SUB) TO                                   17
288200                                     PV-TMESTP-REFORMAT-SHORT-X20.      17
288300     MOVE PV-TRS-CCYY              TO PV-TRC-CCYY.                      17
288400     MOVE PV-TRS-MM                TO PV-TRC-MM.                        17
288500     MOVE PV-TRS-DD                TO PV-TRC-DD.                        17
288600     MOVE PV-TRS-HR                TO PV-TRC-HR.                        17
288700     MOVE PV-TRS-MN                TO PV-TRC-MN.                        17
288800     MOVE PV-TRS-SC                TO PV-TRC-SC.                        17
288900     MOVE PV-TRS-TK                TO PV-TRC-TK.                        17
289000     MOVE PC-DASH                  TO PV-TRC-DASH1                      17
289100                                      PV-TRC-DASH2                      17
289200                                      PV-TRC-DASH3.                     17
289300     MOVE PC-DOT                   TO PV-TRC-DOT1                       17
289400                                      PV-TRC-DOT2                       17
289500                                      PV-TRC-DOT3.                      17
289600 EJECT                                                            DPKCS017
289700                                                                  DPKCS017
289800 Z100-SELECT-TMNEMONIC-ROW.                                       DPKCS017
289900******************************************************************DPKCS017
290000*    SELECT A ROW FROM THE TMNEMONIC TABLE.                       DPKCS017
290100*                                                                 DPKCS017
290200*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS017
290300*    PERFORMED BY F400-EDIT-SELECTED-FKEY.                        DPKCS017
290400******************************************************************DPKCS017
290500                                                                  DPKCS017
290600     EXEC SQL                                                     DPKCS017
290700         SELECT TRANS_ID_CODE,                                    DPKCS017
290800                SCRN_TYP_CDE,                                     DPKCS017
290900                PANEL_TITLE_NAME                                  DPKCS017
291000         INTO :TMNEMONIC-TRANS-ID-CODE,                           DPKCS017
291100              :TMNEMONIC-SCRN-TYP-CDE,                            DPKCS017
291200              :TMNEMONIC-PANEL-TITLE-NAME                         DPKCS017
291300              :IV-PANEL-TITLE-NAME                                DPKCS017
291400         FROM TMNEMONIC                                           DPKCS017
291500         WHERE MNEMONIC_CODE = :PV-MNEMONIC                       DPKCS017
291600     END-EXEC.                                                    DPKCS017
291700                                                                  DPKCS017
291800     EVALUATE TRUE                                                DPKCS017
291900                                                                  DPKCS017
292000         WHEN SQLCODE = +0                                        DPKCS017
292100         WHEN SQLCODE = +100                                      DPKCS017
292200             CONTINUE                                             DPKCS017
292300                                                                  DPKCS017
292400         WHEN OTHER                                               DPKCS017
292500             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
292600             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
292700                                                                  DPKCS017
292800             MOVE 'Z100-SELECT-TMNEMONIC-ROW' TO                  DPKCS017
292900                  DP013-PARAGRAPH                                 DPKCS017
293000             MOVE SQLCODE                     TO                  DPKCS017
293100                  PM-SQLCODE-2                                    DPKCS017
293200             MOVE SQLCA                       TO                  DPKCS017
293300                  DP013-SQLCA                                     DPKCS017
293400             MOVE PM-PROGRAM-MESSAGE-2        TO                  DPKCS017
293500                  DP013-MESSAGE-TEXT(1)                           DPKCS017
293600                                                                  DPKCS017
293700             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
293800                                                                  DPKCS017
293900     END-EVALUATE.                                                DPKCS017
294000 EJECT                                                            DPKCS017
294100                                                                  DPKCS017
294200 Z150-SELECT-TMNEMONIC-BY-LABEL.                                  DPKCS017
294300******************************************************************DPKCS017
294400*    SELECT A ROW FROM THE TMNEMONIC TABLE.                       DPKCS017
294500*                                                                 DPKCS017
294600*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS017
294700*    PERFORMED BY F400-EDIT-SELECTED-FKEY.                        DPKCS017
294800******************************************************************DPKCS017
294900                                                                  DPKCS017
295000     EXEC SQL                                                     DPKCS017
295100         SELECT MNEMONIC_CODE                                     DPKCS017
295200         INTO :PV-LABEL2                                          DPKCS017
295300         FROM TMNEMONIC                                           DPKCS017
295400         WHERE MNEMONIC_CODE = :PV-LABEL                          DPKCS017
295500     END-EXEC.                                                    DPKCS017
295600                                                                  DPKCS017
295700     EVALUATE TRUE                                                DPKCS017
295800                                                                  DPKCS017
295900         WHEN SQLCODE = +0                                        DPKCS017
296000         WHEN SQLCODE = +100                                      DPKCS017
296100             CONTINUE                                             DPKCS017
296200                                                                  DPKCS017
296300         WHEN OTHER                                               DPKCS017
296400             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
296500             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
296600                                                                  DPKCS017
296700             MOVE 'Z150-SELECT-TMNEMONIC-BY-LABEL' TO             DPKCS017
296800                  DP013-PARAGRAPH                                 DPKCS017
296900             MOVE SQLCODE                     TO                  DPKCS017
297000                  PM-SQLCODE-2                                    DPKCS017
297100             MOVE SQLCA                       TO                  DPKCS017
297200                  DP013-SQLCA                                     DPKCS017
297300             MOVE PM-PROGRAM-MESSAGE-2        TO                  DPKCS017
297400                  DP013-MESSAGE-TEXT(1)                           DPKCS017
297500                                                                  DPKCS017
297600             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
297700                                                                  DPKCS017
297800     END-EVALUATE.                                                DPKCS017
297900 EJECT                                                            DPKCS017
298000                                                                  DPKCS017
298100 Z200-OPEN-TAIDKEY-CURSOR.                                        DPKCS017
298200******************************************************************DPKCS017
298300*    OPEN THE TAIDKEY-CURSOR CURSOR                               DPKCS017
298400*                                                                 DPKCS017
298500*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS017
298600******************************************************************DPKCS017
298700                                                                  DPKCS017
298800     EXEC SQL                                                     DPKCS017
298900         OPEN TAIDKEY-CURSOR                                      DPKCS017
299000     END-EXEC.                                                    DPKCS017
299100                                                                  DPKCS017
299200     EVALUATE TRUE                                                DPKCS017
299300                                                                  DPKCS017
299400         WHEN SQLCODE = +0                                        DPKCS017
299500         WHEN SQLCODE = +100                                      DPKCS017
299600             CONTINUE                                             DPKCS017
299700                                                                  DPKCS017
299800         WHEN OTHER                                               DPKCS017
299900             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
300000             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
300100                                                                  DPKCS017
300200             MOVE 'Z200-OPEN-TAIDKEY-CURSOR'                            17
300300                                       TO DP013-PARAGRAPH               17
300400             MOVE SQLCODE              TO PM-SQLCODE-3            DPKCS017
300500             MOVE SQLCA                TO DP013-SQLCA             DPKCS017
300600             MOVE PM-PROGRAM-MESSAGE-3 TO DP013-MESSAGE-TEXT(1)   DPKCS017
300700                                                                  DPKCS017
300800             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
300900                                                                  DPKCS017
301000     END-EVALUATE.                                                DPKCS017
301100 EJECT                                                            DPKCS017
301200                                                                  DPKCS017
301300 Z300-FETCH-TAIDKEY-CURSOR.                                       DPKCS017
301400******************************************************************DPKCS017
301500*    FETCH A ROW FROM THE TAIDKEY TABLE USING THE CURSOR.               17
301600*                                                                 DPKCS017
301700*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS017
301800*    PERFORMED BY G100-LOOP-TO-POPULATE-SCREEN.                   DPKCS017
301900******************************************************************DPKCS017
302000                                                                  DPKCS017
302100     EXEC SQL                                                     DPKCS017
302200         FETCH TAIDKEY-CURSOR                                     DPKCS017
302300         INTO :TAIDKEY-AID-SEQUENCE-NMBR,                         DPKCS017
302400              :TAIDKEY-AID-KEY-NAME,                              DPKCS017
302500              :TAIDKEY-STNRD-ACTION-CODE,                         DPKCS017
302600              :TAIDKEY-SYSWIDE-USE-INDCT,                         DPKCS017
302700              :TAIDKEY-MNDTRY-MNMNC-INDCT,                        DPKCS017
302800              :TAIDKEY-MNEMONIC-CODE                              DPKCS017
302900              :IV-MNEMONIC-CODE                                   DPKCS017
303000     END-EXEC.                                                    DPKCS017
303100                                                                  DPKCS017
303200     EVALUATE TRUE                                                DPKCS017
303300                                                                  DPKCS017
303400         WHEN SQLCODE = +0                                        DPKCS017
303500         WHEN SQLCODE = +100                                      DPKCS017
303600             CONTINUE                                             DPKCS017
303700                                                                  DPKCS017
303800         WHEN OTHER                                               DPKCS017
303900             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
304000             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
304100                                                                  DPKCS017
304200             MOVE 'Z300-FETCH-TAIDKEY-CURSOR'                           17
304300                                       TO DP013-PARAGRAPH               17
304400             MOVE SQLCODE              TO PM-SQLCODE-4            DPKCS017
304500             MOVE SQLCA                TO DP013-SQLCA             DPKCS017
304600             MOVE PM-PROGRAM-MESSAGE-4 TO DP013-MESSAGE-TEXT(1)   DPKCS017
304700                                                                  DPKCS017
304800             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
304900                                                                  DPKCS017
305000     END-EVALUATE.                                                DPKCS017
305100 EJECT                                                            DPKCS017
305200                                                                  DPKCS017
305300 Z400-CLOSE-TAIDKEY-CURSOR.                                       DPKCS017
305400******************************************************************DPKCS017
305500*    CLOSE THE TAIDKEY-CURSOR CURSOR                              DPKCS017
305600*                                                                 DPKCS017
305700*    PERFORMED BY F100-RETRIEVE-DATA-FOR-SCREEN.                  DPKCS017
305800******************************************************************DPKCS017
305900                                                                  DPKCS017
306000     EXEC SQL                                                     DPKCS017
306100         CLOSE TAIDKEY-CURSOR                                     DPKCS017
306200     END-EXEC.                                                    DPKCS017
306300                                                                  DPKCS017
306400     EVALUATE TRUE                                                DPKCS017
306500                                                                  DPKCS017
306600         WHEN SQLCODE = +0                                        DPKCS017
306700         WHEN SQLCODE = +100                                      DPKCS017
306800             CONTINUE                                             DPKCS017
306900                                                                  DPKCS017
307000         WHEN OTHER                                               DPKCS017
307100             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
307200             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
307300                                                                  DPKCS017
307400             MOVE 'Z400-CLOSE-TAIDKEY-CURSOR'                           17
307500                                       TO DP013-PARAGRAPH               17
307600             MOVE SQLCODE              TO PM-SQLCODE-5            DPKCS017
307700             MOVE SQLCA                TO DP013-SQLCA             DPKCS017
307800             MOVE PM-PROGRAM-MESSAGE-5 TO DP013-MESSAGE-TEXT(1)   DPKCS017
307900                                                                  DPKCS017
308000             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
308100                                                                  DPKCS017
308200     END-EVALUATE.                                                DPKCS017
308300 EJECT                                                            DPKCS017
308400                                                                  DPKCS017
308500 Z500-SELECT-TCICSROUTE-ROW.                                      DPKCS017
308600******************************************************************DPKCS017
308700*    SELECT A ROW FROM THE TCICSROUTE TABLE                       DPKCS017
308800*                                                                 DPKCS017
308900*    PERFORMED BY E600-PROCESS-ADDS-UPDATES.                      DPKCS017
309000*    PERFORMED BY F300-DELETE.                                    DPKCS017
309100******************************************************************DPKCS017
309200                                                                  DPKCS017
309300     MOVE PS-SUB TO PV-SEQUENCE-NMBR.                             DPKCS017
309400                                                                  DPKCS017
309500     EXEC SQL                                                     DPKCS017
309600         SELECT DEST_MNEMONIC_CODE,                               DPKCS017
309700                ACTION_CODE,                                      DPKCS017
309800                LAST_UPDATE_TMESTP,                               DPKCS017
309900                ROUTE_STACK_INDCT,                                DPKCS017
310000                IN_APLCTN_COMM_CDE,                               DPKCS017
310100                FUNC_KEY_LBL_NAME,                                DPKCS017
310200                FUNC_KY_DISPN_IND                                 DPKCS017
310300         INTO :TCICSROUTE-DEST-MNEMONIC-CODE,                     DPKCS017
310400              :TCICSROUTE-ACTION-CODE,                            DPKCS017
310500              :TCICSROUTE-LAST-UPDATE-TMESTP,                     DPKCS017
310600              :TCICSROUTE-ROUTE-STACK-INDCT,                      DPKCS017
310700              :TCICSROUTE-IN-APLCTN-COMM-CDE,                     DPKCS017
310800              :TCICSROUTE-FUNC-KEY-LBL-NAME,                      DPKCS017
310900              :TCICSROUTE-FUNC-KY-DISPN-IND                             17
311000         FROM TCICSROUTE                                          DPKCS017
311100         WHERE (MNEMONIC_CODE     = :DP017-SCREEN-MNEMONIC) AND   DPKCS017
311200               (AID_SEQUENCE_NMBR = :PV-SEQUENCE-NMBR-CHAR)       DPKCS017
311300     END-EXEC.                                                    DPKCS017
311400                                                                  DPKCS017
311500     EVALUATE TRUE                                                DPKCS017
311600                                                                  DPKCS017
311700         WHEN SQLCODE = +0                                        DPKCS017
311800         WHEN SQLCODE = +100                                      DPKCS017
311900             CONTINUE                                             DPKCS017
312000                                                                  DPKCS017
312100         WHEN OTHER                                               DPKCS017
312200             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
312300             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
312400                                                                  DPKCS017
312500             MOVE 'Z500-SELECT-TCICSROUTE-ROW' TO                 DPKCS017
312600                  DP013-PARAGRAPH                                 DPKCS017
312700             MOVE SQLCODE                      TO                 DPKCS017
312800                  PM-SQLCODE-6                                    DPKCS017
312900             MOVE SQLCA                        TO                 DPKCS017
313000                  DP013-SQLCA                                     DPKCS017
313100             MOVE PM-PROGRAM-MESSAGE-6         TO                 DPKCS017
313200                  DP013-MESSAGE-TEXT(1)                           DPKCS017
313300                                                                  DPKCS017
313400             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
313500                                                                  DPKCS017
313600     END-EVALUATE.                                                DPKCS017
313700 EJECT                                                            DPKCS017
313800                                                                  DPKCS017
313900 Z550-SELECT-TCICSROUTE-ROW.                                      DPKCS017
314000******************************************************************DPKCS017
314100*    SELECT A ROW FROM THE TCICSROUTE TABLE                       DPKCS017
314200*                                                                 DPKCS017
314300*    PERFORMED BY F400                                            DPKCS017
314400******************************************************************DPKCS017
314500                                                                  DPKCS017
314600     MOVE DP017-SCR-FORMAT(PS-SUB)   TO  PV-FORMAT.                     17
314700     MOVE DP017-SCR-MNEMONIC(PS-SUB) TO  PV-MNEMONIC.                   17
314800                                                                  DPKCS017
314900     EXEC SQL                                                     DPKCS017
315000         SELECT   IN_APLCTN_COMM_CDE                              DPKCS017
315100         INTO     :TCICSROUTE-IN-APLCTN-COMM-CDE                  DPKCS017
315200         FROM     TCICSROUTE                                      DPKCS017
315300         WHERE    (DEST_MNEMONIC_CODE = :PV-MNEMONIC              DPKCS017
315400          AND      MNEMONIC_CODE     ^= :DP017-SCREEN-MNEMONIC    DPKCS017
315500          AND      IN_APLCTN_COMM_CDE = :PV-FORMAT)               DPKCS017
315600     END-EXEC.                                                    DPKCS017
315700                                                                  DPKCS017
315800     EVALUATE TRUE                                                DPKCS017
315900                                                                  DPKCS017
316000         WHEN SQLCODE = +100                                      DPKCS017
316100              CONTINUE                                            DPKCS017
316200         WHEN SQLCODE = +0                                        DPKCS017
316300         WHEN SQLCODE = -811                                      DPKCS017
316400              SET PS-WARNING     TO TRUE                          DPKCS017
316500                                                                  DPKCS017
316600         WHEN OTHER                                               DPKCS017
316700             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
316800             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
316900                                                                  DPKCS017
317000             MOVE 'Z550-SELECT-TCICSROUTE-ROW' TO                 DPKCS017
317100                  DP013-PARAGRAPH                                 DPKCS017
317200             MOVE SQLCODE                      TO                 DPKCS017
317300                  PM-SQLCODE-6                                    DPKCS017
317400             MOVE SQLCA                        TO                 DPKCS017
317500                  DP013-SQLCA                                     DPKCS017
317600             MOVE PM-PROGRAM-MESSAGE-6         TO                 DPKCS017
317700                  DP013-MESSAGE-TEXT(1)                           DPKCS017
317800                                                                  DPKCS017
317900             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
318000                                                                  DPKCS017
318100     END-EVALUATE.                                                DPKCS017
318200 EJECT                                                            DPKCS017
318300                                                                  DPKCS017
318400 Z560-SELECT-TMENUITEM-ROW.                                       DPKCS017
318500******************************************************************DPKCS017
318600*    SELECT FROM THE MENUITEM TABLE.                              DPKCS017
318700*                                                                 DPKCS017
318800*    PERFORMED BY F400                                            DPKCS017
318900******************************************************************DPKCS017
319000                                                                  DPKCS017
319100     MOVE DP017-SCR-FORMAT(PS-SUB)                                DPKCS017
319200                               TO  PV-FORMAT.                     DPKCS017
319300     MOVE DP017-SCR-MNEMONIC(PS-SUB)                              DPKCS017
319400                               TO  PV-MNEMONIC.                   DPKCS017
319500                                                                  DPKCS017
319600     EXEC SQL                                                     DPKCS017
319700         SELECT   IN_APLCTN_COMM_CDE                              DPKCS017
319800         INTO     :TMENUITEM-IN-APLCTN-COMM-CDE                   DPKCS017
319900         FROM     TMENUITEM                                       DPKCS017
320000         WHERE    (ITEM_MNEMONIC_CODE = :PV-MNEMONIC              DPKCS017
320100          AND      IN_APLCTN_COMM_CDE = :PV-FORMAT)               DPKCS017
320200     END-EXEC.                                                    DPKCS017
320300                                                                  DPKCS017
320400     EVALUATE TRUE                                                DPKCS017
320500                                                                  DPKCS017
320600         WHEN SQLCODE = +100                                      DPKCS017
320700              CONTINUE                                            DPKCS017
320800         WHEN SQLCODE = +0                                        DPKCS017
320900         WHEN SQLCODE = -811                                      DPKCS017
321000              SET PS-WARNING     TO TRUE                          DPKCS017
321100                                                                  DPKCS017
321200         WHEN OTHER                                               DPKCS017
321300             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
321400             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
321500                                                                  DPKCS017
321600             MOVE 'Z560-SELECT-TMENUITEM-ROW ' TO                 DPKCS017
321700                  DP013-PARAGRAPH                                 DPKCS017
321800             MOVE SQLCODE                      TO                 DPKCS017
321900                  PM-SQLCODE-6                                    DPKCS017
322000             MOVE SQLCA                        TO                 DPKCS017
322100                  DP013-SQLCA                                     DPKCS017
322200             MOVE PM-PROGRAM-MESSAGE-6         TO                 DPKCS017
322300                  DP013-MESSAGE-TEXT(1)                           DPKCS017
322400                                                                  DPKCS017
322500             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
322600                                                                  DPKCS017
322700     END-EVALUATE.                                                DPKCS017
322800 EJECT                                                            DPKCS017
322900                                                                  DPKCS017
323000 Z600-SELECT-TAIDKEY-ROW.                                         DPKCS017
323100******************************************************************DPKCS017
323200*    SELECT A ROW FROM THE TAIDKEY TABLE                          DPKCS017
323300*                                                                 DPKCS017
323400*    PERFORMED BY E200-CHECK-FIELDS-FOR-ENTRY.                    DPKCS017
323500*    PERFORMED BY E300-PROCESS-DELETES.                           DPKCS017
323600*    PERFORMED BY F400-EDIT-SELECTED-FKEY.                        DPKCS017
323700******************************************************************DPKCS017
323800                                                                  DPKCS017
323900     MOVE PS-SUB TO PV-SEQUENCE-NMBR.                             DPKCS017
324000                                                                  DPKCS017
324100     EXEC SQL                                                     DPKCS017
324200         SELECT AID_SEQUENCE_NMBR,                                DPKCS017
324300                AID_KEY_NAME,                                     DPKCS017
324400                STNRD_ACTION_CODE,                                DPKCS017
324500                SYSWIDE_USE_INDCT,                                DPKCS017
324600                MNDTRY_MNMNC_INDCT,                               DPKCS017
324700                MNEMONIC_CODE                                     DPKCS017
324800         INTO :TAIDKEY-AID-SEQUENCE-NMBR,                         DPKCS017
324900              :TAIDKEY-AID-KEY-NAME,                              DPKCS017
325000              :TAIDKEY-STNRD-ACTION-CODE,                         DPKCS017
325100              :TAIDKEY-SYSWIDE-USE-INDCT,                         DPKCS017
325200              :TAIDKEY-MNDTRY-MNMNC-INDCT,                        DPKCS017
325300              :TAIDKEY-MNEMONIC-CODE                              DPKCS017
325400              :IV-MNEMONIC-CODE                                   DPKCS017
325500         FROM TAIDKEY                                             DPKCS017
325600         WHERE AID_SEQUENCE_NMBR = :PV-SEQUENCE-NMBR-CHAR         DPKCS017
325700          AND  SCRN_TYP_CDE      = :DP017-SCR-TYP-CDE             DPKCS017
325800     END-EXEC.                                                    DPKCS017
325900                                                                  DPKCS017
326000     EVALUATE TRUE                                                DPKCS017
326100                                                                  DPKCS017
326200         WHEN SQLCODE = +0                                        DPKCS017
326300             CONTINUE                                             DPKCS017
326400                                                                  DPKCS017
326500         WHEN OTHER                                               DPKCS017
326600             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
326700             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
326800                                                                  DPKCS017
326900             MOVE 'Z600-SELECT-TAIDKEY-ROW' TO                    DPKCS017
327000                  DP013-PARAGRAPH                                 DPKCS017
327100             MOVE SQLCODE                   TO                    DPKCS017
327200                  PM-SQLCODE-8                                    DPKCS017
327300             MOVE SQLCA                     TO                    DPKCS017
327400                  DP013-SQLCA                                     DPKCS017
327500             MOVE PM-PROGRAM-MESSAGE-8      TO                    DPKCS017
327600                  DP013-MESSAGE-TEXT(1)                           DPKCS017
327700                                                                  DPKCS017
327800             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
327900                                                                  DPKCS017
328000     END-EVALUATE.                                                DPKCS017
328100 EJECT                                                            DPKCS017
328200                                                                  DPKCS017
328300 Z700-DELETE-TCICSROUTE-ROW.                                      DPKCS017
328400******************************************************************DPKCS017
328500*    DELETE A ROW FROM THE TCICSROUTE TABLE                       DPKCS017
328600*                                                                 DPKCS017
328700*    PERFORMED BY F300-DELETE.                                    DPKCS017
328800******************************************************************DPKCS017
328900                                                                  DPKCS017
329000     PERFORM Y200-REFORMAT-TIMESTAMP.                                   17
329100     MOVE PS-SUB                   TO PV-SEQUENCE-NMBR.           DPKCS017
329200                                                                  DPKCS017
329300     EXEC SQL                                                     DPKCS017
329400         DELETE FROM TCICSROUTE                                   DPKCS017
329500         WHERE (MNEMONIC_CODE      = :DP017-SCREEN-MNEMONIC) AND  DPKCS017
329600               (AID_SEQUENCE_NMBR  = :PV-SEQUENCE-NMBR-CHAR) AND  DPKCS017
329700               (LAST_UPDATE_TMESTP = :PV-TMESTP)                  DPKCS017
329800     END-EXEC.                                                    DPKCS017
329900                                                                  DPKCS017
330000     EVALUATE TRUE                                                DPKCS017
330100                                                                  DPKCS017
330200         WHEN SQLCODE = +0                                        DPKCS017
330300         WHEN SQLCODE = +100                                      DPKCS017
330400             CONTINUE                                             DPKCS017
330500                                                                  DPKCS017
330600         WHEN OTHER                                               DPKCS017
330700             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
330800             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
330900                                                                  DPKCS017
331000             MOVE 'Z700-DELETE-TCICSROUTE-ROW' TO                 DPKCS017
331100                  DP013-PARAGRAPH                                 DPKCS017
331200             MOVE SQLCODE                      TO                 DPKCS017
331300                  PM-SQLCODE-10                                   DPKCS017
331400             MOVE SQLCA                        TO                 DPKCS017
331500                  DP013-SQLCA                                     DPKCS017
331600             MOVE PM-PROGRAM-MESSAGE-10        TO                 DPKCS017
331700                  DP013-MESSAGE-TEXT(1)                           DPKCS017
331800             MOVE PV-TMESTP                    TO                       17
331900                  PM-TMESTP                                             17
332000             MOVE PM-PROGRAM-MESSAGE-T         TO                       17
332100                  DP013-MESSAGE-TEXT(2)                                 17
332200                                                                  DPKCS017
332300             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
332400                                                                  DPKCS017
332500     END-EVALUATE.                                                DPKCS017
332600 EJECT                                                            DPKCS017
332700                                                                  DPKCS017
332800 Z800-INSERT-TCICSROUTE-ROW.                                      DPKCS017
332900******************************************************************DPKCS017
333000*    ADD A ROW TO THE TCICSROUTE TABLE                            DPKCS017
333100*                                                                 DPKCS017
333200*    PERFORMED BY E600-PROCESS-ADDS-UPDATES.                      DPKCS017
333300******************************************************************DPKCS017
333400                                                                  DPKCS017
333500     MOVE DP017-SCR-MNEMONIC(PS-SUB) TO PV-MNEMONIC.              DPKCS017
333600     MOVE DP017-SCR-ACTION(PS-SUB)   TO PV-ACT.                   DPKCS017
333700     MOVE DP017-SCR-DISP(PS-SUB)     TO PV-DISP.                  DPKCS017
333800     MOVE DP017-SCR-STK(PS-SUB)      TO PV-STK.                   DPKCS017
333900     MOVE DP017-SCR-LABEL(PS-SUB)    TO PV-LABEL.                 DPKCS017
334000     MOVE DP017-SCR-FORMAT(PS-SUB)   TO PV-FORMAT.                DPKCS017
334100     MOVE PS-SUB                     TO PV-SEQUENCE-NMBR.         DPKCS017
334200                                                                  DPKCS017
334300     EXEC SQL                                                     DPKCS017
334400         INSERT INTO TCICSROUTE                                   DPKCS017
334500             (MNEMONIC_CODE,                                      DPKCS017
334600              AID_SEQUENCE_NMBR,                                  DPKCS017
334700              DEST_MNEMONIC_CODE,                                 DPKCS017
334800              ACTION_CODE,                                        DPKCS017
334900              LAST_UPDATE_TMESTP,                                 DPKCS017
335000              ROUTE_STACK_INDCT,                                  DPKCS017
335100              IN_APLCTN_COMM_CDE,                                 DPKCS017
335200              FUNC_KEY_LBL_NAME,                                  DPKCS017
335300              FUNC_KY_DISPN_IND)                                  DPKCS017
335400         VALUES (:DP017-SCREEN-MNEMONIC,                          DPKCS017
335500                 :PV-SEQUENCE-NMBR-CHAR,                          DPKCS017
335600                 :PV-MNEMONIC,                                    DPKCS017
335700                 :PV-ACT,                                         DPKCS017
335800                  CURRENT TIMESTAMP,                              DPKCS017
335900                 :PV-STK,                                         DPKCS017
336000                 :PV-FORMAT,                                      DPKCS017
336100                 :PV-LABEL,                                       DPKCS017
336200                 :PV-DISP)                                              17
336300     END-EXEC.                                                    DPKCS017
336400                                                                  DPKCS017
336500     EVALUATE TRUE                                                DPKCS017
336600                                                                  DPKCS017
336700         WHEN SQLCODE = +0                                        DPKCS017
336800         WHEN SQLCODE = -803                                      DPKCS017
336900             CONTINUE                                             DPKCS017
337000                                                                  DPKCS017
337100         WHEN OTHER                                               DPKCS017
337200             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
337300             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
337400                                                                  DPKCS017
337500             MOVE 'Z800-INSERT-TCICSROUTE-ROW' TO                 DPKCS017
337600                  DP013-PARAGRAPH                                 DPKCS017
337700             MOVE SQLCODE                      TO                 DPKCS017
337800                  PM-SQLCODE-22                                   DPKCS017
337900             MOVE SQLCA                        TO                 DPKCS017
338000                  DP013-SQLCA                                     DPKCS017
338100             MOVE PM-PROGRAM-MESSAGE-22        TO                 DPKCS017
338200                  DP013-MESSAGE-TEXT(1)                           DPKCS017
338300                                                                  DPKCS017
338400             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
338500                                                                  DPKCS017
338600     END-EVALUATE.                                                DPKCS017
338700 EJECT                                                            DPKCS017
338800                                                                  DPKCS017
338900 Z900-UPDATE-TCICSROUTE-ROW.                                      DPKCS017
339000******************************************************************DPKCS017
339100*    UPDATE A ROW ON THE TCICSROUTE TABLE                         DPKCS017
339200*                                                                 DPKCS017
339300*    PERFORMED BY E600-PROCESS-ADDS-UPDATES.                      DPKCS017
339400******************************************************************DPKCS017
339500                                                                  DPKCS017
339600     MOVE DP017-SCR-MNEMONIC(PS-SUB) TO PV-MNEMONIC.              DPKCS017
339700     MOVE DP017-SCR-ACTION(PS-SUB)   TO PV-ACT.                   DPKCS017
339800     MOVE DP017-SCR-DISP(PS-SUB)     TO PV-DISP.                        17
339900     MOVE DP017-SCR-STK(PS-SUB)      TO PV-STK.                   DPKCS017
340000     MOVE DP017-SCR-LABEL(PS-SUB)    TO PV-LABEL.                 DPKCS017
340100     PERFORM Y200-REFORMAT-TIMESTAMP.                                   17
340200     MOVE DP017-SCR-FORMAT(PS-SUB)   TO PV-FORMAT.                DPKCS017
340300     MOVE PS-SUB                     TO PV-SEQUENCE-NMBR.         DPKCS017
340400                                                                  DPKCS017
340500     EXEC SQL                                                     DPKCS017
340600         UPDATE TCICSROUTE                                        DPKCS017
340700         SET DEST_MNEMONIC_CODE = :PV-MNEMONIC,                   DPKCS017
340800             ACTION_CODE        = :PV-ACT,                        DPKCS017
340900             LAST_UPDATE_TMESTP =  CURRENT TIMESTAMP,             DPKCS017
341000             ROUTE_STACK_INDCT  = :PV-STK,                        DPKCS017
341100             IN_APLCTN_COMM_CDE = :PV-FORMAT,                     DPKCS017
341200             FUNC_KEY_LBL_NAME  = :PV-LABEL,                      DPKCS017
341300             FUNC_KY_DISPN_IND  = :PV-DISP                        DPKCS017
341400         WHERE (MNEMONIC_CODE      = :DP017-SCREEN-MNEMONIC) AND  DPKCS017
341500               (AID_SEQUENCE_NMBR  = :PV-SEQUENCE-NMBR-CHAR) AND  DPKCS017
341600               (LAST_UPDATE_TMESTP = :PV-TMESTP)                  DPKCS017
341700     END-EXEC.                                                    DPKCS017
341800                                                                  DPKCS017
341900     EVALUATE TRUE                                                DPKCS017
342000                                                                  DPKCS017
342100         WHEN SQLCODE = +0                                        DPKCS017
342200         WHEN SQLCODE = +100                                      DPKCS017
342300             CONTINUE                                             DPKCS017
342400                                                                  DPKCS017
342500         WHEN OTHER                                               DPKCS017
342600             SET DP013-DB2-ABEND TO TRUE                          DPKCS017
342700             SET DP013-ROLLBACK  TO TRUE                          DPKCS017
342800                                                                  DPKCS017
342900             MOVE 'Z900-UPDATE-TCICSROUTE-ROW' TO                 DPKCS017
343000                  DP013-PARAGRAPH                                 DPKCS017
343100             MOVE SQLCODE                      TO                 DPKCS017
343200                  PM-SQLCODE-24                                   DPKCS017
343300             MOVE SQLCA                        TO                 DPKCS017
343400                  DP013-SQLCA                                     DPKCS017
343500             MOVE PM-PROGRAM-MESSAGE-24        TO                 DPKCS017
343600                  DP013-MESSAGE-TEXT(1)                           DPKCS017
343700             MOVE PV-TMESTP                    TO                 DPKCS017
343800                  PM-TMESTP                                             17
343900             MOVE PM-PROGRAM-MESSAGE-T         TO                 DPKCS017
344000                  DP013-MESSAGE-TEXT(2)                           DPKCS017
344100                                                                  DPKCS017
344200             PERFORM DP013-0000-PROCESS-ABEND                     DPKCS017
344300                                                                  DPKCS017
344400     END-EVALUATE.                                                DPKCS017
344500 EJECT                                                            DPKCS017
344600                                                                  DPKCS017
344700 Z980-UPDT-TMNEMONIC-ROW.                                         DPKCS012
344800******************************************************************DPKCS017
344900*    CICS24X7 PROJECT: IF ANY ROWS ON THE TCICSROUTE TABLE ARE    DPKCS017
345000*    UPDATED, INSERTED, OR DELETED, UPDATE THE UPD_VSAM_IND FIELD DPKCS017
345100*    ON THE TMNEMONIC TABLE TO A 'Y'.                             DPKCS017
345200******************************************************************DPKCS017
345300     EXEC SQL                                                     DPKCS012
345400           UPDATE TMNEMONIC                                             12
345500              SET LAST_UPDATE_TMESTP = CURRENT TIMESTAMP,               12
345600                  UPD_VSAM_IND       = :PC-Y                            12
345700           WHERE  MNEMONIC_CODE      = :DP017-SCREEN-MNEMONIC           12
345800     END-EXEC.                                                    DPKCS012
345900                                                                  DPKCS012
346000***************************                                       DPKCS021
346100* CHECK SQLCODE OF UPDATE *                                       DPKCS021
346200***************************                                       DPKCS021
346300                                                                  DPKCS021
346400     IF  SQLCODE NOT EQUAL ZERO                                   DPKCS021
346500         SET  DP013-DB2-ABEND  TO TRUE                            DPKCS021
346600         MOVE 'Z980-UPDT-TMNEMONIC-ROW       '                    DPKCS021
346700                                 TO DP013-PARAGRAPH               DPKCS021
346800         MOVE SQLCA              TO DP013-SQLCA                   DPKCS021
346900         MOVE 'TMNEMONIC         '                                DPKCS021
347000                                 TO DP013-DB2-TABLE-NAME (1)      DPKCS021
347100         MOVE 'UPDATE OF UPD-VSAM-IND FAILED FOR: '                     12
347200                                 TO DP013-MESSAGE-TEXT (1)        DPKCS012
347300         MOVE DP017-SCREEN-MNEMONIC                                     12
347400                                 TO DP013-MESSAGE-TEXT (2)        DPKCS012
347500         PERFORM DP013-0000-PROCESS-ABEND                         DPKCS021
347600     END-IF.                                                      DPKCS021
347700 EJECT                                                            DPKCS021
347800                                                                        12
347900******************************************************************DPKCS017
348000*    FILL IN SCREEN HEADER MODULE                                 DPKCS017
348100******************************************************************DPKCS017
348200     COPY DPPD022.                                                DPKCS017
348300 EJECT                                                            DPKCS017
348400                                                                  DPKCS017
348500******************************************************************DPKCS017
348600*    RETURN TO CICS MODULE                                        DPKCS017
348700******************************************************************DPKCS017
348800     COPY DPPD003.                                                DPKCS017
348900 EJECT                                                            DPKCS017
349000                                                                  DPKCS017
349100******************************************************************DPKCS017
349200*    FORMAT MESSAGE LINES MODULE                                  DPKCS017
349300******************************************************************DPKCS017
349400     COPY DPPD005.                                                DPKCS017
349500 EJECT                                                            DPKCS017
349600                                                                  DPKCS017
349700******************************************************************DPKCS017
349800*    GET PANEL MODULE                                             DPKCS017
349900******************************************************************DPKCS017
350000     COPY DPPD007.                                                DPKCS017
350100 EJECT                                                            DPKCS017
350200                                                                  DPKCS017
350300******************************************************************DPKCS017
350400*    WRITE PANEL MODULE                                           DPKCS017
350500******************************************************************DPKCS017
350600     COPY DPPD008.                                                DPKCS017
350700 EJECT                                                            DPKCS017
350800                                                                  DPKCS017
350900******************************************************************DPKCS017
351000*    TOGGLE THE FUNCTION KEY LINE MODULE                          DPKCS017
351100******************************************************************DPKCS017
351200     COPY DPPD009.                                                DPKCS017
351300 EJECT                                                            DPKCS017
351400                                                                  DPKCS017
351500******************************************************************DPKCS017
351600*    ABEND PROCESSOR MODULE                                       DPKCS017
351700******************************************************************DPKCS017
351800     COPY DPPD013.                                                DPKCS017
351900 EJECT                                                            DPKCS017
352000                                                                  DPKCS017
352100******************************************************************DPKCS017
352200*    CHECK COMMUNICATION AREA MODULE                              DPKCS017
352300******************************************************************DPKCS017
352400     COPY DPPD015.                                                DPKCS017
352500 EJECT                                                            DPKCS017
352600                                                                  DPKCS017
352700******************************************************************DPKCS017
352800*    UPDATE TIME AND DATE MODULE                                  DPKCS017
352900******************************************************************DPKCS017
353000     COPY DPPD017.                                                DPKCS017
353100 EJECT                                                            DPKCS017
