00001 ***************************************************************** 07/30/93
00002  IDENTIFICATION DIVISION.                                         SNKUP022
00003 *****************************************************************    LV001
00004                                                                   SNKUP022
00005  PROGRAM-ID.             SNKUP022.                                SNKUP022
00006  AUTHOR.                 PAT LEE.                                 SNKUP022
00007  INSTALLATION.           KOHLS DEPARTMENT STORES.                 SNKUP022
00008  DATE-WRITTEN            05-11-92.                                SNKUP022
00009  DATE-COMPILED.                                                   SNKUP022
00010                                                                   SNKUP022
00011 ***************************************************************** SNKUP022
00012 *     ASSOCIATE ASN TO PO                                       * SNKUP022
00013 *                                                               * SNKUP022
00014 *  THIS PROGRAM WILL RESET THE MATCH PO INDICATOR TO 'Y' FOR    * SNKUP022
00015 *  ALL THOSE THAT ARE CURRENTLY SET TO 'P'.                     * SNKUP022
00016 ***************************************************************** SNKUP022
00017 * CHANGED 05/17/93 BY NATALIYA PALATNIK                           SNKUP022
00018 *   WR# 1812                                                      SNKUP022
00019 *   CHANGE TO ALSO RESET THE MATCH PO INDICATOR TO 'Y' FOR THOSE  SNKUP022
00020 *   THAT ARE CURRENTLY SET TO 'C'.                                SNKUP022
00021 ***************************************************************** SNKUP022
00022  ENVIRONMENT DIVISION.                                            SNKUP022
00023 ***************************************************************** SNKUP022
00024                                                                   SNKUP022
00025  CONFIGURATION SECTION.                                           SNKUP022
00026                                                                   SNKUP022
00027  SOURCE-COMPUTER.        IBM-3090.                                SNKUP022
00028  OBJECT-COMPUTER.        IBM-3090.                                SNKUP022
00029                                                                   SNKUP022
00030  INPUT-OUTPUT SECTION.                                            SNKUP022
00031                                                                   SNKUP022
00032  FILE-CONTROL.                                                    SNKUP022
00033 *                                                                 SNKUP022
00034 ***************************************************************** SNKUP022
00035  DATA DIVISION.                                                   SNKUP022
00036 ***************************************************************** SNKUP022
00037 *                                                                 SNKUP022
00038  FILE SECTION.                                                    SNKUP022
00039 *                                                                 SNKUP022
00040  WORKING-STORAGE SECTION.                                         SNKUP022
00041 *                                                                 SNKUP022
00042  01  FILLER.                                                      SNKUP022
00043      05  FILLER                      PIC  X(36)    VALUE          SNKUP022
00044          ' ***** WORKING STORAGE PGM=SNKUP022 '.                  SNKUP022
00045      05  PGM-COMPILED                PIC  X(20)    VALUE SPACE.   SNKUP022
00046      05  FILLER                      PIC  X(10)    VALUE          SNKUP022
00047          ' LOCATION='.                                            SNKUP022
00048      05  PGM-LOCATION                PIC  X(04)    VALUE SPACE.   SNKUP022
00049      05  FILLER                      PIC  X(06)    VALUE          SNKUP022
00050          ' *****'.                                                SNKUP022
00051  01  PC-PROGRAM-CONSTANTS.                                        SNKUP022
00052      05  PC-C                        PIC  X(01)    VALUE 'C'.     SNKUP022
00053      05  PC-P                        PIC  X(01)    VALUE 'P'.     SNKUP022
00054      05  PC-Y                        PIC  X(01)    VALUE 'Y'.     SNKUP022
00055      05  PC-ILBOABN0                 PIC  X(08)    VALUE          SNKUP022
00056                                                    'ILBOABN0'.    SNKUP022
00057  01  PV-PROGRAM-VARIABLES.                                        SNKUP022
00058      05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO     SNKUP022
00059                                                    COMP SYNC.     SNKUP022
00060      05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.  SNKUP022
00061 /                                                                 SNKUP022
00062 *  DB2 COMMUNICATION AREA                                         SNKUP022
00063 *                                                                 SNKUP022
00064      EXEC SQL                                                     SNKUP022
00065          INCLUDE SQLCA                                            SNKUP022
00066      END-EXEC.                                                    SNKUP022
00067 /                                                                 SNKUP022
00068 *  DB2 COMMUNICATION AREA2                                        SNKUP022
00069 *                                                                 SNKUP022
00070      COPY SQLCA2.                                                 SNKUP022
00071 /                                                                 SNKUP022
00072 *  ASN ORDER TABLE LAYOUT                                         SNKUP022
00073 *                                                                 SNKUP022
00074      EXEC SQL                                                     SNKUP022
00075          INCLUDE TASNORD                                          SNKUP022
00076      END-EXEC.                                                    SNKUP022
00077 *                                                                 SNKUP022
00078  LINKAGE SECTION.                                                 SNKUP022
00079 /                                                                 SNKUP022
00080 ***************************************************************** SNKUP022
00081 *PROCEDURE DIVISION.                                              SNKUP022
00082 ***************************************************************** SNKUP022
00083  PROCEDURE DIVISION.                                              SNKUP022
00084 *                                                                 SNKUP022
00085  A000-MAINLINE-PROCESSING.                                        SNKUP022
00086 *                                                                 SNKUP022
00087      DISPLAY '***********************************'.               SNKUP022
00088      DISPLAY '*         S N K U P 0 2 2         *'.               SNKUP022
00089      DISPLAY '***********************************'.               SNKUP022
00090 *                                                                 SNKUP022
00091      MOVE 'A000'                  TO PGM-LOCATION.                SNKUP022
00092      MOVE 'A000-MAINLINE-PROCESSING'                              SNKUP022
00093                                   TO PV-ABEND-PARAGRAPH.          SNKUP022
00094 *    DISPLAY PV-ABEND-PARAGRAPH.                                  SNKUP022
00095 *                                                                 SNKUP022
00096      EXEC SQL                                                     SNKUP022
00097        UPDATE TASNORD                                             SNKUP022
00098           SET MTCH_PO_CDE   = :PC-Y                               SNKUP022
00099         WHERE MTCH_PO_CDE   = :PC-P                               SNKUP022
00100            OR MTCH_PO_CDE   = :PC-C                               SNKUP022
00101      END-EXEC.                                                    SNKUP022
00102 *                                                                 SNKUP022
00103      MOVE SQLCODE    TO SQLCODE2.                                 SNKUP022
00104 *                                                                 SNKUP022
00105      EVALUATE TRUE                                                SNKUP022
00106        WHEN SQLCODE = ZEROS OR +100                               SNKUP022
00107          CONTINUE                                                 SNKUP022
00108        WHEN (SQLCODE > ZERO OR SQLWARN0 = 'W')                    SNKUP022
00109          DISPLAY '******************************************'     SNKUP022
00110          DISPLAY 'WARNING ISSUED ON UPDATE OF ASNORD TABLE  '     SNKUP022
00111          DISPLAY '******************************************'     SNKUP022
00112          DISPLAY  PV-ABEND-PARAGRAPH                              SNKUP022
00113          PERFORM  Z998-SQL-WARNING                                SNKUP022
00114        WHEN  SQLCODE < ZERO                                       SNKUP022
00115          DISPLAY '******************************************'     SNKUP022
00116          DISPLAY 'ERROR ISSUED ON UPDATE OF ASNORD TABLE    '     SNKUP022
00117          DISPLAY 'ASNORD-ASNHDR-ID: '                             SNKUP022
00118                   ASNORD-ASNHDR-ID                                SNKUP022
00119          DISPLAY 'ASNORD-PO-NBR: '                                SNKUP022
00120                   ASNORD-PO-NBR                                   SNKUP022
00121          DISPLAY 'ASNORD-SELR-INV-NBR: '                          SNKUP022
00122                   ASNORD-SELR-INV-NBR                             SNKUP022
00125          DISPLAY '******************************************'     SNKUP022
00126          DISPLAY  PV-ABEND-PARAGRAPH                              SNKUP022
00127          PERFORM  Z999-SQL-ERROR                                  SNKUP022
00128      END-EVALUATE.                                                SNKUP022
00129 *                                                                 SNKUP022
00130      GOBACK.                                                      SNKUP022
00131 *                                                                 SNKUP022
00132 /                                                                 SNKUP022
00133 ******************************************************************SNKUP022
00134 *     SQL WARNING OR ERROR PROCESSING                            *SNKUP022
00135 *                                                                *SNKUP022
00136 ******************************************************************SNKUP022
00137                                                                   SNKUP022
00138  Z998-SQL-WARNING.                                                SNKUP022
00139 *-----------------                                                SNKUP022
00140                                                                   SNKUP022
00141      MOVE SQLCODE    TO SQLCODE2.                                 SNKUP022
00142      MOVE SQLERRD(3) TO SQLERRD3.                                 SNKUP022
00143      DISPLAY '** ABEND **       ** = SQLWARNING'.                 SNKUP022
00144      DISPLAY '** PROGRAM        ** = SNKUP022'.                   SNKUP022
00145      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  SNKUP022
00146      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  SNKUP022
00147      DISPLAY '** SQLWARN0       ** = ' SQLWARN0.                  SNKUP022
00148      DISPLAY '** SQLWARN1       ** = ' SQLWARN1.                  SNKUP022
00149      DISPLAY '** SQLWARN2       ** = ' SQLWARN2.                  SNKUP022
00150      DISPLAY '** SQLWARN3       ** = ' SQLWARN3.                  SNKUP022
00151      DISPLAY '** SQLWARN4       ** = ' SQLWARN4.                  SNKUP022
00152      DISPLAY '** SQLWARN5       ** = ' SQLWARN5.                  SNKUP022
00153      DISPLAY '** SQLWARN6       ** = ' SQLWARN6.                  SNKUP022
00154      DISPLAY '** SQLWARN7       ** = ' SQLWARN7.                  SNKUP022
00155      EXEC SQL                                                     SNKUP022
00156          COMMIT                                                   SNKUP022
00157      END-EXEC.                                                    SNKUP022
00158      MOVE +4013 TO PV-ABEND-CODE.                                 SNKUP022
00159      CALL PC-ILBOABN0 USING PV-ABEND-CODE.                        SNKUP022
00160 *                                                                 SNKUP022
00161  Z999-SQL-ERROR.                                                  SNKUP022
00162 *---------------                                                  SNKUP022
00163                                                                   SNKUP022
00164      MOVE SQLCODE    TO SQLCODE2.                                 SNKUP022
00165      MOVE SQLERRD(3) TO SQLERRD3.                                 SNKUP022
00166      DISPLAY '** ABEND **       ** = SQLERROR'.                   SNKUP022
00167      DISPLAY '** PROGRAM        ** = SNKUP022'.                   SNKUP022
00168      DISPLAY '** SQLCODE        ** = ' SQLCODE2.                  SNKUP022
00169      DISPLAY '** ROWS PROCESSED ** = ' SQLERRD3.                  SNKUP022
00170      DISPLAY '** SQLERRM        ** = ' SQLERRM.                   SNKUP022
00171      DISPLAY '** SQLERRMC       ** = ' SQLERRMC.                  SNKUP022
00172      EXEC SQL                                                     SNKUP022
00173          COMMIT                                                   SNKUP022
00174      END-EXEC.                                                    SNKUP022
00175      MOVE +4013 TO PV-ABEND-CODE.                                 SNKUP022
00176      CALL PC-ILBOABN0 USING PV-ABEND-CODE.                        SNKUP022
00177 *                                                                 SNKUP022
