000010***************************************************************** 00001000
000020** THIS PROCEDURE DIVISION COPYBOOK IS USED TO RETRIEVE THE       00002000
000021** 'LOGON INFORMATION' TEMP STORAGE QUEUE CREATED BY DPKCS028     00002100
000022** AT LOGON TIME.                                                 00002200
000023**                                                                00002300
000024** OTHER REQUIREMENTS:  DPWS026, DPWS013                          00002400
000025**                                                                00002500
000026** TO USE:                                                        00002600
000027**   PERFORM DP026-0000-GET-LOGON-INFO.                           00002700
000028**   IF  DP026-CICS-RESPONSE = DFHRESP(NORMAL)                    00002800
000029**       --ACCESS DATA IN DPWS026--                               00002900
000030**   ELSE                                                         00003000
000031**       PERFORM --ABEND PARAGRAPH(DPPD013 OR DPPD014)--          00003100
000032**   END-IF.                                                      00003200
000033****************CHANGE LOG****************                        00003300
000034** DATE      BY            DESCRIPTION                            00003400
000035** 03/04/98  CAL BUSH      INITIAL CREATION                       00003500
000040***************************************************************** 00004000
000100 DP026-0000-GET-LOGON-INFO.                                       00010000
000400     MOVE EIBTRMID  TO  DP026-QUEUE-TERM.                         00040000
000500     MOVE +1        TO  DP026-TS-ITEM.                            00050000
000501                                                                  00050100
000502     EXEC CICS                                                    00050200
000503         INQUIRE                                                  00050300
000504             TRANSACTION  (DP026-LOGON-ROUTINE)                   00050400
000505             REMOTESYSTEM (DP026-SYSID)                           00050500
000510     END-EXEC.                                                    00051000
000600                                                                  00060000
000700     IF DP026-SYSID = SPACES                                      00070000
000800         EXEC CICS                                                00080000
000900             READQ TS                                             00090000
001000                 QUEUE  (DP026-QUEUE-NAME)                        00100000
001100                 ITEM   (DP026-TS-ITEM)                           00110000
001200                 INTO   (DP026-SIGN-ON-INFO)                      00120000
001300                 RESP   (DP026-CICS-RESPONSE)                     00130000
001400         END-EXEC                                                 00140000
001500     ELSE                                                         00150000
001600         EXEC CICS                                                00160000
001700             READQ TS                                             00170000
001710                 QUEUE  (DP026-QUEUE-NAME)                        00171000
001711                 SYSID  (DP026-SYSID)                             00171100
001720                 ITEM   (DP026-TS-ITEM)                           00172000
001730                 INTO   (DP026-SIGN-ON-INFO)                      00173000
001740                 RESP   (DP026-CICS-RESPONSE)                     00174000
002400         END-EXEC                                                 00240000
002500     END-IF.                                                      00250000
002600                                                                  00260000
002700     EVALUATE TRUE                                                00270000
002800         WHEN DP026-CICS-RESPONSE = DFHRESP (NORMAL)              00280000
002900             CONTINUE                                             00290000
003100         WHEN OTHER                                               00310000
003300             MOVE PC-CURRENT-PROGRAM-NAME                         00330000
003301                                        TO DP013-PROGRAM          00330100
003302             MOVE 'DP026-0000-GET-LOGON-INFO'                     00330200
003310                                        TO DP013-PARAGRAPH        00331000
003400             MOVE 'UNABLE TO READ LOGON TSQ'                      00340000
003500                                        TO DP013-MESSAGE-TEXT (1) 00350000
003600             SET DP013-CICS-ABEND       TO TRUE                   00360000
004200     END-EVALUATE.                                                00420000
