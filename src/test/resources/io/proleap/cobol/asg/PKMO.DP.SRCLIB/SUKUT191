       IDENTIFICATION DIVISION.                                         00010001
       PROGRAM-ID.    SUKUT191.                                         00020001
       AUTHOR.        JIM ARENDT.                                       00030001
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040001
       DATE-WRITTEN.  SEPTEMBER, 2017.                                  00050001
       DATE-COMPILED.                                                   00060001
      ******************************************************************00070001
      *  DB2                                                            00080001
      * EXTRACT THE SML'S THAT ARE MANIFESTED TO THE STATUS DC SHIPPED  00090025
      * TRAILERS.                                                       00100025
      ******************************************************************00110001
      * DATE: 09/2017 MADE BY:JIM ARENDT  INITIAL IMPLEMENTATION        00120001
      ******************************************************************00130001
       ENVIRONMENT DIVISION.                                            00140001
       CONFIGURATION SECTION.                                           00150001
       SOURCE-COMPUTER.    IBM-3090.                                    00160001
       OBJECT-COMPUTER.    IBM-3090.                                    00170001
       INPUT-OUTPUT SECTION.                                            00180001
       FILE-CONTROL.                                                    00190001
                                                                        00200001
           SELECT INPUT-EXTRACT-DS-FILE                                 00210002
                  ASSIGN TO INP01.                                      00220001
                                                                        00230001
           SELECT OUTPUT-SML-FILE                                       00240001
                  ASSIGN TO OUT01.                                      00250001
                                                                        00260001
       DATA DIVISION.                                                   00270001
       FILE SECTION.                                                    00280001
                                                                        00290001
       FD  INPUT-EXTRACT-DS-FILE                                        00300002
           RECORDING MODE IS F                                          00310001
           LABEL RECORDS OMITTED                                        00320001
           BLOCK CONTAINS 0 RECORDS                                     00330001
           DATA RECORD IS INPUT-EXTRACT-DS-RECORD.                      00340002
       01  INPUT-EXTRACT-DS-RECORD             PIC  X(250).             00350009
                                                                        00360001
       FD  OUTPUT-SML-FILE                                              00370001
           RECORDING MODE IS F                                          00380001
           LABEL RECORDS OMITTED                                        00390001
           BLOCK CONTAINS 0 RECORDS                                     00400001
           DATA RECORD IS OUTPUT-SML-RECORD.                            00410001
       01  OUTPUT-SML-RECORD                   PIC  X(250).             00420009
                                                                        00430001
       WORKING-STORAGE SECTION.                                         00440001
                                                                        00450001
      ******************************************************************00460001
      * PROGRAM CONSTANTS                                               00470001
      ******************************************************************00480001
       01  PC-CONSTANTS-FIELDS.                                         00490001
           05  PC-PGM-NAME                     PIC  X(08) VALUE         00500001
                                                          'SUKUT191'.   00510001
           05  PC-MAX-RETRIES                  PIC S9(03) VALUE +3      00520001
                                                          COMP-3.       00530001
                                                                        00540001
      ******************************************************************00550001
      * PROGRAM VARIABLES                                               00560001
      ******************************************************************00570001
       01  PV-VARIABLE-FIELDS.                                          00580001
           05  PV-PARAGRAPH-NAME               PIC  X(30) VALUE SPACE.  00590001
           05  PV-DB2-OPERATION                PIC  X(30) VALUE SPACE.  00600001
           05  PV-RETRY-COUNTER                PIC S9(04) VALUE ZEROS   00610001
                                                          COMP SYNC.    00620001
           05  PV-NULL-IND                     PIC S9(04) VALUE ZERO    00630021
                                                          COMP SYNC.    00640021
           05  PV-EDIT-FIELD                   PIC  ZZZ,ZZZ,ZZ9.        00650014
           05  PV-TRIP-ID                      PIC S9(09) COMP.         00660002
           05  PV-TIMESTAMP.                                            00670018
               10  PV-DATE-FIELD               PIC  X(10) VALUE SPACES. 00680018
               10  FILLER                      PIC  X(01) VALUE SPACES. 00690018
               10  PV-TIME-FIELD.                                       00700018
                   15 PV-TIME-HH               PIC  X(02) VALUE SPACES. 00710018
                   15 PV-TIME-COLON1           PIC  X(01) VALUE SPACES. 00720018
                   15 PV-TIME-MM               PIC  X(02) VALUE SPACES. 00730018
                   15 PV-TIME-COLON2           PIC  X(01) VALUE SPACES. 00740018
                   15 PV-TIME-MM               PIC  X(02) VALUE SPACES. 00750018
               10  FILLER                      PIC  X(07) VALUE SPACES. 00760018
                                                                        00770001
      ******************************************************************00780001
      * PROGRAM ACCUMULATORS                                            00790001
      ******************************************************************00800001
       01  PA-PROGRAM-ACCUMULATORS.                                     00810001
           05  PA-INPUT-RECORDS-READ           PIC  9(09) VALUE ZEROS.  00820002
           05  PA-DTL-RECORDS-READ             PIC  9(09) VALUE ZEROS.  00830002
           05  PA-OUTPUT-RECS-WROTE            PIC  9(09) VALUE ZEROS.  00840002
                                                                        00850001
      ******************************************************************00860001
      * PROGRAM SWITCHES                                                00870001
      ******************************************************************00880001
       01  PS-SWITCH-AREAS.                                             00890001
           05  PS-FIRST-TIME-SW                PIC  X(01) VALUE 'Y'.    00900025
               88  PS-FIRST-TIME-Y                        VALUE 'Y'.    00910002
               88  PS-FIRST-TIME-N                        VALUE 'N'.    00920002
           05  PS-END-OF-INPUT-FILE-SW         PIC  X(01) VALUE 'N'.    00930002
               88  PS-END-OF-INPUT-FILE                   VALUE 'Y'.    00940002
               88  PS-NOT-END-OF-FILE                     VALUE 'N'.    00950002
           05  PS-SML-CSR-EOF-SW               PIC  X(01) VALUE 'N'.    00960002
               88  PS-SML-CSR-EOF                         VALUE 'Y'.    00970002
               88  PS-SML-CSR-NOT-EOF                     VALUE 'N'.    00980002
           05  PS-RECORD-FOUND-SW              PIC  X(01) VALUE 'N'.    00990024
               88  PS-RECORD-FOUND                        VALUE 'Y'.    01000024
               88  PS-RECORD-NOT-FOUND                    VALUE 'N'.    01010024
                                                                        01020001
      ******************************************************************01030001
      * ABEND INFORMATION                                               01040001
      ******************************************************************01050001
       01  ABEND-CODE                          PIC S9(04) VALUE ZEROS   01060001
                                                          COMP SYNC.    01070001
           88  ABEND-4001-WRITE-ERROR                     VALUE +4001.  01080001
           88  ABEND-4002-READ-ERROR                      VALUE +4002.  01090001
           88  ABEND-4003-CTRL-CARD-ERROR                 VALUE +4003.  01100001
           88  ABEND-4004-TABLE-ERROR                     VALUE +4004.  01110001
           88  ABEND-4005-OPEN-ERROR                      VALUE +4005.  01120001
           88  ABEND-4006-CLOSE-ERROR                     VALUE +4006.  01130001
           88  ABEND-4007-SEQUENCE-ERROR                  VALUE +4007.  01140001
           88  ABEND-4008-DATA-ERROR                      VALUE +4008.  01150001
           88  ABEND-4009-KEY-DATA-ERROR                  VALUE +4009.  01160001
           88  ABEND-4013-DB2-ERROR                       VALUE +4013.  01170001
           88  ABEND-4019-CAL-SUB-ERROR                   VALUE +4019.  01180001
           88  ABEND-4020-MQ-ERROR                        VALUE +4020.  01190001
           88  ABEND-4444-FORCED-ABEND                    VALUE +4444.  01200001
                                                                        01210001
      ******************************************************************01220001
      ****ABEND ROUTINE INFORMATION                                     01230001
           COPY SQLCA2.                                                 01240001
                                                                        01250001
      ****ABEND ROUTINE INFORMATION                                     01260001
           COPY DPWS004.                                                01270001
                                                                        01280001
      ****INPUT/OUTPUT COPYBOOK                                         01290009
           COPY SURD163.                                                01300002
                                                                        01310001
      ******************************************************************01320001
      * TABLE INCLUSIONS                                                01330001
      ******************************************************************01340001
      ** SUT_OTBND_CART TABLE                                           01350001
           EXEC SQL INCLUDE SUT00024 END-EXEC.                          01360001
                                                                        01370001
      ** SUT_OTBND_STR_SCN TABLE                                        01380017
           EXEC SQL INCLUDE SUT00121 END-EXEC.                          01390017
                                                                        01400017
      ** DB2 TABLE INCLUSION                                            01410005
           EXEC SQL INCLUDE SQLCA    END-EXEC.                          01420005
                                                                        01430005
      ******************************************************************01440001
      * CURSOR TO RETRIEVE EXTRACT SML'S THAT ARE MANIFESTED TO         01450001
      * DC SHIPPED TRAILERS FOR 'DS'(DC SHIPPED)                        01460001
      ******************************************************************01470001
           EXEC SQL                                                     01480001
             DECLARE SML_CSR CURSOR FOR                                 01490001
               SELECT A.SHIPT_UNT_ID                                    01500001
                     ,A.ORGN_LOC_NBR                                    01510002
                     ,A.DEST_LOC_NBR                                    01520002
                     ,A.CART_SRC_CDE                                    01530002
                     ,A.CRE_DTE                                         01540002
                     ,A.CRE_TM                                          01550002
                     ,A.ORIG_CART_ID                                    01560002
                     ,A.ACTV_IND                                        01570002
                 FROM SUT_OTBND_CART A                                  01580001
                WHERE A.OTBND_TRIP_ID = :PV-TRIP-ID                     01590002
               WITH UR                                                  01600001
          END-EXEC.                                                     01610001
                                                                        01620001
       PROCEDURE DIVISION.                                              01630001
      ******************************************************************01640001
       0000-MAINLINE-PROCESSING.                                        01650001
                                                                        01660001
           PERFORM 1000-INITIALIZATION.                                 01670001
                                                                        01680001
           PERFORM 2000-PROCESS-INPUT-FILE                              01690003
             UNTIL PS-END-OF-INPUT-FILE.                                01700003
                                                                        01710001
           PERFORM 9000-WRAPUP.                                         01720001
           GOBACK.                                                      01730001
                                                                        01740001
      ******************************************************************01750001
      * INITIALIZATION ROUTINE                                          01760001
      ******************************************************************01770001
       1000-INITIALIZATION.                                             01780001
                                                                        01790001
           DISPLAY ' '.                                                 01800001
           DISPLAY '*******************************************'.       01810001
           DISPLAY '***  PROGRAM NAME:  '  PC-PGM-NAME.                 01820001
           DISPLAY ' '.                                                 01830001
                                                                        01840001
           OPEN INPUT  INPUT-EXTRACT-DS-FILE                            01850002
                OUTPUT OUTPUT-SML-FILE.                                 01860002
                                                                        01870001
           PERFORM 1100-READ-INPUT-FILE.                                01880002
                                                                        01890001
      ******************************************************************01900001
      * READ THE INPUT STATUS 'DS'(DC SHIPPED) TRAILER FILE             01910026
      ******************************************************************01920001
       1100-READ-INPUT-FILE.                                            01930002
                                                                        01940001
           READ INPUT-EXTRACT-DS-FILE INTO SU163-EXTRACT-RECORD         01950010
              AT END                                                    01960001
                 SET PS-END-OF-INPUT-FILE TO TRUE.                      01970001
                                                                        01980001
           IF PS-END-OF-INPUT-FILE                                      01990001
               IF PS-FIRST-TIME-Y                                       02000002
                  DISPLAY ' '                                           02010002
                  DISPLAY '-- INPUT FILE MISSING --'                    02020002
                  DISPLAY ' '                                           02030002
               END-IF                                                   02040002
           ELSE                                                         02050002
               ADD 1                     TO PA-INPUT-RECORDS-READ       02060002
               MOVE SU163-OTBND-TRIP-ID  TO PV-TRIP-ID                  02070010
               SET PS-FIRST-TIME-N       TO TRUE                        02080002
           END-IF.                                                      02090002
                                                                        02100001
      ******************************************************************02110001
      * OPEN THE SML CURSOR                                             02120002
      ******************************************************************02130001
       1200-OPEN-SML-CSR.                                               02140002
                                                                        02150001
           EXEC SQL                                                     02160001
             OPEN SML_CSR                                               02170001
           END-EXEC.                                                    02180001
                                                                        02190001
           EVALUATE TRUE                                                02200001
               WHEN SQLCODE = +0                                        02210001
               WHEN SQLCODE = -904                                      02220001
               WHEN SQLCODE = -911                                      02230001
               WHEN SQLCODE = -913                                      02240001
                    CONTINUE                                            02250001
                                                                        02260001
               WHEN SQLWARN0 NOT EQUAL SPACE                            02270001
               WHEN SQLCODE NOT EQUAL ZERO                              02280001
                    DISPLAY ' ERROR TRIP-ID = '                         02290014
                                              PV-TRIP-ID                02300016
                    MOVE '1200-OPEN-SML-CSR'                            02310002
                                           TO PV-PARAGRAPH-NAME         02320001
                    MOVE 'ERROR ON OPEN OF SML_CSR'                     02330001
                                           TO PV-DB2-OPERATION          02340001
                    SET ABEND-4005-OPEN-ERROR TO TRUE                   02350001
                    PERFORM 9200-SQL-ABEND                              02360001
                                                                        02370001
           END-EVALUATE.                                                02380001
                                                                        02390001
      ******************************************************************02400001
      * RETRIEVE THE SML TRAILER DATA                                   02410002
      ******************************************************************02420001
       1300-FETCH-SML-CSR.                                              02430002
                                                                        02440001
           PERFORM                                                      02450001
               WITH TEST AFTER                                          02460001
               VARYING PV-RETRY-COUNTER                                 02470001
               FROM 1 BY 1                                              02480001
               UNTIL (PV-RETRY-COUNTER > PC-MAX-RETRIES)                02490001
                   OR (SQLCODE = +0                                     02500001
                   OR  SQLCODE = +100)                                  02510001
                                                                        02520001
               EXEC SQL                                                 02530001
                  FETCH SML_CSR                                         02540001
                    INTO  :SUT00024-SHIPT-UNT-ID                        02550002
                         ,:SUT00024-ORGN-LOC-NBR                        02560002
                         ,:SUT00024-DEST-LOC-NBR                        02570002
                         ,:SUT00024-CART-SRC-CDE                        02580002
                         ,:SUT00024-CRE-DTE                             02590002
                         ,:SUT00024-CRE-TM                              02600002
                         ,:SUT00024-ORIG-CART-ID                        02610002
                         ,:SUT00024-ACTV-IND                            02620002
               END-EXEC                                                 02630001
                                                                        02640001
               EVALUATE TRUE                                            02650001
                   WHEN SQLCODE = ZERO                                  02660001
                       ADD 1                     TO PA-DTL-RECORDS-READ 02670002
                                                                        02680001
                   WHEN SQLCODE = +100                                  02690001
                       SET PS-SML-CSR-EOF        TO TRUE                02700002
                                                                        02710001
                   WHEN SQLCODE = -904                                  02720001
                   WHEN SQLCODE = -911                                  02730001
                   WHEN SQLCODE = -913                                  02740001
                       CONTINUE                                         02750001
                                                                        02760001
                   WHEN SQLWARN0 NOT EQUAL SPACE                        02770001
                   WHEN SQLCODE NOT EQUAL ZERO                          02780001
                       DISPLAY ' ERROR TRIP-ID = '  PV-TRIP-ID          02790016
                       MOVE '1300-FETCH-SML-CSR' TO PV-PARAGRAPH-NAME   02800002
                       MOVE 'ERROR ON FETCHING SML_CSR'                 02810001
                                                 TO PV-DB2-OPERATION    02820001
                       SET ABEND-4002-READ-ERROR TO TRUE                02830001
                       PERFORM 9200-SQL-ABEND                           02840001
                                                                        02850001
               END-EVALUATE                                             02860001
           END-PERFORM.                                                 02870001
                                                                        02880001
           IF (PV-RETRY-COUNTER > PC-MAX-RETRIES)                       02890001
               DISPLAY ' ERROR TRIP-ID = '         PV-TRIP-ID           02900016
               MOVE '1300-FETCH-SML-CSR'        TO PV-PARAGRAPH-NAME    02910002
               MOVE 'MAX RETRIES EXCEEDED'      TO PV-DB2-OPERATION     02920001
               SET ABEND-4002-READ-ERROR        TO TRUE                 02930001
               PERFORM 9200-SQL-ABEND                                   02940001
           END-IF.                                                      02950001
                                                                        02960001
      ******************************************************************02970001
      * PROCESS ALL THE RECORDS IN THE INPUT FILE                       02980003
      ******************************************************************02990001
       2000-PROCESS-INPUT-FILE.                                         03000003
                                                                        03010001
           SET PS-SML-CSR-NOT-EOF  TO TRUE.                             03020007
           PERFORM 1200-OPEN-SML-CSR.                                   03030003
                                                                        03040002
           PERFORM 1300-FETCH-SML-CSR.                                  03050003
           IF PS-SML-CSR-EOF                                            03060003
              CONTINUE                                                  03070003
                                                                        03080003
           ELSE                                                         03090003
              PERFORM 2300-PROCESS-RECORDS                              03100003
                UNTIL PS-SML-CSR-EOF                                    03110003
                                                                        03120003
           END-IF.                                                      03130003
                                                                        03140001
           PERFORM 3000-CLOSE-SML-CSR.                                  03150006
                                                                        03160006
           PERFORM 1100-READ-INPUT-FILE.                                03170003
                                                                        03180001
      ******************************************************************03190001
      * POPULATE THE OUTPUT RECORD                                      03200001
      ******************************************************************03210001
       2300-PROCESS-RECORDS.                                            03220001
                                                                        03230017
           MOVE SUT00024-SHIPT-UNT-ID     TO SU163-SHIPT-UNIT-ID.       03240005
           MOVE SUT00024-ORGN-LOC-NBR     TO SU163-SML-ORGN-LOC-NBR.    03250002
           MOVE SUT00024-DEST-LOC-NBR     TO SU163-SML-DEST-LOC-NBR.    03260002
           MOVE SUT00024-CART-SRC-CDE     TO SU163-CART-SRC-CDE.        03270010
           MOVE SUT00024-ORIG-CART-ID     TO SU163-ORIG-CART-ID.        03280010
           MOVE SUT00024-ACTV-IND         TO SU163-ACTV-IND.            03290010
           MOVE SUT00024-CRE-DTE          TO SU163-SML-CRE-DTE.         03300016
           IF SUT00024-CRE-TM > SPACES                                  03310016
              MOVE SUT00024-CRE-TM        TO PV-TIME-FIELD              03320016
              MOVE ':'                    TO PV-TIME-COLON1             03330016
                                             PV-TIME-COLON2             03340016
              MOVE PV-TIME-FIELD          TO SU163-SML-CRE-TM           03350016
           END-IF.                                                      03360016
                                                                        03370017
           PERFORM 4000-SELECT-DATA.                                    03380017
                                                                        03390017
           IF PS-RECORD-FOUND                                           03400024
              MOVE SUT00121-CRE-TMST      TO PV-TIMESTAMP               03410027
              MOVE PV-DATE-FIELD          TO SU163-STR-SCAN-DATE        03420027
              MOVE ':'                    TO PV-TIME-COLON1             03430027
                                             PV-TIME-COLON2             03440017
              MOVE PV-TIME-FIELD          TO SU163-STR-SCAN-TIME        03450027
                                                                        03460018
              MOVE SUT00121-SCN-LOC-NBR   TO SU163-STR-SCAN-LOC         03470024
              MOVE SUT00121-SCN-TYP-CDE   TO SU163-STR-SCAN-TYPE-CDE    03480024
              MOVE SUT00121-ORIG-OTBND-TRIP-ID                          03490024
                                          TO SU163-STR-SCAN-ORIG-TRIP-ID03500017
              MOVE SUT00121-SCN-FR-MSTR-IND                             03510024
                                          TO SU163-STR-SCAN-FR-MSTR-IND 03520024
           END-IF.                                                      03530024
                                                                        03540017
           PERFORM 2400-WRITE-OUTPUT-RECORD.                            03550002
                                                                        03560001
           PERFORM 1300-FETCH-SML-CSR.                                  03570003
                                                                        03580003
      ******************************************************************03590001
      * WRITE THE OUTPUT RECORD                                         03600002
      ******************************************************************03610001
       2400-WRITE-OUTPUT-RECORD.                                        03620002
                                                                        03630001
           WRITE OUTPUT-SML-RECORD FROM SU163-EXTRACT-RECORD.           03640002
                                                                        03650002
           ADD +1              TO PA-OUTPUT-RECS-WROTE.                 03660002
                                                                        03670002
      ******************************************************************03680001
      * CLOSE THE SML CURSOR                                            03690002
      ******************************************************************03700001
       3000-CLOSE-SML-CSR.                                              03710002
                                                                        03720001
           EXEC SQL                                                     03730001
              CLOSE SML_CSR                                             03740001
           END-EXEC.                                                    03750001
                                                                        03760001
           EVALUATE TRUE                                                03770001
               WHEN SQLCODE = +0                                        03780001
               WHEN SQLCODE = -904                                      03790001
               WHEN SQLCODE = -911                                      03800001
               WHEN SQLCODE = -913                                      03810001
                    CONTINUE                                            03820001
                                                                        03830001
               WHEN SQLWARN0 NOT EQUAL SPACE                            03840001
               WHEN SQLCODE NOT EQUAL ZERO                              03850001
                    MOVE '3000-CLOSE-SML-CSR'   TO PV-PARAGRAPH-NAME    03860002
                    MOVE 'ERROR ON CLOSE OF SML_CSR'                    03870001
                                                TO PV-DB2-OPERATION     03880001
                    SET ABEND-4006-CLOSE-ERROR  TO TRUE                 03890001
                    PERFORM 9200-SQL-ABEND                              03900001
                                                                        03910001
           END-EVALUATE.                                                03920001
                                                                        03930001
      ******************************************************************03940017
       4000-SELECT-DATA.                                                03950017
                                                                        03960017
           EXEC SQL                                                     03970017
              SELECT CRE_TMST                                           03980023
                    ,SCN_LOC_NBR                                        03990017
                    ,SCN_TYP_CDE                                        04000017
                    ,ORIG_OTBND_TRIP_ID                                 04010017
                    ,SCN_FR_MSTR_IND                                    04020017
                INTO :SUT00121-CRE-TMST                                 04030023
                    ,:SUT00121-SCN-LOC-NBR                              04040017
                    ,:SUT00121-SCN-TYP-CDE                              04050017
                    ,:SUT00121-ORIG-OTBND-TRIP-ID                       04060017
                     :PV-NULL-IND                                       04070021
                    ,:SUT00121-SCN-FR-MSTR-IND                          04080017
                FROM SUT_OTBND_STR_SCN                                  04090017
               WHERE SHIPT_UNT_ID  = :SUT00024-SHIPT-UNT-ID             04100019
                   ORDER BY CRE_TMST DESC                               04110022
                 FETCH FIRST 1 ROW ONLY                                 04120022
                WITH UR                                                 04130017
           END-EXEC.                                                    04140017
                                                                        04150017
           EVALUATE TRUE                                                04160017
               WHEN SQLCODE = ZERO                                      04170017
                   SET PS-RECORD-FOUND       TO TRUE                    04180024
                   IF PV-NULL-IND = -1                                  04190021
                      MOVE ZEROES            TO                         04200021
                                             SUT00121-ORIG-OTBND-TRIP-ID04210021
                   END-IF                                               04220021
                                                                        04230017
               WHEN SQLCODE = +100                                      04240017
                   SET PS-RECORD-NOT-FOUND   TO TRUE                    04250024
                                                                        04260017
               WHEN SQLWARN0 NOT EQUAL SPACE                            04270017
               WHEN SQLCODE NOT EQUAL ZERO                              04280017
                   DISPLAY ' ERROR TRIP-ID = '  PV-TRIP-ID              04290017
                   DISPLAY ' ERROR SHIP-UNT-ID= '                       04300017
                                                SUT00024-SHIPT-UNT-ID   04310020
                   MOVE '4000-SELECT-DATA'   TO PV-PARAGRAPH-NAME       04320017
                   MOVE 'ERROR SELECTING DATA'                          04330017
                                             TO PV-DB2-OPERATION        04340017
                   SET ABEND-4002-READ-ERROR TO TRUE                    04350017
                   PERFORM 9200-SQL-ABEND                               04360017
                                                                        04370017
           END-EVALUATE.                                                04380017
                                                                        04390017
      ******************************************************************04400001
      * CLOSE INPUT/OUTPUT FILES AND DISPLAY PROGRAM COUNTS             04410001
      ******************************************************************04420001
       9000-WRAPUP.                                                     04430001
                                                                        04440001
           CLOSE INPUT-EXTRACT-DS-FILE                                  04450002
                 OUTPUT-SML-FILE.                                       04460002
                                                                        04470001
           PERFORM 9100-DISPLAY-COUNTS.                                 04480001
                                                                        04490001
      ******************************************************************04500001
      * DISPLAY PROGRAM COUNTS                                          04510001
      ******************************************************************04520001
       9100-DISPLAY-COUNTS.                                             04530001
                                                                        04540001
           MOVE PA-INPUT-RECORDS-READ             TO PV-EDIT-FIELD.     04550008
           DISPLAY ' INPUT RECORDS READ.......: '    PV-EDIT-FIELD.     04560008
                                                                        04570002
           MOVE PA-DTL-RECORDS-READ               TO PV-EDIT-FIELD.     04580008
           DISPLAY ' DETAIL CSR RECORDS READ..: '    PV-EDIT-FIELD.     04590008
                                                                        04600001
           MOVE PA-OUTPUT-RECS-WROTE              TO PV-EDIT-FIELD.     04610008
           DISPLAY ' OUTPUT RECORDS WROTE.....: '    PV-EDIT-FIELD.     04620008
                                                                        04630001
           DISPLAY ' '.                                                 04640001
           DISPLAY '*******************************************'.       04650001
           DISPLAY ' '.                                                 04660001
                                                                        04670001
      ******************************************************************04680001
      * ABEND ROUTINE FOR BAD SQL CALLS                                 04690001
      ******************************************************************04700001
       9200-SQL-ABEND.                                                  04710001
                                                                        04720001
           DISPLAY '** ABEND     **'.                                   04730001
           DISPLAY '** PROGRAM   ** = ' PC-PGM-NAME.                    04740001
           DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.              04750001
           DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION.               04760001
           DISPLAY '** SQLCODE   ** = ' SQLCODE.                        04770001
                                                                        04780001
      ***************************************************************** 04790001
      *    COPY BOOK CONTAINING PROCEDURE DIVISION STATEMENTS REQUIRED  04800001
      *    TO UTILIZE SQLCA MESSAGE DISPLAY MODULE 'DSNTIAR' FOLLOWS.   04810001
      ***************************************************************** 04820001
           COPY DPPD004.                                                04830001
                                                                        04840001
           CALL 'ILBOABN0' USING ABEND-CODE.                            04850001
