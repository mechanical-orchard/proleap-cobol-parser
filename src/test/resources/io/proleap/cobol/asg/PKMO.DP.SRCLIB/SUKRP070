000100******************************************************************00010000
000110 IDENTIFICATION DIVISION.                                         00020000
000120******************************************************************00030000
000130                                                                  00040000
000140 PROGRAM-ID.             SUKRP070.                                00050099
000150 AUTHOR.                 JIM ARENDT.                              00060099
000160 INSTALLATION.           KOHLS.                                   00070000
000170 DATE-WRITTEN            JUNE, 2016.                              00080099
000180 DATE-COMPILED.                                                   00090000
000190                                                                  00100000
000200******************************************************************00110000
000300*       THIS PROGRAM WILL PRINT THE SHORTED CARTON REPORT FOR     00120099
000400*  UNLOADED TRAILERS.                                             00130099
000500******************************************************************00140000
001700 ENVIRONMENT DIVISION.                                            00150000
001800******************************************************************00160000
001900                                                                  00170000
002000 CONFIGURATION SECTION.                                           00180000
002100                                                                  00190000
002200 SOURCE-COMPUTER.        IBM-3090.                                00200000
002300 OBJECT-COMPUTER.        IBM-3090.                                00210000
002400                                                                  00220000
002500 INPUT-OUTPUT SECTION.                                            00230000
002600                                                                  00240000
002700 FILE-CONTROL.                                                    00250000
002800                                                                  00260000
004100     SELECT TRAILER-THEFT-RPT                                     00270099
004200         ASSIGN TO RPT01.                                         00280000
004300                                                                  00290000
004507******************************************************************00300000
004508 DATA DIVISION.                                                   00310000
004509******************************************************************00320000
004510                                                                  00330000
004511 FILE SECTION.                                                    00340000
006800                                                                  00350000
006900 FD  TRAILER-THEFT-RPT                                            00360099
007000     RECORDING MODE IS F                                          00370000
007100     LABEL RECORDS ARE STANDARD                                   00380000
007200     BLOCK CONTAINS 0 RECORDS.                                    00390000
007300                                                                  00400000
007400 01  TRAILER-THEFT-RPT-LINE              PIC  X(132).             00410099
007500                                                                  00420000
008300******************************************************************00430000
008400 WORKING-STORAGE SECTION.                                         00440000
008500******************************************************************00450000
008600                                                                  00460000
048900 01  PC-CONSTANTS.                                                00470099
049000     05  PC-MAX-REPORT-LINES             PIC S9(04)  VALUE +60    00480099
049100                                                     COMP SYNC.   00490099
050500     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00500099
050600                                                     'SUKRP070'.  00510099
050700     05  PC-CURRENT-JOB-NAME             PIC  X(08)  VALUE        00520099
050800                                                     'SUK020  '.  00530099
052660                                                                  00540099
004507******************************************************************00550099
057319 01  PV-PROGRAM-VARIABLES.                                        00560099
057320     05  PV-CURRENT-TMST                 PIC  X(26)  VALUE SPACES.00570099
057320     05  PV-CURRENT-TMST-R  REDEFINES PV-CURRENT-TMST.            00580099
064000         10  PV-CURRENT-DT               PIC  X(10).              00590099
064000         10  PV-CURRENT-TM               PIC  X(16).              00600099
101170     05  PV-DATE-LIMIT                   PIC  X(10).              00610099
064440     05  PV-DISP-DEC                     PIC  Z,ZZZ,ZZ9.          00620099
012200     05  PV-MIN-COUNT                    PIC S9(09)V COMP-3.      00630099
012200     05  PV-DIFFERENCE                   PIC S9(09)V COMP-3.      00640099
067100     05  PV-HOLD-OPER-UNT-ID             PIC S9(04)  COMP.        00650099
017800     05  PV-PAGE-COUNT                   PIC  9(04)  VALUE 0      00660099
017800                                                     COMP SYNC.   00670099
017900     05  PV-LINE-COUNT                   PIC  9(09)  VALUE 0      00680099
017900                                                     COMP SYNC.   00690099
065750     05  PV-CURRENT-DATE.                                         00700099
065760         10  PV-CURRENT-DATE-CCYY        PIC  X(04).              00710099
065770         10  FILLER                      PIC  X(01).              00720099
065780         10  PV-CURRENT-DATE-MM          PIC  X(02).              00730099
065790         10  FILLER                      PIC  X(01).              00740099
065800         10  PV-CURRENT-DATE-DD          PIC  X(02).              00750099
066000     05  PV-CURRENT-TIME.                                         00760099
066200         10  FILLER                      PIC  X(01).              00770099
066100         10  PV-CURRENT-TIME-HH          PIC  X(02).              00780099
066200         10  FILLER                      PIC  X(01).              00790099
066300         10  PV-CURRENT-TIME-MM          PIC  X(02).              00800099
066400         10  FILLER                      PIC  X(01).              00810099
066500         10  PV-CURRENT-TIME-SS          PIC  X(02).              00820099
066400         10  FILLER                      PIC  X(07).              00830099
075500     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 00840099
075600     05  PV-DB2-OPERATION-ATTEMPTED      PIC  X(30)  VALUE SPACE. 00850099
081400                                                                  00860099
004507******************************************************************00870099
057319 01  PA-PROGRAM-COUNTERS.                                         00880099
057320     05  PA-DRIVERS-READ                 PIC  9(07)  VALUE ZERO.  00890099
057320     05  PA-DETAIL-READ                  PIC  9(07)  VALUE ZERO.  00900099
057320     05  PA-DETAIL-BYPASSED              PIC  9(07)  VALUE ZERO.  00910099
057320     05  PA-NO-DETAIL-FOUND              PIC  9(07)  VALUE ZERO.  00920099
057320     05  PA-RECORDS-WROTE                PIC  9(07)  VALUE ZERO.  00930099
017800                                                                  00940099
004507******************************************************************00950099
053197 01  PS-PROGRAM-SWITCHES.                                         00960099
053199     05  PS-FIRST-TIME-SW                PIC  X(01)  VALUE 'Y'.   00970099
053200         88  PS-FIRST-TIME                           VALUE 'Y'.   00980099
053201         88  PS-NOT-FIRST-TIME                       VALUE 'N'.   00990099
053199     05  PS-FIRST-DETAIL-SW              PIC  X(01)  VALUE 'N'.   01000099
053200         88  PS-FIRST-DETAIL-YES                     VALUE 'Y'.   01010099
053201         88  PS-FIRST-DETAIL-NO                      VALUE 'N'.   01020099
053199     05  PS-BYPASS-SW                    PIC  X(01)  VALUE 'N'.   01030099
053200         88  PS-BYPASS                               VALUE 'Y'.   01040099
053201         88  PS-DONT-BYPASS                          VALUE 'N'.   01050099
053199     05  PS-END-OF-DRIVER-CSR-SW         PIC  X(01)  VALUE 'N'.   01060099
053200         88  PS-END-OF-DRIVER-CSR                    VALUE 'Y'.   01070099
053201         88  PS-NOT-END-OF-DRIVER-CSR                VALUE 'N'.   01080099
053199     05  PS-END-OF-DETAIL-CSR-SW         PIC  X(01)  VALUE 'N'.   01090099
053200         88  PS-END-OF-DETAIL-CSR                    VALUE 'Y'.   01100099
053201         88  PS-NOT-END-OF-DETAIL-CSR                VALUE 'N'.   01110099
057318                                                                  01120099
010500******************************************************************01130099
045500 01  DK-DB2-KEY-VALUE.                                            01140099
046000     05  DK-PO-NBR                       PIC S9(09)  COMP.        01150099
046100     05  DK-REC-SEQ-NBR                  PIC S9(09)  COMP.        01160099
046100     05  DK-TRIP-ID                      PIC S9(09)  COMP.        01170099
057318                                                                  01180099
010500******************************************************************01190099
009000*  STANDARD REPORT HEADER FOR A 132 COLUMN REPORT.                01200000
010500******************************************************************01210099
009200     COPY DPWS132.                                                01220000
009300                                                                  01230000
010500******************************************************************01240099
010100*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'                      01250000
010500******************************************************************01260099
010300     COPY DPWS004.                                                01270000
009900                                                                  01280099
011900 01  ABEND-CODE                          PIC S9(04)  VALUE +0     01290099
012000                                                     COMP SYNC.   01300000
009900                                                                  01310099
012100******************************************************************01320000
012200*     PAGE HEADINGS        PAGE HEADINGS         PAGE HEADING     01330099
012300******************************************************************01340000
012400 01  PH1-PAGE-HEADING-1.                                          01350099
012500     05  FILLER                          PIC  X(37)  VALUE SPACE. 01360099
012600     05  FILLER                          PIC  X(47)  VALUE        01370099
012700         'SHORTED CARTON REPORT FOR UNLOADED TRAILERS ON '.       01380099
012800     05  PH2-DATE                        PIC  X(10).              01390099
012800     05  FILLER                          PIC  X(37)  VALUE SPACE. 01400099
012900                                                                  01410099
012400 01  PH1-PAGE-HEADING-2.                                          01420099
012500     05  FILLER                          PIC  X(51)  VALUE SPACE. 01430099
012600     05  FILLER                          PIC  X(11)  VALUE        01440099
012700         'SHORTED BY '.                                           01450099
012800     05  PH2-SHORTED-NBR                 PIC  ZZ9.                01460099
012600     05  FILLER                          PIC  X(16)  VALUE        01470099
012700         ' OR MORE CARTONS'.                                      01480099
012800     05  FILLER                          PIC  X(50)  VALUE SPACE. 01490099
012900                                                                  01500099
026176******************************************************************01510099
026177*     DETAIL HEADINGS      DETAIL HEADINGS       DETAIL HEADINGS  01520099
026178******************************************************************01530099
026180 01  DH1-DETAIL-HEADING-1.                                        01540099
013400     05  FILLER                          PIC  X(91)  VALUE SPACE. 01550099
013200     05  FILLER                          PIC  X(11)  VALUE        01560099
013300         'RCVR   RCVR'.                                           01570099
013400     05  FILLER                          PIC  X(30)  VALUE SPACE. 01580099
012900                                                                  01590099
026180 01  DH1-DETAIL-HEADING-2.                                        01600099
013400     05  FILLER                          PIC  X(01)  VALUE SPACE. 01610099
013200     05  FILLER                          PIC  X(02)  VALUE        01620099
013300         'DC'.                                                    01630099
013400     05  FILLER                          PIC  X(44)  VALUE SPACE. 01640099
013200     05  FILLER                          PIC  X(09)  VALUE        01650099
013300         'REC  DEPT'.                                             01660099
013400     05  FILLER                          PIC  X(36)  VALUE SPACE. 01670099
013200     05  FILLER                          PIC  X(10)  VALUE        01680099
013300         'EXP    ACT'.                                            01690099
013400     05  FILLER                          PIC  X(30)  VALUE SPACE. 01700099
012900                                                                  01710099
026180 01  DH1-DETAIL-HEADING-3.                                        01720099
013400     05  FILLER                          PIC  X(01)  VALUE SPACE. 01730099
013200     05  FILLER                          PIC  X(03)  VALUE        01740099
013300         'NBR'.                                                   01750099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 01760099
013200     05  FILLER                          PIC  X(07)  VALUE        01770099
013300         'TRIP ID'.                                               01780099
013400     05  FILLER                          PIC  X(04)  VALUE SPACE. 01790099
013200     05  FILLER                          PIC  X(04)  VALUE        01800099
013300         'SCAC'.                                                  01810099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 01820099
013200     05  FILLER                          PIC  X(07)  VALUE        01830099
013300         'TRAILER'.                                               01840099
013400     05  FILLER                          PIC  X(05)  VALUE SPACE. 01850099
013200     05  FILLER                          PIC  X(09)  VALUE        01860099
013300         'PO NUMBER'.                                             01870099
013400     05  FILLER                          PIC  X(03)  VALUE SPACE. 01880099
013200     05  FILLER                          PIC  X(03)  VALUE        01890099
013300         'SEQ'.                                                   01900099
013400     05  FILLER                          PIC  X(03)  VALUE SPACE. 01910099
013200     05  FILLER                          PIC  X(03)  VALUE        01920099
013300         'NBR'.                                                   01930099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 01940099
013200     05  FILLER                          PIC  X(11)  VALUE        01950099
013300         'VENDOR NAME'.                                           01960099
013400     05  FILLER                          PIC  X(22)  VALUE SPACE. 01970099
013200     05  FILLER                          PIC  X(04)  VALUE        01980099
013300         'CRTN'.                                                  01990099
013400     05  FILLER                          PIC  X(03)  VALUE SPACE. 02000099
013200     05  FILLER                          PIC  X(04)  VALUE        02010099
013300         'CRTN'.                                                  02020099
013400     05  FILLER                          PIC  X(03)  VALUE SPACE. 02030099
013200     05  FILLER                          PIC  X(17)  VALUE        02040099
013300         'VENDOR CARTON NBR'.                                     02050099
013400     05  FILLER                          PIC  X(09)  VALUE SPACE. 02060099
013500                                                                  02070000
026176******************************************************************02080099
026177*     DETAIL LINE          DETAIL LINE           DETAIL LINE      02090099
035300******************************************************************02100000
035400 01  DL-DETAIL-LINE.                                              02110000
013200     05  DL-DC-NBR                       PIC  ZZZ9.               02120099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02130099
013400     05  DL-TRIP-ID                      PIC  ZZZZZZZZ9.          02140099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02150099
013200     05  DL-SCAC                         PIC  X(04).              02160099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02170099
013200     05  DL-TRAILER                      PIC  X(10).              02180099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02190099
013200     05  DL-PO-NBR                       PIC  ZZZZZZZZ9.          02200099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02210099
013200     05  DL-REC-SEQ-NBR                  PIC  ZZZ9.               02220099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02230099
013200     05  DL-DEPT-NBR                     PIC  ZZZ9.               02240099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02250099
013200     05  DL-VENDOR-NAME                  PIC  X(30).              02260099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02270099
013200     05  DL-EXP-CRTN                     PIC  ZZZZ9.              02280099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02290099
013200     05  DL-ACT-CRTN                     PIC  ZZZZ9.              02300099
013400     05  FILLER                          PIC  X(02)  VALUE SPACE. 02310099
013200     05  DL-CARTON-NBR                   PIC  9(18).              02320099
013400     05  FILLER                          PIC  X(09)  VALUE SPACE. 02330099
013400                                                                  02340099
026176******************************************************************02350099
026177*     BLANK LINE           BLANK LINE            BLANK LINE       02360099
035300******************************************************************02370099
043300 01  BLANK-LINE.                                                  02380000
043400     05  FILLER                          PIC  X(132) VALUE SPACE. 02390000
043500                                                                  02400000
026176******************************************************************02410099
026177*     END OF REPORT LINE          END OF REPORT LINE              02420099
026176******************************************************************02430099
043700 01  END-OF-REPORT-LINE.                                          02440000
043800     05  FILLER                          PIC  X(53)  VALUE SPACE. 02450099
043900     05  FILLER                          PIC  X(25)  VALUE        02460000
044000         '***** END OF REPORT *****'.                             02470000
044100     05  FILLER                          PIC  X(54)  VALUE SPACE. 02480099
044200                                                                  02490000
026176******************************************************************02500099
026177*    NO DATA FOR DC LINE          NO DATA FOR DC LINE             02510099
026176******************************************************************02520099
045138 01  NO-DATA-LINE1.                                               02530099
013200     05  NDL-ZERO-DC                     PIC  9(04).              02540099
045139     05  FILLER                          PIC  X(128) VALUE SPACE. 02550099
044200                                                                  02560099
026176******************************************************************02570099
026177*    NO DATA FOR REPORT LINE      NO DATA FOR REPORT LINE         02580099
026176******************************************************************02590099
045138 01  NO-DATA-LINE2.                                               02600099
045139     05  FILLER                          PIC  X(41)  VALUE SPACE. 02610099
045140     05  FILLER                          PIC  X(48)  VALUE        02620099
045150         '******* NO DATA FOUND TO REPORT ON TODAY *******'.      02630099
045160     05  FILLER                          PIC  X(43)  VALUE SPACE. 02640099
019800                                                                  02650000
084500******************************************************************02660000
084600*  DB2 COMMUNICATION AREA.                                        02670000
084700******************************************************************02680000
084800     EXEC SQL                                                     02690000
084900          INCLUDE SQLCA                                           02700000
085000     END-EXEC.                                                    02710000
085100                                                                  02720099
095100******************************************************************02730099
095200     COPY SQLCA2.                                                 02740099
095400                                                                  02750099
088100******************************************************************02760099
029586     EXEC SQL                                                     02770099
029587          INCLUDE XLT00002                                        02780099
029588     END-EXEC.                                                    02790099
095400                                                                  02800099
088100******************************************************************02810099
029586     EXEC SQL                                                     02820099
029587          INCLUDE TKRPRPM                                         02830099
029588     END-EXEC.                                                    02840099
095400                                                                  02850099
085600******************************************************************02860000
085700     EXEC SQL                                                     02870000
085800          INCLUDE TVHTRIP                                         02880099
085900     END-EXEC.                                                    02890000
086000                                                                  02900099
087200******************************************************************02910000
087300     EXEC SQL                                                     02920000
087400          INCLUDE TSHIPMT                                         02930099
087500     END-EXEC.                                                    02940000
087700*                                                                 02950000
088100******************************************************************02960000
088200     EXEC SQL                                                     02970000
088300          INCLUDE TSHPTPO                                         02980099
088400     END-EXEC.                                                    02990000
088500                                                                  03000099
088100******************************************************************03010099
088600     EXEC SQL                                                     03020000
088700          INCLUDE TRECEIV                                         03030099
088800     END-EXEC.                                                    03040000
088900                                                                  03050099
088100******************************************************************03060099
088200     EXEC SQL                                                     03070099
088300          INCLUDE TPKSLIP                                         03080099
088400     END-EXEC.                                                    03090099
088500                                                                  03100099
088100******************************************************************03110099
088600     EXEC SQL                                                     03120099
088700          INCLUDE TTRIPST                                         03130099
088800     END-EXEC.                                                    03140099
088500                                                                  03150099
088100******************************************************************03160099
088200     EXEC SQL                                                     03170099
088300          INCLUDE TPURCHS                                         03180099
088400     END-EXEC.                                                    03190099
088500                                                                  03200099
088100******************************************************************03210099
088600     EXEC SQL                                                     03220099
088700          INCLUDE TENTNME                                         03230099
088800     END-EXEC.                                                    03240099
088900                                                                  03250099
088100******************************************************************03260099
088600     EXEC SQL                                                     03270099
088700          INCLUDE TINPKSU                                         03280099
088800     END-EXEC.                                                    03290099
088900                                                                  03300099
108300******************************************************************03310099
100100     EXEC SQL                                                     03320000
100200       DECLARE DRIVER_CSR CURSOR FOR                              03330099
100300             SELECT F.OPER_UNT_ID                                 03340099
100400                   ,A.TRIP_ID                                     03350099
100400                   ,A.OWNER_SCAC_ID                               03360099
100500                   ,A.VEH_NBR                                     03370099
100500                   ,D.ORD_NBR                                     03380099
100500                   ,D.REC_SEQ_NBR                                 03390099
100500                   ,I.ENT_NAME_DESC                               03400099
100500                   ,J.DEPT_NBR                                    03410099
100500                   ,J.DEPT_NM                                     03420099
100500                   ,D.REC_TYP_CDE                                 03430099
100500                   ,D.PKGNG_CDE                                   03440099
100500                   ,D.CURR_OPER_UNT_ID                            03450099
100500                   ,D.EXPTED_CART_CNT                             03460099
100500                   ,D.ACTL_CART_CNT                               03470099
100700               FROM TVHTRIP  A                                    03480099
100800                   ,TSHIPMT  B                                    03490099
100900                   ,TSHPTPO  C                                    03500099
101000                   ,TRECEIV  D                                    03510099
101100                   ,TPKSLIP  E                                    03520099
101110                   ,TTRIPST  F                                    03530099
101120                   ,TPKSLIP  G                                    03540099
101130                   ,TPURCHS  H                                    03550099
101140                   ,TENTNME  I                                    03560099
101150                   ,XLT_DEPT J                                    03570099
101160                   ,TINPKSU  K                                    03580099
101170              WHERE A.TRIP_ID           = F.TRIP_ID               03590099
101170                AND B.TRIP_ID           = A.TRIP_ID               03600099
101170                AND C.SHIPT_ID          = B.SHIPT_ID              03610099
101170                AND D.ORD_NBR           = C.PO_NBR                03620099
101170                AND D.REC_SEQ_NBR       = C.REC_SEQ_NBR           03630099
101170                AND D.REC_TYP_CDE IN ('MR','DC')                  03640099
101170                AND E.PO_NBR            = D.ORD_NBR               03650099
101170                AND E.REC_SEQ_NBR       = D.REC_SEQ_NBR           03660099
101170                AND E.VER_STAT_CDE      = 'A'                     03670099
101170                AND E.PKSL_STAT_CDE     = 'AC'                    03680099
101170                AND F.TRIP_STATUS_CDE   = 'UN'                    03690099
101170                AND F.STATUS_DTE        = :PV-DATE-LIMIT          03700099
101170                AND G.PO_NBR            = E.PO_NBR                03710099
101170                AND G.ORIG_PKSL_SEQ_NBR = E.SEQ_NBR               03720099
101170                AND G.VER_STAT_CDE      = 'A'                     03730099
101170                AND G.REC_SEQ_NBR       = 0                       03740099
101170                AND H.PO_NBR            = D.ORD_NBR               03750099
101170                AND H.VER_STATUS_CDE    = 'A'                     03760099
101170                AND I.ENT_ID            = H.ENT_ID                03770099
101170                AND I.SEQ_NBR           = 1                       03780099
101170                AND J.DEPT_NBR          = H.DEPT_NBR              03790099
101170                AND K.PO_NBR            = G.PO_NBR                03800099
101170                AND K.SEQ_NBR           = G.SEQ_NBR               03810099
101170          GROUP BY F.OPER_UNT_ID                                  03820099
101170                  ,A.TRIP_ID                                      03830099
101170                  ,A.OWNER_SCAC_ID                                03840099
101170                  ,A.VEH_NBR                                      03850099
101170                  ,D.ORD_NBR                                      03860099
101170                  ,D.REC_SEQ_NBR                                  03870099
101170                  ,I.ENT_NAME_DESC                                03880099
101170                  ,J.DEPT_NBR                                     03890099
101170                  ,J.DEPT_NM                                      03900099
101170                  ,D.REC_TYP_CDE                                  03910099
101170                  ,D.PKGNG_CDE                                    03920099
101170                  ,D.CURR_OPER_UNT_ID                             03930099
101170                  ,D.EXPTED_CART_CNT                              03940099
100500                  ,D.ACTL_CART_CNT                                03950099
101170          ORDER BY 1, 2, 5, 6                                     03960099
101170           WITH UR                                                03970099
101213     END-EXEC.                                                    03980000
101214                                                                  03990000
108300******************************************************************04000099
100100     EXEC SQL                                                     04010099
100200       DECLARE DETAIL_CSR CURSOR FOR                              04020099
100300             SELECT C.SHIPT_UNT_ID                                04030099
                     FROM TPKSLIP A                                     04040099
                         ,TPKSLIP B                                     04050099
                         ,TINPKSU C                                     04060099
                    WHERE A.PO_NBR            = :DK-PO-NBR              04070099
                      AND A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR         04080099
                      AND A.VER_STAT_CDE      = 'A'                     04090099
                      AND A.PKSL_STAT_CDE     = 'AC'                    04100099
                      AND B.PO_NBR            = A.PO_NBR                04110099
                      AND B.ORIG_PKSL_SEQ_NBR = A.SEQ_NBR               04120099
                      AND B.VER_STAT_CDE      = 'A'                     04130099
                      AND B.REC_SEQ_NBR       = 0                       04140099
                      AND C.PO_NBR            = B.PO_NBR                04150099
                      AND C.SEQ_NBR           = B.SEQ_NBR               04160099
                    ORDER BY 1                                          04170099
101170           WITH UR                                                04180099
107799     END-EXEC.                                                    04190099
107800                                                                  04200000
108300******************************************************************04210099
108000 PROCEDURE DIVISION.                                              04220000
108300******************************************************************04230099
108200                                                                  04240000
108300******************************************************************04250000
108400*  0000-MAINLINE.                                                 04260099
108400*       - CONTROLS THE MAIN PROCESSING OF THE PROGRAM             04270099
108500******************************************************************04280000
108600 0000-PROGRAM-MAINLINE.                                           04290000
109200                                                                  04300000
107500     DISPLAY ' '.                                                 04310099
107500     DISPLAY '  *********   '                                     04320099
107500                PC-CURRENT-PROGRAM-NAME                           04330099
107500             '   *********  '.                                    04340099
050500                                                                  04350099
109525     PERFORM 1000-INITIALIZE.                                     04360000
109526                                                                  04370000
109527     PERFORM 2000-PROCESS-LOOP                                    04380099
124300       UNTIL PS-END-OF-DRIVER-CSR.                                04390099
109529                                                                  04400000
109530     PERFORM 9000-EOJ-ROUTINE.                                    04410000
109570                                                                  04420000
109580     STOP RUN.                                                    04430000
109600                                                                  04440000
113200******************************************************************04450000
113300*  1000-INITIALIZE                                                04460000
113500*       - OPEN THE OUTPUT FILE                                    04470099
113600*       - RETRIEVE PARM INFORMATION                               04480099
113700******************************************************************04490000
114200 1000-INITIALIZE.                                                 04500000
114400                                                                  04510000
111000     OPEN OUTPUT TRAILER-THEFT-RPT.                               04520099
115900                                                                  04530000
107360     MOVE 'SUTUNC'          TO KRPRPM-SYS-PRC-FUNC-CDE.           04540099
107370     PERFORM 1110-SELECT-PARMS.                                   04550099
111900     MOVE KRPRPM-FUNC-QTY   TO PV-MIN-COUNT                       04560099
111900                               PH2-SHORTED-NBR.                   04570099
111900     DISPLAY ' MIN SHORTED CARTON PARM     = ' PV-MIN-COUNT.      04580099
115900                                                                  04590099
107360     MOVE 'SUTUDY'          TO KRPRPM-SYS-PRC-FUNC-CDE.           04600099
107370     PERFORM 1110-SELECT-PARMS.                                   04610099
111600     PERFORM 1200-DATE-CALC-RTN.                                  04620099
012800     MOVE PV-DATE-LIMIT     TO PH2-DATE.                          04630099
107350                                                                  04640099
107370     PERFORM 7000-WRITE-HEADINGS.                                 04650099
107350                                                                  04660099
116500     PERFORM 5000-OPEN-DRIVER-CURSOR.                             04670099
116600                                                                  04680000
111410******************************************************************04690099
111450*1110-SELECT-PARMS.                                               04700099
111420*   RETRIEVES - NUMBER OF DAYS TO BE USED IN DATE RANGE CALC      04710099
111420*               AND MINIMUM NUMBER OF DETACHED CARTONS DISPLAYED  04720099
111440******************************************************************04730099
111450 1110-SELECT-PARMS.                                               04740099
111460                                                                  04750099
107320     MOVE 90                TO KRPRPM-LOC-ID.                     04760099
107330     MOVE 'KHL'             TO KRPRPM-INTFC-SYS-CDE.              04770099
107340     MOVE 'AC'              TO KRPRPM-FUNC-PRC-STAT-CDE.          04780099
111460                                                                  04790099
111470     EXEC SQL                                                     04800099
111480          SELECT FUNC_QTY                                         04810099
111490            INTO :KRPRPM-FUNC-QTY                                 04820099
111491            FROM  TKRPRPM                                         04830099
111492           WHERE  LOC_ID            = :KRPRPM-LOC-ID              04840099
111493             AND  SYS_PRC_FUNC_CDE  = :KRPRPM-SYS-PRC-FUNC-CDE    04850099
111494             AND  INTFC_SYS_CDE     = :KRPRPM-INTFC-SYS-CDE       04860099
111495             AND  FUNC_PRC_STAT_CDE = :KRPRPM-FUNC-PRC-STAT-CDE   04870099
111496            WITH UR                                               04880099
111497     END-EXEC.                                                    04890099
111498                                                                  04900099
111499     EVALUATE TRUE                                                04910099
111500         WHEN SQLCODE = +0                                        04920099
111501              CONTINUE                                            04930099
111502                                                                  04940099
111503         WHEN SQLWARN0 NOT = SPACES                               04950099
111504         WHEN SQLCODE < +0                                        04960099
111505         WHEN SQLCODE > +0                                        04970099
111450              MOVE '1110-SELECT-PARMS'                            04980099
124900                           TO PV-PARAGRAPH-NAME                   04990099
125000              MOVE 'SELECT PARM ROW'                              05000099
125100                           TO PV-DB2-OPERATION-ATTEMPTED          05010099
111506              DISPLAY '** ABEND **'                               05020099
111507              DISPLAY '** PROGRAM = '                             05030099
107500                          PC-CURRENT-PROGRAM-NAME                 05040099
111508              DISPLAY '** PARAGRAPH = 1110-SELECT-PARMS **'       05050099
111510              DISPLAY '** KRPRPM-LOC-ID = '                       05060099
111511                          KRPRPM-LOC-ID                           05070099
111512              DISPLAY '** KRPRPM-SYS-PRC-FUNC-CDE = '             05080099
111513                           KRPRPM-SYS-PRC-FUNC-CDE                05090099
111514              DISPLAY '** KRPRPM-INTFC-SYS-CDE = '                05100099
111515                           KRPRPM-INTFC-SYS-CDE                   05110099
111516              DISPLAY '** KRPRPM-FUNC-PRC-STAT-CDE = '            05120099
111518                           KRPRPM-FUNC-PRC-STAT-CDE               05130099
111519              DISPLAY '** UNSUCCESSFUL SELECT OF PARM**'          05140099
111520              PERFORM 9999-SQL-ABEND                              05150099
111521     END-EVALUATE.                                                05160099
111521                                                                  05170099
111600******************************************************************05180099
111600 1200-DATE-CALC-RTN.                                              05190099
111610                                                                  05200099
106400     EXEC SQL                                                     05210099
106500        SET :PV-CURRENT-TMST  = CURRENT TIMESTAMP                 05220099
106600     END-EXEC.                                                    05230099
106601                                                                  05240099
106610     EXEC SQL                                                     05250099
106630        SET :PV-DATE-LIMIT = (CURRENT_DATE -                      05260099
106631                                     (:KRPRPM-FUNC-QTY) DAYS)     05270099
106640     END-EXEC.                                                    05280099
106700                                                                  05290099
112900     EVALUATE TRUE                                                05300099
111500         WHEN SQLCODE = +0                                        05310099
111900            DISPLAY ' PARM DAYS                   = '             05320099
111900                                          KRPRPM-FUNC-QTY         05330099
112300            DISPLAY ' CURRENT DATE LESS PARM DAYS = '             05340099
112300                                          PV-DATE-LIMIT           05350099
064000            MOVE PV-CURRENT-DT         TO PV-CURRENT-DATE         05360099
064000            MOVE PV-CURRENT-TM         TO PV-CURRENT-TIME         05370099
112800                                                                  05380099
113000         WHEN SQLWARN0 NOT EQUAL SPACE                            05390099
113100         WHEN SQLCODE NOT EQUAL ZERO                              05400099
113200            DISPLAY '** ABEND **'                                 05410099
111507            DISPLAY '** PROGRAM = '                               05420099
107500                        PC-CURRENT-PROGRAM-NAME                   05430099
113400            DISPLAY '** PARAGRAPH = 1200-DATE-CALC-RTN'           05440099
113500            DISPLAY '** UNSUCCESSFUL SELECT OF CALCULATED DATE**' 05450099
113510            DISPLAY '** KRPRPM-FUNC-QTY = ' KRPRPM-FUNC-QTY       05460099
113600            PERFORM 9999-SQL-ABEND                                05470099
113700     END-EVALUATE.                                                05480099
113800                                                                  05490099
155464******************************************************************05500000
155465* 2000-PROCESS-LOOP  -- CREATE THE TRAILER THEFT REPORT. -- THIS  05510099
155466*    PARAGRAPH WILL REPEAT UNTIL THE END OF THE DRIVER_CSR.       05520099
155800******************************************************************05530000
155900 2000-PROCESS-LOOP.                                               05540099
156100                                                                  05550000
122600     PERFORM 5400-FETCH-DRIVER-CSR.                               05560099
118600     IF PS-END-OF-DRIVER-CSR                                      05570099
118600        IF PS-FIRST-TIME                                          05580099
118600           PERFORM 7500-NO-DATA-RTN                               05590099
118600        END-IF                                                    05600099
118600     ELSE                                                         05610099
100400        MOVE VHTRIP-TRIP-ID            TO DK-TRIP-ID              05620099
100500        MOVE RECEIV-ORD-NBR            TO DK-PO-NBR               05630099
100500        MOVE RECEIV-REC-SEQ-NBR        TO DK-REC-SEQ-NBR          05640099
118600        PERFORM 2500-CHECK-COUNT                                  05650099
118600        IF PS-BYPASS                                              05660099
118600           CONTINUE                                               05670099
118600        ELSE                                                      05680099
053201           SET PS-NOT-FIRST-TIME                                  05690099
124300               PS-FIRST-DETAIL-YES     TO TRUE                    05700099
117800           PERFORM 5200-OPEN-DETAIL-CURSOR                        05710099
118600           PERFORM 3000-DETAIL-RTN                                05720099
118600              UNTIL PS-END-OF-DETAIL-CSR                          05730099
118600        END-IF                                                    05740099
118600     END-IF.                                                      05750099
158800                                                                  05760000
210300******************************************************************05770000
118600 2500-CHECK-COUNT.                                                05780099
118600                                                                  05790099
100500     COMPUTE PV-DIFFERENCE = RECEIV-EXPTED-CART-CNT               05800099
048350                           - RECEIV-ACTL-CART-CNT.                05810099
100500                                                                  05820099
118600     IF PV-DIFFERENCE >= PV-MIN-COUNT                             05830099
118600        SET PS-DONT-BYPASS           TO TRUE                      05840099
118600     ELSE                                                         05850099
118600        SET PS-BYPASS                TO TRUE                      05860099
123000        ADD 1                        TO PA-DETAIL-BYPASSED        05870099
118600     END-IF.                                                      05880099
118600                                                                  05890099
210300******************************************************************05900099
210400 3000-DETAIL-RTN.                                                 05910099
156100                                                                  05920099
122600     PERFORM 5600-FETCH-DETAIL-CSR.                               05930099
118600     IF PS-END-OF-DETAIL-CSR                                      05940099
118600        IF PS-FIRST-DETAIL-YES                                    05950099
118600           PERFORM 4000-PROCESS-DETAIL                            05960099
118600        END-IF                                                    05970099
118600        PERFORM 5800-CLOSE-DETAIL-CSR                             05980099
118600     ELSE                                                         05990099
118600        PERFORM 4000-PROCESS-DETAIL                               06000099
118600     END-IF.                                                      06010099
212500                                                                  06020099
117400******************************************************************06030099
118600 4000-PROCESS-DETAIL.                                             06040099
158800                                                                  06050099
123000     IF TRIPST-OPER-UNT-ID = PV-HOLD-OPER-UNT-ID                  06060099
123000        CONTINUE                                                  06070099
123000     ELSE                                                         06080099
123000        PERFORM 7000-WRITE-HEADINGS                               06090099
123000        MOVE TRIPST-OPER-UNT-ID     TO PV-HOLD-OPER-UNT-ID        06100099
123000     END-IF.                                                      06110099
035400     INITIALIZE DL-DETAIL-LINE.                                   06120099
123000     MOVE TRIPST-OPER-UNT-ID        TO DL-DC-NBR.                 06130099
100400     MOVE VHTRIP-TRIP-ID            TO DL-TRIP-ID.                06140099
100400     MOVE VHTRIP-OWNER-SCAC-ID      TO DL-SCAC.                   06150099
100500     MOVE VHTRIP-VEH-NBR            TO DL-TRAILER.                06160099
100500     MOVE RECEIV-ORD-NBR            TO DL-PO-NBR.                 06170099
100500     MOVE RECEIV-REC-SEQ-NBR        TO DL-REC-SEQ-NBR.            06180099
100500     MOVE ENTNME-ENT-NAME-DESC      TO DL-VENDOR-NAME.            06190099
100500     MOVE XLT00002-DEPT-NBR         TO DL-DEPT-NBR.               06200099
100500     MOVE RECEIV-EXPTED-CART-CNT    TO DL-EXP-CRTN.               06210099
048350     MOVE RECEIV-ACTL-CART-CNT      TO DL-ACT-CRTN.               06220099
118600     IF PS-FIRST-DETAIL-YES                                       06230099
123000        MOVE ZEROES                 TO DL-CARTON-NBR              06240099
123000        ADD 1                       TO PA-NO-DETAIL-FOUND         06250099
123000     ELSE                                                         06260099
123000        MOVE INPKSU-SHIPT-UNT-ID    TO DL-CARTON-NBR              06270099
123000     END-IF.                                                      06280099
100600                                                                  06290099
251700     PERFORM 8000-WRITE-DETAIL-LINE.                              06300099
100600                                                                  06310099
117400******************************************************************06320099
117500* 5000-OPEN-DRIVER-CURSOR.                                        06330099
117600*  THIS PROCEDURE WILL OPEN THE DRIVER_CSR CURSOR.                06340099
117700******************************************************************06350099
117800 5000-OPEN-DRIVER-CURSOR.                                         06360099
117900                                                                  06370099
118000     EXEC SQL                                                     06380099
118100          OPEN DRIVER_CSR                                         06390099
118200     END-EXEC.                                                    06400099
118300                                                                  06410099
118400     EVALUATE TRUE                                                06420099
118500         WHEN SQLCODE = ZERO                                      06430099
118600              SET PS-NOT-END-OF-DRIVER-CSR TO TRUE                06440099
118300                                                                  06450099
118800         WHEN SQLWARN0 NOT EQUAL SPACE                            06460099
118900         WHEN SQLCODE NOT EQUAL ZERO                              06470099
119000              MOVE '5000-OPEN-DRIVER-CURSOR'                      06480099
119100                                    TO PV-PARAGRAPH-NAME          06490099
119200              MOVE 'OPEN DRIVER_CSR'                              06500099
119300                                    TO PV-DB2-OPERATION-ATTEMPTED 06510099
119400              DISPLAY 'DATE LIMIT:  '  PV-DATE-LIMIT              06520099
119800              PERFORM 9999-SQL-ABEND                              06530099
119900     END-EVALUATE.                                                06540099
120000                                                                  06550099
117400******************************************************************06560099
117500* 5200-OPEN-DETAIL-CSR.                                           06570099
117600*  THIS PROCEDURE WILL OPEN THE DETAIL_CSR CURSOR.                06580099
117700******************************************************************06590099
117800 5200-OPEN-DETAIL-CURSOR.                                         06600099
117900                                                                  06610099
118000     EXEC SQL                                                     06620099
118100          OPEN DETAIL_CSR                                         06630099
118200     END-EXEC.                                                    06640099
118300                                                                  06650099
118400     EVALUATE TRUE                                                06660099
118500         WHEN SQLCODE = ZERO                                      06670099
118600              SET PS-NOT-END-OF-DETAIL-CSR TO TRUE                06680099
118300                                                                  06690099
118800         WHEN SQLWARN0 NOT EQUAL SPACE                            06700099
118900         WHEN SQLCODE NOT EQUAL ZERO                              06710099
119000              MOVE '5200-OPEN-DETAIL-CURSOR'                      06720099
119100                                    TO PV-PARAGRAPH-NAME          06730099
119200              MOVE 'OPEN DETAIL_CSR'                              06740099
119300                                    TO PV-DB2-OPERATION-ATTEMPTED 06750099
119600              DISPLAY 'PO NBR:      '  DK-PO-NBR                  06760099
119700              DISPLAY 'REC SEQ NBR: '  DK-REC-SEQ-NBR             06770099
119800              PERFORM 9999-SQL-ABEND                              06780099
119900     END-EVALUATE.                                                06790099
120000                                                                  06800099
122200******************************************************************06810099
122300* 5400-FETCH-DRIVER-CSR.                                          06820099
122400*  THIS PROCEDURE WILL READ A ROW FROM THE DRIVER_CSR CURSOR.     06830099
122500******************************************************************06840099
122600 5400-FETCH-DRIVER-CSR.                                           06850099
122700                                                                  06860099
122800     EXEC SQL                                                     06870099
122900          FETCH DRIVER_CSR                                        06880099
123000           INTO  :TRIPST-OPER-UNT-ID                              06890099
100400                ,:VHTRIP-TRIP-ID                                  06900099
100400                ,:VHTRIP-OWNER-SCAC-ID                            06910099
100500                ,:VHTRIP-VEH-NBR                                  06920099
100500                ,:RECEIV-ORD-NBR                                  06930099
100500                ,:RECEIV-REC-SEQ-NBR                              06940099
100500                ,:ENTNME-ENT-NAME-DESC                            06950099
100500                ,:XLT00002-DEPT-NBR                               06960099
100500                ,:XLT00002-DEPT-NM                                06970099
100500                ,:RECEIV-REC-TYP-CDE                              06980099
100500                ,:RECEIV-PKGNG-CDE                                06990099
100500                ,:RECEIV-CURR-OPER-UNT-ID                         07000099
100500                ,:RECEIV-EXPTED-CART-CNT                          07010099
100500                ,:RECEIV-ACTL-CART-CNT                            07020099
123500     END-EXEC.                                                    07030000
123600                                                                  07040000
123700     EVALUATE TRUE                                                07050000
123800         WHEN SQLCODE = ZERO                                      07060000
057320              ADD 1                 TO PA-DRIVERS-READ            07070099
057320              IF PS-FIRST-TIME                                    07080099
123000                 MOVE TRIPST-OPER-UNT-ID                          07090099
123000                                    TO PV-HOLD-OPER-UNT-ID        07100099
057320              END-IF                                              07110099
124000                                                                  07120000
124100         WHEN SQLCODE = +100                                      07130000
124200         WHEN SQLCODE = -305                                      07140000
124300              SET PS-END-OF-DRIVER-CSR TO TRUE                    07150099
124500                                                                  07160000
124600         WHEN SQLWARN0 NOT EQUAL SPACE                            07170000
124700         WHEN SQLCODE NOT EQUAL ZERO                              07180000
124800              MOVE '5400-FETCH-DRIVER-CSR'                        07190099
124900                                    TO PV-PARAGRAPH-NAME          07200099
125000              MOVE 'FETCH DRIVER_CSR'                             07210099
125100                                    TO PV-DB2-OPERATION-ATTEMPTED 07220099
119400              DISPLAY 'DATE LIMIT:  '  PV-DATE-LIMIT              07230099
125200              PERFORM 9999-SQL-ABEND                              07240000
125300     END-EVALUATE.                                                07250000
125400                                                                  07260000
122200******************************************************************07270099
122300* 5600-FETCH-DETAIL-CSR.                                          07280099
122400*  THIS PROCEDURE WILL READ A ROW FROM THE DETAIL_CSR CURSOR.     07290099
122500******************************************************************07300099
122600 5600-FETCH-DETAIL-CSR.                                           07310099
122700                                                                  07320099
122800     EXEC SQL                                                     07330099
122900          FETCH DETAIL_CSR                                        07340099
123000           INTO :INPKSU-SHIPT-UNT-ID                              07350099
123500     END-EXEC.                                                    07360099
123600                                                                  07370099
123700     EVALUATE TRUE                                                07380099
123800         WHEN SQLCODE = ZERO                                      07390099
123900              ADD 1                    TO PA-DETAIL-READ          07400099
124400              SET PS-FIRST-DETAIL-NO   TO TRUE                    07410099
124000                                                                  07420099
124100         WHEN SQLCODE = +100                                      07430099
124300              SET PS-END-OF-DETAIL-CSR TO TRUE                    07440099
124500                                                                  07450099
124600         WHEN SQLWARN0 NOT EQUAL SPACE                            07460099
124700         WHEN SQLCODE NOT EQUAL ZERO                              07470099
124800              MOVE '5600-FETCH-DETAIL-CSR'                        07480099
124900                                    TO PV-PARAGRAPH-NAME          07490099
125000              MOVE 'FETCH DETAIL_CSR'                             07500099
125100                                    TO PV-DB2-OPERATION-ATTEMPTED 07510099
119600              DISPLAY 'PO NBR:      '  DK-PO-NBR                  07520099
119700              DISPLAY 'REC SEQ NBR: '  DK-REC-SEQ-NBR             07530099
125200              PERFORM 9999-SQL-ABEND                              07540099
125300     END-EVALUATE.                                                07550099
125400                                                                  07560099
120100******************************************************************07570000
120200* 5700-CLOSE-DRIVER-CSR.                                          07580099
120300*  THIS PROCEDURE WILL CLOSE THE DRIVER_CSR.                      07590099
120400******************************************************************07600000
120500 5700-CLOSE-DRIVER-CSR.                                           07610099
120600                                                                  07620000
120700     EXEC SQL                                                     07630000
120800         CLOSE DRIVER_CSR                                         07640099
120900     END-EXEC.                                                    07650000
121000                                                                  07660000
121100     EVALUATE TRUE                                                07670000
121200         WHEN SQLWARN0 NOT EQUAL SPACE                            07680000
121300         WHEN SQLCODE NOT EQUAL ZERO                              07690000
121400              MOVE '5700-CLOSE-DRIVER-CSR'                        07700099
121500                               TO PV-PARAGRAPH-NAME               07710099
121600              MOVE 'CLOSE DRIVER_CSR'                             07720099
121700                               TO PV-DB2-OPERATION-ATTEMPTED      07730099
121800              PERFORM 9999-SQL-ABEND                              07740000
121900     END-EVALUATE.                                                07750000
122000                                                                  07760000
120100******************************************************************07770099
120200* 5800-CLOSE-DETAIL-CSR.                                          07780099
120300*  THIS PROCEDURE WILL CLOSE THE DETAIL_CSR.                      07790099
120400******************************************************************07800099
120500 5800-CLOSE-DETAIL-CSR.                                           07810099
120600                                                                  07820099
120700     EXEC SQL                                                     07830099
120800         CLOSE DETAIL_CSR                                         07840099
120900     END-EXEC.                                                    07850099
121000                                                                  07860099
121100     EVALUATE TRUE                                                07870099
121200         WHEN SQLWARN0 NOT EQUAL SPACE                            07880099
121300         WHEN SQLCODE NOT EQUAL ZERO                              07890099
121400              MOVE '5800-CLOSE-DETAIL-CSR'                        07900099
121500                               TO PV-PARAGRAPH-NAME               07910099
121600              MOVE 'CLOSE DETAIL_CSR'                             07920099
121700                               TO PV-DB2-OPERATION-ATTEMPTED      07930099
121800              PERFORM 9999-SQL-ABEND                              07940099
121900     END-EVALUATE.                                                07950099
122000                                                                  07960099
251400******************************************************************07970000
251500* 7000-WRITE-HEADINGS.                                            07980099
251600******************************************************************07990000
251700 7000-WRITE-HEADINGS.                                             08000099
251800                                                                  08010099
040900     MOVE ZEROES               TO PV-LINE-COUNT.                  08020099
041000     ADD 1                     TO PV-PAGE-COUNT.                  08030099
041100     MOVE 1                    TO DP132-REPORT-NUMBER.            08040099
041200     MOVE PV-PAGE-COUNT        TO DP132-PAGE-NUMBER.              08050099
120300     MOVE PC-CURRENT-PROGRAM-NAME                                 08060099
120300                               TO DP132-PROGRAM-NAME.             08070099
121000     MOVE PV-CURRENT-DATE-CCYY TO DP132-RUN-YEAR.                 08080099
121100     MOVE PV-CURRENT-DATE-MM   TO DP132-RUN-MONTH.                08090099
121200     MOVE PV-CURRENT-DATE-DD   TO DP132-RUN-DAY.                  08100099
121300                                                                  08110099
121400     MOVE PV-CURRENT-TIME-HH   TO DP132-RUN-HOUR.                 08120099
121500     MOVE PV-CURRENT-TIME-MM   TO DP132-RUN-MINUTE.               08130099
041300                                                                  08140099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08150099
041400       FROM DP132-STANDRD-HEADER-132-COLS                         08160099
041400         AFTER ADVANCING PAGE.                                    08170099
041500                                                                  08180099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08190099
012400       FROM PH1-PAGE-HEADING-1                                    08200099
041400         AFTER ADVANCING 1 LINE.                                  08210099
041500                                                                  08220099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08230099
012400       FROM PH1-PAGE-HEADING-2                                    08240099
041400         AFTER ADVANCING 1 LINE.                                  08250099
041500                                                                  08260099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08270099
026180       FROM DH1-DETAIL-HEADING-1                                  08280099
041400         AFTER ADVANCING 2 LINES.                                 08290099
041500                                                                  08300099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08310099
026180       FROM DH1-DETAIL-HEADING-2                                  08320099
041400         AFTER ADVANCING 1 LINE.                                  08330099
041500                                                                  08340099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08350099
026180       FROM DH1-DETAIL-HEADING-3                                  08360099
041400         AFTER ADVANCING 1 LINE.                                  08370099
041500                                                                  08380099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08390099
026180       FROM BLANK-LINE                                            08400099
041400         AFTER ADVANCING 1 LINE.                                  08410099
041500                                                                  08420099
040900     MOVE 9                    TO PV-LINE-COUNT.                  08430099
041500                                                                  08440099
251400******************************************************************08450099
251500 7500-NO-DATA-RTN.                                                08460099
041500                                                                  08470099
013200     MOVE ZEROES               TO NDL-ZERO-DC.                    08480099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08490099
026180       FROM NO-DATA-LINE1                                         08500099
041400         AFTER ADVANCING 1 LINE.                                  08510099
041500                                                                  08520099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08530099
026180       FROM NO-DATA-LINE2                                         08540099
041400         AFTER ADVANCING 2 LINE.                                  08550099
041500                                                                  08560099
251600******************************************************************08570099
251700 8000-WRITE-DETAIL-LINE.                                          08580099
251800                                                                  08590099
251900     IF PV-LINE-COUNT > PC-MAX-REPORT-LINES                       08600099
252000         PERFORM 7000-WRITE-HEADINGS                              08610099
252100     END-IF.                                                      08620099
252200                                                                  08630099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 08640099
252400       FROM DL-DETAIL-LINE                                        08650099
252500         AFTER ADVANCING 1.                                       08660099
253300                                                                  08670099
253200     ADD 1                          TO PV-LINE-COUNT              08680099
252500                                       PA-RECORDS-WROTE.          08690099
253300                                                                  08700099
272800******************************************************************08710000
272900* 9000-EOJ-ROUTINE.                                               08720099
113600*       - DISPLAY PROGRAM TOTALS                                  08730099
113500*       - CLOSE THE DRIVER_CSR                                    08740099
113600*       - CLOSE THE OUTPUT FILE                                   08750099
273100******************************************************************08760000
273200 9000-EOJ-ROUTINE.                                                08770000
273300                                                                  08780000
057320     DISPLAY ' '.                                                 08790099
057320     DISPLAY '    ** PROGRAM TOTALS **'.                          08800099
273300                                                                  08810099
057320     MOVE PA-DRIVERS-READ                     TO PV-DISP-DEC.     08820099
057320     DISPLAY ' MAIN CURSOR RECS READ        = '  PV-DISP-DEC.     08830099
273300                                                                  08840099
057320     MOVE PA-DETAIL-BYPASSED                  TO PV-DISP-DEC.     08850099
057320     DISPLAY ' BYPASSED DUE TO SHORTED PARM = '  PV-DISP-DEC.     08860099
273300                                                                  08870099
057320     MOVE PA-DETAIL-READ                      TO PV-DISP-DEC.     08880099
057320     DISPLAY ' DETAIL CURSOR RECS READ      = '  PV-DISP-DEC.     08890099
273300                                                                  08900099
057320     MOVE PA-NO-DETAIL-FOUND                  TO PV-DISP-DEC.     08910099
057320     DISPLAY ' DETAIL CURSOR NOT FOUND      = '  PV-DISP-DEC.     08920099
273300                                                                  08930099
057320     MOVE PA-RECORDS-WROTE                    TO PV-DISP-DEC.     08940099
057320     DISPLAY ' DETAIL RECORDS WROTE         = '  PV-DISP-DEC.     08950099
057320     DISPLAY ' '.                                                 08960099
057320                                                                  08970099
120500     PERFORM 5700-CLOSE-DRIVER-CSR.                               08980099
273300                                                                  08990099
251500     IF PS-FIRST-TIME                                             09000099
251500        CONTINUE                                                  09010099
251500     ELSE                                                         09020099
251500        PERFORM 9500-END-OF-REPORT-LINE                           09030099
251500     END-IF.                                                      09040099
273300                                                                  09050099
111000     CLOSE TRAILER-THEFT-RPT.                                     09060099
275700                                                                  09070000
251400******************************************************************09080099
251500 9500-END-OF-REPORT-LINE.                                         09090099
041500                                                                  09100099
007400     WRITE TRAILER-THEFT-RPT-LINE                                 09110099
026180       FROM END-OF-REPORT-LINE                                    09120099
041400         AFTER ADVANCING 3 LINE.                                  09130099
041500                                                                  09140099
277600******************************************************************09150000
277700* 9999-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      09160099
277800* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 09170099
277900******************************************************************09180000
278000 9999-SQL-ABEND.                                                  09190000
278100                                                                  09200099
279400     DISPLAY '** PROGRAM    ** = ' PC-CURRENT-PROGRAM-NAME.       09210099
279500     DISPLAY '** PARAGRAPH  ** = ' PV-PARAGRAPH-NAME.             09220000
279600     DISPLAY '** OPERATION  ** = ' PV-DB2-OPERATION-ATTEMPTED.    09230000
279700                                                                  09240000
279800******************************************************************09250000
279900* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    09260099
280000* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         09270099
280010* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     09280099
280020* FORMAT.                                                         09290099
280030******************************************************************09300000
280040     COPY DPPD004.                                                09310000
280050                                                                  09320000
280060     MOVE +4013 TO ABEND-CODE.                                    09330000
280070     CALL 'ILBOABN0' USING ABEND-CODE.                            09340000
