000100 IDENTIFICATION DIVISION.                                         00010010
000200 PROGRAM-ID.    RCKUT056.                                         00020010
000300 AUTHOR.        DENISE HAHN.                                      00030010
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040015
000500 DATE-WRITTEN.  3/26/98.                                          00050085
000600****************************************************************  00060010
000700*  THIS PROGRAM WILL CREATE AN EXTRACT FILE FROM THE RECEIVING *  00070011
000800*  TABLE(TRECEIV) AND PURCHASE ORDER HEADER TABLE(TPURCHS).    *  00080011
000900*  THE SELECTION IS BASED ON THE DATE RANGE ENTERED IN THE     *  00090011
001000*  CONTROL CARD AND THE TIMEFRAME DESIRED.                     *  00100011
001100*  VALID TIMEFRAMES ARE:           W=WEEKLY    M=MONTHLY       *  00110011
001200*                        F=FISCAL  C=CALENDAR  S=SEASONAL      *  00120011
001300*  IF THE DATES IN THE CONTROL CARD = DEFAULT (9999-09-09)     *  00130011
001400*  THE PROGRAM WILL CALCULATE THE BEGINNING AND ENDING DATES   *  00140011
001500****************************************************************  00150010
001600 ENVIRONMENT DIVISION.                                            00160010
001700 INPUT-OUTPUT SECTION.                                            00170010
001800                                                                  00180010
001900 FILE-CONTROL.                                                    00190010
002000                                                                  00200011
002100     SELECT DATE-FILE      ASSIGN TO UT-S-OUT01.                  00210011
002200     SELECT EXTRACT-FILE   ASSIGN TO UT-S-OUT02.                  00220010
002300                                                                  00230010
002400 DATA DIVISION.                                                   00240010
002500                                                                  00250010
002600 FILE SECTION.                                                    00260010
002700*                                                                 00270010
002800 FD  DATE-FILE                                                    00280011
002900     RECORDING MODE IS F                                          00290010
003000     LABEL RECORDS ARE STANDARD                                   00300010
003100     RECORD CONTAINS 80                                           00310011
003200     BLOCK CONTAINS 0 RECORDS                                     00320010
003300     DATA RECORD IS DATE-RECORD.                                  00330011
003400 01  DATE-RECORD                 PIC X(80).                       00340011
003500*                                                                 00350010
003600 FD  EXTRACT-FILE                                                 00360018
003700     RECORDING MODE IS F                                          00370010
003800     LABEL RECORDS ARE STANDARD                                   00380010
003900     RECORD CONTAINS 250                                          00390017
004000     BLOCK CONTAINS 0 RECORDS                                     00400010
004100     DATA RECORD IS EXTRACT-RECORD.                               00410010
004200 01  EXTRACT-RECORD              PIC X(250).                      00420017
004300*                                                                 00430010
004400/                                                                 00440010
004500 WORKING-STORAGE SECTION.                                         00450010
004600                                                                  00460010
004700 01  PS-PROGRAM-SWITCHES.                                         00470088
004800     05  PS-NORMAL-RUN-SW             PIC X(01)  VALUE 'N'.       00480088
004900         88  PS-NORMAL-RUN                       VALUE 'Y'.       00490088
005000         88  PS-SPECIAL-RUN                      VALUE 'N'.       00500088
005100     05  PS-TRECEIV-CURSOR-SW         PIC X(01)  VALUE 'N'.       00510088
005200         88  PS-EOF-TRECEIV-CSR                  VALUE 'Y'.       00520088
005300                                                                  00530090
005400 01  PV-PROGRAM-VARIABLES.                                        00540088
005500     05 PV-DATE-AREA.                                             00550089
005600        10 PV-DATE-AREA-MM            PIC  9(02)    VALUE ZEROS.  00560089
005700        10 FILLER                     PIC  X(01)    VALUE '/'.    00570089
005800        10 PV-DATE-AREA-DD            PIC  9(02)    VALUE ZEROS.  00580089
005900        10 FILLER                     PIC  X(01)    VALUE '/'.    00590089
006000        10 PV-DATE-AREA-YY            PIC  9(02)    VALUE ZEROS.  00600089
006100                                                                  00610089
006200     05  PV-RETRY-COUNT               PIC S9(04)  VALUE +0        00620089
006300                                                  COMP SYNC.      00630089
006400     05 PV-CURRENT-DB2-DATE-ONE       PIC  X(10).                 00640086
006500     05 PV-CURRENT-DB2-DATE           PIC  X(10).                 00650086
006500     05 PV-CURRENT-DB2-DATE-ONEYR     PIC  X(10)  VALUE SPACES.   00651098
006500     05 FILLER REDEFINES PV-CURRENT-DB2-DATE-ONEYR.               00652097
006500        10 PV-CDD-ONEYR-CCYY          PIC  9(04).                 00653098
006500        10 FILLER                     PIC  X(06).                 00654098
006600     05 PV-CURR-DATE.                                             00660088
006700         10 PV-CURRENT-DB2-CCYY.                                  00670095
006700            15 PV-CURRENT-DB2-CC       PIC  9(02)    VALUE 0.     00671095
006800            15 PV-CURRENT-DB2-YY       PIC  9(02)    VALUE 0.     00680095
006900         10 FILLER                     PIC  X(01)    VALUE '-'.   00690088
007000         10 PV-CURRENT-DB2-MM          PIC  9(02)    VALUE 0.     00700088
007100         10 FILLER                     PIC  X(01)    VALUE '-'.   00710088
007200         10 PV-CURRENT-DB2-DD          PIC  9(02)    VALUE 0.     00720088
007300     05 PV-CURRENT-DATE.                                          00730088
007400         10 PV-CURRENT-CCYY.                                      00740095
007400            15 PV-CURRENT-CC           PIC  9(02)    VALUE 0.     00741095
007500            15 PV-CURRENT-YY           PIC  9(02)    VALUE 0.     00750095
007600         10 PV-CURRENT-MM              PIC  9(02)    VALUE 0.     00760088
007700         10 PV-CURRENT-DD              PIC  9(02)    VALUE 0.     00770088
007800     05 PV-CURRENT-YYMMDD-DATE.                                   00780088
007900         10 PV-CURRENT-YYMMDD-YY       PIC  9(02)    VALUE 0.     00790088
008000         10 PV-CURRENT-YYMMDD-MM       PIC  9(02)    VALUE 0.     00800088
008100         10 PV-CURRENT-YYMMDD-DD       PIC  9(02)    VALUE 0.     00810088
008200      05 PV-BEG-DATE-CYMD.                                        00820088
008300         10 PV-BEG-YMD-CC              PIC  9(02)    VALUE ZEROS. 00830088
008400         10 PV-BEG-YMD-YY              PIC  9(02)    VALUE ZEROS. 00840088
008500         10 PV-BEG-YMD-MM              PIC  9(02)    VALUE ZEROS. 00850088
008600         10 PV-BEG-YMD-DD              PIC  9(02)    VALUE ZEROS. 00860088
008700      05 PV-END-DATE-CYMD.                                        00870088
008800         10 PV-END-YMD-CC              PIC  9(02)    VALUE ZEROS. 00880088
008900         10 PV-END-YMD-YY              PIC  9(02)    VALUE ZEROS. 00890088
009000         10 PV-END-YMD-MM              PIC  9(02)    VALUE ZEROS. 00900088
009100         10 PV-END-YMD-DD              PIC  9(02)    VALUE ZEROS. 00910088
009200      05 PV-BEG-DATE.                                             00920088
009300         10 PV-BEG-MM                  PIC  9(02)    VALUE ZEROS. 00930088
009400         10 FILLER                     PIC  X(01)    VALUE '/'.   00940088
009500         10 PV-BEG-DD                  PIC  9(02)    VALUE ZEROS. 00950088
009600         10 FILLER                     PIC  X(01)    VALUE '/'.   00960088
009700         10 PV-BEG-YY                  PIC  9(02)    VALUE ZEROS. 00970088
009800      05 PV-END-DATE.                                             00980088
009900         10 PV-END-MM                  PIC  9(02)    VALUE ZEROS. 00990088
010000         10 FILLER                     PIC  X(01)    VALUE '/'.   01000088
010100         10 PV-END-DD                  PIC  9(02)    VALUE ZEROS. 01010088
010200         10 FILLER                     PIC  X(01)    VALUE '/'.   01020088
010300         10 PV-END-YY                  PIC  9(02)    VALUE ZEROS. 01030088
010400      05 PV-START-EXTRACT              PIC X(26)     VALUE SPACE. 01040086
010500      05 FILLER  REDEFINES PV-START-EXTRACT.                      01050086
010600         10 PV-START-EXTRACT-YYYY      PIC 9999.                  01060086
010700         10 PV-START-EXTRACT-1ST       PIC X.                     01070086
010800         10 PV-START-EXTRACT-MM        PIC 99.                    01080086
010900         10 PV-START-EXTRACT-2ND       PIC X.                     01090086
011000         10 PV-START-EXTRACT-DD        PIC 99.                    01100086
011100         10 PV-START-EXTRACT-3RD       PIC X.                     01110086
011200         10 PV-START-TIMESTAMP         PIC X(15).                 01120086
011300      05 PV-END-EXTRACT                PIC X(26)     VALUE SPACE. 01130086
011400      05 FILLER  REDEFINES PV-END-EXTRACT.                        01140086
011500         10 PV-END-EXTRACT-YYYY        PIC 9999.                  01150086
011600         10 PV-END-EXTRACT-YYYY-RE REDEFINES PV-END-EXTRACT-YYYY. 01160086
011700            15 PV-END-EXTRACT-CC       PIC 99.                    01170086
011800            15 PV-END-EXTRACT-YY       PIC 99.                    01180086
011900         10 PV-END-EXTRACT-1ST         PIC X.                     01190086
012000         10 PV-END-EXTRACT-MM          PIC 99.                    01200086
012100         10 PV-END-EXTRACT-2ND         PIC X.                     01210086
012200         10 PV-END-EXTRACT-DD          PIC 99.                    01220086
012300         10 PV-END-EXTRACT-3RD         PIC X.                     01230086
012400         10 PV-END-TIMESTAMP           PIC X(15).                 01240086
012500     05  PV-TRECEIV-COUNT             PIC S9(09) VALUE ZERO       01250088
012600                                                 COMP SYNC.       01260088
012700     05  PV-DISPLAY-COUNT            PIC ZZZ,ZZZ,ZZ9.             01270088
012800     05  PV-PARAGRAPH-NAME            PIC  X(30)  VALUE SPACES.   01280090
012900     05  PV-SQLCODE                   PIC 9(9)  VALUE ZERO.       01290089
013000     05  PV-SEASON-DESC               PIC X(06) VALUE SPACES.     01300088
013100     05  PV-YEAR-FORMAT.                                          01310089
013200        10  PV-YEAR-FORMAT-CC         PIC 9(02) VALUE 0.          01320089
013300        10  PV-YEAR-FORMAT-YY         PIC 9(02) VALUE 0.          01330089
013400 01  PV-DATETIME-WORK.                                            01340089
013500     05  PV-DATETIME-CC           PIC 9(02).                      01350089
013600     05  PV-DATETIME-YY           PIC 9(02).                      01360089
013700     05  FILLER                   PIC X(01)  VALUE '-'.           01370089
013800     05  PV-DATETIME-MM           PIC 9(02).                      01380089
013900     05  FILLER                   PIC X(01)  VALUE '-'.           01390089
014000     05  PV-DATETIME-DD           PIC 9(02).                      01400089
014100     05  FILLER                   PIC X(01)  VALUE '-'.           01410089
014200     05  PV-DATETIME-HO           PIC 9(02).                      01420089
014300     05  FILLER                   PIC X(01)  VALUE '.'.           01430089
014400     05  PV-DATETIME-MI           PIC 9(02).                      01440089
014500     05  FILLER                   PIC X(01)  VALUE '.'.           01450089
014600     05  PV-DATETIME-SS           PIC 9(02).                      01460089
014700     05  FILLER                   PIC X(01)  VALUE '.'.           01470089
014800     05  PV-DATETIME-MSEC         PIC 9(06).                      01480089
014900                                                                  01490089
015000 01  PV-DATE-RECORD.                                              01500011
015100     05  PV-DATE-START-MM             PIC X(02) VALUE SPACE.      01510032
015200     05  FILLER                       PIC X(01) VALUE '/'.        01520032
015300     05  PV-DATE-START-DD             PIC X(02) VALUE SPACE.      01530032
015400     05  FILLER                       PIC X(01) VALUE '/'.        01540032
015500     05  PV-DATE-START-CCYY           PIC X(04) VALUE SPACE.      01550038
015600     05  FILLER                       PIC X(01) VALUE SPACE.      01560032
015700     05  PV-DATE-END-MM               PIC X(02) VALUE SPACE.      01570032
015800     05  FILLER                       PIC X(01) VALUE '/'.        01580032
015900     05  PV-DATE-END-DD               PIC X(02) VALUE SPACE.      01590032
016000     05  FILLER                       PIC X(01) VALUE '/'.        01600032
016100     05  PV-DATE-END-CCYY             PIC X(04) VALUE SPACE.      01610038
016200     05  FILLER                       PIC X(01) VALUE SPACE.      01620032
016300     05  PV-DATE-FISCAL-PERIOD        PIC 9(02) VALUE ZEROES.     01630019
016400     05  FILLER                       PIC X(01) VALUE SPACE.      01640011
016500     05  PV-DATE-FISCAL-QUARTER       PIC 9(01) VALUE ZERO.       01650019
016600     05  FILLER                       PIC X(01)  VALUE SPACE.     01660078
016700     05  PV-DATE-SEASON               PIC X(06)  VALUE SPACES.    01670078
016800     05  FILLER                       PIC X(47)  VALUE SPACES.    01680078
016900                                                                  01690010
017000 01 PC-PRROGRAM-CONSTANTS.                                        01700088
017100     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'RCKUT056'.01710089
017300     05 PC-ONE                        PIC 9(01) VALUE 1.          01730089
017400     05 PC-SEVEN                      PIC 9(02) VALUE 7.          01740089
017500     05 PC-TWENTY-EIGHT               PIC 9(02) VALUE 28.         01750089
017600     05 PC-SPRING                     PIC X(06) VALUE 'SPRING'.   01760088
017700     05 PC-FALL                       PIC X(06) VALUE '  FALL'.   01770088
017800     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         01780089
017900                                                 COMP SYNC.       01790089
018000     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.01800088
018100     05  PC-SYSTEM-DATE              PIC  9(06)    VALUE ZERO.    01810088
018200                                                                  01820090
018300 01 CC-CONTROL-CARD-PARAMETERS.                                   01830000
018400    05 CC-BEG-DATE.                                               01840000
018500       10 CC-BEG-CC                   PIC 9(02) VALUE ZEROS.      01850045
018600       10 CC-BEG-YY                   PIC 9(02) VALUE ZEROS.      01860045
018700       10 FILLER                      PIC X(01) VALUE SPACE.      01870042
018800       10 CC-BEG-MM                   PIC 9(02) VALUE ZEROS.      01880042
018900       10 FILLER                      PIC X(01) VALUE SPACE.      01890042
019000       10 CC-BEG-DD                   PIC 9(02) VALUE ZEROS.      01900042
019100    05 FILLER                       PIC X(01) VALUE SPACE.        01910042
019200    05 CC-END-DATE.                                               01920042
019300       10 CC-END-CC                   PIC 9(02) VALUE ZEROS.      01930045
019400       10 CC-END-YY                   PIC 9(02) VALUE ZEROS.      01940045
019500       10 FILLER                      PIC X(01) VALUE SPACE.      01950042
019600       10 CC-END-MM                   PIC 9(02) VALUE ZEROS.      01960042
019700       10 FILLER                      PIC X(01) VALUE SPACE.      01970042
019800       10 CC-END-DD                   PIC 9(02) VALUE ZEROS.      01980042
019900    05 FILLER                       PIC X(01) VALUE SPACE.        01990042
020000    05 CC-MODE-IND                  PIC X(01) VALUE SPACE.        02000042
020100       88 CC-VALID-MODE-IND         VALUE 'W', 'M',               02010042
020200                                          'F', 'C', 'S'.          02020042
020400       88 CC-WEEKLY-EXTRACT         VALUE 'W'.                    02040042
020500       88 CC-MONTHLY-EXTRACT        VALUE 'M'.                    02050042
020600       88 CC-FISCAL-EXTRACT         VALUE 'F'.                    02060042
020700       88 CC-CALENDAR-EXTRACT       VALUE 'C'.                    02070042
020800       88 CC-SEASONAL-EXTRACT       VALUE 'S'.                    02080042
020900    05 FILLER                       PIC X(57) VALUE SPACE.        02090045
021000                                                                  02100090
021100                                                                  02110090
021200 01  PV-ABEND-FIELDS.                                             02120088
021300     05  PV-ABEND-CODE                PIC S9(04) VALUE +0         02130088
021400                                                 COMP SYNC.       02140088
021500     05  PV-ABEND-PROGRAM             PIC  X(08) VALUE 'RCKUT056'.02150088
021600     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    02160088
021700     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    02170089
021800     05  PV-ABEND-STRUCTURE-1         PIC  X(08) VALUE SPACES.    02180089
021900     05  PV-ABEND-STRUCTURE-2         PIC  X(08) VALUE SPACES.    02190089
022000     05  PV-ABEND-STRUCTURE-3         PIC  X(08) VALUE SPACES.    02200089
022100     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    02210088
022200     05  PV-DB2-OPERATION-MESSAGE-2   PIC  X(79) VALUE SPACES.    02220088
022300     05  PV-DB2-OPERATION-MESSAGE-3   PIC  X(79) VALUE SPACES.    02230088
022400     05  PV-DB2-OPERATION-MESSAGE-4   PIC  X(79) VALUE SPACES.    02240088
022500     05  PV-DB2-TABLE-NAME            PIC  X(08) VALUE SPACES.    02250088
022600                                                                  02260090
022700 01  WS-WORKING-STORAGE-HOLD-FIELDS.                              02270011
022800                                                                  02280090
022900     05  WS-FISCAL-PERIOD-NBR         PIC  9(02) VALUE ZEROES.    02290088
023000     05  WS-FISCAL-PERIOD-WEEK        PIC  9(02) VALUE ZEROES.    02300088
023100     05  WS-FISCAL-QTR-NBR            PIC  9(01) VALUE ZERO.      02310088
023200     05  WS-FISCAL-WEEK-NBR           PIC  9(02) VALUE ZEROES.    02320088
023300                                                                  02330088
023400     05  WS-DEPT-ARRIVE-PERIOD-NBR    PIC  9(02) VALUE ZEROES.    02340088
023500     05  WS-DEPT-ARRIVE-PERIOD-WEEK   PIC  9(02) VALUE ZEROES.    02350088
023600     05  WS-DEPT-ARRIVE-QTR-NBR       PIC  9(01) VALUE ZERO.      02360088
023700     05  WS-DEPT-ARRIVE-FISCAL-WEEK   PIC  9(02) VALUE ZEROES.    02370088
023800                                                                  02380088
023900     05  WS-DEPT-VERFYD-PERIOD-NBR    PIC  9(02) VALUE ZEROES.    02390088
024000     05  WS-DEPT-VERFYD-PERIOD-WEEK   PIC  9(02) VALUE ZEROES.    02400088
024100     05  WS-DEPT-VERFYD-QTR-NBR       PIC  9(01) VALUE ZERO.      02410088
024200     05  WS-DEPT-VERFYD-FISCAL-WEEK   PIC  9(02) VALUE ZEROES.    02420088
024300                                                                  02430088
024400     05  WS-EXPTED-ITEM-QTY           PIC S9(09) VALUE ZEROS      02440086
024500                                                 COMP.            02450086
024600     05  WS-VERIFY-ITEM-QTY           PIC S9(09) VALUE ZEROS      02460090
024700                                                 COMP.            02470086
024800     05  WS-PREVIOUS-ARRIVE-DATE      PIC  X(10) VALUE SPACES.    02480088
024900                                                                  02490088
025000     05  WS-ARRIVE-DATE-WORK.                                     02500088
025100         10  WS-WORK-ARRIVE-MM        PIC  9(02) VALUE ZEROES.    02510088
025200         10  FILLER                   PIC  X     VALUE '/'.       02520088
025300         10  WS-WORK-ARRIVE-DD        PIC  9(02) VALUE ZEROES.    02530088
025400         10  FILLER                   PIC  X     VALUE '/'.       02540088
025500         10  WS-WORK-ARRIVE-CC        PIC  9(02) VALUE ZEROES.    02550088
025600         10  WS-WORK-ARRIVE-YY        PIC  9(02) VALUE ZEROES.    02560088
025700                                                                  02570088
025800     05  WS-ARRIVE-DATE.                                          02580089
025900         10  WS-ARRIVE-CC             PIC  9(02) VALUE ZEROES.    02590089
026000         10  WS-ARRIVE-YY             PIC  9(02) VALUE ZEROES.    02600089
026100         10  FILLER                   PIC  X     VALUE '-'.       02610089
026200         10  WS-ARRIVE-MM             PIC  9(02) VALUE ZEROES.    02620089
026300         10  FILLER                   PIC  X     VALUE '-'.       02630089
026400         10  WS-ARRIVE-DD             PIC  9(02) VALUE ZEROES.    02640089
026500                                                                  02650088
026600     05  WS-PREVIOUS-VERFYD-DATE      PIC  X(10) VALUE SPACES.    02660088
026700                                                                  02670088
026800     05  WS-VERFYD-DATE-WORK.                                     02680088
026900         10  WS-WORK-VERFYD-MM        PIC  9(02) VALUE ZEROES.    02690088
027000         10  FILLER                   PIC  X     VALUE '/'.       02700088
027100         10  WS-WORK-VERFYD-DD        PIC  9(02) VALUE ZEROES.    02710088
027200         10  FILLER                   PIC  X     VALUE '/'.       02720088
027300         10  WS-WORK-VERFYD-CC        PIC  9(02) VALUE ZEROES.    02730088
027400         10  WS-WORK-VERFYD-YY        PIC  9(02) VALUE ZEROES.    02740088
027500                                                                  02750088
027600     05  WS-VERFYD-DATE.                                          02760089
027700         10  WS-VERFYD-CC             PIC  9(02) VALUE ZEROES.    02770089
027800         10  WS-VERFYD-YY             PIC  9(02) VALUE ZEROES.    02780089
027900         10  FILLER                   PIC  X     VALUE '-'.       02790089
028000         10  WS-VERFYD-MM             PIC  9(02) VALUE ZEROES.    02800089
028100         10  FILLER                   PIC  X     VALUE '-'.       02810089
028200         10  WS-VERFYD-DD             PIC  9(02) VALUE ZEROES.    02820089
028300                                                                  02830089
028400     05  WS-RECORDS-READ              PIC  9(09) VALUE ZEROES.    02840020
028500     05  WS-RECORDS-WRITTEN           PIC  9(09) VALUE ZEROES.    02850020
028600                                                                  02860090
028700      05 WS-START-EXTRACT.                                        02870089
028800         10 WS-START-EXTRACT-YYYY      PIC 9999.                  02880089
028900         10 WS-START-EXTRACT-MM        PIC 99.                    02890089
029000         10 WS-START-EXTRACT-DD        PIC 99.                    02900089
029100                                                                  02910090
029200      05 WS-END-EXTRACT.                                          02920089
029300         10 WS-END-EXTRACT-YYYY        PIC 9999.                  02930089
029400         10 WS-END-EXTRACT-MM          PIC 99.                    02940089
029500         10 WS-END-EXTRACT-DD          PIC 99.                    02950089
029600                                                                  02960089
029700******************************************************************02970010
029800*  USED FOR DB2 ERROR MESSAGE BUILDING                            02980010
029900******************************************************************02990010
030000     COPY DPWS004.                                                03000099
030100                                                                  03010089
030200******************************************************************03020010
030300*   DB2 SQL COMMUNICATION AREA                                    03030010
030400******************************************************************03040010
030500     EXEC SQL                                                     03050010
030600          INCLUDE SQLCA                                           03060010
030700     END-EXEC.                                                    03070010
030800                                                                  03080010
030900******************************************************************03090010
031000*   DB2 DCLGEN FOR RECEIVER TABLE                                 03100010
031100******************************************************************03110010
031200     EXEC SQL                                                     03120010
031300          INCLUDE TRECEIV                                         03130010
031400     END-EXEC.                                                    03140010
031500                                                                  03150010
031600******************************************************************03160010
031700*   DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                    03170010
031800******************************************************************03180010
031900     EXEC SQL                                                     03190010
032000          INCLUDE TRECDIS                                         03200010
032100     END-EXEC.                                                    03210010
032200                                                                  03220010
032300******************************************************************03230010
032400*  DCLGEN FOR THE DB2 PURCHASE ORDER TABLE                        03240010
032500******************************************************************03250010
032600     EXEC SQL                                                     03260010
032700         INCLUDE TPURCHS                                          03270010
032800     END-EXEC.                                                    03280010
032900                                                                  03290010
033000******************************************************************03300010
033100*  DCLGEN FOR THE COMPANY CONTROL TABLE                           03310010
033200******************************************************************03320010
033300     EXEC SQL                                                     03330010
033400         INCLUDE TCOCNTL                                          03340010
033500     END-EXEC.                                                    03350010
033600                                                                  03360010
033700******************************************************************03370010
033800* TRECEIV CURSOR                                                 *03380010
033900******************************************************************03390010
034000     EXEC SQL                                                     03400010
034100          DECLARE TRECEIV-CSR CURSOR WITH HOLD FOR                03410011
034200          SELECT A.ORD_NBR,                                       03420011
034300                 A.REC_SEQ_NBR,                                   03430011
034400                 B.DEPT_NBR,                                      03440011
034500                 A.OPER_UNT_ID,                                   03450011
034600                 A.FCLTY_ID,                                      03460011
034700                 A.STATUS_CDE,                                    03470011
034800                 A.REC_TMST,                                      03480011
034900                 A.EXPTED_CART_CNT,                               03490011
035000                 A.ACTL_CART_CNT,                                 03500011
035100                 A.VERFYD_TMST,                                   03510011
035200                 A.CURR_OPER_UNT_ID,                              03520011
035300                 A.CURR_FCLTY_ID,                                 03530011
035400                 A.VRFD_USR_ID,                                   03540011
035500                 B.PO_TYP_CDE,                                    03550011
035600                 B.ENT_ID                                         03560011
035700          FROM  TRECEIV A,                                        03570011
035800                TPURCHS B                                         03580011
035900          WHERE ((DATE(A.REC_TMST)     >=  :PV-START-EXTRACT AND  03590016
036000                  DATE(A.REC_TMST)     <=  :PV-END-EXTRACT)       03600016
036100          OR     (DATE(A.VERFYD_TMST)  >=  :PV-START-EXTRACT AND  03610016
036200                  DATE(A.VERFYD_TMST)  <=  :PV-END-EXTRACT))      03620016
036300          AND   NOT  A.STATUS_CDE       =  'DE'                   03630011
036400          AND   A.ORD_NBR               =  B.PO_NBR               03640011
036500          AND   B.VER_STATUS_CDE        =  'A'                    03650011
037100     END-EXEC.                                                    03710010
037200                                                                  03720010
037300***********************************************************       03730010
037400*  COPYBOOK USED BY CALENDAR ROUTINE                      *       03740010
037500***********************************************************       03750010
037600     COPY DPWS500.                                                03760099
037700                                                                  03770090
037800***********************************************************       03780010
037900*  COPYBOOK USED IN CREATING EXTRACT FILE.                *       03790010
038000***********************************************************       03800010
038100     COPY RCRD035.                                                03810099
038200                                                                  03820090
038300                                                                  03830090
038400 PROCEDURE DIVISION.                                              03840010
038500                                                                  03850010
038600     PERFORM 1000-INITIALIZATION.                                 03860010
038700                                                                  03870010
038800     PERFORM 2000-PROCESS-EXTRACTS                                03880010
038900         UNTIL PS-EOF-TRECEIV-CSR.                                03890010
039000                                                                  03900010
039100     PERFORM 7200-CLOSE-TRECEIV-CSR.                              03910010
039200                                                                  03920010
039300     CLOSE DATE-FILE                                              03930011
039400           EXTRACT-FILE.                                          03940011
039500                                                                  03950010
039600     MOVE PV-TRECEIV-COUNT TO PV-DISPLAY-COUNT                    03960010
039700     DISPLAY 'NUMBER OF TRECEIV ROWS EXTRACTED  '                 03970012
039800                                  PV-DISPLAY-COUNT.               03980010
039900     MOVE WS-RECORDS-WRITTEN TO PV-DISPLAY-COUNT                  03990012
040000     DISPLAY 'NUMBER OF EXTRACT RECORDS WRITTEN '                 04000012
040100                                  PV-DISPLAY-COUNT.               04010012
040200     DISPLAY '                                      '.            04020041
040300     DISPLAY '--------------------------------------'.            04030041
040400                                                                  04040010
040500     GOBACK.                                                      04050010
040600                                                                  04060010
040700/                                                                 04070010
040800 1000-INITIALIZATION.                                             04080000
040900     MOVE '1000-INITIALIZATION     '   TO PV-ABEND-PARAGRAPH.     04090036
041000                                                                  04100036
041100     OPEN OUTPUT DATE-FILE                                        04110010
041200                 EXTRACT-FILE.                                    04120011
041300                                                                  04130010
041400     ACCEPT PC-SYSTEM-DATE FROM DATE.                             04140039
041500                                                                  04150039
041600     EXEC SQL                                                     04160039
041700         SELECT (CURRENT DATE - 1 DAY)                            04170039
041800               , CURRENT DATE                                     04180039
041800               , (CURRENT DATE - 1 YEAR)                          04181095
041900           INTO  :PV-CURRENT-DB2-DATE-ONE                         04190039
042000               , :PV-CURRENT-DB2-DATE                             04200039
042000               , :PV-CURRENT-DB2-DATE-ONEYR                       04201095
042100           FROM  TCOCNTL                                          04210010
042200          WHERE  OPER_UNT_ID = 90                                 04220010
042300     END-EXEC.                                                    04230010
042400                                                                  04240010
042500     EVALUATE TRUE                                                04250010
042600         WHEN SQLCODE = ZERO                                      04260010
042700             MOVE PV-CURRENT-DB2-DATE    TO PV-CURR-DATE          04270010
042800             MOVE PV-CURRENT-DB2-CC      TO PV-CURRENT-CC         04280010
042900             MOVE PV-CURRENT-DB2-YY      TO PV-CURRENT-YY         04290010
043000                                            PV-CURRENT-YYMMDD-YY  04300010
043100             MOVE PV-CURRENT-DB2-MM      TO PV-CURRENT-MM         04310010
043200                                            PV-CURRENT-YYMMDD-MM  04320010
043300             MOVE PV-CURRENT-DB2-DD      TO PV-CURRENT-DD         04330010
043400                                            PV-CURRENT-YYMMDD-DD  04340010
043500         WHEN OTHER                                               04350010
043600              MOVE '1100-INITIALIZATION'      TO                  04360010
043700                   PV-ABEND-PARAGRAPH                             04370020
043800              MOVE 'SET DATE   '  TO PV-DB2-OPERATION-MESSAGE-1   04380020
043900              MOVE 'NONE   '      TO PV-DB2-TABLE-NAME            04390020
044000              PERFORM 9900-DB2-ABEND                              04400020
044100      END-EVALUATE.                                               04410010
044200                                                                  04420010
044300     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                04430010
044400                                                                  04440000
044500     DISPLAY '--------------------------------------'.            04450041
044600     DISPLAY '-        PROGRAM - RCKUT056          -'.            04460041
044700     DISPLAY '--------------------------------------'.            04470041
044800     DISPLAY '                                      '.            04480041
044900                                                                  04490041
045000     DISPLAY 'CONTROL CARD SET-UP FOR THIS RUN IS:  '             04500041
045100             CC-CONTROL-CARD-PARAMETERS.                          04510041
045200                                                                  04520041
045300     PERFORM 1100-CHECK-CC-PARAMETERS.                            04530041
045400     PERFORM 1200-SET-DATABASE-KEYS.                              04540041
045500     PERFORM 7000-OPEN-TRECEIV-CURSOR.                            04550041
045600     PERFORM 7100-FETCH-TRECEIV-CSR.                              04560041
045700                                                                  04570041
045800 1100-CHECK-CC-PARAMETERS.                                        04580041
045900     MOVE '1100-CHECK-CC-PARAMETERS'   TO PV-ABEND-PARAGRAPH.     04590041
046000                                                                  04600041
046100*************************************************************     04610041
046200* CHECK THAT A VALID TIME FRAME HAS BEEN REQUESTED.         *     04620041
046300*************************************************************     04630041
046400*                                                                 04640041
046500     MOVE '1100-CHECK-CC-PARAMETERS'   TO PV-ABEND-PARAGRAPH.     04650041
046600     MOVE '1100-CHECK-CC-PARAMETERS'   TO PV-PARAGRAPH-NAME.      04660090
046700                                                                  04670041
046800     IF NOT CC-VALID-MODE-IND                                     04680041
046900         DISPLAY '***************************'                    04690044
047000         DISPLAY '**       ABEND           **'                    04700044
047100         DISPLAY '**  IN PROGRAM RCKUT056  **'                    04710044
047200         DISPLAY '***************************'                    04720044
047300         DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME     04730044
047400         DISPLAY '**   ERROR         ** = '                       04740044
047500                 'MODE INDICATOR "' CC-MODE-IND '"'               04750044
047600                 ' IS INVALID'                                    04760044
047700         DISPLAY '***************************'                    04770044
047800         DISPLAY '** CONTROL PARAMETERS = '                       04780044
047900                  CC-CONTROL-CARD-PARAMETERS                      04790044
048000         DISPLAY 'RUN ABORTED'                                    04800044
048100         DISPLAY '***************************'                    04810044
048200         MOVE 4003  TO PV-ABEND-CODE                              04820044
048300         DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                 04830044
048400         CALL 'ILBOABN0'   USING PV-ABEND-CODE                    04840044
048500     END-IF.                                                      04850041
048600                                                                  04860041
048700                                                                  04870000
048800     IF CC-BEG-DATE IS  = PC-DEFAULT-CC-DATE AND                  04880000
048900        CC-END-DATE IS  = PC-DEFAULT-CC-DATE                      04890000
049000        SET PS-NORMAL-RUN           TO TRUE                       04900000
049100     ELSE                                                         04910000
049200        SET PS-SPECIAL-RUN    TO TRUE                             04920010
049300        MOVE CC-BEG-CC        TO PV-BEG-YMD-CC                    04930063
049400        MOVE CC-BEG-YY        TO PV-BEG-YY                        04940063
049500        MOVE CC-BEG-YY        TO PV-BEG-YMD-YY                    04950063
049600        MOVE CC-BEG-MM        TO PV-BEG-MM                        04960063
049700        MOVE CC-BEG-MM        TO PV-BEG-YMD-MM                    04970063
049800        MOVE CC-BEG-DD        TO PV-BEG-DD                        04980063
049900        MOVE CC-BEG-DD        TO PV-BEG-YMD-DD                    04990063
050000        MOVE CC-END-CC        TO PV-END-YMD-CC                    05000063
050100        MOVE CC-END-YY        TO PV-END-YY                        05010063
050200        MOVE CC-END-YY        TO PV-END-YMD-YY                    05020063
050300        MOVE CC-END-MM        TO PV-END-MM                        05030063
050400        MOVE CC-END-MM        TO PV-END-YMD-MM                    05040063
050500        MOVE CC-END-DD        TO PV-END-DD                        05050063
050600        MOVE CC-END-DD        TO PV-END-YMD-DD                    05060063
050700                                                                  05070063
050800        IF  PV-BEG-DATE-CYMD IS NOT < PV-END-DATE-CYMD  AND       05080063
050900            PV-BEG-DATE-CYMD IS NOT = PV-END-DATE-CYMD            05090063
051000            DISPLAY '***************************'                 05100010
051100            DISPLAY 'CONTROL PARAMETERS: '                        05110010
051200                     CC-CONTROL-CARD-PARAMETERS                   05120010
051300            DISPLAY                                               05130010
051400              'THE BEGINNING DATE MUST BE LESS THAN '             05140010
051500              'OR EQUAL TO THE ENDING DATE'                       05150010
051600            DISPLAY 'PV-BEG-DATE - ' PV-BEG-DATE                  05160063
051700            DISPLAY 'PV-END-DATE - ' PV-BEG-DATE                  05170063
051800            DISPLAY 'PV-BEG-DATE-CYMD - ' PV-BEG-DATE-CYMD        05180063
051900            DISPLAY 'PV-END-DATE-CYMD - ' PV-BEG-DATE-CYMD        05190063
052000            DISPLAY 'RUN ABORTED'                                 05200062
052100            DISPLAY '***************************'                 05210010
052200            MOVE 4003  TO PV-ABEND-CODE                           05220010
052300            DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE              05230010
052400            CALL 'ILBOABN0'   USING PV-ABEND-CODE                 05240020
052500        END-IF                                                    05250010
052600        INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            05260095
052600        SET DPG51-FISCAL-454-CALENDAR   TO TRUE                   05261095
052700        SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                   05270010
052800        SET DPG52-LK-DTE-GREG-FMT       TO TRUE                   05280010
052900        MOVE PV-BEG-DATE                TO DPG52-LK-DATE-INPUT    05290010
053000        PERFORM 9100-CALL-DATE-MODULE                             05300010
053100        IF DPG54-DATE-INVALID                                     05310010
053200           DISPLAY '***************************'                  05320010
053300           DISPLAY 'CONTROL PARAMETERS: '                         05330010
053400                    CC-CONTROL-CARD-PARAMETERS                    05340010
053500           DISPLAY 'BEGINNING DATE  '                             05350010
053600                   CC-BEG-DATE                                    05360010
053700                   ' IS INVALID.'                                 05370010
053800           DISPLAY 'RUN ABORTED'                                  05380010
053900           DISPLAY '***************************'                  05390010
054000           MOVE 4003  TO PV-ABEND-CODE                            05400010
054100           DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE               05410010
054200           CALL 'ILBOABN0'   USING PV-ABEND-CODE                  05420020
054300        END-IF                                                    05430010
054400        INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            05440095
054400        SET DPG51-FISCAL-454-CALENDAR   TO TRUE                   05441095
054500        SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                   05450010
054600        SET DPG52-LK-DTE-GREG-FMT       TO TRUE                   05460010
054700        MOVE PV-END-DATE                TO DPG52-LK-DATE-INPUT    05470010
054800        PERFORM 9100-CALL-DATE-MODULE                             05480010
054900        IF DPG54-DATE-INVALID                                     05490010
055000           DISPLAY '***************************'                  05500010
055100           DISPLAY 'CONTROL PARAMETERS: '                         05510010
055200                    CC-CONTROL-CARD-PARAMETERS                    05520010
055300           DISPLAY 'ENDING DATE '                                 05530010
055400                   CC-END-DATE                                    05540010
055500                   ' IS INVALID.'                                 05550010
055600           DISPLAY 'RUN ABORTED'                                  05560010
055700           DISPLAY '***************************'                  05570010
055800           MOVE 4003  TO PV-ABEND-CODE                            05580010
055900           DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE               05590010
056000           CALL 'ILBOABN0'   USING PV-ABEND-CODE                  05600020
056100        END-IF                                                    05610010
056200     END-IF.                                                      05620010
056300                                                                  05630010
056400                                                                  05640080
056500     IF  PS-SPECIAL-RUN  AND                                      05650080
056600         CC-SEASONAL-EXTRACT  AND                                 05660080
056700         DPG56-FISCAL-PERIOD-NBR < 7                              05670080
056800            MOVE PC-SPRING TO PV-SEASON-DESC                      05680080
056900     ELSE                                                         05690080
057000     IF  PS-SPECIAL-RUN  AND                                      05700080
057100         CC-SEASONAL-EXTRACT                                      05710080
057200            MOVE PC-FALL   TO PV-SEASON-DESC                      05720080
057300     END-IF.                                                      05730080
057400                                                                  05740080
057500 1200-SET-DATABASE-KEYS.                                          05750080
057600     MOVE '1200-SET-DATABASE-KEYS  '   TO PV-ABEND-PARAGRAPH.     05760080
057700                                                                  05770080
057800     IF PS-NORMAL-RUN                                             05780080
057900        PERFORM 1210-DETERMINE-DATE-RANGE                         05790080
058000     ELSE                                                         05800080
058100        MOVE CC-BEG-DATE         TO PV-START-EXTRACT              05810080
058200        MOVE CC-END-DATE         TO PV-END-EXTRACT                05820080
058300     END-IF.                                                      05830080
058400                                                                  05840080
058500     MOVE  PV-START-EXTRACT-YYYY    TO  WS-START-EXTRACT-YYYY.    05850080
058600     MOVE  PV-START-EXTRACT-MM      TO  WS-START-EXTRACT-MM.      05860080
058700     MOVE  PV-START-EXTRACT-DD      TO  WS-START-EXTRACT-DD.      05870080
058800     MOVE  PV-END-EXTRACT-YYYY      TO  WS-END-EXTRACT-YYYY.      05880080
058900     MOVE  PV-END-EXTRACT-MM        TO  WS-END-EXTRACT-MM.        05890080
059000     MOVE  PV-END-EXTRACT-DD        TO  WS-END-EXTRACT-DD.        05900080
059100                                                                  05910080
059200                                                                  05920080
059300     MOVE  DPG56-FISCAL-PERIOD-NBR  TO  WS-FISCAL-PERIOD-NBR.     05930080
059400     MOVE  DPG56-FISCAL-PERIOD-WEEK TO  WS-FISCAL-PERIOD-WEEK.    05940080
059500     MOVE  DPG56-FISCAL-QTR-NBR     TO  WS-FISCAL-QTR-NBR.        05950080
059600     MOVE  DPG56-FISCAL-WEEK-NBR    TO  WS-FISCAL-WEEK-NBR.       05960080
059700                                                                  05970080
059800     MOVE  PV-START-EXTRACT-MM      TO PV-DATE-START-MM.          05980032
059900     MOVE  PV-START-EXTRACT-DD      TO PV-DATE-START-DD.          05990032
060000     MOVE  PV-START-EXTRACT-YYYY    TO PV-DATE-START-CCYY.        06000032
060100     MOVE  PV-END-EXTRACT-MM        TO PV-DATE-END-MM.            06010032
060200     MOVE  PV-END-EXTRACT-DD        TO PV-DATE-END-DD.            06020032
060300     MOVE  PV-END-EXTRACT-YYYY      TO PV-DATE-END-CCYY.          06030032
060400     MOVE  WS-FISCAL-PERIOD-NBR     TO PV-DATE-FISCAL-PERIOD.     06040032
060500     MOVE  WS-FISCAL-QTR-NBR        TO PV-DATE-FISCAL-QUARTER.    06050032
060600     MOVE  PV-SEASON-DESC           TO PV-DATE-SEASON.            06060079
060700                                                                  06070078
060800     DISPLAY 'DATE RANGE SET-UP FOR THIS RUN IS:    '             06080078
060900             PV-DATE-RECORD.                                      06090078
061000                                                                  06100078
061100     WRITE DATE-RECORD FROM PV-DATE-RECORD.                       06110037
061200                                                                  06120037
061300 1210-DETERMINE-DATE-RANGE.                                       06130037
061400     MOVE '1210-DETERMINE-DATE-RANGE'  TO PV-ABEND-PARAGRAPH.     06140037
061500                                                                  06150037
061600     EVALUATE TRUE                                                06160037
061700       WHEN CC-WEEKLY-EXTRACT                                     06170037
061800            PERFORM 1212-WEEKLY-RPT-DTE-RANGE                     06180037
061900                                                                  06190037
062000       WHEN CC-MONTHLY-EXTRACT                                    06200037
062100                PERFORM 1213-MONTHLY-RPT-DTE-RANGE                06210037
062200                                                                  06220037
062300       WHEN CC-FISCAL-EXTRACT                                     06230037
062400                PERFORM 1214-FISCAL-RPT-DTE-RANGE                 06240037
062500                                                                  06250037
062600       WHEN CC-CALENDAR-EXTRACT                                   06260037
062700                PERFORM 1215-CALENDAR-RPT-DTE-RANGE               06270037
062800                                                                  06280037
062900       WHEN CC-SEASONAL-EXTRACT                                   06290037
063000                PERFORM 1216-SEASONAL-RPT-DTE-RANGE               06300037
063100                                                                  06310037
063200     END-EVALUATE.                                                06320037
063300                                                                  06330037
063400 1212-WEEKLY-RPT-DTE-RANGE.                                       06340037
063500*--------------------------------------------------------------   06350037
063600**** GET START/END DATES OF THE PREVIOUS WEEK.                    06360037
063700*--------------------------------------------------------------   06370037
063800     MOVE '1212-WEEKLY-RPT-DTE-RANGE'  TO PV-ABEND-PARAGRAPH.     06380037
063900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06390095
064000     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               06400032
064100     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               06410032
064200     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               06420032
064300     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           06430032
064400     MOVE   PC-SEVEN           TO DPG51-INCR-DECR-DAYS-9.         06440032
064500                                                                  06450032
064600     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      06460032
064700     SET DPG51-DECREMENT-DATE       TO TRUE.                      06470032
064800     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      06480032
064900                                                                  06490032
065000     PERFORM 9100-CALL-DATE-MODULE                                06500032
065100                                                                  06510032
065200     IF DPG54-DATE-VALID                                          06520032
065300         MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO PV-START-EXTRACT      06530032
065400         MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PV-END-EXTRACT        06540032
065500     ELSE                                                         06550052
065600         DISPLAY 'DPG55-1ST-WKDY-DB2ISO-FMT - '                   06560051
065700                  DPG55-1ST-WKDY-DB2ISO-FMT                       06570051
065800         DISPLAY 'DPG55-LAST-WKDY-DB2ISO-FMT - '                  06580051
065900                  DPG55-LAST-WKDY-DB2ISO-FMT                      06590051
066000     END-IF.                                                      06600051
066100                                                                  06610051
066300                                                                  06630081
066400 1213-MONTHLY-RPT-DTE-RANGE.                                      06640051
066500*--------------------------------------------------------------   06650051
066600*** GET START/END DATES OF THE PREVIOUS MONTH.                    06660051
066700*--------------------------------------------------------------   06670051
066800     MOVE '1213-MONTHLY-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.     06680051
066900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06690095
067000     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY                06700051
067100     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM                06710051
067200     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD                06720051
067300     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            06730051
067500                                                                  06750051
067600     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9          06760051
067700                                                                  06770051
067800     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      06780051
067900     SET DPG51-DECREMENT-DATE       TO TRUE.                      06790051
068000     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      06800051
068100                                                                  06810051
068200     PERFORM 9100-CALL-DATE-MODULE                                06820051
068300                                                                  06830051
068400     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                           06840051
068500                                  PV-START-EXTRACT                06850051
068600     MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO                           06860051
068700                                  PV-END-EXTRACT.                 06870051
068800                                                                  06880051
069000                                                                  06900081
069100 1214-FISCAL-RPT-DTE-RANGE.                                       06910051
069200*-------------------------------------------------------------    06920051
069300*** GET START/END DATES OF THE FISCAL PERIOD.                     06930051
069400*-------------------------------------------------------------    06940051
069500     MOVE '1214-FISCAL-RPT-DTE-RANGE ' TO PV-ABEND-PARAGRAPH.     06950051
069600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              06960095
069700     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               06970051
069800     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               06980051
069900     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               06990051
070000     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            07000051
070100                                                                  07010051
070200     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         07020051
070300                                                                  07030051
070400     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      07040051
070500     SET DPG51-DECREMENT-DATE       TO TRUE.                      07050051
070600     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      07060051
070700                                                                  07070051
070800     PERFORM 9100-CALL-DATE-MODULE                                07080051
070900                                                                  07090051
071000     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         07100051
071100         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       07110051
071200                                  PV-START-EXTRACT                07120051
071300         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       07130051
071400                                  PV-END-EXTRACT                  07140051
071500     ELSE                                                         07150051
071600         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       07160051
071700                                  PV-START-EXTRACT                07170051
071700         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           07171095
071800         MOVE PC-ONE                   TO DPG51-INCR-DECR-DAYS-9  07180051
071900         MOVE PV-DATE-AREA             TO DPG52-LK-DATE-INPUT     07190051
072000         SET DPG51-FISCAL-454-CALENDAR TO TRUE                    07200051
072100         SET DPG51-DECREMENT-DATE      TO TRUE                    07210051
072200         SET DPG52-LK-DTE-GREG-FMT     TO TRUE                    07220051
072300         PERFORM 9100-CALL-DATE-MODULE                            07230051
072400         MOVE DPG55-DB2-ISO-DATE-FMT    TO  PV-END-EXTRACT        07240095
072500     END-IF.                                                      07250095
072700                                                                  07270081
072800 1215-CALENDAR-RPT-DTE-RANGE.                                     07280051
072900*---------------------------------------------------------------- 07290051
073000*** GET START/END DATES OF THE CALENDAR PERIOD.                   07300051
073100*---------------------------------------------------------------- 07310051
073200     MOVE '1215-CALENDAR-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    07320051
073300                                                                  07330051
065900     IF PV-CURRENT-MM = 1 THEN                                    07330195
066000****   IF JANUARY WANT TO CREATE REPORT FOR PREV. CALENDAR YEAR   07330295
065900         MOVE PV-CDD-ONEYR-CCYY         TO PV-START-EXTRACT-YYYY  07330397
065900                                           PV-END-EXTRACT-YYYY    07330495
068900         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   07330595
069000         MOVE  01      TO  PV-START-EXTRACT-MM                    07330697
069100         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   07330795
069200         MOVE  01      TO  PV-START-EXTRACT-DD                    07330897
069300         MOVE  '-'     TO  PV-END-EXTRACT-1ST                     07330995
069400         MOVE   12     TO  PV-END-EXTRACT-MM                      07331095
069500         MOVE  '-'     TO  PV-END-EXTRACT-2ND                     07331195
069600         MOVE   31     TO  PV-END-EXTRACT-DD                      07331295
069700     ELSE                                                         07331395
069800*        CURRENT MONTH > 01                                       07331495
069900*                          BEGINNING DATE = CURRENT YEAR, 01, 01  07331595
070000*                          ENDING DATE    = CURRENT DATE - 1      07331695
070100         MOVE PV-CURRENT-CCYY TO PV-START-EXTRACT-YYYY            07331795
071900         MOVE  '-'     TO  PV-START-EXTRACT-1ST                   07331895
072000         MOVE  01      TO  PV-START-EXTRACT-MM                    07331997
072100         MOVE  '-'     TO  PV-START-EXTRACT-2ND                   07332095
072200         MOVE  01      TO  PV-START-EXTRACT-DD                    07332197
072300                                                                  07332295
072400         MOVE PV-CURRENT-DB2-DATE-ONE TO PV-END-EXTRACT           07332395
072500     END-IF.                                                      07333095
080100                                                                  08010010
080200*-----------------------------------------------------------------08020077
080300* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             08030077
080400*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           08040077
080500* FROM PV-END-EXTRACT DATE.                                       08050077
080600*-----------------------------------------------------------------08060077
080700                                                                  08070077
080800     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     08080077
080900     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     08090077
081000     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     08100077
081100     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     08110077
081200     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              08120095
081300     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   08130077
081400     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  08140077
081500     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  08150077
081600     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  08160077
081700                                                                  08170077
081800     PERFORM 9100-CALL-DATE-MODULE.                               08180077
081900                                                                  08190077
082000 1216-SEASONAL-RPT-DTE-RANGE.                                     08200000
082100*-------------------------------------------------------------    08210036
082200*** GET START/END DATES SEASONAL                                  08220036
082300*-------------------------------------------------------------    08230036
082400     MOVE '1216-SEASONAL-RPT-DTE-RANGE' TO PV-ABEND-PARAGRAPH.    08240036
082500     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              08250095
082600     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               08260000
082700     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               08270000
082800     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               08280000
082900     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           08290000
083000                                                                  08300000
083100     MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9.         08310010
083200                                                                  08320000
083300     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      08330000
083400     SET DPG51-DECREMENT-DATE       TO TRUE.                      08340000
083500     SET DPG52-LK-DTE-GREG-FMT      TO TRUE.                      08350000
083600                                                                  08360000
083700     PERFORM 9100-CALL-DATE-MODULE                                08370010
083800                                                                  08380010
083900     IF DPG56-FISCAL-PERIOD-NBR < 7                               08390010
084000        MOVE PC-SPRING TO PV-SEASON-DESC                          08400010
084100     ELSE                                                         08410010
084200        MOVE PC-FALL   TO PV-SEASON-DESC                          08420010
084300     END-IF.                                                      08430010
084400     IF DPG56-FISCAL-PERIOD-NBR < 6 THEN                          08440010
084500         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       08450000
084600                                  PV-START-EXTRACT                08460000
084700         MOVE PV-CURRENT-DB2-DATE-ONE TO                          08470010
084800                           PV-END-EXTRACT                         08480000
084900     END-IF.                                                      08490010
085000     IF DPG56-FISCAL-PERIOD-NBR = 6 THEN                          08500010
085100         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       08510000
085200                                  PV-START-EXTRACT                08520000
085300         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       08530000
085400                                  PV-END-EXTRACT                  08540000
085500     END-IF.                                                      08550010
085600     IF DPG56-FISCAL-PERIOD-NBR = 7 THEN                          08560010
085700         MOVE DPG56-FIRST-FD-DB2-ISO-FMT TO                       08570000
085800                                  PV-START-EXTRACT                08580000
085900         MOVE PV-CURRENT-DB2-DATE-ONE TO                          08590010
086000                                  PV-END-EXTRACT                  08600000
086100     END-IF.                                                      08610010
086200     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          08620010
086300         MOVE PV-CURRENT-DB2-DATE-ONE TO                          08630010
086400                                  PV-END-EXTRACT                  08640000
086500     END-IF.                                                      08650010
086600     IF DPG56-FISCAL-PERIOD-NBR = 12 THEN                         08660010
086700         MOVE DPG56-LAST-FD-DB2-ISO-FMT  TO                       08670000
086800                                  PV-END-EXTRACT                  08680000
086900     END-IF.                                                      08690010
087000     IF DPG56-FISCAL-PERIOD-NBR > 7 THEN                          08700010
087100         MOVE   DPG56-FIRST-FD-DB2-ISO-FMT-YR                     08710010
087200                               TO  PV-YEAR-FORMAT                 08720010
087300         MOVE   PV-YEAR-FORMAT-YY TO                              08730010
087400                                   PV-DATE-AREA-YY                08740010
087500         MOVE   01             TO  PV-DATE-AREA-MM                08750000
087600         MOVE   01             TO  PV-DATE-AREA-DD                08760000
087800         INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56           08761096
087700         MOVE   PV-DATE-AREA   TO  DPG52-LK-DATE-INPUT            08770000
087900         MOVE 220              TO DPG51-INCR-DECR-DAYS-9          08790010
088000         SET DPG51-FISCAL-454-CALENDAR  TO TRUE                   08800000
088100         SET DPG51-INCREMENT-DATE       TO TRUE                   08810000
088200         SET DPG52-LK-DTE-GREG-FMT      TO TRUE                   08820000
088300         PERFORM 9100-CALL-DATE-MODULE                            08830010
088400         MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                       08840000
088500                                  PV-START-EXTRACT                08850000
088600     END-IF.                                                      08860010
088700                                                                  08870011
088800*-----------------------------------------------------------------08880073
088900* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             08890073
089000*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           08900073
089100* FROM PV-END-EXTRACT DATE.                                       08910073
089200*-----------------------------------------------------------------08920073
089300                                                                  08930073
089400     MOVE  PV-END-EXTRACT-MM           TO  WS-WORK-ARRIVE-MM.     08940073
089500     MOVE  PV-END-EXTRACT-DD           TO  WS-WORK-ARRIVE-DD.     08950073
089600     MOVE  PV-END-EXTRACT-CC           TO  WS-WORK-ARRIVE-CC.     08960074
089700     MOVE  PV-END-EXTRACT-YY           TO  WS-WORK-ARRIVE-YY.     08970074
089800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              08980095
089900     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   08990073
090000     MOVE  ZEROES                      TO  DPG51-INCR-DECR-DAYS-9.09000081
090100     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  09010073
090200     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  09020073
090300     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  09030073
090400                                                                  09040073
090500     PERFORM 9100-CALL-DATE-MODULE.                               09050073
090600                                                                  09060073
090700 2000-PROCESS-EXTRACTS.                                           09070011
090800     MOVE '2000-PROCESS-EXTRACTS   ' TO PV-ABEND-PARAGRAPH.       09080085
090900*-----------------------------------------------------------------09090085
091000* FROM THE RECIEPT DISTRIBUTION TABLE(TRECDIS) GET THE SUM OF THE 09100085
091100* EXPECTED & VERIFIED QUANTITIES FOR ALL LINES OF A GIVEN RECEIVER09110085
091200*-----------------------------------------------------------------09120085
091300     PERFORM 3000-GET-RECEIPT-SUM.                                09130085
091400                                                                  09140085
091500*-----------------------------------------------------------------09150085
091600* DETERMINE ARRIVE DATE PERIOD & FISCAL INFORMATION               09160085
091700*-----------------------------------------------------------------09170085
091800     MOVE  RECEIV-REC-TMST           TO  PV-DATETIME-WORK.        09180085
091900     MOVE  PV-DATETIME-CC            TO  WS-ARRIVE-CC.            09190085
092000     MOVE  PV-DATETIME-YY            TO  WS-ARRIVE-YY.            09200085
092100     MOVE  PV-DATETIME-MM            TO  WS-ARRIVE-MM.            09210085
092200     MOVE  PV-DATETIME-DD            TO  WS-ARRIVE-DD.            09220085
092300                                                                  09230085
092400     IF  WS-PREVIOUS-ARRIVE-DATE  =  WS-ARRIVE-DATE               09240085
092500         NEXT SENTENCE                                            09250085
092600     ELSE                                                         09260085
092700         PERFORM 4000-ARRIVE-DATE-PERIOD                          09270085
092800         MOVE  WS-ARRIVE-DATE        TO  WS-PREVIOUS-ARRIVE-DATE  09280085
092900     END-IF.                                                      09290085
093000                                                                  09300085
093100*-----------------------------------------------------------------09310085
093200* DETERMINE VERIFIED DATE PERIOD & FISCAL INFORMATION             09320085
093300*-----------------------------------------------------------------09330085
093400     MOVE  RECEIV-VERFYD-TMST        TO  PV-DATETIME-WORK.        09340085
093500     MOVE  PV-DATETIME-CC            TO  WS-VERFYD-CC.            09350085
093600     MOVE  PV-DATETIME-YY            TO  WS-VERFYD-YY.            09360085
093700     MOVE  PV-DATETIME-MM            TO  WS-VERFYD-MM.            09370085
093800     MOVE  PV-DATETIME-DD            TO  WS-VERFYD-DD.            09380085
093900                                                                  09390085
094000                                                                  09400085
094100     IF  WS-PREVIOUS-VERFYD-DATE  =  WS-VERFYD-DATE               09410085
094200         NEXT SENTENCE                                            09420085
094300     ELSE                                                         09430085
094400     IF  WS-VERFYD-DATE           =  '9999-09-09'                 09440085
094500         INITIALIZE                  WS-DEPT-VERFYD-PERIOD-NBR    09450085
094600         INITIALIZE                  WS-DEPT-VERFYD-PERIOD-WEEK   09460085
094700         INITIALIZE                  WS-DEPT-VERFYD-QTR-NBR       09470085
094800         INITIALIZE                  WS-DEPT-VERFYD-FISCAL-WEEK   09480085
094900         MOVE  WS-VERFYD-DATE        TO  WS-PREVIOUS-VERFYD-DATE  09490085
095000     ELSE                                                         09500085
095100         PERFORM 4100-VERFYD-DATE-PERIOD                          09510085
095200         MOVE  WS-VERFYD-DATE        TO  WS-PREVIOUS-VERFYD-DATE  09520085
095300     END-IF.                                                      09530085
095400                                                                  09540085
095500*-----------------------------------------------------------------09550085
095600* POPULATE EXTRACT RECORD FIELDS                                  09560085
095700*-----------------------------------------------------------------09570085
095800     MOVE RECEIV-OPER-UNT-ID         TO  RC035-OPER-UNT-ID.       09580085
095900     MOVE RECEIV-FCLTY-ID            TO  RC035-FCLTY-ID.          09590085
096000     MOVE RECEIV-ORD-NBR             TO  RC035-ORD-NBR.           09600085
096100     MOVE RECEIV-REC-SEQ-NBR         TO  RC035-REC-SEQ-NBR.       09610085
096200     MOVE RECEIV-STATUS-CDE          TO  RC035-STATUS-CDE.        09620085
096300     MOVE PURCHS-DEPT-NBR            TO  RC035-DEPT-NBR.          09630085
096400     INITIALIZE                          RC035-DMM-NMBR.          09640090
096500     INITIALIZE                          RC035-DMM-NAME.          09650090
096600     INITIALIZE                          RC035-BYR-NMBR.          09660090
096700     INITIALIZE                          RC035-BYR-NAME.          09670090
096800     MOVE PURCHS-PO-TYP-CDE          TO  RC035-PO-TYP-CDE.        09680085
096900     MOVE PURCHS-ENT-ID              TO  RC035-ENT-ID.            09690085
097000     INITIALIZE                          RC035-VEND-DESC.         09700090
097100     MOVE WS-ARRIVE-DATE             TO  RC035-ARRIVE-DTE.        09710085
097200     MOVE WS-DEPT-ARRIVE-PERIOD-NBR  TO  RC035-ARRIVE-PERIOD-NBR. 09720085
097300     MOVE WS-DEPT-ARRIVE-PERIOD-WEEK TO  RC035-ARRIVE-PERIOD-WEEK.09730085
097400     MOVE WS-DEPT-ARRIVE-FISCAL-WEEK TO  RC035-ARRIVE-FISCAL-WEEK.09740085
097500     MOVE WS-DEPT-ARRIVE-QTR-NBR     TO  RC035-ARRIVE-QTR-NBR.    09750085
097600     MOVE WS-VERFYD-DATE             TO  RC035-VRFYD-DTE.         09760085
097700     MOVE WS-DEPT-VERFYD-PERIOD-NBR  TO  RC035-VRFYD-PERIOD-NBR.  09770085
097800     MOVE WS-DEPT-VERFYD-PERIOD-WEEK TO  RC035-VRFYD-PERIOD-WEEK. 09780085
097900     MOVE WS-DEPT-VERFYD-QTR-NBR     TO  RC035-VRFYD-QTR-NBR.     09790085
098000     MOVE WS-DEPT-VERFYD-FISCAL-WEEK TO  RC035-VRFYD-FISCAL-WEEK. 09800085
098100     MOVE RECEIV-VRFD-USR-ID         TO  RC035-VRFYD-USR-ID.      09810085
098200     MOVE RECEIV-CURR-OPER-UNT-ID    TO  RC035-CURR-OPER-UNT-ID.  09820085
098300     MOVE RECEIV-CURR-FCLTY-ID       TO  RC035-CURR-FCLTY-ID.     09830085
098400     MOVE WS-EXPTED-ITEM-QTY         TO  RC035-EXPTED-ITM-QTY.    09840085
098500     MOVE WS-VERIFY-ITEM-QTY         TO  RC035-VERIFY-ITM-QTY.    09850086
098600     MOVE RECEIV-EXPTED-CART-CNT     TO  RC035-EXPTED-CTN-CNT.    09860085
098700     MOVE RECEIV-ACTL-CART-CNT       TO  RC035-ACTL-CTN-CNT.      09870085
098800                                                                  09880085
098900     WRITE EXTRACT-RECORD FROM RC035-RCVR-EXTRACT-RECORD.         09890085
099000                                                                  09900085
099100     ADD  1                          TO  WS-RECORDS-WRITTEN.      09910085
099200                                                                  09920085
099300     PERFORM 7100-FETCH-TRECEIV-CSR.                              09930085
099400                                                                  09940056
099500 3000-GET-RECEIPT-SUM.                                            09950070
099600     MOVE '3000-GET-RECEIPT-SUM    ' TO PV-ABEND-PARAGRAPH.       09960070
099700                                                                  09970070
099800*-----------------------------------------------------------------09980070
099900* FROM THE RECIEPT DISTRIBUTION TABLE(TRECDIS) GET THE SUM OF THE 09990070
100000* EXPECTED & VERIFIED QUANTITIES FOR ALL LINES OF A GIVEN RECEIVER10000070
100100*-----------------------------------------------------------------10010070
100200                                                                  10020070
100300     EXEC SQL                                                     10030070
100400          SELECT SUM(VERIFY_ITM_QTY),                             10040070
100500                 SUM(AP_VERIFY_ITM_QTY)                           10050070
100600          INTO   :WS-EXPTED-ITEM-QTY,                             10060070
100700                 :WS-VERIFY-ITEM-QTY                              10070087
100800          FROM   TRECDIS                                          10080070
100900          WHERE  ORD_NBR     = :RECEIV-ORD-NBR                    10090070
101000            AND  REC_SEQ_NBR = :RECEIV-REC-SEQ-NBR                10100070
101100     END-EXEC.                                                    10110070
101200                                                                  10120070
101300     EVALUATE TRUE                                                10130070
101400         WHEN SQLCODE = +0                                        10140070
101500             CONTINUE                                             10150070
101600         WHEN SQLCODE = -305                                      10160070
101700              MOVE ZEROES          TO WS-EXPTED-ITEM-QTY          10170070
101800              MOVE ZEROES          TO WS-VERIFY-ITEM-QTY          10180087
101900         WHEN OTHER                                               10190070
102000              MOVE '3000-GET-RECIEPT-SUM '                        10200070
102100                                   TO PV-ABEND-PARAGRAPH          10210070
102200              MOVE 'SELECT TRECDIS       '                        10220070
102300                                   TO PV-ABEND-OPERATION          10230070
102400              MOVE 'TRECDIS'       TO PV-ABEND-STRUCTURE-1        10240070
102500              MOVE RECEIV-ORD-NBR  TO PV-ABEND-STRUCTURE-2        10250070
102600              PERFORM 9900-DB2-ABEND                              10260070
102700     END-EVALUATE.                                                10270070
102800                                                                  10280070
102900                                                                  10290070
103000 4000-ARRIVE-DATE-PERIOD.                                         10300050
103100*-----------------------------------------------------------------10310012
103200* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             10320012
103300*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           10330012
103400* FROM ARRIVED DATE.                                              10340012
103500*-----------------------------------------------------------------10350012
103600     MOVE '4000-ARRIVE-DATE-PERIOD ' TO PV-ABEND-PARAGRAPH.       10360036
103700                                                                  10370012
103800     MOVE  WS-ARRIVE-MM                TO  WS-WORK-ARRIVE-MM.     10380012
103900     MOVE  WS-ARRIVE-DD                TO  WS-WORK-ARRIVE-DD.     10390012
104000     MOVE  WS-ARRIVE-CC                TO  WS-WORK-ARRIVE-CC.     10400012
104100     MOVE  WS-ARRIVE-YY                TO  WS-WORK-ARRIVE-YY.     10410012
104200                                                                  10420012
104300     MOVE  WS-ARRIVE-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   10430012
104400     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  10440012
104500     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  10450012
104600     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  10460012
104700                                                                  10470012
104800     PERFORM 9100-CALL-DATE-MODULE.                               10480012
104900                                                                  10490012
105000     IF DPG54-DATE-VALID                                          10500012
105100         MOVE DPG56-FISCAL-PERIOD-NBR                             10510012
105200              TO  WS-DEPT-ARRIVE-PERIOD-NBR                       10520012
105300         MOVE DPG56-FISCAL-PERIOD-WEEK                            10530012
105400              TO  WS-DEPT-ARRIVE-PERIOD-WEEK                      10540012
105500         MOVE DPG56-FISCAL-QTR-NBR                                10550012
105600              TO  WS-DEPT-ARRIVE-QTR-NBR                          10560012
105700         MOVE DPG56-FISCAL-WEEK-NBR                               10570012
105800              TO  WS-DEPT-ARRIVE-FISCAL-WEEK                      10580012
105900     END-IF.                                                      10590012
106000                                                                  10600012
106100 4100-VERFYD-DATE-PERIOD.                                         10610012
106200*-----------------------------------------------------------------10620012
106300* DETERMINE FISCAL-PERIOD-NUMBER, FISCAL-PERIOD-WEEK,             10630012
106400*           FISCAL-WEEK-NUMBER,   FISCAL-QUARTER-NUMBER           10640012
106500* FROM VERIFIED DATE.                                             10650012
106600*-----------------------------------------------------------------10660012
106700     MOVE '4100-VERFYD-DATE-PERIOD ' TO PV-ABEND-PARAGRAPH.       10670036
106800                                                                  10680012
106900     MOVE  WS-VERFYD-MM                TO  WS-WORK-VERFYD-MM.     10690012
107000     MOVE  WS-VERFYD-DD                TO  WS-WORK-VERFYD-DD.     10700012
107100     MOVE  WS-VERFYD-CC                TO  WS-WORK-VERFYD-CC.     10710012
107200     MOVE  WS-VERFYD-YY                TO  WS-WORK-VERFYD-YY.     10720012
107300                                                                  10730012
107400     MOVE  WS-VERFYD-DATE-WORK         TO  DPG52-LK-DATE-INPUT.   10740012
107500     SET  DPG51-FISCAL-454-CALENDAR    TO  TRUE.                  10750012
107600     SET  DPG51-DO-NOT-INCR-DECR-DATE  TO  TRUE.                  10760012
107700     SET  DPG52-LK-DTE-GREG-CC-FMT     TO  TRUE.                  10770012
107800                                                                  10780012
107900     PERFORM 9100-CALL-DATE-MODULE.                               10790012
108000                                                                  10800012
108100     IF DPG54-DATE-VALID                                          10810012
108200         MOVE DPG56-FISCAL-PERIOD-NBR                             10820012
108300              TO  WS-DEPT-VERFYD-PERIOD-NBR                       10830012
108400         MOVE DPG56-FISCAL-PERIOD-WEEK                            10840012
108500              TO  WS-DEPT-VERFYD-PERIOD-WEEK                      10850012
108600         MOVE DPG56-FISCAL-QTR-NBR                                10860012
108700              TO  WS-DEPT-VERFYD-QTR-NBR                          10870012
108800         MOVE DPG56-FISCAL-WEEK-NBR                               10880012
108900              TO  WS-DEPT-VERFYD-FISCAL-WEEK                      10890012
109000     END-IF.                                                      10900012
109100                                                                  10910012
109200/                                                                 10920010
109300 7000-OPEN-TRECEIV-CURSOR.                                        10930010
109400     MOVE '7000-OPEN-TRECEIV-CURSOR' TO PV-ABEND-PARAGRAPH.       10940036
109500                                                                  10950036
109600     PERFORM                                                      10960010
109700         WITH TEST AFTER                                          10970010
109800         VARYING PV-RETRY-COUNT                                   10980010
109900         FROM 1 BY 1                                              10990010
110000         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 11000010
110100            OR  (SQLCODE = +0))                                   11010010
110200                                                                  11020010
110300         EXEC SQL                                                 11030010
110400             OPEN TRECEIV-CSR                                     11040010
110500         END-EXEC                                                 11050010
110600                                                                  11060010
110700         EVALUATE TRUE                                            11070010
110800             WHEN SQLCODE = +0                                    11080010
110900             WHEN SQLCODE = -904                                  11090010
111000             WHEN SQLCODE = -913                                  11100010
111100                  CONTINUE                                        11110010
111200             WHEN SQLWARN0 NOT = SPACE                            11120010
111300             WHEN SQLCODE  NOT = +0                               11130010
111400                  MOVE '7000-OPEN-TRECEIV-CURSOR'                 11140010
111500                                 TO PV-ABEND-PARAGRAPH            11150010
111600                  MOVE 'OPEN TRECEIV CURSOR'                      11160010
111700                                 TO PV-ABEND-OPERATION            11170010
111800                  MOVE 'TRECIEV'   TO PV-ABEND-STRUCTURE-1        11180010
111900                  MOVE SPACES      TO PV-ABEND-STRUCTURE-2        11190010
112000                  PERFORM 9900-DB2-ABEND                          11200010
112100         END-EVALUATE                                             11210010
112200     END-PERFORM.                                                 11220010
112300                                                                  11230010
112400     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          11240010
112500         MOVE '7000-OPEN-TRECEIV-CURSOR'                          11250010
112600                                 TO PV-ABEND-PARAGRAPH            11260010
112700         MOVE 'MAX RETRIES EXCEEDED'                              11270010
112800                                 TO PV-ABEND-OPERATION            11280010
112900         PERFORM 9900-DB2-ABEND                                   11290010
113000     END-IF.                                                      11300010
113100                                                                  11310010
113200 7100-FETCH-TRECEIV-CSR.                                          11320010
113300     MOVE '7100-FETCH-TRECEIV-CSR  ' TO PV-ABEND-PARAGRAPH.       11330036
113400                                                                  11340010
113500     EXEC SQL                                                     11350010
113600          FETCH TRECEIV-CSR                                       11360010
113700           INTO  :RECEIV-ORD-NBR,                                 11370014
113800                 :RECEIV-REC-SEQ-NBR,                             11380014
113900                 :PURCHS-DEPT-NBR,                                11390014
114000                 :RECEIV-OPER-UNT-ID,                             11400014
114100                 :RECEIV-FCLTY-ID,                                11410014
114200                 :RECEIV-STATUS-CDE,                              11420014
114300                 :RECEIV-REC-TMST,                                11430014
114400                 :RECEIV-EXPTED-CART-CNT,                         11440014
114500                 :RECEIV-ACTL-CART-CNT,                           11450014
114600                 :RECEIV-VERFYD-TMST,                             11460014
114700                 :RECEIV-CURR-OPER-UNT-ID,                        11470014
114800                 :RECEIV-CURR-FCLTY-ID,                           11480014
114900                 :RECEIV-VRFD-USR-ID,                             11490014
115000                 :PURCHS-PO-TYP-CDE,                              11500014
115100                 :PURCHS-ENT-ID                                   11510014
115200     END-EXEC.                                                    11520011
115300                                                                  11530010
115400     MOVE '7100-FETCH-TRECEIV-CSR  ' TO PV-ABEND-PARAGRAPH.       11540055
115500                                                                  11550055
115600     EVALUATE TRUE                                                11560010
115700         WHEN SQLCODE = +0                                        11570010
115800              ADD +1 TO PV-TRECEIV-COUNT                          11580010
115900              ADD  1 TO WS-RECORDS-READ                           11590012
116000         WHEN SQLCODE = +100                                      11600010
116100              SET PS-EOF-TRECEIV-CSR TO TRUE                      11610010
116200         WHEN SQLWARN0 NOT = SPACE                                11620010
116300         WHEN SQLCODE  NOT = +0                                   11630010
116400              MOVE '7100-FETCH-TRECEIV-CSR'                       11640010
116500                                   TO PV-ABEND-PARAGRAPH          11650010
116600              MOVE 'FETCH TRECEIV CURSOR'                         11660010
116700                                   TO PV-ABEND-OPERATION          11670010
116800              MOVE 'TRECEIV'       TO PV-ABEND-STRUCTURE-1        11680010
116900              MOVE SPACES          TO PV-ABEND-STRUCTURE-2        11690010
117000              PERFORM 9900-DB2-ABEND                              11700010
117100     END-EVALUATE.                                                11710010
117200                                                                  11720010
117300 7200-CLOSE-TRECEIV-CSR.                                          11730010
117400     MOVE '7200-CLOSE-TRECEIV-CSR  ' TO PV-ABEND-PARAGRAPH.       11740036
117500                                                                  11750036
117600     PERFORM                                                      11760010
117700         WITH TEST AFTER                                          11770010
117800         VARYING PV-RETRY-COUNT                                   11780010
117900         FROM 1 BY 1                                              11790010
118000         UNTIL ((PV-RETRY-COUNT > PC-MAX-RETRIES)                 11800010
118100            OR  (SQLCODE = +0))                                   11810010
118200                                                                  11820010
118300            EXEC SQL                                              11830010
118400                CLOSE TRECEIV-CSR                                 11840010
118500            END-EXEC                                              11850010
118600                                                                  11860010
118700            EVALUATE TRUE                                         11870010
118800                WHEN SQLCODE = 0                                  11880010
118900                    CONTINUE                                      11890010
119000                WHEN SQLCODE = -911                               11900010
119100                WHEN SQLCODE = -904                               11910010
119200                    CONTINUE                                      11920010
119300                WHEN SQLCODE  NOT = +0                            11930010
119400                     MOVE '7200-CLOSE-TRECEIV-CSR'                11940010
119500                                  TO PV-ABEND-PARAGRAPH           11950010
119600                     MOVE 'CLOSE TRECEIV CURSOR'                  11960010
119700                                  TO PV-ABEND-OPERATION           11970010
119800                     MOVE 'TRECIEV'   TO PV-ABEND-STRUCTURE-1     11980010
119900                     MOVE SPACES      TO PV-ABEND-STRUCTURE-2     11990010
120000                     PERFORM 9900-DB2-ABEND                       12000010
120100            END-EVALUATE                                          12010010
120200                                                                  12020010
120300     END-PERFORM.                                                 12030010
120400                                                                  12040010
120500     IF  PV-RETRY-COUNT > PC-MAX-RETRIES                          12050010
120600         MOVE '7200-CLOSE-TRECEIV-CSR'                            12060010
120700                                 TO PV-ABEND-PARAGRAPH            12070010
120800         MOVE 'MAX RETRIES EXCEEDED'                              12080010
120900                                 TO PV-ABEND-OPERATION            12090010
121000         PERFORM 9900-DB2-ABEND                                   12100010
121100     END-IF.                                                      12110010
121200                                                                  12120010
121300                                                                  12130011
121400 9100-CALL-DATE-MODULE.                                           12140011
121500*    MOVE '9100-CALL-DATE-MODULE   ' TO PV-ABEND-PARAGRAPH.       12150099
121600                                                                  12160036
121700     CALL DP500-KOHLS-CALENDAR-ROUTINE                            12170095
121700                           USING DPG51 DPG52 DPG53                12171095
121800                                 DPG54 DPG55 DPG56.               12180011
121900     EVALUATE TRUE                                                12190011
122000         WHEN DPG54-SEVERE-ERROR                                  12200011
113700              DISPLAY 'ORDER NUMBER '  RECEIV-ORD-NBR             12201099
113800              DISPLAY 'REC SEQ NBR  '  RECEIV-REC-SEQ-NBR         12203099
                    DISPLAY 'INPUT DATE IS ' DPG52-LK-DATE-INPUT        12204099
122100              DISPLAY '** ABEND **'                               12210011
122200              DISPLAY '** PGM = RCKUT056'                         12220011
122300              DISPLAY PV-ABEND-PARAGRAPH                          12230020
122400              DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. ' 12240011
122500              DISPLAY '** ERROR MESSAGE = '                       12250011
122600                      DPG54-ERROR-MESSAGE                         12260011
122700              DISPLAY '** DPG51 = ' DPG51                         12270011
122800              DISPLAY '** DPG52 = ' DPG52                         12280011
122900              DISPLAY '** DPG53 = ' DPG53                         12290011
123000              DISPLAY '** DPG54 = ' DPG54                         12300011
123100              MOVE +4003 TO PV-ABEND-CODE                         12310011
123200              CALL 'ILBOABN0' USING PV-ABEND-CODE                 12320011
123300         WHEN OTHER                                               12330011
123400              CONTINUE                                            12340011
123500     END-EVALUATE.                                                12350011
123600                                                                  12360011
123700*                                                                 12370011
123800 9900-DB2-ABEND.                                                  12380010
123900                                                                  12390010
124000     MOVE SQLCODE TO PV-SQLCODE.                                  12400010
124100     DISPLAY '*** DB2 ERROR '.                                    12410010
124200     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       12420010
124300     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 12430010
124400     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               12440010
124500     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               12450010
124600     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       12460010
124700     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-2.       12470010
124800     DISPLAY '***           = ' PV-DB2-OPERATION-MESSAGE-3.       12480010
124900     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             12490010
125000                                                                  12500010
125100     IF PV-ABEND-STRUCTURE-2 > SPACES                             12510010
125200         DISPLAY '*** TABLE 2   = ' PV-ABEND-STRUCTURE-2          12520010
125300     END-IF.                                                      12530010
125400                                                                  12540010
125500                                                                  12550010
125600     COPY DPPD004.                                                12560099
125700                                                                  12570010
125800                                                                  12580010
125900     MOVE +4013                  TO PV-ABEND-CODE.                12590010
126000     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         12600010
