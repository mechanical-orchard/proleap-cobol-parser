000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.         XSKRP008.                                    00020000
000300 AUTHOR.             JIM LEIKNESS.                                00030000
000400 INSTALLATION.       KOHLS DEPARTMENT STORES.                     00040000
000500 DATE-WRITTEN.       12-22-2002.                                  00050000
000600 DATE-COMPILED.                                                   00060000
000700*                                                                 00070000
000800 ENVIRONMENT DIVISION.                                            00080000
000900                                                                  00090000
001000 CONFIGURATION SECTION.                                           00100000
001100                                                                  00110000
001200 SOURCE-COMPUTER.    IBM-3090.                                    00120000
001300 OBJECT-COMPUTER.    IBM-3090.                                    00130000
001400                                                                  00140000
001500 INPUT-OUTPUT SECTION.                                            00150000
001600                                                                  00160000
001700 FILE-CONTROL.                                                    00170000
001800                                                                  00180000
001900     SELECT XST-INPUT-FILE       ASSIGN TO INP01.                 00190000
002000     SELECT RMS-INPUT-FILE       ASSIGN TO INP02.                 00200000
002100     SELECT ERROR-REPORT         ASSIGN TO RPT01.                 00210000
002200                                                                  00220000
002300 DATA DIVISION.                                                   00230000
002400                                                                  00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  RMS-INPUT-FILE                                               00270000
002800     RECORDING MODE IS F                                          00280000
002900     BLOCK CONTAINS 0 RECORDS                                     00290000
003000     LABEL RECORDS ARE OMITTED.                                   00300000
003100 01  RMS-INPUT-RECORD                    PIC  X(35).              00310000
003200                                                                  00320000
003300 FD  XST-INPUT-FILE                                               00330000
003400     RECORDING MODE IS F                                          00340000
003500     BLOCK CONTAINS 0 RECORDS                                     00350000
003600     LABEL RECORDS ARE OMITTED.                                   00360000
003700 01  XST-INPUT-RECORD                    PIC  X(27).              00370000
003800                                                                  00380000
003900 FD  ERROR-REPORT                                                 00390000
004000     RECORDING MODE IS F                                          00400000
004100     BLOCK CONTAINS 0 RECORDS                                     00410000
004200     LABEL RECORDS ARE OMITTED.                                   00420000
004300 01  ERR-RPT-LINE                        PIC  X(200).             00430000
004400                                                                  00440000
004500 WORKING-STORAGE SECTION.                                         00450000
004600                                                                  00460000
004700     COPY HORD007.                                                00470000
004701                                                                  00480000
005300     COPY DPWS150O.                                               00490000
005301                                                                  00500000
005310 01 XST-REC.                                                      00510000
005320     05 XST-STR-NBR                 PIC S9(04) COMP.              00520000
005321     05 XST-STR-GP-TYP-CDE          PIC S9(04) COMP.              00530000
005330     05 XST-STR-GP-ID               PIC S9(04) COMP.              00531000
005340     05 XST-STR-EFF-BEG-DTE         PIC X(10) VALUE SPACE.        00532000
005341     05 XST-STR-EFF-END-DTE         PIC X(10) VALUE SPACE.        00533000
005342     05 FILLER                      PIC X(01) VALUE SPACE.        00534000
005350                                                                  00535000
005351 01 PC-PROGRAM-CONSTANTS.                                         00535100
005352     05 PC-PGM-NAME                 PIC X(08)  VALUE 'XSKRP008'.  00535200
005353                                                                  00535300
005360 01 PV-PROGRAM-VARIABLES.                                         00535400
005370     05 PV-XST-KEY.                                               00535500
005380        10 PV-XST-STR-NBR           PIC 9(04).                    00535600
005381        10 PV-XST-STR-GP-TYP-CDE    PIC 9(04).                    00535700
005382        10 PV-XST-STR-GP-ID         PIC 9(04).                    00535800
005383        10 PV-XST-STR-EFF-BEG-DTE   PIC X(10) VALUE SPACE.        00535900
005390     05 PV-XST-STR-EFF-END-DTE      PIC X(10) VALUE SPACE.        00536000
005400                                                                  00537000
005410     05 PV-RMS-KEY.                                               00538000
005420        10 PV-RMS-STR-NBR           PIC 9(04).                    00539000
005421        10 PV-RMS-STR-GP-TYP-CDE    PIC 9(04).                    00540000
005422        10 PV-RMS-STR-GP-ID         PIC 9(04).                    00541000
005423        10 PV-RMS-STR-EFF-BEG-DTE   PIC X(10) VALUE SPACE.        00542000
005430     05 PV-RMS-STR-EFF-END-DTE      PIC X(10) VALUE SPACE.        00543000
005433                                                                  00543100
005440     05 PV-PAGE-CNT                 PIC S9(05)  VALUE ZERO.       00543200
005450     05 PV-LINE-CNT                 PIC S9(04)  COMP VALUE ZERO.  00543300
005460     05 PV-MAX-LINES                PIC S9(04)  COMP VALUE +71.   00543400
005470                                                                  00543500
005480     05 PV-DISPLAY-CNT              PIC ZZZZ9.                    00543600
005492     05 PV-NBR-ERRORS               PIC S9(04)  COMP              00543700
005493                                                VALUE ZERO.       00543800
005494     05 PV-DATE-YYMMDD.                                           00543900
005495          10 PV-YYMMDD-YY           PIC X(02)  VALUE SPACE.       00544000
005496          10 PV-YYMMDD-MM           PIC X(02)  VALUE SPACE.       00545000
005497          10 PV-YYMMDD-DD           PIC X(02)  VALUE SPACE.       00546000
005498     05 PV-TIME-HHMMSS.                                           00547000
005499          10 PV-HHMMSS-HH           PIC X(02)  VALUE SPACE.       00548000
005500          10 PV-HHMMSS-MM           PIC X(02)  VALUE SPACE.       00549000
005501          10 PV-HHMMSS-SS           PIC X(02)  VALUE SPACE.       00550000
005502     05 PV-MESSAGE                  PIC X(50)  VALUE SPACE.       00550100
005510                                                                  00550200
005530 01 RPT-TOTAL-LINE.                                               00550300
005540     05 FILLER     PIC  X(23) VALUE                               00550400
005550                         'TOTAL NUMBER OF ERRORS '.               00550500
005560     05 RPT-NBR-ERRORS PIC ZZZZZZ9.                               00550600
005561                                                                  00550700
005562 01 RPT-END-OF-REPORT-LINE.                                       00550800
005563     05 FILLER     PIC  X(21) VALUE                               00550900
005564                            '*** END OF REPORT ***'.              00551000
005565 01 PA-PROGRAM-ACCUMULATORS.                                      00552000
005566     05 PA-ERROR-MESSAGES      PIC 9(13) VALUE ZERO.              00553000
005567     05 PA-XST-RECS-READ       PIC 9(13) VALUE ZERO.              00554000
005568     05 PA-RMS-RECS-READ       PIC 9(13) VALUE ZERO.              00555000
005569                                                                  00556000
005571 01 PS-PROGRAM-SWITCHES.                                          00557000
005572     05 PS-MORE-RMS-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           00557100
005573         88 PS-MORE-RMS-INPUT-RECS           VALUE 'Y'.           00557200
005574         88 PS-END-OF-RMS-INPUT-RECS         VALUE 'N'.           00557300
005575     05 PS-MORE-XST-INPUT-RECS-SW PIC X(01)  VALUE 'Y'.           00557400
005576         88 PS-MORE-XST-INPUT-RECS           VALUE 'Y'.           00557500
005577         88 PS-END-OF-XST-INPUT-RECS         VALUE 'N'.           00557600
005578     05 PS-RMS-OR-XST-ERR        PIC X(01)   VALUE '0'.           00557700
005579         88 PS-RMS-ERROR                     VALUE '1'.           00557800
005580         88 PS-XST-ERROR                     VALUE '2'.           00557900
005581         88 PS-DATA-ERROR                    VALUE '3'.           00558000
005582                                                                  00558100
005583 01 RPT-REPORT-HEADING.                                           00558200
005584     05 FILLER     PIC  X(52)    VALUE SPACES.                    00558300
005585     05 FILLER     PIC  X(47)    VALUE                            00558400
005586         'XS STORE GROUP MEMBERSHIP DATA INTEGRITY ERRORS'.       00558500
005587                                                                  00558600
005588 01 RPT-COL-HEADING-1.                                            00558700
005589     05 FILLER     PIC  X(01) VALUE SPACE.                        00558800
005590     05 FILLER     PIC  X(15) VALUE ALL '-'.                      00558900
005591     05 FILLER     PIC  X(03) VALUE 'KEY'.                        00559000
005592     05 FILLER     PIC  X(15) VALUE ALL '-'.                      00559100
005593                                                                  00559200
005594 01 RPT-COL-HEADING-2.                                            00559300
005595     05 FILLER     PIC  X(01) VALUE SPACE.                        00559400
005596     05 FILLER     PIC  X(07) VALUE 'STR_NBR'.                    00559500
005597     05 FILLER     PIC  X(01) VALUE SPACE.                        00559600
005598     05 FILLER     PIC  X(06) VALUE 'STR_GP'.                     00559700
005599     05 FILLER     PIC  X(02) VALUE SPACE.                        00559800
005600     05 FILLER     PIC  X(06) VALUE 'STR_GP'.                     00559900
005601     05 FILLER     PIC  X(03) VALUE SPACE.                        00560000
005602     05 FILLER     PIC  X(07) VALUE 'EFF_BEG'.                    00560100
005603     05 FILLER     PIC  X(10) VALUE SPACE.                        00560200
005604     05 FILLER     PIC  X(08) VALUE 'XSDOMAIN'.                   00560300
005605     05 FILLER     PIC  X(07) VALUE SPACE.                        00560400
005606     05 FILLER     PIC  X(16) VALUE 'SYSTEM OF RECORD'.           00560500
005607     05 FILLER     PIC  X(12) VALUE SPACE.                        00560600
005608     05 FILLER     PIC  X(07) VALUE 'MESSAGE'.                    00560700
005609                                                                  00560800
005610 01 RPT-COL-HEADING-3.                                            00560900
005611     05 FILLER     PIC  X(09) VALUE SPACE.                        00561000
005612     05 FILLER     PIC  X(07) VALUE 'TYP_CDE'.                    00561100
005613     05 FILLER     PIC  X(02) VALUE SPACE.                        00561200
005614     05 FILLER     PIC  X(03) VALUE '_ID'.                        00561300
005615     05 FILLER     PIC  X(06) VALUE SPACE.                        00561400
005616     05 FILLER     PIC  X(04) VALUE '_DTE'.                       00561500
005617     05 FILLER     PIC  X(11) VALUE SPACE.                        00561600
005618     05 FILLER     PIC  X(11) VALUE 'EFF_END_DTE'.                00561700
005619     05 FILLER     PIC  X(07) VALUE SPACE.                        00561800
005620     05 FILLER     PIC  X(11) VALUE 'EFF_END_DTE'.                00561900
005621                                                                  00562000
005622 01 RPT-COL-HEADING-4.                                            00562100
005623     05 FILLER     PIC  X(132) VALUE ALL '-'.                     00562200
005624                                                                  00562300
005625 01 DL-DETAIL-LINE.                                               00562400
005626     05 FILLER                PIC  X(01) VALUE SPACE.             00562500
005627     05 DL-STR-NBR            PIC  X(04) VALUE SPACE.             00562600
005628     05 FILLER                PIC  X(04) VALUE SPACE.             00562700
005629     05 DL-STR-GP-TYP-CDE     PIC  X(04) VALUE SPACE.             00562800
005630     05 FILLER                PIC  X(04) VALUE SPACE.             00562900
005631     05 DL-STR-GP-ID          PIC  X(04) VALUE SPACE.             00563000
005632     05 FILLER                PIC  X(04) VALUE SPACE.             00563100
005633     05 DL-STR-EFF-BEG-DTE    PIC  X(10) VALUE SPACE.             00563200
005634     05 FILLER                PIC  X(08) VALUE SPACE.             00563300
005635     05 DL-XST-EFF-END-DTE    PIC  X(10) VALUE SPACE.             00563400
005636     05 FILLER                PIC  X(08) VALUE SPACE.             00563500
005637     05 DL-RMS-EFF-END-DTE    PIC  X(10) VALUE SPACE.             00563600
005638     05 FILLER                PIC  X(08) VALUE SPACE.             00563700
005640     05 DL-MESSAGE            PIC  X(50) VALUE SPACE.             00563800
005641                                                                  00563900
005642 PROCEDURE DIVISION.                                              00564000
005643                                                                  00564100
005644 0000-MAIN-MODULE.                                                00564200
005650                                                                  00564300
005660       OPEN INPUT RMS-INPUT-FILE                                  00564400
005670                  XST-INPUT-FILE                                  00564500
005680            OUTPUT ERROR-REPORT.                                  00564600
005681                                                                  00564700
005690       PERFORM 1000-INITIALIZE.                                   00564800
005691       PERFORM 7000-READ-XST-INPUT-FILE.                          00564900
005692       PERFORM 7100-READ-RMS-INPUT-FILE.                          00565000
005693                                                                  00566000
005694       PERFORM 2000-PROCESS-RECS                                  00567000
005695          UNTIL (PS-END-OF-XST-INPUT-RECS                         00568000
005696            AND PS-END-OF-RMS-INPUT-RECS).                        00569000
005700                                                                  00570000
005710       PERFORM 8400-WRITE-TOTALS.                                 00571000
005720                                                                  00572000
005800       CLOSE RMS-INPUT-FILE                                       00573000
005900             XST-INPUT-FILE                                       00574000
006000             ERROR-REPORT.                                        00575000
006010                                                                  00576000
006100       DISPLAY '**** XSKRP008 STATISTICS ****'                    00577000
006200       DISPLAY 'TOTAL ERROR MESSAGES   : ' PA-ERROR-MESSAGES.     00578000
006300       DISPLAY 'TOTAL XST RECORDS READ : ' PA-XST-RECS-READ.      00579000
006400       DISPLAY 'TOTAL RMS RECORDS READ : ' PA-RMS-RECS-READ.      00580000
006500       DISPLAY ' '                                                00590000
006600                                                                  00600000
006700       STOP RUN.                                                  00610000
006710                                                                  00620000
006800 1000-INITIALIZE.                                                 00630000
006900                                                                  00640000
007000       ACCEPT PV-DATE-YYMMDD FROM DATE.                           00650000
007100       MOVE PV-YYMMDD-YY TO DP150O-RUN-YEAR.                      00660000
007200       MOVE PV-YYMMDD-MM TO DP150O-RUN-MONTH.                     00670000
007300       MOVE PV-YYMMDD-DD TO DP150O-RUN-DAY.                       00680000
007400                                                                  00690000
007500       ACCEPT PV-TIME-HHMMSS FROM TIME.                           00700000
007600       MOVE PV-HHMMSS-HH TO DP150O-RUN-HOUR.                      00710000
007700       MOVE PV-HHMMSS-MM TO DP150O-RUN-MINUTE.                    00720000
007800       MOVE PC-PGM-NAME TO DP150O-PROGRAM-NAME.                   00730000
007900       MOVE 1        TO DP150O-REPORT-NUMBER.                     00740000
008000                                                                  00750000
008100       PERFORM 8100-WRITE-STD-RPT-HEADING.                        00760000
008200       PERFORM 8200-WRITE-REPORT-HEADING.                         00770000
008300       PERFORM 8300-WRITE-COLUMN-HEADING.                         00780000
008400                                                                  00790000
008500 2000-PROCESS-RECS.                                               00800000
008501                                                                  00810000
008510       MOVE HO007-STR-NBR         TO  PV-RMS-STR-NBR.             00820000
008511       MOVE HO007-STR-GP-TYP-CDE  TO  PV-RMS-STR-GP-TYP-CDE.      00830000
008512       MOVE HO007-STR-GP-ID       TO  PV-RMS-STR-GP-ID.           00840000
008520       MOVE HO007-STR-EFF-BEG-DTE TO  PV-RMS-STR-EFF-BEG-DTE.     00850000
008521       MOVE HO007-STR-EFF-END-DTE TO  PV-RMS-STR-EFF-END-DTE.     00851000
008530                                                                  00852000
008540       MOVE XST-STR-NBR           TO  PV-XST-STR-NBR.             00853000
008541       MOVE XST-STR-GP-TYP-CDE    TO PV-XST-STR-GP-TYP-CDE.       00854000
008550       MOVE XST-STR-GP-ID         TO  PV-XST-STR-GP-ID.           00855000
008551       MOVE XST-STR-EFF-BEG-DTE TO PV-XST-STR-EFF-BEG-DTE.        00855100
008552       MOVE XST-STR-EFF-END-DTE TO PV-XST-STR-EFF-END-DTE.        00855200
008560                                                                  00855300
008561       IF PV-XST-STR-EFF-END-DTE NOT > ZEROES                     00855400
008562           MOVE SPACES TO PV-XST-STR-EFF-END-DTE                  00855500
008563       END-IF.                                                    00855600
008564                                                                  00855700
008570      IF PV-XST-KEY = PV-RMS-KEY                                  00855800
008572         PERFORM 3000-COMPARE-FIELDS                              00855900
008573         PERFORM 7000-READ-XST-INPUT-FILE                         00856000
008574         PERFORM 7100-READ-RMS-INPUT-FILE                         00857000
008575      ELSE                                                        00857100
008580         IF ((PV-RMS-KEY < PV-XST-KEY)                            00857200
008590             OR PS-END-OF-XST-INPUT-RECS) AND                     00857300
008591             PS-MORE-RMS-INPUT-RECS                               00857400
008592             MOVE '1' TO PS-RMS-OR-XST-ERR                        00857500
008593             MOVE 'KEY ON SYSTEM OF RECORD TABLES ONLY'           00857600
008594                TO PV-MESSAGE                                     00857700
008595             PERFORM 8000-WRITE-OUTPUT-REC                        00857800
008596             PERFORM 7100-READ-RMS-INPUT-FILE                     00857900
008597          ELSE                                                    00858000
008620             IF ((PV-RMS-KEY > PV-XST-KEY)                        00859000
008630                OR PS-END-OF-RMS-INPUT-RECS) AND                  00860000
008640                PS-MORE-XST-INPUT-RECS                            00861000
008650                MOVE '2' TO PS-RMS-OR-XST-ERR                     00862000
008660                MOVE 'KEY ON XS DOMAIN TABLES ONLY' TO PV-MESSAGE 00863000
008670                PERFORM 8000-WRITE-OUTPUT-REC                     00864000
008680                PERFORM 7000-READ-XST-INPUT-FILE                  00865000
008690             END-IF                                               00866000
008691          END-IF                                                  00867000
008692      END-IF.                                                     00868000
008693                                                                  00869000
008694 3000-COMPARE-FIELDS.                                             00869100
008695                                                                  00869200
008696      EVALUATE TRUE                                               00869300
008698         WHEN ((PV-RMS-STR-EFF-END-DTE NOT =                      00869400
008699                 PV-XST-STR-EFF-END-DTE)                          00869500
008720             AND NOT (PV-XST-STR-EFF-END-DTE = '9999-09-09'       00869600
008721             AND  PV-RMS-STR-EFF-END-DTE = SPACES ))              00869700
008726             MOVE '3' TO PS-RMS-OR-XST-ERR                        00869800
008727             MOVE 'EFFECTIVE END DATES DO NOT MATCH'              00869900
008728                       TO PV-MESSAGE                              00870000
008729             PERFORM 8000-WRITE-OUTPUT-REC                        00871000
008730      END-EVALUATE.                                               00872000
008731                                                                  00873000
008740 7000-READ-XST-INPUT-FILE.                                        00874000
008800                                                                  00875000
008900       INITIALIZE XST-REC.                                        00876000
009000                                                                  00877000
009100       READ XST-INPUT-FILE INTO XST-REC                           00878000
009200           AT END SET PS-END-OF-XST-INPUT-RECS TO TRUE.           00879000
009300                                                                  00880000
009400       ADD 1 TO PA-XST-RECS-READ.                                 00890000
009500                                                                  00900000
009600 7100-READ-RMS-INPUT-FILE.                                        00910000
009700                                                                  00920000
009800       INITIALIZE HO007-STR-GP-MBRSHP-DATA                        00930000
009900                                                                  00940000
010000       READ RMS-INPUT-FILE INTO HO007-STR-GP-MBRSHP-DATA          00950000
010100            AT END SET PS-END-OF-RMS-INPUT-RECS TO TRUE.          00960000
010200                                                                  00970000
010300       ADD 1 TO PA-RMS-RECS-READ.                                 00980000
010400                                                                  00990000
010500 8000-WRITE-OUTPUT-REC.                                           01000000
010620                                                                  01010000
010700       IF PS-RMS-ERROR                                            01020000
010800          MOVE SPACES TO DL-DETAIL-LINE                           01030000
010900          MOVE PV-RMS-STR-NBR          TO DL-STR-NBR              01040000
010901          MOVE PV-RMS-STR-GP-TYP-CDE   TO DL-STR-GP-TYP-CDE       01050000
010910          MOVE PV-RMS-STR-GP-ID        TO DL-STR-GP-ID            01060000
011000          MOVE PV-RMS-STR-EFF-BEG-DTE  TO DL-STR-EFF-BEG-DTE      01070000
011001          MOVE PV-RMS-STR-EFF-END-DTE  TO DL-RMS-EFF-END-DTE      01080000
011100          MOVE PV-MESSAGE TO DL-MESSAGE                           01090000
011200       ELSE                                                       01100000
011300          IF PS-XST-ERROR                                         01110000
011310             MOVE SPACES TO DL-DETAIL-LINE                        01120000
011311             MOVE PV-XST-STR-NBR TO DL-STR-NBR                    01130000
011320             MOVE PV-XST-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      01131000
011330             MOVE PV-XST-STR-GP-ID TO DL-STR-GP-ID                01132000
011340             MOVE PV-XST-STR-EFF-BEG-DTE TO DL-STR-EFF-BEG-DTE    01133000
011350             MOVE PV-XST-STR-EFF-END-DTE TO DL-XST-EFF-END-DTE    01134000
011600             MOVE PV-MESSAGE TO DL-MESSAGE                        01135000
011610          ELSE                                                    01136000
011611             MOVE SPACES TO DL-DETAIL-LINE                        01137000
011612             MOVE PV-RMS-STR-NBR TO DL-STR-NBR                    01138000
011613             MOVE PV-RMS-STR-GP-TYP-CDE TO DL-STR-GP-TYP-CDE      01139000
011614             MOVE PV-RMS-STR-GP-ID TO DL-STR-GP-ID                01140000
011615             MOVE PV-RMS-STR-EFF-BEG-DTE                          01150000
011616                                    TO DL-STR-EFF-BEG-DTE         01160000
011617             MOVE PV-XST-STR-EFF-END-DTE                          01161000
011618                                TO DL-XST-EFF-END-DTE             01161100
011619             MOVE PV-RMS-STR-EFF-END-DTE                          01161200
011620                                TO DL-RMS-EFF-END-DTE             01161300
011627             MOVE PV-MESSAGE TO DL-MESSAGE                        01161400
011630          END-IF                                                  01161500
011700       END-IF.                                                    01161600
011710                                                                  01161700
011800       IF PV-LINE-CNT > PV-MAX-LINES                              01161800
011810          PERFORM 8100-WRITE-STD-RPT-HEADING                      01161900
011820          PERFORM 8200-WRITE-REPORT-HEADING                       01162000
011830          PERFORM 8300-WRITE-COLUMN-HEADING                       01163000
011840       END-IF.                                                    01164000
011850                                                                  01165000
011900       WRITE ERR-RPT-LINE FROM DL-DETAIL-LINE                     01166000
012000             AFTER ADVANCING 1 LINE.                              01167000
012100       ADD +1 TO PV-LINE-CNT.                                     01168000
012200                                                                  01169000
012210       MOVE 4095 TO RETURN-CODE.                                  01170000
012300       ADD 1 TO PA-ERROR-MESSAGES.                                01180000
012400                                                                  01190000
012500 8100-WRITE-STD-RPT-HEADING.                                      01200000
012600                                                                  01210000
012610       INITIALIZE PV-LINE-CNT.                                    01220000
012700       ADD 1  TO PV-PAGE-CNT.                                     01230000
012800       MOVE PV-PAGE-CNT TO DP150O-PAGE-NUMBER.                    01240000
012900       WRITE ERR-RPT-LINE FROM DP150O-STANDRD-HEADER-150-COLS     01250000
013000             AFTER ADVANCING PAGE.                                01260000
013110       ADD +1 TO PV-LINE-CNT.                                     01270000
013200                                                                  01280000
013300 8200-WRITE-REPORT-HEADING.                                       01290000
013400                                                                  01300000
013500       WRITE ERR-RPT-LINE FROM RPT-REPORT-HEADING                 01310000
013600            AFTER ADVANCING 1 LINES.                              01320000
013700       ADD +1 TO PV-LINE-CNT.                                     01330000
013800                                                                  01340000
013900 8300-WRITE-COLUMN-HEADING.                                       01350000
013910                                                                  01360000
013920       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-1                  01370000
013930            AFTER ADVANCING 2 LINES.                              01380000
013940       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-2                  01390000
013950            AFTER ADVANCING 1 LINES.                              01391000
013960       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-3                  01392000
013970            AFTER ADVANCING 1 LINES.                              01393000
013971       WRITE ERR-RPT-LINE FROM RPT-COL-HEADING-4                  01394000
013972            AFTER ADVANCING 1 LINES.                              01395000
013980       ADD +5 TO PV-LINE-CNT.                                     01396000
014000                                                                  01397000
014100 8400-WRITE-TOTALS.                                               01398000
014101                                                                  01399000
014102       IF PV-LINE-CNT > PV-MAX-LINES                              01400000
014103          PERFORM 8100-WRITE-STD-RPT-HEADING                      01410000
014104          PERFORM 8200-WRITE-REPORT-HEADING                       01410100
014105          PERFORM 8300-WRITE-COLUMN-HEADING                       01410200
014106       END-IF.                                                    01410300
014107                                                                  01410400
014110      MOVE PA-ERROR-MESSAGES TO RPT-NBR-ERRORS                    01410500
014200      WRITE ERR-RPT-LINE FROM RPT-TOTAL-LINE                      01410600
014210            AFTER ADVANCING 2 LINES.                              01410700
014211      ADD +2 TO PV-LINE-CNT.                                      01410800
014212                                                                  01410900
014220      IF PV-LINE-CNT > PV-MAX-LINES                               01411000
014230         PERFORM 8100-WRITE-STD-RPT-HEADING                       01412000
014240         PERFORM 8200-WRITE-REPORT-HEADING                        01413000
014250         PERFORM 8300-WRITE-COLUMN-HEADING                        01414000
014260      END-IF.                                                     01415000
014300      WRITE ERR-RPT-LINE FROM RPT-END-OF-REPORT-LINE              01416000
014400            AFTER ADVANCING 1 LINES.                              01417000
014500                                                                  01418000
