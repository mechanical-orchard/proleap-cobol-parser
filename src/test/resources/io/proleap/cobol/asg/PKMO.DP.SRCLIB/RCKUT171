000100***************************************************************** 00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300***************************************************************** 00030000
000400                                                                  00040000
000500 PROGRAM-ID.             RCKUT171.                                00050000
000600 AUTHOR.                 RON KRIER.                               00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            APRIL 2021.                              00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100***************************************************************** 00110000
001200*  THIS PROGRAM WILL BE USED TO TAKE IN A FILE USING COPYBOOK   * 00120000
001300*  RCRD101 FROM PROGRAM RCKTU170 AND WILL BUILD THE OUTPUT      * 00130000
001400*  FILE USING COPYBOOK RCRD001 TO PASS ONTO THE RCKUP006        * 00140000
001500*  TO POPULATE DATA TO THE PACKSLIP AND INBOUND CARTON          * 00150000
001600*  DATABASES.                                                   * 00160000
001700*  THIS PROGRAM WAS PART OF THE SEPHORA PROJECT TO TAKE DATA    * 00170000
001800*  FROM SEPHORA IN PLACE OF ASN DATA TO BE ABLE TO CREATE       * 00180000
001900*  PACKSLIPS AND INBOUND CARTON DATA IF AVAILABLE.              * 00190000
002000***************************************************************** 00200000
002100                                                                  00210000
002200 ENVIRONMENT DIVISION.                                            00220000
002300                                                                  00230000
002400 CONFIGURATION SECTION.                                           00240000
002500                                                                  00250000
002600 SOURCE-COMPUTER.        IBM-3090.                                00260000
002700 OBJECT-COMPUTER.        IBM-3090.                                00270000
002800                                                                  00280000
002900 INPUT-OUTPUT SECTION.                                            00290000
003000                                                                  00300000
003100 FILE-CONTROL.                                                    00310000
003200                                                                  00320000
003300     SELECT SHIPPED-MDSE-INPUT-FILE                               00330000
003400         ASSIGN TO INP01.                                         00340000
003500                                                                  00350000
003600     SELECT PACKSLIP-CARTON-FILE                                  00360000
003700         ASSIGN TO OUT01.                                         00370000
003800                                                                  00380000
003810     SELECT SSCC-CARTON-FILE                                      00381000
003820         ASSIGN TO OUT02.                                         00382000
003830                                                                  00383000
003840******************************************************************00384000
003850 DATA DIVISION.                                                   00385000
003860******************************************************************00386000
003870                                                                  00387000
003880 FILE SECTION.                                                    00388000
003890                                                                  00389000
003900 FD  SHIPPED-MDSE-INPUT-FILE                                      00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS.                                    00420000
004300 01  SHIPPED-MDSE-INPUT-RECORD        PIC  X(150).                00430000
004400                                                                  00440000
004500 FD  PACKSLIP-CARTON-FILE                                         00450000
004600     RECORDING MODE IS F                                          00460000
004700     BLOCK CONTAINS 0  RECORDS.                                   00470000
004800 01  PACKSLIP-CARTON-RECORD           PIC  X(600).                00480000
004900                                                                  00490000
005000 FD  SSCC-CARTON-FILE                                             00500000
005100     RECORDING MODE IS F                                          00510000
005200     BLOCK CONTAINS 0  RECORDS.                                   00520000
005300 01  SSCC-CARTON-RECORD               PIC  X(75).                 00530000
005400                                                                  00540000
005500 WORKING-STORAGE SECTION.                                         00550000
005600                                                                  00560000
005700 01  FILLER                      PIC  X(46)    VALUE              00570000
005800     '** WORKING STORAGE FOR RCKUT171 STARTS HERE **'.            00580000
005900                                                                  00590000
006000 01  DATABASE-KEY-FIELDS.                                         00600000
006100     05  DK-PO-NUMBER                PIC  S9(9)  COMP.            00610000
006200     05  DK-PO-LINE-NUMBER           PIC  S9(9)  COMP.            00620000
006300     05  DK-DC-NUMBER                PIC  S9(4)  COMP.            00630000
006400     05  DK-UPC-NUMBER               PIC  S9(15) COMP-3.          00640000
006500     05  DK-SKU-NUMBER               PIC  S9(8)  COMP-3.          00650000
006600     05  DK-SSCC-NUMBER              PIC  S9(18) COMP-3.          00660000
006700                                                                  00670000
006800 01  PV-CSV-RECORD.                                               00680000
006900     05  PV-CSV-FIELDS               PIC  X(100)   VALUE SPACES.  00690000
007000                                                                  00700000
007100 01  PROGRAM-SWITCHES.                                            00710000
007200     05  END-OF-FILE-SW              PIC  X(01)    VALUE 'Y'.     00720000
007300         88  END-OF-FILE                           VALUE 'N'.     00730000
007400     05  PS-WRITE-ERROR-CSV-SW       PIC X(01)     VALUE 'N'.     00740000
007500         88  PS-WRITE-ERROR-CSV-NO                 VALUE 'N'.     00750000
007600         88  PS-WRITE-ERROR-CSV-YES                VALUE 'Y'.     00760000
007700     05  PS-ERROR-SW                 PIC X(01)     VALUE 'N'.     00770000
007800         88  PS-ERROR-NO                           VALUE 'N'.     00780000
007900         88  PS-ERROR-YES                          VALUE 'Y'.     00790000
008000     05  PS-NUMERIC-ERROR-SW         PIC X(01)     VALUE 'N'.     00800000
008100         88  PS-NUMERIC-ERROR-NO                   VALUE 'N'.     00810000
008200         88  PS-NUMERIC-ERROR-YES                  VALUE 'Y'.     00820000
008300     05  PS-PO-FOUND-SW              PIC X(01)     VALUE 'N'.     00830000
008400         88  PS-PO-NOT-FOUND                       VALUE 'N'.     00840000
008500         88  PS-SINGLE-PO-FOUND                    VALUE 'Y'.     00850000
008600         88  PS-MULT-PO-FOUND                      VALUE 'M'.     00860000
008700     05  PS-UPC-FOUND-SW             PIC X(01)     VALUE 'N'.     00870000
008800         88  PS-UPC-NOT-FOUND                      VALUE 'N'.     00880000
008900         88  PS-UPC-FOUND                          VALUE 'Y'.     00890000
009000     05  PS-PO-LINE-FOUND-SW         PIC X(01)     VALUE 'N'.     00900000
009100         88  PS-PO-LINE-NOT-FOUND                  VALUE 'N'.     00910000
009200         88  PS-PO-LINE-FOUND                      VALUE 'Y'.     00920000
009300     05  PS-SSCC-FOUND-SW            PIC X(01)     VALUE 'N'.     00930000
009400         88  PS-SSCC-NOT-FOUND                     VALUE 'N'.     00940000
009500         88  PS-SSCC-FOUND                         VALUE 'Y'.     00950000
009600     05  PS-DC-FOUND-SW              PIC X(01)     VALUE 'N'.     00960000
009700         88  PS-DC-NOT-FOUND                       VALUE 'N'.     00970000
009800         88  PS-DC-FOUND                           VALUE 'Y'.     00980000
009900     05  PS-SSCC-F10-NUMERIC-SW      PIC X(01)     VALUE 'N'.     00990000
010000         88  PS-SSCC-F10-NOT-NUMERIC               VALUE 'N'.     01000000
010100         88  PS-SSCC-F10-NUMERIC                   VALUE 'Y'.     01010000
010200     05  PS-SSCC-L10-NUMERIC-SW      PIC X(01)     VALUE 'N'.     01020000
010300         88  PS-SSCC-L10-NOT-NUMERIC               VALUE 'N'.     01030000
010400         88  PS-SSCC-L10-NUMERIC                   VALUE 'Y'.     01040000
010500                                                                  01050000
010600 01  PC-CONSTANTS.                                                01060000
010700     05  PC-MAX-RETRIES              PIC S9(04)    VALUE +3       01070000
010800                                                   COMP SYNC.     01080000
010900     05  PC-LINE-LIMIT               PIC S9(04)    VALUE +65.     01090000
011000     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          01100000
011100                                                   'RCKUT171'.    01110000
011200     05  PC-REPORT-NBR-1             PIC  9(01)    VALUE 1.       01120000
011300                                                                  01130000
011400     05  PC-COMMA                    PIC X(01)     VALUE ','.     01140000
011500     05  PC-PERIOD                   PIC X(01)     VALUE '.'.     01150000
011600     05  PC-D                        PIC X(01)     VALUE 'D'.     01160000
011700     05  PC-T                        PIC X(01)     VALUE 'T'.     01170000
011800     05  PC-FLNAME-LENGTH            PIC S9(03)    VALUE +30      01180000
011900                                                   COMP-3.        01190000
012000     05  PC-ASTERISK                 PIC  X(30)    VALUE          01200000
012100         '*****************************'.                         01210000
012200     05  PC-PROGRESSIVE-READ-LIMIT   PIC S9(9)     VALUE 1000     01220000
012210                                                   COMP-3.        01221000
012220                                                                  01222000
012230 01  PV-ACCUMULATOR-FIELDS.                                       01223000
012240     05  PV-RETRY-COUNT              PIC S9(04)  VALUE +0         01224000
012250                                                   COMP SYNC.     01225000
012260     05  PV-COMMA-COUNT              PIC S9(04)  VALUE +0         01226000
012270                                                   COMP SYNC.     01227000
012280     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     01228000
012290                                                   COMP-3.        01229000
012300     05  PV-LINE-CNT                 PIC S9(04)    VALUE ZERO     01230000
012400                                                   COMP SYNC.     01240000
012500     05  PV-LINE-SHIP-QTY            PIC  9(07)    VALUE ZERO.    01250000
012600     05  PV-PO-DC-CART-QTY           PIC  9(07)    VALUE ZERO.    01260000
012700     05  PV-KEY-SEQ-NBR              PIC  9(07)    VALUE ZERO.    01270000
012800     05  PV-HOLD-LINE-SEQ-NBR        PIC  9(07)    VALUE ZERO.    01280000
012900                                                                  01290000
013000 01  PV-HOLD-LINE-LEVEL-FIELDS.                                   01300000
013100     05  PV-HOLD-LL-DEPT-NBR.                                     01310000
013200         10  PV-HOLD-LL-DEPT-NBR-1   PIC  X(01)    VALUE SPACE.   01320000
013300         10  PV-HOLD-LL-DEPT-NBR-L3  PIC  X(03)    VALUE SPACE.   01330000
013400     05  PV-HOLD-LL-CLASS-NBR        PIC  X(02)    VALUE SPACE.   01340000
013500     05  PV-HOLD-LL-SKU-SEQ-NBR      PIC  X(03)    VALUE SPACE.   01350000
013600     05  PV-HOLD-LL-UPC-NBR          PIC S9(15)    COMP-3         01360000
013700                                                   VALUE ZEROS.   01370000
013800     05  PV-HOLD-LL-UPC-DESC         PIC  X(25)    VALUE SPACE.   01380000
013900     05  PV-HOLD-LL-VENDOR-STYLE     PIC  X(15)    VALUE SPACE.   01390000
014000     05  PV-HOLD-LL-SIZE             PIC  X(10)    VALUE SPACE.   01400000
014100     05  PV-HOLD-LL-COLOR            PIC  X(10)    VALUE SPACE.   01410000
014200     05  PV-HOLD-LL-UNIT-COST        PIC  S9(4)V9(3) COMP-3       01420000
014300                                                   VALUE ZEROS.   01430000
014400     05  PV-HOLD-LL-UNIT-RETAIL      PIC  S9(6)V9(2) COMP-3       01440000
014500                                                   VALUE ZEROS.   01450000
014600     05  PV-HOLD-LL-QTY-ORDERED      PIC  S9(9) COMP              01460000
014700                                                   VALUE ZEROS.   01470000
014800     05  PV-HOLD-LL-SKU-NBR          PIC  X(08)    VALUE SPACE.   01480000
014900                                                                  01490000
015000 01  PV-PREV-FIELDS.                                              01500000
015100     05  PV-PREV-FILE-NAME           PIC  X(20)    VALUE SPACE.   01510000
015200     05  PV-PREV-DC-NBR              PIC  9(04)    VALUE ZERO.    01520000
015300     05  PV-PREV-MDSE-SOURCE         PIC  X(03)    VALUE ZERO.    01530000
015400     05  PV-PREV-DELIVERY-SCAC       PIC  X(04)    VALUE ZERO.    01540000
015500     05  PV-PREV-ORD-NBR             PIC  9(08)    VALUE ZERO.    01550000
015600     05  PV-PREV-ORD-LNE-NBR         PIC  9(04)    VALUE ZERO.    01560000
015700     05  PV-PREV-SENT-SSCC-NBR       PIC  9(18)    VALUE ZERO.    01570000
015800     05  PV-CURR-SENT-SSCC-NBR       PIC  9(18)    VALUE ZERO.    01580000
015900     05  PV-PREV-KEY.                                             01590000
016000         10  PV-PREV-KEY-FILE-NAME   PIC  X(20)    VALUE SPACE.   01600000
016100         10  PV-PREV-KEY-DC-NBR      PIC  9(04)    VALUE ZERO.    01610000
016200         10  PV-PREV-KEY-MDSE-SOURCE PIC  X(03)    VALUE ZERO.    01620000
016300         10  PV-PREV-KEY-DLVRY-SCAC  PIC  X(04)    VALUE ZERO.    01630000
016400         10  PV-PREV-KEY-ORD-NBR     PIC  9(08)    VALUE ZERO.    01640000
016500         10  PV-PREV-KEY-ORD-LNE-NBR PIC  9(04)    VALUE ZERO.    01650000
016600     05  PV-CURR-KEY.                                             01660000
016610         10  PV-CURR-KEY-FILE-NAME   PIC  X(20)    VALUE SPACE.   01661000
016620         10  PV-CURR-KEY-DC-NBR      PIC  9(04)    VALUE ZERO.    01662000
016630         10  PV-CURR-KEY-MDSE-SOURCE PIC  X(03)    VALUE ZERO.    01663000
016640         10  PV-CURR-KEY-DLVRY-SCAC  PIC  X(04)    VALUE ZERO.    01664000
016650         10  PV-CURR-KEY-ORD-NBR     PIC  9(08)    VALUE ZERO.    01665000
016660         10  PV-CURR-KEY-ORD-LNE-NBR PIC  9(04)    VALUE ZERO.    01666000
016670                                                                  01667000
016680                                                                  01668000
016690 01  PV-TABLE-RELATED-FIELDS.                                     01669000
016700     05  PV-DETAIL-CARTON-LAYOUT.                                 01670000
016800         10  PV-CARTON-TABLE OCCURS 10 TIMES.                     01680000
016900             15  PV-CARTON-NBR           PIC S9(18)  COMP-3.      01690000
017000             15  PV-CARTON-QTY           PIC S9(09)  COMP-3.      01700000
017100             15  PV-CTN-UPC              PIC S9(15)  COMP-3.      01710000
017200             15  PV-CARTON-FIL           PIC  X(07).              01720000
017300     05  PV-TABLE-SUB                PIC S9(03)  COMP-3           01730000
017400                                                 VALUE ZERO.      01740000
017500                                                                  01750000
017600 01  PV-ABEND-FIELDS.                                             01760000
017700     05  PV-ABEND-CODE               PIC S9(04)  VALUE ZERO       01770000
017800                                                   COMP SYNC.     01780000
017900     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)  VALUE SPACES.    01790000
018000     05  PV-ABEND-PROGRAM             PIC X(8)   VALUE 'RCKUT171'.01800000
018100     05  PV-ABEND-PARAGRAPH           PIC X(50)  VALUE SPACES.    01810000
018200     05  PV-ABEND-OPERATION           PIC X(50)  VALUE SPACES.    01820000
018300     05  PV-ABEND-STRUCTURE-1         PIC X(8)   VALUE SPACES.    01830000
018400     05  PV-ABEND-STRUCTURE-2         PIC X(8)   VALUE SPACES.    01840000
018500     05  PV-ABEND-STRUCTURE-3         PIC X(8)   VALUE SPACES.    01850000
018600     05  PV-DB2-OPERATION-MESSAGE-1   PIC  X(79) VALUE SPACES.    01860000
018700     05  PV-SQLCODE                   PIC 9(9)   VALUE ZERO.      01870000
018800                                                                  01880000
018900 01  PV-MISC-FIELDS.                                              01890000
019000     05  PV-READ-COUNT               PIC  S9(9)     VALUE ZERO    01900000
019100                                                    COMP-3.       01910000
019200     05  PV-PROGRESSIVE-READ-COUNT   PIC  S9(9)     VALUE ZERO    01920000
019300                                                    COMP-3.       01930000
019400     05  PV-READ-TRLR-COUNT          PIC  S9(9)     VALUE ZERO    01940000
019500                                                    COMP-3.       01950000
019600     05  PV-READ-DETL-COUNT          PIC  S9(9)     VALUE ZERO    01960000
019700                                                    COMP-3.       01970000
019800     05  PV-READ-OTHR-COUNT          PIC  S9(9)     VALUE ZERO    01980000
019900                                                    COMP-3.       01990000
020000     05  PV-WRITE-HEADER-COUNT       PIC  S9(9)     VALUE ZERO    02000000
020100                                                    COMP-3.       02010000
020200     05  PV-WRITE-DETAIL-COUNT       PIC  S9(9)     VALUE ZERO    02020000
020300                                                    COMP-3.       02030000
020400     05  PV-WRITE-CARTON-COUNT       PIC  S9(9)     VALUE ZERO    02040000
020500                                                    COMP-3.       02050000
020600     05  PV-WRITE-TOTAL-COUNT        PIC  S9(9)     VALUE ZERO    02060000
020700                                                    COMP-3.       02070000
020800     05  PV-WRITE-SSCC-CARTON-COUNT  PIC  S9(9)     VALUE ZERO    02080000
020900                                                    COMP-3.       02090000
021000     05  PV-GOOD-WRITE-COUNT         PIC  S9(9)     VALUE ZERO    02100000
021100                                                    COMP-3.       02110000
021200     05  PV-ERROR-WRITE-COUNT        PIC  S9(9)     VALUE ZERO    02120000
021300                                                    COMP-3.       02130000
021400     05  PV-TOTAL-RECORD-QTY         PIC  S9(9)     VALUE ZERO    02140000
021500                                                    COMP-3.       02150000
021600     05  PV-PREV-RECORD-TYPE         PIC   X(1)     VALUE SPACE.  02160000
021700     05  PV-PRINT-RECORD             PIC X(200)    VALUE SPACES.  02170000
021800     05  PV-LINE-SPACING             PIC S9(04)    VALUE ZERO     02180000
021900                                                   COMP SYNC.     02190000
022000     05  PV-CURRENT-TMST-DB2         PIC X(26)     VALUE SPACE.   02200000
022100     05  PV-CURRENT-DATE-TIME.                                    02210000
022200         10  PV-CURRENT-DATE         PIC X(10)     VALUE SPACE.   02220000
022300         10  PV-CURRENT-FILLER1      PIC X(01)     VALUE SPACE.   02230000
022400         10  PV-CURRENT-TIME         PIC X(08)     VALUE SPACE.   02240000
022500         10  PV-CURRENT-FILLER2      PIC X(01)     VALUE SPACE.   02250000
022600         10  PV-CURRENT-NANO-SECOND  PIC X(06)     VALUE SPACE.   02260000
022700     05  PV-CURRENT-TMST.                                         02270000
022800         10  PV-CURR-DATE.                                        02280000
022900             15  PV-CURR-DATE-CC     PIC  9(02)    VALUE ZERO.    02290000
023000             15  PV-CURR-DATE-YY     PIC  9(02)    VALUE ZERO.    02300000
023100             15  PV-CURR-DASH1       PIC  X        VALUE SPACE.   02310000
023200             15  PV-CURR-DATE-MM     PIC  9(02)    VALUE ZERO.    02320000
023300             15  PV-CURR-DASH2       PIC  X        VALUE SPACE.   02330000
023400             15  PV-CURR-DATE-DD     PIC  9(02)    VALUE ZERO.    02340000
023500             15  PV-CURR-DASH3       PIC  X        VALUE SPACE.   02350000
023600         10  PV-CURR-TIME.                                        02360000
023700             15  PV-CURR-TIME-HH     PIC  9(02)    VALUE ZERO.    02370000
023800             15  PV-CURR-TIME-P1     PIC  X        VALUE SPACE.   02380000
023900             15  PV-CURR-TIME-MM     PIC  9(02)    VALUE ZERO.    02390000
024000             15  PV-CURR-TIME-P2     PIC  X        VALUE SPACE.   02400000
024100             15  PV-CURR-TIME-SS     PIC  9(02)    VALUE ZERO.    02410000
024200             15  FILLER              PIC  X(07)    VALUE SPACE.   02420000
024300                                                                  02430000
024400     05  PV-CURR-TMST-DB2-BOL        PIC X(26)     VALUE SPACE.   02440000
024500     05  PV-CURRENT-TMST-BOL.                                     02450000
024600         10  PV-CURR-BOL-DATE.                                    02460000
024700             15  PV-CURR-BOL-DATE-CC PIC  9(02)    VALUE ZERO.    02470000
024800             15  PV-CURR-BOL-DATE-YY PIC  9(02)    VALUE ZERO.    02480000
024900             15  PV-CURR-BOL-DASH1   PIC  X        VALUE SPACE.   02490000
025000             15  PV-CURR-BOL-DATE-MM PIC  9(02)    VALUE ZERO.    02500000
025100             15  PV-CURR-BOL-DASH2   PIC  X        VALUE SPACE.   02510000
025200             15  PV-CURR-BOL-DATE-DD PIC  9(02)    VALUE ZERO.    02520000
025300             15  PV-CURR-BOL-DASH3   PIC  X        VALUE SPACE.   02530000
025310         10  PV-CURR-BOL-TIME.                                    02531000
025311             15  PV-CURR-BOL-TIME-HH PIC  9(02)    VALUE ZERO.    02531100
025312             15  PV-CURR-BOL-TIME-P1 PIC  X        VALUE SPACE.   02531200
025313             15  PV-CURR-BOL-TIME-MM PIC  9(02)    VALUE ZERO.    02531300
025314             15  PV-CURR-BOL-TIME-P2 PIC  X        VALUE SPACE.   02531400
025315             15  PV-CURR-BOL-TIME-SS PIC  9(02)    VALUE ZERO.    02531500
025316             15  FILLER              PIC  X(07)    VALUE SPACE.   02531600
025317                                                                  02531700
025318     05  PV-CENTURY-DATE-MMDDCCYY.                                02531800
025319         10  PV-CENTURY-DATE-MM      PIC  9(02)    VALUE ZERO.    02531900
025320         10  PV-CENTURY-DATE-DD      PIC  9(02)    VALUE ZERO.    02532000
025330         10  PV-CENTURY-DATE-CCYY    PIC  9(04)    VALUE ZERO.    02533000
025340                                                                  02534000
025350     05  PV-NULL-IND                 PIC  S9(4)    VALUE ZERO     02535000
025360                                                   COMP SYNC.     02536000
025370     05  PV-DB2-COUNT                PIC  S9(9)    VALUE ZERO     02537000
025380                                                   COMP-3.        02538000
025390     05  PV-DISP-NBR-C               PIC  ZZ,ZZZ,ZZ9.             02539000
025400     05  PV-DISP-NBR-C2              PIC  ZZ,ZZZ,ZZ9.             02540000
025500     05  PV-DISP-NBR                 PIC  ZZZZZZZ9.               02550000
025600     05  PV-DISP-NBR-15              PIC  999999999999999.        02560000
025700     05  PV-DISP-NBR-10              PIC  9999999999.             02570000
025800     05  PV-DISP-NBR-8               PIC  99999999.               02580000
025900     05  PV-DISP-NBR-18              PIC  999999999999999999.     02590000
026000     05  PV-DISP-NBR-4               PIC  9999.                   02600000
026100                                                                  02610000
026200     05  PV-CURR-CCYY.                                            02620000
026300         10  PV-CURR-CC              PIC  X(02)    VALUE SPACE.   02630000
026400         10  PV-CURR-YY              PIC  X(02)    VALUE SPACE.   02640000
026500                                                                  02650000
026600     05  PV-HOLD-TIME-SS.                                         02660000
026700         10  PV-HOLD-TIME-S1         PIC  X(01)    VALUE SPACE.   02670000
026800         10  PV-HOLD-TIME-S2         PIC  X(01)    VALUE SPACE.   02680000
026900                                                                  02690000
027000     05  PV-SUB-CL-NBR-N              PIC 9(04).                  02700000
027100     05  PV-SUB-CL-NBR-A REDEFINES PV-SUB-CL-NBR-N.               02710000
027200         10  FILLER                   PIC X(01).                  02720000
027300         10  PV-SUB-CL-NBR-3CH.                                   02730000
027400             15  FILLER               PIC X(01).                  02740000
027500             15  PV-SUB-CL-NBR-2CH    PIC X(02).                  02750000
027600                                                                  02760000
027700     05  PV-SKU-NBR-N                 PIC 9(08).                  02770000
027800     05  PV-SKU-NBR-A    REDEFINES PV-SKU-NBR-N.                  02780000
027900         10  FILLER                   PIC X(05).                  02790000
028000         10  PV-SKU-NBR-3CH           PIC X(03).                  02800000
028100                                                                  02810000
028200     05  PV-BOL-DATE-TIME-N           PIC 9(11).                  02820000
028300     05  PV-BOL-DATE-TIME-A REDEFINES PV-BOL-DATE-TIME-N.         02830000
028400         10  PV-BOL-DATE-MM           PIC X(02).                  02840000
028500         10  PV-BOL-DATE-DD           PIC X(02).                  02850000
028600         10  PV-BOL-DATE-YY           PIC X(02).                  02860000
028700         10  PV-BOL-TIME-HH           PIC X(02).                  02870000
028800         10  PV-BOL-TIME-MM           PIC X(02).                  02880000
028900         10  PV-BOL-TIME-S            PIC X(01).                  02890000
029000                                                                  02900000
029010     05  PV-BOL-NBR.                                              02901000
029020         10  PV-BOL-PREFIX            PIC X(03)   VALUE 'SPH'.    02902000
029030         10  PV-BOL-DATE-TIME         PIC 9(11)   VALUE ZEROS.    02903000
029040         10  PV-BOL-DC-ABBR           PIC X(02)   VALUE SPACES.   02904000
029050                                                                  02905000
029060     10  PV-HOLD-BOL-DATE-TIME        PIC X(11)   VALUE SPACES.   02906000
029070                                                                  02907000
029080     05  PV-PRO-CSV-NBR.                                          02908000
029090         10  PV-PRO-CSV-PREFIX        PIC X(03)   VALUE 'SFP'.    02909000
029100         10  PV-PRO-CSV-DC-ABBR       PIC X(02)   VALUE SPACES.   02910000
029110         10  PV-PRO-CSV-PO-NBR        PIC X(10)   VALUE SPACES.   02911000
029111         10  FILLER                   PIC X(15)   VALUE SPACES.   02911100
029112                                                                  02911200
029113     05  PV-PRO-SKUSRT-NBR.                                       02911300
029114         10  PV-PRO-SKUSRT-PREFIX     PIC X(07)   VALUE 'SKUSORT'.02911400
029115         10  PV-PRO-SKUSRT-DC-ABBR    PIC X(02)   VALUE SPACES.   02911500
029116         10  FILLER                   PIC X(21)   VALUE SPACES.   02911600
029120                                                                  02912000
029130******************************************************************02913000
029140*  COPYBOOKS.                                                     02914000
029150******************************************************************02915000
029160                                                                  02916000
029170*----------------------------------------------------------------*02917000
029180*    NUMERIC EDIT ROUTINE LAYOUT                                  02918000
029190*----------------------------------------------------------------*02919000
029200     COPY DPWS010I.                                               02920000
029300                                                                  02930000
029400*----------------------------------------------------------------*02940000
029500*    FORMAT NAME ROUTINE LAYOUT                                   02950000
029600*----------------------------------------------------------------*02960000
029700     COPY DPWS024.                                                02970000
029800                                                                  02980000
029900*----------------------------------------------------------------*02990000
030000*    SHIPPED MERCHANDISE INPUT FILE LAYOUT                        03000000
030100*----------------------------------------------------------------*03010000
030200     COPY RCRD101.                                                03020000
030300                                                                  03030000
030400*----------------------------------------------------------------*03040000
030500*    CARTON FILE LAYOUT                                           03050000
030600*----------------------------------------------------------------*03060000
030700     COPY RCRD102.                                                03070000
030800                                                                  03080000
030900*----------------------------------------------------------------*03090000
031000*    PACKSLIP INBOUND CARTON OUTPUT FILE LAYOUT                   03100000
031100*----------------------------------------------------------------*03110000
031200     COPY RCRD001.                                                03120000
031300                                                                  03130000
031400***************************************************************** 03140000
031500*  *** DB2 MESSAGE AREAS ****                                   * 03150000
031600***************************************************************** 03160000
031700     COPY DPWS004.                                                03170000
031800                                                                  03180000
031900*---------------------------------------------------------------* 03190000
032000*    DB2 AREA FOR TPURCHS - PURCHASE ORDER HEADER TABLE         * 03200000
032100*---------------------------------------------------------------* 03210000
032200     EXEC SQL                                                     03220000
032300          INCLUDE TPURCHS                                         03230000
032400     END-EXEC.                                                    03240000
032500                                                                  03250000
032600*---------------------------------------------------------------* 03260000
032700*    DB2 AREA FOR TPLNSHP - PO PLAN SHIP TABLE                  * 03270000
032800*---------------------------------------------------------------* 03280000
032900     EXEC SQL                                                     03290000
033000          INCLUDE TPLNSHP                                         03300000
033100     END-EXEC.                                                    03310000
033200                                                                  03320000
033300*---------------------------------------------------------------* 03330000
033400*    DB2 AREA FOR TPURITM - PURCHASE ORDER ITEM TABLE           * 03340000
033500*---------------------------------------------------------------* 03350000
033600     EXEC SQL                                                     03360000
033700          INCLUDE TPURITM                                         03370000
033800     END-EXEC.                                                    03380000
033900                                                                  03390000
034000*---------------------------------------------------------------* 03400000
034100*    DB2 AREA FOR XLT_SKU - LOGISTICS DOMAIN SKU TABLE          * 03410000
034200*---------------------------------------------------------------* 03420000
034300     EXEC SQL                                                     03430000
034400          INCLUDE XLT00003                                        03440000
034500     END-EXEC.                                                    03450000
034600                                                                  03460000
034700*---------------------------------------------------------------* 03470000
034800*    DB2 AREA FOR XLT_VND_STYL - LOGISTICS DOMAIN STYLE TABLE   * 03480000
034900*---------------------------------------------------------------* 03490000
035000     EXEC SQL                                                     03500000
035100          INCLUDE XLT00004                                        03510000
035200     END-EXEC.                                                    03520000
035300                                                                  03530000
035400*---------------------------------------------------------------* 03540000
035500*    DB2 AREA FOR TMDSEAR - MERCHANDISE INFO TABLE              * 03550000
035600*---------------------------------------------------------------* 03560000
035700     EXEC SQL                                                     03570000
035800          INCLUDE TMDSEAR                                         03580000
035900     END-EXEC.                                                    03590000
036000                                                                  03600000
036100*---------------------------------------------------------------* 03610000
036200*    DB2 AREA FOR TRSPBAR - BUYER/ANALYST NAME TABLE            * 03620000
036300*---------------------------------------------------------------* 03630000
036400     EXEC SQL                                                     03640000
036500          INCLUDE TRSPBAR                                         03650000
036600     END-EXEC.                                                    03660000
036700                                                                  03670000
036800*---------------------------------------------------------------* 03680000
036900*    DB2 AREA FOR TEXNENT - EXTERNAL ENTITY TABLE               * 03690000
037000*---------------------------------------------------------------* 03700000
037100     EXEC SQL                                                     03710000
037200          INCLUDE TEXTENT                                         03720000
037300     END-EXEC.                                                    03730000
037400                                                                  03740000
037500*---------------------------------------------------------------* 03750000
037600*    DB2 AREA FOR TENTNME - EXTERNAL ENTITY NAME TABLE          * 03760000
037700*---------------------------------------------------------------* 03770000
037800     EXEC SQL                                                     03780000
037900          INCLUDE TENTNME                                         03790000
038000     END-EXEC.                                                    03800000
038100                                                                  03810000
038200*---------------------------------------------------------------* 03820000
038300*    DB2 AREA FOR COMMUNICATIONS                                * 03830000
038400*---------------------------------------------------------------* 03840000
038500     EXEC SQL                                                     03850000
038600          INCLUDE SQLCA                                           03860000
038700     END-EXEC.                                                    03870000
038800                                                                  03880000
038900***************************************************************** 03890000
039000                                                                  03900000
039100 LINKAGE SECTION.                                                 03910000
039200                                                                  03920000
039300***************************************************************** 03930000
039400 PROCEDURE DIVISION.                                              03940000
039500***************************************************************** 03950000
039600                                                                  03960000
039700 0000-MAINLINE-PROCESSING.                                        03970000
039800                                                                  03980000
039900     DISPLAY 'START OF PROGRAM RCKUT171'.                         03990000
040000                                                                  04000000
040100     MOVE PC-PROGRESSIVE-READ-LIMIT TO PV-DISP-NBR.               04010000
040200     DISPLAY 'PROGRESSIVE READ DISPLAY TRIGGER IS:  '             04020000
040300             PV-DISP-NBR.                                         04030000
040400                                                                  04040000
040500     PERFORM 1000-INITIALIZATION.                                 04050000
040600                                                                  04060000
040700     PERFORM 2000-PROCESS-INPUT-FILE                              04070000
040800       UNTIL END-OF-FILE.                                         04080000
040900                                                                  04090000
041000     IF  PV-READ-COUNT = 0                                        04100000
041100         DISPLAY ' '                                              04110000
041200         DISPLAY '*** EMPTY INPUT FILE ***'                       04120000
041300         DISPLAY ' '                                              04130000
041400     ELSE                                                         04140000
041500         IF  PV-TABLE-SUB > 0                                     04150000
041600             PERFORM 8400-WRITE-CARTON-RECORD                     04160000
041700             PERFORM 8200-WRITE-DETAIL-RECORD                     04170000
041800         ELSE                                                     04180000
041900             PERFORM 8200-WRITE-DETAIL-RECORD                     04190000
042000         END-IF                                                   04200000
042100     END-IF.                                                      04210000
042200                                                                  04220000
042300     PERFORM 8800-SHOW-COUNTERS.                                  04230000
042400                                                                  04240000
042500     CLOSE SHIPPED-MDSE-INPUT-FILE                                04250000
042600           PACKSLIP-CARTON-FILE                                   04260000
042700           SSCC-CARTON-FILE.                                      04270000
042800                                                                  04280000
042900     STOP RUN.                                                    04290000
043000                                                                  04300000
043100                                                                  04310000
043200******************************************************************04320000
043300*  OPEN FILES AND READ THE FIRST INPUT RECORD                    *04330000
043400******************************************************************04340000
043500 1000-INITIALIZATION.                                             04350000
043600                                                                  04360000
043700     OPEN INPUT  SHIPPED-MDSE-INPUT-FILE                          04370000
043800     OPEN OUTPUT PACKSLIP-CARTON-FILE.                            04380000
043900     OPEN OUTPUT SSCC-CARTON-FILE.                                04390000
044000                                                                  04400000
044100     INITIALIZE PV-DETAIL-CARTON-LAYOUT.                          04410000
044200     MOVE ZERO TO PV-TABLE-SUB.                                   04420000
044300                                                                  04430000
044400** GET CURRENT TIMESTAMP                                          04440000
044500                                                                  04450000
044600     EXEC SQL                                                     04460000
044700         SET :PV-CURRENT-TMST-DB2 = CURRENT TIMESTAMP             04470000
044800     END-EXEC.                                                    04480000
044900                                                                  04490000
045000     EVALUATE TRUE                                                04500000
045100         WHEN SQLCODE = ZERO                                      04510000
045200             MOVE PV-CURRENT-TMST-DB2    TO PV-CURRENT-TMST       04520000
045300                                            PV-CURRENT-DATE-TIME  04530000
045400                                            PV-CURRENT-TMST-BOL   04540000
045500         WHEN OTHER                                               04550000
045600             MOVE '1000-INITIALIZATION'  TO PV-ABEND-PARAGRAPH    04560000
045700             MOVE 'SET CURRENT TIMESTAMP'                         04570000
045800                                         TO PV-ABEND-OPERATION    04580000
045900             PERFORM 9900-DB2-ABEND                               04590000
046000         END-EVALUATE.                                            04600000
046100                                                                  04610000
046200     MOVE PV-CURR-BOL-DATE-YY      TO PV-BOL-DATE-YY.             04620000
046300     MOVE PV-CURR-BOL-DATE-MM      TO PV-BOL-DATE-MM.             04630000
046400     MOVE PV-CURR-BOL-DATE-DD      TO PV-BOL-DATE-DD.             04640000
046500     MOVE PV-CURR-BOL-TIME-HH      TO PV-BOL-TIME-HH.             04650000
046600     MOVE PV-CURR-BOL-TIME-MM      TO PV-BOL-TIME-MM.             04660000
046700     MOVE PV-CURR-BOL-TIME-SS      TO PV-HOLD-TIME-SS.            04670000
046800     MOVE PV-HOLD-TIME-S1          TO PV-BOL-TIME-S.              04680000
046810     MOVE PV-BOL-DATE-TIME-N       TO PV-BOL-DATE-TIME.           04681000
046820     ADD  -1                       TO PV-BOL-DATE-TIME.           04682000
046830                                                                  04683000
046840     PERFORM 7000-READ-INPUT.                                     04684000
046850                                                                  04685000
046860                                                                  04686000
046870******************************************************************04687000
046880* THIS PARAGRAPH WILL MANAGE THE PROCESSING OF EACH INPUT RECORD.*04688000
046890* THE OUTPUT RECORD TO BE CREATED WILL CONSIST OF A HEADER       *04689000
046900* RECORD FOR EACH DC/PO, A DETAIL RECORD FOR EACH ITEM WITHIN THE*04690000
047000* DC/PO AND THEN ZERO TO MANY CARTON LEVEL RECORDS DEPENDING ON  *04700000
047100* THE CARTON DATA FROM THE INPUT FILE.  THIS PARAGRAPH WILL HELP *04710000
047200* MANAGE THE CREATION OF THE DIFFERENT RECORD TYPES.             *04720000
047300******************************************************************04730000
047400 2000-PROCESS-INPUT-FILE.                                         04740000
047500                                                                  04750000
047600     IF  PV-CURR-KEY = PV-PREV-KEY                                04760000
047700         PERFORM 3000-PROCESS-SSCC-RECORD                         04770000
047800     ELSE                                                         04780000
047900         PERFORM 3200-PROCESS-KEY-CHANGE                          04790000
048000         MOVE PV-CURR-KEY TO PV-PREV-KEY                          04800000
048100         PERFORM 3000-PROCESS-SSCC-RECORD                         04810000
048200     END-IF.                                                      04820000
048300                                                                  04830000
048400     PERFORM 7000-READ-INPUT.                                     04840000
048500                                                                  04850000
048600******************************************************************04860000
048700* THIS PARAGRAPH WILL PROCESS THE CARTON LEVEL DATA BASED ON THE *04870000
048800* INPUT RECORD.  THE FIRST WRITE WILL BE A WRITE TO OUT02 FOR    *04880000
048900* EACH CARTON PROCESSED.  THE SECOND WRITE WILL BE THE CARTON    *04890000
049000* LEVEL RECORD FOR RCRD001 AND THAT WILL BE WRITTEN VIA THIS     *04900000
049100* PARAGRAPH ONLY IF THE TENTH ENTRY IS WRITTEN TO THE INTERNAL   *04910000
049110* CARTON TABLE WITHIN THE CARTON RECORD.                         *04911000
049120******************************************************************04912000
049130 3000-PROCESS-SSCC-RECORD.                                        04913000
049140                                                                  04914000
049150     MOVE RC101-SENT-SSCC-NBR     TO RC102-SSCC-NBR.              04915000
049160     MOVE RC101-KOHLS-ORD-NBR     TO RC102-KOHLS-ORD-NBR.         04916000
049170     MOVE RC101-DC-NBR            TO RC102-DC-NBR.                04917000
049180     MOVE PV-BOL-NBR              TO RC102-BOL-NBR.               04918000
049190     PERFORM 8600-WRITE-SSCC-CARTON-RECORD.                       04919000
049200                                                                  04920000
049300     IF  RC101-SSCC-NOT-EXISTS                                    04930000
049400         ADD +1 TO PV-TABLE-SUB                                   04940000
049500         MOVE RC101-SENT-SSCC-NBR TO PV-CARTON-NBR (PV-TABLE-SUB) 04950000
049600         MOVE RC101-SHIP-QTY      TO PV-CARTON-QTY (PV-TABLE-SUB) 04960000
049700         MOVE RC101-UPC-NBR       TO PV-CTN-UPC    (PV-TABLE-SUB) 04970000
049800         MOVE SPACES              TO PV-CARTON-FIL (PV-TABLE-SUB) 04980000
049900         ADD  RC101-SHIP-QTY      TO PV-LINE-SHIP-QTY             04990000
050000         IF  PV-TABLE-SUB = 10                                    05000000
050100             PERFORM 8400-WRITE-CARTON-RECORD                     05010000
050200             ADD 1 TO PV-KEY-SEQ-NBR                              05020000
050300             INITIALIZE PV-DETAIL-CARTON-LAYOUT                   05030000
050400             MOVE ZERO TO PV-TABLE-SUB                            05040000
050500         END-IF                                                   05050000
050600     ELSE                                                         05060000
050700         ADD  RC101-SHIP-QTY      TO PV-LINE-SHIP-QTY             05070000
050800     END-IF.                                                      05080000
050900                                                                  05090000
051000                                                                  05100000
051100******************************************************************05110000
051200* THIS PARAGRAPH WILL EXECUTE THE NEEDED PROCESSING WHEN THERE IS*05120000
051300* A CHANGE IN THE KEY FIELDS.  THE PARAGRAPH WILL MANAGE THE     *05130000
051310* WRITE OF THE CARTON RECORD (IF NEEDED), THE DETAIL RECORD AND  *05131000
051320* IF NEEDED, THE HEADER RECORD FOR THE RCRD001 OUTPUT FILE.      *05132000
051330******************************************************************05133000
051340 3200-PROCESS-KEY-CHANGE.                                         05134000
051350                                                                  05135000
051360     IF  PV-READ-COUNT = 1                                        05136000
051370         NEXT SENTENCE                                            05137000
051380     ELSE                                                         05138000
051390         IF  PV-TABLE-SUB > 0                                     05139000
051400             PERFORM 8400-WRITE-CARTON-RECORD                     05140000
051500             INITIALIZE PV-DETAIL-CARTON-LAYOUT                   05150000
051600             MOVE ZERO TO PV-TABLE-SUB                            05160000
051700             PERFORM 8200-WRITE-DETAIL-RECORD                     05170000
051800             MOVE ZERO TO PV-LINE-SHIP-QTY                        05180000
051900         ELSE                                                     05190000
052000             PERFORM 8200-WRITE-DETAIL-RECORD                     05200000
052100             MOVE ZERO TO PV-LINE-SHIP-QTY                        05210000
052200         END-IF                                                   05220000
052300     END-IF.                                                      05230000
052400                                                                  05240000
052500     IF  PV-CURR-KEY-FILE-NAME   = PV-PREV-KEY-FILE-NAME          05250000
052600     AND PV-CURR-KEY-DC-NBR      = PV-PREV-KEY-DC-NBR             05260000
052700     AND PV-CURR-KEY-MDSE-SOURCE = PV-PREV-KEY-MDSE-SOURCE        05270000
052800     AND PV-CURR-KEY-DLVRY-SCAC  = PV-PREV-KEY-DLVRY-SCAC         05280000
052900     AND PV-CURR-KEY-ORD-NBR     = PV-PREV-KEY-ORD-NBR            05290000
053000         PERFORM 4600-GET-ITEM-DATA                               05300000
053100         ADD 1 TO PV-KEY-SEQ-NBR                                  05310000
053200         MOVE PV-KEY-SEQ-NBR TO PV-HOLD-LINE-SEQ-NBR              05320000
053300         ADD 1 TO PV-KEY-SEQ-NBR                                  05330000
053400         MOVE PV-CURR-KEY TO PV-PREV-KEY                          05340000
053500     ELSE                                                         05350000
053600         IF  PV-CURR-KEY-FILE-NAME   = PV-PREV-KEY-FILE-NAME      05360000
053700         AND PV-CURR-KEY-DC-NBR      = PV-PREV-KEY-DC-NBR         05370000
053800         AND PV-CURR-KEY-MDSE-SOURCE = PV-PREV-KEY-MDSE-SOURCE    05380000
053810         AND PV-CURR-KEY-DLVRY-SCAC  = PV-PREV-KEY-DLVRY-SCAC     05381000
053820             CONTINUE                                             05382000
053830         ELSE                                                     05383000
053840             PERFORM 3500-FORMAT-BOL                              05384000
053850         END-IF                                                   05385000
053860         PERFORM 3400-GET-NEW-KEY-DATA                            05386000
053870         PERFORM 8000-WRITE-HEADER-RECORD                         05387000
053880         MOVE PV-CURR-KEY TO PV-PREV-KEY                          05388000
053890         MOVE 1    TO PV-KEY-SEQ-NBR                              05389000
053900         MOVE PV-KEY-SEQ-NBR TO PV-HOLD-LINE-SEQ-NBR              05390000
054000         ADD 1 TO PV-KEY-SEQ-NBR                                  05400000
054100     END-IF.                                                      05410000
054200                                                                  05420000
054300                                                                  05430000
054400******************************************************************05440000
054500* THIS PARAGRAPH WILL CONTROL THE RETRIEVAL OF PO AND ITEM DATA  *05450000
054600* WHERE THERE IS A CHANGE IN ORDER NUMBER INFORMATION.           *05460000
054700******************************************************************05470000
054800 3400-GET-NEW-KEY-DATA.                                           05480000
054900                                                                  05490000
055000     IF  PV-PREV-KEY-ORD-NBR = PV-CURR-KEY-ORD-NBR                05500000
055100         NEXT SENTENCE                                            05510000
055200     ELSE                                                         05520000
055300         PERFORM 3600-GET-PO-DATA                                 05530000
055400         PERFORM 4600-GET-ITEM-DATA                               05540000
055500     END-IF.                                                      05550000
055600                                                                  05560000
055700                                                                  05570000
055800******************************************************************05580000
055900* THIS PARAGRAPH WILL SET A COUPLE OF FIELDS IN THE FORMATTED    *05590000
055901* BOL NUMBER WHICH WILL BE PUT INTO THE RCRD001 RECORDS.  THESE  *05590100
055902* FIELDS WILL HELP ENSURE THAT A UNIQUE BOL NUMBER IS GENERATED  *05590200
055903* FOR THE DATA BEING WRITTEN TO THE RCRD001 OUTPUT FILE.         *05590300
055904******************************************************************05590400
055905 3500-FORMAT-BOL.                                                 05590500
055906                                                                  05590600
055907     IF  RC101-FILE-SOURCE-SKU-SORT                               05590700
055908         MOVE 'SSK'                TO PV-BOL-PREFIX               05590800
055909     ELSE                                                         05590900
055910         MOVE 'SPH'                TO PV-BOL-PREFIX               05591000
055920     END-IF.                                                      05592000
055921                                                                  05592100
055922     MOVE RC101-DC-ABBR            TO PV-BOL-DC-ABBR.             05592200
055923     ADD  +1                       TO PV-BOL-DATE-TIME.           05592300
055924                                                                  05592400
055925                                                                  05592500
055926******************************************************************05592600
055927* THIS PARAGRAPH WILL CONTROL THE RETRIEVAL OF DATA FOR A NEW    *05592700
055928* PO NUMBER.  THE DATA WILL BE WRITTEN TO THE RCRD001 RECORDS    *05592800
055929* ON THE OUTPUT FILE.                                            *05592900
055930******************************************************************05593000
055940 3600-GET-PO-DATA.                                                05594000
055950                                                                  05595000
055960     MOVE RC101-KOHLS-ORD-NBR TO DK-PO-NUMBER.                    05596000
055970     PERFORM 3700-GET-PO-HEADER-DATA.                             05597000
055980                                                                  05598000
055990     PERFORM 3800-GET-VENDOR-DATA.                                05599000
056000                                                                  05600000
056100     PERFORM 3900-GET-BUYER-ANALYST-DATA.                         05610000
056200                                                                  05620000
056300                                                                  05630000
056400******************************************************************05640000
056500* THIS PARAGRAPH WILL GET PO DATA TO BE WRITTEN TO THE HEADER     05650000
056600* RCRD001 OUTPUT RECORD.                                          05660000
056700******************************************************************05670000
056800 3700-GET-PO-HEADER-DATA.                                         05680000
056900                                                                  05690000
057000     EXEC SQL                                                     05700000
057100          SELECT A.PO_NBR                                         05710000
057200               , A.DEPT_NBR                                       05720000
057300               , A.ENT_ID                                         05730000
057400               , A.ORD_DTE                                        05740000
057500               , B.DONT_SHIP_BEF_DTE                              05750000
057600               , B.CAN_IFNOT_SHIP_DTE                             05760000
057700               , B.EXT_CAN_DTE                                    05770000
057800            INTO :PURCHS-PO-NBR                                   05780000
057900               , :PURCHS-DEPT-NBR                                 05790000
058000               , :PURCHS-ENT-ID                                   05800000
058100               , :PURCHS-ORD-DTE                                  05810000
058200               , :PLNSHP-DONT-SHIP-BEF-DTE                        05820000
058300               , :PLNSHP-CAN-IFNOT-SHIP-DTE                       05830000
058400               , :PLNSHP-EXT-CAN-DTE                              05840000
058500            FROM TPURCHS A                                        05850000
058600               , TPLNSHP B                                        05860000
058700          WHERE A.PO_NBR         = :DK-PO-NUMBER                  05870000
058800            AND A.VER_STATUS_CDE = 'A'                            05880000
058900            AND B.PO_NBR         = A.PO_NBR                       05890000
059000            AND B.VER_STATUS_CDE = 'A'                            05900000
059100          WITH UR                                                 05910000
059200     END-EXEC                                                     05920000
059300                                                                  05930000
059400     EVALUATE TRUE                                                05940000
059500         WHEN SQLCODE  = +0                                       05950000
059600             PERFORM 3750-MOVE-PO-HEADER-DATA                     05960000
059700         WHEN SQLCODE  = +100                                     05970000
059800             SET PS-PO-NOT-FOUND TO TRUE                          05980000
059900         WHEN OTHER                                               05990000
060000             DISPLAY '3700-GET-PO-HEADER-DATA'                    06000000
060100             DISPLAY 'PO NUMBER IS: ' RC101-KOHLS-ORD-NBR         06010000
060200             MOVE PV-READ-COUNT TO PV-DISP-NBR                    06020000
060300             DISPLAY 'RECORD NUMBER IS: ' PV-DISP-NBR             06030000
060400             MOVE '3700-GET-PO-HEADER-DATA' TO                    06040000
060500                  PV-ABEND-PARAGRAPH                              06050000
060600             MOVE 'GET PO HEADER INFORMATION' TO                  06060000
060700                  PV-ABEND-OPERATION                              06070000
060800             PERFORM 9900-DB2-ABEND                               06080000
060900     END-EVALUATE.                                                06090000
061000                                                                  06100000
061100                                                                  06110000
061200******************************************************************06120000
061300* THIS PARAGRAPH WILL MOVE THE RETRIEVED PO LEVEL DATA TO THE    *06130000
061400* FIELDS ON THE RCRD001 OUTPUT RECORD.                           *06140000
061500******************************************************************06150000
061600 3750-MOVE-PO-HEADER-DATA.                                        06160000
061700                                                                  06170000
061800     IF  PURCHS-ORD-DTE = '0001-01-01'                            06180000
061900         MOVE ZEROES         TO RC001-PO-DATE                     06190000
062000     ELSE                                                         06200000
062100         MOVE PURCHS-ORD-DTE (3:2) TO                             06210000
062200              RC001-PO-DATE (5:2)                                 06220000
062300         MOVE PURCHS-ORD-DTE (6:2) TO                             06230000
062400              RC001-PO-DATE (1:2)                                 06240000
062500         MOVE PURCHS-ORD-DTE (9:2) TO                             06250000
062600              RC001-PO-DATE (3:2)                                 06260000
062700     END-IF.                                                      06270000
062800                                                                  06280000
062900     IF  PLNSHP-DONT-SHIP-BEF-DTE = '0001-01-01'                  06290000
063000         MOVE ZEROES         TO RC001-REQ-SHIP-DATE               06300000
063100     ELSE                                                         06310000
063200         MOVE PLNSHP-DONT-SHIP-BEF-DTE (6:2) TO                   06320000
063300              RC001-REQ-SHIP-DATE (1:2)                           06330000
063400         MOVE PLNSHP-DONT-SHIP-BEF-DTE (9:2) TO                   06340000
063500              RC001-REQ-SHIP-DATE (3:2)                           06350000
063600         MOVE PLNSHP-DONT-SHIP-BEF-DTE (3:2) TO                   06360000
063700              RC001-REQ-SHIP-DATE (5:2)                           06370000
063800     END-IF.                                                      06380000
063900                                                                  06390000
064000     IF  PLNSHP-CAN-IFNOT-SHIP-DTE = '0001-01-01'                 06400000
064100         MOVE ZEROES         TO RC001-CANCEL-DATE                 06410000
064200     ELSE                                                         06420000
064300         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (6:2) TO                  06430000
064400              RC001-CANCEL-DATE (1:2)                             06440000
064500         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (9:2) TO                  06450000
064600              RC001-CANCEL-DATE (3:2)                             06460000
064700         MOVE PLNSHP-CAN-IFNOT-SHIP-DTE (3:2) TO                  06470000
064800              RC001-CANCEL-DATE (5:2)                             06480000
064900     END-IF.                                                      06490000
065000                                                                  06500000
065100     IF  PLNSHP-EXT-CAN-DTE = '0001-01-01'                        06510000
065200         MOVE ZEROES         TO RC001-CANCEL-EXT-DATE             06520000
065300     ELSE                                                         06530000
065400         MOVE PLNSHP-EXT-CAN-DTE (6:2) TO                         06540000
065500              RC001-CANCEL-EXT-DATE (1:2)                         06550000
065600         MOVE PLNSHP-EXT-CAN-DTE (9:2) TO                         06560000
065700              RC001-CANCEL-EXT-DATE (3:2)                         06570000
065800         MOVE PLNSHP-EXT-CAN-DTE (3:2) TO                         06580000
065900              RC001-CANCEL-EXT-DATE (5:2)                         06590000
066000     END-IF.                                                      06600000
066100                                                                  06610000
066200                                                                  06620000
066300******************************************************************06630000
066400* THIS PARAGRAPH WILL BE USED TO RETRIEVE VENDOR LEVEL DATA FOR  *06640000
066500* THE VENDOR ASSOCIATED TO THE PO BEING PROCESSED.  THIS DATA    *06650000
066600* WILL BE MOVED TO FIELDS ON THE RCRD001 OUTPUT RECORD.          *06660000
066700******************************************************************06670000
066800 3800-GET-VENDOR-DATA.                                            06680000
066900                                                                  06690000
067000     EXEC SQL                                                     06700000
067100          SELECT B.DUN_NBR                                        06710000
067200               , C.ENT_NAME_DESC                                  06720000
067300            INTO :EXTENT-DUN-NBR                                  06730000
067400               , :ENTNME-ENT-NAME-DESC                            06740000
067500            FROM TEXTENT B                                        06750000
067600               , TENTNME C                                        06760000
067700          WHERE B.ENT_ID         = :PURCHS-ENT-ID                 06770000
067800            AND C.ENT_ID         = B.ENT_ID                       06780000
067900            AND C.TYPE_CDE       = '01'                           06790000
068000          WITH UR                                                 06800000
068100     END-EXEC                                                     06810000
068200                                                                  06820000
068300     EVALUATE TRUE                                                06830000
068400         WHEN SQLCODE  = +0                                       06840000
068500             MOVE ENTNME-ENT-NAME-DESC TO RC001-EDI-VEND-NAME     06850000
068600             MOVE EXTENT-DUN-NBR       TO RC001-EDI-VEND-ID       06860000
068700         WHEN SQLCODE  = +100                                     06870000
068800         WHEN SQLCODE  = -811                                     06880000
068900             MOVE ZEROS                TO RC001-EDI-VEND-ID       06890000
069000             MOVE 'NOT FOUND'          TO RC001-EDI-VEND-NAME     06900000
069100         WHEN OTHER                                               06910000
069200             DISPLAY '3800-GET-VENDOR-DATA'                       06920000
069300             DISPLAY 'PO NUMBER IS: ' RC101-KOHLS-ORD-NBR         06930000
069400             MOVE PURCHS-ENT-ID TO PV-DISP-NBR                    06940000
069500             DISPLAY 'ENTITY ID IS: ' PV-DISP-NBR                 06950000
069600             MOVE PV-READ-COUNT TO PV-DISP-NBR                    06960000
069700             DISPLAY 'RECORD NUMBER IS: ' PV-DISP-NBR             06970000
069800             MOVE '3800-GET-VENDOR-DATA' TO                       06980000
069900                  PV-ABEND-PARAGRAPH                              06990000
070000             MOVE 'GET ENTITY ID INFORMATION' TO                  07000000
070100                  PV-ABEND-OPERATION                              07010000
070200             PERFORM 9900-DB2-ABEND                               07020000
070300     END-EVALUATE.                                                07030000
070400                                                                  07040000
070500                                                                  07050000
070600******************************************************************07060000
070700* THIS PARAGRAPH WILL RETRIEVE BUYER LEVEL DATA TO BE WRITTEN TO *07070000
070800* THE RCRD001 OUTPUT RECORD.                                     *07080000
070900******************************************************************07090000
071000 3900-GET-BUYER-ANALYST-DATA.                                     07100000
071100                                                                  07110000
071200     EXEC SQL                                                     07120000
071300         SELECT MDSEAR_DKEY,                                      07130000
071400                MDSEAR_DESC,                                      07140000
071500                BYR_NBR                                           07150000
071600           INTO :MDSEAR-DKEY,                                     07160000
071700                :MDSEAR-DESC,                                     07170000
071800                :MDSEAR-BYR-NBR                                   07180000
071900           FROM TMDSEAR                                           07190000
072000           WHERE DEPT_NBR          = :PURCHS-DEPT-NBR             07200000
072100             AND MDSELV_CDE        = 'DPT'                        07210000
072200             AND :PV-CURRENT-DATE  BETWEEN                        07220000
072300                  STRT_DTE AND END_DTE                            07230000
072400     END-EXEC.                                                    07240000
072500                                                                  07250000
072600     EVALUATE TRUE                                                07260000
072700         WHEN SQLCODE  = +0                                       07270000
072800         WHEN SQLCODE  = -811                                     07280000
072900             PERFORM 3920-GET-ANALYST-NAME                        07290000
073000             PERFORM 3940-GET-BUYER-NAME                          07300000
073100         WHEN SQLCODE  = +100                                     07310000
073200             MOVE 'DEPARTMENT NOT VALID'   TO MDSEAR-DESC         07320000
073300         WHEN OTHER                                               07330000
073400             DISPLAY '3900-GET-BUYER-ANALYST-DATA'                07340000
073500             DISPLAY 'DEPARTMENT NUMBER IS: ' PURCHS-DEPT-NBR     07350000
073600             MOVE PV-READ-COUNT TO PV-DISP-NBR                    07360000
073700             DISPLAY 'RECORD NUMBER IS: ' PV-DISP-NBR             07370000
073800             MOVE '3900-GET-BUYER-ANALYST-DATA' TO                07380000
073900                  PV-ABEND-PARAGRAPH                              07390000
074000             MOVE 'GET TMDSEAR INFORMATION' TO                    07400000
074100                  PV-ABEND-OPERATION                              07410000
074200             PERFORM 9900-DB2-ABEND                               07420000
074300     END-EVALUATE.                                                07430000
074400                                                                  07440000
074500                                                                  07450000
074600******************************************************************07460000
074700* THIS PARAGRAPH WILL BE USED TO GET THE ANALYST NAME TO BE      *07470000
074800* WRITTEN TO THE RCRD001 OUTPUT RECORD.                          *07480000
074900******************************************************************07490000
075000 3920-GET-ANALYST-NAME.                                           07500000
075100                                                                  07510000
075200     EXEC SQL                                                     07520000
075300         SELECT WORKER_NBR,                                       07530000
075400                WORKER_FIR_NAME,                                  07540000
075500                WORKER_LAST_NAME                                  07550000
075600           INTO :RSPBAR-WORKER-NBR,                               07560000
075700                :RSPBAR-WORKER-FIR-NAME,                          07570000
075800                :RSPBAR-WORKER-LAST-NAME                          07580000
075900           FROM TRSPBAR                                           07590000
076000           WHERE MDSEAR_DKEY       = :MDSEAR-DKEY                 07600000
076100             AND RSPLVL_CDE        = 'ANL'                        07610000
076200             AND :PV-CURRENT-DATE  BETWEEN                        07620000
076300                 WORKER_STRT_DTE AND WORKER_END_DTE               07630000
076400     END-EXEC.                                                    07640000
076500*                                                                 07650000
076600     EVALUATE TRUE                                                07660000
076700         WHEN SQLCODE = ZEROS                                     07670000
076800           MOVE PC-FLNAME-LENGTH         TO DP024-FLNAME-LENGTH   07680000
076900           MOVE RSPBAR-WORKER-FIR-NAME   TO DP024-FNAME           07690000
077000           MOVE RSPBAR-WORKER-LAST-NAME  TO DP024-LNAME           07700000
077100           PERFORM DP024-0000-FORMAT-NAME                         07710000
077200           MOVE DP024-FLNAME             TO RC001-ANALYST-NAME    07720000
077300         WHEN SQLCODE = +100                                      07730000
077400           MOVE SPACES                   TO RC001-ANALYST-NAME    07740000
077500         WHEN SQLCODE = -811                                      07750000
077600           MOVE PC-ASTERISK              TO RC001-ANALYST-NAME    07760000
077700         WHEN OTHER                                               07770000
077800             DISPLAY '3920-GET-ANALYST-NAME'                      07780000
077900             MOVE MDSEAR-DKEY TO PV-DISP-NBR                      07790000
078000             DISPLAY 'MDSEAR KEY FOR ANL IS: ' PV-DISP-NBR        07800000
078100             MOVE PV-READ-COUNT TO PV-DISP-NBR                    07810000
078200             DISPLAY 'RECORD NUMBER IS: ' PV-DISP-NBR             07820000
078300             MOVE '3920-GET-ANALYST-NAME' TO                      07830000
078400                  PV-ABEND-PARAGRAPH                              07840000
078500             MOVE 'GET ANALYST NAME INFORMATION' TO               07850000
078600                  PV-ABEND-OPERATION                              07860000
078700             PERFORM 9900-DB2-ABEND                               07870000
078800     END-EVALUATE.                                                07880000
078900                                                                  07890000
079000                                                                  07900000
079100******************************************************************07910000
079200* THIS PARAGRAPH WILL BE USED TO GET THE BUYER NAME TO BE        *07920000
079300* WRITTEN TO THE RCRD001 OUTPUT RECORD.                          *07930000
079400******************************************************************07940000
079500 3940-GET-BUYER-NAME.                                             07950000
079600                                                                  07960000
079700     EXEC SQL                                                     07970000
079800         SELECT WORKER_NBR,                                       07980000
079900                WORKER_FIR_NAME,                                  07990000
080000                WORKER_LAST_NAME                                  08000000
080100           INTO :RSPBAR-WORKER-NBR,                               08010000
080200                :RSPBAR-WORKER-FIR-NAME,                          08020000
080300                :RSPBAR-WORKER-LAST-NAME                          08030000
080400           FROM TRSPBAR A                                         08040000
080500           WHERE MDSEAR_DKEY       = :MDSEAR-DKEY                 08050000
080600             AND RSPLVL_CDE        = 'BYR'                        08060000
080700             AND :PV-CURRENT-DATE  BETWEEN                        08070000
080800                 WORKER_STRT_DTE AND WORKER_END_DTE               08080000
080900     END-EXEC.                                                    08090000
081000                                                                  08100000
081100     EVALUATE TRUE                                                08110000
081200         WHEN SQLCODE = ZEROS                                     08120000
081300             MOVE PC-FLNAME-LENGTH         TO DP024-FLNAME-LENGTH 08130000
081400             MOVE RSPBAR-WORKER-FIR-NAME   TO DP024-FNAME         08140000
081500             MOVE RSPBAR-WORKER-LAST-NAME  TO DP024-LNAME         08150000
081600             PERFORM DP024-0000-FORMAT-NAME                       08160000
081700             MOVE DP024-FLNAME             TO RC001-BUYER-NAME    08170000
081800             MOVE MDSEAR-BYR-NBR           TO RC001-BUYER-NBR     08180000
081900         WHEN SQLCODE = +100                                      08190000
082000         WHEN SQLCODE = -811                                      08200000
082100             MOVE SPACES                   TO RC001-BUYER-NAME    08210000
082200             MOVE ZEROS                    TO RC001-BUYER-NBR     08220000
082300         WHEN OTHER                                               08230000
082400             DISPLAY '3940-GET-BUYER-NAME'                        08240000
082500             MOVE MDSEAR-DKEY TO PV-DISP-NBR                      08250000
082600             DISPLAY 'MDSEAR KEY FOR BYR IS: ' PV-DISP-NBR        08260000
082700             MOVE PV-READ-COUNT TO PV-DISP-NBR                    08270000
082800             DISPLAY 'RECORD NUMBER IS: ' PV-DISP-NBR             08280000
082900             MOVE '3940-GET-BUYER-NAME' TO                        08290000
083000                  PV-ABEND-PARAGRAPH                              08300000
083100             MOVE 'GET BUYER NAME INFORMATION' TO                 08310000
083200                  PV-ABEND-OPERATION                              08320000
083300             PERFORM 9900-DB2-ABEND                               08330000
083400     END-EVALUATE.                                                08340000
083500                                                                  08350000
083600                                                                  08360000
083700******************************************************************08370000
083800* THIS PARAGRAPH WILL BE USED TO CONTROL THE PROCESSING NEEDED   *08380000
083900* TO GET ITEM LEVEL DATA FOR THE ITEM ASSOCIATED TO THE PO.      *08390000
084000******************************************************************08400000
084100 4600-GET-ITEM-DATA.                                              08410000
084200                                                                  08420000
084300     MOVE RC101-KOHLS-ORD-NBR TO DK-PO-NUMBER.                    08430000
084400     MOVE RC101-ORD-LNE-NBR     TO DK-PO-LINE-NUMBER.             08440000
084500     PERFORM 4700-GET-PO-LINE-DATA.                               08450000
084600                                                                  08460000
084700     MOVE PURITM-RMS-PO-SKU-NBR TO DK-SKU-NUMBER.                 08470000
084800     PERFORM 4800-GET-ITEM-DATA.                                  08480000
084900                                                                  08490000
085000                                                                  08500000
085100******************************************************************08510000
085200* THIS PARAGRAPH WILL BE USED TO RETRIEVE PO/LINE LEVEL DATA     *08520000
085300* TO BE WRITTEN TO THE RCRD001 OUTPUT RECORD.                    *08530000
085400******************************************************************08540000
085500 4700-GET-PO-LINE-DATA.                                           08550000
085600                                                                  08560000
085700     EXEC SQL                                                     08570000
085800          SELECT PO_NBR                                           08580000
085900               , PO_LNE_NBR                                       08590000
086000               , RMS_PO_SKU_NBR                                   08600000
086100               , UNT_QTY                                          08610000
086200               , UNT_RTL_PR_AMT                                   08620000
086300               , UNT_COST_AMT                                     08630000
086400            INTO :PURITM-PO-NBR                                   08640000
086500               , :PURITM-PO-LNE-NBR                               08650000
086600               , :PURITM-RMS-PO-SKU-NBR                           08660000
086700               , :PURITM-UNT-QTY                                  08670000
086800               , :PURITM-UNT-RTL-PR-AMT                           08680000
086900               , :PURITM-UNT-COST-AMT                             08690000
087000            FROM TPURITM                                          08700000
087100          WHERE PO_NBR         = :DK-PO-NUMBER                    08710000
087200            AND PO_LNE_NBR     = :DK-PO-LINE-NUMBER               08720000
087300            AND VER_STATUS_CDE = 'A'                              08730000
087400          WITH UR                                                 08740000
087500     END-EXEC                                                     08750000
087600                                                                  08760000
087700     EVALUATE TRUE                                                08770000
087800         WHEN SQLCODE  = +0                                       08780000
087900             MOVE PURITM-RMS-PO-SKU-NBR  TO PV-HOLD-LL-SKU-NBR    08790000
088000             MOVE PURITM-UNT-QTY         TO PV-HOLD-LL-QTY-ORDERED08800000
088100             MOVE PURITM-UNT-RTL-PR-AMT  TO PV-HOLD-LL-UNIT-RETAIL08810000
088200             MOVE PURITM-UNT-COST-AMT    TO PV-HOLD-LL-UNIT-COST  08820000
088300             SET PS-PO-LINE-FOUND TO TRUE                         08830000
088400             MOVE PURITM-PO-LNE-NBR TO RC101-ORD-LNE-NBR          08840000
088500         WHEN OTHER                                               08850000
088600             DISPLAY '4700-GET-PO-LINE-DATA'                      08860000
088700             DISPLAY 'PO NUMBER IS     : ' RC101-KOHLS-ORD-NBR    08870000
088800             DISPLAY 'PO LINE NUMBER IS: ' RC101-ORD-LNE-NBR      08880000
088900             MOVE PV-READ-COUNT TO PV-DISP-NBR                    08890000
089000             DISPLAY 'RECORD NUMBER IS: ' PV-DISP-NBR             08900000
089100             MOVE '4700-GET-PO-LINE-DATA' TO                      08910000
089200                  PV-ABEND-PARAGRAPH                              08920000
089300             MOVE 'GET PO LINE INFORMATION' TO                    08930000
089400                  PV-ABEND-OPERATION                              08940000
089500             PERFORM 9900-DB2-ABEND                               08950000
089600     END-EVALUATE.                                                08960000
089700                                                                  08970000
089800                                                                  08980000
089900******************************************************************08990000
090000* THIS PARAGRAPH WILL BE USED TO RETRIEVE ITEM LEVEL DATA TO BE  *09000000
090100* WRITTEN TO THE RCRD001 OUTPUT RECORD.                          *09010000
090200******************************************************************09020000
090300 4800-GET-ITEM-DATA.                                              09030000
090400                                                                  09040000
090500     EXEC SQL                                                     09050000
090600          SELECT A.SKU_NBR                                        09060000
090700               , A.SKU_DESC                                       09070000
090800               , A.SIZE_DESC                                      09080000
090900               , A.CSTM_CLOR_DESC                                 09090000
091000               , B.VS_NBR                                         09100000
091100               , B.DEPT_NBR                                       09110000
091200               , B.MAJ_CL_NBR                                     09120000
091300               , B.SUB_CL_NBR                                     09130000
091400            INTO :XLT00003-SKU-NBR                                09140000
091500               , :XLT00003-SKU-DESC                               09150000
091600               , :XLT00003-SIZE-DESC                              09160000
091700               , :XLT00003-CSTM-CLOR-DESC                         09170000
091800               , :XLT00004-VS-NBR                                 09180000
091900               , :XLT00004-DEPT-NBR                               09190000
092000               , :XLT00004-MAJ-CL-NBR                             09200000
092100               , :XLT00004-SUB-CL-NBR                             09210000
092200            FROM XLT_SKU A                                        09220000
092300               , XLT_VND_STYL B                                   09230000
092400          WHERE A.SKU_NBR      = :DK-SKU-NUMBER                   09240000
092500            AND B.STYL_ID      = A.STYL_ID                        09250000
092600          WITH UR                                                 09260000
092700     END-EXEC                                                     09270000
092800                                                                  09280000
092900     EVALUATE TRUE                                                09290000
093000         WHEN SQLCODE  = +0                                       09300000
093100             MOVE RC101-SKU-NBR          TO PV-HOLD-LL-SKU-NBR    09310000
093200                                            PV-SKU-NBR-N          09320000
093300             MOVE RC101-UPC-NBR          TO PV-HOLD-LL-UPC-NBR    09330000
093400             MOVE XLT00003-SKU-DESC      TO PV-HOLD-LL-UPC-DESC   09340000
093500             MOVE XLT00003-SIZE-DESC     TO PV-HOLD-LL-SIZE       09350000
093600             MOVE XLT00003-CSTM-CLOR-DESC TO PV-HOLD-LL-COLOR     09360000
093700             MOVE XLT00004-VS-NBR       TO PV-HOLD-LL-VENDOR-STYLE09370000
093800             MOVE RC101-DEPT-NBR         TO PV-HOLD-LL-DEPT-NBR   09380000
093900             MOVE XLT00004-SUB-CL-NBR    TO PV-SUB-CL-NBR-N       09390000
094000             MOVE PV-SUB-CL-NBR-2CH      TO PV-HOLD-LL-CLASS-NBR  09400000
094100             MOVE PV-SKU-NBR-3CH         TO PV-HOLD-LL-SKU-SEQ-NBR09410000
094200             MOVE PURITM-RMS-PO-SKU-NBR  TO PV-HOLD-LL-SKU-NBR    09420000
094300             MOVE PURITM-UNT-QTY         TO PV-HOLD-LL-QTY-ORDERED09430000
094400             MOVE PURITM-UNT-RTL-PR-AMT  TO PV-HOLD-LL-UNIT-RETAIL09440000
094500             MOVE PURITM-UNT-COST-AMT    TO PV-HOLD-LL-UNIT-COST  09450000
094600             SET PS-PO-LINE-FOUND TO TRUE                         09460000
094700             MOVE PURITM-PO-LNE-NBR TO RC101-ORD-LNE-NBR          09470000
094800         WHEN OTHER                                               09480000
094900             DISPLAY '4800-GET-ITEM-DATA'                         09490000
095000             DISPLAY 'SKU NUMBER IS   : ' RC101-SKU-NBR           09500000
095100             MOVE PV-READ-COUNT TO PV-DISP-NBR                    09510000
095200             DISPLAY 'RECORD NUMBER IS: ' PV-DISP-NBR             09520000
095300             MOVE '4800-GET-ITEM-DATA' TO                         09530000
095400                  PV-ABEND-PARAGRAPH                              09540000
095500             MOVE 'GET ITEM LEVEL INFORMATION' TO                 09550000
095600                  PV-ABEND-OPERATION                              09560000
095700             PERFORM 9900-DB2-ABEND                               09570000
095800     END-EVALUATE.                                                09580000
095900                                                                  09590000
096000                                                                  09600000
096100******************************************************************09610000
096200* READ A SHIPPED MERHANDISE INPUT FILE RECORD                    *09620000
096300******************************************************************09630000
096400 7000-READ-INPUT.                                                 09640000
096500                                                                  09650000
096600     READ SHIPPED-MDSE-INPUT-FILE                                 09660000
096700       INTO RC101-SHIPPED-MDSE-REC                                09670000
096800         AT END                                                   09680000
096900           SET END-OF-FILE TO TRUE                                09690000
097000         NOT AT END                                               09700000
097100           ADD 1                      TO PV-READ-COUNT            09710000
097200                                         PV-PROGRESSIVE-READ-COUNT09720000
097300           MOVE RC101-DC-NBR          TO PV-CURR-KEY-DC-NBR       09730000
097400           MOVE RC101-KOHLS-ORD-NBR   TO PV-CURR-KEY-ORD-NBR      09740000
097500           MOVE RC101-ORD-LNE-NBR     TO PV-CURR-KEY-ORD-LNE-NBR  09750000
097600           MOVE RC101-MDSE-SOURCE     TO PV-CURR-KEY-MDSE-SOURCE  09760000
097700           MOVE RC101-DELIVERY-SCAC   TO PV-CURR-KEY-DLVRY-SCAC   09770000
097800           MOVE RC101-FILE-NAME       TO PV-CURR-KEY-FILE-NAME    09780000
097900           IF  RC101-SSCC-NOT-EXISTS                              09790000
098000               MOVE RC101-SENT-SSCC-NBR TO                        09800000
098100                    PV-CURR-SENT-SSCC-NBR                         09810000
098200           ELSE                                                   09820000
098300               MOVE ZEROS             TO PV-CURR-SENT-SSCC-NBR    09830000
098400           END-IF                                                 09840000
098500           IF  PV-PROGRESSIVE-READ-COUNT =                        09850000
098600               PC-PROGRESSIVE-READ-LIMIT                          09860000
098700               MOVE PV-READ-COUNT TO PV-DISP-NBR                  09870000
098800               DISPLAY 'PROGRESSIVE READ COUNT IS: '              09880000
098900                       PV-DISP-NBR                                09890000
099000               MOVE ZEROS TO PV-PROGRESSIVE-READ-COUNT            09900000
099100           END-IF                                                 09910000
099200     END-READ.                                                    09920000
099300                                                                  09930000
099400                                                                  09940000
099500******************************************************************09950000
099600* MOVE ALL OF THE DATA TO THE HEADER RECORD AND WRITE OUT THE    *09960000
099700* RCRD001 HEADER RECORD TO THE OUTPUT FILE.                      *09970000
099800******************************************************************09980000
099900 8000-WRITE-HEADER-RECORD.                                        09990000
100000                                                                  10000000
100100     MOVE '03'                     TO RC001-OPERATING-COMPANY.    10010000
100200     MOVE RC101-DC-NBR             TO RC001-DIST-CNTR.            10020000
100300     MOVE RC101-DELIVERY-SCAC      TO RC001-CARRIER-SCAC-CODE.    10030000
100400     MOVE PV-BOL-NBR               TO RC001-BILL-OF-LADING-NBR.   10040000
100500     MOVE RC101-KOHLS-ORD-NBR      TO RC001-PO-NBR.               10050000
100600     MOVE RC101-DC-NBR             TO RC001-STORE-NBR.            10060000
100700     MOVE ZERO                     TO RC001-PO-LINE-NBR-9.        10070000
100800     MOVE ZERO                     TO RC001-SEQUENCE-NBR.         10080000
100900     MOVE ' '                      TO RC001-CARTON-IND.           10090000
101000     MOVE SPACES                   TO RC001-ASNHDR-NBR.           10100000
101100     MOVE PV-BOL-NBR               TO RC001-ORIG-BOL-NBR.         10110000
101200     MOVE 'N'                      TO RC001-SEQ-NBR-IND.          10120000
101300     MOVE RC101-DEPT-NBR           TO RC001-DEPT-NBR.             10130000
101400     MOVE MDSEAR-DESC              TO RC001-DEPT-DESC.            10140000
101500     MOVE PV-CURR-DATE-CC          TO PV-CURR-CC.                 10150000
101600     MOVE PV-CURR-DATE-YY          TO PV-CURR-YY.                 10160000
101700     MOVE PV-CURR-CCYY             TO PV-CENTURY-DATE-CCYY.       10170000
101800     MOVE PV-CURR-DATE-MM          TO PV-CENTURY-DATE-MM.         10180000
101900     MOVE PV-CURR-DATE-DD          TO PV-CENTURY-DATE-DD.         10190000
102000     MOVE PV-CENTURY-DATE-MMDDCCYY TO RC001-DATE-SHIPPED.         10200000
102100     MOVE ZEROS                    TO RC001-AD-DATE.              10210000
102200     MOVE ZERO                     TO RC001-CARR-VEND-ID.         10220000
102300     MOVE SPACES                   TO RC001-CARRIER-NAME.         10230000
102310     IF  RC101-FILE-SOURCE-SKU-SORT                               10231000
102320         MOVE RC101-DC-ABBR        TO PV-PRO-SKUSRT-DC-ABBR       10232000
102330         MOVE PV-PRO-SKUSRT-NBR    TO RC001-PRO-NBR               10233000
102340     ELSE                                                         10234000
102400         MOVE RC101-DC-ABBR        TO PV-PRO-CSV-DC-ABBR          10240000
102500         MOVE RC101-SENT-ORD-NBR   TO PV-PRO-CSV-PO-NBR           10250000
102600         MOVE PV-PRO-CSV-NBR       TO RC001-PRO-NBR               10260000
102610     END-IF.                                                      10261000
102700     MOVE SPACES                   TO RC001-TRAILER-NBR.          10270000
102800     MOVE 1                        TO RC001-SHIPMENT-WEIGHT.      10280000
102900     MOVE 'LB'                     TO RC001-SHIP-WEIGHT-UM.       10290000
103000     MOVE ZERO                     TO RC001-CARTON-CNT-STORE.     10300000
103100     MOVE ZERO                     TO RC001-CARTON-CNT-PO.        10310000
103200     MOVE ZERO                     TO RC001-CARTON-CNT-SHPMT.     10320000
103300     MOVE SPACES                   TO RC001-SPECIAL-INSTR-1.      10330000
103400     MOVE SPACES                   TO RC001-SPECIAL-INSTR-2.      10340000
103500     MOVE SPACES                   TO RC001-SPECIAL-INSTR-3.      10350000
103600     MOVE SPACES                   TO RC001-ASNORD-EARLY-LTE-CDE. 10360000
103700     MOVE 'Y'                      TO RC001-ASNORD-MTCH-PO-CDE.   10370000
103800     MOVE 'P'                      TO RC001-VENDOR-TRSCP-IND.     10380000
103900     MOVE 'N'                      TO RC001-LINE-ERROR-IND.       10390000
104000     MOVE SPACES                   TO RC001-CONT-NBR.             10400000
104100     MOVE ZERO                     TO RC001-ISA-NBR.              10410000
104200     MOVE SPACE                    TO RC001-MAN-SEG-IND.          10420000
104300     MOVE SPACES                   TO RC001-CARR-AUTH-ID.         10430000
104400     MOVE SPACES                   TO RC001-HDR-FILLER.           10440000
104500                                                                  10450000
104600     WRITE PACKSLIP-CARTON-RECORD                                 10460000
104700      FROM RC001-ASN-TRANSCRIPTION-RECORD.                        10470000
104800                                                                  10480000
104900     ADD +1 TO PV-WRITE-HEADER-COUNT                              10490000
105000               PV-WRITE-TOTAL-COUNT.                              10500000
105100                                                                  10510000
105200                                                                  10520000
105300******************************************************************10530000
105400* WRITE THE DETAIL RECORD TYPE RCRD001 RECORD TO THE OUTPUT FILE.*10540000
105500* THIS IS THE WRITE OF THE DC/PO/LINE LEVEL DETAIL RECORD.       *10550000
105600******************************************************************10560000
105700 8200-WRITE-DETAIL-RECORD.                                        10570000
105800                                                                  10580000
105900     MOVE PV-PREV-KEY-ORD-LNE-NBR  TO RC001-PO-LINE-NBR-9.        10590000
106000     MOVE PV-HOLD-LINE-SEQ-NBR     TO RC001-SEQUENCE-NBR.         10600000
106100     SET  RC001-DETAIL-RECORD      TO TRUE.                       10610000
106200     MOVE PV-HOLD-LL-DEPT-NBR-L3   TO RC001-SKU-DEPT-NBR.         10620000
106300     MOVE PV-HOLD-LL-CLASS-NBR     TO RC001-SKU-CLASS-NBR.        10630000
106400     MOVE PV-HOLD-LL-SKU-SEQ-NBR   TO RC001-SKU-SEQ-NBR.          10640000
106500     MOVE ZEROS                    TO RC001-DIST-PACK-QTY.        10650000
106600     MOVE PV-HOLD-LL-UPC-NBR       TO RC001-UPC-NBR.              10660000
106700     MOVE PV-HOLD-LL-UPC-DESC      TO RC001-UPC-DESC.             10670000
106800     MOVE PV-HOLD-LL-VENDOR-STYLE  TO RC001-VENDOR-STYLE.         10680000
106900     MOVE PV-HOLD-LL-SIZE          TO RC001-SIZE.                 10690000
107000     MOVE PV-HOLD-LL-COLOR         TO RC001-COLOR.                10700000
107100     MOVE PV-HOLD-LL-UNIT-COST     TO RC001-UNIT-COST.            10710000
107200     MOVE PV-HOLD-LL-UNIT-RETAIL   TO RC001-UNIT-RETAIL.          10720000
107300     MOVE PV-HOLD-LL-QTY-ORDERED   TO RC001-QTY-ORDERED.          10730000
107400     MOVE 'EA'                     TO RC001-QTY-ORDERED-UM.       10740000
107500     MOVE PV-LINE-SHIP-QTY         TO RC001-QTY-SHIPPED.          10750000
107600     MOVE 'EA'                     TO RC001-QTY-SHIPPED-UM.       10760000
107700     MOVE ZEROS                    TO RC001-QTY-SHIPPED-VAR.      10770000
107800     MOVE ZEROS                    TO RC001-PR-CHG-EFF-DAYS.      10780000
107900     MOVE 'N'                      TO RC001-ASDTPL-ALLOC-IND.     10790000
108000     MOVE 'Y'                      TO RC001-ASDTPL-MATCH-IND.     10800000
108100     MOVE 'N'                      TO RC001-ASDTPL-PR-DISC-IND.   10810000
108200     MOVE 'N'                      TO RC001-ASDTPL-PR-VAR-IND.    10820000
108300     MOVE PV-HOLD-LL-SKU-NBR       TO RC001-SKU-NBR.              10830000
108400     MOVE SPACES                   TO RC001-DTL-FILLER.           10840000
108500                                                                  10850000
108600     WRITE PACKSLIP-CARTON-RECORD                                 10860000
108700      FROM RC001-ASN-TRANSCRIPTION-RECORD.                        10870000
108800                                                                  10880000
108900     ADD +1 TO PV-WRITE-DETAIL-COUNT                              10890000
109000               PV-WRITE-TOTAL-COUNT.                              10900000
109100                                                                  10910000
109200                                                                  10920000
109300******************************************************************10930000
109400* WRITE THE CARTON RECORD TYPE RECORD TO THE RCRD001 OUTPUT FILE.*10940000
109500* THIS IS THE WRITE OF THE DC/PO/LINE LEVEL CARTON RECORD WHICH  *10950000
109600* CAN HAVE UP TO 10 CARTONS WITHIN AN INTERNAL TABLE IN THE      *10960000
109700* RECORD.                                                        *10970000
109800******************************************************************10980000
109900 8400-WRITE-CARTON-RECORD.                                        10990000
110000                                                                  11000000
110100     MOVE PV-PREV-KEY-ORD-LNE-NBR  TO RC001-PO-LINE-NBR-9.        11010000
110200     MOVE PV-KEY-SEQ-NBR           TO RC001-SEQUENCE-NBR.         11020000
110300     SET  RC001-CARTON-RECORD      TO TRUE.                       11030000
110400     MOVE PV-CARTON-TABLE (1)      TO RC001-CARTON-TABLE (1).     11040000
110500     MOVE PV-CARTON-TABLE (2)      TO RC001-CARTON-TABLE (2).     11050000
110600     MOVE PV-CARTON-TABLE (3)      TO RC001-CARTON-TABLE (3).     11060000
110700     MOVE PV-CARTON-TABLE (4)      TO RC001-CARTON-TABLE (4).     11070000
110800     MOVE PV-CARTON-TABLE (5)      TO RC001-CARTON-TABLE (5).     11080000
110900     MOVE PV-CARTON-TABLE (6)      TO RC001-CARTON-TABLE (6).     11090000
111000     MOVE PV-CARTON-TABLE (7)      TO RC001-CARTON-TABLE (7).     11100000
111100     MOVE PV-CARTON-TABLE (8)      TO RC001-CARTON-TABLE (8).     11110000
111200     MOVE PV-CARTON-TABLE (9)      TO RC001-CARTON-TABLE (9).     11120000
111300     MOVE PV-CARTON-TABLE (10)     TO RC001-CARTON-TABLE (10).    11130000
111400     MOVE SPACES                   TO RC001-CARTON-FILLER.        11140000
111500                                                                  11150000
111600     WRITE PACKSLIP-CARTON-RECORD                                 11160000
111700      FROM RC001-ASN-TRANSCRIPTION-RECORD.                        11170000
111800                                                                  11180000
111900     ADD +1 TO PV-WRITE-CARTON-COUNT                              11190000
112000               PV-WRITE-TOTAL-COUNT.                              11200000
112100                                                                  11210000
112200                                                                  11220000
112300******************************************************************11230000
112400* WRITE THE CARTON RECORD TYPE RECORD TO THE RCRD102 OUTPUT      *11240000
112500* FILE.  THIS IS THE WRITE OF THE DC/PO/LINE LEVEL CARTON        *11250000
112600* RECORD WHICH WILL BE USED IN A LATER PROGRAM TO UPDATE CARTON  *11260000
112700* COUNTS ON THE RCRD001 HEADER RECORD.                           *11270000
112800******************************************************************11280000
112900 8600-WRITE-SSCC-CARTON-RECORD.                                   11290000
113000                                                                  11300000
113100     WRITE SSCC-CARTON-RECORD                                     11310000
113110      FROM RC102-CARTON-REC.                                      11311000
113120                                                                  11312000
113121     ADD +1 TO PV-WRITE-SSCC-CARTON-COUNT.                        11312100
113122                                                                  11312200
113123                                                                  11312300
113124******************************************************************11312400
113125* WRITE THE VARIOUS RECORD COUNTS FOR THE PROGRAM EXECUTION TO   *11312500
113126* SYSOUT.                                                        *11312600
113127******************************************************************11312700
113128 8800-SHOW-COUNTERS.                                              11312800
113129     DISPLAY ' *********  RCKUT171 STATISTICS *********'          11312900
113130     MOVE PV-READ-COUNT           TO PV-DISP-NBR-C                11313000
113140     DISPLAY 'RECORDS READ              = ' PV-DISP-NBR-C.        11314000
113150     MOVE PV-WRITE-HEADER-COUNT   TO PV-DISP-NBR-C                11315000
113160     DISPLAY 'HEADER RECORDS WRITTEN    = ' PV-DISP-NBR-C.        11316000
113170     MOVE PV-WRITE-DETAIL-COUNT   TO PV-DISP-NBR-C                11317000
113180     DISPLAY 'DETAIL RECORDS WRITTEN    = ' PV-DISP-NBR-C.        11318000
113190     MOVE PV-WRITE-CARTON-COUNT   TO PV-DISP-NBR-C                11319000
113200     DISPLAY 'CARTON RECORDS WRITTEN    = ' PV-DISP-NBR-C.        11320000
113300     MOVE PV-WRITE-TOTAL-COUNT    TO PV-DISP-NBR-C.               11330000
113400     DISPLAY 'TOTAL NBR RECORDS WRITTEN = ' PV-DISP-NBR-C.        11340000
113500     MOVE PV-WRITE-SSCC-CARTON-COUNT TO PV-DISP-NBR-C.            11350000
113600     DISPLAY 'NBR SSCC RECORDS WRITTEN =  ' PV-DISP-NBR-C.        11360000
113700                                                                  11370000
113800                                                                  11380000
113900******************************************************************11390000
114000* THIS IS A COPYBOOK THAT CONTAINS PROCEDURE DIVISION RELATED    *11400000
114100* CODE TO FORMAT A NAME FIELD.                                   *11410000
114200******************************************************************11420000
114300     COPY DPPD024.                                                11430000
114400                                                                  11440000
114500******************************************************************11450000
114600* DB2 ABEND ROUTINE                                              *11460000
114700******************************************************************11470000
114800 9900-DB2-ABEND.                                                  11480000
114900*    DISPLAY '9900-DB2-ABEND'.                                    11490000
115000                                                                  11500000
115100     MOVE SQLCODE TO PV-SQLCODE.                                  11510000
115200     DISPLAY '*** DB2 ERROR '.                                    11520000
115300     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       11530000
115400     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 11540000
115500     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               11550000
115600     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               11560000
115700     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       11570000
115800     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             11580000
115900                                                                  11590000
116000     COPY DPPD004.                                                11600000
116100                                                                  11610000
116200     MOVE +4013                  TO PV-ABEND-CODE.                11620000
116300     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         11630000
116400                                                                  11640000
116500* ************************ END OF RCKUT171 ********************** 11650000
