000100 IDENTIFICATION DIVISION.                                         00010049
000200                                                                  00020049
000300 PROGRAM-ID.             PCKRP010.                                00030049
000400 AUTHOR.                 DENISE HAHN.                             00040049
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050049
000600 DATE-WRITTEN            APRIL, 1998.                             00060049
000700                                                                  00070049
000800*----------------------------------------------------------------*00080049
000900*                                                                *00090049
001000*  THIS PROGRAM CREATES THE PACK-TO-LIGHT DOWNLOAD STATUS REPORT *00100049
001100*  BY P2L MODULE.                                                *00110049
001200*                                                                *00120049
001300*  THE INPUT FILE SHOULD BE SORTED IN THE FOLLOWING SEQUENCE:    *00130049
001400*      -P2L MODULE, RECEIPT DATE, PO #, RECORD SEQUENCE, LINE #  *00140049
001500*----------------------------------------------------------------*00150049
001600* PUT TEMPORARY FIX IN TO WRITE HEADING TO INFOPAC IF PRINTER IS *00160050
001700* SELECTED - PITS # 190510  BY DENISE HAHN                       *00170050
001800*----------------------------------------------------------------*00180050
001900* REMOVED TEMPORARY FIX TO WRITE HEADING TO INFOPAC.  ADDED CODE *00190054
002000* TO END WITH RETURN-CODE OF +1 WHEN ONLY WRITING TO PRINTER.    *00200054
002100* IF RETURN-CODE =+1 JCL WILL NOT RUN THE INFOPAC STEPS.         *00210054
002200* PITS # 190510  BY DENISE HAHN                                  *00220054
002300*----------------------------------------------------------------*00230054
002400                                                                  00240049
002500                                                                  00250049
002600 ENVIRONMENT DIVISION.                                            00260049
002700 INPUT-OUTPUT SECTION.                                            00270049
002800                                                                  00280049
002900 FILE-CONTROL.                                                    00290049
003000                                                                  00300049
003100     SELECT INPUT-FILE        ASSIGN TO INP01.                    00310049
003200                                                                  00320049
003300     SELECT REPORT-FILE-1     ASSIGN TO RPT01.                    00330049
003400                                                                  00340049
003500     SELECT REPORT-FILE-2     ASSIGN TO RPT02.                    00350049
003600                                                                  00360049
003700                                                                  00370049
003800 DATA DIVISION.                                                   00380049
003900                                                                  00390049
004000 FILE SECTION.                                                    00400049
004100 FD  INPUT-FILE                                                   00410049
004200     RECORDING MODE IS F                                          00420049
004300     LABEL RECORDS ARE STANDARD                                   00430049
004400     BLOCK CONTAINS 0 RECORDS.                                    00440049
004500 01  INPUT-RECORD                     PIC X(150).                 00450049
004600                                                                  00460049
004700                                                                  00470049
004800 FD  REPORT-FILE-1                                                00480049
004900     RECORDING MODE IS F                                          00490049
005000     BLOCK CONTAINS 0 RECORDS                                     00500049
005100     LABEL RECORDS ARE OMITTED.                                   00510049
005200 01  REPORT-RECORD-1                  PIC  X(132).                00520049
005300                                                                  00530049
005400                                                                  00540049
005500 FD  REPORT-FILE-2                                                00550049
005600     RECORDING MODE IS F                                          00560049
005700     BLOCK CONTAINS 0 RECORDS                                     00570049
005800     LABEL RECORDS ARE OMITTED.                                   00580049
005900 01  REPORT-RECORD-2                  PIC  X(132).                00590049
006000                                                                  00600049
006100                                                                  00610049
006200 WORKING-STORAGE SECTION.                                         00620049
006300                                                                  00630049
006400 01  CC-CONTROL-CARD-PARAMETERS.                                  00640049
006500     05  CC-USER-ID                   PIC X(07)     VALUE SPACES. 00650049
006600     05  FILLER                       PIC X(01)     VALUE SPACE.  00660049
006700     05  CC-DC-NUMBER                 PIC 9(04)     VALUE ZEROES. 00670049
006800     05  FILLER                       PIC X(01)     VALUE SPACE.  00680049
006900     05  CC-REPORT-REQUEST-1          PIC X(01)     VALUE 'N'.    00690049
007000         88  CC-REPORT-BY-STORE-ZONE                VALUE 'S'.    00700049
007100         88  CC-RPT-STORE-ZONE-SUMMRY               VALUE 'X'.    00710038
007200     05  CC-REPORT-REQUEST-2          PIC X(01)     VALUE 'N'.    00720049
007300         88  CC-REPORT-BY-P2L-MODULE                VALUE 'S'.    00730038
007400         88  CC-RPT-P2L-MODULE-SUMMRY               VALUE 'X'.    00740038
007500     05  CC-TO-INFOPAC-OR-PRINTER     PIC X(01)     VALUE SPACE.  00750049
007600         88  CC-TO-INFOPAC                          VALUE 'I'.    00760012
007700         88  CC-TO-PRINTER                          VALUE 'P'.    00770012
007800     05  CC-PRINTER-ID                PIC X(08)     VALUE SPACES. 00780012
007900     05  CC-PRTR-CNTL-IND             PIC X(01)     VALUE SPACES. 00790041
008000     05  CC-TRACK-NBR                 PIC 9(01)     VALUE ZEROES. 00800041
008100     05  FILLER                       PIC X(56)     VALUE SPACES. 00810041
008200                                                                  00820041
008300                                                                  00830041
008400 01  PS-SWITCHES.                                                 00840041
008500     05  PS-INPUT-EOF-SW               PIC  X(01)    VALUE 'N'.   00850001
008600         88  PS-INPUT-EOF                            VALUE 'Y'.   00860001
008700         88  PS-INPUT-NOT-EOF                        VALUE 'N'.   00870001
008800     05  PS-NO-DETAIL-SW               PIC  X(01)    VALUE 'N'.   00880001
008900         88  PS-NO-DETAIL                            VALUE 'Y'.   00890001
009000     05  PS-SUMMARY-TABLE-SW           PIC  X(01)    VALUE 'N'.   00900001
009100         88  SUMMARY-TABLE-EOF                       VALUE 'Y'.   00910001
009200     05  PS-EOF-DC-TOTAL-SW            PIC  X(01)    VALUE 'N'.   00920043
009300         88  PS-EOF-DC-TOTAL                         VALUE 'Y'.   00930043
009400                                                                  00940001
009500 01  CD-CPU-DATE.                                                 00950001
009600     03  CD-YEAR                       PIC  9(02)    VALUE ZERO.  00960001
009700     03  CD-MONTH                      PIC  9(02)    VALUE ZERO.  00970001
009800     03  CD-DAY                        PIC  9(02)    VALUE ZERO.  00980001
009900                                                                  00990001
010000 01  CT-CPU-TIME.                                                 01000001
010100     03  CT-HOUR                       PIC  9(02)    VALUE ZERO.  01010001
010200     03  CT-MINUTE                     PIC  9(02)    VALUE ZERO.  01020001
010300     03  FILLER                        PIC  9(04)    VALUE ZERO.  01030001
010400                                                                  01040001
010500 01  PV-ABEND-FIELDS.                                             01050001
010600     05  PV-RECORD-COUNT              PIC  9(9)  VALUE ZERO.      01060001
010700                                                                  01070001
010800     05  PV-SQLCODE                   PIC  9(9)  VALUE ZERO.      01080001
010900     05  PV-ABEND-CODE                PIC S9(4)  VALUE +0         01090001
011000                                                 COMP SYNC.       01100001
011100     05  PV-ABEND-PROGRAM             PIC  X(8)  VALUE 'PCKRP010'.01110001
011200     05  PV-ABEND-PARAGRAPH           PIC  X(50) VALUE SPACES.    01120001
011300     05  PV-ABEND-OPERATION           PIC  X(50) VALUE SPACES.    01130001
011400     05  PV-ABEND-STRUCTURE-1         PIC  X(8)  VALUE SPACES.    01140001
011500     05  PV-ABEND-STRUCTURE-2         PIC  X(8)  VALUE SPACES.    01150001
011600     05  PV-ABEND-STRUCTURE-3         PIC  X(8)  VALUE SPACES.    01160001
011700     05  PV-DB2-OPERATION-MSG-1       PIC  X(79) VALUE SPACES.    01170001
011800     05  PV-DB2-OPERATION-MSG-2       PIC  X(79) VALUE SPACES.    01180001
011900     05  PV-DB2-OPERATION-MSG-3       PIC  X(79) VALUE SPACES.    01190001
012000     05  PV-DB2-OPERATION-MSG-4       PIC  X(79) VALUE SPACES.    01200001
012100     05  PV-PARAGRAPH-NAME            PIC  X(50) VALUE SPACES.    01210001
012200     05  PV-ERROR-MESSAGE-1           PIC  X(60) VALUE SPACES.    01220001
012300     05  PV-ERROR-MESSAGE-2           PIC  X(60) VALUE SPACES.    01230001
012400                                                                  01240001
012500 01  PC-PROGRAM-CONSTANTS.                                        01250001
012600     05  PC-DESCRIPTION-1             PIC  X(21)    VALUE         01260002
012700             'PO-RECEIVER TOTAL    '.                             01270002
012800     05  PC-DESCRIPTION-2             PIC  X(21)    VALUE         01280002
012900             '       DATE TOTAL    '.                             01290002
013000     05  PC-DESCRIPTION-3             PIC  X(21)    VALUE         01300002
013100             '    P2L MOD TOTAL    '.                             01310002
013200     05  PC-DESCRIPTION-4             PIC  X(21)    VALUE         01320002
013300             '         DC TOTAL    '.                             01330002
013400     05  PC-DESCRIPTION-5             PIC  X(08)    VALUE         01340002
013500             'DC TOTAL'.                                          01350001
013600     05  PC-DESC-STATUS-READY         PIC  X(08)    VALUE         01360003
013700             'READY   '.                                          01370003
013800     05  PC-DESC-STATUS-LAUNCHED      PIC  X(08)    VALUE         01380003
013900             'LAUNCHED'.                                          01390003
014000                                                                  01400001
014100     05  PC-CURRENT-PROGRAM-NAME      PIC  X(08)    VALUE         01410001
014200                                          'PCKRP010'.             01420001
014300                                                                  01430001
014400     05  PC-0                         PIC 9(01)     VALUE 0.      01440072
014500     05  PC-1                         PIC 9(01)     VALUE 1.      01450072
014600     05  PC-TABLE-MAX                 PIC S9(05)    VALUE +150.   01460001
014700     05  PC-ACTUAL-TABLE-ENTRIES      PIC S9(05)    VALUE ZEROES. 01470001
014800     05  PC-LINE-LIMIT                PIC S9(04)    VALUE +60     01480027
014900                                                    COMP SYNC.    01490024
015000     05  PC-TEN                       PIC S9(04)    VALUE +10     01500024
015100                                                    COMP SYNC.    01510001
015200                                                                  01520001
015300 01  PV-PROGRAM-VARIABLES.                                        01530001
015400     05  PV-LINE-COUNT                PIC S9(04)    VALUE +0      01540001
015500                                                    COMP SYNC.    01550001
015600     05  PV-PAGE-COUNT                PIC S9(04)    VALUE ZERO.   01560001
015700                                                                  01570001
015800  01  PV-ACCUMULATOR-FIELDS.                                      01580001
015900*-------------------------------------------------                01590001
016000*  NUMBER OF CARTONS - DETAIL REPORT                              01600001
016100*-------------------------------------------------                01610001
016200     05  PV-PO-RECEIVERS-CRTNS        PIC  9(05)   VALUE ZEROES.  01620003
016300     05  PV-DATE-CRTNS                PIC  9(05)   VALUE ZEROES.  01630003
016400     05  PV-P2L-CRTNS                 PIC  9(05)   VALUE ZEROES.  01640003
016500     05  PV-DC-CRTNS                  PIC  9(05)   VALUE ZEROES.  01650003
016600*-------------------------------------------------                01660001
016700*  NUMBER OF UNITS - DETAIL REPORT                                01670001
016800*-------------------------------------------------                01680001
016900     05  PV-PO-RECEIVERS-UNITS        PIC  9(05)   VALUE ZEROES.  01690003
017000     05  PV-DATE-UNITS                PIC  9(05)   VALUE ZEROES.  01700003
017100     05  PV-P2L-UNITS                 PIC  9(05)   VALUE ZEROES.  01710003
017200     05  PV-DC-UNITS                  PIC  9(05)   VALUE ZEROES.  01720003
017300*-------------------------------------------------                01730001
017400*  NUMBER OF PO-RECEIVER LINES - SUMMARY REPORT                   01740001
017500*-------------------------------------------------                01750001
017600     05  PV-P2L-TOTAL-LINES           PIC  9(06)   VALUE ZEROES.  01760003
017700     05  PV-P2L-ARRIVED-LINES         PIC  9(06)   VALUE ZEROES.  01770003
017800     05  PV-P2L-ENROUTE-LINES         PIC  9(06)   VALUE ZEROES.  01780003
017900*-------------------------------------------------                01790005
018000*  NUMBER OF CARTONS - SUMMARY REPORT                             01800001
018100*-------------------------------------------------                01810001
018200     05  PV-P2L-TOTAL-CRTNS           PIC  9(06)   VALUE ZEROES.  01820003
018300     05  PV-P2L-ARRIVED-CRTNS         PIC  9(06)   VALUE ZEROES.  01830003
018400     05  PV-P2L-ENROUTE-CRTNS         PIC  9(06)   VALUE ZEROES.  01840003
018500*-------------------------------------------------                01850001
018600*  NUMBER OF UNITS - SUMMARY-REPORT                               01860001
018700*-------------------------------------------------                01870001
018800     05  PV-P2L-TOTAL-UNITS           PIC  9(07)   VALUE ZEROES.  01880003
018900     05  PV-P2L-ARRIVED-UNITS         PIC  9(07)   VALUE ZEROES.  01890003
019000     05  PV-P2L-ENROUTE-UNITS         PIC  9(07)   VALUE ZEROES.  01900003
019100*-------------------------------------------------                01910001
019200*  NUMBER OF PO-RECEIVER LINES - FINAL TOTALS                     01920001
019300*-------------------------------------------------                01930001
019400     05  PV-FINAL-TOTAL-LINES         PIC  9(06)   VALUE ZEROES.  01940003
019500     05  PV-FINAL-ARRIVED-LINES       PIC  9(06)   VALUE ZEROES.  01950003
019600     05  PV-FINAL-ENROUTE-LINES       PIC  9(06)   VALUE ZEROES.  01960003
019700*-------------------------------------------------                01970001
019800*  NUMBER OF CARTONS - FINAL TOTALS                               01980001
019900*-------------------------------------------------                01990001
020000     05  PV-FINAL-TOTAL-CRTNS         PIC  9(06)   VALUE ZEROES.  02000003
020100     05  PV-FINAL-ARRIVED-CRTNS       PIC  9(06)   VALUE ZEROES.  02010003
020200     05  PV-FINAL-ENROUTE-CRTNS       PIC  9(06)   VALUE ZEROES.  02020003
020300*-------------------------------------------------                02030001
020400*  NUMBER OF UNITS - FINAL TOTALS                                 02040001
020500*-------------------------------------------------                02050001
020600     05  PV-FINAL-TOTAL-UNITS         PIC  9(07)   VALUE ZEROES.  02060003
020700     05  PV-FINAL-ARRIVED-UNITS       PIC  9(07)   VALUE ZEROES.  02070003
020800     05  PV-FINAL-ENROUTE-UNITS       PIC  9(07)   VALUE ZEROES.  02080003
020900                                                                  02090001
021000  01  PV-HOLD-FIELDS.                                             02100001
021100     05  PV-HOLD-CC-DC-NUMBER        PIC S9(04)     VALUE ZEROES  02110011
021200                                                    COMP.         02120011
021300     05  PV-HOLD-DC-NAME             PIC  X(25)     VALUE SPACES. 02130011
021400     05  PV-HOLD-STORE-ZONE          PIC  X(05)     VALUE SPACES. 02140011
021500     05  PV-HOLD-RECEIPT             PIC  X(10)     VALUE SPACES. 02150003
021600     05  PV-HOLD-RECEIPT-DATE        PIC  X(10)     VALUE SPACES. 02160003
021700         88  TRAILER-ENROUTE             VALUE '09/09/9999'.      02170033
021800     05  PV-HOLD-PO-NMBR             PIC  9(08)     COMP.         02180003
021900     05  PV-HOLD-REC-SEQ-NBR         PIC  X(04)     VALUE SPACES. 02190003
022000     05  PV-HOLD-LINE-LOC            PIC  X(05)     VALUE SPACES. 02200003
022100     05  PV-HOLD-VENDOR-NAME         PIC  X(30)     VALUE SPACES. 02210003
022200     05  PV-HOLD-DEPT-NUMBER         PIC  X(03)     VALUE SPACES. 02220003
022300     05  PV-HOLD-SCAC                PIC  X(04)     VALUE SPACES. 02230003
022400     05  PV-HOLD-TRAILER             PIC  X(10)     VALUE SPACES. 02240003
022500     05  PV-HOLD-LABEL-TYPE-CODE     PIC  X(02)     VALUE SPACES. 02250003
022600     05  PV-HOLD-P2L-MODULE          PIC  X(03)     VALUE SPACES. 02260003
022700     05  PV-HOLD-P2L-MODULE-NUM REDEFINES                         02270038
022800         PV-HOLD-P2L-MODULE          PIC  9(03).                  02280039
022900     05  PV-HOLD-P2L-MODULE-COMP     PIC S9(04)     COMP.         02290038
023000     05  PV-HOLD-DEFAULT-STORE-ZONE  PIC  X(05)     VALUE SPACES. 02300003
023100     05  PV-HOLD-CURRENT-OPER        PIC S9(04)     COMP.         02310040
023200     05  PV-HOLD-CURRENT-FCLTY       PIC S9(04)     COMP.         02320040
023300                                                                  02330001
023400     05  PV-PREV-STORE-ZONE          PIC  X(05)     VALUE SPACES. 02340003
023500     05  PV-PREV-PO-NMBR             PIC  9(08)     COMP.         02350003
023600     05  PV-PREV-REC-SEQ-NBR         PIC  X(04)     VALUE SPACES. 02360003
023700     05  PV-PREV-RECEIPT-DATE        PIC  X(10)     VALUE SPACES. 02370003
023800     05  PV-PREV-VENDOR-NAME         PIC  X(30)     VALUE SPACES. 02380003
023900     05  PV-PREV-DEPT-NUMBER         PIC  X(03)     VALUE SPACES. 02390003
024000     05  PV-PREV-SCAC                PIC  X(04)     VALUE SPACES. 02400003
024100     05  PV-PREV-TRAILER             PIC  X(10)     VALUE SPACES. 02410003
024200                                                                  02420001
024300                                                                  02430001
024400  01  SPT-SUMMARY-PAGE-TABLE.                                     02440001
024500      05  FILLER  OCCURS 150 TIMES                                02450001
024600                  INDEXED BY SPT-INDEX.                           02460001
024700          10  SPT-P2L-MODULE         PIC X(03)      VALUE SPACES. 02470001
024800          10  SPT-ARRIVED-LINES      PIC 9(06)      VALUE ZEROES. 02480001
024900          10  SPT-ENROUTE-LINES      PIC 9(06)      VALUE ZEROES. 02490001
025000          10  SPT-TOTAL-LINES        PIC 9(06)      VALUE ZEROES. 02500001
025100          10  SPT-ARRIVED-CRTNS      PIC 9(06)      VALUE ZEROES. 02510001
025200          10  SPT-ARRIVED-UNITS      PIC 9(07)      VALUE ZEROES. 02520001
025300          10  SPT-ENROUTE-CRTNS      PIC 9(06)      VALUE ZEROES. 02530001
025400          10  SPT-ENROUTE-UNITS      PIC 9(07)      VALUE ZEROES. 02540001
025500          10  SPT-TOTAL-CRTNS        PIC 9(06)      VALUE ZEROES. 02550001
025600          10  SPT-TOTAL-UNITS        PIC 9(07)      VALUE ZEROES. 02560001
025700                                                                  02570001
025800                                                                  02580001
025900 01  HL1-HEADING-LINE-1.                                          02590001
026000     05  FILLER                      PIC  X(02)    VALUE SPACES.  02600042
026100     05  FILLER                      PIC  X(15)    VALUE          02610001
026200     'REQUESTED BY:  '.                                           02620001
026300     05  HL1-USER-ID                 PIC  X(08)    VALUE SPACES.  02630001
026400     05  FILLER                      PIC  X(19)    VALUE SPACES.  02640042
026500     05  FILLER                      PIC  X(43)    VALUE          02650001
026600     'PACK-TO-LIGHT DOWNLOAD STATUS BY P2L MODULE'.               02660001
026700     05  FILLER                      PIC  X(46)    VALUE SPACES.  02670001
026800                                                                  02680001
026900 01  HL2-HEADING-LINE-2.                                          02690001
027000     05  FILLER                      PIC  X(02)    VALUE SPACES.  02700042
027100     05  FILLER                      PIC  X(09)    VALUE          02710001
027200         'DC:      '.                                             02720001
027300     05  HL2-DC-NUMBER               PIC  ZZZZ     VALUE ZEROES.  02730032
027400     05  FILLER                      PIC  X(03)    VALUE ' - '.   02740001
027500     05  HL2-DC-NAME                 PIC  X(25)    VALUE SPACES.  02750001
027600     05  FILLER                      PIC  X(89)    VALUE SPACES.  02760042
027700                                                                  02770001
027800 01  HL3-HEADING-LINE-3.                                          02780001
027900     05  FILLER                      PIC  X(02)    VALUE SPACES.  02790042
028000     05  FILLER                      PIC  X(10)    VALUE          02800001
028100         'P2L MOD:  '.                                            02810001
028200     05  HL3-P2L-MODULE              PIC  ZZZ      VALUE ZEROES.  02820032
028300     05  FILLER                      PIC  X(03)    VALUE '   '.   02830001
028400     05  FILLER                      PIC  X(21)    VALUE          02840001
028500         'DEFAULT STORE ZONE:  '.                                 02850001
028600     05  HL3-DEFAULT-STORE-ZONE      PIC  X(05)    VALUE SPACES.  02860001
028700     05  FILLER                      PIC  X(88)    VALUE SPACES.  02870042
028800                                                                  02880001
028900 01  HL4-HEADING-LINE-4.                                          02890005
029000     05  FILLER                      PIC  X(03)    VALUE SPACES.  02900042
029100     05  FILLER                      PIC  X(07)    VALUE          02910001
029200         'RECEIPT'.                                               02920001
029300     05  FILLER                      PIC  X(17)    VALUE SPACES.  02930042
029400     05  FILLER                      PIC  X(05)    VALUE          02940001
029500         'STORE'.                                                 02950001
029600     05  FILLER                      PIC  X(29)    VALUE SPACES.  02960001
029700     05  FILLER                      PIC  X(04)    VALUE          02970001
029800         'DEPT'.                                                  02980001
029900     05  FILLER                      PIC  X(28)    VALUE SPACES.  02990001
030000     05  FILLER                      PIC  X(04)    VALUE          03000001
030100         'LINE'.                                                  03010001
030200     05  FILLER                      PIC  X(03)    VALUE SPACES.  03020001
030300     05  FILLER                      PIC  X(17)    VALUE          03030001
030400         '--- DOWNLOADED --'.                                     03040001
030500     05  FILLER                      PIC  X(04)    VALUE SPACES.  03050001
030600     05  FILLER                      PIC  X(04)    VALUE          03060001
030700         'LINE'.                                                  03070001
030800     05  FILLER                      PIC  X(07)    VALUE SPACES.  03080001
030900                                                                  03090001
031000 01  HL5-HEADING-LINE-5.                                          03100005
031100     05  FILLER                      PIC  X(04)    VALUE SPACES.  03110042
031200     05  FILLER                      PIC  X(04)    VALUE          03120001
031300         'DATE'.                                                  03130001
031400     05  FILLER                      PIC  X(05)    VALUE SPACES.  03140042
031500     05  FILLER                      PIC  X(11)    VALUE          03150001
031600         'PO/RECEIVER'.                                           03160001
031700     05  FILLER                      PIC  X(03)    VALUE SPACES.  03170001
031800     05  FILLER                      PIC  X(04)    VALUE          03180001
031900         'ZONE'.                                                  03190001
032000     05  FILLER                      PIC  X(03)    VALUE SPACES.  03200001
032100     05  FILLER                      PIC  X(11)    VALUE          03210001
032200         'VENDOR NAME'.                                           03220001
032300     05  FILLER                      PIC  X(16)    VALUE SPACES.  03230001
032400     05  FILLER                      PIC  X(03)    VALUE          03240001
032500         'NUM'.                                                   03250001
032600     05  FILLER                      PIC  X(03)    VALUE SPACES.  03260001
032700     05  FILLER                      PIC  X(14)    VALUE          03270001
032800         'SCAC / TRAILER'.                                        03280001
032900     05  FILLER                      PIC  X(05)    VALUE SPACES.  03290001
033000     05  FILLER                      PIC  X(04)    VALUE          03300001
033100         'LINE'.                                                  03310001
033200     05  FILLER                      PIC  X(03)    VALUE SPACES.  03320001
033300     05  FILLER                      PIC  X(03)    VALUE          03330001
033400         'LOC'.                                                   03340001
033500     05  FILLER                      PIC  X(04)    VALUE SPACES.  03350001
033600     05  FILLER                      PIC  X(05)    VALUE          03360001
033700         'CRTNS'.                                                 03370001
033800     05  FILLER                      PIC  X(07)    VALUE SPACES.  03380001
033900     05  FILLER                      PIC  X(05)    VALUE          03390001
034000         'UNITS'.                                                 03400001
034100     05  FILLER                      PIC  X(03)    VALUE SPACES.  03410001
034200     05  FILLER                      PIC  X(06)    VALUE          03420001
034300         'STATUS'.                                                03430001
034400     05  FILLER                      PIC  X(06)    VALUE SPACES.  03440001
034500                                                                  03450001
034600 01  HSL2-HEADING-SUMMARY-LINE-2.                                 03460043
034700     05  FILLER                      PIC  X(02)    VALUE SPACES.  03470043
034800     05  FILLER                      PIC  X(13)    VALUE          03480043
034900         'P2L MOD:  SUM'.                                         03490043
035000     05  FILLER                      PIC  X(117)   VALUE SPACES.  03500043
035100                                                                  03510043
035200 01  HSL3-HEADING-SUMMARY-LINE-3.                                 03520001
035300     05  FILLER                      PIC  X(02)    VALUE SPACES.  03530042
035400     05  FILLER                      PIC  X(37)    VALUE          03540001
035500         'RECAP SUMMARY BY PACK-TO-LIGHT MODULE'.                 03550001
035600     05  FILLER                      PIC  X(93)   VALUE SPACES.   03560042
035700                                                                  03570001
035800 01  HSL4-HEADING-SUMMARY-LINE-4.                                 03580001
035900     05  FILLER                      PIC  X(57)    VALUE SPACES.  03590001
036000     05  FILLER                      PIC  X(19)    VALUE          03600001
036100         '-------------------'.                                   03610001
036200     05  FILLER                      PIC  X(29)    VALUE          03620001
036300         ' DOWNLOADED TO PACK-TO-LIGHT '.                         03630001
036400     05  FILLER                      PIC  X(19)    VALUE          03640001
036500         '-------------------'.                                   03650001
036600     05  FILLER                      PIC  X(08)    VALUE SPACES.  03660001
036700                                                                  03670001
036800 01  HSL5-HEADING-SUMMARY-LINE-5.                                 03680001
036900     05  FILLER                      PIC  X(13)    VALUE SPACES.  03690001
037000     05  FILLER                      PIC  X(03)    VALUE          03700001
037100         'P2L'.                                                   03710001
037200     05  FILLER                      PIC  X(05)    VALUE SPACES.  03720001
037300     05  FILLER                      PIC  X(31)    VALUE          03730001
037400         '--NUMBER OF PO/RECEIVER LINES--'.                       03740001
037500     05  FILLER                      PIC  X(05)    VALUE SPACES.  03750001
037600     05  FILLER                      PIC  X(19)    VALUE          03760001
037700         '------ARRIVED------'.                                   03770001
037800     05  FILLER                      PIC  X(05)    VALUE SPACES.  03780001
037900     05  FILLER                      PIC  X(19)    VALUE          03790001
038000         '------ENROUTE------'.                                   03800001
038100     05  FILLER                      PIC  X(06)    VALUE SPACES.  03810001
038200     05  FILLER                      PIC  X(18)    VALUE          03820001
038300         '------TOTAL-------'.                                    03830001
038400     05  FILLER                      PIC  X(08)    VALUE SPACES.  03840001
038500                                                                  03850001
038600 01  HSL6-HEADING-SUMMARY-LINE-6.                                 03860001
038700     05  FILLER                      PIC  X(13)    VALUE SPACES.  03870001
038800     05  FILLER                      PIC  X(03)    VALUE          03880001
038900         'MOD'.                                                   03890001
039000     05  FILLER                      PIC  X(05)    VALUE SPACES.  03900001
039100     05  FILLER                      PIC  X(07)    VALUE          03910001
039200         'ARRIVED'.                                               03920001
039300     05  FILLER                      PIC  X(05)    VALUE SPACES.  03930001
039400     05  FILLER                      PIC  X(07)    VALUE          03940001
039500         'ENROUTE'.                                               03950001
039600     05  FILLER                      PIC  X(07)    VALUE SPACES.  03960001
039700     05  FILLER                      PIC  X(05)    VALUE          03970001
039800         'TOTAL'.                                                 03980001
039900     05  FILLER                      PIC  X(07)    VALUE SPACES.  03990001
040000     05  FILLER                      PIC  X(16)    VALUE          04000001
040100         'CTNS       UNITS'.                                      04010001
040200     05  FILLER                      PIC  X(08)    VALUE SPACES.  04020001
040300     05  FILLER                      PIC  X(16)    VALUE          04030001
040400         'CTNS       UNITS'.                                      04040001
040500     05  FILLER                      PIC  X(08)    VALUE SPACES.  04050027
040600     05  FILLER                      PIC  X(16)    VALUE          04060001
040700         'CTNS       UNITS'.                                      04070001
040800     05  FILLER                      PIC  X(09)    VALUE SPACES.  04080001
040900                                                                  04090001
041000 01  DL1-DETAIL-LINE-1.                                           04100043
041100     05  FILLER                      PIC  X(01)    VALUE SPACES.  04110001
041200     05  DL1-RECEIPT-DATE            PIC  X(10)    VALUE SPACES.  04120001
041300     05  FILLER                      PIC  X(02)    VALUE SPACES.  04130001
041400     05  DL1-PO-NUMBER               PIC  X(08)    VALUE ZEROES.  04140005
041500     05  DL1-PO-DASH                 PIC  X(01)    VALUE SPACE.   04150016
041600     05  DL1-PO-SEQ-NBR              PIC  X(04)    VALUE ZEROES.  04160005
041700     05  FILLER                      PIC  X(01)    VALUE SPACES.  04170016
041800     05  DL1-STORE-ZONE              PIC  X(05)    VALUE SPACES.  04180001
041900     05  FILLER                      PIC  X(02)    VALUE SPACE.   04190001
042000     05  DL1-VENDOR-NAME             PIC  X(25)    VALUE SPACES.  04200001
042100     05  FILLER                      PIC  X(02)    VALUE SPACES.  04210001
042200     05  DL1-DEPT-NBR                PIC  ZZZZ     VALUE ZEROES.  04220029
042300     05  FILLER                      PIC  X(02)    VALUE SPACES.  04230001
042400     05  DL1-SCAC                    PIC  X(04)    VALUE SPACES.  04240015
042500     05  DL1-SCAC-DASH               PIC  X(03)    VALUE SPACE.   04250016
042600     05  DL1-TRAILER                 PIC  X(10)    VALUE SPACES.  04260001
042700     05  FILLER                      PIC  X(02)    VALUE SPACES.  04270001
042800     05  DL1-LINE-NUMBER             PIC  ZZZ9     VALUE ZEROES.  04280001
042900     05  FILLER                      PIC  X(02)    VALUE SPACES.  04290001
043000     05  DL1-LINE-LOC                PIC  X(05)    VALUE SPACES.  04300001
043100     05  FILLER                      PIC  X(02)    VALUE SPACES.  04310001
043200     05  DL1-CARTONS                 PIC  ZZ,ZZ9   VALUE ZEROES.  04320001
043300     05  FILLER                      PIC  X(05)    VALUE SPACES.  04330001
043400     05  DL1-UNITS                   PIC  ZZZ,ZZ9  VALUE ZEROES.  04340001
043500     05  FILLER                      PIC  X(05)    VALUE SPACES.  04350001
043600     05  DL1-LINE-STATUS             PIC  X(08)    VALUE SPACES.  04360001
043700     05  FILLER                      PIC  X(05)    VALUE SPACES.  04370001
043800                                                                  04380001
043900 01  TL1-TOTAL-LINE-1.                                            04390001
044000     05  FILLER                     PIC  X(77)     VALUE SPACES.  04400002
044100     05  TL1-TOT-DESCRIPTION        PIC  X(21)     VALUE SPACES.  04410002
044200     05  TL1-TOT-CARTONS            PIC  ZZZ,ZZ9   VALUE ZEROES.  04420001
044300     05  FILLER                     PIC  X(03)     VALUE SPACES.  04430001
044400     05  TL1-TOT-UNITS              PIC  Z,ZZZ,ZZ9 VALUE ZEROES.  04440001
044500     05  FILLER                     PIC  X(16)     VALUE SPACES.  04450001
044600                                                                  04460001
044700 01  SL1-SUMMARY-LINE-1.                                          04470001
044800     05  FILLER                      PIC  X(13)     VALUE SPACES. 04480027
044900     05  SL1-P2L-MODULE              PIC  X(03)     VALUE SPACES. 04490027
045000     05  FILLER                      PIC  X(05)     VALUE SPACE.  04500001
045100     05  SL1-PO-RCVR-LINES-ARRIVED   PIC  ZZZ,ZZ9   VALUE ZEROES. 04510001
045200     05  FILLER                      PIC  X(05)     VALUE SPACES. 04520001
045300     05  SL1-PO-RCVR-LINES-ENROUTE   PIC  ZZZ,ZZ9   VALUE ZEROES. 04530001
045400     05  FILLER                      PIC  X(05)     VALUE SPACES. 04540001
045500     05  SL1-PO-RCVR-LINES-TOTAL     PIC  ZZZ,ZZ9   VALUE ZEROES. 04550001
045600     05  FILLER                      PIC  X(05)     VALUE SPACES. 04560001
045700     05  SL1-TO-P2L-ARRIVED-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04570001
045800     05  FILLER                      PIC  X(03)     VALUE SPACES. 04580001
045900     05  SL1-TO-P2L-ARRIVED-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04590001
046000     05  FILLER                      PIC  X(05)     VALUE SPACES. 04600001
046100     05  SL1-TO-P2L-ENROUTE-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04610001
046200     05  FILLER                      PIC  X(03)     VALUE SPACES. 04620001
046300     05  SL1-TO-P2L-ENROUTE-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04630001
046400     05  FILLER                      PIC  X(05)     VALUE SPACES. 04640001
046500     05  SL1-TO-P2L-TOTAL-CTNS       PIC  ZZZ,ZZ9   VALUE ZEROES. 04650001
046600     05  FILLER                      PIC  X(03)     VALUE SPACES. 04660001
046700     05  SL1-TO-P2L-TOTAL-UNITS      PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04670001
046800     05  FILLER                      PIC  X(08)     VALUE SPACES. 04680001
046900                                                                  04690001
047000 01  SL2-SUMMARY-LINE-2.                                          04700001
047100     05  FILLER                      PIC  X(08)     VALUE SPACES. 04710001
047200     05  SL2-TOTAL-DESCRIPTION       PIC  X(08)     VALUE SPACES. 04720001
047300     05  FILLER                      PIC  X(05)     VALUE SPACE.  04730001
047400     05  SL2-PO-RCVR-LINES-ARRIVED   PIC  ZZZ,ZZ9   VALUE ZEROES. 04740001
047500     05  FILLER                      PIC  X(05)     VALUE SPACES. 04750001
047600     05  SL2-PO-RCVR-LINES-ENROUTE   PIC  ZZZ,ZZ9   VALUE ZEROES. 04760001
047700     05  FILLER                      PIC  X(05)     VALUE SPACES. 04770001
047800     05  SL2-PO-RCVR-LINES-TOTAL     PIC  ZZZ,ZZ9   VALUE ZEROES. 04780001
047900     05  FILLER                      PIC  X(05)     VALUE SPACES. 04790001
048000     05  SL2-TO-P2L-ARRIVED-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04800001
048100     05  FILLER                      PIC  X(03)     VALUE SPACES. 04810001
048200     05  SL2-TO-P2L-ARRIVED-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04820001
048300     05  FILLER                      PIC  X(05)     VALUE SPACES. 04830001
048400     05  SL2-TO-P2L-ENROUTE-CTNS     PIC  ZZZ,ZZ9   VALUE ZEROES. 04840001
048500     05  FILLER                      PIC  X(03)     VALUE SPACES. 04850001
048600     05  SL2-TO-P2L-ENROUTE-UNITS    PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04860001
048700     05  FILLER                      PIC  X(05)     VALUE SPACES. 04870001
048800     05  SL2-TO-P2L-TOTAL-CTNS       PIC  ZZZ,ZZ9   VALUE ZEROES. 04880001
048900     05  FILLER                      PIC  X(03)     VALUE SPACES. 04890001
049000     05  SL2-TO-P2L-TOTAL-UNITS      PIC  Z,ZZZ,ZZ9 VALUE ZEROES. 04900001
049100     05  FILLER                      PIC  X(08)     VALUE SPACES. 04910001
049200                                                                  04920001
049300 01  PR-PRINT-FINAL.                                              04930001
049400     05  FILLER                      PIC X(02)  VALUE SPACES.     04940001
049500     05  FILLER                      PIC X(19)  VALUE             04950001
049600         '** END OF REPORT **'.                                   04960001
049700     05  FILLER                      PIC X(111) VALUE SPACES.     04970001
049800                                                                  04980001
049900 01  PR-PRINT-NO-DETAIL.                                          04990001
050000     05  FILLER                      PIC X(02)  VALUE SPACES.     05000001
050100     05  FILLER                      PIC X(29)  VALUE             05010001
050200         '*** NO DETAILS TO REPORT ***'.                          05020001
050300     05  FILLER                      PIC X(101) VALUE SPACES.     05030001
050400                                                                  05040001
050500                                                                  05050057
050600 01  EL1-ERROR-LINE-1.                                            05060057
050700     05  FILLER                      PIC  X(02)     VALUE SPACES. 05070057
050800     05  FILLER                      PIC  X(48)     VALUE         05080057
050900         'A PROBLEM WAS ENCOUNTERED DURING THE PROCESS OF '.      05090057
051000     05  FILLER                      PIC  X(49)     VALUE         05100057
051100         'CREATING THIS REPORT.  YOUR REQUEST COULD NOT BE '.     05110057
051200     05  FILLER                      PIC  X(33)     VALUE         05120057
051300         'COMPLETED.                       '.                     05130057
051400                                                                  05140057
051500 01  EL2-ERROR-LINE-2.                                            05150057
051600     05  FILLER                      PIC  X(02)     VALUE SPACES. 05160057
051700     05  FILLER                      PIC  X(50)     VALUE         05170057
051800         'PLEASE RE-SUBMIT YOUR REQUEST AGAIN.              '.    05180057
051900     05  FILLER                      PIC  X(81)     VALUE SPACES. 05190057
052000                                                                  05200057
052100 01  EL3-ERROR-LINE-3.                                            05210057
052200     05  FILLER                      PIC  X(02)     VALUE SPACES. 05220057
052300     05  FILLER                      PIC  X(50)     VALUE         05230057
052400         'YOUR REQUEST WAS AS FOLLOWS:                      '.    05240057
052500     05  FILLER                      PIC  X(81)     VALUE SPACES. 05250057
052600                                                                  05260057
052700 01  EL4-ERROR-LINE-4.                                            05270057
052800     05  FILLER                      PIC  X(07)     VALUE SPACES. 05280057
052900     05  FILLER                      PIC  X(30)     VALUE         05290057
053000         'CREATE THE STATUS REPORT BY:  '.                        05300057
053100     05  FILLER                      PIC  X(95)     VALUE SPACES. 05310057
053200                                                                  05320057
053300 01  EL5-ERROR-LINE-5.                                            05330057
053400     05  FILLER                      PIC  X(12)     VALUE SPACES. 05340057
053500     05  FILLER                      PIC  X(25)     VALUE         05350057
053600         'STORE ZONE:              '.                             05360057
053700     05  EL5-STORE-ZONE              PIC  X(01)     VALUE SPACES. 05370057
053800     05  FILLER                      PIC  X(35)     VALUE         05380057
053900         '     (S=ENTIRE RPT, X=SUMMARY ONLY)'.                   05390057
054000     05  FILLER                      PIC  X(59)     VALUE SPACES. 05400057
054100                                                                  05410057
054200 01  EL6-ERROR-LINE-6.                                            05420057
054300     05  FILLER                      PIC  X(12)     VALUE SPACES. 05430057
054400     05  FILLER                      PIC  X(25)     VALUE         05440057
054500         'PACK-TO-LIGHT MODULE:    '.                             05450057
054600     05  EL6-P2L-MODULE              PIC  X(01)     VALUE SPACES. 05460057
054700     05  FILLER                      PIC  X(35)     VALUE         05470057
054800         '     (S=ENTIRE RPT, X=SUMMARY ONLY)'.                   05480057
054900     05  FILLER                      PIC  X(59)     VALUE SPACES. 05490057
055000                                                                  05500057
055100 01  EL7-ERROR-LINE-7.                                            05510057
055200     05  FILLER                      PIC  X(07)     VALUE SPACES. 05520057
055300     05  FILLER                      PIC  X(30)     VALUE         05530057
055400         'PRINT REPORT TO:              '.                        05540057
055500     05  FILLER                      PIC  X(95)     VALUE SPACES. 05550057
055600                                                                  05560057
055700 01  EL8-ERROR-LINE-8.                                            05570057
055800     05  FILLER                      PIC  X(12)     VALUE SPACES. 05580057
055900     05  FILLER                      PIC  X(25)     VALUE         05590057
056000         'INFOPAC (Y/N):           '.                             05600057
056100     05  EL8-INFOPAC                 PIC  X(01)     VALUE SPACES. 05610057
056200     05  FILLER                      PIC  X(94)     VALUE SPACES. 05620057
056300                                                                  05630057
056400 01  EL9-ERROR-LINE-9.                                            05640057
056500     05  FILLER                      PIC  X(12)     VALUE SPACES. 05650057
056600     05  FILLER                      PIC  X(25)     VALUE         05660057
056700         'REMOTE PRINTER ID:       '.                             05670057
056800     05  EL9-PRINTER-ID              PIC  X(08)     VALUE SPACES. 05680057
056900     05  FILLER                      PIC  X(86)     VALUE SPACES. 05690057
057000                                                                  05700057
057100                                                                  05710057
057200*-----------------------------------------------------------------05720057
057300* COPYBOOK WITH PRINTEK/CODE V PRINTER CODES                      05730041
057400*-----------------------------------------------------------------05740057
057500     COPY DSWS004.                                                05750041
057600                                                                  05760041
057700*---------------------------------------------------------------* 05770001
057800*  COPYBOOK FOR DB2 ERROR MESSAGE BUILDING                      * 05780001
057900*---------------------------------------------------------------* 05790001
058000     COPY DPWS004.                                                05800001
058100/                                                                 05810001
058200*    LOCATION MODULE                                                      
058300     COPY XLWS071.                                                        
058400/                                                                         
058500*---------------------------------------------------------------* 05820001
058600*    DB2 AREA FOR COMMUNICATIONS                                * 05830001
058700*---------------------------------------------------------------* 05840001
058800     EXEC SQL                                                     05850001
058900          INCLUDE SQLCA                                           05860001
059000     END-EXEC.                                                    05870001
059100                                                                  05880001
059200*---------------------------------------------------------------* 05960005
059300*    DB2 AREA FOR PROCESSING CONTROL PACK-TO0LIGHT MODULE TABLE * 05970034
059400*---------------------------------------------------------------* 05980005
059500     EXEC SQL                                                     05990005
059600          INCLUDE TP2LMOD                                         06000034
059700     END-EXEC.                                                    06010005
059800                                                                  06020005
059900*---------------------------------------------------------------* 06030001
060000*  COPYBOOK USED FOR INPUT FILE                                 * 06040001
060100*---------------------------------------------------------------* 06050001
060200     COPY PCRD004.                                                06060001
060300                                                                  06070001
060400*---------------------------------------------------------------* 06080001
060500*  COPYBOOK USED FOR OUTPUT REPORT (132 POS)                    * 06090001
060600*---------------------------------------------------------------* 06100001
060700     COPY DPWS132O.                                               06110001
060800                                                                  06120001
060900***************************************************************** 06130001
061000 PROCEDURE DIVISION.                                              06140001
061100*---------------------------------------------------------------* 06150001
061200*  THIS PARAGRAPH DRIVES THE PROGRAM.                           * 06160001
061300* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - * 06170001
061400* IF CONTROL CARD DOES NOT REQUEST THIS REPORT - END PROGRAM    * 06180001
061500* IMMEDIATELY - DO NOT EVEN CREATE HEADINGS.                    * 06190001
061600*---------------------------------------------------------------* 06200001
061700                                                                  06210001
061800     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN                 06220001
061900                                                                  06230001
062000     MOVE  CC-DC-NUMBER  TO  PV-HOLD-CC-DC-NUMBER.                06240011
062100                                                                  06250011
062200     IF  CC-REPORT-BY-P2L-MODULE OR CC-RPT-P2L-MODULE-SUMMRY      06260030
062300         PERFORM 1000-INITIALIZE.                                 06270057
062400                                                                  06280001
062500     IF  CC-TO-PRINTER                                            06290054
062600         MOVE +1 TO RETURN-CODE                                   06300054
062700     END-IF.                                                      06310054
062800                                                                  06320054
062900     GOBACK.                                                      06330001
063000                                                                  06340001
063100 1000-INITIALIZE.                                                 06350001
063200*---------------------------------------------------------------* 06360001
063300*  PROGRAM INITIALIZATION                                       * 06370001
063400*    -- OPEN INPUT AND OUTPUT FILES.                            * 06380001
063500*    -- ACCEPT DATE AND TIME FROM THE SYSTEM AND INITIALIZE     * 06390001
063600*       THE REPORT HEADINGS.                                    * 06400001
063700*---------------------------------------------------------------* 06410001
063800     OPEN  INPUT INPUT-FILE.                                      06420012
063900                                                                  06430012
064000     IF  CC-TO-INFOPAC                                            06440012
064100         OPEN OUTPUT REPORT-FILE-1                                06450012
064200     ELSE                                                         06460012
064300     IF  CC-TO-PRINTER                                            06470012
064400         OPEN OUTPUT REPORT-FILE-2.                               06480050
064500                                                                  06490001
064600     ACCEPT CD-CPU-DATE FROM DATE.                                06500001
064700     ACCEPT CT-CPU-TIME FROM TIME.                                06510001
064800                                                                  06520001
064900     PERFORM 7000-READ-INPUT-FILE.                                06530001
065000                                                                  06540001
065100     IF  PC004-ERROR-RECORD                                       06550057
065200         PERFORM 1010-PROCESS-ERROR                               06560057
065300     ELSE                                                         06570057
065400         PERFORM 1020-PROCESS-REPORT                              06580057
065500         PERFORM 1500-PROCESS-FILE                                06590057
065600     END-IF.                                                      06600057
065700                                                                  06610001
065800                                                                  06620057
065900 1010-PROCESS-ERROR.                                              06630057
066000                                                                  06640057
066100     PERFORM 1100-GET-DC-NAME.                                    06650057
066200     IF XL071-NO-ERRORS                                                   
066300         MOVE XL071-LOC-NM    TO PV-HOLD-DC-NAME                          
066400     ELSE                                                                 
066500         MOVE SPACES          TO PV-HOLD-DC-NAME                          
066600     END-IF                                                               
066700                                                                          
066800     PERFORM 1150-GET-DEFAULT-STORE-ZONE.                         06660057
066900     PERFORM 1200-INITIALIZE-HEADINGS.                            06670057
067000                                                                  06680057
067100*-----------------------------------------------------------------06690057
067200*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  06700057
067300*-----------------------------------------------------------------06710057
067400                                                                  06720057
067500     IF CC-PRTR-CNTL-IND = 'P'                                    06730057
067600        MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR      06740057
067700        MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI           06750057
067800                                                                  06760057
067900        WRITE REPORT-RECORD-2                                     06770057
068000         FROM DS004-PLC-LOAD-FORM                                 06780057
068100              AFTER ADVANCING 1 LINE                              06790057
068200     END-IF.                                                      06800057
068300                                                                  06810057
068400*-----------------------------------------------------------------06820057
068500                                                                  06830057
068600     IF  CC-REPORT-BY-P2L-MODULE                                  06840057
068700         PERFORM 6000-PRINT-RPT-HEADING                           06850057
068800     ELSE                                                         06860058
068900     IF  CC-RPT-P2L-MODULE-SUMMRY                                 06870058
069000         PERFORM 5700-SUMMARY-HEADING                             06880058
069100     END-IF.                                                      06890057
069200                                                                  06900057
069300     PERFORM 6900-PRINT-ERROR-INFO.                               06910057
069400     PERFORM 6600-PRINT-END-OF-REPORT.                            06920057
069500                                                                  06930057
069600                                                                  06940057
069700 1020-PROCESS-REPORT.                                             06950057
069800                                                                  06960051
069900     MOVE PC004-ORD-NBR          TO  PV-HOLD-PO-NMBR.             06970057
070000     MOVE PC004-REC-SEQ-NBR      TO  PV-HOLD-REC-SEQ-NBR.         06980057
070100     MOVE PC004-REC-DATE         TO  PV-HOLD-RECEIPT-DATE.        06990057
070200     MOVE PC004-STR-ZONE-ID      TO  PV-HOLD-STORE-ZONE.          07000057
070300     MOVE PC004-LNE-LOC-CDE      TO  PV-HOLD-LINE-LOC.            07010057
070400     MOVE PC004-VNDR-NME         TO  PV-HOLD-VENDOR-NAME.         07020057
070500     MOVE PC004-DEPT-NBR         TO  PV-HOLD-DEPT-NUMBER.         07030057
070600     MOVE PC004-SCAC-ID          TO  PV-HOLD-SCAC.                07040057
070700     MOVE PC004-VEH-NBR          TO  PV-HOLD-TRAILER.             07050057
070800     MOVE PC004-PRC-AREA-MODU-ID TO  PV-HOLD-P2L-MODULE.          07060057
070900     MOVE PC004-CURRENT-OPER     TO  PV-HOLD-CURRENT-OPER.        07070057
071000     MOVE PC004-CURRENT-FCLTY    TO  PV-HOLD-CURRENT-FCLTY.       07080057
071100                                                                  07090057
071200                                                                  07100057
071300     INITIALIZE SPT-SUMMARY-PAGE-TABLE.                           07110057
071400*LMM SET SPT-INDEX TO +0.                                         07120073
071500     SET SPT-INDEX TO PC-0.                                       07130072
071600                                                                  07140061
071700     PERFORM 1100-GET-DC-NAME.                                    07150061
071800     IF XL071-NO-ERRORS                                                   
071900         MOVE XL071-LOC-NM    TO PV-HOLD-DC-NAME                          
072000     ELSE                                                                 
072100         MOVE SPACES          TO PV-HOLD-DC-NAME                          
072200     END-IF                                                               
072300                                                                          
072400     PERFORM 1150-GET-DEFAULT-STORE-ZONE.                         07160061
072500     PERFORM 1200-INITIALIZE-HEADINGS.                            07170061
072600                                                                  07180061
072700*-----------------------------------------------------------------07190061
072800*    IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                  07200061
072900*-----------------------------------------------------------------07210061
073000                                                                  07220061
073100     IF CC-PRTR-CNTL-IND = 'P'                                    07230061
073200        MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR      07240061
073300        MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI           07250061
073400                                                                  07260061
073500        WRITE REPORT-RECORD-2                                     07270061
073600         FROM DS004-PLC-LOAD-FORM                                 07280061
073700              AFTER ADVANCING 1 LINE                              07290061
073800     END-IF.                                                      07300061
073900                                                                  07310061
074000*-----------------------------------------------------------------07320061
074100                                                                  07330061
074200     IF  CC-REPORT-BY-P2L-MODULE                                  07340061
074300         PERFORM 6000-PRINT-RPT-HEADING                           07350061
074400     END-IF.                                                      07360061
074500                                                                  07370057
074600                                                                  07380001
074700 1100-GET-DC-NAME.                                                07390001
074800                                                                          
074900     INITIALIZE XL071-COMMAREA-REC.                                       
075000     MOVE PV-HOLD-CC-DC-NUMBER TO XL071-LOCATION-NUMBER                   
075100                                                                          
075200     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC.                 
075300                                                                          
075400     EVALUATE TRUE                                                        
075500     WHEN XL071-NO-ERRORS                                                 
075600         MOVE XL071-LOC-NM    TO PV-HOLD-DC-NAME                          
075700     WHEN XL071-LOC-NOT-FOUND                                             
075800     WHEN XL071-DC-ASGMT-NOT-FND                                          
075900         MOVE SPACES           TO  PV-HOLD-DC-NAME                07550001
076000         MOVE 'UNKNOWN DC   '  TO  PV-HOLD-DC-NAME                07560001
076100     WHEN XL071-BAD-DB2-RETURN                                            
076200         MOVE XL071-SQLCA             TO SQLCA                            
076300         MOVE '1100-GET-DC-NAME'      TO PV-ABEND-PARAGRAPH               
076400         MOVE 'CALL XLKUT067 LOCATION MODULE'                             
076500                                      TO PV-ABEND-OPERATION               
076600         MOVE SQLCODE                 TO PV-SQLCODE                       
076700         MOVE XL071-DB2-TABLE         TO PV-ABEND-STRUCTURE-1             
076800         PERFORM 9900-DB2-ABEND                                           
076900     END-EVALUATE.                                                        
077000/                                                                         
077100 1150-GET-DEFAULT-STORE-ZONE.                                     07740005
077200*---------------------------------------------------------------* 07750003
077300* GET THE DEFAULT STORE ZONE FROM TP2LMOD -                     * 07760034
077400*      PC - PACK-TO-LIGHT MODULE TABLE                          * 07770034
077500*---------------------------------------------------------------* 07780003
077600                                                                  07790003
077700       MOVE PV-HOLD-P2L-MODULE-NUM  TO  PV-HOLD-P2L-MODULE-COMP.  07800038
077800                                                                  07810038
077900       EXEC SQL                                                   07820003
078000                SELECT   DFLT_STR_ZN_ID                           07830003
078100                  INTO  :P2LMOD-DFLT-STR-ZN-ID                    07840034
078200                  FROM   TP2LMOD                                  07850034
078300                 WHERE   OPER_UNT_ID  =  :PV-HOLD-CURRENT-OPER    07860035
078400                   AND   FCLTY_ID     =  :PV-HOLD-CURRENT-FCLTY   07870036
078500                   AND   MODU_NBR     =  :PV-HOLD-P2L-MODULE-COMP 07880038
078600       END-EXEC.                                                  07890034
078700                                                                  07900034
078800       EVALUATE TRUE                                              07910034
078900            WHEN SQLCODE = ZERO                                   07920034
079000                MOVE  P2LMOD-DFLT-STR-ZN-ID                       07930034
079100                  TO  PV-HOLD-DEFAULT-STORE-ZONE                  07940034
079200            WHEN SQLCODE = +100                                   07950034
079300                MOVE SPACES       TO  PV-HOLD-DEFAULT-STORE-ZONE  07960034
079400                MOVE '?????'      TO  PV-HOLD-DEFAULT-STORE-ZONE  07970034
079500            WHEN SQLCODE = -904                                   07980057
079600            WHEN SQLCODE = -911                                   07990057
079700            WHEN SQLCODE = -913                                   08000057
079800                MOVE SPACES       TO  PV-HOLD-DEFAULT-STORE-ZONE  08010057
079900            WHEN OTHER                                            08020034
080000                MOVE SQLCODE      TO  PV-SQLCODE                  08030034
080100                MOVE '1150-GET-DEFAULT-STORE-ZONE'                08040034
080200                                      TO  PV-ABEND-PARAGRAPH      08050034
080300                MOVE 'SELECT'         TO  PV-ABEND-OPERATION      08060034
080400                MOVE 'GET STORE ZN'   TO  PV-DB2-OPERATION-MSG-1  08070034
080500                MOVE 'FROM TP2LMOD TABLE  '                       08080034
080600                                      TO  PV-DB2-OPERATION-MSG-2  08090034
080700                MOVE 'TP2LMOD'        TO  PV-ABEND-STRUCTURE-1    08100034
080800                PERFORM 9900-DB2-ABEND                            08110034
080900        END-EVALUATE.                                             08120034
081000                                                                  08130034
081100                                                                  08140034
081200 1200-INITIALIZE-HEADINGS.                                        08150034
081300*---------------------------------------------------------------* 08160001
081400*  INITIALIZE REPORT HEADINGS                                   * 08170001
081500*---------------------------------------------------------------* 08180001
081600     MOVE CD-YEAR                TO DP132O-RUN-YEAR.              08190001
081700     MOVE CD-MONTH               TO DP132O-RUN-MONTH.             08200001
081800     MOVE CD-DAY                 TO DP132O-RUN-DAY.               08210001
081900     MOVE CT-HOUR                TO DP132O-RUN-HOUR.              08220001
082000     MOVE CT-MINUTE              TO DP132O-RUN-MINUTE.            08230001
082100     MOVE 'PCKRP010'             TO DP132O-PROGRAM-NAME.          08240001
082200     MOVE PC-1                   TO DP132O-REPORT-NUMBER.         08250001
082300     MOVE CC-USER-ID             TO HL1-USER-ID.                  08260001
082400     MOVE CC-DC-NUMBER           TO HL2-DC-NUMBER.                08270001
082500     MOVE XL071-LOC-NM           TO HL2-DC-NAME.                          
082600     MOVE PV-HOLD-P2L-MODULE     TO HL3-P2L-MODULE.               08290003
082700     MOVE PV-HOLD-DEFAULT-STORE-ZONE                              08300003
082800                                 TO HL3-DEFAULT-STORE-ZONE.       08310003
082900                                                                  08320001
083000                                                                  08330001
083100 1500-PROCESS-FILE.                                               08340001
083200     IF  PS-INPUT-EOF                                             08350001
083300         PERFORM 6800-NO-REPORT-DETAIL                            08360001
083400         SET PS-NO-DETAIL  TO  TRUE                               08370001
083500     ELSE                                                         08380001
083600         PERFORM 2000-MAIN-PROCESS                                08390001
083700           UNTIL  PS-INPUT-EOF.                                   08400001
083800                                                                  08410001
083900     IF  PS-NO-DETAIL                                             08420001
084000         NEXT SENTENCE                                            08430001
084100     ELSE                                                         08440001
084200         IF CC-RPT-P2L-MODULE-SUMMRY                              08450049
084300             PERFORM 4200-P2L-TOTALS                              08460003
084400             PERFORM 5500-PRINT-SUMMARY-PAGE                      08470001
084500         ELSE                                                     08480049
084600             PERFORM 4000-PURCH-ORD-TOTALS                        08490001
084700             PERFORM 4100-DATE-TOTALS                             08500001
084800             PERFORM 4200-P2L-TOTALS                              08510003
084900             SET PS-EOF-DC-TOTAL TO TRUE                          08520043
085000             PERFORM 4300-DC-TOTALS                               08530001
085100             PERFORM 5500-PRINT-SUMMARY-PAGE                      08540001
085200             PERFORM 6600-PRINT-END-OF-REPORT                     08550041
085300         END-IF                                                   08560049
085400     END-IF.                                                      08570049
085500                                                                  08580001
085600     PERFORM 9000-END-PROCESS.                                    08590001
085700                                                                  08600001
085800                                                                  08610001
085900 2000-MAIN-PROCESS.                                               08620001
086000                                                                  08630001
086100      ADD  1  TO  PV-RECORD-COUNT.                                08640001
086200                                                                  08650001
086300*---------------------------------------------------------------* 08660001
086400*  IF NEW P2L-MODULE - PRINT PO/DATE/P2L MODULE TOTALS          * 08670003
086500*---------------------------------------------------------------* 08680001
086600     IF  PC004-PRC-AREA-MODU-ID  =  PV-HOLD-P2L-MODULE            08690003
086700         CONTINUE                                                 08700001
086800     ELSE                                                         08710001
086900         PERFORM 4000-PURCH-ORD-TOTALS                            08720001
087000         PERFORM 4100-DATE-TOTALS                                 08730001
087100         PERFORM 4200-P2L-TOTALS                                  08740003
087200             MOVE PC004-ORD-NBR      TO  PV-HOLD-PO-NMBR          08750001
087300             MOVE PC004-REC-SEQ-NBR  TO  PV-HOLD-REC-SEQ-NBR      08760001
087400             MOVE PC004-REC-DATE     TO  PV-HOLD-RECEIPT-DATE     08770001
087500             MOVE PC004-STR-ZONE-ID  TO  PV-HOLD-STORE-ZONE       08780001
087600             MOVE PC004-LNE-LOC-CDE  TO  PV-HOLD-LINE-LOC         08790001
087700             MOVE PC004-VNDR-NME     TO  PV-HOLD-VENDOR-NAME      08800001
087800             MOVE PC004-DEPT-NBR     TO  PV-HOLD-DEPT-NUMBER      08810001
087900             MOVE PC004-SCAC-ID      TO  PV-HOLD-SCAC             08820001
088000             MOVE PC004-VEH-NBR      TO  PV-HOLD-TRAILER          08830003
088100             MOVE PC004-PRC-AREA-MODU-ID TO  PV-HOLD-P2L-MODULE   08840004
088200             MOVE PC004-CURRENT-OPER TO  PV-HOLD-CURRENT-OPER     08850035
088300             MOVE PC004-CURRENT-FCLTY TO  PV-HOLD-CURRENT-FCLTY   08860035
088400         PERFORM 1150-GET-DEFAULT-STORE-ZONE                      08870004
088500         MOVE PV-HOLD-DEFAULT-STORE-ZONE                          08880004
088600                                 TO HL3-DEFAULT-STORE-ZONE        08890004
088700         MOVE PV-HOLD-P2L-MODULE     TO HL3-P2L-MODULE            08900018
088800         IF  CC-REPORT-BY-P2L-MODULE                              08910049
088900             PERFORM 6000-PRINT-RPT-HEADING                       08920019
089000         END-IF                                                   08930049
089100             MOVE SPACES             TO  PV-PREV-STORE-ZONE       08940019
089200                                         PV-PREV-VENDOR-NAME      08950019
089300                                         PV-PREV-DEPT-NUMBER      08960019
089400                                         PV-PREV-SCAC             08970019
089500                                         PV-PREV-TRAILER          08980021
089600                                         PV-PREV-REC-SEQ-NBR      08990021
089700                                         PV-PREV-RECEIPT-DATE     09000031
089800             MOVE ZEROES             TO  PV-PREV-PO-NMBR          09010031
089900     END-IF.                                                      09020049
090000                                                                  09030001
090100*---------------------------------------------------------------* 09040001
090200*  IF NEW RECEIPT DATE - PRINT PO/DATE TOTALS                   * 09050001
090300*---------------------------------------------------------------* 09060001
090400     IF  PC004-REC-DATE  =  PV-HOLD-RECEIPT-DATE                  09070001
090500         CONTINUE                                                 09080001
090600     ELSE                                                         09090001
090700         PERFORM 4000-PURCH-ORD-TOTALS                            09100001
090800         PERFORM 4100-DATE-TOTALS                                 09110001
090900             MOVE PC004-ORD-NBR      TO  PV-HOLD-PO-NMBR          09120001
091000             MOVE PC004-REC-SEQ-NBR  TO  PV-HOLD-REC-SEQ-NBR      09130001
091100             MOVE PC004-REC-DATE     TO  PV-HOLD-RECEIPT-DATE     09140001
091200             MOVE PC004-LNE-LOC-CDE  TO  PV-HOLD-LINE-LOC         09150001
091300             MOVE PC004-VNDR-NME     TO  PV-HOLD-VENDOR-NAME      09160001
091400             MOVE PC004-DEPT-NBR     TO  PV-HOLD-DEPT-NUMBER      09170001
091500             MOVE PC004-SCAC-ID      TO  PV-HOLD-SCAC             09180001
091600             MOVE PC004-VEH-NBR      TO  PV-HOLD-TRAILER          09190019
091700             MOVE PC004-CURRENT-OPER TO  PV-HOLD-CURRENT-OPER     09200035
091800             MOVE PC004-CURRENT-FCLTY TO  PV-HOLD-CURRENT-FCLTY   09210035
091900             MOVE SPACES             TO  PV-PREV-STORE-ZONE       09220019
092000                                         PV-PREV-VENDOR-NAME      09230019
092100                                         PV-PREV-DEPT-NUMBER      09240019
092200                                         PV-PREV-SCAC             09250019
092300                                         PV-PREV-TRAILER          09260021
092400                                         PV-PREV-REC-SEQ-NBR      09270021
092500                                         PV-PREV-RECEIPT-DATE     09280031
092600             MOVE ZEROES             TO  PV-PREV-PO-NMBR.         09290021
092700                                                                  09300001
092800*---------------------------------------------------------------* 09310001
092900*  IF NEW PO NUMBER OR NEW SEQUENCE NUMBER - PRINT PO TOTALS    * 09320001
093000*---------------------------------------------------------------* 09330001
093100     IF  PC004-ORD-NBR      =  PV-HOLD-PO-NMBR  AND               09340001
093200         PC004-REC-SEQ-NBR  =  PV-HOLD-REC-SEQ-NBR                09350001
093300         CONTINUE                                                 09360001
093400     ELSE                                                         09370001
093500         PERFORM 4000-PURCH-ORD-TOTALS                            09380001
093600             MOVE PC004-ORD-NBR      TO  PV-HOLD-PO-NMBR          09390001
093700             MOVE PC004-REC-SEQ-NBR  TO  PV-HOLD-REC-SEQ-NBR      09400001
093800             MOVE PC004-LNE-LOC-CDE  TO  PV-HOLD-LINE-LOC         09410001
093900             MOVE PC004-VNDR-NME     TO  PV-HOLD-VENDOR-NAME      09420001
094000             MOVE PC004-DEPT-NBR     TO  PV-HOLD-DEPT-NUMBER      09430001
094100             MOVE PC004-SCAC-ID      TO  PV-HOLD-SCAC             09440001
094200             MOVE PC004-VEH-NBR      TO  PV-HOLD-TRAILER          09450016
094300             MOVE PC004-CURRENT-OPER TO  PV-HOLD-CURRENT-OPER     09460035
094400             MOVE PC004-CURRENT-FCLTY TO  PV-HOLD-CURRENT-FCLTY   09470035
094500             MOVE SPACES             TO  PV-PREV-STORE-ZONE       09480016
094600                                         PV-PREV-VENDOR-NAME      09490016
094700                                         PV-PREV-DEPT-NUMBER      09500016
094800                                         PV-PREV-SCAC             09510016
094900                                         PV-PREV-TRAILER          09520021
095000                                         PV-PREV-REC-SEQ-NBR      09530021
095100             MOVE ZEROES             TO  PV-PREV-PO-NMBR.         09540021
095200*----------------------------------------------------------------*09550001
095300* ACCUMULATE PURCHASE ORDER INFORMATION.                         *09560001
095400*       -P2L MODULE, RECEIPT DATE, PURCHASE ORDER LEVEL          *09570003
095500*            -NUMBER OF CARTONS (P2L/DATE/PO)                    *09580003
095600*            -NUMBER OF UNITS   (P2L/DATA/PO)                    *09590003
095700*       -SUMMARY - BY P2L MODULE                                 *09600003
095800*            -NUMBER OF PO/RECEIVER LINES (ARRIVED/ENROUTE/TOTAL)*09610001
095900*            -NUMBER OF CARTONS & UNITS (ARRIVED)                *09620001
096000*            -NUMBER OF CARTONS & UNITS (ENROUTE)                *09630001
096100*            -NUMBER OF CARTONS & UNITS (TOTAL)                  *09640001
096200*       -FINAL TOTAL - BY DC                                     *09650001
096300*            -NUMBER OF PO/RECEIVER LINES (ARRIVED/ENROUTE/TOTAL)*09660001
096400*            -NUMBER OF CARTONS & UNITS (ARRIVED)                *09670001
096500*            -NUMBER OF CARTONS & UNITS (ENROUTE)                *09680001
096600*            -NUMBER OF CARTONS & UNITS (TOTAL)                  *09690001
096700*----------------------------------------------------------------*09700001
096800                                                                  09710001
096900     ADD  PC004-P2L-CART-CNT     TO  PV-PO-RECEIVERS-CRTNS.       09720001
097000     ADD  PC004-P2L-UNIT-QTY     TO  PV-PO-RECEIVERS-UNITS.       09730001
097100     ADD  PC004-P2L-CART-CNT     TO  PV-DATE-CRTNS.               09740001
097200     ADD  PC004-P2L-UNIT-QTY     TO  PV-DATE-UNITS.               09750001
097300     ADD  PC004-P2L-CART-CNT     TO  PV-P2L-CRTNS.                09760003
097400     ADD  PC004-P2L-UNIT-QTY     TO  PV-P2L-UNITS.                09770003
097500     ADD  PC004-P2L-CART-CNT     TO  PV-DC-CRTNS.                 09780001
097600     ADD  PC004-P2L-UNIT-QTY     TO  PV-DC-UNITS.                 09790001
097700                                                                  09800001
097800     ADD  PC004-P2L-CART-CNT     TO  PV-P2L-TOTAL-CRTNS           09810003
097900     ADD  PC004-P2L-UNIT-QTY     TO  PV-P2L-TOTAL-UNITS           09820003
098000     ADD  1                      TO  PV-P2L-TOTAL-LINES           09830003
098100     ADD  PC004-P2L-CART-CNT     TO  PV-FINAL-TOTAL-CRTNS         09840001
098200     ADD  PC004-P2L-UNIT-QTY     TO  PV-FINAL-TOTAL-UNITS         09850001
098300     ADD  1                      TO  PV-FINAL-TOTAL-LINES         09860001
098400                                                                  09870001
098500     IF  TRAILER-ENROUTE                                          09880001
098600         ADD  PC004-P2L-CART-CNT TO  PV-P2L-ENROUTE-CRTNS         09890003
098700         ADD  PC004-P2L-UNIT-QTY TO  PV-P2L-ENROUTE-UNITS         09900003
098800         ADD  1                  TO  PV-P2L-ENROUTE-LINES         09910003
098900         ADD  PC004-P2L-CART-CNT TO  PV-FINAL-ENROUTE-CRTNS       09920001
099000         ADD  PC004-P2L-UNIT-QTY TO  PV-FINAL-ENROUTE-UNITS       09930001
099100         ADD  1                  TO  PV-FINAL-ENROUTE-LINES       09940001
099200     ELSE                                                         09950001
099300         ADD  PC004-P2L-CART-CNT TO  PV-P2L-ARRIVED-CRTNS         09960003
099400         ADD  PC004-P2L-UNIT-QTY TO  PV-P2L-ARRIVED-UNITS         09970003
099500         ADD  1                  TO  PV-P2L-ARRIVED-LINES         09980003
099600         ADD  PC004-P2L-CART-CNT TO  PV-FINAL-ARRIVED-CRTNS       09990001
099700         ADD  PC004-P2L-UNIT-QTY TO  PV-FINAL-ARRIVED-UNITS       10000001
099800         ADD  1                  TO  PV-FINAL-ARRIVED-LINES.      10010001
099900                                                                  10020001
100000     MOVE PC004-PRC-AREA-MODU-ID TO  PV-HOLD-P2L-MODULE.          10030003
100100     MOVE PC004-ORD-NBR          TO  PV-HOLD-PO-NMBR.             10040001
100200     MOVE PC004-REC-SEQ-NBR      TO  PV-HOLD-REC-SEQ-NBR.         10050001
100300     MOVE PC004-REC-DATE         TO  PV-HOLD-RECEIPT-DATE.        10060001
100400     MOVE PC004-STR-ZONE-ID      TO  PV-HOLD-STORE-ZONE.          10070001
100500     MOVE PC004-LNE-LOC-CDE      TO  PV-HOLD-LINE-LOC.            10080001
100600     MOVE PC004-VNDR-NME         TO  PV-HOLD-VENDOR-NAME.         10090001
100700     MOVE PC004-DEPT-NBR         TO  PV-HOLD-DEPT-NUMBER.         10100001
100800     MOVE PC004-SCAC-ID          TO  PV-HOLD-SCAC.                10110001
100900     MOVE PC004-VEH-NBR          TO  PV-HOLD-TRAILER.             10120001
101000     MOVE PC004-CURRENT-OPER     TO  PV-HOLD-CURRENT-OPER.        10130035
101100     MOVE PC004-CURRENT-FCLTY    TO  PV-HOLD-CURRENT-FCLTY.       10140035
101200                                                                  10150064
101300     PERFORM 3000-DETAIL-LINE.                                    10160003
101400                                                                  10170001
101500     PERFORM 7000-READ-INPUT-FILE.                                10180001
101600                                                                  10190001
101700                                                                  10200001
101800 3000-DETAIL-LINE.                                                10210003
101900*---------------------------------------------------------------* 10220003
102000*  CREATE DETAIL PRINT LINE                                     * 10230003
102100*---------------------------------------------------------------* 10240003
102200     INITIALIZE  DL1-DETAIL-LINE-1.                               10250003
102300                                                                  10260003
102400         IF  TRAILER-ENROUTE                                      10270003
102500             MOVE 'ENROUTE   '         TO PV-HOLD-RECEIPT         10280003
102600         ELSE                                                     10290003
102700             MOVE PV-HOLD-RECEIPT-DATE TO PV-HOLD-RECEIPT.        10300003
102800                                                                  10310003
102900         IF  PV-HOLD-RECEIPT-DATE  =   PV-PREV-RECEIPT-DATE       10320003
103000             MOVE  SPACES              TO DL1-RECEIPT-DATE        10330003
103100         ELSE                                                     10340003
103200             MOVE PV-HOLD-RECEIPT      TO DL1-RECEIPT-DATE        10350003
103300             MOVE PV-HOLD-RECEIPT-DATE TO PV-PREV-RECEIPT-DATE.   10360003
103400                                                                  10370003
103500         IF  PV-HOLD-PO-NMBR       =   PV-PREV-PO-NMBR  AND       10380003
103600             PV-HOLD-REC-SEQ-NBR   =   PV-PREV-REC-SEQ-NBR        10390003
103700             MOVE  SPACES              TO DL1-PO-NUMBER           10400003
103800             MOVE  SPACES              TO DL1-PO-DASH             10410016
103900             MOVE  SPACES              TO DL1-PO-SEQ-NBR          10420016
104000         ELSE                                                     10430016
104100             MOVE PV-HOLD-PO-NMBR      TO DL1-PO-NUMBER           10440016
104200             MOVE  '-'                 TO DL1-PO-DASH             10450016
104300             MOVE PV-HOLD-REC-SEQ-NBR  TO DL1-PO-SEQ-NBR          10460016
104400             MOVE PV-HOLD-PO-NMBR      TO PV-PREV-PO-NMBR         10470016
104500             MOVE PV-HOLD-REC-SEQ-NBR  TO PV-PREV-REC-SEQ-NBR.    10480016
104600                                                                  10490016
104700         IF  PV-HOLD-STORE-ZONE  =     PV-PREV-STORE-ZONE         10500016
104800             MOVE  SPACES              TO DL1-STORE-ZONE          10510016
104900         ELSE                                                     10520016
105000             MOVE PV-HOLD-STORE-ZONE   TO DL1-STORE-ZONE          10530016
105100             MOVE PV-HOLD-STORE-ZONE   TO PV-PREV-STORE-ZONE.     10540016
105200                                                                  10550016
105300         IF  PV-HOLD-VENDOR-NAME =     PV-PREV-VENDOR-NAME        10560016
105400             MOVE  SPACES              TO DL1-VENDOR-NAME         10570016
105500         ELSE                                                     10580016
105600             MOVE PV-HOLD-VENDOR-NAME  TO DL1-VENDOR-NAME         10590016
105700             MOVE PV-HOLD-VENDOR-NAME  TO PV-PREV-VENDOR-NAME.    10600016
105800                                                                  10610016
105900         IF  PV-HOLD-DEPT-NUMBER =     PV-PREV-DEPT-NUMBER        10620016
106000             MOVE  ZEROES              TO DL1-DEPT-NBR            10630029
106100         ELSE                                                     10640016
106200             MOVE PV-HOLD-DEPT-NUMBER  TO DL1-DEPT-NBR            10650016
106300             MOVE PV-HOLD-DEPT-NUMBER  TO PV-PREV-DEPT-NUMBER.    10660016
106400                                                                  10670016
106500         IF  PV-HOLD-SCAC        =     PV-PREV-SCAC               10680016
106600             MOVE  SPACES              TO DL1-SCAC                10690016
106700             MOVE  SPACES              TO DL1-SCAC-DASH           10700016
106800         ELSE                                                     10710016
106900             MOVE PV-HOLD-SCAC         TO DL1-SCAC                10720016
107000             MOVE ' - '                TO DL1-SCAC-DASH           10730017
107100             MOVE PV-HOLD-SCAC         TO PV-PREV-SCAC.           10740016
107200                                                                  10750016
107300         IF  PV-HOLD-TRAILER     =     PV-PREV-TRAILER            10760016
107400             MOVE  SPACES              TO DL1-TRAILER             10770016
107500         ELSE                                                     10780016
107600             MOVE PV-HOLD-TRAILER      TO DL1-TRAILER             10790016
107700             MOVE PV-HOLD-TRAILER      TO PV-PREV-TRAILER.        10800016
107800                                                                  10810016
107900         MOVE  PC004-ORD-LNE-NBR       TO DL1-LINE-NUMBER.        10820016
108000         MOVE  PC004-LNE-LOC-CDE       TO DL1-LINE-LOC.           10830016
108100         MOVE  PC004-P2L-CART-CNT      TO DL1-CARTONS.            10840016
108200         MOVE  PC004-P2L-UNIT-QTY      TO DL1-UNITS.              10850016
108300                                                                  10860016
108400         IF  PC004-LNE-STATUS-READY                               10870016
108500             MOVE  PC-DESC-STATUS-READY                           10880016
108600                                       TO DL1-LINE-STATUS         10890016
108700         ELSE                                                     10900016
108800         IF  PC004-LNE-STATUS-LAUNCHED                            10910016
108900             MOVE  PC-DESC-STATUS-LAUNCHED                        10920016
109000                                       TO DL1-LINE-STATUS.        10930016
109100                                                                  10940016
109200     IF  CC-REPORT-BY-P2L-MODULE                                  10950049
109300         PERFORM 6100-PRINT-DETAIL-LINE                           10960016
109400     END-IF.                                                      10970049
109500                                                                  10980016
109600                                                                  10990016
109700 4000-PURCH-ORD-TOTALS.                                           11000001
109800*---------------------------------------------------------------* 11010001
109900*  PRINT PURCHASE ORDER TOTALS                                  * 11020001
110000*---------------------------------------------------------------* 11030001
110100                                                                  11040001
110200         MOVE  PC-DESCRIPTION-1      TO TL1-TOT-DESCRIPTION.      11050004
110300         MOVE  PV-PO-RECEIVERS-CRTNS TO TL1-TOT-CARTONS.          11060004
110400         MOVE  PV-PO-RECEIVERS-UNITS TO TL1-TOT-UNITS.            11070004
110500                                                                  11080004
110600     IF  CC-REPORT-BY-P2L-MODULE                                  11090049
110700         PERFORM 6400-PRINT-TOTALS                                11100004
110800     END-IF.                                                      11110049
110900                                                                  11120004
111000         MOVE  ZEROES                TO PV-PO-RECEIVERS-CRTNS     11130004
111100                                        PV-PO-RECEIVERS-UNITS.    11140004
111200                                                                  11150004
111300                                                                  11160001
111400 4100-DATE-TOTALS.                                                11170020
111500*---------------------------------------------------------------* 11180001
111600*  PRINT DATE TOTALS                                            * 11190001
111700*---------------------------------------------------------------* 11200001
111800                                                                  11210001
111900         MOVE  PC-DESCRIPTION-2      TO TL1-TOT-DESCRIPTION.      11220003
112000         MOVE  PV-DATE-CRTNS         TO TL1-TOT-CARTONS.          11230001
112100         MOVE  PV-DATE-UNITS         TO TL1-TOT-UNITS.            11240001
112200                                                                  11250001
112300     IF  CC-REPORT-BY-P2L-MODULE                                  11260049
112400         PERFORM 6450-PRINT-TOTALS                                11270019
112500     END-IF.                                                      11280049
112600                                                                  11290001
112700         MOVE  ZEROES                TO PV-DATE-CRTNS             11300001
112800                                        PV-DATE-UNITS.            11310001
112900                                                                  11320001
113000                                                                  11330001
113100 4200-P2L-TOTALS.                                                 11340003
113200*---------------------------------------------------------------* 11350001
113300*  PRINT P2L MODULE TOTALS                                      * 11360003
113400*---------------------------------------------------------------* 11370001
113500                                                                  11380001
113600         MOVE  PC-DESCRIPTION-3      TO TL1-TOT-DESCRIPTION.      11390003
113700         MOVE  PV-P2L-CRTNS          TO TL1-TOT-CARTONS.          11400003
113800         MOVE  PV-P2L-UNITS          TO TL1-TOT-UNITS.            11410003
113900                                                                  11420001
114000     IF  CC-REPORT-BY-P2L-MODULE                                  11430049
114100         PERFORM 6450-PRINT-TOTALS                                11440001
114200     END-IF.                                                      11450049
114300                                                                  11460001
114400         PERFORM 5000-BUILD-SUMMARY-TABLE.                        11470001
114500                                                                  11480001
114600         MOVE  ZEROES                TO PV-P2L-CRTNS              11490003
114700                                        PV-P2L-UNITS              11500003
114800                                        PV-P2L-ARRIVED-LINES      11510003
114900                                        PV-P2L-ENROUTE-LINES      11520003
115000                                        PV-P2L-TOTAL-LINES        11530003
115100                                        PV-P2L-ARRIVED-CRTNS      11540003
115200                                        PV-P2L-ARRIVED-UNITS      11550003
115300                                        PV-P2L-ENROUTE-CRTNS      11560003
115400                                        PV-P2L-ENROUTE-UNITS      11570003
115500                                        PV-P2L-TOTAL-CRTNS        11580003
115600                                        PV-P2L-TOTAL-UNITS.       11590003
115700                                                                  11600001
115800                                                                  11610001
115900                                                                  11620001
116000 4300-DC-TOTALS.                                                  11630001
116100*---------------------------------------------------------------* 11640001
116200*  PRINT DC TOTALS                                              * 11650001
116300*---------------------------------------------------------------* 11660001
116400                                                                  11670001
116500         MOVE  PC-DESCRIPTION-4      TO TL1-TOT-DESCRIPTION.      11680018
116600         MOVE  PV-DC-CRTNS           TO TL1-TOT-CARTONS.          11690001
116700         MOVE  PV-DC-UNITS           TO TL1-TOT-UNITS.            11700001
116800                                                                  11710001
116900     IF  CC-REPORT-BY-P2L-MODULE                                  11720049
117000         PERFORM 6450-PRINT-TOTALS                                11730001
117100     END-IF                                                       11740049
117200                                                                  11750001
117300         MOVE  ZEROES                TO PV-DC-CRTNS               11760001
117400                                        PV-DC-UNITS.              11770001
117500                                                                  11780001
117600                                                                  11790001
117700 5000-BUILD-SUMMARY-TABLE.                                        11800001
117800*---------------------------------------------------------------* 11810001
117900*  BUILD SUMMARY TABLE ENTRY                                    * 11820001
118000*---------------------------------------------------------------* 11830001
118100                                                                  11840001
118200     SET SPT-INDEX UP BY +1.                                      11850001
118300                                                                  11860001
118400     IF  SPT-INDEX GREATER THAN PC-TABLE-MAX                      11870001
118500         MOVE '5000-BUILD-SUMMARY-TABLE'  TO  PV-PARAGRAPH-NAME   11880001
118600         SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX               11890001
118700         MOVE 'SUMMARY TABLE EXCEEDS MAXIMUM TABLE ENTRIES OF 150'11900001
118800                         TO PV-ERROR-MESSAGE-1                    11910001
118900         MOVE 'MAXIMUM TABLE SIZE NEEDS TO BE INCREASED'          11920001
119000                         TO PV-ERROR-MESSAGE-2                    11930001
119100         PERFORM 9200-ABEND.                                      11940001
119200                                                                  11950001
119300     MOVE PV-HOLD-P2L-MODULE     TO  SPT-P2L-MODULE(SPT-INDEX).   11960003
119400     MOVE PV-P2L-ARRIVED-LINES   TO  SPT-ARRIVED-LINES(SPT-INDEX).11970005
119500     MOVE PV-P2L-ENROUTE-LINES   TO  SPT-ENROUTE-LINES(SPT-INDEX).11980005
119600     MOVE PV-P2L-TOTAL-LINES     TO  SPT-TOTAL-LINES(SPT-INDEX).  11990005
119700     MOVE PV-P2L-ARRIVED-CRTNS   TO  SPT-ARRIVED-CRTNS(SPT-INDEX).12000005
119800     MOVE PV-P2L-ARRIVED-UNITS   TO  SPT-ARRIVED-UNITS(SPT-INDEX).12010005
119900     MOVE PV-P2L-ENROUTE-CRTNS   TO  SPT-ENROUTE-CRTNS(SPT-INDEX).12020005
120000     MOVE PV-P2L-ENROUTE-UNITS   TO  SPT-ENROUTE-UNITS(SPT-INDEX).12030005
120100     MOVE PV-P2L-TOTAL-CRTNS     TO  SPT-TOTAL-CRTNS(SPT-INDEX).  12040005
120200     MOVE PV-P2L-TOTAL-UNITS     TO  SPT-TOTAL-UNITS(SPT-INDEX).  12050005
120300                                                                  12060001
120400                                                                  12070001
120500 5500-PRINT-SUMMARY-PAGE.                                         12080001
120600*---------------------------------------------------------------* 12090001
120700*  PRINT SUMMARY PAGE FROM TABLE                                * 12100001
120800*---------------------------------------------------------------* 12110001
120900                                                                  12120001
121000     PERFORM 5700-SUMMARY-HEADING.                                12130001
121100                                                                  12140001
121200     SET PC-ACTUAL-TABLE-ENTRIES  TO  SPT-INDEX                   12150001
121300                                                                  12160001
121400     PERFORM 5600-SUMMARY-DETAIL                                  12170001
121500             VARYING SPT-INDEX FROM 1 BY 1                        12180001
121600             UNTIL SUMMARY-TABLE-EOF.                             12190001
121700                                                                  12200001
121800     INITIALIZE SL2-SUMMARY-LINE-2.                               12210001
121900                                                                  12220001
122000     MOVE PC-DESCRIPTION-5           TO SL2-TOTAL-DESCRIPTION.    12230002
122100     MOVE PV-FINAL-ARRIVED-LINES     TO SL2-PO-RCVR-LINES-ARRIVED.12240001
122200     MOVE PV-FINAL-ENROUTE-LINES     TO SL2-PO-RCVR-LINES-ENROUTE.12250001
122300     MOVE PV-FINAL-TOTAL-LINES       TO SL2-PO-RCVR-LINES-TOTAL.  12260001
122400     MOVE PV-FINAL-ARRIVED-CRTNS     TO SL2-TO-P2L-ARRIVED-CTNS.  12270001
122500     MOVE PV-FINAL-ARRIVED-UNITS     TO SL2-TO-P2L-ARRIVED-UNITS. 12280001
122600     MOVE PV-FINAL-ENROUTE-CRTNS     TO SL2-TO-P2L-ENROUTE-CTNS.  12290001
122700     MOVE PV-FINAL-ENROUTE-UNITS     TO SL2-TO-P2L-ENROUTE-UNITS. 12300001
122800     MOVE PV-FINAL-TOTAL-CRTNS       TO SL2-TO-P2L-TOTAL-CTNS.    12310001
122900     MOVE PV-FINAL-TOTAL-UNITS       TO SL2-TO-P2L-TOTAL-UNITS.   12320001
123000                                                                  12330001
123100     PERFORM 5900-PRINT-SUMMARY-FINAL.                            12340001
123200                                                                  12350001
123300                                                                  12360001
123400 5600-SUMMARY-DETAIL.                                             12370001
123500                                                                  12380001
123600     INITIALIZE SL1-SUMMARY-LINE-1.                               12390001
123700                                                                  12400001
123800     MOVE SPT-P2L-MODULE(SPT-INDEX)  TO SL1-P2L-MODULE.           12410003
123900     MOVE SPT-ARRIVED-LINES(SPT-INDEX)                            12420001
124000                                     TO SL1-PO-RCVR-LINES-ARRIVED.12430001
124100     MOVE SPT-ENROUTE-LINES(SPT-INDEX)                            12440001
124200                                     TO SL1-PO-RCVR-LINES-ENROUTE.12450001
124300     MOVE SPT-TOTAL-LINES(SPT-INDEX)                              12460001
124400                                     TO SL1-PO-RCVR-LINES-TOTAL.  12470001
124500     MOVE SPT-ARRIVED-CRTNS(SPT-INDEX)                            12480001
124600                                     TO SL1-TO-P2L-ARRIVED-CTNS.  12490001
124700     MOVE SPT-ARRIVED-UNITS(SPT-INDEX)                            12500001
124800                                     TO SL1-TO-P2L-ARRIVED-UNITS. 12510001
124900     MOVE SPT-ENROUTE-CRTNS(SPT-INDEX)                            12520001
125000                                     TO SL1-TO-P2L-ENROUTE-CTNS.  12530001
125100     MOVE SPT-ENROUTE-UNITS(SPT-INDEX)                            12540001
125200                                     TO SL1-TO-P2L-ENROUTE-UNITS. 12550001
125300     MOVE SPT-TOTAL-CRTNS(SPT-INDEX)                              12560001
125400                                     TO SL1-TO-P2L-TOTAL-CTNS.    12570001
125500     MOVE SPT-TOTAL-UNITS(SPT-INDEX)                              12580001
125600                                     TO SL1-TO-P2L-TOTAL-UNITS.   12590001
125700        PERFORM 5800-PRINT-SUMMARY-DETAIL                         12600069
125800                                                                  12610069
125900     IF SPT-INDEX  =  PC-ACTUAL-TABLE-ENTRIES                     12620001
126000        SET SUMMARY-TABLE-EOF TO TRUE.                            12630001
126100                                                                  12640001
126200                                                                  12650001
126300 5700-SUMMARY-HEADING.                                            12660001
126400*---------------------------------------------------------------* 12670001
126500*  SUMMARY HEADING ROUTINE.                                     * 12680001
126600*---------------------------------------------------------------* 12690001
126700     ADD 1                       TO PV-PAGE-COUNT.                12700001
126800     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           12710001
126900                                                                  12720001
127000     MOVE 12                     TO PV-LINE-COUNT.                12730001
127100                                                                  12740012
127200     IF  CC-TO-INFOPAC                                            12750012
127300         WRITE REPORT-RECORD-1                                    12760012
127400           FROM DP132O-STANDRD-HEADER-132-COLS                    12770012
127500             AFTER ADVANCING PAGE                                 12780012
127600     ELSE                                                         12790012
127700         WRITE REPORT-RECORD-2                                    12800012
127800           FROM DP132O-STANDRD-HEADER-132-COLS                    12810012
127900             AFTER ADVANCING PAGE.                                12820012
128000                                                                  12830001
128100     IF  CC-TO-INFOPAC                                            12840012
128200         WRITE REPORT-RECORD-1                                    12850012
128300           FROM HL1-HEADING-LINE-1                                12860012
128400             AFTER ADVANCING 2 LINES                              12870012
128500     ELSE                                                         12880012
128600         WRITE REPORT-RECORD-2                                    12890012
128700           FROM HL1-HEADING-LINE-1                                12900012
128800             AFTER ADVANCING 2 LINES.                             12910012
128900                                                                  12920001
129000     IF  CC-TO-INFOPAC                                            12930012
129100         WRITE REPORT-RECORD-1                                    12940012
129200           FROM HL2-HEADING-LINE-2                                12950012
129300             AFTER ADVANCING 2 LINES                              12960012
129400     ELSE                                                         12970012
129500         WRITE REPORT-RECORD-2                                    12980012
129600           FROM HL2-HEADING-LINE-2                                12990012
129700             AFTER ADVANCING 2 LINES.                             13000012
129800                                                                  13010001
129900     IF  CC-TO-INFOPAC                                            13020012
130000         WRITE REPORT-RECORD-1                                    13030012
130100           FROM HSL2-HEADING-SUMMARY-LINE-2                       13040043
130200             AFTER ADVANCING 1 LINES                              13050043
130300     ELSE                                                         13060012
130400         WRITE REPORT-RECORD-2                                    13070012
130500           FROM HSL2-HEADING-SUMMARY-LINE-2                       13080043
130600             AFTER ADVANCING 1 LINES.                             13090043
130700                                                                  13100001
130800     IF  CC-TO-INFOPAC                                            13110043
130900         WRITE REPORT-RECORD-1                                    13120043
131000           FROM HSL3-HEADING-SUMMARY-LINE-3                       13130043
131100             AFTER ADVANCING 2 LINES                              13140043
131200     ELSE                                                         13150043
131300         WRITE REPORT-RECORD-2                                    13160043
131400           FROM HSL3-HEADING-SUMMARY-LINE-3                       13170043
131500             AFTER ADVANCING 2 LINES.                             13180043
131600                                                                  13190043
131700     IF  CC-TO-INFOPAC                                            13200012
131800         WRITE REPORT-RECORD-1                                    13210012
131900           FROM HSL4-HEADING-SUMMARY-LINE-4                       13220012
132000             AFTER ADVANCING 2 LINES                              13230012
132100     ELSE                                                         13240012
132200         WRITE REPORT-RECORD-2                                    13250012
132300           FROM HSL4-HEADING-SUMMARY-LINE-4                       13260012
132400             AFTER ADVANCING 2 LINES.                             13270012
132500                                                                  13280001
132600     IF  CC-TO-INFOPAC                                            13290012
132700         WRITE REPORT-RECORD-1                                    13300012
132800           FROM HSL5-HEADING-SUMMARY-LINE-5                       13310012
132900             AFTER ADVANCING 1 LINES                              13320012
133000     ELSE                                                         13330012
133100         WRITE REPORT-RECORD-2                                    13340012
133200           FROM HSL5-HEADING-SUMMARY-LINE-5                       13350012
133300             AFTER ADVANCING 1 LINES.                             13360012
133400                                                                  13370001
133500     IF  CC-TO-INFOPAC                                            13380012
133600         WRITE REPORT-RECORD-1                                    13390012
133700           FROM HSL6-HEADING-SUMMARY-LINE-6                       13400012
133800             AFTER ADVANCING 1 LINES                              13410012
133900     ELSE                                                         13420012
134000         WRITE REPORT-RECORD-2                                    13430012
134100           FROM HSL6-HEADING-SUMMARY-LINE-6                       13440012
134200             AFTER ADVANCING 1 LINES.                             13450012
134300                                                                  13460001
134400     IF  CC-TO-INFOPAC                                            13470012
134500         MOVE  SPACES  TO  REPORT-RECORD-1                        13480012
134600         WRITE REPORT-RECORD-1                                    13490012
134700             AFTER ADVANCING 1 LINES                              13500013
134800     ELSE                                                         13510012
134900         MOVE  SPACES  TO  REPORT-RECORD-2                        13520012
135000         WRITE REPORT-RECORD-2                                    13530012
135100             AFTER ADVANCING 1 LINES.                             13540012
135200                                                                  13550001
135300                                                                  13560001
135400 5800-PRINT-SUMMARY-DETAIL.                                       13570001
135500*---------------------------------------------------------------* 13580001
135600*  PRINT SUMMARY PAGE DETAIL LINE                               * 13590001
135700*---------------------------------------------------------------* 13600001
135800                                                                  13610001
135900     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            13620001
136000         PERFORM 5700-SUMMARY-HEADING                             13630001
136100         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         13640018
136200                                     PV-PREV-STORE-ZONE           13650018
136300                                     PV-PREV-VENDOR-NAME          13660018
136400                                     PV-PREV-DEPT-NUMBER          13670018
136500                                     PV-PREV-SCAC                 13680018
136600                                     PV-PREV-TRAILER              13690018
136700                                     PV-PREV-REC-SEQ-NBR          13700021
136800         MOVE ZEROES             TO  PV-PREV-PO-NMBR              13710021
136900     END-IF.                                                      13720018
137000                                                                  13730018
137100     IF  CC-TO-INFOPAC                                            13740018
137200         WRITE REPORT-RECORD-1                                    13750018
137300           FROM SL1-SUMMARY-LINE-1                                13760018
137400             AFTER ADVANCING 1 LINES                              13770018
137500     ELSE                                                         13780018
137600         WRITE REPORT-RECORD-2                                    13790018
137700           FROM SL1-SUMMARY-LINE-1                                13800018
137800             AFTER ADVANCING 1 LINES.                             13810018
137900                                                                  13820018
138000     ADD 1                       TO PV-LINE-COUNT.                13830018
138100                                                                  13840018
138200     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            13850018
138300         PERFORM 5700-SUMMARY-HEADING                             13860018
138400         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         13870018
138500                                     PV-PREV-STORE-ZONE           13880018
138600                                     PV-PREV-VENDOR-NAME          13890018
138700                                     PV-PREV-DEPT-NUMBER          13900018
138800                                     PV-PREV-SCAC                 13910018
138900                                     PV-PREV-TRAILER              13920018
139000                                     PV-PREV-REC-SEQ-NBR          13930021
139100         MOVE ZEROES             TO  PV-PREV-PO-NMBR              13940021
139200     END-IF.                                                      13950018
139300                                                                  13960018
139400                                                                  13970018
139500 5900-PRINT-SUMMARY-FINAL.                                        13980018
139600*---------------------------------------------------------------* 13990018
139700*  PRINT SUMMARY PAGE DETAIL LINE                               * 14000018
139800*---------------------------------------------------------------* 14010018
139900                                                                  14020018
140000     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            14030018
140100         PERFORM 5700-SUMMARY-HEADING                             14040018
140200         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         14050018
140300                                     PV-PREV-STORE-ZONE           14060018
140400                                     PV-PREV-VENDOR-NAME          14070018
140500                                     PV-PREV-DEPT-NUMBER          14080018
140600                                     PV-PREV-SCAC                 14090018
140700                                     PV-PREV-TRAILER              14100018
140800                                     PV-PREV-REC-SEQ-NBR          14110021
140900         MOVE ZEROES             TO  PV-PREV-PO-NMBR              14120021
141000     END-IF.                                                      14130018
141100                                                                  14140018
141200     IF  CC-TO-INFOPAC                                            14150018
141300         WRITE REPORT-RECORD-1                                    14160018
141400           FROM SL2-SUMMARY-LINE-2                                14170018
141500             AFTER ADVANCING 2 LINES                              14180019
141600     ELSE                                                         14190018
141700         WRITE REPORT-RECORD-2                                    14200018
141800           FROM SL2-SUMMARY-LINE-2                                14210018
141900             AFTER ADVANCING 2 LINES.                             14220019
142000                                                                  14230018
142100     ADD 1                       TO PV-LINE-COUNT.                14240018
142200                                                                  14250018
142300     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            14260018
142400         PERFORM 5700-SUMMARY-HEADING                             14270018
142500         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         14280018
142600                                     PV-PREV-STORE-ZONE           14290018
142700                                     PV-PREV-VENDOR-NAME          14300018
142800                                     PV-PREV-DEPT-NUMBER          14310018
142900                                     PV-PREV-SCAC                 14320018
143000                                     PV-PREV-TRAILER              14330018
143100                                     PV-PREV-REC-SEQ-NBR          14340021
143200         MOVE ZEROES             TO  PV-PREV-PO-NMBR              14350021
143300     END-IF.                                                      14360018
143400                                                                  14370018
143500                                                                  14380018
143600 6000-PRINT-RPT-HEADING.                                          14390018
143700*---------------------------------------------------------------* 14400001
143800*  HEADING ROUTINE.                                             * 14410001
143900*---------------------------------------------------------------* 14420001
144000     ADD 1                       TO PV-PAGE-COUNT.                14430001
144100     MOVE PV-PAGE-COUNT          TO DP132O-PAGE-NUMBER.           14440001
144200                                                                  14450001
144300     MOVE 10                     TO PV-LINE-COUNT.                14460003
144400                                                                  14470001
144500     IF  CC-TO-INFOPAC                                            14480012
144600         WRITE REPORT-RECORD-1                                    14490012
144700           FROM DP132O-STANDRD-HEADER-132-COLS                    14500012
144800             AFTER ADVANCING PAGE                                 14510012
144900     ELSE                                                         14520012
145000         WRITE REPORT-RECORD-2                                    14530012
145100           FROM DP132O-STANDRD-HEADER-132-COLS                    14540012
145200             AFTER ADVANCING PAGE.                                14550012
145300                                                                  14560012
145400     IF  CC-TO-INFOPAC                                            14570012
145500         WRITE REPORT-RECORD-1                                    14580012
145600           FROM HL1-HEADING-LINE-1                                14590012
145700             AFTER ADVANCING 2 LINES                              14600012
145800     ELSE                                                         14610012
145900         WRITE REPORT-RECORD-2                                    14620012
146000           FROM HL1-HEADING-LINE-1                                14630012
146100             AFTER ADVANCING 2 LINES.                             14640012
146200                                                                  14650001
146300     IF  CC-TO-INFOPAC                                            14660012
146400         WRITE REPORT-RECORD-1                                    14670012
146500           FROM HL2-HEADING-LINE-2                                14680012
146600             AFTER ADVANCING 2 LINES                              14690012
146700     ELSE                                                         14700012
146800         WRITE REPORT-RECORD-2                                    14710012
146900           FROM HL2-HEADING-LINE-2                                14720012
147000             AFTER ADVANCING 2 LINES.                             14730012
147100                                                                  14740001
147200     IF  CC-TO-INFOPAC                                            14750012
147300         WRITE REPORT-RECORD-1                                    14760012
147400           FROM HL3-HEADING-LINE-3                                14770012
147500             AFTER ADVANCING 1 LINES                              14780012
147600     ELSE                                                         14790012
147700         WRITE REPORT-RECORD-2                                    14800012
147800           FROM HL3-HEADING-LINE-3                                14810012
147900             AFTER ADVANCING 1 LINES.                             14820012
148000                                                                  14830003
148100     IF  CC-TO-INFOPAC                                            14840012
148200         WRITE REPORT-RECORD-1                                    14850012
148300           FROM HL4-HEADING-LINE-4                                14860012
148400             AFTER ADVANCING 2 LINES                              14870012
148500     ELSE                                                         14880012
148600         WRITE REPORT-RECORD-2                                    14890012
148700           FROM HL4-HEADING-LINE-4                                14900012
148800             AFTER ADVANCING 2 LINES.                             14910012
148900                                                                  14920001
149000     IF  CC-TO-INFOPAC                                            14930012
149100         WRITE REPORT-RECORD-1                                    14940012
149200           FROM HL5-HEADING-LINE-5                                14950012
149300             AFTER ADVANCING 1 LINES                              14960012
149400     ELSE                                                         14970012
149500         WRITE REPORT-RECORD-2                                    14980012
149600           FROM HL5-HEADING-LINE-5                                14990012
149700             AFTER ADVANCING 1 LINES.                             15000012
149800                                                                  15010001
149900     IF  CC-TO-INFOPAC                                            15020012
150000         MOVE  SPACES  TO  REPORT-RECORD-1                        15030012
150100         WRITE REPORT-RECORD-1                                    15040012
150200             AFTER ADVANCING 1 LINES                              15050012
150300     ELSE                                                         15060012
150400         MOVE  SPACES  TO  REPORT-RECORD-2                        15070012
150500         WRITE REPORT-RECORD-2                                    15080014
150600             AFTER ADVANCING 1 LINES.                             15090012
150700                                                                  15100003
150800                                                                  15110003
150900 6100-PRINT-DETAIL-LINE.                                          15120003
151000*---------------------------------------------------------------* 15130003
151100*  PRINT DETAIL LINE.                                           * 15140003
151200*---------------------------------------------------------------* 15150003
151300                                                                  15160003
151400     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            15170003
151500         PERFORM 6000-PRINT-RPT-HEADING                           15180003
151600         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         15190018
151700                                     PV-PREV-STORE-ZONE           15200018
151800                                     PV-PREV-VENDOR-NAME          15210018
151900                                     PV-PREV-DEPT-NUMBER          15220018
152000                                     PV-PREV-SCAC                 15230018
152100                                     PV-PREV-TRAILER              15240018
152200                                     PV-PREV-REC-SEQ-NBR          15250021
152300         MOVE ZEROES             TO  PV-PREV-PO-NMBR              15260021
152400     END-IF.                                                      15270003
152500                                                                  15280003
152600     IF  CC-TO-INFOPAC                                            15290012
152700         WRITE REPORT-RECORD-1                                    15300012
152800           FROM DL1-DETAIL-LINE-1                                 15310012
152900             AFTER ADVANCING 1 LINES                              15320012
153000         ADD 1                   TO PV-LINE-COUNT                 15330022
153100     ELSE                                                         15340012
153200         WRITE REPORT-RECORD-2                                    15350012
153300           FROM DL1-DETAIL-LINE-1                                 15360012
153400             AFTER ADVANCING 1 LINES                              15370022
153500         ADD 1                   TO PV-LINE-COUNT.                15380022
153600                                                                  15390012
153700     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            15400012
153800         PERFORM 6000-PRINT-RPT-HEADING                           15410012
153900         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         15420018
154000                                     PV-PREV-STORE-ZONE           15430018
154100                                     PV-PREV-VENDOR-NAME          15440018
154200                                     PV-PREV-DEPT-NUMBER          15450018
154300                                     PV-PREV-SCAC                 15460018
154400                                     PV-PREV-TRAILER              15470018
154500                                     PV-PREV-REC-SEQ-NBR          15480021
154600         MOVE ZEROES             TO  PV-PREV-PO-NMBR              15490021
154700     END-IF.                                                      15500012
154800                                                                  15510001
154900 6400-PRINT-TOTALS.                                               15520001
155000*---------------------------------------------------------------* 15530001
155100*  PRINT TOTALS                                                 * 15540001
155200*---------------------------------------------------------------* 15550001
155300                                                                  15560001
155400     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            15570001
155500         PERFORM 6000-PRINT-RPT-HEADING                           15580001
155600         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         15590018
155700                                     PV-PREV-STORE-ZONE           15600018
155800                                     PV-PREV-VENDOR-NAME          15610018
155900                                     PV-PREV-DEPT-NUMBER          15620018
156000                                     PV-PREV-SCAC                 15630018
156100                                     PV-PREV-TRAILER              15640018
156200                                     PV-PREV-REC-SEQ-NBR          15650021
156300         MOVE ZEROES             TO  PV-PREV-PO-NMBR              15660021
156400     ELSE                                                         15670001
156500     IF  PV-LINE-COUNT = PC-TEN                                   15680025
156600         NEXT SENTENCE                                            15690024
156700     ELSE                                                         15700024
156800     IF  CC-TO-INFOPAC                                            15710024
156900         MOVE  SPACES            TO REPORT-RECORD-1               15720012
157000         WRITE REPORT-RECORD-1                                    15730012
157100             AFTER ADVANCING 1 LINES                              15740001
157200         ADD 1                   TO PV-LINE-COUNT                 15750012
157300     ELSE                                                         15760012
157400     IF  CC-TO-PRINTER                                            15770012
157500         MOVE  SPACES            TO REPORT-RECORD-2               15780012
157600         WRITE REPORT-RECORD-2                                    15790012
157700             AFTER ADVANCING 1 LINES                              15800012
157800         ADD 1                   TO PV-LINE-COUNT.                15810012
157900                                                                  15820001
158000     IF  CC-TO-INFOPAC                                            15830012
158100         WRITE REPORT-RECORD-1                                    15840012
158200           FROM TL1-TOTAL-LINE-1                                  15850012
158300             AFTER ADVANCING 1 LINES                              15860012
158400         ADD 1                   TO PV-LINE-COUNT                 15870022
158500     ELSE                                                         15880012
158600         WRITE REPORT-RECORD-2                                    15890012
158700           FROM TL1-TOTAL-LINE-1                                  15900012
158800             AFTER ADVANCING 1 LINES                              15910022
158900         ADD 1                   TO PV-LINE-COUNT.                15920022
159000                                                                  15930001
159100     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            15940001
159200         PERFORM 6000-PRINT-RPT-HEADING                           15950001
159300         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         15960018
159400                                     PV-PREV-STORE-ZONE           15970018
159500                                     PV-PREV-VENDOR-NAME          15980018
159600                                     PV-PREV-DEPT-NUMBER          15990018
159700                                     PV-PREV-SCAC                 16000018
159800                                     PV-PREV-TRAILER              16010018
159900                                     PV-PREV-REC-SEQ-NBR          16020021
160000         MOVE ZEROES             TO  PV-PREV-PO-NMBR              16030021
160100     ELSE                                                         16040001
160200     IF  CC-TO-INFOPAC                                            16050012
160300         MOVE  SPACES            TO REPORT-RECORD-1               16060012
160400         WRITE REPORT-RECORD-1                                    16070012
160500             AFTER ADVANCING 1 LINES                              16080001
160600         ADD 1                   TO PV-LINE-COUNT                 16090012
160700     ELSE                                                         16100012
160800     IF  CC-TO-PRINTER                                            16110012
160900         MOVE  SPACES            TO REPORT-RECORD-2               16120012
161000         WRITE REPORT-RECORD-2                                    16130012
161100             AFTER ADVANCING 1 LINES                              16140012
161200         ADD 1                   TO PV-LINE-COUNT.                16150012
161300                                                                  16160023
161400     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            16170043
161500         PERFORM 6000-PRINT-RPT-HEADING                           16180043
161600         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         16190043
161700                                     PV-PREV-STORE-ZONE           16200043
161800                                     PV-PREV-VENDOR-NAME          16210043
161900                                     PV-PREV-DEPT-NUMBER          16220043
162000                                     PV-PREV-SCAC                 16230043
162100                                     PV-PREV-TRAILER              16240043
162200                                     PV-PREV-REC-SEQ-NBR          16250043
162300         MOVE ZEROES             TO  PV-PREV-PO-NMBR.             16260043
162400                                                                  16270001
162500                                                                  16280043
162600 6450-PRINT-TOTALS.                                               16290001
162700*---------------------------------------------------------------* 16300001
162800*  PRINT TOTALS                                                 * 16310001
162900*---------------------------------------------------------------* 16320001
163000                                                                  16330001
163100     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            16340001
163200         PERFORM 6000-PRINT-RPT-HEADING                           16350018
163300         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         16360018
163400                                     PV-PREV-STORE-ZONE           16370018
163500                                     PV-PREV-VENDOR-NAME          16380018
163600                                     PV-PREV-DEPT-NUMBER          16390018
163700                                     PV-PREV-SCAC                 16400018
163800                                     PV-PREV-TRAILER              16410021
163900                                     PV-PREV-REC-SEQ-NBR          16420021
164000         MOVE ZEROES             TO  PV-PREV-PO-NMBR.             16430021
164100                                                                  16440001
164200     IF  CC-TO-INFOPAC                                            16450012
164300         WRITE REPORT-RECORD-1                                    16460012
164400           FROM TL1-TOTAL-LINE-1                                  16470012
164500             AFTER ADVANCING 1 LINES                              16480012
164600         ADD 1                   TO PV-LINE-COUNT                 16490022
164700     ELSE                                                         16500012
164800         WRITE REPORT-RECORD-2                                    16510012
164900           FROM TL1-TOTAL-LINE-1                                  16520012
165000             AFTER ADVANCING 1 LINES                              16530022
165100         ADD 1                   TO PV-LINE-COUNT.                16540022
165200                                                                  16550012
165300     IF  PS-EOF-DC-TOTAL                                          16560043
165400         NEXT SENTENCE                                            16570043
165500     ELSE                                                         16580043
165600     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            16590043
165700         PERFORM 6000-PRINT-RPT-HEADING                           16600043
165800         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         16610043
165900                                     PV-PREV-STORE-ZONE           16620043
166000                                     PV-PREV-VENDOR-NAME          16630043
166100                                     PV-PREV-DEPT-NUMBER          16640043
166200                                     PV-PREV-SCAC                 16650043
166300                                     PV-PREV-TRAILER              16660043
166400                                     PV-PREV-REC-SEQ-NBR          16670043
166500         MOVE ZEROES             TO  PV-PREV-PO-NMBR              16680043
166600     ELSE                                                         16690043
166700     IF  CC-TO-INFOPAC                                            16700043
166800         MOVE  SPACES            TO REPORT-RECORD-1               16710043
166900         WRITE REPORT-RECORD-1                                    16720043
167000             AFTER ADVANCING 1 LINES                              16730043
167100         ADD 1                   TO PV-LINE-COUNT                 16740043
167200     ELSE                                                         16750043
167300     IF  CC-TO-PRINTER                                            16760043
167400         MOVE  SPACES            TO REPORT-RECORD-2               16770043
167500         WRITE REPORT-RECORD-2                                    16780043
167600             AFTER ADVANCING 1 LINES                              16790043
167700         ADD 1                   TO PV-LINE-COUNT.                16800043
167800                                                                  16810043
167900                                                                  16820043
168000 6600-PRINT-END-OF-REPORT.                                        16830001
168100*---------------------------------------------------------------* 16840001
168200*  PRINT END OF REPORT BANNER                                   * 16850001
168300*---------------------------------------------------------------* 16860001
168400                                                                  16870001
168500     IF  PV-LINE-COUNT > PC-LINE-LIMIT                            16880001
168600         PERFORM 6000-PRINT-RPT-HEADING                           16890001
168700         MOVE SPACES             TO  PV-PREV-RECEIPT-DATE         16900018
168800                                     PV-PREV-STORE-ZONE           16910018
168900                                     PV-PREV-VENDOR-NAME          16920018
169000                                     PV-PREV-DEPT-NUMBER          16930018
169100                                     PV-PREV-SCAC                 16940018
169200                                     PV-PREV-TRAILER              16950018
169300                                     PV-PREV-REC-SEQ-NBR          16960021
169400         MOVE ZEROES             TO  PV-PREV-PO-NMBR              16970021
169500     END-IF.                                                      16980001
169600                                                                  16990001
169700     IF  CC-TO-INFOPAC                                            17000012
169800         WRITE REPORT-RECORD-1                                    17010012
169900           FROM PR-PRINT-FINAL                                    17020012
170000             AFTER ADVANCING 2 LINES                              17030012
170100     ELSE                                                         17040012
170200         WRITE REPORT-RECORD-2                                    17050012
170300           FROM PR-PRINT-FINAL                                    17060012
170400             AFTER ADVANCING 2 LINES.                             17070012
170500                                                                  17080012
170600     ADD 2                       TO PV-LINE-COUNT.                17090001
170700                                                                  17100001
170800*-----------------------------------------------------------------17110041
170900*     IF THIS IS A PRINTEK PRINTER, SEND A CUT COMMAND            17120041
171000*-----------------------------------------------------------------17130041
171100     IF  CC-PRTR-CNTL-IND = 'P'                                   17140041
171200         WRITE REPORT-RECORD-2                                    17150041
171300          FROM DS004-PLC-CUT-FORM                                 17160041
171400               AFTER ADVANCING 1 LINE                             17170041
171500     END-IF.                                                      17180041
171600                                                                  17190001
171700 6800-NO-REPORT-DETAIL.                                           17200001
171800*---------------------------------------------------------------* 17210001
171900*  PRINT "NO DETAIL REPORT' BANNER                              * 17220001
172000*---------------------------------------------------------------* 17230001
172100                                                                  17240001
172200     IF  CC-TO-INFOPAC                                            17250012
172300         WRITE REPORT-RECORD-1                                    17260012
172400           FROM PR-PRINT-NO-DETAIL                                17270012
172500             AFTER ADVANCING 2 LINES                              17280012
172600     ELSE                                                         17290012
172700         WRITE REPORT-RECORD-2                                    17300012
172800           FROM PR-PRINT-NO-DETAIL                                17310012
172900             AFTER ADVANCING 2 LINES.                             17320012
173000                                                                  17330012
173100     ADD 2                       TO PV-LINE-COUNT.                17340001
173200                                                                  17350001
173300*-----------------------------------------------------------------17360041
173400*     IF THIS IS A PRINTEK PRINTER, SEND A CUT COMMAND            17370041
173500*-----------------------------------------------------------------17380041
173600     IF  CC-PRTR-CNTL-IND = 'P'                                   17390041
173700         WRITE REPORT-RECORD-2                                    17400041
173800          FROM DS004-PLC-CUT-FORM                                 17410041
173900               AFTER ADVANCING 1 LINE                             17420041
174000     END-IF.                                                      17430041
174100                                                                  17440041
174200                                                                  17450001
174300*---------------------------------------------------------------* 17460057
174400*  PRINT ERROR INFORMATION                                      * 17470057
174500*---------------------------------------------------------------* 17480057
174600 6900-PRINT-ERROR-INFO.                                           17490057
174700                                                                  17500057
174800     MOVE  CC-REPORT-REQUEST-1       TO  EL5-STORE-ZONE.          17510057
174900     MOVE  CC-REPORT-REQUEST-2       TO  EL6-P2L-MODULE.          17520057
175000                                                                  17530059
175100     IF  CC-TO-INFOPAC-OR-PRINTER  = 'I'                          17540059
175200         MOVE  'Y'                   TO  EL8-INFOPAC              17550059
175300     ELSE                                                         17560059
175400         MOVE  'N'                   TO  EL8-INFOPAC              17570059
175500     END-IF.                                                      17580059
175600                                                                  17590059
175700     MOVE  CC-PRINTER-ID             TO  EL9-PRINTER-ID.          17600057
175800                                                                  17610057
175900     IF  CC-TO-INFOPAC                                            17620057
176000         WRITE REPORT-RECORD-1                                    17630057
176100           FROM EL1-ERROR-LINE-1                                  17640057
176200             AFTER ADVANCING 2 LINES                              17650057
176300         WRITE REPORT-RECORD-1                                    17660057
176400           FROM EL2-ERROR-LINE-2                                  17670057
176500             AFTER ADVANCING 2 LINES                              17680057
176600         WRITE REPORT-RECORD-1                                    17690057
176700           FROM EL3-ERROR-LINE-3                                  17700057
176800             AFTER ADVANCING 2 LINES                              17710057
176900         WRITE REPORT-RECORD-1                                    17720057
177000           FROM EL4-ERROR-LINE-4                                  17730057
177100             AFTER ADVANCING 2 LINES                              17740057
177200         WRITE REPORT-RECORD-1                                    17750057
177300           FROM EL5-ERROR-LINE-5                                  17760057
177400             AFTER ADVANCING 2 LINES                              17770057
177500         WRITE REPORT-RECORD-1                                    17780057
177600           FROM EL6-ERROR-LINE-6                                  17790057
177700             AFTER ADVANCING 1 LINES                              17800057
177800         WRITE REPORT-RECORD-1                                    17810057
177900           FROM EL7-ERROR-LINE-7                                  17820057
178000             AFTER ADVANCING 2 LINES                              17830057
178100         WRITE REPORT-RECORD-1                                    17840057
178200           FROM EL8-ERROR-LINE-8                                  17850057
178300             AFTER ADVANCING 2 LINES                              17860057
178400         WRITE REPORT-RECORD-1                                    17870057
178500           FROM EL9-ERROR-LINE-9                                  17880057
178600             AFTER ADVANCING 1 LINES                              17890057
178700     ELSE                                                         17900057
178800         WRITE REPORT-RECORD-2                                    17910057
178900           FROM EL1-ERROR-LINE-1                                  17920057
179000             AFTER ADVANCING 2 LINES                              17930057
179100         WRITE REPORT-RECORD-2                                    17940057
179200           FROM EL2-ERROR-LINE-2                                  17950057
179300             AFTER ADVANCING 2 LINES                              17960057
179400         WRITE REPORT-RECORD-2                                    17970057
179500           FROM EL3-ERROR-LINE-3                                  17980057
179600             AFTER ADVANCING 2 LINES                              17990057
179700         WRITE REPORT-RECORD-2                                    18000057
179800           FROM EL4-ERROR-LINE-4                                  18010057
179900             AFTER ADVANCING 2 LINES                              18020057
180000         WRITE REPORT-RECORD-2                                    18030057
180100           FROM EL5-ERROR-LINE-5                                  18040057
180200             AFTER ADVANCING 2 LINES                              18050057
180300         WRITE REPORT-RECORD-2                                    18060057
180400           FROM EL6-ERROR-LINE-6                                  18070057
180500             AFTER ADVANCING 1 LINES                              18080057
180600         WRITE REPORT-RECORD-2                                    18090057
180700           FROM EL7-ERROR-LINE-7                                  18100057
180800             AFTER ADVANCING 2 LINES                              18110057
180900         WRITE REPORT-RECORD-2                                    18120057
181000           FROM EL8-ERROR-LINE-8                                  18130057
181100             AFTER ADVANCING 2 LINES                              18140057
181200         WRITE REPORT-RECORD-2                                    18150057
181300           FROM EL9-ERROR-LINE-9                                  18160057
181400             AFTER ADVANCING 1 LINES                              18170057
181500     END-IF.                                                      18180057
181600                                                                  18190057
181700                                                                  18200057
181800 7000-READ-INPUT-FILE.                                            18210001
181900*---------------------------------------------------------------* 18220001
182000*  READ INPUT FILE                                              * 18230001
182100*---------------------------------------------------------------* 18240001
182200                                                                  18250001
182300      READ INPUT-FILE INTO PC004-P2L-EXT-RECORD                   18260001
182400          AT END                                                  18270001
182500             SET PS-INPUT-EOF TO TRUE.                            18280001
182600                                                                  18290001
182700      IF  PS-INPUT-EOF                                            18300001
182800          NEXT SENTENCE                                           18310001
182900      ELSE                                                        18320001
183000      IF  PC004-CURRENT-OPER  =  CC-DC-NUMBER                     18330001
183100          NEXT SENTENCE                                           18340001
183200      ELSE                                                        18350001
183300          GO TO 7000-READ-INPUT-FILE.                             18360001
183400                                                                  18370001
183500                                                                  18380001
183600 9000-END-PROCESS.                                                18390001
183700*---------------------------------------------------------------* 18400001
183800*  CLOSE FILES.                                                   18410001
183900*---------------------------------------------------------------* 18420001
184000                                                                  18430001
184100     DISPLAY '*------------------------------*'.                  18440001
184200     DISPLAY '*     PROGRAM - PCKRP010       *'.                  18450001
184300     DISPLAY '*------------------------------*'.                  18460001
184400     DISPLAY '* PV-RECORD-COUNT  - ' PV-RECORD-COUNT.             18470001
184500     DISPLAY '*------------------------------*'.                  18480001
184600                                                                  18490001
184700     CLOSE INPUT-FILE.                                            18500012
184800                                                                  18510012
184900     IF  CC-TO-INFOPAC                                            18520012
185000         CLOSE REPORT-FILE-1                                      18530012
185100     ELSE                                                         18540012
185200     IF  CC-TO-PRINTER                                            18550012
185300         CLOSE REPORT-FILE-2.                                     18560050
185400                                                                  18570001
185500                                                                  18580001
185600 9200-ABEND.                                                      18590001
185700***************************************************************** 18600001
185800*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       18610001
185900***************************************************************** 18620001
186000     DISPLAY '***************************'.                       18630001
186100     DISPLAY '**       ABEND           **'.                       18640001
186200     DISPLAY '**  IN PROGRAM PCKRP010  **'.                       18650001
186300     DISPLAY '***************************'.                       18660001
186400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        18670001
186500     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       18680001
186600     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       18690001
186700     DISPLAY '** # TABLE ENTRIES ** = ' PC-ACTUAL-TABLE-ENTRIES.  18700001
186800     DISPLAY '** STORE ZONE      ** = ' PV-HOLD-STORE-ZONE.       18710001
186900                                                                  18720001
187000     MOVE +4014                  TO PV-ABEND-CODE.                18730001
187100     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18740001
187200                                                                  18750001
187300                                                                  18760001
187400 9900-DB2-ABEND.                                                  18770001
187500*---------------------------------------------------------------* 18780001
187600*  DB2-ABEND-PROCESSING                                           18790001
187700*---------------------------------------------------------------* 18800001
187800                                                                  18810001
187900     DISPLAY '*** DB2 ERROR '.                                    18820001
188000     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       18830001
188100     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 18840001
188200     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               18850001
188300     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               18860001
188400     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MSG-1.           18870001
188500     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-2.           18880001
188600     DISPLAY '***           = ' PV-DB2-OPERATION-MSG-3.           18890001
188700     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             18900001
188800                                                                  18910001
188900     COPY DPPD004.                                                18920001
189000                                                                  18930001
189100     MOVE +4013                  TO PV-ABEND-CODE.                18940001
189200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         18950001
189300                                                                  18960001
189400****************************************************************  18970001
