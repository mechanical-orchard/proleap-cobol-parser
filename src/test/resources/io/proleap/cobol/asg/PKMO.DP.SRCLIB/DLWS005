000100**************************************************************    00010000
000200*    ******                IMPORTANT                 ******  *    00020000
000300*   THIS IS THE COMMUNICATION AREA TO BE USED BY A CALLING   *    00030000
000400*   PROGRAM THAT WILL USE ROUTINE DLKUP002 TO MAINTAIN       *    00040000
000500*   ASSOCIATES WITHIN AN ASSIGNMENT (CAN ADD AN ASSOCIATE    *    00050000
000600*   TO AN ASSIGNMENT, CAN END AN ASSOCIATE ATTACHED TO AN    *    00060005
000610*   ASSIGNMENT, CAN END ALL ASSOCIATES ATTACHED TO AN        *    00061000
000620*   ASSIGNMENT).                                             *    00062000
000700*                                                            *    00070000
000800*   WHEN THE PROGRAM CHANGES IT MUST BE COMPILED FOR         *    00080000
000900*   BOTH BATCH AND CICS                                      *    00090000
001000*                                                            *    00100000
001100*   TO INVOKE THIS PROGRAM FROM A CICS EXIT YOU MUST USE THIS*    00110000
001200*   FORMAT:                                                  *    00120000
001300*     CALL DL005-USER-PGM USING DFHEIBLK                     *    00130000
001400*                              DL005-COMMAREA                *    00140000
001500*                              DL005-USER-COMMAREA           *    00150000
001600*   IN BATCH DO THIS:                                        *    00160000
001700*     CALL DL005-USER-PGM USING DL005-USER-COMMAREA          *    00170000
001800*    ******                IMPORTANT                 ******  *    00180000
001900*                                                            *    00190000
002000*     INITIALIZE DL005-USER-COMMAREA BEFORE CALLING DLKUP002 *    00200000
002100*                                                            *    00210000
002200*     DL005-ACCESS-METHODD IS REQUIRED.                      *    00220000
002300*                                                            *    00230000
002400*     THE APPROPRIATE DL005-KEYS FIELDS ARE REQUIRED.        *    00240000
002500*                                                            *    00250000
002600*     REGARDING DL005-OUTPUT-FIELDS:                         *    00260000
002700*       THE APPROPRIATE OUTPUT FIELDS WILL BE RETURNED TO    *    00270000
002800*       THE CALLING PROGRAM BASED ON WHAT THE DLKUP002       *    00280000
002900*       MODULE DETERMINES.                                   *    00290000
003000*                                                            *    00300000
003100*     NOTE: IF FIELD(S) ARE ADDED TO THIS COPYBOOK           *    00310000
003200*           DECREMENT THE FILLER NEAR THE END OF THIS        *    00320000
003300*           COPYBOOK SO THE TOTAL LENGTH REMAINS THE SAME    *    00330000
003400*           AT LENGTH OF 550                                 *    00340000
003500**************************************************************    00350000
003600 01  DL005-ASGMT-COMMAREA.                                        00360000
003700     05  DL005-ACCESS-METHOD              PIC  X(04).             00370000
003800         88  DL005-BY-ASGMT-NBR           VALUE 'ASGN'.           00380000
003810     05  DL005-PROCESS-CDE                PIC  X(01).             00381000
003820         88  DL005-ADD-TO-ASGMT           VALUE 'A'.              00382000
003830         88  DL005-END-FROM-ASGMT         VALUE 'B'.              00383001
003850     05  DL005-COMMIT-CDE                 PIC  X(01).             00385001
003860         88  DL005-COMMIT-UPDATE          VALUE 'C'.              00386001
003870         88  DL005-DO-NOT-COMMIT-UPDATE   VALUE 'N'.              00387001
003900     05  DL005-FILLER                     PIC  X(20).             00390007
004000     05  DL005-KEYS.                                              00400000
004010         10  DL005-KEY-START-DTE.                                 00401001
004020             15  DL005-KEY-SDTE-YYYY      PIC  X(04).             00402001
004030             15  DL005-FILLER             PIC  X(01).             00403007
004040             15  DL005-KEY-SDTE-MM        PIC  X(02).             00404001
004050             15  DL005-FILLER             PIC  X(01).             00405007
004060             15  DL005-KEY-SDTE-DD        PIC  X(02).             00406001
004070         10  DL005-KEY-NBR-TXT            PIC  X(10).             00407001
004071             88  DL005-NO-KEY-NBR-TXT     VALUE SPACES.           00407101
004080         10  DL005-KEY-NBR-SEQ-NBR        PIC S9(09)     COMP.    00408001
004081             88  DL005-NO-KEY-NBR-SEQ-NBR VALUE ZEROS.            00408101
004082         10  DL005-KEY-TEM-ASGMT-SEQ-NBR  PIC S9(09)     COMP.    00408201
004083             88  DL005-NO-KEY-TEM-SEQ-NBR VALUE ZEROS.            00408301
004084         10  DL005-KEY-USER-ID            PIC  X(08).             00408401
004085             88  DL005-NO-KEY-USER-ID     VALUE SPACES.           00408501
004086         10  DL005-KEY-ADD-BY-USER-ID     PIC  X(08).             00408601
004087             88  DL005-NO-KEY-ADD-BY-USR  VALUE SPACES.           00408701
004088         10  DL005-KEY-LVE-PGM-NM         PIC  X(08).             00408801
004089             88  DL005-NO-KEY-LVE-BY-PGM  VALUE SPACES.           00408901
004090         10  DL005-KEY-USR-TYPE-CDE       PIC  X(01).             00409001
004091             88  DL005-KEY-USR-IS-KOHLS   VALUE 'K'.              00409101
004092             88  DL005-KEY-USR-IS-TEMP    VALUE 'T'.              00409201
004093             88  DL005-NO-KEY-USR-TYPE    VALUE SPACE.            00409301
004094         10  DL005-KEY-LVE-RSN-CDE        PIC  X(01).             00409401
004095             88  DL005-VALID-LVE-RSN-CDE  VALUES 'M' 'S' 'A'      00409508
004096                                                 'Q' 'T'.         00409608
004097             88  DL005-KEY-LVE-RSN-AMOVE  VALUE 'M'.              00409708
004098             88  DL005-KEY-LVE-RSN-SMOVE  VALUE 'S'.              00409808
004099             88  DL005-KEY-LVE-RSN-ASTOP  VALUE 'A'.              00409908
004100             88  DL005-KEY-LVE-RSN-SSTOP  VALUE 'Q'.              00410008
004101             88  DL005-KEY-LVE-RSN-TIME   VALUE 'T'.              00410108
004110             88  DL005-NO-KEY-LVE-RSN     VALUE SPACE.            00411008
004200         10  DL005-FILLER                 PIC  X(50).             00420007
004260     05  DL005-RETURN-CODE                PIC  X(02).             00426000
004270         88  DL005-SUCCESSFUL             VALUES ZERO.            00427000
004280         88  DL005-SQL-ERROR              VALUE '01'.             00428000
004290         88  DL005-MISSING-KEY-FIELDS     VALUE '02'.             00429000
004291         88  DL005-INVALID-USER-ID        VALUE '03'.             00429102
004292         88  DL005-INVALID-LVE-RSN-CDE    VALUE '04'.             00429202
004293         88  DL005-ASGMT-NOT-ACTIVE       VALUE '05'.             00429302
004294         88  DL005-ASSOC-ALREADY-ACTIVE   VALUE '06'.             00429403
004295         88  DL005-COMMIT-CODE-INVALID    VALUE '07'.             00429506
004296         88  DL005-PROCESS-CODE-INVALID   VALUE '08'.             00429606
004297         88  DL005-CALLED-MODULE-FAILURE  VALUE '98'.             00429709
004300         88  DL005-INVALID-ACCESS         VALUE '99'.             00430000
004400     05  DL005-RETURN-SQLCODES.                                   00440000
004500         10  DL005-ASGMT-SQLCODE          PIC  S9(9).             00450000
004600             88  DL005-ASGMT-NOT-FOUND    VALUE  +100.            00460000
004700             88  DL005-ASGMT-CONTENTION   VALUES -904 -911 -913.  00470004
004800         10  DL005-FILLER                 PIC  X(32).             00480007
004810* THE FOLLOWING FIELD SHOULD CONTAIN THE ORIGINAL CALLING         00481009
004820* PROGRAM ASSOCIATED TO THE PROCESSING TO BE DONE.                00482009
004830     05  DL005-ORIG-CALLING-PGM-NM        PIC  X(08).             00483009
004900     05  DL005-FILLER                     PIC  X(17).             00490010
005000* THE FOLLOWING ARE TO CONTAIN PARAGRAPH NUMBERS ASSOCIATED TO    00500000
005100* THE ABOVE SQL RETURN CODES.                                     00510000
005300     05  DL005-SQL-ERROR-PARA             PIC  X(05).             00530010
005310     05  DL005-CALL-MOD-FAIL-NM           PIC  X(08).             00531009
005320     05  DL005-CALL-MOD-FAIL-ERR-CDE      PIC  X(02).             00532009
005400     05  DL005-FILLER                     PIC  X(10).             00540009
005500                                                                  00550000
005600     05  DL005-OUTPUT-FIELDS.                                     00560000
006010         10  DL005-ASSOC-FOUND-CODE       PIC  X(1).              00601001
006020             88  DL005-ASSOC-FOUND        VALUE 'Y'.              00602001
006030             88  DL005-ASSOC-NOT-FOUND    VALUE 'N'.              00603001
006031             88  DL005-ASSOC-NOT-ACTIVE   VALUE 'A'.              00603101
006040             88  DL005-ASSOC-LAST-ACTIVE  VALUE 'B'.              00604001
006050         10  DL005-ASSOC-TMST.                                    00605001
006060             15 DL005-ASSOC-YYYY          PIC  X(04).             00606001
006070             15 DL005-FILLER              PIC  X(01).             00607007
006080             15 DL005-ASSOC-MM            PIC  X(02).             00608001
006090             15 DL005-FILLER              PIC  X(01).             00609007
006100             15 DL005-ASSOC-DD            PIC  X(02).             00610001
006200             15 DL005-FILLER              PIC  X(01).             00620007
006300             15 DL005-ASSOC-HRS           PIC  X(02).             00630001
006400             15 DL005-FILLER              PIC  X(01).             00640007
006500             15 DL005-ASSOC-MIN           PIC  X(02).             00650001
006600             15 DL005-FILLER              PIC  X(01).             00660007
006700             15 DL005-ASSOC-SEC           PIC  X(02).             00670001
006800             15 DL005-FILLER              PIC  X(07).             00680007
007703         10  DL005-FILLER                 PIC  X(51).             00770307
007704                                                                  00770400
007705     05  DL005-FILLER                     PIC  X(111).            00770507
007706     05  DL005-SQLCA                      PIC  X(138).            00770600
007707 01  DL005-COMMAREA                       PIC  X(01).             00770700
007708 01  DL005-USER-PGM                       PIC  X(08)              00770800
007709                                          VALUE 'DLKUP002'.       00770900
