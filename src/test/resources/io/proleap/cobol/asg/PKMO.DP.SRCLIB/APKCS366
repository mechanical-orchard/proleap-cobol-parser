000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.    APKCS366.                                         00040000
000500 AUTHOR.        MARK BURNSIDE.                                    00050000
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060000
000700 DATE-WRITTEN.  01-27-99.                                         00070000
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*    A366 - ADJUSTMENT TRANSFER ENTRY                            *00100000
001100*                                                                *00110000
001200*    THIS PROGRAM ALLOWS THE USER TO PERFORM AN ADJUSTMENT       *00120000
001300*    TRANSFER.  A '53' TRANSACTION CODE AND AN '82' TRANSACTION  *00130000
001400*    CODE WILL BE ENTERED TO THE ADJUSTMENT JOURNAL FOR          *00140000
001500*    SUCCESSFUL ENTRY OF A MERCHANDISE TO EXPENSE TRANSFER.      *00150000
001600*    FOR A MERCHANDISE TO MERCHANDISE TRANSFER A '53'            *00160000
001700*    TRANSACTION CODE AND A '52' TRANSACTION CODE WILL BE        *00170000
001800*    ENTERED TO THE ADJUSTMENT JOURNAL.                          *00180000
001900******************************************************************00190000
002000* CHANGE LOG:                                                    *00200000
002100******************************************************************00210000
002200* DATE  10/20/99                                                 *00220000
002300*    CHANGE MADE: INSERTED CALL TO APKUP151 TO GET NEXT AVAILABLE*00230000
002400*    DOCUMENT NUMBER.  APKUP151 IS EXCLUSIVELY FOR ON-LINE       *00240000
002500*    APPLICATIONS.  PREVIOUS MODULE FOR NEXT AVAILABLE DOCUMENT  *00250000
002600*    NUMBER WAS DPKUP151 WHICH IS NOW EXCLUSIVELY FOR BATCH      *00260000
002700*    APPLICATIONS.                                               *00270000
002800*    MADE BY: MARK BURNSIDE           WR/IR #: 5998              *00280000
002900*                                                                *00290000
003000* DATE  08/23/00                                                 *00300000
003100*    CHANGE MADE: ADDED CODE TO INITIALIZE THE TWO NEW COLUMNS   *00310000
003200*    ADDED TO THE TADJRNL TABLE - MOS_DISC_PCT & MOS_DISC_AMT.   *00320000
003300*    MADE BY: MIKE BESKE              WR/IR #: 20224             *00330000
003400*                                                                *00340000
003500* DATE  12/13/00                                                 *00350000
003600*    RECOMPILED WITH NEW VERSION OF INPD500.                     *00360000
003700*    MADE BY: NANCY EILBES            WR/IR #: 20704             *00370000
003800*                                                                *00380000
003900* DATE  01/16/01                                                 *00390000
004000*    RECOMPILED WITH NEW VERSION OF INPD500.                     *00400000
004100*    MADE BY: L SCHALLHORN            WR/IR #: 20704             *00410000
004200*                                                                *00420000
004300* DATE  05/16/2002                                               *00430000
004400*    CHANGE MADE:  NI-SKU CHANGES.  THE 3 BYTE SKU-SEQ FIELD IS  *00440000
004500*    REPLACED WITH A NUMERIC 8 BYTE SKU FIELD.  CHANGES MADE TO  *00450000
004600*    WORKING STORAGE FIELDS AND TO PARAGRAPHS 2200, 3000, 3050,  *00460000
004700*    3200, 3360, 3370, 4400, 5010, 5020, 5030, 7800, AND 8200.   *00470000
004800*    MADE BY: KEVIN CATLIN                    WR/IR #: 21278     *00480000
004900*                                                                *00490000
005000*                                                                *00500000
005100*   02/10/2003                                                   *00510000
005200*      CHANGED CALL TO PEOPLESOFT TABLE TO USE NEW ALIAS         *00520000
005300*      NAMING STANDARD.                                          *00530000
005400*   MADE BY: L SCHALLHORN                 WR#: 23417             *00540000
005500*                                                                *00550000
005600*   05/05/2003                                                   *00560000
005700*      CHANGED THE WHERE CONDITION (IN 7800-VALIDATE-SKU) ON     *00570000
005800*      TSKXREF TO USE DEPT & CLASS INSTEAD OF DEPT_NBR & CL_NBR. *00580000
005900*      ADDED REDEFINES FOR THE ASC- FIELDS FOR CLASS AND DEPT FOR*00590000
006000*      NUMERIC DEFNS.  ADDED NEW W/S FIELDS DEFINED AS PACKED    *00600000
006100*      DECIMAL TO MATCH DEPT & CLASS AS HOST VARIABLES. THESE    *00610000
006200*      ARE USED IN THE 3360- AND 3370- PARAGRAPHS.               *00620000
006300*   05/28/2003 CHANGED PARAS 3360-, 3370- AND 7800- TO TAKE THE  *00630000
006400*      CLASS SCREEN INPUT VALUE AND USE THIS TO VALIDATE         *00640000
006500*      AGAINST SUBCLASS ON TSKXREF. THIS ALLOWS THE USER TO ENTER*00650000
006600*      THE SUBCLASS VALUE SO THAT IT IS RETAINED ON THE TADJDIS  *00660000
006700*      TABLE FOR INVENTORY CONTROL AS IS DONE PRIOR TO NI-SKU    *00670000
006800*      INSTALL.                                                  *00680000
006900*   MADE BY: MIKE BESKE                   WR#: 22557             *00690000
007000*                                                                *00700000
007100*   05/04/2004                                                   *00710000
007200*      REPLACED TSTR000 WITH XFT00003 AS PART OF THE STORE       *00720000
007300*      CONSTRAINTS PROJECT.  INCREASED THE LENGTH OF             *00730000
007400*      PV-STORE-NBR-3 FROM S9(03) TO S9(04) AND RENAMED IT       *00740000
007500*      PV-STORE-NBR-4.  RECODED PARA 7400-VALIDATE-STORE TO USE  *00750000
007600*      XFT00003 INSTEAD OF TSTR000.                              *00760000
007700*   MADE BY: MIKE BESKE                   WR#: 25805             *00770000
007800*                                                                *00780000
007900* DATE  09/20/2004                                               *00790000
008000*     CHANGE MADE: ADDED 'CURRENT DATE <= FINCL_CLO_DTE' TO      *00800000
008100*     SELECT STATEMENT THAT IS VALIDATING STORE NUMBER.          *00810000
008200*     PARAGRAPH 7400-VALIDATE-STORE WAS MODIFIED.                *00820000
008300*     MADE BY: KEVIN CATLIN            WR/IR #: P000693987       *00830000
008400*                                                                *00840000
008500* DATE  04/20/06                                                 *00850000
008600*    RECOMPILED WITH NEW VERSION OF INPD500.                     *00860000
008700*    MADE BY: R NOHE                  WR/IR #: 29606             *00870000
008800*                                                                *00880000
008900* DATE  07/28/2006                                               *00890000
009000*     CHANGE MADE:  RECOMPILE FROM PRODUCTION TO PICK UP CHANGES *00900000
009100*     TO APWS363 COPYBOOK.                                       *00910000
009200*     MADE BY: MIKE BESKE              WR/IR #: WR30824          *00920000
009300*                                                                *00930000
009400* DATE  03/27/2007                                               *00940000
009500*     CHANGE MADE: RECOMPILE FROM PRODUCTION TO INCORPORATE      *00950000
009600*     CHANGES TO PS_XFT_LOC TABLE FOR STORE DEMOGRAPHICS.        *00960000
009700*     MADE BY: KEVIN CATLIN            WR/IR #: WR31452          *00970000
009800*                                                                *00980000
009900* DATE  06/28/2007                                               *00990000
010000*     CHANGE MADE: MODIFIED LOGIC TO USE THE UPC RATHER THAN THE *01000000
010100*     SKU WHEN ENTERING MERCHANDISE TRANSFER TO EXPENSE ENTRIES. *01010000
010200*     THE SKU HOWEVER, IS STILL TO BE LOADED ON THE TADJDIS TBL. *01020000
010300*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR26484          *01030000
010400*                                                                *01040000
010500* DATE  07/02/2007                                               *01050000
010600*     CHANGE MADE: MODIFIED LOGIC TO USE THE TUPC INTR_UPC_ID    *01060000
010700*     INSTEAD OF THE TUPC UPC ID.  THE UPC-ID DOESN'T ALWAYS     *01070000
010800*     MATCH THE INTERNAL UPC ID ON TSXREF WHILE THE INTERNAL ON  *01080000
010900*     BOTH WILL.                                                 *01090000
011000*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: P001041473       *01100000
011100*                                                                *01110000
011200* DATE  07/20/2007                                               *01120000
011300*     CHANGE MADE: MODIFIED LOGIC IN 7800- TO LIMIT QUERY TO     *01130000
011400*     NOT SELECT RENUMBERED SKU'S.  RENUMBERING WAS ELIMINATED   *01140000
011500*     SEVERAL YEARS AGO, BUT AN OCCASIONAL RECORD DOES STILL     *01150000
011600*     EXIST.  BY NOT ALLOWING A SKU_STAT_CDE = '98' WILL         *01160000
011700*     RESOLVE THE SELECTION OF MORE THAN ONE EXISTING VERSIONS   *01170000
011800*     OF THE SAME UPC.                                           *01180000
011900*     MADE BY: MICHELE RINDFLEISCH     WR/IR #: PM01049499       *01190000
012000*                                                                *01200000
012100* DATE  09/04/2009                                               *01210000
012200*     CHANGE MADE: BYPASS CUTOFF DATE PROMPT, (INPD500),         *01220000
012300*     TO ALLOW DBA'S TO CHANGE TABLES FOR HILO PROJECT.          *01230000
012400*     MADE BY: ROLF NOHE               WR/IR #: WR33304          *01240000
012500*                                                                *01250000
012600* DATE  09/08/2009                                               *01260000
012700*     CHANGE MADE: BACK OUT BYPASS CUTOFF DATE PROMPT,           *01270000
012800*     AND RECOMPILE WITH NEW VERSION OF INPD500.                 *01280000
012900*     MADE BY: ROLF NOHE               WR/IR #: WR33304          *01290000
013000*                                                                *01300000
013100* DATE 01/19/2010                                                *01310000
013200*     CHANGE MADE: ADDED THE DOC DATE LABEL AND ASSOCIATED FIELDS*01320000
013300*     TO LINE FOUR OF THE APKM366 MAP ALONG WITH REMOVING THE    *01330000
013400*     CUTOFF DATE LABEL AND ASSOCIATED FIELDS.  REMOVED ALL LOGIC*01340000
013500*     IN THE PROGRAM RELATING TO THE INVENTORY CUTOFF DATE       *01350000
013600*     INCLUDING THE INPD500 AND INWS500 COPYBOOKS.  ADDED        *01360000
013700*     ASC-DOC-DATE TO THE ASC-SPECIFIC-COMMAREA FOR THE NEW MAP  *01370000
013800*     FIELD.  THE INCLUSION OF THIS FIELD INVOLVED ADDING LOGIC  *01380000
013900*     TO THE 2200-MOVE-SCREEN-TO-COMMAREA, 4400-MOVE-COMMAREA-TO-*01390000
014000*     SCREEN, AND 5000-FORMAT-COMMON-DATA PARAGRAPHS ALONG WITH  *01400000
014100*     CREATING PARAGRAPH 3020-EDIT-DOC-DATE, WHICH IS CALLED IN  *01410000
014200*     3000-EDIT-DATA-IN-COMMAREA.                                *01420000
014300*     MADE BY: KRYSTEN LEROY           WR/IR #: WR37487          *01430000
014400* DATE  09/20/2011                                                01440016
014500*     CHANGE MADE: REMOVED DB2 CALL TO FI_GL_ACCOUNT_TBL          01450017
014600*     AND REPLACED WITH A CALL TO THE APKUT274 MODULE.  THIS      01460017
014700*     IS NEEDED AS A RESULT OF THE PEOPLESOFT FI UPGRADE AND      01470017
014800*     RE-PLATFORM AS FI_GL_ACCOUNT_TBL IS NOW IN ORACLE.          01480017
014900*     CALLS TO THE 4950-VALIDATE-ACCOUNT-NO PARAGRAPH ARE         01490017
015000*     REMOVED AND REPLACED WITH A CALL TO APKUT274.               01500017
015100*     ALSO EXCHANGED THE XFT00003 PEOPLE SOFT TABLE WITH THE DB2  01510017
015200*     VERSION - XFT00017 TABLE.                                   01520017
015300*     IT STILL USES DP013-DB2-ABEND SO RELEVANT INFO IS DISPLAYED.01530031
015400*     MADE BY: STEVE KRIEG             WR/IR #: WR37038           01540017
015500*                                                                *01550024
015600* DATE  09/20/2018                                               *01560024
015700*     CHANGE MADE: MAINFRAME REFACTORING - REMOVED CGU042MC      *01570025
015800*     MADE BY: JIM HUNTER               WR/IR #: CHG0208819      *01580024
015810*                                                                *01581026
015820*    DATE  04/05/2019                                            *01582032
015830*    CHANGE MADE: REMOVED CALL TO PROGRAM APKUT274 TO VALIDATE   *01583032
015840*    ACCOUNT NUMBER.  REPLACED WITH A LOOKUP ON NEW DB2 TABLE    *01584032
015850*    APT_ACCT_TBL.                                               *01585032
015860*    MADE BY: COGNIZANT               WR/IR #: CHG0221352        *01586032
015870* DATE  09/01/2021                                                01587034
015880*            - CHANGE CALL OF  DPKUT100  TO                     * 01588034
015890*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 01589034
015891*              MAKING THE CALL DYNAMIC VS STATIC                * 01589134
015892*     MADE BY: GERMAN BANDA            WR/IR #: CHG0261053        01589235
015893*                                                                *01589334
015894* DATE  10/24/2022                                               *01589436
015895*     CHANGE MADE: ADD COPYBOOK DPWS930                          *01589536
015896*     CHANGE CICS ARCHITECTURE CALL TO USE DP930-CICS-ARCH-API   *01589636
015897*     MADE BY: BOB MCASEY              WR/IR #: CHG0276864       *01589736
015900******************************************************************01590017
016000                                                                  01600000
016100 ENVIRONMENT DIVISION.                                            01610000
016200                                                                  01620000
016300 DATA DIVISION.                                                   01630000
016400                                                                  01640000
016500 WORKING-STORAGE SECTION.                                         01650000
016600                                                                  01660000
016700 01  DK-DB2-KEYS.                                                 01670000
016800     05  DK-OPERATING-COMPANY           PIC  X(02)  VALUE SPACE.  01680000
016900     05  DK-APLSYS-CDE                  PIC  X(02)  VALUE SPACE.  01690000
017000     05  DK-DOCUMENT-NO                 PIC  X(16)  VALUE SPACE.  01700000
017100     05  DK-TRAN-CODE-LOW               PIC  X(02)  VALUE         01710000
017200                                                      LOW-VALUES. 01720000
017300     05  DK-TRAN-CODE-HIGH              PIC  X(02)  VALUE         01730000
017400                                                      HIGH-VALUES.01740000
017500     05  DK-PO-NBR-LOW                  PIC  S9(09) VALUE +0      01750000
017600                                                    COMP.         01760000
017700     05  DK-PO-NBR-HIGH                 PIC  S9(09) VALUE +0      01770000
017800                                                    COMP.         01780000
017900     05  DK-VND-NBR-LOW                 PIC  X(09) VALUE          01790000
018000                                                      HIGH-VALUES.01800000
018100     05  DK-VND-NBR-HIGH                PIC  X(09) VALUE          01810000
018200                                                      LOW-VALUES. 01820000
018300     05  DK-ENT-ID                      PIC  S9(09).              01830000
018400*                                                                 01840000
018500 01  PC-PROGRAM-CONSTANTS.                                        01850000
018600     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'AP366A  '.  01860000
018700     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'APKM366 '.  01870000
018800     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'APKCS366'.  01880000
018900     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           01890000
019000                                              COMP.               01900000
019100     05  PC-SEL-QUEUE-ITEM        PIC S9(04)  VALUE  +1           01910000
019200                                              COMP SYNC.          01920000
019300     05  PC-SEL-QUEUE-SEQ         PIC  9(01)  VALUE 3.            01930000
019400     05  PC-MAX-RETRIES-DOC-NO    PIC S9(04)  VALUE +10           01940000
019500                                              COMP.               01950000
019600     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE  +3           01960000
019700                                              COMP.               01970000
019800     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE +1            01980000
019900                                              COMP.               01990000
020000     05  PC-APKUP151-PGM          PIC  X(08)  VALUE 'APKUP151'.   02000000
020200     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          02020000
020300     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       02030000
020400     05  PC-INVC-DTE-BEG-LIMIT    PIC  X(10)  VALUE               02040000
020500                                                    '1988-01-01'. 02050000
020600     05  PC-TSYMSG-NUMBERS.                                       02060000
020700         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       02070000
020800         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       02080000
020900         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       02090000
021000         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       02100000
021100         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       02110000
021200         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       02120000
021300         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       02130000
021400         10  PC-TSYMSG-00095      PIC  9(05)  VALUE  00095.       02140000
021500         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       02150000
021600         10  PC-TSYMSG-00116      PIC  9(05)  VALUE  00116.       02160000
021700         10  PC-TSYMSG-00118      PIC  9(05)  VALUE  00118.       02170000
021800         10  PC-TSYMSG-00148      PIC  9(05)  VALUE  00148.       02180000
021900         10  PC-TSYMSG-00224      PIC  9(05)  VALUE  00224.       02190000
022000         10  PC-TSYMSG-00224      PIC  9(05)  VALUE  00224.       02200000
022100         10  PC-TSYMSG-00068      PIC  9(05)  VALUE  00068.       02210000
022200         10  PC-TSYMSG-00316      PIC  9(05)  VALUE  00316.       02220000
022300         10  PC-TSYMSG-00354      PIC  9(05)  VALUE  00354.       02230000
022400         10  PC-TSYMSG-00388      PIC  9(05)  VALUE  00388.       02240000
022500         10  PC-TSYMSG-00398      PIC  9(05)  VALUE  00398.       02250000
022600         10  PC-TSYMSG-00858      PIC  9(05)  VALUE  00858.       02260000
022700         10  PC-TSYMSG-01095      PIC  9(05)  VALUE  01095.       02270000
022800         10  PC-TSYMSG-01904      PIC  9(05)  VALUE  01904.       02280000
022900         10  PC-TSYMSG-01910      PIC  9(05)  VALUE  01910.       02290000
023000         10  PC-TSYMSG-01919      PIC  9(05)  VALUE  01919.       02300000
023100         10  PC-TSYMSG-01925      PIC  9(05)  VALUE  01925.       02310000
023200         10  PC-TSYMSG-01941      PIC  9(05)  VALUE  01941.       02320000
023300         10  PC-TSYMSG-01942      PIC  9(05)  VALUE  01942.       02330000
023400         10  PC-TSYMSG-02059      PIC  9(05)  VALUE  02059.       02340000
023500         10  PC-TSYMSG-03566      PIC  9(05)  VALUE  03566.       02350000
023600         10  PC-TSYMSG-03567      PIC  9(05)  VALUE  03567.       02360000
023700         10  PC-TSYMSG-03580      PIC  9(05)  VALUE  03580.       02370000
023800*                                                                 02380000
023900 01  PS-PROGRAM-SWITCHES.                                         02390000
024000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         02400000
024100         88  PS-ERROR                         VALUE  'Y'.         02410000
024200         88  PS-NO-ERROR                      VALUE  'N'.         02420000
024300     05  PS-NUMBER-LOCK-SW        PIC  X(01)  VALUE  'N'.         02430000
024400         88  PS-NUMBER-LOCKED                 VALUE  'Y'.         02440000
024500         88  PS-NUMBER-NOT-LOCKED             VALUE  'N'.         02450000
024600     05  PS-VALID-DATE-SW         PIC  X(01).                     02460000
024700         88  PS-VALID-DATE                          VALUE 'Y'.    02470000
024800         88  PS-INVALID-DATE                        VALUE 'N'.    02480000
024900         88  PS-DATE-RANGE-ERROR                    VALUE 'E'.    02490000
025000*                                                                 02500000
025100 01  PV-PROGRAM-VARIABLES.                                        02510000
025200     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            02520000
025300                                              COMP SYNC.          02530000
025400     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            02540000
025500                                              COMP SYNC.          02550000
025600     05  PV-LOCK-RETRY-COUNTER    PIC S9(04)  VALUE +0            02560000
025700                                              COMP SYNC.          02570000
025800     05  PV-MSG-VAR-CNT           PIC S9(04)  VALUE +0            02580000
025900                                              COMP SYNC.          02590000
026000     05  PV-NUM4                  PIC  9(04).                     02600000
026100     05  PV-NUM4-X REDEFINES                                      02610000
026200         PV-NUM4                  PIC  X(04).                     02620000
026300     05  PV-NUM17                 PIC  Z(16)9.                    02630000
026400     05  PV-NUM17-X REDEFINES                                     02640000
026500         PV-NUM17                 PIC  X(17).                     02650000
026600     05  PV-10V99                 PIC  ----------.99.             02660000
026700     05  PV-10V99-X REDEFINES                                     02670000
026800         PV-10V99                 PIC  X(13).                     02680000
026900     05  PV-NEW-DOC-NO-9          PIC  S9(16).                    02690000
027000     05  PV-STORE-NBR-4           PIC  S9(04).                    02700000
027100     05  PV-CCYYMMDD-DATE               PIC  X(10).               02710000
027200     05  PV-CCYYMMDD-DATE-RDF           REDEFINES                 02720000
027300         PV-CCYYMMDD-DATE.                                        02730000
027400         10  PV-CCYY                    PIC  X(04).               02740000
027500         10  PV-CCYY-9   REDEFINES PV-CCYY                        02750000
027600                                        PIC  9(04).               02760000
027700         10  PV-CCYY-RDF REDEFINES PV-CCYY.                       02770000
027800             15  PV-CC                  PIC  9(02).               02780000
027900             15  PV-YY                  PIC  9(02).               02790000
028000         10  PV-DASH1                   PIC  X(01).               02800000
028100         10  PV-MM                      PIC  X(02).               02810000
028200         10  PV-MM-9     REDEFINES PV-MM                          02820000
028300                                        PIC  9(02).               02830000
028400         10  PV-DASH2                   PIC  X(01).               02840000
028500         10  PV-DD                      PIC  X(02).               02850000
028600         10  PV-DD-9     REDEFINES PV-DD                          02860000
028700                                        PIC  9(02).               02870000
028800     05  PV-ENTRY-ID                    PIC  X(08).               02880000
028900     05  PV-53-GROSS-COST               PIC  S9(10)V99.           02890000
029000     05  PV-53-RETAIL-AMT               PIC  S9(10)V99.           02900000
029100     05  PV-DEPARTMENT                  PIC  S9(4)V COMP-3.       02910000
029200     05  PV-CLASS                       PIC  S9(4)V COMP-3.       02920000
029210     05  PV-ACCT-NBR                    PIC  X(10) VALUE SPACES.  02921026
029220     05  PV-CURRENT-DATE                PIC  X(10) VALUE SPACES.  02922026
029300                                                                  02930000
029400 01  BARCODE-CHK-DIGIT-AREA.                                      02940000
029500     05  PV-HOLD-BARCODE          PIC X(9)     VALUE SPACES.      02950000
029600     05  PV-HOLD-BARCODE-9    REDEFINES PV-HOLD-BARCODE           02960000
029700                                  PIC 9(9).                       02970000
029800                                                                  02980000
029900 EJECT                                                            02990000
029910******************************************************************02991026
029920*  COMMUNICATIONS AREA2 FOR DB2                                  *02992026
029930******************************************************************02993026
029940     COPY SQLCA2.                                                 02994026
029950*                                                                 02995026
030000******************************************************************03000000
030100*    CALLING PARAMETERS FOR LOCKING MODULE DPKCS044              *03010000
030200******************************************************************03020000
030300                                                                  03030000
030400     COPY DPWS044.                                                03040000
030500 EJECT                                                            03050000
030600******************************************************************03060000
030700*    RECORD LAYOUT FOR THE LIST SELECTION TEMP STORAGE QUEUE.    *03070000
030800******************************************************************03080000
030900                                                                  03090000
031000     COPY APWS362.                                                03100000
031100     EJECT                                                        03110000
031200******************************************************************03120000
031300*     RECORD LAYOUT FOR TEMP STORAGE QUEUE FOR PASSING HEADER    *03130000
031400*     ADJUSTMENT DATA TO DETAIL SCREENS.                         *03140000
031500******************************************************************03150000
031600                                                                  03160000
031700     COPY APWS363.                                                03170000
031800                                                                  03180000
031900******************************************************************03190000
032000*    MAP LAYOUT                                                  *03200000
032100******************************************************************03210000
032200                                                                  03220000
032300     COPY APKM366.                                                03230000
032400                                                                  03240000
032500     EJECT                                                        03250000
032600******************************************************************03260000
032700*    ATTRIBUTE SETTINGS COPYBOOK.                                *03270000
032800******************************************************************03280000
032900                                                                  03290000
033000     COPY DPWS015.                                                03300000
033100                                                                  03310000
033200******************************************************************03320000
033300*    FUNCTION KEYS COPYBOOK                                      *03330000
033400******************************************************************03340000
033500                                                                  03350000
033600     COPY DPWS016.                                                03360000
033700******************************************************************03370000
033800*    WORK AREA PASSED TO MODULE APKUP151 FOR GETTING NEXT        *03380000
033900*    AVAILABLE DOCUMENT NUMBER.                                  *03390000
034000******************************************************************03400000
034100     COPY APWS364.                                                03410000
034200                                                                  03420000
034300 01 WS364-COMMAREA               PIC X(01).                       03430000
034500                                                                  03450000
034600 EJECT                                                            03460000
034700                                                                  03470000
034800******************************************************************03480000
034900*    WORK AREA PASSED IN CALL TO DPKUT500 DATE ROUTINE           *03490000
035000******************************************************************03500000
035100     COPY DPWS500.                                                03510000
035200                                                                  03520000
035300******************************************************************03530000
035400*    WORK AREA FOR NUMERIC EDIT ROUTINE                          *03540000
035500******************************************************************03550000
035600     COPY DPWS010I.                                               03560000
035700******************************************************************03570000
035800* PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).       *03580000
035900******************************************************************03590000
036000     COPY DPWS030.                                                03600000
036100     COPY DPWS930.                                                03610036
036500 EJECT                                                            03650000
036600******************************************************************03660000
036700*    STANDARD COMMAREA.                                          *03670000
036800******************************************************************03680000
036900                                                                  03690000
037000     COPY DPWS020.                                                03700000
037100     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03710000
037200                                                                  03720000
037300******************************************************************03730000
037400*    INTER-APPLICATION COMMAREA.                                 *03740000
037500******************************************************************03750000
037600                                                                  03760000
037700         10  INTER-APPL-COMM-AREA PIC X(200).                     03770000
037800     COPY APWS361.                                                03780000
037900******************************************************************03790000
038000*    SPECIFIC COMMMAREA FOR APKCS366.                            *03800000
038100******************************************************************03810000
038200         10  ASC-SPECIFIC-COMMAREA.                               03820000
038300             15  ASC-INT-APPL-FORMAT-IND     PIC  X(01).          03830000
038400                 88  ASC-INTER-APPL-ADD                 VALUE ' '.03840000
038500             15  ASC-ACTION-SW               PIC  X(03).          03850000
038600                 88  ASC-ADD-PENDING         VALUE 'ADD'.         03860000
038700                 88  ASC-ADD-REQUESTED       VALUE 'REQ'.         03870000
038800                 88  ASC-ADD-CONFIRMED       VALUE 'CNF'.         03880000
038900             15  ASC-ADD-SUCCESSFUL-SW       PIC  X(01).          03890000
039000                 88  ASC-ADD-NOT-SUCCESSFUL  VALUE ' '.           03900000
039100                 88  ASC-ADD-SUCCESSFUL      VALUE 'Y'.           03910000
039200             15  ASC-STORE-WITHIN-INV-IND    PIC  X(01).          03920000
039300                 88  ASC-NO-STORE-IN-PER     VALUE 'N'.           03930000
039400                 88  ASC-STORE-WITHIN-PER    VALUE 'Y'.           03940000
039500             15  ASC-DUP-DOC-NO-SW           PIC  X(01).          03950000
039600                 88  ASC-DUP-DOC             VALUE 'Y'.           03960000
039700                 88  ASC-NO-DUP-DOC          VALUE 'N'.           03970000
039800             15  ASC-CLASS-FOUND-SW          PIC  X(01).          03980000
039900                 88  ASC-CLASS-FOUND         VALUE 'Y'.           03990000
040000                 88  ASC-CLASS-NOT-FOUND     VALUE 'N'.           04000000
040100             15  ASC-ENT-FOUND-SW            PIC  X(01).          04010000
040200                 88  ASC-ENT-FOUND           VALUE 'Y'.           04020000
040300                 88  ASC-ENT-NOT-FOUND       VALUE 'N'.           04030000
040400             15  ASC-VENDOR-FOUND-SW         PIC  X(01).          04040000
040500                 88  ASC-VENDOR-NOT-FOUND               VALUE 'Y'.04050000
040600                 88  ASC-VENDOR-FOUND                   VALUE 'N'.04060000
040700             15  ASC-TRANSFER-TYPE-IND       PIC  X(01).          04070000
040800                 88  ASC-NO-TRANS                       VALUE ' '.04080000
040900                 88  ASC-EXP-TRANS                      VALUE 'E'.04090000
041000                 88  ASC-MER-TRANS                      VALUE 'M'.04100000
041100             15  ASC-DEPARTMENT-FOUND-SW     PIC  X(01).          04110000
041200                 88  ASC-DEPT-NOT-FOUND                 VALUE 'Y'.04120000
041300                 88  ASC-DEPT-FOUND                     VALUE 'N'.04130000
041400             15  ASC-ACCOUNT-NO-FOUND-SW     PIC  X(01).          04140000
041500                 88  ASC-ACCT-NOT-FOUND                 VALUE 'Y'.04150000
041600                 88  ASC-ACCT-FOUND                     VALUE 'N'.04160000
041700             15  ASC-STORE-FOUND-SW          PIC  X(01).          04170000
041800                 88  ASC-STORE-NOT-FOUND                VALUE 'Y'.04180000
041900                 88  ASC-STORE-FOUND                    VALUE 'N'.04190000
042000             15  ASC-DOCUMENT-FOUND-SW       PIC   X(01).         04200000
042100                 88  ASC-DOCUMENT-FOUND                 VALUE 'Y'.04210000
042200                 88  ASC-DOCUMENT-NOT-FOUND             VALUE 'N'.04220000
042300                 88  ASC-MULTIPLE-DOCUMENTS             VALUE 'M'.04230000
042400             15  ASC-KEY-FIELDS.                                  04240000
042500                 20  ASC-KEY-VEND-NUMBER     PIC  X(09).          04250000
042600                 20  ASC-KEY-TRAN-CODE       PIC  X(02).          04260000
042700                 20  ASC-KEY-DOC-NUMBER      PIC  X(16).          04270000
042800                 20  ASC-KEY-DOC-DATE        PIC  X(10).          04280000
042900             15  ASC-ALPHA-FIELDS.                                04290000
043000                 20  ASC-ALP-PO-NBR          PIC  X(09).          04300000
043100                 20  ASC-ALP-PO-NBR-9  REDEFINES                  04310000
043200                         ASC-ALP-PO-NBR      PIC  9(09).          04320000
043300                 20  ASC-ALP-FROM-UPC        PIC  X(17).          04330000
043400                 20  ASC-ALP-FROM-UPC-9  REDEFINES                04340000
043500                         ASC-ALP-FROM-UPC    PIC  9(16)V.         04350000
043600                 20  ASC-ALP-TO-UPC          PIC  X(17).          04360000
043700                 20  ASC-ALP-TO-UPC-9  REDEFINES                  04370000
043800                         ASC-ALP-TO-UPC      PIC   9(16)V.        04380000
043900                 20  ASC-FROM-UPC            PIC  S9(16)V.        04390000
044000                 20  ASC-TO-UPC              PIC  S9(16)V.        04400000
044100                 20  ASC-ALP-FROM-STORE      PIC  X(04).          04410000
044200                 20  ASC-ALP-TO-STORE        PIC  X(04).          04420000
044300                 20  ASC-ALP-NET-COST.                            04430000
044400                     25  ASC-ALP-NET-COST-9  PIC   9(10)V99.      04440000
044500                 20  ASC-ALP-RET-COST        PIC   X(13).         04450000
044600                 20  ASC-ALP-RET-COST-9  REDEFINES                04460000
044700                         ASC-ALP-RET-COST    PIC  -9(10)V99.      04470000
044800                 20  ASC-ALP-GROSS-COST      PIC   X(13).         04480000
044900                 20  ASC-ALP-GRO-COST-9  REDEFINES                04490000
045000                         ASC-ALP-GROSS-COST  PIC  -9(10)V99.      04500000
045100             15  ASC-CURR-PSTG-FYR-NBR       PIC  X(04).          04510000
045200             15  ASC-CURR-PSTG-FMN-NBR       PIC  X(02).          04520000
045300             15  ASC-CURR-PSTG-FWK-NBR       PIC  X(02).          04530000
045400             15  ASC-PREV-PSTG-FYR-NBR       PIC  X(04).          04540000
045500             15  ASC-PREV-PSTG-FMN-NBR       PIC  X(02).          04550000
045600             15  ASC-PREV-PSTG-FWK-NBR       PIC  X(02).          04560000
045700             15  ASC-CURRENT-DATE            PIC  X(10).          04570000
045800             15  ASC-SCREEN-FIELDS.                               04580000
045900                 20  ASC-DOC-NUMBER          PIC  X(16).          04590000
046000                 20  ASC-DOC-DATE            PIC  X(10).          04600000
046100                 20  ASC-DOC-DATE-RDF REDEFINES                   04610000
046200                     ASC-DOC-DATE.                                04620000
046300                     25  ASC-DOC-DATE-CC     PIC  X(02).          04630000
046400                     25  ASC-DOC-DATE-YY     PIC  X(02).          04640000
046500                     25  FILLER              PIC  X(01).          04650000
046600                     25  ASC-DOC-DATE-MM     PIC  X(02).          04660000
046700                     25  FILLER              PIC  X(01).          04670000
046800                     25  ASC-DOC-DATE-DD     PIC  X(02).          04680000
046900                 20  ASC-DET-COST            PIC  S9(10)V99.      04690000
047000                 20  ASC-DET-RETAIL          PIC  S9(10)V99.      04700000
047100                 20  ASC-VENDOR-NUMBER       PIC  X(10).          04710000
047200                 20  ASC-TO-VENDOR-NUMBER    PIC  X(10).          04720000
047300                 20  ASC-VENDOR-NAME         PIC  X(30).          04730000
047400                 20  ASC-ENT-ID              PIC  S9(09).         04740000
047500                 20  ASC-TO-ENT-ID           PIC  S9(09).         04750000
047600                 20  ASC-FROM-DEPARTMENT     PIC  X(03).          04760000
047700                 20  ASC-FROM-DEPARTMENT-9 REDEFINES              04770000
047800                     ASC-FROM-DEPARTMENT     PIC  9(03).          04780000
047900                 20  ASC-TO-DEPARTMENT       PIC  X(03).          04790000
048000                 20  ASC-TO-DEPARTMENT-9 REDEFINES                04800000
048100                     ASC-TO-DEPARTMENT       PIC  9(03).          04810000
048200                 20  ASC-ACCT-NO             PIC  X(06).          04820000
048300                 20  ASC-FROM-CLASS          PIC  X(02).          04830000
048400                 20  ASC-FROM-CLASS-9 REDEFINES ASC-FROM-CLASS    04840000
048500                                             PIC  9(02).          04850000
048600                 20  ASC-TO-CLASS            PIC  X(02).          04860000
048700                 20  ASC-TO-CLASS-9 REDEFINES ASC-TO-CLASS        04870000
048800                                             PIC  9(02).          04880000
048900                 20  ASC-TO-STORE            PIC  9(04).          04890000
049000                 20  ASC-FROM-SKU            PIC  S9(08).         04900000
049100                 20  ASC-TO-SKU              PIC  S9(08).         04910000
049200                 20  ASC-FROM-STORE          PIC  9(04).          04920000
049300                 20  ASC-GROSS-COST          PIC  S9(10)V99.      04930000
049400                 20  ASC-RETAIL-AMT          PIC  S9(10)V99.      04940000
049500     EJECT                                                        04950000
049600******************************************************************04960000
049700*    ABEND PROCESSING COPYBOOK.                                  *04970000
049800******************************************************************04980000
049900                                                                  04990000
050000     COPY DPWS013.                                                05000000
050100                                                                  05010000
050200*    DB2 AREA FOR TADJRNL                                         05020000
050300                                                                  05030000
050400     EXEC SQL                                                     05040000
050500          INCLUDE TADJRNL                                         05050000
050600     END-EXEC.                                                    05060000
050700                                                                  05070000
050800*    DB2 AREA FOR TAJPSINT                                        05080000
050900                                                                  05090000
051000     EXEC SQL                                                     05100000
051100          INCLUDE TAJPSINT                                        05110000
051200     END-EXEC.                                                    05120000
051300                                                                  05130000
051400*    DB2 AREA FOR TINVPAR                                         05140000
051500                                                                  05150000
051600     EXEC SQL                                                     05160000
051700          INCLUDE TINVPAR                                         05170000
051800     END-EXEC.                                                    05180000
051900                                                                  05190000
052000*    DB2 AREA FOR TADJDIS                                         05200000
052100                                                                  05210000
052200     EXEC SQL                                                     05220000
052300          INCLUDE TADJDIS                                         05230000
052400     END-EXEC.                                                    05240000
052500                                                                  05250000
052600*    DB2 AREA FOR TAPCNTL                                         05260000
052700                                                                  05270000
052800     EXEC SQL                                                     05280000
052900          INCLUDE TAPCNTL                                         05290000
053000     END-EXEC.                                                    05300000
053100                                                                  05310000
053200*    DB2 AREA FOR TEXTENT                                         05320000
053300                                                                  05330000
053400     EXEC SQL                                                     05340000
053500          INCLUDE TEXTENT                                         05350000
053600     END-EXEC.                                                    05360000
053700                                                                  05370000
053800*    DB2 AREA FOR TENTNME                                         05380000
053900                                                                  05390000
054000     EXEC SQL                                                     05400000
054100          INCLUDE TENTNME                                         05410000
054200     END-EXEC.                                                    05420000
054300                                                                  05430000
054400*    DB2 AREA FOR XFT00017                                        05440002
054500                                                                  05450002
054600     EXEC SQL                                                     05460002
054700          INCLUDE XFT00017                                        05470002
054800     END-EXEC.                                                    05480002
054900                                                                  05490002
055000*    DB2 AREA FOR XFT00003                                        05500002
055100*                                                                 05510002
055200*    EXEC SQL                                                     05520002
055300*         INCLUDE XFT00003                                        05530002
055400*    END-EXEC.                                                    05540002
055500                                                                  05550002
055600*    DB2 AREA FOR PFI00002                                        05560004
055700                                                                  05570004
055800*    EXEC SQL                                                     05580011
055900*         INCLUDE PFI00002                                        05590011
056000*    END-EXEC.                                                    05600004
056100                                                                  05610000
056200*    DB2 AREA FOR TSKXREF                                         05620000
056300                                                                  05630000
056400     EXEC SQL                                                     05640000
056500          INCLUDE TSKXREF                                         05650000
056600     END-EXEC.                                                    05660000
056700                                                                  05670000
056800*    DB2 AREA FOR TUPC                                            05680000
056900                                                                  05690000
057000     EXEC SQL                                                     05700000
057100          INCLUDE TUPC                                            05710000
057200     END-EXEC.                                                    05720000
057300                                                                  05730000
057400*    DB2 AREA FOR TMDARVS                                         05740000
057500                                                                  05750000
057600     EXEC SQL                                                     05760000
057700          INCLUDE TMDARVS                                         05770000
057800     END-EXEC.                                                    05780000
057900                                                                  05790000
058000*    DB2 AREA FOR TVNDSTL                                         05800000
058100                                                                  05810000
058200     EXEC SQL                                                     05820000
058300          INCLUDE TVNDSTL                                         05830000
058400     END-EXEC.                                                    05840000
058401                                                                  05840126
058410*--------------------------------------------------------------*  05841026
058420*     APT_ACCT_TBL DCLGEN                                      *  05842026
058430*--------------------------------------------------------------*  05843026
058440     EXEC SQL                                                     05844026
058450         INCLUDE APT00002                                         05845026
058500     END-EXEC.                                                    05850026
058510                                                                  05851026
058600*    DB2 AREA FOR COMMUNICATIONS                                  05860000
058700                                                                  05870000
058800     EXEC SQL                                                     05880000
058900          INCLUDE SQLCA                                           05890000
059000     END-EXEC.                                                    05900000
059100                                                                  05910000
059200 EJECT                                                            05920000
059300 LINKAGE SECTION.                                                 05930000
059400                                                                  05940000
059500 01  DFHCOMMAREA.                                                 05950000
059600     05  FILLER                         OCCURS  1 TO 4072 TIMES   05960000
059700                                        DEPENDING ON EIBCALEN.    05970000
059800         10  FILLER                     PIC  X(01).               05980000
059900                                                                  05990000
060000***************************************************************** 06000000
060100** THIS IS THE CURSOR TO GATHER ONE DISTRIBUTION LINE FOR AN   ** 06010000
060200** ADJUSTMENT.  ONLY ONE FETCH WILL OCCUR.                     ** 06020000
060300***************************************************************** 06030000
060400                                                                  06040000
060500     EXEC SQL                                                     06050000
060600          DECLARE DET-CSR CURSOR FOR                              06060000
060700          SELECT                                                  06070000
060800            VND_NBR                                               06080000
060900           ,DOC_NBR                                               06090000
061000           ,DOC_DTE                                               06100000
061100           ,AP_TRN_CDE                                            06110000
061200           ,DISTRB_SEQ_NBR                                        06120000
061300           ,STR_NBR                                               06130000
061400           ,DEPT_NBR                                              06140000
061500           ,CL_NBR                                                06150000
061600           ,SKU_NBR                                               06160000
061700           ,GRO_COST_AMT                                          06170000
061800           ,RTL_AMT                                               06180000
061900           ,FRGT_AMT                                              06190000
062000           ,MISC_CHRG_AMT                                         06200000
062100           ,DISC_AMT                                              06210000
062200           ,NET_COST_AMT                                          06220000
062300         FROM TADJDIS                                             06230000
062400         WHERE VND_NBR     = :ADJRNL-VND-NBR                      06240000
062500         AND   DOC_NBR     = :ADJRNL-DOC-NBR                      06250000
062600         AND   DOC_DTE     = :ADJRNL-DOC-DTE                      06260000
062700         AND AP_TRN_CDE    = :ADJRNL-AP-TRN-CDE                   06270000
062800         AND DISTRB_SEQ_NBR IS NOT NULL                           06280000
062900         ORDER BY VND_NBR, DOC_NBR, DOC_DTE, AP_TRN_CDE,          06290000
063000                  DISTRB_SEQ_NBR                                  06300000
063100     END-EXEC.                                                    06310000
063200                                                                  06320000
063300 PROCEDURE DIVISION.                                              06330000
063400***************************************************************** 06340000
063500** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 06350000
063600** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 06360000
063700** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 06370000
063800**                                                             ** 06380000
063900** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 06390000
064000** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 06400000
064100***************************************************************** 06410000
064200 0000-MAIN-MODULE.                                                06420000
064300                                                                  06430000
064400     INITIALIZE DP030-CICS-API-FIELDS.                            06440000
064500                                                                  06450000
064600     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06460000
064700     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06470000
064800     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06480000
064900     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06490000
065000     MOVE LENGTH OF AP366AI        TO DP030-MAP-LENGTH (1).       06500000
065100     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06510000
065200                                                                  06520000
065300     PERFORM 0001-CALL-CICS-ARCH-API.                             06530000
065400                                                                  06540000
065500     PERFORM 1000-CONTROL-PROCESSING.                             06550000
065600                                                                  06560000
065700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06570000
065800                                                                  06580000
065900     PERFORM 0001-CALL-CICS-ARCH-API.                             06590000
066000                                                                  06600000
066100******************************************************************06610000
066200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **06620000
066300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **06630000
066400******************************************************************06640000
066500 0001-CALL-CICS-ARCH-API.                                         06650000
066600                                                                  06660000
066700     CALL DP930-CICS-ARCH-API  USING DFHEIBLK                     06670036
066800                                     DFHCOMMAREA                  06680036
066900                                     DP030-CICS-API-FIELDS        06690036
067000                                     DP020-STANDARD-COMMAREA      06700036
067100                                     AP366AI.                     06710036
067200                                                                  06720000
067300     IF  DP030-RC-CALL-SUCCESSFUL                                 06730000
067400         CONTINUE                                                 06740000
067500     ELSE                                                         06750000
067600         SET DP013-NO-ROLLBACK                                    06760000
067700             DP013-XCTL-DISPLAY-RESTART                           06770000
067800             DP013-CICS-ABEND      TO TRUE                        06780000
067900         MOVE 'BEFORE 0000-MAIN-MODULE'                           06790000
068000                                   TO DP013-PARAGRAPH             06800000
068210         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06821036
068220-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06822036
068300         MOVE DP030-RETURN-CODE                                   06830000
068400                                   TO DP013-MESSAGE-TEXT (3)      06840000
068500         PERFORM DP013-0000-PROCESS-ABEND                         06850000
068600     END-IF.                                                      06860000
068700 EJECT                                                            06870000
068800******************************************************************06880000
068900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06890000
069000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06900000
069100******************************************************************06910000
069200 1000-CONTROL-PROCESSING.                                         06920000
069300                                                                  06930000
069400     EVALUATE TRUE                                                06940000
069500         WHEN DP020-NEXT-ACT-INITIAL                              06950000
069600             INITIALIZE ASC-SPECIFIC-COMMAREA                     06960000
069700             PERFORM 1100-FIND-OBJECT-KEYS                        06970000
069800             IF PS-ERROR                                          06980000
069900                CONTINUE                                          06990000
070000             ELSE                                                 07000000
070100                PERFORM 7000-EVALUATE-MULT-PSTG                   07010000
070200                PERFORM 4000-BUILD-INITIAL-PANEL                  07020000
070300                PERFORM 3200-RESET-ATTRIBUTES                     07030000
070400              END-IF                                              07040000
070500                                                                  07050000
070600*        WHEN ASC-ADD-SUCCESSFUL                                  07060000
070700*            SET ASC-ADD-NOT-SUCCESSFUL TO TRUE                   07070000
070800*            INITIALIZE ASC-SPECIFIC-COMMAREA                     07080000
070900*            PERFORM 4000-BUILD-INITIAL-PANEL                     07090000
071000*            PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07100000
071100*            PERFORM 3200-RESET-ATTRIBUTES                        07110000
071200*            MOVE -1 TO ADOCNUML                                  07120000
071300                                                                  07130000
071400         WHEN DP020-NEXT-ACT-READ-MAP                             07140000
071500             PERFORM 2000-PROCESS-PANEL                           07150000
071600                                                                  07160000
071700         WHEN OTHER                                               07170000
071800             SET DP013-LOGIC-ABEND                                07180000
071900                 DP013-NO-ROLLBACK TO TRUE                        07190000
072000             MOVE '1000-CONTROL-PROCESSING'                       07200000
072100                                   TO DP013-PARAGRAPH             07210000
072200             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   07220000
072300                                   TO DP013-MESSAGE-TEXT(1)       07230000
072400             MOVE DP020-NEXT-APPL-ACTIVITY                        07240000
072500                                   TO DP013-MESSAGE-TEXT(2)       07250000
072600             PERFORM DP013-0000-PROCESS-ABEND                     07260000
072700     END-EVALUATE.                                                07270000
072800                                                                  07280000
072900******************************************************************07290000
073000* THIS PARAGRAPH WILL CARRY OVER ANY PERTINENT ENTERED FIELDS    *07300000
073100* FROM THE CRITERIA SPECIFICATION SCREEN.                        *07310000
073200******************************************************************07320000
073300 1100-FIND-OBJECT-KEYS.                                           07330000
073400                                                                  07340000
073500     SET ASC-ADD-PENDING           TO TRUE.                       07350000
073600     SET ASC-NO-STORE-IN-PER       TO TRUE.                       07360000
073700                                                                  07370000
073800     MOVE AP361-DOC-NO             TO ASC-KEY-DOC-NUMBER          07380000
073900                                      ASC-DOC-NUMBER.             07390000
074000     MOVE AP361-DEPT               TO ASC-FROM-DEPARTMENT.        07400000
074100     MOVE AP361-ACCT-NO            TO ASC-ACCT-NO.                07410000
074200                                                                  07420000
074300******************************************************************07430000
074400* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*07440000
074500* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*07450000
074600* EDITS.                                                         *07460000
074700******************************************************************07470000
074800 2000-PROCESS-PANEL.                                              07480000
074900                                                                  07490000
075000     EVALUATE TRUE                                                07500000
075100         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    07510000
075200             EVALUATE TRUE                                        07520000
075300                 WHEN ASC-ADD-REQUESTED                           07530000
075400                    PERFORM 5000-FORMAT-COMMON-DATA               07540000
075500                    PERFORM 5010-FORMAT-53-TRANS                  07550000
075600                    PERFORM 8100-INSERT-TADJRNL                   07560000
075700                    PERFORM 8200-INSERT-TADJDIS                   07570000
075800                    IF ASC-ADD-SUCCESSFUL                         07580000
075900                       PERFORM 5000-FORMAT-COMMON-DATA            07590000
076000                       IF ASC-EXP-TRANS                           07600000
076100                          PERFORM 5020-FORMAT-82-TRANS            07610000
076200                       ELSE                                       07620000
076300                          IF ASC-MER-TRANS                        07630000
076400                             PERFORM 5030-FORMAT-52-TRANS         07640000
076500                          END-IF                                  07650000
076600                       END-IF                                     07660000
076700                       PERFORM 8100-INSERT-TADJRNL                07670000
076800                       PERFORM 8200-INSERT-TADJDIS                07680000
076900                       IF ASC-ADD-SUCCESSFUL                      07690000
077000                        MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER  07700000
077100                          SET DP020-MSG-INFORMATIONAL TO TRUE     07710000
077200                          SET ASC-ADD-NOT-SUCCESSFUL TO TRUE      07720000
077300                          INITIALIZE ASC-SPECIFIC-COMMAREA        07730000
077400                          SET ASC-NO-STORE-IN-PER TO TRUE         07740000
077500                          SET ASC-ADD-PENDING TO TRUE             07750000
077600                          PERFORM 7000-EVALUATE-MULT-PSTG         07760000
077700                          PERFORM 4000-BUILD-INITIAL-PANEL        07770000
077800                       END-IF                                     07780000
077900                    END-IF                                        07790000
078000                                                                  07800000
078100* 0726           WHEN OTHER                                       07810000
078200* 0726                MOVE PC-TSYMSG-00118 TO DP020-MSG-NUMBER    07820000
078300* 0726                SET DP020-MSG-FATAL                         07830000
078400* 0726                    PS-ERROR        TO TRUE                 07840000
078500* 0726                PERFORM 3200-RESET-ATTRIBUTES               07850000
078600             END-EVALUATE                                         07860000
078700                                                                  07870000
078800         WHEN DP020-SRC-AID = DP016-CLEAR                         07880000
078900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07890000
079000             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07900000
079100                                                                  07910000
079200         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07920000
079300             INITIALIZE ASC-SPECIFIC-COMMAREA                     07930000
079400             PERFORM 7000-EVALUATE-MULT-PSTG                      07940000
079500             PERFORM 4000-BUILD-INITIAL-PANEL                     07950000
079600             SET ASC-NO-STORE-IN-PER TO TRUE                      07960000
079700             SET ASC-ADD-PENDING TO TRUE                          07970000
079800             PERFORM 3200-RESET-ATTRIBUTES                        07980000
079900                                                                  07990000
080000*        WHEN DP020-SRC-AID = DP016-PF13 AND                      08000000
080100*             PS-NO-ERROR                                         08010000
080200*            MOVE -1 TO ADOCNUML                                  08020000
080300*            PERFORM 4000-BUILD-INITIAL-PANEL                     08030000
080400*            PERFORM 3200-RESET-ATTRIBUTES                        08040000
080500                                                                  08050000
080600         WHEN OTHER                                               08060000
080700             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 08070000
080800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08080000
080900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08090000
081000             IF  PS-NO-ERROR                                      08100000
081100                 SET DP030-CONTINUE-GO TO TRUE                    08110000
081200                 PERFORM 2100-CHECK-FUNCTION-KEY                  08120000
081300             ELSE                                                 08130000
081400                 SET ASC-ADD-PENDING TO TRUE                      08140000
081500                 SET DP030-OVERRIDE-GO TO TRUE                    08150000
081600             END-IF                                               08160000
081700     END-EVALUATE.                                                08170000
081800                                                                  08180000
081900 EJECT                                                            08190000
082000******************************************************************08200000
082100** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **08210000
082200** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **08220000
082300** FROM THE CICS ARCHITECTURE API.                              **08230000
082400******************************************************************08240000
082500 2100-CHECK-FUNCTION-KEY.                                         08250000
082600                                                                  08260000
082700     EVALUATE TRUE                                                08270000
082800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              08280000
082900* COM BEGIN                                                       08290000
083000              IF ASC-ADD-REQUESTED AND                            08300000
083100                 NOT DP020-MSG-WARNING                            08310000
083200                 SET DP020-MSG-INFORMATIONAL TO TRUE              08320000
083300                 MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER         08330000
083400              END-IF                                              08340000
083500              IF ASC-ADD-PENDING                                  08350000
083600                 SET ASC-ADD-REQUESTED TO TRUE                    08360000
083700                 IF NOT DP020-MSG-WARNING                         08370000
083800                    SET DP020-MSG-INFORMATIONAL TO TRUE           08380000
083900                    MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER      08390000
084000                 END-IF                                           08400000
084100              END-IF                                              08410000
084200* COM END                                                         08420000
084300* 0726       PERFORM 5000-FORMAT-COMMON-DATA                      08430000
084400* 0726       PERFORM 5010-FORMAT-53-TRANS                         08440000
084500* 0726       PERFORM 8100-INSERT-TADJRNL                          08450000
084600* 0726       PERFORM 8200-INSERT-TADJDIS                          08460000
084700* 0726       IF ASC-ADD-SUCCESSFUL                                08470000
084800* 0726          PERFORM 5000-FORMAT-COMMON-DATA                   08480000
084900* 0726          IF ASC-EXP-TRANS                                  08490000
085000* 0726             PERFORM 5020-FORMAT-82-TRANS                   08500000
085100* 0726          ELSE                                              08510000
085200* 0726             IF ASC-MER-TRANS                               08520000
085300* 0726                PERFORM 5030-FORMAT-52-TRANS                08530000
085400* 0726             END-IF                                         08540000
085500* 0726          END-IF                                            08550000
085600* 0726          PERFORM 8100-INSERT-TADJRNL                       08560000
085700* 0726          PERFORM 8200-INSERT-TADJDIS                       08570000
085800* 0726          IF ASC-ADD-SUCCESSFUL                             08580000
085900* 0726             MOVE PC-TSYMSG-00034 TO DP020-MSG-NUMBER       08590000
086000* 0726             SET DP020-MSG-INFORMATIONAL TO TRUE            08600000
086100* 0726             SET ASC-ADD-NOT-SUCCESSFUL TO TRUE             08610000
086200* 0726             INITIALIZE ASC-SPECIFIC-COMMAREA               08620000
086300* 0726             SET ASC-NO-STORE-IN-PER TO TRUE                08630000
086400* 0726             MOVE DP015-PRO-DRK-MDT        TO ACUTMMA       08640000
086500* 0726                                              ACUTDDA       08650000
086600* 0726                                              ACUTYYA       08660000
086700* 0726                                              ALABELA       08670000
086800* 0726             MOVE DP015-HL-OFF             TO ACUTMMH       08680000
086900* 0726                                              ACUTDDH       08690000
087000* 0726                                              ACUTYYH       08700000
087100* 0726             PERFORM 7000-EVALUATE-MULT-PSTG                08710000
087200* 0726             PERFORM 4000-BUILD-INITIAL-PANEL               08720000
087300* 0726          END-IF                                            08730000
087400* 0726       END-IF                                               08740000
087500                                                                  08750000
087600         WHEN DP020-SRC-AID = DP016-ENTER                         08760000
087700             CONTINUE                                             08770000
087800                                                                  08780000
087900         WHEN OTHER                                               08790000
088000             SET DP013-NO-ROLLBACK                                08800000
088100                 DP013-XCTL-DISPLAY-RESTART                       08810000
088200                 DP013-CICS-ABEND  TO TRUE                        08820000
088300             MOVE '2100-CHECK-FUNCTION-KEY'                       08830000
088400                                   TO DP013-PARAGRAPH             08840000
088500             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      08850000
088600                                   TO DP013-MESSAGE-TEXT (1)      08860000
088700             PERFORM DP013-0000-PROCESS-ABEND                     08870000
088800     END-EVALUATE.                                                08880000
088900 EJECT                                                            08890000
089000******************************************************************08900000
089100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*08910000
089200* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *08920000
089300* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *08930000
089400******************************************************************08940000
089500 2200-MOVE-SCREEN-TO-COMMAREA.                                    08950000
089600                                                                  08960000
089700     IF  ADOCNUML > ZERO                                          08970000
089800         MOVE ADOCNUMI             TO ASC-DOC-NUMBER              08980000
089900     ELSE                                                         08990000
090000         IF  ADOCNUMF = DP015-ERASE-EOF                           09000000
090100             MOVE SPACE            TO ASC-DOC-NUMBER              09010000
090200         END-IF                                                   09020000
090300     END-IF.                                                      09030000
090400                                                                  09040000
090500     IF  ADOCMML > ZERO                                           09050000
090600         MOVE ADOCMMI              TO ASC-DOC-DATE-MM             09060000
090700     ELSE                                                         09070000
090800         IF ADOCMMF = DP015-ERASE-EOF                             09080000
090900            MOVE SPACE             TO ASC-DOC-DATE-MM             09090000
091000         END-IF                                                   09100000
091100     END-IF.                                                      09110000
091200     IF ADOCDDL > ZERO                                            09120000
091300        MOVE ADOCDDI               TO ASC-DOC-DATE-DD             09130000
091400     ELSE                                                         09140000
091500        IF ADOCDDF = DP015-ERASE-EOF                              09150000
091600           MOVE SPACE              TO ASC-DOC-DATE-DD             09160000
091700        END-IF                                                    09170000
091800     END-IF.                                                      09180000
091900     IF ADOCYYL > ZERO                                            09190000
092000        MOVE ADOCYYI               TO ASC-DOC-DATE-YY             09200000
092100     ELSE                                                         09210000
092200        IF ADOCYYF = DP015-ERASE-EOF                              09220000
092300           MOVE SPACE              TO ASC-DOC-DATE-YY             09230000
092400        END-IF                                                    09240000
092500     END-IF.                                                      09250000
092600                                                                  09260000
092700     IF  ATOESTRL > ZERO                                          09270000
092800         MOVE ATOESTRI            TO ASC-ALP-TO-STORE             09280000
092900     ELSE                                                         09290000
093000         IF  ATOESTRF = DP015-ERASE-EOF                           09300000
093100             MOVE SPACE            TO ASC-ALP-TO-STORE            09310000
093200         END-IF                                                   09320000
093300     END-IF.                                                      09330000
093400                                                                  09340000
093500     IF  AFRSTRL > ZERO                                           09350000
093600         MOVE AFRSTRI             TO ASC-ALP-FROM-STORE           09360000
093700     ELSE                                                         09370000
093800         IF  AFRSTRF = DP015-ERASE-EOF                            09380000
093900             MOVE SPACE            TO ASC-ALP-FROM-STORE          09390000
094000         END-IF                                                   09400000
094100     END-IF.                                                      09410000
094200                                                                  09420000
094300     IF  ADEPTL > ZERO                                            09430000
094400         MOVE ADEPTI               TO ASC-FROM-DEPARTMENT         09440000
094500     ELSE                                                         09450000
094600         IF  ADEPTF = DP015-ERASE-EOF                             09460000
094700             MOVE SPACE            TO ASC-FROM-DEPARTMENT         09470000
094800         END-IF                                                   09480000
094900     END-IF.                                                      09490000
095000                                                                  09500000
095100     IF  AACCNOL > ZERO                                           09510000
095200         MOVE AACCNOI              TO ASC-ACCT-NO                 09520000
095300     ELSE                                                         09530000
095400         IF  AACCNOF = DP015-ERASE-EOF                            09540000
095500             MOVE SPACE            TO ASC-ACCT-NO                 09550000
095600         END-IF                                                   09560000
095700     END-IF.                                                      09570000
095800                                                                  09580000
095900     IF  AGRCOSTL > ZERO                                          09590000
096000         MOVE AGRCOSTI             TO ASC-ALP-GROSS-COST          09600000
096100     ELSE                                                         09610000
096200         IF  AGRCOSTF = DP015-ERASE-EOF                           09620000
096300            MOVE SPACE             TO ASC-ALP-GROSS-COST          09630000
096400         END-IF                                                   09640000
096500     END-IF.                                                      09650000
096600                                                                  09660000
096700     IF  ARETAMTL > ZERO                                          09670000
096800         MOVE ARETAMTI             TO ASC-ALP-RET-COST            09680000
096900     ELSE                                                         09690000
097000         IF  ARETAMTF = DP015-ERASE-EOF                           09700000
097100             MOVE SPACE            TO ASC-ALP-RET-COST            09710000
097200         END-IF                                                   09720000
097300     END-IF.                                                      09730000
097400                                                                  09740000
097500     IF  ACLASSL > ZERO                                           09750000
097600         MOVE ACLASSI              TO ASC-FROM-CLASS              09760000
097700     ELSE                                                         09770000
097800         IF  ACLASSF = DP015-ERASE-EOF                            09780000
097900             MOVE SPACE            TO ASC-FROM-CLASS              09790000
098000         END-IF                                                   09800000
098100     END-IF.                                                      09810000
098200                                                                  09820000
098300     IF  AUPCL > ZERO                                             09830000
098400         MOVE AUPCI                TO ASC-ALP-FROM-UPC            09840000
098500     ELSE                                                         09850000
098600         IF  AUPCF = DP015-ERASE-EOF                              09860000
098700             MOVE SPACE            TO ASC-ALP-FROM-UPC            09870000
098800         END-IF                                                   09880000
098900     END-IF.                                                      09890000
099000                                                                  09900000
099100     IF  ATOCLSL > ZERO                                           09910000
099200         MOVE ATOCLSI              TO ASC-TO-CLASS                09920000
099300     ELSE                                                         09930000
099400         IF  ATOCLSF = DP015-ERASE-EOF                            09940000
099500             MOVE SPACE            TO ASC-TO-CLASS                09950000
099600         END-IF                                                   09960000
099700     END-IF.                                                      09970000
099800                                                                  09980000
099900     IF  ATODEPTL > ZERO                                          09990000
100000         MOVE ATODEPTI             TO ASC-TO-DEPARTMENT           10000000
100100     ELSE                                                         10010000
100200         IF  ATODEPTF = DP015-ERASE-EOF                           10020000
100300             MOVE SPACE            TO ASC-TO-DEPARTMENT           10030000
100400         END-IF                                                   10040000
100500     END-IF.                                                      10050000
100600                                                                  10060000
100700     IF  ATOUPCL > ZERO                                           10070000
100800         MOVE ATOUPCI              TO ASC-ALP-TO-UPC              10080000
100900     ELSE                                                         10090000
101000         IF  ATOUPCF = DP015-ERASE-EOF                            10100000
101100             MOVE SPACE            TO ASC-ALP-TO-UPC              10110000
101200         END-IF                                                   10120000
101300     END-IF.                                                      10130000
101400                                                                  10140000
101500******************************************************************10150000
101600* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *10160000
101700* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *10170000
101800* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *10180000
101900******************************************************************10190000
102000 3000-EDIT-DATA-IN-COMMAREA.                                      10200000
102100                                                                  10210000
102200     PERFORM 3200-RESET-ATTRIBUTES.                               10220000
102300                                                                  10230000
102400     IF DP020-SRC-AID = DP016-PF16                                10240000
102500        CONTINUE                                                  10250000
102600     ELSE                                                         10260000
102700        PERFORM 3080-EDIT-GROSS-COST                              10270000
102800        PERFORM 3090-EDIT-RETAIL-COST                             10280000
102900        PERFORM 3360-EDIT-DEPT-CLS-SKU                            10290000
103000        PERFORM 3040-EDIT-FROM-STORE                              10300000
103100        IF PS-NO-ERROR                                            10310000
103200           SET ASC-VENDOR-NOT-FOUND TO TRUE                       10320000
103300           PERFORM 4800-GET-VENDOR-DATA                           10330000
103400           IF ASC-VENDOR-FOUND                                    10340000
103500              MOVE ENTNME-ENT-NAME-DESC TO ASC-VENDOR-NAME        10350000
103600              MOVE EXTENT-DUN-NBR    TO ASC-VENDOR-NUMBER         10360000
103700              MOVE EXTENT-ENT-ID     TO ASC-ENT-ID                10370000
103800*             PERFORM 3305-CHECK-STORE-INV-DATE                   10380000
103900           ELSE                                                   10390000
104000              SET DP020-MSG-FATAL        TO TRUE                  10400000
104100              MOVE DP015-UNP-ALP-NOR-OFF TO ADEPTA                10410000
104200                                            ACLASSA               10420000
104300                                            AUPCA                 10430000
104400              MOVE DP015-RED             TO ADEPTC                10440000
104500                                            ACLASSC               10450000
104600                                            AUPCC                 10460000
104700              MOVE DP015-REVERSE         TO ADEPTH                10470000
104800                                            ACLASSH               10480000
104900                                            AUPCH                 10490000
105000              MOVE -1                    TO ADEPTL                10500000
105100              IF PS-NO-ERROR                                      10510000
105200                 MOVE PC-TSYMSG-00398    TO DP020-MSG-NUMBER      10520000
105300              END-IF                                              10530000
105400              SET PS-ERROR               TO TRUE                  10540000
105500           END-IF                                                 10550000
105600        ELSE                                                      10560000
105700           MOVE SPACES               TO ASC-VENDOR-NAME           10570000
105800                                        ASC-VENDOR-NUMBER         10580000
105900        END-IF                                                    10590000
106000                                                                  10600000
106100        PERFORM 3050-DETERMINE-MERCH-OR-EXP                       10610000
106200                                                                  10620000
106300        IF ASC-EXP-TRANS                                          10630000
106400           PERFORM 3070-EDIT-ACCOUNT                              10640000
106500           PERFORM 3030-EDIT-TO-STORE                             10650000
106600        ELSE                                                      10660000
106700           IF ASC-MER-TRANS                                       10670000
106800              PERFORM 3370-EDIT-TO-DEPT-CLS-SKU                   10680000
106900              IF ASC-FROM-DEPARTMENT = ASC-TO-DEPARTMENT AND      10690000
107000                 ASC-FROM-CLASS      = ASC-TO-CLASS AND           10700000
107100                 ASC-ALP-FROM-UPC    = ASC-ALP-TO-UPC             10710000
107200                 MOVE DP015-UNP-ALP-NOR-OFF    TO ADEPTA          10720000
107300                                                  ATODEPTA        10730000
107400                                                  ACLASSA         10740000
107500                                                  ATOCLSA         10750000
107600                                                  AUPCA           10760000
107700                                                  ATOUPCA         10770000
107800                 MOVE DP015-RED                TO ADEPTC          10780000
107900                                                  ATODEPTC        10790000
108000                                                  ACLASSC         10800000
108100                                                  ATOCLSC         10810000
108200                                                  AUPCC           10820000
108300                                                  ATOUPCC         10830000
108400                 MOVE DP015-REVERSE            TO ADEPTH          10840000
108500                                                  ATODEPTH        10850000
108600                                                  ACLASSH         10860000
108700                                                  ATOCLSH         10870000
108800                                                  AUPCH           10880000
108900                                                  ATOUPCH         10890000
109000                 MOVE -1                       TO ADEPTL          10900000
109100                 IF PS-NO-ERROR                                   10910000
109200                    MOVE PC-TSYMSG-03567       TO DP020-MSG-NUMBER10920000
109300                 END-IF                                           10930000
109400                 SET PS-ERROR                  TO TRUE            10940000
109500              END-IF                                              10950000
109600              IF PS-NO-ERROR                                      10960000
109700                 SET ASC-VENDOR-NOT-FOUND TO TRUE                 10970000
109800                 PERFORM 4800-GET-VENDOR-DATA                     10980000
109900                 IF ASC-VENDOR-FOUND                              10990000
110000                    MOVE EXTENT-DUN-NBR TO ASC-TO-VENDOR-NUMBER   11000000
110100                    MOVE EXTENT-ENT-ID TO ASC-TO-ENT-ID           11010000
110200*MAB 0723 BEGIN                                                   11020000
110300                    IF ASC-VENDOR-NUMBER NOT EQUAL TO             11030000
110400                                           ASC-TO-VENDOR-NUMBER   11040000
110500                       SET ASC-ADD-REQUESTED TO TRUE              11050000
110600                       SET DP020-MSG-WARNING TO TRUE              11060000
110700                       MOVE PC-TSYMSG-03580  TO DP020-MSG-NUMBER  11070000
110800                    ELSE                                          11080000
110900                       MOVE SPACE TO DP020-MSG-SEVERITY-IND       11090000
111000                    END-IF                                        11100000
111100*MAB 0723 END                                                     11110000
111200                 ELSE                                             11120000
111300                    SET DP020-MSG-FATAL  TO TRUE                  11130000
111400                    MOVE DP015-UNP-ALP-NOR-OFF TO ATODEPTA        11140000
111500                                                  ATOCLSA         11150000
111600                                                  ATOUPCA         11160000
111700                    MOVE DP015-RED       TO ATODEPTC              11170000
111800                                            ATOCLSC               11180000
111900                                            ATOUPCC               11190000
112000                    MOVE DP015-REVERSE   TO ATODEPTH              11200000
112100                                            ATOCLSH               11210000
112200                                            ATOUPCH               11220000
112300                    MOVE -1              TO ATODEPTL              11230000
112400                    IF PS-NO-ERROR                                11240000
112500                       MOVE PC-TSYMSG-00398 TO DP020-MSG-NUMBER   11250000
112600                    END-IF                                        11260000
112700                    SET PS-ERROR         TO TRUE                  11270000
112800                 END-IF                                           11280000
112900              ELSE                                                11290000
113000                 MOVE SPACES         TO ASC-TO-VENDOR-NUMBER      11300000
113100              END-IF                                              11310000
113200           END-IF                                                 11320000
113300        END-IF                                                    11330000
113400                                                                  11340000
113500        PERFORM 3010-EDIT-DOC-NUMBER                              11350000
113600        PERFORM 3020-EDIT-DOC-DATE                                11360000
113700                                                                  11370000
113800     END-IF.                                                      11380000
113900                                                                  11390000
114000     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         11400000
114100                                                                  11410000
114200     IF PS-NO-ERROR                                               11420000
114300        MOVE -1            TO ADOCNUML                            11430000
114400     END-IF.                                                      11440000
114500                                                                  11450000
114600******************************************************************11460000
114700* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED DOCUMENT      *11470000
114800* NUMBER.                                                        *11480000
114900******************************************************************11490000
115000 3010-EDIT-DOC-NUMBER.                                            11500000
115100                                                                  11510000
115200     IF ASC-DOC-NUMBER = SPACES                                   11520000
115300        SET ASC-NO-DUP-DOC TO TRUE                                11530000
115400        MOVE ASC-VENDOR-NUMBER TO WS364-VENDOR-NBR                11540000
115500        PERFORM 4500-GET-NEXT-DOC-NO                              11550000
115600        MOVE WS364-NEXT-DOC-NBR   TO ASC-DOC-NUMBER               11560000
115700     ELSE                                                         11570000
115800        MOVE ASC-VENDOR-NUMBER TO ADJRNL-VND-NBR                  11580000
115900        MOVE ASC-CURRENT-DATE  TO ADJRNL-DOC-DTE                  11590000
116000        MOVE '53'              TO ADJRNL-AP-TRN-CDE               11600000
116100        PERFORM 4600-VALIDATE-UNIQUE-DOC                          11610000
116200     END-IF.                                                      11620000
116300                                                                  11630000
116400** IF THE ENTERED DOCUMENT NUMBER ALREADY EXISTS IN THE ADJUSTMENT11640000
116500** JOURNAL THEN AN ERROR IS PRODUCED.  DOCUMENT NUMBER MUST BE    11650000
116600** UNIQUE FOR A VENDOR.  IN THIS CASE THE "FROM" VENDOR.          11660000
116700     IF ASC-DUP-DOC                                               11670000
116800         SET DP020-MSG-FATAL TO TRUE                              11680000
116900         MOVE DP015-UNP-ALP-BRT-OFF TO ADOCNUMA                   11690000
117000         MOVE DP015-RED             TO ADOCNUMC                   11700000
117100         MOVE DP015-REVERSE         TO ADOCNUMH                   11710000
117200         MOVE -1                    TO ADOCNUML                   11720000
117300*        IF PS-NO-ERROR                                           11730000
117400             MOVE PC-TSYMSG-01919   TO DP020-MSG-NUMBER           11740000
117500*        END-IF                                                   11750000
117600         SET PS-ERROR               TO TRUE                       11760000
117700     END-IF.                                                      11770000
117800                                                                  11780000
117900     IF ASC-MER-TRANS                                             11790000
118000        MOVE ASC-TO-VENDOR-NUMBER TO ADJRNL-VND-NBR               11800000
118100        MOVE ASC-CURRENT-DATE     TO ADJRNL-DOC-DTE               11810000
118200        MOVE '52'                 TO ADJRNL-AP-TRN-CDE            11820000
118300        PERFORM 4600-VALIDATE-UNIQUE-DOC                          11830000
118400** IF THE ENTERED DOCUMENT NUMBER ALREADY EXISTS IN THE ADJUSTMENT11840000
118500** JOURNAL THEN AN ERROR IS PRODUCED.  DOCUMENT NUMBER MUST BE    11850000
118600** UNIQUE FOR A VENDOR.  IN THIS CASE THE "TO" VENDOR.            11860000
118700        IF ASC-DUP-DOC                                            11870000
118800            SET DP020-MSG-FATAL TO TRUE                           11880000
118900            MOVE DP015-UNP-ALP-BRT-OFF TO ADOCNUMA                11890000
119000            MOVE DP015-RED          TO ADOCNUMC                   11900000
119100            MOVE DP015-REVERSE      TO ADOCNUMH                   11910000
119200            MOVE -1                 TO ADOCNUML                   11920000
119300*           IF PS-NO-ERROR                                        11930000
119400                MOVE PC-TSYMSG-01919 TO DP020-MSG-NUMBER          11940000
119500*           END-IF                                                11950000
119600            SET PS-ERROR            TO TRUE                       11960000
119700        END-IF                                                    11970000
119800     END-IF.                                                      11980000
119900                                                                  11990000
120000******************************************************************12000000
120100* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED DOCUMENT DATE.*12010000
120200******************************************************************12020000
120300 3020-EDIT-DOC-DATE.                                              12030000
120400                                                                  12040000
120500     IF ASC-DOC-DATE = SPACES OR                                  12050000
120600        ASC-DOC-DATE = LOW-VALUES                                 12060000
120700        IF ASC-ADD-PENDING                                        12070000
120800           MOVE ASC-CURRENT-DATE TO ASC-DOC-DATE                  12080000
120900        END-IF                                                    12090000
121000     ELSE                                                         12100000
121100                                                                  12110000
121200        IF ASC-DOC-DATE-MM = SPACES AND                           12120000
121300           ASC-DOC-DATE > SPACES                                  12130000
121400           SET DP020-MSG-FATAL       TO TRUE                      12140000
121500           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCMMA                  12150000
121600           MOVE DP015-RED            TO ADOCMMC                   12160000
121700           MOVE DP015-REVERSE        TO ADOCMMH                   12170000
121800           MOVE -1                   TO ADOCMML                   12180000
121900           IF PS-NO-ERROR                                         12190000
122000               MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER          12200000
122100           END-IF                                                 12210000
122200           SET PS-ERROR              TO TRUE                      12220000
122300       END-IF                                                     12230000
122400                                                                  12240000
122500        IF ASC-DOC-DATE-DD = SPACES AND                           12250000
122600           ASC-DOC-DATE > SPACES                                  12260000
122700           SET DP020-MSG-FATAL       TO TRUE                      12270000
122800           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCDDA                  12280000
122900           MOVE DP015-RED            TO ADOCDDC                   12290000
123000           MOVE DP015-REVERSE        TO ADOCDDH                   12300000
123100           MOVE -1                   TO ADOCDDL                   12310000
123200           IF PS-NO-ERROR                                         12320000
123300               MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER          12330000
123400           END-IF                                                 12340000
123500           SET PS-ERROR              TO TRUE                      12350000
123600        END-IF                                                    12360000
123700                                                                  12370000
123800        IF ASC-DOC-DATE-YY = SPACES AND                           12380000
123900           ASC-DOC-DATE > SPACES                                  12390000
124000           SET DP020-MSG-FATAL       TO TRUE                      12400000
124100           MOVE DP015-UNP-ALP-BRT-OFF TO ADOCYYA                  12410000
124200           MOVE DP015-RED            TO ADOCYYC                   12420000
124300           MOVE DP015-REVERSE        TO ADOCYYH                   12430000
124400           MOVE -1                   TO ADOCYYL                   12440000
124500           IF PS-NO-ERROR                                         12450000
124600               MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER          12460000
124700           END-IF                                                 12470000
124800           SET PS-ERROR              TO TRUE                      12480000
124900        END-IF                                                    12490000
125000                                                                  12500000
125100        IF ADOCMML = -1 OR                                        12510000
125200           ADOCDDL = -1 OR                                        12520000
125300           ADOCYYL = -1                                           12530000
125400           CONTINUE                                               12540000
125500        ELSE                                                      12550000
125600           MOVE ASC-DOC-DATE TO PV-CCYYMMDD-DATE                  12560000
125700           PERFORM 3155-EDIT-DATE                                 12570000
125800           MOVE PV-CCYYMMDD-DATE TO ASC-DOC-DATE                  12580000
125900           IF PS-VALID-DATE                                       12590000
126000              CONTINUE                                            12600000
126100           ELSE                                                   12610000
126200              MOVE DP015-UNP-ALP-BRT-OFF                          12620000
126300                                      TO ADOCMMA                  12630000
126400                                         ADOCDDA                  12640000
126500                                         ADOCYYA                  12650000
126600              MOVE DP015-RED       TO ADOCMMC                     12660000
126700                                      ADOCDDC                     12670000
126800                                      ADOCYYC                     12680000
126900              MOVE DP015-REVERSE   TO ADOCMMH                     12690000
127000                                      ADOCDDH                     12700000
127100                                      ADOCYYH                     12710000
127200              MOVE -1              TO ADOCMML                     12720000
127300              IF PS-NO-ERROR                                      12730000
127400                 IF PS-INVALID-DATE                               12740000
127500                    MOVE PC-TSYMSG-00009 TO DP020-MSG-NUMBER      12750000
127600              END-IF                                              12760000
127700              SET PS-ERROR                                        12770000
127800                  DP020-MSG-FATAL   TO TRUE                       12780000
127900           END-IF                                                 12790000
128000        END-IF                                                    12800000
128100     END-IF.                                                      12810000
128200                                                                  12820000
128300******************************************************************12830000
128400* THIS PARAGRAPH WILL PERFORM EDITS ON THE "TO" STORE.           *12840000
128500******************************************************************12850000
128600 3030-EDIT-TO-STORE.                                              12860000
128700                                                                  12870000
128800     IF ASC-ALP-TO-STORE = SPACES                                 12880000
128900        SET DP020-MSG-FATAL  TO TRUE                              12890000
129000        MOVE DP015-UNP-ALP-BRT-OFF                                12900000
129100                             TO ATOESTRA                          12910000
129200        MOVE DP015-RED       TO ATOESTRC                          12920000
129300        MOVE DP015-REVERSE   TO ATOESTRH                          12930000
129400        MOVE -1              TO ATOESTRL                          12940000
129500        IF PS-NO-ERROR                                            12950000
129600            MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER              12960000
129700        END-IF                                                    12970000
129800        SET PS-ERROR         TO TRUE                              12980000
129900     END-IF.                                                      12990000
130000                                                                  13000000
130100     IF ASC-ALP-TO-STORE > SPACES                                 13010000
130200        MOVE ASC-ALP-TO-STORE                                     13020000
130300                                 TO DP010I-UNEDITED-FIELD         13030000
130400        MOVE 4                   TO DP010I-MAXIMUM-DIGITS         13040000
130500        MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       13050000
130600        SET  DP010I-NEGATIVE-NOT-ALLOWED                          13060000
130700                                 TO TRUE                          13070000
130810        CALL DP010I-NUMERIC-EDIT-ROUTINE                          13081034
130820                         USING DP010I-NUMERIC-EDIT-AREA           13082034
130900        IF DP010I-ERROR-DETECTED                                  13090000
131000            SET DP020-MSG-FATAL  TO TRUE                          13100000
131100*           -- MUST BE NUMERIC --                                 13110000
131200            MOVE DP015-UNP-ALP-BRT-OFF                            13120000
131300                                 TO ATOESTRA                      13130000
131400            MOVE DP015-RED       TO ATOESTRC                      13140000
131500            MOVE DP015-REVERSE   TO ATOESTRH                      13150000
131600            MOVE -1              TO ATOESTRL                      13160000
131700            IF PS-NO-ERROR                                        13170000
131800                MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER          13180000
131900            END-IF                                                13190000
132000            SET PS-ERROR         TO TRUE                          13200000
132100        ELSE                                                      13210000
132200            MOVE DP010I-NUMERIC-FIELD TO ASC-TO-STORE             13220000
132300                                         PV-STORE-NBR-4           13230000
132400*           IF PV-STORE-NBR-4 NOT EQUAL 90 AND                    13240000
132500*              PV-STORE-NBR-4 NOT EQUAL ASC-FROM-STORE            13250000
132600            IF ASC-TO-STORE NOT EQUAL 90 AND                      13260000
132700               ASC-TO-STORE NOT EQUAL ASC-FROM-STORE              13270000
132800               SET DP020-MSG-FATAL         TO TRUE                13280000
132900               MOVE DP015-UNP-ALP-BRT-OFF  TO ATOESTRA            13290000
133000               MOVE DP015-RED              TO ATOESTRC            13300000
133100               MOVE DP015-REVERSE          TO ATOESTRH            13310000
133200               MOVE -1                     TO ATOESTRL            13320000
133300*              IF PS-NO-ERROR                                     13330000
133400                  MOVE PC-TSYMSG-01942     TO DP020-MSG-NUMBER    13340000
133500*              END-IF                                             13350000
133600               SET PS-ERROR TO TRUE                               13360000
133700            END-IF                                                13370000
133800        END-IF                                                    13380000
133900     END-IF.                                                      13390000
134000                                                                  13400000
134100******************************************************************13410000
134200* THIS PARAGRAPH WILL PERFORM EDITS ON THE ENTERED FROM STORE.   *13420000
134300******************************************************************13430000
134400 3040-EDIT-FROM-STORE.                                            13440000
134500                                                                  13450000
134600     IF ASC-ALP-FROM-STORE = SPACES                               13460000
134700        SET DP020-MSG-FATAL  TO TRUE                              13470000
134800        MOVE DP015-UNP-ALP-BRT-OFF                                13480000
134900                             TO AFRSTRA                           13490000
135000        MOVE DP015-RED       TO AFRSTRC                           13500000
135100        MOVE DP015-REVERSE   TO AFRSTRH                           13510000
135200        MOVE -1              TO AFRSTRL                           13520000
135300        IF PS-NO-ERROR                                            13530000
135400            MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER              13540000
135500        END-IF                                                    13550000
135600        SET PS-ERROR         TO TRUE                              13560000
135700     END-IF.                                                      13570000
135800                                                                  13580000
135900     SET ASC-STORE-NOT-FOUND TO TRUE.                             13590000
136000                                                                  13600000
136100     IF ASC-ALP-FROM-STORE > SPACES                               13610000
136200        MOVE ASC-ALP-FROM-STORE                                   13620000
136300                                 TO DP010I-UNEDITED-FIELD         13630000
136400        MOVE 4                   TO DP010I-MAXIMUM-DIGITS         13640000
136500        MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       13650000
136600        SET  DP010I-NEGATIVE-NOT-ALLOWED                          13660000
136700                                 TO TRUE                          13670000
136810        CALL DP010I-NUMERIC-EDIT-ROUTINE                          13681034
136820                         USING DP010I-NUMERIC-EDIT-AREA           13682034
136900        IF DP010I-ERROR-DETECTED                                  13690000
137000            SET DP020-MSG-FATAL  TO TRUE                          13700000
137100*           -- MUST BE NUMERIC --                                 13710000
137200            MOVE DP015-UNP-ALP-BRT-OFF                            13720000
137300                                 TO AFRSTRA                       13730000
137400            MOVE DP015-RED       TO AFRSTRC                       13740000
137500            MOVE DP015-REVERSE   TO AFRSTRH                       13750000
137600            MOVE -1              TO AFRSTRL                       13760000
137700            IF PS-NO-ERROR                                        13770000
137800                MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER          13780000
137900            END-IF                                                13790000
138000            SET PS-ERROR         TO TRUE                          13800000
138100        ELSE                                                      13810000
138200            MOVE DP010I-NUMERIC-FIELD TO ASC-FROM-STORE           13820000
138300                                         PV-STORE-NBR-4           13830000
138400*           MOVE PV-STORE-NBR-4 TO XFT00003-LOC-NBR               13840002
138500            MOVE PV-STORE-NBR-4 TO XFT00017-LOC-NBR               13850002
138600*                                  INWS500-STORE (1)              13860000
138700*MAB 07-22-99 BEGIN                                               13870000
138800            IF ASC-FROM-STORE > 9998 OR                           13880000
138900               ASC-FROM-STORE = 80                                13890000
139000               SET ASC-STORE-NOT-FOUND TO TRUE                    13900000
139100            ELSE                                                  13910000
139200*MAB 07-22-99 END                                                 13920000
139300               IF PV-STORE-NBR-4 NOT EQUAL ZERO                   13930000
139400                  PERFORM 7400-VALIDATE-STORE                     13940000
139500               ELSE                                               13950000
139600                  SET ASC-STORE-FOUND TO TRUE                     13960000
139700               END-IF                                             13970000
139800            END-IF                                                13980000
139900            IF ASC-STORE-NOT-FOUND                                13990000
140000               SET DP020-MSG-FATAL  TO TRUE                       14000000
140100               MOVE DP015-UNP-ALP-BRT-OFF                         14010000
140200                                    TO AFRSTRA                    14020000
140300               MOVE DP015-RED       TO AFRSTRC                    14030000
140400               MOVE DP015-REVERSE   TO AFRSTRH                    14040000
140500               MOVE -1              TO AFRSTRL                    14050000
140600               IF PS-NO-ERROR                                     14060000
140700                   MOVE PC-TSYMSG-01904 TO DP020-MSG-NUMBER       14070000
140800               END-IF                                             14080000
140900               SET PS-ERROR         TO TRUE                       14090000
141000            END-IF                                                14100000
141100        END-IF                                                    14110000
141200     END-IF.                                                      14120000
141300                                                                  14130000
141400******************************************************************14140000
141500* THIS PARAGRAPH WILL DETERMINE IF THE USER HAS ENTERED AN       *14150000
141600* EXPENSE TRANSFER OR A MERCHANDISE TRANSFER.  IF THE ACCOUNT    *14160000
141700* NUMBER AND EXPENSE "TO" STORE ARE ENTERED THE TRANSFER IS      *14170000
141800* EXPENSE.  IF THE USER ENTERS THE "TO" DEPARTMENT, CLASS,       *14180000
141900* UPC, AND STORE IT IS A MERCHANDISE TRANSFER.  THERE ARE        *14190000
142000* NO COMBINATION ENTRIES OF EXPENSE AND MERCHANDISE FIELDS       *14200000
142100* ALLOWED.  ONLY ALL "TO" EXPENSE OR ALL "TO" MERCHANDISE IS     *14210000
142200* ALLOWED.                                                       *14220000
142300******************************************************************14230000
142400 3050-DETERMINE-MERCH-OR-EXP.                                     14240000
142500                                                                  14250000
142600     SET ASC-NO-TRANS TO TRUE.                                    14260000
142700                                                                  14270000
142800     IF (ASC-ACCT-NO > SPACES OR ASC-ALP-TO-STORE > SPACES) AND   14280000
142900        (ASC-TO-DEPARTMENT > SPACES OR                            14290000
143000         ASC-TO-CLASS      > SPACES OR                            14300000
143100         ASC-ALP-TO-UPC    > SPACES)                              14310000
143200         SET DP020-MSG-FATAL          TO TRUE                     14320000
143300         MOVE DP015-UNP-ALP-BRT-OFF   TO AACCNOA                  14330000
143400                                         ATOESTRA                 14340000
143500                                         ATODEPTA                 14350000
143600                                         ATOCLSA                  14360000
143700                                         ATOUPCA                  14370000
143800         MOVE DP015-RED               TO AACCNOC                  14380000
143900                                         ATOESTRC                 14390000
144000                                         ATODEPTC                 14400000
144100                                         ATOCLSC                  14410000
144200                                         ATOUPCC                  14420000
144300         MOVE DP015-REVERSE           TO AACCNOH                  14430000
144400                                         ATOESTRH                 14440000
144500                                         ATODEPTH                 14450000
144600                                         ATOCLSH                  14460000
144700                                         ATOUPCH                  14470000
144800         IF PS-NO-ERROR                                           14480000
144900** ERROR MESSAGE TO INDICATE THAT THE USER MUST ENTER EITHER      14490000
145000** "TO" EXPENSE OR "TO" MERCHANDISE FIELDS - NOT BOTH TYPES       14500000
145100            MOVE PC-TSYMSG-01941      TO DP020-MSG-NUMBER         14510000
145200            MOVE -1                   TO AACCNOL                  14520000
145300         END-IF                                                   14530000
145400         SET PS-ERROR                 TO TRUE                     14540000
145500     ELSE                                                         14550000
145600         IF ASC-ACCT-NO = SPACES AND                              14560000
145700            ASC-ALP-TO-STORE = SPACES AND                         14570000
145800            ASC-TO-DEPARTMENT = SPACES AND                        14580000
145900            ASC-TO-CLASS = SPACES AND                             14590000
146000            ASC-ALP-TO-UPC = SPACES                               14600000
146100            SET DP020-MSG-FATAL       TO TRUE                     14610000
146200            MOVE DP015-UNP-ALP-BRT-OFF TO AACCNOA                 14620000
146300                                          ATOESTRA                14630000
146400                                          ATODEPTA                14640000
146500                                          ATOCLSA                 14650000
146600                                          ATOUPCA                 14660000
146700            MOVE DP015-RED            TO AACCNOC                  14670000
146800                                         ATOESTRC                 14680000
146900                                         ATODEPTC                 14690000
147000                                         ATOCLSC                  14700000
147100                                         ATOUPCC                  14710000
147200            MOVE DP015-REVERSE        TO AACCNOH                  14720000
147300                                         ATOESTRH                 14730000
147400                                         ATODEPTH                 14740000
147500                                         ATOCLSH                  14750000
147600                                         ATOUPCH                  14760000
147700            MOVE -1                   TO AACCNOL                  14770000
147800            IF PS-NO-ERROR                                        14780000
147900** ERROR MESSAGE TO INDICATE THAT THE USER IS REQUIRED TO ENTER   14790000
148000** "TO" EXPENSE OR "TO" MERCHANDISE FIELDS BOTH CANNOT BE BLANK   14800000
148100               MOVE PC-TSYMSG-00007   TO DP020-MSG-NUMBER         14810000
148200            END-IF                                                14820000
148300            SET PS-ERROR              TO TRUE                     14830000
148400         ELSE                                                     14840000
148500            IF (ASC-ACCT-NO > SPACES OR                           14850000
148600                ASC-ALP-TO-STORE > SPACES)                        14860000
148700                SET ASC-EXP-TRANS TO TRUE                         14870000
148800            ELSE                                                  14880000
148900                IF (ASC-TO-DEPARTMENT > SPACES OR                 14890000
149000                    ASC-TO-CLASS > SPACES OR                      14900000
149100                    ASC-ALP-TO-UPC > SPACES)                      14910000
149200                    SET ASC-MER-TRANS TO TRUE                     14920000
149300                END-IF                                            14930000
149400            END-IF                                                14940000
149500         END-IF                                                   14950000
149600     END-IF.                                                      14960000
149700                                                                  14970000
149800******************************************************************14980000
149900* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED ACCOUNT.  *14990000
150000******************************************************************15000000
150100 3070-EDIT-ACCOUNT.                                               15010000
150200                                                                  15020000
150300     IF ASC-ACCT-NO = SPACES                                      15030000
150400        SET DP020-MSG-FATAL        TO TRUE                        15040000
150500        MOVE DP015-UNP-ALP-BRT-OFF TO AACCNOA                     15050000
150600        MOVE DP015-RED                TO AACCNOC                  15060000
150700        MOVE DP015-REVERSE            TO AACCNOH                  15070000
150800        MOVE -1                       TO AACCNOL                  15080000
150900        IF PS-NO-ERROR                                            15090000
151000           MOVE PC-TSYMSG-00007 TO DP020-MSG-NUMBER               15100000
151100        END-IF                                                    15110000
151200        SET PS-ERROR               TO TRUE                        15120000
151300     END-IF.                                                      15130000
151400                                                                  15140000
151500     IF ASC-ACCT-NO GREATER THAN SPACES AND                       15150000
151600        PS-NO-ERROR                                               15160000
151700        MOVE ASC-ACCT-NO          TO PV-ACCT-NBR                  15170027
151800        MOVE ASC-CURRENT-DATE     TO PV-CURRENT-DATE              15180029
152200        SET ASC-ACCT-NOT-FOUND    TO TRUE                         15220000
152210        PERFORM 6000-SELECT-ACCT-NBR-DESC                         15221027
152300                                                                  15230002
155000        IF ASC-ACCT-NOT-FOUND                                     15500001
155100           SET DP020-MSG-FATAL TO TRUE                            15510000
155200           MOVE DP015-UNP-ALP-BRT-OFF TO AACCNOA                  15520000
155300           MOVE DP015-RED                TO AACCNOC               15530000
155400           MOVE DP015-REVERSE            TO AACCNOH               15540000
155500           MOVE -1                       TO AACCNOL               15550000
155600           IF PS-NO-ERROR                                         15560000
155700               MOVE PC-TSYMSG-01910 TO DP020-MSG-NUMBER           15570000
155800           END-IF                                                 15580000
155900           SET PS-ERROR TO TRUE                                   15590000
156000        END-IF                                                    15600000
156100     END-IF.                                                      15610000
156200                                                                  15620000
156300******************************************************************15630000
156400* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED GROSS     *15640000
156500* COST.                                                          *15650000
156600******************************************************************15660000
156700 3080-EDIT-GROSS-COST.                                            15670000
156800                                                                  15680000
156900     IF ASC-ALP-GROSS-COST > SPACES AND                           15690000
157000        ASC-ALP-GROSS-COST NOT EQUAL TO '000000000000'            15700000
157100        MOVE ASC-ALP-GROSS-COST TO DP010I-UNEDITED-FIELD          15710000
157200        MOVE 10                TO DP010I-MAXIMUM-DIGITS           15720000
157300        MOVE 2                 TO DP010I-MAXIMUM-DECIMALS         15730000
157400        SET DP010I-NEGATIVE-NOT-ALLOWED                           15740000
157500                                  TO TRUE                         15750000
157600                                                                  15760000
157710        CALL DP010I-NUMERIC-EDIT-ROUTINE                          15771034
157720                         USING DP010I-NUMERIC-EDIT-AREA           15772034
157800                                                                  15780000
157900        IF DP010I-ERROR-DETECTED                                  15790000
158000            SET DP020-MSG-FATAL TO TRUE                           15800000
158100** GROSS COST MUST BE NUMERIC.                                    15810000
158200            MOVE DP015-UNP-ALP-BRT-OFF TO AGRCOSTA                15820000
158300            MOVE DP015-RED          TO AGRCOSTC                   15830000
158400            MOVE DP015-REVERSE      TO AGRCOSTH                   15840000
158500            MOVE -1                 TO AGRCOSTL                   15850000
158600            IF PS-NO-ERROR                                        15860000
158700               MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER           15870000
158800            END-IF                                                15880000
158900            SET PS-ERROR      TO TRUE                             15890000
159000        ELSE                                                      15900000
159100            MOVE DP010I-NUMERIC-FIELD                             15910000
159200                             TO ASC-GROSS-COST                    15920000
159300                                ASC-ALP-GRO-COST-9                15930000
159400        END-IF                                                    15940000
159500     ELSE                                                         15950000
159600        INITIALIZE ASC-GROSS-COST                                 15960000
159700        SET DP020-MSG-FATAL             TO TRUE                   15970000
159800        MOVE DP015-UNP-ALP-BRT-OFF      TO AGRCOSTA               15980000
159900        MOVE DP015-RED                  TO AGRCOSTC               15990000
160000        MOVE DP015-REVERSE              TO AGRCOSTH               16000000
160100        MOVE -1                         TO AGRCOSTL               16010000
160200        IF PS-NO-ERROR                                            16020000
160300           MOVE PC-TSYMSG-00007         TO DP020-MSG-NUMBER       16030000
160400        END-IF                                                    16040000
160500        SET PS-ERROR                    TO TRUE                   16050000
160600     END-IF.                                                      16060000
160700                                                                  16070000
160800******************************************************************16080000
160900* THIS PARAGRAPH WILL PERFORM THE EDITS ON THE ENTERED RETAIL    *16090000
161000* AMOUNT FIELD.                                                  *16100000
161100******************************************************************16110000
161200 3090-EDIT-RETAIL-COST.                                           16120000
161300                                                                  16130000
161400     IF ASC-ALP-RET-COST > SPACES AND                             16140000
161500        ASC-ALP-RET-COST NOT EQUAL TO '000000000000'              16150000
161600        MOVE ASC-ALP-RET-COST TO DP010I-UNEDITED-FIELD            16160000
161700        MOVE 10                TO DP010I-MAXIMUM-DIGITS           16170000
161800        MOVE 2                 TO DP010I-MAXIMUM-DECIMALS         16180000
161900        SET DP010I-NEGATIVE-NOT-ALLOWED                           16190000
162000                            TO TRUE                               16200000
162100                                                                  16210000
162210        CALL DP010I-NUMERIC-EDIT-ROUTINE                          16221034
162220                         USING DP010I-NUMERIC-EDIT-AREA           16222034
162300                                                                  16230000
162400        IF DP010I-ERROR-DETECTED                                  16240000
162500            SET DP020-MSG-FATAL TO TRUE                           16250000
162600** RETAIL AMOUNT MUST BE NUMERIC.                                 16260000
162700            MOVE DP015-UNP-ALP-BRT-OFF TO ARETAMTA                16270000
162800            MOVE DP015-RED          TO ARETAMTC                   16280000
162900            MOVE DP015-REVERSE      TO ARETAMTH                   16290000
163000            MOVE -1                 TO ARETAMTL                   16300000
163100           IF PS-NO-ERROR                                         16310000
163200                MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER          16320000
163300           END-IF                                                 16330000
163400            SET PS-ERROR      TO TRUE                             16340000
163500        ELSE                                                      16350000
163600            MOVE DP010I-NUMERIC-FIELD                             16360000
163700                             TO ASC-RETAIL-AMT                    16370000
163800                                ASC-ALP-RET-COST-9                16380000
163900        END-IF                                                    16390000
164000     ELSE                                                         16400000
164100        INITIALIZE ASC-RETAIL-AMT                                 16410000
164200        SET DP020-MSG-FATAL             TO TRUE                   16420000
164300        MOVE DP015-UNP-ALP-BRT-OFF      TO ARETAMTA               16430000
164400        MOVE DP015-RED                  TO ARETAMTC               16440000
164500        MOVE DP015-REVERSE              TO ARETAMTH               16450000
164600        MOVE -1                         TO ARETAMTL               16460000
164700        IF PS-NO-ERROR                                            16470000
164800           MOVE PC-TSYMSG-00007         TO DP020-MSG-NUMBER       16480000
164900        END-IF                                                    16490000
165000        SET PS-ERROR                    TO TRUE                   16500000
165100     END-IF.                                                      16510000
165200                                                                  16520000
165300******************************************************************16530000
165400* THIS PARAGRAPH PERFORMS THE COMMON DATE EDITS.                 *16540000
165500******************************************************************16550000
165600 3155-EDIT-DATE.                                                  16560000
165700                                                                  16570000
165800     IF PV-MM NUMERIC                                             16580000
165900     OR PV-MM = SPACE                                             16590000
166000         CONTINUE                                                 16600000
166100     ELSE                                                         16610000
166200         MOVE PV-MM                  TO DP010I-UNEDITED-FIELD     16620000
166300         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     16630000
166400         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   16640000
166500         SET DP010I-NEGATIVE-NOT-ALLOWED                          16650000
166600                                     TO TRUE                      16660000
166710         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16671034
166720                         USING DP010I-NUMERIC-EDIT-AREA           16672034
166800         IF DP010I-ERROR-DETECTED                                 16680000
166900             CONTINUE                                             16690000
167000         ELSE                                                     16700000
167100             MOVE DP010I-NUMERIC-FIELD                            16710000
167200                                     TO PV-MM-9                   16720000
167300         END-IF                                                   16730000
167400     END-IF.                                                      16740000
167500                                                                  16750000
167600     IF PV-DD NUMERIC                                             16760000
167700     OR PV-DD = SPACE                                             16770000
167800         CONTINUE                                                 16780000
167900     ELSE                                                         16790000
168000         MOVE PV-DD                  TO DP010I-UNEDITED-FIELD     16800000
168100         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     16810000
168200         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   16820000
168300         SET DP010I-NEGATIVE-NOT-ALLOWED                          16830000
168400                                     TO TRUE                      16840000
168510         CALL DP010I-NUMERIC-EDIT-ROUTINE                         16851034
168520                         USING DP010I-NUMERIC-EDIT-AREA           16852034
168600         IF DP010I-ERROR-DETECTED                                 16860000
168700             CONTINUE                                             16870000
168800         ELSE                                                     16880000
168900             MOVE DP010I-NUMERIC-FIELD                            16890000
169000                                     TO PV-DD-9                   16900000
169100         END-IF                                                   16910000
169200     END-IF.                                                      16920000
169300                                                                  16930000
169400     IF PV-DD NUMERIC                                             16940000
169500     OR PV-DD = SPACE                                             16950000
169600         CONTINUE                                                 16960000
169700     ELSE                                                         16970000
169800         MOVE PV-DD                  TO DP010I-UNEDITED-FIELD     16980000
169900         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     16990000
170000         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   17000000
170100         SET DP010I-NEGATIVE-NOT-ALLOWED                          17010000
170200                                     TO TRUE                      17020000
170310        CALL DP010I-NUMERIC-EDIT-ROUTINE                          17031034
170320                         USING DP010I-NUMERIC-EDIT-AREA           17032034
170400         IF DP010I-ERROR-DETECTED                                 17040000
170500             CONTINUE                                             17050000
170600         ELSE                                                     17060000
170700             MOVE DP010I-NUMERIC-FIELD                            17070000
170800                                     TO PV-DD-9                   17080000
170900         END-IF                                                   17090000
171000     END-IF.                                                      17100000
171100                                                                  17110000
171200     IF PV-CCYY = SPACE                                           17120000
171300         CONTINUE                                                 17130000
171400     ELSE                                                         17140000
171500         IF PV-CCYY NUMERIC                                       17150000
171600             IF PV-YY < 80                                        17160000
171700                 MOVE 20             TO PV-CC                     17170000
171800             ELSE                                                 17180000
171900                 MOVE 19             TO PV-CC                     17190000
172000             END-IF                                               17200000
172100         ELSE                                                     17210000
172200             MOVE PV-CCYY            TO DP010I-UNEDITED-FIELD     17220000
172300             MOVE 4                  TO DP010I-MAXIMUM-DIGITS     17230000
172400             MOVE 0                  TO DP010I-MAXIMUM-DECIMALS   17240000
172500             SET DP010I-NEGATIVE-NOT-ALLOWED                      17250000
172600                                         TO TRUE                  17260000
172710             CALL DP010I-NUMERIC-EDIT-ROUTINE                     17271034
172720                         USING DP010I-NUMERIC-EDIT-AREA           17272034
172800             IF DP010I-ERROR-DETECTED                             17280000
172900                 CONTINUE                                         17290000
173000             ELSE                                                 17300000
173100                 MOVE DP010I-NUMERIC-FIELD                        17310000
173200                                         TO PV-CCYY-9             17320000
173300*                ALLOW THEM TO ENTER A TWO DIGIT YEAR W/OUT CENT  17330000
173400                 IF PV-YY < 80                                    17340000
173500                     MOVE 20             TO PV-CC                 17350000
173600                 ELSE                                             17360000
173700                     IF PV-CCYY-9 > 1999                          17370000
173800                         CONTINUE                                 17380000
173900                     ELSE                                         17390000
174000                         MOVE 19         TO PV-CC                 17400000
174100                     END-IF                                       17410000
174200                 END-IF                                           17420000
174300             END-IF                                               17430000
174400         END-IF                                                   17440000
174500     END-IF.                                                      17450000
174600                                                                  17460000
174700     SET PS-VALID-DATE TO TRUE.                                   17470000
174800                                                                  17480000
174900     INITIALIZE DPG51                                             17490000
175000                DPG52                                             17500000
175100                DPG53                                             17510000
175200                DPG54                                             17520000
175300                DPG55                                             17530000
175400                DPG56.                                            17540000
175500                                                                  17550000
175600*    MOVE 'A0'                 TO DPG51-CALENDAR-TYPE.            17560000
175700     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      17570000
175800                                                                  17580000
175900     SET DPG51-DO-NOT-INCR-DECR-DATE                              17590000
176000         DPG52-LK-DTE-ISO-FMT  TO TRUE.                           17600000
176100                                                                  17610000
176200     IF PV-CCYY NUMERIC AND                                       17620000
176300        PV-MM NUMERIC AND                                         17630000
176400        PV-DD NUMERIC                                             17640000
176500         MOVE '-'  TO PV-DASH1                                    17650000
176600                          PV-DASH2                                17660000
176700         MOVE PV-CCYYMMDD-DATE TO DPG52-LK-DATE-INPUT             17670000
176800                                                                  17680000
176900         CALL DP500-KOHLS-CALENDAR-ROUTINE                        17690000
177000             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            17700000
177100                                                                  17710000
177200* Y2K    IF (DPG54-DATE-INVALID OR                                17720000
177300         IF (DPG54-WARNING-ERROR OR                               17730000
177400             DPG54-SEVERE-ERROR)                                  17740000
177500             SET PS-INVALID-DATE TO TRUE                          17750000
177600         END-IF                                                   17760000
177700     ELSE                                                         17770000
177800         SET PS-INVALID-DATE TO TRUE                              17780000
177900     END-IF.                                                      17790000
178000                                                                  17800000
178100******************************************************************17810000
178200* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *17820000
178300* MAP.                                                           *17830000
178400******************************************************************17840000
178500 3200-RESET-ATTRIBUTES.                                           17850000
178600                                                                  17860000
178700     MOVE DP015-UNP-ALP-NOR-OFF    TO ADOCNUMA                    17870000
178800                                      AGRCOSTA                    17880000
178900                                      ARETAMTA                    17890000
179000                                      ADEPTA                      17900000
179100                                      AACCNOA                     17910000
179200                                      ACLASSA                     17920000
179300                                      ATOESTRA                    17930000
179400                                      AFRSTRA                     17940000
179500                                      AUPCA                       17950000
179600                                      ATODEPTA                    17960000
179700                                      ATOCLSA                     17970000
179800                                      ATOUPCA.                    17980000
179900     MOVE DP015-GREEN              TO ADOCNUMC                    17990000
180000                                      AGRCOSTC                    18000000
180100                                      ARETAMTC                    18010000
180200                                      ADEPTC                      18020000
180300                                      AACCNOC                     18030000
180400                                      ACLASSC                     18040000
180500                                      ATOESTRC                    18050000
180600                                      AFRSTRC                     18060000
180700                                      AUPCC                       18070000
180800                                      ATODEPTC                    18080000
180900                                      ATOCLSC                     18090000
181000                                      ATOUPCC.                    18100000
181100     MOVE DP015-UNDERLINE          TO ADOCNUMH                    18110000
181200                                      AGRCOSTH                    18120000
181300                                      ARETAMTH                    18130000
181400                                      ADEPTH                      18140000
181500                                      AACCNOH                     18150000
181600                                      ACLASSH                     18160000
181700                                      ATOESTRH                    18170000
181800                                      AFRSTRH                     18180000
181900                                      AUPCH                       18190000
182000                                      ATODEPTH                    18200000
182100                                      ATOCLSH                     18210000
182200                                      ATOUPCH.                    18220000
182300                                                                  18230000
182400*    IF ASC-NO-STORE-IN-PER                                       18240000
182500*       MOVE DP015-PRO-DRK-MDT      TO ACUTMMA                    18250000
182600*                                      ACUTDDA                    18260000
182700*                                      ACUTYYA                    18270000
182800*                                      ALABELA                    18280000
182900*       MOVE DP015-HL-OFF           TO ACUTMMH                    18290000
183000*                                      ACUTDDH                    18300000
183100*                                      ACUTYYH                    18310000
183200*    ELSE                                                         18320000
183300*       MOVE DP015-UNP-ALP-NOR-OFF  TO ACUTMMA                    18330000
183400*                                      ACUTDDA                    18340000
183500*                                      ACUTYYA                    18350000
183600*       MOVE DP015-PRO-NOR-MDT      TO ALABELA                    18360000
183700*       MOVE DP015-GREEN            TO ACUTMMC                    18370000
183800*                                      ACUTDDC                    18380000
183900*                                      ACUTYYC                    18390000
184000*       MOVE DP015-UNDERLINE        TO ACUTMMH                    18400000
184100*                                      ACUTDDH                    18410000
184200*                                      ACUTYYH                    18420000
184300*    END-IF.                                                      18430000
184400                                                                  18440000
184500******************************************************************18450000
184600* THIS PARAGRAPH PERFORMS COMMON DATE EDITS.                     *18460000
184700******************************************************************18470000
184800 3309-EDIT-DATE.                                                  18480000
184900                                                                  18490000
185000     IF PV-MM NUMERIC                                             18500000
185100     OR PV-MM = SPACE                                             18510000
185200         CONTINUE                                                 18520000
185300     ELSE                                                         18530000
185400         MOVE PV-MM                  TO DP010I-UNEDITED-FIELD     18540000
185500         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     18550000
185600         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   18560000
185700         SET DP010I-NEGATIVE-NOT-ALLOWED                          18570000
185800                                     TO TRUE                      18580000
185910         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18591034
185920                         USING DP010I-NUMERIC-EDIT-AREA           18592034
186000                                                                  18600000
186100         IF DP010I-ERROR-DETECTED                                 18610000
186200             CONTINUE                                             18620000
186300         ELSE                                                     18630000
186400             MOVE DP010I-NUMERIC-FIELD                            18640000
186500                                     TO PV-MM-9                   18650000
186600         END-IF                                                   18660000
186700     END-IF.                                                      18670000
186800                                                                  18680000
186900     IF PV-DD NUMERIC                                             18690000
187000     OR PV-DD = SPACE                                             18700000
187100         CONTINUE                                                 18710000
187200     ELSE                                                         18720000
187300         MOVE PV-DD                  TO DP010I-UNEDITED-FIELD     18730000
187400         MOVE 2                      TO DP010I-MAXIMUM-DIGITS     18740000
187500         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   18750000
187600         SET DP010I-NEGATIVE-NOT-ALLOWED                          18760000
187700                                     TO TRUE                      18770000
187810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         18781034
187820                         USING DP010I-NUMERIC-EDIT-AREA           18782034
187900         IF DP010I-ERROR-DETECTED                                 18790000
188000             CONTINUE                                             18800000
188100         ELSE                                                     18810000
188200             MOVE DP010I-NUMERIC-FIELD                            18820000
188300                                     TO PV-DD-9                   18830000
188400         END-IF                                                   18840000
188500     END-IF.                                                      18850000
188600                                                                  18860000
188700     IF PV-CCYY = SPACE                                           18870000
188800         CONTINUE                                                 18880000
188900     ELSE                                                         18890000
189000         IF PV-CCYY NUMERIC                                       18900000
189100             IF PV-YY < 80                                        18910000
189200                 MOVE 20             TO PV-CC                     18920000
189300             ELSE                                                 18930000
189400                 MOVE 19             TO PV-CC                     18940000
189500             END-IF                                               18950000
189600         ELSE                                                     18960000
189700             MOVE PV-CCYY            TO DP010I-UNEDITED-FIELD     18970000
189800             MOVE 4                  TO DP010I-MAXIMUM-DIGITS     18980000
189900             MOVE 0                  TO DP010I-MAXIMUM-DECIMALS   18990000
190000             SET DP010I-NEGATIVE-NOT-ALLOWED                      19000000
190100                                         TO TRUE                  19010000
190210             CALL DP010I-NUMERIC-EDIT-ROUTINE                     19021034
190220                         USING DP010I-NUMERIC-EDIT-AREA           19022034
190300             IF DP010I-ERROR-DETECTED                             19030000
190400                 CONTINUE                                         19040000
190500             ELSE                                                 19050000
190600                 MOVE DP010I-NUMERIC-FIELD                        19060000
190700                                         TO PV-CCYY-9             19070000
190800*         ALLOW THEM TO ENTER A TWO DIGIT YEAR W/OUT CENT         19080000
190900                 IF PV-YY < 80                                    19090000
191000                     MOVE 20             TO PV-CC                 19100000
191100                 ELSE                                             19110000
191200                     IF PV-CCYY-9 > 1999                          19120000
191300                         CONTINUE                                 19130000
191400                     ELSE                                         19140000
191500                         MOVE 19         TO PV-CC                 19150000
191600                     END-IF                                       19160000
191700                 END-IF                                           19170000
191800             END-IF                                               19180000
191900         END-IF                                                   19190000
192000     END-IF.                                                      19200000
192100                                                                  19210000
192200     SET PS-VALID-DATE TO TRUE.                                   19220000
192300                                                                  19230000
192400     INITIALIZE DPG51                                             19240000
192500                DPG52                                             19250000
192600                DPG53                                             19260000
192700                DPG54                                             19270000
192800                DPG55                                             19280000
192900                DPG56.                                            19290000
193000                                                                  19300000
193100     MOVE 'A0'                 TO DPG51-CALENDAR-TYPE.            19310000
193200                                                                  19320000
193300     SET DPG51-DO-NOT-INCR-DECR-DATE                              19330000
193400         DPG52-LK-DTE-ISO-FMT  TO TRUE.                           19340000
193500                                                                  19350000
193600     IF PV-CCYY NUMERIC AND                                       19360000
193700        PV-MM NUMERIC AND                                         19370000
193800        PV-DD NUMERIC                                             19380000
193900         MOVE '-'  TO PV-DASH1                                    19390000
194000                          PV-DASH2                                19400000
194100         MOVE PV-CCYYMMDD-DATE TO DPG52-LK-DATE-INPUT             19410000
194200                                                                  19420000
194300         CALL DP500-KOHLS-CALENDAR-ROUTINE                        19430000
194400             USING DPG51 DPG52 DPG53 DPG54 DPG55 DPG56            19440000
194500                                                                  19450000
194600* Y2K    IF (DPG54-DATE-INVALID OR                                19460000
194700         IF (DPG54-WARNING-ERROR OR                               19470000
194800             DPG54-SEVERE-ERROR)                                  19480000
194900             SET PS-INVALID-DATE TO TRUE                          19490000
195000         END-IF                                                   19500000
195100     ELSE                                                         19510000
195200         SET PS-INVALID-DATE TO TRUE                              19520000
195300     END-IF.                                                      19530000
195400                                                                  19540000
195500******************************************************************19550000
195600* THIS CLASS WILL PERFORM EDITS ON THE DEPARTMENT, CLASS AND SKU *19560000
195700* IN THE DISTRIBUTION PORTION OF THE SCREEN.                     *19570000
195800******************************************************************19580000
195900 3360-EDIT-DEPT-CLS-SKU.                                          19590000
196000                                                                  19600000
196100     IF ASC-ALP-FROM-UPC NOT EQUAL SPACES                         19610000
196200        MOVE ASC-ALP-FROM-UPC    TO DP010I-UNEDITED-FIELD         19620000
196300        MOVE 17                  TO DP010I-MAXIMUM-DIGITS         19630000
196400        MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       19640000
196500        SET  DP010I-NEGATIVE-NOT-ALLOWED                          19650000
196600                                 TO TRUE                          19660000
196710        CALL DP010I-NUMERIC-EDIT-ROUTINE                          19671034
196720                         USING DP010I-NUMERIC-EDIT-AREA           19672034
196800        IF DP010I-ERROR-DETECTED                                  19680000
196900            SET DP020-MSG-FATAL  TO TRUE                          19690000
197000*           -- MUST BE NUMERIC --                                 19700000
197100            MOVE DP015-UNP-ALP-BRT-OFF                            19710000
197200                                 TO AUPCA                         19720000
197300            MOVE DP015-RED       TO AUPCC                         19730000
197400            MOVE DP015-REVERSE   TO AUPCH                         19740000
197500            MOVE -1              TO AUPCL                         19750000
197600            IF PS-NO-ERROR                                        19760000
197700               MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER           19770000
197800            END-IF                                                19780000
197900            SET PS-ERROR TO TRUE                                  19790000
198000        ELSE                                                      19800000
198100            MOVE DP010I-NUM-FIELD-17-DIG-0-DEC                    19810000
198200                                      TO ASC-FROM-UPC             19820000
198300                                         ASC-ALP-FROM-UPC-9       19830000
198400        END-IF                                                    19840000
198500     END-IF.                                                      19850000
198600                                                                  19860000
198700     IF ASC-ALP-FROM-UPC = SPACES                                 19870000
198800        MOVE ZERO TO UPC-UPC-NBR                                  19880000
198900     ELSE                                                         19890000
199000        MOVE ASC-ALP-FROM-UPC-9 TO UPC-UPC-NBR                    19900000
199100     END-IF.                                                      19910000
199200                                                                  19920000
199300     MOVE ZERO                     TO PV-CLASS.                   19930000
199400     IF ASC-FROM-CLASS NOT = SPACE                                19940000
199500        MOVE ASC-FROM-CLASS-9      TO PV-CLASS                    19950000
199600     END-IF.                                                      19960000
199700     MOVE PV-CLASS                 TO SKXREF-SUBCLASS.            19970000
199800     MOVE ZERO                     TO PV-DEPARTMENT.              19980000
199900     IF ASC-FROM-DEPARTMENT NOT = SPACE                           19990000
200000        MOVE ASC-FROM-DEPARTMENT-9 TO PV-DEPARTMENT               20000000
200100     END-IF.                                                      20010000
200200     MOVE PV-DEPARTMENT            TO SKXREF-DEPT.                20020000
200300                                                                  20030000
200400     SET ASC-ENT-NOT-FOUND TO TRUE.                               20040000
200500     INITIALIZE EXTENT-ENT-ID                                     20050000
200600                SKXREF-SKU.                                       20060000
200700     PERFORM 7800-SELECT-ENT-ID.                                  20070000
200800                                                                  20080000
200900** SKU COMBINATION WAS NOT VALID ON TSKXREF DB2 TABLE.            20090000
201000     IF ASC-ENT-NOT-FOUND                                         20100000
201100        SET DP020-MSG-FATAL     TO TRUE                           20110000
201200        MOVE DP015-UNP-ALP-BRT-OFF TO AUPCA                       20120000
201300                                      ACLASSA                     20130000
201400                                      ADEPTA                      20140000
201500        MOVE DP015-RED          TO AUPCC                          20150000
201600                                   ACLASSC                        20160000
201700                                   ADEPTC                         20170000
201800        MOVE DP015-REVERSE      TO AUPCH                          20180000
201900                                   ACLASSH                        20190000
202000                                   ADEPTH                         20200000
202100        MOVE -1                 TO ADEPTL                         20210000
202200        IF PS-NO-ERROR                                            20220000
202300           MOVE PC-TSYMSG-03566 TO DP020-MSG-NUMBER               20230000
202400        END-IF                                                    20240000
202500        SET PS-ERROR            TO TRUE                           20250000
202600     ELSE                                                         20260000
202700        MOVE SKXREF-SKU         TO ASC-FROM-SKU                   20270000
202800     END-IF.                                                      20280000
202900                                                                  20290000
203000******************************************************************20300000
203100* THIS PARAGRAPH WILL VALIDATE THE SKU COMBINATION FOR THE       *20310000
203200* MERCHANDISE "TO" SIDE OF THE TRANSFER.                         *20320000
203300******************************************************************20330000
203400 3370-EDIT-TO-DEPT-CLS-SKU.                                       20340000
203500                                                                  20350000
203600     IF ASC-ALP-TO-UPC NOT EQUAL SPACES                           20360000
203700        MOVE ASC-ALP-TO-UPC      TO DP010I-UNEDITED-FIELD         20370000
203800        MOVE 17                  TO DP010I-MAXIMUM-DIGITS         20380000
203900        MOVE 0                   TO DP010I-MAXIMUM-DECIMALS       20390000
204000        SET  DP010I-NEGATIVE-NOT-ALLOWED                          20400000
204100                                 TO TRUE                          20410000
204210        CALL DP010I-NUMERIC-EDIT-ROUTINE                          20421034
204220                         USING DP010I-NUMERIC-EDIT-AREA           20422034
204300        IF DP010I-ERROR-DETECTED                                  20430000
204400            SET DP020-MSG-FATAL  TO TRUE                          20440000
204500*           -- MUST BE NUMERIC --                                 20450000
204600            MOVE DP015-UNP-ALP-BRT-OFF                            20460000
204700                                 TO ATOUPCA                       20470000
204800            MOVE DP015-RED       TO ATOUPCC                       20480000
204900            MOVE DP015-REVERSE   TO ATOUPCH                       20490000
205000            MOVE -1              TO ATOUPCL                       20500000
205100            IF PS-NO-ERROR                                        20510000
205200               MOVE PC-TSYMSG-00008 TO DP020-MSG-NUMBER           20520000
205300            END-IF                                                20530000
205400            SET PS-ERROR TO TRUE                                  20540000
205500        ELSE                                                      20550000
205600            MOVE DP010I-NUM-FIELD-17-DIG-0-DEC                    20560000
205700                                      TO ASC-TO-UPC               20570000
205800                                         ASC-ALP-TO-UPC-9         20580000
205900        END-IF                                                    20590000
206000     END-IF.                                                      20600000
206100                                                                  20610000
206200     IF ASC-ALP-TO-UPC = SPACES                                   20620000
206300        MOVE ZERO TO UPC-UPC-NBR                                  20630000
206400     ELSE                                                         20640000
206500        MOVE ASC-ALP-TO-UPC-9 TO UPC-UPC-NBR                      20650000
206600     END-IF.                                                      20660000
206700                                                                  20670000
206800     MOVE ZERO                   TO PV-CLASS.                     20680000
206900     IF ASC-TO-CLASS NOT = SPACE                                  20690000
207000        MOVE ASC-TO-CLASS-9      TO PV-CLASS                      20700000
207100     END-IF.                                                      20710000
207200*    MOVE PV-CLASS               TO SKXREF-CLASS.                 20720000
207300     MOVE PV-CLASS               TO SKXREF-SUBCLASS.              20730000
207400     MOVE ZERO                   TO PV-DEPARTMENT.                20740000
207500     IF ASC-TO-DEPARTMENT NOT = SPACE                             20750000
207600        MOVE ASC-TO-DEPARTMENT-9 TO PV-DEPARTMENT                 20760000
207700     END-IF.                                                      20770000
207800     MOVE PV-DEPARTMENT          TO SKXREF-DEPT.                  20780000
207900     SET ASC-ENT-NOT-FOUND TO TRUE.                               20790000
208000     INITIALIZE EXTENT-ENT-ID                                     20800000
208100                SKXREF-SKU.                                       20810000
208200     PERFORM 7800-SELECT-ENT-ID.                                  20820000
208300                                                                  20830000
208400** SKU COMBINATION WAS NOT VALID ON TSKXREF DB2 TABLE.            20840000
208500     IF ASC-ENT-NOT-FOUND                                         20850000
208600        SET DP020-MSG-FATAL     TO TRUE                           20860000
208700        MOVE DP015-UNP-ALP-BRT-OFF TO ATOUPCA                     20870000
208800                                      ATOCLSA                     20880000
208900                                      ATODEPTA                    20890000
209000        MOVE DP015-RED          TO ATOUPCC                        20900000
209100                                   ATOCLSC                        20910000
209200                                   ATODEPTC                       20920000
209300        MOVE DP015-REVERSE      TO ATOUPCH                        20930000
209400                                   ATOCLSH                        20940000
209500                                   ATODEPTH                       20950000
209600        MOVE -1                 TO ATODEPTL                       20960000
209700        IF PS-NO-ERROR                                            20970000
209800           MOVE PC-TSYMSG-03566 TO DP020-MSG-NUMBER               20980000
209900        END-IF                                                    20990000
210000        SET PS-ERROR            TO TRUE                           21000000
210100     ELSE                                                         21010000
210200        MOVE SKXREF-SKU         TO ASC-TO-SKU                     21020000
210300     END-IF.                                                      21030000
210400                                                                  21040000
210500******************************************************************21050000
210600* GET THE NEXT AVAILABLE MESSAGE NUMBER, MOVE IT TO THE SCREEN   *21060000
210700* AND POSITION THE CURSOR FOR THE INITIAL PANEL.                 *21070000
210800******************************************************************21080000
210900 4000-BUILD-INITIAL-PANEL.                                        21090000
211000                                                                  21100000
211100     INITIALIZE DCLTADJRNL                                        21110000
211200                DCLTADJDIS                                        21120000
211300                DCLTEXTENT                                        21130000
211400                DCLTENTNME                                        21140000
211500                DCLXFT00017.                                      21150002
211600*               DCLXFT00003.                                      21160002
211700                                                                  21170000
211800     SET ASC-ADD-NOT-SUCCESSFUL TO TRUE.                          21180000
211900                                                                  21190000
212000     EXEC SQL                                                     21200000
212100         SET :ASC-CURRENT-DATE = CURRENT DATE                     21210000
212200     END-EXEC.                                                    21220000
212300                                                                  21230000
212400     SET PS-NO-ERROR               TO TRUE.                       21240000
212500     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       21250000
212600     MOVE -1                       TO ADOCNUML.                   21260000
212700                                                                  21270000
212800     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        21280000
212900                                                                  21290000
213000******************************************************************21300000
213100*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *21310000
213200******************************************************************21320000
213300 4400-MOVE-COMMAREA-TO-SCREEN.                                    21330000
213400                                                                  21340000
213500     MOVE ASC-DOC-NUMBER           TO ADOCNUMO.                   21350000
213600                                                                  21360000
213700     MOVE ASC-DOC-DATE-MM          TO ADOCMMO.                    21370000
213800     MOVE ASC-DOC-DATE-DD          TO ADOCDDO.                    21380000
213900     MOVE ASC-DOC-DATE-YY          TO ADOCYYO.                    21390000
214000                                                                  21400000
214100     IF ASC-ALP-GROSS-COST(2:12) NUMERIC                          21410000
214200        IF ASC-GROSS-COST = +0                                    21420000
214300           MOVE SPACES             TO AGRCOSTO                    21430000
214400                                      ASC-ALP-GROSS-COST          21440000
214500        ELSE                                                      21450000
214600           MOVE ASC-GROSS-COST     TO PV-10V99                    21460000
214700           MOVE PV-10V99           TO AGRCOSTO                    21470000
214800                                      ASC-ALP-GROSS-COST          21480000
214900         END-IF                                                   21490000
215000     ELSE                                                         21500000
215100         MOVE ASC-ALP-GROSS-COST   TO AGRCOSTO                    21510000
215200     END-IF.                                                      21520000
215300                                                                  21530000
215400     IF ASC-ALP-RET-COST(2:12) NUMERIC                            21540000
215500        IF ASC-RETAIL-AMT = +0                                    21550000
215600           MOVE SPACES             TO ARETAMTO                    21560000
215700                                      ASC-ALP-RET-COST            21570000
215800        ELSE                                                      21580000
215900           MOVE ASC-RETAIL-AMT     TO PV-10V99                    21590000
216000           MOVE PV-10V99           TO ARETAMTO                    21600000
216100                                      ASC-ALP-RET-COST            21610000
216200         END-IF                                                   21620000
216300     ELSE                                                         21630000
216400         MOVE ASC-ALP-RET-COST     TO ARETAMTO                    21640000
216500     END-IF.                                                      21650000
216600                                                                  21660000
216700     MOVE ASC-VENDOR-NUMBER        TO AVENDNOO.                   21670000
216800     MOVE ASC-VENDOR-NAME          TO AVENDNMO.                   21680000
216900     MOVE ASC-FROM-DEPARTMENT      TO ADEPTO.                     21690000
217000     MOVE ASC-ACCT-NO              TO AACCNOO.                    21700000
217100     MOVE ASC-FROM-CLASS           TO ACLASSO.                    21710000
217200                                                                  21720000
217300     INITIALIZE PV-NUM4.                                          21730000
217400                                                                  21740000
217500     IF ASC-ALP-TO-STORE NUMERIC                                  21750000
217600        MOVE ASC-TO-STORE          TO PV-NUM4                     21760000
217700        MOVE PV-NUM4               TO ATOESTRO                    21770000
217800     ELSE                                                         21780000
217900        MOVE ASC-ALP-TO-STORE      TO ATOESTRO                    21790000
218000     END-IF.                                                      21800000
218100                                                                  21810000
218200     INITIALIZE PV-NUM4.                                          21820000
218300                                                                  21830000
218400     IF ASC-ALP-FROM-STORE NUMERIC                                21840000
218500        MOVE ASC-FROM-STORE        TO PV-NUM4                     21850000
218600        MOVE PV-NUM4               TO AFRSTRO                     21860000
218700     ELSE                                                         21870000
218800        MOVE ASC-ALP-FROM-STORE    TO AFRSTRO                     21880000
218900     END-IF                                                       21890000
219000                                                                  21900000
219100     IF ASC-ALP-FROM-UPC NUMERIC                                  21910000
219200        IF ASC-FROM-UPC = +0                                      21920000
219300           MOVE SPACES             TO AUPCO                       21930000
219400                                      ASC-ALP-FROM-UPC            21940000
219500        ELSE                                                      21950000
219600           INITIALIZE PV-NUM17                                    21960000
219700           MOVE ASC-FROM-UPC       TO PV-NUM17                    21970000
219800           MOVE PV-NUM17-X         TO AUPCO                       21980000
219900        END-IF                                                    21990000
220000     ELSE                                                         22000000
220100        MOVE ASC-ALP-FROM-UPC      TO AUPCO                       22010000
220200     END-IF.                                                      22020000
220300                                                                  22030000
220400     IF ASC-ALP-TO-UPC NUMERIC                                    22040000
220500        IF ASC-TO-UPC = +0                                        22050000
220600           MOVE SPACES             TO ATOUPCO                     22060000
220700                                      ASC-ALP-TO-UPC              22070000
220800        ELSE                                                      22080000
220900           INITIALIZE PV-NUM17                                    22090000
221000           MOVE ASC-TO-UPC         TO PV-NUM17                    22100000
221100           MOVE PV-NUM17-X         TO ATOUPCO                     22110000
221200        END-IF                                                    22120000
221300     ELSE                                                         22130000
221400        MOVE ASC-ALP-TO-UPC        TO ATOUPCO                     22140000
221500     END-IF.                                                      22150000
221600                                                                  22160000
221700     MOVE ASC-TO-DEPARTMENT        TO ATODEPTO.                   22170000
221800     MOVE ASC-TO-CLASS             TO ATOCLSO.                    22180000
221900                                                                  22190000
222000******************************************************************22200000
222100* THIS PARAGRAPH WILL CALL A MODULE TO ARRIVE AT THE NEXT        *22210000
222200* AVAILABLE DOCUMENT NUMBER.                                     *22220000
222300******************************************************************22230000
222400 4500-GET-NEXT-DOC-NO.                                            22240000
222500                                                                  22250000
222600     CALL PC-APKUP151-PGM    USING DFHEIBLK                       22260000
222700                                   WS364-COMMAREA                 22270000
222800                                   WS364-DOC-NBR-PARAMETERS.      22280000
222900                                                                  22290000
223000     IF WS364-ERRORS-FOUND                                        22300000
223100          MOVE '4500-GET-NEXT-DOC-NO   '                          22310000
223200                                TO DP013-PARAGRAPH                22320000
223300          MOVE WS364-ERROR-MESSAGE                                22330000
223400                                TO DP013-MESSAGE-TEXT (1)         22340000
223500          MOVE SQLCODE          TO DP013-SQLCA                    22350000
223600          SET DP013-DB2-ABEND                                     22360000
223700              DP013-XCTL-DISPLAY-RESTART TO TRUE                  22370000
223800          PERFORM DP013-0000-PROCESS-ABEND                        22380000
223900     END-IF.                                                      22390000
224000                                                                  22400000
224100******************************************************************22410000
224200* THIS PARAGRAPH WILL VALIDATE THAT AN ENTERED DOCUMENT NUMBER   *22420000
224300* DOES NOT ALREADY EXIST.                                        *22430000
224400******************************************************************22440000
224500 4600-VALIDATE-UNIQUE-DOC.                                        22450000
224600                                                                  22460000
224700     PERFORM                                                      22470000
224800        WITH TEST AFTER                                           22480000
224900         VARYING PV-RETRY-COUNTER                                 22490000
225000        FROM 1 BY 1                                               22500000
225100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22510000
225200                  OR (SQLCODE = ZERO)                             22520000
225300                   OR (SQLCODE = +100)                            22530000
225400                   OR (SQLCODE = -811))                           22540000
225500                                                                  22550000
225600     EXEC SQL                                                     22560000
225700         SELECT DOC_NBR                                           22570000
225800         INTO   :ADJRNL-DOC-NBR                                   22580000
225900         FROM   TADJRNL                                           22590000
226000         WHERE  DOC_NBR = :ASC-DOC-NUMBER                         22600000
226100         AND    VND_NBR = :ADJRNL-VND-NBR                         22610000
226200         AND    DOC_DTE = :ADJRNL-DOC-DTE                         22620000
226300         AND AP_TRN_CDE = :ADJRNL-AP-TRN-CDE                      22630000
226400     END-EXEC                                                     22640000
226500                                                                  22650000
226600     EVALUATE TRUE                                                22660000
226700         WHEN SQLCODE = ZERO                                      22670000
226800         WHEN SQLCODE = -811                                      22680000
226900             SET ASC-DUP-DOC TO TRUE                              22690000
227000         WHEN SQLCODE = +100                                      22700000
227100             SET ASC-NO-DUP-DOC TO TRUE                           22710000
227200         WHEN SQLCODE = -904                                      22720000
227300         WHEN SQLCODE = -913                                      22730000
227400         WHEN SQLWARN0 NOT = SPACES                               22740000
227500         WHEN SQLCODE < ZERO                                      22750000
227600         WHEN SQLCODE > ZERO                                      22760000
227700             MOVE '4600-VALIDATE-DOC'                             22770000
227800                               TO DP013-PARAGRAPH                 22780000
227900             MOVE 'SELECT TADJRNL         '                       22790000
228000                               TO DP013-MESSAGE-TEXT (1)          22800000
228100             MOVE SQLCA        TO DP013-SQLCA                     22810000
228200             MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1)        22820000
228300             SET DP013-DB2-ABEND                                  22830000
228400                 DP013-XCTL-DISPLAY-RESTART                       22840000
228500                                     TO TRUE                      22850000
228600             PERFORM DP013-0000-PROCESS-ABEND                     22860000
228700     END-EVALUATE                                                 22870000
228800     END-PERFORM.                                                 22880000
228900                                                                  22890000
229000     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22900000
229100         MOVE '4600-VALIDATE-DOC'                                 22910000
229200                                   TO DP013-PARAGRAPH             22920000
229300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     22930000
229400                                   TO DP013-MESSAGE-TEXT (1)      22940000
229500         MOVE 'DOC          '  TO DP013-MESSAGE-TEXT (2)          22950000
229600         MOVE SQLCA            TO DP013-SQLCA                     22960000
229700         MOVE 'TADJRNL'        TO DP013-DB2-TABLE-NAME (1)        22970000
229800         SET DP013-DB2-ABEND                                      22980000
229900             DP013-XCTL-DISPLAY-RESTART                           22990000
230000                                   TO TRUE                        23000000
230100         PERFORM DP013-0000-PROCESS-ABEND                         23010000
230200     END-IF.                                                      23020000
230300                                                                  23030000
230400******************************************************************23040000
230500* THIS PARAGRAPH WILL PERFORM A SELECT AGAINST THE DB2 TABLES    *23050000
230600* TEXTENT AND TENTNME TO GET THE DUNS NUMBER AND VENDOR NAME FOR *23060000
230700* DISPLAY PURPOSES.                                              *23070000
230800******************************************************************23080000
230900 4800-GET-VENDOR-DATA.                                            23090000
231000                                                                  23100000
231100     PERFORM                                                      23110000
231200        WITH TEST AFTER                                           23120000
231300         VARYING PV-RETRY-COUNTER                                 23130000
231400        FROM 1 BY 1                                               23140000
231500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               23150000
231600                  OR (SQLCODE = ZERO)                             23160000
231700                   OR (SQLCODE = +100)                            23170000
231800                   OR (SQLCODE = -811))                           23180000
231900                                                                  23190000
232000     EXEC SQL                                                     23200000
232100         SELECT B.ENT_NAME_DESC                                   23210000
232200               ,A.DUN_NBR                                         23220000
232300               ,A.ENT_ID                                          23230000
232400         INTO   :ENTNME-ENT-NAME-DESC                             23240000
232500               ,:EXTENT-DUN-NBR                                   23250000
232600               ,:EXTENT-ENT-ID                                    23260000
232700         FROM   TEXTENT A                                         23270000
232800               ,TENTNME B                                         23280000
232900         WHERE  A.ENT_ID  = :EXTENT-ENT-ID                        23290000
233000         AND    A.ENT_ID  =  B.ENT_ID                             23300000
233100         AND   B.TYPE_CDE =  '01'                                 23310000
233200*        AND A.STATUS_CDE =  'A'                                  23320000
233300     END-EXEC                                                     23330000
233400                                                                  23340000
233500     EVALUATE TRUE                                                23350000
233600         WHEN SQLCODE = ZERO                                      23360000
233700         WHEN SQLCODE = -811                                      23370000
233800             SET ASC-VENDOR-FOUND TO TRUE                         23380000
233900         WHEN SQLCODE = +100                                      23390000
234000             SET ASC-VENDOR-NOT-FOUND TO TRUE                     23400000
234100         WHEN SQLCODE = -904                                      23410000
234200         WHEN SQLCODE = -913                                      23420000
234300         WHEN SQLWARN0 NOT = SPACES                               23430000
234400         WHEN SQLCODE < ZERO                                      23440000
234500         WHEN SQLCODE > ZERO                                      23450000
234600             MOVE '4800-VALIDATE-VEND'                            23460000
234700                               TO DP013-PARAGRAPH                 23470000
234800             MOVE 'SELECT TEXTENT         '                       23480000
234900                               TO DP013-MESSAGE-TEXT (1)          23490000
235000             MOVE SQLCA        TO DP013-SQLCA                     23500000
235100             MOVE 'TEXTENT'    TO DP013-DB2-TABLE-NAME (1)        23510000
235200             SET DP013-DB2-ABEND                                  23520000
235300                 DP013-XCTL-DISPLAY-RESTART                       23530000
235400                                     TO TRUE                      23540000
235500             PERFORM DP013-0000-PROCESS-ABEND                     23550000
235600     END-EVALUATE                                                 23560000
235700     END-PERFORM.                                                 23570000
235800                                                                  23580000
235900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         23590000
236000         MOVE '4800-GET-VENDOR-DA'                                23600000
236100                                   TO DP013-PARAGRAPH             23610000
236200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     23620000
236300                                   TO DP013-MESSAGE-TEXT (1)      23630000
236400         MOVE 'DUN NUMBER   '  TO DP013-MESSAGE-TEXT (2)          23640000
236500         MOVE SQLCA            TO DP013-SQLCA                     23650000
236600         MOVE 'TEXTENT'        TO DP013-DB2-TABLE-NAME (1)        23660000
236700         SET DP013-DB2-ABEND                                      23670000
236800             DP013-XCTL-DISPLAY-RESTART                           23680000
236900                                   TO TRUE                        23690000
237000         PERFORM DP013-0000-PROCESS-ABEND                         23700000
237100     END-IF.                                                      23710000
237200                                                                  23720000
237300******************************************************************23730000
237400* FORMAT THE ADJUSTMENT JOURNAL RECORDS FOR INSERTING INTO THE   *23740000
237500* DB2 TABLE TADJRNL.  THIS PARAGRAPH WILL FORMAT THE DATA THAT   *23750000
237600* IS COMMON BETWEEN THE 53 AND 82 TRANSACTIONS.                  *23760000
237700******************************************************************23770000
237800 5000-FORMAT-COMMON-DATA.                                         23780000
237900                                                                  23790000
238000     INITIALIZE DCLTADJRNL.                                       23800000
238100                                                                  23810000
238200     MOVE ASC-DOC-NUMBER          TO ADJRNL-DOC-NBR               23820000
238300                                     ADJDIS-DOC-NBR               23830000
238400                                     ASC-KEY-DOC-NUMBER.          23840000
238500     MOVE ASC-VENDOR-NUMBER       TO ASC-KEY-VEND-NUMBER.         23850000
238600     MOVE ASC-DOC-DATE            TO ADJRNL-DOC-DTE               23860000
238700                                     ADJDIS-DOC-DTE               23870000
238800                                     ASC-KEY-DOC-DATE.            23880000
238900*    MOVE ASC-CURRENT-DATE        TO ADJRNL-DOC-DTE               23890000
239000*                                    ADJDIS-DOC-DTE               23900000
239100*                                    ASC-KEY-DOC-DATE.            23910000
239200     MOVE DP020-USERID             TO ADJRNL-ENTR-ID.             23920000
239300     MOVE ZERO                     TO ADJRNL-FRGT-AMT             23930000
239400                                      ADJDIS-FRGT-AMT             23940000
239500                                      ADJRNL-MISC-CHRG-AMT        23950000
239600                                      ADJDIS-MISC-CHRG-AMT        23960000
239700                                      ADJRNL-TERM-DISC-PCT        23970000
239800                                      ADJRNL-TERM-DISC-AMT        23980000
239900                                      ADJRNL-MOS-DISC-PCT         23990000
240000                                      ADJRNL-MOS-DISC-AMT         24000000
240100                                      ADJRNL-NW-STR-DISC-PCT      24010000
240200                                      ADJRNL-NW-STR-DISC-AMT      24020000
240300                                      ADJRNL-TRD-DISC-PCT         24030000
240400                                      ADJRNL-TRD-DISC-AMT         24040000
240500                                      ADJDIS-DISC-AMT             24050000
240600                                      ADJRNL-PO-NBR.              24060000
240700                                                                  24070000
240800     STRING                                                       24080000
240900        ASC-CURRENT-DATE,                                         24090000
241000        'ADJ',                                                    24100000
241100        '00'                                                      24110000
241200        DELIMITED BY SIZE                                         24120000
241300        INTO ADJRNL-PS-BTCH-NBR                                   24130000
241400     END-STRING.                                                  24140000
241500                                                                  24150000
241600     MOVE ASC-CURRENT-DATE         TO ADJRNL-INV-CTOFF-DTE.       24160000
241700     MOVE 'Y'                      TO ADJRNL-PS-PSTG-IND.         24170000
241800     MOVE 'N'                      TO ADJRNL-DOC-EXTR-IND.        24180000
241900     MOVE '0001-01-01'             TO ADJRNL-DOC-EXTR-DTE.        24190000
242000     MOVE 'A'                      TO ADJRNL-ORGN-CDE.            24200000
242100     MOVE SPACES                   TO ADJRNL-BRCDE-NBR.           24210000
242200     MOVE 1                        TO ADJDIS-DISTRB-SEQ-NBR.      24220000
242300     MOVE ASC-CURR-PSTG-FYR-NBR    TO ADJRNL-PSTG-FYR-NBR.        24230000
242400     MOVE ASC-CURR-PSTG-FMN-NBR    TO ADJRNL-PSTG-FMN-NBR.        24240000
242500     MOVE ASC-CURR-PSTG-FWK-NBR    TO ADJRNL-PSTG-FWK-NBR.        24250000
242600                                                                  24260000
242700******************************************************************24270000
242800* THIS PARAGRAPH WILL FORMAT ADJUSTMENT DETAIL DATA FOR PASSING  *24280000
242900* TO THE DETAIL ENTRY SCREEN.                                    *24290000
243000******************************************************************24300000
243100 5010-FORMAT-53-TRANS.                                            24310000
243200                                                                  24320000
243300     MOVE '53'                     TO ADJRNL-AP-TRN-CDE           24330000
243400                                      ADJDIS-AP-TRN-CDE           24340000
243500                                      ASC-KEY-TRAN-CODE.          24350000
243600     MOVE ASC-VENDOR-NUMBER        TO ADJRNL-VND-NBR              24360000
243700                                      ADJDIS-VND-NBR.             24370000
243800     MOVE ASC-ENT-ID               TO ADJRNL-ENT-ID.              24380000
243900     MOVE ASC-FROM-DEPARTMENT      TO ADJRNL-DEPT-NBR             24390000
244000                                      ADJDIS-DEPT-NBR.            24400000
244100     MOVE ASC-FROM-CLASS           TO ADJDIS-CL-NBR.              24410000
244200     MOVE ASC-FROM-SKU             TO ADJDIS-SKU-NBR.             24420000
244300     MOVE ASC-FROM-STORE           TO ADJRNL-STR-NBR              24430000
244400                                      ADJDIS-STR-NBR.             24440000
244500** THE 53 TRANSACTION IS A CREDIT SO THE GROSS COST IS MULTIPLIED 24450000
244600** BY -1 TO ARRIVE AT THE CORRECT SIGN.                           24460000
244700     MULTIPLY ASC-GROSS-COST BY -1 GIVING PV-53-GROSS-COST.       24470000
244800     MOVE PV-53-GROSS-COST         TO ADJRNL-GRO-COST-AMT         24480000
244900                                      ADJDIS-GRO-COST-AMT         24490000
245000                                      ADJRNL-NET-COST-AMT         24500000
245100                                      ADJDIS-NET-COST-AMT.        24510000
245200     MOVE SPACES                   TO ADJRNL-GL-ACCT-NBR.         24520000
245300** THE 53 TRANSACTION IS A CREDIT SO THE RETAIL AMT IS MULTIPLIED 24530000
245400** BY -1 TO ARRIVE AT THE CORRECT SIGN.                           24540000
245500     MULTIPLY ASC-RETAIL-AMT BY -1 GIVING PV-53-RETAIL-AMT.       24550000
245600     MOVE PV-53-RETAIL-AMT         TO ADJRNL-RTL-AMT              24560000
245700                                      ADJDIS-RTL-AMT.             24570000
245800     MOVE 'MDS'                    TO ADJRNL-TRN-TYP-CDE.         24580000
245900                                                                  24590000
246000******************************************************************24600000
246100* THIS PARAGRAPH WILL FORMAT DATA FOR A DB2 INSERT INTO TADJRNL  *24610000
246200* THAT IS SPECIFIC FOR 82 TRANSACTIONS.                          *24620000
246300******************************************************************24630000
246400 5020-FORMAT-82-TRANS.                                            24640000
246500                                                                  24650000
246600     MOVE '82'                     TO ADJRNL-AP-TRN-CDE           24660000
246700                                      ADJDIS-AP-TRN-CDE           24670000
246800                                      ASC-KEY-TRAN-CODE.          24680000
246900     MOVE ASC-VENDOR-NUMBER        TO ADJRNL-VND-NBR              24690000
247000                                      ADJDIS-VND-NBR.             24700000
247100     MOVE ASC-ENT-ID               TO ADJRNL-ENT-ID.              24710000
247200     MOVE ASC-TO-STORE             TO ADJRNL-STR-NBR              24720000
247300                                      ADJDIS-STR-NBR.             24730000
247400     MOVE ASC-ACCT-NO              TO ADJRNL-GL-ACCT-NBR.         24740000
247500     MOVE SPACES                   TO ADJDIS-DEPT-NBR             24750000
247600                                      ADJRNL-DEPT-NBR             24760000
247700                                      ADJDIS-CL-NBR.              24770000
247800     MOVE ZEROES                   TO ADJDIS-SKU-NBR.             24780000
247900     MOVE ASC-GROSS-COST           TO ADJRNL-GRO-COST-AMT         24790000
248000                                      ADJDIS-GRO-COST-AMT         24800000
248100                                      ADJRNL-NET-COST-AMT         24810000
248200                                      ADJDIS-NET-COST-AMT.        24820000
248300*    MOVE ASC-RETAIL-AMT           TO ADJRNL-RTL-AMT              24830000
248400*                                     ADJDIS-RTL-AMT.             24840000
248500     MOVE ZERO                     TO ADJRNL-RTL-AMT              24850000
248600                                      ADJDIS-RTL-AMT.             24860000
248700     MOVE 'EXP'                    TO ADJRNL-TRN-TYP-CDE.         24870000
248800                                                                  24880000
248900******************************************************************24890000
249000* THIS PARAGRAPH WILL FORMAT DATA FOR A DB2 INSERT INTO TADJRNL  *24900000
249100* THAT IS SPECIFIC FOR 52 TRANSACTIONS.                          *24910000
249200******************************************************************24920000
249300 5030-FORMAT-52-TRANS.                                            24930000
249400                                                                  24940000
249500     MOVE '52'                     TO ADJRNL-AP-TRN-CDE           24950000
249600                                      ADJDIS-AP-TRN-CDE           24960000
249700                                      ASC-KEY-TRAN-CODE.          24970000
249800     MOVE ASC-TO-VENDOR-NUMBER     TO ADJRNL-VND-NBR              24980000
249900                                      ADJDIS-VND-NBR.             24990000
250000     MOVE ASC-TO-ENT-ID            TO ADJRNL-ENT-ID.              25000000
250100     MOVE ASC-FROM-STORE           TO ADJRNL-STR-NBR              25010000
250200                                      ADJDIS-STR-NBR.             25020000
250300     MOVE SPACES                   TO ADJRNL-GL-ACCT-NBR.         25030000
250400     MOVE ASC-TO-DEPARTMENT        TO ADJDIS-DEPT-NBR             25040000
250500                                      ADJRNL-DEPT-NBR.            25050000
250600     MOVE ASC-TO-CLASS             TO ADJDIS-CL-NBR.              25060000
250700     MOVE ASC-TO-SKU               TO ADJDIS-SKU-NBR.             25070000
250800     MOVE ASC-GROSS-COST           TO ADJRNL-GRO-COST-AMT         25080000
250900                                      ADJDIS-GRO-COST-AMT         25090000
251000                                      ADJRNL-NET-COST-AMT         25100000
251100                                      ADJDIS-NET-COST-AMT.        25110000
251200     MOVE ASC-RETAIL-AMT           TO ADJRNL-RTL-AMT              25120000
251300                                      ADJDIS-RTL-AMT.             25130000
251400*    MOVE ZERO                     TO ADJRNL-RTL-AMT              25140000
251500*                                     ADJDIS-RTL-AMT.             25150000
251600     MOVE 'MDS'                    TO ADJRNL-TRN-TYP-CDE.         25160000
251700                                                                  25170000
251710******************************************************************25171028
251720*  SELECT DESCRPTION FROM APT_ACCT_TBL TABLE                     *25172028
251730******************************************************************25173028
251740 6000-SELECT-ACCT-NBR-DESC.                                       25174028
251750                                                                  25175028
251760     EXEC SQL                                                     25176028
251770         SELECT A.DESCR                                           25177028
251780           INTO :APT00002-DESCR                                   25178028
251790           FROM APT_ACCT_TBL      A                               25179028
251791          WHERE A.ACCOUNT = :PV-ACCT-NBR                          25179128
251792            AND A.EFF_STATUS = 'A'                                25179233
251793            AND A.EFFDT =                                         25179333
251794                (SELECT MAX(A1.EFFDT)                             25179433
251795                 FROM APT_ACCT_TBL      A1                        25179533
251796                 WHERE A1.ACCOUNT = A.ACCOUNT                     25179633
251797                 AND   A1.EFFDT  <= :PV-CURRENT-DATE)             25179733
251798     END-EXEC.                                                    25179833
251799                                                                  25179933
251800     EVALUATE TRUE                                                25180033
251801         WHEN SQLCODE = ZERO                                      25180133
251802              SET ASC-ACCT-FOUND  TO TRUE                         25180233
251803         WHEN SQLCODE = 100                                       25180333
251804             SET ASC-ACCT-NOT-FOUND     TO TRUE                   25180433
251805             DISPLAY 'ACCOUNT NUMBER NOT FOUND IN APT_ACCT_TBL'   25180533
251806         WHEN OTHER                                               25180633
251807             MOVE '6000-SELECT-ACCT-NBR-DESC'                     25180733
251808                               TO DP013-PARAGRAPH                 25180833
251809             MOVE 'SELECT APT_ACCT_TBL    '                       25180933
251810                               TO DP013-MESSAGE-TEXT (1)          25181033
251811             MOVE SQLCA        TO DP013-SQLCA                     25181133
251812             MOVE 'APT_ACCT_TBL'                                  25181233
251813                               TO DP013-DB2-TABLE-NAME (1)        25181333
251814             SET DP013-DB2-ABEND                                  25181433
251815                 DP013-XCTL-DISPLAY-RESTART                       25181533
251816                                     TO TRUE                      25181633
251817             PERFORM DP013-0000-PROCESS-ABEND                     25181733
251818     END-EVALUATE.                                                25181833
251819 EJECT                                                            25181933
251820                                                                  25182033
251830******************************************************************25183033
251900* THIS PARAGRAPH WILL MOVE THE POSTING DATA TO THE APPLICATION   *25190000
252000* SPECIFIC COMMAREA FIELDS AND EVALUATE THE MULTIPLE POSTING     *25200000
252100* PERIOD FLAG.                                                   *25210000
252200******************************************************************25220000
252300 7000-EVALUATE-MULT-PSTG.                                         25230000
252400                                                                  25240000
252500     PERFORM 7050-SELECT-TAPCNTL.                                 25250000
252600                                                                  25260000
252700     MOVE APCNTL-CURR-PSTG-FYR-NBR TO ASC-CURR-PSTG-FYR-NBR.      25270000
252800     MOVE APCNTL-CURR-PSTG-FMN-NBR TO ASC-CURR-PSTG-FMN-NBR.      25280000
252900     MOVE APCNTL-CURR-PSTG-FWK-NBR TO ASC-CURR-PSTG-FWK-NBR.      25290000
253000     MOVE APCNTL-PREV-PSTG-FYR-NBR TO ASC-PREV-PSTG-FYR-NBR.      25300000
253100     MOVE APCNTL-PREV-PSTG-FMN-NBR TO ASC-PREV-PSTG-FMN-NBR.      25310000
253200     MOVE APCNTL-PREV-PSTG-FWK-NBR TO ASC-PREV-PSTG-FWK-NBR.      25320000
253300                                                                  25330000
253400                                                                  25340000
253520******************************************************************25352028
253600* THIS PARAGRAPH WILL PERFORM A SELECT ON THE DB2 TAPCNTL TABLE  *25360000
253700* IN ORDER TO GET POSTING DATA FOR THE ADJUSTMENT JOURNAL.       *25370000
253800******************************************************************25380000
253900 7050-SELECT-TAPCNTL.                                             25390000
254000                                                                  25400000
254100     PERFORM                                                      25410000
254200        WITH TEST AFTER                                           25420000
254300         VARYING PV-RETRY-COUNTER                                 25430000
254400        FROM 1 BY 1                                               25440000
254500         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               25450000
254600                  OR (SQLCODE = ZERO)                             25460000
254700                   OR (SQLCODE = +100))                           25470000
254800                                                                  25480000
254900     EXEC SQL                                                     25490000
255000         SELECT CURR_PSTG_FYR_NBR                                 25500000
255100               ,CURR_PSTG_FMN_NBR                                 25510000
255200               ,CURR_PSTG_FWK_NBR                                 25520000
255300               ,PREV_PSTG_FYR_NBR                                 25530000
255400               ,PREV_PSTG_FMN_NBR                                 25540000
255500               ,PREV_PSTG_FWK_NBR                                 25550000
255600               ,MULT_PSTG_PER_IND                                 25560000
255700         INTO   :APCNTL-CURR-PSTG-FYR-NBR                         25570000
255800               ,:APCNTL-CURR-PSTG-FMN-NBR                         25580000
255900               ,:APCNTL-CURR-PSTG-FWK-NBR                         25590000
256000               ,:APCNTL-PREV-PSTG-FYR-NBR                         25600000
256100               ,:APCNTL-PREV-PSTG-FMN-NBR                         25610000
256200               ,:APCNTL-PREV-PSTG-FWK-NBR                         25620000
256300               ,:APCNTL-MULT-PSTG-PER-IND                         25630000
256400         FROM   TAPCNTL                                           25640000
256500     END-EXEC                                                     25650000
256600                                                                  25660000
256700     EVALUATE TRUE                                                25670000
256800         WHEN SQLCODE = ZERO                                      25680000
256900             CONTINUE                                             25690000
257000         WHEN SQLCODE = +100                                      25700000
257100         WHEN SQLCODE = -904                                      25710000
257200         WHEN SQLCODE = -913                                      25720000
257300         WHEN SQLWARN0 NOT = SPACES                               25730000
257400         WHEN SQLCODE < ZERO                                      25740000
257500         WHEN SQLCODE > ZERO                                      25750000
257600             MOVE '7050-SELECT-TAPCNTL'                           25760000
257700                               TO DP013-PARAGRAPH                 25770000
257800             MOVE 'SELECT TAPCNTL         '                       25780000
257900                               TO DP013-MESSAGE-TEXT (1)          25790000
258000             MOVE SQLCA        TO DP013-SQLCA                     25800000
258100             MOVE 'TAPCNTL'    TO DP013-DB2-TABLE-NAME (1)        25810000
258200             SET DP013-DB2-ABEND                                  25820000
258300                 DP013-XCTL-DISPLAY-RESTART                       25830000
258400                                     TO TRUE                      25840000
258500             PERFORM DP013-0000-PROCESS-ABEND                     25850000
258600     END-EVALUATE                                                 25860000
258700     END-PERFORM.                                                 25870000
258800                                                                  25880000
258900     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         25890000
259000         MOVE '7050-SELECT-TAPCNTL'                               25900000
259100                                   TO DP013-PARAGRAPH             25910000
259200         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     25920000
259300                                   TO DP013-MESSAGE-TEXT (1)      25930000
259400         MOVE 'STORE        '  TO DP013-MESSAGE-TEXT (2)          25940000
259500         MOVE SQLCA            TO DP013-SQLCA                     25950000
259600         MOVE 'TAPCNTL'        TO DP013-DB2-TABLE-NAME (1)        25960000
259700         SET DP013-DB2-ABEND                                      25970000
259800             DP013-XCTL-DISPLAY-RESTART                           25980000
259900                                   TO TRUE                        25990000
260000         PERFORM DP013-0000-PROCESS-ABEND                         26000000
260100     END-IF.                                                      26010000
260200                                                                  26020000
260300******************************************************************26030000
260400* THIS PARAGRAPH VALIDATES THE STORE ENTERED IN THE HEADER       *26040000
260500* AND DETAIL PORTION OF THE SCREEN.                              *26050000
260600******************************************************************26060000
260700 7400-VALIDATE-STORE.                                             26070000
260800                                                                  26080000
260900     PERFORM                                                      26090000
261000         WITH TEST AFTER                                          26100000
261100         VARYING PV-RETRY-COUNTER                                 26110000
261200         FROM 1 BY 1                                              26120000
261300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               26130000
261400            OR (SQLCODE = +0)                                     26140000
261500            OR (SQLCODE = +100))                                  26150000
261600                                                                  26160000
261700         EXEC SQL                                                 26170000
261800           SELECT  LOC_NBR                                        26180000
261900                  ,LOC_TYP_CDE                                    26190000
262000            INTO   :XFT00017-LOC-NBR                              26200002
262100                  ,:XFT00017-LOC-TYP-CDE                          26210002
262200*           INTO   :XFT00003-LOC-NBR                              26220002
262300*                 ,:XFT00003-LOC-TYP-CDE                          26230002
262400             FROM   XFT_LOC                                       26240007
262500          WHERE LOC_NBR     = :XFT00017-LOC-NBR                   26250002
262600*         WHERE LOC_NBR     = :XFT00003-LOC-NBR                   26260002
262700          AND   LOC_TYP_CDE IN                                    26270000
262800                 ('DC', 'DS', 'CS', 'RV', 'HQ', 'AL', 'DA')       26280000
262900          AND CURRENT DATE <= FINCL_CLO_DTE                       26290000
263000         END-EXEC                                                 26300000
263100                                                                  26310000
263200         EVALUATE TRUE                                            26320000
263300             WHEN SQLCODE = +0                                    26330000
263400                 SET ASC-STORE-FOUND        TO TRUE               26340000
263500             WHEN SQLCODE = -904                                  26350000
263600             WHEN SQLCODE = -913                                  26360000
263700                 CONTINUE                                         26370000
263800             WHEN SQLCODE = +100                                  26380000
263900                 SET ASC-STORE-NOT-FOUND    TO TRUE               26390000
264000                                                                  26400000
264100             WHEN SQLWARN0 NOT = SPACES                           26410000
264200             WHEN SQLCODE < ZERO                                  26420000
264300             WHEN SQLCODE > ZERO                                  26430000
264400                 MOVE '7400-VALIDATE-STORE'                       26440000
264500                                   TO DP013-PARAGRAPH             26450000
264600                 MOVE 'SELECT ON XFT00017       '                 26460002
264700*                MOVE 'SELECT ON XFT00003       '                 26470002
264800                                   TO DP013-MESSAGE-TEXT (1)      26480000
264900                 MOVE SQLCA        TO DP013-SQLCA                 26490000
265000                 MOVE 'XFT00017'   TO DP013-DB2-TABLE-NAME (1)    26500002
265100*                MOVE 'XFT00003'   TO DP013-DB2-TABLE-NAME (1)    26510002
265200                 MOVE '       '    TO DP013-DB2-TABLE-NAME (2)    26520000
265300                 SET DP013-DB2-ABEND                              26530000
265400                     DP013-XCTL-DISPLAY-RESTART                   26540000
265500                                   TO TRUE                        26550000
265600                 PERFORM DP013-0000-PROCESS-ABEND                 26560000
265700         END-EVALUATE                                             26570000
265800     END-PERFORM.                                                 26580000
265900                                                                  26590000
266000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        26600000
266100         MOVE '7400-VALIDATE-STORE'                               26610000
266200                                   TO DP013-PARAGRAPH             26620000
266300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     26630000
266400                                   TO DP013-MESSAGE-TEXT (1)      26640000
266500         MOVE SQLCA                TO DP013-SQLCA                 26650000
266600         MOVE 'XFT00017'           TO DP013-DB2-TABLE-NAME (1)    26660002
266700*        MOVE 'XFT00003'           TO DP013-DB2-TABLE-NAME (1)    26670002
266800         MOVE '       '            TO DP013-DB2-TABLE-NAME (2)    26680000
266900         SET DP013-DB2-ABEND                                      26690000
267000             DP013-XCTL-DISPLAY-RESTART                           26700000
267100                                   TO TRUE                        26710000
267200         PERFORM DP013-0000-PROCESS-ABEND                         26720000
267300     END-IF.                                                      26730000
267400                                                                  26740000
267500******************************************************************26750000
267600* THIS PARAGRAPH WILL VALIDATE THE SKU BE FINDING THE ASSOCIATED *26760000
267700* ENT-ID.                                                        *26770000
267800******************************************************************26780000
267900 7800-SELECT-ENT-ID.                                              26790000
268000                                                                  26800000
268100     EXEC SQL                                                     26810000
268200          SELECT  E.ENT_ID                                        26820000
268300                 ,A.SKU                                           26830000
268400            INTO :EXTENT-ENT-ID                                   26840000
268500                ,:SKXREF-SKU                                      26850000
268600            FROM  TSKXREF   A                                     26860000
268700                 ,TUPC      B                                     26870000
268800                 ,TMDARVS   C                                     26880000
268900                 ,TVNDSTL   D                                     26890000
269000                 ,TEXTENT   E                                     26900000
269100           WHERE  A.SUBCLASS         = :SKXREF-SUBCLASS           26910000
269200             AND  A.DEPT             = :SKXREF-DEPT               26920000
269300             AND  B.UPC_NBR          = :UPC-UPC-NBR               26930000
269400             AND  A.SKU_STAT_CDE NOT IN ('98')                    26940000
269500             AND  A.INTR_UPC_ID      = B.INTR_UPC_ID              26950000
269600             AND  B.SUB_CL_MDSEAR_ID = C.SUB_CL_MDSEAR_ID         26960000
269700             AND  B.VS_ID            = C.VS_ID                    26970000
269800             AND  C.VS_ID            = D.VS_ID                    26980000
269900             AND  D.ENT_ID           = E.ENT_ID                   26990000
270000             AND  B.EFF_END_DTE IS NULL                           27000000
270100             AND  D.EFF_END_DTE IS NULL                           27010000
270200     END-EXEC.                                                    27020000
270300                                                                  27030000
270400     EVALUATE TRUE                                                27040000
270500         WHEN SQLCODE = +0                                        27050000
270600             SET ASC-ENT-FOUND               TO TRUE              27060000
270700         WHEN SQLCODE = -904                                      27070000
270800         WHEN SQLCODE = -913                                      27080000
270900             CONTINUE                                             27090000
271000         WHEN SQLCODE = +100                                      27100000
271100             SET ASC-ENT-NOT-FOUND           TO TRUE              27110000
271200                                                                  27120000
271300         WHEN SQLWARN0 NOT = SPACES                               27130000
271400         WHEN SQLCODE < ZERO                                      27140000
271500         WHEN SQLCODE > ZERO                                      27150000
271600             MOVE '7800-SELECT-ENT-ID  '                          27160000
271700                               TO DP013-PARAGRAPH                 27170000
271800             MOVE 'ERROR ON SELECT FROM TSKXREF'                  27180000
271900                               TO DP013-MESSAGE-TEXT (1)          27190000
272000             MOVE SQLCA            TO DP013-SQLCA                 27200000
272100             MOVE 'TSKXREF'        TO DP013-DB2-TABLE-NAME (1)    27210000
272200             MOVE 'TUPC   '        TO DP013-DB2-TABLE-NAME (2)    27220000
272300             MOVE 'TMDARVS'        TO DP013-DB2-TABLE-NAME (3)    27230000
272400             MOVE 'TVNDSTL'        TO DP013-DB2-TABLE-NAME (4)    27240000
272500             MOVE 'TEXTENT'        TO DP013-DB2-TABLE-NAME (5)    27250000
272600             SET DP013-DB2-ABEND                                  27260000
272700                 DP013-XCTL-DISPLAY-RESTART                       27270000
272800                               TO TRUE                            27280000
272900             PERFORM DP013-0000-PROCESS-ABEND                     27290000
273000     END-EVALUATE.                                                27300000
273100                                                                  27310000
273200******************************************************************27320000
273300* THIS PARAGRAPH WILL PERFORM A DB2 INSERT INTO THE TADJRNL      *27330000
273400* TABLE.                                                         *27340000
273500******************************************************************27350000
273600 8100-INSERT-TADJRNL.                                             27360000
273700                                                                  27370000
273800     PERFORM                                                      27380000
273900         WITH TEST AFTER                                          27390000
274000         VARYING PV-RETRY-COUNTER                                 27400000
274100         FROM 1 BY 1                                              27410000
274200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               27420000
274300                   OR (SQLCODE = ZERO))                           27430000
274400                                                                  27440000
274500         EXEC SQL                                                 27450000
274600             INSERT INTO TADJRNL                                  27460000
274700                (VND_NBR,                                         27470000
274800                 DOC_NBR,                                         27480000
274900                 DOC_DTE,                                         27490000
275000                 AP_TRN_CDE,                                      27500000
275100                 PO_NBR,                                          27510000
275200                 DEPT_NBR,                                        27520000
275300                 GL_ACCT_NBR,                                     27530000
275400                 STR_NBR,                                         27540000
275500                 ENTR_TMST,                                       27550000
275600                 ENTR_ID,                                         27560000
275700                 ORGN_CDE,                                        27570000
275800                 GRO_COST_AMT,                                    27580000
275900                 RTL_AMT,                                         27590000
276000                 FRGT_AMT,                                        27600000
276100                 MISC_CHRG_AMT,                                   27610000
276200                 TERM_DISC_PCT,                                   27620000
276300                 TERM_DISC_AMT,                                   27630000
276400                 NW_STR_DISC_PCT,                                 27640000
276500                 NW_STR_DISC_AMT,                                 27650000
276600                 TRD_DISC_PCT,                                    27660000
276700                 TRD_DISC_AMT,                                    27670000
276800                 NET_COST_AMT,                                    27680000
276900                 INV_CTOFF_DTE,                                   27690000
277000                 TRN_TYP_CDE,                                     27700000
277100                 DOC_EXTR_IND,                                    27710000
277200                 DOC_EXTR_DTE,                                    27720000
277300                 PSTG_FYR_NBR,                                    27730000
277400                 PSTG_FMN_NBR,                                    27740000
277500                 PSTG_FWK_NBR,                                    27750000
277600                 BRCDE_NBR,                                       27760000
277700                 PS_BTCH_NBR,                                     27770000
277800                 PS_PSTG_IND,                                     27780000
277900                 ENT_ID,                                          27790000
278000                 MOS_DISC_PCT,                                    27800000
278100                 MOS_DISC_AMT )                                   27810000
278200             VALUES                                               27820000
278300                ( :ADJRNL-VND-NBR,                                27830000
278400                  :ADJRNL-DOC-NBR,                                27840000
278500                  :ADJRNL-DOC-DTE,                                27850000
278600                  :ADJRNL-AP-TRN-CDE,                             27860000
278700                  :ADJRNL-PO-NBR,                                 27870000
278800                  :ADJRNL-DEPT-NBR,                               27880000
278900                  :ADJRNL-GL-ACCT-NBR,                            27890000
279000                  :ADJRNL-STR-NBR,                                27900000
279100                   CURRENT TIMESTAMP,                             27910000
279200                  :ADJRNL-ENTR-ID,                                27920000
279300                  :ADJRNL-ORGN-CDE,                               27930000
279400                  :ADJRNL-GRO-COST-AMT,                           27940000
279500                  :ADJRNL-RTL-AMT,                                27950000
279600                  :ADJRNL-FRGT-AMT,                               27960000
279700                  :ADJRNL-MISC-CHRG-AMT,                          27970000
279800                  :ADJRNL-TERM-DISC-PCT,                          27980000
279900                  :ADJRNL-TERM-DISC-AMT,                          27990000
280000                  :ADJRNL-NW-STR-DISC-PCT,                        28000000
280100                  :ADJRNL-NW-STR-DISC-AMT,                        28010000
280200                  :ADJRNL-TRD-DISC-PCT,                           28020000
280300                  :ADJRNL-TRD-DISC-AMT,                           28030000
280400                  :ADJRNL-NET-COST-AMT,                           28040000
280500                  :ADJRNL-INV-CTOFF-DTE,                          28050000
280600                  :ADJRNL-TRN-TYP-CDE,                            28060000
280700                  :ADJRNL-DOC-EXTR-IND,                           28070000
280800                  :ADJRNL-DOC-EXTR-DTE,                           28080000
280900                  :ADJRNL-PSTG-FYR-NBR,                           28090000
281000                  :ADJRNL-PSTG-FMN-NBR,                           28100000
281100                  :ADJRNL-PSTG-FWK-NBR,                           28110000
281200                  :ADJRNL-BRCDE-NBR,                              28120000
281300                  :ADJRNL-PS-BTCH-NBR,                            28130000
281400                  :ADJRNL-PS-PSTG-IND,                            28140000
281500                  :ADJRNL-ENT-ID,                                 28150000
281600                  :ADJRNL-MOS-DISC-PCT,                           28160000
281700                  :ADJRNL-MOS-DISC-AMT )                          28170000
281800         END-EXEC                                                 28180000
281900                                                                  28190000
282000         EVALUATE TRUE                                            28200000
282100            WHEN SQLCODE = ZERO                                   28210000
282200            WHEN SQLCODE = -904                                   28220000
282300            WHEN SQLCODE = -913                                   28230000
282400                CONTINUE                                          28240000
282500            WHEN SQLWARN0 NOT = SPACES                            28250000
282600            WHEN SQLCODE < ZERO                                   28260000
282700            WHEN SQLCODE > ZERO                                   28270000
282800                MOVE '8100-INSERT-TADJRNL   '                     28280000
282900                                 TO DP013-PARAGRAPH               28290000
283000                MOVE 'INSERT A ROW INTO THE ADJUSTMENT JRN TABLE' 28300000
283100                                 TO DP013-MESSAGE-TEXT(1)         28310000
283200                MOVE SQLCA        TO DP013-SQLCA                  28320000
283300                MOVE 'TADJRNL'    TO DP013-DB2-TABLE-NAME (1)     28330000
283400                SET DP013-DB2-ABEND                               28340000
283500                   DP013-XCTL-DISPLAY-RESTART TO TRUE             28350000
283600                PERFORM DP013-0000-PROCESS-ABEND                  28360000
283700         END-EVALUATE                                             28370000
283800     END-PERFORM.                                                 28380000
283900                                                                  28390000
284000     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        28400000
284100       MOVE '8100-INSERT-ADJUSTMENT'                              28410000
284200                                   TO DP013-PARAGRAPH             28420000
284300       MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT A NEW  28430000
284400-             ' ADJUSTMENT    '    TO DP013-MESSAGE-TEXT (1)      28440000
284500       MOVE SQLCA                TO DP013-SQLCA                   28450000
284600         MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)    28460000
284700       SET DP013-DB2-ABEND                                        28470000
284800             DP013-XCTL-DISPLAY-RESTART                           28480000
284900                                 TO TRUE                          28490000
285000         PERFORM DP013-0000-PROCESS-ABEND                         28500000
285100     END-IF.                                                      28510000
285200                                                                  28520000
285300******************************************************************28530000
285400* THIS PARAGRAPH WILL PERFORM A DB2 INSERT INTO THE TADJDIS      *28540000
285500* TABLE.                                                         *28550000
285600******************************************************************28560000
285700 8200-INSERT-TADJDIS.                                             28570000
285800                                                                  28580000
285900     PERFORM                                                      28590000
286000         WITH TEST AFTER                                          28600000
286100         VARYING PV-RETRY-COUNTER                                 28610000
286200         FROM 1 BY 1                                              28620000
286300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               28630000
286400                   OR (SQLCODE = ZERO))                           28640000
286500                                                                  28650000
286600         EXEC SQL                                                 28660000
286700             INSERT INTO TADJDIS                                  28670000
286800                (VND_NBR,                                         28680000
286900                 DOC_NBR,                                         28690000
287000                 DOC_DTE,                                         28700000
287100                 AP_TRN_CDE,                                      28710000
287200                 DISTRB_SEQ_NBR,                                  28720000
287300                 STR_NBR,                                         28730000
287400                 DEPT_NBR,                                        28740000
287500                 CL_NBR,                                          28750000
287600                 SKU_NBR,                                         28760000
287700                 GRO_COST_AMT,                                    28770000
287800                 RTL_AMT,                                         28780000
287900                 FRGT_AMT,                                        28790000
288000                 MISC_CHRG_AMT,                                   28800000
288100                 DISC_AMT,                                        28810000
288200                 NET_COST_AMT)                                    28820000
288300         VALUES                                                   28830000
288400            (:ADJDIS-VND-NBR                                      28840000
288500            ,:ADJDIS-DOC-NBR                                      28850000
288600            ,:ADJDIS-DOC-DTE                                      28860000
288700            ,:ADJDIS-AP-TRN-CDE                                   28870000
288800            ,:ADJDIS-DISTRB-SEQ-NBR                               28880000
288900            ,:ADJDIS-STR-NBR                                      28890000
289000            ,:ADJDIS-DEPT-NBR                                     28900000
289100            ,:ADJDIS-CL-NBR                                       28910000
289200            ,:ADJDIS-SKU-NBR                                      28920000
289300            ,:ADJDIS-GRO-COST-AMT                                 28930000
289400            ,:ADJDIS-RTL-AMT                                      28940000
289500            ,:ADJDIS-FRGT-AMT                                     28950000
289600            ,:ADJDIS-MISC-CHRG-AMT                                28960000
289700            ,:ADJDIS-DISC-AMT                                     28970000
289800            ,:ADJDIS-NET-COST-AMT)                                28980000
289900         END-EXEC                                                 28990000
290000                                                                  29000000
290100         EVALUATE TRUE                                            29010000
290200            WHEN SQLCODE = ZERO                                   29020000
290300                 SET ASC-ADD-SUCCESSFUL TO TRUE                   29030000
290400            WHEN SQLCODE = -904                                   29040000
290500            WHEN SQLCODE = -913                                   29050000
290600                 CONTINUE                                         29060000
290700            WHEN SQLWARN0 NOT = SPACES                            29070000
290800            WHEN SQLCODE < ZERO                                   29080000
290900            WHEN SQLCODE > ZERO                                   29090000
291000                MOVE '8200-INSERT-TADJDIS   '                     29100000
291100                                   TO DP013-PARAGRAPH             29110000
291200                MOVE 'INSERT A ROW INTO THE ADJ. DISTRO TABLE'    29120000
291300                                   TO DP013-MESSAGE-TEXT(1)       29130000
291400                MOVE SQLCA         TO DP013-SQLCA                 29140000
291500                MOVE 'TADJDIS'     TO DP013-DB2-TABLE-NAME(1)     29150000
291600                SET DP013-DB2-ABEND                               29160000
291700                    DP013-XCTL-DISPLAY-RESTART TO TRUE            29170000
291800                PERFORM DP013-0000-PROCESS-ABEND                  29180000
291900         END-EVALUATE                                             29190000
292000     END-PERFORM.                                                 29200000
292100                                                                  29210000
292200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        29220000
292300       MOVE '8200-INSERT-TADJDIS   '                              29230000
292400                                  TO DP013-PARAGRAPH              29240000
292500       MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO INSERT A NEW  29250000
292600-           ' DISTRO LINE   '    TO DP013-MESSAGE-TEXT (1)        29260000
292700       MOVE SQLCA                TO DP013-SQLCA                   29270000
292800       MOVE 'TADJRNL'            TO DP013-DB2-TABLE-NAME (1)      29280000
292900       SET DP013-DB2-ABEND                                        29290000
293000            DP013-XCTL-DISPLAY-RESTART                            29300000
293100                                 TO TRUE                          29310000
293200        PERFORM DP013-0000-PROCESS-ABEND                          29320000
293300     END-IF.                                                      29330000
293400                                                                  29340000
293500******************************************************************29350000
293600* ABEND PROCESSOR MODULE                                         *29360000
293700******************************************************************29370000
293800                                                                  29380000
293900     COPY DPPD013.                                                29390000
