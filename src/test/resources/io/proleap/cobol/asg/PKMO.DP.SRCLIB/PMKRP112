000100*----------------------------------------------------------       00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*----------------------------------------------------------       00030000
000400 PROGRAM-ID.             PMKRP112.                                00040000
000500 AUTHOR.                 ALEXIS KEIKER.                           00050000
000600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00060000
000700 DATE-WRITTEN.           APRIL 2003.                              00070000
000800 DATE-COMPILED.                                                   00080000
000900*----------------------------------------------------------       00090000
001000*          PMKRP112 - PROMOTION SUMMARY BY AD PAGE                00100000
001020*----------------------------------------------------------       00102000
001021* THIS PROGRAM WILL PRODUCE EITHER A FORECAST ONLY REPORT         00102100
001022* OR AN ACTUAL/FORECAST REPORT.  THIS PROGRAM USES TWO            00102250
001023* INPUT FILES.  THE FIRST INPUT FILE IS A PROMOTIONAL SUMMATION   00102350
001024* BY PAGE NUMBER OF EACH GMM.  THE SECOND INPUT FILE IS A         00102450
001025* PROMOTIONAL SUMMATION BY ADVERTISED INDICATOR OF EACH           00102550
001026* DMM.  THESE INPUT FILES WERE CREATED FROM THE PMKUT100          00102650
001027* PROGRAM. THE INPUT FILES ARE THEN SORTED AND SUMMED DIFFERENTLY 00102750
001028* TO GET THE CORRECT PROMOTIONAL TOTALS NEEDED.  THE REPORT       00102850
001029* BREAKS BY AD EVENT/PROMOTION.  THE FIRST PAGE WILL ALWAYS       00102950
001030* DISPLAY THE GMM TOTALS BY PAGE NUMBER/UNADVERTISED TOTALS.      00103050
001031* THE SECOND PAGE TO THE PROMOTION WILL ALWAYS DISPLAY THE        00103150
001032* FINAL GMM TOTALS AND THE FINAL PROMOTION TOTAL.  THE SECOND     00103250
001033* PAGE ALSO SHOWS A BREAK DOWN OF TOTALS FOR THE PROMOTION        00103350
001034* FOR EACH DMM. THIS IS WHERE THE SECOND INPUT FILE IS USED.      00103450
001035*----------------------------------------------------------       00103500
001036* HISTORY LOG:                                                    00103600
001037*----------------------------------------------------------       00103700
PGNBR * DATE: 06/20/2014                                                00103857
PGNBR * WR/IR#: PRB 47935                                               00103957
PGNBR * PROGRAMMER: COGNIZANT                                           00104057
PGNBR * DESCRIPTION:MODIFIED THE CODE TO HANDLE ADVERTISED PROMO ITEMS  00104157
PGNBR *             WITH NO PAGE NUMBER.                                00104257
001042*                                                                 00104300
001043*----------------------------------------------------------       00104400
001050 ENVIRONMENT DIVISION.                                            00105000
001060*----------------------------------------------------------       00106000
001070 CONFIGURATION SECTION.                                           00107000
001080 SOURCE-COMPUTER. IBM-3090.                                       00108000
001090 OBJECT-COMPUTER. IBM-3090.                                       00109000
001100                                                                  00110000
001200 INPUT-OUTPUT SECTION.                                            00120000
001300                                                                  00130000
001400 FILE-CONTROL.                                                    00140000
001500                                                                  00150000
001600     SELECT PROMO-SUMM-GMA-FILE                                   00160002
001700            ASSIGN TO INP01.                                      00170000
001800                                                                  00180000
001810     SELECT PROMO-SUMM-DMA-FILE                                   00181002
001820            ASSIGN TO INP02.                                      00182000
001830                                                                  00183000
001900     SELECT PROMO-SUMM-REPORT                                     00190007
002000            ASSIGN TO RPT01.                                      00200000
002100                                                                  00210000
002200*----------------------------------------------------------       00220000
002300 DATA DIVISION.                                                   00230000
002400*----------------------------------------------------------       00240000
002500 FILE SECTION.                                                    00250000
002600                                                                  00260000
002700 FD  PROMO-SUMM-GMA-FILE                                          00270002
002800     RECORDING MODE F                                             00280000
002900     BLOCK CONTAINS 0 RECORDS                                     00290000
003000     LABEL RECORDS ARE OMITTED.                                   00300000
003100 01  PROMO-SUMM-GMA-RECORD            PIC X(750).                 00310002
003200                                                                  00320000
003210 FD  PROMO-SUMM-DMA-FILE                                          00321002
003220     RECORDING MODE F                                             00322000
003230     BLOCK CONTAINS 0 RECORDS                                     00323000
003240     LABEL RECORDS ARE OMITTED.                                   00324000
003250 01  PROMO-SUMM-DMA-RECORD            PIC X(750).                 00325002
003260                                                                  00326000
003300 FD  PROMO-SUMM-REPORT                                            00330000
003400     RECORDING MODE F                                             00340000
003500     BLOCK CONTAINS 0 RECORDS                                     00350000
003600     LABEL RECORDS ARE OMITTED.                                   00360000
003700 01  PROMO-SUMM-RPT-LINE              PIC X(200).                 00370000
003800                                                                  00380000
003900 WORKING-STORAGE SECTION.                                         00390000
004000*----------------------------------------------------------       00400000
004100* CD- CONTROL DATES (DATES ACCEPTED INTO THE PROGRAM)             00410000
004200*----------------------------------------------------------       00420000
004300 01  CD-CONTROL-DATES.                                            00430000
004400     05  CD-CPU-DATE.                                             00440000
004500         10  CD-CPU-YR                PIC 9(02)  VALUE ZEROES.    00450000
004510         10  CD-CPU-MO                PIC 9(02)  VALUE ZEROES.    00451000
004520         10  CD-CPU-DY                PIC 9(02)  VALUE ZEROES.    00452000
004530                                                                  00453000
004540     05  CD-CPU-DATE-GREG.                                        00454000
004550         10  CD-CPU-MM                PIC 9(02)  VALUE ZEROES.    00455000
004560         10  CD-CPU-DD                PIC 9(02)  VALUE ZEROES.    00456000
004570         10  CD-CPU-YY                PIC 9(02)  VALUE ZEROES.    00457000
004580                                                                  00458000
004590     05  CD-CPU-DATE-ISO              PIC X(10)  VALUE SPACES.    00459000
004591                                                                  00459100
004592*----------------------------------------------------------       00459200
004593* CT- CONTROL TIMES (TIMES ACCEPTED INTO THE PROGRAM)             00459300
004594*----------------------------------------------------------       00459400
004595 01  CT-CONTROL-TIMES.                                            00459500
004596     05  CT-CPU-TIME.                                             00459600
004597         10  CT-CPU-HR                PIC 9(02)  VALUE ZEROES.    00459700
004598         10  CT-CPU-MIN               PIC 9(02)  VALUE ZEROES.    00459800
004599         10  CT-CPU-SEC               PIC 9(02)  VALUE ZEROES.    00459900
004600         10  CT-CPU-HSEC              PIC 9(02)  VALUE ZEROES.    00460000
004601                                                                  00460100
004602*----------------------------------------------------------       00460200
004603* PC- PROGRAM CONSTANTS                                           00460300
004604*----------------------------------------------------------       00460400
004605 01  PC-PROGRAM-CONSTANTS.                                        00460500
004606     05  PC-MAX-LINE-CNT              PIC S9(04) VALUE +78 COMP.  00460600
004607     05  PC-SUB-1                     PIC 9(01)  VALUE 1.         00460700
004608     05  PC-SUB-2                     PIC 9(01)  VALUE 2.         00460800
004609     05  PC-DEFAULT-BEG-HR            PIC 9(02)  VALUE 0.         00460900
004610     05  PC-DEFAULT-BEG-MIN           PIC 9(02)  VALUE 0.         00461000
004620     05  PC-DEFAULT-END-HR            PIC 9(02)  VALUE 23.        00462000
004630     05  PC-DEFAULT-END-MIN           PIC 9(02)  VALUE 59.        00463000
004640     05  PC-CHAR-BUY                  PIC X(03)  VALUE 'BUY'.     00464000
004650     05  PC-CHAR-GET                  PIC X(03)  VALUE 'GET'.     00465000
004660     05  PC-CHAR-OFF                  PIC X(03)  VALUE 'OFF'.     00466000
004670     05  PC-CHAR-EFFECTIVE            PIC X(09)  VALUE            00467000
004680                                          'EFFECTIVE'.            00468000
004690     05  PC-FORECAST-RSLT             PIC X(36)  VALUE            00469003
004700         'FORECAST ONLY RESULTS (IN THOUSANDS)'.                  00470003
004800     05  PC-ACTUAL-RSLT               PIC X(36)  VALUE            00480003
004900         'ACTUAL RESULTS (IN THOUSANDS)       '.                  00490003
004950     05  PC-PERCENT-SIGN              PIC X(01)  VALUE '%'.       00495000
004960     05  PC-DOLLAR-SIGN               PIC X(01)  VALUE '$'.       00496000
004970     05  PC-FRONT-PAR                 PIC X(01)  VALUE '('.       00497000
004980     05  PC-BACK-PAR                  PIC X(01)  VALUE ')'.       00498000
004990     05  PC-ONE-LINE                  PIC S9(04) VALUE +1 COMP.   00499000
005000     05  PC-CURRENT-PROGRAM-NAME      PIC X(08)  VALUE            00500000
005100                                                 'PMKRP112'.      00510000
005200     05  PC-COLON                     PIC X(01)  VALUE ':'.       00520000
005300     05  PC-DASH                      PIC X(01)  VALUE '-'.       00530000
005400     05  PC-ALL-DAY                   PIC X(07)  VALUE            00540000
005500                                                 'ALL DAY'.       00550000
006400     05  PC-TOTAL                     PIC X(05)  VALUE            00640000
006500          'TOTAL'.                                                00650000
006600     05  PC-UNADVERTISED              PIC X(04)  VALUE            00660004
006700          'UNAD'.                                                 00670004
PGNBR      05  PC-ADVNOPAGE                 PIC X(04)  VALUE            00680056
PGNBR           'NOPG'.                                                 00690056
007400     05  PC-PROMO-TOTAL               PIC X(18)  VALUE            00740007
007500          'PROMOTION TOTAL   '.                                   00750021
007510     05  PC-ADV-DMM                   PIC X(14)  VALUE            00751006
007520          '    ADV DMM - '.                                       00752006
007530     05  PC-UNAD-DMM                  PIC X(14)  VALUE            00753021
007540          '   UNAD DMM - '.                                       00754006
007550     05  PC-TOTAL-DMM                 PIC X(14)  VALUE            00755021
007560          '  TOTAL DMM - '.                                       00756006
007600                                                                  00760000
007700*----------------------------------------------------------       00770000
007800* PS- PROGRAM SWITCHES                                            00780000
007900*----------------------------------------------------------       00790000
008000 01  PS-PROGRAM-SWITCHES.                                         00800000
008100     05  PS-EOF-SLS-GMA-RSLTS-SW      PIC X(01)  VALUE 'Y'.       00810002
008200         88  PS-EOF-SLS-GMA-RSLTS                VALUE 'N'.       00820002
008300         88  PS-NOT-EOF-SLS-GMA-RSLT             VALUE 'Y'.       00830002
008310     05  PS-EOF-SLS-DMA-RSLTS-SW      PIC X(01)  VALUE 'Y'.       00831002
008320         88  PS-EOF-SLS-DMA-RSLTS                VALUE 'N'.       00832002
008330         88  PS-NOT-EOF-SLS-DMA-RSLTS            VALUE 'Y'.       00833002
008400     05  PS-FIRST-TIME-SW             PIC X(01)  VALUE 'Y'.       00840000
008500         88  PS-NOT-FIRST-TIME                   VALUE 'N'.       00850000
008600         88  PS-FIRST-TIME                       VALUE 'Y'.       00860000
008700     05  PS-FIRST-TIME-DMM-SW         PIC X(01)  VALUE 'Y'.       00870006
008800         88  PS-NOT-FIRST-TIME-DMM               VALUE 'N'.       00880006
008900         88  PS-FIRST-TIME-DMM                   VALUE 'Y'.       00890006
010710     05  PS-GMA-RESULTS-SW            PIC X(01)  VALUE 'Y'.       01071006
010720         88  PS-DMA-RESULTS                      VALUE 'N'.       01072006
010730         88  PS-GMA-RESULTS                      VALUE 'Y'.       01073006
010740     05  PS-GMA-NBR-FOUND-SW          PIC X(01)  VALUE 'Y'.       01074007
010750         88  PS-GMA-NBR-FOUND                    VALUE 'N'.       01075007
010760         88  PS-GMA-NBR-NOT-FOUND                VALUE 'Y'.       01076007
010770     05  PS-FIRST-LINE-DMM-SW         PIC X(01)  VALUE 'Y'.       01077021
010780         88  PS-FIRST-LINE-DMM                   VALUE 'N'.       01078021
010790         88  PS-NO-FIRST-LINE-DMM                VALUE 'Y'.       01079021
010791     05  PS-FIRST-DMA-READ-SW         PIC X(01)  VALUE 'Y'.       01079146
010792         88  PS-NOT-FIRST-DMA-READ               VALUE 'N'.       01079246
010793         88  PS-FIRST-DMA-READ                   VALUE 'Y'.       01079346
010800                                                                  01080000
010900*----------------------------------------------------------       01090000
011000* PV- PROGRAM VARIABLES                                           01100000
011100*----------------------------------------------------------       01110000
011200 01  PV-PROGRAM-VARIABLES.                                        01120000
011300     05  PV-ADVANCE-LINES             PIC S9(04) VALUE +1 COMP.   01130000
011500     05  PV-LINE-CNT                  PIC S9(04) VALUE +0 COMP.   01150000
011600     05  PV-PAGE-CNT                  PIC 9(05)  VALUE 0.         01160000
011700     05  PV-PARAGRAPH-NAME            PIC X(30)  VALUE SPACE.     01170000
011800     05  PV-OPERATION-MSG-1           PIC X(40)  VALUE SPACES.    01180000
011900     05  PV-OPERATION-MSG-2           PIC X(40)  VALUE SPACES.    01190000
012000     05  PV-SAVE-VAR                  PIC X(40)  VALUE SPACES.    01200000
012100     05  PV-SAVE-NUM                  PIC 9(02)  VALUE 0.         01210000
012200     05  PV-SAVE-LENGTH               PIC 9(02)  VALUE 0.         01220000
012300     05  PV-SUBSCRIPT                 PIC 9(02)  VALUE 0.         01230000
012400     05  PV-PROMO-NM-LENGTH           PIC 9(02)  VALUE 0.         01240000
012500     05  PV-AD-EVNT-NM-LENGTH         PIC 9(02)  VALUE 0.         01250000
012600     05  PV-AD-EVNT-NBR-LENGTH        PIC 9(02)  VALUE 0.         01260000
012610     05  PV-GMM-LAST-NM-LENGTH        PIC 9(02)  VALUE 0.         01261005
012620     05  PV-SAVE-GMA-NAME             PIC X(40)  VALUE SPACES.    01262006
012621     05  PV-LAST-DMA-LAST-NM          PIC X(40)  VALUE SPACES.    01262117
012622     05  PV-SAVE-AD-EVNT-ID           PIC 9(10)  VALUE 0.         01262225
012623     05  PV-SAVE-PROMO-ID             PIC 9(10)  VALUE 0.         01262307
012624     05  PV-LAST-GMA-NBR              PIC 9(04)  VALUE 0.         01262407
012625     05  PV-LAST-DMA-NBR              PIC 9(04)  VALUE 0.         01262507
012630     05  PV-DMM-TITLE.                                            01263006
012640         10  PV-DMM-TOTAL-TITLE       PIC X(14)  VALUE SPACES.    01264006
012650         10  PV-DMM-LAST-NAME         PIC X(40)  VALUE SPACES.    01265006
012700                                                                  01270000
012800     05  PV-TIER-ITM-DESC.                                        01280000
012900         10  FILLER                   PIC X(01)  VALUE SPACES.    01290000
013000         10  PV-TIER-ITM-DESC-1       PIC X(39)  VALUE SPACES.    01300000
013100     05  PV-THRS-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01310000
013200     05  PV-THRS-AMT-NUM-X REDEFINES                              01320000
013300         PV-THRS-AMT-NUM              PIC 9(10).                  01330000
013400     05  PV-DISC-PCT-NUM              PIC 9(03)V9(03) VALUE 0.    01340000
013500     05  PV-DISC-PCT-NUM-X REDEFINES                              01350000
013600         PV-DISC-PCT-NUM              PIC 9(06).                  01360000
013700     05  PV-DISC-AMT-NUM              PIC 9(08)V9(02) VALUE 0.    01370000
013800     05  PV-DISC-AMT-NUM-X REDEFINES                              01380000
013900         PV-DISC-AMT-NUM              PIC 9(10).                  01390000
014000     05  PV-SAVE-THRS-AMT.                                        01400000
014100         10  PV-SAVE-THRS-AMT-1       PIC 9(08)  VALUE 0.         01410000
014200         10  PV-SAVE-THRS-AMT-2       PIC 9(02)  VALUE 0.         01420000
014300     05  PV-SAVE-DISC-PCT.                                        01430000
014400         10  PV-SAVE-DISC-PCT-1       PIC 9(03)  VALUE 0.         01440000
014500         10  PV-SAVE-DISC-PCT-2       PIC 9(03)  VALUE 0.         01450000
014600     05  PV-SAVE-DISC-AMT.                                        01460000
014700         10  PV-SAVE-DISC-AMT-1       PIC 9(08)  VALUE 0.         01470000
014800         10  PV-SAVE-DISC-AMT-2       PIC 9(02)  VALUE 0.         01480000
014900     05  PV-THRS-AMT-CHAR             PIC X(08)  VALUE SPACES.    01490000
015000     05  PV-DISC-PCT-CHAR             PIC X(03)  VALUE SPACES.    01500000
015100     05  PV-DISC-AMT-CHAR             PIC X(08)  VALUE SPACES.    01510000
015200     05  PV-THRS-QTY-CHAR             PIC X(05)  VALUE SPACES.    01520000
015300     05  PV-POINTER-FIELD             PIC S9(03) VALUE +0.        01530000
015400     05  PV-LAST-ADEVNT-ID            PIC 9(10)  VALUE 0.         01540000
015500     05  PV-LAST-PROMO-ID             PIC 9(10)  VALUE 0.         01550000
015600     05  PV-TIER-PRICG-ID             PIC 9(10)  VALUE 0.         01560000
015700     05  PV-AD-PG-NBR                 PIC 9(03)  VALUE 0.         01570000
015900     05  PV-ROUND-TO-WHOLE-DOLLARS    PIC S9(09) VALUE +0.        01590000
016000     05  PV-ROUND-TO-TENTHS           PIC S9(09)V9 VALUE +0.      01600000
016010     05  PV-ROUND-TO-HDRTHS           PIC S9(09)V99 VALUE +0.     01601041
016100     05  PV-ROUND-VOL-PCT             PIC 9(09)V9 VALUE 0.        01610000
016200     05  PV-TRUNCAT-VOL-PCT           PIC 9(04)V9 VALUE 0.        01620034
016300     05  PV-TRUNCAT-VOL-PCT-X REDEFINES                           01630000
016400         PV-TRUNCAT-VOL-PCT           PIC 9(05).                  01640034
016500     05  PV-NUM-VOL-PCT.                                          01650000
016600         10  PV-NUM-VOL-PCT-1         PIC 9(04)  VALUE 0.         01660034
016700         10  PV-NUM-VOL-PCT-2         PIC 9(01)  VALUE 0.         01670000
016800     05  PV-CHAR-VOL-PCT REDEFINES                                01680000
016900         PV-NUM-VOL-PCT.                                          01690000
017000         10  PV-CHAR-VOL-PCT-1        PIC X(04).                  01700034
017100         10  PV-CHAR-VOL-PCT-2        PIC X(01).                  01710000
017200     05  PV-FINAL-VOL-PCT.                                        01720000
017210         10  PV-FINAL-VOL-PCT-1       PIC X(01)  VALUE SPACES.    01721034
017300         10  PV-FINAL-VOL-PCT-2       PIC X(01)  VALUE SPACES.    01730034
017400         10  PV-FINAL-VOL-PCT-3       PIC X(01)  VALUE SPACES.    01740034
017500         10  PV-FINAL-VOL-PCT-4       PIC X(01)  VALUE SPACES.    01750034
017600         10  PV-FINAL-VOL-PCT-5       PIC X(01)  VALUE SPACES.    01760034
017700         10  FILLER                   PIC X(01)  VALUE '.'.       01770000
017800         10  PV-FINAL-VOL-PCT-6       PIC X(01)  VALUE SPACES.    01780034
017900         10  PV-FINAL-VOL-PCT-7       PIC X(01)  VALUE SPACES.    01790034
018000     05  PV-SEP-VOL-PCT.                                          01800000
018010         10  PV-SEP-VOL-PCT-1         PIC 9(01)  VALUE 0.         01801034
018100         10  PV-SEP-VOL-PCT-2         PIC 9(01)  VALUE 0.         01810034
018110         10  PV-SEP-VOL-PCT-3         PIC 9(01)  VALUE 0.         01811034
018120         10  PV-SEP-VOL-PCT-4         PIC 9(01)  VALUE 0.         01812034
018130         10  PV-SEP-VOL-PCT-5         PIC 9(01)  VALUE 0.         01813034
018140     05  PV-VOL-PCT-CHG               PIC S9(09)V9999 VALUE +0    01814000
018150                                                     COMP-3.      01815000
018160     05  PV-MU-PCT                    PIC S9(09)V9999 VALUE +0    01816000
018170                                                     COMP-3.      01817000
018180     05  PV-SELL-THRU-PCT             PIC S9(09)V9999 VALUE +0    01818000
018190                                                     COMP-3.      01819000
018191     05  PV-RPT-LINE                  PIC X(200) VALUE SPACES.    01819100
018192     05  PV-SAVE-RECORD               PIC X(750) VALUE SPACES.    01819228
018193     05  PV-SAVE-RECORD-2             PIC X(750) VALUE SPACES.    01819346
018194     05  PV-PROMO-STRT-TMST.                                      01819400
018195         10  PV-PROMO-STRT-DTE.                                   01819500
018196             15  PV-PM-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    01819600
018197             15  PV-PM-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    01819700
018198             15  FILLER               PIC X(01)  VALUE SPACES.    01819800
018199             15  PV-PM-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    01819900
018200             15  FILLER               PIC X(01)  VALUE SPACES.    01820000
018201             15  PV-PM-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    01820100
018202         10  FILLER                   PIC X(01)  VALUE SPACES.    01820200
018210         10  PV-PROMO-STRT-TM.                                    01821000
018220             15  PV-PM-STRT-TM-HH     PIC X(02)  VALUE SPACES.    01822000
018230             15  FILLER               PIC X(01)  VALUE SPACES.    01823000
018240             15  PV-PM-STRT-TM-MM     PIC X(02)  VALUE SPACES.    01824000
018250             15  FILLER               PIC X(01)  VALUE SPACES.    01825000
018260             15  PV-PM-STRT-TM-SS     PIC X(02)  VALUE SPACES.    01826000
018270                                                                  01827000
018280     05  PV-PROMO-END-TMST.                                       01828000
018290         10  PV-PROMO-END-DTE.                                    01829000
018300             15  PV-PM-END-DTE-CC     PIC X(02)  VALUE SPACES.    01830000
018400             15  PV-PM-END-DTE-YY     PIC X(02)  VALUE SPACES.    01840000
018500             15  FILLER               PIC X(01)  VALUE SPACES.    01850000
018600             15  PV-PM-END-DTE-MM     PIC X(02)  VALUE SPACES.    01860000
018700             15  FILLER               PIC X(01)  VALUE SPACES.    01870000
018800             15  PV-PM-END-DTE-DD     PIC X(02)  VALUE SPACES.    01880000
018900         10  FILLER                   PIC X(01)  VALUE SPACES.    01890000
019000         10  PV-PROMO-END-TM.                                     01900000
019100             15  PV-PM-END-TM-HH      PIC X(02)  VALUE SPACES.    01910000
019200             15  FILLER               PIC X(01)  VALUE SPACES.    01920000
019300             15  PV-PM-END-TM-MM      PIC X(02)  VALUE SPACES.    01930000
019400             15  FILLER               PIC X(01)  VALUE SPACES.    01940000
019500             15  PV-PM-END-TM-SS      PIC X(02)  VALUE SPACES.    01950000
019600                                                                  01960000
019700     05  PV-PROMO-ITM-STRT-TMST.                                  01970000
019800         10  PV-PROMO-ITM-STRT-DTE.                               01980000
019900             15  PV-PI-STRT-DTE-CC    PIC X(02)  VALUE SPACES.    01990000
020000             15  PV-PI-STRT-DTE-YY    PIC X(02)  VALUE SPACES.    02000000
020100             15  FILLER               PIC X(01)  VALUE SPACES.    02010000
020200             15  PV-PI-STRT-DTE-MM    PIC X(02)  VALUE SPACES.    02020000
020300             15  FILLER               PIC X(01)  VALUE SPACES.    02030000
020400             15  PV-PI-STRT-DTE-DD    PIC X(02)  VALUE SPACES.    02040000
020500         10  FILLER                   PIC X(01)  VALUE SPACES.    02050000
020600         10  PV-PROMO-ITM-STRT-TM.                                02060000
020700             15  PV-PI-STRT-TM-HH     PIC X(02)  VALUE SPACES.    02070000
020800             15  FILLER               PIC X(01)  VALUE SPACES.    02080000
020900             15  PV-PI-STRT-TM-MM     PIC X(02)  VALUE SPACES.    02090000
021000             15  FILLER               PIC X(01)  VALUE SPACES.    02100000
021100             15  PV-PI-STRT-TM-SS     PIC X(02)  VALUE SPACES.    02110000
021200                                                                  02120000
021300     05  PV-PROMO-ITM-END-TMST.                                   02130000
021400         10  PV-PROMO-ITM-END-DTE.                                02140000
021500             15  PV-PI-END-DTE-CC     PIC X(02)  VALUE SPACES.    02150000
021600             15  PV-PI-END-DTE-YY     PIC X(02)  VALUE SPACES.    02160000
021700             15  FILLER               PIC X(01)  VALUE SPACES.    02170000
021800             15  PV-PI-END-DTE-MM     PIC X(02)  VALUE SPACES.    02180000
021900             15  FILLER               PIC X(01)  VALUE SPACES.    02190000
022000             15  PV-PI-END-DTE-DD     PIC X(02)  VALUE SPACES.    02200000
022010         10  FILLER                   PIC X(01)  VALUE SPACES.    02201000
022020         10  PV-PROMO-ITM-END-TM.                                 02202000
022030             15  PV-PI-END-TM-HH      PIC X(02)  VALUE SPACES.    02203000
022040             15  FILLER               PIC X(01)  VALUE SPACES.    02204000
022050             15  PV-PI-END-TM-MM      PIC X(02)  VALUE SPACES.    02205000
022060             15  FILLER               PIC X(01)  VALUE SPACES.    02206000
022070             15  PV-PI-END-TM-SS      PIC X(02)  VALUE SPACES.    02207000
022080                                                                  02208000
022090     05  PV-PM-ITM-EFF-STRT-DTE.                                  02209000
022091         10  PV-EFF-STRT-DTE-MM       PIC X(02)  VALUE SPACES.    02209100
022092         10  FILLER                   PIC X(01)  VALUE '/'.       02209200
022093         10  PV-EFF-STRT-DTE-DD       PIC X(02)  VALUE SPACES.    02209300
022094         10  FILLER                   PIC X(01)  VALUE '/'.       02209400
022095         10  PV-EFF-STRT-DTE-YY       PIC X(02)  VALUE SPACES.    02209500
022096                                                                  02209600
022097     05  PV-PM-ITM-EFF-END-DTE.                                   02209700
022098         10  PV-EFF-END-DTE-MM        PIC X(02)  VALUE SPACES.    02209800
022099         10  FILLER                   PIC X(01)  VALUE '/'.       02209900
022100         10  PV-EFF-END-DTE-DD        PIC X(02)  VALUE SPACES.    02210000
022101         10  FILLER                   PIC X(01)  VALUE '/'.       02210100
022102         10  PV-EFF-END-DTE-YY        PIC X(02)  VALUE SPACES.    02210200
022103                                                                  02210300
022104     05  PV-EFF-DTE-LAYOUT.                                       02210400
022105         10  FILLER                   PIC X(02)  VALUE SPACES.    02210500
022106         10  PV-OPEN-PARENTH          PIC X(01)  VALUE SPACES.    02210600
022107         10  PV-EFF-STRT-DTE          PIC X(08)  VALUE SPACES.    02210700
022108         10  PV-DTE-DASH              PIC X(01)  VALUE SPACES.    02210800
022109         10  PV-EFF-END-DTE           PIC X(08)  VALUE SPACES.    02210900
022110         10  PV-CLOSE-PARENTH         PIC X(01)  VALUE SPACES.    02211000
022111                                                                  02211100
022122     05  PV-VARIABLE-OUTPUT-FIELD.                                02212200
022123         10  PV-BIT-VARIABLE          PIC X(01)  VALUE SPACES     02212300
022124                                       OCCURS 41 TIMES            02212400
022125                                       INDEXED BY                 02212500
022126                                       PV-BIT-IDX.                02212600
022127                                                                  02212700
022128     05  PV-HEADER-DTE-TM.                                        02212800
022129         10  PV-BEG-DAY-ALPHA         PIC X(10).                  02212900
022130         10  PV-BEG-DATE              PIC X(08).                  02213000
022131         10  FILLER                   PIC X(02)  VALUE SPACES.    02213100
022132         10  PV-BEG-TIME.                                         02213200
022133             15  PV-BEG-HR-TIME       PIC 9(02).                  02213300
022134             15  PV-BEG-TIME-COLON    PIC X(01).                  02213400
022135             15  PV-BEG-MIN-TIME      PIC 9(02).                  02213500
022136             15  FILLER               PIC X(02)  VALUE SPACES.    02213600
022137         10  FILLER                   PIC X(11)  VALUE            02213700
022138                                      '   THROUGH '.              02213800
022139         10  PV-END-DAY-ALPHA         PIC X(10).                  02213900
022140         10  PV-END-DATE              PIC X(08).                  02214000
022141         10  FILLER                   PIC X(02)  VALUE SPACES.    02214100
022142         10  PV-END-TIME.                                         02214200
022143             15  PV-END-HR-TIME       PIC 9(02).                  02214300
022144             15  PV-END-TIME-COLON    PIC X(01).                  02214400
022145             15  PV-END-MIN-TIME      PIC 9(02).                  02214500
022146             15  FILLER               PIC X(02).                  02214600
022147         10  FILLER                   PIC X(22)  VALUE SPACES.    02214700
022148                                                                  02214800
022149*----------------------------------------------------------       02214900
022150* PA- PROGRAM ACCUMULATORS                                        02215000
022151*----------------------------------------------------------       02215100
022152 01  PA-PROGRAM-ACCUMULATORS.                                     02215200
022153     05  PA-CNT-ADV-TOT               PIC 9(09)  VALUE ZEROES.    02215300
022154     05  PA-CNT-UNADV-TOT             PIC 9(09)  VALUE ZEROES.    02215400
022156     05  PA-CNT-SPACES-1              PIC 9(09)  VALUE ZEROES.    02215600
022157     05  PA-CNT-POS-1                 PIC 9(09)  VALUE ZEROES.    02215700
022158     05  PA-CNT-SPACES-2              PIC 9(09)  VALUE ZEROES.    02215800
022159     05  PA-CNT-SPACES                PIC 9(09)  VALUE ZEROES.    02215900
022160     05  PA-CNT-POS-2                 PIC 9(09)  VALUE ZEROES.    02216000
022161     05  PA-CNT-GMA                   PIC S9(04) VALUE +0.        02216102
022162     05  PA-HOLD-INDEX                PIC S9(04) VALUE +0.        02216207
022163     05  PA-CNT-NEW-INDX              PIC S9(04) VALUE +0.        02216307
022170                                                                  02217000
022180*----------------------------------------------------------       02218000
022190* TBL- TABLE VARIABLES                                            02219000
022200*----------------------------------------------------------       02220000
022300* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02230000
022400*    OCCURRENCE CONTAINS FORECAST FIGURES                         02240000
022500 01  TBL-SECT-TOTAL-TABLE.                                        02250000
022600     05  TBL-STOT-LINE-01 OCCURS 02 TIMES                         02260000
022700                           INDEXED BY TBL-STOT-INDX.              02270000
022800         10  TBL-STOT-TOT-SALE-AMT    PIC S9(09)V9(02) COMP-3.    02280000
022900         10  TBL-STOT-TOT-MD-AMT      PIC S9(09)V9(02) COMP-3.    02290000
023000         10  TBL-STOT-TOT-SLS-UNT-QTY                             02300000
023100                                      PIC S9(09)V9(02) COMP-3.    02310000
023200         10  TBL-STOT-TOT-EOH-INV-QTY                             02320000
023300                                      PIC S9(09)V9(02) COMP-3.    02330000
023400         10  TBL-STOT-PREP-UNT-QTY    PIC S9(09)V9(02) COMP-3.    02340000
023500         10  TBL-STOT-TOT-SLS-COST-AMT                            02350000
023600                                      PIC S9(09)V9(02) COMP-3.    02360000
023700                                                                  02370000
023800* NOTE: THE FIRST OCCURRENCE CONTAINS ACTUAL FIGURES, THE SECOND  02380000
023900*    OCCURRENCE CONTAINS FORECAST FIGURES                         02390000
024000 01  TBL-PROMO-TOTAL-TABLE.                                       02400000
024100     05  TBL-PMTOT-LINE-01 OCCURS 02 TIMES                        02410000
024200                          INDEXED BY TBL-PMTOT-INDX.              02420000
024300         10  TBL-PMTOT-TOT-SALE-AMT   PIC S9(09)V9(02) COMP-3.    02430000
024400         10  TBL-PMTOT-TOT-MD-AMT     PIC S9(09)V9(02) COMP-3.    02440000
024500         10  TBL-PMTOT-TOT-SLS-UNT-QTY                            02450000
024600                                      PIC S9(09)V9(02) COMP-3.    02460000
024700         10  TBL-PMTOT-TOT-EOH-INV-QTY                            02470000
024800                                      PIC S9(09)V9(02) COMP-3.    02480000
024900         10  TBL-PMTOT-PREP-UNT-QTY   PIC S9(09)V9(02) COMP-3.    02490000
025000         10  TBL-PMTOT-TOT-SLS-COST-AMT                           02500000
025100                                      PIC S9(09)V9(02) COMP-3.    02510000
025200                                                                  02520000
025210 01  TBL-GMA-TOTAL-TABLE.                                         02521002
025220     05  TBL-GTOT-LINE-01 OCCURS 2000 TIMES                       02522012
025231                          INDEXED BY TBL-GTOT-INDEX.              02523102
025232         10  TBL-GTOT-GMA-NBR        PIC 9(04).                   02523202
025233         10  TBL-GTOT-GMA-LAST-NM    PIC X(40).                   02523302
025240         10  TBL-GTOT-ACT-SALE-AMT   PIC S9(09)V9(02) COMP-3.     02524002
025241         10  TBL-GTOT-FCST-SALE-AMT  PIC S9(09)V9(02) COMP-3.     02524102
025250         10  TBL-GTOT-ACT-MD-AMT     PIC S9(09)V9(02) COMP-3.     02525002
025251         10  TBL-GTOT-FCST-MD-AMT    PIC S9(09)V9(02) COMP-3.     02525102
025260         10  TBL-GTOT-ACT-SLS-UNT-QTY                             02526002
025270                                      PIC S9(09)V9(02) COMP-3.    02527002
025271         10  TBL-GTOT-FCST-SLS-UNT-QTY                            02527102
025272                                      PIC S9(09)V9(02) COMP-3.    02527202
025280         10  TBL-GTOT-TOT-EOH-INV-QTY                             02528002
025290                                      PIC S9(09)V9(02) COMP-3.    02529002
025291         10  TBL-GTOT-ACT-PREP-QTY    PIC S9(09)V9(02) COMP-3.    02529102
025292         10  TBL-GTOT-FCST-PREP-QTY   PIC S9(09)V9(02) COMP-3.    02529202
025293         10  TBL-GTOT-ACT-SLS-COST-AMT                            02529302
025294                                      PIC S9(09)V9(02) COMP-3.    02529402
025295         10  TBL-GTOT-FCST-SLS-COST-AMT                           02529502
025296                                      PIC S9(09)V9(02) COMP-3.    02529602
025297                                                                  02529702
025300*----------------------------------------------------------       02530000
025400* ABEND- ABEND VARIABLES                                          02540000
025500*----------------------------------------------------------       02550000
025600 01  ABEND-CODE                       PIC S9(04) VALUE +0 COMP.   02560000
025700     88  ABEND-4001-WRITE-ERROR                  VALUE +4001.     02570000
025800     88  ABEND-4002-READ-ERROR                   VALUE +4002.     02580000
025900     88  ABEND-4003-CTRL-CARD-ERROR              VALUE +4003.     02590000
026000     88  ABEND-4004-TABLE-ERROR                  VALUE +4004.     02600000
026100     88  ABEND-4005-OPEN-ERROR                   VALUE +4005.     02610000
026200     88  ABEND-4006-CLOSE-ERROR                  VALUE +4006.     02620000
026300     88  ABEND-4007-SEQUENCE-ERROR               VALUE +4007.     02630000
026400     88  ABEND-4008-DATA-ERROR                   VALUE +4008.     02640000
026500     88  ABEND-4009-KEY-DATA-ERROR               VALUE +4009.     02650000
026800     88  ABEND-4013-DB2-ERROR                    VALUE +4013.     02680000
026900     88  ABEND-4019-DATE-ROUTINE-ERROR           VALUE +4019.     02690000
027000     88  ABEND-4444-FORCED-ABEND                 VALUE +4444.     02700000
027100                                                                  02710000
027200 01  END-OF-REPORT-LINE.                                          02720000
027300     05  FILLER                       PIC X(25)  VALUE            02730000
027400         ' ** END OF REPORT **     '.                             02740000
027500                                                                  02750000
027600*----------------------------------------------------------       02760000
027700* HD- HEADER INFO                                                 02770000
027800*----------------------------------------------------------       02780000
027900 01  HEADER-01.                                                   02790000
028000     05  FILLER                       PIC X(63) VALUE SPACES.     02800020
028100     05  FILLER                       PIC X(41) VALUE             02810003
028200         'PROMOTION SUMMARY - BY GMM, BY AD PAGE - '.             02820003
028300     05  HDR-01-TITLE                 PIC X(43)  VALUE SPACES.    02830000
028400     05  FILLER                       PIC X(53) VALUE SPACES.     02840020
028500                                                                  02850000
028600 01  HEADER-02.                                                   02860000
028700     05  FILLER                       PIC X(12)  VALUE            02870054
028800                                      ' AD EVENT : '.             02880054
028900     05  HDR-02-ADEVNT-STRING         PIC X(188) VALUE SPACES.    02890054
029000                                                                  02900000
029100 01  HEADER-03.                                                   02910000
029200     05  FILLER                       PIC X(12)  VALUE            02920000
029300                                      ' PROMOTION: '.             02930000
029400     05  HDR-03-PROMO-STRING          PIC X(188) VALUE SPACES.    02940000
029500                                                                  02950000
029600 01  HEADER-04.                                                   02960000
029700     05  FILLER                       PIC X(45)  VALUE            02970000
029800         '  AD                                         '.         02980019
029900     05  FILLER                       PIC X(45)  VALUE            02990000
030000         '                    SALES VOLUME         VOL '.         03000037
030100     05  FILLER                       PIC X(45)  VALUE            03010037
030200         '%             MARKDOWN $                UNITS'.         03020037
030300     05  FILLER                       PIC X(45)  VALUE            03030000
030400         ' SOLD        SELL              PREP UNITS    '.         03040037
030500     05  FILLER                       PIC X(20)  VALUE            03050037
030600         '        MARKUP %    '.                                  03060037
030700                                                                  03070000
030800 01  HEADER-05.                                                   03080000
030900     05  FILLER                       PIC X(45)  VALUE            03090000
031000         ' PAGE    GMM LAST NAME                       '.         03100019
031100     05  FILLER                       PIC X(45)  VALUE            03110000
031200         '                  ACT         FCST       CHG '.         03120039
031210     05  FILLER                       PIC X(45)  VALUE            03121000
031220         '           ACT         FCST          ACT     '.         03122039
031230     05  FILLER                       PIC X(45)  VALUE            03123000
031240         '    FCST    THRU %          ACT         FCST '.         03124039
031250     05  FILLER                       PIC X(20)  VALUE            03125000
031260         '     ACT      FCST  '.                                  03126045
031270                                                                  03127000
031280                                                                  03128000
031290*----------------------------------------------------------       03129000
031300* DTL- DETAIL INFO                                                03130000
031400*----------------------------------------------------------       03140000
031500 01  DETAIL-HEADER-01.                                            03150000
031800     05  FILLER                       PIC X(01)  VALUE SPACES.    03180014
031900     05  FILLER                       PIC X(06)  VALUE 'GMM - '.  03190006
032100     05  DTL-HDR-01-GMM-NAME          PIC X(40)  VALUE SPACES.    03210004
032200     05  FILLER                       PIC X(153) VALUE SPACES.    03220004
033000                                                                  03300000
033100 01  DETAIL-HEADER-02.                                            03310006
033200     05  FILLER                       PIC  X(50)     VALUE        03320006
033300         '--------------------------------------------------'.    03330006
033400     05  FILLER                       PIC  X(50)     VALUE        03340006
033500         '--------------------------------------------------'.    03350006
033600     05  FILLER                       PIC  X(50)     VALUE        03360006
033610         '--------------------------------------------------'.    03361006
033611     05  FILLER                       PIC  X(50)     VALUE        03361106
033612         '--------------------------------------------------'.    03361206
033620                                                                  03362006
033700 01  DETAIL-VARIABLE.                                             03370000
033800     05  FILLER                       PIC X(01)  VALUE SPACES.    03380000
033900     05  DTL-VAR-VOL-PCT-CHG          PIC ZZZ9.9.                 03390054
033910     05  DTL-VAR-VOL-PCT-CHG1 REDEFINES                           03391054
033920         DTL-VAR-VOL-PCT-CHG          PIC ZZZZ.Z.                 03392054
034000     05  FILLER                       PIC X(01)  VALUE SPACES.    03400000
034100                                                                  03410000
034200 01  DETAIL-01.                                                   03420000
034300     05  FILLER                       PIC X(01)  VALUE SPACES.    03430000
034400     05  DTL-01-AD-PG-NBR.                                        03440000
034401         10  DTL-01-PM-AD-PG-NBR      PIC ZZZ.                    03440100
034402         10  FILLER                   PIC X(05).                  03440207
034403         10  DTL-01-GMA-LAST-NM       PIC X(43).                  03440306
PGNBR      05  DTL-01-ADV-NOPGE REDEFINES                               03440456
PGNBR          DTL-01-AD-PG-NBR.                                        03440556
PGNBR          10  DTL-01-NOPG-TITLE        PIC X(04).                  03440656
PGNBR          10  FILLER                   PIC X(04).                  03440756
PGNBR          10  DTL-01-ADV-GMA-LAST-NM   PIC X(43).                  03440856
034410     05  DTL-01-NEW-TITLE REDEFINES                               03441004
034420         DTL-01-AD-PG-NBR.                                        03442000
034430         10  DTL-01-UNAD-TITLE        PIC X(04).                  03443007
034440         10  FILLER                   PIC X(04).                  03444007
034450         10  DTL-01-TTL-GMA-LAST-NM   PIC X(43).                  03445007
034520     05  FILLER                       PIC X(04)  VALUE SPACES.    03452038
034600     05  DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZ9.99.             03460054
034610     05  DTL-01-ACTL-SLS-RTL-AMT1 REDEFINES                       03461054
034620         DTL-01-ACTL-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03462054
034700     05  FILLER                       PIC X(03)  VALUE SPACES.    03470038
034800     05  DTL-01-FCST-SLS-RTL-AMT      PIC ZZZ,ZZZ.ZZ.             03480038
034900     05  FILLER                       PIC X(03)  VALUE SPACES.    03490034
034920     05  DTL-01-VOL-PCT-CHG           PIC X(08)  VALUE SPACES.    03492034
034930     05  DTL-01-VOL-PCT-SIGN          PIC X(01)  VALUE SPACES.    03493000
034931     05  FILLER                       PIC X(03)  VALUE SPACES.    03493138
034932     05  DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZ9.99.             03493254
034933     05  DTL-01-ACTL-MD-AMT1 REDEFINES                            03493354
034934         DTL-01-ACTL-MD-AMT           PIC ZZZ,ZZZ.ZZ.             03493454
034935     05  FILLER                       PIC X(03)  VALUE SPACES.    03493538
034936     05  DTL-01-FCST-MD-AMT           PIC ZZZ,ZZZ.ZZ.             03493638
034940     05  FILLER                       PIC X(03)  VALUE SPACES.    03494038
035000     05  DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZ9.99.             03500054
035010     05  DTL-01-ACTL-UNT-SLD-QTY1 REDEFINES                       03501054
035020         DTL-01-ACTL-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03502054
035100     05  FILLER                       PIC X(03)  VALUE SPACES.    03510038
035200     05  DTL-01-FCST-UNT-SLD-QTY      PIC ZZZ,ZZZ.ZZ.             03520038
035201     05  FILLER                       PIC X(04)  VALUE SPACES.    03520100
035210     05  DTL-01-SELL-THRU-PCT         PIC ZZ9.9.                  03521054
035211     05  DTL-01-SELL-THRU-PCT1 REDEFINES                          03521154
035212         DTL-01-SELL-THRU-PCT         PIC ZZZ.Z.                  03521254
035220     05  DTL-O1-SELL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03522000
035300     05  FILLER                       PIC X(03)  VALUE SPACES.    03530038
035400     05  DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZ9.99.             03540054
035410     05  DTL-01-ACTL-PREP-UNT-QTY1 REDEFINES                      03541054
035420         DTL-01-ACTL-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03542054
035500     05  FILLER                       PIC X(03)  VALUE SPACES.    03550038
035600     05  DTL-01-FCST-PREP-UNT-QTY     PIC ZZZ,ZZZ.ZZ.             03560038
036000     05  FILLER                       PIC X(04)  VALUE SPACES.    03600000
036100     05  DTL-01-ACTL-MU-PCT           PIC ZZ9.9.                  03610054
036110     05  DTL-01-ACTL-MU-PCT1 REDEFINES                            03611054
036120         DTL-01-ACTL-MU-PCT           PIC ZZZ.Z.                  03612054
036200     05  DTL-01-ACTL-PCT-SIGN         PIC X(01)  VALUE SPACES.    03620000
036300     05  FILLER                       PIC X(04)  VALUE SPACES.    03630000
036400     05  DTL-01-FCST-MU-PCT           PIC ZZ9.9.                  03640054
036410     05  DTL-01-FCST-MU-PCT1 REDEFINES                            03641054
036420         DTL-01-FCST-MU-PCT           PIC ZZZ.Z.                  03642054
036500     05  DTL-01-FCST-PCT-SIGN         PIC X(01)  VALUE SPACES.    03650000
036600     05  FILLER                       PIC X(01)  VALUE SPACES.    03660037
038052                                                                  03805200
038121*----------------------------------------------------------       03812100
038122* COPYBOOK FOR THE PROMO ITEM SUMMARY EXTRACT - INPUT             03812200
038123*----------------------------------------------------------       03812300
038124     COPY PMRD100.                                                03812400
038125                                                                  03812500
038126*----------------------------------------------------------       03812600
038127*  DATE VALIDATION CALLING PARAMETER LIST                         03812700
038128*----------------------------------------------------------       03812800
038129     COPY DPWS500.                                                03812900
038130                                                                  03813000
038131*----------------------------------------------------------       03813100
038132*  STANDARD HEADER LINE - KOHLS 200 COL                           03813201
038133*----------------------------------------------------------       03813300
038134     COPY DPWS200O.                                               03813400
038135     EJECT                                                        03813500
038136                                                                  03813600
038137*----------------------------------------------------------       03813700
038138 PROCEDURE DIVISION.                                              03813800
038139*----------------------------------------------------------       03813900
038140 0000-MAINLINE.                                                   03814000
038141                                                                  03814100
038142     PERFORM 1000-INITIALIZATION.                                 03814200
038143                                                                  03814300
038144     PERFORM 2000-PROCESS-GMA-SLS-RSLTS                           03814402
038145             UNTIL PS-EOF-SLS-GMA-RSLTS.                          03814502
038146                                                                  03814600
038147     PERFORM 3000-END-OF-JOB-ROUTINE.                             03814700
038148                                                                  03814800
038149     GOBACK.                                                      03814900
038150                                                                  03815000
038200*0000-EXIT.                                                       03820000
038300 EJECT.                                                           03830000
038400                                                                  03840000
038500*----------------------------------------------------------       03850000
038600* 1000-INITIALIZATION.                                            03860000
038700*     INITIALIZATION AREA - INITIALIZES ALL VARIABLES, OPENS      03870000
038800*     FILES, READS INPUT FILES, AND PROCESSES ANY INPUT FILE      03880000
038900*     PARAMETERS IT MAY NEED TO USE TO READ AND PROCESS           03890000
039000*     ANY OF THE RECORDS FROM THE INPUT FILE.                     03900000
039100*----------------------------------------------------------       03910000
039200 1000-INITIALIZATION.                                             03920000
039300                                                                  03930000
039400     INITIALIZE PM100-PROMO-ITM-SUMM                              03940000
039500                TBL-SECT-TOTAL-TABLE                              03950000
039600                TBL-PROMO-TOTAL-TABLE                             03960002
039610                TBL-GMA-TOTAL-TABLE                               03961012
039620                PA-CNT-GMA.                                       03962003
039700                                                                  03970000
039710     SET PS-FIRST-TIME TO TRUE.                                   03971006
039711     SET PS-FIRST-TIME-DMM TO TRUE.                               03971106
039712     SET PS-FIRST-DMA-READ TO TRUE.                               03971246
039720                                                                  03972006
039800     OPEN INPUT PROMO-SUMM-GMA-FILE                               03980002
039810                PROMO-SUMM-DMA-FILE                               03981002
039900         OUTPUT PROMO-SUMM-REPORT.                                03990000
040000                                                                  04000000
040100     ACCEPT CD-CPU-DATE FROM DATE.                                04010000
040200     MOVE CD-CPU-YR                  TO CD-CPU-YY.                04020000
040300     MOVE CD-CPU-MO                  TO CD-CPU-MM.                04030000
040400     MOVE CD-CPU-DY                  TO CD-CPU-DD.                04040000
040500                                                                  04050000
040600     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04060000
040700     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     04070000
040710     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     04071000
040720     SET DPG52-LK-DTE-GREG           TO TRUE.                     04072000
040721     MOVE CD-CPU-DATE-GREG           TO DPG52-LK-DATE-INPUT.      04072100
040722     MOVE 'INVALID CONVERT OF CURRENT DATE FROM CPU'              04072200
040723                                     TO PV-OPERATION-MSG-1.       04072300
040724                                                                  04072400
040725     PERFORM 9100-CALENDAR-ROUTINE.                               04072500
040726                                                                  04072600
040727     MOVE DPG55-DB2-ISO-DATE-FMT     TO CD-CPU-DATE-ISO.          04072700
040728                                                                  04072800
040729     ACCEPT CT-CPU-TIME FROM TIME.                                04072900
040730     MOVE CT-CPU-HR                  TO DP200O-RUN-HOUR.          04073000
040740     MOVE CT-CPU-MIN                 TO DP200O-RUN-MINUTE.        04074000
040750     MOVE CD-CPU-MO                  TO DP200O-RUN-MONTH.         04075000
040760     MOVE CD-CPU-DY                  TO DP200O-RUN-DAY.           04076000
040770     MOVE CD-CPU-YR                  TO DP200O-RUN-YEAR.          04077000
040780     MOVE PC-CURRENT-PROGRAM-NAME    TO DP200O-PROGRAM-NAME.      04078000
040781                                                                  04078131
040800     PERFORM 8000-READ-SLS-GMA-RESULTS.                           04080002
040900                                                                  04090000
041000     IF PS-EOF-SLS-GMA-RSLTS                                      04100008
041100        DISPLAY 'NO PROMOTIONS TO REPORT ON'                      04110001
041200     ELSE                                                         04120000
041500        EVALUATE TRUE                                             04150000
041600          WHEN PM100-ACTUAL                                       04160000
041700               MOVE PC-ACTUAL-RSLT    TO HDR-01-TITLE             04170003
041800          WHEN PM100-FORECAST                                     04180000
041900               MOVE PC-FORECAST-RSLT  TO HDR-01-TITLE             04190003
042000          WHEN OTHER                                              04200000
042100               DISPLAY 'PM100-FCST-ACTUAL-IND: '                  04210000
042200                              PM100-FCST-ACTUAL-IND               04220000
042300               SET ABEND-4444-FORCED-ABEND TO TRUE                04230000
042400               MOVE '1000-INITIALIZATION' TO PV-PARAGRAPH-NAME    04240000
042500               MOVE 'NOT A VALID FORECAST/ACTUAL IND'             04250000
042600                                       TO PV-OPERATION-MSG-1      04260000
042700               PERFORM 9800-ABEND                                 04270000
042800        END-EVALUATE                                              04280000
042900     END-IF.                                                      04290000
043000                                                                  04300000
043100*1000-EXIT.                                                       04310000
043200 EJECT.                                                           04320000
043300                                                                  04330000
043400*----------------------------------------------------------       04340000
043500* 2000-PROCESS-GMA-SLS-RSLTS.                                     04350002
043600*     PROCESSES THE SALES RESULTS FILE AND CREATES A              04360000
043700*     A REPORT. THIS REPORT BREAKS BY AD EVENT/PROMOTION.         04370000
043800*     THE SECOND PAGE OF EACH PROMOTION WILL ALWAYS USE           04380050
043900*     THE SECOND INPUT FILE FOR ITS INFORMATION.                  04390050
044300*----------------------------------------------------------       04430000
044400 2000-PROCESS-GMA-SLS-RSLTS.                                      04440002
044500                                                                  04450000
044600     EVALUATE TRUE                                                04460000
044700       WHEN (PM100-AD-EVNT-ID IS NOT = PV-LAST-ADEVNT-ID)         04470000
044800         OR (PM100-PROMO-ID IS NOT = PV-LAST-PROMO-ID)            04480000
044900            IF PS-NOT-FIRST-TIME                                  04490000
045000               PERFORM 3300-PROCESS-UNAD-TTL                      04500006
045100               PERFORM 3500-PROCESS-PAGE-HEADER                   04510006
045200               PERFORM 3310-PROCESS-GMA-TTLS                      04520006
045300               PERFORM 3320-PROCESS-PROMO-TTL                     04530006
045301               MOVE SPACES        TO PV-SAVE-RECORD               04530128
045302               MOVE PM100-PROMO-ITM-SUMM TO PV-SAVE-RECORD        04530228
045303               IF PS-FIRST-DMA-READ                               04530346
045310                  PERFORM 8100-READ-SLS-DMA-RESULTS               04531046
045311                  SET PS-NOT-FIRST-DMA-READ TO TRUE               04531146
045312               ELSE                                               04531246
045313                  MOVE PV-SAVE-RECORD-2 TO PM100-PROMO-ITM-SUMM   04531346
045314               END-IF                                             04531446
045320               SET PS-DMA-RESULTS TO TRUE                         04532006
045330               IF PM100-AD-EVNT-ID = PV-SAVE-AD-EVNT-ID           04533025
045340                  AND PM100-PROMO-ID = PV-SAVE-PROMO-ID           04534026
045350                  AND PS-NOT-EOF-SLS-DMA-RSLTS                    04535025
045400                  PERFORM 3100-PROCESS-DMA-SLS-RSTLS              04540025
045410                          UNTIL PM100-AD-EVNT-ID NOT =            04541025
045420                                       PV-SAVE-AD-EVNT-ID         04542025
045500                             OR PM100-PROMO-ID NOT =              04550026
045510                                       PV-SAVE-PROMO-ID           04551026
045600                             OR PS-EOF-SLS-DMA-RSLTS              04560025
045700                  PERFORM 3320-PROCESS-PROMO-TTL                  04570025
045800               END-IF                                             04580025
045900               MOVE PV-SAVE-RECORD TO PM100-PROMO-ITM-SUMM        04590028
046720               INITIALIZE TBL-SECT-TOTAL-TABLE                    04672000
046730                          TBL-PROMO-TOTAL-TABLE                   04673000
046740                          TBL-GMA-TOTAL-TABLE                     04674010
046742                          PA-CNT-GMA                              04674203
046743                          PV-LAST-GMA-NBR                         04674315
046744                          PV-LAST-DMA-NBR                         04674415
046745               SET PS-FIRST-TIME-DMM TO TRUE                      04674518
046750            END-IF                                                04675000
046751            SET PS-GMA-RESULTS TO TRUE                            04675106
046760            PERFORM 2200-FORMAT-HEADING-FIELDS                    04676006
046770            PERFORM 2100-ADEVNT-PROMO-HDR-BREAK                   04677006
046780            PERFORM 2300-CREATE-HEADING-FIELDS                    04678006
046790            PERFORM 3500-PROCESS-PAGE-HEADER                      04679007
046792            MOVE PM100-AD-EVNT-ID TO PV-LAST-ADEVNT-ID            04679200
046793                                     PV-SAVE-AD-EVNT-ID           04679325
046794            MOVE PM100-PROMO-ID   TO PV-LAST-PROMO-ID             04679400
046795                                     PV-SAVE-PROMO-ID             04679503
046796            SET PS-NOT-FIRST-TIME TO TRUE                         04679600
049020     END-EVALUATE.                                                04902000
049030     PERFORM 3200-PROCESS-DETAIL.                                 04903006
049040                                                                  04904000
049050     PERFORM 8000-READ-SLS-GMA-RESULTS.                           04905002
049060                                                                  04906000
049070*2000-EXIT.                                                       04907000
049080 EJECT.                                                           04908000
049090                                                                  04909000
051010*----------------------------------------------------------       05101000
051100* 2100-ADEVNT-PROMO-HDR-BREAK.                                    05110006
051200*     WHEN AN ADEVENT ID/PROMO ID CHANGE, GIVE THE NEW            05120000
051300*     START/END DATES.                                            05130000
051400*----------------------------------------------------------       05140000
051500 2100-ADEVNT-PROMO-HDR-BREAK.                                     05150006
051600                                                                  05160000
051700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05170000
051800     SET DPG51-ACTUAL-CALENDAR-ONLY      TO TRUE.                 05180000
051900     SET DPG51-DO-NOT-INCR-DECR-DATE     TO TRUE.                 05190000
052000     SET DPG52-LK-DTE-ISO-FMT            TO TRUE.                 05200000
052100     MOVE PM100-PROMO-STRT-TMST          TO PV-PROMO-STRT-TMST.   05210000
052200     MOVE PM100-PROMO-END-TMST           TO PV-PROMO-END-TMST.    05220000
052300     MOVE PV-PROMO-STRT-DTE              TO DPG52-LK-DATE-INPUT.  05230000
052400     MOVE 'INVALID PROMO BEGINNING DATE' TO PV-OPERATION-MSG-1.   05240000
052500                                                                  05250000
052600     PERFORM 9100-CALENDAR-ROUTINE.                               05260000
052700                                                                  05270000
052800     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-BEG-DAY-ALPHA.              05280000
052900     MOVE DPG55-GREG-DATE-FMT   TO PV-BEG-DATE.                   05290000
053000                                                                  05300000
053100     IF (PV-PM-STRT-TM-HH =                                       05310000
053110         PC-DEFAULT-BEG-HR AND                                    05311000
053111         PV-PM-STRT-TM-MM =                                       05311100
053112         PC-DEFAULT-BEG-MIN)                                      05311200
053113         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  05311300
053114* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05311400
053115            MOVE SPACES         TO PV-BEG-TIME                    05311500
053116            MOVE PV-PM-STRT-TM-HH                                 05311600
053117                                TO PV-BEG-HR-TIME                 05311700
053118            MOVE PC-COLON       TO PV-BEG-TIME-COLON              05311800
053119            MOVE PV-PM-STRT-TM-MM                                 05311900
053120                                TO PV-BEG-MIN-TIME                05312000
053130         ELSE                                                     05313000
053140            MOVE PC-ALL-DAY     TO PV-BEG-TIME                    05314000
053150         END-IF                                                   05315000
053160     ELSE                                                         05316000
053170* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05317000
053180        MOVE SPACES             TO PV-BEG-TIME                    05318000
053190        MOVE PV-PM-STRT-TM-HH                                     05319000
053200                                TO PV-BEG-HR-TIME                 05320000
053300        MOVE PC-COLON           TO PV-BEG-TIME-COLON              05330000
053400        MOVE PV-PM-STRT-TM-MM                                     05340000
053500                                TO PV-BEG-MIN-TIME                05350000
053600     END-IF.                                                      05360000
053700                                                                  05370000
053800     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05380000
053900     SET DPG51-ACTUAL-CALENDAR-ONLY   TO TRUE.                    05390000
054000     SET DPG51-DO-NOT-INCR-DECR-DATE  TO TRUE.                    05400000
054100     SET DPG52-LK-DTE-ISO-FMT         TO TRUE.                    05410000
054200     MOVE PV-PROMO-END-DTE            TO DPG52-LK-DATE-INPUT.     05420000
054300     MOVE 'INVALID PROMO ENDING DATE' TO PV-OPERATION-MSG-1.      05430000
054400                                                                  05440000
054500     PERFORM 9100-CALENDAR-ROUTINE.                               05450000
054600                                                                  05460000
054700     MOVE DPG55-ALPHA-WEEK-DAY  TO PV-END-DAY-ALPHA.              05470000
054800     MOVE DPG55-GREG-DATE-FMT   TO PV-END-DATE.                   05480000
054900                                                                  05490000
055000     IF (PV-PM-END-TM-HH =                                        05500000
055100         PC-DEFAULT-END-HR AND                                    05510000
055200         PV-PM-END-TM-MM =                                        05520000
055300         PC-DEFAULT-END-MIN)                                      05530000
055400         IF PV-PROMO-STRT-DTE = PV-PROMO-END-DTE                  05540000
055500* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05550000
055600            MOVE SPACES         TO PV-END-TIME                    05560000
055700            MOVE PV-PM-END-TM-HH                                  05570000
055800                                TO PV-END-HR-TIME                 05580000
055900            MOVE PC-COLON       TO PV-END-TIME-COLON              05590000
056000            MOVE PV-PM-END-TM-MM                                  05600000
056100                                TO PV-END-MIN-TIME                05610000
056200         ELSE                                                     05620000
056300            MOVE PC-ALL-DAY     TO PV-END-TIME                    05630000
056400         END-IF                                                   05640000
056500      ELSE                                                        05650000
056600* NEED TO CLEAR OUT ANY LETTERS FROM A PREVIOUS 'ALL DAY' DISPLAY 05660000
056700         MOVE SPACES            TO PV-END-TIME                    05670000
056800         MOVE PV-PM-END-TM-HH                                     05680000
056900                                TO PV-END-HR-TIME                 05690000
057000         MOVE PC-COLON          TO PV-END-TIME-COLON              05700000
057100         MOVE PV-PM-END-TM-MM                                     05710000
057200                                TO PV-END-MIN-TIME                05720000
057300     END-IF.                                                      05730000
057400                                                                  05740000
057500*2100-EXIT.                                                       05750006
057600 EJECT.                                                           05760000
057700                                                                  05770000
080078*----------------------------------------------------------       08007800
080079* 2200-FORMAT-HEADING-FIELDS.                                     08007906
080080*     FORMAT THE AD EVENT TITLES AND THE PROMOTION TITLES.        08008000
080090*----------------------------------------------------------       08009000
080100 2200-FORMAT-HEADING-FIELDS.                                      08010006
080200                                                                  08020000
080210     MOVE PM100-AD-EVNT-NBR-TXT TO PV-SAVE-VAR.                   08021000
080220     MOVE 16                    TO PV-SAVE-NUM.                   08022000
080230     PERFORM 7000-COUNT-FIELD-LENGTH.                             08023005
080231     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NBR-LENGTH.         08023100
080232                                                                  08023200
080233     MOVE PM100-AD-EVNT-NM      TO PV-SAVE-VAR.                   08023300
080234     MOVE 41                    TO PV-SAVE-NUM.                   08023400
080235     PERFORM 7000-COUNT-FIELD-LENGTH.                             08023505
080236     MOVE PV-SAVE-LENGTH        TO PV-AD-EVNT-NM-LENGTH.          08023600
080237                                                                  08023700
080238     MOVE PM100-PROMO-NM        TO PV-SAVE-VAR.                   08023800
080239     MOVE 41                    TO PV-SAVE-NUM.                   08023900
080240     PERFORM 7000-COUNT-FIELD-LENGTH.                             08024005
080250     MOVE PV-SAVE-LENGTH        TO PV-PROMO-NM-LENGTH.            08025000
080251                                                                  08025100
080252*2200-EXIT.                                                       08025206
080253 EJECT.                                                           08025300
080254                                                                  08025400
080278*----------------------------------------------------------       08027800
080279* 2300-CREATE-HEADING-FIELDS.                                     08027906
080280*     CREATE THE AD EVENT AND THE PROMO HEADINGS.                 08028000
080281*----------------------------------------------------------       08028100
080282 2300-CREATE-HEADING-FIELDS.                                      08028206
080283                                                                  08028300
080284     MOVE SPACES          TO HDR-02-ADEVNT-STRING                 08028400
080285                             HDR-03-PROMO-STRING.                 08028500
080286                                                                  08028600
080287     MOVE +1 TO PV-POINTER-FIELD.                                 08028700
080288     STRING PM100-AD-EVNT-NBR-TXT(1:PV-AD-EVNT-NBR-LENGTH)        08028800
080289            " " DELIMITED BY SIZE                                 08028900
080290            PM100-AD-EVNT-NM(1:PV-AD-EVNT-NM-LENGTH)              08029000
080291            " " DELIMITED BY SIZE                                 08029100
080292       INTO HDR-02-ADEVNT-STRING                                  08029200
080293       WITH POINTER PV-POINTER-FIELD.                             08029300
080294                                                                  08029400
080295     MOVE +1 TO PV-POINTER-FIELD.                                 08029500
080296     STRING PM100-PROMO-NM(1:PV-PROMO-NM-LENGTH)                  08029600
080297            " " DELIMITED BY SIZE                                 08029700
080298            " " DELIMITED BY SIZE                                 08029800
080299            " " DELIMITED BY SIZE                                 08029900
080300            PC-CHAR-EFFECTIVE DELIMITED BY " "                    08030000
080301            ":" DELIMITED BY SIZE                                 08030100
080302            " " DELIMITED BY SIZE                                 08030200
080303            PV-HEADER-DTE-TM(1:87)                                08030300
080304            " " DELIMITED BY SIZE                                 08030400
080305       INTO HDR-03-PROMO-STRING                                   08030500
080306       WITH POINTER PV-POINTER-FIELD.                             08030600
080307                                                                  08030700
080308*2300-EXIT.                                                       08030806
080309 EJECT.                                                           08030900
080310                                                                  08031000
080311*----------------------------------------------------------       08031100
080312* 3000-END-OF-JOB-ROUTINE.                                        08031200
080313*     PERFORMS THE FINAL PROCESSING OF THE PROGRAM.               08031300
080314*     WRITES OUT THE CLOSING LINES OF THE REPORT, CLOSES          08031400
080315*     ANY FILES, AND DISPLAYS ANY NECESSARY STATISTICS.           08031500
080316*----------------------------------------------------------       08031600
080317 3000-END-OF-JOB-ROUTINE.                                         08031700
080318                                                                  08031800
080319     IF PS-NOT-FIRST-TIME                                         08031906
080320        PERFORM 3300-PROCESS-UNAD-TTL                             08032006
080330        PERFORM 3500-PROCESS-PAGE-HEADER                          08033006
080340        PERFORM 3310-PROCESS-GMA-TTLS                             08034006
080350        PERFORM 3320-PROCESS-PROMO-TTL                            08035006
080351        IF PS-FIRST-DMA-READ                                      08035148
080352           PERFORM 8100-READ-SLS-DMA-RESULTS                      08035248
080353           SET PS-NOT-FIRST-DMA-READ TO TRUE                      08035348
080354        ELSE                                                      08035448
080355           MOVE PV-SAVE-RECORD-2 TO PM100-PROMO-ITM-SUMM          08035548
080356        END-IF                                                    08035648
080361        SET PS-DMA-RESULTS TO TRUE                                08036106
080362        IF PM100-AD-EVNT-ID = PV-SAVE-AD-EVNT-ID                  08036249
080363           AND PM100-PROMO-ID = PV-SAVE-PROMO-ID                  08036349
080364           AND PS-NOT-EOF-SLS-DMA-RSLTS                           08036449
080365           PERFORM 3100-PROCESS-DMA-SLS-RSTLS                     08036549
080366                   UNTIL PM100-AD-EVNT-ID NOT =                   08036649
080367                              PV-SAVE-AD-EVNT-ID                  08036749
080368                      OR PM100-PROMO-ID NOT =                     08036849
080369                             PV-SAVE-PROMO-ID                     08036949
080370                      OR PS-EOF-SLS-DMA-RSLTS                     08037049
080371           PERFORM 3320-PROCESS-PROMO-TTL                         08037149
080372        END-IF                                                    08037249
080379        MOVE 2                     TO PV-ADVANCE-LINES            08037906
080380        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 08038006
080381        PERFORM 3400-CHECK-MAX-LINE-CNT                           08038106
080382        MOVE END-OF-REPORT-LINE    TO PV-RPT-LINE                 08038206
080390        PERFORM 8300-WRITE-RPT-LINE                               08039006
080391     END-IF.                                                      08039106
080400                                                                  08040000
080500     CLOSE PROMO-SUMM-GMA-FILE                                    08050002
080600           PROMO-SUMM-DMA-FILE                                    08060002
080602           PROMO-SUMM-REPORT.                                     08060202
080610                                                                  08061000
080620*3000-EXIT.                                                       08062000
080630 EJECT.                                                           08063000
080640                                                                  08064000
080650*----------------------------------------------------------       08065006
080660* 3100-PROCESS-DMA-SLS-RSTLS.                                     08066006
080670*     PROCESSES THE DMA SALES RESULTS FILE AND CREATES            08067006
080680*     PART OF THE REPORT.  THIS SECTION IS PROCESSING             08068050
080681*     THE SECOND PAGE OF A PROMOTION'S TOTALS.                    08068150
080690*----------------------------------------------------------       08069006
080700 3100-PROCESS-DMA-SLS-RSTLS.                                      08070006
080800                                                                  08080006
080900     EVALUATE TRUE                                                08090006
081000       WHEN (PM100-GMA-NBR IS NOT = PV-LAST-GMA-NBR)              08100006
081100            IF PS-NOT-FIRST-TIME-DMM                              08110006
081200               PERFORM 3320-PROCESS-PROMO-TTL                     08120006
081300            END-IF                                                08130006
081400            INITIALIZE TBL-PROMO-TOTAL-TABLE                      08140006
081500            PERFORM 3110-PROCESS-GMM-HEADERS                      08150006
081600            MOVE PM100-GMA-NBR     TO PV-LAST-GMA-NBR             08160017
081700            MOVE PM100-DMA-NBR     TO PV-LAST-DMA-NBR             08170017
081710            MOVE PM100-DMA-LAST-NM TO PV-LAST-DMA-LAST-NM         08171017
081800            SET PS-NOT-FIRST-TIME-DMM TO TRUE                     08180006
081810            SET PS-FIRST-LINE-DMM  TO TRUE                        08181022
081900       WHEN (PM100-DMA-NBR IS NOT = PV-LAST-DMA-NBR)              08190006
082000            PERFORM 3320-PROCESS-PROMO-TTL                        08200006
082100            INITIALIZE TBL-PROMO-TOTAL-TABLE                      08210006
082200            MOVE PM100-DMA-NBR     TO PV-LAST-DMA-NBR             08220017
082210            MOVE PM100-DMA-LAST-NM TO PV-LAST-DMA-LAST-NM         08221017
082220            SET PS-FIRST-LINE-DMM  TO TRUE                        08222022
082300     END-EVALUATE.                                                08230006
082400     PERFORM 3200-PROCESS-DETAIL.                                 08240006
082500                                                                  08250006
082600     PERFORM 8100-READ-SLS-DMA-RESULTS.                           08260006
082700                                                                  08270006
082800*3100-EXIT.                                                       08280006
082900 EJECT.                                                           08290006
083000                                                                  08300006
083010*----------------------------------------------------------       08301006
083020* 3110-PROCESS-GMM-HEADERS.                                       08302006
083030*     WRITES OUT THE GMM HEADERS.                                 08303006
083050*----------------------------------------------------------       08305006
083060 3110-PROCESS-GMM-HEADERS.                                        08306006
083070                                                                  08307006
083071     MOVE PM100-GMA-LAST-NM     TO DTL-HDR-01-GMM-NAME.           08307106
083072                                                                  08307206
083080     MOVE 1                     TO PV-ADVANCE-LINES.              08308006
083100     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   08310006
083101     PERFORM 3400-CHECK-MAX-LINE-CNT.                             08310106
083102     MOVE DETAIL-HEADER-02      TO PV-RPT-LINE.                   08310206
083103     PERFORM 8300-WRITE-RPT-LINE.                                 08310306
083107                                                                  08310706
083108     MOVE 1                     TO PV-ADVANCE-LINES.              08310806
083109     ADD PV-ADVANCE-LINES       TO PV-LINE-CNT.                   08310906
083110     PERFORM 3400-CHECK-MAX-LINE-CNT.                             08311006
083111     MOVE DETAIL-HEADER-01      TO PV-RPT-LINE.                   08311106
083112     PERFORM 8300-WRITE-RPT-LINE.                                 08311206
083113                                                                  08311306
083114*3110-EXIT.                                                       08311406
083115 EJECT.                                                           08311506
083116                                                                  08311606
083120*----------------------------------------------------------       08312006
083200* 3200-PROCESS-DETAIL.                                            08320006
083300*     PROCESS REPORT DETAIL LINES.                                08330006
083400*----------------------------------------------------------       08340006
083410 3200-PROCESS-DETAIL.                                             08341006
083420                                                                  08342006
083430     MOVE SPACES                    TO DETAIL-01                  08343006
083440                                       DETAIL-VARIABLE.           08344006
083450                                                                  08345006
083460     IF PS-DMA-RESULTS                                            08346006
083470        IF PS-FIRST-LINE-DMM                                      08347021
083492           MOVE 2                   TO PV-ADVANCE-LINES           08349206
083493           SET PS-NO-FIRST-LINE-DMM TO TRUE                       08349321
083494           IF PM100-PROMO-ITM-ADV-IND = 'Y'                       08349423
083495              MOVE PC-ADV-DMM          TO PV-DMM-TOTAL-TITLE      08349523
083496              MOVE PM100-DMA-LAST-NM   TO PV-DMM-LAST-NAME        08349623
083497              MOVE PV-DMM-TITLE        TO DTL-01-NEW-TITLE        08349723
083498           ELSE                                                   08349823
083499              IF PM100-PROMO-ITM-ADV-IND = 'N'                    08349923
083500                 MOVE PC-UNAD-DMM       TO PV-DMM-TOTAL-TITLE     08350023
083501                 MOVE PM100-DMA-LAST-NM TO PV-DMM-LAST-NAME       08350123
083502                 MOVE PV-DMM-TITLE      TO DTL-01-NEW-TITLE       08350223
083503              END-IF                                              08350323
083504           END-IF                                                 08350423
083505        ELSE                                                      08350506
083506           MOVE 1                 TO PV-ADVANCE-LINES             08350621
083507           IF PM100-PROMO-ITM-ADV-IND = 'Y'                       08350723
083508              MOVE PC-ADV-DMM          TO PV-DMM-TOTAL-TITLE      08350823
083509              MOVE PM100-DMA-LAST-NM   TO PV-DMM-LAST-NAME        08350923
083510              MOVE PV-DMM-TITLE        TO DTL-01-NEW-TITLE        08351023
083511           ELSE                                                   08351123
083512              IF PM100-PROMO-ITM-ADV-IND = 'N'                    08351223
083513                 MOVE PC-UNAD-DMM       TO PV-DMM-TOTAL-TITLE     08351323
083514                 MOVE PM100-DMA-LAST-NM TO PV-DMM-LAST-NAME       08351423
083515                 MOVE PV-DMM-TITLE      TO DTL-01-NEW-TITLE       08351523
083516              END-IF                                              08351623
083517           END-IF                                                 08351723
083518        END-IF                                                    08351806
083519     ELSE                                                         08351906
083520        PERFORM 3210-CHECK-GMA-TABLE                              08352024
PGNBR         IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                      08352157
PGNBR            PM100-AD-PG-NBR NOT = 0                                08352257
083522           MOVE PM100-AD-PG-NBR      TO DTL-01-PM-AD-PG-NBR       08352315
083523           MOVE PM100-GMA-LAST-NM    TO DTL-01-GMA-LAST-NM        08352415
083524           MOVE 2                    TO PV-ADVANCE-LINES          08352515
PGNBR         ELSE                                                      08352656
PGNBR            IF PM100-PROMO-ITM-ADV-IND = 'Y' AND                   08352756
PGNBR               PM100-AD-PG-NBR = 0                                 08352856
PGNBR               MOVE PC-ADVNOPAGE         TO DTL-01-NOPG-TITLE      08352956
PGNBR               MOVE PM100-GMA-LAST-NM    TO DTL-01-ADV-GMA-LAST-NM 08353056
PGNBR               MOVE 2                    TO PV-ADVANCE-LINES       08353156
PGNBR            ELSE                                                   08353256
PGNBR               IF PM100-PROMO-ITM-ADV-IND = 'N'                    08353356
PGNBR                  MOVE PC-UNADVERTISED   TO DTL-01-UNAD-TITLE      08353456
PGNBR                  MOVE PM100-GMA-LAST-NM TO DTL-01-TTL-GMA-LAST-NM 08353556
PGNBR                  MOVE 2                 TO PV-ADVANCE-LINES       08353656
PGNBR               END-IF                                              08353756
083530           END-IF                                                 08353815
083531        END-IF                                                    08353915
083532     END-IF.                                                      08354006
083533                                                                  08354106
083534*** THIS IS PROCESSED FOR ACTUAL REPORTS ONLY.                    08354206
083535     IF PM100-ACTUAL                                              08354306
083537        MOVE PM100-ACTL-SLS-RTL-AMT  TO DTL-01-ACTL-SLS-RTL-AMT   08354454
083539                                                                  08354506
083541        MOVE PM100-ACTL-MKDN-RTL-AMT TO DTL-01-ACTL-MD-AMT        08354654
083543                                                                  08354706
083545        MOVE PM100-ACTL-SLS-UNT-QTY  TO DTL-01-ACTL-UNT-SLD-QTY   08354854
083547        ADD PM100-ACTL-SLS-RTL-AMT   TO                           08354954
083548                             TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)     08355006
083549        ADD PM100-ACTL-MKDN-RTL-AMT  TO                           08355154
083550                             TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)       08355206
083551        ADD PM100-ACTL-SLS-UNT-QTY   TO                           08355354
083552                             TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)  08355406
083553        ADD PM100-ACTL-SLS-COST-AMT  TO                           08355554
083554                             TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1) 08355606
083555        ADD PM100-ACTL-EOH-INV-QTY   TO                           08355754
083556                             TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1)  08355806
083557        IF PM100-PROMO-ITM-ADV-IND = 'N'                          08355906
083558           ADD PM100-ACTL-SLS-RTL-AMT  TO                         08356006
083559                           TBL-STOT-TOT-SALE-AMT(PC-SUB-1)        08356106
083560           ADD PM100-ACTL-MKDN-RTL-AMT TO                         08356206
083561                           TBL-STOT-TOT-MD-AMT(PC-SUB-1)          08356306
083562           ADD PM100-ACTL-SLS-UNT-QTY  TO                         08356406
083563                           TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)     08356506
083564           ADD PM100-ACTL-SLS-COST-AMT TO                         08356606
083565                           TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1)    08356706
083566           ADD PM100-ACTL-EOH-INV-QTY TO                          08356806
083567                           TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1)     08356906
083568           ADD PM100-ACTL-PREP-UNT-QTY TO                         08357006
083569                           TBL-STOT-PREP-UNT-QTY(PC-SUB-1)        08357106
083570        END-IF                                                    08357206
083572        MOVE PM100-ACTL-PREP-UNT-QTY TO DTL-01-ACTL-PREP-UNT-QTY  08357354
083574        ADD PM100-ACTL-PREP-UNT-QTY  TO                           08357454
083575                                TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)  08357506
083576        IF PM100-ACTL-SLS-RTL-AMT = ZEROES                        08357627
083578           MOVE ZEROES              TO PV-MU-PCT                  08357854
083579           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         08357954
083580           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       08358054
083581        ELSE                                                      08358127
083582           COMPUTE PV-MU-PCT ROUNDED =                            08358227
083583                   ((PM100-ACTL-SLS-RTL-AMT -                     08358327
083584                    PM100-ACTL-SLS-COST-AMT) /                    08358427
083585                    PM100-ACTL-SLS-RTL-AMT) * 100                 08358527
083586                    ON SIZE ERROR                                 08358627
083587                    MOVE 0 TO PV-MU-PCT                           08358727
083588           END-COMPUTE                                            08358827
083589           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          08358927
083590           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  08359027
083591           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          08359127
083595           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        08359554
083597        END-IF                                                    08359727
083598                                                                  08359827
083605        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        08360551
083606                (PM100-ACTL-SLS-UNT-QTY /                         08360651
083607                (PM100-ACTL-EOH-INV-QTY +                         08360751
083608                 PM100-ACTL-SLS-UNT-QTY)) * 100                   08360851
083609                 ON SIZE ERROR                                    08360951
083610                 MOVE 0 TO PV-SELL-THRU-PCT                       08361051
083611        END-COMPUTE                                               08361151
083613        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          08361327
083614        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  08361427
083615        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        08361527
083619        MOVE PC-PERCENT-SIGN       TO DTL-O1-SELL-PCT-SIGN        08361954
083621                                                                  08362127
083622        IF PM100-FCST-SLS-RTL-AMT = ZEROES                        08362227
083623           CONTINUE                                               08362327
083624        ELSE                                                      08362427
083625           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       08362553
083626                 ((PM100-FCST-SLS-RTL-AMT -                       08362653
083627                   PM100-ACTL-SLS-RTL-AMT) /                      08362753
083628                   PM100-FCST-SLS-RTL-AMT) * -100                 08362853
083629                   ON SIZE ERROR                                  08362927
083630                   MOVE 0 TO PV-VOL-PCT-CHG                       08363027
083631           END-COMPUTE                                            08363127
083632           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          08363227
083633           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  08363327
083634           IF PV-VOL-PCT-CHG < 0                                  08363427
083635              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 08363527
083636              MOVE PV-FINAL-VOL-PCT                               08363627
083637                                   TO DTL-01-VOL-PCT-CHG          08363727
083638           ELSE                                                   08363827
083639              MOVE PV-ROUND-TO-TENTHS                             08363927
083640                                   TO DTL-VAR-VOL-PCT-CHG         08364027
083641              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          08364127
083642           END-IF                                                 08364227
083646           MOVE PC-PERCENT-SIGN TO DTL-01-VOL-PCT-SIGN            08364654
083648        END-IF                                                    08364827
083649     END-IF.                                                      08364906
083650                                                                  08365006
083652     MOVE PM100-FCST-SLS-RTL-AMT    TO DTL-01-FCST-SLS-RTL-AMT.   08365254
083654     ADD PM100-FCST-SLS-RTL-AMT     TO                            08365406
083655                              TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2).   08365506
083657     MOVE PM100-FCST-MKDN-RTL-AMT   TO DTL-01-FCST-MD-AMT.        08365754
083659     ADD PM100-FCST-MKDN-RTL-AMT    TO                            08365906
083660                             TBL-PMTOT-TOT-MD-AMT(PC-SUB-2).      08366006
083662     MOVE PM100-FCST-SLS-UNT-QTY    TO DTL-01-FCST-UNT-SLD-QTY.   08366254
083664     ADD PM100-FCST-SLS-UNT-QTY     TO                            08366406
083665                            TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2).  08366506
083667     MOVE PM100-FCST-PROJD-UNT-QTY  TO DTL-01-FCST-PREP-UNT-QTY.  08366754
083669     ADD PM100-FCST-PROJD-UNT-QTY   TO                            08366906
083670                             TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2).    08367006
083671     ADD PM100-FCST-SLS-COST-AMT    TO                            08367106
083672                             TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2).08367206
083673                                                                  08367306
083674     IF PM100-FCST-SLS-RTL-AMT = ZEROES                           08367427
083675         CONTINUE                                                 08367527
083676     ELSE                                                         08367627
083677         COMPUTE PV-MU-PCT ROUNDED =                              08367727
083678                 ((PM100-FCST-SLS-RTL-AMT -                       08367827
083679                 PM100-FCST-SLS-COST-AMT) /                       08367927
083680                 PM100-FCST-SLS-RTL-AMT) * 100                    08368027
083681                 ON SIZE ERROR                                    08368127
083682                 MOVE 0 TO PV-MU-PCT                              08368227
083683         END-COMPUTE                                              08368327
083684         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          08368427
083685         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  08368527
083686         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          08368627
083690         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        08369054
083692     END-IF.                                                      08369227
083694     IF PM100-PROMO-ITM-ADV-IND = 'N'                             08369406
083695        ADD PM100-FCST-SLS-RTL-AMT   TO                           08369506
083696                      TBL-STOT-TOT-SALE-AMT(PC-SUB-2)             08369606
083697        ADD PM100-FCST-MKDN-RTL-AMT  TO                           08369706
083698                      TBL-STOT-TOT-MD-AMT(PC-SUB-2)               08369806
083699        ADD PM100-FCST-SLS-UNT-QTY   TO                           08369906
083700                      TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)          08370006
083701        ADD PM100-FCST-SLS-COST-AMT  TO                           08370106
083702                      TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2)         08370206
083703        ADD PM100-FCST-PROJD-UNT-QTY TO                           08370306
083704                      TBL-STOT-PREP-UNT-QTY(PC-SUB-2)             08370406
083705     END-IF.                                                      08370506
083706                                                                  08370606
083713     ADD PV-ADVANCE-LINES           TO PV-LINE-CNT.               08371306
083714     PERFORM 3400-CHECK-MAX-LINE-CNT.                             08371406
083715     MOVE DETAIL-01                 TO PV-RPT-LINE.               08371506
083716     PERFORM 8300-WRITE-RPT-LINE.                                 08371606
083717                                                                  08371706
083718*3200-EXIT.                                                       08371806
083719 EJECT.                                                           08371906
083720                                                                  08372006
083721*----------------------------------------------------------       08372106
083722* 3210-CHECK-GMA-TABLE.                                           08372206
083723*     CHECK TO SEE IF THE GMA IS IN THE TABLE, IF NOT             08372306
083724*     ADD THE GMA IN THE TABLE, IF IT IS THERE, THAN ADD          08372406
083725*     THE TOTALS.                                                 08372506
083726*----------------------------------------------------------       08372606
083727 3210-CHECK-GMA-TABLE.                                            08372706
083728                                                                  08372806
083729     IF PA-CNT-GMA = 0                                            08372906
083730        SET TBL-GTOT-INDEX TO +1                                  08373006
083731        PERFORM 3230-POPULATE-GMA-TABLE                           08373107
083732        ADD +1 TO PA-CNT-GMA                                      08373206
083733     ELSE                                                         08373306
083734        PERFORM 3220-SEARCH-GMA-TABLE                             08373406
083735     END-IF.                                                      08373506
083736                                                                  08373606
083737*3210-EXIT.                                                       08373706
083738 EJECT.                                                           08373806
083739                                                                  08373906
083740*----------------------------------------------------------       08374006
083741* 3220-SEARCH-GMA-TABLE.                                          08374106
083742*     THIS SEARCHES ALL THE GMA RECORDS TO SEE IF THERE           08374206
083743*     IS ANOTHER RECORD OUT THERE WITH THE SAME GMA               08374306
083744*     NUMBER.  IF THERE ISN'T A RECORD OUT THERE                  08374406
083745*     WITH THE SAME GMA NUMBER, IT WILL JUST ADD THE              08374506
083746*     RECORD TO THE TABLE.  IF THERE IS ONE OUT THERE             08374606
083747*     WITH THE SAME GMA NUMBER, IT NEEDS TO ADD ALL               08374706
083748*     THE TOTAL NUMBERS TOGETHER.                                 08374806
083749*----------------------------------------------------------       08374906
083750 3220-SEARCH-GMA-TABLE.                                           08375006
083751                                                                  08375106
083752     SET PS-GMA-NBR-NOT-FOUND TO TRUE.                            08375206
083753                                                                  08375306
083754     PERFORM 3225-SEARCH-FOR-GMA-NBR                              08375406
083755        VARYING TBL-GTOT-INDEX FROM 1 BY 1                        08375506
083756        UNTIL PS-GMA-NBR-FOUND                                    08375606
083757              OR TBL-GTOT-INDEX > PA-CNT-GMA.                     08375706
083758                                                                  08375806
083759     IF PS-GMA-NBR-FOUND                                          08375906
083760        SET TBL-GTOT-INDEX TO PA-HOLD-INDEX                       08376006
083761        PERFORM 3230-POPULATE-GMA-TABLE                           08376106
083762     ELSE                                                         08376206
083763        COMPUTE PA-CNT-NEW-INDX = PA-CNT-GMA + 1                  08376306
083764        SET TBL-GTOT-INDEX TO PA-CNT-NEW-INDX                     08376406
083765        PERFORM 3230-POPULATE-GMA-TABLE                           08376506
083766        ADD +1 TO PA-CNT-GMA                                      08376606
083767     END-IF.                                                      08376706
083768                                                                  08376806
083769*3220-EXIT.                                                       08376906
083770 EJECT.                                                           08377006
083771                                                                  08377106
083772*----------------------------------------------------------       08377206
083773* 3225-SEARCH-FOR-GMA-NBR.                                        08377306
083774*     THIS PROCEDURE SETS A FLAG IF THE GMA NUMBER WAS            08377406
083775*     FOUND IN THE TABLE.                                         08377506
083776*----------------------------------------------------------       08377606
083777 3225-SEARCH-FOR-GMA-NBR.                                         08377706
083778                                                                  08377806
083779     IF TBL-GTOT-GMA-NBR(TBL-GTOT-INDEX) = PM100-GMA-NBR          08377906
083780        SET PS-GMA-NBR-FOUND TO TRUE                              08378006
083781        SET PA-HOLD-INDEX TO TBL-GTOT-INDEX                       08378106
083782     END-IF.                                                      08378206
083783                                                                  08378306
083784*3225-EXIT.                                                       08378406
083785 EJECT.                                                           08378506
083786                                                                  08378606
083787*----------------------------------------------------------       08378706
083788* 3230-POPULATE-GMA-TABLE.                                        08378806
083789*     ADDS THE GMA TOTALS TO THE TABLE.                           08378906
083790*----------------------------------------------------------       08379006
083791 3230-POPULATE-GMA-TABLE.                                         08379106
083792                                                                  08379206
083793     IF TBL-GTOT-GMA-NBR(TBL-GTOT-INDEX) = 0                      08379306
083794        MOVE PM100-GMA-NBR           TO                           08379406
083795                TBL-GTOT-GMA-NBR(TBL-GTOT-INDEX)                  08379506
083796        MOVE PM100-GMA-LAST-NM       TO                           08379606
083797                TBL-GTOT-GMA-LAST-NM(TBL-GTOT-INDEX)              08379706
083798     END-IF.                                                      08379806
083799                                                                  08379906
083800     IF PM100-ACTUAL                                              08380006
083801        ADD PM100-ACTL-SLS-RTL-AMT   TO                           08380106
083802                TBL-GTOT-ACT-SALE-AMT(TBL-GTOT-INDEX)             08380206
083803        ADD PM100-ACTL-MKDN-RTL-AMT  TO                           08380306
083804                TBL-GTOT-ACT-MD-AMT(TBL-GTOT-INDEX)               08380406
083805        ADD PM100-ACTL-SLS-UNT-QTY   TO                           08380506
083806                TBL-GTOT-ACT-SLS-UNT-QTY(TBL-GTOT-INDEX)          08380606
083807        ADD PM100-ACTL-SLS-COST-AMT  TO                           08380706
083808                TBL-GTOT-ACT-SLS-COST-AMT(TBL-GTOT-INDEX)         08380806
083809        ADD PM100-ACTL-PREP-UNT-QTY  TO                           08380906
083810                TBL-GTOT-ACT-PREP-QTY(TBL-GTOT-INDEX)             08381006
083811        ADD PM100-ACTL-EOH-INV-QTY   TO                           08381106
083812                TBL-GTOT-TOT-EOH-INV-QTY(TBL-GTOT-INDEX)          08381206
083813     END-IF.                                                      08381306
083814                                                                  08381406
083815     ADD PM100-FCST-SLS-RTL-AMT      TO                           08381506
083816                TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX).           08381606
083817     ADD PM100-FCST-MKDN-RTL-AMT     TO                           08381706
083818                TBL-GTOT-FCST-MD-AMT(TBL-GTOT-INDEX).             08381806
083819     ADD PM100-FCST-SLS-UNT-QTY      TO                           08381906
083820                TBL-GTOT-FCST-SLS-UNT-QTY(TBL-GTOT-INDEX).        08382006
083821     ADD PM100-FCST-SLS-COST-AMT     TO                           08382106
083822                TBL-GTOT-FCST-SLS-COST-AMT(TBL-GTOT-INDEX).       08382206
083823     ADD PM100-FCST-PROJD-UNT-QTY    TO                           08382306
083824                TBL-GTOT-FCST-PREP-QTY(TBL-GTOT-INDEX).           08382406
083825                                                                  08382506
083826*3230-EXIT.                                                       08382606
083827 EJECT.                                                           08382706
083828                                                                  08382806
083829*----------------------------------------------------------       08382900
083830* 3300-PROCESS-UNAD-TTL.                                          08383006
083831*     PROCESS THE UNADVERTISED TOTAL OF THE REPORT.               08383102
083840*----------------------------------------------------------       08384000
083900 3300-PROCESS-UNAD-TTL.                                           08390006
084000                                                                  08400000
084100     MOVE SPACES               TO DETAIL-01                       08410004
084200                                  DETAIL-VARIABLE.                08420002
084300                                                                  08430002
084500     MOVE PC-UNADVERTISED       TO DTL-01-UNAD-TITLE.             08450004
084600     MOVE PC-TOTAL              TO DTL-01-TTL-GMA-LAST-NM.        08460004
085100                                                                  08510002
085200*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                08520002
085300     IF PM100-ACTUAL                                              08530002
085500        MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-1)                      08550054
085600                                   TO DTL-01-ACTL-SLS-RTL-AMT     08560054
085800                                                                  08580002
085900        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES               08590002
086000           CONTINUE                                               08600002
086100        ELSE                                                      08610002
086200           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       08620053
086210                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              08621053
086300                   TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) /             08630053
086400                   TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * -100        08640053
086500                   ON SIZE ERROR                                  08650002
086600                   MOVE 0 TO PV-VOL-PCT-CHG                       08660002
086700           END-COMPUTE                                            08670002
086800           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          08680002
086900           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  08690002
087000           IF PV-VOL-PCT-CHG < 0                                  08700002
087100              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 08710002
087200              MOVE PV-FINAL-VOL-PCT                               08720002
087300                                   TO DTL-01-VOL-PCT-CHG          08730004
087400           ELSE                                                   08740002
087500              MOVE PV-ROUND-TO-TENTHS                             08750002
087600                                   TO DTL-VAR-VOL-PCT-CHG         08760002
087700              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          08770004
087800           END-IF                                                 08780002
088200           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         08820054
088400        END-IF                                                    08840002
088500                                                                  08850002
088600        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        08860051
088700                (TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1) /             08870051
088800                (TBL-STOT-TOT-EOH-INV-QTY(PC-SUB-1) +             08880051
088900                 TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100       08890051
089000                 ON SIZE ERROR                                    08900051
089100                 MOVE 0 TO PV-SELL-THRU-PCT                       08910051
089200        END-COMPUTE                                               08920051
089300        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          08930002
089400        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  08940002
089500        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        08950004
089900        MOVE PC-PERCENT-SIGN    TO DTL-O1-SELL-PCT-SIGN           08990054
090100                                                                  09010002
090300        MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-1)                        09030054
090400                                   TO DTL-01-ACTL-MD-AMT          09040054
090700        MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-1)                   09070054
090800                                   TO DTL-01-ACTL-UNT-SLD-QTY     09080054
091100        MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-1)                      09110054
091200                                   TO DTL-01-ACTL-PREP-UNT-QTY    09120054
091800                                                                  09180002
091900        IF TBL-STOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES               09190002
092010           MOVE ZEROES              TO PV-MU-PCT                  09201054
092020           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         09202054
092030           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       09203054
092100        ELSE                                                      09210002
092200           COMPUTE PV-MU-PCT ROUNDED =                            09220002
092300                   ((TBL-STOT-TOT-SALE-AMT(PC-SUB-1) -            09230002
092400                    TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-1))/         09240002
092500                    TBL-STOT-TOT-SALE-AMT(PC-SUB-1)) * 100        09250002
092600                    ON SIZE ERROR                                 09260002
092700                    MOVE 0 TO PV-MU-PCT                           09270002
092800           END-COMPUTE                                            09280002
092900           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          09290002
093000           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  09300002
093100           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          09310004
093500           MOVE PC-PERCENT-SIGN TO DTL-01-ACTL-PCT-SIGN           09350054
093700        END-IF                                                    09370002
093800     END-IF.                                                      09380002
093900                                                                  09390002
093910*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            09391002
093930     MOVE TBL-STOT-TOT-SALE-AMT(PC-SUB-2)                         09393054
093940                                   TO DTL-01-FCST-SLS-RTL-AMT.    09394054
093970     MOVE TBL-STOT-TOT-MD-AMT(PC-SUB-2)                           09397054
093980                                   TO DTL-01-FCST-MD-AMT.         09398054
093992     MOVE TBL-STOT-TOT-SLS-UNT-QTY(PC-SUB-2)                      09399254
093993                                   TO DTL-01-FCST-UNT-SLD-QTY.    09399354
093996     MOVE TBL-STOT-PREP-UNT-QTY(PC-SUB-2)                         09399654
093997                                   TO DTL-01-FCST-PREP-UNT-QTY.   09399754
094003                                                                  09400302
094004     IF TBL-STOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                  09400402
094005         CONTINUE                                                 09400502
094006     ELSE                                                         09400602
094007         COMPUTE PV-MU-PCT ROUNDED =                              09400702
094008                 ((TBL-STOT-TOT-SALE-AMT(PC-SUB-2) -              09400802
094009                 TBL-STOT-TOT-SLS-COST-AMT(PC-SUB-2))/            09400902
094010                 TBL-STOT-TOT-SALE-AMT(PC-SUB-2)) * 100           09401002
094011                 ON SIZE ERROR                                    09401102
094012                 MOVE 0 TO PV-MU-PCT                              09401202
094013         END-COMPUTE                                              09401302
094014         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          09401402
094015         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  09401502
094016         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          09401604
094020         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        09402054
094022     END-IF.                                                      09402202
094023                                                                  09402302
094024     MOVE 2                    TO PV-ADVANCE-LINES.               09402402
094025     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    09402502
094026     PERFORM 3400-CHECK-MAX-LINE-CNT.                             09402606
094027     MOVE DETAIL-01            TO PV-RPT-LINE.                    09402706
094028     PERFORM 8300-WRITE-RPT-LINE.                                 09402807
094030                                                                  09403000
094100*3300-EXIT.                                                       09410006
094200 EJECT.                                                           09420000
094300                                                                  09430000
094400*----------------------------------------------------------       09440002
094500* 3310-PROCESS-GMA-TTLS.                                          09450006
094600*     PROCESS THE GMA TOTALS OF THE REPORT.                       09460002
094700*----------------------------------------------------------       09470002
094800 3310-PROCESS-GMA-TTLS.                                           09480006
094900                                                                  09490002
095210     PERFORM VARYING TBL-GTOT-INDEX FROM 1 BY 1                   09521004
095220       UNTIL TBL-GTOT-INDEX > PA-CNT-GMA                          09522004
095230       MOVE SPACES                 TO DETAIL-01                   09523006
095240                                      DETAIL-VARIABLE             09524006
095400        MOVE TBL-GTOT-GMA-LAST-NM(TBL-GTOT-INDEX)                 09540006
095410                                   TO PV-SAVE-VAR                 09541006
095411                                      PV-SAVE-GMA-NAME            09541106
095420        MOVE 41                    TO PV-SAVE-NUM                 09542006
095500        PERFORM 7000-COUNT-FIELD-LENGTH                           09550005
095600        MOVE PV-SAVE-LENGTH        TO PV-GMM-LAST-NM-LENGTH       09560006
095700        MOVE +1 TO PV-POINTER-FIELD                               09570006
095800        STRING PV-SAVE-GMA-NAME(1:PV-GMM-LAST-NM-LENGTH)          09580006
095900               " " DELIMITED BY SIZE                              09590006
096000               PC-TOTAL DELIMITED BY " "                          09600006
096010               " " DELIMITED BY SIZE                              09601006
096020        INTO DTL-01-NEW-TITLE                                     09602006
096030        WITH POINTER PV-POINTER-FIELD                             09603006
096100*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                09610002
096200        IF PM100-ACTUAL                                           09620004
096400           MOVE TBL-GTOT-ACT-SALE-AMT(TBL-GTOT-INDEX)             09640054
096500                                   TO DTL-01-ACTL-SLS-RTL-AMT     09650054
096700                                                                  09670002
096800           IF TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX) = ZEROES     09680005
096900              CONTINUE                                            09690004
097000           ELSE                                                   09700004
097100              COMPUTE PV-VOL-PCT-CHG ROUNDED =                    09710053
097110                    ((TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX) -    09711053
097200                      TBL-GTOT-ACT-SALE-AMT(TBL-GTOT-INDEX)) /    09720053
097300                      TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX))     09730053
097310                      * -100                                      09731005
097400                      ON SIZE ERROR                               09740004
097500                      MOVE 0 TO PV-VOL-PCT-CHG                    09750004
097600              END-COMPUTE                                         09760004
097700              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          09770004
097800              ADD PV-VOL-PCT-CHG   TO PV-ROUND-TO-TENTHS ROUNDED  09780004
097900              IF PV-VOL-PCT-CHG < 0                               09790004
098000                 PERFORM 9000-ADD-PARENTH-TO-NEG-PCT              09800004
098100                 MOVE PV-FINAL-VOL-PCT                            09810004
098200                                   TO DTL-01-VOL-PCT-CHG          09820004
098300              ELSE                                                09830004
098400                 MOVE PV-ROUND-TO-TENTHS                          09840004
098500                                   TO DTL-VAR-VOL-PCT-CHG         09850002
098600                 MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG       09860004
098700              END-IF                                              09870004
099100              MOVE PC-PERCENT-SIGN TO DTL-01-VOL-PCT-SIGN         09910054
099300           END-IF                                                 09930004
099400                                                                  09940002
099500           COMPUTE PV-SELL-THRU-PCT ROUNDED =                     09950051
099600                   (TBL-GTOT-ACT-SLS-UNT-QTY(TBL-GTOT-INDEX) /    09960051
099700                   (TBL-GTOT-TOT-EOH-INV-QTY(TBL-GTOT-INDEX) +    09970051
099800                    TBL-GTOT-ACT-SLS-UNT-QTY(TBL-GTOT-INDEX)))    09980051
099810                    * 100                                         09981051
099900                    ON SIZE ERROR                                 09990051
100000                    MOVE 0 TO PV-SELL-THRU-PCT                    10000051
100100           END-COMPUTE                                            10010051
100200           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10020004
100300           ADD PV-SELL-THRU-PCT    TO PV-ROUND-TO-TENTHS ROUNDED  10030004
100400           MOVE PV-ROUND-TO-TENTHS TO DTL-01-SELL-THRU-PCT        10040004
100800           MOVE PC-PERCENT-SIGN    TO DTL-O1-SELL-PCT-SIGN        10080054
101000                                                                  10100002
101200           MOVE TBL-GTOT-ACT-MD-AMT(TBL-GTOT-INDEX)               10120054
101300                                   TO DTL-01-ACTL-MD-AMT          10130054
101600           MOVE TBL-GTOT-ACT-SLS-UNT-QTY(TBL-GTOT-INDEX)          10160054
101700                                   TO DTL-01-ACTL-UNT-SLD-QTY     10170054
102000           MOVE TBL-GTOT-ACT-PREP-QTY(TBL-GTOT-INDEX)             10200054
102100                                   TO DTL-01-ACTL-PREP-UNT-QTY    10210054
102700                                                                  10270002
102800           IF TBL-GTOT-ACT-SALE-AMT(TBL-GTOT-INDEX) = ZEROES      10280005
102910              MOVE ZEROES              TO PV-MU-PCT               10291054
102920              MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT      10292054
102930              MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN    10293054
103000           ELSE                                                   10300004
103100              COMPUTE PV-MU-PCT ROUNDED =                         10310004
103200                      ((TBL-GTOT-ACT-SALE-AMT(TBL-GTOT-INDEX) -   10320005
103300                        TBL-GTOT-ACT-SLS-COST-AMT(TBL-GTOT-INDEX))10330005
103400                        / TBL-GTOT-ACT-SALE-AMT(TBL-GTOT-INDEX))  10340005
103410                        * 100                                     10341005
103500                        ON SIZE ERROR                             10350004
103600                        MOVE 0 TO PV-MU-PCT                       10360004
103700              END-COMPUTE                                         10370004
103800              MOVE ZEROES          TO PV-ROUND-TO-TENTHS          10380004
103900              ADD PV-MU-PCT        TO PV-ROUND-TO-TENTHS ROUNDED  10390004
104000              MOVE PV-ROUND-TO-TENTHS                             10400004
104010                                   TO DTL-01-ACTL-MU-PCT          10401004
104400              MOVE PC-PERCENT-SIGN TO DTL-01-ACTL-PCT-SIGN        10440054
104600           END-IF                                                 10460004
104700        END-IF                                                    10470004
104800                                                                  10480002
104900*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            10490002
105100        MOVE TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX)               10510054
105200                                   TO DTL-01-FCST-SLS-RTL-AMT     10520054
105500        MOVE TBL-GTOT-FCST-MD-AMT(TBL-GTOT-INDEX)                 10550054
105600                                   TO DTL-01-FCST-MD-AMT          10560054
105900        MOVE TBL-GTOT-FCST-SLS-UNT-QTY(TBL-GTOT-INDEX)            10590054
106000                                   TO DTL-01-FCST-UNT-SLD-QTY     10600054
106300        MOVE TBL-GTOT-FCST-PREP-QTY(TBL-GTOT-INDEX)               10630054
106400                                   TO DTL-01-FCST-PREP-UNT-QTY    10640054
107000                                                                  10700002
107100        IF TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX) = ZEROES        10710005
107200           CONTINUE                                               10720004
107300        ELSE                                                      10730004
107400           COMPUTE PV-MU-PCT ROUNDED =                            10740004
107500                   ((TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX) -     10750005
107600                     TBL-GTOT-FCST-SLS-COST-AMT(TBL-GTOT-INDEX))/ 10760005
107700                     TBL-GTOT-FCST-SALE-AMT(TBL-GTOT-INDEX)) * 10010770005
107800                     ON SIZE ERROR                                10780004
107900                     MOVE 0 TO PV-MU-PCT                          10790004
108000           END-COMPUTE                                            10800004
108100           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          10810004
108200           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  10820004
108300           MOVE PV-ROUND-TO-TENTHS TO DTL-01-FCST-MU-PCT          10830004
108700           MOVE PC-PERCENT-SIGN    TO DTL-01-FCST-PCT-SIGN        10870054
108900        END-IF                                                    10890004
108901        MOVE 2                     TO PV-ADVANCE-LINES            10890116
108902        ADD PV-ADVANCE-LINES       TO PV-LINE-CNT                 10890216
108903        PERFORM 3400-CHECK-MAX-LINE-CNT                           10890316
108904        MOVE DETAIL-01             TO PV-RPT-LINE                 10890416
108905        PERFORM 8300-WRITE-RPT-LINE                               10890516
108910     END-PERFORM.                                                 10891007
109600                                                                  10960002
109700*3310-EXIT.                                                       10970006
109800 EJECT.                                                           10980002
109900                                                                  10990002
110000*----------------------------------------------------------       11000002
110100* 3320-PROCESS-PROMO-TTL.                                         11010006
110200*     PROCESS THE PROMOTION TOTAL OF THE REPORT.                  11020002
110300*----------------------------------------------------------       11030002
110400 3320-PROCESS-PROMO-TTL.                                          11040006
110500                                                                  11050002
110600     MOVE SPACES               TO DETAIL-01                       11060004
110700                                  DETAIL-VARIABLE.                11070002
110800                                                                  11080002
110900     IF PS-DMA-RESULTS                                            11090006
110910        MOVE PC-TOTAL-DMM        TO PV-DMM-TOTAL-TITLE            11091017
110920        MOVE PV-LAST-DMA-LAST-NM TO PV-DMM-LAST-NAME              11092017
110930        MOVE PV-DMM-TITLE        TO DTL-01-NEW-TITLE              11093017
110940        MOVE 1                   TO PV-ADVANCE-LINES              11094017
111000     ELSE                                                         11100006
111300        MOVE PC-PROMO-TOTAL      TO DTL-01-NEW-TITLE              11130017
111310        MOVE 2                   TO PV-ADVANCE-LINES              11131017
111400     END-IF.                                                      11140006
111600                                                                  11160002
111700*** THIS IS PROCESSED ONLY FOR THE ACTUAL REPORTS.                11170002
111800     IF PM100-ACTUAL                                              11180002
112000        MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)                     11200054
112100                                   TO DTL-01-ACTL-SLS-RTL-AMT     11210054
112300                                                                  11230002
112400        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES              11240006
112500           CONTINUE                                               11250002
112600        ELSE                                                      11260002
112700           COMPUTE PV-VOL-PCT-CHG ROUNDED =                       11270053
112710                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             11271053
112800                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) /            11280053
112900                   TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * -100       11290053
113000                   ON SIZE ERROR                                  11300002
113100                   MOVE 0 TO PV-VOL-PCT-CHG                       11310002
113200           END-COMPUTE                                            11320002
113300           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11330002
113400           ADD PV-VOL-PCT-CHG      TO PV-ROUND-TO-TENTHS ROUNDED  11340002
113500           IF PV-VOL-PCT-CHG < 0                                  11350002
113600              PERFORM 9000-ADD-PARENTH-TO-NEG-PCT                 11360002
113700              MOVE PV-FINAL-VOL-PCT                               11370002
113800                                   TO DTL-01-VOL-PCT-CHG          11380004
113900           ELSE                                                   11390002
114000              MOVE PV-ROUND-TO-TENTHS                             11400002
114100                                   TO DTL-VAR-VOL-PCT-CHG         11410002
114200              MOVE DETAIL-VARIABLE TO DTL-01-VOL-PCT-CHG          11420004
114300           END-IF                                                 11430002
114700           MOVE PC-PERCENT-SIGN    TO DTL-01-VOL-PCT-SIGN         11470054
114900        END-IF                                                    11490002
115000                                                                  11500002
115100        COMPUTE PV-SELL-THRU-PCT ROUNDED =                        11510051
115200                (TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1) /            11520051
115300                (TBL-PMTOT-TOT-EOH-INV-QTY(PC-SUB-1) +            11530051
115400                 TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1))) * 100      11540051
115500                 ON SIZE ERROR                                    11550051
115600                 MOVE 0 TO PV-SELL-THRU-PCT                       11560051
115700        END-COMPUTE                                               11570051
115800        MOVE ZEROES                TO PV-ROUND-TO-TENTHS          11580002
115900        ADD PV-SELL-THRU-PCT       TO PV-ROUND-TO-TENTHS ROUNDED  11590002
116000        MOVE PV-ROUND-TO-TENTHS    TO DTL-01-SELL-THRU-PCT        11600004
116400        MOVE PC-PERCENT-SIGN       TO DTL-O1-SELL-PCT-SIGN        11640054
116600                                                                  11660002
116800        MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-1)                       11680054
116900                                   TO DTL-01-ACTL-MD-AMT          11690054
117200        MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-1)                  11720054
117300                                   TO DTL-01-ACTL-UNT-SLD-QTY     11730054
117600        MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-1)                     11760054
117700                                   TO DTL-01-ACTL-PREP-UNT-QTY    11770054
118120                                                                  11812002
118130        IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) = ZEROES              11813006
118141           MOVE ZEROES              TO PV-MU-PCT                  11814154
118142           MOVE PV-MU-PCT           TO DTL-01-ACTL-MU-PCT         11814254
118143           MOVE PC-PERCENT-SIGN     TO DTL-01-ACTL-PCT-SIGN       11814354
118150        ELSE                                                      11815002
118160           COMPUTE PV-MU-PCT ROUNDED =                            11816002
118170                   ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1) -           11817006
118180                    TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-1))/        11818006
118181                    TBL-PMTOT-TOT-SALE-AMT(PC-SUB-1)) * 100       11818106
118182                    ON SIZE ERROR                                 11818202
118183                    MOVE 0 TO PV-MU-PCT                           11818302
118184           END-COMPUTE                                            11818402
118185           MOVE ZEROES             TO PV-ROUND-TO-TENTHS          11818502
118186           ADD PV-MU-PCT           TO PV-ROUND-TO-TENTHS ROUNDED  11818602
118187           MOVE PV-ROUND-TO-TENTHS TO DTL-01-ACTL-MU-PCT          11818704
118191           MOVE PC-PERCENT-SIGN    TO DTL-01-ACTL-PCT-SIGN        11819154
118193        END-IF                                                    11819302
118194     END-IF.                                                      11819402
118195                                                                  11819502
118196*** THIS IS PROCESSED FOR FORECAST AND ACTUAL REPORTS.            11819602
118198     MOVE TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)                        11819854
118199                                   TO DTL-01-FCST-SLS-RTL-AMT.    11819954
118202     MOVE TBL-PMTOT-TOT-MD-AMT(PC-SUB-2)                          11820254
118203                                   TO DTL-01-FCST-MD-AMT.         11820354
118206     MOVE TBL-PMTOT-TOT-SLS-UNT-QTY(PC-SUB-2)                     11820654
118207                                   TO DTL-01-FCST-UNT-SLD-QTY.    11820754
118210     MOVE TBL-PMTOT-PREP-UNT-QTY(PC-SUB-2)                        11821054
118211                                   TO DTL-01-FCST-PREP-UNT-QTY.   11821154
118217                                                                  11821702
118218     IF TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) = ZEROES                 11821806
118219         CONTINUE                                                 11821902
118220     ELSE                                                         11822002
118221         COMPUTE PV-MU-PCT ROUNDED =                              11822102
118222                 ((TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2) -             11822206
118223                 TBL-PMTOT-TOT-SLS-COST-AMT(PC-SUB-2))/           11822306
118224                 TBL-PMTOT-TOT-SALE-AMT(PC-SUB-2)) * 100          11822406
118225                 ON SIZE ERROR                                    11822502
118226                 MOVE 0 TO PV-MU-PCT                              11822602
118227         END-COMPUTE                                              11822702
118228         MOVE ZEROES               TO PV-ROUND-TO-TENTHS          11822802
118229         ADD PV-MU-PCT             TO PV-ROUND-TO-TENTHS ROUNDED  11822902
118230         MOVE PV-ROUND-TO-TENTHS   TO DTL-01-FCST-MU-PCT          11823004
118234         MOVE PC-PERCENT-SIGN      TO DTL-01-FCST-PCT-SIGN        11823454
118236     END-IF.                                                      11823602
118237                                                                  11823702
118239     ADD PV-ADVANCE-LINES      TO PV-LINE-CNT.                    11823902
118240     PERFORM 3400-CHECK-MAX-LINE-CNT.                             11824006
118241     MOVE DETAIL-01            TO PV-RPT-LINE.                    11824106
118242     PERFORM 8300-WRITE-RPT-LINE.                                 11824207
118243                                                                  11824302
118244*3320-EXIT.                                                       11824406
118245 EJECT.                                                           11824502
118246                                                                  11824602
118247*----------------------------------------------------------       11824700
118248* 3400-CHECK-MAX-LINE-CNT.                                        11824806
118249*     CHECKS TO SEE IF IT HAS REACHED THE MAXIMUM AMOUNT          11824900
118250*     OF LINES FOR THE PAGE. WRITES OUT ALL HEADERS.              11825000
118251*----------------------------------------------------------       11825100
118252 3400-CHECK-MAX-LINE-CNT.                                         11825206
118253                                                                  11825300
118261     IF PV-LINE-CNT > PC-MAX-LINE-CNT                             11826102
118262         PERFORM 3500-PROCESS-PAGE-HEADER                         11826206
118267         MOVE 2                  TO PV-ADVANCE-LINES              11826710
118268         ADD PV-ADVANCE-LINES    TO PV-LINE-CNT                   11826810
118269     END-IF.                                                      11826902
118270                                                                  11827002
118271*3400-EXIT.                                                       11827106
118272 EJECT.                                                           11827200
118273                                                                  11827300
118358*----------------------------------------------------------       11835800
118359* 3500-PROCESS-PAGE-HEADER.                                       11835906
118360*     PROCESS REPORT PAGE HEADERS.                                11836000
118361*----------------------------------------------------------       11836100
118362 3500-PROCESS-PAGE-HEADER.                                        11836206
118363                                                                  11836300
118364     MOVE ZEROES                 TO PV-LINE-CNT.                  11836400
118365     ADD 1                       TO PV-PAGE-CNT.                  11836500
118366     MOVE PV-PAGE-CNT            TO DP200O-PAGE-NUMBER.           11836600
118367     MOVE 1                      TO DP200O-REPORT-NUMBER.         11836700
118368                                                                  11836800
118369     MOVE DP200O-STANDRD-HEADER-200-COLS                          11836900
118370                                 TO PV-RPT-LINE.                  11837000
118371     PERFORM 8200-WRITE-SLS-RPT-NEW-PAGE.                         11837101
118372                                                                  11837200
118373     MOVE HEADER-01              TO PV-RPT-LINE.                  11837300
118374     MOVE 2                      TO PV-ADVANCE-LINES.             11837400
118375     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11837500
118376     PERFORM 8300-WRITE-RPT-LINE.                                 11837601
118377                                                                  11837700
118378     MOVE HEADER-02              TO PV-RPT-LINE.                  11837800
118379     MOVE 1                      TO PV-ADVANCE-LINES.             11837900
118380     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11838000
118381     PERFORM 8300-WRITE-RPT-LINE.                                 11838101
118382                                                                  11838200
118383     MOVE HEADER-03              TO PV-RPT-LINE.                  11838300
118384     MOVE 1                      TO PV-ADVANCE-LINES.             11838400
118385     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11838500
118386     PERFORM 8300-WRITE-RPT-LINE.                                 11838601
118387                                                                  11838700
118393     MOVE HEADER-04              TO PV-RPT-LINE.                  11839300
118394     MOVE 2                      TO PV-ADVANCE-LINES.             11839400
118395     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11839500
118396     PERFORM 8300-WRITE-RPT-LINE                                  11839601
118397                                                                  11839700
118398     MOVE HEADER-05              TO PV-RPT-LINE.                  11839800
118399     MOVE 1                      TO PV-ADVANCE-LINES.             11839900
118400     ADD PV-ADVANCE-LINES        TO PV-LINE-CNT.                  11840000
118401     PERFORM 8300-WRITE-RPT-LINE.                                 11840101
118402                                                                  11840200
118404*3500-EXIT.                                                       11840406
118410 EJECT.                                                           11841000
118500                                                                  11850000
118696*----------------------------------------------------------       11869605
118697* 7000-COUNT-FIELD-LENGTH.                                        11869705
118698*     COUNTS THE ACTUAL FIELD'S LENGTH.                           11869805
118699*----------------------------------------------------------       11869905
118700 7000-COUNT-FIELD-LENGTH.                                         11870005
118701                                                                  11870105
118702     INITIALIZE PV-VARIABLE-OUTPUT-FIELD.                         11870205
118703     MOVE PV-SAVE-VAR    TO PV-VARIABLE-OUTPUT-FIELD.             11870305
118704                                                                  11870405
118705     MOVE PV-SAVE-NUM TO PV-SUBSCRIPT.                            11870505
118706                                                                  11870605
118707     PERFORM                                                      11870705
118708        VARYING PV-BIT-IDX FROM PV-SAVE-NUM BY -1                 11870805
118709        UNTIL PV-BIT-VARIABLE(PV-BIT-IDX) NOT = SPACES            11870905
118710               OR PV-BIT-IDX = 1                                  11871005
118711        SUBTRACT 1 FROM PV-SUBSCRIPT                              11871105
118712     END-PERFORM.                                                 11871205
118713                                                                  11871305
118714     MOVE PV-SUBSCRIPT TO PV-SAVE-LENGTH.                         11871405
118715                                                                  11871505
118716*7000-EXIT.                                                       11871605
118717 EJECT.                                                           11871705
118718                                                                  11871805
118719*----------------------------------------------------------       11871900
118720* 8000-READ-SLS-GMA-RESULTS.                                      11872002
118721*     READ SALES RESULTS INPUT RECORDS.                           11872100
118722*----------------------------------------------------------       11872200
118723 8000-READ-SLS-GMA-RESULTS.                                       11872302
118724                                                                  11872400
118725     READ PROMO-SUMM-GMA-FILE INTO PM100-PROMO-ITM-SUMM           11872502
118726          AT END                                                  11872600
118727             SET PS-EOF-SLS-GMA-RSLTS TO TRUE                     11872702
118728     END-READ.                                                    11872800
118729                                                                  11872900
118730*8000-EXIT.                                                       11873000
118731 EJECT.                                                           11873100
118732                                                                  11873200
118733*----------------------------------------------------------       11873301
118734* 8100-READ-SLS-DMA-RESULTS.                                      11873402
118735*     READ SALES RESULTS INPUT RECORDS.                           11873501
118736*----------------------------------------------------------       11873601
118737 8100-READ-SLS-DMA-RESULTS.                                       11873702
118738                                                                  11873801
118739     READ PROMO-SUMM-DMA-FILE INTO PM100-PROMO-ITM-SUMM           11873902
118740          AT END                                                  11874001
118741             SET PS-EOF-SLS-DMA-RSLTS TO TRUE                     11874102
118742     END-READ.                                                    11874201
118743                                                                  11874301
118744     MOVE PM100-PROMO-ITM-SUMM TO PV-SAVE-RECORD-2.               11874447
118745                                                                  11874547
118746*8100-EXIT.                                                       11874601
118747 EJECT.                                                           11874701
118748                                                                  11874801
118761*----------------------------------------------------------       11876100
118762* 8200-WRITE-SLS-RPT-NEW-PAGE.                                    11876201
118763*     WRITES NEW PAGE.                                            11876300
118764*----------------------------------------------------------       11876400
118765 8200-WRITE-SLS-RPT-NEW-PAGE.                                     11876501
118766                                                                  11876600
118767     WRITE PROMO-SUMM-RPT-LINE                                    11876707
118768           FROM PV-RPT-LINE                                       11876800
118769           AFTER ADVANCING PAGE.                                  11876900
118770                                                                  11877000
118771     ADD 2            TO PV-LINE-CNT.                             11877100
118772                                                                  11877200
118773*8200-EXIT.                                                       11877301
118774 EJECT.                                                           11877400
118775                                                                  11877500
118776*----------------------------------------------------------       11877600
118777* 8300-WRITE-RPT-LINE.                                            11877701
118778*     WRITES OUT A LINE ON THE REPORT.                            11877800
118779*----------------------------------------------------------       11877900
118780 8300-WRITE-RPT-LINE.                                             11878001
118781                                                                  11878100
118782     WRITE PROMO-SUMM-RPT-LINE                                    11878207
118783           FROM PV-RPT-LINE                                       11878300
118784           AFTER ADVANCING PV-ADVANCE-LINES.                      11878400
118785                                                                  11878500
118786*8300-EXIT.                                                       11878601
118787 EJECT.                                                           11878700
118788                                                                  11878800
118804*----------------------------------------------------------       11880403
118805* 9000-ADD-PARENTH-TO-NEG-PCT.                                    11880503
118806*     PUTS PARENTHESES AROUND A NEGATIVE PERCENT FOR THE          11880603
118807*     VOLUME PERCETN CHANGE FIELD.                                11880703
118808*----------------------------------------------------------       11880803
118809 9000-ADD-PARENTH-TO-NEG-PCT.                                     11880903
118810                                                                  11881003
118811     INITIALIZE PV-ROUND-VOL-PCT                                  11881103
118812                PV-TRUNCAT-VOL-PCT                                11881203
118813                PV-NUM-VOL-PCT                                    11881303
118814                PV-FINAL-VOL-PCT                                  11881403
118815                PV-SEP-VOL-PCT                                    11881503
118816                PA-CNT-SPACES.                                    11881603
118817                                                                  11881703
118818     MOVE PV-ROUND-TO-TENTHS      TO PV-ROUND-VOL-PCT.            11881803
118819     MOVE PV-ROUND-VOL-PCT        TO PV-TRUNCAT-VOL-PCT.          11881903
118820     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-NUM-VOL-PCT.              11882003
118821     MOVE PV-TRUNCAT-VOL-PCT-X    TO PV-SEP-VOL-PCT.              11882103
118822     INSPECT PV-CHAR-VOL-PCT-1 REPLACING                          11882203
118823             LEADING ZERO BY " ".                                 11882303
118824     INSPECT PV-CHAR-VOL-PCT-1                                    11882403
118825            TALLYING PA-CNT-SPACES FOR ALL " ".                   11882503
118826     EVALUATE TRUE                                                11882603
118827         WHEN PA-CNT-SPACES = 0                                   11882703
118828              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-1         11882803
118829              MOVE PV-SEP-VOL-PCT-1 TO PV-FINAL-VOL-PCT-2         11882903
118830              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         11883003
118831              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11883103
118832              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11883203
118833              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11883334
118834         WHEN PA-CNT-SPACES = 1                                   11883403
118835              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-2         11883503
118836              MOVE PV-SEP-VOL-PCT-2 TO PV-FINAL-VOL-PCT-3         11883603
118837              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11883703
118838              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11883803
118839              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11883934
118840         WHEN PA-CNT-SPACES = 2                                   11884003
118841              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-3         11884103
118842              MOVE PV-SEP-VOL-PCT-3 TO PV-FINAL-VOL-PCT-4         11884203
118843              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11884303
118844              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11884434
118845         WHEN PA-CNT-SPACES = 3                                   11884503
118846              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-4         11884603
118847              MOVE PV-SEP-VOL-PCT-4 TO PV-FINAL-VOL-PCT-5         11884703
118848              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11884834
118849         WHEN PA-CNT-SPACES = 4                                   11884934
118850              MOVE PC-FRONT-PAR     TO PV-FINAL-VOL-PCT-5         11885034
118851              MOVE PV-SEP-VOL-PCT-5 TO PV-FINAL-VOL-PCT-6         11885134
118852     END-EVALUATE.                                                11885203
118853     MOVE PC-BACK-PAR               TO PV-FINAL-VOL-PCT-7.        11885334
118854                                                                  11885403
118855                                                                  11885503
118856*9000-EXIT.                                                       11885603
118857 EJECT.                                                           11885703
118858                                                                  11885803
118859*----------------------------------------------------------       11885900
118860* 9100-CALENDAR-ROUTINE.                                          11886000
118861*     CALLS THE DATE ROUTINE WITH SPECIFIED PARAMETERS.           11886100
118862*----------------------------------------------------------       11886200
118863 9100-CALENDAR-ROUTINE.                                           11886300
118864                                                                  11886400
118865     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52          11886500
118866                                             DPG53 DPG54          11886600
118867                                             DPG55 DPG56.         11886700
118868     EVALUATE TRUE                                                11886800
118869         WHEN DPG54-NO-ERROR                                      11886900
118870             CONTINUE                                             11887000
118871         WHEN DPG54-WARNING-ERROR                                 11887100
118872             DISPLAY '** WARNING - PROGRAM '                      11887200
118873                      PC-CURRENT-PROGRAM-NAME ' **'               11887300
118874             DISPLAY '** 9100-CALENDAR-ROUTINE'                   11887400
118875             DISPLAY '** CALL TO DPKUT500 RETURNED WARNING ERROR' 11887500
118876             DISPLAY '** DPG54-ERROR-MESSAGE: '                   11887600
118877             DISPLAY '** ' DPG54-ERROR-MESSAGE                    11887700
118878             DISPLAY '** DPG51: ' DPG51                           11887800
118879             DISPLAY '** DPG52: ' DPG52                           11887900
118880             DISPLAY '** PLEASE INVESTIGATE FURTHER **'           11888000
118881         WHEN DPG54-SEVERE-ERROR                                  11888100
118882             DISPLAY '** ABEND - PROGRAM '                        11888200
118883                      PC-CURRENT-PROGRAM-NAME ' **'               11888300
118884             DISPLAY '** 9100-CALENDAR-ROUTINE'                   11888400
118885             DISPLAY '** CALL TO DPKUT500 RETURNED SEVERE ERROR'  11888500
118886             IF DPG54-CALENDAR-TYPE-INVALID                       11888600
118887                DISPLAY '** DPG54-CALENDAR-TYPE-INVALID'          11888700
118888                DISPLAY '** DPG51-CALENDAR-TYPE: '                11888800
118889                         DPG51-CALENDAR-TYPE                      11888900
118890             END-IF                                               11889000
118891             IF DPG54-DATE-INVALID                                11889100
118892                DISPLAY '** DPG54-DATE-INVALID'                   11889200
118900                DISPLAY '** DPG52-LK-DATE-INPUT: '                11890000
119000                         DPG52-LK-DATE-INPUT                      11900000
119100             END-IF                                               11910000
119200             IF DPG54-INCR-DECR-INVALID                           11920000
119300                DISPLAY '** DPG54-INCR-DECR-INVALID'              11930000
119400                DISPLAY '** DPG51-INCREMENT-DECREMENT-FLAG: '     11940000
119500                         DPG51-INCREMENT-DECREMENT-FLAG           11950000
119600             END-IF                                               11960000
119700             MOVE DPG54-ERROR-MESSAGE                             11970000
119800                                 TO PV-OPERATION-MSG-2            11980000
119900             SET ABEND-4019-DATE-ROUTINE-ERROR TO TRUE            11990000
120000             PERFORM 9800-ABEND                                   12000000
120100     END-EVALUATE.                                                12010000
120200                                                                  12020000
120300*9100-EXIT.                                                       12030000
120400 EJECT.                                                           12040000
120500                                                                  12050000
120600*----------------------------------------------------------       12060000
120700* 9800-ABEND.                                                     12070000
120800*     PERFORMS A NON-SQL-ABEND.                                   12080000
120900*----------------------------------------------------------       12090000
121000 9800-ABEND.                                                      12100000
121100                                                                  12110000
121200     DISPLAY '** ABEND           **'.                             12120000
121300     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  12130000
121400     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        12140000
121500     DISPLAY '** OPERATION       ** = ' PV-OPERATION-MSG-1.       12150000
121600     DISPLAY '**                 ** = ' PV-OPERATION-MSG-2.       12160000
121700                                                                  12170000
121800     CALL 'ILBOABN0' USING ABEND-CODE.                            12180000
