      ******************************************************************00010006
       IDENTIFICATION DIVISION.                                         00020006
      ******************************************************************00030006
                                                                        00040006
       PROGRAM-ID.             TFKUT496.                                00050006
       AUTHOR.                 WILLIAM B. BURT.                         00060006
       INSTALLATION.           KOHLS.                                   00070006
       DATE-WRITTEN            JUNE, 1997.                              00080006
       DATE-COMPILED.                                                   00090006
                                                                        00100006
      ******************************************************************00110006
      *  THIS PROGRAM PRODUCES A SUMMATED VERSION OF THE TRANSFER       00120006
      *  DISCREPANCY FILE, WHICH WILL BE USED AS INPUT TO CREATE THE    00130006
      *  TRANSFER DISCREPANCY REPORT.                                   00140006
      ******************************************************************00150006
      ******************************************************************00160006
      *  2/28/2003 - CHRIS ALBRIGHT                                     00161006
      *   PROCESS NONINTELLIGENT SKU.                                   00162006
      ******************************************************************00163006
111703* 11/17/2003 - RAY GRAF                                           00164014
111703*   SORT1/SORT2 TRANSFER TYPES.                                   00165015
      ******************************************************************00166014
100404** 10/04/2004 CHANGED BY: RAY GRAF                                00166116
100404**     EXPAND STORE NUMBER. MAKE DOMAIN COMPLIANT.                00166216
      ***************************************************************** 00166520
SR3403** 03/12/2012 CHANGED BY: JALAJ KUMAR                             00166620
SR3403**     CHANGED FILE LENGTH AS PART OF LARGE RETAIL ENHANCEMENTS.  00166720
      ***************************************************************** 00166820
                                                                        00167014
      ******************************************************************00170006
       ENVIRONMENT DIVISION.                                            00180006
      ******************************************************************00190006
                                                                        00200006
       CONFIGURATION SECTION.                                           00210006
                                                                        00220006
       SOURCE-COMPUTER.        IBM-3090.                                00230006
       OBJECT-COMPUTER.        IBM-3090.                                00240006
                                                                        00250006
       INPUT-OUTPUT SECTION.                                            00260006
                                                                        00270006
       FILE-CONTROL.                                                    00280006
                                                                        00290006
           SELECT XFER-DISCREPANCY-FILE                                 00300006
               ASSIGN TO INP01.                                         00310006
                                                                        00320006
           SELECT XFER-DISCREPANCY-RPT-FILE                             00330006
               ASSIGN TO OUT01.                                         00340006
                                                                        00350006
      ******************************************************************00360006
       DATA DIVISION.                                                   00370006
      ******************************************************************00380006
                                                                        00390006
       FILE SECTION.                                                    00400010
                                                                        00410010
       FD  XFER-DISCREPANCY-FILE                                        00420010
           RECORDING MODE IS F                                          00430010
           LABEL RECORDS ARE STANDARD                                   00440010
           BLOCK CONTAINS 0 RECORDS.                                    00450010
                                                                        00460010
SR3403 01  XFER-DISCREPANCY-RECORD             PIC  X(100).             00471020
                                                                        00480006
       FD  XFER-DISCREPANCY-RPT-FILE                                    00490006
           RECORDING MODE IS F                                          00500006
           LABEL RECORDS ARE STANDARD                                   00510006
           BLOCK CONTAINS 0 RECORDS.                                    00520006
                                                                        00530006
100404 01  XFER-DISCREPANCY-RPT-RECORD         PIC  X(43).              00540019
                                                                        00550006
      ******************************************************************00560006
       WORKING-STORAGE SECTION.                                         00570006
      ******************************************************************00580006
                                                                        00590006
      *                                                                 00600006
      *  RECORD LAYOUT FOR THE TRANSFER DISCREPANCY FILE                00610006
      *                                                                 00620006
           COPY TFRD030.                                                00630006
                                                                        00640006
      *                                                                 00650006
      *  RECORD LAYOUT FOR THE SUMMED TRANSFER DISCREPANCY FILE         00660006
      *                                                                 00670006
           COPY TFRD038.                                                00680006
                                                                        00690006
       01  CK-CURRENT-KEYS.                                             00700006
100404*    05  CK-XFER-NBR                     PIC  9(09)  VALUE ZEROS. 00710017
100404     05  CK-XFER-NBR                     PIC  9(11)  VALUE ZEROS. 00711017
           05  FILLER  REDEFINES  CK-XFER-NBR.                          00720006
100404*        10  CK-FROM-STR-NBR             PIC  9(03).              00730017
100404         10  CK-FROM-STR-NBR             PIC  9(05).              00731017
               10  CK-XFER-SEQ-NBR             PIC  9(06).              00740006
022803     05  CK-SKU                          PIC  9(08)  VALUE ZEROS. 00780007
                                                                        00790006
       01  PC-PROGRAM-CONSTANTS.                                        00800006
111703*    05  PC-DEFECTIVES-DAMAGES           PIC  X(02)  VALUE '01'.  00810014
111703     05  PC-DEFECTIVES-DAMAGES-SORT1     PIC  X(02)  VALUE '00'.  00811015
111703     05  PC-DEFECTIVES-DAMAGES-SORT2     PIC  X(02)  VALUE '01'.  00812015
           05  PC-CALLBACKS                    PIC  X(02)  VALUE '02'.  00820006
           05  PC-ONE                          PIC  9(01)  VALUE 1.     00830006
                                                                        00840006
       01  PS-PROGRAM-SWITCHES.                                         00850006
           05  PS-END-OF-XFER-DSCRP-FILE-IND   PIC  X(01)  VALUE 'N'.   00860006
               88  PS-END-OF-XFER-DSCRP-FILE               VALUE 'Y'.   00870006
                                                                        00880006
       01  PV-PROGRAM-VARIABLES.                                        00890006
022803     05  PV-SKU                          PIC  9(08)  VALUE ZEROS. 00930007
           05  PV-XFER-ITEM-QTY                PIC  9(04)  VALUE ZEROS. 00940006
           05  PV-RCVD-ITEM-QTY                PIC S9(04)  VALUE ZEROS. 00950006
           05  PV-TOT-UNIT-DSCRP               PIC  9(06)  VALUE ZEROS. 00960006
           05  PV-COMPLETE-XFER-EXT-RTL        PIC S9(07)V9(02)         00970006
                                                           VALUE ZEROS. 00980006
           05  PV-RECEIVE-XFER-EXT-RTL         PIC S9(07)V9(02)         00990006
                                                           VALUE ZEROS. 01000006
           05  PV-TOT-EXT-RTL                  PIC S9(08)V9(02)         01010006
                                                           VALUE ZEROS. 01020006
           05  PV-EXT-RTL                      PIC S9(08)V9(02)         01030006
                                                           VALUE ZEROS. 01040006
           05  PV-UNIT-DSCRP                   PIC S9(05)  VALUE ZEROS. 01050006
100404*    05  PV-XFER-NBR                     PIC  9(09)  VALUE ZEROS. 01060017
100404     05  PV-XFER-NBR                     PIC  9(11)  VALUE ZEROS. 01061017
           05  FILLER  REDEFINES  PV-XFER-NBR.                          01070006
100404*        10  PV-FROM-STR-NBR             PIC  9(03).              01080017
100404         10  PV-FROM-STR-NBR             PIC  9(05).              01081017
               10  PV-XFER-SEQ-NBR             PIC  9(06).              01090006
           05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACE. 01100006
           05  PV-CMPT-XFER-END-TMST           PIC  X(26)  VALUE SPACE. 01110006
           05  FILLER  REDEFINES  PV-CMPT-XFER-END-TMST.                01120006
               10 PV-CMPT-XFER-END-CENTURY     PIC  X(02).              01130006
               10 PV-CMPT-XFER-END-YEAR        PIC  X(02).              01140006
               10 FILLER                       PIC  X(01).              01150006
               10 PV-CMPT-XFER-END-MONTH       PIC  X(02).              01160006
               10 FILLER                       PIC  X(01).              01170006
               10 PV-CMPT-XFER-END-DAY         PIC  X(02).              01180006
               10 PV-CMPT-XFER-END-TIME        PIC  X(16).              01190006
           05  PV-XFER-STAT-TMST               PIC  X(26)  VALUE SPACE. 01200006
           05  FILLER  REDEFINES  PV-XFER-STAT-TMST.                    01210006
               10 PV-XFER-STAT-CENTURY         PIC  X(02).              01220006
               10 PV-XFER-STAT-YEAR            PIC  X(02).              01230006
               10 FILLER                       PIC  X(01).              01240006
               10 PV-XFER-STAT-MONTH           PIC  X(02).              01250006
               10 FILLER                       PIC  X(01).              01260006
               10 PV-XFER-STAT-DAY             PIC  X(02).              01270006
               10 PV-XFER-STAT-TIME            PIC  X(16).              01280006
                                                                        01290006
      ******************************************************************01300006
       PROCEDURE DIVISION.                                              01310006
      ******************************************************************01320006
                                                                        01330006
      ******************************************************************01340006
      *  0000-MAINLINE - CONTROLS THE MAIN PROCESSING OF THE PROGRAM    01350006
      ******************************************************************01360006
       0000-PROGRAM-MAINLINE.                                           01370006
           PERFORM 1000-INITIALIZE.                                     01380006
                                                                        01390006
           PERFORM 2000-CREATE-DISCRP-RPT-FILE.                         01400006
                                                                        01410006
           PERFORM 9000-EOJ-ROUTINE.                                    01420006
                                                                        01430006
           STOP RUN.                                                    01440006
      *                                                                 01450006
       1000-INITIALIZE.                                                 01460006
           OPEN  INPUT XFER-DISCREPANCY-FILE                            01470006
                OUTPUT XFER-DISCREPANCY-RPT-FILE.                       01480006
                                                                        01490006
           PERFORM 7000-READ-XFER-DISCRP-FILE.                          01500006
                                                                        01510006
           INITIALIZE TF038-XFER-DSCRP-RPT-RECORD.                      01520006
      *                                                                 01530006
       2000-CREATE-DISCRP-RPT-FILE.                                     01540006
           MOVE TF030-FROM-STR-NBR  TO  CK-FROM-STR-NBR                 01550006
                                        PV-FROM-STR-NBR                 01560006
                                        TF038-FROM-STR-NBR.             01570006
           MOVE TF030-XFER-SEQ-NBR  TO  CK-XFER-SEQ-NBR                 01580006
                                        PV-XFER-SEQ-NBR                 01590006
                                        TF038-XFER-SEQ-NBR.             01600006
                                                                        01610006
           PERFORM 2020-FILL-DSCRP-RPT-RECORD                           01620006
               UNTIL PS-END-OF-XFER-DSCRP-FILE.                         01630006
      *                                                                 01640006
       2020-FILL-DSCRP-RPT-RECORD.                                      01650006
           MOVE TF030-COMPLETED-CENTURY  TO  TF038-COMPLETED-CENTURY.   01660006
           MOVE TF030-COMPLETED-YEAR     TO  TF038-COMPLETED-YEAR.      01670006
           MOVE TF030-COMPLETED-MONTH    TO  TF038-COMPLETED-MONTH.     01680006
           MOVE TF030-COMPLETED-DAY      TO  TF038-COMPLETED-DAY.       01690006
           MOVE TF030-RECEIVED-CENTURY   TO  TF038-RECEIVED-CENTURY.    01700006
           MOVE TF030-RECEIVED-YEAR      TO  TF038-RECEIVED-YEAR.       01710006
           MOVE TF030-RECEIVED-MONTH     TO  TF038-RECEIVED-MONTH.      01720006
           MOVE TF030-RECEIVED-DAY       TO  TF038-RECEIVED-DAY.        01730006
                                                                        01740006
           PERFORM 2025-PROCESS-XFER-DSCRP-ITEM                         01750006
               UNTIL  (PS-END-OF-XFER-DSCRP-FILE                        01760006
                  OR   PV-XFER-NBR  NOT =  CK-XFER-NBR).                01770006
                                                                        01780006
           PERFORM 3000-CONTROL-BREAK.                                  01790006
      *                                                                 01800006
       2025-PROCESS-XFER-DSCRP-ITEM.                                    01810006
022803     MOVE TF030-SKU           TO  PV-SKU                          01871007
022803                                  CK-SKU.                         01872007
                                                                        01880006
           PERFORM 2030-CALC-TOT-DSCRP-UNTS-RTL                         01890006
               UNTIL  ((PS-END-OF-XFER-DSCRP-FILE)                      01900006
                  OR   (PV-XFER-NBR      NOT =  CK-XFER-NBR)            01910006
022803            OR   (PV-SKU           NOT =  CK-SKU)).               01920007
                                                                        01930006
           COMPUTE PV-UNIT-DSCRP  =                                     01940006
               (PV-XFER-ITEM-QTY  -  PV-RCVD-ITEM-QTY).                 01950006
                                                                        01960006
           IF PV-UNIT-DSCRP NEGATIVE                                    01970006
               COMPUTE PV-UNIT-DSCRP  =                                 01980006
                   (PV-UNIT-DSCRP  *  -1)                               01990006
           END-IF.                                                      02000006
                                                                        02010006
           COMPUTE PV-TOT-UNIT-DSCRP  =                                 02020006
               (PV-TOT-UNIT-DSCRP  +  PV-UNIT-DSCRP).                   02030006
                                                                        02040006
           COMPUTE PV-TOT-EXT-RTL  =                                    02050006
               (PV-TOT-EXT-RTL  +  PV-EXT-RTL).                         02060006
                                                                        02070006
           INITIALIZE PV-RCVD-ITEM-QTY                                  02080006
                      PV-XFER-ITEM-QTY                                  02090006
                      PV-EXT-RTL.                                       02100006
      *                                                                 02110006
       2030-CALC-TOT-DSCRP-UNTS-RTL.                                    02120006
           IF TF030-XFER-LNE-SEQ-NBR  =  PC-ONE                         02130006
111703*        IF (TF030-XFER-TYP-CDE  =  PC-DEFECTIVES-DAMAGES         02140014
111703         IF (TF030-XFER-TYP-CDE  =  PC-DEFECTIVES-DAMAGES-SORT1   02141015
111703                      OR                                          02142014
111703             TF030-XFER-TYP-CDE  =  PC-DEFECTIVES-DAMAGES-SORT2   02142115
                            OR                                          02150006
                   TF030-XFER-TYP-CDE  =  PC-CALLBACKS)                 02160006
                   COMPUTE PV-XFER-ITEM-QTY  =                          02170006
                       (PV-XFER-ITEM-QTY  +  TF030-XFER-QTY)            02180006
               ELSE                                                     02190006
                   MOVE TF030-XFER-QTY  TO  PV-XFER-ITEM-QTY            02200006
               END-IF                                                   02210006
               COMPUTE PV-COMPLETE-XFER-EXT-RTL  =                      02220006
                   (TF030-XFER-QTY  *  TF030-XFER-PRICE)                02230006
           END-IF.                                                      02240006
                                                                        02250006
           COMPUTE PV-RECEIVE-XFER-EXT-RTL  =                           02260006
               (TF030-RCVD-QTY  *  TF030-RCVD-PRICE).                   02270006
                                                                        02280006
           IF TF030-XFER-LNE-SEQ-NBR  =  PC-ONE                         02290006
111703*        IF (TF030-XFER-TYP-CDE  =  PC-DEFECTIVES-DAMAGES         02300014
111703         IF (TF030-XFER-TYP-CDE  =  PC-DEFECTIVES-DAMAGES-SORT1   02301015
111703                      OR                                          02302014
111703             TF030-XFER-TYP-CDE  =  PC-DEFECTIVES-DAMAGES-SORT2   02303015
                            OR                                          02310006
                   TF030-XFER-TYP-CDE  =  PC-CALLBACKS)                 02320006
                 COMPUTE PV-EXT-RTL  =  (PV-EXT-RTL  +                  02330006
                   (PV-COMPLETE-XFER-EXT-RTL - PV-RECEIVE-XFER-EXT-RTL))02340006
               ELSE                                                     02350006
                 COMPUTE PV-EXT-RTL  =                                  02360006
                   (PV-COMPLETE-XFER-EXT-RTL - PV-RECEIVE-XFER-EXT-RTL) 02370006
               END-IF                                                   02380006
           ELSE                                                         02390006
               COMPUTE PV-EXT-RTL  =                                    02400006
                   (PV-EXT-RTL  -  PV-RECEIVE-XFER-EXT-RTL)             02410006
           END-IF.                                                      02420006
                                                                        02430006
           COMPUTE PV-RCVD-ITEM-QTY  =                                  02440006
               (PV-RCVD-ITEM-QTY  +  TF030-RCVD-QTY).                   02450006
                                                                        02460006
           PERFORM 7000-READ-XFER-DISCRP-FILE.                          02470006
                                                                        02480006
           MOVE TF030-FROM-STR-NBR  TO  PV-FROM-STR-NBR.                02490006
           MOVE TF030-XFER-SEQ-NBR  TO  PV-XFER-SEQ-NBR.                02500006
022803     MOVE TF030-SKU           TO  PV-SKU.                         02531007
      *                                                                 02540006
       3000-CONTROL-BREAK.                                              02550006
           MOVE PV-TOT-UNIT-DSCRP   TO  TF038-ADJ-UNITS.                02560006
           MOVE PV-TOT-EXT-RTL      TO  TF038-ADJ-RTL.                  02570006
                                                                        02580006
           PERFORM 8000-WRITE-SUMMED-DSCRP-FILE.                        02590006
                                                                        02600006
           INITIALIZE PV-TOT-UNIT-DSCRP                                 02610006
                      PV-TOT-EXT-RTL.                                   02620006
                                                                        02630006
           MOVE PV-FROM-STR-NBR  TO  CK-FROM-STR-NBR                    02640006
                                     TF038-FROM-STR-NBR.                02650006
           MOVE PV-XFER-SEQ-NBR  TO  CK-XFER-SEQ-NBR                    02660006
                                     TF038-XFER-SEQ-NBR.                02670006
      *                                                                 02680006
       7000-READ-XFER-DISCRP-FILE.                                      02690006
           READ XFER-DISCREPANCY-FILE                                   02700006
               INTO TF030-XFER-DSCRP-RECORD                             02710006
                   AT END                                               02720006
                       SET PS-END-OF-XFER-DSCRP-FILE  TO  TRUE          02730006
           END-READ.                                                    02740006
      *                                                                 02750006
       8000-WRITE-SUMMED-DSCRP-FILE.                                    02760006
           WRITE XFER-DISCREPANCY-RPT-RECORD                            02770006
               FROM TF038-XFER-DSCRP-RPT-RECORD                         02780006
           END-WRITE.                                                   02790006
      *                                                                 02800006
       9000-EOJ-ROUTINE.                                                02810006
           CLOSE XFER-DISCREPANCY-FILE                                  02820006
                 XFER-DISCREPANCY-RPT-FILE.                             02830006
      *                                                                 02840006
