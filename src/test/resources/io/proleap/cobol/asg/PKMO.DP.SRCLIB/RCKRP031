000100*-----------------------*                                         00010005
000200 IDENTIFICATION DIVISION.                                         00020001
000300*-----------------------*                                         00030005
000400 PROGRAM-ID.    RCKRP031.                                         00040005
000500 AUTHOR.        JOE LAROSA.                                       00050005
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060005
000700 DATE-WRITTEN.  MAY, 2000.                                        00070005
000800 DATE-COMPILED.                                                   00080001
000900***************************************************************** 00090001
001000*  THIS BATCH PROGRAM CREATES THE 'EXPECTED CARTON COUNT AND    * 00100001
001100*  CARTON CONTENT QUANTITY VARIANCE' REPORT.                    * 00110001
001200*                                                               * 00120001
001300*  INPUT FILE CREATED FROM PROGRAM RCKUT108 (FORMAT RCRD053).   * 00130001
001400*                                                               * 00140005
001500***************************************************************** 00150001
001300* CHANGE HISTORY:                                                *00151030
001300*    CHANGES                                                     *00152030
001300*     MADE BY: VENKATSUBBU (COGNIZANT)                           *00153030
001300*     DATE:    10/23/2014                                        *00154030
001300*                                                                *00155030
001300*      CHANGES THRU OUT THE PROGRAM TO INCREASE THE SIZE OF PO#  *00156030
001300*      FROM 7 DIGITS TO 8 DIGITS. TAGGED WITH *TV 10/23/2014     *00157030
001100******************************************************************00158030
001600 ENVIRONMENT DIVISION.                                            00160001
001700 CONFIGURATION SECTION.                                           00170001
001800                                                                  00180001
001900 SOURCE-COMPUTER.        IBM-3090.                                00190001
002000 OBJECT-COMPUTER.        IBM-3090.                                00200001
002100                                                                  00210001
002200***************************************************************** 00220001
002300 INPUT-OUTPUT SECTION.                                            00230001
002400 FILE-CONTROL.                                                    00240001
002500                                                                  00250001
002600     SELECT INPUT-EXTRACT-FILE                                    00260001
002700         ASSIGN TO INP01.                                         00270001
002800                                                                  00280001
002900     SELECT OUTPUT-REPORT                                         00290001
003000         ASSIGN TO RPT01.                                         00300001
003100                                                                  00310001
003200***************************************************************** 00320001
003300 DATA DIVISION.                                                   00330001
003400***************************************************************** 00340001
003500 FILE SECTION.                                                    00350001
003600                                                                  00360001
003700 FD  INPUT-EXTRACT-FILE                                           00370001
003800     LABEL RECORDS ARE STANDARD                                   00380001
003900     RECORDING MODE IS F                                          00390001
004000     BLOCK CONTAINS 0 RECORDS                                     00400001
004100     RECORD CONTAINS 300 CHARACTERS.                              00410017
004200 01  EXTRACT-REC                     PIC X(300).                  00420017
004300                                                                  00430001
004400 FD  OUTPUT-REPORT                                                00440001
004500     RECORDING MODE IS F                                          00450001
004600     BLOCK CONTAINS 0  RECORDS.                                   00460001
004700 01  OUTPUT-REC                      PIC X(132).                  00470001
004800                                                                  00480001
004900***************************************************************** 00490001
005000 WORKING-STORAGE SECTION.                                         00500001
005100                                                                  00510001
005200 01  PROGRAM-SWITCHES.                                            00520001
005300     05  PS-END-OF-INPUT-FILE-SW     PIC X(01) VALUE 'N'.         00530001
005400         88  PS-END-OF-INPUT                   VALUE 'Y'.         00540001
005500         88  PS-NOT-END-OF-INPUT               VALUE 'N'.         00550001
005600     05  PS-ASN-WRITTEN-SW           PIC X(01) VALUE 'N'.         00560004
005700         88  PS-ASN-WRITTEN-YES                VALUE 'Y'.         00570004
005800         88  PS-ASN-WRITTEN-NO                 VALUE 'N'.         00580004
005900     05  PS-FIRST-TIME-SW            PIC X(01) VALUE 'N'.         00590006
006000         88  PS-FIRST-TIME-YES                 VALUE 'Y'.         00600006
006100         88  PS-FIRST-TIME-NO                  VALUE 'N'.         00610006
006200     05  PS-PAGE-SW                  PIC X(01) VALUE 'N'.         00620006
006300         88  PS-NEW-PAGE                       VALUE 'Y'.         00630006
006400         88  PS-SAME-PAGE                      VALUE 'N'.         00640006
006500     05  PS-END-OF-TABLE-SW          PIC X(01) VALUE 'N'.         00650018
006600         88  PS-END-OF-TABLE                   VALUE 'Y'.         00660018
006700         88  PS-NOT-END-OF-TABLE               VALUE 'N'.         00670018
006800     05  PS-PRT-QTY-ERRS-SW          PIC X(01) VALUE 'N'.         00680020
006900         88  PS-PRT-QTY-ERRS-YES               VALUE 'Y'.         00690020
007000         88  PS-PRT-QTY-ERRS-NO                VALUE 'N'.         00700020
007100                                                                  00710001
007200 01  PC-PROGRAM-CONSTANTS.                                        00720001
007300     05  PC-RCKRP031                 PIC X(08) VALUE              00730001
007400                                               'RCKRP031'.        00740001
007500     05  PC-REPORT-NBR               PIC X(02) VALUE '-1'.        00750001
007600     05  PC-REPORT-NBR-2             PIC X(02) VALUE '-2'.        00760022
007700     05  PC-MAX-LINE-COUNT           PIC S9(3) VALUE +65          00770001
007800                                               COMP-3.            00780001
007900     05  PC-DEFAULT-CC-DATE          PIC X(10) VALUE '9999-09-09'.00790001
008000     05  PC-SYSTEM-DATE              PIC 9(06) VALUE ZERO.        00800001
008100                                                                  00810001
008200 01  PV-PROGRAM-VARIABLES.                                        00820001
008300     05  PV-PARAGRAPH-NAME           PIC X(30) VALUE SPACE.       00830001
008400     05  PV-SQLCODE                  PIC 9(09) VALUE ZERO.        00840001
008500     05  PV-PAGE-COUNT               PIC S9(4) VALUE ZERO         00850001
008600                                               COMP-3.            00860001
008700     05  PV-LINE-COUNT               PIC S9(3) VALUE ZERO         00870001
008800                                               COMP-3.            00880001
008900     05  PV-REC-IN-QTY               PIC 9(07) VALUE ZEROES.      00890020
009000     05  PV-REC-OUT-QTY              PIC 9(07) VALUE ZEROES.      00900020
009100     05  PV-SUM-OUT-QTY              PIC 9(07) VALUE ZEROES.      00910020
009200     05  PV-TOT-VEND-NBR             PIC 9(03) VALUE ZEROES.      00920024
009300     05  PV-TOT-VEND-QTY             PIC 9(09) VALUE ZEROES.      00930024
009400     05  PV-TOT-VEND-ERR             PIC 9(09) VALUE ZEROES.      00940020
009500     05  PV-TOT-ITEM-ERR             PIC 9(09) VALUE ZEROES.      00950024
009600     05  PV-PERCENT                  PIC 9(06)V9999.              00960020
009800*TV 10/23/2014 CHANGE STARTS                                      00960136
009600     05  PV-DL1-PO-NBR-8             PIC 9(08) VALUE ZEROES.      00961033
009800*TV 10/23/2014 CHANGE ENDS                                        00962036
009700     05  PV-FIELDS.                                               00970001
009800         10  PV-CURR-VEND-NAME       PIC X(25) VALUE SPACES.      00980004
009800*TV 10/23/2014 CHANGE STARTS                                      00981030
009900         10  PV-CURR-PO-NBR          PIC 9(08) VALUE ZEROES.      00990030
009800*TV 10/23/2014 CHANGE ENDS                                        00991030
010000         10  PV-CURR-ASN-NBR         PIC X(30) VALUE ALL '?'.     01000012
010100         10  PV-CURR-BOL-NBR         PIC X(30) VALUE ALL '?'.     01010012
010200         10  PV-LAST-BOL-NBR         PIC X(30) VALUE SPACES.      01020009
010300         10  PV-CURR-SCAC            PIC X(04) VALUE SPACES.      01030011
010400         10  PV-CURR-DC              PIC 9(04) VALUE ZEROES.      01040011
010500         10  PV-CURR-EDI-NBR         PIC 9(09) VALUE 999999999.   01050015
010600                                                                  01060001
010700     05  PV-FORMAT-DC.                                            01070004
010900         10  PV-FORMAT-DC-L4         PIC Z999.                    01090029
011000     05  PV-FORMAT-STR.                                           01100004
011200         10  PV-FORMAT-STR-L4        PIC Z999.                    01120029
011300     05  PV-FORMAT-LINE.                                          01130004
011400         10  PV-FORMAT-LINE-F1       PIC 9.                       01140004
011500         10  PV-FORMAT-LINE-L4       PIC 9999.                    01150004
011600     05  PV-FORMAT-COUNT             PIC ZZZZ9.                   01160004
011700     05  PV-CURRENT-DB2-DATE         PIC X(10).                   01170026
011800     05  PV-RPT-DATE.                                             01180026
011900         10  PV-RPT-DB2-CCYY.                                     01190026
012000             15  PV-RPT-DB2-CC       PIC 9(02) VALUE ZEROES.      01200026
012100             15  PV-RPT-DB2-YY       PIC 9(02) VALUE ZEROES.      01210026
012200         10  FILLER                  PIC X(01) VALUE '-'.         01220026
012300         10  PV-RPT-DB2-MM           PIC 9(02) VALUE ZEROES.      01230026
012400         10  FILLER                  PIC X(01) VALUE '-'.         01240026
012500         10  PV-RPT-DB2-DD           PIC 9(02) VALUE ZEROES.      01250026
012700                                                                  01270001
012800     05  PV-TODAYS-DATE.                                          01280001
012900         10  PV-TODAYS-DATE-YY       PIC 9(02) VALUE ZERO.        01290001
013000         10  PV-TODAYS-DATE-MM       PIC 9(02) VALUE ZERO.        01300001
013100         10  PV-TODAYS-DATE-DD       PIC 9(02) VALUE ZERO.        01310001
013200     05  PV-TODAYS-DATE-YYYY.                                     01320001
013300         10  PV-TODAYS-DATE-CC       PIC 9(02) VALUE 20.          01330001
013400         10  PV-TODAYS-DATE-Y2       PIC 9(02) VALUE ZERO.        01340001
013500                                                                  01350001
013600     05  PV-TODAYS-TIME.                                          01360001
013700         10  PV-TODAYS-TIME-HH       PIC 9(02) VALUE ZERO.        01370001
013800         10  PV-TODAYS-TIME-MM       PIC 9(02) VALUE ZERO.        01380001
013900         10  PV-TODAYS-TIME-SS       PIC 9(02) VALUE ZERO.        01390001
014000         10  FILLER                  PIC 9(02) VALUE ZERO.        01400001
014100                                                                  01410001
014200 01  VENDOR-SUMMARY-TABLE.                                        01420018
014300     05  SUMMARY-TABLE  OCCURS 900 TIMES INDEXED BY VS-IDX.       01430024
014400         10  SUMMARY-VEND-NAME       PIC X(25).                   01440018
014500         10  SUMMARY-VEND-COUNT      PIC S9(7) COMP-3.            01450018
014600         10  SUMMARY-VEND-ERRS       PIC S9(5) COMP-3.            01460018
014700         10  SUMMARY-ITEM-ERRS       PIC S9(5) COMP-3.            01470024
014800                                                                  01480018
014900 01  PV-ABEND-FIELDS.                                             01490026
015000     05  PV-ABEND-CODE               PIC S9(4) VALUE +0 COMP SYNC.01500026
015100     05  PV-ABEND-PROGRAM            PIC X(08) VALUE 'RCKRP031'.  01510026
015200     05  PV-ABEND-PARAGRAPH          PIC X(50) VALUE SPACES.      01520026
015300     05  PV-ABEND-OPERATION          PIC X(50) VALUE SPACES.      01530026
015400     05  PV-ABEND-STRUCTURE-1        PIC X(08) VALUE SPACES.      01540026
015500     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79) VALUE SPACES.      01550026
015600     05  PV-DB2-TABLE-NAME           PIC X(08) VALUE SPACES.      01560026
015700                                                                  01570026
015800******************************************************************01580001
015900*  RECORD LAYOUT FOR INPUT FILE                                   01590001
016000******************************************************************01600001
016100     COPY RCRD053.                                                01610001
016200                                                                  01620001
016300******************************************************************01630026
016400*  ABEND ROUTINE WORKING STORAGE                                  01640026
016500******************************************************************01650026
016600     COPY DPWS004.                                                01660026
016700                                                                  01670026
016800******************************************************************01680026
016900*  DCLGEN - COMPANY CONTROL TABLE                                 01690026
017000******************************************************************01700026
017100     EXEC SQL                                                     01710026
017200         INCLUDE TCOCNTL                                          01720026
017300     END-EXEC.                                                    01730026
017400                                                                  01740026
017500******************************************************************01750026
017600*  DB2 COMMUNICATION AREA                                         01760026
017700******************************************************************01770026
017800     EXEC SQL                                                     01780026
017900         INCLUDE SQLCA                                            01790026
018000     END-EXEC.                                                    01800026
018100                                                                  01810026
018200******************************************************************01820001
018300*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               01830001
018400******************************************************************01840001
018500     COPY DPWS132.                                                01850001
018600                                                                  01860001
018700 01  HEADING-LINES.                                               01870001
018800     05  HEADING-LINE-1.                                          01880001
018900         10  FILLER                  PIC X(29) VALUE SPACES.      01890026
019000         10  FILLER                  PIC X(49) VALUE              01900001
019100             'EXPECTED CARTON COUNT AND CARTON CONTENT QUANTITY'. 01910001
019200         10  FILLER                  PIC X(14) VALUE              01920026
019300                                     ' VARIANCE FOR '.            01930026
019400         10  HL1-RPT1-MM             PIC X(02) VALUE SPACES.      01940026
019500         10  HL1-RPT1-S1             PIC X(01) VALUE SPACES.      01950026
019600         10  HL1-RPT1-DD             PIC X(02) VALUE SPACES.      01960026
019700         10  HL1-RPT1-S2             PIC X(01) VALUE SPACES.      01970026
019800         10  HL1-RPT1-CC             PIC X(02) VALUE SPACES.      01980026
019900         10  HL1-RPT1-YY             PIC X(02) VALUE SPACES.      01990026
020000         10  FILLER                  PIC X(30) VALUE SPACES.      02000026
020100                                                                  02010001
020200     05  HEADING-LINE-2.                                          02020007
020300         10  FILLER                  PIC X(01) VALUE SPACES.      02030007
020400         10  FILLER                  PIC X(25) VALUE SPACES.      02040007
020500         10  FILLER                  PIC X(03) VALUE SPACES.      02050007
020600         10  FILLER                  PIC X(07) VALUE SPACES.      02060007
020700         10  FILLER                  PIC X(03) VALUE SPACES.      02070007
020800         10  FILLER                  PIC X(30) VALUE SPACES.      02080007
020900         10  FILLER                  PIC X(03) VALUE SPACES.      02090007
021000         10  FILLER                  PIC X(04) VALUE SPACES.      02100007
021100         10  FILLER                  PIC X(03) VALUE SPACES.      02110007
021200         10  FILLER                  PIC X(03) VALUE SPACES.      02120007
021300         10  FILLER                  PIC X(02) VALUE SPACES.      02130007
021400         10  FILLER                  PIC X(04) VALUE SPACES.      02140007
021500         10  FILLER                  PIC X(04) VALUE SPACES.      02150011
021600         10  FILLER                  PIC X(06) VALUE 'EXPECT'.    02160007
021700         10  FILLER                  PIC X(01) VALUE SPACES.      02170011
021800         10  FILLER                  PIC X(06) VALUE SPACES.      02180007
021900         10  FILLER                  PIC X(04) VALUE SPACES.      02190007
022000         10  FILLER                  PIC X(04) VALUE SPACES.      02200007
022100         10  FILLER                  PIC X(03) VALUE SPACES.      02210007
022200         10  FILLER                  PIC X(07) VALUE 'PKSLIP '.   02220007
022300         10  FILLER                  PIC X(01) VALUE SPACES.      02230011
022400         10  FILLER                  PIC X(07) VALUE ' DWNLD '.   02240007
022500                                                                  02250007
022600     05  HEADING-LINE-3.                                          02260007
022700         10  FILLER                  PIC X(01) VALUE SPACES.      02270004
022800         10  FILLER                  PIC X(25) VALUE SPACES.      02280004
022900         10  FILLER                  PIC X(01) VALUE SPACES.      02290011
023000         10  FILLER                  PIC X(07) VALUE SPACES.      02300004
023100         10  FILLER                  PIC X(01) VALUE SPACES.      02310011
023200         10  FILLER                  PIC X(09) VALUE SPACES.      02320011
023300         10  FILLER                  PIC X(01) VALUE SPACES.      02330011
023400         10  FILLER                  PIC X(30) VALUE SPACES.      02340011
023500         10  FILLER                  PIC X(01) VALUE SPACES.      02350011
023600         10  FILLER                  PIC X(04) VALUE SPACES.      02360004
023700         10  FILLER                  PIC X(02) VALUE SPACES.      02370011
023800         10  FILLER                  PIC X(03) VALUE SPACES.      02380011
023900         10  FILLER                  PIC X(02) VALUE SPACES.      02390004
024000         10  FILLER                  PIC X(04) VALUE SPACES.      02400011
024100         10  FILLER                  PIC X(01) VALUE SPACES.      02410011
024200         10  FILLER                  PIC X(06) VALUE 'PKSLIP'.    02420004
024300         10  FILLER                  PIC X(02) VALUE SPACES.      02430011
024400         10  FILLER                  PIC X(06) VALUE ' DWNLD'.    02440004
024500         10  FILLER                  PIC X(03) VALUE SPACES.      02450011
024600         10  FILLER                  PIC X(04) VALUE SPACES.      02460004
024700         10  FILLER                  PIC X(03) VALUE SPACES.      02470004
024800         10  FILLER                  PIC X(07) VALUE 'CARTON '.   02480004
024900         10  FILLER                  PIC X(02) VALUE SPACES.      02490011
025000         10  FILLER                  PIC X(07) VALUE 'CARTON '.   02500004
025100                                                                  02510001
025200     05  HEADING-LINE-4.                                          02520001
025300         10  FILLER                  PIC X(01) VALUE SPACES.      02530004
025400         10  FILLER                  PIC X(25) VALUE              02540004
025500             '                         '.                         02550004
025600         10  FILLER                  PIC X(01) VALUE SPACES.      02560011
025700         10  FILLER                  PIC X(07) VALUE '   PO  '.   02570004
009800*TV 10/23/2014 CHANGE STARTS                                      02571036
025800         10  FILLER                  PIC X(12) VALUE SPACES.      02580034
009800*TV 10/23/2014 CHANGE ENDS                                        02581036
025900         10  FILLER                  PIC X(30) VALUE              02590034
026000             'ASN NUMBER                    '.                    02600026
026100         10  FILLER                  PIC X(01) VALUE SPACES.      02610011
026200         10  FILLER                  PIC X(04) VALUE '    '.      02620011
026300         10  FILLER                  PIC X(01) VALUE SPACES.      02630011
026400         10  FILLER                  PIC X(03) VALUE '   '.       02640004
026500         10  FILLER                  PIC X(02) VALUE SPACES.      02650011
026600         10  FILLER                  PIC X(04) VALUE 'DEST'.      02660004
009800*TV 10/23/2014 CHANGE STARTS                                      02661036
026700         10  FILLER                  PIC X(01) VALUE SPACES.      02670034
009800*TV 10/23/2014 CHANGE ENDS                                        02671036
026800         10  FILLER                  PIC X(06) VALUE 'CARTON'.    02680004
026900         10  FILLER                  PIC X(02) VALUE SPACES.      02690011
027000         10  FILLER                  PIC X(06) VALUE 'CARTON'.    02700004
027100         10  FILLER                  PIC X(03) VALUE SPACES.      02710011
027200         10  FILLER                  PIC X(04) VALUE 'LINE'.      02720004
027300         10  FILLER                  PIC X(02) VALUE SPACES.      02730011
027400         10  FILLER                  PIC X(07) VALUE 'CONTENT'.   02740004
027500         10  FILLER                  PIC X(02) VALUE SPACES.      02750004
027600         10  FILLER                  PIC X(07) VALUE 'CONTENT'.   02760004
027700                                                                  02770001
027800     05  HEADING-LINE-5.                                          02780001
027900         10  FILLER                  PIC X(01) VALUE SPACES.      02790004
028000         10  FILLER                  PIC X(25) VALUE              02800004
028100             '       VENDOR NAME       '.                         02810004
028200         10  FILLER                  PIC X(01) VALUE SPACES.      02820010
028300         10  FILLER                  PIC X(07) VALUE ' NUMBER'.   02830004
028400         10  FILLER                  PIC X(01) VALUE SPACES.      02840010
028500         10  FILLER                  PIC X(09) VALUE              02850035
028600                                               ' ISA NBR '.       02860035
009800*TV 10/23/2014 CHANGE STARTS                                      02861036
028700         10  FILLER                  PIC X(02) VALUE SPACES.      02870035
009800*TV 10/23/2014 CHANGE ENDS                                        02871036
028800         10  FILLER                  PIC X(30) VALUE              02880004
028900             'BOL NUMBER                    '.                    02890026
029000         10  FILLER                  PIC X(01) VALUE SPACES.      02900010
029100         10  FILLER                  PIC X(04) VALUE 'SCAC'.      02910010
029200         10  FILLER                  PIC X(02) VALUE SPACES.      02920010
029300         10  FILLER                  PIC X(03) VALUE 'DC '.       02930004
029400         10  FILLER                  PIC X(02) VALUE SPACES.      02940010
029500         10  FILLER                  PIC X(03) VALUE 'STR'.       02950010
009800*TV 10/23/2014 CHANGE STARTS                                      02951036
029600         10  FILLER                  PIC X(02) VALUE SPACES.      02960034
009800*TV 10/23/2014 CHANGE ENDS                                        02961036
029700         10  FILLER                  PIC X(05) VALUE 'COUNT'.     02970004
029800         10  FILLER                  PIC X(03) VALUE SPACES.      02980010
029900         10  FILLER                  PIC X(05) VALUE 'COUNT'.     02990004
030000         10  FILLER                  PIC X(03) VALUE SPACES.      03000010
030100         10  FILLER                  PIC X(04) VALUE ' NBR'.      03010004
030200         10  FILLER                  PIC X(03) VALUE SPACES.      03020011
030300         10  FILLER                  PIC X(05) VALUE ' QTY '.     03030004
030400         10  FILLER                  PIC X(04) VALUE SPACES.      03040004
030500         10  FILLER                  PIC X(05) VALUE ' QTY '.     03050004
030600         10  FILLER                  PIC X(02) VALUE SPACES.      03060011
030700                                                                  03070001
030800     05  HEADING-LINE-1-CS.                                       03080019
030900         10  FILLER                  PIC X(47) VALUE SPACES.      03090026
031000         10  FILLER                  PIC X(28) VALUE              03100026
031100             'VENDOR PACKSLIP SUMMARY FOR '.                      03110026
031200         10  HL1-RPT2-MM             PIC X(02) VALUE SPACES.      03120026
031300         10  HL1-RPT2-S1             PIC X(01) VALUE SPACES.      03130026
031400         10  HL1-RPT2-DD             PIC X(02) VALUE SPACES.      03140026
031500         10  HL1-RPT2-S2             PIC X(01) VALUE SPACES.      03150026
031600         10  HL1-RPT2-CC             PIC X(02) VALUE SPACES.      03160026
031700         10  HL1-RPT2-YY             PIC X(02) VALUE SPACES.      03170026
031800         10  FILLER                  PIC X(47) VALUE SPACES.      03180026
031900                                                                  03190020
032000     05  HEADING-LINE-2-CS.                                       03200024
032100         10  FILLER                  PIC X(01) VALUE SPACES.      03210024
032200         10  FILLER                  PIC X(25) VALUE              03220024
032300             '                         '.                         03230024
032400         10  FILLER                  PIC X(07) VALUE SPACES.      03240024
032500         10  FILLER                  PIC X(09) VALUE              03250019
032600                                               '         '.       03260024
032700         10  FILLER                  PIC X(07) VALUE SPACES.      03270024
032800         10  FILLER                  PIC X(08) VALUE              03280024
032900                                               '        '.        03290024
033000         10  FILLER                  PIC X(07) VALUE SPACES.      03300024
033100         10  FILLER                  PIC X(08) VALUE              03310024
033200                                               '        '.        03320024
033300         10  FILLER                  PIC X(07) VALUE SPACES.      03330024
033400         10  FILLER                  PIC X(08) VALUE              03340024
033500                                               ' CARTON '.        03350024
033600         10  FILLER                  PIC X(07) VALUE SPACES.      03360024
033700         10  FILLER                  PIC X(08) VALUE              03370024
033800                                               ' CARTON '.        03380024
033900         10  FILLER                  PIC X(30) VALUE SPACES.      03390024
034000                                                                  03400019
034100     05  HEADING-LINE-3-CS.                                       03410024
034200         10  FILLER                  PIC X(01) VALUE SPACES.      03420024
034300         10  FILLER                  PIC X(25) VALUE              03430024
034400             '                         '.                         03440024
034500         10  FILLER                  PIC X(07) VALUE SPACES.      03450024
034600         10  FILLER                  PIC X(09) VALUE              03460024
034700                                               'NUMBER OF'.       03470024
034800         10  FILLER                  PIC X(07) VALUE SPACES.      03480024
034900         10  FILLER                  PIC X(08) VALUE              03490024
035000                                               'PACKSLIP'.        03500024
035100         10  FILLER                  PIC X(07) VALUE SPACES.      03510024
035200         10  FILLER                  PIC X(08) VALUE              03520024
035300                                               'PACKSLIP'.        03530024
035400         10  FILLER                  PIC X(07) VALUE SPACES.      03540024
035500         10  FILLER                  PIC X(08) VALUE              03550024
035600                                               ' CONTENT'.        03560024
035700         10  FILLER                  PIC X(07) VALUE SPACES.      03570024
035800         10  FILLER                  PIC X(08) VALUE              03580024
035900                                               ' CONTENT'.        03590024
036000         10  FILLER                  PIC X(30) VALUE SPACES.      03600024
036100                                                                  03610024
036200     05  HEADING-LINE-4-CS.                                       03620024
036300         10  FILLER                  PIC X(01) VALUE SPACES.      03630024
036400         10  FILLER                  PIC X(25) VALUE              03640024
036500             '       VENDOR NAME       '.                         03650024
036600         10  FILLER                  PIC X(07) VALUE SPACES.      03660024
036700         10  FILLER                  PIC X(09) VALUE              03670024
036800                                               'PACKSLIPS'.       03680024
036900         10  FILLER                  PIC X(07) VALUE SPACES.      03690024
037000         10  FILLER                  PIC X(08) VALUE              03700024
037100                                               ' ERRORS '.        03710024
037200         10  FILLER                  PIC X(07) VALUE SPACES.      03720024
037300         10  FILLER                  PIC X(08) VALUE              03730024
037400                                               'ERROR % '.        03740024
037500         10  FILLER                  PIC X(07) VALUE SPACES.      03750024
037600         10  FILLER                  PIC X(08) VALUE              03760024
037700                                               ' ERRORS '.        03770024
037800         10  FILLER                  PIC X(07) VALUE SPACES.      03780024
037900         10  FILLER                  PIC X(08) VALUE              03790024
038000                                               ' ERROR %'.        03800024
038100         10  FILLER                  PIC X(30) VALUE SPACES.      03810024
038200                                                                  03820024
038300 01  DETAIL-LINES.                                                03830024
038400     05  DETAIL-LINE-1.                                           03840001
038500         10  FILLER                  PIC X(01) VALUE SPACES.      03850004
038600         10  DL1-VENDOR-NAME         PIC X(25) VALUE SPACES.      03860004
038700         10  FILLER                  PIC X(01) VALUE SPACES.      03870011
038700*TV 10/23/2014 CHANGE STARTS                                      03871030
038800         10  DL1-PO-NBR              PIC X(08) VALUE SPACES.      03880030
038700*TV 10/23/2014 CHANGE ENDS                                        03881030
038900         10  FILLER                  PIC X(01) VALUE SPACES.      03890011
039000         10  DL1-EDIISA-CNTL-NBR     PIC X(09) VALUE SPACES.      03900011
039100         10  FILLER                  PIC X(01) VALUE SPACES.      03910011
039200         10  DL1-ASN-BOL-NBR         PIC X(30) VALUE SPACES.      03920004
039300         10  FILLER                  PIC X(01) VALUE SPACES.      03930011
039400         10  DL1-SCAC                PIC X(04) VALUE SPACES.      03940004
039500         10  FILLER                  PIC X(01) VALUE SPACES.      03950029
039600         10  DL1-DC                  PIC X(04) VALUE SPACES.      03960029
039700         10  FILLER                  PIC X(01) VALUE SPACES.      03970029
039800         10  DL1-DEST-STR            PIC X(04) VALUE SPACES.      03980029
038700*TV 10/23/2014 CHANGE STARTS                                      03981036
039900         10  FILLER                  PIC X(02) VALUE SPACES.      03990034
038700*TV 10/23/2014 CHANGE ENDS                                        03991036
040000         10  DL1-PKSLIP-EXP-QTY      PIC X(05) VALUE SPACES.      04000004
040100         10  FILLER                  PIC X(03) VALUE SPACES.      04010011
040200         10  DL1-INPKSU-PKG-COUNT    PIC X(05) VALUE SPACES.      04020004
040300         10  FILLER                  PIC X(03) VALUE SPACES.      04030011
040400         10  DL1-LINE-NBR            PIC X(04) VALUE SPACES.      04040004
040500         10  FILLER                  PIC X(03) VALUE SPACES.      04050011
040600         10  DL1-PKITEM-EXP-QTY      PIC X(05) VALUE SPACES.      04060004
040700         10  FILLER                  PIC X(04) VALUE SPACES.      04070004
040800         10  DL1-SHUUPC-SHP-QTY      PIC X(05) VALUE SPACES.      04080004
038700*TV 10/23/2014 CHANGE STARTS                                      04081031
040900         10  FILLER                  PIC X(01) VALUE SPACES.      04090031
038700*TV 10/23/2014 CHANGE ENDS;                                       04091031
041000                                                                  04100001
041100 01  DETAIL-LINES-CS.                                             04110019
041200     05  DETAIL-LINE-1-CS.                                        04120019
041300         10  FILLER                  PIC X(01) VALUE SPACES.      04130024
041400         10  DL1-VENDOR-NAME-CS      PIC X(25) VALUE SPACES.      04140019
041500         10  FILLER                  PIC X(06) VALUE SPACES.      04150019
041600         10  DL1-TOT-VEND-RECS-CS    PIC Z,ZZZ,ZZ9.               04160019
041700         10  FILLER                  PIC X(08) VALUE SPACES.      04170024
041800         10  DL1-VEND-PKSL-ERRS-CS   PIC ZZ,ZZ9.                  04180019
041900         10  FILLER                  PIC X(07) VALUE SPACES.      04190024
042000         10  DL1-VEND-PERCENT        PIC Z,ZZ9.99.                04200019
042100         10  FILLER                  PIC X(01) VALUE '%'.         04210019
042200         10  FILLER                  PIC X(09) VALUE SPACES.      04220024
042300         10  DL1-PKSL-DTL-ERRS-CS    PIC ZZ,ZZ9.                  04230024
042400         10  FILLER                  PIC X(07) VALUE SPACES.      04240024
042500         10  DL1-ITEM-PERCENT        PIC Z,ZZ9.99.                04250024
042600         10  FILLER                  PIC X(01) VALUE '%'.         04260024
042700         10  FILLER                  PIC X(30) VALUE SPACES.      04270024
042800                                                                  04280019
042900                                                                  04290024
043000 01  TOTAL-LINES-CS.                                              04300024
043100     05  TOTAL-LINE-1-CS.                                         04310024
043200         10  FILLER                  PIC X(01) VALUE SPACES.      04320024
043300         10  FILLER                  PIC X(21) VALUE              04330024
043400                                     'TOTAL VENDORS .....: '.     04340024
043500         10  FILLER                  PIC X(01) VALUE SPACES.      04350024
043600         10  TL1-VENDOR-NMBR-CS      PIC ZZZ9.                    04360024
043700         10  FILLER                  PIC X(05) VALUE SPACES.      04370025
043800         10  TL1-TOT-VEND-RECS-CS    PIC Z,ZZZ,ZZ9.               04380024
043900         10  FILLER                  PIC X(08) VALUE SPACES.      04390025
044000         10  TL1-VEND-PKSL-ERRS-CS   PIC ZZ,ZZ9.                  04400024
044100         10  FILLER                  PIC X(07) VALUE SPACES.      04410025
044200         10  TL1-VEND-PERCENT        PIC Z,ZZ9.99.                04420024
044300         10  FILLER                  PIC X(01) VALUE '%'.         04430024
044400         10  FILLER                  PIC X(09) VALUE SPACES.      04440024
044500         10  TL1-PKSL-DTL-ERRS-CS    PIC ZZ,ZZ9.                  04450024
044600         10  FILLER                  PIC X(07) VALUE SPACES.      04460024
044700         10  TL1-ITEM-PERCENT        PIC Z,ZZ9.99.                04470024
044800         10  FILLER                  PIC X(01) VALUE '%'.         04480024
044900         10  FILLER                  PIC X(31) VALUE SPACES.      04490025
045000                                                                  04500024
045100 01  MISCELLANEOUS-LINES.                                         04510024
045200     05  BLANK-LINE.                                              04520001
045300         10  FILLER                  PIC X(132) VALUE SPACES.     04530001
045400                                                                  04540001
045500     05  END-OF-REPORT-LINE.                                      04550001
045600         10  FILLER                  PIC X(43) VALUE SPACES.      04560022
045700         10  FILLER                  PIC X(45) VALUE              04570001
045800             '*******   E N D   O F   R E P O R T   *******'.     04580001
045900         10  FILLER                  PIC X(44) VALUE SPACES.      04590022
046000                                                                  04600001
046100     05  NO-DATA-TO-REPORT-LINE.                                  04610001
046200         10  FILLER                  PIC X(39) VALUE SPACES.      04620022
046300         10  FILLER                  PIC X(53) VALUE              04630022
046400         '*******   N O   D A T A   T O   R E P O R T   *******'. 04640022
046500         10  FILLER                  PIC X(40) VALUE SPACES.      04650004
046600                                                                  04660001
046700******************************************************************04670001
046800******************************************************************04680001
046900 PROCEDURE DIVISION.                                              04690001
047000     DISPLAY '**** START OF RCKRP031 ****'.                       04700001
047100                                                                  04710001
047200*OPEN FILES.                                                      04720001
047300     OPEN INPUT  INPUT-EXTRACT-FILE                               04730001
047400          OUTPUT OUTPUT-REPORT.                                   04740001
047500                                                                  04750001
047600*SET/PRINT REPORT HEADINGS.                                       04760004
047700     PERFORM 1000-INITIALIZATION.                                 04770004
047800                                                                  04780004
047900*READ FIRST INPUT RECORD.                                         04790001
048000     SET PS-NOT-END-OF-INPUT TO TRUE.                             04800001
048100     PERFORM 7000-READ-EXTRACT.                                   04810004
048200                                                                  04820001
048300*PROCESS INPUT FILE.                                              04830001
048400     IF PS-END-OF-INPUT                                           04840001
048500         PERFORM 6100-NO-DETAIL-LINE                              04850004
048600     ELSE                                                         04860001
048700         MOVE 1 TO PV-REC-IN-QTY                                  04870004
048800         SET PS-FIRST-TIME-YES   TO TRUE                          04880006
048900         SET PS-ASN-WRITTEN-NO   TO TRUE                          04890006
049000         PERFORM 2000-PROCESS-EXTRACT                             04900001
049100           UNTIL PS-END-OF-INPUT                                  04910001
049200     END-IF.                                                      04920001
049300                                                                  04930001
049400*WRITE 'RCKRP031-1' END-OF-REPORT LINE.                           04940023
049500     PERFORM 6200-END-OF-RPT-LINE.                                04950023
049600                                                                  04960023
049700*WRITE VENDOR SUMMARY LINES.                                      04970019
049800     PERFORM 3100-VENDOR-SUMMARY.                                 04980019
049900                                                                  04990019
050000*WRITE 'RCKRP031-2' END-OF-REPORT LINE.                           05000023
050100     PERFORM 6200-END-OF-RPT-LINE.                                05010019
050200                                                                  05020020
050300     DISPLAY ' '.                                                 05030020
050400     DISPLAY '  ** RECORDS READ    ==> ' PV-REC-IN-QTY.           05040020
050500     DISPLAY ' '.                                                 05050020
050600     DISPLAY '  ** DETAILS WRITTEN ==> ' PV-REC-OUT-QTY.          05060020
050700     DISPLAY '  ** VENDORS WRITTEN ==> ' PV-SUM-OUT-QTY.          05070020
050800     DISPLAY ' '.                                                 05080020
050900                                                                  05090001
051000*CLOSE FILES.                                                     05100001
051100     CLOSE INPUT-EXTRACT-FILE                                     05110001
051200           OUTPUT-REPORT.                                         05120001
051300                                                                  05130001
051400     DISPLAY '****  END OF RCKRP031  ****'.                       05140001
051500     GOBACK.                                                      05150001
051600                                                                  05160001
051700******************************************************************05170001
051800*  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.               *05180001
051900******************************************************************05190001
052000 1000-INITIALIZATION.                                             05200001
052100                                                                  05210001
052200*GET REPORT DATE.                                                 05220026
052300     EXEC SQL                                                     05230026
052400         SELECT  BTCH_PRC_DTE                                     05240026
052500           INTO  :PV-CURRENT-DB2-DATE                             05250026
052600           FROM  TCOCNTL                                          05260026
052700          WHERE  OPER_UNT_ID = 90                                 05270026
052800     END-EXEC.                                                    05280026
052900                                                                  05290026
053000     EVALUATE TRUE                                                05300026
053100       WHEN SQLCODE = ZERO                                        05310026
053200           MOVE PV-CURRENT-DB2-DATE   TO PV-RPT-DATE              05320026
053300                                                                  05330026
053400       WHEN OTHER                                                 05340026
053500           MOVE '1000-INITIALIZATION' TO PV-ABEND-PARAGRAPH       05350026
053600           MOVE 'TCOCNTL'      TO PV-DB2-TABLE-NAME               05360026
053700           MOVE 'EXTRACT DATE' TO PV-DB2-OPERATION-MESSAGE-1      05370026
053800           PERFORM Z999-SQL-ABEND                                 05380026
053900     END-EVALUATE.                                                05390026
054000                                                                  05400026
054100     ACCEPT PV-TODAYS-DATE   FROM DATE.                           05410026
054200     MOVE PV-TODAYS-DATE-MM    TO DP132-RUN-MONTH.                05420001
054300     MOVE PV-TODAYS-DATE-DD    TO DP132-RUN-DAY.                  05430001
054400     MOVE PV-TODAYS-DATE-YY    TO PV-TODAYS-DATE-Y2.              05440001
054500     MOVE PV-TODAYS-DATE-YYYY  TO DP132-RUN-YEAR.                 05450001
054600                                                                  05460001
054700     ACCEPT PV-TODAYS-TIME   FROM TIME.                           05470026
054800     MOVE PV-TODAYS-TIME-HH    TO DP132-RUN-HOUR.                 05480001
054900     MOVE PV-TODAYS-TIME-MM    TO DP132-RUN-MINUTE.               05490001
055000                                                                  05500001
055100     MOVE PC-RCKRP031          TO DP132-PROGRAM-NAME.             05510001
055200     MOVE PC-REPORT-NBR        TO DP132-REPORT-NUMBER.            05520001
055300                                                                  05530001
055400     MOVE +0                   TO PV-PAGE-COUNT.                  05540004
055500                                                                  05550004
055600     MOVE ZEROES               TO PV-REC-IN-QTY                   05560022
055700                                  PV-REC-OUT-QTY.                 05570022
055800                                                                  05580001
055900     PERFORM 1100-INIT-SUMMARY-TABLE.                             05590018
056000                                                                  05600018
056100     PERFORM 6000-PRINT-HEADINGS.                                 05610018
056200                                                                  05620001
056300******************************************************************05630001
056400 1100-INIT-SUMMARY-TABLE.                                         05640018
056500                                                                  05650018
056600     PERFORM                                                      05660018
056700       VARYING VS-IDX FROM 1 BY 1 UNTIL VS-IDX > 900              05670024
056800         MOVE SPACES TO SUMMARY-VEND-NAME (VS-IDX)                05680018
056900         MOVE ZEROES TO SUMMARY-VEND-COUNT (VS-IDX)               05690018
057000         MOVE ZEROES TO SUMMARY-VEND-ERRS (VS-IDX)                05700018
057100         MOVE ZEROES TO SUMMARY-ITEM-ERRS (VS-IDX)                05710024
057200     END-PERFORM.                                                 05720018
057300                                                                  05730018
057400******************************************************************05740018
057500*  THIS IS THE MAIN CONTROLLING PARAGRAPH FOR READING THE INPUT  *05750001
057600*  EXTRACT FILE (FORMAT RCRD053) AND CREATING THE 'EXPECTED      *05760004
057700*  CARTON COUNT AND CARTON CONTENT QUANTITY VARIANCE' REPORT.    *05770004
057800******************************************************************05780001
057900 2000-PROCESS-EXTRACT.                                            05790001
058000                                                                  05800001
058100*CHECK FOR BREAKS.                                                05810001
058200     IF RC053-TYPE-CODE = '4'                                     05820020
058300         CONTINUE                                                 05830020
058400     ELSE                                                         05840020
058500       IF PS-FIRST-TIME-YES                                       05850020
058600         SET PS-FIRST-TIME-NO    TO TRUE                          05860020
058700         SET PS-PRT-QTY-ERRS-YES TO TRUE                          05870020
058800       ELSE                                                       05880020
058900         IF (RC053-VENDOR-NAME  NOT = PV-CURR-VEND-NAME)          05890009
059000           OR (RC053-PO-NBR     NOT = PV-CURR-PO-NBR)             05900009
059100             IF PV-LAST-BOL-NBR NOT = PV-CURR-BOL-NBR             05910009
059200                 PERFORM 5100-PRINT-BOL-LINE                      05920012
059300             END-IF                                               05930006
059400             PERFORM 6300-PRINT-BLANK-LINE                        05940006
059500             MOVE ALL '?'            TO PV-CURR-VEND-NAME         05950012
059600                                        PV-CURR-ASN-NBR           05960009
059700                                        PV-CURR-BOL-NBR           05970009
059800                                        PV-CURR-SCAC              05980011
059900             MOVE ZEROES             TO PV-CURR-PO-NBR            05990006
060000             MOVE ALL '9'            TO PV-CURR-DC                06000013
060100                                        PV-CURR-EDI-NBR           06010013
060200             SET PS-PRT-QTY-ERRS-YES TO TRUE                      06020020
060300         ELSE                                                     06030012
060400             IF (RC053-ASN-NBR  NOT = PV-CURR-ASN-NBR)            06040012
060500                 IF PV-LAST-BOL-NBR NOT = PV-CURR-BOL-NBR         06050012
060600                     PERFORM 5100-PRINT-BOL-LINE                  06060012
060700                 END-IF                                           06070012
060800                 PERFORM 6300-PRINT-BLANK-LINE                    06080012
060900                 MOVE ALL '?'        TO PV-CURR-ASN-NBR           06090012
061000                                        PV-CURR-BOL-NBR           06100012
061100                                        PV-CURR-SCAC              06110012
061200                 MOVE ALL '9'        TO PV-CURR-DC                06120013
061300                                        PV-CURR-EDI-NBR           06130013
061400                 SET PS-PRT-QTY-ERRS-YES TO TRUE                  06140021
061500             END-IF                                               06150012
061600         END-IF                                                   06160012
061700       END-IF                                                     06170019
061800     END-IF.                                                      06180019
061900                                                                  06190001
062000*SAVE VENDOR SUMMARY RECORD OR PRINT DETAIL LINE.                 06200018
062100     IF RC053-TYPE-CODE = '4'                                     06210018
062200         PERFORM 3000-LOAD-VENDOR-DATA                            06220018
062300         IF PS-END-OF-TABLE                                       06230018
062400             DISPLAY '3000-LOAD-VENDOR-DATA'                      06240019
062500             DISPLAY                                              06250019
062600             'TABLE TOO SMALL - OVER 900 VENDORS PROCESSED'       06260024
062700         END-IF                                                   06270018
062800     ELSE                                                         06280018
062900         PERFORM 5000-PRINT-DETAIL                                06290018
063000         ADD 1   TO PV-REC-OUT-QTY                                06300018
063100     END-IF.                                                      06310018
063200                                                                  06320001
063300*READ NEXT INPUT RECORD.                                          06330001
063400     PERFORM 7000-READ-EXTRACT.                                   06340004
063500     IF NOT PS-END-OF-INPUT                                       06350001
063600         ADD +1 TO PV-REC-IN-QTY                                  06360001
063700     ELSE                                                         06370008
063800         IF PV-LAST-BOL-NBR NOT = PV-CURR-BOL-NBR                 06380009
063900             PERFORM 5100-PRINT-BOL-LINE                          06390008
064000         END-IF                                                   06400008
064100     END-IF.                                                      06410008
064200                                                                  06420001
064300******************************************************************06430018
064400*  LOAD TYPE '4' INPUT RECORDS TO VENDOR SUMMARY TABLE.          *06440018
064500******************************************************************06450018
064600 3000-LOAD-VENDOR-DATA.                                           06460018
064700                                                                  06470018
064800     SET VS-IDX TO 1.                                             06480018
064900                                                                  06490018
065000     SEARCH SUMMARY-TABLE                                         06500018
065100       VARYING VS-IDX                                             06510018
065200         AT END SET PS-END-OF-TABLE TO TRUE                       06520018
065300                                                                  06530018
065400         WHEN SUMMARY-VEND-NAME (VS-IDX) = SPACES                 06540018
065500             MOVE RC053-VENDOR-NAME                               06550019
065600                                 TO SUMMARY-VEND-NAME (VS-IDX)    06560018
065700             MOVE RC053-TOT-VEND-RECS                             06570019
065800                                 TO SUMMARY-VEND-COUNT (VS-IDX)   06580019
065900             MOVE RC053-VEND-PKSL-ERRS                            06590019
066000                                 TO SUMMARY-VEND-ERRS (VS-IDX)    06600019
066100             MOVE RC053-PKSL-DTL-ERRS                             06610024
066200                                 TO SUMMARY-ITEM-ERRS (VS-IDX)    06620024
066300             ADD +1 TO PV-TOT-VEND-NBR                            06630024
066400                                                                  06640018
066500     END-SEARCH.                                                  06650018
066600                                                                  06660018
066700******************************************************************06670019
066800*  FILL AND PRINT VENDOR SUMMARY REPORT LINES.                   *06680019
066900******************************************************************06690019
067000 3100-VENDOR-SUMMARY.                                             06700019
067100                                                                  06710019
067200* PRINT VENDOR SUMMARY HEADINGS.                                  06720020
067300     MOVE +0 TO PV-PAGE-COUNT.                                    06730023
067400     PERFORM 3110-PRINT-VEND-HDGS.                                06740019
067500                                                                  06750019
067600* PRINT 'NO DETAIL' MESSAGE IF INPUT FILE EMPTY.                  06760022
067700     IF PV-REC-IN-QTY = ZEROES                                    06770022
067800         PERFORM 6100-NO-DETAIL-LINE                              06780022
067900     ELSE                                                         06790022
068000* PRINT VENDOR SUMMARY DETAIL.                                    06800020
068100         PERFORM 3120-WRITE-SUMMARY-TABLE                         06810022
068200           VARYING VS-IDX FROM 1 BY 1                             06820022
068300             UNTIL SUMMARY-VEND-NAME (VS-IDX) = SPACES            06830022
068400                OR PS-END-OF-TABLE                                06840022
068500     END-IF.                                                      06850022
068600                                                                  06860019
068700* PRINT VENDOR SUMMARY TOTALS.                                    06870020
068800     ADD 2 TO PV-LINE-COUNT.                                      06880020
068900     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         06890020
069000         PERFORM 3110-PRINT-VEND-HDGS                             06900020
069100     END-IF.                                                      06910020
069200                                                                  06920020
069300     MOVE PV-TOT-VEND-NBR             TO TL1-VENDOR-NMBR-CS.      06930024
069400     MOVE PV-TOT-VEND-QTY             TO TL1-TOT-VEND-RECS-CS.    06940024
069500     MOVE PV-TOT-VEND-ERR             TO TL1-VEND-PKSL-ERRS-CS.   06950024
069600     IF (PV-TOT-VEND-QTY = ZEROES)                                06960020
069700       OR (PV-TOT-VEND-ERR = ZEROES)                              06970020
069800         MOVE ZEROES     TO TL1-VEND-PERCENT                      06980024
069900     ELSE                                                         06990020
070000         COMPUTE PV-PERCENT = (PV-TOT-VEND-ERR                    07000020
070100                             / PV-TOT-VEND-QTY)                   07010020
070200                             * 100                                07020020
070300         MOVE PV-PERCENT TO TL1-VEND-PERCENT                      07030024
070400     END-IF.                                                      07040020
070500                                                                  07050020
070600     MOVE PV-TOT-ITEM-ERR TO TL1-PKSL-DTL-ERRS-CS.                07060024
070700     IF (PV-TOT-VEND-QTY = ZEROES)                                07070024
070800       OR (PV-TOT-ITEM-ERR = ZEROES)                              07080024
070900         MOVE ZEROES     TO TL1-ITEM-PERCENT                      07090024
071000     ELSE                                                         07100024
071100         COMPUTE PV-PERCENT = (PV-TOT-ITEM-ERR                    07110024
071200                             / PV-TOT-VEND-QTY)                   07120024
071300                             * 100                                07130024
071400         MOVE PV-PERCENT TO TL1-ITEM-PERCENT                      07140024
071500     END-IF.                                                      07150024
071600                                                                  07160024
071700     IF PV-REC-IN-QTY > ZEROES                                    07170022
071800         WRITE OUTPUT-REC                                         07180022
071900           FROM TOTAL-LINE-1-CS                                   07190024
072000             AFTER ADVANCING 2 LINES                              07200022
072100     END-IF.                                                      07210022
072200                                                                  07220020
072300******************************************************************07230019
072400*  PRINT VENDOR SUMMARY HEADINGS.                                *07240019
072500******************************************************************07250019
072600 3110-PRINT-VEND-HDGS.                                            07260019
072700                                                                  07270019
072800     ADD +1               TO PV-PAGE-COUNT.                       07280022
072900     MOVE PV-PAGE-COUNT   TO DP132-PAGE-NUMBER.                   07290022
073000                                                                  07300019
073100     MOVE PC-REPORT-NBR-2 TO DP132-REPORT-NUMBER.                 07310022
073200     WRITE OUTPUT-REC                                             07320019
073300       FROM DP132-STANDRD-HEADER-132-COLS                         07330019
073400         AFTER ADVANCING PAGE.                                    07340019
073500                                                                  07350019
073600     MOVE PV-RPT-DB2-MM   TO HL1-RPT2-MM.                         07360027
073700     MOVE PV-RPT-DB2-DD   TO HL1-RPT2-DD.                         07370027
073800     MOVE PV-RPT-DB2-CC   TO HL1-RPT2-CC.                         07380027
073900     MOVE PV-RPT-DB2-YY   TO HL1-RPT2-YY.                         07390027
074000     MOVE '/'             TO HL1-RPT2-S1                          07400027
074100                             HL1-RPT2-S2.                         07410027
074200     WRITE OUTPUT-REC                                             07420020
074300       FROM HEADING-LINE-1-CS                                     07430020
074400         AFTER ADVANCING 2 LINES.                                 07440024
074500                                                                  07450020
074600     WRITE OUTPUT-REC                                             07460020
074700       FROM HEADING-LINE-2-CS                                     07470020
074800         AFTER ADVANCING 2 LINES.                                 07480020
074900                                                                  07490020
075000     WRITE OUTPUT-REC                                             07500024
075100       FROM HEADING-LINE-3-CS                                     07510024
075200         AFTER ADVANCING 1 LINES.                                 07520024
075300                                                                  07530024
075400     WRITE OUTPUT-REC                                             07540024
075500       FROM HEADING-LINE-4-CS                                     07550024
075600         AFTER ADVANCING 1 LINES.                                 07560024
075700                                                                  07570024
075800     WRITE OUTPUT-REC                                             07580019
075900       FROM BLANK-LINE                                            07590019
076000         AFTER ADVANCING 1 LINES.                                 07600019
076100                                                                  07610019
076200     MOVE +9 TO PV-LINE-COUNT.                                    07620024
076300                                                                  07630019
076400******************************************************************07640019
076500*  FILL AND PRINT VENDOR SUMMARY DETAIL REPORT LINES.            *07650019
076600******************************************************************07660019
076700 3120-WRITE-SUMMARY-TABLE.                                        07670019
076800                                                                  07680019
076900*INITIALIZE PRINT LINE.                                           07690019
077000     INITIALIZE DETAIL-LINE-1-CS.                                 07700019
077100                                                                  07710019
077200*CHECK FOR OVERFLOW.                                              07720019
077300     ADD 1 TO PV-LINE-COUNT.                                      07730019
077400     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         07740019
077500         PERFORM 3110-PRINT-VEND-HDGS                             07750019
077600         ADD 1 TO PV-LINE-COUNT                                   07760019
077700     END-IF.                                                      07770019
077800                                                                  07780019
077900*FILL VENDOR NAME.                                                07790019
078000     MOVE SUMMARY-VEND-NAME (VS-IDX)  TO DL1-VENDOR-NAME-CS.      07800019
078100                                                                  07810019
078200*FILL VENDOR TOTAL PKSLIPS.                                       07820020
078300     MOVE SUMMARY-VEND-COUNT (VS-IDX) TO DL1-TOT-VEND-RECS-CS.    07830019
078400     ADD  SUMMARY-VEND-COUNT (VS-IDX) TO PV-TOT-VEND-QTY.         07840020
078500                                                                  07850019
078600*FILL VENDOR PKSLIP ERRORS.                                       07860024
078700     MOVE SUMMARY-VEND-ERRS (VS-IDX)  TO DL1-VEND-PKSL-ERRS-CS.   07870019
078800     ADD  SUMMARY-VEND-ERRS (VS-IDX)  TO PV-TOT-VEND-ERR.         07880020
078900                                                                  07890019
079000*FILL VENDOR PKSLIP ERROR PERCENTAGE.                             07900024
079100     IF (SUMMARY-VEND-COUNT (VS-IDX) = ZEROES)                    07910020
079200       OR (SUMMARY-VEND-ERRS (VS-IDX) = ZEROES)                   07920020
079300         MOVE ZEROES     TO DL1-VEND-PERCENT                      07930020
079400     ELSE                                                         07940020
079500         COMPUTE PV-PERCENT = (SUMMARY-VEND-ERRS (VS-IDX)         07950020
079600                            / SUMMARY-VEND-COUNT (VS-IDX))        07960020
079700                            * 100                                 07970020
079800         MOVE PV-PERCENT TO DL1-VEND-PERCENT                      07980020
079900     END-IF.                                                      07990020
080000                                                                  08000020
080100*FILL VENDOR PKSLIP DETAIL ERRORS.                                08010024
080200     MOVE SUMMARY-ITEM-ERRS (VS-IDX)  TO DL1-PKSL-DTL-ERRS-CS.    08020024
080300     ADD  SUMMARY-ITEM-ERRS (VS-IDX)  TO PV-TOT-ITEM-ERR.         08030024
080400                                                                  08040024
080500*FILL PKSLIP DETAIL ERROR PERCENTAGE.                             08050024
080600     IF (SUMMARY-VEND-COUNT (VS-IDX) = ZEROES)                    08060024
080700       OR (SUMMARY-ITEM-ERRS (VS-IDX) = ZEROES)                   08070024
080800         MOVE ZEROES     TO DL1-ITEM-PERCENT                      08080024
080900     ELSE                                                         08090024
081000         COMPUTE PV-PERCENT = (SUMMARY-ITEM-ERRS (VS-IDX)         08100024
081100                            / SUMMARY-VEND-COUNT (VS-IDX))        08110024
081200                            * 100                                 08120024
081300         MOVE PV-PERCENT TO DL1-ITEM-PERCENT                      08130024
081400     END-IF.                                                      08140024
081500                                                                  08150024
081600*WRITE DETAIL LINE.                                               08160019
081700     WRITE OUTPUT-REC                                             08170019
081800       FROM DETAIL-LINE-1-CS                                      08180019
081900         AFTER ADVANCING 1 LINES.                                 08190019
082000     ADD 1 TO PV-SUM-OUT-QTY.                                     08200020
082100                                                                  08210019
082200******************************************************************08220001
082300*  FILL AND PRINT DETAIL REPORT LINE.                            *08230005
082400******************************************************************08240005
082500 5000-PRINT-DETAIL.                                               08250004
082600                                                                  08260001
082700*INITIALIZE PRINT LINE.                                           08270006
082800     INITIALIZE DETAIL-LINE-1.                                    08280006
082900                                                                  08290006
083000*FILL VENDOR NAME.                                                08300004
083100     IF (RC053-VENDOR-NAME  = PV-CURR-VEND-NAME)                  08310004
083200         MOVE SPACES              TO DL1-VENDOR-NAME              08320004
083300     ELSE                                                         08330004
083400         MOVE RC053-VENDOR-NAME   TO DL1-VENDOR-NAME              08340004
083500                                     PV-CURR-VEND-NAME            08350005
083600     END-IF.                                                      08360004
083700                                                                  08370012
083800*FILL PO NUMBER.                                                  08380004
083900     IF (RC053-VENDOR-NAME  = PV-CURR-VEND-NAME)                  08390004
084000       AND (RC053-PO-NBR    = PV-CURR-PO-NBR)                     08400004
084100         MOVE SPACES              TO DL1-PO-NBR                   08410004
084200     ELSE                                                         08420004
084200*TV 10/23/2014 CHANGE STARTS                                      08421036
084300         MOVE RC053-PO-NBR        TO PV-DL1-PO-NBR-8              08430036
084400                                     PV-CURR-PO-NBR               08440036
084300         MOVE PV-DL1-PO-NBR-8     TO DL1-PO-NBR                   08441036
084300*TV 10/23/2014 CHANGE ENDS                                        08442036
084500     END-IF.                                                      08450036
084600                                                                  08460036
084700*FILL EDIISA CONTROL NUMBER.                                      08470036
084800     IF RC053-EDIISA-CNTL-NBR NOT = PV-CURR-EDI-NBR               08480036
084900         MOVE RC053-EDIISA-CNTL-NBR TO DL1-EDIISA-CNTL-NBR        08490036
085000                                       PV-CURR-EDI-NBR            08500036
085100     ELSE                                                         08510036
085200         MOVE SPACES                TO DL1-EDIISA-CNTL-NBR        08520036
085300     END-IF.                                                      08530036
085400                                                                  08540036
085500*FILL ASN/BOL NUMBER.                                             08550036
085600     MOVE RC053-BOL-NBR           TO PV-LAST-BOL-NBR.             08560036
085700     IF RC053-ASN-NBR NOT = PV-CURR-ASN-NBR                       08570036
085800         MOVE RC053-ASN-NBR       TO DL1-ASN-BOL-NBR              08580036
085900                                     PV-CURR-ASN-NBR              08590036
086000     ELSE                                                         08600036
086100         IF RC053-BOL-NBR NOT = PV-CURR-BOL-NBR                   08610036
086200             MOVE RC053-BOL-NBR   TO DL1-ASN-BOL-NBR              08620036
086300                                     PV-CURR-BOL-NBR              08630036
086400         ELSE                                                     08640036
086500             MOVE SPACES          TO DL1-ASN-BOL-NBR              08650036
086600         END-IF                                                   08660036
086700     END-IF.                                                      08670036
086800                                                                  08680036
086900*FILL SCAC.                                                       08690036
087000     IF RC053-SCAC NOT = PV-CURR-SCAC                             08700036
087100         MOVE RC053-SCAC          TO DL1-SCAC                     08710036
087200                                     PV-CURR-SCAC                 08720036
087300     ELSE                                                         08730036
087400         MOVE SPACES              TO DL1-SCAC                     08740036
087500     END-IF.                                                      08750036
087600                                                                  08760036
087700*FILL DC.                                                         08770036
087800     IF RC053-DC NOT = PV-CURR-DC                                 08780036
087900         MOVE RC053-DC            TO PV-FORMAT-DC                 08790036
088000                                     PV-CURR-DC                   08800036
088100         MOVE PV-FORMAT-DC-L4     TO DL1-DC                       08810036
088200     ELSE                                                         08820036
088300         MOVE SPACES              TO DL1-DC                       08830036
088400     END-IF.                                                      08840036
088500                                                                  08850036
088600*FILL DESTINATION STORE.                                          08860036
088700     MOVE RC053-DEST-STORE        TO PV-FORMAT-STR.               08870036
088800     MOVE PV-FORMAT-STR-L4        TO DL1-DEST-STR.                08880036
088900     IF DL1-DEST-STR = '0000'                                     08890036
089000         MOVE SPACES              TO DL1-DEST-STR                 08900036
089100     END-IF.                                                      08910036
089200                                                                  08920036
089300*FILL EXPECTED/ACTUAL CARTON COUNTS.                              08930036
089400     IF RC053-TYPE-CODE = '1'                                     08940036
089500         MOVE RC053-TPKSLIP-EXP-QTY                               08950036
089600                                  TO PV-FORMAT-COUNT              08960036
089700         MOVE PV-FORMAT-COUNT     TO DL1-PKSLIP-EXP-QTY           08970036
089800         MOVE RC053-TINPKSU-PKG-COUNT                             08980036
089900                                  TO PV-FORMAT-COUNT              08990036
090000         MOVE PV-FORMAT-COUNT     TO DL1-INPKSU-PKG-COUNT         09000036
090100         SET PS-PRT-QTY-ERRS-YES  TO TRUE                         09010036
090200         IF RC053-TINPKSU-PKG-COUNT = ZEROES                      09020036
090300             SET PS-PRT-QTY-ERRS-NO   TO TRUE                     09030036
090400         END-IF                                                   09040036
090500     ELSE                                                         09050036
090600         MOVE SPACES              TO DL1-PKSLIP-EXP-QTY           09060036
090700                                     DL1-INPKSU-PKG-COUNT         09070036
090800     END-IF.                                                      09080036
090900                                                                  09090036
091000*FILL LINE NUMBER.                                                09100036
091100*FILL EXPECTED ITEM QUANTITY.                                     09110036
091200*FILL ACTUAL ITEM QUANTITY.                                       09120036
091300     IF RC053-TYPE-CODE = '2'                                     09130036
091400         IF RC053-PKSL-LINE-NBR > ZEROES                          09140036
091500             MOVE RC053-PKSL-LINE-NBR TO PV-FORMAT-LINE           09150036
091600             MOVE PV-FORMAT-LINE-L4   TO DL1-LINE-NBR             09160036
091700         ELSE                                                     09170036
091800             MOVE RC053-TRN-LINE-NBR  TO PV-FORMAT-LINE           09180036
091900             MOVE PV-FORMAT-LINE-L4   TO DL1-LINE-NBR             09190036
092000         END-IF                                                   09200036
092100         MOVE RC053-TPKITEM-EXP-QTY   TO PV-FORMAT-COUNT          09210036
092200         MOVE PV-FORMAT-COUNT         TO DL1-PKITEM-EXP-QTY       09220036
092300         MOVE RC053-TSHUUPC-SHP-QTY   TO PV-FORMAT-COUNT          09230036
092400         MOVE PV-FORMAT-COUNT         TO DL1-SHUUPC-SHP-QTY       09240036
092500     ELSE                                                         09250036
092600         MOVE SPACES                  TO DL1-LINE-NBR             09260036
092700                                         DL1-PKITEM-EXP-QTY       09270036
092800                                         DL1-SHUUPC-SHP-QTY       09280036
092900     END-IF.                                                      09290036
093000                                                                  09300036
093100*IF NO DOWNLOADED CARTONS, DO NOT PRINT ITEM QTY DETAIL ERRORS.   09310036
093200     IF PS-PRT-QTY-ERRS-NO                                        09320036
093300       AND RC053-TYPE-CODE = '2'                                  09330036
093400         MOVE ALL '?' TO PV-CURR-BOL-NBR                          09340036
093500     ELSE                                                         09350036
093600*CHECK FOR OVERFLOW.                                              09360036
093700         ADD 1 TO PV-LINE-COUNT                                   09370036
093800         IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                     09380036
093900             PERFORM 6000-PRINT-HEADINGS                          09390036
094000             ADD 1 TO PV-LINE-COUNT                               09400036
094100         END-IF                                                   09410036
094200                                                                  09420036
094300*IF NEW PAGE, DISPLAY VENDOR NAME & PO# ON FIRST LINE.            09430036
094400         IF PS-NEW-PAGE                                           09440036
094500             MOVE RC053-VENDOR-NAME   TO DL1-VENDOR-NAME          09450036
094500*TV 10/23/2014 CHANGE STARTS                                      09451036
094600             MOVE RC053-PO-NBR        TO PV-DL1-PO-NBR-8          09460036
094600             MOVE PV-DL1-PO-NBR-8     TO DL1-PO-NBR               09461036
094500*TV 10/23/2014 CHANGE ENDS                                        09462036
094700             MOVE RC053-ASN-NBR       TO DL1-ASN-BOL-NBR          09470036
094800             MOVE ALL '?'             TO PV-CURR-BOL-NBR          09480036
094900             SET PS-SAME-PAGE         TO TRUE                     09490036
095000         END-IF                                                   09500036
095100                                                                  09510036
095200*WRITE DETAIL LINE.                                               09520036
095300         WRITE OUTPUT-REC                                         09530036
095400           FROM DETAIL-LINE-1                                     09540036
095500             AFTER ADVANCING 1 LINES                              09550036
095600                                                                  09560036
095700     END-IF.                                                      09570036
095800                                                                  09580036
095900******************************************************************09590036
096000*  FILL AND PRINT BOL DETAIL LINE.                               *09600036
096100******************************************************************09610036
096200 5100-PRINT-BOL-LINE.                                             09620036
096300                                                                  09630036
096400*INITIALIZE PRINT LINE.                                           09640036
096500     INITIALIZE DETAIL-LINE-1.                                    09650036
096600                                                                  09660036
096700*FILL BOL NUMBER.                                                 09670036
096800     MOVE PV-LAST-BOL-NBR   TO DL1-ASN-BOL-NBR                    09680036
096900                               PV-CURR-BOL-NBR.                   09690036
097000                                                                  09700036
097100*CHECK FOR OVERFLOW.                                              09710036
097200     ADD 1     TO PV-LINE-COUNT.                                  09720036
097300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         09730036
097400         PERFORM 6000-PRINT-HEADINGS                              09740036
097500         ADD 1 TO PV-LINE-COUNT                                   09750036
097600     END-IF.                                                      09760036
097700                                                                  09770036
097800*IF NEW PAGE, DISPLAY VENDOR NAME & PO# ON FIRST LINE.            09780036
097900     IF PS-NEW-PAGE                                               09790036
098000         MOVE PV-CURR-VEND-NAME TO DL1-VENDOR-NAME                09800036
098100         MOVE PV-CURR-PO-NBR    TO DL1-PO-NBR                     09810036
098200***      MOVE RC053-ASN-NBR     TO DL1-ASN-BOL-NBR                09820036
098300***      MOVE ALL '?'           TO PV-CURR-BOL-NBR                09830036
098400         SET PS-SAME-PAGE       TO TRUE                           09840036
098500     END-IF.                                                      09850036
098600                                                                  09860036
098700*WRITE DETAIL LINE.                                               09870036
098800     WRITE OUTPUT-REC                                             09880036
098900       FROM DETAIL-LINE-1                                         09890036
099000         AFTER ADVANCING 1 LINES.                                 09900036
099100                                                                  09910036
099200******************************************************************09920036
099300*  PRINT THE REPORT HEADINGS.                                    *09930036
099400******************************************************************09940036
099500 6000-PRINT-HEADINGS.                                             09950036
099600                                                                  09960036
099700     ADD +1 TO PV-PAGE-COUNT.                                     09970036
099800     MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     09980036
099900                                                                  09990036
100000     WRITE OUTPUT-REC                                             10000036
100100       FROM DP132-STANDRD-HEADER-132-COLS                         10010036
100200         AFTER ADVANCING PAGE.                                    10020036
100300                                                                  10030036
100400     MOVE PV-RPT-DB2-MM   TO HL1-RPT1-MM.                         10040036
100500     MOVE PV-RPT-DB2-DD   TO HL1-RPT1-DD.                         10050036
100600     MOVE PV-RPT-DB2-CC   TO HL1-RPT1-CC.                         10060036
100700     MOVE PV-RPT-DB2-YY   TO HL1-RPT1-YY.                         10070036
100800     MOVE '/'             TO HL1-RPT1-S1                          10080036
100900                             HL1-RPT1-S2.                         10090036
101000     WRITE OUTPUT-REC                                             10100036
101100       FROM HEADING-LINE-1                                        10110036
101200         AFTER ADVANCING 2 LINES.                                 10120036
101300                                                                  10130036
101400     WRITE OUTPUT-REC                                             10140036
101500       FROM HEADING-LINE-2                                        10150036
101600         AFTER ADVANCING 2 LINES.                                 10160036
101700                                                                  10170036
101800     WRITE OUTPUT-REC                                             10180036
101900       FROM HEADING-LINE-3                                        10190036
102000         AFTER ADVANCING 1 LINES.                                 10200036
102100                                                                  10210036
102200     WRITE OUTPUT-REC                                             10220036
102300       FROM HEADING-LINE-4                                        10230036
102400         AFTER ADVANCING 1 LINES.                                 10240036
102500                                                                  10250036
102600     WRITE OUTPUT-REC                                             10260036
102700       FROM HEADING-LINE-5                                        10270036
102800         AFTER ADVANCING 1 LINES.                                 10280036
102900                                                                  10290036
103000     WRITE OUTPUT-REC                                             10300036
103100       FROM BLANK-LINE                                            10310036
103200         AFTER ADVANCING 1 LINES.                                 10320036
103300                                                                  10330036
103400     MOVE +9 TO PV-LINE-COUNT.                                    10340036
103500                                                                  10350036
103600     SET PS-NEW-PAGE TO TRUE.                                     10360036
103700                                                                  10370036
103800******************************************************************10380036
103900*  PRINT A 'NO INPUT' REPORT LINE.                               *10390036
104000******************************************************************10400036
104100 6100-NO-DETAIL-LINE.                                             10410036
104200                                                                  10420036
104300     WRITE OUTPUT-REC                                             10430036
104400       FROM NO-DATA-TO-REPORT-LINE                                10440036
104500         AFTER ADVANCING 3 LINES.                                 10450036
104600                                                                  10460036
104700******************************************************************10470036
104800*  PRINT A 'END OF REPORT' REPORT LINE.                          *10480036
104900******************************************************************10490036
105000 6200-END-OF-RPT-LINE.                                            10500036
105100                                                                  10510036
105200     WRITE OUTPUT-REC                                             10520036
105300       FROM END-OF-REPORT-LINE                                    10530036
105400         AFTER ADVANCING 3 LINES.                                 10540036
105500                                                                  10550036
105600******************************************************************10560036
105700*  PRINT A BLANK REPORT LINE.                                    *10570036
105800******************************************************************10580036
105900 6300-PRINT-BLANK-LINE.                                           10590036
106000                                                                  10600036
106100*CHECK FOR OVERFLOW.                                              10610036
106200     ADD 1 TO PV-LINE-COUNT.                                      10620036
106300     IF PV-LINE-COUNT > PC-MAX-LINE-COUNT                         10630036
106400         PERFORM 6000-PRINT-HEADINGS                              10640036
106500     ELSE                                                         10650036
106600*PRINT LINE.                                                      10660036
106700         WRITE OUTPUT-REC                                         10670036
106800           FROM BLANK-LINE                                        10680036
106900             AFTER ADVANCING 1 LINES                              10690036
107000     END-IF.                                                      10700036
107100                                                                  10710036
107200******************************************************************10720036
107300*  READ NEXT INPUT FILE RECORD.                                  *10730036
107400******************************************************************10740036
107500 7000-READ-EXTRACT.                                               10750036
107600                                                                  10760036
107700     READ INPUT-EXTRACT-FILE INTO RC053-ASN-RECVR-PKSLIP-ERRREC   10770036
107800       AT END                                                     10780036
107900         SET PS-END-OF-INPUT TO TRUE.                             10790036
108000                                                                  10800036
108100******************************************************************10810036
108200*  DB2 ABEND ROUTINE                                             *10820036
108300******************************************************************10830036
108400 Z999-SQL-ABEND.                                                  10840036
108500                                                                  10850036
108600     MOVE SQLCODE TO PV-SQLCODE.                                  10860036
108700     DISPLAY '*** DB2 ERROR '.                                    10870036
108800     DISPLAY '*** SQLCODE   = ' PV-SQLCODE.                       10880036
108900     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 10890036
109000     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               10900036
109100     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               10910036
109200     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       10920036
109300     DISPLAY '*** TABLE 1   = ' PV-DB2-TABLE-NAME.                10930036
109400                                                                  10940036
109500     COPY DPPD004.                                                10950036
109600                                                                  10960036
109700     MOVE +4013 TO PV-ABEND-CODE.                                 10970036
109800     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         10980036
109900******************************************************************10990036
110000******************************************************************11000036
