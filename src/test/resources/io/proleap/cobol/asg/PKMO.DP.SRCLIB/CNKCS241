000100 IDENTIFICATION DIVISION.                                         00010003
000200 PROGRAM-ID.    CNKCS241.                                         00020003
000300 AUTHOR.        DENISE HAHN.                                      00030003
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040003
000500 DATE-WRITTEN.  JUNE, 2012.                                       00050003
000600 DATE-COMPILED.                                                   00060003
000700******************************************************************00070003
000800*  CICS         Y241 - COMPANY CONTROL TABLE UPDATE              *00080003
000900*  THIS PROGRAM UPDATE APPLICATION CONTROL PARAMETERS IN TCOCNTL *00090003
001100******************************************************************00110003
263455* CHANGED 11/03/2021    BY JIM HUNTER      WR: CHG0263455         00111054
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00112054
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00113054
263455*----------------------------------------------------------------*00114054
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00115055
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00116055
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00117055
CICS  *-----------------------------------------------------------------00118055
001200 DATA DIVISION.                                                   00120003
001300 WORKING-STORAGE SECTION.                                         00130003
001400 01  PS-PROGRAM-SWITCHES.                                         00140003
001500     05  PS-ERROR-SW              PIC  X(01)  VALUE 'N'.          00150003
001600         88  PS-ERROR                         VALUE 'Y'.          00160003
001700         88  PS-NO-ERROR                      VALUE 'N'.          00170003
001710     05  PS-UPDATE-ALLOWED-SW     PIC  X(01)  VALUE 'N'.          00171040
001720         88  PS-UPDATE-ALLOWED                VALUE 'Y'.          00172040
001730         88  PS-UPDATE-NOT-ALLOWED            VALUE 'N'.          00173041
001800                                                                  00180003
001900 01  PC-PROGRAM-CONSTANTS.                                        00190003
002000     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE 'CN241A  '.   00200003
002100     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE 'CNKM241 '.   00210003
002200     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE 'CNKCS241'.   00220003
002300     05  PC-MAX-RETRIES           PIC S9(04)  VALUE +3 COMP.      00230003
002400     05  PC-MAX-LOCK-RETRIES      PIC S9(04)  VALUE +3 COMP.      00240003
002500     05  PC-MAX-MSG-VAR           PIC S9(04)  VALUE +1  COMP.     00250003
002600     05  PC-UPD-VSAM              PIC  X(01)  VALUE 'Y'.          00260003
002700     05  PC-MSG-VAR-SYMBOLIC      PIC  X(04)  VALUE '&VAR'.       00270003
002800     05  PC-APPL-MAP              PIC S9(04)  VALUE +1 COMP.      00280003
002810     05  PC-DPKCS060               PIC  X(08)  VALUE  'DPKCS060'. 00281005
002900                                                                  00290003
003000******************************************************************00300003
003100* 00004 - PRESS F2 TO CONFIRM REQUEST                             00310024
003101* 00005 - INVALID VALUE                                           00310124
003110* 00007 - REQUIRED ENTRY (DP)                                     00311008
003200* 00008 - MUST BE NUMERIC (DP)                                    00320003
003300* 00045 - INVALID FUNCTION KEY (DP)                               00330003
003400* 00059 - UPDATE(S) SUCCESSFUL                                    00340024
003410* 00746 - INVALID PRINTER DESTINATION                             00341024
003500* 00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES            00350024
003510* 02612 - YOU DO NOT HAVE AUTHORITY TO UPDATE                     00351039
003700******************************************************************00370003
003800                                                                  00380003
003900     05  PC-TSYMSG-NUMBERS.                                       00390003
004000         10  PC-TSYMSG-00004      PIC  9(05)  VALUE 00004.        00400024
004001         10  PC-TSYMSG-00005      PIC  9(05)  VALUE 00005.        00400124
004010         10  PC-TSYMSG-00007      PIC  9(05)  VALUE 00007.        00401008
004100         10  PC-TSYMSG-00008      PIC  9(05)  VALUE 00008.        00410003
004200         10  PC-TSYMSG-00045      PIC  9(05)  VALUE 00045.        00420003
004300         10  PC-TSYMSG-00059      PIC  9(05)  VALUE 00059.        00430003
004400         10  PC-TSYMSG-00746      PIC  9(05)  VALUE 00746.        00440032
004410         10  PC-TSYMSG-00984      PIC  9(05)  VALUE 00984.        00441008
004420         10  PC-TSYMSG-02612      PIC  9(05)  VALUE 02612.        00442039
004600                                                                  00460003
004700 01  PV-PROGRAM-VARIABLES.                                        00470003
004900     05  PV-RETRY-COUNTER         PIC S9(4) VALUE +0 COMP SYNC.   00490003
005000     05  PV-CICS-RESP             PIC S9(04)  VALUE +0            00500008
005100                                               COMP SYNC.         00510008
005200     05  PV-OPER-LENGTH           PIC S9(04)  VALUE +0            00520029
005300                                              COMP.               00530029
006300                                                                  00630003
006400                                                                  00640003
006500*----------------------------------------------------------------*00650003
006600*    SECURITY SUBROUTINE PARAMETERS                              *00660003
006700*----------------------------------------------------------------*00670003
006800     COPY DPWS008.                                                00680003
006900                                                                  00690003
007000*----------------------------------------------------------------*00700003
007100*    THE CALLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT   *00710003
007200*    SUB-ROUTINE (DPKUT100).                                     *00720003
007300*----------------------------------------------------------------*00730003
007400     COPY DPWS010I.                                               00740003
007500                                                                  00750003
007600*----------------------------------------------------------------*00760003
007700*  WORK AREA PASSED IN CALL TO DPKUT500                          *00770003
007800*----------------------------------------------------------------*00780003
007900*    COPY DPWS500.                                                00790003
008000*                                                                 00800003
008100*----------------------------------------------------------------*00810003
008200*    MAP LAYOUT                                                  *00820003
008300*----------------------------------------------------------------*00830003
008400     COPY CNKM241.                                                00840003
008500                                                                  00850003
008600*----------------------------------------------------------------*00860003
008700*    ATTRIBUTE SETTINGS COPYBOOK.                                *00870003
008800*----------------------------------------------------------------*00880003
008900     COPY DPWS015.                                                00890003
009000                                                                  00900003
009100*----------------------------------------------------------------*00910003
009200*    FUNCTION KEYS COPYBOOK                                      *00920003
009300*----------------------------------------------------------------*00930003
009400     COPY DPWS016.                                                00940003
009500                                                                  00950003
009600***************************************************************** 00960003
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 00970055
009800***************************************************************** 00980003
009900     COPY DPWS030.                                                00990003
CICS       COPY DPWS930.                                                00991055
010000                                                                  01000003
010100***************************************************************** 01010003
010200*    STANDARD COMMAREA.                                           01020003
010300***************************************************************** 01030003
010400     COPY DPWS020.                                                01040003
010500     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01050003
010600                                                                  01060003
010700***************************************************************** 01070003
010800*    INTER-APPLICATION COMMAREA.                                  01080003
010900***************************************************************** 01090003
011000         10  INTER-APPL-COMM-AREA PIC X(200).                     01100003
011100*                                                                 01110003
011200***************************************************************** 01120003
011300*    SPECIFIC COMMMAREA FOR CNKCS241.                             01130003
011400***************************************************************** 01140003
011500         10  ASC-SPECIFIC-COMMAREA.                               01150003
011600             15  ASC-FIRST-PASS-SW       PIC X(01).               01160006
011601                 88  ASC-FIRST-PASS          VALUE 'Y'.           01160106
011602                 88  ASC-FIRST-PASS-NO       VALUE 'N'.           01160206
011603             15  ASC-KNOWN-OPER-SW       PIC X(01).               01160350
011604                 88  ASC-UNKNOWN-OPER        VALUE 'N'.           01160450
011605                 88  ASC-KNOWN-OPER          VALUE 'Y'.           01160550
011606             15  ASC-CONFIRM-TYPE-IND        PIC  X(01).          01160624
011607                 88  ASC-CONFIRM-NONE                   VALUE 'N'.01160724
011608                 88  ASC-CONFIRM-UPDATE                 VALUE 'U'.01160824
011609             15  ASC-PROTECT-OPER-IND        PIC  X(01).          01160928
011610                 88  ASC-PROTECT-OPER-NO                VALUE 'N'.01161028
011611                 88  ASC-PROTECT-OPER-YES               VALUE 'Y'.01161128
011620             15  ASC-OPER-UNT-ID         PIC X(04).               01162006
011700             15  ASC-OPER-UNT-ID-N           REDEFINES            01170004
011800                 ASC-OPER-UNT-ID         PIC 9(04).               01180004
011900             15  ASC-LOC-TYP-CDE         PIC X(02).               01190052
011901                 88  ASC-LOC-HQ                       VALUE 'HQ'. 01190152
011902                 88  ASC-LOC-DC                       VALUE 'DC'. 01190252
011910             15  ASC-OPER-NAME           PIC X(25).               01191052
012000             15  ASC-CASEPK-LABEL-SEQ    PIC X(01).               01200004
012100                 88  ASC-DOOR-ORDER          VALUE 'D'.           01210004
012110                 88  ASC-STORE-ORDER         VALUE 'R'.           01211004
012120                 88  ASC-SHUFFLED-ORDER      VALUE 'S'.           01212004
012130                 88  ASC-VALID-LBL-SEQ       VALUE 'D' 'R' 'S'.   01213004
012200             15  ASC-CASEPK-CRE-LBL      PIC X(01).               01220004
012300                 88  ASC-P2L-ONLY            VALUE 'P'.           01230004
012310                 88  ASC-CASE-ONLY           VALUE 'C'.           01231004
012320                 88  ASC-BOTH-P2L-CASE       VALUE 'B'.           01232004
012330                 88  ASC-VALID-CRE-LBL       VALUE 'P' 'C' 'B'.   01233004
012400             15  ASC-RF-PRINT-ON-SCAN    PIC X(04).               01240004
012410             15  ASC-RF-PRINT-ON-SCAN-N      REDEFINES            01241004
012500                 ASC-RF-PRINT-ON-SCAN    PIC 9(04).               01250004
012510             15  ASC-DAYS-ADJ-ALLOW      PIC X(04).               01251004
012520             15  ASC-DAYS-ADJ-ALLOW-N        REDEFINES            01252004
012530                 ASC-DAYS-ADJ-ALLOW      PIC 9(04).               01253004
012600             15  ASC-DEFAULT-OPER-SET    PIC X(04).               01260004
012610             15  ASC-DEFAULT-OPER-SET-N      REDEFINES            01261004
012620                 ASC-DEFAULT-OPER-SET    PIC 9(04).               01262004
012621             15  ASC-OPER-SET-NAME       PIC X(25).               01262104
012630             15  ASC-FULLCASE-PRCS-AREA  PIC X(06).               01263004
012640             15  ASC-CENTRL-STK-LBL-QTY  PIC X(04).               01264004
012650             15  ASC-CENTRL-STK-LBL-QTY-N    REDEFINES            01265004
012660                 ASC-CENTRL-STK-LBL-QTY  PIC 9(04).               01266004
012661             15  ASC-CENTRL-PL-PRT-CD    PIC X(01).               01266121
012662                 88  ASC-CS-AUTOMATIC        VALUE 'A'.           01266204
012663                 88  ASC-CS-MANUAL           VALUE 'M'.           01266304
012665                 88  ASC-VALID-CS-CODE       VALUE 'A' 'M'.       01266504
012667             15  ASC-CENTRL-STK-LOC-ID   PIC X(04).               01266704
012668             15  ASC-CENTRL-STK-LOC-ID-N     REDEFINES            01266804
012669                 ASC-CENTRL-STK-LOC-ID   PIC 9(04).               01266904
012670             15  ASC-CENTRL-STK-NAME     PIC X(25).               01267004
012671             15  ASC-RCVG-PRINTER-ID     PIC X(08).               01267104
012672             15  ASC-FLAT-PRINTER-ID     PIC X(08).               01267204
012673             15  ASC-SHIP-PRINTER-ID     PIC X(08).               01267304
012674             15  ASC-SU-PRINTER-ID       PIC X(08).               01267404
012680             15  ASC-CNTL-STK-PRTR-ID    PIC X(08).               01268004
012700         10  FILLER                      PIC X(200).              01270003
012800*                                                                 01280003
012900*----------------------------------------------------------------*01290003
013000*    ABEND PROCESSING COPYBOOK.                                  *01300003
013100*----------------------------------------------------------------*01310003
013200     COPY DPWS013.                                                01320003
013300                                                                  01330003
013400*** COMPANY CONTROL TABLE                                         01340003
013500*                                                                 01350003
013600     EXEC SQL                                                     01360003
013700          INCLUDE TCOCNTL                                         01370003
013800     END-EXEC.                                                    01380003
013900                                                                  01390003
014000*** XLT_LOC                                                       01400004
014100*                                                                 01410004
014200     EXEC SQL                                                     01420004
014300          INCLUDE XLT00010                                        01430004
014400     END-EXEC.                                                    01440004
014500                                                                  01450004
014510*** OPER SET                                                      01451004
014520*                                                                 01452004
014530     EXEC SQL                                                     01453004
014540          INCLUDE TOPRSET                                         01454004
014550     END-EXEC.                                                    01455004
014560                                                                  01456004
014570*** TPRTRID                                                       01457010
014580*                                                                 01458010
014590     EXEC SQL                                                     01459010
014591          INCLUDE TPRTRID                                         01459110
014592     END-EXEC.                                                    01459211
014593                                                                  01459310
014600*DB2 AREA FOR COMMUNICATIONS                                      01460003
014700     EXEC SQL                                                     01470003
014800          INCLUDE SQLCA                                           01480003
014900     END-EXEC.                                                    01490003
015000                                                                  01500003
015100/*****************************************************************01510003
015200 LINKAGE SECTION.                                                 01520003
015300******************************************************************01530003
015400 01  DFHCOMMAREA.                                                 01540003
015500     05  FILLER                         OCCURS  1 TO 4072 TIMES   01550003
015600                                        DEPENDING ON EIBCALEN.    01560003
015700         10  FILLER                     PIC  X(01).               01570003
015800                                                                  01580003
015900 PROCEDURE DIVISION.                                              01590003
016000***************************************************************** 01600003
016100** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 01610003
016200** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 01620003
016300** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 01630003
016400**                                                             ** 01640003
016500** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 01650003
016600** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 01660003
016700***************************************************************** 01670003
016800 0000-MAIN-MODULE.                                                01680003
016900                                                                  01690003
017000     INITIALIZE DP030-CICS-API-FIELDS.                            01700003
017100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       01710003
017200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          01720003
017300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         01730003
017400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       01740003
017500     MOVE LENGTH OF CN241AI        TO DP030-MAP-LENGTH (1).       01750003
017600     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     01760003
017700     PERFORM 0001-CALL-CICS-ARCH-API.                             01770003
017800                                                                  01780003
017900     PERFORM 1000-CONTROL-PROCESSING                              01790003
018000                                                                  01800003
018100     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     01810003
018200     PERFORM 0001-CALL-CICS-ARCH-API.                             01820003
018300                                                                  01830003
018400******************************************************************01840003
018500 0001-CALL-CICS-ARCH-API.                                         01850003
018600                                                                  01860003
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      01870055
018800                                    DFHCOMMAREA                   01880055
018900                                    DP030-CICS-API-FIELDS         01890055
019000                                    DP020-STANDARD-COMMAREA       01900055
019100                                    CN241AI.                      01910055
019200                                                                  01920003
019300     IF  DP030-RC-CALL-SUCCESSFUL                                 01930003
019400         CONTINUE                                                 01940003
019500     ELSE                                                         01950003
019600         SET DP013-NO-ROLLBACK                                    01960003
019700             DP013-XCTL-DISPLAY-RESTART                           01970003
019800             DP013-CICS-ABEND      TO TRUE                        01980003
019900         MOVE 'BEFORE 0000-MAIN-MODULE'                           01990003
020000                                   TO DP013-PARAGRAPH             02000003
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O02001055
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      02002055
020300         MOVE DP030-RETURN-CODE                                   02030003
020400                                   TO DP013-MESSAGE-TEXT (3)      02040003
020500         PERFORM DP013-0000-PROCESS-ABEND                         02050003
020600     END-IF.                                                      02060003
020700                                                                  02070003
020800*----------------------------------------------------------------*02080003
020900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02090003
021000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02100003
021100*----------------------------------------------------------------*02110003
021200 1000-CONTROL-PROCESSING.                                         02120003
021300                                                                  02130003
021400     EVALUATE TRUE                                                02140003
021500        WHEN DP020-NEXT-ACT-INITIAL                               02150003
021600             INITIALIZE ASC-SPECIFIC-COMMAREA                     02160003
021700                                                                  02170003
021710             SET  ASC-FIRST-PASS                                  02171028
021711                  ASC-UNKNOWN-OPER                                02171150
021720                  ASC-PROTECT-OPER-NO  TO  TRUE                   02172028
021800             MOVE ZEROES         TO ASC-OPER-UNT-ID-N             02180004
021801             MOVE ZEROES         TO ASC-RF-PRINT-ON-SCAN-N        02180104
021802             MOVE ZEROES         TO ASC-DAYS-ADJ-ALLOW-N          02180204
021803             MOVE ZEROES         TO ASC-DEFAULT-OPER-SET-N        02180304
021804             MOVE ZEROES         TO ASC-CENTRL-STK-LBL-QTY-N      02180404
021805             MOVE ZEROES         TO ASC-CENTRL-STK-LOC-ID-N       02180508
021807                                                                  02180704
021808             MOVE SPACES         TO ASC-OPER-NAME                 02180804
021809             MOVE SPACES         TO ASC-CASEPK-LABEL-SEQ          02180904
021810             MOVE SPACES         TO ASC-CASEPK-CRE-LBL            02181004
021811             MOVE SPACES         TO ASC-OPER-SET-NAME             02181104
021812             MOVE SPACES         TO ASC-FULLCASE-PRCS-AREA        02181204
021813             MOVE SPACES         TO ASC-CENTRL-PL-PRT-CD          02181322
021814             MOVE SPACES         TO ASC-CENTRL-STK-NAME           02181404
021815             MOVE SPACES         TO ASC-RCVG-PRINTER-ID           02181504
021816             MOVE SPACES         TO ASC-FLAT-PRINTER-ID           02181604
021817             MOVE SPACES         TO ASC-SHIP-PRINTER-ID           02181704
021818             MOVE SPACES         TO ASC-SU-PRINTER-ID             02181804
021819             MOVE SPACES         TO ASC-CNTL-STK-PRTR-ID          02181904
022200                                                                  02220003
022300             PERFORM 1100-CHECK-SECURITY                          02230003
022400             PERFORM 3200-RESET-ATTRIBUTES                        02240003
022500             PERFORM 4000-BUILD-INITIAL-PANEL                     02250003
022600                                                                  02260003
022700       WHEN DP020-NEXT-ACT-READ-MAP                               02270003
022800            PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                  02280003
022801                                                                  02280113
023000           IF  PS-ERROR                                           02300003
023100               CONTINUE                                           02310003
023200           ELSE                                                   02320003
023300               PERFORM 2000-PROCESS-PANEL                         02330003
023400           END-IF                                                 02340003
023500                                                                  02350003
023600       WHEN DP020-NEXT-ACT-RETURN                                 02360003
023700           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   02370003
023800                                                                  02380003
023900       WHEN OTHER                                                 02390003
024000           SET DP013-LOGIC-ABEND                                  02400003
024100               DP013-NO-ROLLBACK TO TRUE                          02410003
024200           MOVE '1000-CONTROL-PROCESSING'                         02420003
024300                                 TO DP013-PARAGRAPH               02430003
024400           MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'     02440003
024500                                 TO DP013-MESSAGE-TEXT(1)         02450003
024600           MOVE DP020-NEXT-APPL-ACTIVITY                          02460003
024700                                 TO DP013-MESSAGE-TEXT(2)         02470003
024800           PERFORM DP013-0000-PROCESS-ABEND                       02480003
024900     END-EVALUATE.                                                02490003
025000                                                                  02500003
025100*----------------------------------------------------------------*02510003
025200*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *02520003
025300*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *02530003
025400*----------------------------------------------------------------*02540003
025500 1100-CHECK-SECURITY.                                             02550003
025600                                                                  02560003
025700     SET DP008-RSRC-TYPE-FUNC       TO TRUE.                      02570003
025800     SET DP008-ACCESS-TYPE-USE      TO TRUE.                      02580003
025900     PERFORM 1110-LINK-TO-SECURITY.                               02590003
026000                                                                  02600003
026100******************************************************************02610003
026200 1110-LINK-TO-SECURITY.                                           02620003
026300                                                                  02630003
026400     EXEC CICS LINK                                               02640003
026500               PROGRAM  (DP008-SECURITY-SUBROUTINE)               02650003
026600               COMMAREA (DP008-SECURITY-COMMAREA)                 02660003
026700               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          02670003
026800     END-EXEC.                                                    02680003
026900                                                                  02690003
027000     IF DP008-CALL-SUCCESSFUL                                     02700003
027100         CONTINUE                                                 02710003
027200     ELSE                                                         02720003
027300         SET DP013-XCTL-DISPLAY-LOGOFF TO TRUE                    02730003
027400         SET DP013-SECURITY-ABEND      TO TRUE                    02740003
027500         MOVE '1110-LINK-TO-SECURITY'  TO DP013-PARAGRAPH         02750003
027600         MOVE DP008-SECURITY-COMMAREA  TO DP013-SECURITY-INFO     02760003
027700         PERFORM DP013-0000-PROCESS-ABEND                         02770003
027800     END-IF.                                                      02780003
027900                                                                  02790003
028000*----------------------------------------------------------------*02800003
028100* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*02810003
028200* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*02820003
028300* EDITS.                                                         *02830003
028400*----------------------------------------------------------------*02840003
028500 2000-PROCESS-PANEL.                                              02850003
028600                                                                  02860003
028700     EVALUATE TRUE                                                02870003
028800       WHEN DP020-SRC-AID = DP016-CLEAR                           02880003
028900           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   02890003
029000           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     02900003
029100                                                                  02910003
029200       WHEN DP020-FK-REFRESH(DP020-SRC-AID)                       02920003
029300           INITIALIZE ASC-SPECIFIC-COMMAREA                       02930003
029400                                                                  02940003
029410             SET  ASC-FIRST-PASS                                  02941028
029411                  ASC-PROTECT-OPER-NO                             02941128
029412                  ASC-UNKNOWN-OPER                                02941250
029413                  ASC-CONFIRM-NONE  TO  TRUE                      02941350
029414             MOVE ZEROES         TO ASC-OPER-UNT-ID-N             02941450
029420             MOVE ZEROES         TO ASC-RF-PRINT-ON-SCAN-N        02942004
029430             MOVE ZEROES         TO ASC-DAYS-ADJ-ALLOW-N          02943004
029440             MOVE ZEROES         TO ASC-DEFAULT-OPER-SET-N        02944004
029450             MOVE ZEROES         TO ASC-CENTRL-STK-LBL-QTY-N      02945004
029460             MOVE ZEROES         TO ASC-CENTRL-STK-LOC-ID-N       02946008
029470                                                                  02947004
029480             MOVE SPACES         TO ASC-OPER-UNT-ID               02948046
029481             MOVE SPACES         TO ASC-OPER-NAME                 02948146
029490             MOVE SPACES         TO ASC-CASEPK-LABEL-SEQ          02949004
029491             MOVE SPACES         TO ASC-CASEPK-CRE-LBL            02949104
029492             MOVE SPACES         TO ASC-OPER-SET-NAME             02949204
029493             MOVE SPACES         TO ASC-FULLCASE-PRCS-AREA        02949304
029494             MOVE SPACES         TO ASC-CENTRL-PL-PRT-CD          02949422
029495             MOVE SPACES         TO ASC-CENTRL-STK-NAME           02949504
029496             MOVE SPACES         TO ASC-RCVG-PRINTER-ID           02949604
029497             MOVE SPACES         TO ASC-FLAT-PRINTER-ID           02949704
029498             MOVE SPACES         TO ASC-SHIP-PRINTER-ID           02949804
029499             MOVE SPACES         TO ASC-SU-PRINTER-ID             02949904
029500             MOVE SPACES         TO ASC-CNTL-STK-PRTR-ID          02950004
029510                                                                  02951047
029600             MOVE ASC-OPER-UNT-ID      TO AOPERO                  02960047
029900                                                                  02990003
030000           PERFORM 3200-RESET-ATTRIBUTES                          03000003
030100           PERFORM 4000-BUILD-INITIAL-PANEL                       03010003
030200                                                                  03020003
030320       WHEN OTHER                                                 03032006
030400           PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                   03040003
030500           PERFORM 3000-EDIT-DATA-IN-COMMAREA                     03050003
030600           IF PS-NO-ERROR                                         03060003
030700               SET DP030-CONTINUE-GO TO TRUE                      03070003
030800               PERFORM 2100-CHECK-FUNCTION-KEY                    03080003
030900           ELSE                                                   03090003
031000               SET DP030-OVERRIDE-GO TO TRUE                      03100003
031100               PERFORM 4400-MOVE-COMMAREA-TO-SCREEN               03110003
031200           END-IF                                                 03120003
031300     END-EVALUATE.                                                03130003
031400                                                                  03140003
031500******************************************************************03150003
031600** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **03160003
031700** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **03170003
031800** FROM THE CICS ARCHITECTURE API.                              **03180003
031900******************************************************************03190003
032000 2100-CHECK-FUNCTION-KEY.                                         03200003
032100                                                                  03210003
032200     EVALUATE TRUE                                                03220003
032501                                                                  03250106
032510         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              03251006
032511              PERFORM 2105-RACF-ACCESS                            03251139
032512              IF  PS-UPDATE-ALLOWED                               03251239
032515                  SET  ASC-CONFIRM-UPDATE   TO  TRUE              03251539
032516                  IF  PS-NO-ERROR                                 03251639
032700                      MOVE PC-TSYMSG-00004 TO DP020-MSG-NUMBER    03270039
032800                      MOVE DP015-UNP-ALP-BRT-OFF   TO AOPERA      03280039
032900                      MOVE -1                      TO AOPERL      03290039
033000                      SET DP030-SET-CURSOR-APPL-1                 03300039
033100                          DP020-MSG-INFORMATIONAL  TO TRUE        03310039
033200                  END-IF                                          03320039
033210              ELSE                                                03321039
033211                  SET PS-ERROR  TO  TRUE                          03321139
033212                  MOVE PC-TSYMSG-02612 TO DP020-MSG-NUMBER        03321239
033213                  MOVE DP015-UNP-ALP-BRT-OFF   TO AOPERA          03321339
033214                  MOVE -1                      TO AOPERL          03321439
033215                  SET DP030-SET-CURSOR-APPL-1                     03321539
033216                      DP020-MSG-INFORMATIONAL  TO TRUE            03321639
033220              END-IF                                              03322039
033300                                                                  03330003
033400           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03340003
033410           PERFORM 3210-RESET-ATTRIBUTES-PROT                     03341024
033500                                                                  03350003
033600       WHEN DP020-SRC-AID = DP016-ENTER                           03360003
033700           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   03370003
033710*                                                                 03371024
033720* F2-CONFIRM -                                                    03372024
033730*                                                                 03373024
033740         WHEN DP020-FK-CONFIRM (DP020-SRC-AID)                    03374024
033760              EVALUATE TRUE                                       03376024
033770                  WHEN ASC-CONFIRM-UPDATE                         03377024
033780                       PERFORM 5000-UPDATE                        03378024
033790                       IF PS-NO-ERROR                             03379024
033791* SUCCESSFUL UPDATE                                               03379124
033793                          MOVE PC-TSYMSG-00059                    03379324
033794                            TO DP020-MSG-NUMBER                   03379424
033795                          MOVE DP015-UNP-ALP-BRT-OFF              03379524
033796                            TO AOPERA                             03379624
033797                          MOVE -1       TO AOPERL                 03379724
033798                          SET DP030-SET-CURSOR-APPL-1             03379824
033799                              DP020-MSG-INFORMATIONAL  TO TRUE    03379924
033800                                                                  03380024
033801                          SET ASC-FIRST-PASS                      03380128
033802                              ASC-UNKNOWN-OPER                    03380250
033803                              ASC-PROTECT-OPER-NO   TO  TRUE      03380350
033804                          PERFORM 3200-RESET-ATTRIBUTES           03380450
033805                          MOVE ZEROES                             03380550
033806                                      TO ASC-OPER-UNT-ID-N        03380650
033807                                         ASC-RF-PRINT-ON-SCAN-N   03380750
033808                                         ASC-DAYS-ADJ-ALLOW-N     03380850
033809                                         ASC-DEFAULT-OPER-SET-N   03380950
033810                                         ASC-CENTRL-STK-LBL-QTY-N 03381050
033811                                         ASC-CENTRL-STK-LOC-ID-N  03381150
033812                          MOVE SPACES                             03381250
033813                                      TO ASC-OPER-NAME            03381350
033814                                         ASC-CASEPK-LABEL-SEQ     03381450
033815                                         ASC-CASEPK-CRE-LBL       03381550
033816                                         ASC-OPER-SET-NAME        03381650
033817                                         ASC-FULLCASE-PRCS-AREA   03381750
033818                                         ASC-CENTRL-PL-PRT-CD     03381850
033819                                         ASC-CENTRL-STK-NAME      03381950
033820                                         ASC-RCVG-PRINTER-ID      03382050
033821                                         ASC-FLAT-PRINTER-ID      03382150
033822                                         ASC-SHIP-PRINTER-ID      03382250
033823                                         ASC-SU-PRINTER-ID        03382350
033824                                         ASC-CNTL-STK-PRTR-ID     03382450
033825                       END-IF                                     03382550
033826                                                                  03382650
033827                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       03382750
033828                                                                  03382850
033829                  WHEN OTHER                                      03382950
033830                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       03383050
033831                       SET  PS-ERROR                              03383150
033832                            DP020-MSG-FATAL  TO TRUE              03383250
033833                       MOVE PC-TSYMSG-00045  TO DP020-MSG-NUMBER  03383350
033834                                                                  03383450
033835             END-EVALUATE                                         03383550
033841                                                                  03384124
033842             SET  ASC-CONFIRM-NONE  TO  TRUE                      03384224
033850                                                                  03385024
033900       WHEN OTHER                                                 03390003
034000           SET DP013-NO-ROLLBACK                                  03400003
034100               DP013-XCTL-DISPLAY-RESTART                         03410003
034200               DP013-CICS-ABEND  TO TRUE                          03420003
034300           MOVE '2100-CHECK-FUNCTION-KEY'                         03430003
034400                                 TO DP013-PARAGRAPH               03440003
034500           MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'        03450003
034600                                 TO DP013-MESSAGE-TEXT (1)        03460003
034700           PERFORM DP013-0000-PROCESS-ABEND                       03470003
034800     END-EVALUATE.                                                03480003
034900                                                                  03490003
034910*----------------------------------------------------------------*03491039
034920* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR UPDATE FUNCTION*03492039
034930*----------------------------------------------------------------*03493039
034940 2105-RACF-ACCESS.                                                03494039
034950                                                                  03495039
034960      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  03496039
034970      MOVE 'CNUCOCTL'                    TO DP008-FUNCTION-NAME   03497039
034980      SET DP008-ACCESS-TYPE-USE          TO TRUE                  03498039
034990                                                                  03499039
034991      EXEC CICS                                                   03499139
034992         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 03499239
034993              COMMAREA (DP008-SECURITY-COMMAREA)                  03499339
034994              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             03499439
034995      END-EXEC                                                    03499539
034996                                                                  03499639
034997      IF DP008-CALL-SUCCESSFUL                                    03499739
034998         IF DP008-ACCESS-ALLOWED                                  03499839
034999             SET PS-UPDATE-ALLOWED TO TRUE                        03499939
035000         ELSE                                                     03500039
035001             SET PS-UPDATE-NOT-ALLOWED TO TRUE                    03500139
035002         END-IF                                                   03500239
035003     ELSE                                                         03500339
035004         MOVE '2105-RACF-ACCESS'                                  03500439
035005                               TO DP013-PARAGRAPH                 03500539
035006          MOVE 'UNABLE TO ACCESS CICS'                            03500639
035007                               TO DP013-MESSAGE-TEXT (1)          03500739
035008          MOVE SQLCA                 TO DP013-SQLCA               03500839
035009          SET DP013-DB2-ABEND                                     03500939
035010              DP013-XCTL-DISPLAY-RESTART                          03501039
035011                               TO TRUE                            03501139
035012          PERFORM DP013-0000-PROCESS-ABEND                        03501239
035013      END-IF.                                                     03501339
035014                                                                  03501439
035015                                                                  03501539
035016                                                                  03501639
035020*----------------------------------------------------------------*03502003
035100* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*03510003
035200* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *03520003
035300* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *03530003
035400*----------------------------------------------------------------*03540003
035500 2200-MOVE-SCREEN-TO-COMMAREA.                                    03550003
035600                                                                  03560003
035700     IF AOPERL > ZERO                                             03570004
035800         MOVE AOPERI TO ASC-OPER-UNT-ID                           03580004
035900     ELSE                                                         03590003
036000         IF  ASC-OPER-UNT-ID > SPACES                             03600004
036100             CONTINUE                                             03610003
036200         ELSE                                                     03620003
036300             SET PS-ERROR                                         03630003
036400                 DP020-MSG-FATAL         TO TRUE                  03640003
036500             MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER      03650003
036600             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                03660004
036700             MOVE DP015-RED              TO AOPERC                03670004
036800             MOVE DP015-REVERSE          TO AOPERH                03680004
036900             MOVE -1                     TO AOPERL                03690004
037000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03700003
037100         END-IF                                                   03710003
037110     END-IF.                                                      03711004
037200                                                                  03720003
037210     IF  ASC-OPER-UNT-ID > SPACES                                 03721014
037220         MOVE ASC-OPER-UNT-ID         TO DP010I-UNEDITED-FIELD    03722014
037230         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  03723014
037240         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  03724014
037250         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  03725014
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         03726154
263455              USING DP010I-NUMERIC-EDIT-AREA                      03726254
037270         IF  DP010I-ERROR-DETECTED                                03727014
037280             SET PS-ERROR                                         03728014
037290                 DP020-MSG-FATAL         TO TRUE                  03729014
037291             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      03729114
037292             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                03729214
037293             MOVE DP015-RED              TO AOPERC                03729314
037294             MOVE DP015-REVERSE          TO AOPERH                03729414
037295             MOVE -1                     TO AOPERL                03729514
037296             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  03729614
037297         ELSE                                                     03729714
037298             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       03729814
037299             MOVE ASC-OPER-UNT-ID      TO AOPERO                  03729914
037300         END-IF                                                   03730014
037301     END-IF.                                                      03730114
037302                                                                  03730214
037303     IF  ASC-OPER-UNT-ID > SPACES  AND                            03730314
037310         ASC-FIRST-PASS                                           03731014
037311         SET ASC-FIRST-PASS-NO                                    03731153
037312             ASC-UNKNOWN-OPER                                     03731253
037313             ASC-PROTECT-OPER-YES    TO TRUE                      03731353
037314         PERFORM 3120-GET-COCNTL-SETTINGS                         03731414
037316         MOVE DP015-PRO-NOR-OFF      TO AOPERA                    03731650
037317         MOVE DP015-BLUE             TO AOPERC                    03731750
037318         MOVE -1                     TO ALBLSQL                   03731850
037319     END-IF.                                                      03731950
037320                                                                  03732050
037321     IF  ASC-KNOWN-OPER                                           03732151
037330         IF ALBLSQL > ZERO                                        03733050
037400             MOVE ALBLSQI TO ASC-CASEPK-LABEL-SEQ                 03740050
037500         ELSE                                                     03750050
037600             IF  ASC-CASEPK-LABEL-SEQ  >  SPACES                  03760050
037700                 CONTINUE                                         03770050
037800             ELSE                                                 03780050
037900                 SET PS-ERROR                                     03790050
038000                     DP020-MSG-FATAL         TO TRUE              03800050
038100                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  03810050
038200                 MOVE DP015-UNP-ALP-BRT-OFF  TO ALBLSQA           03820050
038300                 MOVE DP015-RED              TO ALBLSQC           03830050
038400                 MOVE DP015-REVERSE          TO ALBLSQH           03840050
038500                 MOVE -1                     TO ALBLSQL           03850050
038600                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              03860050
038700             END-IF                                               03870050
038710         END-IF                                                   03871050
038800     END-IF.                                                      03880003
038900                                                                  03890003
039000     IF  ASC-KNOWN-OPER                                           03900051
039020         IF ACRELBL > ZERO                                        03902050
039100             MOVE ACRELBI TO ASC-CASEPK-CRE-LBL                   03910050
039200         ELSE                                                     03920050
039300             IF  ASC-CASEPK-CRE-LBL  >  SPACES                    03930050
039400                 CONTINUE                                         03940050
039500             ELSE                                                 03950050
039600                 SET PS-ERROR                                     03960050
039700                     DP020-MSG-FATAL         TO TRUE              03970050
039800                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  03980050
039900                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACRELBA           03990050
040000                 MOVE DP015-RED              TO ACRELBC           04000050
040100                 MOVE DP015-REVERSE          TO ACRELBH           04010050
040200                 MOVE -1                     TO ACRELBL           04020050
040300                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04030050
040400             END-IF                                               04040050
040410         END-IF                                                   04041050
040500     END-IF.                                                      04050003
040600                                                                  04060003
040700     IF  ASC-KNOWN-OPER                                           04070051
040710         IF ARFSCNL > ZERO                                        04071050
040800             MOVE ARFSCNI TO ASC-RF-PRINT-ON-SCAN                 04080050
040900         ELSE                                                     04090050
041000             IF  ASC-RF-PRINT-ON-SCAN  >  SPACES                  04100050
041100                 CONTINUE                                         04110050
041200             ELSE                                                 04120050
041300                 SET PS-ERROR                                     04130050
041400                     DP020-MSG-FATAL         TO TRUE              04140050
041500                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04150050
041600                 MOVE DP015-UNP-ALP-BRT-OFF  TO ARFSCNA           04160050
041700                 MOVE DP015-RED              TO ARFSCNC           04170050
041800                 MOVE DP015-REVERSE          TO ARFSCNH           04180050
041900                 MOVE -1                     TO ARFSCNL           04190050
042000                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04200050
042100             END-IF                                               04210050
042110         END-IF                                                   04211050
042200     END-IF.                                                      04220003
042300                                                                  04230003
042301     IF  ASC-KNOWN-OPER                                           04230151
042310         IF AADJDYL > ZERO                                        04231050
042320             MOVE AADJDYI TO ASC-DAYS-ADJ-ALLOW                   04232050
042330         ELSE                                                     04233050
042340             IF  ASC-DAYS-ADJ-ALLOW  >  SPACES                    04234050
042350                 CONTINUE                                         04235050
042360             ELSE                                                 04236050
042370                 SET PS-ERROR                                     04237050
042371                     DP020-MSG-FATAL         TO TRUE              04237150
042372                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04237250
042373                 MOVE DP015-UNP-ALP-BRT-OFF  TO AADJDYA           04237350
042374                 MOVE DP015-RED              TO AADJDYC           04237450
042375                 MOVE DP015-REVERSE          TO AADJDYH           04237550
042376                 MOVE -1                     TO AADJDYL           04237650
042377                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04237750
042378             END-IF                                               04237850
042379         END-IF                                                   04237950
042380     END-IF.                                                      04238050
042381                                                                  04238150
042382     IF  ASC-KNOWN-OPER                                           04238251
042383         IF AOPRSTL > ZERO                                        04238350
042384             MOVE AOPRSTI TO ASC-DEFAULT-OPER-SET                 04238450
042385         ELSE                                                     04238550
042386             IF  ASC-DEFAULT-OPER-SET  >  SPACES                  04238650
042387                 CONTINUE                                         04238750
042388             ELSE                                                 04238850
042389                 SET PS-ERROR                                     04238950
042390                     DP020-MSG-FATAL         TO TRUE              04239050
042391                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04239150
042392                 MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRSTA           04239250
042393                 MOVE DP015-RED              TO AOPRSTC           04239350
042394                 MOVE DP015-REVERSE          TO AOPRSTH           04239450
042395                 MOVE -1                     TO AOPRSTL           04239550
042396                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04239650
042397             END-IF                                               04239750
042398         END-IF                                                   04239850
042399     END-IF.                                                      04239950
042400                                                                  04240050
042401     IF  ASC-KNOWN-OPER                                           04240151
042402         IF AFULCSL > ZERO                                        04240250
042403             MOVE AFULCSI TO ASC-FULLCASE-PRCS-AREA               04240350
042404         ELSE                                                     04240450
042405             IF  ASC-FULLCASE-PRCS-AREA  >  SPACES                04240550
042406                 CONTINUE                                         04240650
042407             ELSE                                                 04240750
042408                 SET PS-ERROR                                     04240850
042409                     DP020-MSG-FATAL         TO TRUE              04240950
042410                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04241050
042411                 MOVE DP015-UNP-ALP-BRT-OFF  TO AFULCSA           04241150
042412                 MOVE DP015-RED              TO AFULCSC           04241250
042413                 MOVE DP015-REVERSE          TO AFULCSH           04241350
042414                 MOVE -1                     TO AFULCSL           04241450
042415                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04241550
042416             END-IF                                               04241650
042417         END-IF                                                   04241750
042418     END-IF.                                                      04241850
042419                                                                  04241950
042420     IF  ASC-KNOWN-OPER                                           04242051
042421         IF ACSLBLL > ZERO                                        04242150
042422             MOVE ACSLBLI TO ASC-CENTRL-STK-LBL-QTY               04242250
042423         ELSE                                                     04242350
042424             IF  ASC-CENTRL-STK-LBL-QTY  >  SPACES                04242450
042425                 CONTINUE                                         04242550
042426             ELSE                                                 04242650
042427                 SET PS-ERROR                                     04242750
042428                     DP020-MSG-FATAL         TO TRUE              04242850
042429                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04242950
042430                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACSLBLA           04243050
042431                 MOVE DP015-RED              TO ACSLBLC           04243150
042432                 MOVE DP015-REVERSE          TO ACSLBLH           04243250
042433                 MOVE -1                     TO ACSLBLL           04243350
042434                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04243450
042435             END-IF                                               04243550
042436         END-IF                                                   04243650
042437     END-IF.                                                      04243750
042438                                                                  04243850
042439     IF  ASC-KNOWN-OPER                                           04243951
042440         IF APLPRTL > ZERO                                        04244050
042441             MOVE APLPRTI TO ASC-CENTRL-PL-PRT-CD                 04244150
042442         ELSE                                                     04244250
042443             IF  ASC-CENTRL-PL-PRT-CD    >  SPACES                04244350
042444                 CONTINUE                                         04244450
042445             ELSE                                                 04244550
042446                 SET PS-ERROR                                     04244650
042447                     DP020-MSG-FATAL         TO TRUE              04244750
042448                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04244850
042449                 MOVE DP015-UNP-ALP-BRT-OFF  TO APLPRTA           04244950
042450                 MOVE DP015-RED              TO APLPRTC           04245050
042451                 MOVE DP015-REVERSE          TO APLPRTH           04245150
042452                 MOVE -1                     TO APLPRTL           04245250
042453                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04245350
042454             END-IF                                               04245450
042455         END-IF                                                   04245550
042456     END-IF.                                                      04245650
042457                                                                  04245750
042458     IF  ASC-KNOWN-OPER                                           04245851
042459         IF ACSLOCL > ZERO                                        04245950
042460             MOVE ACSLOCI TO ASC-CENTRL-STK-LOC-ID                04246050
042461         ELSE                                                     04246150
042462             IF  ASC-CENTRL-STK-LOC-ID  >  SPACES                 04246250
042463                 CONTINUE                                         04246350
042464             ELSE                                                 04246450
042465                 SET PS-ERROR                                     04246550
042466                     DP020-MSG-FATAL         TO TRUE              04246650
042467                 MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER  04246750
042468                 MOVE DP015-UNP-ALP-BRT-OFF  TO ACSLOCA           04246850
042469                 MOVE DP015-RED              TO ACSLOCC           04246950
042470                 MOVE DP015-REVERSE          TO ACSLOCH           04247050
042471                 MOVE -1                     TO ACSLOCL           04247150
042472                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              04247250
042473             END-IF                                               04247350
042474         END-IF                                                   04247450
042475     END-IF.                                                      04247550
042476                                                                  04247650
042478     IF ARCPRTL > ZERO                                            04247850
042480         MOVE ARCPRTI TO ASC-RCVG-PRINTER-ID                      04248050
042481     END-IF.                                                      04248104
042482                                                                  04248204
042483     IF ASUPRTL > ZERO                                            04248304
042484         MOVE ASUPRTI TO ASC-SU-PRINTER-ID                        04248404
042498     END-IF.                                                      04249804
042499                                                                  04249904
042500     IF AFLPRTL > ZERO                                            04250004
042501         MOVE AFLPRTI TO ASC-FLAT-PRINTER-ID                      04250104
042515     END-IF.                                                      04251504
042516                                                                  04251604
042517     IF ACSPRTL > ZERO                                            04251704
042518         MOVE ACSPRTI TO ASC-CNTL-STK-PRTR-ID                     04251804
042532     END-IF.                                                      04253204
042533                                                                  04253304
042534     IF ASHPRTL > ZERO                                            04253404
042535         MOVE ASHPRTI TO ASC-SHIP-PRINTER-ID                      04253504
042549     END-IF.                                                      04254904
042550                                                                  04255004
042551                                                                  04255104
042560*----------------------------------------------------------------*04256003
042600* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *04260003
042700* IS FOUND THE CURSOR IS POSITIONED AT THAT FIELD AND AN         *04270003
042800* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *04280003
042900*----------------------------------------------------------------*04290003
043000 3000-EDIT-DATA-IN-COMMAREA.                                      04300003
043100                                                                  04310036
043110     MOVE AOPERL  TO  PV-OPER-LENGTH.                             04311037
043120                                                                  04312036
043200     PERFORM 3200-RESET-ATTRIBUTES.                               04320036
043300                                                                  04330036
043310     IF ASC-PROTECT-OPER-YES                                      04331037
043311         MOVE DP015-PRO-NOR-OFF      TO AOPERA                    04331137
043312         MOVE DP015-BLUE             TO AOPERC                    04331237
043313         MOVE PV-OPER-LENGTH         TO AOPERL                    04331337
043314*        MOVE -1                     TO ALBLSQL                   04331438
043320     END-IF.                                                      04332037
043330                                                                  04333037
043400*-----------------------------------------------------------------04340003
043500* VERIFY THAT OPER UNIT IS NUMERIC                                04350004
043600*-----------------------------------------------------------------04360003
043700     IF  ASC-OPER-UNT-ID > SPACES                                 04370004
043800         MOVE ASC-OPER-UNT-ID         TO DP010I-UNEDITED-FIELD    04380004
043900         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  04390004
044000         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  04400003
044100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04410003
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04421054
263455              USING DP010I-NUMERIC-EDIT-AREA                      04422054
044300         IF  DP010I-ERROR-DETECTED                                04430003
044400             SET PS-ERROR                                         04440003
044500                 DP020-MSG-FATAL         TO TRUE                  04450003
044600             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04460003
044700             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                04470004
044800             MOVE DP015-RED              TO AOPERC                04480004
044900             MOVE DP015-REVERSE          TO AOPERH                04490004
045000             MOVE -1                     TO AOPERL                04500004
045100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04510003
045200         ELSE                                                     04520003
045300             MOVE DP010I-NUMERIC-FIELD TO ASC-OPER-UNT-ID-N       04530004
045400             MOVE ASC-OPER-UNT-ID      TO AOPERO                  04540004
045500         END-IF                                                   04550003
045600     END-IF.                                                      04560003
045700                                                                  04570004
046000                                                                  04600006
046100     IF  PS-NO-ERROR                                              04610048
046200         PERFORM 3005-NUMERIC-EDITS                               04620049
046300     END-IF.                                                      04630048
046400                                                                  04640048
046500                                                                  04650048
047042*-----------------------------------------------------------------04704204
047043* GET OPER NAME                                                   04704304
047044*-----------------------------------------------------------------04704404
047045     IF  ASC-OPER-UNT-ID > SPACES                                 04704504
047046         MOVE ASC-OPER-UNT-ID-N TO XLT00010-LOC-NBR               04704604
047047         PERFORM 3100-GET-OPER-NAME                               04704704
047054         MOVE XLT00010-LOC-NM   TO ASC-OPER-NAME                  04705404
047055         MOVE XLT00010-LOC-TYP-CDE  TO ASC-LOC-TYP-CDE            04705552
047056     END-IF.                                                      04705652
047057                                                                  04705752
047058*-----------------------------------------------------------------04705852
047059* GET CENTRAL STOCK NAME                                          04705952
047060*-----------------------------------------------------------------04706052
047061     IF  ASC-CENTRL-STK-LOC-ID  > SPACES                          04706152
047062         MOVE ASC-CENTRL-STK-LOC-ID-N TO XLT00010-LOC-NBR         04706252
047063         PERFORM 3105-GET-OPER-CS                                 04706352
047069         MOVE XLT00010-LOC-NM   TO ASC-CENTRL-STK-NAME            04706908
047071     END-IF.                                                      04707152
047072                                                                  04707252
047073*-----------------------------------------------------------------04707352
047074* VERIFY OPER SET IS VALID - GET OPER SET NAME                    04707452
047075*-----------------------------------------------------------------04707552
047076     IF  ASC-LOC-DC                                               04707652
047077         IF  ASC-DEFAULT-OPER-SET   > SPACES                      04707752
047078             MOVE ASC-OPER-UNT-ID-N      TO OPRSET-OPER-UNT-ID    04707852
047079             MOVE ASC-DEFAULT-OPER-SET-N TO OPRSET-OPER-SET-ID    04707952
047080             PERFORM 3110-GET-OPER-SET                            04708052
047081             MOVE OPRSET-OPER-SET-DESC   TO ASC-OPER-SET-NAME     04708152
047082         END-IF                                                   04708252
047083     END-IF.                                                      04708352
047084                                                                  04708452
047085*-----------------------------------------------------------------04708552
047086* VERIFY THAT LABEL PRINT SEQUENCE IS A VALID VALUE               04708652
047087*-----------------------------------------------------------------04708752
047088     IF  PS-NO-ERROR                                              04708852
047089         IF  ASC-CASEPK-LABEL-SEQ  >  SPACES     AND              04708952
047090             ASC-VALID-LBL-SEQ                                    04709052
047091             CONTINUE                                             04709152
047092         ELSE                                                     04709252
047093             SET PS-ERROR                                         04709352
047094                 DP020-MSG-FATAL         TO TRUE                  04709452
047095             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      04709552
047096             MOVE DP015-UNP-ALP-BRT-OFF  TO ALBLSQA               04709652
047097             MOVE DP015-RED              TO ALBLSQC               04709752
047098             MOVE DP015-REVERSE          TO ALBLSQH               04709852
047099             MOVE -1                     TO ALBLSQL               04709952
047100         END-IF                                                   04710052
047101     END-IF.                                                      04710152
047102                                                                  04710252
047103*-----------------------------------------------------------------04710352
047104* VERIFY THAT LABEL CREATE CODE IS A VALID VALUE                  04710452
047105*-----------------------------------------------------------------04710552
047106     IF  PS-NO-ERROR                                              04710652
047107         IF  ASC-CASEPK-CRE-LBL    >  SPACES     AND              04710752
047108             ASC-VALID-CRE-LBL                                    04710852
047109             CONTINUE                                             04710952
047110         ELSE                                                     04711052
047111             SET PS-ERROR                                         04711152
047112                 DP020-MSG-FATAL         TO TRUE                  04711252
047113             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      04711352
047114             MOVE DP015-UNP-ALP-BRT-OFF  TO ACRELBA               04711452
047115             MOVE DP015-RED              TO ACRELBC               04711552
047116             MOVE DP015-REVERSE          TO ACRELBH               04711652
047117             MOVE -1                     TO ACRELBL               04711752
047118         END-IF                                                   04711852
047119     END-IF.                                                      04711952
047120                                                                  04712052
047121*-----------------------------------------------------------------04712152
047122* VERIFY THAT CENTRAL STOCK PRINT CODE IS A VALID VALUE           04712252
047123*-----------------------------------------------------------------04712352
047124     IF  PS-NO-ERROR                                              04712452
047125         IF  ASC-VALID-CS-CODE                                    04712552
047126             CONTINUE                                             04712652
047127         ELSE                                                     04712752
047128             SET PS-ERROR                                         04712852
047129                 DP020-MSG-FATAL         TO TRUE                  04712952
047130             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      04713052
047131             MOVE DP015-UNP-ALP-BRT-OFF  TO APLPRTA               04713152
047132             MOVE DP015-RED              TO APLPRTC               04713252
047133             MOVE DP015-REVERSE          TO APLPRTH               04713352
047134             MOVE -1                     TO APLPRTL               04713452
047135         END-IF                                                   04713552
047136     END-IF.                                                      04713652
047137                                                                  04713752
047138*-----------------------------------------------------------------04713852
047139* VERIFY THAT RECEIVING PRINTER ID A VALID PRINTER                04713952
047140*-----------------------------------------------------------------04714052
047141     IF  PS-NO-ERROR  AND                                         04714152
047142         ASC-RCVG-PRINTER-ID  >  SPACES                           04714252
047143         MOVE  ASC-RCVG-PRINTER-ID TO PRTRID-PRTR-ID              04714352
047144         MOVE  ASC-OPER-UNT-ID-N   TO PRTRID-PRTR-OPER-UNT-ID     04714452
047145         MOVE  1                   TO PRTRID-PRTR-FCLTY-ID        04714552
047146         PERFORM 3130-VALIDATE-PRINTER-ID                         04714652
047147         EVALUATE TRUE                                            04714752
047148             WHEN SQLCODE  = +0                                   04714852
047149                  CONTINUE                                        04714952
047150             WHEN SQLCODE  = +100                                 04715010
047163                  SET PS-ERROR                                    04716310
047164                      DP020-MSG-FATAL         TO TRUE             04716410
047165                  MOVE PC-TSYMSG-00746     TO DP020-MSG-NUMBER    04716510
047166                  MOVE DP015-UNP-ALP-BRT-OFF  TO ARCPRTA          04716610
047167                  MOVE DP015-RED              TO ARCPRTC          04716710
047168                  MOVE DP015-REVERSE          TO ARCPRTH          04716810
047169                  MOVE -1                     TO ARCPRTL          04716910
047170         END-EVALUATE                                             04717010
047203     END-IF                                                       04720304
047204                                                                  04720404
047205                                                                  04720504
047207*-----------------------------------------------------------------04720704
047208* VERIFY THAT FLAT PRINTER ID IS A VALID PRINTER                  04720804
047209*-----------------------------------------------------------------04720904
047210     IF  PS-NO-ERROR      AND                                     04721008
047211         ASC-FLAT-PRINTER-ID  >  SPACES                           04721104
047212         MOVE  ASC-FLAT-PRINTER-ID TO PRTRID-PRTR-ID              04721210
047213         MOVE  ASC-OPER-UNT-ID-N   TO PRTRID-PRTR-OPER-UNT-ID     04721310
047214         MOVE  1                   TO PRTRID-PRTR-FCLTY-ID        04721410
047215         PERFORM 3130-VALIDATE-PRINTER-ID                         04721510
047216         EVALUATE TRUE                                            04721610
047217             WHEN SQLCODE  = +0                                   04721710
047218                  CONTINUE                                        04721810
047219             WHEN SQLCODE  = +100                                 04721910
047238                  SET PS-ERROR                                    04723810
047239                      DP020-MSG-FATAL         TO TRUE             04723910
047240                  MOVE PC-TSYMSG-00746     TO DP020-MSG-NUMBER    04724010
047241                  MOVE DP015-UNP-ALP-BRT-OFF  TO AFLPRTA          04724110
047242                  MOVE DP015-RED              TO AFLPRTC          04724210
047243                  MOVE DP015-REVERSE          TO AFLPRTH          04724310
047244                  MOVE -1                     TO AFLPRTL          04724410
047245         END-EVALUATE                                             04724510
047258     END-IF                                                       04725804
047259                                                                  04725904
047260                                                                  04726004
047261*-----------------------------------------------------------------04726104
047262* VERIFY THAT SHIPPING PRINTER ID IS A VALID PRINTER              04726204
047263*-----------------------------------------------------------------04726304
047264     IF  PS-NO-ERROR     AND                                      04726408
047265         ASC-SHIP-PRINTER-ID  >  SPACES                           04726504
047266         MOVE  ASC-SHIP-PRINTER-ID TO PRTRID-PRTR-ID              04726610
047267         MOVE  ASC-OPER-UNT-ID-N   TO PRTRID-PRTR-OPER-UNT-ID     04726710
047268         MOVE  1                   TO PRTRID-PRTR-FCLTY-ID        04726810
047269         PERFORM 3130-VALIDATE-PRINTER-ID                         04726910
047270         EVALUATE TRUE                                            04727010
047271             WHEN SQLCODE  = +0                                   04727110
047272                  CONTINUE                                        04727210
047280             WHEN SQLCODE  = +100                                 04728010
047292                  SET PS-ERROR                                    04729210
047293                      DP020-MSG-FATAL         TO TRUE             04729310
047294                  MOVE PC-TSYMSG-00746     TO DP020-MSG-NUMBER    04729410
047295                  MOVE DP015-UNP-ALP-BRT-OFF  TO ASHPRTA          04729510
047296                  MOVE DP015-RED              TO ASHPRTC          04729610
047297                  MOVE DP015-REVERSE          TO ASHPRTH          04729710
047298                  MOVE -1                     TO ASHPRTL          04729810
047299         END-EVALUATE                                             04729910
047312     END-IF                                                       04731204
047313                                                                  04731304
047314                                                                  04731404
047315*-----------------------------------------------------------------04731504
047316* VERIFY THAT SU PRINTER ID IS A VALID PRINTER                    04731604
047317*-----------------------------------------------------------------04731704
047318     IF  PS-NO-ERROR          AND                                 04731808
047319         ASC-SU-PRINTER-ID    >  SPACES                           04731904
047320         MOVE  ASC-SU-PRINTER-ID   TO PRTRID-PRTR-ID              04732010
047321         MOVE  ASC-OPER-UNT-ID-N   TO PRTRID-PRTR-OPER-UNT-ID     04732110
047322         MOVE  1                   TO PRTRID-PRTR-FCLTY-ID        04732210
047323         PERFORM 3130-VALIDATE-PRINTER-ID                         04732310
047324         EVALUATE TRUE                                            04732410
047325             WHEN SQLCODE  = +0                                   04732510
047326                  CONTINUE                                        04732610
047327             WHEN SQLCODE  = +100                                 04732710
047346                  SET PS-ERROR                                    04734610
047347                      DP020-MSG-FATAL         TO TRUE             04734710
047348                  MOVE PC-TSYMSG-00746     TO DP020-MSG-NUMBER    04734810
047349                  MOVE DP015-UNP-ALP-BRT-OFF  TO ASUPRTA          04734910
047350                  MOVE DP015-RED              TO ASUPRTC          04735010
047351                  MOVE DP015-REVERSE          TO ASUPRTH          04735110
047352                  MOVE -1                     TO ASUPRTL          04735210
047353         END-EVALUATE                                             04735310
047366     END-IF                                                       04736604
047367                                                                  04736704
047368                                                                  04736804
047369*-----------------------------------------------------------------04736904
047370* VERIFY THAT SU PRINTER ID IS A VALID PRINTER                    04737004
047371*-----------------------------------------------------------------04737104
047372     IF  PS-NO-ERROR      AND                                     04737208
047373         ASC-CNTL-STK-PRTR-ID >  SPACES                           04737304
047374         MOVE  ASC-CNTL-STK-PRTR-ID TO PRTRID-PRTR-ID             04737410
047375         MOVE  ASC-OPER-UNT-ID-N    TO PRTRID-PRTR-OPER-UNT-ID    04737510
047376         MOVE  1                    TO PRTRID-PRTR-FCLTY-ID       04737610
047377         PERFORM 3130-VALIDATE-PRINTER-ID                         04737710
047378         EVALUATE TRUE                                            04737810
047379             WHEN SQLCODE  = +0                                   04737910
047380                  CONTINUE                                        04738010
047390             WHEN SQLCODE  = +100                                 04739010
047400                  SET PS-ERROR                                    04740010
047401                      DP020-MSG-FATAL         TO TRUE             04740110
047402                  MOVE PC-TSYMSG-00746     TO DP020-MSG-NUMBER    04740210
047403                  MOVE DP015-UNP-ALP-BRT-OFF  TO ACSPRTA          04740310
047404                  MOVE DP015-RED              TO ACSPRTC          04740410
047405                  MOVE DP015-REVERSE          TO ACSPRTH          04740510
047406                  MOVE -1                     TO ACSPRTL          04740610
047407         END-EVALUATE                                             04740710
047420     END-IF                                                       04742004
047421                                                                  04742104
047422                                                                  04742204
047423*-----------------------------------------------------------------04742304
047424*                                                                 04742404
047425*-----------------------------------------------------------------04742504
047426     IF PS-NO-ERROR                                               04742604
047427        IF  ASC-PROTECT-OPER-YES                                  04742737
047430            MOVE PV-OPER-LENGTH         TO AOPERL                 04743037
047431            MOVE -1                     TO ALBLSQL                04743137
047432        ELSE                                                      04743237
047433            MOVE -1                     TO AOPERL                 04743337
047434        END-IF                                                    04743437
047436     END-IF.                                                      04743637
047437     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         04743735
047438                                                                  04743804
047439                                                                  04743904
047440*-----------------------------------------------------------------04744048
047441* NUMERIC EDITS                                                   04744148
047442*-----------------------------------------------------------------04744248
047443 3005-NUMERIC-EDITS.                                              04744348
047444*-----------------------------------------------------------------04744448
047445* VERIFY THAT RF PRINT ON SCAN IS NUMERIC                         04744548
047446*-----------------------------------------------------------------04744648
047447     IF  ASC-RF-PRINT-ON-SCAN  >  SPACES                          04744748
047448         MOVE ASC-RF-PRINT-ON-SCAN    TO DP010I-UNEDITED-FIELD    04744848
047449         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  04744948
047450         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  04745048
047451         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04745148
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04745354
263455              USING DP010I-NUMERIC-EDIT-AREA                      04745454
047453         IF  DP010I-ERROR-DETECTED                                04745548
047454             SET PS-ERROR                                         04745648
047455                 DP020-MSG-FATAL         TO TRUE                  04745748
047456             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04745848
047457             MOVE DP015-UNP-ALP-BRT-OFF  TO ARFSCNA               04745948
047458             MOVE DP015-RED              TO ARFSCNC               04746048
047459             MOVE DP015-REVERSE          TO ARFSCNH               04746148
047460             MOVE -1                     TO ARFSCNL               04746248
047461             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04746348
047462         ELSE                                                     04746448
047463             MOVE DP010I-NUMERIC-FIELD TO ASC-RF-PRINT-ON-SCAN-N  04746548
047464             MOVE ASC-RF-PRINT-ON-SCAN TO ARFSCNO                 04746648
047465         END-IF                                                   04746748
047466     END-IF.                                                      04746848
047467                                                                  04746948
047468*-----------------------------------------------------------------04747048
047469* VERIFY THAT DAYS ALLOW TO ADJUST AFTER VERIFICATION IS NUMERIC  04747148
047470*-----------------------------------------------------------------04747248
047471     IF  ASC-DAYS-ADJ-ALLOW  >  SPACES                            04747348
047472         MOVE ASC-DAYS-ADJ-ALLOW      TO DP010I-UNEDITED-FIELD    04747448
047473         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  04747548
047474         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  04747648
047475         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04747748
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04747954
263455              USING DP010I-NUMERIC-EDIT-AREA                      04748054
047477         IF  DP010I-ERROR-DETECTED                                04748148
047478             SET PS-ERROR                                         04748248
047479                 DP020-MSG-FATAL         TO TRUE                  04748348
047480             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04748448
047481             MOVE DP015-UNP-ALP-BRT-OFF  TO AADJDYA               04748548
047482             MOVE DP015-RED              TO AADJDYC               04748648
047483             MOVE DP015-REVERSE          TO AADJDYH               04748748
047484             MOVE -1                     TO AADJDYL               04748848
047485             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04748948
047486         ELSE                                                     04749048
047487             MOVE DP010I-NUMERIC-FIELD TO ASC-DAYS-ADJ-ALLOW-N    04749148
047488             MOVE ASC-DAYS-ADJ-ALLOW     TO AADJDYO               04749248
047489         END-IF                                                   04749348
047490     END-IF.                                                      04749448
047491                                                                  04749548
047492*-----------------------------------------------------------------04749648
047493* VERIFY THAT THE OPER SET IS NUMERIC                             04749748
047494*-----------------------------------------------------------------04749848
047495     IF  ASC-DEFAULT-OPER-SET  >  SPACES                          04749948
047496         MOVE ASC-DEFAULT-OPER-SET    TO DP010I-UNEDITED-FIELD    04750048
047497         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  04750148
047498         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  04750248
047499         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04750348
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04750554
263455              USING DP010I-NUMERIC-EDIT-AREA                      04750654
047501         IF  DP010I-ERROR-DETECTED                                04750748
047502             SET PS-ERROR                                         04750848
047503                 DP020-MSG-FATAL         TO TRUE                  04750948
047504             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04751048
047505             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRSTA               04751148
047506             MOVE DP015-RED              TO AOPRSTC               04751248
047507             MOVE DP015-REVERSE          TO AOPRSTH               04751348
047508             MOVE -1                     TO AOPRSTL               04751448
047509             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04751548
047510         ELSE                                                     04751648
047511             MOVE DP010I-NUMERIC-FIELD TO ASC-DEFAULT-OPER-SET-N  04751748
047512             MOVE ASC-DEFAULT-OPER-SET   TO AOPRSTO               04751848
047513         END-IF                                                   04751948
047514     END-IF.                                                      04752048
047515                                                                  04752148
047516*-----------------------------------------------------------------04752248
047517* VERIFY THAT THE CENTRAL STOCK LABEL QUANTITY IS NUMERIC         04752348
047518*-----------------------------------------------------------------04752448
047519     IF  ASC-CENTRL-STK-LBL-QTY  >  SPACES                        04752548
047520         MOVE ASC-CENTRL-STK-LBL-QTY  TO DP010I-UNEDITED-FIELD    04752648
047521         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  04752748
047522         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  04752848
047523         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04752948
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04753154
263455              USING DP010I-NUMERIC-EDIT-AREA                      04753254
047525         IF  DP010I-ERROR-DETECTED                                04753348
047526             SET PS-ERROR                                         04753448
047527                 DP020-MSG-FATAL         TO TRUE                  04753548
047528             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04753648
047529             MOVE DP015-UNP-ALP-BRT-OFF  TO ACSLBLA               04753748
047530             MOVE DP015-RED              TO ACSLBLC               04753848
047531             MOVE DP015-REVERSE          TO ACSLBLH               04753948
047532             MOVE -1                     TO ACSLBLL               04754048
047533             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04754148
047534         ELSE                                                     04754248
047535             MOVE DP010I-NUMERIC-FIELD TO ASC-CENTRL-STK-LBL-QTY-N04754348
047536             MOVE ASC-CENTRL-STK-LBL-QTY TO ACSLBLO               04754448
047537         END-IF                                                   04754548
047538     END-IF.                                                      04754648
047539                                                                  04754748
047540*-----------------------------------------------------------------04754848
047541* VERIFY THAT THE CENTRAL STOCK LOCATION ID IS NUMERIC            04754948
047542*-----------------------------------------------------------------04755048
047543     IF  ASC-CENTRL-STK-LOC-ID   >  SPACES                        04755148
047544         MOVE ASC-CENTRL-STK-LOC-ID   TO DP010I-UNEDITED-FIELD    04755248
047545         MOVE LENGTH OF ASC-OPER-UNT-ID TO DP010I-MAXIMUM-DIGITS  04755348
047546         MOVE ZERO                    TO DP010I-MAXIMUM-DECIMALS  04755448
047547         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  04755548
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         04755754
263455              USING DP010I-NUMERIC-EDIT-AREA                      04755854
047549         IF  DP010I-ERROR-DETECTED                                04755948
047550             SET PS-ERROR                                         04756048
047551                 DP020-MSG-FATAL         TO TRUE                  04756148
047552             MOVE PC-TSYMSG-00008        TO DP020-MSG-NUMBER      04756248
047553             MOVE DP015-UNP-ALP-BRT-OFF  TO ACSLOCA               04756348
047554             MOVE DP015-RED              TO ACSLOCC               04756448
047555             MOVE DP015-REVERSE          TO ACSLOCH               04756548
047556             MOVE -1                     TO ACSLOCL               04756648
047557             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04756748
047558         ELSE                                                     04756848
047559             MOVE DP010I-NUMERIC-FIELD TO ASC-CENTRL-STK-LOC-ID-N 04756948
047560             MOVE ASC-CENTRL-STK-LOC-ID  TO ACSLOCO               04757048
047561         END-IF                                                   04757148
047562     END-IF.                                                      04757248
047563                                                                  04757348
047564                                                                  04757448
047565                                                                  04757548
047566*---------------------------------------------------------------* 04757604
047567* GET NAME FROM XLT_LOC - CORP OR DC                              04757743
047568*---------------------------------------------------------------* 04757803
047570 3100-GET-OPER-NAME.                                              04758004
047600                                                                  04760003
047700     EXEC SQL                                                     04770003
047800         SELECT  LOC_NM                                           04780004
047810               , LOC_TYP_CDE                                      04781052
047900           INTO :XLT00010-LOC-NM                                  04790004
047910               ,:XLT00010-LOC-TYP-CDE                             04791052
048000           FROM  XLT_LOC                                          04800004
048100          WHERE  LOC_NBR       =  :XLT00010-LOC-NBR               04810004
048110            AND  LOC_TYP_CDE   IN ('DC','HQ')                     04811043
048200          WITH UR                                                 04820005
048300     END-EXEC                                                     04830003
048400                                                                  04840003
048500     EVALUATE TRUE                                                04850003
048600       WHEN SQLCODE = ZERO                                        04860003
048610            CONTINUE                                              04861004
048800                                                                  04880003
048900       WHEN SQLCODE = +100                                        04890003
048910             MOVE 'UNKNOWN LOCATION NAME'                         04891004
048920                                  TO XLT00010-LOC-NM              04892004
049000             SET PS-ERROR                                         04900003
049100                 DP020-MSG-FATAL         TO TRUE                  04910003
049200             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      04920042
049300             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                04930043
049400             MOVE DP015-RED              TO AOPERC                04940043
049500             MOVE DP015-REVERSE          TO AOPERH                04950043
049600             MOVE -1                     TO AOPERL                04960043
049700             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  04970003
049800                                                                  04980003
049900       WHEN OTHER                                                 04990003
050000            SET PS-ERROR                                          05000003
050100                DP020-MSG-FATAL         TO TRUE                   05010003
050200            MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER       05020003
050300            MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                 05030004
050400            MOVE DP015-RED              TO AOPERC                 05040004
050500            MOVE DP015-REVERSE          TO AOPERH                 05050004
050600            MOVE -1                     TO AOPERL                 05060004
050700            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   05070003
050800                                                                  05080003
050900            MOVE '3100-GET-OPER-NAME  ' TO DP013-PARAGRAPH        05090004
051000            MOVE 'XLT_LOC       '  TO DP013-MESSAGE-TEXT (1)      05100004
051100            MOVE SQLCA             TO DP013-SQLCA                 05110003
051200            MOVE 'XLT00010'        TO DP013-DB2-TABLE-NAME (1)    05120004
051300            SET DP013-DB2-ABEND                                   05130003
051400                DP013-XCTL-DISPLAY-RESTART TO TRUE                05140003
051500            PERFORM DP013-0000-PROCESS-ABEND                      05150003
051600     END-EVALUATE.                                                05160003
051700                                                                  05170003
051800                                                                  05180003
051801*---------------------------------------------------------------* 05180143
051802* GET NAME FROM XLT_LOC - CENTRAL STOCK LOCATION                  05180243
051803*---------------------------------------------------------------* 05180343
051804 3105-GET-OPER-CS.                                                05180443
051805                                                                  05180543
051806     EXEC SQL                                                     05180643
051807         SELECT  LOC_NM                                           05180743
051808           INTO :XLT00010-LOC-NM                                  05180843
051809           FROM  XLT_LOC                                          05180943
051810          WHERE  LOC_NBR       =  :XLT00010-LOC-NBR               05181043
051811            AND  LOC_TYP_CDE   IN ('CS')                          05181143
051812          WITH UR                                                 05181243
051813     END-EXEC                                                     05181343
051814                                                                  05181443
051815     EVALUATE TRUE                                                05181543
051816       WHEN SQLCODE = ZERO                                        05181643
051817            CONTINUE                                              05181743
051818                                                                  05181843
051819       WHEN SQLCODE = +100                                        05181943
051820             MOVE 'UNKNOWN LOCATION NAME'                         05182043
051821                                  TO XLT00010-LOC-NM              05182143
051822             SET PS-ERROR                                         05182243
051823                 DP020-MSG-FATAL         TO TRUE                  05182343
051824             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      05182443
051825             MOVE DP015-UNP-ALP-BRT-OFF  TO ACSLOCA               05182543
051826             MOVE DP015-RED              TO ACSLOCC               05182643
051827             MOVE DP015-REVERSE          TO ACSLOCH               05182743
051828             MOVE -1                     TO ACSLOCL               05182843
051829             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05182943
051830                                                                  05183043
051831       WHEN OTHER                                                 05183143
051832            SET PS-ERROR                                          05183243
051833                DP020-MSG-FATAL         TO TRUE                   05183343
051834            MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER       05183443
051835            MOVE DP015-UNP-ALP-BRT-OFF  TO ACSLOCA                05183543
051836            MOVE DP015-RED              TO ACSLOCC                05183643
051837            MOVE DP015-REVERSE          TO ACSLOCH                05183743
051838            MOVE -1                     TO ACSLOCL                05183843
051839            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   05183943
051840                                                                  05184043
051841            MOVE '3105-GET-OPER-CS    ' TO DP013-PARAGRAPH        05184143
051842            MOVE 'XLT_LOC       '  TO DP013-MESSAGE-TEXT (1)      05184243
051843            MOVE SQLCA             TO DP013-SQLCA                 05184343
051844            MOVE 'XLT00010'        TO DP013-DB2-TABLE-NAME (1)    05184443
051845            SET DP013-DB2-ABEND                                   05184543
051846                DP013-XCTL-DISPLAY-RESTART TO TRUE                05184643
051847            PERFORM DP013-0000-PROCESS-ABEND                      05184743
051848     END-EVALUATE.                                                05184843
051849                                                                  05184943
051850                                                                  05185043
051851*---------------------------------------------------------------* 05185104
051852* GET OPRSET DESCRIPTION FROM TOPRSET                             05185204
051853*---------------------------------------------------------------* 05185304
051854 3110-GET-OPER-SET.                                               05185404
051855     EXEC SQL                                                     05185504
051856         SELECT  OPER_SET_DESC                                    05185604
051857           INTO :OPRSET-OPER-SET-DESC                             05185704
051858           FROM  TOPRSET                                          05185804
051859          WHERE  OPER_UNT_ID   =  :OPRSET-OPER-UNT-ID             05185904
051860            AND  OPER_SET_ID   =  :OPRSET-OPER-SET-ID             05186004
051861          WITH UR                                                 05186104
051862     END-EXEC                                                     05186204
051863                                                                  05186304
051864     EVALUATE TRUE                                                05186404
051865       WHEN SQLCODE = ZERO                                        05186504
051866            CONTINUE                                              05186604
051867                                                                  05186704
051868       WHEN SQLCODE = +100                                        05186804
051869             MOVE 'UNKNOWN OPER SET NAME'                         05186904
051870                                  TO OPRSET-OPER-SET-DESC         05187004
051871             SET PS-ERROR                                         05187104
051872                 DP020-MSG-FATAL         TO TRUE                  05187204
051873             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      05187342
051874             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRSTA               05187404
051875             MOVE DP015-RED              TO AOPRSTC               05187504
051876             MOVE DP015-REVERSE          TO AOPRSTH               05187604
051877             MOVE -1                     TO AOPRSTL               05187704
051878             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05187804
051879                                                                  05187904
051880       WHEN OTHER                                                 05188004
051881            SET PS-ERROR                                          05188104
051882                DP020-MSG-FATAL         TO TRUE                   05188204
051883            MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER       05188304
051884            MOVE DP015-UNP-ALP-BRT-OFF  TO AOPRSTA                05188404
051885            MOVE DP015-RED              TO AOPRSTC                05188504
051886            MOVE DP015-REVERSE          TO AOPRSTH                05188604
051887            MOVE -1                     TO AOPRSTL                05188704
051888            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   05188804
051889                                                                  05188904
051890            MOVE '3110-GET-OPER-SET   ' TO DP013-PARAGRAPH        05189004
051891            MOVE 'TOPRSET       '  TO DP013-MESSAGE-TEXT (1)      05189104
051892            MOVE SQLCA             TO DP013-SQLCA                 05189204
051893            MOVE 'TOPRSET '        TO DP013-DB2-TABLE-NAME (1)    05189304
051894            SET DP013-DB2-ABEND                                   05189404
051895                DP013-XCTL-DISPLAY-RESTART TO TRUE                05189504
051896            PERFORM DP013-0000-PROCESS-ABEND                      05189604
051897     END-EVALUATE.                                                05189704
051898                                                                  05189804
051899                                                                  05189904
051900*---------------------------------------------------------------* 05190006
051901*                                                                 05190106
051902*---------------------------------------------------------------* 05190206
051903 3120-GET-COCNTL-SETTINGS.                                        05190306
051904     MOVE ASC-OPER-UNT-ID         TO COCNTL-OPER-UNT-ID.          05190406
051905     MOVE 1                       TO COCNTL-FCLTY-ID.             05190506
051906                                                                  05190606
051907     EXEC SQL                                                     05190706
051908         SELECT                                                   05190806
051909                 DFLT_PRT_ORD_CDE                                 05190906
051910                ,DFLT_CRE_LBL_CDE                                 05191006
051911                ,PRT_LBL_ON_SCN_CNT                               05191107
051912                ,DAYS_ALWD_ADJ_QTY                                05191207
051913                ,DFLT_OPER_SET_ID                                 05191306
051914                ,DFLT_FCSE_AREA_ID                                05191406
051915                ,DFLT_CNSTK_LBL_QTY                               05191506
051916                ,CNSTK_PL_PRT_CD                                  05191619
051917                ,DFLT_CNSTK_LOC_ID                                05191706
051918                ,CA_RCVG_PRTR_ID                                  05191806
051919                ,DFLT_SU_PRTR_ID                                  05191906
051920                ,CA_FLAT_PRTR_ID                                  05192006
051921                ,DFLT_CNSTK_PRTR_ID                               05192106
051922                ,CA_SHIP_PRTR_ID                                  05192206
051923           INTO                                                   05192306
051924                 :COCNTL-DFLT-PRT-ORD-CDE                         05192406
051925                ,:COCNTL-DFLT-CRE-LBL-CDE                         05192506
051926                ,:COCNTL-PRT-LBL-ON-SCN-CNT                       05192606
051927                ,:COCNTL-DAYS-ALWD-ADJ-QTY                        05192706
051928                ,:COCNTL-DFLT-OPER-SET-ID                         05192806
051929                ,:COCNTL-DFLT-FCSE-AREA-ID                        05192906
051930                ,:COCNTL-DFLT-CNSTK-LBL-QTY                       05193006
051931                ,:COCNTL-CNSTK-PL-PRT-CD                          05193119
051932                ,:COCNTL-DFLT-CNSTK-LOC-ID                        05193206
051933                ,:COCNTL-CA-RCVG-PRTR-ID                          05193306
051934                ,:COCNTL-DFLT-SU-PRTR-ID                          05193406
051935                ,:COCNTL-CA-FLAT-PRTR-ID                          05193506
051936                ,:COCNTL-DFLT-CNSTK-PRTR-ID                       05193606
051937                ,:COCNTL-CA-SHIP-PRTR-ID                          05193706
051938           FROM  TCOCNTL                                          05193806
051939          WHERE  OPER_UNT_ID   =  :COCNTL-OPER-UNT-ID             05193906
051940            AND  FCLTY_ID      =  :COCNTL-FCLTY-ID                05194006
051941          WITH UR                                                 05194106
051942     END-EXEC                                                     05194206
051943                                                                  05194306
051944     EVALUATE TRUE                                                05194406
051945       WHEN SQLCODE = ZERO                                        05194506
051946            SET ASC-KNOWN-OPER        TO TRUE                     05194650
051947            MOVE COCNTL-DFLT-PRT-ORD-CDE                          05194706
051948              TO ASC-CASEPK-LABEL-SEQ                             05194806
051949                 ALBLSQO                                          05194916
051950            MOVE COCNTL-DFLT-CRE-LBL-CDE                          05195006
051951              TO ASC-CASEPK-CRE-LBL                               05195106
051952                 ACRELBO                                          05195216
051953            MOVE COCNTL-PRT-LBL-ON-SCN-CNT                        05195306
051954              TO ASC-RF-PRINT-ON-SCAN                             05195406
051955                 ARFSCNO                                          05195516
051956            MOVE COCNTL-DAYS-ALWD-ADJ-QTY                         05195606
051957              TO ASC-DAYS-ADJ-ALLOW                               05195706
051958                 AADJDYO                                          05195816
051959            MOVE COCNTL-DFLT-OPER-SET-ID                          05195906
051960              TO ASC-DEFAULT-OPER-SET                             05196006
051961                 AOPRSTO                                          05196116
051962            MOVE COCNTL-DFLT-FCSE-AREA-ID                         05196206
051963              TO ASC-FULLCASE-PRCS-AREA                           05196306
051964                 AFULCSO                                          05196416
051965            MOVE COCNTL-DFLT-CNSTK-LBL-QTY                        05196506
051966              TO ASC-CENTRL-STK-LBL-QTY                           05196606
051967                 ACSLBLO                                          05196716
051968            MOVE COCNTL-CNSTK-PL-PRT-CD                           05196820
051969              TO ASC-CENTRL-PL-PRT-CD                             05196920
051970                 APLPRTO                                          05197016
051971            MOVE COCNTL-DFLT-CNSTK-LOC-ID                         05197106
051972              TO ASC-CENTRL-STK-LOC-ID                            05197206
051973                 ACSLOCO                                          05197316
051974            MOVE COCNTL-CA-RCVG-PRTR-ID                           05197406
051975              TO ASC-RCVG-PRINTER-ID                              05197506
051976                 ARCPRTO                                          05197616
051977            MOVE COCNTL-DFLT-SU-PRTR-ID                           05197706
051978              TO ASC-SU-PRINTER-ID                                05197806
051979                 ASUPRTO                                          05197916
051980            MOVE COCNTL-CA-FLAT-PRTR-ID                           05198006
051981              TO ASC-FLAT-PRINTER-ID                              05198106
051982                 AFLPRTO                                          05198216
051983            MOVE COCNTL-DFLT-CNSTK-PRTR-ID                        05198306
051984              TO ASC-CNTL-STK-PRTR-ID                             05198406
051985                 ACSPRTO                                          05198516
051986            MOVE COCNTL-CA-SHIP-PRTR-ID                           05198606
051987              TO ASC-SHIP-PRINTER-ID                              05198706
051988                 ASHPRTO                                          05198816
051989                                                                  05198906
051990       WHEN SQLCODE = +100                                        05199006
051991             MOVE 'UNKNOWN OPER UNIT    '                         05199106
051992                                  TO ASC-OPER-NAME                05199206
051993             SET PS-ERROR                                         05199306
051994                 DP020-MSG-FATAL                                  05199450
051995                 ASC-UNKNOWN-OPER        TO TRUE                  05199550
051996             MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER      05199650
051997             MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                05199750
051998             MOVE DP015-RED              TO AOPERC                05199850
051999             MOVE DP015-REVERSE          TO AOPERH                05199950
052000             MOVE -1                     TO AOPERL                05200050
052001             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  05200150
052002                                                                  05200250
052003       WHEN OTHER                                                 05200350
052004            SET PS-ERROR                                          05200450
052005                DP020-MSG-FATAL         TO TRUE                   05200550
052006            MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER       05200650
052007            MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                 05200750
052008            MOVE DP015-RED              TO AOPERC                 05200850
052009            MOVE DP015-REVERSE          TO AOPERH                 05200950
052010            MOVE -1                     TO AOPERL                 05201050
052011            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   05201150
052012                                                                  05201250
052013            MOVE '3120-GET-COCNTL-SET'  TO DP013-PARAGRAPH        05201350
052014            MOVE 'TCOCNTL       '  TO DP013-MESSAGE-TEXT (1)      05201450
052015            MOVE SQLCA             TO DP013-SQLCA                 05201550
052016            MOVE 'TCOCNTL '        TO DP013-DB2-TABLE-NAME (1)    05201650
052017            SET DP013-DB2-ABEND                                   05201750
052018                DP013-XCTL-DISPLAY-RESTART TO TRUE                05201850
052019            PERFORM DP013-0000-PROCESS-ABEND                      05201950
052020     END-EVALUATE.                                                05202050
052021                                                                  05202150
052022                                                                  05202250
052023*---------------------------------------------------------------* 05202350
052024* VALIDATE PRINTER ID                                             05202450
052025*---------------------------------------------------------------* 05202550
052026 3130-VALIDATE-PRINTER-ID.                                        05202650
052027                                                                  05202750
052028     EXEC SQL                                                     05202850
052029         SELECT  PRTR_LOC_DESC                                    05202950
052030           INTO :PRTRID-PRTR-LOC-DESC                             05203050
052031           FROM  TPRTRID                                          05203150
052032          WHERE  PRTR_ID           = :PRTRID-PRTR-ID              05203250
052033            AND  PRTR_OPER_UNT_ID  = :PRTRID-PRTR-OPER-UNT-ID     05203350
052034            AND  PRTR_FCLTY_ID     = :PRTRID-PRTR-FCLTY-ID        05203450
052035            AND  PRTR_CLUSTR_NBR  IS  NULL                        05203550
052036          WITH UR                                                 05203650
052037     END-EXEC                                                     05203750
052038                                                                  05203850
052039     EVALUATE TRUE                                                05203950
052040       WHEN SQLCODE = ZERO                                        05204050
052041            CONTINUE                                              05204150
052042                                                                  05204250
052043       WHEN SQLCODE = +100                                        05204350
052044            CONTINUE                                              05204450
052045                                                                  05204550
052046       WHEN OTHER                                                 05204650
052047            SET PS-ERROR                                          05204750
052048                DP020-MSG-FATAL         TO TRUE                   05204850
052049            MOVE PC-TSYMSG-00984        TO DP020-MSG-NUMBER       05204950
052050            MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                 05205050
052051            MOVE DP015-RED              TO AOPERC                 05205150
052052            MOVE DP015-REVERSE          TO AOPERH                 05205250
052053            MOVE -1                     TO AOPERL                 05205350
052054            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   05205450
052055                                                                  05205550
052056            MOVE '3130-VALIDATE-PRINTER-ID' TO DP013-PARAGRAPH    05205650
052057            MOVE 'TPRTRID       '  TO DP013-MESSAGE-TEXT (1)      05205750
052058            MOVE SQLCA             TO DP013-SQLCA                 05205850
052059            MOVE 'XLT00010'        TO DP013-DB2-TABLE-NAME (1)    05205950
052060            SET DP013-DB2-ABEND                                   05206050
052061                DP013-XCTL-DISPLAY-RESTART TO TRUE                05206150
052062            PERFORM DP013-0000-PROCESS-ABEND                      05206250
052063     END-EVALUATE.                                                05206350
052064                                                                  05206450
052065                                                                  05206550
052066*---------------------------------------------------------------* 05206650
052070*                                                                 05207003
052100*---------------------------------------------------------------* 05210003
052200 3200-RESET-ATTRIBUTES.                                           05220003
052300                                                                  05230003
052500     IF ASC-PROTECT-OPER-YES                                      05250036
052600        CONTINUE                                                  05260036
052700     ELSE                                                         05270036
053710         MOVE DP015-GREEN           TO AOPERC                     05371036
053711         MOVE DP015-UNP-ALP-NOR-OFF TO AOPERA                     05371136
053712         MOVE DP015-UNDERLINE       TO AOPERH                     05371236
053713     END-IF.                                                      05371336
053714                                                                  05371436
053720     MOVE DP015-GREEN              TO ALBLSQC                     05372036
053730                                      ACRELBC                     05373009
053740                                      ARFSCNC                     05374009
053750                                      AADJDYC                     05375009
053760                                      AOPRSTC                     05376009
053770                                      AFULCSC                     05377009
053780                                      ACSLBLC                     05378009
053790                                      APLPRTC                     05379009
053791                                      ACSLOCC                     05379109
053792                                      ARCPRTC                     05379209
053793                                      ASUPRTC                     05379309
053794                                      AFLPRTC                     05379409
053795                                      ACSPRTC                     05379509
053796                                      ASHPRTC.                    05379609
053798     MOVE DP015-UNDERLINE          TO ALBLSQH                     05379836
053799                                      ACRELBH                     05379909
053800                                      ARFSCNH                     05380009
053801                                      AADJDYH                     05380109
053802                                      AOPRSTH                     05380209
053803                                      AFULCSH                     05380309
053804                                      ACSLBLH                     05380409
053805                                      APLPRTH                     05380509
053806                                      ACSLOCH                     05380609
053807                                      ARCPRTH                     05380709
053808                                      ASUPRTH                     05380809
053809                                      AFLPRTH                     05380909
053810                                      ACSPRTH                     05381009
053811                                      ASHPRTH.                    05381109
053813     MOVE DP015-UNP-ALP-NOR-OFF    TO ALBLSQA                     05381336
053814                                      ACRELBA                     05381409
053815                                      ARFSCNA                     05381509
053816                                      AADJDYA                     05381609
053817                                      AOPRSTA                     05381709
053818                                      AFULCSA                     05381809
053819                                      ACSLBLA                     05381909
053820                                      APLPRTA                     05382009
053821                                      ACSLOCA                     05382109
053822                                      ARCPRTA                     05382209
053823                                      ASUPRTA                     05382309
053824                                      AFLPRTA                     05382409
053825                                      ACSPRTA                     05382509
053826                                      ASHPRTA.                    05382609
053827     MOVE DP015-PRO-NOR-OFF        TO ANAMEA                      05382709
053828                                      AOPRNMA                     05382809
053829                                      ACSNMA.                     05382909
053830     MOVE -1                         TO AOPERL.                   05383026
053831     SET DP030-SET-CURSOR-APPL-1     TO TRUE.                     05383109
053840                                                                  05384003
053850*---------------------------------------------------------------* 05385024
053860* PROTECT BEFORE UPDATE                                           05386024
053870*---------------------------------------------------------------* 05387024
053880 3210-RESET-ATTRIBUTES-PROT.                                      05388024
053890                                                                  05389024
053891     MOVE DP015-BLUE               TO AOPERC                      05389124
053892                                      ALBLSQC                     05389224
053893                                      ACRELBC                     05389324
053894                                      ARFSCNC                     05389424
053895                                      AADJDYC                     05389524
053896                                      AOPRSTC                     05389624
053897                                      AFULCSC                     05389724
053898                                      ACSLBLC                     05389824
053899                                      APLPRTC                     05389924
053900                                      ACSLOCC                     05390024
053901                                      ARCPRTC                     05390124
053902                                      ASUPRTC                     05390224
053903                                      AFLPRTC                     05390324
053904                                      ACSPRTC                     05390424
053905                                      ASHPRTC.                    05390524
053906*    MOVE DP015-UNDERLINE          TO AOPERH                      05390624
053907*                                     ALBLSQH                     05390724
053908*                                     ACRELBH                     05390824
053909*                                     ARFSCNH                     05390924
053910*                                     AADJDYH                     05391024
053911*                                     AOPRSTH                     05391124
053912*                                     AFULCSH                     05391224
053913*                                     ACSLBLH                     05391324
053914*                                     APLPRTH                     05391424
053915*                                     ACSLOCH                     05391524
053916*                                     ARCPRTH                     05391624
053917*                                     ASUPRTH                     05391724
053918*                                     AFLPRTH                     05391824
053919*                                     ACSPRTH                     05391924
053920*                                     ASHPRTH.                    05392024
053921     MOVE DP015-PRO-NOR-OFF        TO AOPERA                      05392124
053922                                      ALBLSQA                     05392224
053923                                      ACRELBA                     05392324
053924                                      ARFSCNA                     05392424
053925                                      AADJDYA                     05392524
053926                                      AOPRSTA                     05392624
053927                                      AFULCSA                     05392724
053928                                      ACSLBLA                     05392824
053929                                      APLPRTA                     05392924
053930                                      ACSLOCA                     05393024
053931                                      ARCPRTA                     05393124
053932                                      ASUPRTA                     05393224
053933                                      AFLPRTA                     05393324
053934                                      ACSPRTA                     05393424
053935                                      ASHPRTA                     05393524
053936                                      ANAMEA                      05393624
053937                                      AOPRNMA                     05393724
053938                                      ACSNMA.                     05393824
053939     MOVE -1                         TO AOPERL.                   05393926
053940     SET DP030-SET-CURSOR-APPL-1     TO TRUE.                     05394024
053941                                                                  05394124
053950*----------------------------------------------------------------*05395003
054000* BUILD THE INITIAL PANEL OF THE SCREEN AND POSITION THE CURSOR  *05400003
054100* AT ENTITY ID                                                   *05410003
054200*----------------------------------------------------------------*05420003
054300 4000-BUILD-INITIAL-PANEL.                                        05430003
054400                                                                  05440003
054500     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         05450003
054600                                                                  05460003
054700     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA                      05470004
054800                                      ALBLSQA                     05480004
054900                                      ACRELBA                     05490004
054910                                      ARFSCNA                     05491004
054920                                      AADJDYA                     05492004
054930                                      AOPRSTA                     05493004
054940                                      AFULCSA                     05494004
054950                                      ACSLBLA                     05495010
054960                                      APLPRTA                     05496004
054970                                      ACSLOCA                     05497004
054980                                      ARCPRTA                     05498004
054990                                      ASUPRTA                     05499004
054991                                      AFLPRTA                     05499104
054992                                      ACSPRTA                     05499204
054993                                      ASHPRTA.                    05499304
055100     MOVE DP015-GREEN              TO AOPERC                      05510004
055200                                      ALBLSQC                     05520004
055300                                      ACRELBC                     05530004
055310                                      ARFSCNC                     05531004
055320                                      AADJDYC                     05532004
055330                                      AOPRSTC                     05533004
055340                                      AFULCSC                     05534004
055350                                      ACSLBLC                     05535004
055360                                      APLPRTC                     05536004
055370                                      ACSLOCC                     05537004
055380                                      ARCPRTC                     05538004
055390                                      ASUPRTC                     05539004
055391                                      AFLPRTC                     05539104
055392                                      ACSPRTC                     05539204
055393                                      ASHPRTC.                    05539304
055500     MOVE DP015-UNDERLINE          TO AOPERH                      05550004
055600                                      ALBLSQH                     05560004
055700                                      ACRELBH                     05570004
055710                                      ARFSCNH                     05571004
055720                                      AADJDYH                     05572004
055730                                      AOPRSTH                     05573004
055740                                      AFULCSH                     05574004
055750                                      ACSLBLH                     05575004
055760                                      APLPRTH                     05576004
055770                                      ACSLOCH                     05577004
055780                                      ARCPRTH                     05578004
055790                                      ASUPRTH                     05579004
055791                                      AFLPRTH                     05579104
055792                                      ACSPRTH                     05579204
055793                                      ASHPRTH.                    05579304
055900     MOVE DP015-PRO-NOR-OFF        TO ANAMEA                      05590004
055910                                      AOPRNMA                     05591004
055920                                      ACSNMA.                     05592004
056000     MOVE DP015-BLUE               TO ANAMEC.                     05600003
056100     MOVE -1                       TO AOPERL.                     05610004
056200                                                                  05620003
056400                                                                  05640003
056500*----------------------------------------------------------------*05650003
056600*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *05660003
056700*----------------------------------------------------------------*05670003
056800 4400-MOVE-COMMAREA-TO-SCREEN.                                    05680003
056900                                                                  05690003
057536     MOVE ASC-OPER-UNT-ID              TO AOPERO.                 05753604
057537     MOVE ASC-OPER-NAME                TO ANAMEO.                 05753704
057538     MOVE ASC-CASEPK-LABEL-SEQ         TO ALBLSQO.                05753804
057539     MOVE ASC-CASEPK-CRE-LBL           TO ACRELBO.                05753904
057540     MOVE ASC-RF-PRINT-ON-SCAN         TO ARFSCNO.                05754004
057550     MOVE ASC-DAYS-ADJ-ALLOW           TO AADJDYO.                05755004
057560     MOVE ASC-DEFAULT-OPER-SET         TO AOPRSTO.                05756004
057561     MOVE ASC-OPER-SET-NAME            TO AOPRNMO.                05756104
057570     MOVE ASC-FULLCASE-PRCS-AREA       TO AFULCSO.                05757004
057580     MOVE ASC-CENTRL-STK-LBL-QTY       TO ACSLBLO.                05758004
057590     MOVE ASC-CENTRL-PL-PRT-CD         TO APLPRTO.                05759020
057591     MOVE ASC-CENTRL-STK-LOC-ID        TO ACSLOCO.                05759104
057592     MOVE ASC-CENTRL-STK-NAME          TO ACSNMO.                 05759204
057593     MOVE ASC-RCVG-PRINTER-ID          TO ARCPRTO.                05759304
057594     MOVE ASC-SU-PRINTER-ID            TO ASUPRTO.                05759404
057595     MOVE ASC-FLAT-PRINTER-ID          TO AFLPRTO.                05759504
057596     MOVE ASC-CNTL-STK-PRTR-ID         TO ACSPRTO.                05759604
057597     MOVE ASC-SHIP-PRINTER-ID          TO ASHPRTO.                05759704
057600                                                                  05760003
057700******************************************************************05770003
057800* 5000-UPDATE.                                                    05780005
057900******************************************************************05790003
058000 5000-UPDATE.                                                     05800005
058100                                                                  05810003
058200     INITIALIZE PV-RETRY-COUNTER.                                 05820003
058300                                                                  05830003
058310     MOVE ASC-OPER-UNT-ID         TO COCNTL-OPER-UNT-ID.          05831005
058320     MOVE 1                       TO COCNTL-FCLTY-ID.             05832005
058330     MOVE ASC-CASEPK-LABEL-SEQ    TO COCNTL-DFLT-PRT-ORD-CDE.     05833005
058340     MOVE ASC-CASEPK-CRE-LBL      TO COCNTL-DFLT-CRE-LBL-CDE.     05834005
058350     MOVE ASC-RF-PRINT-ON-SCAN    TO COCNTL-PRT-LBL-ON-SCN-CNT.   05835005
058360     MOVE ASC-DAYS-ADJ-ALLOW      TO COCNTL-DAYS-ALWD-ADJ-QTY.    05836005
058370     MOVE ASC-DEFAULT-OPER-SET    TO COCNTL-DFLT-OPER-SET-ID.     05837005
058390     MOVE ASC-FULLCASE-PRCS-AREA  TO COCNTL-DFLT-FCSE-AREA-ID.    05839005
058391     MOVE ASC-CENTRL-STK-LBL-QTY  TO COCNTL-DFLT-CNSTK-LBL-QTY.   05839105
058392     MOVE ASC-CENTRL-PL-PRT-CD    TO COCNTL-CNSTK-PL-PRT-CD.      05839222
058393     MOVE ASC-CENTRL-STK-LOC-ID   TO COCNTL-DFLT-CNSTK-LOC-ID.    05839305
058395     MOVE ASC-RCVG-PRINTER-ID     TO COCNTL-CA-RCVG-PRTR-ID.      05839505
058396     MOVE ASC-SU-PRINTER-ID       TO COCNTL-DFLT-SU-PRTR-ID.      05839605
058397     MOVE ASC-FLAT-PRINTER-ID     TO COCNTL-CA-FLAT-PRTR-ID.      05839705
058398     MOVE ASC-CNTL-STK-PRTR-ID    TO COCNTL-DFLT-CNSTK-PRTR-ID.   05839805
058399     MOVE ASC-SHIP-PRINTER-ID     TO COCNTL-CA-SHIP-PRTR-ID.      05839905
058800                                                                  05880003
059200                                                                  05920003
059300     EXEC SQL                                                     05930005
059400          UPDATE  TCOCNTL                                         05940005
059410             SET  DFLT_PRT_ORD_CDE   = :COCNTL-DFLT-PRT-ORD-CDE   05941005
059420                 ,DFLT_CRE_LBL_CDE   = :COCNTL-DFLT-CRE-LBL-CDE   05942005
059430                 ,PRT_LBL_ON_SCN_CNT = :COCNTL-PRT-LBL-ON-SCN-CNT 05943008
059440                 ,DAYS_ALWD_ADJ_QTY  = :COCNTL-DAYS-ALWD-ADJ-QTY  05944008
059450                 ,DFLT_OPER_SET_ID   = :COCNTL-DFLT-OPER-SET-ID   05945005
059460                 ,DFLT_FCSE_AREA_ID  = :COCNTL-DFLT-FCSE-AREA-ID  05946005
059470                 ,DFLT_CNSTK_LBL_QTY = :COCNTL-DFLT-CNSTK-LBL-QTY 05947005
059480                 ,CNSTK_PL_PRT_CD    = :COCNTL-CNSTK-PL-PRT-CD    05948019
059490                 ,DFLT_CNSTK_LOC_ID  = :COCNTL-DFLT-CNSTK-LOC-ID  05949005
059491                 ,CA_RCVG_PRTR_ID    = :COCNTL-CA-RCVG-PRTR-ID    05949105
059492                 ,DFLT_SU_PRTR_ID    = :COCNTL-DFLT-SU-PRTR-ID    05949205
059493                 ,CA_FLAT_PRTR_ID    = :COCNTL-CA-FLAT-PRTR-ID    05949305
059494                 ,DFLT_CNSTK_PRTR_ID = :COCNTL-DFLT-CNSTK-PRTR-ID 05949405
059495                 ,CA_SHIP_PRTR_ID    = :COCNTL-CA-SHIP-PRTR-ID    05949505
059498                                                                  05949805
059499          WHERE OPER_UNT_ID  = :COCNTL-OPER-UNT-ID                05949905
059500            AND FCLTY_ID     = :COCNTL-FCLTY-ID                   05950008
060500     END-EXEC                                                     06050005
060600                                                                  06060003
060700     EVALUATE TRUE                                                06070012
060800       WHEN SQLCODE = ZERO                                        06080012
060810            CONTINUE                                              06081012
061100       WHEN SQLCODE = -911                                        06110012
061200       WHEN SQLCODE = -913                                        06120012
061400            WHEN SQLCODE = -803                                   06140012
061500                 SET DP013-DB2-ABEND TO TRUE                      06150012
061600                 SET DP013-ROLLBACK  TO TRUE                      06160012
061700                 MOVE 'TCOCNTL' TO DP013-DB2-TABLE-NAME (1)       06170012
061800                 MOVE '5000-UPDATE'                               06180012
061900                                     TO DP013-PARAGRAPH           06190012
062000                 MOVE SQLCA          TO DP013-SQLCA               06200012
062100                 MOVE 'UPDATE TCOCNTL           '                 06210012
062200                                     TO DP013-MESSAGE-TEXT(1)     06220012
062300                 MOVE ASC-OPER-UNT-ID TO DP013-MESSAGE-TEXT (2)   06230012
062400                 PERFORM DP013-0000-PROCESS-ABEND                 06240012
062500             WHEN OTHER                                           06250012
062600                  SET DP013-DB2-ABEND TO TRUE                     06260012
062700                   SET DP013-ROLLBACK  TO TRUE                    06270012
062800                   MOVE 'TCOCNTL'      TO DP013-DB2-TABLE-NAME (1)06280012
062900                   MOVE '5000-UPDATE'                             06290012
063000                                     TO DP013-PARAGRAPH           06300012
063100                   MOVE SQLCA        TO DP013-SQLCA               06310012
063200                   MOVE 'UPDATE TCOCNTL           '               06320012
063300                                     TO DP013-MESSAGE-TEXT(1)     06330012
063400                   MOVE ASC-OPER-UNT-ID TO DP013-MESSAGE-TEXT (2) 06340012
063500                   PERFORM DP013-0000-PROCESS-ABEND               06350012
063600     END-EVALUATE.                                                06360012
063800                                                                  06380003
065100                                                                  06510003
065400*----------------------------------------------------------------*06540003
065500*    ABEND PROCESSOR MODULE                                      *06550003
065600*----------------------------------------------------------------*06560003
065700     COPY DPPD013.                                                06570003
065800                                                                  06580003
