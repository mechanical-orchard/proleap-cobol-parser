000100 IDENTIFICATION DIVISION.                                         00010001
000200 TITLE 'MANIFESTING SUBMENU'.                                     00020001
000300 PROGRAM-ID.             PCKRF850.                                00030001
000400 AUTHOR.                 DENNIS STEFFEN.                          00040001
000500 INSTALLATION.           KOHLS.                                   00050001
000600 DATE-WRITTEN            SEPTEMBER, 2000.                         00060001
000700 DATE-COMPILED.                                                   00070001
000800                                                                  00080001
000900******************************************************************00090001
001000* THIS PROGRAM DISPLAYS THE MANIFESTING SUB-MENU ON THE           00100001
001100* LRT (LASER RADIO TERMINAL) AND PASSES CONTROL TO THE PROGRAM    00110001
001200* WHICH PROCESSES THE SELECTED FUNCTION.                          00120001
001300******************************************************************00130001
001400                                                                  00140001
001500 ENVIRONMENT DIVISION.                                            00150001
001600 DATA DIVISION.                                                   00160001
001700                                                                  00170001
001800 WORKING-STORAGE SECTION.                                         00180001
001900* INBOUND COMMAREA FROM MPKCS027                                  00190001
002000     COPY MPWS026.                                                00200001
002100                                                                  00210001
002200* OUTBOUND COMMAREA                                               00220001
002300     COPY PCWS033.                                                00230001
002400                                                                  00240001
002500* HELP SCREEN COMMAREA                                            00250001
002600     COPY PCWS192.                                                00260001
002700* HELP SCREEN WORK AREA                                           00270001
002800     COPY PCWS188.                                                00280001
002900/                                                                 00290001
003000 01  PC-PROGRAM-CONSTANTS.                                        00300001
003100     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        00310001
003200         'PCKRF850'.                                              00320001
003300     05  PC-DC-RF-APPL-PGM               PIC  X(08)  VALUE        00330001
003400         'MPKCS027'.                                              00340001
003500     05  PC-MENU-TRANID                  PIC  X(04)  VALUE 'E850'.00350001
003600     05  PC-CHECK-AUTH-FOR-TRAN-E884     PIC  X(04)  VALUE 'E884'.00360001
003700     05  PC-CHECK-AUTH-FOR-TRAN-E885     PIC  X(04)  VALUE 'E885'.00370001
003800     05  PC-CHECK-AUTH-FOR-TRAN-E853     PIC  X(04)  VALUE 'E853'.00380001
003900     05  PC-END-OF-SESSION-MSG           PIC  X(19)  VALUE        00390001
004000         'END OF SESSION     '.                                   00400001
004100     05  PC-INVALID-SELECTION-MSG        PIC  X(19)  VALUE        00410001
004200         'INVALID SELECTION  '.                                   00420001
004300     05  PC-UNRECOGNIZED-PF-KEY-MSG      PIC  X(19)  VALUE        00430001
004400         'UNRECOGNIZED PF KEY'.                                   00440001
004500     05  PC-ACCESS-NOT-ALLOWED-MSG       PIC  X(19)  VALUE        00450001
004600         'USER NOT AUTHORIZED'.                                   00460001
004700     05  PC-NON-NUMERIC-SELECTION-MSG    PIC  X(19)  VALUE        00470001
004800         'NUMERIC VALUE REQ. '.                                   00480001
004900     05  PC-PROGRAM-FUNCTION-KEYS        PIC  X(19)  VALUE        00490001
005000         'F3 =END            '.                                   00500001
005100     05  PC-TRANS-UNAVAILABLE-MSG        PIC  X(19)  VALUE        00510001
005200         'TRANS NOT AVAILABLE'.                                   00520001
005300     05  PC-CICS-ABEND-MSG               PIC  X(19)  VALUE        00530001
005400         'CICS ABEND -CALL DP'.                                   00540001
005500     05  PC-CICSAUTH-MSG                 PIC  X(19)  VALUE        00550001
005600         'CICSAUTH BAD RETURN'.                                   00560001
005700     05  PC-UNAVAIL-SELECTION-MSG        PIC X(19)   VALUE        00570001
005800         'SELECTION NOT AVAIL'.                                   00580001
005810* DMH 09/02                                                       00581004
005900     05  PC-DC-IN-WMOS-MSG               PIC X(19)   VALUE        00590004
006000         'ERR - DC IS ON WMS'.                                    00600004
006300                                                                  00630001
006400 01  PN-PGM-NAME-DATA.                                            00640001
006500     05  PN-SELECTION-01-PROGRAM         PIC  X(08)  VALUE        00650001
006600         'PCKRF884'.                                              00660001
006700     05  PN-SELECTION-02-PROGRAM         PIC  X(08)  VALUE        00670001
006800         'PCKRF885'.                                              00680001
006900     05  PN-SELECTION-03-PROGRAM         PIC  X(08)  VALUE        00690001
007000         'PCKRF853'.                                              00700001
007500                                                                  00750001
007600 01  PN-PGM-NAME-TABLE  REDEFINES  PN-PGM-NAME-DATA.              00760001
007700*LMM 05  PN-PGM-NAME  OCCURS 5 TIMES                              00770001
007800     05  PN-PGM-NAME  OCCURS 3 TIMES                              00780001
007900                      INDEXED BY PN-INDX                          00790001
008000                                         PIC  X(08).              00800001
008100                                                                  00810001
008200 01  PS-PROGRAM-SWITCHES.                                         00820001
008300     05  PS-ACCESS-ALLOWED-IND           PIC  X(01)  VALUE 'N'.   00830001
008400         88  PS-NO-ACCESS-ALLOWED                    VALUE 'N'.   00840001
008500         88  PS-ACCESS-ALLOWED                       VALUE 'Y'.   00850001
008510* DMH 09/2015   ADD WMOS SWITCH                                   00851004
008520     05  PS-DC-ON-WMOS-SW               PIC  X       VALUE 'N'.   00852004
008530         88  PS-DC-ON-WMOS-YES                       VALUE 'Y'.   00853004
008540         88  PS-DC-ON-WMOS-NO                        VALUE 'N'.   00854004
008550                                                                  00855004
008600                                                                  00860001
008700                                                                  00870001
008800 01  PV-PROGRAM-VARIABLES.                                        00880001
008900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +300   00890001
009000                                                     COMP.        00900001
009100     05  PV-MESSAGE-AREA                 PIC  X(19)  VALUE SPACE. 00910001
009200     05  PV-CICS-RESPONSE                PIC S9(08)  VALUE ZEROS  00920001
009300                                                     COMP SYNC.   00930001
009400     05  PV-TRANSFER-PROGRAM             PIC  X(08)  VALUE SPACE. 00940001
009410                                                                  00941011
009411     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      00941116
009412                                                    COMP SYNC.    00941216
009420     05  PV-CSSL-MSG                     PIC  X(100) VALUE SPACE. 00942015
009430     05  PV-CSSL-MSG-LENGTH              PIC S9(04)  VALUE +0     00943015
009440                                                     COMP SYNC.   00944015
009500     05  PV-TIMESTAMP                    PIC  X(26)  VALUE SPACE. 00950001
009510     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   00951009
009520                                                     COMP SYNC.   00952009
009521     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   00952111
009522                                                     COMP.        00952211
009523     05  PV-SYSID                        PIC  X(04)  VALUE SPACE. 00952312
009530     05  PV-SYSTEM-ID.                                            00953011
009540         10  FILLER              PIC  X(04)  VALUE SPACE.         00954011
009550         10  PV-REGION-IND       PIC  X(01).                      00955011
009560             88  PV-TEST-CICS                VALUE 'T'.           00956011
009570             88  PV-QA-CICS                  VALUE 'Q'.           00957011
009580             88  PV-PROD-CICS                VALUE 'P'.           00958011
009590             88  PV-LEARN-CICS               VALUE 'L'.           00959011
009600         10  FILLER              PIC  X(03)  VALUE SPACES.        00960011
009601*                                                                 00960110
009602 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  00960210
009603     05  TS-INFO-QUEUE-NAME.                                      00960310
009604         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 00960410
009605         10  FILLER                      PIC  X(04)  VALUE 'INFO'.00960510
009606                                                                  00960610
009610* DMH 09/2015 - ADD KEY FIELDS                                    00961005
009620 01  DK-DB2-KEYS.                                                 00962005
009630     05  DK-OPER-UNT-ID                  PIC S9(04) COMP.         00963005
009640     05  DK-CURRENT-TIMESTAMP            PIC X(26)   VALUE SPACES.00964005
009700     COPY DPWS026.                                                00970001
009800                                                                  00980001
009900*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               00990001
010000     COPY DPWS013.                                                01000001
010100                                                                  01010001
010200*    COPY BOOK FOR THE CICSAUTH SUBROUTINE                        01020001
010300     COPY DPWS008.                                                01030001
010400                                                                  01040001
010500*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 01050001
010600     COPY DPWS010I.                                               01060001
010700                                                                  01070001
010800*  MAPSET                                                         01080001
010900     COPY PCKM850.                                                01090001
011000                                                                  01100001
011100*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   01110001
011200     COPY DPWS015.                                                01120001
011300                                                                  01130001
011400     COPY DFHAID.                                                 01140001
011500                                                                  01150001
011510* DMH 09/2015 - ADD WST00008/9/10                                 01151004
011520******************************************************************01152004
011530*  SQL AND COBOL DECLARATIONS FOR WST_INTGRTN_TYP                 01153004
011540******************************************************************01154004
011550     EXEC SQL                                                     01155004
011560          INCLUDE WST00008                                        01156004
011570     END-EXEC.                                                    01157004
011580******************************************************************01158004
011590*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_DEFN                   01159004
011591******************************************************************01159104
011592     EXEC SQL                                                     01159204
011593          INCLUDE WST00009                                        01159304
011594     END-EXEC.                                                    01159404
011595******************************************************************01159504
011596*  SQL AND COBOL DECLARATIONS FOR WST_ATTR_ELEM                   01159604
011597******************************************************************01159704
011598     EXEC SQL                                                     01159804
011599          INCLUDE WST00010                                        01159904
011600     END-EXEC.                                                    01160004
011601                                                                  01160104
011610     EXEC SQL                                                     01161001
011700         INCLUDE SQLCA                                            01170001
011800     END-EXEC.                                                    01180001
011900                                                                  01190001
012000                                                                  01200001
012100 LINKAGE SECTION.                                                 01210001
012200 01  DFHCOMMAREA.                                                 01220001
012300     05  FILLER                       OCCURS 1 TO 4072 TIMES      01230001
012400                                      DEPENDING ON EIBCALEN.      01240001
012500         10  FILLER                   PIC X.                      01250001
012600/                                                                 01260001
012700 PROCEDURE DIVISION.                                              01270001
012800 0000-PROGRAM-MAINLINE.                                           01280001
012900     INITIALIZE                         MP026-COMMAREA.           01290001
013000     MOVE DFHCOMMAREA                TO MP026-COMMAREA.           01300001
013100     MOVE LOW-VALUES                 TO PC850AI.                  01310001
013200     EXEC SQL SET :PV-TIMESTAMP = CURRENT TIMESTAMP END-EXEC      01320001
013300                                                                  01330001
013400     EVALUATE TRUE                                                01340001
013500         WHEN EIBCALEN = ZERO                                     01350001
013600         WHEN EIBTRNID = 'Z278'                                   01360001
013700         WHEN EIBTRNID = 'E852'                                   01370001
013800         WHEN EIBAID = DFHCLEAR                                   01380001
013900         WHEN MP026-INITIALIZE-SCREEN                             01390001
014000              INITIALIZE MP026-COMMAREA                           01400001
014100*             MOVE PC-PROGRAM-FUNCTION-KEYS                       01410001
014200*                                    TO AMSGLNO                   01420001
014300              PERFORM 8000-SEND-MAP                               01430001
014400              PERFORM 8200-RETURN-TRANID                          01440001
014500         WHEN EIBAID = DFHENTER                                   01450001
014600              PERFORM 1000-RECEIVE-MAP                            01460001
014700              PERFORM 1100-EDIT-SELECTION                         01470001
014800         WHEN EIBAID = DFHPF3                                     01480001
014900              MOVE PC-DC-RF-APPL-PGM TO PV-TRANSFER-PROGRAM       01490001
015000              PERFORM 2100-XCTL-TO-SELECTED-PROGRAM               01500001
015100         WHEN EIBAID = DFHPF1                                     01510001
015200              PERFORM 1200-HELP-SCREEN                            01520001
015300         WHEN OTHER                                               01530001
015400              MOVE PC-UNRECOGNIZED-PF-KEY-MSG                     01540001
015500                                     TO AMSGLNO                   01550001
015600              PERFORM 8100-SEND-DATA-ONLY                         01560001
015700              PERFORM 8200-RETURN-TRANID                          01570001
015800     END-EVALUATE.                                                01580001
015900                                                                  01590001
016000     GOBACK.                                                      01600001
016100*                                                                 01610001
016200*                                                                 01620001
016300 1000-RECEIVE-MAP.                                                01630001
016400     EXEC CICS                                                    01640001
016500         RECEIVE MAP    ('PC850A')                                01650001
016600                 MAPSET ('PCKM850')                               01660001
016700                 RESP   (PV-CICS-RESPONSE)                        01670001
016800     END-EXEC.                                                    01680001
016900                                                                  01690001
017000     EVALUATE TRUE                                                01700001
017100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 01710001
017200              PERFORM 1010-RECEIVE-SCREEN-FIELDS                  01720001
017300         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                01730001
017400              CONTINUE                                            01740001
017500         WHEN OTHER                                               01750001
017600              MOVE '1000-RECEIVE-MAP'                             01760001
017700                                     TO DP013-PARAGRAPH           01770001
017800              MOVE 'UNABLE TO RECEIVE MAP'                        01780001
017900                                     TO DP013-MESSAGE-TEXT (1)    01790001
018000              SET DP013-LOGIC-ABEND  TO TRUE                      01800001
018100              SET DP013-NO-ROLLBACK  TO TRUE                      01810001
018200              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              01820001
018300     END-EVALUATE.                                                01830001
018400*                                                                 01840001
018500*                                                                 01850001
018600 1010-RECEIVE-SCREEN-FIELDS.                                      01860001
018700     IF  ASELECTL > ZERO                                          01870001
018800         MOVE ASELECTI               TO MP026-SELECTION-X         01880001
018900     END-IF.                                                      01890001
019000*                                                                 01900001
019100*                                                                 01910001
019200 1100-EDIT-SELECTION.                                             01920001
019300                                                                  01930001
019400     IF  MP026-SELECTION-TEST                                     01940001
019500         CONTINUE                                                 01950001
019600     ELSE                                                         01960001
019700         MOVE MP026-SELECTION-X      TO DP010I-UNEDITED-FIELD     01970001
019800         MOVE 1                      TO DP010I-MAXIMUM-DIGITS     01980001
019900         MOVE 0                      TO DP010I-MAXIMUM-DECIMALS   01990001
020000         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  02000001
020100                                                                  02010001
020210         CALL DP010I-NUMERIC-EDIT-ROUTINE                         02021017
020220                         USING DP010I-NUMERIC-EDIT-AREA           02022017
020300                                                                  02030001
020400         IF  DP010I-ERROR-DETECTED                                02040001
020500             MOVE PC-NON-NUMERIC-SELECTION-MSG TO AMSGLNO         02050001
020600             PERFORM 8100-SEND-DATA-ONLY                          02060001
020700             PERFORM 8200-RETURN-TRANID                           02070001
020800         ELSE                                                     02080001
020900             MOVE DP010I-NUMERIC-FIELD   TO MP026-SELECTION       02090001
021000         END-IF                                                   02100001
021100     END-IF.                                                      02110001
021200                                                                  02120001
021300     EVALUATE TRUE                                                02130001
021400*LMM WHEN MP026-SELECTION-X = '2' OR 'T'                          02140001
021500     WHEN MP026-SELECTION-X = '1 ' OR '2' OR '3' OR '5' OR 'T'    02150001
021600         PERFORM 2000-PROCESS-SELECTION                           02160001
021700     WHEN OTHER                                                   02170001
021800         MOVE DP015-UNP-ALP-BRT-MDT  TO ASELECTA                  02180001
021900         MOVE PC-INVALID-SELECTION-MSG                            02190001
022000                                     TO AMSGLNO                   02200001
022100         PERFORM 8100-SEND-DATA-ONLY                              02210001
022200         PERFORM 8200-RETURN-TRANID                               02220001
022300     END-EVALUATE.                                                02230001
022400                                                                  02240001
022500 1200-HELP-SCREEN.                                                02250001
022600     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      02260001
022700     MOVE 'PCKRF850'                  TO PC192-PROGRAM-NAME       02270001
022800     COPY PCPD188.                                                02280001
022900     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      02290001
023000     PERFORM 2200-XCTL-TO-HELP.                                   02300001
023100                                                                  02310001
023200*                                                                 02320001
023300 2000-PROCESS-SELECTION.                                          02330001
023400     SET PN-INDX                     TO MP026-SELECTION.          02340001
023500     IF MP026-SELECTION < 4                                       02350001
023600         PERFORM 9000-CHECK-RACF                                  02360001
023700     ELSE                                                         02370001
024200         MOVE PN-PGM-NAME (PN-INDX)  TO PV-TRANSFER-PROGRAM       02420001
024300         PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                    02430001
024500     END-IF.                                                      02450001
024600                                                                  02460001
024610* DMH 09/2015 - ADD WMOS CHECK                                    02461004
024620     PERFORM 2040-FIND-SYSTEM-ID.                                 02462012
024640     PERFORM 2050-FIND-LOGON-INFO.                                02464009
024641     PERFORM 2060-GET-CURR-TMST.                                  02464109
024642     MOVE MP026-OPER-UNIT-ID         TO DK-OPER-UNT-ID.           02464209
024643     PERFORM 2070-CHECK-DC-WMOS.                                  02464309
024644                                                                  02464409
024645* IF THE DC IS SET UP ON WMOS, THEN THE ONLY OPTION AVAILABLE     02464509
024646* FROM THIS SCREEN IS 1-CARTON FUNCTIONS                          02464609
024647*                                                                 02464709
024651     IF  PS-DC-ON-WMOS-NO                                         02465107
024652         CONTINUE                                                 02465207
024653     ELSE                                                         02465307
024654     IF  PS-DC-ON-WMOS-YES  AND                                   02465407
024655         MP026-SELECTION = 1                                      02465507
024656         CONTINUE                                                 02465607
024657     ELSE                                                         02465707
024664         MOVE DP015-UNP-NUM-BRT-MDT  TO ASELECTA                  02466404
024665         MOVE PC-DC-IN-WMOS-MSG                                   02466504
024666                                     TO AMSGLNO                   02466604
024667         SET PS-NO-ACCESS-ALLOWED    TO TRUE                      02466704
024671     END-IF                                                       02467107
024672     END-IF.                                                      02467207
024673* DMH 09/2015 - END                                               02467307
024674                                                                  02467407
024700     IF  PS-ACCESS-ALLOWED                                        02470001
024800         MOVE PN-PGM-NAME (PN-INDX)  TO PV-TRANSFER-PROGRAM       02480001
024900         PERFORM 2100-XCTL-TO-SELECTED-PROGRAM                    02490001
025000     ELSE                                                         02500001
025100         MOVE DP015-UNP-ALP-BRT-MDT  TO ASELECTA                  02510001
025200         PERFORM 8100-SEND-DATA-ONLY                              02520001
025300         PERFORM 8200-RETURN-TRANID                               02530001
025400     END-IF.                                                      02540001
025500*                                                                 02550001
025501                                                                  02550104
025502                                                                  02550204
025503* DMH 09/2015 - START                                             02550304
025504 2040-FIND-SYSTEM-ID.                                             02550412
025505                                                                  02550512
025506     EXEC CICS                                                    02550612
025507         INQUIRE                                                  02550712
025508             TRANSACTION   (PC-MENU-TRANID)                       02550813
025509             REMOTESYSTEM  (PV-SYSID)                             02550912
025510             RESP          (PV-CICS-RESPONSE)                     02551012
025511     END-EXEC.                                                    02551112
025512                                                                  02551212
025513     EVALUATE TRUE                                                02551312
025514         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02551412
025515             CONTINUE                                             02551512
025516         WHEN OTHER                                               02551612
025517             MOVE '1200-FIND-SYSTEM-ID'                           02551712
025518                 TO DP013-PARAGRAPH                               02551812
025519             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 02551912
025520                 TO DP013-MESSAGE-TEXT (1)                        02552012
025521             SET DP013-CICS-ABEND      TO  TRUE                   02552112
025522             SET DP013-NO-ROLLBACK     TO  TRUE                   02552212
025523             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               02552312
025524             MOVE 'CICS ERR/HELP DESK '                           02552413
025525                                       TO  AMSGLNO                02552512
025526             SET MP026-PROCESS-SCREEN  TO  TRUE                   02552612
025527             PERFORM 8100-SEND-DATA-ONLY                          02552712
025528             PERFORM 8200-RETURN-TRANID                           02552812
025529     END-EVALUATE.                                                02552912
025530                                                                  02553012
025531 2050-FIND-LOGON-INFO.                                            02553109
025532     MOVE LENGTH OF DP026-SIGN-ON-INFO                            02553209
025533                    TO  PV-SIGN-ON-INFO-LENGTH.                   02553309
025534     MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   02553409
025535     MOVE +1        TO  PV-TS-ITEM.                               02553509
025536                                                                  02553609
025537     IF PV-SYSID = SPACES                                         02553709
025538         EXEC CICS                                                02553809
025539             READQ TS                                             02553909
025540                 QUEUE  (TS-INFO-QUEUE-NAME)                      02554009
025541                 ITEM   (PV-TS-ITEM)                              02554109
025542                 INTO   (DP026-SIGN-ON-INFO)                      02554209
025543                 RESP   (PV-CICS-RESPONSE)                        02554309
025544         END-EXEC                                                 02554409
025545     ELSE                                                         02554509
025546         EXEC CICS                                                02554609
025547             READQ TS                                             02554709
025548                 QUEUE   (TS-INFO-QUEUE-NAME)                     02554809
025549                 SYSID   (PV-SYSID)                               02554909
025550                 ITEM    (PV-TS-ITEM)                             02555009
025551                 INTO    (DP026-SIGN-ON-INFO)                     02555109
025552                 LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 02555209
025553                 RESP    (PV-CICS-RESPONSE)                       02555309
025554         END-EXEC                                                 02555409
025555     END-IF.                                                      02555509
025556                                                                  02555609
025557     EVALUATE TRUE                                                02555709
025558         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02555809
025559             MOVE DP026-LOCATION-NBR  TO MP026-OPER-UNIT-ID       02555909
025560                                                                  02556014
025561             MOVE DP026-USERID    TO MP026-USERID                 02556109
025562         WHEN OTHER                                               02556209
025563                                                                  02556309
025564             INITIALIZE PV-CSSL-MSG                               02556409
025565             STRING ' PCKRF850 2050-FIND-LOGON-INFO'              02556515
025566                    ' CANT READ LOGON TSQ -'                      02556609
025567                    ' PV-SYSID:'  PV-SYSID                        02556709
025568                    ' USER:'      DP026-USERID                    02556809
025569                    DELIMITED BY SIZE INTO PV-CSSL-MSG            02556909
025570                                                                  02557015
025571              MOVE LENGTH OF PV-CSSL-MSG                          02557109
025572                TO PV-CSSL-MSG-LENGTH                             02557209
025573                                                                  02557315
025574              EXEC CICS                                           02557409
025575                   WRITEQ TD                                      02557509
025576                    QUEUE  ('CSSL')                               02557609
025577                     FROM  (PV-CSSL-MSG)                          02557709
025578                   LENGTH  (PV-CSSL-MSG-LENGTH)                   02557809
025579                     RESP  (PV-CICS-RESP)                         02557909
025580              END-EXEC                                            02558009
025581                                                                  02558109
025582     END-EVALUATE.                                                02558209
025583                                                                  02558309
025584                                                                  02558409
025585 2060-GET-CURR-TMST.                                              02558504
025586                                                                  02558604
025587         EXEC SQL                                                 02558704
025588             SET :DK-CURRENT-TIMESTAMP = CURRENT TIMESTAMP        02558804
025589         END-EXEC.                                                02558904
025590                                                                  02559004
025591                                                                  02559104
025592 2070-CHECK-DC-WMOS.                                              02559204
025593                                                                  02559304
025594     EXEC SQL                                                     02559404
025595          SELECT   A.INTGRTN_TYP_DESC                             02559504
025596            INTO  :WST00008-INTGRTN-TYP-DESC                      02559604
025597            FROM                                                  02559704
025598                  WST_INTGRTN_TYP  A                              02559804
025599               ,  WST_ATTR_DEFN    B                              02559904
025600               ,  WST_ATTR_ELEM    C                              02560004
025601               ,  WST_ATTR_ELEM    D                              02560104
025602               ,  WST_ATTR_ELEM    E                              02560204
025603            WHERE                                                 02560304
025604                  A.INTGRTN_TYP_CDE   = 'WMOSON'                  02560404
025605              AND A.INTGRTN_TYP_CDE   = B.INTGRTN_TYP_CDE         02560504
025606              AND B.ATTR_DEFN_SEQ_NBR = 1                         02560604
025607              AND B.INTGRTN_TYP_CDE   = C.INTGRTN_TYP_CDE         02560704
025608              AND C.ATTR_DEFN_SEQ_NBR = 1                         02560804
025609              AND B.INTGRTN_TYP_CDE   = D.INTGRTN_TYP_CDE         02560904
025610              AND D.ATTR_DEFN_SEQ_NBR = 2                         02561004
025611              AND B.INTGRTN_TYP_CDE   = E.INTGRTN_TYP_CDE         02561104
025612              AND E.ATTR_DEFN_SEQ_NBR = 3                         02561204
025613              AND C.ATTR_ELEM_SEQ_NBR = D.ATTR_ELEM_SEQ_NBR       02561304
025614              AND C.ATTR_ELEM_SEQ_NBR = E.ATTR_ELEM_SEQ_NBR       02561404
025615              AND C.ATTR_ELEM_NBR     = :DK-OPER-UNT-ID           02561504
025616              AND E.ATTR_ELEM_TMST   <= :DK-CURRENT-TIMESTAMP     02561604
025617     END-EXEC.                                                    02561704
025618                                                                  02561804
025619     EVALUATE TRUE                                                02561904
025620         WHEN SQLCODE = ZERO                                      02562004
025621             SET PS-DC-ON-WMOS-YES      TO TRUE                   02562104
025622         WHEN OTHER                                               02562204
025623             SET PS-DC-ON-WMOS-NO       TO TRUE                   02562304
025624     END-EVALUATE.                                                02562404
025625* DMH 09/2015 - END                                               02562504
025626                                                                  02562604
025627                                                                  02562704
025630*                                                                 02563001
025700 2100-XCTL-TO-SELECTED-PROGRAM.                                   02570001
025800                                                                  02580001
025900     INITIALIZE PC033-COMMON-DATA.                                02590001
026000     SET PC033-INITIALIZE-SCREEN     TO TRUE.                     02600001
026100     MOVE PC-CURRENT-PROGRAM-NAME    TO PC033-LAST-PROGRAM.       02610001
026200     PERFORM DP026-0000-GET-LOGON-INFO.                           02620001
026300     MOVE DP026-USERID                TO PC033-USER-ID.           02630001
026400     MOVE DP026-LOCATION-NBR          TO PC033-OPER-UNT-ID        02640002
026500     MOVE DP026-FCLTY-ID              TO PC033-FCLTY-ID           02650001
026600     MOVE DP026-QUEUE-TERM            TO PC033-TERM-ID            02660001
026700     SET PC033-PROCESS-BY-UPC         TO TRUE                     02670001
026800                                                                  02680001
026900*    SET ROOT-PROGRAM FOR FAST TOTE SCAN PROCESSING               02690001
027000     IF PN-INDX = 3                                               02700001
027100         MOVE 'PCKRF853'              TO PC033-ROOT-PROGRAM       02710001
027200     END-IF                                                       02720001
027300                                                                  02730001
027400                                                                  02740001
027500     MOVE LENGTH OF PC033-COMMON-DATA TO PV-COMMAREA-LENGTH       02750001
027600                                                                  02760001
027700     EXEC CICS                                                    02770001
027800         XCTL                                                     02780001
027900             PROGRAM   (PV-TRANSFER-PROGRAM)                      02790001
028000             COMMAREA  (PC033-COMMON-DATA)                        02800001
028100             LENGTH    (PV-COMMAREA-LENGTH)                       02810001
028200             RESP      (PV-CICS-RESPONSE)                         02820001
028300     END-EXEC.                                                    02830001
028400                                                                  02840001
028500     EVALUATE TRUE                                                02850001
028600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 02860001
028700              CONTINUE                                            02870001
028800         WHEN OTHER                                               02880001
028900              MOVE '2100-XCTL-TO-SELECTED-PROGRAM'                02890001
029000                                     TO DP013-PARAGRAPH           02900001
029100              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       02910001
029200                                     TO DP013-MESSAGE-TEXT (1)    02920001
029300              MOVE PV-TRANSFER-PROGRAM                            02930001
029400                                     TO DP013-MESSAGE-TEXT (2)    02940001
029500              SET DP013-CICS-ABEND   TO TRUE                      02950001
029600              SET DP013-NO-ROLLBACK  TO TRUE                      02960001
029700              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              02970001
029800              MOVE PC-TRANS-UNAVAILABLE-MSG                       02980001
029900                                     TO AMSGLNO                   02990001
030000              SET MP026-PROCESS-SCREEN TO TRUE                    03000001
030100              PERFORM 8100-SEND-DATA-ONLY                         03010001
030200              PERFORM 8200-RETURN-TRANID                          03020001
030300     END-EVALUATE.                                                03030001
030400                                                                  03040001
030500     COPY DPPD026.                                                03050001
030600*                                                                 03060001
030700 2200-XCTL-TO-HELP.                                               03070001
030800                                                                  03080001
030900     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       03090001
031000                                                                  03100001
031100     EXEC CICS                                                    03110001
031200         XCTL                                                     03120001
031300             PROGRAM   (PV-TRANSFER-PROGRAM)                      03130001
031400             COMMAREA  (PC192-COMMAREA)                           03140001
031500             LENGTH    (PV-COMMAREA-LENGTH)                       03150001
031600             RESP      (PV-CICS-RESPONSE)                         03160001
031700     END-EXEC.                                                    03170001
031800                                                                  03180001
031900     EVALUATE TRUE                                                03190001
032000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03200001
032100              CONTINUE                                            03210001
032200         WHEN OTHER                                               03220001
032300              MOVE '2200-XCTL-TO-HELP'                            03230001
032400                                     TO DP013-PARAGRAPH           03240001
032500              MOVE 'UNABLE TO XCTL THE FOLLOWING PROGRAM: '       03250001
032600                                     TO DP013-MESSAGE-TEXT (1)    03260001
032700              MOVE PV-TRANSFER-PROGRAM                            03270001
032800                                     TO DP013-MESSAGE-TEXT (2)    03280001
032900              SET DP013-CICS-ABEND   TO TRUE                      03290001
033000              SET DP013-NO-ROLLBACK  TO TRUE                      03300001
033100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03310001
033200              MOVE PC-TRANS-UNAVAILABLE-MSG                       03320001
033300                                     TO AMSGLNO                   03330001
033400              SET MP026-PROCESS-SCREEN TO TRUE                    03340001
033500              PERFORM 8100-SEND-DATA-ONLY                         03350001
033600              PERFORM 8200-RETURN-TRANID                          03360001
033700     END-EVALUATE.                                                03370001
033800/                                                                 03380001
033900 8000-SEND-MAP.                                                   03390001
034000     EXEC CICS                                                    03400001
034100         SEND MAP       ('PC850A')                                03410001
034200              MAPSET    ('PCKM850')                               03420001
034300              ERASE                                               03430001
034400              RESP      (PV-CICS-RESPONSE)                        03440001
034500     END-EXEC.                                                    03450001
034600                                                                  03460001
034700     EVALUATE TRUE                                                03470001
034800         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03480001
034900              CONTINUE                                            03490001
035000         WHEN OTHER                                               03500001
035100              MOVE '8000-SEND-MAP'   TO DP013-PARAGRAPH           03510001
035200              MOVE 'UNABLE TO SEND MAP'                           03520001
035300                                     TO DP013-MESSAGE-TEXT (1)    03530001
035400              SET DP013-CICS-ABEND   TO TRUE                      03540001
035500              SET DP013-NO-ROLLBACK  TO TRUE                      03550001
035600              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03560001
035700     END-EVALUATE.                                                03570001
035800*                                                                 03580001
035900*                                                                 03590001
036000 8100-SEND-DATA-ONLY.                                             03600001
036100     MOVE -1 TO ASELECTL.                                         03610001
036200                                                                  03620001
036300     EXEC CICS                                                    03630001
036400         SEND MAP       ('PC850A')                                03640001
036500              MAPSET    ('PCKM850')                               03650001
036600              CURSOR                                              03660001
036700              DATAONLY                                            03670001
036800              RESP      (PV-CICS-RESPONSE)                        03680001
036900     END-EXEC.                                                    03690001
037000                                                                  03700001
037100     EVALUATE TRUE                                                03710001
037200         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03720001
037300              CONTINUE                                            03730001
037400         WHEN OTHER                                               03740001
037500              MOVE '8100-SEND-DATA-ONLY'                          03750001
037600                                     TO DP013-PARAGRAPH           03760001
037700              MOVE 'UNABLE TO SEND DATA'                          03770001
037800                                     TO DP013-MESSAGE-TEXT (1)    03780001
037900              SET DP013-CICS-ABEND   TO TRUE                      03790001
038000              SET DP013-NO-ROLLBACK  TO TRUE                      03800001
038100              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              03810001
038200     END-EVALUATE.                                                03820001
038300*                                                                 03830001
038400*                                                                 03840001
038500 8200-RETURN-TRANID.                                              03850001
038600     MOVE LENGTH OF MP026-COMMAREA    TO PV-COMMAREA-LENGTH       03860001
038700     EXEC CICS                                                    03870001
038800         RETURN TRANSID   (PC-MENU-TRANID)                        03880001
038900                COMMAREA  (MP026-COMMAREA)                        03890001
039000                LENGTH    (PV-COMMAREA-LENGTH)                    03900001
039100                RESP      (PV-CICS-RESPONSE)                      03910001
039200     END-EXEC.                                                    03920001
039300                                                                  03930001
039400     EVALUATE TRUE                                                03940001
039500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 03950001
039600              CONTINUE                                            03960001
039700         WHEN OTHER                                               03970001
039800              MOVE '8200-RETURN-TRANID'                           03980001
039900                                     TO DP013-PARAGRAPH           03990001
040000              MOVE 'UNABLE TO RETURN TO TRANID'                   04000001
040100                                     TO DP013-MESSAGE-TEXT (1)    04010001
040200              SET DP013-CICS-ABEND   TO TRUE                      04020001
040300              SET DP013-NO-ROLLBACK  TO TRUE                      04030001
040400              PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG              04040001
040500     END-EVALUATE.                                                04050001
040600*                                                                 04060001
040700*                                                                 04070001
040800 8300-LOGOFF-TO-VTAM-SCREEN.                                      04080001
040900     EXEC CICS                                                    04090001
041000         START TRANSID  ('Z011')                                  04100001
041100               TERMID   (EIBTRMID)                                04110001
041200               NOHANDLE                                           04120001
041300     END-EXEC.                                                    04130001
041400*                                                                 04140001
041500*                                                                 04150001
041600 9000-CHECK-RACF.                                                 04160001
041700******************************************************************04170001
041800*  CHECK ACCESSS AUTHORITY OF USER                                04180001
041900******************************************************************04190001
042000     SET DP008-RSRC-TYPE-TRAN        TO TRUE.                     04200001
042100     SET DP008-ACCESS-TYPE-USE       TO TRUE.                     04210001
042200                                                                  04220001
042300     EVALUATE TRUE                                                04230001
042400         WHEN MP026-SELECTION-ONE                                 04240001
042500              MOVE PC-CHECK-AUTH-FOR-TRAN-E884                    04250001
042600                                      TO DP008-RESOURCE-NAME      04260001
042700         WHEN MP026-SELECTION-TWO                                 04270001
042800              MOVE PC-CHECK-AUTH-FOR-TRAN-E885                    04280001
042900                                      TO DP008-RESOURCE-NAME      04290001
043000         WHEN MP026-SELECTION-THREE                               04300001
043100              MOVE PC-CHECK-AUTH-FOR-TRAN-E853                    04310001
043200                                      TO DP008-RESOURCE-NAME      04320001
043300     END-EVALUATE.                                                04330001
043400                                                                  04340001
043500     EXEC CICS                                                    04350001
043600          LINK PROGRAM  (DP008-SECURITY-SUBROUTINE)               04360001
043700               COMMAREA (DP008-SECURITY-COMMAREA)                 04370001
043800               LENGTH   (DP008-SECURITY-COMMAREA-LENGTH)          04380001
043900               RESP     (PV-CICS-RESPONSE)                        04390001
044000     END-EXEC.                                                    04400001
044100                                                                  04410001
044200     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       04420001
044300         IF  DP008-CALL-SUCCESSFUL                                04430001
044400             IF  DP008-ACCESS-ALLOWED                             04440001
044500                 SET PS-ACCESS-ALLOWED                            04450001
044600                                     TO TRUE                      04460001
044700             ELSE                                                 04470001
044800                 MOVE PC-ACCESS-NOT-ALLOWED-MSG                   04480001
044900                                     TO AMSGLNO                   04490001
045000             END-IF                                               04500001
045100         ELSE                                                     04510001
045200             MOVE PC-CICSAUTH-MSG    TO AMSGLNO                   04520001
045300         END-IF                                                   04530001
045400     ELSE                                                         04540001
045500         MOVE '9000-CHECK-RACF'      TO DP013-PARAGRAPH           04550001
045600         MOVE 'BAD LINK TO RACF PROGRAM'                          04560001
045700                                     TO DP013-MESSAGE-TEXT (1)    04570001
045800         SET DP013-CICS-ABEND        TO TRUE                      04580001
045900         SET DP013-NO-ROLLBACK       TO TRUE                      04590001
046000         PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                   04600001
046100     END-IF.                                                      04610001
046200*                                                                 04620001
046300*                                                                 04630001
046400 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  04640001
046500     MOVE PC-CURRENT-PROGRAM-NAME    TO DP013-PROGRAM.            04650001
046600     MOVE DFHEIBLK                   TO DP013-DFHEIBLK.           04660001
046700     INITIALIZE DP013-SRC-TASK-NUMBER                             04670001
046800                DP013-STACK.                                      04680001
046900     SET DP013-LINK-RETURN           TO TRUE.                     04690001
047000                                                                  04700001
047100     EXEC CICS                                                    04710001
047200         LINK                                                     04720001
047300             PROGRAM   (DP013-NAME)                               04730001
047400             COMMAREA  (DP013-PARAMETERS)                         04740001
047500             LENGTH    (DP013-LENGTH)                             04750001
047600     END-EXEC.                                                    04760001
