000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             SAKUT023.                                00050000
000600 AUTHOR.                 KOHLS DEPARTMENT STORES.                 00060000
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            MAY 2002.                                00080000
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100******************************************************************00110000
001200*  THIS PROGRAM CREATES NINE MARKDOWN/MARKUP FILES AND ONE        00120000
001300*  MERCHANDISE LEDGER MARKDOWN/MARKUP TRANSACTION REPORT. THIS    00130000
001400*  PROGRAM SOURCE FROM THE COSA DATABASE.                         00140000
001500******************************************************************00150000
001600*  CHANGES MADE:                                                  00160000
001700*     BY JIM HUNTER      03/25/2008          WR: 33714            00170000
001800*     EXCLUDE THIRD PARTY CARD SALES (DEPARTMENTS 833 AND 834)    00180000
001900******************************************************************00190000
002000*  CHANGES MADE:                                                  00200000
002100*     BY STEVEN NOWAK    04/15/2008          WR: 33714            00210000
002200*     DUE TO QUANTITY EXTEND CHANGES IN THE NEWEST RELEASE, NEED  00220000
002300*     TO RING EACH ITEM SEPERATLY, COMMENT OUT PARA 7900- WHICH   00230000
002400*     IS CAUSING NO MATCHES DUE TO 'PENNY' DIFFERENCES            00240000
002500******************************************************************00250000
002600*  CHANGES MADE:                                                  00260000
002700*     BY STEVEN NOWAK    06/02/2008          IR: 381721           00270000
002800*     SALES CORRECTIONS ARE NOT TAKING MARK DOWNS WHEN PROCESSED  00280000
002900******************************************************************00290000
003000*  CHANGES MADE:                                                  00300000
003100*     BY STEVEN NOWAK    06/25/2008          IR: 416561           00310000
003200*     SEND SALES CORRECTIONS TO MERCHANDISE LEDGER                00320000
003300******************************************************************00330000
003400* DATE: 10/14/2008                           WR 34938             00340000
003500*   BY:JOANNE PIETROSKE (REFER TO 'SP0906' FOR ALL CHANGES)       00350000
003600*   ADD REPORT LINES FOR EACH OF THE 4 NEW LID REASON CODES       00360000
003700******************************************************************00370000
003800*  CHANGES MADE:                                                  00380000
003900*     BY CHERI PARMLEY  02/18/2011           WR: 39586            00390000
004000*     ADD NEW FILE FOR DATA WAREHOUSE WHEN MW MARKDOWNS/MARKDOWN  00400000
004100*     CUTOFF/MARKUPS/MARKUP CUTOFF ARE WRITTEN TO. DD'S FOR       00410000
004200*     OUT03,04,07,08. ITS A COPY OF THE MLRD017 FILE WITH 3       00420000
004300*     ADDITIONAL FIELDS AND THE UNPACKING OF ALL COMP FIELDS.     00430000
004400******************************************************************00440000
004500*  CHANGES MADE:                                                  00450000
004600*     BY CHERI PARMLEY  03/15/2011           WR: 39586            00460000
004700*     ADD YEAR TO END OF FILE FOR PART OF THE ML044-PC-DTE        00470000
004800******************************************************************00480000
004900* CHANGED: 01/26/2012                                            *00490000
005000* BY:      ROB SWAGER                                            *00500000
005100* FOR:     WR24719                                               *00510000
005200* WHY:     EXPANDED SIZE OF PV-PC-OLD-PR-AMT FIELD AND           *00520000
005300*          PV-PC-NEW-PR-AMT FIELD AND                            *00530000
005400*          PV-PC-DIFFER-AMT FIELD FOR LARGE                      *00540000
005500*         RETAIL ITEMS PART OF KOHLS CASH PROJECT.               *00550000
005600******************************************************************00560000
005700*  CHANGES MADE:                                                  00570000
005800*     BY DAN PAYNTER    05/24/2012           WR: 35157            00580000
005900*     ADD ABILITY TO CALCULATE MARKDOWN CANCEL ON ECOMMERCE       00590000
006000*     TRANSACTIONS WHERE THE PRICE MOVED BETWEEN THE TIME OF      00600000
006100*     THE ORDER BEING PLACED TO THE TIME OF THE ORDER BEING       00610000
006200*     SHIPPED.  ELIMINATED CHECKS FOR POS-CAP-LVL < 11 BECAUSE    00620000
006300*     THE POS-CAP-LVL WILL ALWAYS BE GREATER THAN 11.             00630000
006400******************************************************************00640000
006500*  CHANGES MADE:                                                  00650000
006600*     BY COGNIZANT      07/20/2012           PKE000000011018      00660000
006700*     ADD COMMIT STATEMENTS TO 2200- AND 6100- PARA TO            00670000
006800*     HANDLE DBKR0127 FAILURE DUE TO CONTENTION WITH JOB SAK007   00680000
006900******************************************************************00690000
007000*  CHANGES MADE:                                                  00700000
007100*     BY JIM ARENDT     08/06/2012           WR39372              00710000
007200*     MOVED DISCOUNT CODE 765.                                    00720000
007300******************************************************************00730000
P8612 *  CHANGES MADE:                                                  00740000
P8612 *     BY COGNIZANT      09/02/2014           CHG0092405           00750000
P8612 *     EXCULDE NEW MARKET PLACE DEPARTMENT '070'                   00760000
P8612 ******************************************************************00770000
011618*  CHANGES MADE:                                                  00780000
011618*     BY DAN PAYNTER    01/16/2018           CHG0187382           00790000
011618*     FIX BUGS FOR RETURNS: MDC FOR PROMOTIONS, MD FOR MAN LID    00800000
011618*     FROM A PRICE CORRECTION, AND MDC FOR ADDTL PROMO (TIERED)   00810000
011618******************************************************************00820000
062118*  CHANGES MADE:                                                  00830000
062118*     BY DAN PAYNTER    06/21/2018           CHG0201651           00840000
062118*     BY DAN PAYNTER    06/29/2018           CHG0201651           00850000
062118*     PROCESS POC PRICE ADJ/PSA ITEMS THROUGH THE SAME NEW CODE   00860000
062118*     THAT WAS ADDED FOR POC RETURNS ITEMS EARLIER IN THE YEAR.   00870000
062118*     RESOLVE INCIDENT IN WHICH RETURN OWN ADJ WAS INCORRECTLY    00880000
062118*     BEING RECORDED AS A MARKUP CANCEL. THIS IS A SHORT TERM FIX 00890000
062118*     THAT WILL RESULT IN THE PROMOTIONAL MDC BEING ROLLED INTO   00900000
062118*     THE RETURN OWNERSHIP ADJUSTMENT.                            00910000
062118*     FIX MINOR ISSUE WITH TIERED PROMO ON PSA/PA ITEMS FROM POC. 00920000
062918*     RESOLVED ISSUE WITH PRICE MOVEMENT ON POC RETURNS           00930000
062918*     ON WHICH THE PRICE WAS LOWER AT THE TIME OF SALE THAN AT    00940000
062918*     THE TIME OF THE RETURN                                      00950000
072618******************************************************************00960000
072618*  CHANGES MADE:                                                  00970000
072618*     BY DAN PAYNTER    07/26/2018           CHG0203936           00980000
072618*     PROPERLY REPORT OLD AND NEW PRICES ON OWNERSHIP RETURN ADJ  00990000
072618*     FOR POC RETURNS, PA, AND PSA TRANSACTIONS ON ML OUTPUT FILE.01000000
072618******************************************************************01010000
205464*  CHANGES MADE:                                                  01020000
205464*     BY JIM ARENDT     08/16/2018           CHG0205464           01030000
205464*     ADDED DISCOUNT CODE 710.                                    01040000
007300******************************************************************01050000
214615*  CHANGES MADE:                                                  01051000
214615*     BY JIM ARENDT     01/15/2019           CHG0214615           01052000
214615*     CHANGED PROGRAM TO READ TWO NEW FIELDS FROM TEPITM          01053000
214615*     (ORIG_SAL_TYP_CDE AND ORIG_REG_RTL_AMT) AND PROCESS THEM.   01053100
007300******************************************************************01053200
221940*  CHANGES MADE:                                                  01053300
221940*     BY DAN PAYNTER    04/16/2019           CHG0221940           01053400
221940*     BACKOUT THE PRICE CHANGE MOVEMENT CHANGE FOR POC BY         01053500
221940*     RESTORING THE PREVIOUS PRODUCTION VERSION OF THE CODE       01053600
007300******************************************************************01053700
226892*  CHANGES MADE:                                                  01053800
226892*     BY JIM ARENDT     06/13/2019           CHG0226892           01053900
226892*     ADDING CHG0214615 BACK IN ALONG WITH A FIX SO THE ML SYSTEM 01054000
226892*     WILL PROCESS MARKDOWN CANCELS CORRECTLY.                    01055000
040220******************************************************************01056000
040220*  CHANGES MADE:                                                  01057000
040220*     BY DAN PAYNTER    04/02/2020           CHG0242320           01058000
040220*     FIX IMBALANCES BETWEEN PEK AND SAK REPORT BY ENSURING THAT  01059000
040220*     MD WILL BE COUNTED AS MD'S AND MDC WILL BE COUNTED AS MDC'S 01059100
040220*     IN ML                                                       01059200
007300******************************************************************01059300
MKTPLC*  CHANGES MADE:                                                  01060400
MKTPLC*     BY JIM HUNTER     06/02/2020           CHG0??????           01060501
MKTPLC*     REPLACE WAYFAIR DEPT 070 CHECK WITH MARKETPLACE DEPT 985    01060600
MKTPLC*     CHECK TO PREVENT MARKETPLACE ITEMS FROM GOING TO ML.        01060700
MKTPLC******************************************************************01060800
BOSSCL*   02/21/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0249017          01060907
BOSSCL* THIS CHANGE WILL CONTAIN A FIX FOR EXISTING PRODUCTION ORDERS,  01061001
BOSSCL* AS WELL AS BOSS CLEARANCE ORDERS WHEN THEY ARE ENABLED:         01061101
BOSSCL*   IF THE STORE PRICE CHANGED AFTER THE ECOM ORDER DATE          01061201
BOSSCL*     GET THE STORE'S ACTIVE PRICE ON THE ECOM ORDER DATE         01061301
BOSSCL*     AND THE STORE SALE DATE.   IF THERE IS A DIFFERENCE,        01061401
BOSSCL*     CALCULATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE.       01061501
BOSSCL*     NEED TSKXREF AND TPPCPRC TABLES.                            01061601
BOSSCL*   IF THE STORE PRICE DIDN'T CHANGE,                             01061701
BOSSCL*     DO NOT CREATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE    01061801
BOSSCL*     BETWEEN THE ECOM AND STORE PRICES.  THE TRANSFER PRICE      01061901
BOSSCL*     FROM ECOM TO THE STORE WILL BE OFFSET BY THE PRICE THE      01062001
BOSSCL*     CUSTOMER PAYS TO THE STORE.                                 01062101
BOSSCL******************************************************************01062201
BOSSC2*   10/30/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0246551          01062314
BOSSC2* THIS CHANGE IS FIX 2 OF 3 FOR CALCULATING OWNERSHIP ADJUSTMENTS 01062414
BOSSC2* FOR BOSS, SFS AND BOPUS ORDERS.  THIS SHOULD BE THE FINAL CHANGE01062514
BOSSC2* FOR SFS AND BOPUS ORDERS.  IT ALSO CONTAINS CHANGES FOR BOSS    01062614
BOSSC2* ORDERS WHICH WILL REQUIRE A FUTURE CHANGE TO GET TRANSFER       01062714
BOSSC2* INFORMATION.                                                    01062814
BOSSC2******************************************************************01063614
BOSSC3*   11/04/2020 - JIM HUNTER  BOSS CLEARANCE   CHG0252661          01063724
BOSSC3* THIS CHANGE IS FIX 3 OF 3 FOR CALCULATING OWNERSHIP ADJUSTMENTS 01063816
BOSSC3* FOR BOSS ORDERS.  IT WILL READ THE NEW SAT_BOSS_TRANSFERS TABLE 01063916
BOSSC3* TO GET THE TRANSFER DATE AND PRICE, WHICH IS REQUIRED WHEN      01064016
BOSSC3* CALCULATING BOSS OWNERSHIP ADJUSTMENTS.                         01064116
BOSSC3******************************************************************01064216
MUCFIX*   12/18/2020 - JIM HUNTER  MARKUP CANCEL FIX   CHG0252661       01064324
MUCFIX* THIS IS A FIX TO MAKE SURE THAT MARKDOWN CANCEL AMOUNTS ARE     01064420
MUCFIX* POSITIVE.                                                       01064520
MUCFIX******************************************************************01064620
262807*   05/26/2021 - JIM HUNTER  SEPHORA DISCOUNTS   CHG0262807       01064733
262807* THIS CHANGE ADDS SEPHORA DISCOUNTS TO THE MU / MD REPORT.       01064833
262807* ALSO, THE 4 OBSOLETE MW FILES HAVE BEEN REMOVED:                01065033
262807* DATAWHSE-MARKDOWN-FILE                                          01065133
262807* DATAWHSE-MARKUP-FILE                                            01065233
262807* HOLD-DATAWHSE-MARKDOWN-FILE                                     01065333
262807* HOLD-DATAWHSE-MARKUP-FILE                                       01065433
262807******************************************************************01065533
SEPHOR*   03/16/2022 - JIM HUNTER  SEPHORA GIFT CARDS  CHG0??????       01065634
SEPHOR* THIS CHANGE PREVENTS SEPHORA GIFT CARDS FROM GOING TO THE       01065734
SEPHOR* MU / MD REPORT OR ML OUTPUT FILES.                              01065834
SEPHOR******************************************************************01065934
007400                                                                  01066031
007500 ENVIRONMENT DIVISION.                                            01066131
007600 CONFIGURATION SECTION.                                           01066231
007700                                                                  01066331
007800 SOURCE-COMPUTER.        IBM-3090.                                01066431
007900 OBJECT-COMPUTER.        IBM-3090.                                01066531
008000                                                                  01066631
008100 INPUT-OUTPUT SECTION.                                            01066731
008200 FILE-CONTROL.                                                    01066831
008300                                                                  01066931
008400     SELECT POS-DATE-FILE                                         01067031
008500         ASSIGN TO INP01.                                         01067131
008600                                                                  01067231
008700     SELECT LEDGER-MARKDOWN-FILE                                  01067331
008800         ASSIGN TO OUT01.                                         01067431
008900                                                                  01067531
009000     SELECT LEDGER-MARKUP-FILE                                    01067631
009100         ASSIGN TO OUT02.                                         01068000
009200                                                                  01069000
009900     SELECT HOLD-LEDGER-MARKDOWN-FILE                             01130000
010000         ASSIGN TO OUT05.                                         01140000
010100                                                                  01150000
010200     SELECT HOLD-LEDGER-MARKUP-FILE                               01160000
010300         ASSIGN TO OUT06.                                         01170000
010400                                                                  01180000
011100     SELECT DATAWHSE-FILE                                         01250000
011200         ASSIGN TO OUT09.                                         01260000
011300                                                                  01270000
011400     SELECT MERCH-LEDGER-REPORT                                   01280000
011500         ASSIGN TO RPT01.                                         01290000
011600                                                                  01300000
011700 DATA DIVISION.                                                   01310000
011800 FILE SECTION.                                                    01320000
011900                                                                  01330000
012000 FD POS-DATE-FILE                                                 01340000
012100     RECORDING MODE IS F                                          01350000
012200     LABEL RECORDS ARE STANDARD                                   01360000
012300     RECORD CONTAINS 80 CHARACTERS                                01370000
012400     BLOCK CONTAINS 0 RECORDS                                     01380000
012500     DATA RECORD IS POS-DATE-RECORD.                              01390000
012600                                                                  01400000
012700 01 POS-DATE-RECORD              PIC  X(80).                      01410000
012800                                                                  01420000
012900 FD  LEDGER-MARKDOWN-FILE                                         01430000
013000     RECORDING MODE IS F                                          01440000
013100     LABEL RECORDS ARE STANDARD                                   01450000
013200     BLOCK CONTAINS 0 RECORDS                                     01460000
013300     RECORD CONTAINS 200 CHARACTERS                               01470000
013400     DATA RECORD IS LM-LEDGER-MARKDOWN-RECORD.                    01480000
013500                                                                  01490000
013600 01  LM-LEDGER-MARKDOWN-RECORD   PIC  X(200).                     01500000
013700                                                                  01510000
013800 FD  LEDGER-MARKUP-FILE                                           01520000
013900     RECORDING MODE IS F                                          01530000
014000     LABEL RECORDS ARE STANDARD                                   01540000
014100     BLOCK CONTAINS 0 RECORDS                                     01550000
014200     RECORD CONTAINS 200 CHARACTERS                               01560000
014300     DATA RECORD IS LM-LEDGER-MARKUP-RECORD.                      01570000
014400                                                                  01580000
014500 01  LM-LEDGER-MARKUP-RECORD     PIC  X(200).                     01590000
014600                                                                  01600000
016500 FD  HOLD-LEDGER-MARKDOWN-FILE                                    01790000
016600     RECORDING MODE IS F                                          01800000
016700     LABEL RECORDS ARE STANDARD                                   01810000
016800     BLOCK CONTAINS 0 RECORDS                                     01820000
016900     RECORD CONTAINS 200 CHARACTERS                               01830000
017000     DATA RECORD IS HOLD-LEDGER-MARKDOWN-RECORD.                  01840000
017100                                                                  01850000
017200 01  HOLD-LEDGER-MARKDOWN-RECORD PIC  X(200).                     01860000
017300                                                                  01870000
017400 FD  HOLD-LEDGER-MARKUP-FILE                                      01880000
017500     RECORDING MODE IS F                                          01890000
017600     LABEL RECORDS ARE STANDARD                                   01900000
017700     BLOCK CONTAINS 0 RECORDS                                     01910000
017800     RECORD CONTAINS 200 CHARACTERS                               01920000
017900     DATA RECORD IS HOLD-LEDGER-MARKUP-RECORD.                    01930000
018000                                                                  01940000
018100 01  HOLD-LEDGER-MARKUP-RECORD     PIC  X(200).                   01950000
018200                                                                  01960000
020100 FD  DATAWHSE-FILE                                                02150000
020200     RECORDING MODE IS F                                          02160000
020300     LABEL RECORDS ARE STANDARD                                   02170000
020400     BLOCK CONTAINS 0 RECORDS                                     02180000
020500     RECORD CONTAINS 200 CHARACTERS                               02190000
020600     DATA RECORD IS DATAWHSE-RECORD.                              02200000
020700                                                                  02210000
020800 01  DATAWHSE-RECORD             PIC  X(200).                     02220000
020900                                                                  02230000
021000 FD  MERCH-LEDGER-REPORT                                          02240000
021100     RECORDING MODE IS F                                          02250000
021200     LABEL RECORDS ARE STANDARD                                   02260000
021300     BLOCK CONTAINS 0 RECORDS                                     02270000
021400     RECORD CONTAINS 132 CHARACTERS.                              02280000
021500                                                                  02290000
021600 01  REPORT-LINE-OUT             PIC  X(132).                     02300000
021700                                                                  02310000
021800 WORKING-STORAGE SECTION.                                         02320000
021900                                                                  02330000
022000*  PARAMETER LIST FOR THE CALENDAR ROUTINE                        02340000
022100                                                                  02350000
022200     COPY DPWS500.                                                02360000
022300                                                                  02370000
022400*  REPORT HEADER FOR A 132 COLUMN REPORT                          02380000
022500                                                                  02390000
022600     COPY DPWS132O.                                               02400000
022700                                                                  02410000
022800*  MERCHANDISE LEDGER PRICE CHANGE RECORD LAYOUT                  02420000
022900                                                                  02430000
023000     COPY MLRD017.                                                02440000
023100                                                                  02450000
023200* MERCHANDISE LEDGER PRICE CHANGE RECORD LAYOUT FOR DATA WAREHOUSE02460000
023300                                                                  02470000
023400     COPY MLRD044.                                                02480000
023500                                                                  02490000
023600 01  AC-ABEND-CODE               PIC S9(04) VALUE ZEROS.          02500000
023700     88  AC-CONTROL-CARD-ERROR              VALUE +4009.          02510000
023800     88  AC-CALENDAR-ERROR                  VALUE +4010.          02520000
023900     88  AC-DB2-ERROR                       VALUE +4013.          02530000
024000                                                                  02540000
024100 01  PV-SUBSCRIPTS.                                               02550000
024200     05  PV-TOT-SUB              PIC S9(04) VALUE ZERO.           02560000
024300                                                                  02570000
024400 01  PV-NULL-INDICATORS.                                          02580000
024500     05 PV-ORIG-OWND-UNT-AMT-NULL-IND PIC S9(4) COMP VALUE +0.    02590000
BOSSCL     05 PV-OMNI-CHNL-TYP-CDE-NULL-IND PIC S9(4) COMP VALUE +0.    02600000
024600                                                                  02610000
024700 01  PS-PROGRAM-SWITCHES.                                         02620000
024800     05  PS-END-OF-TRAN-IND      PIC  X(01) VALUE 'N'.            02630000
024900         88  PS-END-OF-TRAN-YES             VALUE 'Y'.            02640000
025000     05  PS-END-OF-DKEY-IND      PIC  X(01) VALUE 'N'.            02650000
025100         88  PS-END-OF-DKEY-YES             VALUE 'Y'.            02660000
025200     05  PS-END-OF-ITEM-IND      PIC  X(01) VALUE 'N'.            02670000
025300         88  PS-END-OF-ITEM-YES             VALUE 'Y'.            02680000
025400         88  PS-END-OF-ITEM-NO              VALUE 'N'.            02690000
025500     05  PS-END-OF-LID-IND       PIC  X(01) VALUE 'N'.            02700000
025600         88  PS-END-OF-LID-YES              VALUE 'Y'.            02710000
025700         88  PS-END-OF-LID-NO               VALUE 'N'.            02720000
025800     05  PS-TIERED-ITEM-IND      PIC  X(01) VALUE 'N'.            02730000
025900         88  PS-TIERED-ITEM-YES             VALUE 'Y'.            02740000
026000         88  PS-TIERED-ITEM-NO              VALUE 'N'.            02750000
026100     05  PS-END-OF-CARD-FILE-SW  PIC  X(01) VALUE 'N'.            02760000
026200         88  PS-END-OF-CARD-FILE            VALUE 'Y'.            02770000
026300                                                                  02780000
026400     05  PS-FIRST-READ-SW        PIC  X(01) VALUE 'N'.            02790000
026500         88  PS-FIRST-READ-YES              VALUE 'Y'.            02800000
026600         88  PS-FIRST-READ-NO               VALUE 'N'.            02810000
026700     05  PS-UNMTCHD-AMT-SW       PIC  X(01) VALUE 'N'.            02820000
026800         88  PS-UNMTCHD-AMT-YES             VALUE 'Y'.            02830000
026900         88  PS-UNMTCHD-AMT-NO              VALUE 'N'.            02840000
BOSSC2     05  PS-ECOM-PRICE-CHG-SW    PIC  X(01) VALUE 'N'.            02841013
BOSSC2         88  PS-ECOM-PRICE-CHANGE-YES       VALUE 'Y'.            02842013
BOSSC2         88  PS-ECOM-PRICE-CHANGE-NO        VALUE 'N'.            02843013
BOSSC2     05  PS-ECOM-PRICE-FOUND-SW PIC   X(01) VALUE 'N'.            02844013
BOSSC2         88  PS-ECOM-PRICE-FOUND            VALUE 'Y'.            02845013
BOSSC2         88  PS-ECOM-PRICE-NOT-FOUND        VALUE 'N'.            02846013
027000                                                                  02850000
027100                                                                  02860000
027200 01  PC-PROGRAM-CONSTANTS.                                        02870000
027300     05  PC-CURRENT-PROGRAM-NAME PIC  X(08) VALUE 'SAKUT023'.     02880000
027400     05  PC-YES                  PIC  X(01) VALUE 'Y'.            02890000
027500     05  PC-11                   PIC  9(02) VALUE 11.             02900000
027600     05  PC-ONE                  PIC  9(01) VALUE 1.              02910000
027700     05  PC-LINE-LIMIT           PIC  9(02) VALUE 60.             02920000
027800     05  PC-ROW-NOT-FOUND        PIC S9(03) VALUE +100.           02930000
011618     05  PC-POC                  PIC S9(04) VALUE  200.           02940000
027900     05  PC-NON-OWNED            PIC  X(01) VALUE 'N'.            02950000
028000     05  PC-NON-OWNED-TRACKED    PIC  X(01) VALUE 'T'.            02960000
028100     05  PC-GOLDSTAR-G           PIC  X(01) VALUE 'G'.            02970000
214615     05  PC-REGULAR-R            PIC  X(01) VALUE 'R'.            02980000
214615     05  PC-PROMO-P              PIC  X(01) VALUE 'P'.            02990000
214615     05  PC-CLEARANCE-C          PIC  X(01) VALUE 'C'.            03000000
214615     05  PC-UNKNOWN-N            PIC  X(01) VALUE 'N'.            03010000
028200     05  PC-RSLV-ORIGINAL        PIC  X(01) VALUE 'R'.            03020000
028300     05  PC-REVERSAL             PIC  X(01) VALUE 'R'.            03030000
028400     05  PC-RSLV-VOID            PIC  X(01) VALUE 'V'.            03040000
028500     05  PC-LATE                 PIC  X(01) VALUE 'L'.            03050000
028600     05  PC-CORRECTION           PIC  X(01) VALUE 'V'.            03060000
262807     05  PC-SEPHORA-720          PIC  X(03) VALUE '720'.          03070033
028700     05  PC-SENIOR-CIT-728       PIC  X(03) VALUE '728'.          03071025
028800     05  PC-KOHLS-CPON-733       PIC  X(03) VALUE '733'.          03080000
028900     05  PC-TRAN-LEVEL-734       PIC  X(03) VALUE '734'.          03090000
029000     05  PC-GOLDSTAR-753         PIC  X(03) VALUE '753'.          03100000
029100     05  PC-760-OFFER-COUPON     PIC  X(03) VALUE '760'.          03110000
029200     05  PC-761-OFFER-TLD-TIERED PIC  X(03) VALUE '761'.          03120000
029300     05  PC-762-OFFER-LID-TIERED PIC  X(03) VALUE '762'.          03130000
029400     05  PC-763-OFFER-GWP-PWP-PRORATED PIC  X(03) VALUE '763'.    03140000
029500     05  PC-ADDTL-PROMO-OFF-774  PIC  X(03) VALUE '774'.          03150000
029600     05  PC-BOGO-775             PIC  X(03) VALUE '775'.          03160000
029700     05  PC-BOGO-777             PIC  X(03) VALUE '777'.          03170000
029800     05  PC-UNEARNED-REWARDS-780 PIC  X(03) VALUE '780'.          03180000
029900     05  PC-OWN-RTN-ADJ-792      PIC  X(03) VALUE '792'.          03190000
030000     05  PC-OWN-ADJ-796          PIC  X(03) VALUE '796'.          03200000
030100     05  PC-GIFT-CARD            PIC  X(03) VALUE '983'.          03210000
SEPHOR     05  PC-SEPHORA-GIFT-CARD-712 PIC X(03) VALUE '712'.          03211034
030200     05  PC-THIRD-PARTY-CARD-833 PIC  X(03) VALUE '833'.          03220000
030300     05  PC-THIRD-PARTY-CARD-834 PIC  X(03) VALUE '834'.          03230000
MKTPLC     05  PC-MKTPLACE-DEPT-985    PIC  X(03) VALUE '985'.          03240000
030400     05  PC-701-SIGNING-ERROR    PIC  X(03) VALUE '701'.          03250000
030500     05  PC-702-PLU-ERROR        PIC  X(03) VALUE '702'.          03260000
030600     05  PC-703-DAMAGED-MDSE     PIC  X(03) VALUE '703'.          03270000
030700     05  PC-704-KEYED-GWP        PIC  X(03) VALUE '704'.          03280000
030800     05  PC-705-INVALID-UPC-MKDN PIC  X(03) VALUE '705'.          03290000
030900     05  PC-706-RAINCHECK        PIC  X(03) VALUE '706'.          03300000
031000     05  PC-707-MEET-COMPETITION PIC  X(03) VALUE '707'.          03310000
031100     05  PC-708-SPECIAL-PRMTN    PIC  X(03) VALUE '708'.          03320000
031200     05  PC-709-YES-WE-CAN       PIC  X(03) VALUE '709'.          03330000
205464     05  PC-710-NON-RCPT-RTRN    PIC  X(03) VALUE '710'.          03340000
031300     05  PC-746-PLU-TIER         PIC  X(03) VALUE '746'.          03350000
031400     05  PC-790-EMPLY-DISCOUNT   PIC  X(03) VALUE '790'.          03360000
031500     05  PC-765-GFT-RCPT-RTRN    PIC  X(03) VALUE '765'.          03370000
031600     05  PC-NULL                 PIC S9(4) COMP VALUE -1.         03380000
031700                                                                  03390000
031800**>> DETAIL LINE CONSTANTS FOR REPORT                             03400000
031900     05  PC-PROMOTIONAL          PIC X(14) VALUE 'PROMOTIONAL   '.03410000
032000     05  PC-TIERED               PIC X(14) VALUE 'ADDTL PROMOTNS'.03420000
032100     05  PC-GOLDSTAR             PIC X(14) VALUE 'GOLDSTAR      '.03430000
032200     05  PC-MANUAL-LID           PIC X(14) VALUE 'MANUAL LID    '.03440000
032300     05  PC-OWNERSHIP-ADJ        PIC X(14) VALUE 'OWNERSHIP ADJ '.03450000
032400     05  PC-OWN-RETRN-ADJ        PIC X(14) VALUE 'OWN RETURN ADJ'.03460000
032500     05  PC-SENIOR-CITIZEN       PIC X(14) VALUE 'SENIOR CITIZEN'.03470000
032600     05  PC-KOHLS-COUPON         PIC X(14) VALUE 'KOHLS COUPON  '.03480000
032700     05  PC-OFFER-COUPON         PIC X(14) VALUE 'OFFER COUPON  '.03490000
032800     05  PC-OFFER-TLD-TIERED     PIC X(14) VALUE 'OFFER TLD TIER'.03500000
032900     05  PC-OFFER-LID-TIERED     PIC X(14) VALUE 'OFFER LID TIER'.03510000
033000     05  PC-OFFER-GWP-PWP        PIC X(14) VALUE 'OFFER GWP/PWP '.03520000
205464     05  PC-NON-REC-RETURN       PIC X(14) VALUE 'NON RCPT RTRN '.03530000
033100     05  PC-GIFT-RCPT-RETURN     PIC X(14) VALUE 'GIFT RCPT RTRN'.03540000
033200     05  PC-BOGO                 PIC X(14) VALUE 'EBOGO         '.03550000
033300     05  PC-UNEARNED-REWARDS     PIC X(14) VALUE 'UNEARNED RWDS'. 03560000
033400     05  PC-EMPLY-DISCOUNT       PIC X(14) VALUE 'EMPLY DISCOUNT'.03570000
262807     05  PC-SEPHORA-DISCOUNT     PIC X(14) VALUE 'SEPHORA DISCNT'.03571033
033500     05  PC-TOTAL                PIC X(14) VALUE 'TOTAL         '.03580000
033600                                                                  03590000
033700 01  PV-RUN-DATE-CCYY-MM-DD      PIC  X(10).                      03600000
033800                                                                  03610000
033900 01  PV-CUT-OFF-CCYY-MM-DD       PIC  X(10).                      03620000
034000                                                                  03630000
BOSSC2 01  PV-TRANSFER-DATE            PIC  X(10)   VALUE SPACES.       03631013
032800                                                                  03632013
034100 01  PV-PROGRAM-VARIABLES.                                        03640000
034200     05  PV-LID-SEQ-NBR          PIC S9(04) COMP VALUE ZERO.      03650000
034300     05  PV-TOTAL-MKDN-AMT       PIC  9(9)V9(2) VALUE ZEROS.      03660000
034400     05  PV-TOTAL-MKDNCAN-AMT    PIC  9(9)V9(2) VALUE ZEROS.      03670000
034500     05  PV-SPACE-CONTROL        PIC  9(02) VALUE 1.              03680000
226892     05  PV-DIFF                 PIC S9(5)V99 VALUE ZEROES.       03690000
034600     05  PV-PARAGRAPH-NAME       PIC  X(30) VALUE SPACES.         03700000
034700     05  PV-OPERATION-MSG-1      PIC  X(40) VALUE SPACES.         03710000
034800     05  PV-OPERATION-MSG-2      PIC  X(40) VALUE SPACES.         03720000
034900     05  PV-FISC-PERIOD-NBR-HOLD PIC  9(02) VALUE 0.              03730000
035000     05  PV-PAGE-COUNT           PIC  9(02) VALUE 1.              03740000
035100     05  PV-LINE-COUNT           PIC  9(02) VALUE ZERO.           03750000
035200     05  PV-POS-DATE-CYMD        PIC  9(08) VALUE ZEROS.          03760000
035300     05  PV-PRICE-CHANGE-AMOUNT  PIC S9(7)V99 VALUE ZERO.         03770000
035400     05  PV-CUST-CHRGD-AMT       PIC  9(07)V9(02) VALUE ZERO.     03780000
035500     05  PV-EXTENDED-AMT         PIC S9(07)V9(02) VALUE ZERO.     03790000
035600     05  PV-NET-CHRGD-AMT        PIC  9(07)V9(02) VALUE ZERO.     03800000
035700     05  PV-EXCLUDE-LID-AMT      PIC  9(07)V9(02) VALUE ZERO.     03810000
040220     05  PV-NEW-PR-AMT           PIC S9(07)V9(02) VALUE ZERO.     03820000
035800     05  PV-LID-AMT              PIC  9(07)V9(02) VALUE ZERO.     03830000
035900     05  PV-NET-CHRGD-AMT-TMP    PIC  9(07)V9(02) VALUE ZERO.     03840000
BOSSCL     05  PV-OMNI-CHNL-FFLMT-TYP-CDE  PIC X(3)     VALUE SPACES.   03850000
036000                                                                  03860000
BOSSCL     05  PV-PRICE-CHG-STRT-DATE  PIC  X(10)       VALUE SPACES.   03860101
BOSSCL     05  PV-PRICE-CHG-END-DATE   PIC  X(10)       VALUE SPACES.   03860201
BOSSCL     05  PV-NEW-OMNI-PRICE       PIC S9(7)V9(2)   VALUE ZERO.     03860301
BOSSCL     05  PV-OLD-OMNI-PRICE       PIC S9(7)V9(2)   VALUE ZERO.     03860401
BOSSC3     05  PV-EPORD-ORD-NBR        PIC X(20)        VALUE SPACES.   03860523
036100                                                                  03870000
BOSSCL     05  PV-OWND-UNT-RTL-ORIG-AMT PIC S9(7)V9(2)      VALUE ZERO. 03880000
036200     05  PV-PC-OLD-PR-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03890000
036300     05  PV-PC-NEW-PR-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03900000
036400     05  PV-PC-DIFFER-AMT         PIC S9(7)V9(2)      VALUE ZERO. 03910000
BOSSCL     05  PV-DISPLAY-AMT           PIC ---,--9.99      VALUE ZERO. 03911005
036500                                                                  03920000
036600     05  PV-ITM-CUST-CHRGD-AMT  PIC  9(7)V9(2)        VALUE ZERO. 03930000
036700     05  PV-ITM-REG-RTL-AMT     PIC  9(5)V9(2)        VALUE ZERO. 03940000
036800                                                                  03950000
036900     05  PV-ISO-DB2-DATE.                                         03960000
037000         10  PV-ISO-DB2-CC       PIC  X(02).                      03970000
037100         10  PV-ISO-DB2-YY       PIC  X(02).                      03980000
037200         10  FILLER              PIC  X(01).                      03990000
037300         10  PV-ISO-DB2-MM       PIC  X(02).                      04000000
037400         10  FILLER              PIC  X(01).                      04010000
037500         10  PV-ISO-DB2-DD       PIC  X(02).                      04020000
037600                                                                  04030000
037700     05  PV-CURRENT-TIME.                                         04040000
037800         10  PV-CURRENT-HOUR     PIC  9(02) VALUE ZERO.           04050000
037900         10  PV-CURRENT-MINUTE   PIC  9(02) VALUE ZERO.           04060000
038000         10  FILLER              PIC  9(04) VALUE ZERO.           04070000
038100                                                                  04080000
038200     05  PV-CURRENT-DATE.                                         04090000
038300         10  PV-CURRENT-YEAR     PIC  9(02) VALUE ZERO.           04100000
038400         10  PV-CURRENT-MONTH    PIC  9(02) VALUE ZERO.           04110000
038500         10  PV-CURRENT-DAY      PIC  9(02) VALUE ZERO.           04120000
038600                                                                  04130000
BOSSCL     05  PV-TIMESTAMP                     PIC X(26) VALUE SPACES. 04131001
BOSSCL     05  PV-TIMESTAMP-DB2.                                        04132001
BOSSCL         10  PV-TS-DATE.                                          04133001
BOSSCL             15  PV-TS-CENTURY            PIC  X(02) VALUE ZERO.  04134001
BOSSCL             15  PV-TS-YEAR               PIC  9(02) VALUE ZERO.  04135001
BOSSCL             15  FILLER                   PIC  X(01) VALUE '-'.   04136001
BOSSCL             15  PV-TS-MONTH              PIC  9(02) VALUE ZERO.  04137001
BOSSCL             15  FILLER                   PIC  X(01) VALUE '-'.   04138001
BOSSCL             15  PV-TS-DAY                PIC  9(02) VALUE ZERO.  04139001
BOSSCL         10  FILLER                       PIC  X(01) VALUE '-'.   04139101
BOSSCL         10  PV-TS-HOUR                   PIC  9(02) VALUE 02.    04139201
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   04139301
BOSSCL         10  PV-TS-MINUTE                 PIC  9(02) VALUE ZERO.  04139401
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   04139501
BOSSCL         10  PV-TS-SECONDS                PIC  9(02) VALUE ZERO.  04139601
BOSSCL         10  FILLER                       PIC  X(01) VALUE '.'.   04139701
BOSSCL         10  PV-TS-MILLISEC               PIC  9(06) VALUE ZERO.  04139801
038000                                                                  04139901
BOSSCL     05  PV-STR-NBR-DB2          PIC  S9(4) COMP  VALUE ZERO.     04140001
038000                                                                  04140101
038700     05  PV-RFMT-STR-NBR.                                         04141000
038800         10  FILLER              PIC  9 VALUE ZERO.               04150000
038900         10  PV-STR-NBR-4        PIC  9(04).                      04160000
039000                                                                  04170000
039100                                                                  04180000
039200     05  PV-SKU-NBR              PIC  9(08) VALUE ZERO.           04190000
039300                                                                  04200000
039400     05  PV-SKU-NBR-RDFN         REDEFINES PV-SKU-NBR.            04210000
039500         10  FILLER              PIC  9(05).                      04220000
039600         10  PV-SKU-LST-3-DGT    PIC  9(03).                      04230000
039700                                                                  04240000
039800     05  PV-DB2-KEY-FIELDS.                                       04250000
039900         10  PV-PARTN-NBR        PIC S9(04) COMP SYNC             04260000
040000                                            VALUE ZERO.           04270000
040100         10  PV-STR-NBR          PIC S9(04) COMP SYNC             04280000
040200                                            VALUE ZERO.           04290000
040300         10  PV-RGST-ID          PIC S9(04) COMP SYNC             04300000
040400                                            VALUE ZERO.           04310000
040500         10  PV-TRN-NBR          PIC S9(04) COMP SYNC             04320000
040600                                            VALUE ZERO.           04330000
040700         10  PV-STRT-TM          PIC  X(08) VALUE SPACE.          04340000
040800         10  PV-SLS-CORR-SEQ-NBR PIC S9(04) COMP SYNC             04350000
040900                                            VALUE ZERO.           04360000
041000         10  PV-LNE-ITM-SEQ-NBR  PIC S9(04) COMP SYNC             04370000
041100                                            VALUE ZERO.           04380000
041200                                                                  04390000
041300 01  DH-DISPLAY-HEADER.                                           04400000
041400     05  FILLER                  PIC  X(18) VALUE                 04410000
041500         'PRICE CHG TYPE'.                                        04420000
041600     05  FILLER                  PIC  X(15) VALUE                 04430000
041700         'MKDN QTY'.                                              04440000
041800     05  FILLER                  PIC  X(14) VALUE                 04450000
041900         'MKDN AMT'.                                              04460000
042000     05  FILLER                  PIC  X(15) VALUE                 04470000
042100         'MDC QTY'.                                               04480000
042200     05  FILLER                  PIC  X(10) VALUE                 04490000
042300         'MDC AMT'.                                               04500000
042400     05  FILLER                  PIC  X(13) VALUE                 04510000
042500         'MKUP QTY'.                                              04520000
042600     05  FILLER                  PIC  X(12) VALUE                 04530000
042700         'MKUP AMT'.                                              04540000
042800     05  FILLER                  PIC  X(13) VALUE                 04550000
042900         'MUC QTY'.                                               04560000
043000     05  FILLER                  PIC  X(08) VALUE                 04570000
043100         'MUC AMT'.                                               04580000
043200                                                                  04590000
043300 01  HL-HEADER-LINE1.                                             04600000
043400     05  FILLER                  PIC  X(39) VALUE SPACES.         04610000
043500     05                          PIC  X(55) VALUE                 04620000
043600        'MERCHANDISE LEDGER MARKDOWN/MARKUP TRANSACTION CREATION'.04630000
043700     05  FILLER                  PIC  X(38) VALUE SPACES.         04640000
043800                                                                  04650000
043900 01  HL-HEADER-LINE1-1.                                           04660000
044000     05  FILLER                  PIC  X(59) VALUE SPACES.         04670000
044100     05                          PIC  X(04) VALUE                 04680000
044200         'FOR '.                                                  04690000
044300     05  HL-REPORT-MONTH         PIC  X(02) VALUE SPACES.         04700000
044400     05  FILLER                  PIC  X(01) VALUE '/'.            04710000
044500     05  HL-REPORT-DAY           PIC  X(02) VALUE SPACES.         04720000
044600     05  FILLER                  PIC  X(01) VALUE '/'.            04730000
044700     05  HL-REPORT-YEAR          PIC  X(02) VALUE SPACES.         04740000
044800     05  FILLER                  PIC  X(59) VALUE SPACES.         04750000
044900                                                                  04760000
045000 01  HL-HEADER-LINE2.                                             04770000
045100     05  FILLER                  PIC  X(04) VALUE SPACES.         04780000
045200     05  FILLER                  PIC  X(14) VALUE                 04790000
045300         'PRICE CHG TYPE'.                                        04800000
045400     05  FILLER                  PIC  X(02) VALUE SPACES.         04810000
045500     05  FILLER                  PIC  X(11) VALUE                 04820000
045600         'MKDN QTY'.                                              04830000
045700     05  FILLER                  PIC  X(02) VALUE SPACES.         04840000
045800     05  FILLER                  PIC  X(15) VALUE                 04850000
045900         'MKDN AMT'.                                              04860000
046000     05  FILLER                  PIC  X(02) VALUE SPACES.         04870000
046100     05  FILLER                  PIC  X(11) VALUE                 04880000
046200         'MDC QTY'.                                               04890000
046300     05  FILLER                  PIC  X(02) VALUE SPACES.         04900000
046400     05  FILLER                  PIC  X(15) VALUE                 04910000
046500         'MDC AMT'.                                               04920000
046600     05  FILLER                  PIC  X(02) VALUE SPACES.         04930000
046700     05  FILLER                  PIC  X(09) VALUE                 04940000
046800         'MKUP QTY'.                                              04950000
046900     05  FILLER                  PIC  X(02) VALUE SPACES.         04960000
047000     05  FILLER                  PIC  X(13) VALUE                 04970000
047100         'MKUP AMT'.                                              04980000
047200     05  FILLER                  PIC  X(02) VALUE SPACES.         04990000
047300     05  FILLER                  PIC  X(09) VALUE                 05000000
047400         'MUC QTY'.                                               05010000
047500     05  FILLER                  PIC  X(02) VALUE SPACES.         05020000
047600     05  FILLER                  PIC  X(13) VALUE                 05030000
047700         'MUC AMT'.                                               05040000
047800     05  FILLER                  PIC  X(04) VALUE SPACES.         05050000
047900                                                                  05060000
048000 01  HL-HEADER-LINE3.                                             05070000
048100     05  FILLER                  PIC  X(04) VALUE SPACES.         05080000
048200     05  FILLER                  PIC  X(14) VALUE ALL '-'.        05090000
048300     05  FILLER                  PIC  X(02) VALUE SPACES.         05100000
048400     05  FILLER                  PIC  X(11) VALUE ALL '-'.        05110000
048500     05  FILLER                  PIC  X(02) VALUE SPACES.         05120000
048600     05  FILLER                  PIC  X(15) VALUE ALL '-'.        05130000
048700     05  FILLER                  PIC  X(02) VALUE SPACES.         05140000
048800     05  FILLER                  PIC  X(11) VALUE ALL '-'.        05150000
048900     05  FILLER                  PIC  X(02) VALUE SPACES.         05160000
049000     05  FILLER                  PIC  X(15) VALUE ALL '-'.        05170000
049100     05  FILLER                  PIC  X(02) VALUE SPACES.         05180000
049200     05  FILLER                  PIC  X(09) VALUE ALL '-'.        05190000
049300     05  FILLER                  PIC  X(02) VALUE SPACES.         05200000
049400     05  FILLER                  PIC  X(13) VALUE ALL '-'.        05210000
049500     05  FILLER                  PIC  X(02) VALUE SPACES.         05220000
049600     05  FILLER                  PIC  X(09) VALUE ALL '-'.        05230000
049700     05  FILLER                  PIC  X(02) VALUE SPACES.         05240000
049800     05  FILLER                  PIC  X(13) VALUE ALL '-'.        05250000
049900     05  FILLER                  PIC  X(04) VALUE SPACES.         05260000
050000                                                                  05270000
050100 01  HL-HEADER-LINE4.                                             05280000
050200     05  FILLER                  PIC  X(53) VALUE SPACES.         05290000
050300     05  FILLER                  PIC  X(26) VALUE SPACES.         05300000
050400         88  HD-ORIGINAL-SALES              VALUE                 05310000
050500             '    ORIGINAL POS SALES    '.                        05320000
050600         88  HD-SALES-CORR                  VALUE                 05330000
050700             '    SALES CORRECTIONS     '.                        05340000
050800         88  HD-LATE-TRANSACTIONS           VALUE                 05350000
050900             '    LATE TRANSACTIONS     '.                        05360000
051000         88  HD-CUTOFF-SALES-CORR           VALUE                 05370000
051100             ' CUTOFF SALES CORRECTIONS '.                        05380000
051200         88  HD-CUTOFF-LATE-TRANSACTIONS    VALUE                 05390000
051300             ' CUTOFF LATE TRANSACTIONS '.                        05400000
051400     05  FILLER                  PIC  X(53) VALUE SPACES.         05410000
051500                                                                  05420000
051600 01  DD-DISPLAY-DETAIL.                                           05430000
051700     05  DD-PRICE-CHANGE-TYPE    PIC  X(14) VALUE SPACES.         05440000
051800         88  DD-PC-PROMOTIONAL              VALUE                 05450000
051900             'PROMOTIONAL   '.                                    05460000
052000         88  DD-PC-TIERED                   VALUE                 05470000
052100             'ADDTL PROMOTNS'.                                    05480000
052200         88  DD-PC-GOLDSTAR                 VALUE                 05490000
052300             'GOLDSTAR      '.                                    05500000
052400         88  DD-PC-MANUAL-LID               VALUE                 05510000
052500             'MANUAL LID    '.                                    05520000
052600         88  DD-PC-OWNERSHIP-ADJUSTMENT     VALUE                 05530000
052700             'OWNERSHIP ADJ '.                                    05540000
052800         88  DD-PC-OWN-RETRN-ADJUSTMENT     VALUE                 05550000
052900             'OWN.RETURN ADJ'.                                    05560000
053000         88  DD-PC-SENIOR-CITIZEN           VALUE                 05570000
053100             'SENIOR CITIZEN'.                                    05580000
053200         88  DD-PC-KOHLS-COUPON             VALUE                 05590000
053300             'KOHLS COUPON  '.                                    05600000
053400         88  DD-PC-OFFER-COUPON             VALUE                 05610000
053500             'OFFER COUPON  '.                                    05620000
053600         88  DD-PC-OFFER-TLD-TIERED         VALUE                 05630000
053700             'OFFER TLD TIER'.                                    05640000
053800         88  DD-PC-OFFER-LID-TIERED         VALUE                 05650000
053900             'OFFER LID TIER'.                                    05660000
054000         88  DD-PC-OFFER-GWP-PWP            VALUE                 05670000
054100             'OFFER GWP/PWP '.                                    05680000
054200         88  DD-PC-GFT-RCPT-RTRN            VALUE                 05690000
054300             'GIFT RCPT RTRN'.                                    05700000
205464         88  DD-NON-RCPT-RTRN               VALUE                 05710000
205464             'NON RCPT RTRN '.                                    05720000
054400         88  DD-PC-BOGO                     VALUE                 05730000
054500             'EBOGO         '.                                    05740000
054600         88  DD-PC-UNEARNED-REWARDS         VALUE                 05750000
054700             'UNEARNED RWDS '.                                    05760000
054800         88  DD-PC-EMPLY-DISCOUNT           VALUE                 05770000
054900             'EMPLY DISCOUNT'.                                    05780000
262807         88  DD-PC-SEPHORA-DISCOUNT         VALUE                 05781033
262807             'SEPHORA DISCNT'.                                    05782033
055000         88  DD-PC-TOTAL                    VALUE                 05790000
055100             'TOTAL         '.                                    05800000
055200                                                                  05810000
055300     05  FILLER                  PIC  X(01) VALUE SPACES.         05820000
055400     05  DD-MARKDOWN-QTY         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05830000
055500     05  FILLER                  PIC  X(01) VALUE SPACES.         05840000
055600     05  DD-MARKDOWN-AMT         PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05850000
055700     05  FILLER                  PIC  X(01) VALUE SPACES.         05860000
055800     05  DD-MARKDOWN-CANCEL-QTY  PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      05870000
055900     05  FILLER                  PIC  X(01) VALUE SPACES.         05880000
056000     05  DD-MARKDOWN-CANCEL-AMT  PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  05890000
056100     05  FILLER                  PIC  X(01) VALUE SPACES.         05900000
056200     05  DD-MARKUP-QTY           PIC Z,ZZZ,ZZ9 VALUE ZERO.        05910000
056300     05  FILLER                  PIC  X(01) VALUE SPACES.         05920000
056400     05  DD-MARKUP-AMT           PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05930000
056500     05  FILLER                  PIC  X(01) VALUE SPACES.         05940000
056600     05  DD-MARKUP-CANCEL-QTY    PIC Z,ZZZ,ZZ9 VALUE ZERO.        05950000
056700     05  FILLER                  PIC  X(01) VALUE SPACES.         05960000
056800     05  DD-MARKUP-CANCEL-AMT    PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    05970000
056900                                                                  05980000
057000 01  DL-DETAIL-LINE.                                              05990000
057100     05  FILLER                  PIC  X(04) VALUE SPACES.         06000000
057200     05  DL-PRICE-CHANGE-TYPE    PIC  X(14) VALUE SPACES.         06010000
057300     05  FILLER                  PIC  X(02) VALUE SPACES.         06020000
057400     05  DL-MARKDOWN-QTY         PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      06030000
057500     05  FILLER                  PIC  X(02) VALUE SPACES.         06040000
057600     05  DL-MARKDOWN-AMT         PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  06050000
057700     05  FILLER                  PIC  X(02) VALUE SPACES.         06060000
057800     05  DL-MARKDOWN-CANCEL-QTY  PIC ZZZ,ZZZ,ZZ9 VALUE ZERO.      06070000
057900     05  FILLER                  PIC  X(02) VALUE SPACES.         06080000
058000     05  DL-MARKDOWN-CANCEL-AMT  PIC ZZZ,ZZZ,ZZ9.99- VALUE ZERO.  06090000
058100     05  FILLER                  PIC  X(02) VALUE SPACES.         06100000
058200     05  DL-MARKUP-QTY           PIC Z,ZZZ,ZZ9 VALUE ZERO.        06110000
058300     05  FILLER                  PIC  X(02) VALUE SPACES.         06120000
058400     05  DL-MARKUP-AMT           PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    06130000
058500     05  FILLER                  PIC  X(02) VALUE SPACES.         06140000
058600     05  DL-MARKUP-CANCEL-QTY    PIC Z,ZZZ,ZZ9 VALUE ZERO.        06150000
058700     05  FILLER                  PIC  X(02) VALUE SPACES.         06160000
058800     05  DL-MARKUP-CANCEL-AMT    PIC Z,ZZZ,ZZ9.99- VALUE ZERO.    06170000
058900     05  FILLER                  PIC  X(04) VALUE SPACES.         06180000
059000                                                                  06190000
059100 01  PT-PROGRAM-TOTALS.                                           06200000
059200     05  PT-PROGRAM-TOTAL-ELEMENT    OCCURS 5 TIMES.              06210000
059300         10  PT-PROMOTIONAL-MKDN-QTY PIC S9(09) VALUE ZERO        06220000
059400                                                COMP-3.           06230000
059500         10  PT-PROMOTIONAL-MKDN-AMT PIC S9(9)V99 VALUE ZERO      06240000
059600                                                COMP-3.           06250000
059700         10  PT-PROMOTIONAL-MDC-QTY  PIC S9(09) VALUE ZERO        06260000
059800                                                COMP-3.           06270000
059900         10  PT-PROMOTIONAL-MDC-AMT  PIC S9(9)V99 VALUE ZERO      06280000
060000                                                COMP-3.           06290000
060100         10  PT-TIERED-MKDN-QTY      PIC S9(07) VALUE ZERO        06300000
060200                                                COMP-3.           06310000
060300         10  PT-TIERED-MKDN-AMT      PIC S9(9)V99 VALUE ZERO      06320000
060400                                                COMP-3.           06330000
060500         10  PT-TIERED-MDC-QTY       PIC S9(09) VALUE ZERO        06340000
060600                                                COMP-3.           06350000
060700         10  PT-TIERED-MDC-AMT       PIC S9(9)V99 VALUE ZERO      06360000
060800                                                COMP-3.           06370000
060900         10  PT-GOLDSTAR-MKDN-QTY    PIC S9(09) VALUE ZERO        06380000
061000                                                COMP-3.           06390000
061100         10  PT-GOLDSTAR-MKDN-AMT    PIC S9(9)V99 VALUE ZERO      06400000
061200                                                COMP-3.           06410000
061300         10  PT-GOLDSTAR-MDC-QTY     PIC S9(09) VALUE ZERO        06420000
061400                                                COMP-3.           06430000
061500         10  PT-GOLDSTAR-MDC-AMT     PIC S9(9)V99 VALUE ZERO      06440000
061600                                                COMP-3.           06450000
061700         10  PT-MANUAL-LID-MKDN-QTY  PIC S9(09) VALUE ZERO        06460000
061800                                                COMP-3.           06470000
061900         10  PT-MANUAL-LID-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      06480000
062000                                                COMP-3.           06490000
062100         10  PT-MANUAL-LID-MDC-QTY   PIC S9(09) VALUE ZERO        06500000
062200                                                COMP-3.           06510000
062300         10  PT-MANUAL-LID-MDC-AMT   PIC S9(9)V99 VALUE ZERO      06520000
062400                                                COMP-3.           06530000
062500         10  PT-OWNERSHIP-ADJ-MKDN-QTY                            06540000
062600                                     PIC S9(09) VALUE ZERO        06550000
062700                                                COMP-3.           06560000
062800         10  PT-OWNERSHIP-ADJ-MKDN-AMT                            06570000
062900                                     PIC S9(9)V99 VALUE ZERO      06580000
063000                                                COMP-3.           06590000
063100         10  PT-OWNERSHIP-ADJ-MDC-QTY                             06600000
063200                                     PIC S9(09) VALUE ZERO        06610000
063300                                                COMP-3.           06620000
063400         10  PT-OWNERSHIP-ADJ-MDC-AMT                             06630000
063500                                     PIC S9(9)V99 VALUE ZERO      06640000
063600                                                COMP-3.           06650000
063700         10  PT-OWNERSHIP-ADJ-MKUP-QTY                            06660000
063800                                     PIC S9(07) VALUE ZERO        06670000
063900                                                COMP-3.           06680000
064000         10  PT-OWNERSHIP-ADJ-MKUP-AMT                            06690000
064100                                     PIC S9(7)V99 VALUE ZERO      06700000
064200                                                COMP-3.           06710000
064300         10  PT-OWNERSHIP-ADJ-MUC-QTY                             06720000
064400                                     PIC S9(07) VALUE ZERO        06730000
064500                                                COMP-3.           06740000
064600         10  PT-OWNERSHIP-ADJ-MUC-AMT                             06750000
064700                                     PIC S9(7)V99 VALUE ZERO      06760000
064800                                                COMP-3.           06770000
064900         10  PT-OWN-RETRN-ADJ-MKDN-QTY                            06780000
065000                                     PIC S9(09) VALUE ZERO        06790000
065100                                                COMP-3.           06800000
065200         10  PT-OWN-RETRN-ADJ-MKDN-AMT                            06810000
065300                                     PIC S9(9)V99 VALUE ZERO      06820000
065400                                                COMP-3.           06830000
065500         10  PT-OWN-RETRN-ADJ-MDC-QTY                             06840000
065600                                     PIC S9(09) VALUE ZERO        06850000
065700                                                COMP-3.           06860000
065800         10  PT-OWN-RETRN-ADJ-MDC-AMT                             06870000
065900                                     PIC S9(09)V99 VALUE ZERO     06880000
066000                                                COMP-3.           06890000
066100         10  PT-OWN-RETRN-ADJ-MKUP-QTY                            06900000
066200                                     PIC S9(07) VALUE ZERO        06910000
066300                                                COMP-3.           06920000
066400         10  PT-OWN-RETRN-ADJ-MKUP-AMT                            06930000
066500                                     PIC S9(7)V99 VALUE ZERO      06940000
066600                                                COMP-3.           06950000
066700         10  PT-OWN-RETRN-ADJ-MUC-QTY                             06960000
066800                                     PIC S9(07) VALUE ZERO        06970000
066900                                                COMP-3.           06980000
067000         10  PT-OWN-RETRN-ADJ-MUC-AMT                             06990000
067100                                     PIC S9(7)V99 VALUE ZERO      07000000
067200                                                COMP-3.           07010000
067300         10  PT-SENIOR-CITIZEN-MKDN-QTY                           07020000
067400                                     PIC S9(09) VALUE ZERO        07030000
067500                                                COMP-3.           07040000
067600         10  PT-SENIOR-CITIZEN-MKDN-AMT                           07050000
067700                                     PIC S9(9)V99 VALUE ZERO      07060000
067800                                                  COMP-3.         07070000
067900         10  PT-SENIOR-CITIZEN-MDC-QTY                            07080000
068000                                     PIC S9(9)    VALUE ZERO      07090000
068100                                                  COMP-3.         07100000
068200         10  PT-SENIOR-CITIZEN-MDC-AMT                            07110000
068300                                     PIC S9(9)V99 VALUE ZERO      07120000
068400                                                  COMP-3.         07130000
068500         10  PT-KOHLS-COUPON-MKDN-QTY                             07140000
068600                                     PIC S9(9)    VALUE ZERO      07150000
068700                                                  COMP-3.         07160000
068800         10  PT-KOHLS-COUPON-MKDN-AMT                             07170000
068900                                     PIC S9(9)V99 VALUE ZERO      07180000
069000                                                  COMP-3.         07190000
069100         10  PT-KOHLS-COUPON-MDC-QTY PIC S9(9)    VALUE ZERO      07200000
069200                                                  COMP-3.         07210000
069300         10  PT-KOHLS-COUPON-MDC-AMT PIC S9(9)V99 VALUE ZERO      07220000
069400                                                  COMP-3.         07230000
205464         10  PT-710-NORCPT-MKDN-QTY  PIC S9(9)    VALUE ZERO      07240000
205464                                                  COMP-3.         07250000
205464         10  PT-710-NORCPT-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      07260000
205464                                                  COMP-3.         07270000
205464         10  PT-710-NORCPT-MDC-QTY   PIC S9(9)    VALUE ZERO      07280000
205464                                                  COMP-3.         07290000
205464         10  PT-710-NORCPT-MDC-AMT   PIC S9(9)V99 VALUE ZERO      07300000
205464                                                  COMP-3.         07310000
262807         10  PT-720-SEPHORA-MKDN-QTY                              07311033
262807                                     PIC S9(9)    VALUE ZERO      07312033
262807                                                  COMP-3.         07313033
262807         10  PT-720-SEPHORA-MKDN-AMT                              07314033
262807                                     PIC S9(9)V99 VALUE ZERO      07315033
262807                                                  COMP-3.         07316033
262807         10  PT-720-SEPHORA-MDC-QTY    PIC S9(9)    VALUE ZERO    07317033
262807                                                  COMP-3.         07318033
262807         10  PT-720-SEPHORA-MDC-AMT    PIC S9(9)V99 VALUE ZERO    07319033
262807                                                  COMP-3.         07319133
069500         10  PT-760-OFFER-MKDN-QTY                                07320000
069600                                     PIC S9(9)    VALUE ZERO      07330000
069700                                                  COMP-3.         07340000
069800         10  PT-760-OFFER-MKDN-AMT                                07350000
069900                                     PIC S9(9)V99 VALUE ZERO      07360000
070000                                                  COMP-3.         07370000
070100         10  PT-760-OFFER-MDC-QTY    PIC S9(9)    VALUE ZERO      07380000
070200                                                  COMP-3.         07390000
070300         10  PT-760-OFFER-MDC-AMT    PIC S9(9)V99 VALUE ZERO      07400000
070400                                                  COMP-3.         07410000
070500         10  PT-761-TLDTIER-MKDN-QTY                              07420000
070600                                     PIC S9(9)    VALUE ZERO      07430000
070700                                                  COMP-3.         07440000
070800         10  PT-761-TLDTIER-MKDN-AMT                              07450000
070900                                     PIC S9(9)V99 VALUE ZERO      07460000
071000                                                  COMP-3.         07470000
071100         10  PT-761-TLDTIER-MDC-QTY  PIC S9(9)    VALUE ZERO      07480000
071200                                                  COMP-3.         07490000
071300         10  PT-761-TLDTIER-MDC-AMT  PIC S9(9)V99 VALUE ZERO      07500000
071400                                                  COMP-3.         07510000
071500         10  PT-762-LIDTIER-MKDN-QTY                              07520000
071600                                     PIC S9(9)    VALUE ZERO      07530000
071700                                                  COMP-3.         07540000
071800         10  PT-762-LIDTIER-MKDN-AMT                              07550000
071900                                     PIC S9(9)V99 VALUE ZERO      07560000
072000                                                  COMP-3.         07570000
072100         10  PT-762-LIDTIER-MDC-QTY  PIC S9(9)    VALUE ZERO      07580000
072200                                                  COMP-3.         07590000
072300         10  PT-762-LIDTIER-MDC-AMT  PIC S9(9)V99 VALUE ZERO      07600000
072400                                                  COMP-3.         07610000
072500         10  PT-763-GWPPWP-MKDN-QTY                               07620000
072600                                     PIC S9(9)    VALUE ZERO      07630000
072700                                                  COMP-3.         07640000
072800         10  PT-763-GWPPWP-MKDN-AMT                               07650000
072900                                     PIC S9(9)V99 VALUE ZERO      07660000
073000                                                  COMP-3.         07670000
073100         10  PT-763-GWPPWP-MDC-QTY   PIC S9(9)    VALUE ZERO      07680000
073200                                                  COMP-3.         07690000
073300         10  PT-763-GWPPWP-MDC-AMT   PIC S9(9)V99 VALUE ZERO      07700000
073400                                                  COMP-3.         07710000
073500         10  PT-765-GIFT-MKDN-QTY    PIC S9(9)    VALUE ZERO      07720000
073600                                                  COMP-3.         07730000
073700         10  PT-765-GIFT-MKDN-AMT    PIC S9(9)V99 VALUE ZERO      07740000
073800                                                  COMP-3.         07750000
073900         10  PT-765-GIFT-MDC-QTY     PIC S9(9)    VALUE ZERO      07760000
074000                                                  COMP-3.         07770000
074100         10  PT-765-GIFT-MDC-AMT     PIC S9(9)V99 VALUE ZERO      07780000
074200                                                  COMP-3.         07790000
074300         10  PT-BOGO-MKDN-QTY        PIC S9(9)    VALUE ZERO      07800000
074400                                                  COMP-3.         07810000
074500         10  PT-BOGO-MKDN-AMT        PIC S9(9)V99 VALUE ZERO      07820000
074600                                                  COMP-3.         07830000
074700         10  PT-BOGO-MDC-QTY         PIC S9(9)    VALUE ZERO      07840000
074800                                                  COMP-3.         07850000
074900         10  PT-BOGO-MDC-AMT         PIC S9(9)V99 VALUE ZERO      07860000
075000                                                  COMP-3.         07870000
075100                                                                  07880000
075200         10  PT-UNEARNED-RWDS-MKDN-QTY                            07890000
075300                                     PIC S9(9)    VALUE ZERO      07900000
075400                                                  COMP-3.         07910000
075500         10  PT-UNEARNED-RWDS-MKDN-AMT                            07920000
075600                                     PIC S9(9)V99 VALUE ZERO      07930000
075700                                                  COMP-3.         07940000
075800         10  PT-UNEARNED-RWDS-MDC-QTY                             07950000
075900                                     PIC S9(9)    VALUE ZERO      07960000
076000                                                  COMP-3.         07970000
076100         10  PT-UNEARNED-RWDS-MDC-AMT                             07980000
076200                                     PIC S9(9)V99 VALUE ZERO      07990000
076300                                                  COMP-3.         08000000
076400                                                                  08010000
076500         10  PT-EMPLY-DISC-MKDN-QTY  PIC S9(9)    VALUE ZERO      08020000
076600                                                  COMP-3.         08030000
076700         10  PT-EMPLY-DISC-MKDN-AMT  PIC S9(9)V99 VALUE ZERO      08040000
076800                                                  COMP-3.         08050000
076900         10  PT-EMPLY-DISC-MDC-QTY   PIC S9(9)    VALUE ZERO      08060000
077000                                                  COMP-3.         08070000
077100         10  PT-EMPLY-DISC-MDC-AMT   PIC S9(9)V99 VALUE ZERO      08080000
077200                                                  COMP-3.         08090000
077300                                                                  08100000
077400         10  PT-TOTAL-MARKDOWN-QTY   PIC S9(9)    VALUE ZERO      08110000
077500                                                  COMP-3.         08120000
077600         10  PT-TOTAL-MARKDOWN-AMT   PIC S9(9)V99 VALUE ZERO      08130000
077700                                                  COMP-3.         08140000
077800         10  PT-TOTAL-MARKDOWN-CANCEL-QTY                         08150000
077900                                     PIC S9(9)    VALUE ZERO      08160000
078000                                                  COMP-3.         08170000
078100         10  PT-TOTAL-MARKDOWN-CANCEL-AMT                         08180000
078200                                     PIC S9(9)V99 VALUE ZERO      08190000
078300                                                  COMP-3.         08200000
078400         10  PT-TOTAL-MARKUP-QTY     PIC S9(7)    VALUE ZERO      08210000
078500                                                  COMP-3.         08220000
078600         10  PT-TOTAL-MARKUP-AMT     PIC S9(7)V99 VALUE ZERO      08230000
078700                                                  COMP-3.         08240000
078800         10  PT-TOTAL-MARKUP-CANCEL-QTY                           08250000
078900                                     PIC S9(7)    VALUE ZERO      08260000
079000                                                  COMP-3.         08270000
079100         10  PT-TOTAL-MARKUP-CANCEL-AMT                           08280000
079200                                     PIC S9(7)V99 VALUE ZERO      08290000
079300                                                  COMP-3.         08300000
079400         10  PT-NON-OWNED-DROPPED    PIC S9(11)   VALUE ZEROS     08310000
079500                                                  COMP-3.         08320000
079600                                                                  08330000
079700******************************************************************08340000
079800* RECORD LAYOUT FOR INPUT DATE CARD (POS DATE)                    08350000
079900******************************************************************08360000
080000 01  CC-CONTROL-CARD.                                             08370000
080100     05  CC-CONTROL-CARD-DISPLAY.                                 08380000
080200         10  CC-CONTROL-NAME     PIC  X(14) VALUE SPACE.          08390000
080300         10  CC-POS-DATE-MMDDYY  PIC  9(06) VALUE ZERO.           08400000
080400         10  FILLER REDEFINES CC-POS-DATE-MMDDYY.                 08410000
080500             15  CC-POS-DATE-MM  PIC  99.                         08420000
080600             15  CC-POS-DATE-DD  PIC  99.                         08430000
080700             15  CC-POS-DATE-YY  PIC  99.                         08440000
080800     05 FILLER                   PIC  X(60) VALUE SPACE.          08450000
080900                                                                  08460000
081000 01  TD-TOTAL-DISPLAY-MESSAGE.                                    08470000
081100     05  FILLER                  PIC  X(04) VALUE SPACE.          08480000
081200     05  TD-TOTAL-ID             PIC  X(51) VALUE SPACE.          08490000
081300         88  TD-NON-OWNED-DROPPED-ID        VALUE                 08500000
081400             'NON OWNED MDSE MARKDOWNS DROPPED . . . . . . . . '. 08510000
081500     05  TD-TOTAL-AMOUNT         PIC ZZ,ZZZ,ZZZ,ZZ9 VALUE ZEROS.  08520000
081600     05  FILLER                  PIC  X(67) VALUE SPACES.         08530000
081700                                                                  08540000
081800 77  WS-CMT-CNT                  PIC 9(4)   VALUE ZEROS.          08550000
081900                                                                  08560000
082000******************************************************************08570000
082100*  WS FIELDS FOR SQLCA MESSAGE ROUTINE                            08580000
082200******************************************************************08590000
082300                                                                  08600000
082400     COPY DPWS004.                                                08610000
082500                                                                  08620000
082600******************************************************************08630000
082700*  DB2 COMMUNICATION AREA.                                        08640000
082800******************************************************************08650000
082900                                                                  08660000
083000     EXEC SQL                                                     08670000
083100          INCLUDE SQLCA                                           08680000
083200     END-EXEC.                                                    08690000
083300                                                                  08700000
083400******************************************************************08710000
083500*  DB2 TABLE DB2PDBA.TEPPART - PARTITION CONTROL TABLE            08720000
083600******************************************************************08730000
083700                                                                  08740000
083800     EXEC SQL                                                     08750000
083900          INCLUDE TEPPART                                         08760000
084000     END-EXEC.                                                    08770000
084100                                                                  08780000
084200******************************************************************08790000
084300*  DB2 TABLE DB2PDBA.TEPDKEY - CURRENT PROCESSING DAY KEY TABLE   08800000
084400******************************************************************08810000
084500                                                                  08820000
084600     EXEC SQL                                                     08830000
084700          INCLUDE TEPDKEY                                         08840000
084800     END-EXEC.                                                    08850000
084900                                                                  08860000
085000******************************************************************08870000
085100*  DB2 TABLE DB2PDBA.TEPTRN - TRANSACTION TABLE                   08880000
085200******************************************************************08890000
085300                                                                  08900000
085400     EXEC SQL                                                     08910000
085500          INCLUDE TEPTRN                                          08920000
085600     END-EXEC.                                                    08930000
085700                                                                  08940000
085800******************************************************************08950000
085900*  DB2 TABLE DB2PDBA.TEPITM - ITEM TABLE                          08960000
086000******************************************************************08970000
086100                                                                  08980000
086200     EXEC SQL                                                     08990000
086300          INCLUDE TEPITM                                          09000000
086400     END-EXEC.                                                    09010000
086500                                                                  09020000
086600******************************************************************09030000
086700*  DB2 TABLE DB2PDBA.TEPIGP - ITEM GROUP PRICING TABLE            09040000
086800******************************************************************09050000
086900                                                                  09060000
087000     EXEC SQL                                                     09070000
087100          INCLUDE TEPIGP                                          09080000
087200     END-EXEC.                                                    09090000
087300                                                                  09100000
087400******************************************************************09110000
087500*  DB2 TABLE DB2PDBA.TEPLID - LINE ITEM DISCOUNT TABLE            09120000
087600******************************************************************09130000
087700                                                                  09140000
087800     EXEC SQL                                                     09150000
087900          INCLUDE TEPLID                                          09160000
088000     END-EXEC.                                                    09170000
088100                                                                  09180000
088200******************************************************************09190000
088300*  DB2 TABLE DB2PDBA.TEPEID - EMPLOYEE ITEM DISCOUNT TABLE.       09200000
088400******************************************************************09210000
088500                                                                  09220000
088600     EXEC SQL                                                     09230000
088700          INCLUDE TEPEID                                          09240000
088800     END-EXEC.                                                    09250000
088900                                                                  09260000
BOSSCL******************************************************************09261001
BOSSCL*  DB2 TABLE TSKXREF - SKU XREF                                   09262001
BOSSCL******************************************************************09263001
BOSSCL                                                                  09264001
BOSSCL     EXEC SQL                                                     09265001
BOSSCL          INCLUDE TSKXREF                                         09266001
BOSSCL     END-EXEC.                                                    09267001
BOSSCL                                                                  09268001
BOSSCL******************************************************************09269101
BOSSCL*  DB2 TABLE TPPCPRC - PERM PRICING HISTORY                       09269201
BOSSCL******************************************************************09269301
BOSSCL                                                                  09269401
BOSSCL     EXEC SQL                                                     09269501
BOSSCL          INCLUDE TPPCPRC                                         09269601
BOSSCL     END-EXEC.                                                    09269701
BOSSCL                                                                  09269801
BOSSCL                                                                  09269901
BOSSC3******************************************************************09270016
BOSSC3*  DB2 TABLE SAT_BOSS_TRANSFERS TABLE                             09270116
BOSSC3******************************************************************09270216
BOSSC3                                                                  09270316
BOSSC3     EXEC SQL                                                     09270416
BOSSC3          INCLUDE SAT00016                                        09270516
BOSSC3     END-EXEC.                                                    09270616
BOSSC3                                                                  09270716
BOSSC3                                                                  09270816
BOSSC3******************************************************************09270916
BOSSC3*  DB2 TABLE TEPORD - ORDER NUMBER TABLE                          09271016
BOSSC3******************************************************************09271116
BOSSC3                                                                  09271216
BOSSC3     EXEC SQL                                                     09271316
BOSSC3          INCLUDE TEPORD                                          09271416
BOSSC3     END-EXEC.                                                    09271516
BOSSC3                                                                  09271616
BOSSC3                                                                  09271716
089000******************************************************************09272000
089100*  TEPTRN-CURSOR --> VALID CURRENT DAY TRANSACTIONS.              09280000
089200******************************************************************09290000
089300                                                                  09300000
089400     EXEC SQL                                                     09310000
089500        DECLARE TEPTRN-CURSOR CURSOR WITH HOLD FOR                09320000
089600         SELECT A.PARTN_NBR                                       09330000
089700               ,A.STR_NBR                                         09340000
089800               ,A.RGST_ID                                         09350000
089900               ,A.TRN_NBR                                         09360000
090000               ,A.STRT_TM                                         09370000
090100               ,A.SLS_CORR_SEQ_NBR                                09380000
090200               ,A.TRN_STAT_CDE                                    09390000
090300               ,A.SLS_DTE                                         09400000
BOSSCL               ,A.TRN_DTE                                         09401001
011618               ,A.POS_CPBL_LVL_NBR                                09410000
090400               ,A.CRE_TMST                                        09420000
BOSSCL               ,A.OMNI_CHNL_FFLMT_TYP_CDE                         09430000
BOSSC2               ,A.SLS_DTE - 2 DAYS                                09431015
090500           FROM TEPTRN A                                          09440000
090600               ,TEPPART B                                         09450000
090700          WHERE A.PARTN_NBR        = B.PARTN_NBR                  09460000
090800            AND B.SLS_DTE          = :PV-RUN-DATE-CCYY-MM-DD      09470000
090900            AND A.VOID_ABRT_CDE    = 'N'                          09480000
091000            AND A.TRN_STAT_CDE     = 'Z'                          09490000
091100            AND B.STR_GP_CDE       = 'A'                          09500000
091200            AND B.DB_STRUC_CDE     = 'O'                          09510000
091300            AND A.TRN_TYP_CDE     IN                              09520000
091400                ('01', '02', '11', '12', '22', '23', '24', '25')  09530000
091500            AND A.SLS_CORR_SEQ_NBR = 0                            09540000
091600       ORDER BY A.STR_NBR                                         09550000
091700               ,A.RGST_ID                                         09560000
091800               ,A.TRN_NBR                                         09570000
091900               ,A.STRT_TM                                         09580000
092000               ,A.SLS_CORR_SEQ_NBR                                09590000
092100                WITH UR                                           09600000
092200     END-EXEC.                                                    09610000
092300                                                                  09620000
092400******************************************************************09630000
092500*  TEPDKEY CURSOR --> VALID LATE, CORRECTION TRANSACTIONS.        09640000
092600******************************************************************09650000
092700     EXEC SQL                                                     09660000
092800        DECLARE TEPDKEY-CURSOR CURSOR WITH HOLD FOR               09670000
092900         SELECT B.PARTN_NBR                                       09680000
093000               ,B.STR_NBR                                         09690000
093100               ,B.RGST_ID                                         09700000
093200               ,B.TRN_NBR                                         09710000
093300               ,B.STRT_TM                                         09720000
093400               ,B.SLS_CORR_SEQ_NBR                                09730000
093500               ,B.TRN_STAT_CDE                                    09740000
093600               ,B.SLS_DTE                                         09750000
BOSSCL               ,B.TRN_DTE                                         09751001
011618               ,B.POS_CPBL_LVL_NBR                                09760000
093700               ,B.CRE_TMST                                        09770000
BOSSCL               ,B.OMNI_CHNL_FFLMT_TYP_CDE                         09780000
BOSSC2               ,B.SLS_DTE - 2 DAYS                                09781015
093800           FROM TEPDKEY A                                         09790000
093900               ,TEPTRN B                                          09800000
094000               ,TEPPART C                                         09810000
094100          WHERE A.PRCG_DTE         = :PV-RUN-DATE-CCYY-MM-DD      09820000
094200            AND A.SLS_DTE          = C.SLS_DTE                    09830000
094300            AND B.PARTN_NBR        = C.PARTN_NBR                  09840000
094400            AND A.STR_NBR          = B.STR_NBR                    09850000
094500            AND A.RGST_ID          = B.RGST_ID                    09860000
094600            AND A.TRN_NBR          = B.TRN_NBR                    09870000
094700            AND A.STRT_TM          = B.STRT_TM                    09880000
094800            AND A.SLS_CORR_SEQ_NBR = B.SLS_CORR_SEQ_NBR           09890000
094900            AND B.VOID_ABRT_CDE    = 'N'                          09900000
095000            AND B.TRN_STAT_CDE    IN ('V','R','L')                09910000
095100            AND C.STR_GP_CDE       = 'A'                          09920000
095200            AND C.DB_STRUC_CDE     = 'O'                          09930000
095300            AND B.TRN_TYP_CDE     IN                              09940000
095400                ('01', '02', '11', '12', '22', '23', '24', '25')  09950000
095500       ORDER BY B.PARTN_NBR                                       09960000
095600               ,B.STR_NBR                                         09970000
095700               ,B.RGST_ID                                         09980000
095800               ,B.TRN_NBR                                         09990000
095900               ,B.STRT_TM                                         10000000
096000               ,B.SLS_CORR_SEQ_NBR                                10010000
096100                WITH UR                                           10020000
096200     END-EXEC.                                                    10030000
096300                                                                  10040000
096400******************************************************************10050000
096500* ITEM CURSOR                                                     10060000
096600******************************************************************10070000
096700     EXEC SQL                                                     10080000
096800        DECLARE TEPITM-CURSOR CURSOR FOR                          10090000
096900         SELECT LNE_ITM_SEQ_NBR                                   10100000
097000               ,LIV_RSLU_CDE                                      10110000
097100               ,DEPT_NBR                                          10120000
097200               ,SUB_CL_NBR                                        10130000
097300               ,SLD_QTY                                           10140000
097400               ,NET_CHRGD_AMT                                     10150000
097500               ,SAL_TYP_CDE                                       10160000
097600               ,SAL_RET_CDE                                       10170000
097700               ,DEPT_CL_ERR_CDE                                   10180000
097800               ,SKU_ERR_CDE                                       10190000
097900               ,PRIC_SRC_CDE                                      10200000
098000               ,CUST_CHRGD_AMT                                    10210000
098100               ,REG_RTL_AMT                                       10220000
098200               ,ADITEM_NBR                                        10230000
098300               ,UNT_COST_AMT                                      10240000
098400               ,OWND_UNT_RTL_AMT                                  10250000
098500               ,OWNSHP_CDE                                        10260000
098600               ,REG_RTL_ORGN_CDE                                  10270000
098700               ,SKU_NBR                                           10280000
098800               ,MAJ_CL_NBR                                        10290000
098900               ,PROMO_INTFC_ID                                    10300000
214615               ,PROMO_SCHM_CDE                                    10310000
099000               ,OWND_UNT_RTL_ORIG_AMT                             10320000
099100               ,ITM_STAT_CDE                                      10330000
214615               ,ORIG_SAL_TYP_CDE                                  10340000
214615               ,ORIG_REG_RTL_AMT                                  10350000
099200           FROM TEPITM                                            10360000
099300          WHERE PARTN_NBR        = :PV-PARTN-NBR                  10370000
099400            AND STR_NBR          = :PV-STR-NBR                    10371000
099500            AND RGST_ID          = :PV-RGST-ID                    10372000
099600            AND TRN_NBR          = :PV-TRN-NBR                    10373000
099700            AND STRT_TM          = :PV-STRT-TM                    10374000
099800            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           10375000
099900            AND LIV_RSLU_CDE    IN ('+', '-')                     10376000
100000                                                                  10377000
100100       ORDER BY LNE_ITM_SEQ_NBR                                   10378000
100200                WITH UR                                           10379000
100300                OPTIMIZE FOR 5 ROWS                               10380000
100400     END-EXEC.                                                    10390000
100500                                                                  10400000
100600******************************************************************10410000
100700* LINE ITEM DISCOUNT CURSOR                                       10420000
100800******************************************************************10430000
100900     EXEC SQL                                                     10440000
101000        DECLARE TEPLID-CURSOR CURSOR FOR                          10450000
101100         SELECT SUM(LID_AMT)                                      10460000
101200               ,LID_RSN_CDE                                       10470000
101300           FROM TEPLID                                            10480000
101400          WHERE PARTN_NBR        = :PV-PARTN-NBR                  10490000
101500            AND STR_NBR          = :PV-STR-NBR                    10500000
101600            AND RGST_ID          = :PV-RGST-ID                    10510000
101700            AND TRN_NBR          = :PV-TRN-NBR                    10520000
101800            AND STRT_TM          = :PV-STRT-TM                    10530000
101900            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           10540000
102000            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            10550000
102100            AND LID_TYP_CDE     NOT IN ('E', 'G')                 10560000
102200       GROUP BY LID_RSN_CDE                                       10570000
102300       ORDER BY SUM(LID_AMT) DESC                                 10580000
102400                WITH UR                                           10590000
102500                OPTIMIZE FOR 2 ROWS                               10600000
102600     END-EXEC.                                                    10610000
102700                                                                  10620000
102800******************************************************************10630000
102900 PROCEDURE DIVISION.                                              10640000
103000******************************************************************10650000
103100                                                                  10660000
103200******************************************************************10670000
103300 0000-MAINLINE-PARAGRAPH.                                         10680000
103400******************************************************************10690000
103500                                                                  10700000
SEPHOR     DISPLAY 'PROCESSING SAKUT023 SEPHORA VERSION'.               10701035
BOSSC3*    DISPLAY 'PROCESSING SAKUT023 FIX 4 VERSION'.                 10702035
103500                                                                  10710009
103600     PERFORM 1000-HOUSEKEEPING.                                   10730000
103700                                                                  10740000
103800     PERFORM 1115-CONVERT-INPUT-DATE.                             10750000
103900                                                                  10760000
104000     PERFORM 1116-CALCULATE-CUTOFF-DATE.                          10770000
104100                                                                  10780000
104200     PERFORM 1200-FORMAT-HEADINGS.                                10790000
104300                                                                  10800000
104400     PERFORM 2000-OPEN-TRAN-CURSOR.                               10810000
104500                                                                  10820000
104600     PERFORM 2200-FETCH-TRAN-CURSOR                               10830000
104700        UNTIL PS-END-OF-TRAN-YES.                                 10840000
104800                                                                  10850000
104900     PERFORM 2400-CLOSE-TRAN-CURSOR.                              10860000
105000                                                                  10870000
105100     PERFORM 6000-OPEN-DKEY-CURSOR.                               10880000
105200                                                                  10890000
105300     MOVE ZEROS TO  WS-CMT-CNT.                                   10900000
105400     PERFORM 6100-FETCH-DKEY-CURSOR                               10910000
105500        UNTIL PS-END-OF-DKEY-YES.                                 10920000
105600                                                                  10930000
105700     PERFORM 6200-CLOSE-DKEY-CURSOR.                              10940000
105800                                                                  10950000
105900     PERFORM 1500-PROCESS-PROGRAM-TOTALS                          10960000
106000         VARYING PV-TOT-SUB FROM 1 BY 1                           10970027
106100             UNTIL PV-TOT-SUB GREATER THAN 5.                     10980000
106200                                                                  10990000
106300     DISPLAY '**************************************'.            11000000
106400     DISPLAY 'FILE MARKDOWN / MARKDOWN CANCEL TOTALS'.            11010000
106500     DISPLAY 'FOR CURENT DAY PROCEC(NOT INCLUDING LATES/CORRCTS)'.11020000
106600     DISPLAY 'PV-TOTAL-MKDN-AMT= ' PV-TOTAL-MKDN-AMT.             11030000
106700     DISPLAY 'PV-TOTAL-MKDNCAN-AMT= ' PV-TOTAL-MKDNCAN-AMT.       11040000
106800     DISPLAY '**************************************'.            11050000
106900                                                                  11060000
107000     PERFORM 9000-EOJ-ROUTINE.                                    11070000
107100                                                                  11080000
107200     STOP RUN.                                                    11090000
107300                                                                  11100000
107400******************************************************************11110000
107500 1000-HOUSEKEEPING.                                               11120000
107600*     OPEN FILES, READ INPUT FILE, CALL ROUTINES TO VALIDATE,    *11130000
107700*     CALCULATE, AND POPULATE FIELDS.                            *11140000
107800******************************************************************11150000
107900                                                                  11160000
108000     OPEN INPUT POS-DATE-FILE                                     11170000
108100         OUTPUT LEDGER-MARKDOWN-FILE                              11180000
108200                LEDGER-MARKUP-FILE                                11190000
108500                HOLD-LEDGER-MARKDOWN-FILE                         11220000
108600                HOLD-LEDGER-MARKUP-FILE                           11230000
108900                DATAWHSE-FILE                                     11260000
109000                MERCH-LEDGER-REPORT.                              11270000
109100                                                                  11280000
109200     READ POS-DATE-FILE            INTO CC-CONTROL-CARD           11290000
109300        AT END                                                    11300000
109400           SET PS-END-OF-CARD-FILE   TO TRUE.                     11310000
109500                                                                  11320000
109600     CLOSE POS-DATE-FILE.                                         11330000
109700                                                                  11340000
109800     IF PS-END-OF-CARD-FILE                                       11350000
109900         MOVE '1000-HOUSEKEEPING'    TO PV-PARAGRAPH-NAME         11360000
110000         MOVE 'NO INPUT TO PROCESS'  TO PV-OPERATION-MSG-1        11370000
110100         SET AC-CONTROL-CARD-ERROR   TO TRUE                      11380000
110200         PERFORM 9999-ABEND                                       11390000
110300     END-IF.                                                      11400000
110400                                                                  11410000
110500     DISPLAY PC-CURRENT-PROGRAM-NAME                              11420000
110600             ' - CONTROL CARD = (' CC-CONTROL-CARD-DISPLAY ')'.   11430000
110700                                                                  11440000
110800******************************************************************11450000
110900 1115-CONVERT-INPUT-DATE.                                         11460000
111000*     KOHLS CALENDAR ROUTINE. VALIDATES INPUT DATE.               11470000
111100******************************************************************11480000
111200                                                                  11490000
111300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11500000
111400                                                                  11510000
111500     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     11520000
111600     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     11530000
111700     SET DPG52-LK-DTE-GREG           TO TRUE.                     11540000
111800                                                                  11550000
111900     MOVE CC-POS-DATE-MMDDYY         TO DPG52-LK-DATE-INPUT.      11560000
112000                                                                  11570000
112100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11580000
112200                                             DPG54 DPG55 DPG56.   11590000
112300                                                                  11600000
112400     EVALUATE TRUE                                                11610000
112500        WHEN DPG54-SEVERE-ERROR                                   11620000
112600        WHEN DPG54-DATE-INVALID                                   11630000
112700           MOVE '1115-CONVERT-INPUT-DATE'                         11640000
112800                                     TO PV-PARAGRAPH-NAME         11650000
112900           MOVE 'INPUT DATE ERROR'   TO PV-OPERATION-MSG-1        11660000
113000           SET AC-CALENDAR-ERROR     TO TRUE                      11670000
113100           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        11680000
113200           PERFORM 9999-ABEND                                     11690000
113300     END-EVALUATE.                                                11700000
113400                                                                  11710000
113500     MOVE DPG55-DB2-ISO-DATE-FMT     TO PV-RUN-DATE-CCYY-MM-DD.   11720000
113600                                                                  11730000
113700******************************************************************11740000
113800 1116-CALCULATE-CUTOFF-DATE.                                      11750000
113900*     KOHLS CALENDAR ROUTINE. CALCULATE THE CUTOFF DATE.          11760000
114000******************************************************************11770000
114100     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              11780000
114200                                                                  11790000
114300     SET DPG51-FISCAL-454-CALENDAR   TO TRUE.                     11800000
114400     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                     11810000
114500     SET DPG52-LK-DTE-GREG           TO TRUE.                     11820000
114600                                                                  11830000
114700     MOVE CC-POS-DATE-MMDDYY         TO DPG52-LK-DATE-INPUT.      11840000
114800                                                                  11850000
114900     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    11860000
115000                                             DPG54 DPG55 DPG56.   11870000
115100                                                                  11880000
115200     EVALUATE TRUE                                                11890000
115300        WHEN DPG54-SEVERE-ERROR                                   11900000
115400        WHEN DPG54-DATE-INVALID                                   11910000
115500           MOVE '1116-CALCULATE-CUTOFF-DATE'                      11920000
115600                                     TO PV-PARAGRAPH-NAME         11930000
115700           MOVE 'INPUT DATE ERROR'   TO PV-OPERATION-MSG-1        11940000
115800           SET AC-CALENDAR-ERROR     TO TRUE                      11950000
115900           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        11960000
116000           PERFORM 9999-ABEND                                     11970000
116100     END-EVALUATE.                                                11980000
116200                                                                  11990000
116300     MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO PV-CUT-OFF-CCYY-MM-DD.    12000000
116400                                                                  12010000
116500     DISPLAY 'PV-CUT-OFF-CCYY-MM-DD - ' PV-CUT-OFF-CCYY-MM-DD     12020000
116600                                                                  12030000
116700     DISPLAY 'DPG56-FISCAL-PERIOD-NBR ------- '                   12040000
116800              DPG56-FISCAL-PERIOD-NBR                             12050000
116900     DISPLAY 'DPG56-FIRST-FISCAL-PERIOD-DAY - '                   12060000
117000              DPG56-FIRST-FP-DB2-ISO-FMT.                         12070000
117100     DISPLAY 'DPG56-LAST-FISCAL-PERIOD-DAY -- '                   12080000
117200              DPG56-LAST-FP-DB2-ISO-FMT.                          12090000
117300                                                                  12100000
117400******************************************************************12110000
117500 1117-CALCU-KOHLS-MONTH.                                          12120000
117600*     KOHLS CALENDAR ROUTINE. CALCULATE KOHLS MONTH.              12130000
117700******************************************************************12140000
117800                                                                  12150000
117900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              12160000
118000                                                                  12170000
118100     SET  DPG51-FISCAL-454-CALENDAR  TO TRUE.                     12180000
118200     SET  DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                    12190000
118300     SET  DPG52-LK-DTE-ISO-FMT       TO TRUE.                     12200000
118400     MOVE EPTRN-SLS-DTE              TO DPG52-LK-DATE-INPUT.      12210000
118500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    12220000
118600                                             DPG54 DPG55 DPG56.   12230000
118700     EVALUATE TRUE                                                12240000
118800        WHEN DPG54-SEVERE-ERROR                                   12250000
118900        WHEN DPG54-DATE-INVALID                                   12260000
119000           MOVE '1117-CALCU-KOHLS-MONTH'                          12270000
119100                                     TO PV-PARAGRAPH-NAME         12280000
119200           MOVE 'CALENDAR ROUTINE ERROR'                          12290000
119300                                     TO PV-OPERATION-MSG-1        12300000
119400           SET AC-CALENDAR-ERROR     TO TRUE                      12310000
119500           MOVE DPG54-ERROR-MESSAGE  TO PV-OPERATION-MSG-2        12320000
119600           PERFORM 9999-ABEND                                     12330000
119700     END-EVALUATE.                                                12340000
119800                                                                  12350000
119900     MOVE DPG56-FISCAL-PERIOD-NBR TO  PV-FISC-PERIOD-NBR-HOLD.    12360000
120000                                                                  12370000
120100                                                                  12380000
120200******************************************************************12390000
120300 1200-FORMAT-HEADINGS.                                            12400000
120400*     GET CURRENT DATE AND TIME FROM SYSTEM.                      12410000
120500*     FORMAT REPORT FIELDS IN THE TOP PAGE HEADING LINE.          12420000
120600*     FORMAT HEADING LINE 2 WITH CONVERTED POS DATE.              12430000
120700******************************************************************12440000
120800                                                                  12450000
120900     ACCEPT PV-CURRENT-DATE        FROM DATE.                     12460000
121000     ACCEPT PV-CURRENT-TIME        FROM TIME.                     12470000
121100                                                                  12480000
121200     MOVE PV-CURRENT-YEAR            TO DP132O-RUN-YEAR.          12490000
121300     MOVE PV-CURRENT-MONTH           TO DP132O-RUN-MONTH.         12500000
121400     MOVE PV-CURRENT-DAY             TO DP132O-RUN-DAY.           12510000
121500                                                                  12520000
121600     MOVE PV-CURRENT-HOUR            TO DP132O-RUN-HOUR.          12530000
121700     MOVE PV-CURRENT-MINUTE          TO DP132O-RUN-MINUTE.        12540000
121800                                                                  12550000
121900     MOVE PC-CURRENT-PROGRAM-NAME    TO DP132O-PROGRAM-NAME.      12560000
122000                                                                  12570000
122100     MOVE '1'                        TO DP132O-REPORT-NUMBER.     12580000
122200                                                                  12590000
122300     INITIALIZE DL-DETAIL-LINE.                                   12600000
122400                                                                  12610000
122500     INITIALIZE ML017-PRICE-CHANGE-RECORD.                        12620000
122600                                                                  12630000
122700     MOVE CC-POS-DATE-MM             TO HL-REPORT-MONTH           12640000
122800     MOVE CC-POS-DATE-DD             TO HL-REPORT-DAY             12650000
122900     MOVE CC-POS-DATE-YY             TO HL-REPORT-YEAR            12660000
123000                                                                  12670000
123100     PERFORM 8400-WRITE-HEADERS.                                  12680000
123200                                                                  12690000
123300******************************************************************12700000
123400 1500-PROCESS-PROGRAM-TOTALS.                                     12710000
123500*  DISPLAY PROGRAM TOTALS BY MARKDOWN/MARKUP TYPE AND CATEGORY.  *12720000
123600******************************************************************12730000
123700                                                                  12740000
123800     EVALUATE PV-TOT-SUB                                          12750000
123900         WHEN 1                                                   12760000
124000             SET HD-ORIGINAL-SALES   TO TRUE                      12770000
124100         WHEN 2                                                   12780000
124200             SET HD-SALES-CORR       TO TRUE                      12790000
124300         WHEN 3                                                   12800000
124400             SET HD-LATE-TRANSACTIONS                             12810000
124500                                     TO TRUE                      12820000
124600         WHEN 4                                                   12830000
124700             SET HD-CUTOFF-SALES-CORR                             12840000
124800                                     TO TRUE                      12850000
124900         WHEN 5                                                   12860000
125000             SET HD-CUTOFF-LATE-TRANSACTIONS                      12870000
125100                                     TO TRUE                      12880000
125200     END-EVALUATE.                                                12890000
125300                                                                  12900000
125400     MOVE 2 TO PV-SPACE-CONTROL.                                  12910000
125500                                                                  12920000
125600     WRITE REPORT-LINE-OUT                                        12930000
125700         FROM HL-HEADER-LINE4                                     12940000
125800            AFTER ADVANCING PV-SPACE-CONTROL.                     12950000
125900                                                                  12960000
126000     ADD 2 TO PV-LINE-COUNT.                                      12970000
126100                                                                  12980000
126200     DISPLAY ' '.                                                 12990000
126300     DISPLAY '  '  HL-HEADER-LINE4                                13000000
126400     DISPLAY ' '.                                                 13010000
126500                                                                  13020000
126600     DISPLAY ' '.                                                 13030000
126700     DISPLAY '  '  DH-DISPLAY-HEADER.                             13040000
126800     DISPLAY ' '.                                                 13050000
126900                                                                  13060000
127000     MOVE SPACES TO DD-DISPLAY-DETAIL.                            13070000
127100     SET DD-PC-PROMOTIONAL           TO TRUE.                     13080000
127200     MOVE PT-PROMOTIONAL-MKDN-QTY (PV-TOT-SUB)                    13090000
127300                                     TO DD-MARKDOWN-QTY           13100000
127400                                        DL-MARKDOWN-QTY.          13110000
127500     ADD PT-PROMOTIONAL-MKDN-QTY (PV-TOT-SUB)                     13120000
127600                                     TO PT-TOTAL-MARKDOWN-QTY     13130000
127700                                        (PV-TOT-SUB).             13140000
127800     MOVE PT-PROMOTIONAL-MKDN-AMT (PV-TOT-SUB)                    13150000
127900                                     TO DD-MARKDOWN-AMT           13160000
128000                                        DL-MARKDOWN-AMT.          13170000
128100     ADD PT-PROMOTIONAL-MKDN-AMT (PV-TOT-SUB)                     13180000
128200                                     TO PT-TOTAL-MARKDOWN-AMT     13190000
128300                                        (PV-TOT-SUB).             13200000
128400     MOVE PT-PROMOTIONAL-MDC-QTY (PV-TOT-SUB)                     13210000
128500                                     TO DD-MARKDOWN-CANCEL-QTY    13220000
128600                                        DL-MARKDOWN-CANCEL-QTY.   13230000
128700     ADD PT-PROMOTIONAL-MDC-QTY (PV-TOT-SUB)                      13240000
128800                                     TO                           13250000
128900         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13260000
129000     MOVE PT-PROMOTIONAL-MDC-AMT (PV-TOT-SUB)                     13270000
129100                                     TO DD-MARKDOWN-CANCEL-AMT    13280000
129200                                        DL-MARKDOWN-CANCEL-AMT.   13290000
129300     ADD PT-PROMOTIONAL-MDC-AMT (PV-TOT-SUB)                      13300000
129400                                     TO                           13310000
129500         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13320000
129600                                                                  13330000
129700     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13340000
129800     MOVE PC-PROMOTIONAL             TO DL-PRICE-CHANGE-TYPE.     13350000
129900     PERFORM 8200-WRITE-DETAIL-LINE.                              13360000
130000                                                                  13370000
130100     MOVE SPACES                     TO DD-DISPLAY-DETAIL.        13380000
130200     SET DD-PC-TIERED                TO TRUE.                     13390000
130300     MOVE PT-TIERED-MKDN-QTY (PV-TOT-SUB)                         13400000
130400                                     TO DD-MARKDOWN-QTY           13410000
130500                                        DL-MARKDOWN-QTY.          13420000
130600     ADD PT-TIERED-MKDN-QTY (PV-TOT-SUB)                          13430000
130700                                     TO PT-TOTAL-MARKDOWN-QTY     13440000
130800                                        (PV-TOT-SUB).             13450000
130900     MOVE PT-TIERED-MKDN-AMT (PV-TOT-SUB)                         13460000
131000                                     TO DD-MARKDOWN-AMT           13470000
131100                                        DL-MARKDOWN-AMT.          13480000
131200     ADD PT-TIERED-MKDN-AMT (PV-TOT-SUB)                          13490000
131300                                     TO PT-TOTAL-MARKDOWN-AMT     13500000
131400                                        (PV-TOT-SUB).             13510000
131500     MOVE PT-TIERED-MDC-QTY (PV-TOT-SUB)                          13520000
131600                                     TO DD-MARKDOWN-CANCEL-QTY    13530000
131700                                        DL-MARKDOWN-CANCEL-QTY.   13540000
131800     ADD PT-TIERED-MDC-QTY (PV-TOT-SUB)                           13550000
131900                                     TO                           13560000
132000         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13570000
132100     MOVE PT-TIERED-MDC-AMT (PV-TOT-SUB)                          13580000
132200                                     TO DD-MARKDOWN-CANCEL-AMT    13590000
132300                                        DL-MARKDOWN-CANCEL-AMT.   13600000
132400     ADD PT-TIERED-MDC-AMT (PV-TOT-SUB)                           13610000
132500                                     TO                           13620000
132600         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13630000
132700                                                                  13640000
132800     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13650000
132900     MOVE PC-TIERED                  TO DL-PRICE-CHANGE-TYPE.     13660000
133000     PERFORM 8200-WRITE-DETAIL-LINE.                              13670000
133100                                                                  13680000
133200     MOVE SPACES                     TO DD-DISPLAY-DETAIL.        13690000
133300     SET DD-PC-GOLDSTAR              TO TRUE.                     13700000
133400     MOVE PT-GOLDSTAR-MKDN-QTY (PV-TOT-SUB)                       13710000
133500                                     TO DD-MARKDOWN-QTY           13720000
133600                                        DL-MARKDOWN-QTY.          13730000
133700     ADD PT-GOLDSTAR-MKDN-QTY (PV-TOT-SUB)                        13740000
133800                                     TO PT-TOTAL-MARKDOWN-QTY     13750000
133900                                        (PV-TOT-SUB).             13760000
134000     MOVE PT-GOLDSTAR-MKDN-AMT (PV-TOT-SUB)                       13770000
134100                                     TO DD-MARKDOWN-AMT           13780000
134200                                        DL-MARKDOWN-AMT.          13790000
134300     ADD PT-GOLDSTAR-MKDN-AMT (PV-TOT-SUB)                        13800000
134400                                     TO PT-TOTAL-MARKDOWN-AMT     13810000
134500                                        (PV-TOT-SUB).             13820000
134600     MOVE PT-GOLDSTAR-MDC-QTY (PV-TOT-SUB)                        13830000
134700                                     TO DD-MARKDOWN-CANCEL-QTY    13840000
134800                                        DL-MARKDOWN-CANCEL-QTY.   13850000
134900     ADD PT-GOLDSTAR-MDC-QTY (PV-TOT-SUB)                         13860000
135000                                     TO                           13870000
135100         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               13880000
135200     MOVE PT-GOLDSTAR-MDC-AMT (PV-TOT-SUB)                        13890000
135300                                     TO DD-MARKDOWN-CANCEL-AMT    13900000
135400                                        DL-MARKDOWN-CANCEL-AMT.   13910000
135500     ADD PT-GOLDSTAR-MDC-AMT (PV-TOT-SUB)                         13920000
135600                                     TO                           13930000
135700         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               13940000
135800                                                                  13950000
135900     DISPLAY '  '  DD-DISPLAY-DETAIL.                             13960000
136000     MOVE PC-GOLDSTAR                TO DL-PRICE-CHANGE-TYPE.     13970000
136100     PERFORM 8200-WRITE-DETAIL-LINE.                              13980000
136200                                                                  13990000
136300     MOVE SPACES TO DD-DISPLAY-DETAIL.                            14000000
136400     SET DD-PC-MANUAL-LID            TO TRUE.                     14010000
136500     MOVE PT-MANUAL-LID-MKDN-QTY (PV-TOT-SUB)                     14020000
136600                                     TO DD-MARKDOWN-QTY           14030000
136700                                        DL-MARKDOWN-QTY.          14040000
136800     ADD PT-MANUAL-LID-MKDN-QTY (PV-TOT-SUB)                      14050000
136900                                     TO PT-TOTAL-MARKDOWN-QTY     14060000
137000                                        (PV-TOT-SUB).             14070000
137100     MOVE PT-MANUAL-LID-MKDN-AMT (PV-TOT-SUB)                     14080000
137200                                     TO DD-MARKDOWN-AMT           14090000
137300                                        DL-MARKDOWN-AMT.          14100000
137400     ADD PT-MANUAL-LID-MKDN-AMT (PV-TOT-SUB)                      14110000
137500                                     TO PT-TOTAL-MARKDOWN-AMT     14120000
137600                                        (PV-TOT-SUB).             14130000
137700     MOVE PT-MANUAL-LID-MDC-QTY (PV-TOT-SUB)                      14140000
137800                                     TO DD-MARKDOWN-CANCEL-QTY    14150000
137900                                        DL-MARKDOWN-CANCEL-QTY.   14160000
138000     ADD PT-MANUAL-LID-MDC-QTY (PV-TOT-SUB)                       14170000
138100                                     TO                           14180000
138200         PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB).               14190000
138300     MOVE PT-MANUAL-LID-MDC-AMT (PV-TOT-SUB)                      14200000
138400                                     TO DD-MARKDOWN-CANCEL-AMT    14210000
138500                                        DL-MARKDOWN-CANCEL-AMT.   14220000
138600     ADD PT-MANUAL-LID-MDC-AMT (PV-TOT-SUB)                       14230000
138700                                     TO                           14240000
138800         PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB).               14250000
138900                                                                  14260000
139000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             14270000
139100     MOVE PC-MANUAL-LID              TO DL-PRICE-CHANGE-TYPE.     14280000
139200     PERFORM 8200-WRITE-DETAIL-LINE.                              14290000
139300                                                                  14300000
139400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            14310000
139500     SET DD-PC-OWNERSHIP-ADJUSTMENT  TO TRUE.                     14320000
139600     MOVE PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)                  14330000
139700                                     TO DD-MARKDOWN-QTY           14340000
139800                                        DL-MARKDOWN-QTY.          14350000
139900     ADD PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)                   14360000
140000                                     TO PT-TOTAL-MARKDOWN-QTY     14370000
140100                                        (PV-TOT-SUB).             14380000
140200     MOVE PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)                  14390000
140300                                     TO DD-MARKDOWN-AMT           14400000
140400                                        DL-MARKDOWN-AMT.          14410000
140500     ADD PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)                   14420000
140600                                     TO PT-TOTAL-MARKDOWN-AMT     14430000
140700                                        (PV-TOT-SUB).             14440000
140800     MOVE PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)                   14450000
140900                                 TO DD-MARKDOWN-CANCEL-QTY        14460000
141000                                    DL-MARKDOWN-CANCEL-QTY.       14470000
141100     ADD PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)                    14480000
141200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  14490000
141300                                                    (PV-TOT-SUB). 14500000
141400     MOVE PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                   14510000
141500                                 TO DD-MARKDOWN-CANCEL-AMT        14520000
141600                                    DL-MARKDOWN-CANCEL-AMT.       14530000
141700     ADD PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                    14540000
141800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  14550000
141900                                                    (PV-TOT-SUB). 14560000
142000     MOVE PT-OWNERSHIP-ADJ-MKUP-QTY (PV-TOT-SUB)                  14570000
142100                                 TO DD-MARKUP-QTY                 14580000
142200                                    DL-MARKUP-QTY.                14590000
142300     ADD PT-OWNERSHIP-ADJ-MKUP-QTY (PV-TOT-SUB)                   14600000
142400                                 TO PT-TOTAL-MARKUP-QTY           14610000
142500                                                    (PV-TOT-SUB). 14620000
142600     MOVE PT-OWNERSHIP-ADJ-MKUP-AMT (PV-TOT-SUB)                  14630000
142700                                 TO DD-MARKUP-AMT                 14640000
142800                                    DL-MARKUP-AMT.                14650000
142900     ADD PT-OWNERSHIP-ADJ-MKUP-AMT (PV-TOT-SUB)                   14660000
143000                                 TO PT-TOTAL-MARKUP-AMT           14670000
143100                                                    (PV-TOT-SUB). 14680000
143200     MOVE PT-OWNERSHIP-ADJ-MUC-QTY (PV-TOT-SUB)                   14690000
143300                                 TO DD-MARKUP-CANCEL-QTY          14700000
143400                                    DL-MARKUP-CANCEL-QTY.         14710000
143500     ADD PT-OWNERSHIP-ADJ-MUC-QTY (PV-TOT-SUB)                    14720000
143600                                 TO PT-TOTAL-MARKUP-CANCEL-QTY    14730000
143700                                                    (PV-TOT-SUB). 14740000
143800     MOVE PT-OWNERSHIP-ADJ-MUC-AMT (PV-TOT-SUB)                   14750000
143900                                 TO DD-MARKUP-CANCEL-AMT          14760000
144000                                    DL-MARKUP-CANCEL-AMT.         14770000
144100     ADD PT-OWNERSHIP-ADJ-MUC-AMT (PV-TOT-SUB)                    14780000
144200                                 TO PT-TOTAL-MARKUP-CANCEL-AMT    14790000
144300                                                    (PV-TOT-SUB). 14800000
144400                                                                  14810000
144500     DISPLAY '  '  DD-DISPLAY-DETAIL.                             14820000
144600     MOVE PC-OWNERSHIP-ADJ TO DL-PRICE-CHANGE-TYPE.               14830000
144700     PERFORM 8200-WRITE-DETAIL-LINE.                              14840000
144800                                                                  14850000
144900     MOVE SPACES TO DD-DISPLAY-DETAIL.                            14860000
145000     SET DD-PC-OWN-RETRN-ADJUSTMENT TO TRUE.                      14870000
145100     MOVE PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)                  14880000
145200                                 TO DD-MARKDOWN-QTY               14890000
145300                                    DL-MARKDOWN-QTY.              14900000
145400     ADD PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)                   14910000
145500                                 TO PT-TOTAL-MARKDOWN-QTY         14920000
145600                                                    (PV-TOT-SUB). 14930000
145700     MOVE PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)                  14940000
145800                                 TO DD-MARKDOWN-AMT               14950000
145900                                    DL-MARKDOWN-AMT.              14960000
146000     ADD PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)                   14970000
146100                                 TO PT-TOTAL-MARKDOWN-AMT         14980000
146200                                                    (PV-TOT-SUB). 14990000
146300     MOVE PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB)                   15000000
146400                                 TO DD-MARKDOWN-CANCEL-QTY        15010000
146500                                    DL-MARKDOWN-CANCEL-QTY.       15020000
146600     ADD PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB)                    15030000
146700                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15040000
146800                                                    (PV-TOT-SUB). 15050000
146900     MOVE PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB)                   15060000
147000                                 TO DD-MARKDOWN-CANCEL-AMT        15070000
147100                                    DL-MARKDOWN-CANCEL-AMT.       15080000
147200     ADD PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB)                    15090000
147300                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15100000
147400                                                    (PV-TOT-SUB). 15110000
147500     MOVE PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB)                  15120000
147600                                 TO DD-MARKUP-QTY                 15130000
147700                                    DL-MARKUP-QTY.                15140000
147800     ADD PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB)                   15150000
147900                                 TO PT-TOTAL-MARKUP-QTY           15160000
148000                                                    (PV-TOT-SUB). 15170000
148100     MOVE PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB)                  15180000
148200                                 TO DD-MARKUP-AMT                 15190000
148300                                    DL-MARKUP-AMT.                15200000
148400     ADD PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB)                   15210000
148500                                 TO PT-TOTAL-MARKUP-AMT           15220000
148600                                                    (PV-TOT-SUB). 15230000
148700     MOVE PT-OWN-RETRN-ADJ-MUC-QTY (PV-TOT-SUB)                   15240000
148800                                 TO DD-MARKUP-CANCEL-QTY          15250000
148900                                    DL-MARKUP-CANCEL-QTY.         15260000
149000     ADD PT-OWN-RETRN-ADJ-MUC-QTY (PV-TOT-SUB)                    15270000
149100                                 TO PT-TOTAL-MARKUP-CANCEL-QTY    15280000
149200                                                    (PV-TOT-SUB). 15290000
149300     MOVE PT-OWN-RETRN-ADJ-MUC-AMT (PV-TOT-SUB)                   15300000
149400                                 TO DD-MARKUP-CANCEL-AMT          15310000
149500                                    DL-MARKUP-CANCEL-AMT.         15320000
149600     ADD PT-OWN-RETRN-ADJ-MUC-AMT (PV-TOT-SUB)                    15330000
149700                                 TO PT-TOTAL-MARKUP-CANCEL-AMT    15340000
149800                                                    (PV-TOT-SUB). 15350000
149900                                                                  15360000
150000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15370000
150100     MOVE PC-OWN-RETRN-ADJ TO DL-PRICE-CHANGE-TYPE.               15380000
150200     PERFORM 8200-WRITE-DETAIL-LINE.                              15390000
150300                                                                  15400000
150400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15410000
150500     SET DD-PC-SENIOR-CITIZEN TO TRUE.                            15420000
150600     MOVE PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)                 15430000
150700                                 TO DD-MARKDOWN-QTY               15440000
150800                                    DL-MARKDOWN-QTY.              15450000
150900     ADD PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)                  15460000
151000                                 TO PT-TOTAL-MARKDOWN-QTY         15470000
151100                                                    (PV-TOT-SUB). 15480000
151200     MOVE PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)                 15490000
151300                                 TO DD-MARKDOWN-AMT               15500000
151400                                    DL-MARKDOWN-AMT.              15510000
151500     ADD PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)                  15520000
151600                                 TO PT-TOTAL-MARKDOWN-AMT         15530000
151700                                                    (PV-TOT-SUB). 15540000
151800     MOVE PT-SENIOR-CITIZEN-MDC-QTY (PV-TOT-SUB)                  15550000
151900                                 TO DD-MARKDOWN-CANCEL-QTY        15560000
152000                                    DL-MARKDOWN-CANCEL-QTY.       15570000
152100     ADD PT-SENIOR-CITIZEN-MDC-QTY (PV-TOT-SUB)                   15580000
152200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15590000
152300                                                    (PV-TOT-SUB). 15600000
152400     MOVE PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)                  15610000
152500                                 TO DD-MARKDOWN-CANCEL-AMT        15620000
152600                                    DL-MARKDOWN-CANCEL-AMT.       15630000
152700     ADD PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)                   15640000
152800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15650000
152900                                                    (PV-TOT-SUB). 15660000
153000                                                                  15670000
153100     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15680000
153200     MOVE PC-SENIOR-CITIZEN TO DL-PRICE-CHANGE-TYPE.              15690000
153300     PERFORM 8200-WRITE-DETAIL-LINE.                              15700000
153400                                                                  15710000
153500     MOVE SPACES TO DD-DISPLAY-DETAIL.                            15720000
153600     SET DD-PC-KOHLS-COUPON TO TRUE.                              15730000
153700     MOVE PT-KOHLS-COUPON-MKDN-QTY (PV-TOT-SUB)                   15740000
153800                                 TO DD-MARKDOWN-QTY               15750000
153900                                    DL-MARKDOWN-QTY.              15760000
154000     ADD PT-KOHLS-COUPON-MKDN-QTY (PV-TOT-SUB)                    15770000
154100                                 TO PT-TOTAL-MARKDOWN-QTY         15780000
154200                                                    (PV-TOT-SUB). 15790000
154300     MOVE PT-KOHLS-COUPON-MKDN-AMT (PV-TOT-SUB)                   15800000
154400                                 TO DD-MARKDOWN-AMT               15810000
154500                                    DL-MARKDOWN-AMT.              15820000
154600     ADD PT-KOHLS-COUPON-MKDN-AMT (PV-TOT-SUB)                    15830000
154700                                 TO PT-TOTAL-MARKDOWN-AMT         15840000
154800                                                    (PV-TOT-SUB). 15850000
154900     MOVE PT-KOHLS-COUPON-MDC-QTY (PV-TOT-SUB)                    15860000
155000                                 TO DD-MARKDOWN-CANCEL-QTY        15870000
155100                                    DL-MARKDOWN-CANCEL-QTY.       15880000
155200     ADD PT-KOHLS-COUPON-MDC-QTY (PV-TOT-SUB)                     15890000
155300                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  15900000
155400                                                    (PV-TOT-SUB). 15910000
155500     MOVE PT-KOHLS-COUPON-MDC-AMT (PV-TOT-SUB)                    15920000
155600                                 TO DD-MARKDOWN-CANCEL-AMT        15930000
155700                                    DL-MARKDOWN-CANCEL-AMT.       15940000
155800     ADD PT-KOHLS-COUPON-MDC-AMT (PV-TOT-SUB)                     15950000
155900                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  15960000
156000                                                    (PV-TOT-SUB). 15970000
156100     DISPLAY '  '  DD-DISPLAY-DETAIL.                             15980000
156200     MOVE PC-KOHLS-COUPON TO DL-PRICE-CHANGE-TYPE.                15990000
156300     PERFORM 8200-WRITE-DETAIL-LINE.                              16000000
156400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16010000
156500     SET DD-PC-OFFER-COUPON TO TRUE.                              16020000
156600     MOVE PT-760-OFFER-MKDN-QTY (PV-TOT-SUB)                      16030000
156700                                 TO DD-MARKDOWN-QTY               16040000
156800                                    DL-MARKDOWN-QTY.              16050000
156900     ADD PT-760-OFFER-MKDN-QTY (PV-TOT-SUB)                       16060000
157000                                 TO PT-TOTAL-MARKDOWN-QTY         16070000
157100                                                    (PV-TOT-SUB). 16080000
157200     MOVE PT-760-OFFER-MKDN-AMT (PV-TOT-SUB)                      16090000
157300                                 TO DD-MARKDOWN-AMT               16100000
157400                                    DL-MARKDOWN-AMT.              16110000
157500     ADD PT-760-OFFER-MKDN-AMT (PV-TOT-SUB)                       16120000
157600                                 TO PT-TOTAL-MARKDOWN-AMT         16130000
157700                                                    (PV-TOT-SUB). 16140000
157800     MOVE PT-760-OFFER-MDC-QTY (PV-TOT-SUB)                       16150000
157900                                 TO DD-MARKDOWN-CANCEL-QTY        16160000
158000                                    DL-MARKDOWN-CANCEL-QTY.       16170000
158100     ADD PT-760-OFFER-MDC-QTY (PV-TOT-SUB)                        16180000
158200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16190000
158300                                                    (PV-TOT-SUB). 16200000
158400     MOVE PT-760-OFFER-MDC-AMT (PV-TOT-SUB)                       16210000
158500                                 TO DD-MARKDOWN-CANCEL-AMT        16220000
158600                                    DL-MARKDOWN-CANCEL-AMT.       16230000
158700     ADD PT-760-OFFER-MDC-AMT (PV-TOT-SUB)                        16240000
158800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16250000
158900                                                    (PV-TOT-SUB). 16260000
159000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16270000
159100     MOVE PC-OFFER-COUPON TO DL-PRICE-CHANGE-TYPE.                16280000
159200     PERFORM 8200-WRITE-DETAIL-LINE.                              16290000
159300                                                                  16300000
159400     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16310000
159500     SET DD-PC-OFFER-TLD-TIERED TO TRUE.                          16320000
159600     MOVE PT-761-TLDTIER-MKDN-QTY (PV-TOT-SUB)                    16330000
159700                                 TO DD-MARKDOWN-QTY               16340000
159800                                    DL-MARKDOWN-QTY.              16350000
159900     ADD PT-761-TLDTIER-MKDN-QTY (PV-TOT-SUB)                     16360000
160000                                 TO PT-TOTAL-MARKDOWN-QTY         16370000
160100                                                    (PV-TOT-SUB). 16380000
160200     MOVE PT-761-TLDTIER-MKDN-AMT (PV-TOT-SUB)                    16390000
160300                                 TO DD-MARKDOWN-AMT               16400000
160400                                    DL-MARKDOWN-AMT.              16410000
160500     ADD PT-761-TLDTIER-MKDN-AMT (PV-TOT-SUB)                     16420000
160600                                 TO PT-TOTAL-MARKDOWN-AMT         16430000
160700                                                    (PV-TOT-SUB). 16440000
160800     MOVE PT-761-TLDTIER-MDC-QTY (PV-TOT-SUB)                     16450000
160900                                 TO DD-MARKDOWN-CANCEL-QTY        16460000
161000                                    DL-MARKDOWN-CANCEL-QTY.       16470000
161100     ADD PT-761-TLDTIER-MDC-QTY (PV-TOT-SUB)                      16480000
161200                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16490000
161300                                                    (PV-TOT-SUB). 16500000
161400     MOVE PT-761-TLDTIER-MDC-AMT (PV-TOT-SUB)                     16510000
161500                                 TO DD-MARKDOWN-CANCEL-AMT        16520000
161600                                    DL-MARKDOWN-CANCEL-AMT.       16530000
161700     ADD PT-761-TLDTIER-MDC-AMT (PV-TOT-SUB)                      16540000
161800                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16550000
161900                                                    (PV-TOT-SUB). 16560000
162000     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16570000
162100     MOVE PC-OFFER-TLD-TIERED  TO DL-PRICE-CHANGE-TYPE.           16580000
162200     PERFORM 8200-WRITE-DETAIL-LINE.                              16590000
162300                                                                  16600000
162400                                                                  16610000
162500     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16620000
162600     SET DD-PC-OFFER-LID-TIERED TO TRUE.                          16630000
162700     MOVE PT-762-LIDTIER-MKDN-QTY (PV-TOT-SUB)                    16640000
162800                                 TO DD-MARKDOWN-QTY               16650000
162900                                    DL-MARKDOWN-QTY.              16660000
163000     ADD PT-762-LIDTIER-MKDN-QTY (PV-TOT-SUB)                     16670000
163100                                 TO PT-TOTAL-MARKDOWN-QTY         16680000
163200                                                    (PV-TOT-SUB). 16690000
163300     MOVE PT-762-LIDTIER-MKDN-AMT (PV-TOT-SUB)                    16700000
163400                                 TO DD-MARKDOWN-AMT               16710000
163500                                    DL-MARKDOWN-AMT.              16720000
163600     ADD PT-762-LIDTIER-MKDN-AMT (PV-TOT-SUB)                     16730000
163700                                 TO PT-TOTAL-MARKDOWN-AMT         16740000
163800                                                    (PV-TOT-SUB). 16750000
163900     MOVE PT-762-LIDTIER-MDC-QTY (PV-TOT-SUB)                     16760000
164000                                 TO DD-MARKDOWN-CANCEL-QTY        16770000
164100                                    DL-MARKDOWN-CANCEL-QTY.       16780000
164200     ADD PT-762-LIDTIER-MDC-QTY (PV-TOT-SUB)                      16790000
164300                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  16800000
164400                                                    (PV-TOT-SUB). 16810000
164500     MOVE PT-762-LIDTIER-MDC-AMT (PV-TOT-SUB)                     16820000
164600                                 TO DD-MARKDOWN-CANCEL-AMT        16830000
164700                                    DL-MARKDOWN-CANCEL-AMT.       16840000
164800     ADD PT-762-LIDTIER-MDC-AMT (PV-TOT-SUB)                      16850000
164900                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  16860000
165000                                                    (PV-TOT-SUB). 16870000
165100     DISPLAY '  '  DD-DISPLAY-DETAIL.                             16880000
165200     MOVE PC-OFFER-LID-TIERED  TO DL-PRICE-CHANGE-TYPE.           16890000
165300     PERFORM 8200-WRITE-DETAIL-LINE.                              16900000
165400                                                                  16910000
165500                                                                  16920000
165600     MOVE SPACES TO DD-DISPLAY-DETAIL.                            16930000
165700     SET DD-PC-OFFER-GWP-PWP    TO TRUE.                          16940000
165800     MOVE PT-763-GWPPWP-MKDN-QTY (PV-TOT-SUB)                     16950000
165900                                 TO DD-MARKDOWN-QTY               16960000
166000                                    DL-MARKDOWN-QTY.              16970000
166100     ADD PT-763-GWPPWP-MKDN-QTY (PV-TOT-SUB)                      16980000
166200                                 TO PT-TOTAL-MARKDOWN-QTY         16990000
166300                                                    (PV-TOT-SUB). 17000000
166400     MOVE PT-763-GWPPWP-MKDN-AMT (PV-TOT-SUB)                     17010000
166500                                 TO DD-MARKDOWN-AMT               17020000
166600                                    DL-MARKDOWN-AMT.              17030000
166700     ADD PT-763-GWPPWP-MKDN-AMT (PV-TOT-SUB)                      17040000
166800                                 TO PT-TOTAL-MARKDOWN-AMT         17050000
166900                                                    (PV-TOT-SUB). 17060000
167000     MOVE PT-763-GWPPWP-MDC-QTY (PV-TOT-SUB)                      17070000
167100                                 TO DD-MARKDOWN-CANCEL-QTY        17080000
167200                                    DL-MARKDOWN-CANCEL-QTY.       17090000
167300     ADD PT-763-GWPPWP-MDC-QTY (PV-TOT-SUB)                       17100000
167400                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17110000
167500                                                    (PV-TOT-SUB). 17120000
167600     MOVE PT-763-GWPPWP-MDC-AMT (PV-TOT-SUB)                      17130000
167700                                 TO DD-MARKDOWN-CANCEL-AMT        17140000
167800                                    DL-MARKDOWN-CANCEL-AMT.       17150000
167900     ADD PT-763-GWPPWP-MDC-AMT (PV-TOT-SUB)                       17160000
168000                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17170000
168100                                                    (PV-TOT-SUB). 17180000
168200                                                                  17190000
168300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17200000
168400     MOVE PC-OFFER-GWP-PWP     TO DL-PRICE-CHANGE-TYPE.           17210000
168500     PERFORM 8200-WRITE-DETAIL-LINE.                              17220000
205464                                                                  17230000
205464     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17240000
205464     SET DD-NON-RCPT-RTRN        TO TRUE.                         17250000
205464     MOVE PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)                     17260000
205464                                 TO DD-MARKDOWN-QTY               17270000
205464                                    DL-MARKDOWN-QTY.              17280000
205464     ADD PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)                      17290000
205464                                 TO PT-TOTAL-MARKDOWN-QTY         17300000
205464                                                    (PV-TOT-SUB). 17310000
205464     MOVE PT-710-NORCPT-MKDN-AMT (PV-TOT-SUB)                     17320000
205464                                 TO DD-MARKDOWN-AMT               17330000
205464                                    DL-MARKDOWN-AMT.              17340000
205464     ADD PT-710-NORCPT-MKDN-AMT (PV-TOT-SUB)                      17350000
205464                                 TO PT-TOTAL-MARKDOWN-AMT         17360000
205464                                                    (PV-TOT-SUB). 17370000
205464     MOVE PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)                      17380000
205464                                 TO DD-MARKDOWN-CANCEL-QTY        17390000
205464                                    DL-MARKDOWN-CANCEL-QTY.       17400000
205464     ADD PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)                       17410000
205464                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17420000
205464                                                    (PV-TOT-SUB). 17430000
205464     MOVE PT-710-NORCPT-MDC-AMT (PV-TOT-SUB)                      17440000
205464                                 TO DD-MARKDOWN-CANCEL-AMT        17450000
205464                                    DL-MARKDOWN-CANCEL-AMT.       17460000
205464     ADD PT-710-NORCPT-MDC-AMT (PV-TOT-SUB)                       17470000
205464                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17480000
205464                                                    (PV-TOT-SUB). 17490000
205464     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17500000
205464     MOVE PC-NON-REC-RETURN    TO DL-PRICE-CHANGE-TYPE.           17510000
205464     PERFORM 8200-WRITE-DETAIL-LINE.                              17520000
168600                                                                  17530000
168700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17540000
168800     SET DD-PC-GFT-RCPT-RTRN     TO TRUE.                         17550000
168900     MOVE PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)                       17560000
169000                                 TO DD-MARKDOWN-QTY               17570000
169100                                    DL-MARKDOWN-QTY.              17580000
169200     ADD PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)                        17590000
169300                                 TO PT-TOTAL-MARKDOWN-QTY         17600000
169400                                                    (PV-TOT-SUB). 17610000
169500     MOVE PT-765-GIFT-MKDN-AMT (PV-TOT-SUB)                       17620000
169600                                 TO DD-MARKDOWN-AMT               17630000
169700                                    DL-MARKDOWN-AMT.              17640000
169800     ADD PT-765-GIFT-MKDN-AMT (PV-TOT-SUB)                        17650000
169900                                 TO PT-TOTAL-MARKDOWN-AMT         17660000
170000                                                    (PV-TOT-SUB). 17670000
170100     MOVE PT-765-GIFT-MDC-QTY (PV-TOT-SUB)                        17680000
170200                                 TO DD-MARKDOWN-CANCEL-QTY        17690000
170300                                    DL-MARKDOWN-CANCEL-QTY.       17700000
170400     ADD PT-765-GIFT-MDC-QTY (PV-TOT-SUB)                         17710000
170500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  17720000
170600                                                    (PV-TOT-SUB). 17730000
170700     MOVE PT-765-GIFT-MDC-AMT (PV-TOT-SUB)                        17740000
170800                                 TO DD-MARKDOWN-CANCEL-AMT        17750000
170900                                    DL-MARKDOWN-CANCEL-AMT.       17760000
171000     ADD PT-765-GIFT-MDC-AMT (PV-TOT-SUB)                         17770000
171100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  17780000
171200                                                    (PV-TOT-SUB). 17790000
171300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             17800000
171400     MOVE PC-GIFT-RCPT-RETURN    TO DL-PRICE-CHANGE-TYPE.         17810000
171500     PERFORM 8200-WRITE-DETAIL-LINE.                              17820000
171600                                                                  17830000
171700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            17840000
171800     SET DD-PC-BOGO              TO TRUE.                         17850000
171900     MOVE PT-BOGO-MKDN-QTY (PV-TOT-SUB)                           17860000
172000                                 TO DD-MARKDOWN-QTY               17870000
172100                                    DL-MARKDOWN-QTY.              17880000
172200     ADD PT-BOGO-MKDN-QTY (PV-TOT-SUB)                            17890000
172300                                 TO PT-TOTAL-MARKDOWN-QTY         17900000
172400                                                    (PV-TOT-SUB). 17910000
172500     MOVE PT-BOGO-MKDN-AMT (PV-TOT-SUB)                           17920000
172600                                 TO DD-MARKDOWN-AMT               17930000
172700                                    DL-MARKDOWN-AMT.              17940000
172800     ADD PT-BOGO-MKDN-AMT (PV-TOT-SUB)                            17950000
172900                                 TO PT-TOTAL-MARKDOWN-AMT         17960000
173000                                                    (PV-TOT-SUB). 17970000
173100     MOVE PT-BOGO-MDC-QTY (PV-TOT-SUB)                            17980000
173200                                 TO DD-MARKDOWN-CANCEL-QTY        17990000
173300                                    DL-MARKDOWN-CANCEL-QTY.       18000000
173400     ADD PT-BOGO-MDC-QTY (PV-TOT-SUB)                             18010000
173500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18020000
173600                                                    (PV-TOT-SUB). 18030000
173700     MOVE PT-BOGO-MDC-AMT (PV-TOT-SUB)                            18040000
173800                                 TO DD-MARKDOWN-CANCEL-AMT        18050000
173900                                    DL-MARKDOWN-CANCEL-AMT.       18060000
174000     ADD PT-BOGO-MDC-AMT (PV-TOT-SUB)                             18070000
174100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18080000
174200                                                    (PV-TOT-SUB). 18090000
174300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18100000
174400     MOVE PC-BOGO                TO DL-PRICE-CHANGE-TYPE.         18110000
174500     PERFORM 8200-WRITE-DETAIL-LINE.                              18120000
174600                                                                  18130000
174700     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18140000
174800     SET DD-PC-UNEARNED-REWARDS  TO TRUE.                         18150000
174900     MOVE PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)                  18160000
175000                                 TO DD-MARKDOWN-QTY               18170000
175100                                    DL-MARKDOWN-QTY.              18180000
175200     ADD PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)                   18190000
175300                                 TO PT-TOTAL-MARKDOWN-QTY         18200000
175400                                                    (PV-TOT-SUB). 18210000
175500     MOVE PT-UNEARNED-RWDS-MKDN-AMT (PV-TOT-SUB)                  18220000
175600                                 TO DD-MARKDOWN-AMT               18230000
175700                                    DL-MARKDOWN-AMT.              18240000
175800     ADD PT-UNEARNED-RWDS-MKDN-AMT (PV-TOT-SUB)                   18250000
175900                                 TO PT-TOTAL-MARKDOWN-AMT         18260000
176000                                                    (PV-TOT-SUB). 18270000
176100     MOVE PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)                   18280000
176200                                 TO DD-MARKDOWN-CANCEL-QTY        18290000
176300                                    DL-MARKDOWN-CANCEL-QTY.       18300000
176400     ADD PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)                    18310000
176500                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18320000
176600                                                    (PV-TOT-SUB). 18330000
176700     MOVE PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)                   18340000
176800                                 TO DD-MARKDOWN-CANCEL-AMT        18350000
176900                                    DL-MARKDOWN-CANCEL-AMT.       18360000
177000     ADD PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)                    18370000
177100                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18380000
177200                                                    (PV-TOT-SUB). 18390000
177300     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18400000
177400     MOVE PC-UNEARNED-REWARDS    TO DL-PRICE-CHANGE-TYPE.         18410000
177500     PERFORM 8200-WRITE-DETAIL-LINE.                              18420000
177600                                                                  18430000
177700                                                                  18440000
177800     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18450000
177900     SET DD-PC-EMPLY-DISCOUNT    TO TRUE.                         18460000
178000     MOVE PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)                     18470000
178100                                 TO DD-MARKDOWN-QTY               18480000
178200                                    DL-MARKDOWN-QTY.              18490000
178300     ADD PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)                      18500000
178400                                 TO PT-TOTAL-MARKDOWN-QTY         18510000
178500                                                    (PV-TOT-SUB). 18520000
178600     MOVE PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)                     18530000
178700                                 TO DD-MARKDOWN-AMT               18540000
178800                                    DL-MARKDOWN-AMT.              18550000
178900     ADD PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)                      18560000
179000                                 TO PT-TOTAL-MARKDOWN-AMT         18570000
179100                                                    (PV-TOT-SUB). 18580000
179200     MOVE PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)                      18590000
179300                                 TO DD-MARKDOWN-CANCEL-QTY        18600000
179400                                    DL-MARKDOWN-CANCEL-QTY.       18610000
179500     ADD PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)                       18620000
179600                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18630000
179700                                                    (PV-TOT-SUB). 18640000
179800     MOVE PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)                      18650000
179900                                 TO DD-MARKDOWN-CANCEL-AMT        18660000
180000                                    DL-MARKDOWN-CANCEL-AMT.       18670000
180100     ADD PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)                       18680000
180200                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18690000
180300                                                    (PV-TOT-SUB). 18700000
180400     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18710000
180500     MOVE PC-EMPLY-DISCOUNT      TO DL-PRICE-CHANGE-TYPE.         18720000
180600     PERFORM 8200-WRITE-DETAIL-LINE.                              18730000
180700                                                                  18740000
262807     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18740133
262807     SET DD-PC-SEPHORA-DISCOUNT TO TRUE.                          18741033
262807     MOVE PT-720-SEPHORA-MKDN-QTY (PV-TOT-SUB)                    18742033
262807                                 TO DD-MARKDOWN-QTY               18743033
262807                                    DL-MARKDOWN-QTY.              18744033
262807     ADD PT-720-SEPHORA-MKDN-QTY (PV-TOT-SUB)                     18745033
262807                                 TO PT-TOTAL-MARKDOWN-QTY         18746033
262807                                                    (PV-TOT-SUB). 18747033
262807     MOVE PT-720-SEPHORA-MKDN-AMT (PV-TOT-SUB)                    18748033
262807                                 TO DD-MARKDOWN-AMT               18749033
262807                                    DL-MARKDOWN-AMT.              18749133
262807     ADD PT-720-SEPHORA-MKDN-AMT (PV-TOT-SUB)                     18749233
262807                                 TO PT-TOTAL-MARKDOWN-AMT         18749333
262807                                                    (PV-TOT-SUB). 18749433
262807     MOVE PT-720-SEPHORA-MDC-QTY (PV-TOT-SUB)                     18749533
262807                                 TO DD-MARKDOWN-CANCEL-QTY        18749633
262807                                    DL-MARKDOWN-CANCEL-QTY.       18749733
262807     ADD PT-720-SEPHORA-MDC-QTY (PV-TOT-SUB)                      18749833
262807                                 TO PT-TOTAL-MARKDOWN-CANCEL-QTY  18749933
262807                                                    (PV-TOT-SUB). 18750033
262807     MOVE PT-720-SEPHORA-MDC-AMT (PV-TOT-SUB)                     18750133
262807                                 TO DD-MARKDOWN-CANCEL-AMT        18750233
262807                                    DL-MARKDOWN-CANCEL-AMT.       18750333
262807     ADD PT-720-SEPHORA-MDC-AMT (PV-TOT-SUB)                      18750433
262807                                 TO PT-TOTAL-MARKDOWN-CANCEL-AMT  18750533
262807                                                    (PV-TOT-SUB). 18750633
262807     DISPLAY '  '  DD-DISPLAY-DETAIL.                             18750733
262807     MOVE PC-SEPHORA-DISCOUNT TO DL-PRICE-CHANGE-TYPE.            18750833
262807     PERFORM 8200-WRITE-DETAIL-LINE.                              18750933
262807                                                                  18751033
180900     DISPLAY ' '.                                                 18760000
181000     MOVE SPACES TO DD-DISPLAY-DETAIL.                            18770000
181100     SET DD-PC-TOTAL TO TRUE.                                     18780000
181200     MOVE PT-TOTAL-MARKDOWN-QTY (PV-TOT-SUB)                      18790000
181300                                 TO DD-MARKDOWN-QTY               18800000
181400                                    DL-MARKDOWN-QTY.              18810000
181500     MOVE PT-TOTAL-MARKDOWN-AMT (PV-TOT-SUB)                      18820000
181600                                 TO DD-MARKDOWN-AMT               18830000
181700                                    DL-MARKDOWN-AMT.              18840000
181800     MOVE PT-TOTAL-MARKDOWN-CANCEL-QTY (PV-TOT-SUB)               18850000
181900                                 TO DD-MARKDOWN-CANCEL-QTY        18860000
182000                                    DL-MARKDOWN-CANCEL-QTY.       18870000
182100     MOVE PT-TOTAL-MARKDOWN-CANCEL-AMT (PV-TOT-SUB)               18880000
182200                                 TO DD-MARKDOWN-CANCEL-AMT        18890000
182300                                    DL-MARKDOWN-CANCEL-AMT.       18900000
182400     MOVE PT-TOTAL-MARKUP-QTY (PV-TOT-SUB)                        18910000
182500                                 TO DD-MARKUP-QTY                 18920000
182600                                    DL-MARKUP-QTY.                18930000
182700     MOVE PT-TOTAL-MARKUP-AMT (PV-TOT-SUB)                        18940000
182800                                 TO DD-MARKUP-AMT                 18950000
182900                                    DL-MARKUP-AMT.                18960000
183000     MOVE PT-TOTAL-MARKUP-CANCEL-QTY (PV-TOT-SUB)                 18970000
183100                                 TO DD-MARKUP-CANCEL-QTY          18980000
183200                                    DL-MARKUP-CANCEL-QTY.         18990000
183300     MOVE PT-TOTAL-MARKUP-CANCEL-AMT (PV-TOT-SUB)                 19000000
183400                                 TO DD-MARKUP-CANCEL-AMT          19010000
183500                                    DL-MARKUP-CANCEL-AMT.         19020000
183600                                                                  19030000
183700     DISPLAY '  '  DD-DISPLAY-DETAIL.                             19040000
183800     MOVE PC-TOTAL TO DL-PRICE-CHANGE-TYPE.                       19050000
183900     PERFORM 8200-WRITE-DETAIL-LINE.                              19060000
184000                                                                  19070000
184100     DISPLAY '  '.                                                19080000
184200     SET TD-NON-OWNED-DROPPED-ID TO TRUE.                         19090000
184300     MOVE PT-NON-OWNED-DROPPED (PV-TOT-SUB) TO TD-TOTAL-AMOUNT.   19100000
184400     DISPLAY PC-CURRENT-PROGRAM-NAME  ' - '                       19110000
184500               TD-TOTAL-DISPLAY-MESSAGE.                          19120000
184600     PERFORM 8300-WRITE-NON-OWNED.                                19130000
184700                                                                  19140000
184800******************************************************************19150000
184900 2000-OPEN-TRAN-CURSOR.                                           19160000
185000*     OPEN TRANSACTION CURSOR.                                    19170000
185100******************************************************************19180000
185200                                                                  19190000
185300     EXEC SQL                                                     19200000
185400          OPEN TEPTRN-CURSOR                                      19210000
185500     END-EXEC.                                                    19220000
185600                                                                  19230000
185700     EVALUATE TRUE                                                19240000
185800        WHEN SQLCODE = ZERO                                       19250000
185900           CONTINUE                                               19260000
186000        WHEN OTHER                                                19270000
186100           MOVE '2000-OPEN-TRAN-CURSOR'                           19280000
186200                                      TO PV-PARAGRAPH-NAME        19290000
186300           SET AC-DB2-ERROR           TO TRUE                     19300000
186400           PERFORM 9999-ABEND                                     19310000
186500     END-EVALUATE.                                                19320000
186600                                                                  19330000
186700******************************************************************19340000
186800 2200-FETCH-TRAN-CURSOR.                                          19350000
186900*     FETCH TRANSACTION CURSOR.                                   19360000
187000******************************************************************19370000
187100     EXEC SQL                                                     19380000
187200         FETCH TEPTRN-CURSOR                                      19390000
187300          INTO :EPTRN-PARTN-NBR                                   19400000
187400              ,:EPTRN-STR-NBR                                     19410000
187500              ,:EPTRN-RGST-ID                                     19420000
187600              ,:EPTRN-TRN-NBR                                     19430000
187700              ,:EPTRN-STRT-TM                                     19440000
187800              ,:EPTRN-SLS-CORR-SEQ-NBR                            19450000
187900              ,:EPTRN-TRN-STAT-CDE                                19460000
188000              ,:EPTRN-SLS-DTE                                     19470000
BOSSCL              ,:EPTRN-TRN-DTE                                     19471001
011618              ,:EPTRN-POS-CPBL-LVL-NBR                            19480000
188100              ,:EPTRN-CRE-TMST                                    19490000
BOSSCL              ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                     19500000
BOSSCL               :PV-OMNI-CHNL-TYP-CDE-NULL-IND                     19510000
BOSSC2              ,:PV-TRANSFER-DATE                                  19511013
188200     END-EXEC.                                                    19520000
188300                                                                  19530000
188400     EVALUATE TRUE                                                19540000
188500        WHEN SQLCODE = ZERO                                       19550000
BOSSCL           IF PV-OMNI-CHNL-TYP-CDE-NULL-IND = -1                  19551001
BOSSCL              MOVE SPACES TO EPTRN-OMNI-CHNL-FFLMT-TYP-CDE        19552001
BOSSCL           END-IF                                                 19553001
188600           MOVE EPTRN-PARTN-NBR       TO  PV-PARTN-NBR            19560000
188700           MOVE EPTRN-STR-NBR         TO  PV-STR-NBR              19570000
188800           MOVE EPTRN-RGST-ID         TO  PV-RGST-ID              19580000
188900           MOVE EPTRN-TRN-NBR         TO  PV-TRN-NBR              19590000
189000           MOVE EPTRN-STRT-TM         TO  PV-STRT-TM              19600000
189100           MOVE EPTRN-SLS-CORR-SEQ-NBR                            19610000
189200                                      TO  PV-SLS-CORR-SEQ-NBR     19620000
189300           MOVE ZERO                  TO PV-FISC-PERIOD-NBR-HOLD  19630000
189400           PERFORM 1117-CALCU-KOHLS-MONTH                         19640000
189500                                                                  19650000
189600           PERFORM 2500-OPEN-ITEM-CURSOR                          19660000
189700           PERFORM 2600-FETCH-ITEM-CURSOR                         19670000
189800              UNTIL PS-END-OF-ITEM-YES                            19680000
189900           PERFORM 2700-CLOSE-ITEM-CURSOR                         19690000
190000           ADD 1                      TO WS-CMT-CNT               19700000
190100                                                                  19710000
190200        WHEN SQLCODE = PC-ROW-NOT-FOUND                           19720000
190300           SET PS-END-OF-TRAN-YES     TO TRUE                     19730000
190400        WHEN OTHER                                                19740000
190500           MOVE '2200-FETCH-TRAN-CURSOR'                          19750000
190600                                      TO PV-PARAGRAPH-NAME        19760000
190700           SET AC-DB2-ERROR           TO TRUE                     19770000
190800           PERFORM 9999-ABEND                                     19780000
190900     END-EVALUATE.                                                19790000
191000                                                                  19800000
191100     IF WS-CMT-CNT > 2000                                         19810000
191200       PERFORM 8999-COMMIT-PARA                                   19820000
191300       MOVE ZEROS                         TO WS-CMT-CNT           19830000
191400     END-IF.                                                      19840000
191500                                                                  19850000
191600******************************************************************19860000
191700 2400-CLOSE-TRAN-CURSOR.                                          19870000
191800*     CLOSE TRANSACTION CURSOR.                                   19880000
191900******************************************************************19890000
192000                                                                  19900000
192100     EXEC SQL                                                     19910000
192200          CLOSE TEPTRN-CURSOR                                     19920000
192300     END-EXEC.                                                    19930000
192400                                                                  19940000
192500     EVALUATE TRUE                                                19950000
192600        WHEN SQLCODE = ZERO                                       19960000
192700           CONTINUE                                               19970000
192800        WHEN OTHER                                                19980000
192900           MOVE '2400-CLOSE-TRAN-CURSOR'                          19990000
193000                                      TO PV-PARAGRAPH-NAME        20000000
193100           SET AC-DB2-ERROR           TO TRUE                     20010000
193200           PERFORM 9999-ABEND                                     20020000
193300     END-EVALUATE.                                                20030000
193400                                                                  20040000
BOSSC3******************************************************************20041016
BOSSC3 2450-SELECT-ORDER-NUMBER.                                        20042016
BOSSC3*     CHECK IF ORDER NUMBER FOUND                                 20043016
BOSSC3******************************************************************20044016
BOSSC3                                                                  20045016
BOSSC3     EXEC SQL                                                     20048016
BOSSC3        SELECT  ORD_NBR                                           20049016
BOSSC3          INTO :EPORD-ORD-NBR                                     20049116
BOSSC3          FROM  TEPORD                                            20049216
BOSSC3         WHERE  PARTN_NBR        = :PV-PARTN-NBR                  20049316
BOSSC3           AND  STR_NBR          = :PV-STR-NBR                    20049416
BOSSC3           AND  RGST_ID          = :PV-RGST-ID                    20049516
BOSSC3           AND  TRN_NBR          = :PV-TRN-NBR                    20049616
BOSSC3           AND  STRT_TM          = :PV-STRT-TM                    20049716
BOSSC3           AND  SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           20049816
BOSSC3                WITH UR                                           20049916
BOSSC3     END-EXEC.                                                    20050016
BOSSC3                                                                  20050116
BOSSC3     EVALUATE TRUE                                                20050216
BOSSC3        WHEN SQLCODE = ZERO                                       20050316
BOSSC3           MOVE EPORD-ORD-NBR-TEXT     TO PV-EPORD-ORD-NBR        20050416
BOSSC3           DISPLAY 'ORDER NBR = '         PV-EPORD-ORD-NBR        20050516
BOSSC3        WHEN SQLCODE = PC-ROW-NOT-FOUND                           20050616
BOSSC3           MOVE SPACES                 TO PV-EPORD-ORD-NBR        20050716
BOSSC3           DISPLAY 'ORDER NBR NOT FOUND'                          20050816
BOSSC3        WHEN OTHER                                                20051016
BOSSC3           MOVE '2450-SELECT-ORDER-NUMBER '                       20051116
BOSSC3                                        TO PV-PARAGRAPH-NAME      20051216
BOSSC3           SET AC-DB2-ERROR           TO TRUE                     20051316
BOSSC3           PERFORM 9999-ABEND                                     20051416
BOSSC3     END-EVALUATE.                                                20051516
BOSSC3                                                                  20051616
193500******************************************************************20052000
193600 2500-OPEN-ITEM-CURSOR.                                           20060000
193700*     OPEN ITEM CURSOR.                                           20070000
193800******************************************************************20080000
193900                                                                  20090000
194000     EXEC SQL                                                     20100000
194100          OPEN TEPITM-CURSOR                                      20110000
194200     END-EXEC.                                                    20120000
194300                                                                  20130000
194400     EVALUATE TRUE                                                20140000
194500        WHEN SQLCODE = ZERO                                       20150000
194600           SET PS-END-OF-ITEM-NO      TO TRUE                     20160000
194700        WHEN OTHER                                                20170000
194800           MOVE '2500-OPEN-ITEM-CURSOR' TO PV-PARAGRAPH-NAME      20180000
194900           SET AC-DB2-ERROR           TO TRUE                     20190000
195000           PERFORM 9999-ABEND                                     20200000
195100     END-EVALUATE.                                                20210000
195200                                                                  20220000
195300******************************************************************20230000
195400 2600-FETCH-ITEM-CURSOR.                                          20240000
195500*     FETCH ITEMS FROM TEPITM TABLE.                              20250000
195600******************************************************************20260000
195700                                                                  20270000
195800     EXEC SQL                                                     20280000
195900          FETCH TEPITM-CURSOR                                     20290000
196000           INTO :EPITM-LNE-ITM-SEQ-NBR                            20300000
196100               ,:EPITM-LIV-RSLU-CDE                               20310000
196200               ,:EPITM-DEPT-NBR                                   20320000
196300               ,:EPITM-SUB-CL-NBR                                 20330000
196400               ,:EPITM-SLD-QTY                                    20340000
196500               ,:EPITM-NET-CHRGD-AMT                              20350000
196600               ,:EPITM-SAL-TYP-CDE                                20360000
196700               ,:EPITM-SAL-RET-CDE                                20370000
196800               ,:EPITM-DEPT-CL-ERR-CDE                            20380000
196900               ,:EPITM-SKU-ERR-CDE                                20390000
197000               ,:EPITM-PRIC-SRC-CDE                               20400000
197100               ,:EPITM-CUST-CHRGD-AMT                             20410000
197200               ,:EPITM-REG-RTL-AMT                                20420000
197300               ,:EPITM-ADITEM-NBR                                 20430000
197400               ,:EPITM-UNT-COST-AMT                               20440000
197500               ,:EPITM-OWND-UNT-RTL-AMT                           20450000
197600               ,:EPITM-OWNSHP-CDE                                 20460000
197700               ,:EPITM-REG-RTL-ORGN-CDE                           20470000
197800               ,:EPITM-SKU-NBR                                    20480000
197900               ,:EPITM-MAJ-CL-NBR                                 20490000
198000               ,:EPITM-PROMO-INTFC-ID                             20500000
214615               ,:EPITM-PROMO-SCHM-CDE                             20510000
198100               ,:EPITM-OWND-UNT-RTL-ORIG-AMT                      20520000
198200                :PV-ORIG-OWND-UNT-AMT-NULL-IND                    20530000
198300               ,:EPITM-ITM-STAT-CDE                               20540000
214615               ,:EPITM-ORIG-SAL-TYP-CDE                           20550000
214615               ,:EPITM-ORIG-REG-RTL-AMT                           20560000
198400     END-EXEC.                                                    20570000
198500                                                                  20580000
198600     EVALUATE TRUE                                                20590000
198700        WHEN SQLCODE = ZERO                                       20600000
198800           PERFORM 2800-SCREEN-ITEM                               20610000
198900        WHEN SQLCODE = PC-ROW-NOT-FOUND                           20620000
199000           SET PS-END-OF-ITEM-YES     TO TRUE                     20630000
199100        WHEN OTHER                                                20640000
199200           MOVE '2600-FETCH-ITEM-CURSOR'                          20650000
199300                                      TO PV-PARAGRAPH-NAME        20660000
199400           SET AC-DB2-ERROR           TO TRUE                     20670000
199500           PERFORM 9999-ABEND                                     20680000
199600     END-EVALUATE.                                                20690000
199700                                                                  20700000
199800******************************************************************20710000
199900 2700-CLOSE-ITEM-CURSOR.                                          20720000
200000*     CLOSE ITEM CURSOR.                                          20730000
200100******************************************************************20740000
200200                                                                  20750000
200300     EXEC SQL                                                     20760000
200400          CLOSE TEPITM-CURSOR                                     20770000
200500     END-EXEC.                                                    20780000
200600                                                                  20790000
200700     EVALUATE TRUE                                                20800000
200800        WHEN SQLCODE = ZERO                                       20810000
200900           CONTINUE                                               20820000
201000        WHEN OTHER                                                20830000
201100           MOVE '2700-CLOSE-ITEM-CURSOR'                          20840000
201200                                            TO PV-PARAGRAPH-NAME  20850000
201300           SET AC-DB2-ERROR           TO TRUE                     20860000
201400           PERFORM 9999-ABEND                                     20870000
201500     END-EVALUATE.                                                20880000
201600                                                                  20890000
201700******************************************************************20900000
201800 2800-SCREEN-ITEM.                                                20910000
201900*     FILTER ITEMS. EXCLUDE SALES CORRECTIONS, EVEN EXCHANGES,    20920000
202000*     RESOLVED LINE ITEM VOIDS, AND GOLDSTAR ITEMS.               20930000
202100******************************************************************20940000
202200                                                                  20950000
202300     INITIALIZE ML017-PRICE-CHANGE-RECORD.                        20960000
202400                                                                  20970000
202500     MOVE EPITM-LNE-ITM-SEQ-NBR TO   PV-LNE-ITM-SEQ-NBR.          20980000
202600                                                                  20990000
202700     EVALUATE TRUE                                                21000000
202800        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-ORIGINAL                21010000
202900        WHEN EPITM-LIV-RSLU-CDE = PC-RSLV-VOID                    21020000
203000        WHEN EPITM-DEPT-NBR = PC-GIFT-CARD                        21030000
SEPHOR        WHEN EPITM-DEPT-NBR = PC-SEPHORA-GIFT-CARD-712            21031034
203100        WHEN EPITM-DEPT-NBR = PC-THIRD-PARTY-CARD-833             21040000
203200        WHEN EPITM-DEPT-NBR = PC-THIRD-PARTY-CARD-834             21050000
MKTPLC        WHEN EPITM-DEPT-NBR = PC-MKTPLACE-DEPT-985                21060000
203300           CONTINUE                                               21070000
203400                                                                  21080000
203500        WHEN EPITM-OWNSHP-CDE = PC-NON-OWNED                      21090000
203600        WHEN EPITM-OWNSHP-CDE = PC-NON-OWNED-TRACKED              21100000
203700           IF EPTRN-TRN-STAT-CDE = PC-CORRECTION                  21110000
203800              IF DPG55-DB2-ISO-DATE-FMT LESS THAN                 21120000
203900                 PV-CUT-OFF-CCYY-MM-DD                            21130000
204000                 MOVE 4  TO PV-TOT-SUB                            21140000
204100              ELSE                                                21150000
204200                 MOVE 2  TO PV-TOT-SUB                            21160000
204300              END-IF                                              21170000
204400           END-IF                                                 21180000
204500                                                                  21190000
204600           IF EPTRN-TRN-STAT-CDE = PC-LATE                        21200000
204700              IF DPG55-DB2-ISO-DATE-FMT LESS THAN                 21210000
204800                 PV-CUT-OFF-CCYY-MM-DD                            21220000
204900                 MOVE 5  TO PV-TOT-SUB                            21230000
205000              ELSE                                                21240000
205100                 MOVE 3  TO PV-TOT-SUB                            21250000
205200              END-IF                                              21260000
205300           END-IF                                                 21270000
205400                                                                  21280000
205500           IF DPG55-DB2-ISO-DATE-FMT NOT LESS THAN                21290000
205600              PV-CUT-OFF-CCYY-MM-DD                               21300000
205700              MOVE 1  TO PV-TOT-SUB                               21310000
205800           END-IF                                                 21320000
205900                                                                  21330000
206000           ADD +1 TO PT-NON-OWNED-DROPPED (PV-TOT-SUB)            21340000
206100                                                                  21350000
206200        WHEN OTHER                                                21360000
206300           IF (EPITM-NET-CHRGD-AMT > ZERO AND                     21370000
206400               EPITM-CUST-CHRGD-AMT < ZERO) OR                    21380000
206500              (EPITM-NET-CHRGD-AMT < ZERO AND                     21390000
206600               EPITM-CUST-CHRGD-AMT > ZERO)                       21400000
206700               DISPLAY 'TRANSACTION WITH OPPOSING SIGNS DETECTED' 21410000
206800               DISPLAY ' PARTN   ' EPTRN-PARTN-NBR                21420000
206900                       ' STORE   ' EPTRN-STR-NBR                  21430000
207000                       ' RGST    ' EPTRN-RGST-ID                  21440000
207100                       ' TRAN    ' EPTRN-TRN-NBR                  21450000
207200                       ' ITEM #  ' EPITM-LNE-ITM-SEQ-NBR          21460000
207300           ELSE                                                   21470000
207400              PERFORM 2900-PROCESS-ITEM                           21480000
207500           END-IF                                                 21490000
207600     END-EVALUATE.                                                21500000
207700                                                                  21510000
207800******************************************************************21520000
207900 2900-PROCESS-ITEM.                                               21530000
208000*    DIRECT THE FLOW OF AN ITEM.                                  21540001
BOSSC2*                                                                 21550013
BOSSC2*    IF THE ITEM IS FOR A BOSS ORDER AND THERE WAS A PRICE CHANGE 21560013
BOSSC2*    - GET ECOM'S ACTIVE PRICE ON THE ECOM ORDER DATE AND         21570013
BOSSC2*    THE TRANSFER DATE.   IF THERE IS A DIFFERENCE, CALCULATE     21571013
BOSSC2*    AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE.                  21572013
BOSSC2*                                                                 21573013
BOSSC2*    IF THE ITEM IS FOR AN SFS OR BOPUS ORDER THAT WAS NOT ON     21574013
BOSSC2*    CLEARANCE AND THERE WAS A PRICE CHANGE -                     21574113
BOSSC2*    CALCULATE AN OWNERSHIP ADJUSTMENT FOR THE DIFFERENCE         21574213
BOSSC2*    BETWEEN ECOM'S ACTIVE PRICE ON THE ECOM ORDER DATE AND       21574313
BOSSC2*    THE STORE PRICE ON THE SALES DATE.                           21574413
BOSSCL*                                                                 21574513
BOSSCL*    THEN RESET THE STORE'S OWNED UNIT RTL WITH THE ECOM ORIGINAL 21574601
BOSSCL*    OWNED UNIT RTL AMT SO THAT THE ITEM CAN PROCEED THROUGH THE  21574701
BOSSCL*    REST OF THE LOGIC THAT CALCULATES PROMO MARKDOWNS.           21574801
208100******************************************************************21575000
208200                                                                  21576000
208300     PERFORM 3000-POPULATE-MISC-FIELDS.                           21577000
208400                                                                  21578000
BOSSC3     IF  (PV-ORIG-OWND-UNT-AMT-NULL-IND IS NOT = PC-NULL)         21578118
BOSSC3     AND (EPITM-SAL-RET-CDE = 'S'  OR  EPITM-SAL-RET-CDE = 'A')   21578218
BOSSC2         IF (EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BOS')               21580013
BOSSC2         OR ((EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BPS' OR 'SFS') AND 21590013
BOSSC2              EPITM-ITM-STAT-CDE IS NOT = '30')                   21600013
BOSSC2             PERFORM 2910-OMNI-OWNERSHIP-ADJ                      21610013
BOSSCL                                                                  21623700
BOSSCL* AFTER OWNERSHIP ADJ IS GENERATED, FLIP THE RETAIL AMOUNT AND    21623800
BOSSCL* ORIGINAL RETAIL AMOUNTS FOR THE REST OF THE PROCESSING.         21623900
BOSSCL* ALSO NEED TO SET ML017-PC-DIFFER-AMT TO ZEROES OR IT WILL       21624000
BOSSCL* BE PICKED UP BY PARA 4000- BELOW.                               21625000
BOSSCL             MOVE EPITM-OWND-UNT-RTL-ORIG-AMT  TO                 21625113
BOSSCL                  PV-OWND-UNT-RTL-ORIG-AMT                        21625213
BOSSCL             MOVE EPITM-OWND-UNT-RTL-AMT       TO                 21625313
BOSSCL                  EPITM-OWND-UNT-RTL-ORIG-AMT                     21625413
BOSSCL             MOVE PV-OWND-UNT-RTL-ORIG-AMT     TO                 21625513
BOSSCL                  EPITM-OWND-UNT-RTL-AMT                          21625613
BOSSCL             MOVE ZEROES  TO  ML017-PC-DIFFER-AMT                 21625713
BOSSCL                                                                  21625813
BOSSC2         END-IF                                                   21625913
BOSSCL     END-IF.                                                      21626000
                                                                        21626100
208500     PERFORM 3001-CHECK-DISCOUNT.                                 21627000
208600                                                                  21628000
208700     MOVE ZERO                        TO PV-CUST-CHRGD-AMT        21629000
208800                                         PV-EXTENDED-AMT          21630000
208900                                         PV-EXCLUDE-LID-AMT       21640000
209000                                         PV-PRICE-CHANGE-AMOUNT.  21650000
209100     MOVE EPITM-CUST-CHRGD-AMT        TO PV-CUST-CHRGD-AMT.       21660000
209200                                                                  21670000
209300     IF EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G OR                      21680000
209400        EPTRN-TRN-STAT-CDE = PC-CORRECTION OR                     21690000
209500        EPTRN-TRN-STAT-CDE = PC-REVERSAL                          21700000
209600        PERFORM 4100-OPEN-LID-CURSOR                              21710000
209700        PERFORM 4200-FETCH-LID-CURSOR                             21720000
209800           UNTIL PS-END-OF-LID-YES                                21730000
209900        PERFORM 4300-CLOSE-LID-CURSOR                             21740000
210000                                                                  21750000
210100* PROCESS MARKDOWNS FOR SALE CORRECTIONS BYPASS DUMMY SKUS        21760000
210200        MOVE EPITM-CUST-CHRGD-AMT TO PV-ITM-CUST-CHRGD-AMT        21770000
210300        MOVE EPITM-REG-RTL-AMT    TO PV-ITM-REG-RTL-AMT           21780000
210400                                                                  21790000
210500        IF EPTRN-TRN-STAT-CDE = PC-CORRECTION OR                  21800000
210510           EPTRN-TRN-STAT-CDE = PC-REVERSAL                       21810000
210600           IF PV-SKU-LST-3-DGT NOT = '000'                        21820000
210700              IF PV-ITM-CUST-CHRGD-AMT NOT = PV-ITM-REG-RTL-AMT   21830000
210800                 IF (EPITM-SAL-RET-CDE = 'S'                      21840000
210900                 OR  EPITM-SAL-RET-CDE = 'A')                     21850000
211000                     PERFORM 3950-SALE-CORRECTION-MARKDOWN        21860000
211100                 ELSE                                             21870000
211200                     PERFORM 3650-MARKDOWN-CORR-CANCEL            21880000
211300                 END-IF                                           21890000
211400              END-IF                                              21900000
211500           END-IF                                                 21910000
211600        END-IF                                                    21920000
211700                                                                  21930000
211800     ELSE                                                         21940000
211900        IF EPITM-SAL-RET-CDE = 'R' OR                             21950000
212000           EPITM-SAL-RET-CDE = 'B'                                21960000
212100              PERFORM 3100-RETURN-ITEM-MARKDOWN                   21970000
212200              PERFORM 4000-PROCESS-MARKDOWN-MARKUP                21980000
212300              PERFORM 4100-OPEN-LID-CURSOR                        21990000
212400              PERFORM 4200-FETCH-LID-CURSOR                       22000000
212500                 UNTIL PS-END-OF-LID-YES                          22010000
212600              PERFORM 4300-CLOSE-LID-CURSOR                       22020000
212700        END-IF                                                    22030000
212800                                                                  22040000
212900        IF (EPITM-SAL-RET-CDE = 'S' OR                            22050000
213000            EPITM-SAL-RET-CDE = 'A') AND                          22060000
213100            EPITM-LIV-RSLU-CDE = '-'                              22070000
213200            PERFORM 3300-CALC-EXTENDED-AMT                        22080000
213300            IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                22090000
213400******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     22100000
213500******* BEING PROCESSED AS MARKUPS.                               22110000
213600               IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND            22120000
213700                  EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO           22130000
213800                  PERFORM 3400-MARKUP-CANCEL                      22140000
213900               END-IF                                             22150000
214000            ELSE                                                  22160000
214100               IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT             22170000
214200                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              22180000
226892                  OR EPITM-PROMO-SCHM-CDE NOT = ZERO              22190000
214300                     PERFORM 3500-PROMO-MARKDOWN-CANCEL           22200000
214400                  ELSE                                            22210000
214500                     PERFORM 3600-MARKDOWN-CANCEL                 22220000
214600                  END-IF                                          22230000
214700               END-IF                                             22240000
214800            END-IF                                                22250000
214900                                                                  22260000
215000            PERFORM 4000-PROCESS-MARKDOWN-MARKUP                  22270000
215100                                                                  22280000
215200            PERFORM 4100-OPEN-LID-CURSOR                          22290000
215300            PERFORM 4200-FETCH-LID-CURSOR                         22300000
215400               UNTIL PS-END-OF-LID-YES                            22310000
215500            PERFORM 4300-CLOSE-LID-CURSOR                         22320000
215600        END-IF                                                    22330000
215700                                                                  22340000
215800        IF (EPITM-SAL-RET-CDE = 'S' OR                            22350000
215900            EPITM-SAL-RET-CDE = 'A') AND                          22360000
216000            EPITM-LIV-RSLU-CDE = '+'                              22370000
216100            PERFORM 3300-CALC-EXTENDED-AMT                        22380000
216200            IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                22390000
216300******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     22400000
216400******* BEING PROCESSED AS MARKUPS.                               22410000
216500               IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND            22420000
216600                  EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO           22430000
216700                  IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL      22440000
216800                      PERFORM 3700-SALE-MARKUP                    22450000
216900                  ELSE                                            22460000
217000                      PERFORM 3600-MARKDOWN-CANCEL                22470000
217100                  END-IF                                          22480000
217200               END-IF                                             22490000
217300            ELSE                                                  22500000
217400               IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT             22510000
217500                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              22520000
226892                  OR EPITM-PROMO-SCHM-CDE NOT = ZERO              22530000
217600                     PERFORM 3800-PROMO-MARKDOWN                  22540000
217700                  ELSE                                            22550000
217800                     IF PV-ORIG-OWND-UNT-AMT-NULL-IND = PC-NULL OR22560000
217900                        EPITM-ITM-STAT-CDE = '30'                 22570000
218000                        PERFORM 3900-SALE-MARKDOWN                22580000
218100                     ELSE                                         22590000
218200                        PERFORM 3400-MARKUP-CANCEL                22600000
218300                     END-IF                                       22610000
218400                  END-IF                                          22620000
218500               END-IF                                             22630000
218600            END-IF                                                22640000
218700                                                                  22650000
218800            PERFORM 4000-PROCESS-MARKDOWN-MARKUP                  22660000
218900                                                                  22670000
219000            PERFORM 4100-OPEN-LID-CURSOR                          22680000
219100            PERFORM 4200-FETCH-LID-CURSOR                         22690000
219200               UNTIL PS-END-OF-LID-YES                            22700000
219300            PERFORM 4300-CLOSE-LID-CURSOR                         22710000
219400        END-IF                                                    22720000
219500     END-IF.                                                      22730000
219600                                                                  22740000
BOSSC2******************************************************************22740109
BOSSC2 2910-OMNI-OWNERSHIP-ADJ.                                         22740209
BOSSC2*    REQUIRED WHEN AN OMNI ORDER IS BEING PROCESSED.              22740309
BOSSC2*                                                                 22740409
BOSSC2*    BOSS ORDERS ARE TREATED DIFFERENTLY BECAUSE THEY INVOLVE     22740509
BOSSC2*    INVENTORY TRANSFERS FROM ECOM TO THE STORE.  SINCE THE       22740609
BOSSC2*    CUSTOMER WILL PAY THE STORE THE ECOM PRICE THEY DO NOT       22740709
BOSSC2*    NEED TO ACCOUNT FOR PRICE DIFFERENCES BETWEEN ECOM AND THE   22740809
BOSSC2*    STORE.  THEY ARE CONCERNED ABOUT PRICE CHANGES AT ECOM       22740909
BOSSC2*    BETWEEN THE ORDER DATE AND TRANSFER DATE BECAUSE THE STORE   22741009
BOSSC2*    WILL RECEIVE THE INVENTORY AT THE ECOM PRICE ON THE TRANSFER 22741109
BOSSC2*    DATE.  THESE PRICE CHANGES WILL NEED AN OWNERSHIP ADJUSTMENT 22741209
BOSSC2*    TO BE GENERATED FOR THE STORE.                               22741309
BOSSC2*                                                                 22741409
BOSSC2*    SFS AND BOPUS ORDERS DO NOT INVOLVE INVENTORY TRANSFERS TO   22741509
BOSSC2*    THE STORE.  THEY ARE NOT CONCERNED WITH PRICE CHANGES AT THE 22741609
BOSSC2*    STORE, BUT DO NEED AN OWNERSHIP ADJUSTMENT TO ACCOUNT FOR    22741709
BOSSC2*    PRICE DIFFERENCES BETWEEN ECOM AND THE STORE SINCE THE       22741809
BOSSC2*    CUSTOMER WILL PAY THE STORE THE ECOM PRICE.                  22741909
BOSSC2*                                                                 22742009
BOSSC2*    FOLLOWING TO CHANGE WHEN SAT_BOSS_TRANSFERS TABLE AVAILABLE. 22742109
BOSSC2*    CHECK FOR STORE PRICE FIRST                                  22742209
BOSSC2*    IF STORE PRICE NOT FOUND, CHECK FOR CORP PRICE (LOC ZERO)    22742309
BOSSC2******************************************************************22742409
BOSSC2     DISPLAY 'OMNI PRICE CHG LOGIC HIT FOR : ' PV-PARTN-NBR       22742509
BOSSC2             ' ' PV-STR-NBR ' ' PV-RGST-ID ' ' PV-TRN-NBR         22742609
BOSSC2             ' ' EPTRN-OMNI-CHNL-FFLMT-TYP-CDE.                   22742709
BOSSC2                                                                  22742809
BOSSC2     IF EPTRN-OMNI-CHNL-FFLMT-TYP-CDE = 'BOS'                     22742909
BOSSC2         SET PS-ECOM-PRICE-CHANGE-NO TO TRUE                      22743013
BOSSC3**       PERFORM 2940-CHECK-FOR-ECOM-PRICE-CHG                    22743216
BOSSC3**       PARA'S  2940-, 2942- AND 2944- WILL BE OBSOLETE          22743316
BOSSC3**       COMMENT TEPORD CALL HERE UNTIL OMS PASSES ORDER NUMBER - 22743516
BOSSC3**       ORDER IS ONLY NEEDED ON BOSS ORDERS WITH PRICE CHANGES.  22743616
BOSSC3*        PERFORM 2450-SELECT-ORDER-NUMBER                         22743722
BOSSC3         PERFORM 2930-READ-BOSS-TRANSFER                          22743816
BOSSC2         IF  PS-ECOM-PRICE-CHANGE-YES                             22743916
BOSSC3             PERFORM 2950-CREATE-BOSS-OWNERSHIP-ADJ               22744023
BOSSC2             MOVE ML017-PC-DIFFER-AMT  TO PV-DISPLAY-AMT          22744116
BOSSC3             DISPLAY 'BOSS STORE PRICE CHG - CREATING OWNERSHIP'  22744223
BOSSC2                 ' ADJ FOR '  PV-DISPLAY-AMT                      22744316
BOSSC2         END-IF                                                   22744416
BOSSC2     ELSE                                                         22744516
BOSSC3*        SFS AND BOPUS - COMPARE STORE AND ECOM PRICES            22744623
BOSSC2         IF EPITM-OWND-UNT-RTL-AMT = EPITM-OWND-UNT-RTL-ORIG-AMT  22744716
BOSSC2             CONTINUE                                             22744816
BOSSC2         ELSE                                                     22744916
BOSSC2             PERFORM 2920-SFS-BPS-OWN-ADJ                         22745016
BOSSC2         END-IF                                                   22745116
BOSSC2     END-IF.                                                      22745216
BOSSC2                                                                  22745316
BOSSC2******************************************************************22745416
BOSSC2 2920-SFS-BPS-OWN-ADJ.                                            22745516
BOSSC2*    OWNERSHIP ADJUSTMENT PROCESSING FOR SFS AND BOPUS ORDERS.    22745616
BOSSC2*    THESE ORDERS DO NOT INVOLVE INVENTORY TRANSFERS FROM ECOM    22745716
BOSSC2*    AND ARE HANDLED DIFFERENTLY THAN BOSS ORDERS.                22745816
BOSSC2*    OWNERSHIP ADJUSTMENT MUST REFLECT THE DIFFERENCE BETWEEN     22745916
BOSSC2*    THE ECOM ORDER PRICE AND THE STORE OWNED PRICE AT TIME OF    22746016
BOSSC2*    SALE.                                                        22746116
BOSSC2******************************************************************22746216
BOSSC2                                                                  22746316
BOSSC2     SET ML017-MKDOWN                                             22746416
BOSSC2         ML017-BN-OWN-ADJ                                         22746516
BOSSC2         ML017-RC-MISCELLANEOUS                                   22746616
BOSSC2         ML017-REGISTER-MKDN-MKON     TO TRUE.                    22746716
BOSSC2     MOVE PC-OWN-ADJ-796    TO ML017-PC-MKDN-MKUP-RSN-CDE.        22746816
BOSSC2     COMPUTE ML017-PC-OLD-PR-AMT      =                           22746916
BOSSC2             EPITM-OWND-UNT-RTL-AMT       * EPITM-SLD-QTY.        22747016
BOSSC2     COMPUTE ML017-PC-NEW-PR-AMT      =                           22747116
BOSSC2             EPITM-OWND-UNT-RTL-ORIG-AMT  * EPITM-SLD-QTY.        22747216
BOSSC2     MOVE EPITM-SLD-QTY               TO ML017-PC-QTY.            22747316
BOSSC2                                                                  22747416
BOSSC2     COMPUTE ML017-PC-DIFFER-AMT =                                22747516
BOSSC2             ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT.           22747616
BOSSC2                                                                  22747716
BOSSC2     IF ML017-PC-DIFFER-AMT < 0                                   22747816
BOSSC2*        PRICE DECREASE - GENERATE MARKDOWN CANCEL                22747916
BOSSC2*        LOGIC BELOW COPIED FROM 3600-MARKDOWN-CANCEL             22748016
BOSSC2         SET ML017-MARKDOWN-CANCEL TO TRUE                        22748116
BOSSC2         ADD +1     TO PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)      22748216
BOSSC2         ADD ML017-PC-DIFFER-AMT  TO                              22748316
BOSSC2             PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                22748416
BOSSC2     ELSE                                                         22748516
BOSSC2*        PRICE INCREASE - GENERATE MARKDOWN                       22748616
BOSSC2*        BELOW LOGIC COPIED FROM 3120-CONTINUE-PROCESS            22748716
BOSSC2         SET ML017-MARKDOWN          TO TRUE                      22748816
BOSSC2         ADD +1    TO PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)      22748916
BOSSC2         ADD ML017-PC-DIFFER-AMT     TO                           22749016
BOSSC2             PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)               22749116
BOSSC2     END-IF.                                                      22749216
BOSSC2                                                                  22749316
BOSSC2     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        22749416
BOSSC2                                                                  22749516
BOSSC2     MOVE ML017-PC-DIFFER-AMT  TO PV-DISPLAY-AMT.                 22749616
BOSSC2     DISPLAY 'OMNI STORE PRICE CHG - CREATING OWNERSHIP'          22749716
BOSSC2             ' ADJ FOR '  PV-DISPLAY-AMT.                         22749816
BOSSC2                                                                  22749916
BOSSC3******************************************************************22750016
BOSSC3 2930-READ-BOSS-TRANSFER.                                         22750116
BOSSC3*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED                22750216
BOSSC3*    IF THE TRANSFER IS FOUND AND THE TRANSFER PRICE DOES NOT     22750316
BOSSC3*    MATCH THE ORIGINAL ECOM ORDER PRICE                          22750416
BOSSC3*    (EPITM-OWND-UNT-RTL-ORIG-AMT) SET THE                        22750516
BOSSC3*    PS-ECOM-PRICE-CHANGE-YES SWITCH TO TRUE SO THAT AN           22750616
BOSSC3*    OWNERSHIP ADJUSTMENT WILL BE CREATED.                        22750716
BOSSC3******************************************************************22750816
BOSSC3**   ADD PV-EPORD-ORD-NBR TO WHERE CLAUSE AFTER OMS STARTS        22750916
BOSSC3**   SENDING IT AND IT IS ADDED TO TRANSFER TABLE.                22751016
BOSSC3                                                                  22751116
BOSSC3      EXEC SQL                                                    22751216
BOSSC3         SELECT XFER_SKU_NBR                                      22751316
BOSSC3              , XFER_SHIPPING_STORE                               22751416
BOSSC3              , XFER_RECEIVING_STORE                              22751516
BOSSC3              , XFER_QUANTITY                                     22751616
BOSSC3              , XFER_BATCH_DATE                                   22751716
BOSSC3              , XFER_RETAIL_VALUE                                 22751816
BOSSC3          INTO :SAT00016-XFER-SKU-NBR                             22751916
BOSSC3              ,:SAT00016-XFER-SHIPPING-STORE                      22752016
BOSSC3              ,:SAT00016-XFER-RECEIVING-STORE                     22752116
BOSSC3              ,:SAT00016-XFER-QUANTITY                            22752216
BOSSC3              ,:SAT00016-XFER-BATCH-DATE                          22752316
BOSSC3              ,:SAT00016-XFER-RETAIL-VALUE                        22752416
BOSSC3          FROM  SAT_BOSS_TRANSFERS                                22752516
BOSSC3         WHERE XFER_SKU_NBR          = :EPITM-SKU-NBR             22752616
BOSSC3           AND XFER_RECEIVING_STORE  = :EPTRN-STR-NBR             22752716
BOSSC3           AND XFER_BATCH_DATE      >= :EPTRN-TRN-DTE             22752816
BOSSC3           AND XFER_BATCH_DATE      <= :EPTRN-SLS-DTE             22752916
BOSSC3      ORDER BY XFER_BATCH_DATE                                    22753016
BOSSC3         FETCH FIRST ROW ONLY                                     22753116
BOSSC3          WITH UR                                                 22753216
BOSSC3      END-EXEC.                                                   22753316
BOSSC3                                                                  22753416
BOSSC3     EVALUATE TRUE                                                22753516
BOSSC3        WHEN SQLCODE = ZERO                                       22753616
BOSSC3           COMPUTE PV-OLD-OMNI-PRICE =                            22753716
BOSSC3                   SAT00016-XFER-RETAIL-VALUE /                   22753816
BOSSC3                   SAT00016-XFER-QUANTITY                         22753916
BOSSC3* EPITM-OWND-UNT-RTL-ORIG-AMT DOESN'T INCLUDE SOLD QTY.           22754016
BOSSC3* EPITM-OWND-UNT-RTL-ORIG-AMT ON SFS AND BOPUS CLEARANCE ITEMS    22754116
BOSSC3* REFLECTS LAST ACTIVE PRICE?  IF THAT HAPPENS ON BOSS CLEARANCE  22754216
BOSSC3* ITEMS, WE MAY BE ABLE TO USE CUST-CHRGD-AMT, ASSUMING THAT      22754316
BOSSC3* THERE WOULD BE NO PROMOS ON CLEARANCE ITEMS?                    22754416
BOSSC3* PARA 2950- WILL MULTIPLY OLD AND NEW OMNI PRICES BY SOLD QTY.   22754516
BOSSC3* PARA 2950- WILL SUBTRACT NEW FROM OLD                           22754616
BOSSC3           IF EPITM-OWND-UNT-RTL-ORIG-AMT = PV-OLD-OMNI-PRICE     22754716
BOSSC3               SET PS-ECOM-PRICE-CHANGE-NO   TO  TRUE             22754816
BOSSC3           ELSE                                                   22754916
BOSSC3               SET PS-ECOM-PRICE-CHANGE-YES  TO  TRUE             22755016
BOSSC3               MOVE EPITM-OWND-UNT-RTL-ORIG-AMT                   22755116
BOSSC3                 TO PV-NEW-OMNI-PRICE                             22755216
BOSSC3           END-IF                                                 22755316
BOSSC3        WHEN SQLCODE = PC-ROW-NOT-FOUND                           22755416
BOSSC3**          THIS CONDITION SHOULD NOT BE HIT?                     22755516
BOSSC3            DISPLAY 'TRANSFER NOT FOUND'                          22755616
BOSSC3            SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE                22755716
BOSSC3        WHEN OTHER                                                22755816
BOSSC3            DISPLAY 'TRANSFER CALL FAILED '                       22755916
BOSSC3            SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE                22756016
BOSSC3     END-EVALUATE.                                                22756116
BOSSC3                                                                  22756216
BOSSCL                                                                  22756316
BOSSCL******************************************************************22756416
BOSSC2 2940-CHECK-FOR-ECOM-PRICE-CHG.                                   22756516
BOSSC2*    REQUIRED WHEN A BOSS ORDER IS BEING PROCESSED                22756616
BOSSC2*    CHECK FOR ECOM PRICE FIRST                                   22756716
BOSSC2*    IF ECOM PRICE NOT FOUND, CHECK FOR CORP PRICE (LOC ZERO)     22756816
BOSSCL******************************************************************22756916
BOSSCL**    GET PRICE WHEN CUSTOMER PLACED ORDER                        22757016
BOSSC2      SET PS-ECOM-PRICE-NOT-FOUND   TO TRUE.                      22757116
BOSSC2***   MOVE EPTRN-STR-NBR            TO PV-STR-NBR-DB2.            22757216
BOSSC2      MOVE 873                      TO PV-STR-NBR-DB2.            22757316
BOSSCL      PERFORM 2942-GET-ORDER-DATE-PRICE.                          22757416
BOSSC2      IF PS-ECOM-PRICE-NOT-FOUND                                  22757516
BOSSCL          MOVE ZEROES               TO PV-STR-NBR-DB2             22757616
BOSSCL          PERFORM 2942-GET-ORDER-DATE-PRICE                       22757716
BOSSCL      END-IF.                                                     22757816
BOSSCL                                                                  22757916
BOSSC2      IF PS-ECOM-PRICE-FOUND                                      22758016
BOSSC2**    CHECK IF TRANSFER DATE FELL WITHIN SAME PRICE CHANGE AS     22758116
BOSSC2**    ORDER DATE                                                  22758216
BOSSC2*         IF  EPTRN-SLS-DTE IS >= PV-PRICE-CHG-STRT-DATE          22758316
BOSSC2*         AND EPTRN-SLS-DTE IS <= PV-PRICE-CHG-END-DATE           22758416
BOSSC2          IF  PV-TRANSFER-DATE IS >= PV-PRICE-CHG-STRT-DATE       22758516
BOSSC2          AND PV-TRANSFER-DATE IS <= PV-PRICE-CHG-END-DATE        22758616
BOSSC2              SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE              22758716
BOSSCL          ELSE                                                    22758816
BOSSC2**            GET PRICE WHEN TRANSFER COMPLETED                   22758916
BOSSC2              SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE              22759016
BOSSC2***           MOVE EPTRN-STR-NBR             TO PV-STR-NBR-DB2    22759116
BOSSC2              MOVE 873                       TO PV-STR-NBR-DB2    22759216
BOSSCL              PERFORM 2944-GET-SALE-DATE-PRICE                    22759316
BOSSC2              IF PS-ECOM-PRICE-NOT-FOUND                          22759416
BOSSCL                  MOVE ZEROES                TO PV-STR-NBR-DB2    22759516
BOSSCL                  PERFORM 2944-GET-SALE-DATE-PRICE                22759616
BOSSCL              END-IF                                              22759716
BOSSC2              IF PS-ECOM-PRICE-FOUND                              22759816
BOSSCL                  IF PV-OLD-OMNI-PRICE = PV-NEW-OMNI-PRICE        22759916
BOSSC2                      SET PS-ECOM-PRICE-CHANGE-NO    TO TRUE      22760016
BOSSCL                  ELSE                                            22760116
BOSSC2                      SET PS-ECOM-PRICE-CHANGE-YES   TO TRUE      22760216
BOSSCL                  END-IF                                          22760316
BOSSCL              ELSE                                                22760416
BOSSCL***           PRICING NOT FOUND - DO NOT ATTEMPT OWNERSHIP ADJ    22760516
BOSSC2              DISPLAY 'PRICING NOT FOUND FOR TRANSFER DATE'       22760616
BOSSC2                  SET PS-ECOM-PRICE-CHANGE-NO        TO TRUE      22760716
BOSSCL              END-IF                                              22760816
BOSSCL          END-IF                                                  22760916
BOSSCL      ELSE                                                        22761016
BOSSCL***   PRICING NOT FOUND - DO NOT ATTEMPT OWNERSHIP ADJ            22761116
BOSSCL       DISPLAY 'PRICING NOT FOUND FOR ORDER DATE '                22761216
BOSSC2          SET PS-ECOM-PRICE-CHANGE-NO                TO TRUE      22761316
BOSSCL      END-IF.                                                     22761416
BOSSCL                                                                  22761516
BOSSCL******************************************************************22761616
BOSSCL 2942-GET-ORDER-DATE-PRICE.                                       22761716
BOSSCL*    GET THE ACTIVE PRICE FOR THE ORDER DATE.                     22761816
BOSSCL*    IF THE STORE PRICE IS NOT FOUND, THIS PARAGRAPH WILL BE      22761916
BOSSCL*    CALLED AGAIN TO FIND THE CORPORATE LOC ZERO PRICE.           22762016
BOSSCL******************************************************************22762116
BOSSCL*    SET TIMESTAMP TO TRAN DATE AT 2:00 AM.                       22762216
BOSSCL*    A TIME IS REQUIRED - USING ONLY THE DATE COULD RESULT IN     22762316
BOSSCL*    MULTIPLE ROWS BEING RETURNED.                                22762416
BOSSCL     MOVE EPTRN-TRN-DTE    TO PV-TS-DATE.                         22762516
BOSSCL     MOVE PV-TIMESTAMP-DB2 TO PV-TIMESTAMP.                       22762616
BOSSCL                                                                  22762716
BOSSCL      EXEC SQL                                                    22762816
BOSSCL         SELECT A.SKU                                             22762916
BOSSCL              , B.STR_NBR                                         22763016
BOSSCL              , DATE(B.STRT_TMST)                                 22763116
BOSSCL              , DATE(B.END_TMST)                                  22763216
BOSSCL              , B.STATUS_CDE                                      22763316
BOSSCL              , B.RTL_AMT                                         22763416
BOSSCL              , A.ITM_NBR                                         22763516
BOSSCL          INTO :SKXREF-SKU                                        22763616
BOSSCL              ,:PPCPRC-STR-NBR                                    22763716
BOSSCL              ,:PV-PRICE-CHG-STRT-DATE                            22763816
BOSSCL              ,:PV-PRICE-CHG-END-DATE                             22763916
BOSSCL              ,:PPCPRC-STATUS-CDE                                 22764016
BOSSCL              ,:PPCPRC-RTL-AMT                                    22764116
BOSSCL              ,:SKXREF-ITM-NBR                                    22764216
BOSSCL          FROM TSKXREF A                                          22764316
BOSSCL             , TPPCPRC B                                          22764416
BOSSCL         WHERE B.STR_NBR        = :PV-STR-NBR-DB2                 22764516
BOSSCL           AND A.SKU            = :EPITM-SKU-NBR                  22764616
BOSSCL           AND A.ITM_NBR        = B.TSK_ITM_NBR                   22764716
BOSSCL           AND (:PV-TIMESTAMP BETWEEN B.STRT_TMST AND B.END_TMST) 22764816
BOSSCL          WITH UR                                                 22764916
BOSSCL      END-EXEC.                                                   22765016
BOSSCL                                                                  22765116
BOSSCL     EVALUATE TRUE                                                22765216
BOSSCL        WHEN SQLCODE = ZERO                                       22765316
BOSSC2           SET PS-ECOM-PRICE-FOUND         TO TRUE                22765416
BOSSCL           MOVE PPCPRC-RTL-AMT             TO  PV-NEW-OMNI-PRICE  22765516
BOSSCL        WHEN SQLCODE = PC-ROW-NOT-FOUND                           22765616
BOSSCL**          STORE SEARCH COULD HIT HERE, BUT NOT CORP SEARCH      22765716
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                22765816
BOSSCL        WHEN OTHER                                                22765916
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                22766016
BOSSCL     END-EVALUATE.                                                22766116
BOSSCL                                                                  22766216
BOSSCL                                                                  22766316
BOSSCL******************************************************************22766416
BOSSCL 2944-GET-SALE-DATE-PRICE.                                        22766516
BOSSCL*    GET THE ACTIVE PRICE FOR THE SALE DATE.                      22766616
BOSSC2*    TRANSFER DATE IS 2 DAYS EARLIER THEN SALES DATE TO MIMIC     22766716
BOSSC2*    ACTUAL TRANSFER DATE.  ECOM PRICE CHANGES AFTER THE TRANSFER 22766816
BOSSC2*    DATE SHOULDN'T RESULT IN AN OWNERSHIP ADJUSTMENT.            22766916
BOSSCL*    IF THE STORE PRICE IS NOT FOUND, THIS PARAGRAPH WILL BE      22767016
BOSSCL*    CALLED AGAIN TO FIND THE CORPORATE LOC ZERO PRICE.           22767116
BOSSCL******************************************************************22767216
BOSSCL                                                                  22767316
BOSSCL*    SET TIMESTAMP TO SALES DATE AT 2:00 AM.                      22767416
BOSSCL*    A TIME IS REQUIRED - USING ONLY THE DATE COULD RESULT IN     22767516
BOSSCL*    MULTIPLE ROWS BEING RETURNED.                                22767616
BOSSC2*    MOVE EPTRN-SLS-DTE    TO PV-TS-DATE.                         22767716
BOSSC2     MOVE PV-TRANSFER-DATE TO PV-TS-DATE.                         22767816
BOSSCL     MOVE PV-TIMESTAMP-DB2 TO PV-TIMESTAMP.                       22767916
BOSSCL                                                                  22768016
BOSSCL      EXEC SQL                                                    22768116
BOSSCL         SELECT A.SKU                                             22768216
BOSSCL              , B.STR_NBR                                         22768316
BOSSCL              , DATE(B.STRT_TMST)                                 22768416
BOSSCL              , DATE(B.END_TMST)                                  22768516
BOSSCL              , B.STATUS_CDE                                      22768616
BOSSCL              , B.RTL_AMT                                         22768716
BOSSCL              , A.ITM_NBR                                         22768816
BOSSCL          INTO :SKXREF-SKU                                        22768916
BOSSCL              ,:PPCPRC-STR-NBR                                    22769016
BOSSCL              ,:PV-PRICE-CHG-STRT-DATE                            22769116
BOSSCL              ,:PV-PRICE-CHG-END-DATE                             22769216
BOSSCL              ,:PPCPRC-STATUS-CDE                                 22769316
BOSSCL              ,:PPCPRC-RTL-AMT                                    22769416
BOSSCL              ,:SKXREF-ITM-NBR                                    22769516
BOSSCL          FROM TSKXREF A                                          22769616
BOSSCL             , TPPCPRC B                                          22769716
BOSSCL         WHERE B.STR_NBR        = :PV-STR-NBR-DB2                 22769816
BOSSCL           AND A.SKU            = :EPITM-SKU-NBR                  22769916
BOSSCL           AND A.ITM_NBR        = B.TSK_ITM_NBR                   22770016
BOSSCL           AND (:PV-TIMESTAMP BETWEEN B.STRT_TMST AND B.END_TMST) 22770116
BOSSCL          WITH UR                                                 22770216
BOSSCL      END-EXEC.                                                   22770316
BOSSCL                                                                  22770416
BOSSCL     EVALUATE TRUE                                                22770516
BOSSCL        WHEN SQLCODE = ZERO                                       22770616
BOSSC2            SET PS-ECOM-PRICE-FOUND        TO TRUE                22770716
BOSSCL            MOVE PPCPRC-RTL-AMT            TO PV-OLD-OMNI-PRICE   22770816
BOSSCL        WHEN SQLCODE = PC-ROW-NOT-FOUND                           22770916
BOSSCL**          STORE SEARCH COULD HIT HERE, BUT NOT CORP SEARCH      22771016
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                22771116
BOSSCL        WHEN OTHER                                                22771216
BOSSC2            SET PS-ECOM-PRICE-NOT-FOUND    TO TRUE                22771316
BOSSCL     END-EVALUATE.                                                22771416
BOSSCL                                                                  22771516
BOSSCL                                                                  22771616
BOSSCL******************************************************************22771716
BOSSC3 2950-CREATE-BOSS-OWNERSHIP-ADJ.                                  22771823
BOSSCL*    REQUIRED WHEN AN OMNI ORDER IS BEING PROCESSED AND THE       22771916
BOSSC3*    ECOM PRICE CHANGED AFTER THE ECOM ORDER WAS PLACED AND       22772123
BOSSC3*    BEFORE THE TRANSFER TO THE STORE HAPPENED.                   22772223
BOSSC3*    PV-OLD-OMNI-PRICE SET TO TRANSFER DATE PRICE FOR PRICE LOOKUP22772316
BOSSC3*    OR TRANSFER PRICE FOR TRANSFER LOOKUP.                       22772416
BOSSC3*    PV-NEW-OMNI-PRICE SET TO ORDER DATE PRICE FOR PRICE LOOKUP   22772516
BOSSC3*    OR EPITM-OWND-UNT-RTL-ORIG-AMT FOR TRANSFER LOOKUP.          22772616
BOSSCL******************************************************************22772716
BOSSCL                                                                  22772816
BOSSCL     SET ML017-MKDOWN                                             22772916
BOSSCL         ML017-BN-OWN-ADJ                                         22773016
BOSSCL         ML017-RC-MISCELLANEOUS                                   22773116
BOSSCL         ML017-REGISTER-MKDN-MKON     TO TRUE.                    22773216
BOSSCL     MOVE PC-OWN-ADJ-796    TO ML017-PC-MKDN-MKUP-RSN-CDE.        22773316
BOSSCL     COMPUTE ML017-PC-OLD-PR-AMT      =                           22773416
BOSSCL             PV-OLD-OMNI-PRICE            * EPITM-SLD-QTY.        22773516
BOSSCL     COMPUTE ML017-PC-NEW-PR-AMT      =                           22773616
BOSSCL             PV-NEW-OMNI-PRICE            * EPITM-SLD-QTY.        22773716
BOSSCL     MOVE EPITM-SLD-QTY               TO ML017-PC-QTY.            22773816
BOSSCL                                                                  22773916
BOSSCL     COMPUTE ML017-PC-DIFFER-AMT =                                22774016
BOSSCL             ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT.           22774116
BOSSCL                                                                  22774216
BOSSCL     IF ML017-PC-DIFFER-AMT < 0                                   22774316
BOSSCL*        PRICE DECREASE - GENERATE MARKDOWN CANCEL                22774416
BOSSCL*        LOGIC BELOW COPIED FROM 3600-MARKDOWN-CANCEL             22774516
BOSSCL         SET ML017-MARKDOWN-CANCEL TO TRUE                        22774616
BOSSCL         ADD +1     TO PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)      22774716
BOSSCL         ADD ML017-PC-DIFFER-AMT  TO                              22774816
BOSSCL             PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB)                22774916
BOSSCL     ELSE                                                         22775016
BOSSCL*        PRICE INCREASE - GENERATE MARKDOWN                       22775116
BOSSCL*        BELOW LOGIC COPIED FROM 3120-CONTINUE-PROCESS            22775216
BOSSCL         SET ML017-MARKDOWN          TO TRUE                      22775316
BOSSCL         ADD +1    TO PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB)      22775416
BOSSCL         ADD ML017-PC-DIFFER-AMT     TO                           22775516
BOSSCL             PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB)               22775616
BOSSCL     END-IF.                                                      22775716
BOSSCL                                                                  22775816
BOSSCL     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        22775916
BOSSCL                                                                  22776016
219700******************************************************************22776116
219800 3000-POPULATE-MISC-FIELDS.                                       22776216
219900*     POPULATE MISC FIELDS.                                       22777016
220000******************************************************************22780000
220100                                                                  22790000
220200     INITIALIZE ML017-PC-CATEGORY-IND.                            22800000
220300                                                                  22810000
220400     IF EPITM-DEPT-CL-ERR-CDE NOT EQUAL '0' AND                   22820000
220500        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '1' AND                   22830000
220600        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '2' AND                   22840000
220700        EPITM-DEPT-CL-ERR-CDE NOT EQUAL '3' OR                    22850000
220800        EPITM-SKU-ERR-CDE = '2'                                   22860000
220900        MOVE EPITM-SKU-NBR            TO ML017-PC-SKU             22870000
221000        MOVE '099'                    TO ML017-PC-DEPT-NBR        22880000
221100                                         EPITM-DEPT-NBR           22890000
221200                                         ML017-PC-SKU(1:3)        22900000
221300        MOVE '10'                     TO ML017-PC-CLASS-NBR       22910000
221400                                         EPITM-SUB-CL-NBR         22920000
221500                                         ML017-PC-SKU(4:2)        22930000
221600     ELSE                                                         22940000
221700        MOVE EPITM-DEPT-NBR           TO ML017-PC-DEPT-NBR        22950000
221800        MOVE EPITM-SUB-CL-NBR         TO ML017-PC-CLASS-NBR       22960000
221900        MOVE EPITM-SKU-NBR            TO ML017-PC-SKU             22970000
222000     END-IF.                                                      22980000
222100                                                                  22990000
222200     MOVE EPITM-DEPT-NBR              TO ML017-PC-DOC-DEPT.       23000000
222300     MOVE EPTRN-SLS-DTE               TO PV-ISO-DB2-DATE.         23010000
222400     MOVE PV-ISO-DB2-DD               TO ML017-PC-DOC-DAY.        23020000
222500     MOVE ML017-PC-DOC-NBR            TO ML017-PC-DOC-5-NBR.      23030000
222600     MOVE PV-ISO-DB2-MM               TO ML017-PC-DTE-MM.         23040000
222700     MOVE PV-ISO-DB2-DD               TO ML017-PC-DTE-DD.         23050000
222800     MOVE PV-FISC-PERIOD-NBR-HOLD     TO ML017-PC-KOHLS-MM.       23060000
222900     MOVE EPITM-MAJ-CL-NBR            TO ML017-PC-MAJ-CLASS.      23070000
223000     MOVE +1                          TO ML017-PC-QTY             23080000
223100                                         ML017-PC-TOT-DOC-QTY.    23090000
223200     MOVE EPTRN-STR-NBR               TO PV-STR-NBR-4.            23100000
223300     MOVE PV-RFMT-STR-NBR             TO ML017-PC-STORE-NBR.      23110000
223400     MOVE EPITM-SKU-NBR               TO PV-SKU-NBR.              23120000
223500     MOVE PV-RGST-ID                  TO ML017-RGST-ID.           23130000
223600     MOVE PV-TRN-NBR                  TO ML017-TRN-NBR.           23140000
223700     MOVE PV-LNE-ITM-SEQ-NBR          TO ML017-LNE-ITM-SEQ-NBR.   23150000
223800                                                                  23160000
223900     IF EPTRN-TRN-STAT-CDE = 'V' OR                               23170000
224000        EPTRN-TRN-STAT-CDE = 'R'                                  23180000
224100        SET ML017-SALES-AUDIT-CORR    TO TRUE                     23190000
224200        IF DPG55-DB2-ISO-DATE-FMT LESS THAN PV-CUT-OFF-CCYY-MM-DD 23200000
224300           MOVE 4              TO PV-TOT-SUB                      23210000
224400        ELSE                                                      23220000
224500           MOVE 2              TO PV-TOT-SUB                      23230000
224600        END-IF                                                    23240000
224700     ELSE                                                         23250000
224800        IF EPTRN-TRN-STAT-CDE = 'L'                               23260000
224900           SET ML017-SYSTEM-LATE-CORR TO TRUE                     23270000
225000           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    23280000
225100              PV-CUT-OFF-CCYY-MM-DD                               23290000
225200              MOVE 5          TO PV-TOT-SUB                       23300000
225300           ELSE                                                   23310000
225400              MOVE 3          TO PV-TOT-SUB                       23320000
225500           END-IF                                                 23330000
225600        ELSE                                                      23340000
225700           MOVE 1              TO PV-TOT-SUB                      23350000
225800        END-IF                                                    23360000
225900     END-IF.                                                      23370000
226000                                                                  23380000
226100******************************************************************23390000
226200* CHECK FOR EMPLOYEE DISCOUNT                                     23400000
226300******************************************************************23410000
226400 3001-CHECK-DISCOUNT.                                             23420000
226500                                                                  23430000
226600      EXEC SQL                                                    23440000
226700         SELECT  EMP_DISC_AMT                                     23450000
226800           INTO :EPEID-EMP-DISC-AMT                               23460000
226900                                                                  23470000
227000           FROM TEPEID                                            23480000
227100                                                                  23490000
227200          WHERE PARTN_NBR        = :PV-PARTN-NBR                  23500000
227300            AND STR_NBR          = :PV-STR-NBR                    23510000
227400            AND RGST_ID          = :PV-RGST-ID                    23520000
227500            AND TRN_NBR          = :PV-TRN-NBR                    23530000
227600            AND STRT_TM          = :PV-STRT-TM                    23540000
227700            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           23550000
227800            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            23560000
227900                                                                  23570000
228000          WITH UR                                                 23580000
228100      END-EXEC.                                                   23590000
228200                                                                  23600000
228300     EVALUATE TRUE                                                23610000
228400        WHEN SQLCODE = ZERO                                       23620000
228500           PERFORM 3002-EMPLY-DISCOUNT                            23630000
228600           PERFORM 4000-PROCESS-MARKDOWN-MARKUP                   23640000
228700*** NEED TO CLEAR OUT WORKING STORAGE TO WHERE IT WOULD HAVE BEEN 23650000
228800*** WITHOUT THE DISCOUNT.  AS A RESULT, INITIALIZE THE RECORD AS  23660000
228900*** IT WAS PRIOR TO WORKING WITH THE EMPLOYEE DISCOUNT.           23670000
229000           INITIALIZE ML017-PRICE-CHANGE-RECORD                   23680000
229100           PERFORM 3000-POPULATE-MISC-FIELDS                      23690000
229200        WHEN SQLCODE = PC-ROW-NOT-FOUND                           23700000
229300           CONTINUE                                               23710000
229400        WHEN OTHER                                                23720000
229500           MOVE '3001-CHECK-DISCOUNT'                             23730000
229600                                      TO PV-PARAGRAPH-NAME        23740000
229700           SET AC-DB2-ERROR           TO TRUE                     23750000
229800           PERFORM 9999-ABEND                                     23760000
229900                                                                  23770000
230000     END-EVALUATE.                                                23780000
230100                                                                  23790000
230200                                                                  23800000
230300******************************************************************23810000
230400* PROCESS EMPLOYEE DISCOUNTS                                      23820000
230500******************************************************************23830000
230600 3002-EMPLY-DISCOUNT.                                             23840000
230700                                                                  23850000
230800     MOVE EPITM-NET-CHRGD-AMT TO PV-NET-CHRGD-AMT-TMP.            23860000
230900                                                                  23870000
231000     COMPUTE EPITM-NET-CHRGD-AMT = EPITM-NET-CHRGD-AMT            23880000
231100                                 - EPEID-EMP-DISC-AMT.            23890000
231200                                                                  23900000
231300     SET ML017-MKDOWN                                             23910000
231400         ML017-RC-MISCELLANEOUS                                   23920000
231500         ML017-BN-EMPLY-DISCOUNT                                  23930000
231600         ML017-REGISTER-MKDN-MKON TO TRUE.                        23940000
231700                                                                  23950000
231800     MOVE PC-790-EMPLY-DISCOUNT TO                                23960000
231900                ML017-PC-MKDN-MKUP-RSN-CDE.                       23970000
232000                                                                  23980000
232100     MOVE EPITM-NET-CHRGD-AMT  TO ML017-PC-OLD-PR-AMT.            23990000
232200     MOVE PV-NET-CHRGD-AMT-TMP TO ML017-PC-NEW-PR-AMT.            24000000
232300                                                                  24010000
232400     IF  EPEID-EMP-DISC-AMT < ZERO                                24020000
232500         SET ML017-MARKDOWN TO TRUE                               24030000
232600                                                                  24040000
232700         COMPUTE EPEID-EMP-DISC-AMT =                             24050000
232800                 EPEID-EMP-DISC-AMT * (-1)                        24060000
232900                                                                  24070000
233000         ADD +1           TO PT-EMPLY-DISC-MKDN-QTY (PV-TOT-SUB)  24080000
233100         ADD EPEID-EMP-DISC-AMT                                   24090000
233200                          TO PT-EMPLY-DISC-MKDN-AMT (PV-TOT-SUB)  24100000
233300     ELSE                                                         24110000
233400         SET ML017-MARKDOWN-CANCEL TO TRUE                        24120000
233500                                                                  24130000
233600         MOVE ZEROS              TO ML017-PC-OLD-PR-AMT           24140000
233700         MOVE EPEID-EMP-DISC-AMT TO ML017-PC-NEW-PR-AMT           24150000
233800         COMPUTE EPEID-EMP-DISC-AMT =                             24160000
233900                 EPEID-EMP-DISC-AMT * (-1)                        24170000
234000                                                                  24180000
234100         ADD +1           TO PT-EMPLY-DISC-MDC-QTY (PV-TOT-SUB)   24190000
234200         ADD EPEID-EMP-DISC-AMT                                   24200000
234300                          TO PT-EMPLY-DISC-MDC-AMT (PV-TOT-SUB)   24210000
234400     END-IF.                                                      24220000
234500                                                                  24230000
234600     MOVE EPEID-EMP-DISC-AMT   TO ML017-PC-DIFFER-AMT.            24240000
234700                                                                  24250000
234800******************************************************************24260000
234900 3100-RETURN-ITEM-MARKDOWN.                                       24270000
235000*     PROCESS BACK OFFICE MARKDOWN FOR QUALIFY RETURN ITEMS.      24280000
235100*     FOR RETURN ITEMS, EPITM-CUST-CHRGD-AMT IS NEGATIVE, TO      24290000
235200*     SUBTRACT THAT AMOUNT, HAS TO "ADD" IT TO THE GROUPED PRICE. 24300000
235300******************************************************************24310000
235400                                                                  24320000
235500     PERFORM 3200-SELECT-GROUP-PRICING.                           24330000
235600     IF SQLCODE = ZERO                                            24340000
235700        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPIGP-GP-AMT             24350000
235800                                       / EPIGP-GP-QTY             24360000
235900                                       * EPITM-SLD-QTY            24370000
236000                                       + EPITM-CUST-CHRGD-AMT     24380000
236100     ELSE                                                         24390000
236200        IF PV-SKU-LST-3-DGT        EQUAL ZERO                     24400000
236300           COMPUTE PV-PRICE-CHANGE-AMOUNT = EPITM-REG-RTL-AMT     24410000
236400                                          * EPITM-SLD-QTY         24420000
236500        ELSE                                                      24430000
236600***** CORRECT NET-CHRGD-AMT < 0 AND CUST-CHRGD-AMT > 0            24440000
236700           IF EPITM-NET-CHRGD-AMT < 0 AND                         24450000
236800              EPITM-CUST-CHRGD-AMT > 0 AND                        24460000
236900              EPITM-REG-RTL-AMT    = 0                            24470000
237000              MOVE ZERO           TO PV-PRICE-CHANGE-AMOUNT       24480000
237100           ELSE                                                   24490000
237200              COMPUTE PV-PRICE-CHANGE-AMOUNT                      24500000
237300                    = EPITM-CUST-CHRGD-AMT                        24510000
237400                    + EPITM-REG-RTL-AMT                           24520000
237500                    * EPITM-SLD-QTY                               24530000
237600           END-IF                                                 24540000
237700        END-IF                                                    24550000
237800     END-IF.                                                      24560000
237900                                                                  24570000
238000     COMPUTE PV-PRICE-CHANGE-AMOUNT = PV-PRICE-CHANGE-AMOUNT      24580000
238100                                    * (-1).                       24590000
238200                                                                  24600000
214615     IF (EPITM-ORIG-REG-RTL-AMT > 0                               24610000
214615     AND EPITM-ORIG-REG-RTL-AMT NOT = EPITM-REG-RTL-AMT)          24620000
214615        PERFORM 3140-NEW-PROCESS                                  24630000
214615     ELSE                                                         24631000
214615        PERFORM 3120-CONTINUE-PROCESS                             24632000
214615     END-IF.                                                      24633000
214615                                                                  24634000
242000******************************************************************24634100
214615 3120-CONTINUE-PROCESS.                                           24634200
214615                                                                  24634300
238300     SET ML017-MKDOWN                                             24634400
238400         ML017-RC-MISCELLANEOUS                                   24634500
238500         ML017-BN-OWN-ADJ                                         24634600
238600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    24634700
238700                                                                  24634800
011618     IF EPTRN-POS-CPBL-LVL-NBR = PC-POC AND                       24634900
062118        (EPITM-SAL-RET-CDE = 'R' OR                               24635000
062118         EPITM-SAL-RET-CDE = 'B')                                 24636000
011618         PERFORM 3300-CALC-EXTENDED-AMT                           24637000
011618         IF PV-CUST-CHRGD-AMT > PV-EXTENDED-AMT                   24638000
011618******* THIS IF STATEMENT IS ADDED TO AVOID "ZERO COST" ITEMS     24639000
011618******* BEING PROCESSED AS MARKUPS.                               24640000
011618             IF EPITM-REG-RTL-AMT NOT EQUAL ZERO AND              24650000
011618                EPITM-OWND-UNT-RTL-AMT NOT EQUAL ZERO             24660000
062918                 IF PV-PRICE-CHANGE-AMOUNT < ZERO                 24670000
062918                     MOVE PC-OWN-ADJ-796        TO                24680000
062918                                       ML017-PC-MKDN-MKUP-RSN-CDE 24690000
062918                     SET ML017-MARKDOWN-CANCEL  TO TRUE           24700000
062918                     MOVE ZERO            TO ML017-PC-OLD-PR-AMT  24710000
062918                     MOVE PV-PRICE-CHANGE-AMOUNT                  24720000
062918                                          TO ML017-PC-NEW-PR-AMT  24730000
062918                                             ML017-PC-DIFFER-AMT  24740000
062918                     ADD +1                     TO                24750000
062918                            PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB) 24760000
062918                     ADD ML017-PC-DIFFER-AMT    TO                24770000
062918                            PT-OWNERSHIP-ADJ-MDC-AMT (PV-TOT-SUB) 24780000
062918                 END-IF                                           24790000
062918                 IF PV-PRICE-CHANGE-AMOUNT > ZERO                 24800000
062118                     MOVE PC-OWN-RTN-ADJ-792    TO                24810000
062118                                       ML017-PC-MKDN-MKUP-RSN-CDE 24820000
062118                     SET ML017-MARKDOWN         TO TRUE           24830000
072618                     MOVE EPITM-OWND-UNT-RTL-AMT                  24840000
072618                                           TO ML017-PC-NEW-PR-AMT 24850000
072618                     MOVE EPITM-CUST-CHRGD-AMT                    24860000
072618                                           TO ML017-PC-OLD-PR-AMT 24870000
072618                     COMPUTE ML017-PC-DIFFER-AMT =                24880000
072618                       ML017-PC-OLD-PR-AMT - ML017-PC-NEW-PR-AMT  24890000
062118                     SET ML017-BN-OWN-RTN-ADJ   TO TRUE           24900000
062118                     ADD +1                     TO                24910000
062118                            PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)24920000
062118                     ADD ML017-PC-DIFFER-AMT TO                   24930000
062118                            PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)24940000
062918                 END-IF                                           24950000
011618             END-IF                                               24960000
011618         ELSE                                                     24970000
011618              IF PV-CUST-CHRGD-AMT < PV-EXTENDED-AMT              24980000
011618                  IF EPITM-PROMO-INTFC-ID NOT = ZERO              24990000
214615                  OR EPITM-PROMO-SCHM-CDE NOT = ZERO              25000000
011618                     PERFORM 3500-PROMO-MARKDOWN-CANCEL           25010000
011618                  ELSE                                            25020000
011618                     PERFORM 3600-MARKDOWN-CANCEL                 25030000
011618                  END-IF                                          25040000
011618              END-IF                                              25050000
011618         END-IF                                                   25060000
011618     ELSE                                                         25070000
238800     EVALUATE TRUE                                                25080000
238900        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        25090000
239000           MOVE PC-OWN-ADJ-796        TO                          25100000
239100                ML017-PC-MKDN-MKUP-RSN-CDE                        25110000
239200           SET ML017-MARKDOWN-CANCEL  TO TRUE                     25120000
239300           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      25130000
239400           MOVE PV-PRICE-CHANGE-AMOUNT                            25140000
239500                                      TO ML017-PC-NEW-PR-AMT      25150000
239600                                         ML017-PC-DIFFER-AMT      25160000
239700           ADD +1                     TO                          25170000
239800               PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)              25180000
239900           ADD ML017-PC-DIFFER-AMT    TO PT-OWNERSHIP-ADJ-MDC-AMT 25190000
240000                                         (PV-TOT-SUB)             25200000
240100        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        25210000
240200           SET ML017-MARKDOWN         TO TRUE                     25220000
240300           MOVE EPITM-OWND-UNT-RTL-AMT                            25230000
240400                                      TO ML017-PC-NEW-PR-AMT      25240000
240500           MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-OLD-PR-AMT       25250000
240600                                                                  25260000
240700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      25270000
240800                                       - ML017-PC-NEW-PR-AMT      25280000
240900           MOVE PC-OWN-RTN-ADJ-792    TO                          25290000
241000                ML017-PC-MKDN-MKUP-RSN-CDE                        25300000
241100           SET ML017-BN-OWN-RTN-ADJ TO TRUE                       25310000
241200           ADD +1                  TO                             25320000
241300               PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)             25330000
241400           ADD ML017-PC-DIFFER-AMT TO                             25340000
241500                  PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)          25350000
241600        WHEN OTHER                                                25360000
241700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       25370000
011618     END-EVALUATE                                                 25380000
011618     END-IF.                                                      25390000
011618                                                                  25400000
214615******************************************************************25410000
214615 3140-NEW-PROCESS.                                                25420000
214615                                                                  25430000
214615     MOVE ZERO TO ML017-PC-DIFFER-AMT.                            25440000
214615                                                                  25450000
214615     IF (EPITM-SAL-TYP-CDE  = PC-REGULAR-R                        25460000
214615     OR  EPITM-SAL-TYP-CDE  = PC-PROMO-P                          25470000
214615     OR  EPITM-SAL-TYP-CDE  = PC-UNKNOWN-N)                       25480000
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-REGULAR-R                   25490000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                     25500000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-UNKNOWN-N)                  25501000
214615        IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT             25502000
214615***      WT SALE, WT RETURN PM UP                                 25502100
214615           PERFORM 3142-MARKUP-RTN                                25502200
214615        ELSE                                                      25502300
214615***      WT SALE, WT RETURN PM DOWN                               25502400
214615           PERFORM 3146-MARKDOWN-RTN                              25502500
214615        END-IF                                                    25502600
214615     END-IF.                                                      25502700
214615                                                                  25502800
214615     IF (EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G                        25502900
214615     OR  EPITM-SAL-TYP-CDE = PC-CLEARANCE-C)                      25503000
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G                  25504000
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-CLEARANCE-C)                25504100
214615        IF EPITM-REG-RTL-AMT < EPITM-ORIG-REG-RTL-AMT             25504200
214615***      CL SALE, CL RETURN PM DOWN                               25504300
214615           PERFORM 3146-MARKDOWN-RTN                              25504400
214615        ELSE                                                      25504500
214615***      CL SALE, CL RETURN PM UP                                 25504600
214615           PERFORM 3144-MARKDOWN-CANCEL-RTN                       25504700
214615        END-IF                                                    25504800
214615     END-IF.                                                      25504900
214615                                                                  25505000
214615     IF (EPITM-SAL-TYP-CDE = PC-REGULAR-R                         25506000
214615     OR  EPITM-SAL-TYP-CDE = PC-PROMO-P                           25506100
214615     OR  EPITM-SAL-TYP-CDE = PC-UNKNOWN-N)                        25506200
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G                  25506300
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-CLEARANCE-C)                25506400
214615       IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT              25506500
214615***     CL SALE, WT RETURN PM UP                                  25506600
214615          PERFORM 3144-MARKDOWN-CANCEL-RTN                        25506700
214615      ELSE                                                        25506800
214615***     CL SALE, WT RETURN PM DOWN                                25506900
214615          PERFORM 3146-MARKDOWN-RTN                               25507000
214615       END-IF                                                     25507100
214615     END-IF.                                                      25507200
214615                                                                  25507300
214615     IF (EPITM-SAL-TYP-CDE = PC-GOLDSTAR-G                        25507400
214615     OR  EPITM-SAL-TYP-CDE = PC-CLEARANCE-C)                      25507500
214615     AND (EPITM-ORIG-SAL-TYP-CDE = PC-REGULAR-R                   25507600
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                     25507700
214615      OR  EPITM-ORIG-SAL-TYP-CDE = PC-UNKNOWN-N)                  25507800
214615       IF EPITM-REG-RTL-AMT > EPITM-ORIG-REG-RTL-AMT              25507900
214615***     WT SALE, CL RETURN PM UP                                  25508000
214615          PERFORM 3142-MARKUP-RTN                                 25508100
214615       ELSE                                                       25508200
214615***     WT SALE, CL RETURN PM DOWN                                25508300
214615          PERFORM 3146-MARKDOWN-RTN                               25508400
214615       END-IF                                                     25508500
214615     END-IF.                                                      25508600
214615                                                                  25508700
214615******************************************************************25508800
214615 3142-MARKUP-RTN.                                                 25508900
214615                                                                  25509000
214615     SET ML017-MKUP                                               25509100
214615         ML017-MARKUP                                             25509200
214615         ML017-RC-MISCELLANEOUS                                   25509300
214615         ML017-BN-OWN-RTN-ADJ                                     25509400
214615         ML017-REGISTER-MKDN-MKON     TO TRUE.                    25509500
214615                                                                  25509600
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   25509700
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          25509800
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          25509900
214615     COMPUTE ML017-PC-DIFFER-AMT  = ML017-PC-OLD-PR-AMT           25510000
214615                                  - ML017-PC-NEW-PR-AMT.          25511000
214615                                                                  25512000
214615     ADD +1                      TO                               25513000
214615                           PT-OWN-RETRN-ADJ-MKUP-QTY (PV-TOT-SUB).25513100
214615     ADD ML017-PC-DIFFER-AMT     TO                               25513200
214615                           PT-OWN-RETRN-ADJ-MKUP-AMT (PV-TOT-SUB).25513300
214615                                                                  25513400
226892     COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                    25513500
226892                     +  EPITM-CUST-CHRGD-AMT) * -1.               25513600
226892     IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                      25513700
226892     OR  EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G)                  25513800
226892     AND PV-DIFF NOT = 0                                          25513900
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      25514000
214615        PERFORM 3850-PROMO-MARKDOWN2                              25515000
214615     END-IF.                                                      25515100
214615                                                                  25515200
214615******************************************************************25515300
214615 3144-MARKDOWN-CANCEL-RTN.                                        25515400
214615                                                                  25515500
214615     SET ML017-MKDOWN                                             25515600
214615         ML017-MARKDOWN-CANCEL                                    25515700
214615         ML017-RC-MISCELLANEOUS                                   25515800
214615         ML017-BN-OWN-RTN-ADJ                                     25515900
214615         ML017-REGISTER-MKDN-MKON TO TRUE.                        25516000
214615                                                                  25517000
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   25518000
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          25519000
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          25520000
214615     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            25521000
214615                                 - ML017-PC-NEW-PR-AMT.           25521100
214615                                                                  25521200
214615     ADD +1                     TO                                25521300
214615                           PT-OWN-RETRN-ADJ-MDC-QTY (PV-TOT-SUB). 25521400
214615     ADD ML017-PC-DIFFER-AMT    TO                                25521500
214615                           PT-OWN-RETRN-ADJ-MDC-AMT (PV-TOT-SUB). 25521600
                                                                        25521700
226892* ADDED THE FOLLOWING TO FIX ML PRODUCTION ISSUE WITH MDC         25521800
226892* RELATED TO MLKUP021'S MDC TO MD FLIP LOGIC                      25521900
226892     MOVE ZERO                  TO ML017-PC-OLD-PR-AMT.           25522000
226892     MOVE ML017-PC-DIFFER-AMT   TO ML017-PC-NEW-PR-AMT.           25522100
214615                                                                  25522200
226892     COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                    25522300
226892                     +  EPITM-CUST-CHRGD-AMT) * -1.               25522400
226892     IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                      25522500
226892     OR  EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G)                  25522600
226892     AND PV-DIFF NOT = 0                                          25522700
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      25522800
214615        PERFORM 3850-PROMO-MARKDOWN2                              25522900
214615     END-IF.                                                      25523000
214615                                                                  25524000
214615******************************************************************25524100
214615 3146-MARKDOWN-RTN.                                               25524200
214615                                                                  25524300
214615     SET ML017-MKDOWN                                             25524400
214615         ML017-RC-MISCELLANEOUS                                   25524500
214615         ML017-BN-OWN-RTN-ADJ                                     25524600
226892         ML017-MARKDOWN                                           25524700
214615         ML017-REGISTER-MKDN-MKON TO TRUE.                        25524800
214615                                                                  25524900
214615     MOVE PC-OWN-RTN-ADJ-792     TO ML017-PC-MKDN-MKUP-RSN-CDE.   25525000
214615     MOVE EPITM-ORIG-REG-RTL-AMT TO ML017-PC-OLD-PR-AMT.          25525100
214615     MOVE EPITM-REG-RTL-AMT      TO ML017-PC-NEW-PR-AMT.          25525200
214615     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            25525300
214615                                 - ML017-PC-NEW-PR-AMT.           25525400
214615                                                                  25525500
214615     ADD +1                      TO                               25525600
214615                           PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB).25525700
214615     ADD ML017-PC-DIFFER-AMT     TO                               25525800
214615                           PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB).25525900
214615                                                                  25526000
226892     COMPUTE PV-DIFF = (EPITM-ORIG-REG-RTL-AMT                    25526100
226892                     +  EPITM-CUST-CHRGD-AMT) * -1.               25526200
226892     IF (EPITM-ORIG-SAL-TYP-CDE = PC-PROMO-P                      25526300
226892     OR  EPITM-ORIG-SAL-TYP-CDE = PC-GOLDSTAR-G)                  25526400
226892     AND PV-DIFF NOT = 0                                          25526500
214615        PERFORM 4000-PROCESS-MARKDOWN-MARKUP                      25526600
214615        PERFORM 3850-PROMO-MARKDOWN2                              25526700
214615     END-IF.                                                      25526800
214615                                                                  25526900
242000******************************************************************25527000
242100 3200-SELECT-GROUP-PRICING.                                       25527100
242200*     CHECK IF ITEM IS GROUP PRICED.                              25527200
242300******************************************************************25527300
242400                                                                  25527400
242500     EXEC SQL                                                     25527500
242600        SELECT  GP_QTY                                            25527600
242700               ,GP_AMT                                            25527700
242800          INTO :EPIGP-GP-QTY                                      25527800
242900              ,:EPIGP-GP-AMT                                      25527900
243000          FROM  TEPIGP                                            25528000
243100         WHERE  PARTN_NBR        = :PV-PARTN-NBR                  25529000
243200           AND  STR_NBR          = :PV-STR-NBR                    25530000
243300           AND  RGST_ID          = :PV-RGST-ID                    25540000
243400           AND  TRN_NBR          = :PV-TRN-NBR                    25550000
243500           AND  STRT_TM          = :PV-STRT-TM                    25560000
243600           AND  SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           25570000
243700           AND  LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            25580000
243800                WITH UR                                           25590000
243900     END-EXEC.                                                    25600000
244000                                                                  25610000
244100     EVALUATE TRUE                                                25620000
244200        WHEN SQLCODE = ZERO                                       25630000
244300        WHEN SQLCODE = PC-ROW-NOT-FOUND                           25640000
244400           CONTINUE                                               25650000
244500        WHEN OTHER                                                25660000
244600           MOVE '3200-SELECT-GROUP-PRICING'                       25670000
244700                                        TO PV-PARAGRAPH-NAME      25680000
244800           SET AC-DB2-ERROR           TO TRUE                     25690000
244900           PERFORM 9999-ABEND                                     25700000
245000     END-EVALUATE.                                                25710000
245100                                                                  25720000
245200******************************************************************25730000
245300 3300-CALC-EXTENDED-AMT.                                          25740000
245400*     CALCULATE THE EXTENDED AMOUNT.                              25750000
245500******************************************************************25760000
245600                                                                  25770000
245700     EVALUATE TRUE                                                25780000
245800        WHEN EPITM-PRIC-SRC-CDE        = 'I'                      25790000
245900           COMPUTE PV-EXTENDED-AMT     = EPITM-OWND-UNT-RTL-AMT   25800000
246000                                       * EPITM-SLD-QTY            25810000
246100                                                                  25820000
246200        WHEN EPITM-REG-RTL-AMT         < ZERO                     25830000
246300*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    25840000
246400*****   NET RING OFFLINE SALE ITEMS, THIS IF STATEMENT IS REMOVED.25850000
246500*          IF EPITM-REG-RTL-ORGN-CDE = 'C'                        25860000
246600*             COMPUTE PV-EXTENDED-AMT                             25870000
246700*                   = EPITM-CUST-CHRGD-AMT * (-1)                 25880000
246800*          ELSE                                                   25890000
246900              COMPUTE PV-EXTENDED-AMT = EPITM-REG-RTL-AMT * (-1)  25900000
247000*          END-IF                                                 25910000
247100                                                                  25920000
247200        WHEN EPITM-REG-RTL-AMT         > ZERO                     25930000
247300*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    25940000
247400*****   DUMMY SKU, NEED TO REMOVE THIS IF STATEMENT.              25950000
247500*          IF PV-SKU-LST-3-DGT     EQUAL ZERO                     25960000
247600*             MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT        25970000
247700*          ELSE                                                   25980000
247800*****   TO CORRECT THE PROBLEM OF NOT CALCULATING MARKDOWN FOR    25990000
247900*****   NET RING OFFLINE SALE ITEMS, THIS IF STATEMENT IS REMOVED.26000000
248000*             IF EPITM-REG-RTL-ORGN-CDE = 'C'                     26010000
248100*                MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT     26020000
248200*             ELSE                                                26030000
248300*****   RED-TICKET ITEMS; NO MARKDOWN. GOLDSTAR SHOULD NOT GO     26040000
248400*****   THROUGH THIS LOGIC BUT CODED FOR JUST IN CASE.            26050000
248500                 IF EPITM-REG-RTL-ORGN-CDE = 'P' AND              26060000
248600                    EPITM-PRIC-SRC-CDE = 'K' AND                  26070000
248700                    EPITM-SAL-TYP-CDE EQUAL ('C' OR 'G')          26080000
248800                    MOVE EPITM-CUST-CHRGD-AMT TO PV-EXTENDED-AMT  26090000
248900                 ELSE                                             26100000
249000                    MOVE EPITM-REG-RTL-AMT TO PV-EXTENDED-AMT     26110000
249100                 END-IF                                           26120000
249200*             END-IF                                              26130000
249300*          END-IF                                                 26140000
249400        WHEN OTHER                                                26150000
249500           IF EPITM-CUST-CHRGD-AMT     < ZERO                     26160000
249600              COMPUTE PV-EXTENDED-AMT  = EPITM-CUST-CHRGD-AMT     26170000
249700                                       * (-1)                     26180000
249800           ELSE                                                   26190000
249900              MOVE EPITM-CUST-CHRGD-AMT                           26200000
250000                                      TO PV-EXTENDED-AMT          26210000
250100           END-IF                                                 26220000
250200     END-EVALUATE.                                                26230000
250300                                                                  26240000
250400******************************************************************26250000
250500 3400-MARKUP-CANCEL.                                              26260000
250600*     PROCESS BACK OFFICE MARKUP CANCEL FOR QUALIFY SALE ITEMS.   26270000
250700*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '-'.              26280000
011618*     SAL_RET_CDE = 'R' AND POC RETURN                            26290000
250800******************************************************************26300000
250900                                                                  26310000
251000     SET ML017-MKUP                                               26320000
251100         ML017-MARKUP-CANCEL                                      26330000
251200         ML017-RC-MISCELLANEOUS                                   26340000
251300         ML017-BN-OWN-ADJ                                         26350000
251400         ML017-REGISTER-MKDN-MKON     TO TRUE.                    26360000
251500                                                                  26370000
251600     MOVE PC-OWN-ADJ-796           TO ML017-PC-MKDN-MKUP-RSN-CDE. 26380000
251700                                                                  26390000
251800     PERFORM 6300-SELECT-TIERED.                                  26400000
251900                                                                  26410000
252000     IF PS-TIERED-ITEM-NO                                         26420000
MUCFIX*       COMPUTE ML017-PC-OLD-PR-AMT = PV-CUST-CHRGD-AMT           26430021
MUCFIX*                                   + PV-CUST-CHRGD-AMT           26440021
MUCFIX*                                   - PV-EXTENDED-AMT             26450021
MUCFIX        MOVE PV-EXTENDED-AMT       TO ML017-PC-OLD-PR-AMT         26451020
252400     ELSE                                                         26460000
252500        COMPUTE ML017-PC-OLD-PR-AMT = EPITM-CUST-CHRGD-AMT        26470000
252600                                    + EPLID-LID-AMT               26480000
252700     END-IF.                                                      26490000
252800                                                                  26500000
252900     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     26510000
253000                                                                  26520000
253100     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            26530000
253200                                 - ML017-PC-NEW-PR-AMT.           26540000
253300                                                                  26550000
253400     ADD +1                           TO PT-OWNERSHIP-ADJ-MUC-QTY 26560000
253500                                         (PV-TOT-SUB).            26570000
253600     ADD ML017-PC-DIFFER-AMT          TO PT-OWNERSHIP-ADJ-MUC-AMT 26580000
253700                                         (PV-TOT-SUB).            26590000
253800                                                                  26600000
253900******************************************************************26610000
254000 3500-PROMO-MARKDOWN-CANCEL.                                      26620000
254100*     PROCESS BACK OFFICE PROMO MARKDOWN CANCEL FOR QUALIFY RETURN26630000
062118*     ITEMS. SAL_RET_CDE = 'R' OR 'A' AND POC RETURN              26640000
254300******************************************************************26650000
254400                                                                  26660000
254500     SET ML017-MKDOWN                                             26670000
254600         ML017-MARKDOWN-CANCEL                                    26680000
254700         ML017-RC-PROMOTIONAL                                     26690000
254800         ML017-BN-PROMOTIONAL                                     26700000
254900         ML017-PLU-MKDN-MKON          TO TRUE.                    26710000
255000                                                                  26720000
255100     MOVE PC-746-PLU-TIER             TO                          26730000
255200          ML017-PC-MKDN-MKUP-RSN-CDE.                             26740000
255300     MOVE ZERO                        TO ML017-PC-OLD-PR-AMT.     26750000
255400     COMPUTE ML017-PC-NEW-PR-AMT = PV-EXTENDED-AMT                26760000
255500                                 + EPITM-CUST-CHRGD-AMT           26770000
255600                                                                  26780000
255700     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            26790000
255800                                 - ML017-PC-NEW-PR-AMT.           26800000
255900                                                                  26810000
256000     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   26820000
256100                                         (PV-TOT-SUB).            26830000
256200     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   26840000
256300                                         (PV-TOT-SUB).            26850000
256400                                                                  26860000
256500******************************************************************26870000
256600 3600-MARKDOWN-CANCEL.                                            26880000
256700*     PROCESS BACK OFFICE MARKDOWN CANCEL FOR QUALIFY SALE ITEMS. 26890000
256800*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '-'.              26900000
011618*     SAL_RET_CDE = 'R' AND POC RETURN                            26910000
256900******************************************************************26920000
257000                                                                  26930000
257100     SET ML017-MKDOWN                                             26940000
257200         ML017-MARKDOWN-CANCEL                                    26950000
257300         ML017-RC-MISCELLANEOUS                                   26960000
257400         ML017-BN-OWN-ADJ                                         26970000
257500         ML017-REGISTER-MKDN-MKON  TO TRUE.                       26980000
257600                                                                  26990000
257700     MOVE PC-OWN-ADJ-796           TO ML017-PC-MKDN-MKUP-RSN-CDE. 27000000
257800     MOVE ZERO                     TO ML017-PC-OLD-PR-AMT.        27010000
257900                                                                  27020000
258000     COMPUTE ML017-PC-NEW-PR-AMT = PV-EXTENDED-AMT                27030000
258100                                 - PV-CUST-CHRGD-AMT.             27040000
258200                                                                  27050000
258300     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            27060000
258400                                 - ML017-PC-NEW-PR-AMT.           27070000
258500                                                                  27080000
258600     ADD +1                        TO PT-OWNERSHIP-ADJ-MDC-QTY    27090000
258700                                      (PV-TOT-SUB).               27100000
258800     ADD ML017-PC-DIFFER-AMT       TO PT-OWNERSHIP-ADJ-MDC-AMT    27110000
258900                                      (PV-TOT-SUB).               27120000
259000                                                                  27130000
259100******************************************************************27140000
259200 3650-MARKDOWN-CORR-CANCEL.                                       27150000
259300*     PROCESS BACK OFFICE MARKDOWN CANCEL FOR QUALIFY SALE ITEMS. 27160000
259400******************************************************************27170000
259500                                                                  27180000
259600     SET ML017-MKDOWN                                             27190000
259700         ML017-RC-MISCELLANEOUS                                   27200000
259800         ML017-BN-OWN-ADJ                                         27210000
259900         ML017-REGISTER-MKDN-MKON  TO TRUE.                       27220000
260000                                                                  27230000
260100     COMPUTE PV-PRICE-CHANGE-AMOUNT = (EPITM-CUST-CHRGD-AMT       27240000
260200                                    +  EPITM-REG-RTL-AMT          27250000
260300                                    *  EPITM-SLD-QTY)             27260000
260400                                    *  -1.                        27270000
260500                                                                  27280000
260600     EVALUATE TRUE                                                27290000
260700        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        27300000
260800           MOVE PC-OWN-ADJ-796        TO                          27310000
260900                ML017-PC-MKDN-MKUP-RSN-CDE                        27320000
261000           SET ML017-MARKDOWN-CANCEL  TO TRUE                     27330000
261100           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      27340000
261200           MOVE PV-PRICE-CHANGE-AMOUNT                            27350000
261300                                      TO ML017-PC-NEW-PR-AMT      27360000
261400                                         ML017-PC-DIFFER-AMT      27370000
261500           ADD +1                     TO                          27380000
261600               PT-OWNERSHIP-ADJ-MDC-QTY (PV-TOT-SUB)              27390000
261700           ADD ML017-PC-DIFFER-AMT    TO PT-OWNERSHIP-ADJ-MDC-AMT 27400000
261800                                         (PV-TOT-SUB)             27410000
261900        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        27420000
262000           SET ML017-MARKDOWN         TO TRUE                     27430000
262100           MOVE EPITM-OWND-UNT-RTL-AMT                            27440000
262200                                      TO ML017-PC-NEW-PR-AMT      27450000
262300           MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-OLD-PR-AMT       27460000
262400                                                                  27470000
262500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      27480000
262600                                       - ML017-PC-NEW-PR-AMT      27490000
262700           MOVE PC-OWN-RTN-ADJ-792    TO                          27500000
262800                ML017-PC-MKDN-MKUP-RSN-CDE                        27510000
262900           SET ML017-BN-OWN-RTN-ADJ TO TRUE                       27520000
263000           ADD +1                  TO                             27530000
263100               PT-OWN-RETRN-ADJ-MKDN-QTY (PV-TOT-SUB)             27540000
263200           ADD ML017-PC-DIFFER-AMT TO                             27550000
263300                  PT-OWN-RETRN-ADJ-MKDN-AMT (PV-TOT-SUB)          27560000
263400        WHEN OTHER                                                27570000
263500           MOVE ZERO TO ML017-PC-DIFFER-AMT                       27580000
263600     END-EVALUATE.                                                27590000
263700                                                                  27600000
263800     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        27610000
263900                                                                  27620000
264000******************************************************************27630000
264100 3700-SALE-MARKUP.                                                27640000
264200*     PROCESS BACK OFFICE MARKUP FOR QUALIFY SALE ITEMS.          27650000
264300*     SAL_RET_CDE = 'S' AND 'A'. LIV-RSLU-CDE = '+'.              27660000
011618*     SAL_RET_CDE = 'R' AND POC RETURN.                           27670000
264400******************************************************************27680000
264500                                                                  27690000
264600     SET ML017-MKUP                                               27700000
264700         ML017-MARKUP                                             27710000
264800         ML017-RC-MISCELLANEOUS                                   27720000
264900         ML017-BN-OWN-ADJ                                         27730000
265000         ML017-REGISTER-MKDN-MKON     TO TRUE.                    27740000
265100                                                                  27750000
265200     MOVE PC-OWN-ADJ-796              TO                          27760000
265300          ML017-PC-MKDN-MKUP-RSN-CDE.                             27770000
265400     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-OLD-PR-AMT.     27780000
265500                                                                  27790000
265600     COMPUTE ML017-PC-NEW-PR-AMT = EPITM-CUST-CHRGD-AMT           27800000
265700                                 + EPITM-CUST-CHRGD-AMT           27810000
265800                                 - PV-EXTENDED-AMT.               27820000
265900                                                                  27830000
266000     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            27840000
266100                                 - ML017-PC-NEW-PR-AMT.           27850000
266200                                                                  27860000
266300     ADD +1                          TO PT-OWNERSHIP-ADJ-MKUP-QTY 27870000
266400                                        (PV-TOT-SUB).             27880000
266500     ADD ML017-PC-DIFFER-AMT         TO                           27890000
266600                                        PT-OWNERSHIP-ADJ-MKUP-AMT 27900000
266700                                        (PV-TOT-SUB).             27910000
266800                                                                  27920000
266900******************************************************************27930000
267000 3800-PROMO-MARKDOWN.                                             27940000
267100*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         27950000
267200******************************************************************27960000
267300                                                                  27970000
267400     SET ML017-MKDOWN                                             27980000
267500         ML017-MARKDOWN                                           27990000
267600         ML017-RC-PROMOTIONAL                                     28000000
267700         ML017-BN-PROMOTIONAL                                     28010000
267800         ML017-PLU-MKDN-MKON          TO TRUE.                    28020000
267900                                                                  28030000
268000     MOVE PC-746-PLU-TIER             TO                          28040000
268100          ML017-PC-MKDN-MKUP-RSN-CDE.                             28050000
268200     MOVE PV-EXTENDED-AMT             TO ML017-PC-OLD-PR-AMT.     28060000
268300     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     28070000
268400                                                                  28080000
268500     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            28090000
268600                                 - ML017-PC-NEW-PR-AMT.           28100000
268700                                                                  28110000
268800     ADD +1                           TO PT-PROMOTIONAL-MKDN-QTY  28120000
268900                                         (PV-TOT-SUB).            28130000
269000     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MKDN-AMT  28140000
269100                                         (PV-TOT-SUB).            28150000
269200                                                                  28160000
214615******************************************************************28170000
214615 3850-PROMO-MARKDOWN2.                                            28180000
214615*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         28190000
214615******************************************************************28200000
214615                                                                  28210000
214615     SET ML017-MKDOWN                                             28220000
214615         ML017-MARKDOWN-CANCEL                                    28230000
214615         ML017-RC-PROMOTIONAL                                     28240000
214615         ML017-BN-PROMOTIONAL                                     28250000
214615         ML017-PLU-MKDN-MKON          TO TRUE.                    28260000
214615                                                                  28270000
214615     MOVE PC-746-PLU-TIER             TO                          28271000
214615                                      ML017-PC-MKDN-MKUP-RSN-CDE. 28272000
214615     MOVE EPITM-ORIG-REG-RTL-AMT      TO ML017-PC-OLD-PR-AMT.     28273000
214615     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     28274000
214615                                                                  28275000
214615     COMPUTE ML017-PC-DIFFER-AMT = (ML017-PC-OLD-PR-AMT           28276000
214615                                 -  ML017-PC-NEW-PR-AMT) * -1.    28277000
214615                                                                  28278000
226892* ADDED THE FOLLOWING TO FIX ML PRODUCTION ISSUE WITH MDC         28279000
226892* RELATED TO MLKUP021'S MDC TO MD FLIP LOGIC                      28280000
226892     MOVE ZERO                   TO ML017-PC-OLD-PR-AMT.          28280100
226892     MOVE ML017-PC-DIFFER-AMT    TO ML017-PC-NEW-PR-AMT.          28280200
226892                                                                  28280300
214615     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   28280400
214615                                         (PV-TOT-SUB).            28280500
214615     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   28280600
214615                                         (PV-TOT-SUB).            28280700
214615                                                                  28280800
214615******************************************************************28280900
214615 3860-PROMO-MARKUP2.                                              28281000
214615*     PROCESS PROMOTIONAL MARKDOWN ITEMS.                         28282000
214615******************************************************************28282100
214615                                                                  28282200
214615     SET ML017-MKUP                                               28282300
214615         ML017-RC-PROMOTIONAL                                     28282400
214615         ML017-BN-PROMOTIONAL                                     28282500
214615         ML017-PLU-MKDN-MKON          TO TRUE.                    28282600
214615                                                                  28282700
214615     MOVE PC-746-PLU-TIER             TO                          28282800
214615                                      ML017-PC-MKDN-MKUP-RSN-CDE. 28282900
214615     MOVE EPITM-ORIG-REG-RTL-AMT      TO ML017-PC-OLD-PR-AMT.     28283000
214615     MOVE EPITM-REG-RTL-AMT           TO ML017-PC-NEW-PR-AMT.     28283100
214615                                                                  28283200
214615     COMPUTE ML017-PC-DIFFER-AMT = (ML017-PC-OLD-PR-AMT           28283300
214615                                 -  ML017-PC-NEW-PR-AMT) * -1.    28283400
214615                                                                  28283500
214615     ADD +1                           TO PT-PROMOTIONAL-MDC-QTY   28283600
214615                                         (PV-TOT-SUB).            28283700
214615     ADD ML017-PC-DIFFER-AMT          TO PT-PROMOTIONAL-MDC-AMT   28283800
214615                                         (PV-TOT-SUB).            28283900
214615                                                                  28284000
269300******************************************************************28284100
269400 3900-SALE-MARKDOWN.                                              28284200
269500*     PROCESS SALE MARKDOWN ITEMS.                                28284300
269600******************************************************************28284400
269700                                                                  28284500
269800     SET ML017-MKDOWN                                             28284600
269900         ML017-MARKDOWN                                           28284700
270000         ML017-RC-MISCELLANEOUS                                   28284800
270100         ML017-BN-OWN-ADJ                                         28284900
270200         ML017-REGISTER-MKDN-MKON     TO TRUE.                    28285000
270300                                                                  28286000
270400     COMPUTE ML017-PC-OLD-PR-AMT = EPITM-CUST-CHRGD-AMT           28287000
270500                                 + (PV-EXTENDED-AMT               28288000
270600                                 -  EPITM-CUST-CHRGD-AMT).        28289000
270700                                                                  28290000
270800     IF EPITM-CUST-CHRGD-AMT     = ZERO                           28300000
270900        MOVE PC-704-KEYED-GWP      TO                             28310000
271000                                   ML017-PC-MKDN-MKUP-RSN-CDE     28320000
271100     ELSE                                                         28330000
271200        MOVE PC-OWN-ADJ-796        TO                             28340000
271300                                   ML017-PC-MKDN-MKUP-RSN-CDE     28350000
271400     END-IF.                                                      28360000
271500                                                                  28370000
271600     MOVE EPITM-CUST-CHRGD-AMT        TO ML017-PC-NEW-PR-AMT.     28380000
271700                                                                  28390000
271800     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            28400000
271900                                 - ML017-PC-NEW-PR-AMT.           28410000
272000                                                                  28420000
272100     ADD +1                           TO                          28430000
272200         PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB).                  28440000
272300                                                                  28450000
272400     ADD ML017-PC-DIFFER-AMT          TO                          28460000
272500         PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB).                  28470000
272600                                                                  28480000
272700******************************************************************28490000
272800 3950-SALE-CORRECTION-MARKDOWN.                                   28500000
272900*     PROCESS SALE CORRECTION MARKDOWN ITEMS.                     28510000
273000******************************************************************28520000
273100                                                                  28530000
273200     SET ML017-MKDOWN                                             28540000
273300         ML017-MARKDOWN                                           28550000
273400         ML017-RC-MISCELLANEOUS                                   28560000
273500         ML017-BN-OWN-ADJ                                         28570000
273600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    28580000
273700                                                                  28590000
273800     IF EPITM-CUST-CHRGD-AMT = ZERO                               28600000
273900        MOVE PC-704-KEYED-GWP TO ML017-PC-MKDN-MKUP-RSN-CDE       28610000
274000     ELSE                                                         28620000
274100        MOVE PC-OWN-ADJ-796   TO ML017-PC-MKDN-MKUP-RSN-CDE       28630000
274200     END-IF.                                                      28640000
274300                                                                  28650000
274400     MOVE EPITM-REG-RTL-AMT    TO ML017-PC-OLD-PR-AMT.            28660000
274500     MOVE EPITM-CUST-CHRGD-AMT TO ML017-PC-NEW-PR-AMT.            28670000
274600                                                                  28680000
274700     IF  ML017-PC-NEW-PR-AMT < ZERO                               28690000
274800         COMPUTE ML017-PC-NEW-PR-AMT =                            28700000
274900                 ML017-PC-NEW-PR-AMT * (-1)                       28710000
275000     END-IF.                                                      28720000
275100                                                                  28730000
275200     COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT            28740000
275300                                 - ML017-PC-NEW-PR-AMT.           28750000
275400                                                                  28760000
275500     ADD +1                    TO                                 28770000
275600         PT-OWNERSHIP-ADJ-MKDN-QTY (PV-TOT-SUB).                  28780000
275700                                                                  28790000
275800     ADD ML017-PC-DIFFER-AMT   TO                                 28800000
275900         PT-OWNERSHIP-ADJ-MKDN-AMT (PV-TOT-SUB).                  28810000
276000                                                                  28820000
276100                                                                  28830000
276200     PERFORM 4000-PROCESS-MARKDOWN-MARKUP.                        28840000
276300                                                                  28850000
276400                                                                  28860000
276500******************************************************************28870000
276600 4000-PROCESS-MARKDOWN-MARKUP.                                    28880000
276700*     DETERMINE IF A RECORD SHOULD BE WRITTEN.                    28890000
276800******************************************************************28900000
276900                                                                  28910000
277000     MOVE +1 TO ML017-PC-QTY.                                     28920000
277100                                                                  28930000
277200     EVALUATE TRUE                                                28940000
277300        WHEN ML017-PC-DIFFER-AMT       = ZERO                     28950000
277400           CONTINUE                                               28960000
277500                                                                  28970000
277600        WHEN ML017-MKDOWN                                         28980000
277700           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    28990000
277800                                         PV-CUT-OFF-CCYY-MM-DD    29000000
277900              PERFORM 8025-WRITE-HOLD-LEDGR-MKDN-REC              29010000
278000              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  29020000
278200              PERFORM 8180-FORMAT-MW-RECORD                       29040000
278300              PERFORM 8190-WRITE-DATAWHSE-RECORD                  29050000
278400           ELSE                                                   29060000
278500              PERFORM 8000-WRITE-LEDGER-MKDN-RECORD               29070000
278600              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  29080000
278800              PERFORM 8180-FORMAT-MW-RECORD                       29100000
278900              PERFORM 8190-WRITE-DATAWHSE-RECORD                  29110000
279000           END-IF                                                 29120000
279100                                                                  29130000
279200        WHEN OTHER                                                29140000
279300           IF DPG55-DB2-ISO-DATE-FMT LESS THAN                    29150000
279400                                           PV-CUT-OFF-CCYY-MM-DD  29160000
279500              PERFORM 8125-WRITE-HOLD-LEDGR-MKUP-REC              29170000
279600              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  29180000
279800              PERFORM 8180-FORMAT-MW-RECORD                       29200000
279900              PERFORM 8190-WRITE-DATAWHSE-RECORD                  29210000
280000           ELSE                                                   29220000
280100              PERFORM 8100-WRITE-LEDGER-MKUP-RECORD               29230000
280200              MOVE EPITM-SLD-QTY TO ML017-PC-QTY                  29240000
280400              PERFORM 8180-FORMAT-MW-RECORD                       29260000
280500              PERFORM 8190-WRITE-DATAWHSE-RECORD                  29270000
280600           END-IF                                                 29280000
280700                                                                  29290000
280800     END-EVALUATE.                                                29300000
280900                                                                  29310000
281000                                                                  29320000
281100******************************************************************29330000
281200 4100-OPEN-LID-CURSOR.                                            29340000
281300*     OPEN TEPLID CURSOR TO PROCESS LINE ITEM DISCOUNTS.          29350000
281400******************************************************************29360000
281500                                                                  29370000
281600     MOVE ZERO TO PV-LID-SEQ-NBR.                                 29380000
281700                                                                  29390000
281800     EXEC SQL                                                     29400000
281900          OPEN TEPLID-CURSOR                                      29410000
282000     END-EXEC.                                                    29420000
282100                                                                  29430000
282200     EVALUATE TRUE                                                29440000
282300        WHEN SQLCODE = ZERO                                       29450000
282400           MOVE EPITM-CUST-CHRGD-AMT TO PV-EXCLUDE-LID-AMT        29460000
282500           SET PS-END-OF-LID-NO       TO TRUE                     29470000
282600        WHEN OTHER                                                29480000
282700           MOVE '4100-OPEN-LID-CURSOR'                            29490000
282800                                      TO PV-PARAGRAPH-NAME        29500000
282900           SET AC-DB2-ERROR           TO TRUE                     29510000
283000           PERFORM 9999-ABEND                                     29520000
283100     END-EVALUATE.                                                29530000
283200                                                                  29540000
283300******************************************************************29550000
283400 4200-FETCH-LID-CURSOR.                                           29560000
283500*     FETCH AND PROCESS LINE ITEM DISCOUNT INFORMATION.           29570000
283600******************************************************************29580000
283700                                                                  29590000
283800     EXEC SQL                                                     29600000
283900          FETCH TEPLID-CURSOR                                     29610000
284000          INTO  :EPLID-LID-AMT                                    29620000
284100               ,:EPLID-LID-RSN-CDE                                29630000
284200     END-EXEC.                                                    29640000
284300                                                                  29650000
284400     EVALUATE TRUE                                                29660000
284500         WHEN SQLCODE = ZERO                                      29670000
284600            ADD +1 TO PV-LID-SEQ-NBR                              29680000
284700                                                                  29690000
284800             PERFORM 4400-PROCESS-LID                             29700000
284900             PERFORM 4000-PROCESS-MARKDOWN-MARKUP                 29710000
285000         WHEN SQLCODE = PC-ROW-NOT-FOUND                          29720000
285100             SET PS-END-OF-LID-YES    TO TRUE                     29730000
285200         WHEN OTHER                                               29740000
285300             MOVE '4200-FETCH-LID-CURSOR'                         29750000
285400                                      TO PV-PARAGRAPH-NAME        29760000
285500             SET AC-DB2-ERROR           TO TRUE                   29770000
285600             PERFORM 9999-ABEND                                   29780000
285700     END-EVALUATE.                                                29790000
285800                                                                  29800000
285900******************************************************************29810000
286000 4300-CLOSE-LID-CURSOR.                                           29820000
286100******************************************************************29830000
286200                                                                  29840000
286300     EXEC SQL                                                     29850000
286400          CLOSE TEPLID-CURSOR                                     29860000
286500     END-EXEC.                                                    29870000
286600                                                                  29880000
286700     EVALUATE TRUE                                                29890000
286800        WHEN SQLCODE = ZERO                                       29900000
286900           CONTINUE                                               29910000
287000        WHEN OTHER                                                29920000
287100           MOVE '4300-CLOSE-LID-CURSOR'                           29930000
287200                                            TO PV-PARAGRAPH-NAME  29940000
287300           SET AC-DB2-ERROR           TO TRUE                     29950000
287400           PERFORM 9999-ABEND                                     29960000
287500     END-EVALUATE.                                                29970000
287600                                                                  29980000
287700******************************************************************29990000
287800 4400-PROCESS-LID.                                                30000000
287900*     PROCESS LINE ITEM DISCOUNTS. PV-EXCLUDE-LID-AMT HOLDS       30010000
288000*     AMOUNT OF EPITM-CUST-CHRGD-AMT - SUM OF PREVIOUS            30020000
288100*     EPLID-LID-AMT FOR THE ITEM.                                 30030000
288200******************************************************************30040000
288300                                                                  30050000
288400     MOVE EPLID-LID-RSN-CDE        TO ML017-PC-MKDN-MKUP-RSN-CDE. 30060000
288500     MOVE PV-EXCLUDE-LID-AMT       TO PV-CUST-CHRGD-AMT.          30070000
288600     MOVE EPITM-NET-CHRGD-AMT      TO PV-NET-CHRGD-AMT.           30080000
288700     COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1).       30090000
288800                                                                  30100000
288900     PERFORM 4450-DETERMINE-LID-TYPE                              30110000
289000                                                                  30120000
289100     IF EPITM-LIV-RSLU-CDE      = '-'                             30130000
289200        COMPUTE PV-EXCLUDE-LID-AMT = PV-EXCLUDE-LID-AMT           30140000
289300                                   - EPLID-LID-AMT                30150000
289400     ELSE                                                         30160000
289500        COMPUTE PV-EXCLUDE-LID-AMT = PV-EXCLUDE-LID-AMT           30170000
289600                                   + EPLID-LID-AMT                30180000
289700     END-IF.                                                      30190000
289800                                                                  30200000
289900******************************************************************30210000
290000 4450-DETERMINE-LID-TYPE.                                         30220000
290100*    DETERMINE WHAT TYPE IS BEING WORKED WITH TO DETERMINED MARKDO30230000
290200******************************************************************30240000
290300                                                                  30250000
290400     EVALUATE EPLID-LID-RSN-CDE                                   30260000
205464        WHEN PC-710-NON-RCPT-RTRN                                 30270000
205464           MOVE PC-710-NON-RCPT-RTRN  TO                          30280000
205464                ML017-PC-MKDN-MKUP-RSN-CDE                        30290000
205464           PERFORM 4841-PROCESS-NON-RCPT-RTRN                     30300000
290500        WHEN PC-746-PLU-TIER                                      30310000
290600        WHEN PC-ADDTL-PROMO-OFF-774                               30320000
290700           PERFORM 4500-PROCESS-TIERED-LID                        30330000
290800        WHEN PC-GOLDSTAR-753                                      30340000
290900           PERFORM 4600-PROCESS-GOLDSTAR-LID                      30350000
262807        WHEN PC-SEPHORA-720                                       30352033
262807           PERFORM 4650-PROCESS-SEPHORA-LID                       30353033
291000        WHEN PC-SENIOR-CIT-728                                    30360000
291100           PERFORM 4700-SENIOR-CITIZEN-LID                        30370000
291200        WHEN PC-KOHLS-CPON-733                                    30380000
291300           PERFORM 4800-PROCESS-TLCD-LID                          30390000
291400        WHEN PC-760-OFFER-COUPON                                  30400000
291500           PERFORM 4810-PROCESS-OFFER-COUPON                      30410000
291600        WHEN PC-761-OFFER-TLD-TIERED                              30420000
291700           PERFORM 4820-PROCESS-OFFER-TLD-TIERED                  30430000
291800        WHEN PC-762-OFFER-LID-TIERED                              30440000
291900           PERFORM 4830-PROCESS-OFFER-LID-TIERED                  30450000
292000        WHEN PC-763-OFFER-GWP-PWP-PRORATED                        30460000
292100           PERFORM 4840-PROCESS-OFFER-GWP-PWP                     30470000
292200        WHEN PC-765-GFT-RCPT-RTRN                                 30480000
292300           MOVE PC-765-GFT-RCPT-RTRN  TO                          30490000
292400                ML017-PC-MKDN-MKUP-RSN-CDE                        30500000
292500           PERFORM 4842-PROCESS-GFT-RCPT-RTRN                     30510000
292600        WHEN PC-BOGO-775                                          30520000
292700*****  REMOVE THIS CODE 3 MONTHS AFTER BOGO III GOES IN. *BEGIN*  30530000
292800        WHEN PC-BOGO-777                                          30540000
292900           MOVE PC-BOGO-775           TO                          30550000
293000                ML017-PC-MKDN-MKUP-RSN-CDE                        30560000
293100*****  REMOVE THIS CODE 3 MONTHS AFTER BOGO III GOES IN. *END*    30570000
293200           PERFORM 4850-PROCESS-BOGO-LID                          30580000
293300        WHEN PC-UNEARNED-REWARDS-780                              30590000
293400           MOVE PC-UNEARNED-REWARDS-780    TO                     30600000
293500                ML017-PC-MKDN-MKUP-RSN-CDE                        30610000
293600           PERFORM 4860-PROCESS-UNEARNED-RWDS-LID                 30620000
293700        WHEN OTHER                                                30630000
293800           PERFORM 4900-PROCESS-NORMAL-LID                        30640000
293900     END-EVALUATE.                                                30650000
294000                                                                  30660000
294100******************************************************************30670000
294200 4500-PROCESS-TIERED-LID.                                         30680000
294300*     PROCESS TIERRED ITEMS.                                      30690000
294400******************************************************************30700000
294500                                                                  30710000
294600     SET ML017-MKDOWN                                             30720000
294700         ML017-RC-PROMOTIONAL                                     30730000
294800         ML017-BN-PROMOTIONAL                                     30740000
294900         ML017-PLU-MKDN-MKON          TO TRUE.                    30750000
295000                                                                  30760000
295100     IF EPITM-LIV-RSLU-CDE          = '+' AND                     30770000
062118        EPLID-LID-AMT               > 0 AND                       30780000
062118        (EPITM-SAL-RET-CDE           = 'R' OR                     30790000
062118         EPITM-SAL-RET-CDE           = 'B')                       30800000
040220        MOVE 0                     TO ML017-PC-OLD-PR-AMT         30810000
040220        MOVE EPLID-LID-AMT         TO ML017-PC-NEW-PR-AMT         30820000
040220* MAKE THIS NEGATIVE FOR THE SPREADSHEET AND REPORT DUE TO        30830000
040220* MLKUP021 FLIPPING FROM MDC TO MD WHENVER OLD > NEW              30840000
040220        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1)     30850000
295700     ELSE                                                         30860000
295800        COMPUTE PV-PRICE-CHANGE-AMOUNT = EPLID-LID-AMT * (-1)     30870000
295900        COMPUTE ML017-PC-OLD-PR-AMT = PV-EXCLUDE-LID-AMT          30880000
296000                                    - EPLID-LID-AMT               30890000
296100                                                                  30900000
296200        MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-NEW-PR-AMT         30910000
296300     END-IF.                                                      30920000
296400                                                                  30930000
296500     IF PV-PRICE-CHANGE-AMOUNT   < ZERO                           30940000
296600        SET ML017-MARKDOWN-CANCEL      TO TRUE                    30950000
296700     ELSE                                                         30960000
296800        SET ML017-MARKDOWN       TO TRUE                          30970000
296900     END-IF.                                                      30980000
297000                                                                  30990000
297100     MOVE PV-PRICE-CHANGE-AMOUNT      TO ML017-PC-DIFFER-AMT.     31000000
297200                                                                  31010000
297300     IF ML017-MARKDOWN                                            31020000
297400        ADD +1                        TO PT-TIERED-MKDN-QTY       31030000
297500                                         (PV-TOT-SUB)             31040000
297600        ADD ML017-PC-DIFFER-AMT       TO PT-TIERED-MKDN-AMT       31050000
297700                                         (PV-TOT-SUB)             31060000
297800     ELSE                                                         31070000
297900        ADD +1                        TO PT-TIERED-MDC-QTY        31080000
298000                                         (PV-TOT-SUB)             31090000
298100        ADD ML017-PC-DIFFER-AMT       TO PT-TIERED-MDC-AMT        31100000
298200                                         (PV-TOT-SUB)             31110000
298300     END-IF.                                                      31120000
298400                                                                  31130000
298500******************************************************************31140000
298600 4600-PROCESS-GOLDSTAR-LID.                                       31150000
298700*     PROCESS GOLDSTAR ITEMS.                                     31160000
298800******************************************************************31170000
298900                                                                  31180000
299000     SET ML017-MKDOWN                                             31190000
299100         ML017-RC-MISCELLANEOUS                                   31200000
299200         ML017-BN-GOLDSTAR            TO TRUE.                    31210000
299300                                                                  31220000
299400     SET ML017-REGISTER-MKDN-MKON     TO TRUE.                    31230000
299500                                                                  31240000
299600     EVALUATE TRUE                                                31250000
299700        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO                        31260000
299800           SET ML017-MARKDOWN         TO TRUE                     31270000
299900           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      31280000
300000                                                                  31290000
300100           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       31300000
300200                                       + EPLID-LID-AMT            31310000
300300                                                                  31320000
300400           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31330000
300500                                       - ML017-PC-NEW-PR-AMT      31340000
300600                                                                  31350000
300700           ADD +1                     TO PT-GOLDSTAR-MKDN-QTY     31360000
300800                                         (PV-TOT-SUB)             31370000
300900           ADD ML017-PC-DIFFER-AMT                                31380000
301000                                      TO PT-GOLDSTAR-MKDN-AMT     31390000
301100                                         (PV-TOT-SUB)             31400000
301200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        31410000
301300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     31420000
301400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      31430000
301500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   31440000
301600                                       * (-1)                     31450000
301700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31460000
301800                                       - ML017-PC-NEW-PR-AMT      31470000
301900           ADD +1                     TO PT-GOLDSTAR-MDC-QTY      31480000
302000                                         (PV-TOT-SUB)             31490000
302100           ADD ML017-PC-DIFFER-AMT    TO PT-GOLDSTAR-MDC-AMT      31500000
302200                                         (PV-TOT-SUB)             31510000
302300        WHEN OTHER                                                31520000
302400           MOVE ZERO                  TO ML017-PC-DIFFER-AMT      31530000
302500     END-EVALUATE.                                                31540000
302600                                                                  31550000
262807******************************************************************31550133
262807 4650-PROCESS-SEPHORA-LID.                                        31551033
262807*     PROCESS SEPHORA DISCOUNTS                                   31551433
262807*     (COPIED PARA 4810-PROCESS-OFFER-COUPON FOR 760 LIDS)        31551533
262807******************************************************************31551633
262807                                                                  31551733
262807     SET ML017-MKDOWN                                             31551833
262807         ML017-RC-MISCELLANEOUS                                   31551933
262807         ML017-BN-SEPHORA-DISCOUNT                                31552033
262807         ML017-REGISTER-MKDN-MKON     TO TRUE.                    31552133
262807                                                                  31552233
262807     EVALUATE TRUE                                                31552333
262807        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     31552433
262807           SET ML017-MARKDOWN         TO TRUE                     31552533
262807           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      31552633
262807           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       31552733
262807                                       + EPLID-LID-AMT            31552833
262807                                                                  31552933
262807           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31553033
262807                                       - ML017-PC-NEW-PR-AMT      31553133
262807                                                                  31553233
262807           ADD +1 TO PT-720-SEPHORA-MKDN-QTY                      31553333
262807                                                (PV-TOT-SUB)      31553433
262807           ADD ML017-PC-DIFFER-AMT TO                             31553533
262807                               PT-720-SEPHORA-MKDN-AMT            31553633
262807                                                 (PV-TOT-SUB)     31553733
262807        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        31553833
262807           SET ML017-MARKDOWN-CANCEL  TO TRUE                     31553933
262807           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      31554033
262807           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   31554133
262807                                       * (-1)                     31554233
262807           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31554333
262807                                       - ML017-PC-NEW-PR-AMT      31554433
262807           ADD +1 TO PT-720-SEPHORA-MDC-QTY                       31554533
262807                                                 (PV-TOT-SUB)     31554633
262807           ADD ML017-PC-DIFFER-AMT TO                             31554733
262807                             PT-720-SEPHORA-MDC-AMT               31554833
262807                                                 (PV-TOT-SUB)     31554933
262807        WHEN OTHER                                                31555033
262807           MOVE ZERO TO ML017-PC-DIFFER-AMT                       31555133
262807     END-EVALUATE.                                                31555233
262807                                                                  31555333
262807                                                                  31556033
302700******************************************************************31560000
302800 4700-SENIOR-CITIZEN-LID.                                         31570000
302900*     PROCESS SENIOR CITIZEN DISCOUNT.                            31580000
303000******************************************************************31590000
303100                                                                  31600000
303200     SET ML017-MKDOWN                                             31610000
303300         ML017-RC-MISCELLANEOUS                                   31620000
303400         ML017-BN-SENIOR-CITZ-DISC                                31630000
303500         ML017-REGISTER-MKDN-MKON     TO TRUE.                    31640000
303600                                                                  31650000
303700     EVALUATE TRUE                                                31660000
303800        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     31670000
303900           SET ML017-MARKDOWN         TO TRUE                     31680000
304000           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      31690000
304100                                                                  31700000
304200           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       31710000
304300                                       + EPLID-LID-AMT            31720000
304400                                                                  31730000
304500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31740000
304600                                       - ML017-PC-NEW-PR-AMT      31750000
304700                                                                  31760000
304800           ADD +1                     TO                          31770000
304900               PT-SENIOR-CITIZEN-MKDN-QTY (PV-TOT-SUB)            31780000
305000           ADD ML017-PC-DIFFER-AMT    TO                          31790000
305100               PT-SENIOR-CITIZEN-MKDN-AMT (PV-TOT-SUB)            31800000
305200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        31810000
305300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     31820000
305400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      31830000
305500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   31840000
305600                                       * (-1)                     31850000
305700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      31860000
305800                                       - ML017-PC-NEW-PR-AMT      31870000
305900           ADD +1 TO PT-SENIOR-CITIZEN-MDC-QTY                    31880000
306000                                                 (PV-TOT-SUB)     31890000
306100           ADD ML017-PC-DIFFER-AMT TO                             31900000
306200               PT-SENIOR-CITIZEN-MDC-AMT (PV-TOT-SUB)             31910000
306300        WHEN OTHER                                                31920000
306400           MOVE ZERO TO ML017-PC-DIFFER-AMT                       31930000
306500     END-EVALUATE.                                                31940000
306600                                                                  31950000
306700******************************************************************31960000
306800 4800-PROCESS-TLCD-LID.                                           31970000
306900*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        31980000
307000******************************************************************31990000
307100                                                                  32000000
307200     SET ML017-MKDOWN                                             32010000
307300         ML017-RC-MISCELLANEOUS                                   32020000
307400         ML017-BN-KOHLS-COUPON                                    32030000
307500         ML017-REGISTER-MKDN-MKON     TO TRUE.                    32040000
307600                                                                  32050000
307700     EVALUATE TRUE                                                32060000
307800        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     32070000
307900           SET ML017-MARKDOWN         TO TRUE                     32080000
308000           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      32090000
308100           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       32100000
308200                                       + EPLID-LID-AMT            32110000
308300                                                                  32120000
308400           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32130000
308500                                       - ML017-PC-NEW-PR-AMT      32140000
040220* ADDED THE BELOW CODE TO FIX INCORRECT MARKDOWN AMOUNT FROM      32150000
040220* BEING TAKEN ON SALES ON WHICH THE ITEM PRICE WAS INFLATED VIA   32160000
040220* A MANUAL LID (INCREASING THE PRICE)                             32170000
040220           COMPUTE PV-NEW-PR-AMT  = PV-EXCLUDE-LID-AMT            32180000
040220                                  + EPLID-LID-AMT                 32190000
040220           IF PV-NEW-PR-AMT < 0                                   32200000
040220               COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT  32210000
040220                                           - PV-NEW-PR-AMT        32220000
040220               MOVE ML017-PC-DIFFER-AMT TO ML017-PC-OLD-PR-AMT    32230000
040220               MOVE 0                   TO ML017-PC-NEW-PR-AMT    32240000
040220           END-IF                                                 32250000
308600                                                                  32260000
308700           ADD +1 TO PT-KOHLS-COUPON-MKDN-QTY                     32261000
308800                                                (PV-TOT-SUB)      32262000
308900           ADD ML017-PC-DIFFER-AMT TO                             32263000
309000                               PT-KOHLS-COUPON-MKDN-AMT           32264000
309100                                                 (PV-TOT-SUB)     32265000
309200        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        32266000
309300           SET ML017-MARKDOWN-CANCEL  TO TRUE                     32267000
309400           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      32268000
309500           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   32269000
309600                                       * (-1)                     32270000
309700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32280000
309800                                       - ML017-PC-NEW-PR-AMT      32290000
309900           ADD +1 TO PT-KOHLS-COUPON-MDC-QTY                      32300000
310000                                                 (PV-TOT-SUB)     32310000
310100           ADD ML017-PC-DIFFER-AMT TO                             32320000
310200                             PT-KOHLS-COUPON-MDC-AMT              32330000
310300                                                 (PV-TOT-SUB)     32340000
310400        WHEN OTHER                                                32350000
310500           MOVE ZERO TO ML017-PC-DIFFER-AMT                       32360000
310600     END-EVALUATE.                                                32370000
310700                                                                  32380000
310800******************************************************************32390000
310900 4810-PROCESS-OFFER-COUPON.                                       32400000
311000*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        32410000
311100******************************************************************32420000
311200                                                                  32430000
311300     SET ML017-MKDOWN                                             32440000
311400         ML017-RC-MISCELLANEOUS                                   32450000
311500         ML017-BN-OFFER-COUPON                                    32460000
311600         ML017-REGISTER-MKDN-MKON     TO TRUE.                    32470000
311700                                                                  32480000
311800     EVALUATE TRUE                                                32490000
311900        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     32500000
312000           SET ML017-MARKDOWN         TO TRUE                     32510000
312100           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      32520000
312200           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       32530000
312300                                       + EPLID-LID-AMT            32540000
312400                                                                  32550000
312500           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32560000
312600                                       - ML017-PC-NEW-PR-AMT      32570000
312700                                                                  32580000
312800           ADD +1 TO PT-760-OFFER-MKDN-QTY                        32590000
312900                                                (PV-TOT-SUB)      32600000
313000           ADD ML017-PC-DIFFER-AMT TO                             32610000
313100                               PT-760-OFFER-MKDN-AMT              32620000
313200                                                 (PV-TOT-SUB)     32630000
313300        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        32640000
313400           SET ML017-MARKDOWN-CANCEL  TO TRUE                     32650000
313500           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      32660000
313600           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   32670000
313700                                       * (-1)                     32680000
313800           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32690000
313900                                       - ML017-PC-NEW-PR-AMT      32700000
314000           ADD +1 TO PT-760-OFFER-MDC-QTY                         32710000
314100                                                 (PV-TOT-SUB)     32720000
314200           ADD ML017-PC-DIFFER-AMT TO                             32730000
314300                             PT-760-OFFER-MDC-AMT                 32740000
314400                                                 (PV-TOT-SUB)     32750000
314500        WHEN OTHER                                                32760000
314600           MOVE ZERO TO ML017-PC-DIFFER-AMT                       32770000
314700     END-EVALUATE.                                                32780000
314800                                                                  32790000
314900******************************************************************32800000
315000 4820-PROCESS-OFFER-TLD-TIERED.                                   32810000
315100*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        32820000
315200******************************************************************32830000
315300                                                                  32840000
315400     SET ML017-MKDOWN                                             32850000
315500         ML017-RC-MISCELLANEOUS                                   32860000
315600         ML017-BN-OFFER-TLD-TIERED                                32870000
315700         ML017-REGISTER-MKDN-MKON     TO TRUE.                    32880000
315800                                                                  32890000
315900     EVALUATE TRUE                                                32900000
316000        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     32910000
316100           SET ML017-MARKDOWN         TO TRUE                     32920000
316200           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      32930000
316300           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       32940000
316400                                       + EPLID-LID-AMT            32950000
316500                                                                  32960000
316600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      32970000
316700                                       - ML017-PC-NEW-PR-AMT      32980000
316800                                                                  32990000
316900           ADD +1 TO PT-761-TLDTIER-MKDN-QTY                      33000000
317000                                                (PV-TOT-SUB)      33010000
317100           ADD ML017-PC-DIFFER-AMT TO                             33020000
317200                               PT-761-TLDTIER-MKDN-AMT            33030000
317300                                                 (PV-TOT-SUB)     33040000
317400        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        33050000
317500           SET ML017-MARKDOWN-CANCEL  TO TRUE                     33060000
317600           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      33070000
317700           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   33080000
317800                                       * (-1)                     33090000
317900           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33100000
318000                                       - ML017-PC-NEW-PR-AMT      33110000
318100           ADD +1 TO PT-761-TLDTIER-MDC-QTY                       33120000
318200                                                 (PV-TOT-SUB)     33130000
318300           ADD ML017-PC-DIFFER-AMT TO                             33140000
318400                             PT-761-TLDTIER-MDC-AMT               33150000
318500                                                 (PV-TOT-SUB)     33160000
318600        WHEN OTHER                                                33170000
318700           MOVE ZERO TO ML017-PC-DIFFER-AMT                       33180000
318800     END-EVALUATE.                                                33190000
318900                                                                  33200000
319000******************************************************************33210000
319100 4830-PROCESS-OFFER-LID-TIERED.                                   33220000
319200*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        33230000
319300******************************************************************33240000
319400                                                                  33250000
319500     SET ML017-MKDOWN                                             33260000
319600         ML017-RC-MISCELLANEOUS                                   33270000
319700         ML017-BN-OFFER-LID-TIERED                                33280000
319800         ML017-REGISTER-MKDN-MKON     TO TRUE.                    33290000
319900                                                                  33300000
320000     EVALUATE TRUE                                                33310000
320100        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     33320000
320200           SET ML017-MARKDOWN         TO TRUE                     33330000
320300           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      33340000
320400           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       33350000
320500                                       + EPLID-LID-AMT            33360000
320600                                                                  33370000
320700           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33380000
320800                                       - ML017-PC-NEW-PR-AMT      33390000
320900                                                                  33400000
321000           ADD +1 TO PT-762-LIDTIER-MKDN-QTY                      33410000
321100                                                (PV-TOT-SUB)      33420000
321200           ADD ML017-PC-DIFFER-AMT TO                             33430000
321300                               PT-762-LIDTIER-MKDN-AMT            33440000
321400                                                 (PV-TOT-SUB)     33450000
321500        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        33460000
321600           SET ML017-MARKDOWN-CANCEL  TO TRUE                     33470000
321700           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      33480000
321800           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   33490000
321900                                       * (-1)                     33500000
322000           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33510000
322100                                       - ML017-PC-NEW-PR-AMT      33520000
322200           ADD +1 TO PT-762-LIDTIER-MDC-QTY                       33530000
322300                                                 (PV-TOT-SUB)     33540000
322400           ADD ML017-PC-DIFFER-AMT TO                             33550000
322500                             PT-762-LIDTIER-MDC-AMT               33560000
322600                                                 (PV-TOT-SUB)     33570000
322700        WHEN OTHER                                                33580000
322800           MOVE ZERO TO ML017-PC-DIFFER-AMT                       33590000
322900     END-EVALUATE.                                                33600000
323000                                                                  33610000
323100******************************************************************33620000
323200 4840-PROCESS-OFFER-GWP-PWP.                                      33630000
323300*     PROCESS TRANSACTION LEVEL DISCOUNTS.                        33640000
323400******************************************************************33650000
323500                                                                  33660000
323600     SET ML017-MKDOWN                                             33670000
323700         ML017-RC-MISCELLANEOUS                                   33680000
323800         ML017-BN-OFFER-GWP-PWP                                   33690000
323900         ML017-REGISTER-MKDN-MKON     TO TRUE.                    33700000
324000                                                                  33710000
324100     EVALUATE TRUE                                                33720000
324200        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     33730000
324300           SET ML017-MARKDOWN         TO TRUE                     33740000
324400           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      33750000
324500           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       33760000
324600                                       + EPLID-LID-AMT            33770000
324700                                                                  33780000
324800           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33790000
324900                                       - ML017-PC-NEW-PR-AMT      33800000
325000                                                                  33810000
325100           ADD +1 TO PT-763-GWPPWP-MKDN-QTY                       33820000
325200                                                (PV-TOT-SUB)      33830000
325300           ADD ML017-PC-DIFFER-AMT TO                             33840000
325400                               PT-763-GWPPWP-MKDN-AMT             33850000
325500                                                 (PV-TOT-SUB)     33860000
325600        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        33870000
325700           SET ML017-MARKDOWN-CANCEL  TO TRUE                     33880000
325800           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      33890000
325900           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   33900000
326000                                       * (-1)                     33910000
326100           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      33920000
326200                                       - ML017-PC-NEW-PR-AMT      33930000
326300           ADD +1 TO PT-763-GWPPWP-MDC-QTY                        33940000
326400                                                 (PV-TOT-SUB)     33950000
326500           ADD ML017-PC-DIFFER-AMT TO                             33960000
326600                             PT-763-GWPPWP-MDC-AMT                33970000
326700                                                 (PV-TOT-SUB)     33980000
326800        WHEN OTHER                                                33990000
326900           MOVE ZERO TO ML017-PC-DIFFER-AMT                       34000000
327000     END-EVALUATE.                                                34010000
327100                                                                  34020000
205464******************************************************************34030000
205464 4841-PROCESS-NON-RCPT-RTRN.                                      34040000
205464*     PROCESS NON RECEIPT RETURNS                                 34050000
205464******************************************************************34060000
205464                                                                  34070000
205464     SET ML017-MKDOWN                                             34080000
205464         ML017-RC-MISCELLANEOUS                                   34090000
205464         ML017-BN-NON-RCPT-RETURN                                 34100000
205464         ML017-REGISTER-MKDN-MKON     TO TRUE.                    34110000
205464                                                                  34120000
205464     EVALUATE TRUE                                                34130000
205464        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     34140000
205464           SET ML017-MARKDOWN         TO TRUE                     34150000
205464           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      34160000
205464           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       34170000
205464                                       + EPLID-LID-AMT            34180000
205464                                                                  34190000
205464           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      34200000
205464                                       - ML017-PC-NEW-PR-AMT      34210000
205464                                                                  34220000
205464           ADD +1 TO PT-710-NORCPT-MKDN-QTY (PV-TOT-SUB)          34230000
205464           ADD ML017-PC-DIFFER-AMT    TO                          34240000
205464                               PT-710-NORCPT-MKDN-AMT(PV-TOT-SUB) 34250000
205464        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        34260000
205464           SET ML017-MARKDOWN-CANCEL  TO TRUE                     34270000
205464           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      34280000
205464           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   34290000
205464                                       * (-1)                     34300000
205464           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      34310000
205464                                       - ML017-PC-NEW-PR-AMT      34320000
205464           ADD +1 TO PT-710-NORCPT-MDC-QTY (PV-TOT-SUB)           34330000
205464           ADD ML017-PC-DIFFER-AMT    TO                          34340000
205464                               PT-710-NORCPT-MDC-AMT  (PV-TOT-SUB)34350000
205464        WHEN OTHER                                                34360000
205464           MOVE ZERO TO ML017-PC-DIFFER-AMT                       34370000
205464     END-EVALUATE.                                                34380000
205464                                                                  34390000
327200******************************************************************34400000
327300 4842-PROCESS-GFT-RCPT-RTRN.                                      34410000
327400*     PROCESS GIFT RECEIPT RETURNS                                34420000
327500******************************************************************34430000
327600                                                                  34440000
327700     SET ML017-MKDOWN                                             34450000
327800         ML017-RC-MISCELLANEOUS                                   34460000
327900         ML017-BN-UU-GFT-RCPT-RTRN                                34470000
328000         ML017-REGISTER-MKDN-MKON     TO TRUE.                    34480000
328100                                                                  34490000
328200     EVALUATE TRUE                                                34500000
328300        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     34510000
328400           SET ML017-MARKDOWN         TO TRUE                     34520000
328500           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      34530000
328600           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       34540000
328700                                       + EPLID-LID-AMT            34550000
328800                                                                  34560000
328900           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      34570000
329000                                       - ML017-PC-NEW-PR-AMT      34580000
329100                                                                  34590000
329200           ADD +1 TO PT-765-GIFT-MKDN-QTY (PV-TOT-SUB)            34600000
329300           ADD ML017-PC-DIFFER-AMT TO                             34610000
329400                                  PT-765-GIFT-MKDN-AMT(PV-TOT-SUB)34620000
329500        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        34630000
329600           SET ML017-MARKDOWN-CANCEL  TO TRUE                     34640000
329700           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      34650000
329800           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   34660000
329900                                       * (-1)                     34670000
330000           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      34680000
330100                                       - ML017-PC-NEW-PR-AMT      34690000
330200           ADD +1 TO PT-765-GIFT-MDC-QTY (PV-TOT-SUB)             34700000
330300           ADD ML017-PC-DIFFER-AMT TO                             34710000
330400                                  PT-765-GIFT-MDC-AMT (PV-TOT-SUB)34720000
330500        WHEN OTHER                                                34730000
330600           MOVE ZERO TO ML017-PC-DIFFER-AMT                       34740000
330700     END-EVALUATE.                                                34750000
330800                                                                  34760000
330900******************************************************************34770000
331000 4850-PROCESS-BOGO-LID.                                           34780000
331100*     PROCESS PRORATED BUY ONE GET ONE FREE PROMOTION.            34790000
331200******************************************************************34800000
331300                                                                  34810000
331400     SET ML017-MKDOWN                                             34820000
331500         ML017-RC-MISCELLANEOUS                                   34830000
331600         ML017-BN-BOGO                                            34840000
331700         ML017-PLU-MKDN-MKON          TO TRUE.                    34850000
331800                                                                  34860000
331900     EVALUATE TRUE                                                34870000
332000        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     34880000
332100           SET ML017-MARKDOWN         TO TRUE                     34890000
332200           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      34900000
332300           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       34910000
332400                                       + EPLID-LID-AMT            34920000
332500                                                                  34930000
332600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      34940000
332700                                       - ML017-PC-NEW-PR-AMT      34950000
332800                                                                  34960000
332900           ADD +1 TO PT-BOGO-MKDN-QTY (PV-TOT-SUB)                34970000
333000           ADD ML017-PC-DIFFER-AMT TO PT-BOGO-MKDN-AMT(PV-TOT-SUB)34980000
333100        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        34990000
333200           SET ML017-MARKDOWN-CANCEL  TO TRUE                     35000000
333300           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      35010000
333400           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   35020000
333500                                       * (-1)                     35030000
333600           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      35040000
333700                                       - ML017-PC-NEW-PR-AMT      35050000
333800           ADD +1 TO PT-BOGO-MDC-QTY (PV-TOT-SUB)                 35060000
333900           ADD ML017-PC-DIFFER-AMT TO PT-BOGO-MDC-AMT (PV-TOT-SUB)35070000
334000        WHEN OTHER                                                35080000
334100           MOVE ZERO TO ML017-PC-DIFFER-AMT                       35090000
334200     END-EVALUATE.                                                35100000
334300                                                                  35110000
334400******************************************************************35120000
334500 4860-PROCESS-UNEARNED-RWDS-LID.                                  35130000
334600*     PROCESS THE MARKDOWN CANCELS FOR UNEARNED REWARDS.          35140000
334700******************************************************************35150000
334800                                                                  35160000
334900     SET ML017-MKDOWN                                             35170000
335000         ML017-RC-MISCELLANEOUS                                   35180000
335100         ML017-BN-UNEARNED-RWDS                                   35190000
335200         ML017-REGISTER-MKDN-MKON     TO TRUE.                    35200000
335300                                                                  35210000
335400     EVALUATE TRUE                                                35220000
335500        WHEN PV-PRICE-CHANGE-AMOUNT    > ZERO                     35230000
335600           SET ML017-MARKDOWN         TO TRUE                     35240000
335700           MOVE PV-EXCLUDE-LID-AMT    TO ML017-PC-OLD-PR-AMT      35250000
335800           COMPUTE ML017-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT       35260000
335900                                       + EPLID-LID-AMT            35270000
336000                                                                  35280000
336100           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      35290000
336200                                       - ML017-PC-NEW-PR-AMT      35300000
336300                                                                  35310000
336400           ADD +1 TO PT-UNEARNED-RWDS-MKDN-QTY (PV-TOT-SUB)       35320000
336500           ADD ML017-PC-DIFFER-AMT TO                             35330000
336600                       PT-UNEARNED-RWDS-MKDN-AMT(PV-TOT-SUB)      35340000
336700        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        35350000
336800           SET ML017-MARKDOWN-CANCEL  TO TRUE                     35360000
336900           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      35370000
337000           COMPUTE ML017-PC-NEW-PR-AMT = PV-PRICE-CHANGE-AMOUNT   35380000
337100                                       * (-1)                     35390000
337200           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      35400000
337300                                       - ML017-PC-NEW-PR-AMT      35410000
337400           ADD +1 TO PT-UNEARNED-RWDS-MDC-QTY (PV-TOT-SUB)        35420000
337500           ADD ML017-PC-DIFFER-AMT TO                             35430000
337600                       PT-UNEARNED-RWDS-MDC-AMT (PV-TOT-SUB)      35440000
337700        WHEN OTHER                                                35450000
337800           MOVE ZERO TO ML017-PC-DIFFER-AMT                       35460000
337900     END-EVALUATE.                                                35470000
338000                                                                  35480000
338100******************************************************************35490000
338200 4900-PROCESS-NORMAL-LID.                                         35500000
338300*     PROCESS NORMAL DISCOUNTS.                                   35510000
338400******************************************************************35520000
338500                                                                  35530000
338600     SET ML017-MKDOWN                                             35540000
338700         ML017-RC-MISCELLANEOUS                                   35550000
338800         ML017-BN-MANUAL-LID                                      35560000
338900         ML017-REGISTER-MKDN-MKON     TO TRUE.                    35570000
339000                                                                  35580000
339100     IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753              35590000
339200        SET ML017-BN-GOLDSTAR TO TRUE                             35600000
339300     END-IF.                                                      35610000
339400                                                                  35620000
339500     EVALUATE TRUE                                                35630000
339600        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    35640000
339700             PV-EXCLUDE-LID-AMT   >= ZERO AND                     35650000
339800             (                                                    35660000
339900               (                                                  35670000
340000                (EPITM-NET-CHRGD-AMT > ZERO  OR                   35680000
340100                (EPITM-NET-CHRGD-AMT = 0                          35690000
340200                    AND (EPITM-SAL-RET-CDE = 'S' OR 'A') ))       35700000
340300                )                                                 35710000
340400             )                            AND                     35720000
340500                                                                  35730000
340600             PV-EXCLUDE-LID-AMT   >= EPITM-NET-CHRGD-AMT          35740000
340700                                                                  35750000
340800           SET ML017-MARKDOWN TO TRUE                             35760000
340900                                                                  35770000
341000** FIX DUE TO SIGN BEING DROPPED CAUSING CALCULATION TO BE WRONG  35780000
341100           MOVE PV-EXCLUDE-LID-AMT TO PV-PC-OLD-PR-AMT            35790000
341200           COMPUTE PV-PC-NEW-PR-AMT = PV-EXCLUDE-LID-AMT          35800000
341300                                       + EPLID-LID-AMT            35810000
341400           COMPUTE PV-PC-DIFFER-AMT = PV-PC-OLD-PR-AMT            35820000
341500                                       - PV-PC-NEW-PR-AMT         35830000
341600                                                                  35840000
341700           MOVE PV-PC-OLD-PR-AMT TO ML017-PC-OLD-PR-AMT           35850000
341800           MOVE PV-PC-NEW-PR-AMT TO ML017-PC-NEW-PR-AMT           35860000
341900           MOVE PV-PC-DIFFER-AMT TO ML017-PC-DIFFER-AMT           35870000
342000                                                                  35880000
342100                                                                  35890000
342200** FIX TO WHERE A GOLDSTAR LID IS RETRIEVED FROM THE ORIGIN SALE  35900000
342300** AND WAS PREVOIUSLY REPORTING AS MANUAL LID                     35910000
342400           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        35920000
342500               ADD +1                  TO PT-GOLDSTAR-MKDN-QTY    35930000
342600                                            (PV-TOT-SUB)          35940000
342700               ADD ML017-PC-DIFFER-AMT                            35950000
342800                                       TO PT-GOLDSTAR-MKDN-AMT    35960000
342900                                            (PV-TOT-SUB)          35970000
343000           ELSE                                                   35980000
343100               ADD +1                    TO PT-MANUAL-LID-MKDN-QTY35990000
343200                                           (PV-TOT-SUB)           36000000
343300               ADD ML017-PC-DIFFER-AMT   TO PT-MANUAL-LID-MKDN-AMT36010000
343400                                           (PV-TOT-SUB)           36020000
343500           END-IF                                                 36030000
343600                                                                  36040000
343700        WHEN PV-PRICE-CHANGE-AMOUNT < ZERO                        36050000
343800           SET ML017-MARKDOWN-CANCEL  TO TRUE                     36060000
343900           MOVE ZERO                  TO ML017-PC-OLD-PR-AMT      36070000
344000           MOVE EPLID-LID-AMT         TO ML017-PC-NEW-PR-AMT      36080000
344100           MOVE ML017-PC-NEW-PR-AMT   TO PV-NET-CHRGD-AMT         36090000
344200           COMPUTE ML017-PC-DIFFER-AMT = ML017-PC-OLD-PR-AMT      36100000
344300                                       - ML017-PC-NEW-PR-AMT      36110000
344400                                                                  36120000
344500** FIX TO WHERE A GOLDSTAR LID IS RETRIEVED FROM THE ORIGIN SALE  36130000
344600** AND WAS PREVOIUSLY REPORTING AS MANUAL LID                     36140000
344700           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        36150000
344800               ADD +1                  TO PT-GOLDSTAR-MDC-QTY     36160000
344900                                            (PV-TOT-SUB)          36170000
345000               ADD ML017-PC-DIFFER-AMT                            36180000
345100                                       TO PT-GOLDSTAR-MDC-AMT     36190000
345200                                            (PV-TOT-SUB)          36200000
345300           ELSE                                                   36210000
345400               ADD +1                  TO PT-MANUAL-LID-MDC-QTY   36220000
345500                                            (PV-TOT-SUB)          36230000
345600               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MDC-AMT   36240000
345700                                            (PV-TOT-SUB)          36250000
345800           END-IF                                                 36260000
345900                                                                  36270000
346000        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    36280000
346100             EPITM-CUST-CHRGD-AMT <= ZERO AND                     36290000
346200             EPITM-NET-CHRGD-AMT   <= ZERO AND                    36300000
011618             EPTRN-POS-CPBL-LVL-NBR = PC-POC AND                  36310000
062118             (EPITM-SAL-RET-CDE = 'R' OR                          36320000
062118              EPITM-SAL-RET-CDE = 'B')                            36330000
011618* WHEN IT'S A RETURN ITEM AND THE DISCOUNT WAS NEGATIVE           36340000
011618* WHICH MEANS THAT ON THE SALE, THIS DISCOUNT HAD RAISED THE      36350000
011618* COST OF THE ITEM (PRICE CORRECTION - MAN LID MARKUP) AND        36360000
011618* IT'S A POC TRANSACTION, THEN EXECUTE THE BELOW CODE.            36370000
011618           SET ML017-MARKDOWN TO TRUE                             36380000
040220           COMPUTE ML017-PC-OLD-PR-AMT =                          36390000
011618                              (PV-PRICE-CHANGE-AMOUNT * (-1))     36400000
040220           MOVE ZERO TO ML017-PC-NEW-PR-AMT                       36410000
011618           COMPUTE ML017-PC-DIFFER-AMT =                          36420000
011618                               (ML017-PC-OLD-PR-AMT -             36430000
011618                               ML017-PC-NEW-PR-AMT)               36440000
011618                                                                  36450000
011618           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        36460000
011618               ADD +1                  TO PT-GOLDSTAR-MKDN-QTY    36470000
011618                                            (PV-TOT-SUB)          36480000
011618               ADD ML017-PC-DIFFER-AMT                            36490000
011618                                       TO PT-GOLDSTAR-MKDN-AMT    36500000
011618                                            (PV-TOT-SUB)          36510000
011618           ELSE                                                   36520000
011618               ADD +1                  TO PT-MANUAL-LID-MKDN-QTY  36530000
011618                                            (PV-TOT-SUB)          36540000
011618               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MKDN-AMT  36550000
011618                                            (PV-TOT-SUB)          36560000
011618           END-IF                                                 36570000
346300                                                                  36580000
346000        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    36590000
346100             EPITM-CUST-CHRGD-AMT <= ZERO AND                     36600000
346200             EPITM-NET-CHRGD-AMT   <= ZERO                        36610000
346400        WHEN PV-PRICE-CHANGE-AMOUNT > ZERO AND                    36620000
346500             EPITM-CUST-CHRGD-AMT >= ZERO AND                     36630000
346600             EPITM-NET-CHRGD-AMT >= ZERO AND                      36640000
346700             EPITM-CUST-CHRGD-AMT <= EPITM-NET-CHRGD-AMT          36650000
346800                                                                  36660000
346900           SET ML017-MARKDOWN-CANCEL TO TRUE                      36670000
347000           MOVE ZERO TO ML017-PC-OLD-PR-AMT                       36680000
347100           COMPUTE ML017-PC-NEW-PR-AMT =                          36690000
347200                              (PV-PRICE-CHANGE-AMOUNT * (-1))     36700000
347300           COMPUTE ML017-PC-DIFFER-AMT =                          36710000
347400                               (ML017-PC-OLD-PR-AMT -             36720000
347500                               ML017-PC-NEW-PR-AMT)               36730000
347600                                                                  36740000
347700           IF ML017-PC-MKDN-MKUP-RSN-CDE = PC-GOLDSTAR-753        36750000
347800               ADD +1                  TO PT-GOLDSTAR-MDC-QTY     36760000
347900                                            (PV-TOT-SUB)          36770000
348000               ADD ML017-PC-DIFFER-AMT                            36780000
348100                                       TO PT-GOLDSTAR-MDC-AMT     36790000
348200                                            (PV-TOT-SUB)          36800000
348300           ELSE                                                   36810000
348400               ADD +1                  TO PT-MANUAL-LID-MDC-QTY   36820000
348500                                            (PV-TOT-SUB)          36830000
348600               ADD ML017-PC-DIFFER-AMT TO PT-MANUAL-LID-MDC-AMT   36840000
348700                                            (PV-TOT-SUB)          36850000
348800           END-IF                                                 36860000
348900                                                                  36870000
349000        WHEN OTHER                                                36880000
349100           MOVE ZERO TO ML017-PC-DIFFER-AMT                       36890000
349200                                                                  36900000
349300     END-EVALUATE.                                                36910000
349400                                                                  36920000
349500                                                                  36930000
349600******************************************************************36940000
349700 6000-OPEN-DKEY-CURSOR.                                           36950000
349800******************************************************************36960000
349900                                                                  36970000
350000     EXEC SQL                                                     36980000
350100          OPEN TEPDKEY-CURSOR                                     36990000
350200     END-EXEC.                                                    37000000
350300                                                                  37010000
350400     EVALUATE TRUE                                                37020000
350500        WHEN SQLCODE = ZERO                                       37030000
350600           CONTINUE                                               37040000
350700        WHEN OTHER                                                37050000
350800           MOVE '6000-OPEN-DKEY-CURSOR'                           37060000
350900                                      TO PV-PARAGRAPH-NAME        37070000
351000           SET AC-DB2-ERROR           TO TRUE                     37080000
351100           PERFORM 9999-ABEND                                     37090000
351200     END-EVALUATE.                                                37100000
351300                                                                  37110000
351400******************************************************************37120000
351500 6100-FETCH-DKEY-CURSOR.                                          37130000
351600*     FETCH LATE AND SALES CORRECTION TRANSACTIONS.               37140000
351700******************************************************************37150000
351800                                                                  37160000
351900     EXEC SQL                                                     37170000
352000          FETCH TEPDKEY-CURSOR                                    37180000
352100           INTO :EPTRN-PARTN-NBR                                  37190000
352200               ,:EPTRN-STR-NBR                                    37200000
352300               ,:EPTRN-RGST-ID                                    37210000
352400               ,:EPTRN-TRN-NBR                                    37220000
352500               ,:EPTRN-STRT-TM                                    37230000
352600               ,:EPTRN-SLS-CORR-SEQ-NBR                           37240000
352700               ,:EPTRN-TRN-STAT-CDE                               37250000
352800               ,:EPTRN-SLS-DTE                                    37260000
BOSSCL               ,:EPTRN-TRN-DTE                                    37261001
011618               ,:EPTRN-POS-CPBL-LVL-NBR                           37270000
352900               ,:EPTRN-CRE-TMST                                   37280000
BOSSCL               ,:EPTRN-OMNI-CHNL-FFLMT-TYP-CDE                    37290000
BOSSCL                :PV-OMNI-CHNL-TYP-CDE-NULL-IND                    37300000
BOSSC2               ,:PV-TRANSFER-DATE                                 37301013
353000     END-EXEC.                                                    37310000
353100                                                                  37320000
353200     EVALUATE TRUE                                                37330000
353300        WHEN SQLCODE = ZERO                                       37340000
BOSSCL           IF PV-OMNI-CHNL-TYP-CDE-NULL-IND = -1                  37341001
BOSSCL              MOVE SPACES TO EPTRN-OMNI-CHNL-FFLMT-TYP-CDE        37342001
BOSSCL           END-IF                                                 37343001
353400           MOVE EPTRN-PARTN-NBR       TO  PV-PARTN-NBR            37350000
353500           MOVE EPTRN-STR-NBR         TO  PV-STR-NBR              37360000
353600           MOVE EPTRN-RGST-ID         TO  PV-RGST-ID              37370000
353700           MOVE EPTRN-TRN-NBR         TO  PV-TRN-NBR              37380000
353800           MOVE EPTRN-STRT-TM         TO  PV-STRT-TM              37390000
353900           MOVE EPTRN-SLS-CORR-SEQ-NBR  TO  PV-SLS-CORR-SEQ-NBR   37400000
354000                                                                  37410000
354100           PERFORM 1117-CALCU-KOHLS-MONTH                         37420000
354200           PERFORM 2500-OPEN-ITEM-CURSOR                          37430000
354300           PERFORM 2600-FETCH-ITEM-CURSOR                         37440000
354400              UNTIL PS-END-OF-ITEM-YES                            37450000
354500           PERFORM 2700-CLOSE-ITEM-CURSOR                         37460000
354600           ADD 1                      TO WS-CMT-CNT               37470000
354700                                                                  37480000
354800        WHEN SQLCODE = PC-ROW-NOT-FOUND                           37490000
354900           SET PS-END-OF-DKEY-YES     TO TRUE                     37500000
355000        WHEN SQLWARN0 NOT EQUAL SPACE                             37510000
355100        WHEN SQLCODE NOT EQUAL ZERO                               37520000
355200           MOVE '6100-FETCH-DKEY-CURSOR'                          37530000
355300                                      TO PV-PARAGRAPH-NAME        37540000
355400           SET AC-DB2-ERROR           TO TRUE                     37550000
355500           PERFORM 9999-ABEND                                     37560000
355600     END-EVALUATE.                                                37570000
355700                                                                  37580000
355800     IF WS-CMT-CNT > 2000                                         37590000
355900       PERFORM 8999-COMMIT-PARA                                   37600000
356000       MOVE ZEROS                         TO WS-CMT-CNT           37610000
356100     END-IF.                                                      37620000
356200                                                                  37630000
356300******************************************************************37640000
356400 6200-CLOSE-DKEY-CURSOR.                                          37650000
356500******************************************************************37660000
356600                                                                  37670000
356700     EXEC SQL                                                     37680000
356800          CLOSE TEPDKEY-CURSOR                                    37690000
356900     END-EXEC.                                                    37700000
357000                                                                  37710000
357100     EVALUATE TRUE                                                37720000
357200        WHEN SQLCODE = ZERO                                       37730000
357300           CONTINUE                                               37740000
357400        WHEN OTHER                                                37750000
357500           MOVE '6200-CLOSE-DKEY-CURSOR'    TO PV-PARAGRAPH-NAME  37760000
357600           SET AC-DB2-ERROR           TO TRUE                     37770000
357700           PERFORM 9999-ABEND                                     37780000
357800     END-EVALUATE.                                                37790000
357900                                                                  37800000
358000******************************************************************37810000
358100 6300-SELECT-TIERED.                                              37820000
358200******************************************************************37830000
358300                                                                  37840000
358400      EXEC SQL                                                    37850000
358500         SELECT  LID_AMT                                          37860000
358600           INTO :EPLID-LID-AMT                                    37870000
358700           FROM TEPLID                                            37880000
358800          WHERE PARTN_NBR = :PV-PARTN-NBR                         37890000
358900            AND STR_NBR   = :PV-STR-NBR                           37900000
359000            AND RGST_ID   = :PV-RGST-ID                           37910000
359100            AND TRN_NBR   = :PV-TRN-NBR                           37920000
359200            AND STRT_TM   = :PV-STRT-TM                           37930000
359300            AND SLS_CORR_SEQ_NBR = :PV-SLS-CORR-SEQ-NBR           37940000
359400            AND LNE_ITM_SEQ_NBR  = :PV-LNE-ITM-SEQ-NBR            37950000
359500            AND LID_TYP_CDE      = 'T'                            37960000
359600                WITH UR                                           37970000
359700      END-EXEC.                                                   37980000
359800                                                                  37990000
359900     EVALUATE TRUE                                                38000000
360000        WHEN SQLCODE = ZERO                                       38010000
360100           SET PS-TIERED-ITEM-YES     TO TRUE                     38020000
360200        WHEN SQLCODE = PC-ROW-NOT-FOUND                           38030000
360300           SET PS-TIERED-ITEM-NO      TO TRUE                     38040000
360400        WHEN SQLWARN0 NOT EQUAL SPACE                             38050000
360500        WHEN SQLCODE NOT EQUAL ZERO                               38060000
360600           MOVE '6100-FETCH-DKEY-CURSOR'                          38070000
360700                                      TO PV-PARAGRAPH-NAME        38080000
360800           SET AC-DB2-ERROR           TO TRUE                     38090000
360900           PERFORM 9999-ABEND                                     38100000
361000     END-EVALUATE.                                                38110000
361100                                                                  38120000
361200******************************************************************38130000
361300 8000-WRITE-LEDGER-MKDN-RECORD.                                   38140000
361400*     WRITE A LEDGER MARKDOWN TRANSACTION RECORD.                 38150000
361500******************************************************************38160000
361600** ACCUMULATES MARKDOWNS/MARKDOWN CANCELS WRITTEN TO FILE.        38170000
361700     IF ML017-MARKDOWN-CANCEL                                     38180000
361800          COMPUTE PV-TOTAL-MKDNCAN-AMT =                          38190000
361900             (ML017-PC-DIFFER-AMT * -1) + PV-TOTAL-MKDNCAN-AMT    38200000
362000     ELSE                                                         38210000
362100          ADD ML017-PC-DIFFER-AMT TO PV-TOTAL-MKDN-AMT            38220000
362200     END-IF                                                       38230000
362300                                                                  38240000
362400     WRITE LM-LEDGER-MARKDOWN-RECORD                              38250000
362500         FROM ML017-PRICE-CHANGE-RECORD.                          38260000
362600                                                                  38270000
362700******************************************************************38280000
362800 8025-WRITE-HOLD-LEDGR-MKDN-REC.                                  38290000
362900*     WRITE A HOLD LEDGER MARKDOWN TRANSACTION RECORD.            38300000
363000******************************************************************38310000
BOSSCL     IF ML017-MARKDOWN-CANCEL                                     38311000
BOSSCL          COMPUTE PV-TOTAL-MKDNCAN-AMT =                          38312000
BOSSCL             (ML017-PC-DIFFER-AMT * -1) + PV-TOTAL-MKDNCAN-AMT    38313000
BOSSCL     ELSE                                                         38314000
BOSSCL          ADD ML017-PC-DIFFER-AMT TO PV-TOTAL-MKDN-AMT            38315000
BOSSCL     END-IF.                                                      38316000
                                                                        38317000
363100     WRITE HOLD-LEDGER-MARKDOWN-RECORD                            38318000
363200         FROM ML017-PRICE-CHANGE-RECORD.                          38319000
363300                                                                  38320000
365000******************************************************************38490000
365100 8100-WRITE-LEDGER-MKUP-RECORD.                                   38500000
365200*     WRITE A LEDGER MARKUP TRANSACTION RECORD.                   38510000
365300******************************************************************38520000
365400                                                                  38530000
365500     WRITE LM-LEDGER-MARKUP-RECORD                                38540000
365600         FROM ML017-PRICE-CHANGE-RECORD.                          38550000
365700                                                                  38560000
365800******************************************************************38570000
365900 8125-WRITE-HOLD-LEDGR-MKUP-REC.                                  38580000
366000*     WRITE A HOLD LEDGER MARKUP TRANSACTION RECORD.              38590000
366100******************************************************************38600000
366200                                                                  38610000
366300     WRITE HOLD-LEDGER-MARKUP-RECORD                              38620000
366400         FROM ML017-PRICE-CHANGE-RECORD.                          38630000
366500                                                                  38640000
368200******************************************************************38810000
368300 8180-FORMAT-MW-RECORD.                                           38820000
368400*     COPY THE MLRD017 TO MLRD044 FOR DATA WAREHOUSE              38830000
368500******************************************************************38840000
368600      INITIALIZE ML044-PRICE-CHANGE-RECORD.                       38850000
368700      MOVE ML017-PC-CDE              TO ML044-PC-CDE.             38860000
368800      MOVE ML017-PC-TYP-CDE          TO ML044-PC-TYP-CDE.         38870000
368900      MOVE ML017-SLS-CORR-CDE        TO ML044-SLS-CORR-CDE.       38880000
369000      MOVE ML017-PC-DOC-5-NBR        TO ML044-PC-DOC-5-NBR.       38890000
369100      MOVE ML017-PC-DTE              TO ML044-PC-DTE.             38900000
369200      MOVE ML017-PC-KOHLS-MM         TO ML044-PC-KOHLS-MM.        38910000
369300      MOVE ML017-PC-SKU              TO ML044-PC-SKU.             38920000
369400      MOVE ML017-PC-RSN-CDE          TO ML044-PC-RSN-CDE.         38930000
369500      MOVE ML017-PC-OLD-PR-AMT       TO ML044-PC-OLD-PR-AMT.      38940000
369600      MOVE ML017-PC-NEW-PR-AMT       TO ML044-PC-NEW-PR-AMT.      38950000
369700      MOVE ML017-PC-QTY              TO ML044-PC-QTY.             38960000
369800      MOVE ML017-PC-BATCH-NBR        TO ML044-PC-BATCH-NBR.       38970000
369900      MOVE ML017-PC-MKDN-MKUP-RSN-CDE TO                          38980000
370000           ML044-PC-MKDN-MKUP-RSN-CDE.                            38990000
370100      MOVE ML017-PC-DIFFER-AMT       TO ML044-PC-DIFFER-AMT       39000000
370200      MOVE ML017-PC-TOT-DOC-QTY      TO ML044-PC-TOT-DOC-QTY.     39010000
370300      MOVE ML017-PC-STORE-NBR        TO ML044-PC-STORE-NBR.       39020000
370400      MOVE ML017-PC-CATEG-CDE        TO ML044-PC-CATEG-CDE.       39030000
370500      MOVE ML017-PC-DOC-7-NBR        TO ML044-PC-DOC-7-NBR.       39040000
370600      MOVE ML017-PC-VENDOR-INHSE-NMBR TO                          39050000
370700           ML044-PC-VENDOR-INHSE-NMBR.                            39060000
370800      MOVE ML017-PC-LINE-NBR         TO ML044-PC-LINE-NBR.        39070000
370900      MOVE ML017-PC-SKU-DTA-ATTRIB   TO ML044-PC-SKU-DTA-ATTRIB.  39080000
371000      MOVE ML017-PC-DEPT-CLASS       TO ML044-PC-DEPT-CLASS.      39090000
371100      MOVE ML017-PC-MAJ-CLASS        TO ML044-PC-MAJ-CLASS.       39100000
371200      MOVE ML017-RGST-ID             TO ML044-RGST-ID.            39110000
371300      MOVE ML017-TRN-NBR             TO ML044-TRN-NBR.            39120000
371400      MOVE PV-STRT-TM                TO ML044-STRT-TM.            39130000
371500      MOVE PV-SLS-CORR-SEQ-NBR       TO ML044-SLS-CORR-SEQ-NBR.   39140000
371600      MOVE ML017-LNE-ITM-SEQ-NBR     TO ML044-LNE-ITM-SEQ-NBR.    39150000
371700      MOVE PV-LID-SEQ-NBR            TO ML044-LID-SEQ-NBR.        39160000
371800      MOVE ML017-GMM                 TO ML044-GMM.                39170000
371900      MOVE ML017-DMM                 TO ML044-DMM.                39180000
372000      MOVE ML017-BUYER               TO ML044-BUYER.              39190000
372100      MOVE ML017-PC-ENT-ID           TO ML044-PC-ENT-ID.          39200000
372200      MOVE ML017-ORIG-CLR-DTE        TO ML044-ORIG-CLR-DTE.       39210000
372300      MOVE ML017-MKDN-CDE            TO ML044-MKDN-CDE.           39220000
372400      MOVE ML017-ORIG-CLR-NONGRP-RTL TO ML044-ORIG-CLR-NONGRP-RTL.39230000
372500      MOVE ML017-PC-DA               TO ML044-PC-DA.              39240000
372600      MOVE PV-ISO-DB2-CC             TO ML044-PC-DTE-YEAR(1:2).   39250000
372700      MOVE PV-ISO-DB2-YY             TO ML044-PC-DTE-YEAR(3:2).   39260000
372800                                                                  39270000
372900******************************************************************39280000
373000 8190-WRITE-DATAWHSE-RECORD.                                      39290000
373100*     WRITE A DATAWHSE TRANSACTION RECORD.                        39300000
373200******************************************************************39310000
373300                                                                  39320000
373400     WRITE DATAWHSE-RECORD                                        39330000
373500         FROM ML044-PRICE-CHANGE-RECORD.                          39340000
373600                                                                  39350000
373700******************************************************************39360000
373800 8200-WRITE-DETAIL-LINE.                                          39370000
373900*     WRITE THE DETAIL LINES FOR THE REPORT.                      39380000
374000******************************************************************39390000
374100                                                                  39400000
374200     IF PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                  39410000
374300         MOVE ZERO TO PV-LINE-COUNT                               39420000
374400         ADD 3     TO PV-LINE-COUNT                               39430000
374500         PERFORM 8400-WRITE-HEADERS                               39440000
374600     END-IF.                                                      39450000
374700                                                                  39460000
374800     MOVE 2 TO PV-SPACE-CONTROL.                                  39470000
374900                                                                  39480000
375000     WRITE REPORT-LINE-OUT                                        39490000
375100         FROM DL-DETAIL-LINE AFTER ADVANCING PV-SPACE-CONTROL.    39500000
375200                                                                  39510000
375300     INITIALIZE DL-DETAIL-LINE.                                   39520000
375400                                                                  39530000
375500     ADD 2 TO PV-LINE-COUNT.                                      39540000
375600                                                                  39550000
375700******************************************************************39560000
375800 8300-WRITE-NON-OWNED.                                            39570000
375900*     WRITE THE NON OWNED MDSE MARKDOWNS DROPPED.                 39580000
376000******************************************************************39590000
376100                                                                  39600000
376200     MOVE 2 TO PV-SPACE-CONTROL.                                  39610000
376300                                                                  39620000
376400     WRITE REPORT-LINE-OUT                                        39630000
376500         FROM TD-TOTAL-DISPLAY-MESSAGE                            39640000
376600            AFTER ADVANCING PV-SPACE-CONTROL.                     39650000
376700                                                                  39660000
262807**   TRY FORCING PAGE BREAKS AT END OF SECTIONS                   39670033
262807**   DON'T WRITE HEADINGS AFTER FINAL SECTION (5)                 39671033
262807     MOVE 65 TO PV-LINE-COUNT.                                    39672033
262807**   ADD 2 TO PV-LINE-COUNT.                                      39673033
376700                                                                  39674028
376900     IF PV-LINE-COUNT GREATER THAN PC-LINE-LIMIT                  39680000
262807     AND PV-TOT-SUB < 5                                           39681033
377000         PERFORM 8400-WRITE-HEADERS                               39690000
377100         MOVE ZERO TO PV-LINE-COUNT                               39700000
377200                                                                  39710000
377300         ADD 3     TO PV-LINE-COUNT                               39720000
377400     END-IF.                                                      39730000
377500                                                                  39740000
377600******************************************************************39750000
377700 8400-WRITE-HEADERS.                                              39760000
377800*     WRITE THE REPORT HEADERS.                                   39770000
377900******************************************************************39780000
378000                                                                  39790000
378100     MOVE 1 TO PV-SPACE-CONTROL.                                  39800000
378200     MOVE PV-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    39810000
378300                                                                  39820000
378400     WRITE REPORT-LINE-OUT                                        39830000
378500          FROM DP132O-STANDRD-HEADER-132-COLS                     39840000
378600             AFTER ADVANCING PAGE.                                39850000
378700     ADD 1 TO PV-PAGE-COUNT.                                      39860000
378800                                                                  39870000
378900     WRITE REPORT-LINE-OUT                                        39880000
379000         FROM HL-HEADER-LINE1                                     39890000
379100            AFTER ADVANCING PV-SPACE-CONTROL.                     39900000
379200                                                                  39910000
379300     WRITE REPORT-LINE-OUT                                        39920000
379400         FROM HL-HEADER-LINE1-1                                   39930000
379500            AFTER ADVANCING PV-SPACE-CONTROL.                     39940000
379600                                                                  39950000
379700     MOVE 2 TO PV-SPACE-CONTROL.                                  39960000
379800                                                                  39970000
379900     WRITE REPORT-LINE-OUT                                        39980000
380000         FROM HL-HEADER-LINE2                                     39990000
380100            AFTER ADVANCING PV-SPACE-CONTROL.                     40000000
380200                                                                  40010000
380300     MOVE 1 TO PV-SPACE-CONTROL.                                  40020000
380400                                                                  40030000
380500     WRITE REPORT-LINE-OUT                                        40040000
380600         FROM HL-HEADER-LINE3                                     40050000
380700            AFTER ADVANCING PV-SPACE-CONTROL.                     40060000
380800                                                                  40070000
380900     ADD 7 TO PV-LINE-COUNT.                                      40080000
381000                                                                  40090000
381100******************************************************************40100000
381200* COMMIT DATABASE CHNAGES                                         40110000
381300******************************************************************40120000
381400 8999-COMMIT-PARA.                                                40130000
381500                                                                  40140000
381600     EXEC SQL                                                     40150000
381700         COMMIT                                                   40160000
381800     END-EXEC.                                                    40170000
381900                                                                  40180000
382000     EVALUATE TRUE                                                40190000
382100       WHEN SQLCODE = ZERO                                        40200000
382200         CONTINUE                                                 40210000
382300       WHEN SQLWARN0 NOT EQUAL SPACE                              40220000
382400       WHEN SQLCODE NOT EQUAL ZERO                                40230000
382500         MOVE '8999-COMMIT-PARA'  TO PV-PARAGRAPH-NAME            40240000
382600         SET AC-DB2-ERROR           TO TRUE                       40250000
382700         PERFORM 9999-ABEND                                       40260000
382800     END-EVALUATE.                                                40270000
382900                                                                  40280000
383000******************************************************************40290000
383100 9000-EOJ-ROUTINE.                                                40300000
383200*     CLOSE FILES.                                                40310000
383300******************************************************************40320000
383400                                                                  40330000
383500     CLOSE LEDGER-MARKDOWN-FILE                                   40340000
383600           LEDGER-MARKUP-FILE                                     40350000
383900           HOLD-LEDGER-MARKDOWN-FILE                              40380000
384000           HOLD-LEDGER-MARKUP-FILE                                40390000
384300           DATAWHSE-FILE                                          40420000
384400           MERCH-LEDGER-REPORT.                                   40430000
384500                                                                  40440000
384600******************************************************************40450000
384700 9999-ABEND.                                                      40460000
384800*     DISPLAY ABEND INFO.                                         40470000
384900******************************************************************40480000
385000                                                                  40490000
385100     DISPLAY '************ SAKUT023 ABEND ************'.          40500000
385200     DISPLAY '**  PROGRAM   ** ' PC-CURRENT-PROGRAM-NAME.         40510000
385300     DISPLAY '**  PARAGRAPH ** ' PV-PARAGRAPH-NAME.               40520000
385400     DISPLAY '**  SQLCODE   ** ' SQLCODE.                         40530000
062118     DISPLAY '**  SQLSTATE  ** ' SQLSTATE.                        40540000
385500     DISPLAY '**  SLS DATE  ** ' EPTRN-SLS-DTE.                   40550000
385600     DISPLAY '**  STORE NBR ** ' EPTRN-STR-NBR.                   40560000
385700     DISPLAY '**  REGISTER  ** ' EPTRN-RGST-ID.                   40570000
385800     DISPLAY '**  TRAN      ** ' EPTRN-TRN-NBR.                   40580000
385900     DISPLAY '************ SAKUT023 ******************'.          40590000
386000                                                                  40600000
386100     CALL 'ILBOABN0' USING AC-ABEND-CODE.                         40610000
386200                                                                  40620000
