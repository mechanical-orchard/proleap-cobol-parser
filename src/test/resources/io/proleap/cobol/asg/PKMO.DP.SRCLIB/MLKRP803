       IDENTIFICATION DIVISION.                                            CL**4
       PROGRAM-ID.         MLKRP803.                                       CL**4
       AUTHOR.             PAUL KEBER - STRATAGEM.                         CL**4
       INSTALLATION.       KOHLS DEPARTMENT STORE.                         CL**4
       DATE-WRITTEN.       06-22-99.                                       CL**4
       DATE-COMPILED.                                                      CL**4
                                                                           CL**4
      ******************************************************************   CL**4
      *   MLKRP803 - PRODUCE THE VENDOR ANALYSIS MANAGERS REPORT BY    *        
      *              TOTAL COMPANY.                                    *        
      *   WR# 10587                                                    *        
      ******************************************************************        
      *   READ THE MANAGERS REPORT DATA FILE AND PRINT THE MANAGERS    *   CL**4
      *   REPORT.  THE FILE WILL CONTAIN VENDOR DATA BETWEEN THE FIRST *   CL**4
      *   MONTH OF THE CURRENT FISCAL SEASON AND THE CURRENT FISCAL    *00409000
      *   MONTH OF THE CURRENT FISCAL SEASON.  AN INPUT CONTROL CARD   *        
      *   CONTAINING THE END FISCAL MONTH DATE MAY BE USED TO OVERRIDE *        
      *   THE TMLCNTL AND TDTATTR CURRENT MONTH INFO.  THIS PROGRAM    *00410000
      *   ASSUMES THAT REPORT DATA FILE WILL CONTAIN ONLY 1 RECORD PER *   CL**4
      *   VENDOR.                                                      *   CL**4
      *                                                                *00410000
      *   THE PAGE HEADER WILL DISPLAY THE MONTH NAME AND YEAR OF THE  *00410000
      *   CURRENT FISCAL MONTH OF THE CURRENT FISCAL YEAR (I.E. 'MARCH *        
      *   1999').                                                      *00410000
      *                                                                *00410000
      *   DATA IS PRINTED FOR EACH VENDOR, WITH GRAND TOTALS FOR ALL   *   CL**4
      *   VENDORS.  IF A VENDOR HAS THIS YEAR AND LAST YEAR SALES      *   CL**4
      *   WHICH ARE NOT GREATER THAN $5000, ALL AMOUNTS FOR THAT       *   CL**4
      *   VENDOR WILL BE ROLLED UP UNDER A MISCELLANEOUS VENDOR LINE.  *   CL**4
      *   THE MISCELLANEOUS VENDOR LINE WILL BE LISTED AFTER ALL OTHER *   CL**4
      *   VENDORS.  THE REPORT WILL DISPLAY VENDOR DATA FOR THE        *   CL**4
      *   CURRENT YEAR, AND FOR THE SAME MONTH(S) THIS TIME LAST YEAR. *   CL**4
      *   THE DETAIL LINES SUB HEADING WILL DISPLAY THE CALENDAR       *   CL**4
      *   MONTHS DATE RANGE (I.E. 02/1999 THRU 05/1999).               *   CL**4
      ******************************************************************        
      *   DATE: 08/25/1999     CHANGE ID: WR10587    WHO: B.MCASEY    *         
      *   REASON FOR CHANGE : CHANGED REPORT TO SHOW RECEIPT COST/RTL  *        
      *   AND PURCHASE ADJ COST/RTL INSTEAD OF GROSS COST, COST PURCH  *        
      *   ADJ, NET COST AND RETAIL PURCHASES.                          *        
      ******************************************************************        
      *   DATE: 09/09/1999     CHANGE ID: WR10587    WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : CHANGED REPORT TOTALS TO NOT INCLUDE THE *        
      *   UNKNOWN VENDOR IN THE GROSS MARGIN, CUM MARKUP.              *        
      ******************************************************************        
      *   DATE: 01/06/2000     CHANGE ID:            WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : CHANGED REPORT TO ONLY INCLUDE 1999 DATA *        
      *   UNDER THE LAST YEAR COLUMN TOTALS FOR RECEIPTS AND SALES     *        
      ******************************************************************        
      *   DATE: 04/27/2000     CHANGE ID: WR21047    WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : ADDED WEEK NUMBER TO HEADING.            *        
      ******************************************************************        
      *   DATE: 05/09/2000     CHANGE ID: WR21047V2  WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : FIXED WEEK NUMBER LOGIC FOR HEADING BY   *        
      *                       ADDING LOGIC TO CHECK THE OPN-FSCL-WK-DTE*        
      *                       INSTEAD OF THE MNTH END DTE.             *        
      ******************************************************************        
      *   DATE: 01/08/2001     CHANGE ID:            WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : ADDED LOGIC TO FIND THE LAST YEAR DATE   *        
      *   WHEN THE CURRENT YEAR CONTAINS 53 WEEKS. THIS WILL EXECUTE   *        
      *   WHEN THE LY_THIS_DAY_KY_DTE IS '9999-09-09'.  THE NEW LOGIC  *        
      *   IS EXECUTED FROM F200-SELECT-CURR-YR-TDTATTR AND IT CALLS    *        
      *   F225-LY-THIS-DTE-53WK.                                       *        
      ******************************************************************        
      *   DATE: 01/11/2001     CHANGE ID:            WHO: B.MCASEY     *        
      *   REASON FOR CHANGE : CHANGED HEADING YEAR TO REFLECT THE      *        
      *   ACTUAL YEAR OF THE MONTH NOT THE FISCAL YEAR.                *        
      ******************************************************************        
W02191*   DATE: 02/19/2001     CHANGE ID: 99999      WHO: ROD JANSSEN  *        
  |   * CHANGE DATE CONTROL LOGIC TO USE THE POSTING FISCAL MTH DATE   *        
  |   * IN PLACE OF THE OPEN FISCAL MTH DATE.                          *        
W02191******************************************************************        
                                                                           CL**4
       ENVIRONMENT DIVISION.                                               CL**4
                                                                           CL**4
       CONFIGURATION SECTION.                                              CL**4
       SOURCE-COMPUTER.    IBM-3090.                                       CL**4
       OBJECT-COMPUTER.    IBM-3090.                                       CL**4
                                                                           CL**4
       INPUT-OUTPUT SECTION.                                               CL**4
                                                                           CL**4
       FILE-CONTROL.                                                       CL**4
                                                                           CL**4
           SELECT VA-REPORT-EXTRACT-FILE                                   CL**4
               ASSIGN TO INP01.                                            CL**4
                                                                           CL**4
           SELECT MANAGERS-REPORT                                          CL**4
               ASSIGN TO RPT01.                                            CL**4
                                                                           CL**4
       DATA DIVISION.                                                      CL**4
                                                                           CL**4
       FILE SECTION.                                                       CL**4
                                                                           CL**4
       FD  VA-REPORT-EXTRACT-FILE                                          CL**4
           RECORDING MODE IS F                                             CL**4
           LABEL RECORDS ARE STANDARD                                      CL**4
           RECORD CONTAINS 660 CHARACTERS                                  CL**4
           BLOCK CONTAINS 0 RECORDS                                        CL**4
           DATA RECORD IS VA-REPORT-EXTRACT-RECORD.                     MLKRP803
                                                                           CL**4
       01  VA-REPORT-EXTRACT-RECORD PIC X(660).                            CL*32
                                                                           CL**4
       FD  MANAGERS-REPORT                                                 CL**4
           RECORDING MODE IS F                                             CL**4
           LABEL RECORDS ARE STANDARD                                      CL**4
           RECORD CONTAINS 200 CHARACTERS                                  CL**4
           BLOCK CONTAINS 0 RECORDS                                        CL**4
           DATA RECORD IS MR-MANAGERS-REPORT-RECORD.                       CL**4
                                                                           CL**4
       01  MR-MANAGERS-REPORT-RECORD     PIC X(200).                       CL**4
                                                                           CL**4
       EJECT                                                               CL**4
                                                                           CL**4
       WORKING-STORAGE SECTION.                                            CL**4
                                                                           CL**4
       01  PC-PROGRAM-CONSTANTS.                                           CL**4
           05  PC-LINE-MAX                   PIC S9(4)   VALUE +74         CL**4
                                                         COMP SYNC.        CL**4
           05  PC-PROGRAM-NAME               PIC X(08) VALUE 'MLKRP803'.MLKRP803
           05  PC-MIN-TOTAL-SALES            PIC S9(11)V99 VALUE +5000  MLKRP803
                                                         COMP-3.        MLKRP803
0999RM     05  PC-UNKNOWN-VENDOR             PIC S9(09) VALUE 5161      MLKRP803
0999RM                                                   COMP.          MLKRP803
0999RM     05  PC-1998                       PIC S9(04) VALUE 1998.     MLKRP803
0100RM     05  PC-1999                       PIC S9(04) VALUE 1999.     MLKRP803
                                                                                
       01  PS-PROGRAM-SUBSCRIPTS.                                          CL**4
           05  PS-SUB                        PIC S9(4)   VALUE ZEROES      CL**4
                                                         COMP SYNC.        CL**4
       01  PS-PROGRAM-SWITCHES.                                            CL**4
           05  PS-INPUT-EOF-SW               PIC X(1)     VALUE 'N'.       CL**4
               88  PS-INPUT-EOF                           VALUE 'Y'.       CL**4
           05  PS-FIRST-DATAREC-SW           PIC X(1)     VALUE 'Y'.       CL**4
               88  PS-FIRST-DATAREC                       VALUE 'Y'.       CL**4
               88  PS-DONE-WITH-FIRST-DATAREC             VALUE 'N'.       CL**4
           05  PS-FOUND-A-RECORD-SW          PIC X(1)     VALUE 'N'.       CL**4
               88  PS-FOUND-A-RECORD                      VALUE 'Y'.       CL**4
            05  PS-PRINT-DETAIL-IND          PIC X(01)    VALUE 'Y'.            
                88  PS-PRINT-DETAIL                       VALUE 'Y'.            
                88  PS-NO-PRINT-DETAIL                    VALUE 'N'.            
                                                                           CL**4
       01  PV-PROGRAM-VARIABLES.                                           CL**4
           05  PV-PAGE-COUNTER               PIC S9(4)   VALUE ZEROES      CL**4
                                                         COMP SYNC.        CL**4
           05  PV-LINE-COUNTER               PIC S9(4)   VALUE 99          CL**4
                                                         COMP SYNC.        CL**4
           05  PV-IN-COUNTER                 PIC S9(4)   VALUE ZEROES      CL**4
                                                         COMP SYNC.        CL**4
           05  PV-NEW-TOTAL1                 PIC S9(3)V9 VALUE +0          CL**4
                                                         COMP-3.                
           05  PV-NEW-TOTAL2                 PIC S9(8)V9 VALUE +0          CL**4
                                                         COMP-3.                
           05  PV-PERCENT                    PIC S9(3)V9 VALUE +0       MLKRP803
                                                         COMP-3.                
           05  PV-RETAIL-PURCH-LY            PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
           05  PV-RETAIL-PURCH-TY            PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
0899RM     05  PV-RECEIPT-COST-TY            PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  PV-RECEIPT-RTL-TY             PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  PV-PURCH-ADJ-COST-TY          PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  PV-PURCH-ADJ-RTL-TY           PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
           05  PV-TOTAL-SALES-LY             PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
           05  PV-TOTAL-SALES-TY             PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
           05  PV-TOTAL-MKDN-LY              PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
           05  PV-TOTAL-MKDN-TY              PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
           05  PV-CUM-TO-DATE-PURCH-RETAIL   PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
           05  PV-CUM-TO-DATE-PURCH-COST     PIC S9(11)V99 VALUE +0     MLKRP803
                                                         COMP-3.        MLKRP803
           05  PV-CAL-LY-END-CCYY            PIC 9(04)   VALUE  0.              
           05  PV-CAL-LY-END-MONTH           PIC 9(02)   VALUE  0.      MLKRP803
           05  PV-CAL-TY-BEG-MONTH           PIC 9(02)   VALUE  0.      MLKRP800
           05  PV-CAL-TY-END-CCYY            PIC 9(04)   VALUE  0.              
           05  PV-CAL-TY-END-MONTH           PIC 9(02)   VALUE  0.      MLKRP803
           05  PV-FISCAL-LY-CCYY             PIC 9(04)   VALUE  0.              
           05  PV-FISCAL-LY-END-MONTH        PIC 9(02)   VALUE  0.      MLKRP803
           05  PV-FISCAL-TY-BEG-MONTH        PIC 9(02)   VALUE  0.      MLKRP800
           05  PV-FISCAL-TY-CCYY             PIC 9(04)   VALUE  0.              
           05  PV-FISCAL-TY-END-MONTH        PIC 9(02)   VALUE  0.      MLKRP803
           05  PV-OPN-FSCL-MN-DTE            PIC X(10)   VALUE SPACES.  MLKRP803
0101RM     05  PV-OPN-FSCL-MN-DTE-RDF REDEFINES PV-OPN-FSCL-MN-DTE.             
0101RM         10  PV-OPN-FSCL-MN-CCYY       PIC X(04).                         
0101RM         10  FILLER                    PIC X(06).                         
0500RM     05  PV-OPN-FSCL-WK-NBR            PIC X(02)   VALUE SPACES.  MLKRP803
0101RM     05  PV-INVALID-DATE            PIC X(10) VALUE '9999-09-09'.         
                                                                                
           05  PV-HDG-DATE-TY.                                          MLKRP803
               10  FILLER                PIC X(01)   VALUE ' '.         MLKRP803
               10  PV-HDG-START-MM-TY    PIC 9(02)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP803
               10  PV-HDG-START-CCYY-TY  PIC 9(04)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(06)   VALUE ' THRU '.    MLKRP803
               10  PV-HDG-END-MM-TY      PIC 9(02)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP803
               10  PV-HDG-END-CCYY-TY    PIC 9(04)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(01)   VALUE ' '.         MLKRP803
           05  PV-HDG-DATE-LY.                                          MLKRP803
               10  FILLER                PIC X(1)    VALUE ' '.         MLKRP803
               10  PV-HDG-START-MM-LY    PIC 9(02)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP803
               10  PV-HDG-START-CCYY-LY  PIC 9(04)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(06)   VALUE ' THRU '.    MLKRP803
               10  PV-HDG-END-MM-LY      PIC 9(02)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(01)   VALUE '/'.         MLKRP803
               10  PV-HDG-END-CCYY-LY    PIC 9(04)   VALUE 0.           MLKRP803
               10  FILLER                PIC X(01)   VALUE ' '.         MLKRP803
                                                                           CL**4
       01  CC-CONTROL-CARD.                                             MLKRP803
           05  CC-FISCAL-END-DATE                        VALUE SPACES.  MLKRP803
               10  CC-FISCAL-END-YEAR        PIC 9(04).                 MLKRP803
               10  CC-FISCAL-END-DSH1        PIC X(01).                 MLKRP803
               10  CC-FISCAL-END-MONTH       PIC 9(02).                 MLKRP803
               10  CC-FISCAL-END-DSH2        PIC X(01).                 MLKRP803
               10  CC-FISCAL-END-DAY         PIC 9(02).                 MLKRP803
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  CC-REPORT-SEQUENCE            PIC X(1)    VALUE SPACES.     CL**4
               88  CC-RETAIL-PURCH-SEQ                   VALUE 'P'.        CL**4
               88  CC-VENDOR-NAME-SEQ                    VALUE 'V'.        CL**4
           05  FILLER                        PIC X(68)   VALUE SPACES.  MLKRP803
      *                                                                 MLKRP803
      *   DETAIL REPORT FILE LAYOUT                                     MLKRP803
           COPY MLRD202.                                                   CL*31
      /                                                                 MLKRP803
      *  KOHL'S STANDARD FIRST HEADING LINE                             MLKRP803
           COPY DPWS200O.                                                  CL**4
                                                                           CL**4
       01  DL-ALL-DASHES-LINE.                                             CL**4
           05  FILLER                        PIC X(195)  VALUE ALL '-'.    CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  DH-DETAIL-HEADING1.                                             CL**4
           05  FILLER                        PIC X(20)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(44)   VALUE ALL '-'.    CL**4
           05  DH-DATE-RANGE-TY              PIC X(22)   VALUE SPACES.     CL*26
0899RM*    05  FILLER                        PIC X(39)   VALUE ALL '-'.    CL**4
0899RM     05  FILLER                        PIC X(37)   VALUE ALL '-'.    CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(21)   VALUE ALL '-'.    CL**4
           05  DH-DATE-RANGE-LY              PIC X(22)   VALUE SPACES.     CL*26
           05  FILLER                        PIC X(24)   VALUE ALL '-'.    CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  DH-DETAIL-HEADING2.                                             CL**4
W10587*** CHANGED HEADING                                                       
0899RM     05  FILLER                        PIC X(20)   VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(5)    VALUE 'GROSS'.    CL**4
0899RM*    05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(4)    VALUE 'COST'.     CL**4
0899RM*    05  FILLER                        PIC X(7)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(3)    VALUE 'NET'.      CL**4
0899RM*    05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(6)    VALUE             CL**4
0899RM*    'RETAIL'.                                                       CL**4
0899RM     05  FILLER                        PIC X(06) VALUE                    
0899RM                                                     '<-----'.            
0899RM     05  FILLER                        PIC X(08) VALUE                    
0899RM                                                    'RECEIPTS'.           
0899RM     05  FILLER                        PIC X(06) VALUE                    
0899RM                                                     '----->'.            
0899RM     05  FILLER                        PIC X(02) VALUE SPACES.       CL**4
0899RM     05  FILLER                        PIC X(04) VALUE                    
0899RM                                                     '<---'.              
0899RM     05  FILLER                        PIC X(09) VALUE                    
0899RM                                                    'PURCHASE '.          
0899RM     05  FILLER                        PIC X(03) VALUE                    
0899RM                                                    'ADJ'.                
0899RM     05  FILLER                        PIC X(04) VALUE                    
0899RM                                                     '--->'.              
0899RM     05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(7)    VALUE             CL**4
           'NET    '.                                                      CL**4
           05  FILLER                        PIC X(1)   VALUE SPACES.      CL**4
           05  FILLER                        PIC X(5)    VALUE             CL**4
           'CUMM '.                                                        CL**4
           05  FILLER                        PIC X(15)  VALUE SPACES.      CL**4
           05  FILLER                        PIC X(5)    VALUE 'TOTAL'.    CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'TOTAL'.    CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'GROSS'.    CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(9)    VALUE             CL**4
               'END INVEN'.                                                     
           05  FILLER                        PIC X(1)    VALUE SPACE.      CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(3)    VALUE 'NET'.      CL**4
           05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'RETAIL'.                                                       CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'NET   '.                                                       CL**4
           05  FILLER                        PIC X(14)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'TOTAL'.    CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'GROSS'.    CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(9)    VALUE             CL**4
               'END INVEN'.                                                     
           05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  DH-DETAIL-HEADING3.                                             CL**4
           05  FILLER                        PIC X(9)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'VENDOR'.                                                       CL**4
0899RM*    05  FILLER                        PIC X(9)    VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(07)   VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(4)    VALUE 'COST'.     CL**4
0899RM*    05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(9)    VALUE             CL**4
0899RM*    'PURCH ADJ'.                                                    CL**4
0899RM*    05  FILLER                        PIC X(4)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(4)    VALUE 'COST'.     CL**4
0899RM*    05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
0899RM*    05  FILLER                        PIC X(9)    VALUE             CL**4
0899RM*    'PURCHASES'.                                                    CL**4
W10587*** CHANGED HEADING                                                       
0899RM     05  FILLER                        PIC X(04) VALUE 'COST'.            
0899RM     05  FILLER                        PIC X(06) VALUE SPACE.             
0899RM     05  FILLER                        PIC X(06) VALUE 'RETAIL'.          
0899RM     05  FILLER                        PIC X(06) VALUE SPACE.             
0899RM     05  FILLER                        PIC X(04) VALUE 'COST'.            
0899RM     05  FILLER                        PIC X(06) VALUE SPACE.             
0899RM     05  FILLER                        PIC X(06) VALUE 'RETAIL'.          
0899RM*    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(02)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE 'MKUP %'.   CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE 'MKUP %'.   CL**4
           05  FILLER                        PIC X(4)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'SALES'.    CL**4
0899RM*    05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKDN $'.                                                       CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKDN %'.                                                       CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MRGN %'.                                                       CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(8)    VALUE             CL**4
           ' RETAIL '.                                                     CL**4
           05  FILLER                        PIC X(1)    VALUE SPACE.      CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(4)    VALUE 'COST'.     CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(9)    VALUE             CL**4
           'PURCHASES'.                                                    CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKUP %'.                                                       CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(5)    VALUE 'SALES'.    CL**4
           05  FILLER                        PIC X(6)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MKDN $'.                                                       CL**4
           05  FILLER                        PIC X(2)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE             CL**4
           'MRGN %'.                                                       CL**4
           05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  FILLER                        PIC X(6)    VALUE 'RETAIL'.   CL**4
           05  FILLER                        PIC X(7)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  DL-DETAIL-LINE.                                                 CL**4
0899RM*    05  DL-VENDOR-NAME                PIC X(20)   VALUE SPACES.     CL**4
0899RM     05  DL-VENDOR-NAME                PIC X(18)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-GROSS-COST                 PIC ZZZ,ZZ9.9-                CL**4
0899RM*                                                  VALUE ZEROES      CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-PURCH-ADJ-COST             PIC ZZZ,ZZ9.9-                CL**4
0899RM*                                                  VALUE ZEROES      CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-NET-COST-TY                PIC ZZZ,ZZ9.9-                CL**4
0899RM*                                                  VALUE ZEROES      CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM*    05  DL-RETAIL-PURCH-TY            PIC ZZZ,ZZ9.9-                CL**4
0899RM*                                                  VALUE ZEROES      CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM     05  DL-RECEIPT-COST-TY            PIC ZZZ,ZZ9.9-                CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM     05  DL-RECEIPT-RTL-TY             PIC ZZZ,ZZ9.9-                CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
0899RM     05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM     05  DL-PURCH-ADJ-COST-TY          PIC ZZZ,ZZ9.9-                CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM     05  DL-PURCH-ADJ-RTL-TY           PIC ZZZ,ZZ9.9-                CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(3)    VALUE SPACES.     CL**4
           05  DL-NET-MKUP-PCT-TY            PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-CUMM-MARKUP-PCT-TY         PIC ZZ9.9-  VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-TOTAL-SALES-TY             PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-TOTAL-MKDN-TY              PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-MKDN-PCT-SALES-TY          PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-GROSS-MRGIN-PCT-TY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-INVEN-RTL-DLR-TY           PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-SEPARATOR                  PIC X(1)    VALUE '|'.        CL**4
           05  DL-NET-COST-LY                PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-RETAIL-PURCH-LY            PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-NET-MKUP-PCT-LY            PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-TOTAL-SALES-LY             PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-TOTAL-MKDN-LY              PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-GROSS-MRGIN-PCT-LY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
           05  DL-INVEN-RTL-DLR-LY           PIC ZZZ,ZZ9.9-                CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  GT-GRAND-TOTALS.                                                CL**4
0899RM*    05  GT-GROSS-COST                 PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM*                                                   COMP-3.          CL**4
0899RM*    05  GT-PURCH-ADJ-COST             PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM*                                                   COMP-3.          CL**4
0899RM*    05  GT-NET-COST-TY                PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM*                                                   COMP-3.          CL**4
0899RM     05  GT-RETAIL-PURCH-TY            PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM                                                    COMP-3.          CL**4
0899RM     05  GT-RECEIPT-COST-TY            PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  GT-RECEIPT-RTL-TY             PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  GT-PURCH-ADJ-COST-TY          PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  GT-PURCH-ADJ-RTL-TY           PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
           05  GT-NET-MKUP-TY                PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-MKUP-PCT-TY            PIC S9(3)V9  VALUE ZEROES     CL**4
                                                          COMP-3.          CL**4
           05  GT-CUMM-MKUP-PCT-TY           PIC S9(3)V9  VALUE ZEROES     CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-SALES-TY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-MKDN-TY              PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-MKDN-PCT-SALES-TY          PIC S9(3)V9  VALUE ZEROES     CL**4
                                                          COMP-3.          CL**4
           05  GT-GROSS-MRGIN-TY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-GROSS-MRGIN-PCT-TY         PIC S9(3)V9  VALUE ZEROES     CL**4
                                                          COMP-3.          CL**4
           05  GT-END-INV-RTL-TY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-CUM-TO-DATE-PURCH-COST-TY  PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-CUM-TO-DATE-PURCH-RETAIL-TY PIC S9(11)V99 VALUE ZEROES   CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-COST-LY                PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-RETAIL-PURCH-LY            PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-MKUP-LY                PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-NET-MKUP-PCT-LY            PIC S9(3)V9  VALUE ZEROES     CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-SALES-LY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-TOTAL-MKDN-LY              PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-GROSS-MRGIN-LY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  GT-GROSS-MRGIN-PCT-LY         PIC S9(3)V9  VALUE ZEROES     CL**4
                                                          COMP-3.          CL**4
           05  GT-END-INV-RTL-LY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
                                                                           CL**4
       01  GTL-GRAND-TOTAL-LINE-1.                                         CL**4
0899RM*    05  FILLER                        PIC X(7)    VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(05)   VALUE SPACES.     CL**4
           05  GTL-TOTAL                     PIC X(13)   VALUE             CL**4
           'GRAND TOTALS:'.                                                CL**4
0899RM*    05  FILLER                        PIC X(09)   VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(08)   VALUE SPACES.     CL**4
0899RM*    05  GTL-PURCH-ADJ-COST            PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM*                                                  VALUE ZEROES      CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(09)   VALUE SPACES.     CL**4
0899RM*    05  GTL-RETAIL-PURCH-TY           PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM*                                                  VALUE ZEROES      CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(8)    VALUE SPACES.     CL**4
0899RM     05  GTL-RECEIPT-RTL-TY            PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
0899RM     05  FILLER                        PIC X(08)    VALUE SPACES.    CL**4
0899RM     05  GTL-PURCH-ADJ-RTL-TY          PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
0899RM     05  FILLER                        PIC X(10)   VALUE SPACES.     CL**4
           05  GTL-CUMM-MARKUP-PCT-TY        PIC ZZ9.9-  VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(09)   VALUE SPACES.     CL**4
           05  GTL-TOTAL-MKDN-TY             PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(8)    VALUE SPACES.     CL**4
           05  GTL-GROSS-MRGIN-PCT-TY        PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(10)   VALUE SPACES.     CL**4
           05  GTL-NET-COST-LY               PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  GTL-NET-MKUP-PCT-LY           PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(09)   VALUE SPACES.     CL**4
           05  GTL-TOTAL-MKDN-LY             PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  GTL-INVEN-RTL-DLR-LY          PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(1)    VALUE SPACES.     CL**4
                                                                           CL**4
       01  GTL-GRAND-TOTAL-LINE-2.                                         CL**4
0899RM*    05  FILLER                        PIC X(18)   VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(16)   VALUE SPACES.     CL**4
0899RM*    05  GTL-GROSS-COST                PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM*                                                    VALUE ZEROES    CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM*    05  FILLER                        PIC X(9)    VALUE SPACES.     CL**4
0899RM*    05  GTL-NET-COST-TY               PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM*                                                  VALUE ZEROES      CL**4
0899RM*                                      BLANK WHEN ZEROES.            CL**4
0899RM     05  GTL-RECEIPT-COST-TY           PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
0899RM     05  FILLER                        PIC X(08)   VALUE SPACES.     CL**4
0899RM     05  GTL-PURCH-ADJ-COST-TY         PIC ZZ,ZZZ,ZZ9.9-             CL**4
0899RM                                                   VALUE ZEROES      CL**4
0899RM                                       BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(13)   VALUE SPACES.     CL**4
           05  GTL-NET-MKUP-PCT-TY           PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  GTL-TOTAL-SALES-TY            PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  GTL-MKDN-PCT-SALES-TY         PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  GTL-INVEN-RTL-DLR-TY          PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(10)   VALUE SPACES.     CL**4
           05  GTL-RETAIL-PURCH-LY           PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(5)    VALUE SPACES.     CL**4
           05  GTL-TOTAL-SALES-LY            PIC ZZ,ZZZ,ZZ9.9-             CL**4
                                                         VALUE ZEROES      CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(12)   VALUE SPACES.     CL**4
           05  GTL-GROSS-MRGIN-PCT-LY        PIC ZZ9.9- VALUE ZEROES       CL**4
                                             BLANK WHEN ZEROES.            CL**4
           05  FILLER                        PIC X(13)   VALUE SPACES.     CL**4
                                                                                
       01  MT-GRAND-TOTALS.                                                CL**4
0899RM*    05  MT-GROSS-COST                 PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM*                                                   COMP-3.          CL**4
0899RM*    05  MT-PURCH-ADJ-COST             PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM*                                                   COMP-3.          CL**4
0899RM*    05  MT-NET-COST-TY                PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM*                                                   COMP-3.          CL**4
0899RM     05  MT-RETAIL-PURCH-TY            PIC S9(11)V99 VALUE ZEROES    CL**4
0899RM                                                    COMP-3.          CL**4
0899RM     05  MT-RECEIPT-COST-TY            PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  MT-RECEIPT-RTL-TY             PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  MT-PURCH-ADJ-COST-TY          PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
0899RM     05  MT-PURCH-ADJ-RTL-TY           PIC S9(11)V99 VALUE +0     MLKRP803
0899RM                                                   COMP-3.        MLKRP803
           05  MT-NET-MKUP-TY                PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-TOTAL-SALES-TY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-TOTAL-MKDN-TY              PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-GROSS-MRGIN-TY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-END-INV-RTL-TY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-CUM-TO-DATE-PURCH-COST-TY  PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-CUM-TO-DATE-PURCH-RETAIL-TY PIC S9(11)V99 VALUE ZEROES   CL**4
                                                          COMP-3.          CL**4
           05  MT-NET-COST-LY                PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-RETAIL-PURCH-LY            PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-NET-MKUP-LY                PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-TOTAL-SALES-LY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-TOTAL-MKDN-LY              PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-GROSS-MRGIN-LY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
           05  MT-END-INV-RTL-LY             PIC S9(11)V99 VALUE ZEROES    CL**4
                                                          COMP-3.          CL**4
      *-- UNKNOWN VENDOR TOTALS                                            CL**4
0999RM 01  UVT-UNKN-VNDR-TOTALS.                                           CL**4
0999RM     05  UVGT-GROSS-COST                PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RECEIPT-COST-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-COST-PURCH-ADJ            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RECEIPT-RTL-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-COST-TY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-PRCH-ADJ-COST-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RETAIL-PURCH-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-PRCH-ADJ-RTL-TY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-MKUP-TY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-SALES-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-MKDN-TY             PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-GROSS-MRGIN-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-END-INV-RTL-TY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-STD-PURCH-COST-TY         PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-STD-PURCH-RTL-TY          PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-COST-LY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-RETAIL-PURCH-LY           PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-NET-MKUP-LY               PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-SALES-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-TOTAL-MKDN-LY             PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-GROSS-MRGIN-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
0999RM     05  UVGT-END-INV-RTL-LY            PIC S9(11)V99 VALUE 0        CL**4
0999RM                                                    COMP-3.          CL**4
                                                                           CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING1.                                                CL**4
           05  FILLER                        PIC X(92)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(15)   VALUE             CL**4
           'VENDOR ANALYSIS'.                                              CL**4
           05  FILLER                        PIC X(93)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING2.                                                CL**4
           05  FILLER                        PIC X(84)   VALUE SPACES.     CL**4
           05  FILLER                        PIC X(32)   VALUE             CL**4
           'MANAGERS REPORT BY TOTAL COMPANY'.                             CL**4
           05  FILLER                        PIC X(84)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING3.                                                CL**4
           05  FILLER                        PIC X(88)  VALUE SPACES.      CL**4
           05  SH-SEQUENCE                   PIC X(24)  VALUE SPACES.      CL**4
           05  FILLER                        PIC X(88)  VALUE SPACES.      CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SH-SUB-HEADING4.                                                CL**4
0400RM*    05  FILLER                        PIC X(92)  VALUE SPACES.      CL**4
0400RM     05  FILLER                        PIC X(89)  VALUE SPACES.      CL**4
           05  SH-MONTH                      PIC X(9)   VALUE SPACES.      CL**4
           05  FILLER                        PIC X(1)   VALUE SPACE.       CL**4
           05  SH-YEAR                       PIC X(4)   VALUE SPACES.      CL**4
0400RM     05  FILLER                        PIC X(02)  VALUE SPACES.           
0400RM     05  FILLER                        PIC X(05)  VALUE 'WEEK '.          
0400RM     05  SH-WEEK-NBR                   PIC X(01)  VALUE SPACE.            
0400RM     05  FILLER                        PIC X(89)  VALUE SPACES.      CL**4
0400RM*    05  FILLER                        PIC X(94)  VALUE SPACES.      CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       01  SL-SPECIAL-LINE.                                                CL**4
0899RM*    05  FILLER                        PIC X(126)  VALUE SPACES.     CL**4
0899RM     05  FILLER                        PIC X(124)  VALUE SPACES.     CL**4
           05  FILLER                        PIC X(1)    VALUE '|'.        CL**4
           05  FILLER                        PIC X(73)   VALUE SPACES.     CL**4
                                                                           CL**4
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
       01  ABEND-AREAS.                                                         
           05  ABEND-CODE              PIC S9(04)  VALUE ZERO                   
                                                   COMP SYNC.                   
               88  AC-BAD-CC-RPT-SEQ               VALUE +4002.                 
               88  AC-BAD-CONTROL-CARD             VALUE +4003.                 
               88  AC-DB2-ERROR                    VALUE +4013.                 
           05  AA-ABEND-LIT            PIC X(40)   VALUE                        
                 '*****       ABEND'.                                           
           05  AA-PROGRAM-LIT          PIC X(40)   VALUE                        
                   '*****   PROGRAM: MLKRP803'.                                 
           05  AA-PARAGRAPH-LIT.                                                
               10  FILLER              PIC X(17)   VALUE                        
                   '***** PARAGRAPH: '.                                         
               10  AA-PARAGRAPH-NAME   PIC X(35)   VALUE SPACES.                
           05  AA-MESSAGE-LINE.                                                 
               10  FILLER              PIC X(06)   VALUE '*****'.               
               10  AA-MESSAGE          PIC X(127)  VALUE SPACES.                
           05  AA-DB2-ERROR-LIT        PIC X(40)   VALUE                        
                   '*****    DB2 ERROR'.                                        
           05  AA-DB2-OPERATION-LIT.                                            
               10  FILLER              PIC X(17)   VALUE                        
                   '***** OPERATION: '.                                         
               10  AA-DB2-OPERATION.                                            
                   15  AA-DB2-OP-1     PIC X(25)   VALUE SPACES.                
                   15  AA-DB2-OP-2     PIC X(25)   VALUE SPACES.                
           05  AA-DB2-TABLE-1          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-2          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-3          PIC X(08)   VALUE SPACES.                
           05  AA-DB2-TABLE-4          PIC X(08)   VALUE SPACES.                
                                                                                
       EJECT                                                                    
                                                                                
      ******************************************************************        
      *  DB2 ERROR MESSAGES FORMAT AREA.                                        
      ******************************************************************        
           COPY DPWS004.                                                        
                                                                                
      ******************************************************************        
      *  DB2 ERRORS                                                             
      ******************************************************************        
           COPY SQLCA2.                                                         
                                                                                
      ******************************************************************        
      *  DB2 MLCNTL TABLE LAYOUT                                                
      ******************************************************************        
           EXEC SQL                                                             
                INCLUDE TMLCNTL                                                 
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  DB2 DTATTR TABLE LAYOUT                                                
      ******************************************************************        
           EXEC SQL                                                             
                INCLUDE TDTATTR                                                 
           END-EXEC.                                                            
                                                                                
      ******************************************************************        
      *  DB2 COMMUNICATION AREA                                                 
      ******************************************************************        
           EXEC SQL                                                             
                INCLUDE SQLCA                                                   
           END-EXEC.                                                            
                                                                                
      *                                                                    CL**4
      *****************************************************************    CL**4
      *                                                                    CL**4
                                                                           CL**4
       EJECT                                                               CL**4
      *                                                                    CL**4
       PROCEDURE DIVISION.                                                 CL**4
                                                                           CL**4
       0000-MLKRP803.                                                      CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    OPEN ALL FILES.                                                 CL**4
      *    INITIALIZE PAGE HEADINGS AND PRINT THEM.                        CL**4
      *    PROCESS AND PRINT RECORDS ON MARKET REPORT FILE.                CL**4
      *    PRINT THE DEPT TOTALS FOR LAST DEPT.                            CL**4
      *    PRINT THE GRAND TOTALS FOR ALL DEPTS.                           CL**4
      *    CLOSE ALL FILES.                                                CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           OPEN INPUT  VA-REPORT-EXTRACT-FILE                              CL**4
                OUTPUT MANAGERS-REPORT.                                    CL**4
                                                                           CL**4
           PERFORM 1000-INITIALIZE-HEADER.                                 CL**4
                                                                           CL**4
           PERFORM 2000-PROCESS                                            CL**4
               UNTIL PS-INPUT-EOF.                                         CL**4
                                                                           CL**4
           IF PV-IN-COUNTER > 0                                            CL**4
               PERFORM E200-MISC-VENDOR-DETAIL                                  
0999RM         PERFORM 6000-PRINT-HEADERS                                  CL**4
               PERFORM B300-GRAND-TOTAL-PCT                                CL**4
               PERFORM B400-GRAND-TOTALS                                   CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
           CLOSE VA-REPORT-EXTRACT-FILE                                    CL**4
                 MANAGERS-REPORT.                                          CL**4
                                                                           CL**4
           STOP RUN.                                                       CL**4
                                                                           CL**4
       1000-INITIALIZE-HEADER.                                             CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP THE STANDARD PAGE HEADER.                                CL**4
      *    ACCEPT THE CONTROL CARD AND GET THE RUN DATE INFO FROM          CL**4
      *    THE TMLCNTL AND TDTATTR DB2 TABLES.                                  
      *    REPORT SEQUENCE TYPE MUST BE P OR V.                            CL**4
      *    PRINT PAGE HEADERS.                                             CL**4
      *                                                                    CL**4
      *    PERFORMED BY 0000-MLKRP803.                                     CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           MOVE FUNCTION CURRENT-DATE (3:2) TO DP200O-RUN-YEAR.         MLKRP803
           MOVE FUNCTION CURRENT-DATE (5:2) TO DP200O-RUN-MONTH.        MLKRP803
           MOVE FUNCTION CURRENT-DATE (7:2) TO DP200O-RUN-DAY.          MLKRP803
           MOVE FUNCTION CURRENT-DATE (9:2) TO DP200O-RUN-HOUR.         MLKRP803
           MOVE FUNCTION CURRENT-DATE (11:2) TO DP200O-RUN-MINUTE.      MLKRP803
           MOVE PC-PROGRAM-NAME TO DP200O-PROGRAM-NAME.                    CL**4
                                                                           CL**4
           ACCEPT CC-CONTROL-CARD.                                      MLKRP803
                                                                           CL**4
           IF (NOT CC-RETAIL-PURCH-SEQ) AND                                CL**4
              (NOT CC-VENDOR-NAME-SEQ)                                     CL**4
               SET AC-BAD-CC-RPT-SEQ TO TRUE                                    
               DISPLAY 'INVALID INPUT CONTROL CARD REPORT SEQUENCE'             
               DISPLAY '** ABEND IN PGM  ', PC-PROGRAM-NAME                     
               CALL 'ILBOABN0' USING ABEND-CODE                                 
           END-IF.                                                         CL**4
           IF CC-RETAIL-PURCH-SEQ                                          CL**4
               MOVE 'RETAIL PURCHASE SEQUENCE' TO SH-SEQUENCE              CL**4
               MOVE 2 TO DP200O-REPORT-NUMBER                              CL**4
           ELSE                                                            CL**4
               MOVE '  VENDOR NAME SEQUENCE  ' TO SH-SEQUENCE              CL**4
               MOVE 1 TO DP200O-REPORT-NUMBER                              CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
           IF CC-FISCAL-END-DATE = SPACES                               MLKRP803
               PERFORM F100-SELECT-TMLCNTL                                      
W02191*****    DISPLAY 'USING TMLCNTL OPEN FISCAL MONTH END DATE: '             
W02191         DISPLAY 'USING TMLCNTL PSTG FISCAL MONTH END DATE: '             
                        PV-OPN-FSCL-MN-DTE                                      
           ELSE                                                         MLKRP803
               DISPLAY 'USING INPUT CONTROL CARD FISCAL END DATE: '             
                        CC-CONTROL-CARD                                 MLKRP803
               IF CC-FISCAL-END-YEAR IS NUMERIC                         MLKRP803
                 AND CC-FISCAL-END-DSH1 = '-'                           MLKRP803
                 AND CC-FISCAL-END-MONTH IS NUMERIC                     MLKRP803
                 AND CC-FISCAL-END-DSH2 = '-'                           MLKRP803
                 AND CC-FISCAL-END-DAY IS NUMERIC                       MLKRP803
                   MOVE CC-FISCAL-END-DATE TO PV-OPN-FSCL-MN-DTE                
               ELSE                                                     MLKRP803
                   SET AC-BAD-CONTROL-CARD TO TRUE                              
                   DISPLAY 'INVALID INPUT CONTROL CARD FISCAL END DATE'         
                   DISPLAY '** ABEND IN PGM  ', PC-PROGRAM-NAME                 
                   CALL 'ILBOABN0' USING ABEND-CODE                             
               END-IF                                                   MLKRP803
           END-IF.                                                      MLKRP803
                                                                        MLKRP803
           PERFORM F200-SELECT-CURR-YR-TDTATTR.                                 
           DISPLAY '*** CURRENT FISCAL YEAR NUMBER IS:  '                       
                 DTATTR-FSCL-YR-NBR.                                            
           DISPLAY '*** CURRENT FISCAL MONTH NUMBER IS: '                       
                 DTATTR-FSCL-MN-NBR.                                            
                                                                        MLKRP803
           MOVE DTATTR-FSCL-MN-NM         TO SH-MONTH.                     CL**4
0101RM*** MADE THE FOLLOWING CHANGE BECAUSE IN JANUARY THE YEAR PRINTING        
0101RM*** WAS THE CALENDAR YEAR NOT THE FISCAL YEAR.                            
0101RM*    MOVE DTATTR-FSCL-YR-NBR        TO SH-YEAR.                      CL**4
0101RM     MOVE PV-OPN-FSCL-MN-CCYY       TO SH-YEAR.                           
                                                                                
0500RM     IF CC-FISCAL-END-DATE = SPACES                               MLKRP803
0500RM         PERFORM F210-SELECT-WEEK-IN-MTH-NBR                              
0500RM         MOVE PV-OPN-FSCL-WK-NBR    TO SH-WEEK-NBR                        
0500RM     ELSE                                                                 
0400RM         MOVE DTATTR-WK-IN-MN-NBR   TO SH-WEEK-NBR                   CL**4
0500RM     END-IF.                                                              
                                                                           CL**4
           PERFORM F250-SELECT-TY-SEA-BEG-TDTATTR.                              
           DISPLAY '*** CURRENT SEASON FISCAL MONTH NUMBER IS: '                
                 DTATTR-FSCL-MN-NBR.                                            
                                                                        MLKRP800
           PERFORM F300-SELECT-LAST-YR-TDTATTR.                                 
           DISPLAY '*** LAST FISCAL YEAR NUMBER IS:  '                          
                 DTATTR-FSCL-YR-NBR.                                            
           DISPLAY '*** LAST FISCAL MONTH NUMBER IS: '                          
                 DTATTR-FSCL-MN-NBR.                                            
                                                                        MLKRP803
           PERFORM 1200-HOUSKEEPING.                                    MLKRP803
                                                                        MLKRP803
           INITIALIZE DL-DETAIL-LINE.                                      CL**4
                                                                           CL**4
           PERFORM 6000-PRINT-HEADERS.                                     CL**4
                                                                           CL**4
           MOVE '|' TO DL-SEPARATOR.                                       CL**4
                                                                           CL**4
           PERFORM 4000-READ-REPORT-DATA.                                  CL**4
                                                                           CL**4
       EJECT                                                               CL**4
                                                                           CL**4
       1200-HOUSKEEPING.                                                MLKRP803
      ******************************************************************MLKRP803
      *   1200-HOUSKEEPING.                                            *MLKRP803
      *   DOES THE FOLLOWING:                                          *MLKRP803
      *      1.  SET-UP HEADING LINE                                   *MLKRP803
      *                                                                *MLKRP803
      *   PERFORMED BY: 1000-INITIALIZE-HEADER.                        *MLKRP803
      ******************************************************************MLKRP803
                                                                        MLKRP803
           ADD 1 TO PV-FISCAL-TY-END-MONTH                              MLKRP803
                 GIVING PV-CAL-TY-END-MONTH.                                    
           IF PV-CAL-TY-END-MONTH = 13                                          
               MOVE 1 TO PV-CAL-TY-END-MONTH                                    
               ADD 1 TO PV-FISCAL-TY-CCYY                               MLKRP803
                     GIVING PV-CAL-TY-END-CCYY                                  
           ELSE                                                                 
               MOVE PV-FISCAL-TY-CCYY TO PV-CAL-TY-END-CCYY             MLKRP803
           END-IF.                                                              
                                                                        MLKRP803
           ADD 1 TO PV-FISCAL-TY-BEG-MONTH                              MLKRP800
                 GIVING PV-CAL-TY-BEG-MONTH.                                    
                                                                        MLKRP800
           ADD 1 TO PV-FISCAL-LY-END-MONTH                              MLKRP803
                 GIVING PV-CAL-LY-END-MONTH.                                    
           IF PV-CAL-LY-END-MONTH = 13                                          
               MOVE 1 TO PV-CAL-LY-END-MONTH                                    
               ADD 1 TO PV-FISCAL-LY-CCYY                               MLKRP803
                     GIVING PV-CAL-LY-END-CCYY                                  
           ELSE                                                                 
               MOVE PV-FISCAL-LY-CCYY TO PV-CAL-LY-END-CCYY             MLKRP803
           END-IF.                                                              
                                                                        MLKRP803
           MOVE PV-CAL-TY-BEG-MONTH      TO PV-HDG-START-MM-TY          MLKRP803
                                            PV-HDG-START-MM-LY.         MLKRP803
           MOVE PV-FISCAL-TY-CCYY        TO PV-HDG-START-CCYY-TY.       MLKRP803
           MOVE PV-FISCAL-LY-CCYY        TO PV-HDG-START-CCYY-LY.       MLKRP803
                                                                        MLKRP803
           MOVE PV-CAL-TY-END-MONTH      TO PV-HDG-END-MM-TY.           MLKRP803
           MOVE PV-CAL-LY-END-MONTH      TO PV-HDG-END-MM-LY.           MLKRP803
           MOVE PV-CAL-TY-END-CCYY       TO PV-HDG-END-CCYY-TY.         MLKRP803
           MOVE PV-CAL-LY-END-CCYY       TO PV-HDG-END-CCYY-LY.         MLKRP803
           MOVE PV-HDG-DATE-TY           TO DH-DATE-RANGE-TY.              CL*26
           MOVE PV-HDG-DATE-LY           TO DH-DATE-RANGE-LY.              CL*26
                                                                        MLKRP803
       EJECT                                                               CL**4
                                                                           CL**4
       2000-PROCESS.                                                       CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT DETAIL FOR THE CURRENT VENDOR AND READ THE NEXT           CL**4
      *    INPUT RECORD.                                                   CL**4
      *                                                                    CL**4
      *    PERFORMED BY 0000-MLKRP803.                                     CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           PERFORM 2200-NEW-ENT-ID.                                        CL**4
                                                                           CL**4
           PERFORM 4000-READ-REPORT-DATA.                                  CL**4
                                                                           CL**4
           EJECT                                                           CL**4
                                                                           CL**4
       B300-GRAND-TOTAL-PCT.                                               CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    DETERMINE THE GRAND TOTALS FOR THE PERCENTAGE FIELDS USING      CL**4
      *    THE GRAND TOTALS ALREADY CALCULATED.                            CL**4
      *                                                                    CL**4
      *    PERFORMED BY 0000-MLKRP803.                                     CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               GT-NET-MKUP-TY * 100                                        CL**4
             / GT-RETAIL-PURCH-TY                                          CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-NET-MKUP-PCT-TY.                       CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
0999RM       ( GT-CUM-TO-DATE-PURCH-RETAIL-TY                                   
0999RM       - GT-CUM-TO-DATE-PURCH-COST-TY ) * 100.00                          
0999RM       / GT-CUM-TO-DATE-PURCH-RETAIL-TY                           MLKRP803
               ON SIZE ERROR                                            MLKRP803
                   MOVE 100 TO PV-NEW-TOTAL1.                           MLKRP803
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-CUMM-MKUP-PCT-TY.                      CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
0999RM*        GT-TOTAL-MKDN-TY * 100 / GT-TOTAL-SALES-TY                  CL**4
0999RM       ((GT-TOTAL-MKDN-TY + UVGT-TOTAL-MKDN-TY) * 100)               CL**4
0999RM      / (GT-TOTAL-SALES-TY + UVGT-TOTAL-SALES-TY)                    CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-MKDN-PCT-SALES-TY.                     CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               GT-GROSS-MRGIN-TY * 100 / GT-TOTAL-SALES-TY                 CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
                                                                           CL**4
           MOVE PV-NEW-TOTAL1 TO GT-GROSS-MRGIN-PCT-TY.                    CL**4
                                                                           CL**4
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM*    IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998 OR PC-1999                         
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL1 ROUNDED =                             CL**4
                   GT-NET-MKUP-LY * 100                                    CL**4
                 / GT-RETAIL-PURCH-LY                                      CL**4
                   ON SIZE ERROR                                           CL**4
                       INITIALIZE PV-NEW-TOTAL1                            CL**4
               END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL1 TO GT-NET-MKUP-PCT-LY                    CL**4
               COMPUTE PV-NEW-TOTAL1 ROUNDED =                             CL**4
                   GT-GROSS-MRGIN-LY * 100 / GT-TOTAL-SALES-LY             CL**4
                   ON SIZE ERROR                                           CL**4
                       INITIALIZE PV-NEW-TOTAL1                            CL**4
               END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL1 TO GT-GROSS-MRGIN-PCT-LY                 CL**4
           END-IF.                                                              
                                                                           CL**4
       B400-GRAND-TOTALS.                                                  CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP THE DETAIL LINE FOR THE GRAND TOTALS AND PRINT.          CL**4
      *    DIVIDE CERTAIN VALUES BY 1000, SO THE HUNDRETHS DIGIT IS        CL**4
      *    EXPRESSED AS A DECIMAL POINT.  (I.E. 240120 = 240.1)            CL**4
      *                                                                    CL**4
      *    PERFORMED BY 0000-MLKRP803.                                     CL**4
      ****************************************************************     CL**4
                                                                           CL**4
0999RM     INITIALIZE GTL-GRAND-TOTAL-LINE-1                                    
0999RM                GTL-GRAND-TOTAL-LINE-2.                                   
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*                 GT-GROSS-COST / 1000.00.                           CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-GROSS-COST.                   CL**4
0899RM*                                                                    CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        GT-PURCH-ADJ-COST   / 1000.00.                              CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-PURCH-ADJ-COST.               CL**4
0899RM*                                                                    CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*                 GT-NET-COST-TY / 1000.00.                          CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-NET-COST-TY.                  CL**4
0899RM*                                                                    CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*                 GT-RETAIL-PURCH-TY / 1000.00.                      CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO GTL-RETAIL-PURCH-TY.              CL**4
0899RM                                                                     CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        GT-RECEIPT-COST-TY / 1000.00.                               CL**4
0999RM            (UVGT-RECEIPT-COST-TY + GT-RECEIPT-COST-TY) / 1000.00.   CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-RECEIPT-COST-TY.              CL**4
0899RM                                                                     CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*           GT-RECEIPT-RTL-TY / 1000.00.                             CL**4
0999RM            (UVGT-RECEIPT-RTL-TY + GT-RECEIPT-RTL-TY) / 1000.00.     CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-RECEIPT-RTL-TY.               CL**4
0899RM                                                                     CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        GT-PURCH-ADJ-COST-TY / 1000.00.                             CL**4
0899RM            (UVGT-PRCH-ADJ-COST-TY + GT-PURCH-ADJ-COST-TY)           CL**4
0899RM            / 1000.00.                                               CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-PURCH-ADJ-COST-TY.            CL**4
0899RM                                                                     CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        GT-PURCH-ADJ-RTL-TY / 1000.00.                              CL**4
0899RM         (UVGT-PRCH-ADJ-RTL-TY + GT-PURCH-ADJ-RTL-TY) / 1000.00.     CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO GTL-PURCH-ADJ-RTL-TY.             CL**4
0899RM                                                                          
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*                 GT-TOTAL-SALES-TY / 1000.00.                       CL**4
0999RM            (UVGT-TOTAL-SALES-TY + GT-TOTAL-SALES-TY) / 1000.00.     CL**4
           MOVE PV-NEW-TOTAL2         TO GTL-TOTAL-SALES-TY.               CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*                 GT-TOTAL-MKDN-TY / 1000.00.                        CL**4
0999RM            (UVGT-TOTAL-MKDN-TY + GT-TOTAL-MKDN-TY) / 1000.00.       CL**4
           MOVE PV-NEW-TOTAL2         TO GTL-TOTAL-MKDN-TY.                CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0999RM*                 GT-END-INV-RTL-TY / 1000.00.                       CL**4
0999RM            (UVGT-END-INV-RTL-TY + GT-END-INV-RTL-TY) / 1000.00.     CL**4
           MOVE PV-NEW-TOTAL2         TO GTL-INVEN-RTL-DLR-TY.             CL**4
                                                                           CL**4
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*                     GT-NET-COST-LY / 1000.00.                      CL**4
0999RM                (UVGT-NET-COST-LY + GT-NET-COST-LY)                  CL**4
0999RM              / 1000.00                                              CL**4
               MOVE PV-NEW-TOTAL2     TO GTL-NET-COST-LY                   CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*               GT-RETAIL-PURCH-LY / 1000.00.                        CL**4
0999RM                (UVGT-RETAIL-PURCH-LY + GT-RETAIL-PURCH-LY)          CL**4
0999RM              / 1000.00                                              CL**4
               MOVE PV-NEW-TOTAL2     TO GTL-RETAIL-PURCH-LY               CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
0999RM*                     GT-TOTAL-SALES-LY / 1000.00.                   CL**4
0999RM                (UVGT-TOTAL-SALES-LY + GT-TOTAL-SALES-LY)         0. CL**4
0999RM               / 1000.00                                          0. CL**4
               MOVE PV-NEW-TOTAL2     TO GTL-TOTAL-SALES-LY                CL**4
0100RM*-- DO NOT PRINT 1999 DATA (LAST YEAR)                                    
0100RM         IF PV-HDG-START-CCYY-LY = PC-1999                                
0100RM             CONTINUE                                                     
0100RM         ELSE                                                             
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
0999RM*                    GT-TOTAL-MKDN-LY / 1000.00.                     CL**4
0999RM                    (UVGT-TOTAL-MKDN-LY + GT-TOTAL-MKDN-LY)          CL**4
0999RM                   / 1000.00                                      0. CL**4
                   MOVE PV-NEW-TOTAL2 TO GTL-TOTAL-MKDN-LY                 CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
0999RM*                    GT-END-INV-RTL-LY / 1000.00.                    CL**4
0999RM                    (UVGT-END-INV-RTL-LY + GT-END-INV-RTL-LY)     0. CL**4
0999RM                   / 1000.00                                      0. CL**4
                   MOVE PV-NEW-TOTAL2         TO GTL-INVEN-RTL-DLR-LY      CL**4
                   MOVE GT-NET-MKUP-PCT-LY    TO GTL-NET-MKUP-PCT-LY       CL**4
                   MOVE GT-GROSS-MRGIN-PCT-LY TO GTL-GROSS-MRGIN-PCT-LY    CL**4
0100RM         END-IF                                                      CL**4
0999RM     END-IF.                                                         CL**4
                                                                                
           MOVE GT-NET-MKUP-PCT-TY    TO GTL-NET-MKUP-PCT-TY.              CL**4
           MOVE GT-CUMM-MKUP-PCT-TY   TO GTL-CUMM-MARKUP-PCT-TY.           CL**4
           MOVE GT-MKDN-PCT-SALES-TY  TO GTL-MKDN-PCT-SALES-TY.            CL**4
           MOVE GT-GROSS-MRGIN-PCT-TY TO GTL-GROSS-MRGIN-PCT-TY.           CL**4
                                                                           CL**4
           PERFORM Z450-PRINT-GRAND-TOTALS.                                CL**4
                                                                           CL**4
       2200-NEW-ENT-ID.                                                    CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP AND PRINT THE DETAIL LINE.                               CL**4
      *    CHECK IF A NEW PAGE HEADER IS REQUIRED.                         CL**4
      *    UPDATE THE GRAND TOTALS FROM THE CURRENT VENDOR.                CL**4
      *    INITIALIZE THE DETAIL LINE.                                     CL**4
      *                                                                    CL**4
      *    PERFORMED BY 0000-MLKRP803.                                     CL**4
      *    PERFORMED BY 2000-PROCESS.                                      CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           PERFORM D100-MOVE-TO-DETAIL.                                    CL**4
                                                                           CL**4
           PERFORM D300-CHECK-DETAIL-GT-ZERO.                                   
           IF PS-PRINT-DETAIL                                                   
0999RM         IF PV-LINE-COUNTER >= PC-LINE-MAX                           CL**4
0999RM             PERFORM 6000-PRINT-HEADERS                              CL**4
0999RM         END-IF                                                      CL**4
0999RM         IF PV-HDG-START-CCYY-LY = PC-1998                                
0999RM             IF PV-TOTAL-SALES-TY > PC-MIN-TOTAL-SALES                    
1099RM             OR (ML202-ENT-ID = PC-UNKNOWN-VENDOR)                        
0999RM                 PERFORM Z300-PRINT-DETAIL                               C
0999RM                 ADD 2 TO PV-LINE-COUNTER                                C
0999RM             ELSE                                                         
0999RM                 PERFORM E100-ADD-MISC-VENDOR                            C
0999RM             END-IF                                                       
0999RM         ELSE                                                             
                   IF PV-TOTAL-SALES-TY > PC-MIN-TOTAL-SALES                    
                     OR PV-TOTAL-SALES-LY > PC-MIN-TOTAL-SALES                  
1099RM               OR (ML202-ENT-ID = PC-UNKNOWN-VENDOR)                      
                       PERFORM Z300-PRINT-DETAIL                               C
                       ADD 2 TO PV-LINE-COUNTER                                C
                   ELSE                                                         
                       PERFORM E100-ADD-MISC-VENDOR                            C
                   END-IF                                                       
               END-IF                                                           
           END-IF.                                                              
                                                                           CL**4
0999RM*    IF PV-LINE-COUNTER >= PC-LINE-MAX                               CL**4
0999RM*        PERFORM 6000-PRINT-HEADERS                                  CL**4
0999RM*    END-IF.                                                         CL**4
                                                                           CL**4
0899RM*-- ACCUMULATE ALL UNKNOWN VENDOR (5161) SEPARATELY                  CL**4
0999RM     IF ML202-ENT-ID = PC-UNKNOWN-VENDOR                                  
0999RM         PERFORM D220-ADD-UNKNOWN-VNDR-TOTALS                             
0999RM     ELSE                                                                 
0999RM         PERFORM D200-ADD-GRAND-TOTALS                               CL**4
0999RM     END-IF.                                                              
0999RM*    PERFORM D200-ADD-GRAND-TOTALS.                                  CL**4
                                                                           CL**4
           INITIALIZE DL-DETAIL-LINE.                                      CL**4
                                                                           CL**4
           MOVE '|' TO DL-SEPARATOR.                                       CL**4
                                                                           CL**4
       EJECT                                                               CL**4
       D100-MOVE-TO-DETAIL.                                                CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    SET UP THE DETAIL LINE FOR THE CURRENT VENDOR.                  CL**4
      *    DIVIDE CERTAIN VALUES BY 1000, SO THE HUNDRETHS DIGIT IS        CL**4
      *    EXPRESSED AS A DECIMAL POINT.  (I.E. 240120 = 240.1)            CL**4
      *                                                                    CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           MOVE ML202-NAME-VENDOR TO DL-VENDOR-NAME.                       CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*           ML202-TY-RCPT-GRO-COST-AMT / 1000.00.                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-GROSS-COST.                CL**4
                                                                           CL**4
      *-- RECEIPTS - COST                                                       
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                      
0899RM             ML202-TY-RCPT-NET-COST-AMT / 1000.00.                        
0899RM     MOVE PV-NEW-TOTAL2             TO DL-RECEIPT-COST-TY.           CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        ML202-TY-PADJ-NET-COST-AMT / 1000.00.                       CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-PURCH-ADJ-COST.            CL**4
                                                                           CL**4
      *-- RECEIPTS - RETAIL                                                     
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM         ML202-TY-RCPT-RTL-AMT / 1000.00.                            CL**4
0899RM     MOVE PV-NEW-TOTAL2       TO DL-RECEIPT-RTL-TY.                  CL**4
                                                                                
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*          (ML202-TY-RCPT-NET-COST-AMT                               CL**4
0899RM*           + ML202-TY-PADJ-NET-COST-AMT) / 1000.00.                 CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-NET-COST-TY.               CL**4
                                                                           CL**4
      *-- PURCHASE ADJUSTMENTS - COST                                           
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM             ML202-TY-PADJ-NET-COST-AMT / 1000.00.                   CL**4
0899RM     MOVE PV-NEW-TOTAL2             TO DL-PURCH-ADJ-COST-TY.         CL**4
                                                                                
0899RM     COMPUTE PV-RETAIL-PURCH-TY = ML202-TY-RCPT-RTL-AMT           MLKRP803
0899RM                                + ML202-TY-PADJ-RTL-AMT           MLKRP803
0899RM                                + ML202-TY-MKUP-RTL-AMT           MLKRP803
0899RM                                + ML202-TY-XFER-IN-RTL-AMT        MLKRP803
0899RM                                - ML202-TY-XFER-OUT-RTL-AMT.      MLKRP803
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        PV-RETAIL-PURCH-TY / 1000.00.                               CL**4
0899RM*    MOVE PV-NEW-TOTAL2             TO DL-RETAIL-PURCH-TY.           CL**4
                                                                           CL**4
      *-- PURCHASE ADJUSTMENTS - RETAIL                                         
0899RM     COMPUTE PV-NEW-TOTAL2 =                                              
0899RM           ( ML202-TY-PADJ-RTL-AMT                                        
0899RM           + ML202-TY-MKUP-RTL-AMT                                        
0899RM           + ML202-TY-XFER-IN-RTL-AMT                                     
0899RM           - ML202-TY-XFER-OUT-RTL-AMT) / 1000.00.                        
0899RM     MOVE PV-NEW-TOTAL2             TO DL-PURCH-ADJ-RTL-TY.          CL**4
                                                                           CL**4
           COMPUTE PV-PERCENT ROUNDED =                                 MLKRP803
                        ML202-TY-MKUP-NET-AMT * 100.00                  MLKRP803
                      / PV-RETAIL-PURCH-TY                              MLKRP803
                        ON SIZE ERROR MOVE 0 TO PV-PERCENT              MLKRP803
           END-COMPUTE.                                                 MLKRP803
           MOVE PV-PERCENT                TO DL-NET-MKUP-PCT-TY.        MLKRP803
                                                                           CL**4
           COMPUTE PV-CUM-TO-DATE-PURCH-COST   =                                
                                       ML202-TY-PREV-SEA-EI-COST                
                                     + ML202-TY-RCPT-NET-COST-AMT               
                                     + ML202-TY-PADJ-NET-COST-AMT.              
           COMPUTE PV-CUM-TO-DATE-PURCH-RETAIL =                        MLKRP803
                                       ML202-TY-PREV-SEA-EI-RTL                 
                                     + ML202-TY-XFER-IN-RTL-AMT         MLKRP803
                                     - ML202-TY-XFER-OUT-RTL-AMT        MLKRP803
                                     + ML202-TY-RCPT-RTL-AMT               CL**4
                                     + ML202-TY-PADJ-RTL-AMT               CL**4
                                     + ML202-TY-MKUP-RTL-AMT.              CL**4
                                                                           CL**4
           COMPUTE PV-PERCENT ROUNDED =                                 MLKRP803
                      ( PV-CUM-TO-DATE-PURCH-RETAIL                             
                      - PV-CUM-TO-DATE-PURCH-COST ) * 100.00                    
                      / PV-CUM-TO-DATE-PURCH-RETAIL                     MLKRP803
                        ON SIZE ERROR MOVE 100 TO PV-PERCENT            MLKRP803
           END-COMPUTE.                                                 MLKRP803
           MOVE PV-PERCENT                TO DL-CUMM-MARKUP-PCT-TY.     MLKRP803
                                                                           CL**4
           COMPUTE PV-TOTAL-SALES-TY = ML202-TY-SLS-REG-RTL-AMT         MLKRP803
                                     + ML202-TY-SLS-PROMO-RTL-AMT       MLKRP803
                                     + ML202-TY-SLS-PROCLR-RTL-AMT      MLKRP803
                                     + ML202-TY-SLS-CLR-RTL-AMT         MLKRP803
                                     + ML202-TY-SLS-OTH-RTL-AMT.        MLKRP803
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               PV-TOTAL-SALES-TY / 1000.00.                                CL**4
           MOVE PV-NEW-TOTAL2             TO DL-TOTAL-SALES-TY.            CL**4
                                                                           CL**4
           COMPUTE PV-TOTAL-MKDN-TY = ML202-TY-MKDN-PLU-RTL-AMT         MLKRP803
                                    + ML202-TY-MKDN-RGST-RTL-AMT        MLKRP803
                                    + ML202-TY-MKDN-UMTCH-RTL-AMT       MLKRP803
                                    + ML202-TY-MKDN-BYR-RTL-AMT         MLKRP803
                                    + ML202-TY-MKDN-STR-RTL-AMT.        MLKRP803
                                                                        MLKRP803
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               PV-TOTAL-MKDN-TY / 1000.00.                                 CL**4
           MOVE PV-NEW-TOTAL2             TO DL-TOTAL-MKDN-TY.             CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               PV-TOTAL-MKDN-TY * 100 / PV-TOTAL-SALES-TY                  CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1             TO DL-MKDN-PCT-SALES-TY.         CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               ML202-TY-GRO-MRGN-AMT * 100 / PV-TOTAL-SALES-TY             CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1             TO DL-GROSS-MRGIN-PCT-TY.        CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               ML202-TY-END-INV-RTL-AMT / 1000.00.                         CL**4
           MOVE PV-NEW-TOTAL2            TO DL-INVEN-RTL-DLR-TY.           CL**4
                                                                           CL**4
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                     (ML202-LY-RCPT-NET-COST-AMT                           CL**4
                    + ML202-LY-PADJ-NET-COST-AMT) / 1000.00                CL**4
               END-COMPUTE                                                      
               MOVE PV-NEW-TOTAL2         TO DL-NET-COST-LY                CL**4
               COMPUTE PV-RETAIL-PURCH-LY = ML202-LY-RCPT-RTL-AMT       MLKRP803
                                          + ML202-LY-PADJ-RTL-AMT       MLKRP803
                                          + ML202-LY-MKUP-RTL-AMT       MLKRP803
                                          + ML202-LY-XFER-IN-RTL-AMT    MLKRP803
                                          - ML202-LY-XFER-OUT-RTL-AMT   MLKRP803
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   PV-RETAIL-PURCH-LY / 1000.00                            CL**4
               MOVE PV-NEW-TOTAL2         TO DL-RETAIL-PURCH-LY            CL**4
               COMPUTE PV-TOTAL-SALES-LY =                              MLKRP803
                       ML202-LY-SLS-REG-RTL-AMT                         MLKRP803
                     + ML202-LY-SLS-PROMO-RTL-AMT                       MLKRP803
                     + ML202-LY-SLS-PROCLR-RTL-AMT                      MLKRP803
                     + ML202-LY-SLS-CLR-RTL-AMT                         MLKRP803
                     + ML202-LY-SLS-OTH-RTL-AMT                         MLKRP803
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   PV-TOTAL-SALES-LY / 1000.00                             CL**4
               MOVE PV-NEW-TOTAL2         TO DL-TOTAL-SALES-LY             CL**4
               COMPUTE PV-PERCENT ROUNDED =                             MLKRP803
                            ML202-LY-MKUP-NET-AMT * 100.00              MLKRP803
                          / PV-RETAIL-PURCH-LY                          MLKRP803
                            ON SIZE ERROR MOVE 0 TO PV-PERCENT          MLKRP803
               END-COMPUTE                                              MLKRP803
               MOVE PV-PERCENT            TO DL-NET-MKUP-PCT-LY         MLKRP803
0100RM*--     DO NOT PRINT 1999 DATA (LAST YEAR)                                
0100RM         IF PV-HDG-START-CCYY-LY = PC-1999                                
0100RM             CONTINUE                                                     
0100RM         ELSE                                                             
                   COMPUTE PV-TOTAL-MKDN-LY =                           MLKRP803
                           ML202-LY-MKDN-PLU-RTL-AMT                    MLKRP803
                         + ML202-LY-MKDN-RGST-RTL-AMT                   MLKRP803
                         + ML202-LY-MKDN-UMTCH-RTL-AMT                  MLKRP803
                         + ML202-LY-MKDN-BYR-RTL-AMT                    MLKRP803
                         + ML202-LY-MKDN-STR-RTL-AMT                    MLKRP803
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       PV-TOTAL-MKDN-LY / 1000.00                          CL**4
                   MOVE PV-NEW-TOTAL2     TO DL-TOTAL-MKDN-LY              CL**4
                   COMPUTE PV-NEW-TOTAL1 ROUNDED =                         CL**4
                       ML202-LY-GRO-MRGN-AMT * 100 / PV-TOTAL-SALES-LY     CL**4
                       ON SIZE ERROR                                       CL**4
                           INITIALIZE PV-NEW-TOTAL1                        CL**4
                   END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL1     TO DL-GROSS-MRGIN-PCT-LY         CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       ML202-LY-END-INV-RTL-AMT / 1000.00                  CL**4
                   END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL2    TO DL-INVEN-RTL-DLR-LY            CL**4
           END-IF.                                                              
                                                                           CL**4
       D200-ADD-GRAND-TOTALS.                                              CL**4
      ****************************************************************     CL**4
      *    UPDATE THE GRAND TOTALS WITH THE CURRENT VENDOR TOTALS.         CL**4
      *                                                                    CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
0899RM*    ADD ML202-TY-RCPT-GRO-COST-AMT TO GT-GROSS-COST.                CL**4
0899RM*    ADD ML202-TY-PADJ-NET-COST-AMT TO GT-PURCH-ADJ-COST.            CL**4
0899RM*    COMPUTE GT-NET-COST-TY = GT-NET-COST-TY                         CL**4
0899RM*                           + ML202-TY-RCPT-NET-COST-AMT             CL**4
0899RM*                           + ML202-TY-PADJ-NET-COST-AMT.            CL**4
0899RM     ADD PV-RETAIL-PURCH-TY          TO GT-RETAIL-PURCH-TY.          CL**4
                                                                                
0899RM     ADD ML202-TY-RCPT-NET-COST-AMT TO GT-RECEIPT-COST-TY.                
0899RM     ADD ML202-TY-RCPT-RTL-AMT      TO GT-RECEIPT-RTL-TY.                 
0899RM     ADD ML202-TY-PADJ-NET-COST-AMT TO GT-PURCH-ADJ-COST-TY.              
0899RM     COMPUTE GT-PURCH-ADJ-RTL-TY =                                        
0899RM           ( GT-PURCH-ADJ-RTL-TY                                          
0899RM           + ML202-TY-PADJ-RTL-AMT                                        
0899RM           + ML202-TY-MKUP-RTL-AMT                                        
0899RM           + ML202-TY-XFER-IN-RTL-AMT                                     
0899RM           - ML202-TY-XFER-OUT-RTL-AMT).                                  
                                                                                
           ADD ML202-TY-MKUP-NET-AMT   TO GT-NET-MKUP-TY.                  CL**4
           ADD PV-TOTAL-SALES-TY       TO GT-TOTAL-SALES-TY.               CL**4
           ADD PV-TOTAL-MKDN-TY        TO GT-TOTAL-MKDN-TY.                CL**4
           ADD ML202-TY-GRO-MRGN-AMT   TO GT-GROSS-MRGIN-TY.               CL**4
           ADD ML202-TY-END-INV-RTL-AMT                                         
                                       TO GT-END-INV-RTL-TY.                    
           ADD PV-CUM-TO-DATE-PURCH-COST                                        
                                       TO GT-CUM-TO-DATE-PURCH-COST-TY.         
           ADD PV-CUM-TO-DATE-PURCH-RETAIL                                      
                                      TO GT-CUM-TO-DATE-PURCH-RETAIL-TY.        
                                                                                
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE GT-NET-COST-LY = GT-NET-COST-LY                     CL**4
                                      + ML202-LY-RCPT-NET-COST-AMT         CL**4
                                      + ML202-LY-PADJ-NET-COST-AMT         CL**4
               ADD PV-RETAIL-PURCH-LY    TO GT-RETAIL-PURCH-LY             CL**4
               ADD ML202-LY-MKUP-NET-AMT TO GT-NET-MKUP-LY                 CL**4
               ADD PV-TOTAL-SALES-LY     TO GT-TOTAL-SALES-LY              CL**4
               ADD PV-TOTAL-MKDN-LY      TO GT-TOTAL-MKDN-LY               CL**4
               ADD ML202-LY-GRO-MRGN-AMT TO GT-GROSS-MRGIN-LY              CL**4
               ADD ML202-LY-END-INV-RTL-AMT                                     
                                         TO GT-END-INV-RTL-LY                   
0999RM     END-IF.                                                              
                                                                           CL**4
       D220-ADD-UNKNOWN-VNDR-TOTALS.                                       CL**4
      ****************************************************************     CL**4
      *    UPDATE THE GRAND TOTALS WITH THE CURRENT VENDOR TOTALS.         CL**4
      *                                                                    CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
0899RM     ADD PV-RETAIL-PURCH-TY          TO UVGT-RETAIL-PURCH-TY.        CL**4
                                                                                
0899RM     ADD ML202-TY-RCPT-NET-COST-AMT TO UVGT-RECEIPT-COST-TY.              
0899RM     ADD ML202-TY-RCPT-RTL-AMT      TO UVGT-RECEIPT-RTL-TY.               
0899RM     ADD ML202-TY-PADJ-NET-COST-AMT TO UVGT-PRCH-ADJ-COST-TY.             
0899RM     COMPUTE UVGT-PRCH-ADJ-RTL-TY =                                       
0899RM           ( UVGT-PRCH-ADJ-RTL-TY                                         
0899RM           + ML202-TY-PADJ-RTL-AMT                                        
0899RM           + ML202-TY-MKUP-RTL-AMT                                        
0899RM           + ML202-TY-XFER-IN-RTL-AMT                                     
0899RM           - ML202-TY-XFER-OUT-RTL-AMT).                                  
                                                                                
           ADD ML202-TY-MKUP-NET-AMT   TO UVGT-NET-MKUP-TY.                CL**4
           ADD PV-TOTAL-SALES-TY       TO UVGT-TOTAL-SALES-TY.             CL**4
           ADD PV-TOTAL-MKDN-TY        TO UVGT-TOTAL-MKDN-TY.              CL**4
           ADD ML202-TY-GRO-MRGN-AMT   TO UVGT-GROSS-MRGIN-TY.             CL**4
           ADD ML202-TY-END-INV-RTL-AMT                                         
                                       TO UVGT-END-INV-RTL-TY.                  
           ADD PV-CUM-TO-DATE-PURCH-COST                                        
                                       TO UVGT-STD-PURCH-COST-TY.       .       
           ADD PV-CUM-TO-DATE-PURCH-RETAIL                                      
                                      TO UVGT-STD-PURCH-RTL-TY.         Y.      
           COMPUTE UVGT-NET-COST-LY = UVGT-NET-COST-LY                     CL**4
                                  + ML202-LY-RCPT-NET-COST-AMT             CL**4
                                  + ML202-LY-PADJ-NET-COST-AMT.            CL**4
                                                                                
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               ADD PV-RETAIL-PURCH-LY    TO UVGT-RETAIL-PURCH-LY           CL**4
               ADD ML202-LY-MKUP-NET-AMT TO UVGT-NET-MKUP-LY               CL**4
               ADD PV-TOTAL-SALES-LY     TO UVGT-TOTAL-SALES-LY            CL**4
               ADD PV-TOTAL-MKDN-LY      TO UVGT-TOTAL-MKDN-LY             CL**4
               ADD ML202-LY-GRO-MRGN-AMT TO UVGT-GROSS-MRGIN-LY            CL**4
               ADD ML202-LY-END-INV-RTL-AMT                                     
                                         TO UVGT-END-INV-RTL-LY                 
0999RM     END-IF.                                                              
                                                                                
       D300-CHECK-DETAIL-GT-ZERO.                                          CL**4
      ****************************************************************     CL**4
      *    CHECK THE DOLLAR FIELDS IN DETAIL LINE NUMBER 2 TO              CL**4
      *    DETERMINE IF ANY ONE OF THEM WILL BE GREATER THAN ZERO.              
      *    IF ONE IS THEN THE DETAIL LINES WILL BE PRINTED, OTHERWISE           
      *    THE DETAIL LINES ARE NOT PLACED ON THE REPORT.                       
      *                                                                    CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           SET PS-PRINT-DETAIL TO TRUE.                                         
                                                                                
0899RM*    IF DL-GROSS-COST                   = SPACES AND                      
0899RM*       DL-PURCH-ADJ-COST               = SPACES AND                      
0899RM*       DL-NET-COST-TY                  = SPACES AND                      
0899RM*       DL-RETAIL-PURCH-TY              = SPACES AND                      
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0899RM         IF DL-RECEIPT-COST-TY          = SPACES AND                      
0899RM            DL-RECEIPT-RTL-TY           = SPACES AND                      
0899RM            DL-PURCH-ADJ-COST-TY        = SPACES AND                      
0899RM            DL-PURCH-ADJ-RTL-TY         = SPACES AND                      
                  DL-NET-MKUP-PCT-TY          = SPACES AND                      
                  DL-TOTAL-SALES-TY           = SPACES AND                      
                  DL-TOTAL-MKDN-TY            = SPACES AND                      
                  DL-MKDN-PCT-SALES-TY        = SPACES AND                      
                  DL-GROSS-MRGIN-PCT-TY       = SPACES                          
                   SET PS-NO-PRINT-DETAIL TO TRUE                               
                   INITIALIZE DL-DETAIL-LINE                                    
               END-IF                                                           
0999RM     ELSE                                                                 
0899RM         IF DL-RECEIPT-COST-TY          = SPACES AND                      
0899RM            DL-RECEIPT-RTL-TY           = SPACES AND                      
0899RM            DL-PURCH-ADJ-COST-TY        = SPACES AND                      
0899RM            DL-PURCH-ADJ-RTL-TY         = SPACES AND                      
                  DL-NET-MKUP-PCT-TY          = SPACES AND                      
                  DL-TOTAL-SALES-TY           = SPACES AND                      
                  DL-TOTAL-MKDN-TY            = SPACES AND                      
                  DL-MKDN-PCT-SALES-TY        = SPACES AND                      
                  DL-GROSS-MRGIN-PCT-TY       = SPACES AND                      
                  DL-NET-COST-LY              = SPACES AND                      
                  DL-RETAIL-PURCH-LY          = SPACES AND                      
                  DL-NET-MKUP-PCT-LY          = SPACES AND                      
                  DL-TOTAL-SALES-LY           = SPACES AND                      
                  DL-TOTAL-MKDN-LY            = SPACES AND                      
                  DL-GROSS-MRGIN-PCT-LY       = SPACES AND                      
                  DL-INVEN-RTL-DLR-LY         = SPACES                          
                   SET PS-NO-PRINT-DETAIL TO TRUE                               
                   INITIALIZE DL-DETAIL-LINE                                    
               END-IF                                                           
           END-IF.                                                              
                                                                           CL**4
       E100-ADD-MISC-VENDOR.                                               CL**4
      ****************************************************************     CL**4
      *    UPDATE THE MISCELLANEOUS VENDOR TOTALS WITH THE CURRENT         CL**4
      *    VENDOR TOTALS.                                                  CL**4
      *                                                                    CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
0899RM*    ADD ML202-TY-RCPT-GRO-COST-AMT TO MT-GROSS-COST.                CL**4
0899RM*    ADD ML202-TY-PADJ-NET-COST-AMT TO MT-PURCH-ADJ-COST.            CL**4
0899RM*    COMPUTE MT-NET-COST-TY = MT-NET-COST-TY                         CL**4
0899RM*                           + ML202-TY-RCPT-NET-COST-AMT             CL**4
0899RM*                           + ML202-TY-PADJ-NET-COST-AMT.            CL**4
0899RM     ADD PV-RETAIL-PURCH-TY      TO MT-RETAIL-PURCH-TY.              CL**4
                                                                                
0899RM     ADD ML202-TY-RCPT-NET-COST-AMT TO MT-RECEIPT-COST-TY.                
0899RM     ADD ML202-TY-RCPT-RTL-AMT      TO MT-RECEIPT-RTL-TY.                 
0899RM     ADD ML202-TY-PADJ-NET-COST-AMT TO MT-PURCH-ADJ-COST-TY.              
0899RM     COMPUTE MT-PURCH-ADJ-RTL-TY =                                        
0899RM           ( MT-PURCH-ADJ-RTL-TY                                          
0899RM           + ML202-TY-PADJ-RTL-AMT                                        
0899RM           + ML202-TY-MKUP-RTL-AMT                                        
0899RM           + ML202-TY-XFER-IN-RTL-AMT                                     
0899RM           - ML202-TY-XFER-OUT-RTL-AMT).                                  
                                                                                
           ADD ML202-TY-MKUP-NET-AMT   TO MT-NET-MKUP-TY.                  CL**4
           ADD PV-TOTAL-SALES-TY       TO MT-TOTAL-SALES-TY.               CL**4
           ADD PV-TOTAL-MKDN-TY        TO MT-TOTAL-MKDN-TY.                CL**4
           ADD ML202-TY-GRO-MRGN-AMT   TO MT-GROSS-MRGIN-TY.               CL**4
           ADD ML202-TY-END-INV-RTL-AMT                                         
                                       TO MT-END-INV-RTL-TY.                    
           ADD PV-CUM-TO-DATE-PURCH-COST                                        
                                       TO MT-CUM-TO-DATE-PURCH-COST-TY.         
           ADD PV-CUM-TO-DATE-PURCH-RETAIL                                      
                                      TO MT-CUM-TO-DATE-PURCH-RETAIL-TY.        
                                                                                
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE MT-NET-COST-LY = MT-NET-COST-LY                     CL**4
                                  + ML202-LY-RCPT-NET-COST-AMT             CL**4
                                  + ML202-LY-PADJ-NET-COST-AMT             CL**4
               ADD PV-RETAIL-PURCH-LY    TO MT-RETAIL-PURCH-LY             CL**4
               ADD ML202-LY-MKUP-NET-AMT TO MT-NET-MKUP-LY                 CL**4
               ADD PV-TOTAL-SALES-LY     TO MT-TOTAL-SALES-LY              CL**4
               ADD PV-TOTAL-MKDN-LY      TO MT-TOTAL-MKDN-LY               CL**4
               ADD ML202-LY-GRO-MRGN-AMT TO MT-GROSS-MRGIN-LY              CL**4
               ADD ML202-LY-END-INV-RTL-AMT                                     
                                         TO MT-END-INV-RTL-LY                   
0999RM     END-IF.                                                              
                                                                           CL**4
       E200-MISC-VENDOR-DETAIL.                                            CL**4
      ****************************************************************     CL**4
      *    SET UP THE DETAIL LINE FOR THE MISCELLANEOUS VENDOR LINE.       CL**4
      *    DIVIDE CERTAIN VALUES BY 1000, SO THE HUNDRETHS DIGIT IS        CL**4
      *    EXPRESSED AS A DECIMAL POINT.  (I.E. 240120 = 240.1)            CL**4
      *                                                                    CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           MOVE 'MISCELLANEOUS' TO DL-VENDOR-NAME.                         CL**4
                                                                           CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MT-GROSS-COST / 1000.00.                                    CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-GROSS-COST.                    CL**4
0899RM*                                                                    CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MT-PURCH-ADJ-COST / 1000.00.                                CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-PURCH-ADJ-COST.                CL**4
0899RM*                                                                    CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MT-NET-COST-TY / 1000.00.                                   CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-NET-COST-TY.                   CL**4
0899RM*                                                                    CL**4
0899RM*    COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM*        MT-RETAIL-PURCH-TY / 1000.00.                               CL**4
0899RM*    MOVE PV-NEW-TOTAL2         TO DL-RETAIL-PURCH-TY.               CL**4
                                                                           CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM         MT-RECEIPT-COST-TY / 1000.00.                               CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-RECEIPT-COST-TY.               CL**4
0899RM                                                                     CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM         MT-RECEIPT-RTL-TY / 1000.00.                                CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-RECEIPT-RTL-TY.                CL**4
0899RM                                                                     CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM         MT-PURCH-ADJ-COST-TY / 1000.00.                             CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-PURCH-ADJ-COST-TY.             CL**4
0899RM                                                                     CL**4
0899RM     COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
0899RM         MT-PURCH-ADJ-RTL-TY / 1000.00.                              CL**4
0899RM     MOVE PV-NEW-TOTAL2         TO DL-PURCH-ADJ-RTL-TY.              CL**4
0899RM                                                                          
0899RM                                                                          
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               MT-NET-MKUP-TY * 100                                        CL**4
             / MT-RETAIL-PURCH-TY                                          CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1         TO DL-NET-MKUP-PCT-TY.               CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
             ( MT-CUM-TO-DATE-PURCH-RETAIL-TY                                   
             - MT-CUM-TO-DATE-PURCH-COST-TY ) * 100.00                          
             / MT-CUM-TO-DATE-PURCH-RETAIL-TY                           MLKRP803
               ON SIZE ERROR                                            MLKRP803
                   MOVE 100 TO PV-NEW-TOTAL1.                           MLKRP803
           MOVE PV-NEW-TOTAL1         TO DL-CUMM-MARKUP-PCT-TY.            CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               MT-TOTAL-SALES-TY / 1000.00.                                CL**4
           MOVE PV-NEW-TOTAL2         TO DL-TOTAL-SALES-TY.                CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               MT-TOTAL-MKDN-TY / 1000.00.                                 CL**4
           MOVE PV-NEW-TOTAL2         TO DL-TOTAL-MKDN-TY.                 CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               MT-TOTAL-MKDN-TY * 100 / MT-TOTAL-SALES-TY                  CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1         TO DL-MKDN-PCT-SALES-TY.             CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL1 ROUNDED =                                 CL**4
               MT-GROSS-MRGIN-TY * 100 / MT-TOTAL-SALES-TY                 CL**4
               ON SIZE ERROR                                               CL**4
                   INITIALIZE PV-NEW-TOTAL1.                               CL**4
           MOVE PV-NEW-TOTAL1         TO DL-GROSS-MRGIN-PCT-TY.            CL**4
                                                                           CL**4
           COMPUTE PV-NEW-TOTAL2 ROUNDED =                                 CL**4
               MT-END-INV-RTL-TY / 1000.00.                                CL**4
           MOVE PV-NEW-TOTAL2         TO DL-INVEN-RTL-DLR-TY.              CL**4
                                                                           CL**4
                                                                           CL**4
0999RM*-- DO NOT PRINT 1998 DATA (LAST YEAR)                                    
0999RM     IF PV-HDG-START-CCYY-LY = PC-1998                                    
0999RM         CONTINUE                                                         
0999RM     ELSE                                                                 
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   MT-NET-COST-LY / 1000.00                                CL**4
               MOVE PV-NEW-TOTAL2     TO DL-NET-COST-LY                    CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                            MT-RETAIL-PURCH-LY / 1000.00                   CL**4
               MOVE PV-NEW-TOTAL2     TO DL-RETAIL-PURCH-LY                CL**4
               COMPUTE PV-NEW-TOTAL2 ROUNDED =                             CL**4
                   MT-TOTAL-SALES-LY / 1000.00                             CL**4
               MOVE PV-NEW-TOTAL2     TO DL-TOTAL-SALES-LY                 CL**4
0100RM*--     DO NOT PRINT 1999 DATA (LAST YEAR)                                
0100RM         IF PV-HDG-START-CCYY-LY = PC-1999                                
0100RM             CONTINUE                                                     
0100RM         ELSE                                                             
                   COMPUTE PV-NEW-TOTAL1 ROUNDED =                         CL**4
                       MT-NET-MKUP-LY * 100                                CL**4
                     / MT-RETAIL-PURCH-LY                                  CL**4
                       ON SIZE ERROR                                       CL**4
                           INITIALIZE PV-NEW-TOTAL1                        CL**4
                   END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL1 TO DL-NET-MKUP-PCT-LY                CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       MT-TOTAL-MKDN-LY / 1000.00                          CL**4
                   MOVE PV-NEW-TOTAL2 TO DL-TOTAL-MKDN-LY                  CL**4
                   COMPUTE PV-NEW-TOTAL1 ROUNDED =                         CL**4
                       MT-GROSS-MRGIN-LY * 100 / MT-TOTAL-SALES-LY         CL**4
                       ON SIZE ERROR                                       CL**4
                           INITIALIZE PV-NEW-TOTAL1                        CL**4
                   END-COMPUTE                                                  
                   MOVE PV-NEW-TOTAL1 TO DL-GROSS-MRGIN-PCT-LY             CL**4
                   COMPUTE PV-NEW-TOTAL2 ROUNDED =                         CL**4
                       MT-END-INV-RTL-LY / 1000.00                         CL**4
                   MOVE PV-NEW-TOTAL2 TO DL-INVEN-RTL-DLR-LY               CL**4
0100RM         END-IF                                                           
0999RM     END-IF.                                                              
                                                                           CL**4
           PERFORM D300-CHECK-DETAIL-GT-ZERO.                                   
           IF PS-PRINT-DETAIL                                                   
               PERFORM Z300-PRINT-DETAIL                                   CL**4
               ADD 2 TO PV-LINE-COUNTER                                    CL**4
0999RM*        IF PV-LINE-COUNTER >= PC-LINE-MAX                           CL**4
0999RM*            PERFORM 6000-PRINT-HEADERS                              CL**4
0999RM*        END-IF                                                      CL**4
           END-IF.                                                         CL**4
                                                                           CL**4
       F100-SELECT-TMLCNTL.                                                     
      ******************************************************************        
      *   F100-SELECT-TMLCNTL.                                         *        
      *      OBTAIN THE OPEN FISCAL MONTH DATE IN ORDER TO ACCESS      *        
      *      TDTATTR TABLE FIELDS.                                     *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
W02191****     SELECT OPN_FSCL_MN_DTE                                           
  |   ****         ,  OPN_FSCL_WK_DTE                                           
  |            SELECT PSTG_FSCL_MN_DTE                                          
W02191             ,  PSTG_FSCL_WK_DTE                                          
               INTO  :PV-OPN-FSCL-MN-DTE                                        
                   , :MLCNTL-OPN-FSCL-WK-DTE                                    
               FROM TMLCNTL                                                     
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = ZERO                                              
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   MOVE 'F100-SELECT-TMLCNTL'                                   
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TMLCNTL ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
       EJECT                                                                    
                                                                                
       F200-SELECT-CURR-YR-TDTATTR.                                             
      ******************************************************************        
      *   F200-SELECT-CURR-YR-TDTATTR.                                 *        
      *      OBTAIN THE OPEN FISCAL MONTH DATE'S FISCAL YEAR AND MONTH *        
      *      NUMBERS.                                                  *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
               SELECT FSCL_YR_NBR,                                              
                      FSCL_MN_NBR,                                              
                      FSCL_MN_NM,                                               
                      SEA_BEG_DTE,                                              
0400RM                WK_IN_MN_NBR,                                             
                      LY_THIS_DAY_KY_DTE                                        
               INTO   :DTATTR-FSCL-YR-NBR,                                      
                      :DTATTR-FSCL-MN-NBR,                                      
                      :DTATTR-FSCL-MN-NM,                                       
                      :DTATTR-SEA-BEG-DTE,                                      
0400RM                :DTATTR-WK-IN-MN-NBR,                                     
                      :DTATTR-LY-THIS-DAY-KY-DTE                                
               FROM   TDTATTR                                                   
               WHERE  KY_DTE = :PV-OPN-FSCL-MN-DTE                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   MOVE DTATTR-FSCL-YR-NBR (1:4)                                
                                       TO PV-FISCAL-TY-CCYY                     
                   MOVE DTATTR-FSCL-MN-NBR                                      
                                       TO PV-FISCAL-TY-END-MONTH                
               WHEN SQLCODE = +100                                              
                   MOVE 'F200-SELECT-CURR-YR-TDTATTR'                           
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
               WHEN OTHER                                                       
                   MOVE 'F200-SELECT-CURR-YR-TDTATTR'                           
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR TABLE ERROR'                                   
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
0101RM     IF DTATTR-LY-THIS-DAY-KY-DTE = PV-INVALID-DATE                       
0101RM         PERFORM F225-LY-THIS-DTE-53WK                                    
0101RM     END-IF.                                                              
       EJECT                                                                    
                                                                                
                                                                                
0101RM F225-LY-THIS-DTE-53WK.                                                   
0101RM******************************************************************        
0101RM*   F225-LY-THIS-DTE-53WK.                                       *        
0101RM*      OBTAIN THE DTATTR-LY-THIS-DAY-KY-DTE FOR THE LAST MONTH   *        
0101RM*      OF A YEAR THAT CONTAINS 53 WEEKS                          *        
0101RM******************************************************************        
0101RM*                                                                         
0101RM     EXEC SQL                                                             
0101RM         SELECT LY_THIS_DAY_KY_DTE                                        
0101RM         INTO   :DTATTR-LY-THIS-DAY-KY-DTE                                
0101RM         FROM   TDTATTR                                                   
0101RM         WHERE  KY_DTE = DATE(:PV-OPN-FSCL-MN-DTE) - 7 DAYS               
0101RM     END-EXEC.                                                            
0101RM                                                                          
0101RM     EVALUATE TRUE                                                        
0101RM         WHEN SQLCODE = 0                                                 
0101RM             CONTINUE                                                     
0101RM         WHEN SQLCODE = +100                                              
0101RM             MOVE 'F225-LY-THIS-DTE-53WK'                                 
0101RM                                 TO AA-PARAGRAPH-NAME                     
0101RM             MOVE 'TDTATTR ROW NOT FOUND'                                 
0101RM                                 TO AA-MESSAGE                            
0101RM             MOVE 'SELECT'       TO AA-DB2-OPERATION                      
0101RM             PERFORM Z999-SQL-ERROR                                       
0101RM         WHEN OTHER                                                       
0101RM             MOVE 'F225-LY-THIS-DTE-53WK'                                 
0101RM                                 TO AA-PARAGRAPH-NAME                     
0101RM             MOVE 'TDTATTR TABLE ERROR'                                   
0101RM                                 TO AA-MESSAGE                            
0101RM             MOVE 'SELECT'       TO AA-DB2-OPERATION                      
0101RM             PERFORM Z999-SQL-ERROR                                       
0101RM     END-EVALUATE.                                                        
                                                                                
0500RM F210-SELECT-WEEK-IN-MTH-NBR.                                             
0500RM******************************************************************        
0500RM*   F210-SELECT-WEEK-IN-MTH-NBR.                                 *        
0500RM*      OBTAIN THE OPEN FISCAL MONTH WEEK NUMBER FOR THE REPORT   *        
0500RM*      HEADING.                                                  *        
0500RM******************************************************************        
0500RM*                                                                         
0500RM     EXEC SQL                                                             
0500RM         SELECT WK_IN_MN_NBR                                              
0500RM         INTO   :PV-OPN-FSCL-WK-NBR                                       
0500RM         FROM   TDTATTR                                                   
0500RM         WHERE  KY_DTE = :MLCNTL-OPN-FSCL-WK-DTE                          
0500RM     END-EXEC.                                                            
0500RM                                                                          
0500RM     EVALUATE TRUE                                                        
0500RM         WHEN SQLCODE = 0                                                 
0500RM             CONTINUE                                                     
0500RM         WHEN SQLCODE = +100                                              
0500RM             MOVE 'F250-SELECT-WEEK-IN-MTH-NBR.'                          
0500RM                                 TO AA-PARAGRAPH-NAME                     
0500RM             MOVE 'TDTATTR ROW NOT FOUND'                                 
0500RM                                 TO AA-MESSAGE                            
0500RM             MOVE 'SELECT'       TO AA-DB2-OPERATION                      
0500RM             PERFORM Z999-SQL-ERROR                                       
0500RM         WHEN OTHER                                                       
0500RM             MOVE 'F250-SELECT-WEEK-IN-MTH-NBR.'                          
0500RM                                 TO AA-PARAGRAPH-NAME                     
0500RM             MOVE 'TDTATTR TABLE ERROR'                                   
0500RM                                 TO AA-MESSAGE                            
0500RM             MOVE 'SELECT'       TO AA-DB2-OPERATION                      
0500RM             PERFORM Z999-SQL-ERROR                                       
0500RM     END-EVALUATE.                                                        
                                                                                
       EJECT                                                                    
       F250-SELECT-TY-SEA-BEG-TDTATTR.                                          
      ******************************************************************        
      *   F250-SELECT-TY-SEA-BEG-TDTATTR.                              *        
      *      OBTAIN THIS YEAR SEASON BEGIN MONTH DATE'S FISCAL YEAR    *        
      *      AND MONTH NUMBERS.                                        *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
               SELECT FSCL_MN_NBR                                               
               INTO   :DTATTR-FSCL-MN-NBR                                       
               FROM   TDTATTR                                                   
               WHERE  KY_DTE = :DTATTR-SEA-BEG-DTE                              
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   MOVE DTATTR-FSCL-MN-NBR                                      
                                       TO PV-FISCAL-TY-BEG-MONTH                
               WHEN SQLCODE = +100                                              
                   MOVE 'F250-SELECT-TY-SEA-BEG-TDTATTR'                        
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
               WHEN OTHER                                                       
                   MOVE 'F250-SELECT-TY-SEA-BEG-TDTATTR'                        
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR TABLE ERROR'                                   
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
       EJECT                                                                    
                                                                                
       F300-SELECT-LAST-YR-TDTATTR.                                             
      ******************************************************************        
      *   F300-SELECT-LAST-YR-TDTATTR.                                 *        
      *      OBTAIN THE OPEN FISCAL MONTH DATE'S FISCAL YEAR AND MONTH *        
      *      NUMBERS.                                                  *        
      ******************************************************************        
      *                                                                         
           EXEC SQL                                                             
               SELECT FSCL_YR_NBR,                                              
                      FSCL_MN_NBR                                               
               INTO   :DTATTR-FSCL-YR-NBR,                                      
                      :DTATTR-FSCL-MN-NBR                                       
               FROM   TDTATTR                                                   
               WHERE  KY_DTE = :DTATTR-LY-THIS-DAY-KY-DTE                       
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = 0                                                 
                   MOVE DTATTR-FSCL-YR-NBR (1:4)                                
                                       TO PV-FISCAL-LY-CCYY                     
                   MOVE DTATTR-FSCL-MN-NBR                                      
                                       TO PV-FISCAL-LY-END-MONTH                
               WHEN SQLCODE = +100                                              
                   MOVE 'F300-SELECT-LAST-YR-TDTATTR'                           
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR ROW NOT FOUND'                                 
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
               WHEN OTHER                                                       
                   MOVE 'F300-SELECT-LAST-YR-TDTATTR'                           
                                       TO AA-PARAGRAPH-NAME                     
                   MOVE 'TDTATTR TABLE ERROR'                                   
                                       TO AA-MESSAGE                            
                   MOVE 'SELECT'       TO AA-DB2-OPERATION                      
                   PERFORM Z999-SQL-ERROR                                       
           END-EVALUATE.                                                        
                                                                                
       4000-READ-REPORT-DATA.                                              CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    READ THE MARKET REPORT DATA FILE.                               CL**4
      *                                                                    CL**4
      *    PERFORMED BY 0000-MLKRP803.                                     CL**4
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                            CL**4
      *    PERFORMED BY 2000-PROCESS.                                      CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           READ VA-REPORT-EXTRACT-FILE INTO ML202-VENDOR-EXTRACT           CL**4
               AT END                                                      CL**4
                   SET PS-INPUT-EOF TO TRUE                                CL**4
               NOT AT END                                                  CL**4
                   ADD 1 TO PV-IN-COUNTER.                                 CL**4
                                                                           CL**4
       6000-PRINT-HEADERS.                                                 CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT THE PAGE HEADERS.                                         CL**4
      *                                                                    CL**4
      *    PERFORMED BY 1000-INITIALIZE-HEADER.                            CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           ADD  1               TO PV-PAGE-COUNTER.                        CL**4
                                                                           CL**4
           MOVE PV-PAGE-COUNTER TO DP200O-PAGE-NUMBER.                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM DP200O-STANDRD-HEADER-200-COLS                         CL**4
               AFTER ADVANCING PAGE.                                       CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM SH-SUB-HEADING1                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM SH-SUB-HEADING2                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM SH-SUB-HEADING3                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM SH-SUB-HEADING4                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM DH-DETAIL-HEADING1                                     CL**4
               AFTER ADVANCING 2 LINES.                                    CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM DH-DETAIL-HEADING2                                     CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM DH-DETAIL-HEADING3                                     CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM SL-SPECIAL-LINE                                        CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           MOVE 10 TO PV-LINE-COUNTER.                                     CL**4
                                                                           CL**4
           EJECT                                                           CL**4
                                                                           CL**4
       Z300-PRINT-DETAIL.                                                  CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT DETAIL LINE.                                              CL**4
      *                                                                    CL**4
      *    PERFORMED BY 2200-NEW-ENT-ID.                                   CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM DL-DETAIL-LINE                                         CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM DL-ALL-DASHES-LINE                                     CL**4
               AFTER ADVANCING 1 LINE.                                     CL**4
                                                                           CL**4
           EJECT                                                           CL**4
                                                                           CL**4
       Z450-PRINT-GRAND-TOTALS.                                            CL**4
                                                                           CL**4
      ****************************************************************     CL**4
      *    PRINT THE GRAND TOTAL LINES.                                    CL**4
      *                                                                    CL**4
      *    PERFORMED BY B400-GRAND-TOTALS.                                 CL**4
      ****************************************************************     CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM GTL-GRAND-TOTAL-LINE-1                                 CL**4
               AFTER ADVANCING 2 LINES.                                    CL**4
                                                                           CL**4
           WRITE MR-MANAGERS-REPORT-RECORD                                 CL**4
               FROM GTL-GRAND-TOTAL-LINE-2                                 CL**4
               AFTER ADVANCING 1 LINES.                                    CL**4
                                                                           CL**4
       Z999-SQL-ERROR.                                                          
      ******************************************************************MLKRP803
      *   Z999-SQL-ERROR.                                              *MLKRP803
      *      SQL ERROR ABEND ROUTINE.                                  *MLKRP803
      ******************************************************************        
                                                                                
           DISPLAY AA-ABEND-LIT.                                                
           DISPLAY AA-DB2-ERROR-LIT.                                            
           DISPLAY AA-PROGRAM-LIT.                                              
           DISPLAY AA-PARAGRAPH-LIT.                                            
           DISPLAY AA-MESSAGE-LINE.                                             
           DISPLAY AA-DB2-OPERATION-LIT.                                        
           SET AC-DB2-ERROR TO TRUE.                                            
           MOVE +4013                  TO ABEND-CODE.                           
                                                                                
           COPY DPPD004.                                                        
           CALL 'ILBOABN0' USING ABEND-CODE.                                    
