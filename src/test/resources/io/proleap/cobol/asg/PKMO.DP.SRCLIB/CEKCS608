000100*-----------------------*                                         00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300*-----------------------*                                         00030002
000400 PROGRAM-ID.    CEKCS608.                                         00040002
000500 AUTHOR.        DENISE HAHN.                                      00050002
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060002
000700 DATE-WRITTEN.  12-29-1999.                                       00070002
000800 DATE-COMPILED.                                                   00080002
000900                                                                  00090002
001000*---------------------------------------------------------------* 00100002
001100*    S608 - CENTRAL STOCK INTERFACE - ITEM STATUS LIST SCREEN   * 00110002
001200*                                                               * 00120002
001300*---------------------------------------------------------------* 00130002
001310*                                                               * 00131041
001320* CHANGE HISTORY:                                               * 00132042
001330* WR/PROJ DATE       PGMR        DESCRIPTION OF CHANGES         * 00133042
001340* ------- ---------- ----------- -------------------------------- 00134042
001350* WR38216 04-26-2010 C. TWIEHAUS  EFC1-2 TRANSFERS              * 00135042
001350* CHG0243966 05/26/2020 J KURK    PARA 4230 - ADD CEKUP024,     * 00135152
001350*                                 REMOVE WMKUP015, WMKUP027     * 00135252
001360*---------------------------------------------------------------* 00136042
263455* CHANGED 10/29/2021    BY JIM HUNTER      WR: CHG0263455         00137054
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00138054
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00139054
263455*----------------------------------------------------------------*00139154
CICS  * CHANGED 10/20/2022    BY JIM HUNTER      WR: CHG0276924         00139256
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00139355
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00139455
CICS  *-----------------------------------------------------------------00139555
001400 EJECT                                                            00140002
001500 ENVIRONMENT DIVISION.                                            00150002
001600                                                                  00160002
001700 DATA DIVISION.                                                   00170002
001800                                                                  00180002
001900 WORKING-STORAGE SECTION.                                         00190002
002000                                                                  00200002
002100 01  DK-DB2-KEYS.                                                 00210002
002200     15  DK-PULL-NUMBER                 PIC S9(09)  VALUE ZERO    00220002
002300                                                    COMP.         00230002
002400     15  DK-REF-NUMBER                  PIC  X(15)  VALUE SPACES. 00240002
002500     15  DK-LINE-NUMBER                 PIC S9(04)  VALUE ZERO    00250002
002600                                                    COMP.         00260002
002700     15  DK-STORE-NUMBER                PIC S9(04)  VALUE ZERO    00270002
002800                                                    COMP.         00280002
002900     15  DK-LINE-STATUS                 PIC  X(02)  VALUE SPACES. 00290002
003000     05  DK-KEY-UID                     PIC  X(08).               00300008
003100                                                                  00310002
003200                                                                  00320002
003300 01  PC-PROGRAM-CONSTANTS.                                        00330002
003400     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'CE608A  '.  00340002
003500     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'CEKM608'.   00350004
003600     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'CEKCS608'.  00360002
003700     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00370002
003800     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00380002
003900     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00390002
004000     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00400002
004100     05  PC-FROM-PULL-LST-FORMAT   PIC  X(01)  VALUE '2'.         00410025
004200     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +12          00420004
004300                                               COMP SYNC.         00430002
004400     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00440002
004500                                               COMP SYNC.         00450002
004600     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00460002
004700                                               COMP-3.            00470002
004800     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00480002
004900                                               COMP SYNC.         00490002
005000     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00500002
005100                                               COMP-3.            00510002
005200     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00520002
005300     05  PC-UPD                    PIC  X(03)  VALUE 'UPD'.       00530002
005400     05  PC-DEL                    PIC  X(03)  VALUE 'DEL'.       00540002
005500     05  PC-ERR                    PIC  X(03)  VALUE 'ERR'.       00550002
005600     05  PC-NEW                    PIC  X(02)  VALUE 'NW'.        00560002
005700     05  PC-SLASH                  PIC  X(01)  VALUE '/'.         00570002
005800     05  PC-ZERO                   PIC S9(04)  VALUE ZEROES       00580002
005900                                               COMP.              00590002
006000     05  PC-CA                     PIC  X(02)  VALUE 'CA'.        00600002
006100     05  PC-DS                     PIC  X(02)  VALUE 'DS'.        00610002
006200     05  PC-IP                     PIC  X(02)  VALUE 'IP'.        00620002
006300     05  PC-NW                     PIC  X(02)  VALUE 'NW'.        00630002
006400     05  PC-PD                     PIC  X(02)  VALUE 'PD'.        00640002
006500     05  PC-AD                     PIC  X(02)  VALUE 'AD'.        00650002
006600     05  PC-IN                     PIC  X(02)  VALUE 'IN'.        00660002
006700     05  PC-MA                     PIC  X(02)  VALUE 'MA'.        00670002
006800     05  PC-01                     PIC  X(02)  VALUE '01'.        00680002
006900*                                                                 00690002
007000*----------------------------------------------------------------*00700002
007100*  DESCRIPTION CONSTANTS                                         *00710002
007200*----------------------------------------------------------------*00720002
007300     05  PC-ALL-DESC                PIC X(08)  VALUE 'ALL     '.  00730002
007400     05  PC-NEW-DESC                PIC X(08)  VALUE 'NEW     '.  00740002
007500     05  PC-PULL-STATUS-CANCELLED   PIC X(08)  VALUE 'CANCELED'.  00750002
007600     05  PC-IN-PROCESS-DESC         PIC X(08)  VALUE 'IN PROCS'.  00760002
007700     05  PC-DISTRIB-DESC            PIC X(08)  VALUE 'DISTRBTD'.  00770002
007800     05  PC-POSTED-DESC             PIC X(08)  VALUE 'POSTED  '.  00780002
007900     05  PC-UNPOSTED-DESC           PIC X(08)  VALUE 'UNPOSTED'.  00790024
008000     05  PC-UNCNCL-DESC             PIC X(08)  VALUE 'UNCNCLED'.  00800007
008100     05  PC-PULLED-DESC             PIC X(08)  VALUE 'PULLED  '.  00810007
008200     05  PC-UNPULL-DESC             PIC X(08)  VALUE 'UNPULLED'.  00820007
008300     05  PC-PRINTED-DESC            PIC X(08)  VALUE 'PRINTED '.  00830007
008400     05  PC-UNDISTR-DESC            PIC X(08)  VALUE 'UNDISTRB'.  00840007
008500     05  PC-ADAM-DESC               PIC X(08)  VALUE 'ADAM    '.  00850002
008600     05  PC-INFOREM-DESC            PIC X(08)  VALUE 'INFOREM '.  00860002
008700     05  PC-MANUAL-DESC             PIC X(08)  VALUE 'MANUAL  '.  00870002
008800     05  PC-UNKNOWN-DESC            PIC X(08)  VALUE 'UNKNOWN '.  00880002
008900     05  PC-PULL-NBR-SEQ-DESC       PIC X(10)  VALUE 'PULL # SEQ'.00890002
009000     05  PC-CRTE-DTE-SEQ-DESC       PIC X(10)  VALUE 'DATE SEQ  '.00900002
009100     05  PC-UNKNOWN-SKU-DESC        PIC X(15)                     00910002
009200                                           VALUE '** UNKNOWN **'. 00920002
009300*                                                                 00930002
009400*----------------------------------------------------------------*00940002
009500*  SYSTEM MESSAGES                                               *00950002
009600*----------------------------------------------------------------*00960002
009700*   00005 = INVALID VALUE                                        *00970002
009800*   00008 = MUST BE NUMERIC                                      *00980002
009900*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00990002
010000*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *01000002
010100*   00052 - END OF RANGE PRECEDES START OF RANGE                 *01010002
010200*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *01020002
010300*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *01030002
010400*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *01040002
010500*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *01050002
010600*   00069 - TOP OF LIST                                          *01060002
010700*   00070 - BOTTOM OF LIST                                       *01070002
010800*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *01080002
010900*   00551 - WAIT 15 SECONDS;RETRY FUNCTION AGAIN; IF UNSUCCESSFUL*01090002
011000*   00279 - MORE ITEMS TO DISPLAY                                *01100002
011100*   00984 - DATABASE IS BUSY, TRY AGAIN IN A FEW MINUTES         *01110002
011200*   02227 = APPLICATION UNAVAILABLE AT THIS TIME                 *01120002
011300*   02234 = PRINT REQUEST HAS BEEN COMPLETED FOR SELECTED LIME(S)*01130002
011400*   02238 = PRINT PROBLEM, TRY AGAIN - LINES UP TO THIS POINT    *01140002
011500*   02245 = CANNOT UPDATE ACTUAL UNITS - PULL LINE ITEM HAS BEEN *01150002
011600*   02252 = UPDATE REQUEST HAS BEEN COMPLETED FOR SELECTED LINE(S*01160002
011700*   99901 = INVALID COMMAND WAS ENTERED                          *01170002
011800*----------------------------------------------------------------*01180002
011900     05  PC-TSYMSG-NUMBERS.                                       01190002
012000         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01200002
012100         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01210002
012200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01220002
012300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01230002
012400         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  01240002
012500         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01250002
012600         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  01260002
012700         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  01270002
012800         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  01280002
012900         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01290002
013000         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01300002
013100         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01310002
013200         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01320002
013300         10  PC-TSYMSG-00551            PIC  9(05)  VALUE 00551.  01330002
013400         10  PC-TSYMSG-00746            PIC  9(05)  VALUE 00746.  01340002
013500         10  PC-TSYMSG-01563            PIC  9(05)  VALUE 01563.  01350002
013600         10  PC-TSYMSG-00984            PIC  9(05)  VALUE 00984.  01360002
013700         10  PC-TSYMSG-02227            PIC  9(05)  VALUE 02227.  01370002
013800         10  PC-TSYMSG-02234            PIC  9(05)  VALUE 02234.  01380002
013900         10  PC-TSYMSG-02238            PIC  9(05)  VALUE 02238.  01390002
014000         10  PC-TSYMSG-02245            PIC  9(05)  VALUE 02245.  01400002
014100         10  PC-TSYMSG-02252            PIC  9(05)  VALUE 02252.  01410002
014200         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  01420002
014300*                                                                 01430002
014400 01  PS-PROGRAM-SWITCHES.                                         01440002
014500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01450002
014600         88  PS-NO-ERROR                            VALUE 'Y'.    01460002
014700         88  PS-ERROR                               VALUE 'N'.    01470002
014800     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE  'N'.   01480002
014900         88  PS-SOFT-ABORT-ERROR                    VALUE  'Y'.   01490002
015000         88  PS-NO-SOFT-ABORT-ERROR                 VALUE  'N'.   01500002
015100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    01510002
015200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    01520002
015300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    01530002
015400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    01540002
015500         88  PS-DONE                                VALUE 'Y'.    01550002
015600         88  PS-NOT-DONE                            VALUE 'N'.    01560002
015700     05  PS-LIST-END-SW                 PIC  X(01)  VALUE  'N'.   01570002
015800         88  PS-LIST-END                            VALUE  'Y'.   01580002
015900         88  PS-NO-LIST-END                         VALUE  'N'.   01590002
016000*                                                                 01600002
016100 01  PV-PROGRAM-VARIABLES.                                        01610002
016200     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  01620002
016300                                        COMP SYNC.                01630002
016400     05  PV-DISPLAY-PULL-NBR            PIC  9(09)  VALUE ZEROES. 01640002
016500     05  PV-SUB                         PIC S9(04)  VALUE +0      01650002
016600                                                    COMP SYNC.    01660002
016700     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01670002
016800                                                    COMP SYNC.    01680002
016900     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01690002
017000                                                    COMP-3.       01700002
017100     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01710002
017200                                                    COMP-3.       01720002
017300     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01730002
017400                                                    COMP-3.       01740002
017500     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01750002
017600                                                    COMP-3.       01760002
017700     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01770002
017800                                                    COMP-3.       01780002
017900     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01790002
018000                                                    COMP-3.       01800002
018100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01810002
018200                                                    COMP-3.       01820002
018300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01830002
018400                                                    COMP SYNC.    01840002
018500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01850002
018600                                                    COMP SYNC.    01860002
018700     05  PV-ITEM                        PIC S9(04)  VALUE +0      01870002
018800                                                    COMP SYNC.    01880002
018900     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01890002
019000                                                    COMP SYNC.    01900002
019100     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01910002
019200                                                    COMP SYNC.    01920002
019300     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01930002
019400                                                    COMP SYNC.    01940002
019500     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01950002
019600                                                    COMP SYNC.    01960002
019700     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01970002
019800                                                    COMP SYNC.    01980002
019900     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01990002
020000                                                    COMP SYNC.    02000002
020100     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      02010002
020200                                                    COMP SYNC.    02020002
020300     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      02030002
020400                                                    COMP SYNC.    02040002
020500     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      02050002
020600                                                    COMP SYNC.    02060002
020700     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      02070002
020800                                                    COMP SYNC.    02080002
020900     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      02090002
021000                                                    COMP SYNC.    02100002
021100     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      02110002
021200                                                    COMP SYNC.    02120002
021300     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      02130002
021400                                                    COMP SYNC.    02140002
021500     05  PV-NULL-IND-1                  PIC S9(04)  VALUE +0      02150002
021600                                                    COMP.         02160002
021700     05  PV-NULL-IND-2                  PIC S9(04)  VALUE +0      02170002
021800                                                    COMP.         02180002
021900     05  PV-NULL-IND-3                  PIC S9(04)  VALUE +0      02190002
022000                                                    COMP.         02200002
022100     05  PV-NULL-IND-4                  PIC S9(04)  VALUE +0      02210028
022200                                                    COMP.         02220028
022300     05  PV-NULL-IND-5                  PIC S9(04)  VALUE +0      02230028
022400                                                    COMP.         02240028
022500     05  PV-SOFT-ABORT-MSG.                                       02250002
022600         10  FILLER            PIC X(12) VALUE ' CEKCS608 - '.    02260002
022700         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       02270002
022800         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    02280002
022900         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    02290002
023000         10  PV-SOFT-PARAGRAPH PIC X(30).                         02300002
023100     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     02310002
023200                                                     COMP SYNC.   02320002
023300     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 02330002
023400     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 02340002
023500     05  PV-CICS-MSG-HOLD.                                        02350002
023600         10  FILLER                      PIC  X(01)  VALUE SPACE. 02360002
023700         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 02370002
023800     05  PV-CICS-MSG-HOLD2.                                       02380002
023900         10  FILLER                      PIC  X(01)  VALUE SPACE. 02390002
024000         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 02400002
024100                                                                  02410002
024200     05  PV-TMST                 PIC X(26)   VALUE SPACES.        02420007
024300     05  PV-TMST-R REDEFINES  PV-TMST.                            02430007
024400         10   PV-TMST-CCYY              PIC X(04).                02440007
024500         10   FILLER                    PIC X(01).                02450002
024600         10   PV-TMST-MM                PIC X(02).                02460007
024700         10   FILLER                    PIC X(01).                02470002
024800         10   PV-TMST-DD                PIC X(02).                02480007
024900         10   FILLER                    PIC X(01).                02490007
025000         10   PV-TMST-HRS               PIC X(02).                02500007
025100         10   FILLER                    PIC X(01).                02510007
025200         10   PV-TMST-MIN               PIC X(02).                02520007
025300         10   FILLER                    PIC X(01).                02530007
025400         10   PV-TMST-SEC               PIC X(02).                02540007
025500         10   FILLER                    PIC X(07).                02550007
025600     05  PV-DATE-TIME-DISPLAY.                                    02560008
025700         10   PV-DISPLAY-MM             PIC X(02)   VALUE SPACES. 02570008
025800         10   PV-SLASH-1                PIC X(01)   VALUE SPACES. 02580008
025900         10   PV-DISPLAY-DD             PIC X(02)   VALUE SPACES. 02590008
026000         10   PV-SLASH-2                PIC X(01)   VALUE SPACES. 02600008
026100         10   PV-DISPLAY-CCYY           PIC X(04)   VALUE SPACES. 02610008
026200         10   PV-AT                     PIC X(03)   VALUE SPACES. 02620008
026300         10   PV-DISPLAY-HRS            PIC X(02)   VALUE SPACES. 02630008
026400         10   PV-SEMICOLON-1            PIC X(01)   VALUE SPACES. 02640008
026500         10   PV-DISPLAY-MIN            PIC X(02)   VALUE SPACES. 02650008
026600         10   PV-SEMICOLON-2            PIC X(01)   VALUE SPACES. 02660008
026700         10   PV-DISPLAY-SEC            PIC X(02)   VALUE SPACES. 02670008
026800     05  PV-USER-NAME                   PIC X(42)   VALUE SPACES. 02680008
026900*                                                                 02690008
027000     05  PV-PULL-SOURCE                 PIC X(02)   VALUE SPACES. 02700002
027100         88   PV-SOURCE-ADAM                        VALUE 'AD'.   02710002
027200         88   PV-SOURCE-INFOREM                     VALUE 'IN'.   02720002
027300         88   PV-SOURCE-MANUAL                      VALUE 'MA'.   02730002
027400         88   PV-SOURCE-UNKNOWN                     VALUE SPACES. 02740002
027500     05  PV-CEPLIT-ITEM-QTY              PIC S9(09) VALUE ZEROES  02750002
027600                                                    COMP.         02760002
027700     05  PV-CEPLIT-REQ-QTY               PIC S9(09) VALUE ZEROES  02770002
027800                                                    COMP.         02780002
027900     05  PV-CEPLIT-ACTL-QTY              PIC S9(09) VALUE ZEROES  02790002
028000                                                    COMP.         02800002
028100     05  PV-CEPLDS-STORE-COUNT           PIC S9(09) VALUE ZEROES  02810002
028200                                                    COMP.         02820002
028300     05  PV-CEPLDS-DISTRB-QTY            PIC S9(09) VALUE ZEROES  02830027
028400                                                    COMP.         02840027
028500     05  PV-CEPLMF-MANIF-QTY             PIC S9(09) VALUE ZEROES  02850027
028600                                                    COMP.         02860027
028700     05  PV-CEPLAU-ADJUST-QTY            PIC S9(09) VALUE ZEROES  02870027
028800                                                    COMP.         02880027
028900     05  PV-COMPUTE-DISTRB-QTY           PIC S9(09) VALUE ZEROES  02890027
029000                                                    COMP.         02900027
029100                                                                  02910002
029200     05  PV-TYPE-1                       PIC X(02)  VALUE SPACES. 02920002
029300         88   PV-TYPE-1-ADAM                        VALUE 'AD'.   02930002
029400         88   PV-TYPE-1-INFOREM                     VALUE 'IN'.   02940002
029500         88   PV-TYPE-1-MANUAL                      VALUE 'MA'.   02950002
029600     05  PV-TYPE-2                       PIC X(02)  VALUE SPACES. 02960002
029700         88   PV-TYPE-2-ADAM                        VALUE 'AD'.   02970002
029800         88   PV-TYPE-2-INFOREM                     VALUE 'IN'.   02980002
029900         88   PV-TYPE-2-MANUAL                      VALUE 'MA'.   02990002
030000     05  PV-TYPE-3                       PIC X(02)  VALUE SPACES. 03000002
030100         88   PV-TYPE-3-ADAM                        VALUE 'AD'.   03010002
030200         88   PV-TYPE-3-INFOREM                     VALUE 'IN'.   03020002
030300         88   PV-TYPE-3-MANUAL                      VALUE 'MA'.   03030002
030400                                                                  03040002
030500     05  PV-STATUS-1                     PIC X(02)  VALUE SPACES. 03050002
030600         88   PV-STATUS-1-NEW                       VALUE 'NW'.   03060002
030700         88   PV-STATUS-1-CANCELLED                 VALUE 'CA'.   03070002
030800         88   PV-STATUS-1-INPROCESS                 VALUE 'IP'.   03080002
030900         88   PV-STATUS-1-DISTRIBTD                 VALUE 'DS'.   03090002
031000         88   PV-STATUS-1-POSTED                    VALUE 'PD'.   03100002
031100         88   PV-STATUS-1-UNPOSTED                  VALUE 'UT'.   03110024
031200     05  PV-STATUS-2                     PIC X(02)  VALUE SPACES. 03120002
031300         88   PV-STATUS-2-NEW                       VALUE 'NW'.   03130002
031400         88   PV-STATUS-2-CANCELLED                 VALUE 'CA'.   03140002
031500         88   PV-STATUS-2-INPROCESS                 VALUE 'IP'.   03150002
031600         88   PV-STATUS-2-DISTRIBTD                 VALUE 'DS'.   03160002
031700         88   PV-STATUS-2-POSTED                    VALUE 'PD'.   03170002
031800         88   PV-STATUS-2-UNPOSTED                  VALUE 'UT'.   03180024
031900     05  PV-STATUS-3                     PIC X(02)  VALUE SPACES. 03190002
032000         88   PV-STATUS-3-NEW                       VALUE 'NW'.   03200002
032100         88   PV-STATUS-3-CANCELLED                 VALUE 'CA'.   03210002
032200         88   PV-STATUS-3-INPROCESS                 VALUE 'IP'.   03220002
032300         88   PV-STATUS-3-DISTRIBTD                 VALUE 'DS'.   03230002
032400         88   PV-STATUS-3-POSTED                    VALUE 'PD'.   03240002
032500         88   PV-STATUS-3-UNPOSTED                  VALUE 'UT'.   03250024
032600     05  PV-STATUS-4                     PIC X(02)  VALUE SPACES. 03260002
032700         88   PV-STATUS-4-NEW                       VALUE 'NW'.   03270002
032800         88   PV-STATUS-4-CANCELLED                 VALUE 'CA'.   03280002
032900         88   PV-STATUS-4-INPROCESS                 VALUE 'IP'.   03290002
033000         88   PV-STATUS-4-DISTRIBTD                 VALUE 'DS'.   03300002
033100         88   PV-STATUS-4-POSTED                    VALUE 'PD'.   03310002
033200         88   PV-STATUS-4-UNPOSTED                  VALUE 'UT'.   03320024
033300     05  PV-STATUS-5                     PIC X(02)  VALUE SPACES. 03330002
033400         88   PV-STATUS-5-NEW                       VALUE 'NW'.   03340002
033500         88   PV-STATUS-5-CANCELLED                 VALUE 'CA'.   03350002
033600         88   PV-STATUS-5-INPROCESS                 VALUE 'IP'.   03360002
033700         88   PV-STATUS-5-DISTRIBTD                 VALUE 'DS'.   03370002
033800         88   PV-STATUS-5-POSTED                    VALUE 'PD'.   03380002
033900         88   PV-STATUS-5-UNPOSTED                  VALUE 'UT'.   03390024
034000                                                                  03400002
034100     05  PV-PULL-NUMBER                  PIC  9(08) VALUE ZEROES. 03410002
034200     05  PV-REF-NUMBER                   PIC  X(15) VALUE SPACES. 03420002
034300     05  PV-CS-LOCATION                  PIC  9(04) VALUE ZEROES. 03430002
034400     05  PV-LINE-NUMBER                  PIC  9(04) VALUE ZEROES. 03440002
034500     05  PV-STORE-NUMBER                 PIC  9(04) VALUE ZEROES. 03450002
034600     05  PV-CEPLIT-ITM-NBR               PIC  9(15) VALUE ZEROES. 03460002
034610*----------------------------------------------------------------*03461042
034620*                                               **   WR # 230ZZ  *03462042
034630* CHANGED PV-LINE-SKU FROM PIC X(10) TO PIC 9(08).               *03463042
034640*----------------------------------------------------------------*03464042
034700*    05  PV-LINE-SKU                     PIC  X(10) VALUE SPACES. 03470034
034710     05  PV-LINE-SKU                     PIC  9(08) VALUE ZEROES. 03471042
034720*----------------------------------------------------------------*03472042
034730* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03473042
034740*----------------------------------------------------------------*03474042
034800     05  PV-LINE-SKU-RETAIL              PIC  9(05)V99            03480002
034900                                                    VALUE ZEROES. 03490002
035000     05  PV-LINE-ITEM                    PIC  9(15) VALUE ZEROES. 03500002
035100     05  PV-LINE-STATUS-CDE              PIC  X(02) VALUE SPACES. 03510002
035200     05  PV-NBR-STORES                   PIC  9(05) VALUE ZEROES. 03520002
035300     05  PV-REQ-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03530002
035400     05  PV-ACT-PULL-UNITS               PIC  9(06) VALUE ZEROES. 03540002
035500     05  PV-DISTRBUTED-UNITS             PIC  9(06) VALUE ZEROES. 03550002
035600     05  PV-UPDATE-UNITS                 PIC  9(05) VALUE ZEROES. 03560002
035700                                                                  03570002
035800     05  PV-CREATE-DATE                  PIC  X(08) VALUE SPACES. 03580002
035900     05  PV-PULL-STATUS-CDE              PIC  X(02) VALUE SPACES. 03590002
036000         88   PV-PULL-STATUS-NEW                    VALUE 'NW'.   03600002
036100         88   PV-PULL-STATUS-CANCELLED              VALUE 'CA'.   03610002
036200         88   PV-PULL-STATUS-INPROCESS              VALUE 'IP'.   03620002
036300         88   PV-PULL-STATUS-DISTRIBTD              VALUE 'DS'.   03630002
036400         88   PV-PULL-STATUS-POSTED                 VALUE 'PD'.   03640002
036500         88   PV-PULL-STATUS-UNPOSTED               VALUE 'UT'.   03650024
036600     05  PV-PULL-STATUS-CDE-2            PIC  X(02) VALUE SPACES. 03660007
036700         88   PV-PULL-STATUS-2-NEW                  VALUE 'NW'.   03670007
036800         88   PV-PULL-STATUS-2-CANCELLED            VALUE 'CA'.   03680007
036900         88   PV-PULL-STATUS-2-INPROCESS            VALUE 'IP'.   03690007
037000         88   PV-PULL-STATUS-2-DISTRIBTD            VALUE 'DS'.   03700007
037100         88   PV-PULL-STATUS-2-POSTED               VALUE 'PD'.   03710007
037200         88   PV-PULL-STATUS-2-UNPOSTED             VALUE 'UT'.   03720024
037300         88   PV-PULL-STATUS-2-UNCNCLED             VALUE 'UC'.   03730007
037400         88   PV-PULL-STATUS-2-PULLED               VALUE 'PU'.   03740007
037500         88   PV-PULL-STATUS-2-UNPULLED             VALUE 'UP'.   03750007
037600         88   PV-PULL-STATUS-2-PRINTED              VALUE 'PR'.   03760007
037700         88   PV-PULL-STATUS-2-UNDISTR              VALUE 'UD'.   03770007
037710*----------------------------------------------------------------*03771042
037720*                                               **   WR # 230ZZ  *03772042
037730* COMMENTED: PROGRAM VARIABLE PV-SKU-NUMBER                      *03773042
037731*            GROUP ITEM PV-SKU-NUMBER-HOLD.                      *03773142
037732*----------------------------------------------------------------*03773242
037800     05  PV-PULL-SOURCE-CDE              PIC  X(02) VALUE SPACES. 03780007
037900     05  PV-SELECT-LIST-SEQ              PIC  X(01) VALUE SPACES. 03790007
038000     05  PV-NBR-ITEMS                    PIC  9(05) VALUE ZEROES. 03800007
038100     05  PV-DIST-PULL-UNITS              PIC  9(06) VALUE ZEROES. 03810007
038200*    05  PV-SKU-NUMBER                   PIC  X(10) VALUE SPACES. 03820033
038300*    05  PV-SKU-NUMBER-HOLD.                                      03830033
038400*        10  PV-SKU-DEPT                 PIC  9(03) VALUE ZEROES. 03840033
038500*        10  FILLER                      PIC  X(01) VALUE '-'.    03850033
038600*        10  PV-SKU-CLASS                PIC  9(02) VALUE ZEROES. 03860033
038700*        10  FILLER                      PIC  X(01) VALUE '-'.    03870033
038800*        10  PV-SKU-SEQ                  PIC  9(03) VALUE ZEROES. 03880033
038900                                                                  03890007
039000     05  PV-SEL-TERM-ID                  PIC  X(04).              03900007
039100     05  PV-SEL-TASK-NUMBER              PIC  9(05).              03910007
039200     05  PV-SEL-SEQ                      PIC  9(01).              03920007
039210*----------------------------------------------------------------*03921042
039220* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *03922042
039230*----------------------------------------------------------------*03923042
039300******************************************************************03930007
039400**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **03940007
039500**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **03950007
039600**  APPLICATION-SPECIFIC COMMAREA.                              **03960007
039700******************************************************************03970007
039800 01  LQW-LIST-QUEUE-WORK-AREA.                                    03980007
039900     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  03990007
040000     05  LQW-ITEM-ENTRIES               OCCURS 12 TIMES           04000018
040100                                        INDEXED BY LQW-IDX.       04010007
040200         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       04020007
040300         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               04030007
040400         10  LQW-SELECTED-SW            PIC  X(01).               04040007
040500             88  LQW-SELECT                         VALUE 'S'.    04050007
040600             88  LQW-DESELECT                       VALUE ' '.    04060007
040700         10  LQW-PROCESS                PIC  X(10).               04070004
040800         10  LQW-DATE-TIME              PIC  X(21).               04080004
040900         10  LQW-USER-ID                PIC  X(42).               04090004
041000                                                                  04100002
041100                                                                  04110002
041200*---------------------------------------------------------------* 04120002
041300* SELECTON QUEUE LAYOUT                                         * 04130002
041400*---------------------------------------------------------------* 04140002
041500     COPY CEWS003.                                                04150002
041600                                                                  04160002
041700                                                                  04170002
041800*---------------------------------------------------------------* 04180002
041900*    MAP LAYOUT                                                 * 04190002
042000*---------------------------------------------------------------* 04200002
042100                                                                  04210002
042200     COPY CEKM608.                                                04220002
042300*                                                                 04230002
042400 01  MR-OCCURS-LAYOUT                   REDEFINES  CE608AO.       04240002
042500     05  FILLER                         PIC X(172).               04250022
042600     05  MR-SCROLL-AREA                 OCCURS 12 TIMES.          04260004
042700         10  MR-PROCESSL                PIC S9(04) COMP.          04270002
042800         10  MR-PROCESSA                PIC  X(01).               04280002
042900         10  MR-PROCESSC                PIC  X(01).               04290002
043000         10  MR-PROCESSH                PIC  X(01).               04300002
043100         10  MR-PROCESS                 PIC  X(10).               04310002
043200                                                                  04320002
043300         10  MR-DATE-TIMEL              PIC S9(04) COMP.          04330002
043400         10  MR-DATE-TIMEA              PIC  X(01).               04340002
043500         10  MR-DATE-TIMEC              PIC  X(01).               04350002
043600         10  MR-DATE-TIMEH              PIC  X(01).               04360002
043700         10  MR-DATE-TIME               PIC  X(21).               04370002
043800                                                                  04380002
043900         10  MR-USERL                   PIC S9(04) COMP.          04390002
044000         10  MR-USERA                   PIC  X(01).               04400002
044100         10  MR-USERC                   PIC  X(01).               04410002
044200         10  MR-USERH                   PIC  X(01).               04420002
044300         10  MR-USER                    PIC  X(42).               04430002
044301                                                                  04430148
044310*----------------------------------------------------------------*04431048
044320**  ASSOCIATE INFO SUBROUTINE PARAMETERS                          04432048
044330*----------------------------------------------------------------*04433048
044340     COPY XLWS067.                                                04434048
044400                                                                  04440002
044500*---------------------------------------------------------------* 04450002
044600*    ATTRIBUTE SETTINGS COPYBOOK.                               * 04460002
044700*---------------------------------------------------------------* 04470002
044800                                                                  04480002
044900     COPY DPWS015.                                                04490002
045000                                                                  04500002
045100*---------------------------------------------------------------* 04510002
045200*    FUNCTION KEYS COPYBOOK.                                    * 04520002
045300*---------------------------------------------------------------* 04530002
045400                                                                  04540002
045500     COPY DPWS016.                                                04550002
045600                                                                  04560002
045700*---------------------------------------------------------------* 04570002
045800*    NUMERIC EDIT LAYOUT.                                       * 04580002
045900*---------------------------------------------------------------* 04590002
046000                                                                  04600002
046100     COPY DPWS010I.                                               04610002
046200 EJECT                                                            04620002
046300*---------------------------------------------------------------* 04630002
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 04641055
046500*---------------------------------------------------------------* 04650002
046600                                                                  04660002
046700     COPY DPWS030.                                                04670002
CICS       COPY DPWS930.                                                04671055
046800 EJECT                                                            04680002
046900*---------------------------------------------------------------* 04690002
047000*    STANDARD COMMAREA.                                         * 04700002
047100*---------------------------------------------------------------* 04710002
047200                                                                  04720002
047300     COPY DPWS020.                                                04730002
047400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04740002
047500                                                                  04750002
047600*---------------------------------------------------------------* 04760002
047700* INTER-APPLICATION COMMAREA.                                   * 04770002
047800*   CEWS001 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 04780002
047900*             SPEC SCREEN.                                      * 04790002
048000*   CEWS002 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 04800002
048100*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 04810002
048200*---------------------------------------------------------------* 04820002
048300                                                                  04830002
048400         10  INTER-APPL-COMM-AREA       PIC X(200).               04840002
048500     COPY CEWS001.                                                04850002
048600     COPY CEWS002.                                                04860002
048700*---------------------------------------------------------------* 04870002
048800*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 04880002
048900*---------------------------------------------------------------* 04890002
049000         10  ASC-SPECIFIC-COMMAREA.                               04900002
049100             15  ASC-CURR-OPER-UNT-ID        PIC  X(04).          04910002
049200             15  ASC-CURR-OPER-UNT-ID-N REDEFINES                 04920002
049300                     ASC-CURR-OPER-UNT-ID    PIC  9(04).          04930002
049400             15  ASC-CURR-FCLTY-ID           PIC  X(04).          04940002
049500             15  ASC-CURR-FCLTY-ID-N REDEFINES                    04950002
049600                     ASC-CURR-FCLTY-ID       PIC  9(04).          04960002
049700             15  ASC-CS-LOC                  PIC  X(04).          04970002
049800             15  ASC-CS-LOC-R REDEFINES ASC-CS-LOC.               04980002
049900                 20  ASC-CS-LOC-N            PIC  9(04).          04990002
050000             15  ASC-CS-LOCATION-DESC        PIC  X(25).          05000002
050100             15  ASC-PULL-NBR                PIC  X(09).          05010002
050200             15  ASC-PULL-NBR-R REDEFINES ASC-PULL-NBR.           05020002
050300                 20  ASC-PULL-NBR-N          PIC  9(09).          05030002
050400             15  ASC-REF-NBR                 PIC  X(15).          05040002
050410*----------------------------------------------------------------*05041042
050420*                                               **   WR # 230ZZ  *05042042
050430* CHANGED ASC-SKU-NUMBER FROM PIC X(10) TO PIC 9(08).            *05043042
050440*----------------------------------------------------------------*05044042
050500*            15  ASC-SKU-NUMBER              PIC  X(10).          05050034
050510             15  ASC-SKU-NUMBER              PIC  9(08).          05051042
050520*----------------------------------------------------------------*05052042
050530* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *05053042
050540*----------------------------------------------------------------*05054042
050600             15  ASC-LINE-ITEM               PIC  9(15).          05060002
050700             15  ASC-LINE-SKU-RETAIL         PIC  9(05)V99.       05070002
050800             15  ASC-LINE-STATUS-CDE         PIC  X(02).          05080002
050900                 88   ASC-LINE-STATUS-NEW             VALUE 'NW'. 05090002
051000                 88   ASC-LINE-STATUS-CANCELLED       VALUE 'CA'. 05100002
051100                 88   ASC-LINE-STATUS-INPROCESS       VALUE 'IP'. 05110002
051200                 88   ASC-LINE-STATUS-DISTRIBTD       VALUE 'DS'. 05120002
051300                 88   ASC-LINE-STATUS-POSTED          VALUE 'PD'. 05130002
051400                 88   ASC-LINE-STATUS-UNPOSTED        VALUE 'UT'. 05140024
051500             15  ASC-LINE-STATUS-DESC        PIC  X(08).          05150002
051600             15  ASC-PULL-SELECT-STATUS      PIC  X(01).          05160002
051700                 88  ASC-SELECT-VALID        VALUE 'A' 'C' 'D'    05170002
051800                                                   'I' 'N' 'P'    05180002
051900                                                   ' '.           05190043
052000                 88  ASC-PULL-STATUS-ENTERED VALUE 'A' 'C' 'D'    05200002
052100                                                   'I' 'N' 'P'.   05210002
052200                 88  ASC-SELECT-ALL               VALUE 'A'.      05220002
052300                 88  ASC-SELECT-CNCLD             VALUE 'C'.      05230002
052400                 88  ASC-SELECT-DSTRB             VALUE 'D'.      05240002
052500                 88  ASC-SELECT-INPROC            VALUE 'I'.      05250002
052600                 88  ASC-SELECT-NEW               VALUE 'N'.      05260002
052700                 88  ASC-SELECT-POSTD             VALUE 'P'.      05270002
052710* 04/26/2010 CT START ADDED 'X'                                   05271044
052800             15  ASC-PULL-SELECT-TYPE        PIC  X(01).          05280002
052900                 88  ASC-SELECT-SRC-VALID    VALUE 'A' 'D' 'I'    05290002
053000                                                   'M' ' ' 'X'.   05300043
053100                 88  ASC-PULL-SOURCE-ENTERED VALUE 'A' 'D' 'I'    05310002
053200                                                   'M' 'X'.       05320043
053300                 88  ASC-SELECT-SRC-ALL           VALUE 'A'.      05330002
053400                 88  ASC-SELECT-SRC-ADAM          VALUE 'D'.      05340002
053500                 88  ASC-SELECT-SRC-INFOREM       VALUE 'I'.      05350002
053600                 88  ASC-SELECT-SRC-MANUAL        VALUE 'M'.      05360002
053610                 88  ASC-SELECT-SRC-XFER          VALUE 'X'.      05361043
053620* 04/26/2010 CT END                                               05362045
053700             15  ASC-PULL-SELECT-DATE-FROM.                       05370002
053800                 20  ASC-FROM-MM             PIC  9(02).          05380002
053900                 20  ASC-FROM-DD             PIC  9(02).          05390002
054000                 20  ASC-FROM-YY             PIC  9(04).          05400002
054100             15  ASC-PULL-SELECT-DATE-TO.                         05410002
054200                 20  ASC-TO-MM               PIC  9(02).          05420002
054300                 20  ASC-TO-DD               PIC  9(02).          05430002
054400                 20  ASC-TO-YY               PIC  9(04).          05440002
054500             15  ASC-SELECT-LIST-SEQUENCE    PIC  X(01).          05450002
054600                 88  ASC-LIST-SEQ-VALID      VALUE 'P' 'D' ' '.   05460002
054700                 88  ASC-LIST-SEQ-ENTERED    VALUE 'P' 'D'.       05470002
054800                 88  ASC-LIST-SEQ-PL-NBR          VALUE 'P'.      05480002
054900                 88  ASC-LIST-SEQ-CR-DTE          VALUE 'D'.      05490002
055000             15  ASC-PULL-STATUS             PIC  X(02).          05500002
055100                 88  ASC-PULL-CANCELLED           VALUE 'CA'.     05510002
055200                 88  ASC-PULL-DISTRIBUTED         VALUE 'DS'.     05520002
055300                 88  ASC-PULL-IN-PROCESS          VALUE 'IP'.     05530002
055400                 88  ASC-PULL-NEW                 VALUE 'NW'.     05540002
055500                 88  ASC-PULL-POSTED              VALUE 'PD'.     05550002
055600                 88  ASC-PULL-UNPOSTED            VALUE 'UT'.     05560024
055700             15  ASC-PULL-TYPE               PIC  X(02).          05570002
055800                 88  ASC-PULL-SRC-ADAM            VALUE 'AD'.     05580002
055900                 88  ASC-PULL-SRC-INFOREM         VALUE 'IN'.     05590002
056000                 88  ASC-PULL-SRC-MANUAL          VALUE 'MA'.     05600002
056100                                                                  05610002
056200             15  FILLER                      PIC  X(125).         05620002
056300*-----------------------------------------------------------------05630002
056400             15  ASC-BLK-SUB                  PIC S9(04) COMP     05640002
056500                                                         SYNC.    05650002
056600             15  ASC-ITEM-SUB                 PIC S9(04) COMP     05660002
056700                                                         SYNC.    05670002
056800             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  05680002
056900             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  05690002
057000             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  05700002
057100             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  05710002
057200             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  05720002
057300             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     05730002
057400                                                         SYNC.    05740002
057500             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  05750002
057600             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  05760002
057700             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         05770002
057800                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     05780002
057900                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     05790002
058000             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         05800002
058100                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     05810002
058200                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     05820002
058300             15  ASC-LIST-QUEUE-NAME.                             05830002
058400                 20  ASC-LIST-TERM-ID         PIC  X(04).         05840002
058500                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  05850002
058600                 20  ASC-LIST-SEQ             PIC  9(01).         05860002
058700                                                                  05870002
058800             15  ASC-START-ITEM-REQUEST.                          05880002
058900                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         05890002
059000                                                                  05900002
059100             15  ASC-SEL-SUB                  PIC S9(4) COMP.     05910002
059200             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     05920002
059300             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          05930002
059400                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 05940002
059500             15  ASC-SEL-QUEUE-NAME.                              05950002
059600                 20  ASC-SEL-TERM-ID          PIC  X(04).         05960002
059700                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  05970002
059800                 20  ASC-SEL-SEQ              PIC  9(01).         05980002
059900             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  05990002
060000                                                                  06000002
060100*-----------------------------------------------------------------06010002
060200                                                                  06020002
060300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                06030002
060400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  06040002
060500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06050002
060600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06060002
060700                                                                  06070002
060800                 20  ASC-ITEM-ARRAY.                              06080002
060900                     25  ASC-ITEM-ENTRIES OCCURS 12 TIMES.        06090018
061000                         30  ASC-LIST-ITEM-NUMBER                 06100002
061100                                                     PIC S9(09)   06110002
061200                                                     COMP-3.      06120002
061300                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  06130002
061400                             88  ASC-VALID-SELECT    VALUE ' '    06140002
061500                                                           'S'    06150002
061600                                                           'B'    06160002
061700                                                           'E'.   06170002
061800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06180002
061900                             88  ASC-TEMP-SELECT     VALUE 'S'.   06190002
062000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06200002
062100                             88  ASC-TEMP-END        VALUE 'E'.   06210002
062200                         30  ASC-SELECTED-SW         PIC  X(01).  06220002
062300                             88  ASC-NO-SELECT       VALUE ' '.   06230002
062400                             88  ASC-SELECT          VALUE 'S'.   06240002
062500                             88  ASC-BEGIN           VALUE 'B'.   06250002
062600                             88  ASC-END             VALUE 'E'.   06260002
062700                         30  ASC-PROCESS             PIC  X(10).  06270004
062800                         30  ASC-DATE-TIME           PIC  X(21).  06280004
062900                         30  ASC-USER-ID             PIC  X(42).  06290004
063000                                                                  06300002
063100                                                                  06310002
063200     EJECT                                                        06320002
063300*---------------------------------------------------------------* 06330002
063400*    ABEND PROCESSING COPYBOOK.                                 * 06340002
063500*---------------------------------------------------------------* 06350002
063600                                                                  06360002
063700     COPY DPWS013.                                                06370002
063800                                                                  06380002
063900 EJECT                                                            06390002
064000*---------------------------------------------------------------* 06400002
064100*    TCEPLRQ - CENTRAL STOCK PULL REQUESTS                      * 06410002
064200*---------------------------------------------------------------* 06420002
064300     EXEC SQL                                                     06430002
064400          INCLUDE TCEPLRQ                                         06440002
064500     END-EXEC.                                                    06450002
064600*---------------------------------------------------------------* 06460002
064700*    TCEPLIT - CENTRAL STOCK PULL ITEMS                         * 06470002
064800*---------------------------------------------------------------* 06480002
064900     EXEC SQL                                                     06490002
065000          INCLUDE TCEPLIT                                         06500002
065100     END-EXEC.                                                    06510002
065110*---------------------------------------------------------------* 06511029
065120*    TCEPLMF - CENTRAL STOCK PULL MANIFESTING                   * 06512029
065130*---------------------------------------------------------------* 06513029
065140     EXEC SQL                                                     06514029
065150          INCLUDE TCEPLMF                                         06515029
065160     END-EXEC.                                                    06516029
065170*---------------------------------------------------------------* 06517029
065180*    TCEPLAU - CENTRAL STOCK PULL ADJUSTMENT                    * 06518029
065190*---------------------------------------------------------------* 06519029
065191     EXEC SQL                                                     06519129
065192          INCLUDE TCEPLAU                                         06519229
065193     END-EXEC.                                                    06519329
065200*---------------------------------------------------------------* 06520002
065300*    TCEPLST - CENTRAL STOCK PULL STATUS                        * 06530002
065400*---------------------------------------------------------------* 06540002
065500     EXEC SQL                                                     06550002
065600          INCLUDE TCEPLST                                         06560002
065700     END-EXEC.                                                    06570002
065800*---------------------------------------------------------------* 06580008
065900*    TWORKER - WORKER TABLE                                     * 06590008
066000*---------------------------------------------------------------* 06600008
066100     EXEC SQL                                                     06610008
066200          INCLUDE TWORKER                                         06620008
066300     END-EXEC.                                                    06630008
066400*---------------------------------------------------------------* 06640002
066500*    TSK - SKU TABLE                                            * 06650002
066600*---------------------------------------------------------------* 06660002
066610*----------------------------------------------------------------*06661042
066620* COMMENTED TSK DCLGEN.                              WR # 230ZZ  *06662031
066630*----------------------------------------------------------------*06663031
066700*    EXEC SQL                                                     06670031
066800*         INCLUDE TSK                                             06680031
066900*    END-EXEC.                                                    06690031
066910*----------------------------------------------------------------*06691031
066920* CHANGES MADE FOR WR # 230ZZ ENDS HERE.                         *06692031
066930*----------------------------------------------------------------*06693031
067000*---------------------------------------------------------------* 06700028
067100*    TCEPLDS - CENTRAL STOCK PULL DISTRIBUTION                  * 06710028
067200*---------------------------------------------------------------* 06720028
067300     EXEC SQL                                                     06730028
067400          INCLUDE TCEPLDS                                         06740028
067500     END-EXEC.                                                    06750028
067600*---------------------------------------------------------------* 06760002
067700*    DB2 AREA FOR COMMUNICATIONS                                * 06770002
067800*---------------------------------------------------------------* 06780002
067900     EXEC SQL                                                     06790002
068000          INCLUDE SQLCA                                           06800002
068100     END-EXEC.                                                    06810002
068200                                                                  06820002
068300*---------------------------------------------------------------* 06830002
068400*    LINE ITEM CURSOR                                           * 06840002
068500*---------------------------------------------------------------* 06850002
068600                                                                  06860002
068700     EXEC SQL                                                     06870002
068800          DECLARE LINE-ITEM-STAT-CSR CURSOR FOR                   06880004
068900              SELECT  CNSTK_REQ_PL_NBR                            06890002
069000                     ,PL_LNE_NBR                                  06900002
069100                     ,CRE_TMST                                    06910004
069200                     ,STAT_CDE                                    06920004
069300                     ,CRE_BY_USR_ID                               06930004
069400                FROM  TCEPLST                                     06940004
069500               WHERE  CNSTK_REQ_PL_NBR = :DK-PULL-NUMBER          06950002
069600                 AND  PL_LNE_NBR       = :DK-LINE-NUMBER          06960002
069700            ORDER BY  CRE_TMST DESC                               06970010
069800     END-EXEC.                                                    06980002
069900                                                                  06990002
070000                                                                  07000002
070100                                                                  07010002
070200 LINKAGE SECTION.                                                 07020002
070300                                                                  07030002
070400 01  DFHCOMMAREA.                                                 07040002
070500     05  FILLER                         OCCURS  1 TO 4072 TIMES   07050002
070600                                        DEPENDING ON EIBCALEN.    07060002
070700         10  FILLER                     PIC X.                    07070002
070800                                                                  07080002
070900 EJECT                                                            07090002
071000 PROCEDURE DIVISION.                                              07100002
071100******************************************************************07110002
071200**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **07120002
071300**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **07130002
071400**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **07140002
071500******************************************************************07150002
071600 0000-MAIN-MODULE.                                                07160002
071700     INITIALIZE DP030-CICS-API-FIELDS.                            07170002
071800     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       07180002
071900     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          07190002
072000     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         07200002
072100     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       07210002
072200     MOVE LENGTH OF CE608AI        TO DP030-MAP-LENGTH (1).       07220002
072300     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     07230002
072400     PERFORM 0001-CALL-CICS-ARCH-API.                             07240002
072500*                                                                 07250002
072600     PERFORM 1000-CONTROL-PROCESSING                              07260002
072700*                                                                 07270002
072800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     07280002
072900     PERFORM 0001-CALL-CICS-ARCH-API.                             07290002
073000                                                                  07300002
073100******************************************************************07310002
073200**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **07320002
073300**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **07330002
073400******************************************************************07340002
073500 0001-CALL-CICS-ARCH-API.                                         07350002
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      07361055
073700                                    DFHCOMMAREA                   07370055
073800                                    DP030-CICS-API-FIELDS         07380055
073900                                    DP020-STANDARD-COMMAREA       07390055
074000                                    CE608AI.                      07400055
074100*                                                                 07410002
074200     IF  DP030-RC-CALL-SUCCESSFUL                                 07420002
074300         CONTINUE                                                 07430002
074400     ELSE                                                         07440002
074500         SET DP013-NO-ROLLBACK                                    07450002
074600             DP013-XCTL-DISPLAY-RESTART                           07460002
074700             DP013-CICS-ABEND      TO TRUE                        07470002
074800         MOVE '0001-CALL-CICS-ARCH-API'                           07480002
074900                                   TO DP013-PARAGRAPH             07490002
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O07491055
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      07492055
075200         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      07520002
075300         PERFORM DP013-0000-PROCESS-ABEND                         07530002
075400     END-IF.                                                      07540002
075500*----------------------------------------------------------------*07550002
075600* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *07560002
075700* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07570002
075800*                                                                *07580002
075900* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07590002
076000*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07600002
076100*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07610002
076200*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07620002
076300*----------------------------------------------------------------*07630002
076400                                                                  07640002
076500 1000-CONTROL-PROCESSING.                                         07650002
076600                                                                  07660002
076700     EVALUATE TRUE                                                07670002
076800         WHEN DP020-NEXT-ACT-INITIAL                              07680002
076900             INITIALIZE ASC-SPECIFIC-COMMAREA                     07690002
077000             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            07700002
077100                                      ASC-SEL-TERM-ID             07710002
077200             MOVE DP020-SRC-TASK-NUMBER                           07720002
077300                                   TO ASC-LIST-TASK-NUMBER        07730002
077400                                      ASC-SEL-TASK-NUMBER         07740002
077500             MOVE PC-LIST-QUEUE-SEQ                               07750002
077600                                   TO ASC-LIST-SEQ                07760002
077700             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 07770002
077800             PERFORM 1100-PROCESS-INTER-APPL-COMM                 07780002
077900***-----$TEMPLATE NOTE$-------------------------------------------07790002
078000*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,07800002
078100*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  07810002
078200*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.07820002
078300***---------------------------------------------------------------07830002
078400             IF  PS-COMMAREA-NOT-VALID                            07840002
078500                 SET DP020-NEXT-ACT-APPL-ERROR                    07850002
078600                                   TO TRUE                        07860002
078700             ELSE                                                 07870002
078800                 PERFORM 4000-BUILD-INITIAL-PANEL                 07880002
078900             END-IF                                               07890002
079000                                                                  07900002
079100         WHEN DP020-NEXT-ACT-READ-MAP                             07910002
079200             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        07920002
079300                                   TO PV-TOP-ITEM                 07930002
079400             PERFORM 2000-PROCESS-PANEL                           07940002
079500                                                                  07950002
079600         WHEN DP020-NEXT-ACT-RETURN                               07960002
079700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        07970002
079800                                   TO PV-TOP-ITEM                 07980002
079900             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    07990002
080000             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 08000002
080100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08010002
080200             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08020002
080300                                                                  08030002
080400         WHEN OTHER                                               08040002
080500             SET DP013-LOGIC-ABEND TO TRUE                        08050002
080600             SET DP013-NO-ROLLBACK TO TRUE                        08060002
080700             MOVE '1000-CONTROL-PROCESSING'                       08070002
080800                                   TO DP013-PARAGRAPH             08080002
080900             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    08090002
081000                                   TO DP013-MESSAGE-TEXT(1)       08100002
081100             PERFORM DP013-0000-PROCESS-ABEND                     08110002
081200     END-EVALUATE.                                                08120002
081300                                                                  08130002
081400 EJECT                                                            08140002
081500*----------------------------------------------------------------*08150002
081600* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *08160002
081700* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *08170002
081800*----------------------------------------------------------------*08180002
081900                                                                  08190002
082000 1100-PROCESS-INTER-APPL-COMM.                                    08200002
082100                                                                  08210002
082200     SET PS-COMMAREA-VALID         TO TRUE.                       08220002
082300     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     08230002
082400                                                                  08240002
082500***  IF  DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT          08250025
082600                                                                  08260025
082700     IF CE002-NUMBER-OF-SELECTED-ITEMS > 0                        08270002
082800         MOVE CE002-CURR-OPER-UNT-ID-N                            08280002
082900                                      TO ASC-CURR-OPER-UNT-ID-N   08290002
083000         MOVE CE002-CURR-FCLTY-ID-N   TO ASC-CURR-FCLTY-ID-N      08300002
083100         MOVE CE002-CS-LOCATION       TO ASC-CS-LOC-N             08310002
083200         MOVE CE002-PULL-NBR          TO ASC-PULL-NBR-N           08320002
083300         MOVE CE002-REF-NBR           TO ASC-REF-NBR              08330002
083400         MOVE CE002-PULL-SELECT-STATUS                            08340002
083500                                      TO ASC-PULL-SELECT-STATUS   08350002
083600         MOVE CE002-PULL-SELECT-TYPE  TO ASC-PULL-SELECT-TYPE     08360002
083700         MOVE CE002-SELECT-LIST-SEQUENCE                          08370002
083800                                      TO ASC-SELECT-LIST-SEQUENCE 08380002
083900         SET ASC-USE-SELECTION-QUEUE   TO TRUE                    08390002
084000         MOVE CE002-NUMBER-OF-TS-ITEMS TO ASC-NUMBER-OF-TS-ITEMS  08400002
084100         MOVE CE002-SEL-QUEUE-NAME     TO ASC-SEL-QUEUE-NAME      08410002
084200         PERFORM 1120-PREPARE-LIST-ENTRY                          08420002
084300     ELSE                                                         08430002
084400         MOVE PC-TSYMSG-00057       TO DP020-MSG-NUMBER           08440002
084500         SET  PS-COMMAREA-NOT-VALID TO TRUE                       08450002
084600     END-IF.                                                      08460002
084700                                                                  08470002
084800                                                                  08480002
084900*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08490002
085000 1120-PREPARE-LIST-ENTRY.                                         08500002
085100                                                                  08510002
085200     MOVE CE003-MAX-ITEMS          TO ASC-SEL-SUB.                08520002
085300     MOVE ZERO                     TO ASC-SEL-ITEM.               08530002
085400     PERFORM 1130-GET-NEXT-RECORD.                                08540002
085500                                                                  08550002
085600*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08560002
085700*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*08570002
085800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*08580002
085900 1130-GET-NEXT-RECORD.                                            08590002
086000                                                                  08600002
086100     ADD +1                       TO ASC-SEL-SUB.                 08610002
086200                                                                  08620002
086300     IF  ASC-SEL-SUB > CE003-MAX-ITEMS                            08630002
086400         ADD +1                   TO ASC-SEL-ITEM                 08640002
086500         MOVE +1                  TO ASC-SEL-SUB                  08650002
086600     END-IF.                                                      08660002
086700                                                                  08670002
086800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                08680002
086900         PERFORM 9100-READ-SEL-QUEUE                              08690002
087000         IF  CE003-ITEM (ASC-SEL-SUB) > ZERO                      08700002
087100             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 08710002
087200                                  TO PV-PULL-NUMBER               08720002
087300                                     ASC-PULL-NBR-N               08730002
087400             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  08740002
087500                                  TO PV-REF-NUMBER                08750002
087600             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 08760002
087700                                  TO PV-LINE-NUMBER               08770002
087800                                     ASC-LINE-ITEM                08780002
087900             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 08790002
088000                                  TO PV-CS-LOCATION               08800002
088100             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 08810002
088200                                  TO PV-CREATE-DATE               08820002
088300             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             08830002
088400                                  TO PV-PULL-STATUS-CDE           08840002
088500                                     ASC-PULL-STATUS              08850002
088600             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             08860002
088700                                  TO PV-PULL-SOURCE-CDE           08870002
088800                                     ASC-PULL-TYPE                08880002
088900             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             08890002
089000                                  TO PV-SELECT-LIST-SEQ           08900002
089100             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   08910002
089200                                  TO PV-NBR-ITEMS                 08920002
089300             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  08930002
089400                                  TO PV-NBR-STORES                08940002
089500             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              08950002
089600                                  TO PV-REQ-PULL-UNITS            08960002
089700             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              08970002
089800                                  TO PV-ACT-PULL-UNITS            08980002
089900             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             08990002
090000                                  TO PV-DIST-PULL-UNITS           09000002
090100             MOVE CE003-LINE-STATUS-CDE (ASC-SEL-SUB)             09010002
090200                                  TO PV-LINE-STATUS-CDE           09020002
090300                                     ASC-LINE-STATUS-CDE          09030002
090400             MOVE CE003-LINE-SKU (ASC-SEL-SUB)                    09040002
090500                                  TO PV-LINE-SKU                  09050002
090600                                     ASC-SKU-NUMBER               09060002
090700             MOVE CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)             09070002
090800                                  TO PV-LINE-SKU-RETAIL           09080002
090900                                     ASC-LINE-SKU-RETAIL          09090002
091000             MOVE CE003-LINE-ITEM (ASC-SEL-SUB)                   09100002
091100                                  TO PV-LINE-ITEM                 09110002
091200                                                                  09120002
091300             SET CE003-INQ (ASC-SEL-SUB)                          09130002
091400                                  TO TRUE                         09140002
091500             PERFORM 9200-REWRITE-SEL-QUEUE                       09150002
091600         ELSE                                                     09160002
091700             SUBTRACT +1 FROM ASC-SEL-SUB                         09170002
091800             MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER             09180002
091900             SET DP020-MSG-INFORMATIONAL                          09190002
092000                 PS-LIST-END             TO TRUE                  09200002
092100         END-IF                                                   09210002
092200     ELSE                                                         09220002
092300         SUBTRACT +1 FROM ASC-SEL-ITEM                            09230002
092400         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  09240002
092500         MOVE PC-TSYMSG-00070     TO DP020-MSG-NUMBER             09250002
092600         SET DP020-MSG-INFORMATIONAL                              09260002
092700             PS-LIST-END             TO TRUE                      09270002
092800     END-IF.                                                      09280002
092900                                                                  09290002
093000/                                                                 09300002
093100*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09310002
093200*    GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING      *09320002
093300*    PROCESSED.                                                  *09330002
093400*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*09340002
093500                                                                  09350002
093600 1140-GET-PREV-RECORD.                                            09360002
093700                                                                  09370002
093800     SUBTRACT +1 FROM ASC-SEL-SUB.                                09380002
093900                                                                  09390002
094000     IF  ASC-SEL-SUB < +1                                         09400002
094100         SUBTRACT +1 FROM ASC-SEL-ITEM                            09410002
094200         MOVE CE003-MAX-ITEMS     TO ASC-SEL-SUB                  09420002
094300     END-IF.                                                      09430002
094400                                                                  09440002
094500     IF  ASC-SEL-ITEM > ZERO                                      09450002
094600         PERFORM 9100-READ-SEL-QUEUE                              09460002
094700             MOVE CE003-PULL-NUMBER (ASC-SEL-SUB)                 09470006
094800                                  TO PV-PULL-NUMBER               09480006
094900                                     ASC-PULL-NBR-N               09490006
095000             MOVE CE003-REF-NUMBER (ASC-SEL-SUB)                  09500006
095100                                  TO PV-REF-NUMBER                09510006
095200             MOVE CE003-LINE-NUMBER (ASC-SEL-SUB)                 09520006
095300                                  TO PV-LINE-NUMBER               09530006
095400                                     ASC-LINE-ITEM                09540006
095500             MOVE CE003-CS-LOCATION (ASC-SEL-SUB)                 09550006
095600                                  TO PV-CS-LOCATION               09560006
095700             MOVE CE003-CREATE-DATE (ASC-SEL-SUB)                 09570006
095800                                  TO PV-CREATE-DATE               09580006
095900             MOVE CE003-PULL-STATUS-CDE (ASC-SEL-SUB)             09590006
096000                                  TO PV-PULL-STATUS-CDE           09600006
096100                                     ASC-PULL-STATUS              09610006
096200             MOVE CE003-PULL-SOURCE-CDE (ASC-SEL-SUB)             09620006
096300                                  TO PV-PULL-SOURCE-CDE           09630006
096400                                     ASC-PULL-TYPE                09640006
096500             MOVE CE003-SELECT-LIST-SEQ (ASC-SEL-SUB)             09650006
096600                                  TO PV-SELECT-LIST-SEQ           09660006
096700             MOVE CE003-NBR-ITEMS (ASC-SEL-SUB)                   09670006
096800                                  TO PV-NBR-ITEMS                 09680006
096900             MOVE CE003-NBR-STORES (ASC-SEL-SUB)                  09690006
097000                                  TO PV-NBR-STORES                09700006
097100             MOVE CE003-REQ-PULL-UNITS (ASC-SEL-SUB)              09710006
097200                                  TO PV-REQ-PULL-UNITS            09720006
097300             MOVE CE003-ACT-PULL-UNITS (ASC-SEL-SUB)              09730006
097400                                  TO PV-ACT-PULL-UNITS            09740006
097500             MOVE CE003-DIST-PULL-UNITS (ASC-SEL-SUB)             09750006
097600                                  TO PV-DIST-PULL-UNITS           09760006
097700             MOVE CE003-LINE-STATUS-CDE (ASC-SEL-SUB)             09770006
097800                                  TO PV-LINE-STATUS-CDE           09780006
097900                                     ASC-LINE-STATUS-CDE          09790006
098000             MOVE CE003-LINE-SKU (ASC-SEL-SUB)                    09800006
098100                                  TO PV-LINE-SKU                  09810006
098200                                     ASC-SKU-NUMBER               09820006
098300             MOVE CE003-LINE-SKU-RETAIL (ASC-SEL-SUB)             09830006
098400                                  TO PV-LINE-SKU-RETAIL           09840006
098500                                     ASC-LINE-SKU-RETAIL          09850006
098600             MOVE CE003-LINE-ITEM (ASC-SEL-SUB)                   09860006
098700                                  TO PV-LINE-ITEM                 09870006
098800         SET CE003-INQ (ASC-SEL-SUB)                              09880002
098900                                  TO TRUE                         09890002
099000         PERFORM 9200-REWRITE-SEL-QUEUE                           09900002
099100     ELSE                                                         09910002
099200         MOVE +1                  TO ASC-SEL-ITEM                 09920002
099300                                     ASC-SEL-SUB                  09930002
099400         MOVE PC-TSYMSG-00069     TO DP020-MSG-NUMBER             09940002
099500         SET DP020-MSG-INFORMATIONAL                              09950002
099600             PS-LIST-END             TO TRUE                      09960002
099700     END-IF.                                                      09970002
099800                                                                  09980002
099900                                                                  09990002
100000                                                                  10000002
100100                                                                  10010002
100200*----------------------------------------------------------------*10020002
100300* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *10030002
100400* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *10040002
100500* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *10050002
100600* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *10060002
100700* FUNCTION KEYS CAN GET THIS FAR.                                *10070002
100800*----------------------------------------------------------------*10080002
100900                                                                  10090002
101000 2000-PROCESS-PANEL.                                              10100002
101100     EVALUATE TRUE                                                10110002
101200         WHEN DP020-SRC-AID = DP016-CLEAR                         10120002
101300             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    10130002
101400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10140002
101500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10150002
101600                                                                  10160002
101700         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    10170002
101800             PERFORM 2050-DELETE-LIST-QUEUE                       10180002
101900             PERFORM 4000-BUILD-INITIAL-PANEL                     10190002
102000                                                                  10200002
102100         WHEN DP020-FK-DESELECT(DP020-SRC-AID)                    10210002
102200             PERFORM 2140-DESELECT-ALL-ITEMS                      10220002
102300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10230002
102400                                                                  10240002
102500         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  10250002
102600             PERFORM 2150-SELECT-ALL-ITEMS                        10260002
102700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 10270002
102800                                                                  10280002
102900         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             10290002
103000             IF  ASC-USE-SELECTION-QUEUE                          10300002
103100                 PERFORM 1130-GET-NEXT-RECORD                     10310002
103200                 IF PS-LIST-END                                   10320002
103300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10330002
103400                     SET PS-NO-LIST-END TO TRUE                   10340002
103500                 ELSE                                             10350002
103600                     PERFORM 2050-DELETE-LIST-QUEUE               10360002
103700                     PERFORM 3200-RESET-ATTRIBUTES                10370002
103800                     PERFORM 4000-BUILD-INITIAL-PANEL             10380002
103900                 END-IF                                           10390002
104000              ELSE                                                10400002
104100                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10410002
104200*                --- BOTTOM OF LIST ---                           10420002
104300                 MOVE PC-TSYMSG-00070                             10430002
104400                                   TO DP020-MSG-NUMBER            10440002
104500                 SET DP020-MSG-INFORMATIONAL                      10450002
104600                                   TO TRUE                        10460002
104700             END-IF                                               10470002
104800                                                                  10480002
104900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             10490002
105000             IF  ASC-USE-SELECTION-QUEUE                          10500002
105100                 PERFORM 1140-GET-PREV-RECORD                     10510002
105200                 IF PS-LIST-END                                   10520002
105300                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         10530002
105400                     SET PS-NO-LIST-END                           10540002
105500                                   TO TRUE                        10550002
105600                 ELSE                                             10560002
105700                     PERFORM 2050-DELETE-LIST-QUEUE               10570002
105800                     PERFORM 3200-RESET-ATTRIBUTES                10580002
105900                     PERFORM 4000-BUILD-INITIAL-PANEL             10590002
106000                 END-IF                                           10600002
106100             ELSE                                                 10610002
106200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10620002
106300                 MOVE PC-TSYMSG-00069                             10630002
106400                                   TO DP020-MSG-NUMBER            10640002
106500                 SET DP020-MSG-INFORMATIONAL                      10650002
106600                                   TO TRUE                        10660002
106700             END-IF                                               10670002
106800                                                                  10680002
106900         WHEN OTHER                                               10690002
107000             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 10700002
107100             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   10710002
107200                                                                  10720002
107300             EVALUATE TRUE                                        10730002
107400                 WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)       10740002
107500                      SET PS-ERROR                                10750002
107600                          DP020-MSG-FATAL   TO TRUE               10760002
107700                          MOVE PC-TSYMSG-02227                    10770002
107800                                            TO DP020-MSG-NUMBER   10780002
107900                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         10790002
108000                      MOVE -1               TO ASTRTITL           10800009
108100             END-EVALUATE                                         10810002
108200                                                                  10820002
108300             IF  PS-NO-ERROR                                      10830002
108400                 SET DP030-CONTINUE-GO                            10840002
108500                                 TO TRUE                          10850002
108600                 PERFORM 2100-CHECK-FUNCTION-KEY                  10860002
108700             ELSE                                                 10870002
108800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             10880002
108900                 SET DP030-OVERRIDE-GO                            10890002
109000                                 TO TRUE                          10900002
109100             END-IF                                               10910002
109200     END-EVALUATE.                                                10920002
109300 EJECT                                                            10930002
109400*----------------------------------------------------------------*10940002
109500*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *10950002
109600*----------------------------------------------------------------*10960002
109700 2050-DELETE-LIST-QUEUE.                                          10970002
109800                                                                  10980002
109900     EXEC CICS                                                    10990002
110000         DELETEQ TS                                               11000002
110100             QUEUE (ASC-LIST-QUEUE-NAME)                          11010002
110200             RESP  (PV-CICS-RESP)                                 11020002
110300     END-EXEC.                                                    11030002
110400                                                                  11040002
110500     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       11050002
110600        (PV-CICS-RESP = DFHRESP(QIDERR))                          11060002
110700         CONTINUE                                                 11070002
110800     ELSE                                                         11080002
110900         SET DP013-CICS-ABEND      TO TRUE                        11090002
111000         SET DP013-NO-ROLLBACK     TO TRUE                        11100002
111100                                                                  11110002
111200         MOVE '2050-DELETE-LIST-QUEUE'                            11120002
111300                                   TO DP013-PARAGRAPH             11130002
111400         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    11140002
111500                                   TO DP013-MESSAGE-TEXT (1)      11150002
111600         PERFORM DP013-0000-PROCESS-ABEND                         11160002
111700     END-IF.                                                      11170002
111800                                                                  11180002
111900     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  11190002
112000 EJECT                                                            11200002
112100*----------------------------------------------------------------*11210002
112200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*11220002
112300* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *11230002
112400* CICS ARCHITECTURE API.                                         *11240002
112500*----------------------------------------------------------------*11250002
112600 2100-CHECK-FUNCTION-KEY.                                         11260002
112700                                                                  11270002
112800     EVALUATE TRUE                                                11280002
112900*                                                                 11290002
113000* F6 - FIRST PAGE                                                 11300002
113100*                                                                 11310002
113200         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  11320002
113300             MOVE +1               TO PV-TOP-ITEM                 11330002
113400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11340002
113500*                                                                 11350002
113600* F7 - PREVIOUS PAGE                                              11360002
113700*                                                                 11370002
113800         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   11380002
113900             PERFORM 2110-BROWSE-BACKWARD                         11390002
114000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11400002
114100*                                                                 11410002
114200* F8 - NEXT PAGE                                                  11420002
114300*                                                                 11430002
114400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   11440002
114500             PERFORM 2120-BROWSE-FORWARD                          11450002
114600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 11460002
114700*                                                                 11470002
114800* ENTER KEY                                                       11480002
114900*                                                                 11490002
115000         WHEN DP020-SRC-AID = DP016-ENTER                         11500002
115100             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   11510002
115200             IF  PS-ERROR                                         11520002
115300                 CONTINUE                                         11530002
115400             ELSE                                                 11540002
115500                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             11550002
115600             END-IF                                               11560002
115700                                                                  11570002
115800         WHEN OTHER                                               11580002
115900             SET DP013-NO-ROLLBACK                                11590002
116000                 DP013-XCTL-DISPLAY-RESTART                       11600002
116100                 DP013-CICS-ABEND  TO TRUE                        11610002
116200             MOVE '2100-CHECK-FUNCTION-KEY'                       11620002
116300                                   TO DP013-PARAGRAPH             11630002
116400             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      11640002
116500                                   TO DP013-MESSAGE-TEXT (1)      11650002
116600             PERFORM DP013-0000-PROCESS-ABEND                     11660002
116700     END-EVALUATE.                                                11670002
116800*                                                                 11680002
116900*----------------------------------------------------------------*11690002
117000*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *11700002
117100*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *11710002
117200*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *11720002
117300*    MESSAGE.                                                    *11730002
117400*----------------------------------------------------------------*11740002
117500                                                                  11750002
117600 2110-BROWSE-BACKWARD.                                            11760002
117700     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    11770002
117800         GIVING PV-TOP-ITEM.                                      11780002
117900*                                                                 11790002
118000     IF  ((PV-TOP-ITEM < +1)                                      11800002
118100       OR (PV-TOP-ITEM = +1))                                     11810002
118200         MOVE +1                   TO PV-TOP-ITEM                 11820002
118300*        -- TOP OF LIST --                                        11830002
118400         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            11840002
118500         SET DP020-MSG-INFORMATIONAL TO TRUE                      11850002
118600     END-IF.                                                      11860002
118700                                                                  11870002
118800 EJECT                                                            11880002
118900*----------------------------------------------------------------*11890002
119000*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *11900002
119100*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11910002
119200*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11920002
119300*----------------------------------------------------------------*11930002
119400                                                                  11940002
119500 2120-BROWSE-FORWARD.                                             11950002
119600                                                                  11960002
119700     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11970002
119800         GIVING PV-TOP-ITEM.                                      11980002
119900     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11990002
120000         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12000002
120100                                   TO PV-TOP-ITEM                 12010002
120200*        -- BOTTOM OF LIST --                                     12020002
120300         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            12030002
120400         SET DP020-MSG-INFORMATIONAL                              12040002
120500                                   TO TRUE                        12050002
120600     ELSE                                                         12060002
120700         COMPUTE PV-BOTTOM-ITEM =                                 12070002
120800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 12080002
120900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            12090002
121000*            -- BOTTOM OF LIST --                                 12100002
121100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            12110002
121200             SET DP020-MSG-INFORMATIONAL                          12120002
121300                                   TO TRUE                        12130002
121400         END-IF                                                   12140002
121500     END-IF.                                                      12150002
121600 EJECT                                                            12160002
121700*----------------------------------------------------------------*12170002
121800*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *12180002
121900*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *12190002
122000*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *12200002
122100*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *12210002
122200*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *12220002
122300*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *12230002
122400*----------------------------------------------------------------*12240002
122500                                                                  12250002
122600 2130-CHECK-FOR-JUMP-BROWSE.                                      12260002
122700     SET PS-NO-ERROR               TO TRUE.                       12270002
122800     IF (ASC-START-ITEM-REQUEST = SPACE)                          12280002
122900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            12290002
123000                                   TO PV-TOP-ITEM                 12300002
123100     ELSE                                                         12310002
123200         MOVE ASC-START-ITEM-REQUEST                              12320002
123300                                   TO DP010I-UNEDITED-FIELD       12330002
123400         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       12340002
123500         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     12350002
123600         SET DP010I-NEGATIVE-NOT-ALLOWED                          12360002
123700                                   TO TRUE                        12370002
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         12381054
263455              USING DP010I-NUMERIC-EDIT-AREA                      12382054
123900                                                                  12390002
124000         IF  NOT DP010I-ERROR-DETECTED                            12400002
124100             MOVE DP010I-NUMERIC-FIELD                            12410002
124200                                   TO  ASC-START-ITEM-REQUEST-N   12420002
124300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  12430002
124400                 IF  ASC-START-ITEM-REQUEST-N >                   12440002
124500                                          ASC-NUMBER-OF-ITEMS-READ12450002
124600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         12460002
124700                     COMPUTE PV-TOP-ITEM =                        12470002
124800                             ASC-NUMBER-OF-ITEMS-READ             12480002
124900                             - PC-ITEMS-PER-PANEL + 1             12490002
125000                     IF  PV-TOP-ITEM < +1                         12500002
125100                         MOVE +1   TO PV-TOP-ITEM                 12510002
125200                         MOVE PC-TSYMSG-00070                     12520002
125300                                   TO DP020-MSG-NUMBER            12530002
125400                         SET DP020-MSG-INFORMATIONAL              12540002
125500                                   TO TRUE                        12550002
125600                     END-IF                                       12560002
125700                 ELSE                                             12570002
125800                     MOVE ASC-START-ITEM-REQUEST-N                12580002
125900                                   TO PV-TOP-ITEM                 12590002
126000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      12600002
126100                     COMPUTE PV-BOTTOM-ITEM =                     12610002
126200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     12620002
126300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ12630002
126400*                        -- BOTTOM OF LIST --                     12640002
126500                         MOVE PC-TSYMSG-00070                     12650002
126600                                   TO DP020-MSG-NUMBER            12660002
126700                         SET DP020-MSG-INFORMATIONAL              12670002
126800                                   TO TRUE                        12680002
126900                     END-IF                                       12690002
127000                 END-IF                                           12700002
127100             ELSE                                                 12710002
127200*                --- VALUE OUT OF RANGE ----                      12720002
127300                 MOVE PC-TSYMSG-00101                             12730002
127400                                   TO DP020-MSG-NUMBER            12740002
127500                 MOVE -1           TO ASTRTITL                    12750002
127600                 SET DP030-SET-CURSOR-APPL-1                      12760002
127700                                   TO TRUE                        12770002
127800                 MOVE DP015-REVERSE                               12780002
127900                                   TO ASTRTITH                    12790002
128000                 MOVE DP015-RED    TO ASTRTITC                    12800002
128100                 MOVE DP015-UNP-NUM-BRT-MDT                       12810002
128200                                   TO ASTRTITA                    12820002
128300                 SET DP020-MSG-FATAL                              12830002
128400                                   TO TRUE                        12840002
128500                 SET PS-ERROR      TO TRUE                        12850002
128600             END-IF                                               12860002
128700                                                                  12870002
128800         ELSE                                                     12880002
128900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            12890002
129000             MOVE -1               TO ASTRTITL                    12900002
129100             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12910002
129200             MOVE DP015-REVERSE    TO ASTRTITH                    12920002
129300             MOVE DP015-RED        TO ASTRTITC                    12930002
129400             MOVE DP015-UNP-NUM-BRT-MDT                           12940002
129500                                   TO ASTRTITA                    12950002
129600             SET DP020-MSG-FATAL   TO TRUE                        12960002
129700             SET PS-ERROR          TO TRUE                        12970002
129800         END-IF                                                   12980002
129900     END-IF.                                                      12990002
130000 EJECT                                                            13000002
130100*----------------------------------------------------------------*13010002
130200*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *13020002
130300*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *13030002
130400*----------------------------------------------------------------*13040002
130500 2140-DESELECT-ALL-ITEMS.                                         13050002
130600     MOVE +1                       TO ASC-BLK-SUB.                13060002
130700                                                                  13070002
130800     PERFORM 2141-CLEAR-SELECTED-INDS                             13080002
130900         VARYING ASC-ITEM-SUB                                     13090002
131000         FROM 1 BY 1                                              13100002
131100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13110002
131200                                                                  13120002
131300     ADD +1                        TO ASC-BLK-SUB.                13130002
131400                                                                  13140002
131500     PERFORM 2141-CLEAR-SELECTED-INDS                             13150002
131600         VARYING ASC-ITEM-SUB                                     13160002
131700         FROM 1 BY 1                                              13170002
131800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 13180002
131900                                                                  13190002
132000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               13200002
132100                                   TO PV-LIST-ITEM-NUMBER.        13210002
132200                                                                  13220002
132300     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            13230002
132400         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    13240002
132500                                                                  13250002
132600     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     13260002
132700        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      13270002
132800         MOVE +1                   TO ASC-BLK-SUB                 13280002
132900                                                                  13290002
133000         PERFORM 5100-WRITE-TEMP-STORAGE                          13300002
133100                                                                  13310002
133200         MOVE +1                   TO PV-BLOCK-NUMBER             13320002
133300                                                                  13330002
133400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         13340002
133500             PV-FIRST-BLOCK-IN-ARRAY - 1                          13350002
133600                                                                  13360002
133700         PERFORM                                                  13370002
133800             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       13380002
133900                                                                  13390002
134000             PERFORM 4410-READ-TEMP-STORAGE                       13400002
134100                                                                  13410002
134200             PERFORM 2141-CLEAR-SELECTED-INDS                     13420002
134300                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 13430002
134400                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13440002
134500                                                                  13450002
134600             PERFORM 5100-WRITE-TEMP-STORAGE                      13460002
134700                                                                  13470002
134800             ADD +1                TO PV-BLOCK-NUMBER             13480002
134900                                                                  13490002
135000         END-PERFORM                                              13500002
135100                                                                  13510002
135200         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         13520002
135300             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     13530002
135400                                                                  13540002
135500         PERFORM                                                  13550002
135600             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       13560002
135700                   ASC-HIGHEST-BLOCK-WRITTEN                      13570002
135800                                                                  13580002
135900             MOVE PV-NEXT-BLOCK-IN-ARRAY                          13590002
136000                                   TO PV-BLOCK-NUMBER             13600002
136100                                                                  13610002
136200             PERFORM 4410-READ-TEMP-STORAGE                       13620002
136300                                                                  13630002
136400             PERFORM 2141-CLEAR-SELECTED-INDS                     13640002
136500                 VARYING ASC-ITEM-SUB                             13650002
136600                 FROM 1 BY 1                                      13660002
136700                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          13670002
136800                                                                  13680002
136900             PERFORM 5100-WRITE-TEMP-STORAGE                      13690002
137000                                                                  13700002
137100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      13710002
137200                                                                  13720002
137300         END-PERFORM                                              13730002
137400                                                                  13740002
137500         MOVE PV-FIRST-BLOCK-IN-ARRAY                             13750002
137600                                   TO PV-BLOCK-NUMBER             13760002
137700                                                                  13770002
137800         PERFORM 4410-READ-TEMP-STORAGE                           13780002
137900     END-IF.                                                      13790002
138000                                                                  13800002
138100                                                                  13810002
138200     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 13820002
138300     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE.13830002
138400     MOVE +0                       TO ASC-END-OF-SELECTED-RANGE.  13840002
138500                                                                  13850002
138600     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        13860002
138700                                                                  13870002
138800 EJECT                                                            13880002
138900*----------------------------------------------------------------*13890002
139000*    MARK EACH ITEM AS BEING NOT SELECTED.                       *13900002
139100*----------------------------------------------------------------*13910002
139200                                                                  13920002
139300 2141-CLEAR-SELECTED-INDS.                                        13930002
139400                                                                  13940002
139500     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           13950002
139600             NOT EQUAL ZERO                                       13960002
139700         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13970002
139800             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          13980002
139900                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    13990002
140000                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  14000002
140100                                   TO TRUE                        14010002
140200         END-IF                                                   14020002
140300     END-IF.                                                      14030002
140400                                                                  14040002
140500 EJECT                                                            14050002
140600*----------------------------------------------------------------*14060002
140700*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTIO SWITCH  *14070002
140800*  FOR ALL ITEMS.                                                *14080002
140900*----------------------------------------------------------------*14090002
141000                                                                  14100002
141100 2150-SELECT-ALL-ITEMS.                                           14110002
141200                                                                  14120002
141300     MOVE +1                       TO ASC-BLK-SUB.                14130002
141400                                                                  14140002
141500     PERFORM 2151-SET-SELECTED-INDS                               14150002
141600         VARYING ASC-ITEM-SUB                                     14160002
141700         FROM 1 BY 1                                              14170002
141800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14180002
141900                                                                  14190002
142000     ADD +1                        TO ASC-BLK-SUB.                14200002
142100                                                                  14210002
142200     PERFORM 2151-SET-SELECTED-INDS                               14220002
142300         VARYING ASC-ITEM-SUB                                     14230002
142400         FROM 1 BY 1                                              14240002
142500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14250002
142600                                                                  14260002
142700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14270002
142800                                   TO PV-LIST-ITEM-NUMBER.        14280002
142900                                                                  14290002
143000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14300002
143100         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    14310002
143200                                                                  14320002
143300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     14330002
143400        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    14340002
143500         MOVE +1                   TO ASC-BLK-SUB                 14350002
143600                                                                  14360002
143700         PERFORM 5100-WRITE-TEMP-STORAGE                          14370002
143800                                                                  14380002
143900         MOVE +1                   TO PV-BLOCK-NUMBER             14390002
144000                                                                  14400002
144100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14410002
144200             PV-FIRST-BLOCK-IN-ARRAY - 1                          14420002
144300                                                                  14430002
144400         PERFORM                                                  14440002
144500             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       14450002
144600                                                                  14460002
144700             PERFORM 4410-READ-TEMP-STORAGE                       14470002
144800                                                                  14480002
144900             PERFORM 2151-SET-SELECTED-INDS                       14490002
145000                 VARYING ASC-ITEM-SUB                             14500002
145100                 FROM 1 BY 1                                      14510002
145200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14520002
145300                                                                  14530002
145400             PERFORM 5100-WRITE-TEMP-STORAGE                      14540002
145500                                                                  14550002
145600             ADD +1                TO PV-BLOCK-NUMBER             14560002
145700                                                                  14570002
145800         END-PERFORM                                              14580002
145900                                                                  14590002
146000         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14600002
146100             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14610002
146200                                                                  14620002
146300         PERFORM                                                  14630002
146400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14640002
146500                   ASC-HIGHEST-BLOCK-WRITTEN                      14650002
146600                                                                  14660002
146700             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14670002
146800                                   TO PV-BLOCK-NUMBER             14680002
146900                                                                  14690002
147000             PERFORM 4410-READ-TEMP-STORAGE                       14700002
147100                                                                  14710002
147200             PERFORM 2151-SET-SELECTED-INDS                       14720002
147300                 VARYING ASC-ITEM-SUB                             14730002
147400                 FROM 1 BY 1                                      14740002
147500                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14750002
147600                                                                  14760002
147700             PERFORM 5100-WRITE-TEMP-STORAGE                      14770002
147800                                                                  14780002
147900             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      14790002
148000                                                                  14800002
148100         END-PERFORM                                              14810002
148200                                                                  14820002
148300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             14830002
148400                                   TO PV-BLOCK-NUMBER             14840002
148500                                                                  14850002
148600         PERFORM 4410-READ-TEMP-STORAGE                           14860002
148700     END-IF.                                                      14870002
148800                                                                  14880002
148900                                                                  14890002
149000     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             14900002
149100                       ASC-NUMBER-OF-SELECTED-ITEMS.              14910002
149200                                                                  14920002
149300     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        14930002
149400                                                                  14940002
149500 EJECT                                                            14950002
149600*----------------------------------------------------------------*14960002
149700*    MARK EACH ITEM AS BEING SELECTED.                           *14970002
149800*----------------------------------------------------------------*14980002
149900                                                                  14990002
150000 2151-SET-SELECTED-INDS.                                          15000002
150100                                                                  15010002
150200     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           15020002
150300             NOT EQUAL ZERO                                       15030002
150400         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15040002
150500             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             15050002
150600                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        15060002
150700                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  15070002
150800                               TO  TRUE                           15080002
150900         END-IF                                                   15090002
151000     END-IF.                                                      15100002
151100******************************************************************15110002
151200** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **15120002
151300** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **15130002
151400******************************************************************15140002
151500 2200-MOVE-SCREEN-TO-COMMAREA.                                    15150002
151600                                                                  15160002
151700     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             15170002
151800     MOVE +1                       TO PV-SUB.                     15180002
151900*                                                                 15190002
152000     PERFORM 3100-SET-SUBSCRIPTS.                                 15200002
152100     IF  ASTRTITL > ZERO                                          15210002
152200         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          15220002
152300     ELSE                                                         15230002
152400         IF  ASTRTITF = DP015-ERASE-EOF                           15240002
152500             INITIALIZE ASC-START-ITEM-REQUEST                    15250002
152600         END-IF                                                   15260002
152700     END-IF.                                                      15270002
152800                                                                  15280002
152900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          15290002
153000         VARYING PV-SUB                                           15300002
153100         FROM 1 BY 1                                              15310002
153200         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      15320002
153300******************************************************************15330002
153400** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**15340002
153500******************************************************************15350002
153600 2210-MOVE-LINES-TO-COMMAREA.                                     15360002
153700     SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE                 15370003
153800     MOVE SPACE        TO ASC-TEMP-SELECTED-SW                    15380003
153900                          (ASC-BLK-SUB, ASC-ITEM-SUB)             15390003
154000                                                                  15400002
154100     ADD +1                        TO ASC-ITEM-SUB.               15410002
154200                                                                  15420003
154300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15430002
154400         ADD +1                    TO ASC-BLK-SUB                 15440002
154500         MOVE +1                   TO ASC-ITEM-SUB                15450002
154600     END-IF.                                                      15460002
154700******************************************************************15470002
154800** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **15480002
154900** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **15490002
155000******************************************************************15500002
155100 3000-EDIT-DATA-IN-COMMAREA.                                      15510002
155200     SET PS-NO-ERROR               TO TRUE.                       15520002
155300     PERFORM 3200-RESET-ATTRIBUTES.                               15530002
155400     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     15540002
155500                                                                  15550002
155600**                                                                15560002
155700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              15570002
155800* EDITTING IS DONE FROM THE BOTTOM UP.                            15580002
155900**                                                                15590002
156000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       15600002
156100         ASC-ITEMS-DISPLAYED - 1.                                 15610002
156200     PERFORM 3100-SET-SUBSCRIPTS.                                 15620002
156300     PERFORM 3300-EDIT-SELECTIONS                                 15630002
156400         VARYING PV-SUB                                           15640002
156500         FROM PV-SUB BY -1                                        15650002
156600         UNTIL PV-SUB < +1                                        15660002
156700*                                                                 15670002
156800     IF  PS-NO-ERROR                                              15680002
156900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        15690002
157000     END-IF.                                                      15700002
157100*                                                                 15710002
157200     IF  ((PS-NO-ERROR)                                           15720002
157300       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   15730002
157400       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    15740002
157500             PERFORM 3500-MARK-RANGE-AS-SELECTED                  15750002
157600     END-IF.                                                      15760002
157700                                                                  15770002
157800                                                                  15780002
157900*----------------------------------------------------------------*15790002
158000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *15800002
158100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*15810002
158200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *15820002
158300*                                                                *15830002
158400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *15840002
158500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *15850002
158600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *15860002
158700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *15870002
158800*----------------------------------------------------------------*15880002
158900                                                                  15890002
159000 3100-SET-SUBSCRIPTS.                                             15900002
159100                                                                  15910002
159200     COMPUTE ASC-ITEM-SUB =                                       15920002
159300         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        15930002
159400                                                                  15940002
159500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         15950002
159600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15960002
159700                                                                  15970002
159800         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               15980002
159900     ELSE                                                         15990002
160000         MOVE +1                     TO ASC-BLK-SUB               16000002
160100     END-IF.                                                      16010002
160200******************************************************************16020002
160300** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **16030002
160400******************************************************************16040002
160500                                                                  16050002
160600 3200-RESET-ATTRIBUTES.                                           16060002
160700     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   16070002
160800     MOVE DP015-GREEN              TO ASTRTITC.                   16080002
160900     MOVE DP015-UNDERLINE          TO ASTRTITH.                   16090002
161000                                                                  16100004
161100******************************************************************16110002
161200** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **16120002
161300** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **16130002
161400** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **16140002
161500** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **16150002
161600******************************************************************16160002
161700 3300-EDIT-SELECTIONS.                                            16170002
161800     EVALUATE TRUE                                                16180002
161900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16190002
162000             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         16200002
162100                 CONTINUE                                         16210002
162200         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         16220002
162300             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        16230002
162400                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   16240002
162500                 MOVE ASC-TEMP-SELECTED-SW                        16250002
162600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16260002
162700                                TO ASC-SELECTED-SW                16270002
162800                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16280002
162900             END-IF                                               16290002
163000         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     16300002
163100                 = SPACE                                          16310002
163200             EVALUATE TRUE                                        16320002
163300                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       16330002
163400                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS16340002
163500                     MOVE SPACE TO ASC-SELECTED-SW                16350002
163600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16360002
163700                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        16370002
163800                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    16380002
163900                     MOVE SPACE TO ASC-SELECTED-SW                16390002
164000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16400002
164100                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          16410002
164200                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      16420002
164300                     MOVE SPACE TO ASC-SELECTED-SW                16430002
164400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  16440002
164500             END-EVALUATE                                         16450002
164600         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           16460002
164700             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16470002
164800                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16480002
164900             END-IF                                               16490002
165000             PERFORM 3310-EDIT-RANGE                              16500002
165100         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             16510002
165200             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16520002
165300                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    16530002
165400             END-IF                                               16540002
165500             PERFORM 3310-EDIT-RANGE                              16550002
165600         WHEN OTHER                                               16560002
165700             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           16570002
165800             SET DP020-MSG-FATAL    TO TRUE                       16580002
165900             MOVE -1                TO ASTRTITL                   16590009
166000             SET DP030-SET-CURSOR-APPL-1                          16600002
166100                                    TO TRUE                       16610002
166200             SET PS-ERROR TO TRUE                                 16620002
166300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            16630002
166400                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     16640002
166500                 MOVE SPACE         TO ASC-SELECTED-SW            16650002
166600                                        (ASC-BLK-SUB ASC-ITEM-SUB)16660002
166700             END-IF                                               16670002
166800     END-EVALUATE.                                                16680002
166900                                                                  16690002
167000     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 16700002
167100     SUBTRACT +1 FROM ASC-ITEM-SUB.                               16710002
167200     IF  ASC-ITEM-SUB < 1                                         16720002
167300         SUBTRACT +1 FROM ASC-BLK-SUB                             16730002
167400         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                16740002
167500     END-IF.                                                      16750002
167600                                                                  16760002
167700                                                                  16770002
167800******************************************************************16780002
167900** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **16790002
168000** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **16800002
168100** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**16810002
168200** THE ENDING.                                                  **16820002
168300******************************************************************16830002
168400 3310-EDIT-RANGE.                                                 16840002
168500     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                16850002
168600         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   16860002
168700             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)16870002
168800                                   TO ASC-SELECTED-SW             16880002
168900                                        (ASC-BLK-SUB ASC-ITEM-SUB)16890002
169000             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 16900002
169100         ELSE                                                     16910002
169200             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     16920002
169300                 CONTINUE                                         16930002
169400             ELSE                                                 16940002
169500*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        16950002
169600                 MOVE PC-TSYMSG-00054                             16960002
169700                                       TO DP020-MSG-NUMBER        16970003
169800                 MOVE -1               TO ASTRTITL                16980009
169900                 SET DP020-MSG-FATAL                              16990002
170000                     DP030-SET-CURSOR-APPL-1                      17000003
170100                     PS-ERROR          TO TRUE                    17010003
170200             END-IF                                               17020002
170300         END-IF                                                   17030002
170400     ELSE                                                         17040002
170500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     17050002
170600             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 17060002
170700                                   TO ASC-SELECTED-SW             17070002
170800                                     (ASC-BLK-SUB ASC-ITEM-SUB)   17080002
170900             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   17090002
171000         ELSE                                                     17100002
171100             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       17110002
171200                 CONTINUE                                         17120002
171300             ELSE                                                 17130002
171400*                -- ONLY ONE END-OF-RANGE ALLOWED --              17140002
171500                 MOVE PC-TSYMSG-00055                             17150002
171600                                        TO DP020-MSG-NUMBER       17160003
171700                 MOVE -1                TO ASTRTITL               17170009
171800                 SET DP020-MSG-FATAL                              17180002
171900                     DP030-SET-CURSOR-APPL-1                      17190003
172000                     PS-ERROR           TO TRUE                   17200003
172100             END-IF                                               17210002
172200         END-IF                                                   17220002
172300     END-IF.                                                      17230002
172400*                                                                 17240002
172500******************************************************************17250002
172600** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **17260002
172700** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **17270002
172800******************************************************************17280002
172900 3400-CHECK-RANGE-SEQUENCE.                                       17290002
173000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       17300002
173100       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      17310002
173200       AND  ASC-START-OF-SELECTED-RANGE >                         17320002
173300                                         ASC-END-OF-SELECTED-RANGE17330002
173400*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                17340002
173500         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 17350002
173600         SET DP020-MSG-FATAL TO TRUE                              17360002
173700         SET PS-ERROR TO TRUE                                     17370002
173800         PERFORM 3410-POSITION-AT-ERROR                           17380002
173900     END-IF.                                                      17390002
174000******************************************************************17400002
174100** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **17410002
174200** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **17420002
174300** SHOULD BE POSITIONED ON A RANGE ERROR.                       **17430002
174400******************************************************************17440002
174500 3410-POSITION-AT-ERROR.                                          17450002
174600     SET DP030-SET-CURSOR-APPL-1                                  17460002
174700                                   TO TRUE.                       17470002
174800     MOVE -1                       TO ASTRTITL                    17480009
174900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 17490002
175000                    - PV-TOP-ITEM + 1.                            17500002
175100     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17510002
175200         CONTINUE                                                 17520002
175300     END-IF.                                                      17530002
175400*                                                                 17540002
175500     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   17550002
175600                    - PV-TOP-ITEM + 1.                            17560002
175700     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      17570002
175800         CONTINUE                                                 17580002
175900     END-IF.                                                      17590002
176000 EJECT                                                            17600002
176100*----------------------------------------------------------------*17610002
176200*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *17620002
176300*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *17630002
176400*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *17640002
176500*----------------------------------------------------------------*17650002
176600                                                                  17660002
176700 3500-MARK-RANGE-AS-SELECTED.                                     17670002
176800     MOVE +1                       TO  ASC-BLK-SUB.               17680002
176900     PERFORM 3510-MARK-SELECTED-INDS                              17690002
177000         VARYING ASC-ITEM-SUB                                     17700002
177100         FROM 1 BY 1                                              17710002
177200         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17720002
177300                                                                  17730002
177400     ADD +1                        TO ASC-BLK-SUB.                17740002
177500     PERFORM 3510-MARK-SELECTED-INDS                              17750002
177600         VARYING ASC-ITEM-SUB                                     17760002
177700         FROM 1 BY 1                                              17770002
177800         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 17780002
177900                                                                  17790002
178000     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               17800002
178100                                   TO  PV-LIST-ITEM-NUMBER.       17810002
178200     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            17820002
178300         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         17830002
178400               PC-ITEMS-PER-PANEL).                               17840002
178500                                                                  17850002
178600     MOVE ASC-START-OF-SELECTED-RANGE                             17860002
178700                                   TO PV-START-OF-SELECTED-RANGE. 17870002
178800     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            17880002
178900         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  17890002
179000               PC-ITEMS-PER-PANEL).                               17900002
179100                                                                  17910002
179200     MOVE ASC-END-OF-SELECTED-RANGE                               17920002
179300                                   TO  PV-END-OF-SELECTED-RANGE.  17930002
179400     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             17940002
179500         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    17950002
179600               PC-ITEMS-PER-PANEL).                               17960002
179700     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             17970002
179800         PV-FIRST-BLOCK-IN-ARRAY + 1.                             17980002
179900                                                                  17990002
180000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    18000002
180100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        18010002
180200         MOVE +1                   TO ASC-BLK-SUB                 18020002
180300         PERFORM 5100-WRITE-TEMP-STORAGE                          18030002
180400         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         18040002
180500             PV-FIRST-BLOCK-IN-ARRAY - 1                          18050002
180600                                                                  18060002
180700         PERFORM                                                  18070002
180800             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      18080002
180900                   PV-PREV-BLOCK-IN-ARRAY                         18090002
181000             MOVE PV-FIRST-BLOCK-IN-RANGE                         18100002
181100                                   TO PV-BLOCK-NUMBER             18110002
181200             PERFORM 4410-READ-TEMP-STORAGE                       18120002
181300             PERFORM 3510-MARK-SELECTED-INDS                      18130002
181400                 VARYING ASC-ITEM-SUB                             18140002
181500                 FROM 1 BY 1                                      18150002
181600                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18160002
181700             PERFORM 5100-WRITE-TEMP-STORAGE                      18170002
181800             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     18180002
181900         END-PERFORM                                              18190002
182000                                                                  18200002
182100         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         18210002
182200             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     18220002
182300         PERFORM                                                  18230002
182400             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       18240002
182500                   PV-LAST-BLOCK-IN-RANGE                         18250002
182600             MOVE PV-NEXT-BLOCK-IN-ARRAY                          18260002
182700                                   TO PV-BLOCK-NUMBER             18270002
182800             PERFORM 4410-READ-TEMP-STORAGE                       18280002
182900             PERFORM 3510-MARK-SELECTED-INDS                      18290002
183000                 VARYING ASC-ITEM-SUB                             18300002
183100                 FROM 1 BY 1                                      18310002
183200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          18320002
183300             PERFORM 5100-WRITE-TEMP-STORAGE                      18330002
183400             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      18340002
183500         END-PERFORM                                              18350002
183600                                                                  18360002
183700         MOVE PV-FIRST-BLOCK-IN-ARRAY                             18370002
183800                                   TO PV-BLOCK-NUMBER             18380002
183900         PERFORM 4410-READ-TEMP-STORAGE                           18390002
184000     END-IF.                                                      18400002
184100                                                                  18410002
184200     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 18420002
184300                                      ASC-END-OF-SELECTED-RANGE.  18430002
184400                                                                  18440002
184500 EJECT                                                            18450002
184600*----------------------------------------------------------------*18460002
184700* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *18470002
184800*----------------------------------------------------------------*18480002
184900                                                                  18490002
185000 3510-MARK-SELECTED-INDS.                                         18500002
185100                                                                  18510002
185200     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         18520002
185300                                ASC-ITEM-SUB) >                   18530002
185400         ASC-START-OF-SELECTED-RANGE)                             18540002
185500     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         18550002
185600                                ASC-ITEM-SUB) =                   18560002
185700         ASC-START-OF-SELECTED-RANGE)                             18570002
185800                                                                  18580002
185900         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     18590002
186000                                    ASC-ITEM-SUB) <               18600002
186100             ASC-END-OF-SELECTED-RANGE)                           18610002
186200         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     18620002
186300                                    ASC-ITEM-SUB) =               18630002
186400             ASC-END-OF-SELECTED-RANGE)                           18640002
186500                                                                  18650002
186600             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          18660002
186700                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   18670002
186800                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   18680002
186900                               TO TRUE                            18690002
187000                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              18700002
187100                               TO TRUE                            18710002
187200                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    18720002
187300             END-IF                                               18730002
187400         END-IF                                                   18740002
187500     END-IF.                                                      18750002
187600                                                                  18760002
187700 EJECT                                                            18770002
187800*----------------------------------------------------------------*18780002
187900*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *18790002
188000*    INITIALIZE ALL COUNTERS AND FLAGS.                          *18800002
188100*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *18810002
188200*    DISPLAY THE PANEL TO USER.                                  *18820002
188300*----------------------------------------------------------------*18830002
188400                                                                  18840002
188500 4000-BUILD-INITIAL-PANEL.                                        18850002
188600                                                                  18860002
188700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            18870002
188800                                 ASC-BLOCK-ENTRIES (2).           18880002
188900     MOVE +1                 TO ASC-BLK-SUB.                      18890002
189000     SET ASC-ITEMS-LEFT-ON-DB                                     18900002
189100                             TO TRUE.                             18910002
189200                                                                  18920002
189300     MOVE +0                 TO ASC-ITEM-SUB                      18930002
189400                                ASC-NUMBER-OF-ITEMS-READ          18940002
189500                                ASC-NUMBER-OF-SELECTED-ITEMS      18950002
189600                                ASC-HIGHEST-BLOCK-WRITTEN         18960002
189700                                ASC-START-OF-SELECTED-RANGE       18970002
189800                                ASC-END-OF-SELECTED-RANGE         18980002
189900                                ASC-ITEM-AT-TOP-OF-PANEL.         18990002
190000                                                                  19000002
190100     PERFORM 4100-PREPARE-CURSOR                                  19010002
190200                                                                  19020002
190300     PERFORM 4010-OPEN-CURSOR.                                    19030002
190400                                                                  19040002
190500     PERFORM 4300-READ-ITEMS-FROM-DB.                             19050002
190600                                                                  19060002
190700     PERFORM 4020-CLOSE-CURSOR.                                   19070002
190800                                                                  19080002
190900     MOVE +1                   TO  PV-TOP-ITEM.                   19090002
191000     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          19100002
191100         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    19110002
191200         SET DP020-MSG-FATAL   TO  TRUE                           19120002
191300         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               19130002
191400     ELSE                                                         19140002
191500         MOVE -1               TO ASTRTITL                        19150009
191600         SET DP030-SET-CURSOR-APPL-1                              19160002
191700                               TO TRUE                            19170002
191800         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     19180002
191900     END-IF.                                                      19190002
192000 EJECT                                                            19200002
192100*----------------------------------------------------------------*19210002
192200* OPEN THE TMESSAGE CURSOR.                                      *19220002
192300*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *19230002
192400*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *19240002
192500*   USER.                                                        *19250002
192600*----------------------------------------------------------------*19260002
192700                                                                  19270002
192800 4010-OPEN-CURSOR.                                                19280002
192900     PERFORM                                                      19290002
193000         WITH TEST AFTER                                          19300002
193100         VARYING PV-RETRY-COUNTER                                 19310002
193200         FROM 1 BY 1                                              19320002
193300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               19330002
193400                   OR (SQLCODE = ZERO))                           19340002
193500                                                                  19350002
193600         MOVE 'CURSOR:  LINE-ITEM-DSTR-CSR'                       19360002
193700                              TO DP013-MESSAGE-TEXT (2)           19370002
193800         EXEC SQL                                                 19380002
193900              OPEN LINE-ITEM-STAT-CSR                             19390004
194000         END-EXEC                                                 19400002
194100                                                                  19410002
194200                                                                  19420002
194300         EVALUATE TRUE                                            19430002
194400             WHEN SQLCODE = ZERO                                  19440002
194500             WHEN SQLCODE = -904                                  19450002
194600             WHEN SQLCODE = -913                                  19460002
194700                 CONTINUE                                         19470002
194800             WHEN SQLWARN0 NOT = SPACES                           19480002
194900             WHEN SQLCODE < ZERO                                  19490002
195000             WHEN SQLCODE > ZERO                                  19500002
195100                 MOVE '4010-OPEN-CURSOR'                          19510002
195200                                   TO DP013-PARAGRAPH             19520002
195300                 MOVE 'OPEN CENTRAL STOCK STATUS CURSOR - '       19530004
195400                                   TO DP013-MESSAGE-TEXT (1)      19540002
195500                 MOVE SQLCA        TO DP013-SQLCA                 19550002
195600                 MOVE 'TCEPLST '   TO DP013-DB2-TABLE-NAME (1)    19560004
195700                 SET DP013-DB2-ABEND                              19570002
195800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           19580002
195900                 PERFORM DP013-0000-PROCESS-ABEND                 19590002
196000         END-EVALUATE                                             19600002
196100     END-PERFORM                                                  19610002
196200*                                                                 19620002
196300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        19630002
196400         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             19640002
196500         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   19650002
196600                                   TO DP013-MESSAGE-TEXT (1)      19660002
196700         MOVE SQLCA                TO DP013-SQLCA                 19670002
196800         MOVE 'TCEPLST '           TO DP013-DB2-TABLE-NAME (1)    19680004
196900         SET DP013-DB2-ABEND                                      19690002
197000             DP013-XCTL-DISPLAY-RESTART                           19700002
197100                                   TO TRUE                        19710002
197200         PERFORM DP013-0000-PROCESS-ABEND                         19720002
197300     END-IF.                                                      19730002
197400                                                                  19740002
197500 EJECT                                                            19750002
197600*----------------------------------------------------------------*19760002
197700* CLOSE THE TMESSAGE CURSOR.                                     *19770002
197800*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *19780002
197900*   WILL BE CLOSED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *19790002
198000*   USER.                                                        *19800002
198100*----------------------------------------------------------------*19810002
198200                                                                  19820002
198300 4020-CLOSE-CURSOR.                                               19830002
198400                                                                  19840002
198500     EXEC SQL                                                     19850002
198600          CLOSE LINE-ITEM-STAT-CSR                                19860004
198700     END-EXEC.                                                    19870002
198800                                                                  19880002
198900*                                                                 19890002
199000     EVALUATE TRUE                                                19900002
199100         WHEN SQLCODE = ZERO                                      19910002
199200             CONTINUE                                             19920002
199300         WHEN SQLWARN0 NOT = SPACES                               19930002
199400         WHEN SQLCODE < ZERO                                      19940002
199500         WHEN SQLCODE > ZERO                                      19950002
199600             MOVE '4020-CLOSE-CURSOR'                             19960002
199700                               TO DP013-PARAGRAPH                 19970002
199800             MOVE 'CLOSE CENTRAL STOCK PULL STATUS CURSOR'        19980004
199900                               TO DP013-MESSAGE-TEXT (1)          19990002
200000             MOVE SQLCA        TO DP013-SQLCA                     20000002
200100             MOVE 'TCEPLST '   TO DP013-DB2-TABLE-NAME (1)        20010004
200200             SET DP013-DB2-ABEND                                  20020002
200300                 DP013-XCTL-DISPLAY-RESTART TO TRUE               20030002
200400             PERFORM DP013-0000-PROCESS-ABEND                     20040002
200500     END-EVALUATE.                                                20050002
200600                                                                  20060002
200700 EJECT                                                            20070002
200800*----------------------------------------------------------------*20080002
200900*    SET UP THE HOST VARIABLES.                                  *20090002
201000*----------------------------------------------------------------*20100002
201100                                                                  20110002
201200 4100-PREPARE-CURSOR.                                             20120002
201300                                                                  20130002
201400     MOVE ASC-PULL-NBR         TO DK-PULL-NUMBER.                 20140002
201500     MOVE ASC-REF-NBR          TO DK-REF-NUMBER.                  20150002
201600     MOVE ASC-LINE-ITEM        TO DK-LINE-NUMBER.                 20160002
201700                                                                  20170002
201800                                                                  20180002
201900*----------------------------------------------------------------*20190002
202000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *20200002
202100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *20210002
202200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *20220002
202300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *20230002
202400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *20240002
202500*                                                                *20250002
202600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *20260002
202700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *20270002
202800*    UPON INITIALIZATION.                                        *20280002
202900*----------------------------------------------------------------*20290002
203000 4300-READ-ITEMS-FROM-DB.                                         20300002
203100                                                                  20310002
203200     PERFORM                                                      20320002
203300         VARYING PV-READ-COUNT                                    20330002
203400         FROM 1 BY 1                                              20340002
203500         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    20350002
203600            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         20360002
203700                                                                  20370002
203800         PERFORM 4310-FETCH                                       20380002
203900                                                                  20390002
204000         IF  ASC-ITEMS-LEFT-ON-DB                                 20400002
204100             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                20410002
204200                 ADD +1            TO ASC-ITEM-SUB                20420002
204300             ELSE                                                 20430002
204400                 ADD +1            TO ASC-BLK-SUB                 20440002
204500                 MOVE +1           TO ASC-ITEM-SUB                20450002
204600                                                                  20460002
204700                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         20470002
204800                     MOVE +1       TO ASC-BLK-SUB                 20480002
204900                     SET ASC-BLOCK-MODIFIED (1)                   20490002
205000                                   TO TRUE                        20500002
205100                     PERFORM 5100-WRITE-TEMP-STORAGE              20510002
205200                     MOVE ASC-BLOCK-ENTRIES                       20520002
205300                               (PC-MAX-BLOCKS-IN-ARRAY)           20530002
205400                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 20540002
205500                     ADD +1        TO ASC-BLK-SUB                 20550002
205600                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   20560002
205700                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      20570002
205800                                   TO TRUE                        20580002
205900                 END-IF                                           20590002
206000             END-IF                                               20600002
206100             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    20610002
206200             SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          20620002
206300             MOVE ASC-NUMBER-OF-ITEMS-READ                        20630002
206400                                   TO ASC-LIST-ITEM-NUMBER        20640002
206500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  20650002
206600                                                                  20660002
206700             MOVE CEPLST-STAT-CDE  TO  PV-PULL-STATUS-CDE-2       20670007
206800                                                                  20680007
206900             EVALUATE  TRUE                                       20690007
207000                 WHEN  PV-PULL-STATUS-2-NEW                       20700007
207100                           MOVE  PC-NEW-DESC                      20710007
207200                              TO  ASC-PROCESS                     20720007
207300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20730007
207400                 WHEN  PV-PULL-STATUS-2-CANCELLED                 20740007
207500                           MOVE  PC-PULL-STATUS-CANCELLED         20750007
207600                              TO  ASC-PROCESS                     20760007
207700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20770007
207800                 WHEN  PV-PULL-STATUS-2-INPROCESS                 20780007
207900                           MOVE  PC-IN-PROCESS-DESC               20790007
208000                              TO  ASC-PROCESS                     20800007
208100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20810007
208200                 WHEN  PV-PULL-STATUS-2-DISTRIBTD                 20820007
208300                           MOVE  PC-DISTRIB-DESC                  20830007
208400                              TO  ASC-PROCESS                     20840007
208500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20850007
208600                 WHEN  PV-PULL-STATUS-2-POSTED                    20860007
208700                           MOVE  PC-POSTED-DESC                   20870007
208800                              TO  ASC-PROCESS                     20880007
208900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20890007
209000                 WHEN  PV-PULL-STATUS-2-UNPOSTED                  20900024
209100                           MOVE  PC-UNPOSTED-DESC                 20910024
209200                              TO  ASC-PROCESS                     20920024
209300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20930024
209400                 WHEN  PV-PULL-STATUS-2-UNCNCLED                  20940007
209500                           MOVE  PC-UNCNCL-DESC                   20950007
209600                              TO  ASC-PROCESS                     20960007
209700                                       (ASC-BLK-SUB ASC-ITEM-SUB) 20970007
209800                 WHEN  PV-PULL-STATUS-2-PULLED                    20980007
209900                           MOVE  PC-PULLED-DESC                   20990007
210000                              TO  ASC-PROCESS                     21000007
210100                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21010007
210200                 WHEN  PV-PULL-STATUS-2-UNPULLED                  21020007
210300                           MOVE  PC-UNPULL-DESC                   21030007
210400                              TO  ASC-PROCESS                     21040007
210500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21050007
210600                 WHEN  PV-PULL-STATUS-2-PRINTED                   21060007
210700                           MOVE  PC-PRINTED-DESC                  21070007
210800                              TO  ASC-PROCESS                     21080007
210900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21090007
211000                 WHEN  PV-PULL-STATUS-2-UNDISTR                   21100007
211100                           MOVE  PC-UNDISTR-DESC                  21110007
211200                              TO  ASC-PROCESS                     21120007
211300                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21130007
211400             END-EVALUATE                                         21140007
211500                                                                  21150007
211600                                                                  21160007
211700             MOVE PV-DATE-TIME-DISPLAY                            21170007
211800                              TO  ASC-DATE-TIME                   21180004
211900                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21190002
212000             MOVE PV-USER-NAME                                    21200008
212100                              TO  ASC-USER-ID                     21210004
212200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 21220002
212300                                                                  21230002
212400             EVALUATE  TRUE                                       21240002
212500                 WHEN  PV-PULL-STATUS-NEW                         21250002
212600                           MOVE  PC-NEW-DESC                      21260002
212700                               TO ASC-LINE-STATUS-DESC            21270002
212800                 WHEN  PV-PULL-STATUS-CANCELLED                   21280002
212900                           MOVE  PC-PULL-STATUS-CANCELLED         21290002
213000                               TO ASC-LINE-STATUS-DESC            21300002
213100                 WHEN  PV-PULL-STATUS-INPROCESS                   21310002
213200                           MOVE  PC-IN-PROCESS-DESC               21320002
213300                               TO ASC-LINE-STATUS-DESC            21330002
213400                 WHEN  PV-PULL-STATUS-DISTRIBTD                   21340002
213500                           MOVE  PC-DISTRIB-DESC                  21350002
213600                               TO ASC-LINE-STATUS-DESC            21360002
213700                 WHEN  PV-PULL-STATUS-POSTED                      21370002
213800                           MOVE  PC-POSTED-DESC                   21380002
213900                               TO ASC-LINE-STATUS-DESC            21390002
214000                 WHEN  PV-PULL-STATUS-UNPOSTED                    21400024
214100                           MOVE  PC-UNPOSTED-DESC                 21410024
214200                               TO ASC-LINE-STATUS-DESC            21420024
214300             END-EVALUATE                                         21430002
214400                                                                  21440002
214500         END-IF                                                   21450002
214600     END-PERFORM.                                                 21460002
214700                                                                  21470002
214800     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          21480002
214900         MOVE +1               TO ASC-BLK-SUB                     21490002
215000         PERFORM 5100-WRITE-TEMP-STORAGE                          21500002
215100         ADD +1                TO ASC-BLK-SUB                     21510002
215200         PERFORM 5100-WRITE-TEMP-STORAGE                          21520002
215300                                                                  21530002
215400         MOVE 1                TO ASC-BLK-SUB                     21540002
215500                                  PV-BLOCK-NUMBER                 21550002
215600         PERFORM 4410-READ-TEMP-STORAGE                           21560002
215700         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             21570002
215800             MOVE 2            TO ASC-BLK-SUB                     21580002
215900                                  PV-BLOCK-NUMBER                 21590002
216000             PERFORM 4410-READ-TEMP-STORAGE                       21600002
216100         END-IF                                                   21610002
216200     END-IF.                                                      21620002
216300                                                                  21630008
216400*----------------------------------------------------------------*21640002
216500*    FETCH THE MESSAGE CURSOR.                                   *21650002
216600*----------------------------------------------------------------*21660002
216700                                                                  21670002
216800 4310-FETCH.                                                      21680002
216900                                                                  21690002
217000     INITIALIZE PV-DATE-TIME-DISPLAY                              21700008
217100                PV-USER-NAME.                                     21710008
217200                                                                  21720007
217300     EXEC SQL                                                     21730002
217400          FETCH LINE-ITEM-STAT-CSR                                21740004
217500           INTO  :CEPLST-CNSTK-REQ-PL-NBR                         21750004
217600               , :CEPLST-PL-LNE-NBR                               21760004
217700               , :CEPLST-CRE-TMST                                 21770004
217800               , :CEPLST-STAT-CDE                                 21780004
217900               , :CEPLST-CRE-BY-USR-ID                            21790004
218000     END-EXEC.                                                    21800002
218100                                                                  21810002
218200     EVALUATE TRUE                                                21820002
218300         WHEN SQLCODE = ZERO                                      21830002
218400              MOVE  CEPLST-CRE-TMST   TO  PV-TMST                 21840008
218500              MOVE  PV-TMST-CCYY      TO  PV-DISPLAY-CCYY         21850008
218600              MOVE  PV-TMST-MM        TO  PV-DISPLAY-MM           21860008
218700              MOVE  PV-TMST-DD        TO  PV-DISPLAY-DD           21870008
218800              MOVE  PV-TMST-HRS       TO  PV-DISPLAY-HRS          21880008
218900              MOVE  PV-TMST-MIN       TO  PV-DISPLAY-MIN          21890008
219000              MOVE  PV-TMST-SEC       TO  PV-DISPLAY-SEC          21900008
219100              MOVE  '/'               TO  PV-SLASH-1              21910007
219200                                          PV-SLASH-2              21920007
219300              MOVE  ':'               TO  PV-SEMICOLON-1          21930007
219400                                          PV-SEMICOLON-2          21940008
219500              MOVE  ' @ '             TO  PV-AT                   21950008
219600              PERFORM 4320-GET-USER-NAME THRU 4320-EXIT           21960013
219700         WHEN SQLCODE = +100                                      21970002
219800              CONTINUE                                            21980002
219900         WHEN SQLWARN0 NOT = SPACE                                21990002
220000         WHEN SQLCODE NOT = ZERO                                  22000002
220100              MOVE '4310-FETCH-CURSOR'                            22010002
220200                               TO DP013-PARAGRAPH                 22020002
220300              MOVE 'FETCH CENTRAL STOCK PULL STATUS CURSOR'       22030004
220400                               TO DP013-MESSAGE-TEXT (1)          22040002
220500              MOVE SQLCA       TO DP013-SQLCA                     22050002
220600              SET DP013-DB2-ABEND                                 22060002
220700                               TO TRUE                            22070002
220800              PERFORM DP013-0000-PROCESS-ABEND                    22080002
220900     END-EVALUATE.                                                22090002
221000                                                                  22100002
221100     IF  SQLCODE EQUAL +100                                       22110002
221200         SET ASC-NO-ITEMS-LEFT-ON-DB                              22120002
221300                                   TO TRUE                        22130002
221400     END-IF.                                                      22140002
221500                                                                  22150002
221600                                                                  22160008
221700*----------------------------------------------------------------*22170008
221800*    GET USER NAME                                               *22180008
221900*----------------------------------------------------------------*22190008
222000 4320-GET-USER-NAME.                                              22200008
222100     MOVE  CEPLST-CRE-BY-USR-ID  TO  DK-KEY-UID.                  22210008
222200                                                                  22220014
222300     IF CEPLST-CRE-BY-USR-ID = 'CEKCS611'                         22230013
222400        MOVE 'AUTO PRINT' TO PV-USER-NAME                         22240013
222500        GO TO 4320-EXIT                                           22250013
222600     ELSE                                                         22260013
222700        CONTINUE                                                  22270013
222800     END-IF.                                                      22280013
222900                                                                  22290013
223000     IF CEPLST-CRE-BY-USR-ID = 'CEKUP006'                         22300016
223100        MOVE 'AUTO POST PROCESS' TO PV-USER-NAME                  22310016
223200        GO TO 4320-EXIT                                           22320016
223300     ELSE                                                         22330016
223400        CONTINUE                                                  22340016
223500     END-IF.                                                      22350016
223600                                                                  22360023
224220     IF CEPLST-CRE-BY-USR-ID = 'WMKUP024'                         22422045
224220     OR CEPLST-CRE-BY-USR-ID = 'CEKUP024'                         22422151
224230        MOVE 'POSTED BY AGING PROCESS' TO PV-USER-NAME            22423045
224240        GO TO 4320-EXIT                                           22424045
224250     ELSE                                                         22425045
224260        CONTINUE                                                  22426045
224270     END-IF.                                                      22427045
224280                                                                  22428045
227510*----------------------------------------------------------------*22751045
227520*  CALL XLKUT067 TO RETRIEVE THE NAME FOR USERID                  22752045
227530*----------------------------------------------------------------*22753045
227550                                                                  22755045
227560     MOVE CEPLST-CRE-BY-USR-ID TO XL067-KEY-USER-ID.              22756045
227570                                                                  22757045
227580     SET XL067-BY-USER-ID                                         22758045
227590         XL067-SELECT-BOTH-USERS      TO TRUE.                    22759045
227591                                                                  22759145
227592     CALL XL067-USER-PGM USING DFHEIBLK                           22759245
227593                               XL067-COMMAREA                     22759345
227594                               XL067-USER-COMMAREA.               22759445
227595                                                                  22759545
227597     IF XL067-SUCCESSFUL                                          22759747
227598        IF XL067-USER-NOT-FOUND                                   22759850
227599           MOVE CEPLST-CRE-BY-USR-ID     TO PV-USER-NAME          22759950
227600        ELSE                                                      22760050
227601           MOVE XL067-COMBINED-NAME-2    TO PV-USER-NAME          22760150
227602        END-IF                                                    22760250
227603     ELSE                                                         22760347
227604        MOVE CEPLST-CRE-BY-USR-ID     TO PV-USER-NAME             22760447
227605     END-IF.                                                      22760547
227610                                                                  22761047
227640 4320-EXIT.  EXIT.                                                22764013
227700                                                                  22770002
227800                                                                  22780011
227900*----------------------------------------------------------------*22790002
228000* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *22800002
228100*----------------------------------------------------------------*22810002
228200                                                                  22820002
228300 4400-MOVE-COMMAREA-TO-SCREEN.                                    22830002
228400     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             22840002
228500         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          22850002
228600         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          22860002
228700             MOVE +1    TO ASC-BLK-SUB                            22870002
228800             PERFORM 5100-WRITE-TEMP-STORAGE                      22880002
228900             ADD +1     TO ASC-BLK-SUB                            22890002
229000             PERFORM 5100-WRITE-TEMP-STORAGE                      22900002
229100             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             22910002
229200                 GIVING PV-BLOCK-NUMBER                           22920002
229300                 REMAINDER PV-REMAINDER                           22930002
229400             IF  PV-REMAINDER > ZERO                              22940002
229500                 ADD +1 TO PV-BLOCK-NUMBER                        22950002
229600             END-IF                                               22960002
229700             MOVE +1    TO ASC-BLK-SUB                            22970002
229800             PERFORM 4410-READ-TEMP-STORAGE                       22980002
229900             ADD +1     TO ASC-BLK-SUB                            22990002
230000                           PV-BLOCK-NUMBER                        23000002
230100             PERFORM 4410-READ-TEMP-STORAGE                       23010002
230200     END-IF.                                                      23020002
230300     MOVE +1            TO ASC-BLK-SUB.                           23030002
230400     COMPUTE ASC-ITEM-SUB =                                       23040002
230500         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              23050002
230600         + PC-ITEMS-PER-PANEL).                                   23060002
230700*                                                                 23070002
230800     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        23080002
230900         ADD +1         TO ASC-BLK-SUB                            23090002
231000         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            23100002
231100     END-IF.                                                      23110002
231200*                                                                 23120002
231300     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           23130002
231400         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                23140002
231500     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        23150002
231600     PERFORM 4420-FORMAT-LIST-LINES                               23160002
231700         VARYING PV-SUB                                           23170002
231800         FROM PC-ITEMS-PER-PANEL BY -1                            23180002
231900         UNTIL PV-SUB < +1.                                       23190002
232000*                                                                 23200002
232100     COMPUTE ASC-ITEMS-DISPLAYED =                                23210002
232200         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          23220002
232300     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    23230002
232400                                      ASTRTITO.                   23240002
232500     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    23250002
232600     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    23260002
232700                                                                  23270002
232800     MOVE ASC-CS-LOC                 TO ALOCIDO.                  23280002
232900     MOVE ASC-PULL-NBR-N             TO APULNOO                   23290002
233000                                        DK-PULL-NUMBER.           23300002
233100     MOVE ASC-SKU-NUMBER             TO ASKUO.                    23310002
233200     MOVE ASC-LINE-ITEM              TO ALNENOO                   23320002
233300                                        DK-LINE-NUMBER.           23330002
233400     MOVE ASC-LINE-SKU-RETAIL        TO ASKRETO.                  23340002
233500                                                                  23350002
233600     PERFORM 4500-GET-PULL-ITEM                                   23360027
233700     PERFORM 4510-GET-PULL-DISTRO.                                23370027
233800     PERFORM 4520-GET-PULL-MANIFEST.                              23380027
233900     PERFORM 4530-GET-PULL-ADJUST.                                23390027
234000                                                                  23400002
234100     COMPUTE PV-COMPUTE-DISTRB-QTY =                              23410027
234200             (PV-CEPLDS-DISTRB-QTY +                              23420027
234300              PV-CEPLMF-MANIF-QTY  +                              23430027
234400              PV-CEPLAU-ADJUST-QTY).                              23440027
234500                                                                  23450027
234600     MOVE PV-CEPLIT-REQ-QTY          TO ARQUNTO.                  23460002
234700     MOVE PV-COMPUTE-DISTRB-QTY      TO APLACTO.                  23470027
234800                                                                  23480002
234900     MOVE ASC-REF-NBR                TO AREFNOO.                  23490002
235000                                                                  23500002
235100     EVALUATE TRUE                                                23510002
235200         WHEN ASC-PULL-CANCELLED                                  23520002
235300              MOVE PC-PULL-STATUS-CANCELLED TO APULSTO            23530002
235400         WHEN ASC-PULL-DISTRIBUTED                                23540002
235500              MOVE PC-DISTRIB-DESC          TO APULSTO            23550002
235600         WHEN ASC-PULL-IN-PROCESS                                 23560002
235700              MOVE PC-IN-PROCESS-DESC       TO APULSTO            23570002
235800         WHEN ASC-PULL-NEW                                        23580002
235900              MOVE PC-NEW-DESC              TO APULSTO            23590002
236000         WHEN ASC-PULL-POSTED                                     23600002
236100              MOVE PC-POSTED-DESC           TO APULSTO            23610002
236200         WHEN ASC-PULL-UNPOSTED                                   23620024
236300              MOVE PC-UNPOSTED-DESC         TO APULSTO            23630024
236400         WHEN OTHER                                               23640002
236500              MOVE PC-UNKNOWN-DESC          TO APULSTO            23650026
236600     END-EVALUATE.                                                23660002
236700                                                                  23670002
236800     EVALUATE TRUE                                                23680002
236900         WHEN ASC-LINE-STATUS-CANCELLED                           23690002
237000              MOVE PC-PULL-STATUS-CANCELLED TO ALNESTO            23700002
237100         WHEN ASC-LINE-STATUS-DISTRIBTD                           23710002
237200              MOVE PC-DISTRIB-DESC          TO ALNESTO            23720002
237300         WHEN ASC-LINE-STATUS-INPROCESS                           23730002
237400              MOVE PC-IN-PROCESS-DESC       TO ALNESTO            23740002
237500         WHEN ASC-LINE-STATUS-NEW                                 23750002
237600              MOVE PC-NEW-DESC              TO ALNESTO            23760002
237700         WHEN  ASC-LINE-STATUS-POSTED                             23770002
237800              MOVE PC-POSTED-DESC           TO ALNESTO            23780002
237900         WHEN  ASC-LINE-STATUS-UNPOSTED                           23790024
238000              MOVE PC-UNPOSTED-DESC         TO ALNESTO            23800024
238100         WHEN OTHER                                               23810002
238200              IF  ASC-LINE-ITEM  >  0                             23820026
238300                  MOVE PC-UNKNOWN-DESC      TO ALNESTO            23830026
238400              ELSE                                                23840026
238500                  MOVE SPACES               TO ALNESTO            23850026
238600              END-IF                                              23860026
238700     END-EVALUATE.                                                23870002
238800                                                                  23880002
238900*                                                                 23890002
239000     IF  DP020-MSG-NUMBER-X = SPACE                               23900002
239100         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  23910002
239200*            --- MORE ITEMS TO DISPLAY ----                       23920002
239300             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            23930002
239400             SET DP020-MSG-INFORMATIONAL TO TRUE                  23940002
239500         END-IF                                                   23950002
239600     END-IF.                                                      23960002
239700*----------------------------------------------------------------*23970002
239800*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *23980002
239900*----------------------------------------------------------------*23990002
240000                                                                  24000002
240100 4410-READ-TEMP-STORAGE.                                          24010002
240200                                                                  24020002
240300     EXEC CICS                                                    24030002
240400         READQ TS                                                 24040002
240500             QUEUE (ASC-LIST-QUEUE-NAME)                          24050002
240600             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               24060002
240700             ITEM  (PV-BLOCK-NUMBER)                              24070002
240800             RESP  (PV-CICS-RESP)                                 24080002
240900     END-EXEC.                                                    24090002
241000                                                                  24100002
241100     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       24110002
241200       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     24120002
241300         CONTINUE                                                 24130002
241400     ELSE                                                         24140002
241500         SET DP013-CICS-ABEND     TO TRUE                         24150002
241600         SET DP013-NO-ROLLBACK    TO TRUE                         24160002
241700         MOVE '4410-READ-TEMP-STORAGE'                            24170002
241800                                  TO DP013-PARAGRAPH              24180002
241900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      24190002
242000                                  TO DP013-MESSAGE-TEXT(1)        24200002
242100         PERFORM DP013-0000-PROCESS-ABEND                         24210002
242200     END-IF.                                                      24220002
242300                                                                  24230002
242400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             24240002
242500*                                                                 24250002
242600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         24260002
242700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               24270002
242800     END-IF.                                                      24280002
242900 EJECT                                                            24290002
243000*----------------------------------------------------------------*24300002
243100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *24310002
243200*----------------------------------------------------------------*24320002
243300                                                                  24330002
243400 4420-FORMAT-LIST-LINES.                                          24340002
243500     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      24350002
243600         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                24360002
243700         MOVE SPACES             TO MR-PROCESS (PV-SUB)           24370005
243800                                    MR-DATE-TIME (PV-SUB)         24380005
243900                                    MR-USER (PV-SUB)              24390005
244000     ELSE                                                         24400002
244100*                                                                 24410002
244200         IF  DP030-SET-CURSOR-TRAILER                             24420002
244300             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)24430002
244400                 > SPACE)                                         24440002
244500               OR (PV-SUB = 1))                                   24450002
244600                SET DP030-SET-CURSOR-APPL-1 TO TRUE               24460002
244700                MOVE -1               TO ASTRTITL                 24470009
244800             END-IF                                               24480002
244900         END-IF                                                   24490002
245000*                                                                 24500002
245100         MOVE ASC-PROCESS (ASC-BLK-SUB ASC-ITEM-SUB)              24510004
245200                                 TO MR-PROCESS (PV-SUB)           24520004
245300         MOVE ASC-DATE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)            24530004
245400                                 TO MR-DATE-TIME (PV-SUB)         24540004
245500         MOVE ASC-USER-ID (ASC-BLK-SUB ASC-ITEM-SUB)              24550004
245600                                 TO MR-USER (PV-SUB)              24560004
245700                                                                  24570002
245800     END-IF.                                                      24580002
245900     SUBTRACT +1 FROM ASC-ITEM-SUB                                24590002
246000     IF  ASC-ITEM-SUB < + 1                                       24600002
246100         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  24610002
246200         MOVE +1                 TO ASC-BLK-SUB                   24620002
246300     END-IF.                                                      24630002
246400******************************************************************24640002
246500** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **24650002
246600** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **24660002
246700** ISSUE A WARNING.                                             **24670002
246800******************************************************************24680002
246900 4430-CHECK-FOR-BEGIN-AND-END.                                    24690002
247000     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       24700002
247100         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     24710002
247200*            -- NO END-OF-RANGE SPECFIED ---                      24720002
247300             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            24730002
247400             SET DP020-MSG-WARNING TO TRUE                        24740002
247500             PERFORM 4431-POSITION-AT-WARNING                     24750002
247600         END-IF                                                   24760002
247700     ELSE                                                         24770002
247800         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     24780002
247900*            -- NO BEGINNING-OF-RANGE SPECFIED ---                24790002
248000             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            24800002
248100             SET DP020-MSG-WARNING TO TRUE                        24810002
248200             PERFORM 4431-POSITION-AT-WARNING                     24820002
248300         END-IF                                                   24830002
248400     END-IF.                                                      24840002
248500******************************************************************24850002
248600** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **24860002
248700** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **24870002
248800** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **24880002
248900** POSITION THE CURSOR THERE.                                   **24890002
249000******************************************************************24900002
249100 4431-POSITION-AT-WARNING.                                        24910002
249200     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 24920002
249300                    - PV-TOP-ITEM + 1.                            24930002
249400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      24940002
249500         CONTINUE                                                 24950002
249600     ELSE                                                         24960002
249700         SET DP030-SET-CURSOR-APPL-1                              24970002
249800                                   TO TRUE                        24980002
249900         MOVE -1                   TO ASTRTITL                    24990009
250000     END-IF.                                                      25000002
250100*                                                                 25010002
250200     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   25020002
250300                    - PV-TOP-ITEM + 1.                            25030002
250400     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      25040002
250500         CONTINUE                                                 25050002
250600     ELSE                                                         25060002
250700         SET DP030-SET-CURSOR-APPL-1                              25070002
250800                                   TO TRUE                        25080002
250900         MOVE -1                   TO ASTRTITL                    25090009
251000     END-IF.                                                      25100002
251100                                                                  25110002
251200                                                                  25120002
251300*----------------------------------------------------------------*25130002
251400* GET PULL ITEM QTYS                                             *25140002
251500*----------------------------------------------------------------*25150002
251600 4500-GET-PULL-ITEM.                                              25160002
251700                                                                  25170002
251800     INITIALIZE  PV-CEPLIT-ITEM-QTY                               25180002
251900                 PV-CEPLIT-REQ-QTY                                25190002
252000                 PV-CEPLIT-ACTL-QTY.                              25200002
252100                                                                  25210002
252200     IF  DK-LINE-NUMBER  >  0                                     25220026
252300         EXEC SQL                                                 25230026
252400             SELECT  COUNT(*)                                     25240026
252500                    ,SUM(PL_REQ_QTY)                              25250026
252600                    ,SUM(ACTL_PL_QTY)                             25260026
252700               INTO  :PV-CEPLIT-ITEM-QTY                          25270026
252800                    ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1           25280026
252900                    ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2           25290026
253000               FROM  TCEPLIT                                      25300026
253100              WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER         25310026
253200                AND  PL_LNE_NBR        =  :DK-LINE-NUMBER         25320026
253300               AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD') 25330026
253400         END-EXEC                                                 25340026
253500     ELSE                                                         25350026
253600         EXEC SQL                                                 25360026
253700             SELECT  COUNT(*)                                     25370026
253800                    ,SUM(PL_REQ_QTY)                              25380026
253900                    ,SUM(ACTL_PL_QTY)                             25390026
254000               INTO  :PV-CEPLIT-ITEM-QTY                          25400026
254100                    ,:PV-CEPLIT-REQ-QTY  :PV-NULL-IND-1           25410026
254200                    ,:PV-CEPLIT-ACTL-QTY :PV-NULL-IND-2           25420026
254300               FROM  TCEPLIT                                      25430026
254400              WHERE  CNSTK_REQ_PL_NBR  =  :DK-PULL-NUMBER         25440026
254500               AND  STAT_CDE         IN  ('NW', 'IP', 'DS', 'PD') 25450026
254600         END-EXEC                                                 25460026
254700     END-IF                                                       25470026
254800                                                                  25480002
254900     EVALUATE TRUE                                                25490002
255000         WHEN SQLCODE = +0                                        25500002
255100              CONTINUE                                            25510002
255200         WHEN SQLCODE = -904                                      25520002
255300         WHEN SQLCODE = -911                                      25530002
255400         WHEN SQLCODE = -913                                      25540002
255500             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    25550002
255600             MOVE '4500-GET-PULL-ITEM  '    TO PV-SOFT-PARAGRAPH  25560002
255700             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  25570002
255800             MOVE LENGTH OF PV-CICS-MSG-AREA2                     25580002
255900               TO PV-COMMAREA-LENGTH                              25590002
256000             EXEC CICS                                            25600002
256100                  WRITEQ TD                                       25610002
256200                   QUEUE  ('CSSL')                                25620002
256300                    FROM  (PV-CICS-MSG-AREA2)                     25630002
256400                  LENGTH  (PV-COMMAREA-LENGTH)                    25640002
256500                    RESP  (PV-CICS-RESP)                          25650002
256600             END-EXEC                                             25660002
256700             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          25670002
256800             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              25680002
256900             PERFORM 9900-SOFT-ABORT                              25690002
257000         WHEN OTHER                                               25700002
257100              MOVE '4500-GET-PULL-ITEM'                           25710002
257200                               TO DP013-PARAGRAPH                 25720002
257300              MOVE 'GET PULL STATUS ITEM QTYS'                    25730002
257400                               TO DP013-MESSAGE-TEXT (1)          25740002
257500              MOVE SQLCA       TO DP013-SQLCA                     25750002
257600              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (1)        25760002
257700              SET DP013-DB2-ABEND                                 25770002
257800                  DP013-XCTL-DISPLAY-RESTART                      25780002
257900                                   TO TRUE                        25790002
258000                  PERFORM DP013-0000-PROCESS-ABEND                25800002
258100     END-EVALUATE.                                                25810002
258200                                                                  25820002
258300*----------------------------------------------------------------*25830027
258400* GET LINE ITEM DISTRIBUTION QTY & STORE COUNT                   *25840027
258500*----------------------------------------------------------------*25850027
258600 4510-GET-PULL-DISTRO.                                            25860027
258700     INITIALIZE  PV-CEPLDS-DISTRB-QTY.                            25870027
258800                                                                  25880027
258900     IF  DK-LINE-NUMBER  >  0                                     25890027
259000         EXEC SQL                                                 25900027
259100              SELECT  SUM(B.ACTL_DISTRB_QTY)                      25910027
259200                INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1        25920027
259300                FROM  TCEPLIT A                                   25930027
259400                   ,  TCEPLDS B                                   25940027
259500               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       25950027
259600                 AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER       25960027
259700                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    25970027
259800                 AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR          25980027
259900                 AND  A.STAT_CDE   IN  ('DS', 'PD')               25990027
260000         END-EXEC                                                 26000027
260100     ELSE                                                         26010027
260200         EXEC SQL                                                 26020027
260300              SELECT  SUM(B.ACTL_DISTRB_QTY)                      26030030
260400                INTO  :PV-CEPLDS-DISTRB-QTY :PV-NULL-IND-1        26040027
260500                FROM  TCEPLIT A                                   26050027
260600                   ,  TCEPLDS B                                   26060027
260700               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       26070027
260800                 AND  A.CNSTK_REQ_PL_NBR =  B.CNSTK_REQ_PL_NBR    26080027
260900                 AND  A.PL_LNE_NBR       =  B.PL_LNE_NBR          26090027
261000                 AND  A.STAT_CDE   IN  ('DS', 'PD')               26100027
261100         END-EXEC                                                 26110027
261200     END-IF.                                                      26120027
261300                                                                  26130027
261400                                                                  26140027
261500     EVALUATE TRUE                                                26150027
261600         WHEN SQLCODE = +0                                        26160027
261700              CONTINUE                                            26170027
261800         WHEN SQLCODE = -904                                      26180027
261900         WHEN SQLCODE = -911                                      26190027
262000         WHEN SQLCODE = -913                                      26200027
262100             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    26210027
262200             MOVE '4510-GET-PULL-DISTRO'    TO PV-SOFT-PARAGRAPH  26220027
262300             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  26230027
262400             MOVE LENGTH OF PV-CICS-MSG-AREA2                     26240027
262500               TO PV-COMMAREA-LENGTH                              26250027
262600             EXEC CICS                                            26260027
262700                  WRITEQ TD                                       26270027
262800                   QUEUE  ('CSSL')                                26280027
262900                    FROM  (PV-CICS-MSG-AREA2)                     26290027
263000                  LENGTH  (PV-COMMAREA-LENGTH)                    26300027
263100                    RESP  (PV-CICS-RESP)                          26310027
263200             END-EXEC                                             26320027
263300             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          26330027
263400             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              26340027
263500             PERFORM 9900-SOFT-ABORT                              26350027
263600         WHEN OTHER                                               26360027
263700              MOVE '4510-GET-PULL-DISTRO'                         26370027
263800                               TO DP013-PARAGRAPH                 26380027
263900              MOVE 'GET LINE DISTRIBTION     '                    26390027
264000                               TO DP013-MESSAGE-TEXT (1)          26400027
264100              MOVE SQLCA       TO DP013-SQLCA                     26410027
264200              MOVE 'TCEPLDS '  TO DP013-DB2-TABLE-NAME (2)        26420027
264300              MOVE 'TCEPLIT '  TO DP013-DB2-TABLE-NAME (3)        26430027
264400              SET DP013-DB2-ABEND                                 26440027
264500                  DP013-XCTL-DISPLAY-RESTART                      26450027
264600                                   TO TRUE                        26460027
264700                  PERFORM DP013-0000-PROCESS-ABEND                26470027
264800     END-EVALUATE.                                                26480027
264900                                                                  26490027
265000                                                                  26500027
265100*----------------------------------------------------------------*26510027
265200* GET LINE ITEM MANIFESTED UNIT QUANTITY                         *26520027
265300*----------------------------------------------------------------*26530027
265400 4520-GET-PULL-MANIFEST.                                          26540027
265500     INITIALIZE  PV-CEPLMF-MANIF-QTY.                             26550027
265600                                                                  26560027
265700     IF  DK-LINE-NUMBER  >  0                                     26570027
265800         EXEC SQL                                                 26580027
265900              SELECT  SUM(A.MFST_UNT_QTY)                         26590027
266000                INTO  :PV-CEPLMF-MANIF-QTY :PV-NULL-IND-4         26600027
266100                FROM  TCEPLMF A                                   26610027
266200                   ,  TCEPLIT B                                   26620027
266300               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       26630027
266400                 AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER       26640027
266500                 AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR    26650027
266600                 AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR          26660027
266700                 AND  B.STAT_CDE         NOT IN ('CA', 'PD')      26670027
266800         END-EXEC                                                 26680027
266900     ELSE                                                         26690027
267000         EXEC SQL                                                 26700027
267100              SELECT  SUM(A.MFST_UNT_QTY)                         26710027
267200                INTO  :PV-CEPLMF-MANIF-QTY :PV-NULL-IND-4         26720027
267300                FROM  TCEPLMF A                                   26730027
267400                   ,  TCEPLIT B                                   26740027
267500               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       26750027
267600                 AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR    26760027
267700                 AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR          26770027
267800                 AND  B.STAT_CDE         NOT IN ('CA', 'PD')      26780027
267900         END-EXEC                                                 26790027
268000     END-IF.                                                      26800027
268100                                                                  26810027
268200                                                                  26820027
268300     EVALUATE TRUE                                                26830027
268400         WHEN SQLCODE = +0                                        26840027
268500              CONTINUE                                            26850027
268600         WHEN SQLCODE = -904                                      26860027
268700         WHEN SQLCODE = -911                                      26870027
268800         WHEN SQLCODE = -913                                      26880027
268900             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    26890027
269000             MOVE '4520-GET-PULL-MANIFEST'  TO PV-SOFT-PARAGRAPH  26900027
269100             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  26910027
269200             MOVE LENGTH OF PV-CICS-MSG-AREA2                     26920027
269300               TO PV-COMMAREA-LENGTH                              26930027
269400             EXEC CICS                                            26940027
269500                  WRITEQ TD                                       26950027
269600                   QUEUE  ('CSSL')                                26960027
269700                    FROM  (PV-CICS-MSG-AREA2)                     26970027
269800                  LENGTH  (PV-COMMAREA-LENGTH)                    26980027
269900                    RESP  (PV-CICS-RESP)                          26990027
270000             END-EXEC                                             27000027
270100             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          27010027
270200             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              27020027
270300             PERFORM 9900-SOFT-ABORT                              27030027
270400         WHEN OTHER                                               27040027
270500              MOVE '4520-GET-PULL-MANIFEST'                       27050027
270600                               TO DP013-PARAGRAPH                 27060027
270700              MOVE 'GET LINE MANIFEST QTY    '                    27070027
270800                               TO DP013-MESSAGE-TEXT (1)          27080027
270900              MOVE SQLCA       TO DP013-SQLCA                     27090027
271000              MOVE 'TCEPLMF '  TO DP013-DB2-TABLE-NAME (2)        27100027
271100              SET DP013-DB2-ABEND                                 27110027
271200                  DP013-XCTL-DISPLAY-RESTART                      27120027
271300                                   TO TRUE                        27130027
271400                  PERFORM DP013-0000-PROCESS-ABEND                27140027
271500     END-EVALUATE.                                                27150027
271600                                                                  27160027
271700                                                                  27170027
271800                                                                  27180027
271900*----------------------------------------------------------------*27190027
272000* GET LINE ITEM ADJUSTED UNIT QUANTITY                           *27200027
272100*----------------------------------------------------------------*27210027
272200 4530-GET-PULL-ADJUST.                                            27220027
272300     INITIALIZE  PV-CEPLAU-ADJUST-QTY.                            27230027
272400                                                                  27240027
272500     IF  DK-LINE-NUMBER  >  0                                     27250027
272600         EXEC SQL                                                 27260027
272700              SELECT  SUM(A.AFT_ADJ_UNT_QTY - A.BEF_ADJ_UNT_QTY)  27270027
272800                INTO  :PV-CEPLAU-ADJUST-QTY :PV-NULL-IND-5        27280027
272900                FROM  TCEPLAU A                                   27290027
273000                   ,  TCEPLIT B                                   27300027
273100               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       27310027
273200                 AND  A.PL_LNE_NBR       =  :DK-LINE-NUMBER       27320027
273300                 AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR    27330027
273400                 AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR          27340027
273500                 AND  B.STAT_CDE         NOT IN ('CA', 'PD')      27350027
273600         END-EXEC                                                 27360027
273700     ELSE                                                         27370027
273800         EXEC SQL                                                 27380027
273900              SELECT  SUM(A.AFT_ADJ_UNT_QTY - A.BEF_ADJ_UNT_QTY)  27390027
274000                INTO  :PV-CEPLAU-ADJUST-QTY :PV-NULL-IND-5        27400027
274100                FROM  TCEPLAU A                                   27410027
274200                   ,  TCEPLIT B                                   27420027
274300               WHERE  A.CNSTK_REQ_PL_NBR =  :DK-PULL-NUMBER       27430027
274400                 AND  B.CNSTK_REQ_PL_NBR =  A.CNSTK_REQ_PL_NBR    27440027
274500                 AND  B.PL_LNE_NBR       =  A.PL_LNE_NBR          27450027
274600                 AND  B.STAT_CDE         NOT IN ('CA', 'PD')      27460027
274700         END-EXEC                                                 27470027
274800     END-IF.                                                      27480027
274900                                                                  27490027
275000                                                                  27500027
275100     EVALUATE TRUE                                                27510027
275200         WHEN SQLCODE = +0                                        27520027
275300              CONTINUE                                            27530027
275400         WHEN SQLCODE = -904                                      27540027
275500         WHEN SQLCODE = -911                                      27550027
275600         WHEN SQLCODE = -913                                      27560027
275700             MOVE SQLCODE                   TO PV-SOFT-SQLCODE    27570027
275800             MOVE '4530-GET-PULL-ADJUST'    TO PV-SOFT-PARAGRAPH  27580027
275900             MOVE PV-SOFT-ABORT-MSG         TO PV-CICS-MSG-AREA2  27590027
276000             MOVE LENGTH OF PV-CICS-MSG-AREA2                     27600027
276100               TO PV-COMMAREA-LENGTH                              27610027
276200             EXEC CICS                                            27620027
276300                  WRITEQ TD                                       27630027
276400                   QUEUE  ('CSSL')                                27640027
276500                    FROM  (PV-CICS-MSG-AREA2)                     27650027
276600                  LENGTH  (PV-COMMAREA-LENGTH)                    27660027
276700                    RESP  (PV-CICS-RESP)                          27670027
276800             END-EXEC                                             27680027
276900             MOVE  PC-TSYMSG-00984  TO  DP020-MSG-NUMBER          27690027
277000             SET  DP020-NEXT-ACT-APPL-ERROR  TO TRUE              27700027
277100             PERFORM 9900-SOFT-ABORT                              27710027
277200         WHEN OTHER                                               27720027
277300              MOVE '4530-GET-PULL-ADJUST'                         27730027
277400                               TO DP013-PARAGRAPH                 27740027
277500              MOVE 'GET LINE ADJUSTMENT QTY  '                    27750027
277600                               TO DP013-MESSAGE-TEXT (1)          27760027
277700              MOVE SQLCA       TO DP013-SQLCA                     27770027
277800              MOVE 'TCEPLAU '  TO DP013-DB2-TABLE-NAME (2)        27780027
277900              SET DP013-DB2-ABEND                                 27790027
278000                  DP013-XCTL-DISPLAY-RESTART                      27800027
278100                                   TO TRUE                        27810027
278200                  PERFORM DP013-0000-PROCESS-ABEND                27820027
278300     END-EVALUATE.                                                27830027
278400                                                                  27840027
278500                                                                  27850027
278600*----------------------------------------------------------------*27860027
278700*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *27870002
278800*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *27880002
278900*----------------------------------------------------------------*27890002
279000                                                                  27900002
279100 5100-WRITE-TEMP-STORAGE.                                         27910002
279200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     27920002
279300                                   TO PV-LIST-ITEM-NUMBER.        27930002
279400     COMPUTE PV-BLOCK-NUMBER =                                    27940002
279500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    27950002
279600                                                                  27960002
279700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             27970002
279800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             27980002
279900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      27990002
280000             PERFORM 5105-REWRITE-ASC-LISTQ                       28000002
280100         END-IF                                                   28010002
280200     ELSE                                                         28020002
280300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       28030002
280400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            28040002
280500         PERFORM 5110-WRITE-ASC-LISTQ                             28050002
280600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   28060002
280700     END-IF.                                                      28070002
280800                                                                  28080002
280900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28090002
281000******************************************************************28100002
281100** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **28110002
281200** SPECIFIC COMMAREA.                                           **28120002
281300******************************************************************28130002
281400 5105-REWRITE-ASC-LISTQ.                                          28140002
281500     EXEC CICS                                                    28150002
281600         WRITEQ TS                                                28160002
281700             QUEUE (ASC-LIST-QUEUE-NAME)                          28170002
281800             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28180002
281900             ITEM  (PV-BLOCK-NUMBER)                              28190002
282000             REWRITE                                              28200002
282100             RESP  (PV-CICS-RESP)                                 28210002
282200     END-EXEC.                                                    28220002
282300                                                                  28230002
282400     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           28240002
282500         CONTINUE                                                 28250002
282600     ELSE                                                         28260002
282700         SET DP013-CICS-ABEND            TO TRUE                  28270002
282800         SET DP013-NO-ROLLBACK           TO TRUE                  28280002
282900         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       28290002
283000         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     28300002
283100                                         TO DP013-MESSAGE-TEXT(1) 28310002
283200         PERFORM DP013-0000-PROCESS-ABEND                         28320002
283300     END-IF.                                                      28330002
283400                                                                  28340002
283500******************************************************************28350002
283600** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **28360002
283700** SPECIFIC COMMAREA.                                           **28370002
283800******************************************************************28380002
283900 5110-WRITE-ASC-LISTQ.                                            28390002
284000     EXEC CICS                                                    28400002
284100         WRITEQ TS                                                28410002
284200             QUEUE (ASC-LIST-QUEUE-NAME)                          28420002
284300             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               28430002
284400             ITEM  (PV-BLOCK-NUMBER)                              28440002
284500             RESP  (PV-CICS-RESP)                                 28450002
284600     END-EXEC.                                                    28460002
284700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      28470002
284800         SET DP013-CICS-ABEND      TO TRUE                        28480002
284900         SET DP013-NO-ROLLBACK     TO TRUE                        28490002
285000         MOVE '5110-WRITE-ASC-LISTQ'                              28500002
285100                                   TO DP013-PARAGRAPH             28510002
285200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           28520002
285300                                   TO DP013-MESSAGE-TEXT(1)       28530002
285400         PERFORM DP013-0000-PROCESS-ABEND                         28540002
285500     END-IF.                                                      28550002
285600                                                                  28560004
285700                                                                  28570002
285800******************************************************************28580002
285900** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **28590002
286000** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **28600002
286100** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **28610002
286200** THE USER.                                                    **28620002
286300******************************************************************28630002
286400 6000-REFRESH-PANEL-FROM-TEMP.                                    28640002
286500     IF  ASC-UPDATE-TSQ                                           28650002
286600         SET ASC-NO-TSQ-UPDATE TO TRUE                            28660002
286700         MOVE ZERO                 TO PV-SAVE-ITEM                28670002
286800                                      PV-SEL-QUEUE-ITEM           28680002
286900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        28690002
287000                                   TO PV-HOLD-SELECTED-ITEMS      28700002
287100         MOVE +1                   TO PV-ITEMS-PROCESSED          28710002
287200         PERFORM 6100-UPDATE-TSQ                                  28720002
287300             UNTIL PV-ITEMS-PROCESSED >                           28730002
287400                                     PV-HOLD-SELECTED-ITEMS       28740002
287500         PERFORM 6010-DELETE-SEL-QUEUE                            28750002
287600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         28760002
287700                    ASC-BLOCK-ENTRIES (2)                         28770002
287800     END-IF.                                                      28780002
287900                                                                  28790002
288000*----------------------------------------------------------------*28800002
288100*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *28810002
288200*----------------------------------------------------------------*28820002
288300 6010-DELETE-SEL-QUEUE.                                           28830002
288400                                                                  28840002
288500     EXEC CICS                                                    28850002
288600         DELETEQ TS                                               28860002
288700             QUEUE (ASC-SEL-QUEUE-NAME)                           28870002
288800             RESP  (PV-CICS-RESP)                                 28880002
288900     END-EXEC.                                                    28890002
289000*                                                                 28900002
289100     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      28910002
289200        (PV-CICS-RESP = DFHRESP(QIDERR)))                         28920002
289300         CONTINUE                                                 28930002
289400     ELSE                                                         28940002
289500         SET DP013-CICS-ABEND TO TRUE                             28950002
289600         SET DP013-NO-ROLLBACK TO TRUE                            28960002
289700         MOVE '6010-DELETE-SEL-QUEUE'                             28970002
289800                        TO DP013-PARAGRAPH                        28980002
289900         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         28990002
290000                        TO DP013-MESSAGE-TEXT (1)                 29000002
290100         PERFORM DP013-0000-PROCESS-ABEND                         29010002
290200     END-IF.                                                      29020002
290300                                                                  29030002
290400*----------------------------------------------------------------*29040002
290500*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *29050002
290600*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *29060002
290700*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *29070002
290800*    THE TEMP QUEUE.                                             *29080002
290900*----------------------------------------------------------------*29090002
291000                                                                  29100002
291100 6100-UPDATE-TSQ.                                                 29110002
291200                                                                  29120002
291300     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             29130002
291400     PERFORM 6105-READ-SEL-QUEUE.                                 29140002
291500     PERFORM                                                      29150002
291600         VARYING CE003-IDX                                        29160002
291700         FROM 1 BY 1                                              29170002
291800         UNTIL ((PV-ITEMS-PROCESSED >                             29180002
291900                              PV-HOLD-SELECTED-ITEMS)             29190002
292000         OR (CE003-IDX GREATER THAN CE003-MAX-ITEMS))             29200002
292100         IF  CE003-ACTION-SW (CE003-IDX) > SPACE                  29210002
292200             PERFORM 6110-PROCESS-ITEMS                           29220002
292300         END-IF                                                   29230002
292400         ADD +1                TO PV-ITEMS-PROCESSED              29240002
292500     END-PERFORM.                                                 29250002
292600     PERFORM 6111-WRITE-LIST-QUEUE.                               29260002
292700*----------------------------------------------------------------*29270002
292800*    READ THE LIST QUEUE RECORD.                                 *29280002
292900*----------------------------------------------------------------*29290002
293000                                                                  29300002
293100 6105-READ-SEL-QUEUE.                                             29310002
293200                                                                  29320002
293300     EXEC CICS                                                    29330002
293400          READQ TS                                                29340002
293500              QUEUE (ASC-SEL-QUEUE-NAME)                          29350002
293600              INTO  (CE003-SELECT-RECORD)                         29360002
293700              ITEM  (PV-SEL-QUEUE-ITEM)                           29370002
293800              RESP  (PV-CICS-RESP)                                29380002
293900     END-EXEC.                                                    29390002
294000*                                                                 29400002
294100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29410002
294200         CONTINUE                                                 29420002
294300     ELSE                                                         29430002
294400         SET DP013-CICS-ABEND      TO  TRUE                       29440002
294500         SET DP013-NO-ROLLBACK     TO  TRUE                       29450002
294600         MOVE '6105-READ-SEL-QUEUE'                               29460002
294700                                   TO  DP013-PARAGRAPH            29470002
294800         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           29480002
294900                                   TO  DP013-MESSAGE-TEXT(1)      29490002
295000         PERFORM DP013-0000-PROCESS-ABEND                         29500002
295100     END-IF.                                                      29510002
295200 EJECT                                                            29520002
295300*----------------------------------------------------------------*29530002
295400*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*29540002
295500*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*29550002
295600*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *29560002
295700*----------------------------------------------------------------*29570002
295800                                                                  29580002
295900 6110-PROCESS-ITEMS.                                              29590002
296000                                                                  29600002
296100     COMPUTE PV-ITEM = 1 + ((CE003-ITEM (CE003-IDX) - 1)          29610002
296200                     / PC-ITEMS-PER-PANEL).                       29620002
296300                                                                  29630002
296400     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           29640002
296500         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          29650002
296600             PERFORM 6111-WRITE-LIST-QUEUE                        29660002
296700         END-IF                                                   29670002
296800         MOVE PV-ITEM          TO PV-SAVE-ITEM                    29680002
296900                                                                  29690002
297000         PERFORM 6112-READ-LIST-QUEUE                             29700002
297100         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               29710002
297200             CONTINUE                                             29720002
297300         END-IF                                                   29730002
297400     END-IF.                                                      29740002
297500                                                                  29750002
297600     COMPUTE PV-SUB = (CE003-ITEM (CE003-IDX)                     29760002
297700                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              29770002
297800     SET LQW-DESELECT (PV-SUB) TO    TRUE                         29780002
297900     MOVE LQW-SELECTED-SW (PV-SUB)                                29790002
298000                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  29800002
298100                                                                  29810002
298200     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                29820002
298300                                                                  29830002
298400*----------------------------------------------------------------*29840002
298500*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *29850002
298600*----------------------------------------------------------------*29860002
298700                                                                  29870002
298800 6111-WRITE-LIST-QUEUE.                                           29880002
298900                                                                  29890002
299000     EXEC CICS                                                    29900002
299100         WRITEQ TS                                                29910002
299200             QUEUE (ASC-LIST-QUEUE-NAME)                          29920002
299300             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     29930002
299400             ITEM  (PV-SAVE-ITEM)                                 29940002
299500             REWRITE                                              29950002
299600             RESP  (PV-CICS-RESP)                                 29960002
299700     END-EXEC.                                                    29970002
299800*                                                                 29980002
299900     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29990002
300000         CONTINUE                                                 30000002
300100     ELSE                                                         30010002
300200         SET DP013-CICS-ABEND  TO  TRUE                           30020002
300300         SET DP013-NO-ROLLBACK TO  TRUE                           30030002
300400         MOVE '6111-WRITE-LIST-QUEUE'                             30040002
300500                               TO  DP013-PARAGRAPH                30050002
300600         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  30060002
300700                               TO  DP013-MESSAGE-TEXT(1)          30070002
300800         PERFORM DP013-0000-PROCESS-ABEND                         30080002
300900     END-IF.                                                      30090002
301000                                                                  30100002
301100 EJECT                                                            30110002
301200*----------------------------------------------------------------*30120002
301300*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*30130002
301400*----------------------------------------------------------------*30140002
301500                                                                  30150002
301600 6112-READ-LIST-QUEUE.                                            30160002
301700                                                                  30170002
301800     EXEC CICS                                                    30180002
301900         READQ TS                                                 30190002
302000             QUEUE (ASC-LIST-QUEUE-NAME)                          30200002
302100             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     30210002
302200             ITEM  (PV-ITEM)                                      30220002
302300             RESP  (PV-CICS-RESP)                                 30230002
302400     END-EXEC.                                                    30240002
302500*                                                                 30250002
302600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          30260002
302700         CONTINUE                                                 30270002
302800     ELSE                                                         30280002
302900         SET DP013-CICS-ABEND        TO TRUE                      30290002
303000         SET DP013-NO-ROLLBACK       TO TRUE                      30300002
303100         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           30310002
303200         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    30320002
303300                                     TO DP013-MESSAGE-TEXT(1)     30330002
303400         PERFORM DP013-0000-PROCESS-ABEND                         30340002
303500     END-IF.                                                      30350002
303600                                                                  30360002
303700                                                                  30370002
303800*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 30380002
303900* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *30390002
304000*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 30400002
304100 9100-READ-SEL-QUEUE.                                             30410002
304200                                                                  30420002
304300     EXEC CICS                                                    30430002
304400         READQ TS                                                 30440002
304500             QUEUE (ASC-SEL-QUEUE-NAME)                           30450002
304600             INTO  (CE003-SELECT-RECORD)                          30460002
304700             ITEM  (ASC-SEL-ITEM)                                 30470002
304800             RESP  (PV-CICS-RESP)                                 30480002
304900     END-EXEC.                                                    30490002
305000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        30500002
305100         CONTINUE                                                 30510002
305200     ELSE                                                         30520002
305300         SET DP013-LOGIC-ABEND                                    30530002
305400             DP013-NO-ROLLBACK   TO   TRUE                        30540002
305500         MOVE '9100-READ-SEL-QUEUE'                               30550002
305600                                 TO   DP013-PARAGRAPH             30560002
305700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   30570002
305800                                 TO   DP013-MESSAGE-TEXT (1)      30580002
305900         PERFORM DP013-0000-PROCESS-ABEND                         30590002
306000     END-IF.                                                      30600002
306100                                                                  30610002
306200                                                                  30620002
306300*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*30630002
306400* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *30640002
306500*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 30650002
306600 9200-REWRITE-SEL-QUEUE.                                          30660002
306700                                                                  30670002
306800     EXEC CICS                                                    30680002
306900          WRITEQ TS                                               30690002
307000              QUEUE  (ASC-SEL-QUEUE-NAME)                         30700002
307100              FROM   (CE003-SELECT-RECORD)                        30710002
307200              ITEM   (ASC-SEL-ITEM)                               30720002
307300              RESP   (PV-CICS-RESP)                               30730002
307400              REWRITE                                             30740002
307500     END-EXEC.                                                    30750002
307600                                                                  30760002
307700     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   30770002
307800         SET DP013-CICS-ABEND                                     30780002
307900             DP013-NO-ROLLBACK     TO TRUE                        30790002
308000         MOVE '9200-REWRITE-SEL-QUEUE'                            30800002
308100                                   TO DP013-PARAGRAPH             30810002
308200         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30820002
308300                                   TO DP013-MESSAGE-TEXT (1)      30830002
308400         PERFORM DP013-0000-PROCESS-ABEND                         30840002
308500     END-IF.                                                      30850002
308600                                                                  30860002
308700                                                                  30870002
308800*----------------------------------------------------------------*30880002
308900*    THE DB2 RESOURCE IS NOT AVAILABLE, DISPLAY A MESSAGE ON     *30890002
309000*    THE TERMINAL INDICATING THAT THE RESOURCE IS UNAVAILABLE.   *30900002
309100*----------------------------------------------------------------*30910002
309200 9900-SOFT-ABORT.                                                 30920002
309300                                                                  30930002
309400     EXEC CICS SYNCPOINT                                          30940002
309500          ROLLBACK                                                30950002
309600     END-EXEC.                                                    30960002
309700                                                                  30970002
309800     SET  PS-ERROR                                                30980002
309900          PS-SOFT-ABORT-ERROR                                     30990002
310000          DP020-MSG-FATAL       TO  TRUE.                         31000002
310100                                                                  31010002
310200                                                                  31020002
310300*----------------------------------------------------------------*31030002
310400*    ABEND PROCESSOR MODULE                                      *31040002
310500*----------------------------------------------------------------*31050002
310600                                                                  31060002
310700     COPY DPPD013.                                                31070002
