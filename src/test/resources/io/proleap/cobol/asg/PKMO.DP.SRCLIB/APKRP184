000100 IDENTIFICATION DIVISION.                                         00010099
000200 PROGRAM-ID.    APKRP184.                                         00020099
000300 AUTHOR.        ROBIN BERNOSKI.                                   00030099
000400 DATE-WRITTEN.  AUGUST 1999.                                      00040099
000500 DATE-COMPILED.                                                   00050099
000600*************************************************************     00060099
000700*    COBOL 2                                                *     00070099
000800*                                                           *     00080099
000900*    UNJOURNALIZED RECEIPT REPORT BY DIVISION/DEPT/CLASS    *     00090099
001000*                                                           *     00100099
001100*   INPUT:                                                  *     00110099
001200*  1) INTRANSIT-FILE                      (APRD042)         *     00120099
001300*                                                           *     00130099
001400*   OUTPUT:                                                 *     00140099
001500*  1) REPORT-FILE                         (DPWS132O)        *     00150099
001600*                                                           *     00160099
001700*************************************************************     00170099
001800*************************************************************     00180099
001900* CHANGE LOG:                                               *     00190099
002000*                                                           *     00200099
002100*   01/23/02      BY:  MIKE BESKE                WR # 23005 *     00210099
002200*   INCREASED THE SIZE OF PV-HOLD-REC-SEQ-NBR TO MATCH THE  *     00220099
002300*   SAME INCREASE TO AP042-REC-SEQ-NBR.  ALSO INCREASED     *     00230099
002400*   THE SIZE OF DL-RCVR-SEQ-NBR.                            *     00240099
002500*                                                           *     00250099
002600* 02/05/2003                                                *     00260099
002700*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00270099
002800*    UPDATED THE PROGRAM TITLE TO MATCH THE SPEC PROGRAM    *     00280099
002900*    TITLE. UPDATED THE FILE NAMES IN THE PROGRAM COMMENT   *     00290099
003000*    BLOCK. INCREASED THE SIZE OF THE PRINT PO NBR TO Z(9)  *     00300099
003100*    AND THE SIZE OF THE W/S PO NBR FROM 7 TO 9 BYTES.      *     00310099
003200* MADE BY:  MIKE BESKE                          WR#: 23500  *     00320099
003210*                                                           *     00321099
003220* 03/31/2004                                                *     00322099
003230*    CHANGE MADE: INCREASED THE W/S STORE FIELDS FROM 3 TO  *     00323099
003240*    4 CHARS.                                               *     00324099
003250* MADE BY:  MIKE BESKE                          WR#: 25805  *     00325099
003210*                                                           *     00326099
003220* 09/07/2021                                                *     00327099
003230*    CHANGE MADE: RECOMPILE FOR NEW VERSION OF APRD042      *     00328099
003250* MADE BY:  JEAN KURK                       CHG0260549      *     00329199
003300*************************************************************     00330099
003400 ENVIRONMENT DIVISION.                                            00340099
003500*************************************************************     00350099
003600 CONFIGURATION SECTION.                                           00360099
003700 INPUT-OUTPUT SECTION.                                            00370099
003800 FILE-CONTROL.                                                    00380099
003900     SELECT INTRANSIT-FILE ASSIGN TO UT-S-INP01.                  00390099
004000                                                                  00400099
004100     SELECT REPORT-FILE    ASSIGN TO UT-S-RPT01.                  00410099
004200                                                                  00420099
004300 DATA DIVISION.                                                   00430099
004400 FILE SECTION.                                                    00440099
004500 FD  INTRANSIT-FILE RECORDING MODE IS F                           00450099
004600                                 LABEL RECORDS ARE STANDARD       00460099
004700                                 BLOCK CONTAINS 0 RECORDS         00470099
004800                                 DATA RECORD IS REPORT-RECORD.    00480099
004900 01  INTRANSIT-RECORD            PIC X(120).                      00490099
005000                                                                  00500099
005100 FD  REPORT-FILE                 RECORDING MODE IS F              00510099
005200                                 LABEL RECORDS ARE STANDARD       00520099
005300                                 BLOCK CONTAINS 0 RECORDS         00530099
005400                                 DATA RECORD IS REPORT-RECORD.    00540099
005500 01  REPORT-RECORD               PIC X(132).                      00550099
005600                                                                  00560099
005700                                                                  00570099
005800*************************************************************     00580099
005900 WORKING-STORAGE SECTION.                                         00590099
006000                                                                  00600099
006100 01  PV-PROGRAM-VARIABLES.                                        00610099
006200     05  PV-PROGRAM-NAME         PIC X(08)     VALUE 'APKRP184'.  00620099
006300     05  PV-CURRENT-PARAGRAPH    PIC  X(35).                      00630099
006400     05  PV-CURRENT-DATE.                                         00640099
006500         10  PV-CURRENT-YEAR     PIC  9(02)  VALUE ZEROS.         00650099
006600         10  PV-CURRENT-MONTH    PIC  9(02)  VALUE ZEROS.         00660099
006700         10  PV-CURRENT-DAY      PIC  9(02)  VALUE ZEROS.         00670099
006800     05  PV-CURRENT-TIME.                                         00680099
006900         10  PV-CURRENT-HOUR     PIC  9(02)  VALUE ZEROS.         00690099
007000         10  PV-CURRENT-MINUTE   PIC  9(02)  VALUE ZEROS.         00700099
007100         10  FILLER              PIC  9(02)  VALUE ZEROS.         00710099
007200     05  PV-HOLD-STR-NBR         PIC  9(04)  VALUE ZEROES.        00720099
007300     05  PV-HOLD-DMM-NBR         PIC  9(03)  VALUE ZEROES.        00730099
007400     05  PV-HOLD-DEPT-NBR        PIC  9(03)  VALUE ZEROES.        00740099
007500     05  PV-HOLD-CL-NBR          PIC  9(03)  VALUE ZEROES.        00750099
007600     05  PV-HOLD-PO-NBR          PIC  9(09)  VALUE ZEROES.        00760099
007700     05  PV-HOLD-REC-SEQ-NBR     PIC  9(09)  VALUE ZEROES.        00770099
007800     05  PV-HOLD-VRFD-DTE        PIC  X(10)  VALUE ZEROES.        00780099
007900     05  PV-HOLD-ENT-NM-DESC     PIC  X(30)  VALUE SPACES.        00790099
008000     05  PV-HOLD-RTL-AMT         PIC  S9(09)V99 VALUE ZEROES.     00800099
008100     05  PV-HOLD-COST-AMT        PIC  S9(09)V99 VALUE ZEROES.     00810099
008200                                                                  00820099
008300 01  PV-DATE-HOLD.                                                00830099
008400     05  PV-HOLD-CCYY           PIC X(04)   VALUE SPACES.         00840099
008500     05  FILLER                 PIC X(01)   VALUE SPACES.         00850099
008600     05  PV-HOLD-MO             PIC X(02)   VALUE SPACES.         00860099
008700     05  FILLER                 PIC X(01)   VALUE SPACES.         00870099
008800     05  PV-HOLD-DAY            PIC X(02)   VALUE SPACES.         00880099
008900                                                                  00890099
009000 01  PV-DATE-RESTRUCTURE.                                         00900099
009100     05  PV-DATE-MO             PIC X(02)   VALUE SPACES.         00910099
009200     05  FILLER                 PIC X(01)   VALUE '/'.            00920099
009300     05  PV-DATE-DAY            PIC X(02)   VALUE SPACES.         00930099
009400     05  FILLER                 PIC X(01)   VALUE '/'.            00940099
009500     05  PV-DATE-CCYY           PIC X(04)   VALUE SPACES.         00950099
009600                                                                  00960099
009700 01  PV-PROGRAM-SWITCHES.                                         00970099
009800     05  PS-FIRST-RUN-SW                  PIC X(01) VALUE 'Y'.    00980099
009900         88  FIRST-RUN                              VALUE 'Y'.    00990099
010000         88  NOT-FIRST-RUN                          VALUE 'N'.    01000099
010100     05  PS-STORE-FLAG-SW                 PIC X(01) VALUE 'N'.    01010099
010200         88  STORE-FLAG                             VALUE 'Y'.    01020099
010300         88  NOT-STORE-FLAG                         VALUE 'N'.    01030099
010400     05  SW-CLASS-NOT-FOUND               PIC X(01) VALUE 'N'.    01040099
010500         88 CLASS-NOT-FOUND                         VALUE 'N'.    01050099
010600         88 CLASS-FOUND                             VALUE 'Y'.    01060099
010700     05  SW-DEPT-NOT-FOUND                PIC X(01) VALUE 'N'.    01070099
010800         88 DEPT-NOT-FOUND                          VALUE 'N'.    01080099
010900         88 DEPT-FOUND                              VALUE 'Y'.    01090099
011000      05 WS-CLASS-BBL-SORT-SW             PIC X(01) VALUE 'N'.    01100099
011100         88  WS-CLASS-BBL-SORT-COMPLETE             VALUE 'Y'.    01110099
011200         88  WS-CLASS-BBL-SORT-NOT-COMPLETE         VALUE 'N'.    01120099
011300      05 WS-DEPT-BBL-SORT-SW              PIC X(01) VALUE 'N'.    01130099
011400         88  WS-DEPT-BBL-SORT-COMPLETE              VALUE 'Y'.    01140099
011500         88  WS-DEPT-BBL-SORT-NOT-COMPLETE          VALUE 'N'.    01150099
011600     05  SW-END-OF-INTRANSIT-DATA       PIC  X(01)  VALUE 'N'.    01160099
011700         88 END-OF-INTRANSIT-DATA                   VALUE 'Y'.    01170099
011800     05  CLASS-MAX-INDX          PIC 9(07) VALUE 500.             01180099
011900     05  DEPT-MAX-INDX           PIC 9(07) VALUE 500.             01190099
012000                                                                  01200099
012100 01  PV-COMPUTE-CLASS-TOTALS.                                     01210099
012200     05  PV-CLASS-RETAIL         PIC S9(13)V99 VALUE ZEROS.       01220099
012300     05  PV-CLASS-COST           PIC S9(13)V99 VALUE ZEROS.       01230099
012400                                                                  01240099
012500 01  PV-COMPUTE-DEPT-TOTALS.                                      01250099
012600     05  PV-DEPT-RETAIL          PIC S9(13)V99 VALUE ZEROS.       01260099
012700     05  PV-DEPT-COST            PIC S9(13)V99 VALUE ZEROS.       01270099
012800                                                                  01280099
012900 01  PC-PROGRAM-COUNTERS.                                         01290099
013000     05  PC-LINE-COUNT           PIC S9(03)    VALUE ZEROES       01300099
013100                                               COMP-3.            01310099
013200     05  PC-MAX-LINES            PIC S9(03)    VALUE +60          01320099
013300                                               COMP-3.            01330099
013400     05  PC-PAGE-COUNT           PIC S9(06)    VALUE ZEROES       01340099
013500                                               COMP-3.            01350099
013600     05  CLASS-SIZE-COUNTER      PIC S9(05)    VALUE ZEROS        01360099
013700                                               COMP-3.            01370099
013800     05  DEPT-SIZE-COUNTER       PIC S9(05)    VALUE ZEROS        01380099
013900                                               COMP-3.            01390099
014000     05  PC-DATA-RECS-READ       PIC 9(10)     VALUE ZEROES.      01400099
014100                                                                  01410099
014200 01  WS-MISC-COUNTS.                                              01420099
014300     05  WS-CLASS-COMPARISONS     PIC S9(04)  VALUE +0 COMP SYNC. 01430099
014400     05  WS-DEPT-COMPARISONS      PIC S9(04)  VALUE +0 COMP SYNC. 01440099
014500     05  WS-CLASS-TABLE-SORT-DATA.                                01450099
014600         10  WS-CLASS-TBL-STR     PIC X(04).                      01460099
014700         10  WS-CLASS-TBL-RETAIL  PIC S9(13)V99 COMP-3.           01470099
014800         10  WS-CLASS-TBL-COST    PIC S9(13)V99 COMP-3.           01480099
014900     05  WS-DEPT-TABLE-SORT-DATA.                                 01490099
015000         10  WS-DEPT-TBL-STR      PIC X(04).                      01500099
015100         10  WS-DEPT-TBL-RETAIL   PIC S9(13)V99 COMP-3.           01510099
015200         10  WS-DEPT-TBL-COST     PIC S9(13)V99 COMP-3.           01520099
015300     05  WS-ABEND-CODE            PIC S9(04)  VALUE +0 COMP.      01530099
015400                                                                  01540099
015500 01  CLASS-TBL.                                                   01550099
015600     05  CLASS-TABLE OCCURS 500 TIMES                             01560099
015700              INDEXED BY CLASS-INDX.                              01570099
015800         10  CT-STORE         PIC X(04).                          01580099
015900         10  CT-TOT-RETAIL    PIC S9(13)V99 COMP-3.               01590099
016000         10  CT-TOT-COST      PIC S9(13)V99 COMP-3.               01600099
016100                                                                  01610099
016200 01  DEPARTMENT-TBL.                                              01620099
016300     05  DEPT-TABLE OCCURS 500 TIMES                              01630099
016400              INDEXED BY DEPT-INDX.                               01640099
016500         10  DT-STORE         PIC X(04).                          01650099
016600         10  DT-TOT-RETAIL    PIC S9(13)V99 COMP-3.               01660099
016700         10  DT-TOT-COST      PIC S9(13)V99 COMP-3.               01670099
016800                                                                  01680099
016900 01  ABEND-CODE                         PIC S9(04) VALUE ZERO     01690099
017000                                                   COMP SYNC.     01700099
017100     88  AC-BAD-WRITE                   VALUE  +4001.             01710099
017200     88  AC-CONTROL-CARD-ERROR          VALUE  +4003.             01720099
017300     88  AC-OPEN-ERROR                  VALUE  +4005.             01730099
017400     88  AC-CLOSE-ERROR                 VALUE  +4006.             01740099
017500     88  AC-BAD-DATA                    VALUE  +4008.             01750099
017600     88  AC-DB2-ERROR                   VALUE  +4013.             01760099
017700     88  AC-UNSUCCESSFUL-SELECT         VALUE  +4015.             01770099
017800     88  AC-MAX-RETRIES-EXCEEDED        VALUE  +4016.             01780099
017900     88  AC-DATE-ERROR                  VALUE  +4019.             01790099
018000                                                                  01800099
018100 01  REPORT-HEADER-1.                                             01810099
018200     05  FILLER               PIC X(42)   VALUE SPACES.           01820099
018300     05  FILLER               PIC X(49)   VALUE                   01830099
018400         'UNJOURNALIZED RECEIPTS REPORT - BY DIV/DEPT/CLASS'.     01840099
018500     05  FILLER               PIC X(42)   VALUE SPACES.           01850099
018600                                                                  01860099
018700 01  REPORT-HEADER-2.                                             01870099
018800     05  FILLER               PIC  X(02)  VALUE SPACES.           01880099
018900     05  FILLER               PIC  X(08)  VALUE 'DIVISION'.       01890099
019000     05  FILLER               PIC  X(01)  VALUE SPACE.            01900099
019100     05  RH2-DIVISION         PIC  X(03)  VALUE SPACE.            01910099
019200     05  FILLER               PIC  X(02)  VALUE SPACE.            01920099
019300     05  FILLER               PIC  X(04)  VALUE 'DEPT'.           01930099
019400     05  FILLER               PIC  X(01)  VALUE SPACE.            01940099
019500     05  RH2-DEPT             PIC  X(03)  VALUE SPACES.           01950099
019600     05  FILLER               PIC  X(02)  VALUE SPACE.            01960099
019700     05  FILLER               PIC  X(05)  VALUE 'CLASS'.          01970099
019800     05  FILLER               PIC  X(01)  VALUE SPACE.            01980099
019900     05  RH2-CLASS            PIC  X(03)  VALUE SPACES.           01990099
020000     05  FILLER               PIC  X(89)  VALUE SPACES.           02000099
020100                                                                  02010099
020200 01  REPORT-HEADER-3.                                             02020099
020300     05  FILLER               PIC X(12)   VALUE SPACES.           02030099
020400     05  FILLER               PIC X(11)   VALUE 'VENDOR NAME'.    02040099
020500     05  FILLER               PIC X(16)   VALUE SPACES.           02050099
020600     05  FILLER               PIC X(09)   VALUE 'PO NUMBER'.      02060099
020700     05  FILLER               PIC X(09)   VALUE SPACES.           02070099
020800     05  FILLER               PIC X(08)   VALUE 'RCVR SEQ'.       02080099
020900     05  FILLER               PIC X(11)   VALUE SPACES.           02090099
021000     05  FILLER               PIC X(04)   VALUE 'DATE'.           02100099
021100     05  FILLER               PIC X(12)   VALUE SPACES.           02110099
021200     05  FILLER               PIC X(05)   VALUE 'STORE'.          02120099
021300     05  FILLER               PIC X(09)   VALUE SPACES.           02130099
021400     05  FILLER               PIC X(06)   VALUE 'RETAIL'.         02140099
021500     05  FILLER               PIC X(12)   VALUE SPACES.           02150099
021600     05  FILLER               PIC X(04)   VALUE 'COST'.           02160099
021700     05  FILLER               PIC X(14)   VALUE SPACES.           02170099
021800                                                                  02180099
021900 01  REPORT-DETAIL-LINE.                                          02190099
022000     05  FILLER               PIC X(05)   VALUE SPACES.           02200099
022100     05  DL-VND-NME           PIC X(30)   VALUE SPACES.           02210099
022200     05  FILLER               PIC X(04)   VALUE SPACES.           02220099
022300     05  DL-PO-NBR            PIC Z(09)   VALUE ZEROS.            02230099
022400     05  FILLER               PIC X(05)   VALUE SPACES.           02240099
022500     05  DL-RCVR-SEQ-NBR      PIC ZZZZZZZZZ VALUE ZEROS.          02250099
022600     05  FILLER               PIC X(11)   VALUE SPACES.           02260099
022700     05  DL-DATE              PIC X(10)   VALUE SPACES.           02270099
022800     05  FILLER               PIC X(09)   VALUE SPACES.           02280099
022900     05  DL-STORE             PIC X(04)   VALUE SPACES.           02290099
023000     05  FILLER               PIC X(04)   VALUE SPACES.           02300099
023100     05  DL-RETAIL            PIC ZZZ,ZZZ,ZZ9.99.                 02310099
023200     05  FILLER               PIC X(03)   VALUE SPACES.           02320099
023300     05  DL-COST              PIC ZZZ,ZZZ,ZZ9.99.                 02330099
023400     05  FILLER               PIC X(10)   VALUE SPACES.           02340099
023500                                                                  02350099
023600 01  REPORT-CLASS-TOTAL.                                          02360099
023700     05  FILLER               PIC X(59)   VALUE SPACES.           02370099
023800     05  FILLER               PIC X(21)   VALUE                   02380099
023900                                      'CLASS TOTALS BY STORE'.    02390099
024000     05  FILLER               PIC X(12)   VALUE SPACES.           02400099
024100     05  RC-STORE-NBR         PIC X(04)   VALUE SPACES.           02410099
024200     05  FILLER               PIC X(02)   VALUE SPACES.           02420099
024300     05  RC-RETAIL-TOTAL      PIC Z,ZZZ,ZZZ,ZZ9.99.               02430099
024400     05  FILLER               PIC X(01)   VALUE SPACES.           02440099
024500     05  RC-COST-TOTAL        PIC Z,ZZZ,ZZZ,ZZ9.99.               02450099
024600     05  FILLER               PIC X(09)   VALUE SPACES.           02460099
024700                                                                  02470099
024800 01  REPORT-GRAND-CLASS-TOTAL.                                    02480099
024900     05  FILLER               PIC X(59)   VALUE SPACES.           02490099
025000     05  FILLER               PIC X(11)   VALUE                   02500099
025100                                      'CLASS TOTAL'.              02510099
025200     05  FILLER               PIC X(28)   VALUE SPACES.           02520099
025300     05  GC-RETAIL-TOTAL      PIC Z,ZZZ,ZZZ,ZZ9.99.               02530099
025400     05  FILLER               PIC X(01)   VALUE SPACES.           02540099
025500     05  GC-COST-TOTAL        PIC Z,ZZZ,ZZZ,ZZ9.99.               02550099
025600     05  FILLER               PIC X(09)   VALUE SPACES.           02560099
025700                                                                  02570099
025800 01  REPORT-DEPARTMENT-TOTAL.                                     02580099
025900     05  FILLER               PIC X(59)   VALUE SPACES.           02590099
026000     05  FILLER               PIC X(26)   VALUE                   02600099
026100                                   'DEPARTMENT TOTALS BY STORE'.  02610099
026200     05  FILLER               PIC X(07)   VALUE SPACES.           02620099
026300     05  RD-STORE-NBR         PIC X(04)   VALUE SPACES.           02630099
026400     05  FILLER               PIC X(02)   VALUE SPACES.           02640099
026500     05  RD-RETAIL-TOTAL      PIC Z,ZZZ,ZZZ,ZZ9.99.               02650099
026600     05  FILLER               PIC X(01)   VALUE SPACES.           02660099
026700     05  RD-COST-TOTAL        PIC Z,ZZZ,ZZZ,ZZ9.99.               02670099
026800     05  FILLER               PIC X(09)   VALUE SPACES.           02680099
026900                                                                  02690099
027000 01  REPORT-GRAND-DEPARTMENT-TOTAL.                               02700099
027100     05  FILLER               PIC X(59)   VALUE SPACES.           02710099
027200     05  FILLER               PIC X(16)   VALUE                   02720099
027300                                              'DEPARTMENT TOTAL'. 02730099
027400     05  FILLER               PIC X(22)   VALUE SPACES.           02740099
027500     05  GD-RETAIL-TOTAL      PIC ZZ,ZZZ,ZZZ,ZZ9.99.              02750099
027600     05  FILLER               PIC X(01)   VALUE SPACES.           02760099
027700     05  GD-COST-TOTAL        PIC Z,ZZZ,ZZZ,ZZ9.99.               02770099
027800     05  FILLER               PIC X(09)   VALUE SPACES.           02780099
027900                                                                  02790099
028000 01  REPORT-BLANK-LINE.                                           02800099
028100     05  FILLER               PIC X(132)  VALUE SPACES.           02810099
028200                                                                  02820099
028300***** REPORT LAYOUT                                               02830099
028400     COPY DPWS132O.                                               02840099
028500                                                                  02850099
028600***** INPUT FILE LAYOUT                                           02860099
028700     COPY APRD042.                                                02870099
028800                                                                  02880099
028900 PROCEDURE DIVISION.                                              02890099
029000 A100-MAINLINE.                                                   02900099
029100                                                                  02910099
029200     PERFORM B100-INITIALIZATION.                                 02920099
029300                                                                  02930099
029400     PERFORM B200-PROCESS-VENDOR-DATA                             02940099
029500             UNTIL END-OF-INTRANSIT-DATA.                         02950099
029600                                                                  02960099
029700     PERFORM B300-TERMINATION.                                    02970099
029800                                                                  02980099
029900     GOBACK.                                                      02990099
030000                                                                  03000099
030100******************************************************************03010099
030200** OPEN INPUT FILE, INITIALIZE VARIABLES, AND DO AN INITIAL     **03020099
030300** READ ON THE INTRANSIT DATA FILE.                             **03030099
030400******************************************************************03040099
030500 B100-INITIALIZATION.                                             03050099
030600                                                                  03060099
030700     OPEN INPUT  INTRANSIT-FILE                                   03070099
030800          OUTPUT REPORT-FILE.                                     03080099
030900                                                                  03090099
031000     INITIALIZE AP042-EXTRACT-FILE                                03100099
031100                CLASS-TBL                                         03110099
031200                DEPARTMENT-TBL.                                   03120099
031300                                                                  03130099
031400     MOVE 'N' TO SW-END-OF-INTRANSIT-DATA.                        03140099
031500                                                                  03150099
031600     ACCEPT PV-CURRENT-DATE FROM DATE.                            03160099
031700     MOVE PV-CURRENT-MONTH            TO DP132O-RUN-MONTH.        03170099
031800     MOVE PV-CURRENT-DAY              TO DP132O-RUN-DAY.          03180099
031900     MOVE PV-CURRENT-YEAR             TO DP132O-RUN-YEAR.         03190099
032000                                                                  03200099
032100     ACCEPT PV-CURRENT-TIME FROM TIME.                            03210099
032200     MOVE PV-CURRENT-HOUR             TO DP132O-RUN-HOUR.         03220099
032300     MOVE PV-CURRENT-MINUTE           TO DP132O-RUN-MINUTE.       03230099
032400     MOVE PV-PROGRAM-NAME             TO DP132O-PROGRAM-NAME.     03240099
032500     MOVE 1                           TO DP132O-REPORT-NUMBER.    03250099
032600                                                                  03260099
032700     PERFORM R100-READ-INTRANSIT-FILE.                            03270099
032800                                                                  03280099
032900     MOVE AP042-DMM-NBR  TO RH2-DIVISION.                         03290099
033000     MOVE AP042-DEPT-NBR TO RH2-DEPT.                             03300099
033100     MOVE AP042-CL-NBR   TO RH2-CLASS.                            03310099
033200                                                                  03320099
033300     PERFORM W100-WRITE-REPORT-HEADINGS.                          03330099
033400     PERFORM W200-WRITE-DIV-DEPT-CLASS.                           03340099
033500                                                                  03350099
033600     MOVE AP042-STR-NBR   TO PV-HOLD-STR-NBR.                     03360099
033700     MOVE AP042-DMM-NBR   TO PV-HOLD-DMM-NBR.                     03370099
033800     MOVE AP042-DEPT-NBR  TO PV-HOLD-DEPT-NBR.                    03380099
033900     MOVE AP042-CL-NBR    TO PV-HOLD-CL-NBR.                      03390099
034000     MOVE AP042-CALCD-VRFD-RTL-AMT  TO PV-HOLD-RTL-AMT.           03400099
034100     MOVE AP042-CALCD-VRFD-COST-AMT TO PV-HOLD-COST-AMT.          03410099
034200                                                                  03420099
034300******************************************************************03430099
034400** CHECK FOR CHANGE IN EITHER DIVISION, DEPARTMENT OR CLASS     **03440099
034500** NUMBER.  IF CHANGE EXISTS, WRITE OUT TOTALS OTHERWISE        **03450099
034600** CONTINUE PROCESSING THE NEXT RECORD.                         **03460099
034700******************************************************************03470099
034800 B200-PROCESS-VENDOR-DATA.                                        03480099
034900                                                                  03490099
035000     IF AP042-DMM-NBR  NOT = PV-HOLD-DMM-NBR OR                   03500099
035100        AP042-DEPT-NBR NOT = PV-HOLD-DEPT-NBR OR                  03510099
035200        AP042-CL-NBR   NOT = PV-HOLD-CL-NBR                       03520099
035300        MOVE 99 TO PC-LINE-COUNT                                  03530099
035400     END-IF.                                                      03540099
035500                                                                  03550099
035600     MOVE AP042-STR-NBR             TO PV-HOLD-STR-NBR.           03560099
035700     MOVE AP042-DMM-NBR             TO PV-HOLD-DMM-NBR.           03570099
035800     MOVE AP042-DEPT-NBR            TO PV-HOLD-DEPT-NBR.          03580099
035900     MOVE AP042-CL-NBR              TO PV-HOLD-CL-NBR.            03590099
036000     MOVE AP042-PO-NBR              TO PV-HOLD-PO-NBR.            03600099
036100     MOVE AP042-REC-SEQ-NBR         TO PV-HOLD-REC-SEQ-NBR.       03610099
036200     MOVE AP042-VRFD-DTE            TO PV-HOLD-VRFD-DTE.          03620099
036300     MOVE AP042-ENT-NM-DESC         TO PV-HOLD-ENT-NM-DESC.       03630099
036400                                                                  03640099
036500     MOVE AP042-DMM-NBR  TO RH2-DIVISION.                         03650099
036600     MOVE AP042-DEPT-NBR TO RH2-DEPT.                             03660099
036700     MOVE AP042-CL-NBR   TO RH2-CLASS.                            03670099
036800                                                                  03680099
036900     SET CLASS-NOT-FOUND TO TRUE.                                 03690099
037000     PERFORM C100-CREATE-CLASS-TABLE                              03700099
037100        VARYING CLASS-INDX FROM 1 BY 1                            03710099
037200            UNTIL CLASS-FOUND OR CLASS-INDX > CLASS-MAX-INDX      03720099
037300                                                                  03730099
037400     SET DEPT-NOT-FOUND TO TRUE.                                  03740099
037500     PERFORM C200-CREATE-DEPARTMENT-TABLE                         03750099
037600        VARYING DEPT-INDX FROM 1 BY 1                             03760099
037700            UNTIL DEPT-FOUND OR DEPT-INDX > DEPT-MAX-INDX         03770099
037800                                                                  03780099
037900     PERFORM R100-READ-INTRANSIT-FILE.                            03790099
038000                                                                  03800099
038100     IF AP042-PO-NBR      = PV-HOLD-PO-NBR AND                    03810099
038200        AP042-REC-SEQ-NBR = PV-HOLD-REC-SEQ-NBR AND               03820099
038300        AP042-VRFD-DTE    = PV-HOLD-VRFD-DTE                      03830099
038400        ADD AP042-CALCD-VRFD-RTL-AMT  TO PV-HOLD-RTL-AMT          03840099
038500        ADD AP042-CALCD-VRFD-COST-AMT TO PV-HOLD-COST-AMT         03850099
038600        SET STORE-FLAG                TO TRUE                     03860099
038700     ELSE                                                         03870099
038800        MOVE PV-HOLD-ENT-NM-DESC      TO DL-VND-NME               03880099
038900        MOVE PV-HOLD-PO-NBR           TO DL-PO-NBR                03890099
039000        MOVE PV-HOLD-REC-SEQ-NBR      TO DL-RCVR-SEQ-NBR          03900099
039100        MOVE PV-HOLD-VRFD-DTE         TO PV-DATE-HOLD             03910099
039200        MOVE PV-HOLD-CCYY             TO PV-DATE-CCYY             03920099
039300        MOVE PV-HOLD-MO               TO PV-DATE-MO               03930099
039400        MOVE PV-HOLD-DAY              TO PV-DATE-DAY              03940099
039500        MOVE PV-DATE-RESTRUCTURE      TO DL-DATE                  03950099
039600        MOVE PV-HOLD-RTL-AMT          TO DL-RETAIL                03960099
039700        MOVE PV-HOLD-COST-AMT         TO DL-COST                  03970099
039800        IF STORE-FLAG                                             03980099
039900           MOVE '0000'                TO DL-STORE                 03990099
040000           MOVE AP042-CALCD-VRFD-RTL-AMT  TO PV-HOLD-RTL-AMT      04000099
040100           MOVE AP042-CALCD-VRFD-COST-AMT TO PV-HOLD-COST-AMT     04010099
040200        ELSE                                                      04020099
040300           MOVE PV-HOLD-STR-NBR       TO DL-STORE                 04030099
040400           MOVE AP042-CALCD-VRFD-RTL-AMT  TO PV-HOLD-RTL-AMT      04040099
040500           MOVE AP042-CALCD-VRFD-COST-AMT TO PV-HOLD-COST-AMT     04050099
040600        END-IF                                                    04060099
040700        PERFORM W300-WRITE-REPORT-DETAIL-LINE                     04070099
040800        SET NOT-STORE-FLAG            TO TRUE                     04080099
040900     END-IF.                                                      04090099
041000                                                                  04100099
041100     IF AP042-DMM-NBR   NOT = PV-HOLD-DMM-NBR  OR                 04110099
041200        AP042-DEPT-NBR  NOT = PV-HOLD-DEPT-NBR OR                 04120099
041300        AP042-CL-NBR    NOT = PV-HOLD-CL-NBR                      04130099
041400                                                                  04140099
041500****   SORTS CLASS TABLE IN STORE SEQUENCE                        04150099
041600        SET WS-CLASS-BBL-SORT-NOT-COMPLETE TO TRUE                04160099
041700        COMPUTE WS-CLASS-COMPARISONS = CLASS-SIZE-COUNTER - 1     04170099
041800        PERFORM C300-SORT-CLASS-TABLE                             04180099
041900            UNTIL WS-CLASS-BBL-SORT-COMPLETE                      04190099
042000               OR WS-CLASS-COMPARISONS = 0                        04200099
042100                                                                  04210099
042200        SET CLASS-INDX TO 1                                       04220099
042300        PERFORM UNTIL CLASS-INDX > CLASS-SIZE-COUNTER             04230099
042400           MOVE CT-STORE (CLASS-INDX)     TO RC-STORE-NBR         04240099
042500           MOVE CT-TOT-RETAIL(CLASS-INDX) TO RC-RETAIL-TOTAL      04250099
042600           MOVE CT-TOT-COST (CLASS-INDX)  TO RC-COST-TOTAL        04260099
042700           SET CLASS-INDX UP BY 1                                 04270099
042800           PERFORM W400-WRITE-CLASS-TOTALS                        04280099
042900           SET NOT-FIRST-RUN TO TRUE                              04290099
043000        END-PERFORM                                               04300099
043100        PERFORM W500-WRITE-GRAND-CLASS-TOTALS                     04310099
043200        PERFORM W800-WRITE-BLANK-LINE                             04320099
043300        INITIALIZE CLASS-TBL                                      04330099
043400        SET FIRST-RUN  TO TRUE                                    04340099
043500        SET CLASS-INDX TO 1                                       04350099
043600        MOVE 0         TO CLASS-SIZE-COUNTER                      04360099
043700     END-IF.                                                      04370099
043800                                                                  04380099
043900     IF AP042-DEPT-NBR NOT = PV-HOLD-DEPT-NBR                     04390099
044000                                                                  04400099
044100****   SORTS DEPARTMENT TABLE IN STORE SEQUENCE                   04410099
044200        SET WS-DEPT-BBL-SORT-NOT-COMPLETE TO TRUE                 04420099
044300        COMPUTE WS-DEPT-COMPARISONS = DEPT-SIZE-COUNTER - 1       04430099
044400        PERFORM C500-SORT-DEPT-TABLE                              04440099
044500            UNTIL WS-DEPT-BBL-SORT-COMPLETE                       04450099
044600               OR WS-DEPT-COMPARISONS = 0                         04460099
044700                                                                  04470099
044800        SET DEPT-INDX TO 1                                        04480099
044900        PERFORM UNTIL DEPT-INDX > DEPT-SIZE-COUNTER               04490099
045000           MOVE DT-STORE (DEPT-INDX)      TO RD-STORE-NBR         04500099
045100           MOVE DT-TOT-RETAIL (DEPT-INDX) TO RD-RETAIL-TOTAL      04510099
045200           MOVE DT-TOT-COST (DEPT-INDX)   TO RD-COST-TOTAL        04520099
045300           SET DEPT-INDX UP BY 1                                  04530099
045400           PERFORM W600-WRITE-DEPARTMENT-TOTALS                   04540099
045500        END-PERFORM                                               04550099
045600        PERFORM W700-WRITE-GRAND-DEPT-TOTALS                      04560099
045700        INITIALIZE DEPARTMENT-TBL                                 04570099
045800        SET DEPT-INDX TO 1                                        04580099
045900        MOVE 0        TO DEPT-SIZE-COUNTER                        04590099
046000     END-IF.                                                      04600099
046100                                                                  04610099
046200******************************************************************04620099
046300**  CLOSE THE OUTPUT FILES.                                     **04630099
046400******************************************************************04640099
046500 B300-TERMINATION.                                                04650099
046600                                                                  04660099
046700     DISPLAY '**** PROGRAM APKRP184 COMPLETED NORMALLY **'.       04670099
046800     DISPLAY ' INTRANSIT RECS READ   =  ' PC-DATA-RECS-READ.      04680099
046900                                                                  04690099
047000     CLOSE INTRANSIT-FILE                                         04700099
047100           REPORT-FILE.                                           04710099
047200                                                                  04720099
047300******************************************************************04730099
047400** ADD ENTRIES TO THE CLASS TABLE FOR THE CURRENT RECORD READ   **04740099
047500******************************************************************04750099
047600 C100-CREATE-CLASS-TABLE.                                         04760099
047700                                                                  04770099
047800     IF AP042-STR-NBR = CT-STORE (CLASS-INDX)                     04780099
047900        MOVE AP042-STR-NBR             TO CT-STORE (CLASS-INDX)   04790099
048000        ADD AP042-CALCD-VRFD-RTL-AMT   TO                         04800099
048100                                        CT-TOT-RETAIL (CLASS-INDX)04810099
048200        ADD AP042-CALCD-VRFD-COST-AMT  TO                         04820099
048300                                         CT-TOT-COST (CLASS-INDX) 04830099
048400        ADD AP042-CALCD-VRFD-RTL-AMT   TO PV-CLASS-RETAIL         04840099
048500        ADD AP042-CALCD-VRFD-COST-AMT  TO PV-CLASS-COST           04850099
048600        SET CLASS-FOUND                TO TRUE                    04860099
048700     ELSE                                                         04870099
048800        IF CT-STORE (CLASS-INDX) = SPACES                         04880099
048900           ADD 1 TO CLASS-SIZE-COUNTER                            04890099
049000           MOVE AP042-STR-NBR             TO CT-STORE (CLASS-INDX)04900099
049100           MOVE AP042-CALCD-VRFD-RTL-AMT  TO                      04910099
049200                                        CT-TOT-RETAIL (CLASS-INDX)04920099
049300           MOVE AP042-CALCD-VRFD-COST-AMT TO                      04930099
049400                                          CT-TOT-COST (CLASS-INDX)04940099
049500           ADD CT-TOT-RETAIL (CLASS-INDX) TO PV-CLASS-RETAIL      04950099
049600           ADD CT-TOT-COST   (CLASS-INDX) TO PV-CLASS-COST        04960099
049700           SET CLASS-FOUND                TO TRUE                 04970099
049800        END-IF                                                    04980099
049900     END-IF.                                                      04990099
050000                                                                  05000099
050100** PROGRAM WILL ABEND IF THE CLASS TABLE IS FULL.                 05010099
050200     IF CLASS-INDX > CLASS-MAX-INDX                               05020099
050300        DISPLAY 'CLASS INTERNAL TABLE FULL, INCREASE TABLE SIZE'  05030099
050400        PERFORM Z999-ABEND                                        05040099
050500     END-IF.                                                      05050099
050600                                                                  05060099
050700******************************************************************05070099
050800** ADD ENTRIES TO THE CLASS TABLE FOR THE CURRENT RECORD READ   **05080099
050900******************************************************************05090099
051000 C200-CREATE-DEPARTMENT-TABLE.                                    05100099
051100                                                                  05110099
051200     IF AP042-STR-NBR = DT-STORE (DEPT-INDX)                      05120099
051300        MOVE AP042-STR-NBR             TO DT-STORE (DEPT-INDX)    05130099
051400        ADD AP042-CALCD-VRFD-RTL-AMT   TO                         05140099
051500                                        DT-TOT-RETAIL (DEPT-INDX) 05150099
051600        ADD AP042-CALCD-VRFD-COST-AMT  TO DT-TOT-COST (DEPT-INDX) 05160099
051700        ADD AP042-CALCD-VRFD-RTL-AMT   TO PV-DEPT-RETAIL          05170099
051800        ADD AP042-CALCD-VRFD-COST-AMT  TO PV-DEPT-COST            05180099
051900        SET DEPT-FOUND                 TO TRUE                    05190099
052000     ELSE                                                         05200099
052100        IF DT-STORE (DEPT-INDX) = SPACES                          05210099
052200           ADD 1 TO DEPT-SIZE-COUNTER                             05220099
052300           MOVE AP042-STR-NBR             TO DT-STORE (DEPT-INDX) 05230099
052400           MOVE AP042-CALCD-VRFD-RTL-AMT  TO                      05240099
052500                                        DT-TOT-RETAIL (DEPT-INDX) 05250099
052600           MOVE AP042-CALCD-VRFD-COST-AMT TO                      05260099
052700                                        DT-TOT-COST (DEPT-INDX)   05270099
052800           ADD AP042-CALCD-VRFD-RTL-AMT   TO PV-DEPT-RETAIL       05280099
052900           ADD AP042-CALCD-VRFD-COST-AMT  TO PV-DEPT-COST         05290099
053000           SET DEPT-FOUND                 TO TRUE                 05300099
053100        END-IF                                                    05310099
053200     END-IF.                                                      05320099
053300                                                                  05330099
053400** PROGRAM WILL ABEND IF THE DEPARTMENT TABLE IS FULL.            05340099
053500     IF DEPT-INDX > DEPT-MAX-INDX                                 05350099
053600        DISPLAY 'DEPT INTERNAL TABLE FULL, INCREASE TABLE SIZE'   05360099
053700        PERFORM Z999-ABEND                                        05370099
053800     END-IF.                                                      05380099
053900                                                                  05390099
054000******************************************************************05400099
054100** BUBBLE SORT THE CLASS TABLE BY STORE                         **05410099
054200******************************************************************05420099
054300 C300-SORT-CLASS-TABLE.                                           05430099
054400     SET WS-CLASS-BBL-SORT-COMPLETE TO TRUE.                      05440099
054500     SET CLASS-INDX           TO 1.                               05450099
054600     PERFORM C400-COMPARE-CLASS-TBL-ENTRIES                       05460099
054700         UNTIL CLASS-INDX > WS-CLASS-COMPARISONS.                 05470099
054800     SUBTRACT 1 FROM WS-CLASS-COMPARISONS.                        05480099
054900                                                                  05490099
055000 C400-COMPARE-CLASS-TBL-ENTRIES.                                  05500099
055100     IF  CT-STORE (CLASS-INDX) > CT-STORE (CLASS-INDX + 1)        05510099
055200         MOVE CLASS-TABLE (CLASS-INDX)                            05520099
055300                            TO WS-CLASS-TABLE-SORT-DATA           05530099
055400         MOVE CLASS-TABLE (CLASS-INDX + 1)                        05540099
055500                            TO CLASS-TABLE (CLASS-INDX)           05550099
055600         MOVE WS-CLASS-TABLE-SORT-DATA                            05560099
055700                            TO CLASS-TABLE (CLASS-INDX + 1)       05570099
055800                                                                  05580099
055900         SET WS-CLASS-BBL-SORT-NOT-COMPLETE TO TRUE               05590099
056000     END-IF.                                                      05600099
056100     SET CLASS-INDX UP BY 1.                                      05610099
056200                                                                  05620099
056300******************************************************************05630099
056400** BUBBLE SORT THE DEPARTMENT TABLE BY STORE                    **05640099
056500******************************************************************05650099
056600 C500-SORT-DEPT-TABLE.                                            05660099
056700     SET WS-DEPT-BBL-SORT-COMPLETE TO TRUE.                       05670099
056800     SET DEPT-INDX           TO 1.                                05680099
056900     PERFORM C600-COMPARE-DEPT-TBL-ENTRIES                        05690099
057000         UNTIL DEPT-INDX > WS-DEPT-COMPARISONS.                   05700099
057100     SUBTRACT 1 FROM WS-DEPT-COMPARISONS.                         05710099
057200                                                                  05720099
057300 C600-COMPARE-DEPT-TBL-ENTRIES.                                   05730099
057400     IF  DT-STORE (DEPT-INDX) > DT-STORE (DEPT-INDX + 1)          05740099
057500         MOVE DEPT-TABLE (DEPT-INDX)                              05750099
057600                            TO WS-DEPT-TABLE-SORT-DATA            05760099
057700         MOVE DEPT-TABLE (DEPT-INDX + 1)                          05770099
057800                            TO DEPT-TABLE (DEPT-INDX)             05780099
057900         MOVE WS-DEPT-TABLE-SORT-DATA                             05790099
058000                            TO DEPT-TABLE (DEPT-INDX + 1)         05800099
058100                                                                  05810099
058200         SET WS-DEPT-BBL-SORT-NOT-COMPLETE TO TRUE                05820099
058300     END-IF.                                                      05830099
058400     SET DEPT-INDX UP BY 1.                                       05840099
058500                                                                  05850099
058600******************************************************************05860099
058700** READ INPUT INTRANSIT FILE                                    **05870099
058800******************************************************************05880099
058900 R100-READ-INTRANSIT-FILE.                                        05890099
059000                                                                  05900099
059100     INITIALIZE AP042-EXTRACT-FILE.                               05910099
059200                                                                  05920099
059300     READ INTRANSIT-FILE INTO AP042-EXTRACT-FILE                  05930099
059400        AT END                                                    05940099
059500        SET END-OF-INTRANSIT-DATA TO TRUE.                        05950099
059600                                                                  05960099
059700     IF NOT END-OF-INTRANSIT-DATA                                 05970099
059800        ADD 1 TO PC-DATA-RECS-READ.                               05980099
059900                                                                  05990099
060000******************************************************************06000099
060100** WRITE REPORT HEADINGS                                        **06010099
060200******************************************************************06020099
060300 W100-WRITE-REPORT-HEADINGS.                                      06030099
060400                                                                  06040099
060500     ADD 1                            TO PC-PAGE-COUNT.           06050099
060600     MOVE PC-PAGE-COUNT               TO DP132O-PAGE-NUMBER.      06060099
060700                                                                  06070099
060800     WRITE REPORT-RECORD                                          06080099
060900           FROM DP132O-STANDRD-HEADER-132-COLS AFTER PAGE.        06090099
061000     WRITE REPORT-RECORD FROM REPORT-HEADER-1 AFTER 1.            06100099
061100                                                                  06110099
061200     MOVE SPACES TO REPORT-RECORD.                                06120099
061300     WRITE REPORT-RECORD AFTER 1.                                 06130099
061400     MOVE 5  TO PC-LINE-COUNT.                                    06140099
061500                                                                  06150099
061600******************************************************************06160099
061700** WRITE THE DIVISION, DEPARTMENT, AND CLASS VALUES             **06170099
061800******************************************************************06180099
061900 W200-WRITE-DIV-DEPT-CLASS.                                       06190099
062000                                                                  06200099
062100     IF PC-LINE-COUNT > PC-MAX-LINES                              06210099
062200         PERFORM W100-WRITE-REPORT-HEADINGS                       06220099
062300         PERFORM W200-WRITE-DIV-DEPT-CLASS                        06230099
062400     END-IF.                                                      06240099
062500                                                                  06250099
062600     WRITE REPORT-RECORD  FROM REPORT-HEADER-2 AFTER 2.           06260099
062700     WRITE REPORT-RECORD  FROM REPORT-HEADER-3 AFTER 1.           06270099
062800                                                                  06280099
062900     ADD 2 TO PC-LINE-COUNT.                                      06290099
063000                                                                  06300099
063100******************************************************************06310099
063200** WRITE THE DETAIL LINE FOR THE RECORD PREVIOUSLY READ         **06320099
063300******************************************************************06330099
063400 W300-WRITE-REPORT-DETAIL-LINE.                                   06340099
063500                                                                  06350099
063600     IF PC-LINE-COUNT > PC-MAX-LINES                              06360099
063700         PERFORM W100-WRITE-REPORT-HEADINGS                       06370099
063800         PERFORM W200-WRITE-DIV-DEPT-CLASS                        06380099
063900     END-IF.                                                      06390099
064000                                                                  06400099
064100     WRITE REPORT-RECORD FROM REPORT-DETAIL-LINE AFTER 1.         06410099
064200                                                                  06420099
064300     ADD 1 TO PC-LINE-COUNT.                                      06430099
064400                                                                  06440099
064500*    INITIALIZE REPORT-DETAIL-LINE.                               06450099
064600                                                                  06460099
064700******************************************************************06470099
064800** WRITE THE CLASS TOTALS FOR EACH STORE PROCESSED              **06480099
064900******************************************************************06490099
065000 W400-WRITE-CLASS-TOTALS.                                         06500099
065100                                                                  06510099
065200     IF PC-LINE-COUNT > PC-MAX-LINES                              06520099
065300         PERFORM W100-WRITE-REPORT-HEADINGS                       06530099
065400         PERFORM W200-WRITE-DIV-DEPT-CLASS                        06540099
065500     END-IF.                                                      06550099
065600                                                                  06560099
065700     IF FIRST-RUN                                                 06570099
065800        PERFORM W800-WRITE-BLANK-LINE                             06580099
065900     END-IF.                                                      06590099
066000                                                                  06600099
066100     WRITE REPORT-RECORD FROM REPORT-CLASS-TOTAL AFTER 1.         06610099
066200                                                                  06620099
066300     ADD 1 TO PC-LINE-COUNT.                                      06630099
066400                                                                  06640099
066500*    INITIALIZE REPORT-CLASS-TOTAL.                               06650099
066600                                                                  06660099
066700******************************************************************06670099
066800** WRITE THE CLASS GRAND TOTALS FOR EACH STORE PROCESSED        **06680099
066900******************************************************************06690099
067000 W500-WRITE-GRAND-CLASS-TOTALS.                                   06700099
067100                                                                  06710099
067200     IF PC-LINE-COUNT > PC-MAX-LINES                              06720099
067300         PERFORM W100-WRITE-REPORT-HEADINGS                       06730099
067400         PERFORM W200-WRITE-DIV-DEPT-CLASS                        06740099
067500     END-IF.                                                      06750099
067600                                                                  06760099
067700     MOVE PV-CLASS-RETAIL TO GC-RETAIL-TOTAL.                     06770099
067800     MOVE PV-CLASS-COST   TO GC-COST-TOTAL.                       06780099
067900                                                                  06790099
068000     WRITE REPORT-RECORD FROM REPORT-GRAND-CLASS-TOTAL AFTER 2.   06800099
068100                                                                  06810099
068200     ADD 2 TO PC-LINE-COUNT.                                      06820099
068300                                                                  06830099
068400     INITIALIZE REPORT-CLASS-TOTAL                                06840099
068500                PV-CLASS-RETAIL                                   06850099
068600                PV-CLASS-COST.                                    06860099
068700                                                                  06870099
068800******************************************************************06880099
068900** WRITE THE DEPARTMENT TOTALS FOR EACH STORE PROCESSED         **06890099
069000******************************************************************06900099
069100 W600-WRITE-DEPARTMENT-TOTALS.                                    06910099
069200                                                                  06920099
069300     IF PC-LINE-COUNT > PC-MAX-LINES                              06930099
069400         PERFORM W100-WRITE-REPORT-HEADINGS                       06940099
069500         PERFORM W200-WRITE-DIV-DEPT-CLASS                        06950099
069600     END-IF.                                                      06960099
069700                                                                  06970099
069800     WRITE REPORT-RECORD FROM REPORT-DEPARTMENT-TOTAL AFTER 1.    06980099
069900                                                                  06990099
070000     ADD 1 TO PC-LINE-COUNT.                                      07000099
070100                                                                  07010099
070200******************************************************************07020099
070300** WRITE THE DEPARTMENT GRAND TOTALS FOR EACH STORE PROCESSED   **07030099
070400******************************************************************07040099
070500 W700-WRITE-GRAND-DEPT-TOTALS.                                    07050099
070600                                                                  07060099
070700     IF PC-LINE-COUNT > PC-MAX-LINES                              07070099
070800         PERFORM W100-WRITE-REPORT-HEADINGS                       07080099
070900         PERFORM W200-WRITE-DIV-DEPT-CLASS                        07090099
071000     END-IF.                                                      07100099
071100                                                                  07110099
071200     MOVE PV-DEPT-RETAIL TO GD-RETAIL-TOTAL.                      07120099
071300     MOVE PV-DEPT-COST   TO GD-COST-TOTAL.                        07130099
071400                                                                  07140099
071500     WRITE REPORT-RECORD FROM REPORT-GRAND-DEPARTMENT-TOTAL       07150099
071600                                           AFTER 2.               07160099
071700                                                                  07170099
071800     ADD 2 TO PC-LINE-COUNT.                                      07180099
071900                                                                  07190099
072000     INITIALIZE REPORT-CLASS-TOTAL                                07200099
072100                PV-DEPT-RETAIL                                    07210099
072200                PV-DEPT-COST.                                     07220099
072300                                                                  07230099
072400******************************************************************07240099
072500** PRINTS A BLANK LINE AS NEEDED                                **07250099
072600******************************************************************07260099
072700 W800-WRITE-BLANK-LINE.                                           07270099
072800                                                                  07280099
072900     WRITE REPORT-RECORD FROM REPORT-BLANK-LINE AFTER 1.          07290099
073000                                                                  07300099
073100     ADD 1 TO PC-LINE-COUNT.                                      07310099
073200                                                                  07320099
073300                                                                  07330099
073400****************************************************************  07340099
073500** ABEND ROUTINE                                              **  07350099
073600****************************************************************  07360099
073700 Z999-ABEND.                                                      07370099
073800                                                                  07380099
073900     CLOSE INTRANSIT-FILE                                         07390099
074000           REPORT-FILE.                                           07400099
074100                                                                  07410099
074200     DISPLAY 'APKRP184 ABENDS ABNORMALLY'                         07420099
074300                                                                  07430099
074400     CALL 'ILBOABN0' USING ABEND-CODE.                            07440099
074500                                                                  07450099
