000100 IDENTIFICATION DIVISION.                                         02/12/96
000200 PROGRAM-ID.    TRKCS141.                                         TRKCS141
000300 AUTHOR.        TOM RUSKA. G&R.                                      LV004
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          TRKCS141
000500 DATE-WRITTEN.  05/26/93.                                         TRKCS141
000600 DATE-COMPILED.                                                   TRKCS141
000700                                                                  TRKCS141
000800******************************************************************TRKCS141
000900*  TRKCS141 - TRANID = Y141                                      *TRKCS141
001000*                                                                *TRKCS141
001100*  THIS PROGRAM WILL PRINT THE FREIGHT BILL RECEIVER LIST REPORT.*TRKCS141
001200*  THE PRINT LINES WILL BE ROUTED TO THE PRINTER THRU DRS.       *TRKCS141
001300******************************************************************TRKCS141
001400                                                                  TRKCS141
001500 ENVIRONMENT DIVISION.                                            TRKCS141
001600 DATA DIVISION.                                                   TRKCS141
001700                                                                  TRKCS141
001800/                                                                 TRKCS141
001900 WORKING-STORAGE SECTION.                                         TRKCS141
002000 01  FILLER                           PIC X(36)  VALUE            TRKCS141
002100     'TRKCS141 WORKING STORAGE STARTS HERE'.                      TRKCS141
002200                                                                  TRKCS141
002300*                                                                 TRKCS141
002400*  STANDARD ATTENTION IDENTIFIER LIST                             TRKCS141
002500*                                                                 TRKCS141
002600     COPY DFHAID.                                                 TRKCS141
002700/                                                                 TRKCS141
002800                                                                  TRKCS141
002900*                                                                 TRKCS141
003000* COPIES FOR THE PROGRAM DRS1INTC WORK FIELDS.                    TRKCS141
003100*                                                                 TRKCS141
003200     COPY DRRD001O.                                               TRKCS141
003300     COPY DRRD002O.                                               TRKCS141
003400/                                                                 TRKCS141
003500                                                                  TRKCS141
003600*                                                                 TRKCS141
003700*  RECORD LAYOUT FOR THE REPORT HEADER                            TRKCS141
003800*                                                                 TRKCS141
003900     COPY DPWS075O.                                               TRKCS141
004000                                                                  TRKCS141
004100 01  IE-DRS-ERROR-MSG.                                            TRKCS141
004200     05  FILLER                       PIC X(41)  VALUE            TRKCS141
004300     'A DRS ERROR HAS OCCURRED  - CONTACT DP - '.                 TRKCS141
004400     05  FILLER                       PIC X(44)  VALUE            TRKCS141
004500     'PROGRAM TRKCS141'.                                          TRKCS141
004600     05  FILLER                       PIC X(11)  VALUE            TRKCS141
004700     'FUNCTION = '.                                               TRKCS141
004800     05  IE-DRS-FUNC                  PIC X(04)  VALUE SPACE.     TRKCS141
004900     05  FILLER                       PIC X(14)  VALUE            TRKCS141
005000     'RETURN CODE = '.                                            TRKCS141
005100     05  IE-DRS-RC                    PIC X(04)  VALUE SPACES.    TRKCS141
005200                                                                  TRKCS141
005300 01  IE-DB2-ERROR-MSG.                                            TRKCS141
005400     05  FILLER                       PIC X(41)  VALUE            TRKCS141
005500     'AN DB2 ERROR HAS OCCURRED - CONTACT DP - '.                 TRKCS141
005600     05  FILLER                       PIC X(44)  VALUE            TRKCS141
005700     'PROGRAM TRKCS141'.                                          TRKCS141
005800     05  IE-ATTEMPTED-ACTION          PIC X(80)  VALUE SPACE.     TRKCS141
005900                                                                  TRKCS141
006000/                                                                 TRKCS141
006100*                                                                 TRKCS141
006200*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               TRKCS141
006300*                                                                 TRKCS141
006400     COPY DPWS013.                                                TRKCS141
006500                                                                  TRKCS141
006600 01  H1-HEADING-LINE1.                                            TRKCS141
006700     05  FILLER                       PIC X(25)  VALUE SPACES.    TRKCS141
006800     05  FILLER                       PIC X(28)  VALUE            TRKCS141
006900         'FREIGHT BILL ALLOCATION LIST'.                          TRKCS141
007000     05  FILLER                       PIC X(27)  VALUE SPACES.    TRKCS141
007100                                                                  TRKCS141
007200 01  H2-HEADING-LINE2.                                            TRKCS141
007300     05  FILLER                       PIC X(17)  VALUE            TRKCS141
007400         ' INVOICE NUMBER: '.                                     TRKCS141
007500     05  H2-INVOICE                   PIC X(15)  VALUE SPACES.    TRKCS141
007600     05  FILLER                       PIC X(15)  VALUE            TRKCS141
007700         ' PROCESS DATE: '.                                       TRKCS141
007800     05  H2-MM                        PIC X(02)  VALUE SPACES.    TRKCS141
007900     05  FILLER                       PIC X(01)  VALUE '/'.       TRKCS141
008000     05  H2-DD                        PIC X(02)  VALUE SPACES.    TRKCS141
008100     05  FILLER                       PIC X(01)  VALUE '/'.       TRKCS141
008200     05  H2-YY                        PIC X(04)  VALUE SPACES.    TRKCS141
008300     05  FILLER                       PIC X(15)  VALUE            TRKCS141
008400         ' ORIG CARRIER: '.                                       TRKCS141
008500     05  H2-ORIG-SCAC                 PIC X(04)  VALUE SPACES.    TRKCS141
008600     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
008700                                                                  TRKCS141
008800 01  H3-HEADING-LINE3.                                            TRKCS141
008900     05  FILLER                       PIC X(18)  VALUE            TRKCS141
009000         ' FREIGHT BILL...: '.                                    TRKCS141
009100     05  H3-PRO-NBR                   PIC X(22)  VALUE SPACES.    TRKCS141
009200     05  FILLER                       PIC X(12)  VALUE            TRKCS141
009300         ' DLVY CARR: '.                                          TRKCS141
009400     05  H3-SCAC                      PIC X(04)  VALUE SPACES.    TRKCS141
009500     05  FILLER                       PIC X(12)  VALUE            TRKCS141
009600         '   TRAILER: '.                                          TRKCS141
009700     05  H3-TRLR-ID                   PIC X(10)  VALUE SPACES.    TRKCS141
009800     05  FILLER                       PIC X(02)  VALUE SPACES.    TRKCS141
009900                                                                  TRKCS141
010000 01  H4-HEADING-LINE4.                                            TRKCS141
010100     05  FILLER                       PIC X(18)  VALUE            TRKCS141
010200         ' FREIGHT CHARGES: '.                                    TRKCS141
010300     05  H4-FRGT-CHG-AMT              PIC ZZZZZ9.99 VALUE ZEROES. TRKCS141
010400     05  FILLER                       PIC X(19)  VALUE            TRKCS141
010500         '          TERMS..: '.                                   TRKCS141
010600     05  H4-TERMS                     PIC X(04)  VALUE SPACES.    TRKCS141
010700     05  FILLER                       PIC X(12)  VALUE            TRKCS141
010800         '   WEIGHT.: '.                                          TRKCS141
010900     05  H4-EXPTED-GRO-WGHT           PIC ZZZZZ9 VALUE ZEROES.    TRKCS141
011000     05  FILLER                       PIC X(20)  VALUE SPACES.    TRKCS141
011100                                                                  TRKCS141
011200 01  H5-HEADING-LINE5.                                            TRKCS141
011300     05  FILLER                       PIC X(44)  VALUE            TRKCS141
011410         '    PO              RCV                   CA'.          TRKCS141
011500     05  FILLER                       PIC X(40)  VALUE            TRKCS141
011600         'RTON   ADJSTD  DAMAGED                  '.              TRKCS141
011700                                                                  TRKCS141
011800 01  H6-HEADING-LINE6.                                            TRKCS141
011900     05  FILLER                       PIC X(44)  VALUE            TRKCS141
012010         '  NUMBER      DC    SEQ     DEPT   CL     CO'.          TRKCS141
012100     05  FILLER                       PIC X(40)  VALUE            TRKCS141
012200         'UNT    COUNT   CARTONS    CHARGES       '.              TRKCS141
012300                                                                  TRKCS141
012400 01  D1-DETAIL-LINE1.                                             TRKCS141
012500     05  FILLER                       PIC X(02)  VALUE SPACES.    TRKCS141
012600     05  D1-PO-NBR                    PIC 9(08)  VALUE ZEROES.    TRKCS141
012701     05  FILLER                       PIC X(03)  VALUE SPACES.    TRKCS141
012710     05  D1-DC-NBR                    PIC X(04)  VALUE SPACES.            
012720     05  FILLER                       PIC X(03)  VALUE SPACES.            
012800     05  D1-REC-SEQ-NBR               PIC X(04)  VALUE SPACES.    TRKCS141
012910     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
013000     05  D1-DEPT                      PIC 9(04)  VALUE ZEROES.    TRKCS141
013001     05  FILLER                       PIC X(02)  VALUE SPACES.    TRKCS141
013002     05  D1-CLASS                     PIC 9(04)  VALUE ZEROES.    TRKCS141
013110     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
013200     05  D1-CARTON-CNT                PIC ZZZZ9  VALUE ZEROES.    TRKCS141
013310     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
013400     05  D1-ACTL-CNT                  PIC ZZZZ9  VALUE ZEROES.    TRKCS141
013510     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
013600     05  D1-DMG-CNT                   PIC ZZZZ9  VALUE ZEROES.    TRKCS141
013700     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
013800     05  D1-FRGT-CHG-AMT              PIC ZZZZ9.99 VALUE ZEROES.  TRKCS141
013900                                                                  TRKCS141
014000 01  D1-TOTAL-LINE1.                                              TRKCS141
014100     05  FILLER                       PIC X(29)  VALUE SPACES.    TRKCS141
014200     05  FILLER                       PIC X(06)  VALUE 'TOTAL:'.  TRKCS141
014300     05  FILLER                       PIC X(07)  VALUE SPACES.    TRKCS141
014400     05  D1-TOT-CARTON-CNT            PIC ZZZZ9  VALUE ZEROES.    TRKCS141
014500     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
014600     05  D1-TOT-ADJ-CNT               PIC ZZZZ9  VALUE ZEROES.    TRKCS141
014700     05  FILLER                       PIC X(04)  VALUE SPACES.    TRKCS141
014800     05  D1-TOT-DMG-CNT               PIC ZZZZ9  VALUE ZEROES.    TRKCS141
014900     05  FILLER                       PIC X(03)  VALUE SPACES.    TRKCS141
015000     05  D1-TOT-FRGT-CHG              PIC ZZZZZ9.99 VALUE ZEROES. TRKCS141
015100                                                                  TRKCS141
015200 01  M1-MESSAGE-LINE.                                             TRKCS141
015300     05  FILLER                       PIC X(05)  VALUE ' *** '.   TRKCS141
015400     05  M1-MESSAGE                   PIC X(75)  VALUE SPACES.    TRKCS141
015500                                                                  TRKCS141
015600 01  L1-LAST-LINE.                                                TRKCS141
015700     05  FILLER                       PIC X(30)  VALUE SPACES.    TRKCS141
015800     05  FILLER                       PIC X(17)  VALUE            TRKCS141
015900         '** END OF LIST **'.                                     TRKCS141
016000     05  FILLER                       PIC X(33)  VALUE SPACES.    TRKCS141
016100                                                                  TRKCS141
016200 01  PS-PROGRAM-SWITCHES.                                         TRKCS141
016300     05  PS-EOF-TRECEIV-CSR-SW        PIC X(01)  VALUE 'N'.       TRKCS141
016400         88  PS-EOF-TRECEIV-CSR                  VALUE 'Y'.       TRKCS141
016500                                                                  TRKCS141
016600     05  PS-VE-STATUS-SW              PIC X(01)  VALUE 'N'.       TRKCS141
016700         88  PS-VE-STATUS                        VALUE 'Y'.       TRKCS141
016800         88  PS-VE-STATUS-NO                     VALUE 'N'.       TRKCS141
016900     05  PS-MULTIPLE-SHIPMENTS-SW     PIC X(01)  VALUE 'S'.       TRKCS141
017000         88  PS-MULTIPLE-SHIPMENTS               VALUE 'M'.       TRKCS141
017100         88  PS-SINGLE-SHIPMENT                  VALUE 'S'.       TRKCS141
017200                                                                  TRKCS141
017300 01  PM-PROGRAM-MESSAGES.                                         TRKCS141
017400     05  PM-PROGRAM-MESSAGE-7.                                    TRKCS141
017500         10  FILLER                   PIC X(54)  VALUE            TRKCS141
017600         'ERROR DURING TERM LINK TO DRS  - TRKCS141 CICS RESP = '.TRKCS141
017700         10  PM-CICS-RESP-7           PIC 9(04)  VALUE ZEROS.     TRKCS141
017800         10  FILLER                   PIC X(18)  VALUE SPACES.    TRKCS141
017900     05  PM-PROGRAM-MESSAGE-8.                                    TRKCS141
018000         10  FILLER                   PIC X(54)  VALUE            TRKCS141
018100         'ERROR DURING CICS RETRIEVE INTO- TRKCS141 CICS RESP = '.TRKCS141
018200         10  PM-CICS-RESP-8           PIC 9(04)  VALUE ZEROS.     TRKCS141
018300         10  FILLER                   PIC X(18)  VALUE SPACES.    TRKCS141
018400     05  PM-PROGRAM-MESSAGE-9.                                    TRKCS141
018500         10  FILLER                   PIC X(54)  VALUE            TRKCS141
018600         'ERROR DURING INIT LINK TO DRS  - TRKCS141 CICS RESP = '.TRKCS141
018700         10  PM-CICS-RESP-9           PIC 9(04)  VALUE ZEROS.     TRKCS141
018800         10  FILLER                   PIC X(18)  VALUE SPACES.    TRKCS141
018900     05  PM-PROGRAM-MESSAGE-10.                                   TRKCS141
019000         10  FILLER                   PIC X(54)  VALUE            TRKCS141
019100         'ERROR DURING PUT LINK TO DRS  -  TRKCS141 CICS RESP = '.TRKCS141
019200         10  PM-CICS-RESP-10          PIC 9(04)  VALUE ZEROS.     TRKCS141
019300         10  FILLER                   PIC X(18)  VALUE SPACES.    TRKCS141
019400     05  PM-PROGRAM-MESSAGE-11.                                   TRKCS141
019500         10  FILLER                   PIC X(54)  VALUE            TRKCS141
019600         'ERROR DURING CICS WRITEQ CSML -  TRKCS141 CICS RESP = '.TRKCS141
019700         10  PM-CICS-RESP-11          PIC 9(04)  VALUE ZEROS.     TRKCS141
019800         10  FILLER                   PIC X(18)  VALUE SPACES.    TRKCS141
019900     05  PM-PROGRAM-MESSAGE-12.                                   TRKCS141
020000         10  FILLER                   PIC X(75)  VALUE            TRKCS141
020100         '** ONE OR MORE RECEIVERS MAY NOT BE VERIFIED ***'.      TRKCS141
020200                                                                  TRKCS141
020300 01  PV-PROGRAM-VARIABLES.                                        TRKCS141
020400     05  PV-CICS-RESPONSE             PIC S9(9)  VALUE +0         TRKCS141
020500                                                 COMP SYNC.       TRKCS141
020600     05  PV-PRINTER                   PIC S9(8)  VALUE +0         TRKCS141
020700                                                 COMP.            TRKCS141
020800     05  PV-ORDER-SEQ-NBR             PIC  9(9).                  TRKCS141
020900     05  PV-OLD-RCVR-SEQ-NBR          PIC  9(9).                  TRKCS141
021000     05  PV-OLD-RCVR-SEQ-NBR-R REDEFINES PV-OLD-RCVR-SEQ-NBR.     TRKCS141
021100         10  PV-OLD-RCVR-SEQ-NBR-1    PIC X(01).                  TRKCS141
021200         10  PV-OLD-RCVR-SEQ-NBR-2-8  PIC X(07).                  TRKCS141
021300         10  PV-OLD-RCVR-SEQ-NBR-9    PIC X(01).                  TRKCS141
021400     05  PV-RETRY-COUNTER             PIC S9(04) VALUE +0         TRKCS141
021500                                                 COMP SYNC.       TRKCS141
021600                                                                  TRKCS141
021700     05  PV-VEH-NBR-NULL-IND          PIC S9(04) COMP VALUE +0.   TRKCS141
021800     05  PV-PROCESSED-DTE.                                        TRKCS141
021900         10  PV-PROCESSED-YY          PIC X(04).                  TRKCS141
022000         10  FILLER                   PIC X(01).                  TRKCS141
022100         10  PV-PROCESSED-MM          PIC X(02).                  TRKCS141
022200         10  FILLER                   PIC X(01).                  TRKCS141
022300         10  PV-PROCESSED-DD          PIC X(02).                  TRKCS141
022400     05  PV-DEPT-NBR              PIC  X(04).                             
022500     05  PV-DEPT-NBR-N REDEFINES                                          
022501         PV-DEPT-NBR              PIC  9(04).                             
022502                                                                  TRKCS141
022503 01  PA-PROGRAM-ACCUMS.                                           TRKCS141
022600     05  PA-PAGE-NBR                  PIC S9(05) VALUE +0.        TRKCS141
022700     05  PA-CART-CNT                  PIC S9(05) COMP-3           TRKCS141
022800                                                 VALUE +0.        TRKCS141
022900     05  PA-LINE-CNT                  PIC S9(02) VALUE +99.       TRKCS141
023000     05  PA-TOT-FRGT-CHG-AMT          PIC S9(09)V99 COMP-3        TRKCS141
023100                                                 VALUE +0.        TRKCS141
023200     05  PA-TOT-CART-CNT              PIC S9(09)    COMP-3        TRKCS141
023300                                                 VALUE +0.        TRKCS141
023400     05  PA-TOT-ACTL-CART-CNT         PIC S9(09)    COMP-3        TRKCS141
023500                                                 VALUE +0.        TRKCS141
023600     05  PA-TOT-DMG-CART-CNT          PIC S9(09)    COMP-3        TRKCS141
023700                                                 VALUE +0.        TRKCS141
023800     05  PA-TOT-FRGT-CHG              PIC S9(09)V99 COMP-3        TRKCS141
023900                                                 VALUE +0.        TRKCS141
024000                                                                  TRKCS141
024100 01  SA-SAVE-AREAS.                                               TRKCS141
024200     05  SA-REPORT-ID                 PIC X(08).                  TRKCS141
024300                                                                  TRKCS141
024400 01  IW-INTERMEDIATE-WORK-AREAS.                                  TRKCS141
024500     05  IW-DATE.                                                 TRKCS141
024600         10  IW-MONTH                 PIC 9(2)   VALUE ZERO.      TRKCS141
024700         10  FILLER REDEFINES IW-MONTH.                           TRKCS141
024800             15  IW-FIRST-DIGIT-OF-MONTH                          TRKCS141
024900                                      PIC X.                      TRKCS141
025000             15  IW-SECOND-DIGIT-OF-MONTH                         TRKCS141
025100                                      PIC X.                      TRKCS141
025200         10  FILLER                   PIC X      VALUE '/'.       TRKCS141
025300         10  IW-DAY                   PIC X(2).                   TRKCS141
025400         10  FILLER                   PIC X      VALUE '/'.       TRKCS141
025500         10  IW-YEAR                  PIC X(2).                   TRKCS141
025600     05  IW-TIME.                                                 TRKCS141
025700         10  IW-ABSTIME               PIC S9(18) COMP SYNC.       TRKCS141
025800         10  IW-TIME-EDIT.                                        TRKCS141
025900             15  IW-TIME-HHMM         PIC X(5).                   TRKCS141
026000             15  FILLER               PIC X(3).                   TRKCS141
026100                                                                  TRKCS141
026200 01  PC-PROGRAM-CONSTANTS.                                        TRKCS141
026300     05  PC-PROGRAM-NAME              PIC X(08)  VALUE 'TRKCS141'.TRKCS141
026400     05  PC-OP-CO-NBR                 PIC X(02)  VALUE '03'.      TRKCS141
026500     05  PC-MAX-RETRIES               PIC S9(04) VALUE +3         TRKCS141
026600                                                 COMP SYNC.       TRKCS141
026700     05  PC-COMM-AREA-LENGTH          PIC S9(04) VALUE +34        TRKCS141
026800                                                 COMP.            TRKCS141
026900     05  PC-LINE-MAX                  PIC S9(2)  VALUE +60.       TRKCS141
027000     05  PC-LAST-LINE                 PIC S9(2)  VALUE +59.       TRKCS141
027100     05  PC-PAGE                      PIC X      VALUE '1'.       TRKCS141
027200     05  PC-DEFAULT-DTE               PIC  X(10)                  TRKCS141
027300                                             VALUE '0001-01-01'.  TRKCS141
027400     05  PC-MULT                      PIC X(04)  VALUE 'MULT'.    TRKCS141
027500                                                                  TRKCS141
027501*                                                                         
027510*  THE FOLLOWING SECTION 'PC-PORTRAIT-PRINT' WAS USED FOR XEROX           
027520*  PRINTERS AND IS MEANINGLESS FOR THE PRINTERS WE USE TODAY.             
027530*  TODAY, THE LINE PRINTS ON A PAGE AND THEN FORM FEEDS ONTO A            
027540*  NEW PAGE, THUS WASTING PAPER.                                          
027550*                                                                         
027600*01  PC-PORTRAIT-PRINT.                                           TRKCS141
027700*    05  PC-PORTRAIT-LINE1            PIC X(50)  VALUE            TRKCS141
027800*        ' $$DJDE$$ JDL=KDSP1S,JDE=000001,COPIES=001,END;  '.     TRKCS141
027900                                                                  TRKCS141
028000 01  CA-COMM-AREA.                                                TRKCS141
028100     05  CA-OWNER-SCAC-ID             PIC X(04).                  TRKCS141
028200     05  CA-PRO-NBR                   PIC X(22).                  TRKCS141
028300     05  CA-PRINTER                   PIC X(08).                  TRKCS141
028400                                                                  TRKCS141
028500/                                                                 TRKCS141
028600*                                                                 TRKCS141
028700*  DCLGEN FOR THE DB2 RECEIVER TABLE                              TRKCS141
028800*                                                                 TRKCS141
028900     EXEC SQL                                                     TRKCS141
029000         INCLUDE TRECEIV                                          TRKCS141
029100     END-EXEC.                                                    TRKCS141
029200                                                                  TRKCS141
029300/                                                                 TRKCS141
029400*                                                                 TRKCS141
029500*  DCLGEN FOR THE DB2 VEHICLE TRIP TABLE                          TRKCS141
029600*                                                                 TRKCS141
029700     EXEC SQL                                                     TRKCS141
029800         INCLUDE TVHTRIP                                          TRKCS141
029900     END-EXEC.                                                    TRKCS141
030000                                                                  TRKCS141
030100/                                                                 TRKCS141
030200*                                                                 TRKCS141
030300*  DCLGEN FOR THE DB2 SHIPMENT PO TABLE                           TRKCS141
030400*                                                                 TRKCS141
030500     EXEC SQL                                                     TRKCS141
030600         INCLUDE TSHPTPO                                          TRKCS141
030700     END-EXEC.                                                    TRKCS141
030800                                                                  TRKCS141
030900/                                                                 TRKCS141
031000*                                                                 TRKCS141
031100*  DCLGEN FOR THE DB2 SHIPMENT TABLE                              TRKCS141
031200*                                                                 TRKCS141
031300     EXEC SQL                                                     TRKCS141
031400         INCLUDE TSHIPMT                                          TRKCS141
031500     END-EXEC.                                                    TRKCS141
031600                                                                  TRKCS141
031700/                                                                 TRKCS141
031800*                                                                 TRKCS141
031900*  DCLGEN FOR THE DB2 PO LINE ITEM TABLE                          TRKCS141
032000*                                                                 TRKCS141
032100     EXEC SQL                                                     TRKCS141
032200         INCLUDE TPURITM                                          TRKCS141
032300     END-EXEC.                                                    TRKCS141
032400                                                                  TRKCS141
032500/                                                                    CL**2
032600*                                                                    CL**2
032700*  DCLGEN FOR THE DB2 PURCHASE ORDER TABLE                           CL**2
032800*                                                                    CL**2
032900     EXEC SQL                                                        CL**2
033000         INCLUDE TPURCHS                                             CL**2
033100     END-EXEC.                                                       CL**2
033200                                                                     CL**2
033201/                                                                    CL**2
033202*                                                                    CL**2
033203*  DCLGEN FOR THE DB2 TSKXREF TABLE                                  CL**2
033204*                                                                    CL**2
033205     EXEC SQL                                                        CL**2
033206         INCLUDE TSKXREF                                             CL**2
033207     END-EXEC.                                                       CL**2
033208                                                                     CL**2
033300/                                                                 TRKCS141
033400*                                                                 TRKCS141
033500*  CURSOR TO SELECT ALL RECEIVERS FOR A FREIGHT BILL              TRKCS141
033600*                                                                 TRKCS141
033700     EXEC SQL                                                     TRKCS141
033800         DECLARE TRECEIV-CSR CURSOR FOR                           TRKCS141
033900             SELECT  DISTINCT                                     TRKCS141
034000                     A.ORD_NBR                                    TRKCS141
034100                    ,A.REC_SEQ_NBR                                TRKCS141
034200                    ,A.RCVR_NBR                                   TRKCS141
034300                    ,A.STATUS_CDE                                 TRKCS141
034400                    ,A.EXPTED_CART_CNT                            TRKCS141
034500                    ,A.ACTL_CART_CNT                              TRKCS141
034510                    ,A.OPER_UNT_ID                                        
034600                    ,B.OWNER_SCAC_ID                              TRKCS141
034700                    ,B.VEH_NBR                                    TRKCS141
034800                    ,C.SHIPT_ID                                   TRKCS141
034900                    ,C.PO_NBR                                     TRKCS141
035100                    ,C.EXPTED_CART_CNT                            TRKCS141
035200                    ,C.ACTL_CART_CNT                              TRKCS141
035300                    ,C.DMG_CART_CNT                               TRKCS141
035400                    ,C.FRGT_CHG_AMT                               TRKCS141
035500                    ,D.FRGT_TERMS_CDE                             TRKCS141
035600                    ,D.EXPTED_GRO_WGHT                            TRKCS141
035700                    ,D.COMPLETE_PRO_NBR                           TRKCS141
035710                    ,E.DEPT_NBR                                   TRKCS141
035800               FROM TRECEIV A                                     TRKCS141
035900                   ,TVHTRIP B                                     TRKCS141
036000                   ,TSHPTPO C                                     TRKCS141
036100                   ,TSHIPMT D                                     TRKCS141
036110                   ,TPURCHS E                                             
036200              WHERE D.PRO_NBR         = :CA-PRO-NBR               TRKCS141
036300                AND D.PRO_SCAC_ID     = :CA-OWNER-SCAC-ID         TRKCS141
036400                AND A.VER_STATUS_CDE = 'A'                        TRKCS141
036500                AND A.ORD_NBR         = C.PO_NBR                  TRKCS141
036501                AND C.PO_NBR          = E.PO_NBR                          
036502                AND E.VER_STATUS_CDE = 'A'                        TRKCS141
036600                AND A.REC_SEQ_NBR     = C.REC_SEQ_NBR             TRKCS141
036700                AND C.SHIPT_ID        = D.SHIPT_ID                TRKCS141
036800                AND B.TRIP_ID         = D.TRIP_ID                 TRKCS141
036900           ORDER BY A.ORD_NBR                                     TRKCS141
037000                  , A.REC_SEQ_NBR                                 TRKCS141
037100     END-EXEC.                                                    TRKCS141
037200                                                                  TRKCS141
037300/                                                                 TRKCS141
037400*                                                                 TRKCS141
037500*  COMMUNICATION AREAS FOR DB2                                    TRKCS141
037600*                                                                 TRKCS141
037700     EXEC SQL                                                     TRKCS141
037800         INCLUDE SQLCA                                            TRKCS141
037900     END-EXEC.                                                    TRKCS141
038000                                                                  TRKCS141
038100/                                                                 TRKCS141
038200******************************************************************TRKCS141
038300 LINKAGE SECTION.                                                 TRKCS141
038400******************************************************************TRKCS141
038500                                                                  TRKCS141
038600 01  DFHCOMMAREA                      PIC X(34).                  TRKCS141
038700                                                                  TRKCS141
038800/                                                                 TRKCS141
038900******************************************************************TRKCS141
039000 PROCEDURE DIVISION.                                              TRKCS141
039100******************************************************************TRKCS141
039200                                                                  TRKCS141
039300 0000-MAINLINE.                                                   TRKCS141
039400                                                                  TRKCS141
039500     PERFORM 0100-INITIALIZATION.                                 TRKCS141
039600                                                                  TRKCS141
039700     PERFORM 2000-OPEN-TRECEIV-CSR.                               TRKCS141
039800     PERFORM 2100-FETCH-TRECEIV-CSR.                              TRKCS141
039900                                                                  TRKCS141
040000     PERFORM 2300-GET-TOTALS.                                     TRKCS141
040100     MOVE PA-TOT-FRGT-CHG-AMT    TO PA-TOT-FRGT-CHG.              TRKCS141
040200                                                                  TRKCS141
040300     MOVE SHIPMT-COMPLETE-PRO-NBR    TO H3-PRO-NBR                TRKCS141
040400                                                                  TRKCS141
040500     PERFORM 2500-GET-SHIPMT.                                     TRKCS141
040600                                                                  TRKCS141
040700     IF SHIPMT-PROCESSED-DTE = PC-DEFAULT-DTE                     TRKCS141
040800         MOVE SPACES               TO H2-YY                       TRKCS141
040900                                      H2-MM                       TRKCS141
041000                                      H2-DD                       TRKCS141
041100     ELSE                                                         TRKCS141
041200         MOVE SHIPMT-PROCESSED-DTE TO PV-PROCESSED-DTE            TRKCS141
041300         MOVE PV-PROCESSED-YY      TO H2-YY                       TRKCS141
041400         MOVE PV-PROCESSED-MM      TO H2-MM                       TRKCS141
041500         MOVE PV-PROCESSED-DD      TO H2-DD                       TRKCS141
041600     END-IF.                                                      TRKCS141
041700     MOVE SHIPMT-INVC-NBR          TO H2-INVOICE.                 TRKCS141
041800     PERFORM 2550-GET-SHIPMT.                                     TRKCS141
041900     IF SQLCODE = -811                                            TRKCS141
042000         MOVE PC-MULT              TO H2-ORIG-SCAC                TRKCS141
042100     ELSE                                                         TRKCS141
042200         MOVE SHIPMT-ORIG-SCAC-ID  TO H2-ORIG-SCAC                TRKCS141
042300     END-IF.                                                      TRKCS141
042400                                                                  TRKCS141
042500     MOVE ZERO TO PA-TOT-CART-CNT                                 TRKCS141
042600                  PA-TOT-ACTL-CART-CNT.                           TRKCS141
042700     PERFORM 1000-CREATE-REPORT                                   TRKCS141
042800       UNTIL PS-EOF-TRECEIV-CSR.                                  TRKCS141
042900                                                                  TRKCS141
043000     PERFORM 4000-PRINT-TOTAL-LINE.                               TRKCS141
043100     PERFORM 3000-PRINT-MESSAGE-LINE                              TRKCS141
043200     PERFORM 5000-PRINT-LAST-LINE.                                TRKCS141
043300                                                                  TRKCS141
043400     PERFORM 2200-CLOSE-TRECEIV-CSR.                              TRKCS141
043500                                                                  TRKCS141
043600     MOVE 'TERM'                 TO DRS01-DRRB-FUNC.              TRKCS141
043700                                                                  TRKCS141
043800     EXEC CICS LINK                                               TRKCS141
043900         PROGRAM  ('DRS1INTC')                                    TRKCS141
044000         COMMAREA (DRS01-COMMAREA)                                TRKCS141
044100         LENGTH   (152)                                           TRKCS141
044200         RESP     (PV-CICS-RESPONSE)                              TRKCS141
044300     END-EXEC.                                                    TRKCS141
044400                                                                  TRKCS141
044500     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    TRKCS141
044600         SET DP013-LOGIC-ABEND   TO TRUE                          TRKCS141
044700         SET DP013-NO-ROLLBACK   TO TRUE                          TRKCS141
044800         MOVE '0000-MAINLINE'    TO DP013-PARAGRAPH               TRKCS141
044900         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-7                TRKCS141
045000         MOVE PM-PROGRAM-MESSAGE-7                                TRKCS141
045100                                 TO DP013-MESSAGE-TEXT(1)         TRKCS141
045200         PERFORM 9999-ABEND                                       TRKCS141
045300     END-IF.                                                      TRKCS141
045400                                                                  TRKCS141
045500     GOBACK.                                                      TRKCS141
045600                                                                  TRKCS141
045700/                                                                 TRKCS141
045800 0100-INITIALIZATION.                                             TRKCS141
045900                                                                  TRKCS141
046000     EXEC CICS                                                    TRKCS141
046100          RETRIEVE                                                TRKCS141
046200          INTO   (CA-COMM-AREA)                                   TRKCS141
046300          LENGTH (PC-COMM-AREA-LENGTH)                            TRKCS141
046400          RESP   (PV-CICS-RESPONSE)                               TRKCS141
046500     END-EXEC.                                                    TRKCS141
046600                                                                  TRKCS141
046700     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    TRKCS141
046800         SET DP013-LOGIC-ABEND   TO TRUE                          TRKCS141
046900         SET DP013-NO-ROLLBACK   TO TRUE                          TRKCS141
047000         MOVE '0100-INITIALIZATION'                               TRKCS141
047100                                 TO DP013-PARAGRAPH               TRKCS141
047200         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-8                TRKCS141
047300         MOVE PM-PROGRAM-MESSAGE-8                                TRKCS141
047400                                 TO DP013-MESSAGE-TEXT(1)         TRKCS141
047500         PERFORM 9999-ABEND                                       TRKCS141
047600     END-IF.                                                      TRKCS141
047700                                                                  TRKCS141
047800     MOVE 'INIT'                 TO DRS01-DRRB-FUNC.              TRKCS141
047900     MOVE 80                     TO DRS02-DRIB-LRECL-1            TRKCS141
048000                                    DRS02-DRIB-BLKSIZE-1.         TRKCS141
048100     MOVE 'A'                    TO DRS02-DRIB-CLASS.             TRKCS141
048200                                                                  TRKCS141
048300     IF CA-PRINTER = 'XXXXXXXX'                                   TRKCS141
048400         MOVE 'LOCAL'            TO DRS02-DRIB-DEST               TRKCS141
048500     ELSE                                                         TRKCS141
048600         MOVE CA-PRINTER         TO DRS02-DRIB-DEST               TRKCS141
048700     END-IF.                                                      TRKCS141
048800                                                                  TRKCS141
048900     MOVE DRS02-DRIB-HEADER      TO DRS01-COMM-DRIB-HDR.          TRKCS141
049000     MOVE DRS02-DRIB-ATTRIB      TO DRS01-COMM-DRIB-AT1.          TRKCS141
049100                                                                  TRKCS141
049200     EXEC CICS LINK                                               TRKCS141
049300         PROGRAM  ('DRS1INTC')                                    TRKCS141
049400         COMMAREA (DRS01-COMMAREA)                                TRKCS141
049500         LENGTH   (181)                                           TRKCS141
049600         RESP     (PV-CICS-RESPONSE)                              TRKCS141
049700     END-EXEC.                                                    TRKCS141
049800                                                                  TRKCS141
049900     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    TRKCS141
050000         SET DP013-LOGIC-ABEND   TO TRUE                          TRKCS141
050100         SET DP013-NO-ROLLBACK   TO TRUE                          TRKCS141
050200         MOVE '0100-INITIALIZATION'                               TRKCS141
050300                                 TO DP013-PARAGRAPH               TRKCS141
050400         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-9                TRKCS141
050500         MOVE PM-PROGRAM-MESSAGE-9                                TRKCS141
050600                                 TO DP013-MESSAGE-TEXT(1)         TRKCS141
050700         PERFORM 9999-ABEND                                       TRKCS141
050800     END-IF.                                                      TRKCS141
050900                                                                  TRKCS141
051000     IF DRS01-DRRB-RC = ZERO                                      TRKCS141
051100         CONTINUE                                                 TRKCS141
051200     ELSE                                                         TRKCS141
051300         PERFORM 9950-DRS-FATAL-ERROR                             TRKCS141
051400     END-IF.                                                      TRKCS141
051500                                                                  TRKCS141
051600     MOVE DRS01-DRRB-RID         TO SA-REPORT-ID.                 TRKCS141
051700                                                                  TRKCS141
051800     INITIALIZE PA-CART-CNT.                                      TRKCS141
051900                                                                  TRKCS141
052000     EXEC CICS                                                    TRKCS141
052100         ASKTIME                                                  TRKCS141
052200         ABSTIME(IW-ABSTIME)                                      TRKCS141
052300     END-EXEC.                                                    TRKCS141
052400                                                                  TRKCS141
052500     EXEC CICS                                                    TRKCS141
052600         FORMATTIME                                               TRKCS141
052700         ABSTIME (IW-ABSTIME)                                     TRKCS141
052800         MMDDYY  (DP075O-RUN-DATE)                                TRKCS141
052900         DATESEP                                                  TRKCS141
053000         TIME    (IW-TIME-EDIT)                                   TRKCS141
053100         TIMESEP                                                  TRKCS141
053200     END-EXEC.                                                    TRKCS141
053300                                                                  TRKCS141
053400     MOVE IW-TIME-HHMM           TO DP075O-RUN-TIME.              TRKCS141
053500                                                                  TRKCS141
053600*    MOVE PC-PORTRAIT-LINE1      TO DRS01-COMM-PRT-LINE.          TRKCS141
053700*    MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
053800*    PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
053900                                                                  TRKCS141
054000     SET PS-VE-STATUS-NO         TO TRUE.                         TRKCS141
054100/                                                                 TRKCS141
054200*----------------------------------------------------------------*TRKCS141
054300*    CONTROL THE COLLECTION OF ALL INFORMATION TO BE PRINTED     *TRKCS141
054400*    ON THE REPORT.                                              *TRKCS141
054500*----------------------------------------------------------------*TRKCS141
054600                                                                  TRKCS141
054700 1000-CREATE-REPORT.                                              TRKCS141
054800                                                                  TRKCS141
054900     PERFORM 1100-FORMAT-REPORT.                                  TRKCS141
055000     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
055100                                                                  TRKCS141
055200     PERFORM 2100-FETCH-TRECEIV-CSR.                              TRKCS141
055300                                                                  TRKCS141
055400/                                                                 TRKCS141
055500*----------------------------------------------------------------*TRKCS141
055600*    SETS UP DRS CALL AND PRINTS THE LINE                        *TRKCS141
055700*----------------------------------------------------------------*TRKCS141
055800                                                                  TRKCS141
055900 1100-FORMAT-REPORT.                                              TRKCS141
056000                                                                  TRKCS141
056100     IF PA-LINE-CNT > PC-LINE-MAX                                 TRKCS141
056200         PERFORM 1200-FORMAT-HEADER-LINES                         TRKCS141
056300     END-IF.                                                      TRKCS141
056400                                                                  TRKCS141
056410     MOVE RECEIV-OPER-UNT-ID     TO D1-DC-NBR.                            
056500     MOVE RECEIV-REC-SEQ-NBR     TO PV-ORDER-SEQ-NBR.             TRKCS141
056600     MOVE PV-ORDER-SEQ-NBR (6:4) TO D1-REC-SEQ-NBR.               TRKCS141
056700     MOVE SHPTPO-PO-NBR          TO D1-PO-NBR.                    TRKCS141
056800     PERFORM 2400-GET-MAJOR-CLASS.                                TRKCS141
056900     IF  SQLCODE = +100                                           TRKCS141
057000         MOVE ZEROES             TO D1-DEPT                       TRKCS141
057010                                    D1-CLASS                      TRKCS141
057100     ELSE                                                         TRKCS141
057200         MOVE PURCHS-DEPT-NBR    TO PV-DEPT-NBR-N                 TRKCS141
057300         MOVE PV-DEPT-NBR-N      TO D1-DEPT                               
057400         MOVE SKXREF-CLASS       TO D1-CLASS                      TRKCS141
058600     END-IF.                                                      TRKCS141
058700     SET PS-SINGLE-SHIPMENT TO TRUE.                              TRKCS141
058800     PERFORM 2600-SELECT-TSHIPMT.                                 TRKCS141
058900     IF PS-MULTIPLE-SHIPMENTS                                     TRKCS141
059000         MOVE SHPTPO-EXPTED-CART-CNT TO D1-CARTON-CNT             TRKCS141
059100         ADD  SHPTPO-EXPTED-CART-CNT TO PA-TOT-CART-CNT           TRKCS141
059200         MOVE SHPTPO-ACTL-CART-CNT TO D1-ACTL-CNT                 TRKCS141
059300         ADD  SHPTPO-ACTL-CART-CNT   TO PA-TOT-ACTL-CART-CNT      TRKCS141
059400     ELSE                                                         TRKCS141
059500         MOVE RECEIV-EXPTED-CART-CNT TO D1-CARTON-CNT             TRKCS141
059600         ADD  RECEIV-EXPTED-CART-CNT TO PA-TOT-CART-CNT           TRKCS141
059700         MOVE RECEIV-ACTL-CART-CNT TO D1-ACTL-CNT                 TRKCS141
059800         ADD  RECEIV-ACTL-CART-CNT   TO PA-TOT-ACTL-CART-CNT      TRKCS141
059900     END-IF.                                                      TRKCS141
060000     MOVE SHPTPO-DMG-CART-CNT    TO D1-DMG-CNT.                   TRKCS141
060100     MOVE SHPTPO-FRGT-CHG-AMT    TO D1-FRGT-CHG-AMT.              TRKCS141
060200                                                                  TRKCS141
060300     IF RECEIV-STATUS-CDE NOT = 'VE'                              TRKCS141
060400         SET PS-VE-STATUS        TO TRUE                          TRKCS141
060500     END-IF.                                                      TRKCS141
060600                                                                  TRKCS141
060700     MOVE D1-DETAIL-LINE1        TO DRS01-COMM-DATA.              TRKCS141
060800     MOVE ' '                    TO DRS01-COMM-CTL.               TRKCS141
060900     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
061000     ADD  1                      TO PA-LINE-CNT.                  TRKCS141
061100                                                                  TRKCS141
061200/                                                                 TRKCS141
061300*----------------------------------------------------------------*TRKCS141
061400*    FORMAT AND PRINT HEADING LINES                              *TRKCS141
061500*----------------------------------------------------------------*TRKCS141
061600                                                                  TRKCS141
061700 1200-FORMAT-HEADER-LINES.                                        TRKCS141
061800                                                                  TRKCS141
061900     ADD 1                       TO PA-PAGE-NBR.                  TRKCS141
062000     MOVE PA-PAGE-NBR            TO DP075O-PAGE-NUMBER.           TRKCS141
062100     MOVE PC-PROGRAM-NAME        TO DP075O-PROGRAM-NAME.          TRKCS141
062200     MOVE '1'                    TO DP075O-REPORT-NUMBER.         TRKCS141
062300     MOVE DP075O-STANDARD-HEADER-75-COLS                          TRKCS141
062400                                 TO DRS01-COMM-DATA.              TRKCS141
062500     MOVE PC-PAGE                TO DRS01-COMM-CTL.               TRKCS141
062600     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
062700     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
062800                                                                  TRKCS141
062900     MOVE H1-HEADING-LINE1       TO DRS01-COMM-DATA.              TRKCS141
063000     MOVE ' '                    TO DRS01-COMM-CTL.               TRKCS141
063100     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
063200     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
063300                                                                  TRKCS141
063400     MOVE H2-HEADING-LINE2       TO DRS01-COMM-DATA.              TRKCS141
063500     MOVE '-'                    TO DRS01-COMM-CTL.               TRKCS141
063600     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
063700     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
063800                                                                  TRKCS141
063900     MOVE CA-OWNER-SCAC-ID       TO H3-SCAC.                      TRKCS141
064000     IF PV-VEH-NBR-NULL-IND NOT = -1                              TRKCS141
064100         MOVE VHTRIP-VEH-NBR     TO H3-TRLR-ID                    TRKCS141
064200     END-IF.                                                      TRKCS141
064300                                                                  TRKCS141
064400     MOVE H3-HEADING-LINE3       TO DRS01-COMM-DATA.              TRKCS141
064500     MOVE ' '                    TO DRS01-COMM-CTL.               TRKCS141
064600     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
064700     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
064800                                                                  TRKCS141
064900     IF SHIPMT-FRGT-TERMS-CDE = 'P'                               TRKCS141
065000        MOVE 'PPD'               TO H4-TERMS                      TRKCS141
065100     ELSE                                                         TRKCS141
065200       IF SHIPMT-FRGT-TERMS-CDE = 'C'                             TRKCS141
065300          MOVE 'COLL'            TO H4-TERMS                      TRKCS141
065310       ELSE                                                               
065320          IF SHIPMT-FRGT-TERMS-CDE = 'F'                                  
065330             MOVE 'FREE'         TO H4-TERMS                              
065340          END-IF                                                          
065400       END-IF                                                     TRKCS141
065500     END-IF.                                                      TRKCS141
065600     MOVE PA-TOT-FRGT-CHG-AMT    TO H4-FRGT-CHG-AMT.              TRKCS141
065700     MOVE SHIPMT-EXPTED-GRO-WGHT TO H4-EXPTED-GRO-WGHT.           TRKCS141
065800     MOVE H4-HEADING-LINE4       TO DRS01-COMM-DATA.              TRKCS141
065900     MOVE '0'                    TO DRS01-COMM-CTL.               TRKCS141
066000     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
066100     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
066200                                                                  TRKCS141
066300                                                                  TRKCS141
066400     MOVE H5-HEADING-LINE5       TO DRS01-COMM-DATA.              TRKCS141
066500     MOVE '0'                    TO DRS01-COMM-CTL.               TRKCS141
066600     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
066700     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
066800                                                                  TRKCS141
066900     MOVE H6-HEADING-LINE6       TO DRS01-COMM-DATA.              TRKCS141
067000     MOVE ' '                    TO DRS01-COMM-CTL.               TRKCS141
067100     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
067200     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
067300                                                                  TRKCS141
067400     MOVE 10                     TO PA-LINE-CNT.                  TRKCS141
067500                                                                  TRKCS141
067600/                                                                 TRKCS141
067700*----------------------------------------------------------------*TRKCS141
067800*    OPEN TRECEIV CURSOR                                         *TRKCS141
067900*----------------------------------------------------------------*TRKCS141
068000                                                                  TRKCS141
068100 2000-OPEN-TRECEIV-CSR.                                           TRKCS141
068200                                                                  TRKCS141
068300     EXEC SQL                                                     TRKCS141
068400         OPEN TRECEIV-CSR                                         TRKCS141
068500     END-EXEC.                                                    TRKCS141
068600                                                                  TRKCS141
068700     EVALUATE TRUE                                                TRKCS141
068800         WHEN SQLCODE = +0                                        TRKCS141
068900             CONTINUE                                             TRKCS141
069000                                                                  TRKCS141
069100         WHEN SQLWARN0 NOT = SPACE                                TRKCS141
069200         WHEN SQLCODE < +0                                        TRKCS141
069300         WHEN SQLCODE > +0                                        TRKCS141
069400             MOVE '2000-OPEN-TRECEIV-CSR'                         TRKCS141
069500                                 TO DP013-PARAGRAPH               TRKCS141
069600             MOVE 'OPEN TRECEIV-CSR'                              TRKCS141
069700                                 TO DP013-MESSAGE-TEXT (1)        TRKCS141
069800             MOVE SQLCA          TO DP013-SQLCA                   TRKCS141
069900             MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (1)      TRKCS141
070000             MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (2)      TRKCS141
070100             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (3)      TRKCS141
070200             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (4)      TRKCS141
070300             SET DP013-DB2-ABEND                                  TRKCS141
070400                 DP013-XCTL-DISPLAY-RESTART                       TRKCS141
070500                                 TO TRUE                          TRKCS141
070600             PERFORM 9999-ABEND                                   TRKCS141
070700     END-EVALUATE.                                                TRKCS141
070800                                                                  TRKCS141
070900/                                                                 TRKCS141
071000*----------------------------------------------------------------*TRKCS141
071100*    FETCH TRECEIC CURSOR                                        *TRKCS141
071200*----------------------------------------------------------------*TRKCS141
071300                                                                  TRKCS141
071400 2100-FETCH-TRECEIV-CSR.                                          TRKCS141
071500                                                                  TRKCS141
071600     EXEC SQL                                                     TRKCS141
071700          FETCH  TRECEIV-CSR                                      TRKCS141
071800           INTO :RECEIV-ORD-NBR                                   TRKCS141
071900               ,:RECEIV-REC-SEQ-NBR                               TRKCS141
072000               ,:RECEIV-RCVR-NBR                                  TRKCS141
072100               ,:RECEIV-STATUS-CDE                                TRKCS141
072200               ,:RECEIV-EXPTED-CART-CNT                           TRKCS141
072300               ,:RECEIV-ACTL-CART-CNT                             TRKCS141
072310               ,:RECEIV-OPER-UNT-ID                                       
072400               ,:VHTRIP-OWNER-SCAC-ID                             TRKCS141
072500               ,:VHTRIP-VEH-NBR:PV-VEH-NBR-NULL-IND               TRKCS141
072600               ,:SHPTPO-SHIPT-ID                                  TRKCS141
072700               ,:SHPTPO-PO-NBR                                    TRKCS141
072900               ,:SHPTPO-EXPTED-CART-CNT                           TRKCS141
073000               ,:SHPTPO-ACTL-CART-CNT                             TRKCS141
073100               ,:SHPTPO-DMG-CART-CNT                              TRKCS141
073200               ,:SHPTPO-FRGT-CHG-AMT                              TRKCS141
073300               ,:SHIPMT-FRGT-TERMS-CDE                            TRKCS141
073400               ,:SHIPMT-EXPTED-GRO-WGHT                           TRKCS141
073500               ,:SHIPMT-COMPLETE-PRO-NBR                          TRKCS141
073510               ,:PURCHS-DEPT-NBR                                  TRKCS141
073600     END-EXEC.                                                    TRKCS141
073700                                                                  TRKCS141
073800*              ,:VHTRIP-VEH-NBR:PV-VEH-NBR-NULL-IND               TRKCS141
073900     EVALUATE TRUE                                                TRKCS141
074000         WHEN SQLCODE = ZERO                                      TRKCS141
074100             CONTINUE                                             TRKCS141
074200                                                                  TRKCS141
074300         WHEN SQLCODE = +100                                      TRKCS141
074400             SET PS-EOF-TRECEIV-CSR                               TRKCS141
074500                                 TO TRUE                          TRKCS141
074600                                                                  TRKCS141
074700         WHEN SQLWARN0 NOT = SPACE                                TRKCS141
074800         WHEN SQLCODE < +0                                        TRKCS141
074900         WHEN SQLCODE > +0                                        TRKCS141
075000             MOVE '2100-FETCH-TRECEIV-CSR'                        TRKCS141
075100                                 TO DP013-PARAGRAPH               TRKCS141
075200             MOVE 'FETCH TRECEIV-CSR'                             TRKCS141
075300                                 TO DP013-MESSAGE-TEXT (1)        TRKCS141
075400             MOVE SQLCA          TO DP013-SQLCA                   TRKCS141
075500             MOVE 'TRECEIV'      TO DP013-DB2-TABLE-NAME (1)      TRKCS141
075600             MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (2)      TRKCS141
075700             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (3)      TRKCS141
075800             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (4)      TRKCS141
075900             SET DP013-DB2-ABEND                                  TRKCS141
076000                 DP013-XCTL-DISPLAY-RESTART                       TRKCS141
076100                                 TO TRUE                          TRKCS141
076200             PERFORM 9999-ABEND                                   TRKCS141
076300     END-EVALUATE.                                                TRKCS141
076400                                                                  TRKCS141
076500/                                                                 TRKCS141
076600*----------------------------------------------------------------*TRKCS141
076700*    CLOSE TRECEIV CURSOR                                        *TRKCS141
076800*----------------------------------------------------------------*TRKCS141
076900                                                                  TRKCS141
077000 2200-CLOSE-TRECEIV-CSR.                                          TRKCS141
077100                                                                  TRKCS141
077200     EXEC SQL                                                     TRKCS141
077300         CLOSE TRECEIV-CSR                                        TRKCS141
077400     END-EXEC.                                                    TRKCS141
077500                                                                  TRKCS141
077600     IF SQLCODE NOT = ZERO                                        TRKCS141
077700         MOVE '2200-CLOSE-TRECEIV-CSR'                            TRKCS141
077800                                 TO DP013-PARAGRAPH               TRKCS141
077900         MOVE 'CLOSE OF TPFOFSL CURSOR FAILED'                    TRKCS141
078000                                 TO DP013-MESSAGE-TEXT (1)        TRKCS141
078100         MOVE SQLCA              TO DP013-SQLCA                   TRKCS141
078200         MOVE 'TRECEIV'          TO DP013-DB2-TABLE-NAME (1)      TRKCS141
078300             MOVE 'TVHTRIP'      TO DP013-DB2-TABLE-NAME (2)      TRKCS141
078400             MOVE 'TSHPTPO'      TO DP013-DB2-TABLE-NAME (3)      TRKCS141
078500             MOVE 'TSHIPMT'      TO DP013-DB2-TABLE-NAME (4)      TRKCS141
078600             SET DP013-DB2-ABEND                                  TRKCS141
078700                 DP013-XCTL-DISPLAY-RESTART                       TRKCS141
078800                                 TO TRUE                          TRKCS141
078900         PERFORM 9999-ABEND                                       TRKCS141
079000     END-IF.                                                      TRKCS141
079100                                                                  TRKCS141
079200/                                                                 TRKCS141
079300*----------------------------------------------------------------*TRKCS141
079400*    OBTAIN THE TOTAL FREIGHT CHARGES AND WEIGHT FOR THIS        *TRKCS141
079500*    FREIGHT BILL                                                *TRKCS141
079600*----------------------------------------------------------------*TRKCS141
079700                                                                  TRKCS141
079800 2300-GET-TOTALS.                                                 TRKCS141
079900                                                                  TRKCS141
080000     EXEC SQL                                                     TRKCS141
080100         SELECT SUM(C.FRGT_CHG_AMT)                               TRKCS141
080200               ,SUM(C.DMG_CART_CNT)                               TRKCS141
080300          INTO  :PA-TOT-FRGT-CHG-AMT                              TRKCS141
080400               ,:PA-TOT-DMG-CART-CNT                              TRKCS141
080500           FROM TRECEIV A                                         TRKCS141
080600               ,TVHTRIP B                                         TRKCS141
080700               ,TSHPTPO C                                         TRKCS141
080800               ,TSHIPMT D                                         TRKCS141
080900          WHERE D.PRO_NBR        = :CA-PRO-NBR                    TRKCS141
081000            AND D.PRO_SCAC_ID    = :CA-OWNER-SCAC-ID              TRKCS141
081100            AND A.VER_STATUS_CDE = 'A'                            TRKCS141
081200            AND A.ORD_NBR  = C.PO_NBR                             TRKCS141
081300            AND A.REC_SEQ_NBR = C.REC_SEQ_NBR                     TRKCS141
081400            AND C.SHIPT_ID = D.SHIPT_ID                           TRKCS141
081500            AND D.TRIP_ID  = B.TRIP_ID                            TRKCS141
081600     END-EXEC.                                                    TRKCS141
081700                                                                  TRKCS141
081800                                                                  TRKCS141
081900     EVALUATE TRUE                                                TRKCS141
082000         WHEN SQLCODE = +0                                        TRKCS141
082100         WHEN SQLCODE = +100                                      TRKCS141
082200         WHEN SQLCODE = -305                                      TRKCS141
082300         WHEN SQLCODE = -904                                      TRKCS141
082400         WHEN SQLCODE = -913                                      TRKCS141
082500             CONTINUE                                             TRKCS141
082600         WHEN SQLWARN0 NOT = SPACE                                TRKCS141
082700         WHEN SQLCODE < +0                                        TRKCS141
082800         WHEN SQLCODE > +0                                        TRKCS141
082900             MOVE '2300-GET-TOTALS'                               TRKCS141
083000                             TO DP013-PARAGRAPH                   TRKCS141
083100             MOVE 'SUM ON PROOF OF DELIVERY TABLE'                TRKCS141
083200                             TO DP013-MESSAGE-TEXT (1)            TRKCS141
083300             MOVE SQLCA      TO DP013-SQLCA                       TRKCS141
083400             MOVE 'TREVEIV'  TO DP013-DB2-TABLE-NAME (1)          TRKCS141
083500             MOVE 'TVHTRIP'  TO DP013-DB2-TABLE-NAME (2)          TRKCS141
083600             MOVE 'TSHPTPO'  TO DP013-DB2-TABLE-NAME (3)          TRKCS141
083700             MOVE 'TSHIPMT'  TO DP013-DB2-TABLE-NAME (4)          TRKCS141
083800                 SET DP013-DB2-ABEND                              TRKCS141
083900                     DP013-XCTL-DISPLAY-RESTART                   TRKCS141
084000                                 TO TRUE                          TRKCS141
084100             PERFORM 9999-ABEND                                   TRKCS141
084200     END-EVALUATE.                                                TRKCS141
084300                                                                  TRKCS141
084400/                                                                 TRKCS141
084500*----------------------------------------------------------------*TRKCS141
084600*    GET THE CLASS NUMBER                                        *TRKCS141
084700*----------------------------------------------------------------*TRKCS141
084800 2400-GET-MAJOR-CLASS.                                            TRKCS141
084900                                                                  TRKCS141
085000     PERFORM                                                      TRKCS141
085100         WITH TEST AFTER                                          TRKCS141
085200         VARYING PV-RETRY-COUNTER                                 TRKCS141
085300         FROM 1 BY 1                                              TRKCS141
085400         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS141
085500             OR (SQLCODE = +0)                                    TRKCS141
085600             OR (SQLCODE = +100))                                 TRKCS141
085700                                                                  TRKCS141
085800         EXEC SQL                                                 TRKCS141
085900              SELECT B.CLASS                                      TRKCS141
086000                INTO :SKXREF-CLASS                                TRKCS141
086100                FROM TPURITM A,                                   TRKCS141
086200                     TSKXREF B                                            
086300               WHERE A.PO_NBR         = :SHPTPO-PO-NBR            TRKCS141
086400                 AND A.VER_STATUS_CDE = 'A'                       TRKCS141
086500                 AND A.ITM_NBR        = B.ITM_NBR                         
086600                 AND A.PO_LNE_NBR =                               TRKCS141
086700                      (SELECT MIN(B.PO_LNE_NBR)                   TRKCS141
086800                       FROM   TPURITM B                           TRKCS141
086900                       WHERE  B.PO_NBR = A.PO_NBR                 TRKCS141
086901                         AND  B.VER_STATUS_CDE = 'A')             TRKCS141
086902         END-EXEC                                                 TRKCS141
087000     END-PERFORM.                                                 TRKCS141
087100                                                                  TRKCS141
087200     EVALUATE TRUE                                                TRKCS141
087300         WHEN SQLCODE = +0                                        TRKCS141
087400         WHEN SQLCODE = +100                                      TRKCS141
087500         WHEN SQLCODE = -904                                      TRKCS141
087600         WHEN SQLCODE = -913                                      TRKCS141
087700             CONTINUE                                             TRKCS141
087800         WHEN SQLWARN0 NOT = SPACE                                TRKCS141
087900         WHEN SQLCODE < +0                                        TRKCS141
088000         WHEN SQLCODE > +0                                        TRKCS141
088100             MOVE '2400-GET-MAJOR-CLASS'                          TRKCS141
088200                             TO DP013-PARAGRAPH                   TRKCS141
088300             MOVE 'UNSUCCESSFUL SELECT ON TPURITM'                TRKCS141
088400                             TO DP013-MESSAGE-TEXT (1)            TRKCS141
088500             MOVE SQLCA      TO DP013-SQLCA                       TRKCS141
088600             MOVE 'TPURITM'  TO DP013-DB2-TABLE-NAME (1)          TRKCS141
088700             SET DP013-DB2-ABEND                                  TRKCS141
088800                     DP013-XCTL-DISPLAY-RESTART                   TRKCS141
088900                                 TO TRUE                          TRKCS141
089000             PERFORM 9999-ABEND                                   TRKCS141
089100     END-EVALUATE.                                                TRKCS141
089200                                                                  TRKCS141
089300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    TRKCS141
089400         SQLCODE NOT =  +0                                        TRKCS141
089500         MOVE '2400-GET-MAJOR-CLASS'                              TRKCS141
089600                                  TO DP013-PARAGRAPH              TRKCS141
089700         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            TRKCS141
089800                                  TO DP013-MESSAGE-TEXT (1)       TRKCS141
089900         MOVE SQLCA               TO DP013-SQLCA                  TRKCS141
090000         MOVE 'TPURITM '          TO DP013-DB2-TABLE-NAME (1)     TRKCS141
090100         SET DP013-DB2-ABEND                                      TRKCS141
090200             DP013-XCTL-DISPLAY-RESTART                           TRKCS141
090300                                  TO TRUE                         TRKCS141
090400         PERFORM 9999-ABEND                                       TRKCS141
090500     END-IF.                                                      TRKCS141
090600                                                                  TRKCS141
090700/                                                                 TRKCS141
090800*----------------------------------------------------------------*TRKCS141
090900*    GET THE CLASS NUMBER                                        *TRKCS141
091000*----------------------------------------------------------------*TRKCS141
091100 2500-GET-SHIPMT.                                                 TRKCS141
091200                                                                  TRKCS141
091300     PERFORM                                                      TRKCS141
091400         WITH TEST AFTER                                          TRKCS141
091500         VARYING PV-RETRY-COUNTER                                 TRKCS141
091600         FROM 1 BY 1                                              TRKCS141
091700         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS141
091800             OR (SQLCODE = +0)                                    TRKCS141
091900             OR (SQLCODE = +100))                                 TRKCS141
092000                                                                  TRKCS141
092100         EXEC SQL                                                 TRKCS141
092200              SELECT DISTINCT                                     TRKCS141
092300                     D.PROCESSED_DTE                              TRKCS141
092400                   , D.INVC_NBR                                   TRKCS141
092500                INTO :SHIPMT-PROCESSED-DTE                        TRKCS141
092600                   , :SHIPMT-INVC-NBR                             TRKCS141
092700               FROM TRECEIV A                                     TRKCS141
092800                   ,TVHTRIP B                                     TRKCS141
092900                   ,TSHPTPO C                                     TRKCS141
093000                   ,TSHIPMT D                                     TRKCS141
093100              WHERE D.PRO_NBR        = :CA-PRO-NBR                TRKCS141
093200                AND D.PRO_SCAC_ID    = :CA-OWNER-SCAC-ID          TRKCS141
093300                AND A.VER_STATUS_CDE = 'A'                        TRKCS141
093400                AND A.ORD_NBR      = C.PO_NBR                     TRKCS141
093500                AND A.REC_SEQ_NBR  = C.REC_SEQ_NBR                TRKCS141
093600                AND C.SHIPT_ID     = D.SHIPT_ID                   TRKCS141
093700                AND D.TRIP_ID      = B.TRIP_ID                    TRKCS141
093800         END-EXEC                                                 TRKCS141
093900                                                                  TRKCS141
094000         EVALUATE TRUE                                            TRKCS141
094100             WHEN SQLCODE = +0                                    TRKCS141
094200             WHEN SQLCODE = +100                                  TRKCS141
094300             WHEN SQLCODE = -904                                  TRKCS141
094400             WHEN SQLCODE = -913                                  TRKCS141
094500                  CONTINUE                                        TRKCS141
094600                                                                  TRKCS141
094700             WHEN SQLWARN0 NOT = SPACES                           TRKCS141
094800             WHEN SQLCODE < +0                                    TRKCS141
094900             WHEN SQLCODE > +0                                    TRKCS141
095000                  MOVE '2500-GET-SHIPMT'                          TRKCS141
095100                                  TO DP013-PARAGRAPH              TRKCS141
095200                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT'           TRKCS141
095300                                  TO DP013-MESSAGE-TEXT (1)       TRKCS141
095400                  MOVE SQLCA      TO DP013-SQLCA                  TRKCS141
095500                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     TRKCS141
095600                  SET DP013-DB2-ABEND                             TRKCS141
095700                      DP013-XCTL-DISPLAY-RESTART                  TRKCS141
095800                                  TO TRUE                         TRKCS141
095900                  PERFORM 9999-ABEND                              TRKCS141
096000         END-EVALUATE                                             TRKCS141
096100     END-PERFORM.                                                 TRKCS141
096200                                                                  TRKCS141
096300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    TRKCS141
096400         SQLCODE NOT =  +0                                        TRKCS141
096500         MOVE '2500-GET-SHIPMT '                                  TRKCS141
096600                                  TO DP013-PARAGRAPH              TRKCS141
096700         MOVE 'MAX RETRIES EXCEEDED ON SELECT TSHIPMT'            TRKCS141
096800                                  TO DP013-MESSAGE-TEXT (1)       TRKCS141
096900         MOVE SQLCA               TO DP013-SQLCA                  TRKCS141
097000         MOVE 'TRECEIV '          TO DP013-DB2-TABLE-NAME (1)     TRKCS141
097100         MOVE 'TVHTRIP '          TO DP013-DB2-TABLE-NAME (2)     TRKCS141
097200         MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (3)     TRKCS141
097300         MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (4)     TRKCS141
097400         SET DP013-DB2-ABEND                                      TRKCS141
097500             DP013-XCTL-DISPLAY-RESTART                           TRKCS141
097600                                  TO TRUE                         TRKCS141
097700         PERFORM 9999-ABEND                                       TRKCS141
097800     END-IF.                                                      TRKCS141
097900                                                                  TRKCS141
098000                                                                  TRKCS141
098100*----------------------------------------------------------------*TRKCS141
098200*    GET THE ORIGIN SCAC                                         *TRKCS141
098300*----------------------------------------------------------------*TRKCS141
098400 2550-GET-SHIPMT.                                                 TRKCS141
098500                                                                  TRKCS141
098600     PERFORM                                                      TRKCS141
098700         WITH TEST AFTER                                          TRKCS141
098800         VARYING PV-RETRY-COUNTER                                 TRKCS141
098900         FROM 1 BY 1                                              TRKCS141
099000         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS141
099100             OR (SQLCODE = +0)                                    TRKCS141
099200             OR (SQLCODE = +100)                                  TRKCS141
099300             OR (SQLCODE = -811))                                 TRKCS141
099400                                                                  TRKCS141
099500         EXEC SQL                                                 TRKCS141
099600              SELECT DISTINCT                                     TRKCS141
099700                     ORIG_SCAC_ID                                 TRKCS141
099800                INTO :SHIPMT-ORIG-SCAC-ID                         TRKCS141
099900                FROM TSHIPMT                                      TRKCS141
100000              WHERE  PRO_NBR        = :CA-PRO-NBR                 TRKCS141
100100                AND  PRO_SCAC_ID    = :CA-OWNER-SCAC-ID           TRKCS141
100200         END-EXEC                                                 TRKCS141
100300                                                                  TRKCS141
100400         EVALUATE TRUE                                            TRKCS141
100500             WHEN SQLCODE = +0                                    TRKCS141
100600             WHEN SQLCODE = +100                                  TRKCS141
100700             WHEN SQLCODE = -811                                  TRKCS141
100800             WHEN SQLCODE = -904                                  TRKCS141
100900             WHEN SQLCODE = -913                                  TRKCS141
101000                  CONTINUE                                        TRKCS141
101100                                                                  TRKCS141
101200             WHEN SQLWARN0 NOT = SPACES                           TRKCS141
101300             WHEN SQLCODE < +0                                    TRKCS141
101400             WHEN SQLCODE > +0                                    TRKCS141
101500                  MOVE '2550-GET-SHIPMT'                          TRKCS141
101600                                  TO DP013-PARAGRAPH              TRKCS141
101700                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT'           TRKCS141
101800                                  TO DP013-MESSAGE-TEXT (1)       TRKCS141
101900                  MOVE SQLCA      TO DP013-SQLCA                  TRKCS141
102000                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (1)     TRKCS141
102100                  SET DP013-DB2-ABEND                             TRKCS141
102200                      DP013-XCTL-DISPLAY-RESTART                  TRKCS141
102300                                  TO TRUE                         TRKCS141
102400                  PERFORM 9999-ABEND                              TRKCS141
102500         END-EVALUATE                                             TRKCS141
102600     END-PERFORM.                                                 TRKCS141
102700                                                                  TRKCS141
102800     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    TRKCS141
102900         SQLCODE  NOT = +0                                        TRKCS141
103000         MOVE '2550-GET-SHIPMT '                                  TRKCS141
103100                                  TO DP013-PARAGRAPH              TRKCS141
103200         MOVE 'MAX RETRIES EXCEEDED ON SELECT TPURITM'            TRKCS141
103300                                  TO DP013-MESSAGE-TEXT (1)       TRKCS141
103400         MOVE SQLCA               TO DP013-SQLCA                  TRKCS141
103500         MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (1)     TRKCS141
103600         SET DP013-DB2-ABEND                                      TRKCS141
103700             DP013-XCTL-DISPLAY-RESTART                           TRKCS141
103800                                  TO TRUE                         TRKCS141
103900         PERFORM 9999-ABEND                                       TRKCS141
104000     END-IF.                                                      TRKCS141
104100                                                                  TRKCS141
104200/                                                                 TRKCS141
104300*----------------------------------------------------------------*TRKCS141
104400*    RETREIVE SHIPMENT INFO                                      *TRKCS141
104500*----------------------------------------------------------------*TRKCS141
104600 2600-SELECT-TSHIPMT.                                             TRKCS141
104700                                                                  TRKCS141
104800     PERFORM                                                      TRKCS141
104900         WITH TEST AFTER                                          TRKCS141
105000         VARYING PV-RETRY-COUNTER                                 TRKCS141
105100         FROM 1 BY 1                                              TRKCS141
105200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               TRKCS141
105300             OR (SQLCODE = +0)                                    TRKCS141
105400             OR (SQLCODE = +100)                                  TRKCS141
105500             OR (SQLCODE = -811))                                 TRKCS141
105600                                                                  TRKCS141
105700         EXEC SQL                                                 TRKCS141
105800              SELECT  REC_SEQ_NBR                                 TRKCS141
105900                INTO :SHPTPO-REC-SEQ-NBR                          TRKCS141
106000                FROM  TSHPTPO                                     TRKCS141
106100            WHERE   PO_NBR      = :SHPTPO-PO-NBR                  TRKCS141
106200              AND   REC_SEQ_NBR = :RECEIV-REC-SEQ-NBR             TRKCS141
106300         END-EXEC                                                 TRKCS141
106400                                                                  TRKCS141
106500                                                                  TRKCS141
106600         EVALUATE TRUE                                            TRKCS141
106700             WHEN SQLCODE = +0                                    TRKCS141
106800             WHEN SQLCODE = +100                                  TRKCS141
106900             WHEN SQLCODE = -904                                  TRKCS141
107000             WHEN SQLCODE = -913                                  TRKCS141
107100                 CONTINUE                                         TRKCS141
107200                                                                  TRKCS141
107300             WHEN SQLCODE = -811                                  TRKCS141
107400                  SET PS-MULTIPLE-SHIPMENTS                       TRKCS141
107500                                   TO TRUE                        TRKCS141
107600                                                                  TRKCS141
107700             WHEN SQLWARN0 NOT = SPACES                           TRKCS141
107800             WHEN SQLCODE < +0                                    TRKCS141
107900             WHEN SQLCODE > +0                                    TRKCS141
108000                  MOVE '2600-SELECT-TSHIPMT     '                 TRKCS141
108100                                  TO DP013-PARAGRAPH              TRKCS141
108200                  MOVE 'UNSUCCESSFUL SELECT ON TSHIPMT  '         TRKCS141
108300                                  TO DP013-MESSAGE-TEXT (1)       TRKCS141
108400                  MOVE SQLCA      TO DP013-SQLCA                  TRKCS141
108500                  MOVE 'TSHPTPO ' TO DP013-DB2-TABLE-NAME (1)     TRKCS141
108600                  MOVE 'TSHIPMT ' TO DP013-DB2-TABLE-NAME (2)     TRKCS141
108700                  SET DP013-DB2-ABEND                             TRKCS141
108800                      DP013-XCTL-DISPLAY-RESTART                  TRKCS141
108900                                  TO TRUE                         TRKCS141
109000                  PERFORM 9999-ABEND                              TRKCS141
109100         END-EVALUATE                                             TRKCS141
109200     END-PERFORM.                                                 TRKCS141
109300                                                                  TRKCS141
109400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    TRKCS141
109500         SQLCODE NOT =  +0                                        TRKCS141
109600         MOVE '2600-SELECT-TSHIPMT     '                          TRKCS141
109700                                  TO DP013-PARAGRAPH              TRKCS141
109800         MOVE 'MAX RETRIES EXCEEDED ON COUNT FOR SHIPMENTS'       TRKCS141
109900                                  TO DP013-MESSAGE-TEXT (1)       TRKCS141
110000         MOVE SQLCA               TO DP013-SQLCA                  TRKCS141
110100         MOVE 'TSHPTPO '          TO DP013-DB2-TABLE-NAME (1)     TRKCS141
110200         MOVE 'TSHIPMT '          TO DP013-DB2-TABLE-NAME (2)     TRKCS141
110300         SET DP013-DB2-ABEND                                      TRKCS141
110400             DP013-XCTL-DISPLAY-RESTART                           TRKCS141
110500                                  TO TRUE                         TRKCS141
110600         PERFORM 9999-ABEND                                       TRKCS141
110700     END-IF.                                                      TRKCS141
110800                                                                  TRKCS141
110900/                                                                 TRKCS141
114500*----------------------------------------------------------------*TRKCS141
114600*    PRINT MESSAGE LINE                                          *TRKCS141
114700*----------------------------------------------------------------*TRKCS141
114800                                                                  TRKCS141
114900 3000-PRINT-MESSAGE-LINE.                                         TRKCS141
115000                                                                  TRKCS141
115100     IF PS-VE-STATUS                                              TRKCS141
115200         MOVE PM-PROGRAM-MESSAGE-12  TO M1-MESSAGE                TRKCS141
115300         MOVE M1-MESSAGE-LINE        TO DRS01-COMM-DATA           TRKCS141
115400         MOVE '0'                    TO DRS01-COMM-CTL            TRKCS141
115500         MOVE SA-REPORT-ID           TO DRS01-DRRB-RID            TRKCS141
115600         PERFORM 9000-PUT-LINE-TO-DRS                             TRKCS141
115700         ADD  1                      TO PA-LINE-CNT               TRKCS141
115800     END-IF.                                                      TRKCS141
115900/                                                                 TRKCS141
116000*----------------------------------------------------------------*TRKCS141
116100*    PRINT TOTAL LINE                                            *TRKCS141
116200*----------------------------------------------------------------*TRKCS141
116300                                                                  TRKCS141
116400 4000-PRINT-TOTAL-LINE.                                           TRKCS141
116500                                                                  TRKCS141
116600     IF PA-LINE-CNT > (PC-LINE-MAX - 5)                           TRKCS141
116700         PERFORM 1200-FORMAT-HEADER-LINES                         TRKCS141
116800     END-IF.                                                      TRKCS141
116900                                                                  TRKCS141
117000     MOVE PA-TOT-CART-CNT        TO D1-TOT-CARTON-CNT.            TRKCS141
117100     MOVE PA-TOT-ACTL-CART-CNT   TO D1-TOT-ADJ-CNT.               TRKCS141
117200     MOVE PA-TOT-DMG-CART-CNT    TO D1-TOT-DMG-CNT.               TRKCS141
117300     MOVE PA-TOT-FRGT-CHG        TO D1-TOT-FRGT-CHG.              TRKCS141
117400                                                                  TRKCS141
117500     MOVE D1-TOTAL-LINE1         TO DRS01-COMM-DATA.              TRKCS141
117600     MOVE '0'                    TO DRS01-COMM-CTL.               TRKCS141
117700     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
117800     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
117900                                                                  TRKCS141
118000/                                                                 TRKCS141
118100*----------------------------------------------------------------*TRKCS141
118200*    PRINT END OF REPORT MESSAGE                                 *TRKCS141
118300*----------------------------------------------------------------*TRKCS141
118400                                                                  TRKCS141
118500 5000-PRINT-LAST-LINE.                                            TRKCS141
118600                                                                  TRKCS141
118700     MOVE L1-LAST-LINE           TO DRS01-COMM-DATA.              TRKCS141
118800     MOVE '-'                    TO DRS01-COMM-CTL.               TRKCS141
118900     MOVE SA-REPORT-ID           TO DRS01-DRRB-RID.               TRKCS141
119000     PERFORM 9000-PUT-LINE-TO-DRS.                                TRKCS141
119100                                                                  TRKCS141
119200/                                                                 TRKCS141
119300*----------------------------------------------------------------*TRKCS141
119400*    LINK TO DRS TO PRINT THE LINE                               *TRKCS141
119500*----------------------------------------------------------------*TRKCS141
119600                                                                  TRKCS141
119700 9000-PUT-LINE-TO-DRS.                                            TRKCS141
119800                                                                  TRKCS141
119900     MOVE 'PUT'                  TO DRS01-DRRB-FUNC.              TRKCS141
120000                                                                  TRKCS141
120100     EXEC CICS LINK                                               TRKCS141
120200         PROGRAM  ('DRS1INTC')                                    TRKCS141
120300         COMMAREA (DRS01-COMMAREA)                                TRKCS141
120400         LENGTH   (181)                                           TRKCS141
120500         RESP     (PV-CICS-RESPONSE)                              TRKCS141
120600     END-EXEC.                                                    TRKCS141
120700                                                                  TRKCS141
120800     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    TRKCS141
120900         SET DP013-LOGIC-ABEND   TO TRUE                          TRKCS141
121000         SET DP013-NO-ROLLBACK   TO TRUE                          TRKCS141
121100         MOVE '9000-PUT-LINE-TO-DRS'                              TRKCS141
121200                                 TO DP013-PARAGRAPH               TRKCS141
121300         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-10               TRKCS141
121400         MOVE PM-PROGRAM-MESSAGE-10                               TRKCS141
121500                                 TO DP013-MESSAGE-TEXT(1)         TRKCS141
121600         PERFORM 9999-ABEND                                       TRKCS141
121700     END-IF.                                                      TRKCS141
121800                                                                  TRKCS141
121900     IF DRS01-DRRB-RC = ZERO                                      TRKCS141
122000         CONTINUE                                                 TRKCS141
122100     ELSE                                                         TRKCS141
122200         PERFORM 9950-DRS-FATAL-ERROR                             TRKCS141
122300     END-IF.                                                      TRKCS141
122400                                                                  TRKCS141
122500/                                                                 TRKCS141
122600*----------------------------------------------------------------*TRKCS141
122700*    TERMINATE DRS AND WRITE AN ERROR MESSAGE TO THE LOG         *TRKCS141
122800*----------------------------------------------------------------*TRKCS141
122900                                                                  TRKCS141
123000 9950-DRS-FATAL-ERROR.                                            TRKCS141
123100                                                                  TRKCS141
123200     MOVE DRS01-DRRB-FUNC        TO IE-DRS-FUNC.                  TRKCS141
123300     MOVE DRS01-DRRB-RC          TO IE-DRS-RC.                    TRKCS141
123400     MOVE 'TERM'                 TO DRS01-DRRB-FUNC.              TRKCS141
123500                                                                  TRKCS141
123600     EXEC CICS LINK                                               TRKCS141
123700         PROGRAM  ('DRS1INTC')                                    TRKCS141
123800         COMMAREA (DRS01-COMMAREA)                                TRKCS141
123900         LENGTH   (152)                                           TRKCS141
124000     END-EXEC.                                                    TRKCS141
124100                                                                  TRKCS141
124200     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    TRKCS141
124300         SET DP013-LOGIC-ABEND   TO TRUE                          TRKCS141
124400         SET DP013-NO-ROLLBACK   TO TRUE                          TRKCS141
124500         MOVE '9500-DRS-FATAL-ERROR'                              TRKCS141
124600                                 TO DP013-PARAGRAPH               TRKCS141
124700         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-7                TRKCS141
124800         MOVE PM-PROGRAM-MESSAGE-7                                TRKCS141
124900                                 TO DP013-MESSAGE-TEXT(1)         TRKCS141
125000         PERFORM 9999-ABEND                                       TRKCS141
125100     END-IF.                                                      TRKCS141
125200                                                                  TRKCS141
125300     EXEC CICS                                                    TRKCS141
125400         SYNCPOINT                                                TRKCS141
125500     END-EXEC.                                                    TRKCS141
125600                                                                  TRKCS141
125700     EXEC CICS                                                    TRKCS141
125800         WRITEQ TD                                                TRKCS141
125900         QUEUE  ('CSML')                                          TRKCS141
126000         FROM   (IE-DRS-ERROR-MSG)                                TRKCS141
126100         LENGTH (118)                                             TRKCS141
126200     END-EXEC.                                                    TRKCS141
126300                                                                  TRKCS141
126400     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    TRKCS141
126500         SET DP013-LOGIC-ABEND   TO TRUE                          TRKCS141
126600         SET DP013-NO-ROLLBACK   TO TRUE                          TRKCS141
126700         MOVE '9500-DRS-FATAL-ERROR'                              TRKCS141
126800                                 TO DP013-PARAGRAPH               TRKCS141
126900         MOVE PV-CICS-RESPONSE   TO PM-CICS-RESP-11               TRKCS141
127000         MOVE PM-PROGRAM-MESSAGE-11                               TRKCS141
127100                                 TO DP013-MESSAGE-TEXT(1)         TRKCS141
127200         PERFORM 9999-ABEND                                       TRKCS141
127300     END-IF.                                                      TRKCS141
127400                                                                  TRKCS141
127500     PERFORM 9999-ABEND.                                          TRKCS141
127600                                                                  TRKCS141
127700/                                                                 TRKCS141
127800 9999-ABEND.                                                      TRKCS141
127900                                                                  TRKCS141
128000     MOVE 'TRKCS141'             TO DP013-PROGRAM.                TRKCS141
128100                                                                  TRKCS141
128200     SET DP013-LINK-RETURN       TO TRUE.                         TRKCS141
128300     SET DP013-NO-ROLLBACK       TO TRUE.                         TRKCS141
128400                                                                  TRKCS141
128500     INITIALIZE                     DP013-SRC-TASK-NUMBER         TRKCS141
128600                                    DP013-STACK.                  TRKCS141
128700                                                                  TRKCS141
128800     MOVE DFHEIBLK               TO DP013-DFHEIBLK.               TRKCS141
128900                                                                  TRKCS141
129000     EXEC CICS                                                    TRKCS141
129100         LINK PROGRAM  (DP013-NAME)                               TRKCS141
129200              COMMAREA (DP013-PARAMETERS)                         TRKCS141
129300              LENGTH   (DP013-LENGTH)                             TRKCS141
129400     END-EXEC.                                                    TRKCS141
129500                                                                  TRKCS141
129600     EXEC CICS                                                    TRKCS141
129700         RETURN                                                   TRKCS141
129800     END-EXEC.                                                    TRKCS141
129900                                                                  TRKCS141
