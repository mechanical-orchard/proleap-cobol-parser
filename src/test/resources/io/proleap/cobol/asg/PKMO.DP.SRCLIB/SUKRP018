000010*****************************************************************         
000020 IDENTIFICATION DIVISION.                                                 
000030*****************************************************************         
000040                                                                          
000050 PROGRAM-ID.             SUKRP018.                                        
000060 AUTHOR.                 MARY SARDINA.                                    
000070 INSTALLATION.           KOHLS DEPARTMENT STORES.                         
000080 DATE-WRITTEN            OCTOBER, 1997.                                   
000090 DATE-COMPILED.                                                           
000091*****************************************************************         
000092*****************************************************************         
000093*                                                               *         
000094*  THIS PROGRAM WILL EXTRACT RECEIVER INFORMATION FOR AUDITED   *         
000095*  POS.                                                         *         
000097*****************************************************************         
000098*  CHANGED 10/14/14 BY CHERI PARMLEY                            *         
000099*   CHG#0094517 EXPAND PO# FROM 7 TO 8 DIGITS                   *         
000100*                                                               *         
000098*  CHANGED MM/DD/YY BY XXXXXXXXXXX                              *         
000099*   WR# XXXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX *         
000100*                                                               *         
000110*****************************************************************         
000120*****************************************************************         
000130 ENVIRONMENT DIVISION.                                                    
000140*****************************************************************         
000150                                                                          
000160 CONFIGURATION SECTION.                                                   
000170                                                                          
000180 SOURCE-COMPUTER.        IBM-3090.                                        
000190 OBJECT-COMPUTER.        IBM-3090.                                        
000191                                                                          
000192 INPUT-OUTPUT SECTION.                                                    
000193                                                                          
000194 FILE-CONTROL.                                                            
000195*                                                                         
000196     SELECT CARDIN-AUDIT-NBR-FILE                                         
000197         ASSIGN TO CARDIN.                                                
000198                                                                          
000199     SELECT SU-CARTON-HEADER-RPT-FILE                             00360011
000200         ASSIGN TO RPT01.                                         00370011
000210*                                                                         
000220*****************************************************************         
000230 DATA DIVISION.                                                           
000240*****************************************************************         
000250*                                                                         
000260 FILE SECTION.                                                            
000270*                                                                         
000280 FD  CARDIN-AUDIT-NBR-FILE                                                
000290     LABEL RECORDS ARE STANDARD                                           
000291     RECORDING MODE IS F                                                  
000292     BLOCK CONTAINS 0 RECORDS                                             
000293     RECORD CONTAINS 80 CHARACTERS.                                       
000294 01  CC-RECORD                       PIC X(80).                           
000295                                                                          
000296*                                                                 00353025
000298 FD  SU-CARTON-HEADER-RPT-FILE                                          11
000299     RECORDING MODE IS F                                          00560011
000300     BLOCK CONTAINS 0  RECORDS.                                   00570011
000301 01  SU-CARTON-HEADER-RPT-RECORD     PIC  X(132).                 00580011
000306*                                                                         
000310                                                                          
000320 WORKING-STORAGE SECTION.                                                 
000321*                                                                         
000322 01  ABEND-CODE                      PIC S9(04)    VALUE +0               
000323                                                   COMP SYNC.             
000331*                                                                         
000340 01  PROGRAM-SWITCHES.                                                    
000341     05  PS-DATA-IND                 PIC  X(01)  VALUE 'N'.               
000342         88  PS-DATA                             VALUE 'Y'.               
000350         88  PS-NO-DATA                          VALUE 'N'.               
000362     05  PS-END-OF-SUATRN-CURSOR-SW  PIC  X(01)    VALUE 'N'.             
000363         88  PS-END-OF-SUATRN-CURSOR               VALUE 'Y'.             
000364         88  PS-NOT-END-OF-SUATRN-CURSOR          VALUE 'N'.              
000370     05  PS-END-OF-TRIP-CURSOR-SW    PIC  X(01)    VALUE 'N'.             
000380         88  PS-END-OF-TRIP-CURSOR                 VALUE 'Y'.             
000390         88  PS-NOT-END-OF-TRIP-CURSOR             VALUE 'N'.             
000391     05  PS-END-OF-CARTON-CURSOR-SW PIC   X(01)    VALUE 'N'.             
000392         88  PS-END-OF-CARTON-CURSOR               VALUE 'Y'.             
000393         88  PS-NOT-END-OF-CARTON-CURSOR           VALUE 'N'.             
000394     05  PS-END-OF-CARDIN-FILE-SW   PIC   X(01)    VALUE 'N'.             
000395         88  PS-END-OF-CARDIN-FILE                 VALUE 'Y'.             
000396         88  PS-NOT-END-OF-CARDIN-FILE             VALUE 'N'.             
000406*                                                                         
000407 01  PC-CONSTANTS.                                                        
000408     05  PC-REPORT-NBR               PIC  9(01)    VALUE 1.             11
000409     05  PC-1                        PIC S9(03)    VALUE +1               
000410                                                   COMP-3.                
000411     05  PC-13                       PIC S9(03)    VALUE +13            11
000412                                                   COMP-3.              11
000413     05  PC-A                        PIC  X(01)    VALUE 'A'.             
000414     05  PC-Y                        PIC  X(01)    VALUE 'Y'.             
000420     05  PC-RCV                      PIC  X(03)    VALUE 'RCV'.           
000431     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE                  
000432         'SUKRP018'.                                                      
000433     05  PC-FONT-CNTL-ON              PIC X(05)  VALUE '^PY^-'.           
000434     05  PC-FONT-CNTL-OFF             PIC X(05)  VALUE '^PN^-'.           
000435     05  PC-FONT-MED-4-BY-4           PIC X(09)  VALUE                    
000436                                                 '^M0404000'.             
000437     05  PC-CARR-RETURN               PIC  X(02)  VALUE '^-'.             
000440*                                                                         
000450 01  PV-MISC-FIELDS.                                                      
000451     05  PV-LINE-CNT                 PIC S9(03)    VALUE ZERO     02880011
000452                                                   COMP-3.        02890011
000453     05  PV-PAGE-CNT                 PIC S9(04)    VALUE ZERO     02900011
000454                                                   COMP-3.        02910011
000460     05  PV-LINE-SUB                 PIC S9(03)    VALUE ZERO             
000470                                                   COMP-3.                
000480     05  PV-ABEND-CODE               PIC S9(04)    VALUE ZERO             
000490                                                   COMP SYNC.             
000491     05  PV-PARAGRAPH-NAME           PIC  X(30)    VALUE SPACES.          
000492     05  PV-DB2-OPERATION-ATTEMPTED  PIC  X(30)    VALUE SPACES.          
000493     05  PV-ABEND-PARAGRAPH          PIC  X(30)    VALUE SPACES.          
000494     05  PV-AUDIT-NBR-X              PIC  X(09).                          
000495     05  PV-AUDIT-NBR REDEFINES PV-AUDIT-NBR-X                            
000496                                     PIC  9(09).                          
000497     05  PV-SKU-COUNT                    PIC S9(09)  VALUE +0             
000498                                                     COMP-3.              
000499     05  PV-WRITE-COUNT              PIC S9(09)    COMP.                  
000500     05  PV-QTY-RECV                 PIC S9(09)    COMP.                  
000501     05  PV-HOLD-PO-NBR              PIC S9(09)    COMP.                  
000502     05  PV-HOLD-REC-SEQ-NBR         PIC S9(09)    COMP.                  
000503     05  PV-TODAYS-DATE.                                                11
000504         10  PV-TODAYS-DATE-YY       PIC  9(02)    VALUE ZERO.          11
000505         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZERO.          11
000506         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZERO.          11
000507     05  PV-TODAYS-TIME.                                                11
000508         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZERO.          11
000509         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZERO.          11
000510         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZERO.          11
000511         10  FILLER                  PIC  9(02)    VALUE ZERO.          11
000512     05  PV-PRINT-LINE.                                                   
000513         10  PV-PL-HEADER.                                                
000514             15  PV-PL-HDR-PRIM       PIC  X(05)  VALUE SPACES.           
000515             15  PV-PL-HDR-SECN       PIC  X(04)  VALUE SPACES.           
000516         10  PV-PL-DATA               PIC X(122)  VALUE SPACES.           
000517 EJECT                                                                    
000518*                                                                         
000519 01  DK-DB-KEYS.                                                          
000520    05  DK-SHIPT-UNT-ID             PIC S9(18) COMP-3.                    
000521    05  DK-AUD-CNTL-NBR             PIC S9(09) COMP.                      
000522                                                                          
000523 01  CC-CARDIN.                                                           
000524     05  CC-AUDIT-CNTL-NBR           PIC 9(09).                           
000525     05  FILLER                      PIC X(62).                           
000526*                                                                         
000527 01  CC-CONTROL-CARD.                                             06940011
000528     05  CC-PRINTER-ID               PIC  X(08)    VALUE SPACES.  06950011
000529     05  CC-PRTR-CNTL-IND            PIC  X(01)    VALUE SPACE.   06960016
000530     05  CC-TRACK-NBR                PIC  9(01)    VALUE ZERO.    06970011
000531     05  CC-BRCDE-IND                PIC  X(01)    VALUE SPACE.   06970011
064784*DMB 9/18/01                                                              
000531     05  CC-PRTR-CUT-IND             PIC  X(01)    VALUE SPACE.   06970011
000532*                                                                         
000527 01  WS-PRINT-LINES.                                              06940011
000533     05  BLANK-LINE                  PIC  X(132)   VALUE SPACES.          
000534     05  BLANK-LINE-1.                                                    
000536*        10  FILLER                  PIC  X(03)    VALUE SPACE.   04620011
000537         10  FILLER                  PIC  X(31)    VALUE          04630011
000538             '                               '.                         11
000539         10  FILLER                  PIC  X(20)    VALUE SPACES.  04680011
000541         10  BLANK-CARR-RETURN       PIC  X(02)  VALUE '  '.              
000542*                                                                         
000543     05  NO-BAR-CODE-LINE.                                                
000544         10  FILLER                  PIC  X(50)    VALUE SPACE.   04620011
000545         10  PRINT-LINE              PIC  X(82)    VALUE SPACE.   04630011
000549*                                                                         
000550*  LAYOUT FOR THE PRINT PACKAGE PRINTER CONTROL COMMANDS                  
000551*                                                                         
000552     COPY DSWS004.                                                        
000553/                                                                         
000554*                                                                         
000555*  LAYOUT FOR THE PRINTER VALIDATION ROUTINE COMMAREA                     
000556*                                                                         
000557     COPY DPWS072.                                                        
000558/                                                                         
000559******************************************************************04420011
000560*  WORK FIELDS FOR PRINTING A 132 CHARACTER REPORT.               04430011
000561******************************************************************04440011
000562     COPY DPWS132O.                                               04450011
000563                                                                          
000564 01  HEADING-LINES.                                               04      
000565     05  HEADING-LINE-0.                                          04      
000566         10  FILLER                  PIC  X(52)    VALUE SPACES.  04      
000567         10  FILLER                  PIC  X(28)    VALUE          04      
000568             'VENDOR ACCURACY CARTON AUDIT'.                      04      
000569         10  FILLER                  PIC  X(52)    VALUE SPACES.  04      
000570*                                                                 04      
000571     05  HEADING-LINE-1.                                          04      
000572         10  FILLER                  PIC  X(57)    VALUE SPACES.  04      
000573         10  FILLER                  PIC  X(19)    VALUE          04      
000574             'HEADER LINE        '.                               04      
000575         10  FILLER                  PIC  X(56)    VALUE SPACES.  04      
000576*                                                                 04600011
000577     05  HEADING-LINE-2.                                          04610011
000578*        10  FILLER                  PIC  X(03)    VALUE SPACE.   04620011
000579         10  FILLER                  PIC  X(15)    VALUE          04630011
000580             'PO/RECEIVER:   '.                                   04640011
      *CLP 10/14/14 START                                                       
000581         10  HL2-PO-NBR              PIC  ZZZZZZZ9 VALUE ZEROS.   04650011
000582         10  FILLER                  PIC  X(03)    VALUE ' - '.   04660011
000583         10  HL2-REC-SEQ-NBR         PIC  9(03)    VALUE ZEROS.   04670011
000584         10  FILLER                  PIC  X(19)    VALUE SPACES.  04680011
      *CLP 10/14/14 END                                                         
000585         10  HL2-CARR-RETURN         PIC  X(02)    VALUE '  '.            
000586*                                                                 04600011
000587     05  HEADING-LINE-ASTERICKS.                                  04610011
000588*        10  FILLER                  PIC  X(03)    VALUE SPACE.   04620011
000589         10  FILLER                  PIC  X(31)    VALUE          04630011
000590             '*******************************'.                         11
000900         10  FILLER                  PIC  X(20)    VALUE SPACES.  04680011
000901         10  HL-ASTS-CARR-RETURN     PIC  X(02)  VALUE '  '.              
000902*                                                                 04600011
000903     05  HEADING-LINE-ASTERICK.                                   04610011
000904*        10  FILLER                  PIC  X(03)    VALUE SPACE.   04620011
000905         10  FILLER                  PIC  X(31)    VALUE          04630011
000906             '*                             *'.                         11
000908         10  FILLER                  PIC  X(20)    VALUE SPACES.  04680011
000909         10  HL-AST-CARR-RETURN      PIC  X(02)  VALUE '  '.              
000910*                                                                 04600011
001000     05  HEADING-LINE-3.                                          04610011
001100*        10  FILLER                  PIC  X(03)    VALUE SPACE.   04620011
001200         10  FILLER                  PIC  X(31)    VALUE          04630011
001310             '*    AUDIT CONTROL NUMBER     *'.                         11
001400         10  FILLER                  PIC  X(20)    VALUE SPACES.  04680011
001410         10  HL3-CARR-RETURN         PIC  X(02)  VALUE '  '.              
001500*                                                                 04600011
001600     05  HEADING-LINE-4.                                          04610011
001700*        10  FILLER                  PIC  X(03)    VALUE SPACE.   04620011
001701         10  FILLER                  PIC  X(01)    VALUE '*'.     04620011
001702         10  FILLER                  PIC  X(07)    VALUE SPACE.   04620011
001703         10  FILLER                  PIC  X(02)    VALUE '* '.    04620011
001710         10  HL4-AUD-CNTL-NBR        PIC  X(10)    VALUE SPACES.  05160011
002000         10  FILLER                  PIC  X(01)    VALUE '*'.           11
002001         10  FILLER                  PIC  X(09)    VALUE SPACES.  04680011
002010         10  FILLER                  PIC  X(01)    VALUE '*'.           11
002100         10  HL4-CARR-RETURN         PIC  X(02)    VALUE '  '.            
044804******************************************************************        
044805*  DB2 FORMATTED MESSAGE AREA                                             
044806******************************************************************        
044807     COPY DPWS004.                                                        
044808*                                                                         
044809*                                                                         
044810*  COPY BOOK FOR THE SHIPPING UNIT AUDIT TRANSACTION TABLE                
044811*                                                                         
044812     EXEC SQL                                                             
044813          INCLUDE TSUATRN                                                 
044814     END-EXEC.                                                            
044815                                                                          
044855                                                                          
044856 EJECT                                                                    
044857*  DB2 COMMUNICATION AREA                                                 
044858*                                                                         
044859     EXEC SQL                                                             
044860         INCLUDE SQLCA                                                    
044861     END-EXEC.                                                            
044862 EJECT                                                                    
044863*  DB2 COMMUNICATION AREA2                                                
044864*                                                                         
044865     COPY SQLCA2.                                                         
044866 EJECT                                                                    
044867                                                                          
044868     EXEC SQL                                                             
044869       DECLARE SUATRN-CSR CURSOR FOR                                      
044870         SELECT DISTINCT(TRN_NBR)                                         
044871                       ,(REC_SEQ_NBR)                                     
044872          FROM  TSUATRN                                                   
044873          WHERE AUD_CNTL_NBR        = :DK-AUD-CNTL-NBR                    
044874         GROUP BY TRN_NBR,REC_SEQ_NBR                                     
044875     END-EXEC.                                                            
044916*                                                                         
044917 PROCEDURE DIVISION.                                                      
044918*                                                                         
044919 0000-MAINLINE-PROCESSING.                                                
044920******************************************************************        
044921**  THIS IS THE MAIN DRIVER FOR THE PROGRAM.                              
044922******************************************************************        
044923*                                                                         
044924     PERFORM 1000-INITIALIZATION.                                         
044925*                                                                         
044926     IF PS-NOT-END-OF-CARDIN-FILE                                         
044927         PERFORM 2000-PROCESS-SUATRN                                      
044928            UNTIL PS-END-OF-CARDIN-FILE                                   
044929     END-IF.                                                              
044930     PERFORM 9000-EOJ-ROUTINE.                                            
044931*                                                                         
044932     GOBACK.                                                              
044933*                                                                         
044934*                                                                         
044935 1000-INITIALIZATION.                                                     
044936******************************************************************        
044937**  PERFORM THE INITIAL PROCESSING FOR THE PROGRAM.                       
044938******************************************************************        
044939                                                                          
044940     OPEN INPUT  CARDIN-AUDIT-NBR-FILE                                    
044942          OUTPUT SU-CARTON-HEADER-RPT-FILE                              11
044943                                                                          
044944     PERFORM 7000-READ-CARDIN-FILE.                                       
044945                                                                          
044952                                                                          
044953     DISPLAY 'AUDIT NBR IS : ' CC-AUDIT-CNTL-NBR.                         
044954     ACCEPT CC-CONTROL-CARD FROM SYSIN.                           08050011
044955     DISPLAY 'CONTROL CARD = ' CC-CONTROL-CARD.                   08060011
044956                                                                  08070011
044957     ACCEPT PV-TODAYS-DATE                                        08080011
044958       FROM DATE.                                                 08090011
044959*                                                                 08100011
044960     ACCEPT PV-TODAYS-TIME                                        08110011
044961       FROM TIME.                                                 08120011
044962*                                                                 08130011
044963     MOVE PC-REPORT-NBR      TO DP132O-REPORT-NUMBER.             08140011
044964     MOVE PV-TODAYS-DATE-MM  TO DP132O-RUN-MONTH.                 08150011
044965     MOVE PV-TODAYS-DATE-DD  TO DP132O-RUN-DAY.                   08160011
044966     MOVE PV-TODAYS-DATE-YY  TO DP132O-RUN-YEAR.                  08170011
044967*                                                                 08180011
044968     MOVE PV-TODAYS-TIME-HH  TO DP132O-RUN-HOUR.                  08190011
044969     MOVE PV-TODAYS-TIME-MM  TO DP132O-RUN-MINUTE.                08200011
044971     MOVE PC-CURRENT-PROGRAM-NAME                                         
044972                             TO DP132O-PROGRAM-NAME.              08210011
044973                                                                          
044974*    IF THERE IS NO DATA, PRINT NO DATA MESSAGE TO THE REPORT,            
044975*    OTHERWISE SET-UP THE PAGE HEADINGS                                   
044982     IF PS-END-OF-CARDIN-FILE                                             
044984         SET PS-NO-DATA                 TO TRUE                           
044985         DISPLAY '*******  NO DATA TO REPORT IN SUKRP018 ******'          
044986     ELSE                                                                 
044987         SET PS-DATA                    TO TRUE                           
044988*        IF THIS IS A PRINTEK PRINTER, LOAD THE FORM                      
044989         IF CC-PRTR-CNTL-IND = 'P'                                        
044990             MOVE CC-TRACK-NBR           TO DS004-PLC-LF-FORM-NBR         
044991             MOVE DS004-PES-8LPI         TO DS004-PLC-LF-LPI              
044992                                                                          
044993          WRITE SU-CARTON-HEADER-RPT-RECORD                             11
044995                 FROM DS004-PLC-LOAD-FORM                                 
044996             AFTER ADVANCING 1 LINE                                       
044997         END-IF                                                           
044998       END-IF.                                                            
044999*                                                                         
045000 2000-PROCESS-SUATRN.                                                     
045001     SET PS-NOT-END-OF-SUATRN-CURSOR TO TRUE.                             
045002     PERFORM 2100-OPEN-SUATRN-CURSOR.                                     
045003     PERFORM 2200-FETCH-SUATRN-CURSOR.                                    
045004     PERFORM 2300-PROCESS-SUATRN-CURSOR                                   
045005         UNTIL PS-END-OF-SUATRN-CURSOR.                                   
045006     PERFORM 2400-CLOSE-SUATRN-CURSOR.                                    
045007     PERFORM 7000-READ-CARDIN-FILE.                                       
045008 2100-OPEN-SUATRN-CURSOR.                                                 
045009     MOVE '2100-OPEN-SUATRN-CURSOR   '                                    
045010                                 TO PV-ABEND-PARAGRAPH.                   
045011     EXEC SQL                                                             
045012         OPEN SUATRN-CSR                                                  
045013     END-EXEC.                                                            
045014     EVALUATE TRUE                                                        
045015         WHEN SQLCODE = -904                                              
045016         WHEN SQLCODE = -911                                              
045017             CONTINUE                                                     
045018         WHEN SQLWARN0 NOT = SPACES                                       
045019         WHEN SQLCODE < ZERO                                              
045020         WHEN SQLCODE > ZERO                                              
045021             MOVE '2100-OPEN-SUATRN-CURSOR         '                      
045022                             TO PV-PARAGRAPH-NAME                         
045023             MOVE 'OPEN THE SUATRN_CUROSR         '                       
045024                             TO PV-DB2-OPERATION-ATTEMPTED                
045025             DISPLAY 'AUD CNTL NBR  ' DK-AUD-CNTL-NBR                     
045026             PERFORM 9100-SQL-ABEND                                       
045027     END-EVALUATE.                                                        
045028                                                                          
045029 2200-FETCH-SUATRN-CURSOR.                                                
045030     MOVE '2200-FETCH-SUATRN-CURSOR   '                                   
045031                                 TO PV-ABEND-PARAGRAPH.                   
045032     EXEC SQL                                                             
045033          FETCH SUATRN-CSR                                                
045034          INTO  :SUATRN-TRN-NBR                                           
045035              , :SUATRN-REC-SEQ-NBR                                       
045036              , :SUATRN-DEST-OPER-UNT-ID                                  
045037     END-EXEC.                                                            
045038                                                                          
045039     EVALUATE TRUE                                                        
045040       WHEN SQLCODE = ZEROS                                               
045041         CONTINUE                                                         
045042       WHEN SQLCODE = +100                                                
045043           SET PS-END-OF-SUATRN-CURSOR TO TRUE                            
045044       WHEN SQLWARN0 NOT = SPACES                                         
045045       WHEN SQLCODE < ZERO                                                
045046       WHEN SQLCODE > ZERO                                                
045047           MOVE '2200-FETCH-SUATRN-CURSOR'                                
045048                               TO PV-PARAGRAPH-NAME                       
045049           MOVE 'FETCH SUATRN CURSOR '                                    
045050                               TO PV-DB2-OPERATION-ATTEMPTED              
045051           DISPLAY 'AUD CNTL NBR  ' DK-AUD-CNTL-NBR                       
045052           PERFORM 9100-SQL-ABEND                                         
045053     END-EVALUATE.                                                        
045054                                                                          
045055 2300-PROCESS-SUATRN-CURSOR.                                              
045056     IF SUATRN-TRN-NBR = PV-HOLD-PO-NBR AND                               
045057        SUATRN-REC-SEQ-NBR = PV-HOLD-REC-SEQ-NBR                          
045058         CONTINUE                                                         
045059     ELSE                                                                 
045060         MOVE SUATRN-TRN-NBR       TO PV-HOLD-PO-NBR                      
045061                                      HL2-PO-NBR                        11
045062         MOVE SUATRN-REC-SEQ-NBR   TO PV-HOLD-REC-SEQ-NBR                 
045063                                      HL2-REC-SEQ-NBR                   11
045064         MOVE PV-AUDIT-NBR-X      TO  HL4-AUD-CNTL-NBR                  11
045065         PERFORM 8000-WRITE-REPORT-HEADERS                              11
045066     END-IF.                                                              
045067     PERFORM 2200-FETCH-SUATRN-CURSOR.                                    
045068                                                                          
045069                                                                          
045070 2400-CLOSE-SUATRN-CURSOR.                                                
045071     MOVE '2400-CLOSE-SUATRN-CURSOR   '                                   
045072                                 TO PV-ABEND-PARAGRAPH.                   
045073     EXEC SQL                                                             
045074         CLOSE SUATRN-CSR                                                 
045075     END-EXEC.                                                            
045076     EVALUATE TRUE                                                        
045077         WHEN SQLCODE = -904                                              
045078         WHEN SQLCODE = -911                                              
045079             CONTINUE                                                     
045080         WHEN SQLWARN0 NOT = SPACES                                       
045081         WHEN SQLCODE < ZERO                                              
045082         WHEN SQLCODE > ZERO                                              
045083             MOVE '2400-CLOSE-CURSOR '                                    
045084                             TO PV-PARAGRAPH-NAME                         
045085             MOVE 'CLOSE THE SUATRN_CURSOR        '                       
045086                             TO PV-DB2-OPERATION-ATTEMPTED                
045087             PERFORM 9100-SQL-ABEND                                       
045088          WHEN SQLCODE = ZERO                                             
045089              CONTINUE                                                    
045090     END-EVALUATE.                                                        
068591                                                                          
068592 7000-READ-CARDIN-FILE.                                                   
068593******************************************************************        
068594                                                                          
068595     READ CARDIN-AUDIT-NBR-FILE INTO CC-CARDIN                            
068596        AT END                                                            
068597           SET PS-END-OF-CARDIN-FILE TO TRUE.                             
068598                                                                          
068599     MOVE CC-AUDIT-CNTL-NBR   TO PV-AUDIT-NBR-X.                          
068600     MOVE PV-AUDIT-NBR        TO DK-AUD-CNTL-NBR.                         
068601                                                                          
068602                                                                          
068604                                                                  14540011
068605*                                                                 14550011
068606 8000-WRITE-REPORT-HEADERS.                                       14560011
068607******************************************************************14570011
068608*  PRINT THE HEADING FOR THE REPORT.                             *14580011
068609******************************************************************14590011
068610     PERFORM 8100-WRITE-TOP-LINE.                                 14600012
068611*                                                                 14610011
068614     WRITE SU-CARTON-HEADER-RPT-RECORD                                  11
068615       FROM HEADING-LINE-0                                        14630011
068616         AFTER ADVANCING 2 LINES.                                 14640011
068617*                                                                 14650011
068618     WRITE SU-CARTON-HEADER-RPT-RECORD                                  11
068620       FROM HEADING-LINE-1                                        14670011
068621         AFTER ADVANCING 1 LINE.                                  14680011
068622*                                                                 14650011
068623     WRITE SU-CARTON-HEADER-RPT-RECORD                                  11
068624       FROM BLANK-LINE                                            14670011
068625         AFTER ADVANCING 2 LINES.                                 14680011
068632                                                                          
068633*    IF THE PRINTER IS CAPABLE OF PRINTING BARCODES, PRINT THE            
068634*    STORE LINE                                                           
068635     IF CC-BRCDE-IND = 'Y'                                                
068636*        TURN ON CHARACTER CONTROL (MAGNUM CONTROL)                       
068637         MOVE DS004-PLC-ACTIVATE-IMAGE1                                   
068638                                     TO PV-PL-HDR-PRIM                    
068639         MOVE LOW-VALUES             TO PV-PL-HDR-SECN                    
068640         MOVE LOW-VALUES             TO PV-PL-DATA                        
068641         WRITE SU-CARTON-HEADER-RPT-RECORD FROM PV-PRINT-LINE           11
068642                                                                          
068643*        IF THE PRINTER IS THE "FORMSPRO" USE ITS CONTROL CHARACTE        
068644         IF CC-PRTR-CNTL-IND = 'P'                                        
068645*            FREE-FORM CONTROL                                            
068646             MOVE DS004-PLC-ACTIVATE-FF-PROC                              
068647                                 TO PV-PL-HDR-PRIM                        
068648             MOVE LOW-VALUES     TO PV-PL-HDR-SECN                        
068649             MOVE LOW-VALUES     TO PV-PL-DATA                            
068650             WRITE SU-CARTON-HEADER-RPT-RECORD FROM PV-PRINT-LINE       11
068654         END-IF                                                           
068655                                                                          
068656*        SET MEDIUM FONT (4 BY 4)                                         
068657         MOVE PC-FONT-MED-4-BY-4     TO PV-PL-HEADER                      
068660         MOVE PC-CARR-RETURN         TO HL2-CARR-RETURN                   
068661         MOVE HEADING-LINE-2      TO PV-PL-DATA                           
068662         WRITE SU-CARTON-HEADER-RPT-RECORD                              11
068663            FROM PV-PRINT-LINE                                          11
068664                AFTER ADVANCING 3 LINES                                 11
068668                                                                        11
068669         MOVE PC-CARR-RETURN  TO                                          
068670               BLANK-CARR-RETURN                                          
068671         MOVE BLANK-LINE-1            TO PV-PL-DATA                       
068672         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068673            FROM PV-PRINT-LINE                                          11
068674             AFTER ADVANCING 1 LINE                                     80
068675*                                                                         
068678         MOVE PC-CARR-RETURN         TO HL-ASTS-CARR-RETURN               
068679         MOVE HEADING-LINE-ASTERICKS  TO PV-PL-DATA                       
068680         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068681            FROM PV-PRINT-LINE                                          11
068682             AFTER ADVANCING 2 LINES                                    11
068683*                                                                       11
068684         MOVE PC-CARR-RETURN         TO HL-AST-CARR-RETURN                
068685         MOVE HEADING-LINE-ASTERICK   TO PV-PL-DATA                       
068686         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068687            FROM PV-PRINT-LINE                                          11
068688             AFTER ADVANCING 1 LINE                                     80
068689*                                                                         
068690                                                                          
068691                                                                          
068692         MOVE PC-CARR-RETURN         TO HL3-CARR-RETURN                   
068693         MOVE HEADING-LINE-3      TO PV-PL-DATA                           
068694         WRITE SU-CARTON-HEADER-RPT-RECORD                              11
068695            FROM PV-PRINT-LINE                                          11
068696                AFTER ADVANCING 1 LINE                                  11
068697                                                                          
068698         MOVE HEADING-LINE-ASTERICK   TO PV-PL-DATA                       
068699         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068700            FROM PV-PRINT-LINE                                          11
068701             AFTER ADVANCING 1 LINE                                     80
068702                                                                          
068703         MOVE PC-CARR-RETURN      TO HL4-CARR-RETURN                      
068704         MOVE HEADING-LINE-4      TO PV-PL-DATA                           
068705         WRITE SU-CARTON-HEADER-RPT-RECORD                              11
068706            FROM PV-PRINT-LINE                                          11
068707                AFTER ADVANCING 1 LINES                                 11
068708                                                                          
068709         MOVE HEADING-LINE-ASTERICK   TO PV-PL-DATA                       
068710         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068711            FROM PV-PRINT-LINE                                          11
068712             AFTER ADVANCING 1 LINE                                     80
068713                                                                        11
068714                                                                          
068715         MOVE HEADING-LINE-ASTERICKS  TO PV-PL-DATA                       
068716         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068717            FROM PV-PRINT-LINE                                          11
068718             AFTER ADVANCING 1 LINE                                     80
068719                                                                        11
068720                                                                          
068721*        IF THE PRINTER IS THE "FORMSPRO" USE ITS CONTROL CHARACTE        
068722         IF CC-PRTR-CNTL-IND = 'P'                                        
068723*            TURN OFF FREE-FORM CONTROL                                   
068724             MOVE DS004-PLC-DEACTIVATE-FF-PROC                            
068725                                         TO PV-PL-HDR-PRIM                
068726             MOVE LOW-VALUES             TO PV-PL-HDR-SECN                
068727             MOVE LOW-VALUES             TO PV-PL-DATA                    
068728             WRITE SU-CARTON-HEADER-RPT-RECORD                            
068729                  FROM PV-PRINT-LINE                                      
068730                                                                          
068731*            TURN OFF CHARACTER CONTROL (MAGNUM CONTROL)                  
068732             MOVE DS004-PLC-DEACTIVATE-IMAGE                              
068733                                         TO PV-PL-DATA                    
068737              WRITE SU-CARTON-HEADER-RPT-RECORD                           
068738                     FROM PV-PRINT-LINE                                   
068739                 AFTER ADVANCING 1 LINE                                   
068740         ELSE                                                             
068741*            TURN OFF CHARACTER CONTROL (MAGNUM CONTROL)                  
068742             MOVE '^PN^-'                TO PV-PL-HDR-PRIM                
068743             MOVE LOW-VALUES             TO PV-PL-HDR-SECN                
068744             MOVE LOW-VALUES             TO PV-PL-DATA                    
068745             WRITE SU-CARTON-HEADER-RPT-RECORD                            
068746                  FROM PV-PRINT-LINE                                      
068747         END-IF                                                           
068748     ELSE                                                                 
068749         MOVE HEADING-LINE-2 TO PRINT-LINE                                
068750             WRITE SU-CARTON-HEADER-RPT-RECORD                            
068751                FROM NO-BAR-CODE-LINE                                     
068752                AFTER ADVANCING 3 LINES                                 11
068753         MOVE HEADING-LINE-ASTERICKS TO PRINT-LINE                        
068754             WRITE SU-CARTON-HEADER-RPT-RECORD                            
068755              FROM NO-BAR-CODE-LINE                                       
068756                 AFTER ADVANCING 2 LINES                                80
068757         MOVE HEADING-LINE-ASTERICK TO PRINT-LINE                         
068758             WRITE SU-CARTON-HEADER-RPT-RECORD                            
068759                  FROM NO-BAR-CODE-LINE                                   
068760             AFTER ADVANCING 1 LINES                                  1480
068761         MOVE HEADING-LINE-3 TO PRINT-LINE                                
068762         WRITE SU-CARTON-HEADER-RPT-RECORD                              11
068763                  FROM NO-BAR-CODE-LINE                                   
068764                AFTER ADVANCING 1 LINES                                 11
068765         MOVE HEADING-LINE-ASTERICK TO PRINT-LINE                         
068766         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068767                  FROM NO-BAR-CODE-LINE                                   
068769             AFTER ADVANCING 1 LINES                                  1480
068770         MOVE HEADING-LINE-4 TO PRINT-LINE                                
068771         WRITE SU-CARTON-HEADER-RPT-RECORD                              11
068772                  FROM NO-BAR-CODE-LINE                                   
068774                AFTER ADVANCING 1 LINE                                  11
068775         MOVE HEADING-LINE-ASTERICK TO PRINT-LINE                         
068776         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068777                  FROM NO-BAR-CODE-LINE                                   
068779             AFTER ADVANCING 1 LINES                                  1480
068780         MOVE HEADING-LINE-ASTERICKS TO PRINT-LINE                        
068781         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068782                  FROM NO-BAR-CODE-LINE                                   
068784             AFTER ADVANCING 1 LINES                                  1480
068785     END-IF.                                                              
068786                                                                          
068787     MOVE PC-13                   TO PV-LINE-CNT.                 14980011
068788*                                                                 15000011
068789 8100-WRITE-TOP-LINE.                                             15010011
068790******************************************************************15020011
068791*     WRITES HEADER LINES 0 AND 1 WHEN MORE THAN ONE PAGE IS     *15030011
068792*     NEEDED FOR AN ASN NUMBER.                                  *15040011
068793******************************************************************15050011
068794     MOVE 1                       TO PV-PAGE-CNT.                 15060011
068795*                                                                 15070011
068796     MOVE PV-PAGE-CNT             TO DP132O-PAGE-NUMBER.          15080011
068797*                                                                 15090011
068798     WRITE SU-CARTON-HEADER-RPT-RECORD                                  11
068799       FROM DP132O-STANDRD-HEADER-132-COLS                        15110011
068800         AFTER ADVANCING PAGE.                                    15120011
068801*                                                                 15130011
068802*                                                                         
068803 9000-EOJ-ROUTINE.                                                        
068804*    IF THIS IS A PRINTEK PRINTER, CUT THE PAPER                          
068805*DMB 9/18/01   IF CC-PRTR-CNTL-IND = 'P'                                  
068805     IF CC-PRTR-CUT-IND = 'Y'                                             
068806         WRITE SU-CARTON-HEADER-RPT-RECORD                                
068807             FROM DS004-PLC-CUT-FORM                                      
068808         AFTER ADVANCING 1 LINE                                           
068809     END-IF.                                                              
068810                                                                          
068811     CLOSE CARDIN-AUDIT-NBR-FILE                                          
068812           SU-CARTON-HEADER-RPT-FILE.                                   11
068813                                                                          
068814 9100-SQL-ABEND.                                                          
068815******************************************************************        
068816*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL            
068817*  ERROR OR WARNING CODE OCCURS.                                          
068818******************************************************************        
068819     DISPLAY '** ABEND     **'.                                           
068820     DISPLAY '** PROGRAM   ** = ' PC-CURRENT-PROGRAM-NAME.                
068821     DISPLAY '** PARAGRAPH ** = ' PV-PARAGRAPH-NAME.                      
068822     DISPLAY '** OPERATION ** = ' PV-DB2-OPERATION-ATTEMPTED.             
068823                                                                          
068824******************************************************************        
068825* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-            
068826* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE                 
068827* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE             
068828* FORMAT.                                                                 
068829******************************************************************        
068830     COPY DPPD004.                                                        
068831                                                                          
068840     MOVE +4013                  TO ABEND-CODE.                           
068900     CALL 'ILBOABN0' USING ABEND-CODE.                                    
