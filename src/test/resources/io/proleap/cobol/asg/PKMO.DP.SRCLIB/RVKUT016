000100 IDENTIFICATION DIVISION.                                         00010005
000200                                                                  00020005
000300 PROGRAM-ID.             RVKUT016.                                00030005
000400 AUTHOR.                 VIRGENE LENNEMAN                         00040005
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050005
000600 DATE-WRITTEN.           JANUARY 2004.                            00060005
000700 DATE-COMPILED.                                                   00070005
000800                                                                  00080005
000900***************************************************************** 00090005
001000*  PROGRAM NARRATIVE:                                             00100005
001100*  THIS PROGRAM READS AN EXTRACT FILE OF RTV TRANSACTIONS FROM    00110005
001200*  RVKUT015 AND CREATES THE AP TRANSACTION RECORDS.  IT ALSO      00120005
001300*  CREATES THE RTV - AP CONTROL REPORT                            00130005
001400***************************************************************** 00140005
001500                                                                  00150005
001600 ENVIRONMENT DIVISION.                                            00160005
001700                                                                  00170005
001800 CONFIGURATION SECTION.                                           00180005
001900                                                                  00190005
002000 SOURCE-COMPUTER.                        IBM-3090.                00200005
002100 OBJECT-COMPUTER.                        IBM-3090.                00210005
002200                                                                  00220005
002300 INPUT-OUTPUT SECTION.                                            00230005
002400                                                                  00240005
002500 FILE-CONTROL.                                                    00250005
002600                                                                  00260005
002700     SELECT  RV-EXTRACT-FILE                                      00270005
002800         ASSIGN TO INP01.                                         00280005
002900                                                                  00290005
003000     SELECT  AP-TRANSACTION-FILE                                  00300005
003100         ASSIGN TO OUT01.                                         00310005
003200                                                                  00320005
003300     SELECT  REPORT-FILE                                          00330005
003400         ASSIGN TO RPT01.                                         00340005
003500                                                                  00350005
003600******************************************************************00360005
003700 DATA DIVISION.                                                   00370005
003800******************************************************************00380005
003900                                                                  00390005
004000 FILE SECTION.                                                    00400005
004100*                                                                 00410005
004200 FD  RV-EXTRACT-FILE                                              00420005
004300     RECORDING MODE IS F                                          00430005
004400     LABEL RECORDS ARE STANDARD                                   00440005
004500     BLOCK CONTAINS 0 RECORDS.                                    00450005
004600 01  RV-EXT-REC                       PIC  X(500).                00460005
004700*                                                                 00470005
004800 FD  AP-TRANSACTION-FILE                                          00480005
004900     RECORDING MODE IS F                                          00490005
005000     LABEL RECORDS ARE STANDARD                                   00500005
005100     BLOCK CONTAINS 0 RECORDS.                                    00510005
005200 01  AP-TRANSACTION-RECORD            PIC  X(500).                00520005
005300*                                                                 00530005
005400 FD  REPORT-FILE                                                  00540005
005500     RECORDING MODE IS F                                          00550005
005600     LABEL RECORDS ARE OMITTED                                    00560005
005700     BLOCK CONTAINS 0 RECORDS.                                    00570005
P49473*01  REPORT-LINE                      PIC  X(132).                00580005
P49473 01  REPORT-LINE                      PIC  X(150).                00590005
005900*                                                                 00600005
006000 WORKING-STORAGE SECTION.                                         00610005
006100 01  PC-CONSTANTS.                                                00620005
006200     05  PC-CURRENT-PGM-RVKUT016      PIC  X(08) VALUE 'RVKUT016'.00630005
006300     05  PC-LINE-LIMIT                PIC  9(02) VALUE 55.        00640005
006400     05  PC-DEBIT-LEGEND              PIC  X(30) VALUE            00650005
006500              '          DEBIT AMOUNT TOTAL ='.                   00660005
006600     05  PC-VENDOR-LEGEND             PIC  X(30) VALUE            00670005
006700              '          VENDOR       TOTAL ='.                   00680005
006800     05  PC-FIN-DND-LEGEND            PIC  X(30) VALUE            00690005
006900              'GRAND DEBIT TOTAL D & D (54) ='.                   00700005
007000     05  PC-FIN-RTV-LEGEND            PIC  X(30) VALUE            00710005
007100              'GRAND DEBIT TOTAL  RTV  (55) ='.                   00720005
007200     05  PC-FAC-DND-LEGEND            PIC  X(30) VALUE            00730005
007300              'FCLTY DEBIT TOTAL D & D (54) ='.                   00740005
007400     05  PC-FAC-RTV-LEGEND            PIC  X(30) VALUE            00750005
007500              'FCLTY DEBIT TOTAL  RTV  (55) ='.                   00760005
007600     05  PC-GRAND-TOTAL-LEGEND        PIC  X(30) VALUE            00770005
007700              'ALL FACILITIES                '.                   00780005
007800     05  PC-VNDR-LEGEND               PIC  X(07) VALUE 'VENDOR:'. 00790005
007900     05  PC-DUNS-LEGEND               PIC  X(07) VALUE 'DUNS #:'. 00800005
008000     05  PC-BLANK-LINE                PIC  X(132) VALUE SPACES.   00810005
008100     05  PC-END-OF-REPORT-LINE.                                   00820005
008200         10  FILLER                   PIC  X(88) VALUE SPACES.    00830005
008300         10  FILLER                   PIC  X(25) VALUE            00840005
008400              '* * * END OF REPORT * * *'.                        00850005
008500         10  FILLER                   PIC  X(87) VALUE SPACES.    00860005
008600     05  PC-EMPTY-REPORT-LINE.                                    00870005
008700         10  FILLER                   PIC  X(52) VALUE SPACES.    00880005
008800         10  FILLER                   PIC  X(29) VALUE            00890005
008900              'NO RTV TRANSACTIONS TO REPORT'.                    00900005
009000         10  FILLER                   PIC  X(51) VALUE SPACES.    00910005
009100                                                                  00920005
009200 01  PS-SWITCHES.                                                 00930005
009300     05  PS-EOF-EXTRACT-SWITCH        PIC  X(01) VALUE 'N'.       00940005
009400         88  PS-EOF-EXTRACT                      VALUE 'Y'.       00950005
009500         88  PS-NOT-EOF-EXTRACT                  VALUE 'N'.       00960005
009600     05  PS-1ST-TIME-SWITCH           PIC  X(01) VALUE 'Y'.       00970005
009700         88  PS-1ST-TIME                         VALUE 'Y'.       00980005
009800         88  PS-NOT-1ST-TIME                     VALUE 'N'.       00990005
009900     05  PS-PRINT-VNDR-DUNS-SWITCH    PIC  X(01) VALUE 'Y'.       01000005
010000         88  PS-PRINT-VNDR-DUNS                  VALUE 'Y'.       01010005
010100         88  PS-NOT-PRINT-VNDR-DUNS              VALUE 'N'.       01020005
010200     05  PS-NEW-FACILITY-SWITCH       PIC  X(01) VALUE 'Y'.       01030005
010300         88  PS-NEW-FACILITY                     VALUE 'Y'.       01040005
010400         88  PS-NOT-NEW-FACILITY                 VALUE 'N'.       01050005
010500     05  PS-GRAND-TOTAL-SWITCH        PIC  X(01) VALUE 'Y'.       01060005
010600         88  PS-GRAND-TOTAL                      VALUE 'N'.       01070005
010700         88  PS-NOT-GRAND-TOTAL                  VALUE 'Y'.       01080005
010710     05  PS-NO-PREVIOUS-STR-SW        PIC  X(01) VALUE 'N'.       01090005
010720         88  PS-PREVIOUS-STR                     VALUE 'Y'.       01100005
010730         88  PS-NO-PREVIOUS-STR                  VALUE 'N'.       01110005
010800                                                                  01120005
010900 01  PV-VARIABLES.                                                01130005
011000     05  PV-READ-COUNT                PIC  9(11) VALUE ZERO.      01140005
011100     05  PV-WRITE-TRAN-CNT            PIC  9(11) VALUE ZERO.      01150005
011200     05  PV-WRITE-REPT-CNT            PIC  9(11) VALUE ZERO.      01160005
011300     05  PV-DISP-NUMBER               PIC  ZZ,ZZZ,ZZZ,ZZ9.        01170005
011400     05  PV-PAGE-COUNT                PIC  9(04) VALUE ZERO.      01180005
011500     05  PV-LINE-COUNT                PIC  9(04) VALUE ZERO.      01190005
011600     05  PV-PREV-STR-NBR              PIC  9(05) VALUE ZERO.      01200005
011610     05  PV-PREV-STR-NME              PIC  X(25) VALUE SPACES.    01210005
011700     05  PV-PREV-ENT-NME-DESC         PIC  X(30) VALUE SPACES.    01220005
011800     05  PV-PREV-DOC-NBR              PIC  X(16) VALUE SPACES.    01230005
011900     05  PV-PREV-DEPT-NBR             PIC  X(04) VALUE SPACES.    01240005
012000     05  PV-PREV-CL-NBR               PIC  9(04) VALUE ZEROS.     01250005
012100     05  PV-PREV-AP-TRN-CDE           PIC  X(02) VALUE ZEROS.     01260005
012200     05  PV-PREV-VENDOR-DUNS-NBR      PIC  X(09) VALUE ZEROS.     01270005
012300     05  PV-AP-TRN-CDE                PIC  X(02) VALUE SPACES.    01280005
012400         88 PV-AP-TRN-CDE-DND                    VALUE '54'.      01290005
012500         88 PV-AP-TRN-CDE-RTV                    VALUE '55'.      01300005
012600                                                                  01310005
012700     05  PV-CTL-RECORD-FIELDS.                                    01320005
012800         10 PV-CTL-RECORD-COUNT       PIC S9(11) COMP-3 VALUE +0. 01330005
012900         10 PV-CTL-GRO-COST-AMT       PIC S9(11)V99 COMP-3        01340005
013000                                                        VALUE +0. 01350005
013100         10 PV-CTL-FRGT-AMT           PIC S9(11)V99 COMP-3        01360005
013200                                                        VALUE +0. 01370005
013300         10 PV-CTL-TRD-DISC-AMT       PIC S9(11)V99 COMP-3        01380005
013400                                                        VALUE +0. 01390005
013500         10 PV-CTL-NET-COST-AMT       PIC S9(11)V99 COMP-3        01400005
013600                                                        VALUE +0. 01410005
013700         10 PV-CTL-RETL-AMT           PIC S9(11)V99 COMP-3        01420005
013800                                                        VALUE +0. 01430005
013900     05  PV-DEBIT-TOTAL-FIELDS.                                   01440005
014000         10 PV-DEBIT-AMT-TOT          PIC S9(11)V99 COMP-3        01450005
014100                                                        VALUE +0. 01460005
014200         10 PV-DEBIT-COST             PIC S9(11)V99 COMP-3        01470005
014300                                                        VALUE +0. 01480005
014400         10 PV-DEBIT-RETAIL           PIC S9(11)V99 COMP-3        01490005
014500                                                        VALUE +0. 01500005
014600         10 PV-DEBIT-INB-FRGT         PIC S9(11)V99 COMP-3        01510005
014700                                                        VALUE +0. 01520005
014800         10 PV-DEBIT-OUT-FRGT         PIC S9(11)V99 COMP-3        01530005
014900                                                        VALUE +0. 01540005
015000         10 PV-DEBIT-DEDUCTION        PIC  9(11)V99 COMP-3        01550005
015100                                                        VALUE  0. 01560005
015200         10 PV-DEBIT-DISCOUNT         PIC  9(11)V99 COMP-3        01570005
015300                                                        VALUE  0. 01580005
015400         10 PV-DEBIT-DISC-PCT         PIC  9(03)V99 COMP-3        01590005
015500                                                        VALUE  0. 01600005
015600     05  PV-VENDR-TOTAL-FIELDS.                                   01610005
015700         10 PV-VENDR-AMT-TOT          PIC S9(11)V99 COMP-3        01620005
015800                                                        VALUE +0. 01630005
015900         10 PV-VENDR-COST             PIC S9(11)V99 COMP-3        01640005
016000                                                        VALUE +0. 01650005
016100         10 PV-VENDR-RETAIL           PIC S9(11)V99 COMP-3        01660005
016200                                                        VALUE +0. 01670005
016300         10 PV-VENDR-INB-FRGT         PIC S9(11)V99 COMP-3        01680005
016400                                                        VALUE +0. 01690005
016500         10 PV-VENDR-OUT-FRGT         PIC S9(11)V99 COMP-3        01700005
016600                                                        VALUE +0. 01710005
016700         10 PV-VENDR-DEDUCTION        PIC  9(11)V99 COMP-3        01720005
016800                                                        VALUE  0. 01730005
016900         10 PV-VENDR-DISCOUNT         PIC  9(11)V99 COMP-3        01740005
017000                                                        VALUE  0. 01750005
017100         10 PV-VENDR-DISC-PCT         PIC  9(03)V99 COMP-3        01760005
017200                                                        VALUE  0. 01770005
017300         10 PV-VENDR-DISC-PCT-X REDEFINES PV-VENDR-DISC-PCT       01780005
017400                                      PIC  X(03).                 01790005
017500     05  PV-FCLTY-TOTAL-FIELDS-DND.                               01800005
017600         10 PV-FCLTY-AMT-TOT-DND      PIC S9(11)V99 COMP-3        01810005
017700                                                        VALUE +0. 01820005
017800         10 PV-FCLTY-COST-DND         PIC S9(11)V99 COMP-3        01830005
017900                                                        VALUE +0. 01840005
018000         10 PV-FCLTY-RETAIL-DND       PIC S9(11)V99 COMP-3        01850005
018100                                                        VALUE +0. 01860005
018200         10 PV-FCLTY-INB-FRGT-DND     PIC S9(11)V99 COMP-3        01870005
018300                                                        VALUE +0. 01880005
018400         10 PV-FCLTY-OUT-FRGT-DND     PIC S9(11)V99 COMP-3        01890005
018500                                                        VALUE +0. 01900005
018600         10 PV-FCLTY-DEDUCTION-DND    PIC  9(11)V99 COMP-3        01910005
018700                                                        VALUE  0. 01920005
018800         10 PV-FCLTY-DISCOUNT-DND     PIC  9(11)V99 COMP-3        01930005
018900                                                        VALUE  0. 01940005
019000         10 PV-FCLTY-DISC-PCT-DND     PIC  9(03)V99 COMP-3        01950005
019100                                                        VALUE  0. 01960005
019200         10 PV-FCLTY-DISC-PCT-DND-X                               01970005
019300                                  REDEFINES PV-FCLTY-DISC-PCT-DND 01980005
019400                                      PIC  X(03).                 01990005
019500     05  PV-FCLTY-TOTAL-FIELDS-RTV.                               02000005
019600         10 PV-FCLTY-AMT-TOT-RTV      PIC S9(11)V99 COMP-3        02010005
019700                                                        VALUE +0. 02020005
019800         10 PV-FCLTY-COST-RTV         PIC S9(11)V99 COMP-3        02030005
019900                                                       VALUE +0.  02040005
020000        10 PV-FCLTY-RETAIL-RTV       PIC S9(11)V99 COMP-3         02050005
020100                                                       VALUE +0.  02060005
020200        10 PV-FCLTY-INB-FRGT-RTV     PIC S9(11)V99 COMP-3         02070005
020300                                                       VALUE +0.  02080005
020400        10 PV-FCLTY-OUT-FRGT-RTV     PIC S9(11)V99 COMP-3         02090005
020500                                                       VALUE +0.  02100005
020600        10 PV-FCLTY-DEDUCTION-RTV    PIC  9(11)V99 COMP-3         02110005
020700                                                       VALUE  0.  02120005
020800        10 PV-FCLTY-DISCOUNT-RTV     PIC  9(11)V99 COMP-3         02130005
020900                                                       VALUE  0.  02140005
021000        10 PV-FCLTY-DISC-PCT-RTV     PIC  9(03)V99 COMP-3         02150005
021100                                                       VALUE  0.  02160005
021200        10 PV-FCLTY-DISC-PCT-RTV-X                                02170005
021300                                 REDEFINES PV-FCLTY-DISC-PCT-RTV  02180005
021400                                     PIC  X(03).                  02190005
021500    05  PV-FINAL-TOTAL-FIELDS-DND.                                02200005
021600        10 PV-FINAL-AMT-TOT-DND      PIC S9(11)V99 COMP-3         02210005
021700                                                        VALUE +0. 02220005
021800         10 PV-FINAL-COST-DND         PIC S9(11)V99 COMP-3        02230005
021900                                                        VALUE +0. 02240005
022000         10 PV-FINAL-RETAIL-DND       PIC S9(11)V99 COMP-3        02250005
022100                                                        VALUE +0. 02260005
022200         10 PV-FINAL-INB-FRGT-DND     PIC S9(11)V99 COMP-3        02270005
022300                                                        VALUE +0. 02280005
022400         10 PV-FINAL-OUT-FRGT-DND     PIC S9(11)V99 COMP-3        02290005
022500                                                        VALUE +0. 02300005
022600         10 PV-FINAL-DEDUCTION-DND    PIC  9(11)V99 COMP-3        02310005
022700                                                        VALUE  0. 02320005
022800         10 PV-FINAL-DISCOUNT-DND     PIC  9(11)V99 COMP-3        02330005
022900                                                        VALUE  0. 02340005
023000         10 PV-FINAL-DISC-PCT-DND     PIC  9(03)V99 COMP-3        02350005
023100                                                        VALUE  0. 02360005
023200         10 PV-FINAL-DISC-PCT-DND-X                               02370005
023300                                  REDEFINES PV-FINAL-DISC-PCT-DND 02380005
023400                                      PIC  X(03).                 02390005
023500     05  PV-FINAL-TOTAL-FIELDS-RTV.                               02400005
023600         10 PV-FINAL-AMT-TOT-RTV      PIC S9(11)V99 COMP-3        02410005
023700                                                        VALUE +0. 02420005
023800         10 PV-FINAL-COST-RTV         PIC S9(11)V99 COMP-3        02430005
023900                                                        VALUE +0. 02440005
024000         10 PV-FINAL-RETAIL-RTV       PIC S9(11)V99 COMP-3        02450005
024100                                                        VALUE +0. 02460005
024200         10 PV-FINAL-INB-FRGT-RTV     PIC S9(11)V99 COMP-3        02470005
024300                                                        VALUE +0. 02480005
024400         10 PV-FINAL-OUT-FRGT-RTV     PIC S9(11)V99 COMP-3        02490005
024500                                                        VALUE +0. 02500005
024600         10 PV-FINAL-DEDUCTION-RTV    PIC  9(11)V99 COMP-3        02510005
024700                                                        VALUE  0. 02520005
024800         10 PV-FINAL-DISCOUNT-RTV     PIC  9(11)V99 COMP-3        02530005
024900                                                        VALUE  0. 02540005
025000         10 PV-FINAL-DISC-PCT-RTV     PIC  9(03)V99 COMP-3        02550005
025100                                                        VALUE  0. 02560005
025200         10 PV-FINAL-DISC-PCT-RTV-X                               02570005
025300                                  REDEFINES PV-FINAL-DISC-PCT-RTV 02580005
025400                                      PIC  X(03).                 02590005
025500                                                                  02600005
025600****** RV EXTRACT RECORD LAYOUT                                   02610005
025700     COPY RVRD005.                                                02620005
025800                                                                  02630005
025900****** AP TRANSACTION RECORD LAYOUT                               02640005
026000     COPY APRD045.                                                02650005
026100                                                                  02660005
026200****** STANDARD COPYBOOK FOR 132 COL REPORT                       02670005
P49473*    COPY DPWS132.                                                02680005
P49473****** STANDARD COPYBOOK FOR 150 COL REPORT                       02690005
P49473     COPY DPWS150.                                                02700005
026400                                                                  02710005
026500 01  SYSTEM-DATE-TIME.                                            02720005
026600     05  SD-SYSTEM-DATE.                                          02730005
026700         10  SD-CD-CCYY               PIC 9(04)  VALUE ZEROS.     02740005
026800         10  SD-CD-MM                 PIC 9(02)  VALUE ZEROS.     02750005
026900         10  SD-CD-DD                 PIC 9(02)  VALUE ZEROS.     02760005
027000     05  ST-SYSTEM-TIME.                                          02770005
027100         10  ST-CT-HH                 PIC 9(02)  VALUE ZEROS.     02780005
027200         10  ST-CT-MM                 PIC 9(02)  VALUE ZEROS.     02790005
027300         10  FILLER                   PIC 9(04)  VALUE ZEROS.     02800005
027400                                                                  02810005
027500 01  RL-REPORT-LINES.                                             02820005
027600     05  HL2-HEADING-LINE2.                                       02830005
027700         10  FILLER                   PIC  X(55) VALUE SPACES.    02840005
027800         10  FILLER                   PIC  X(23) VALUE            02850005
027900             'RETURN TO VENDOR SYSTEM'.                           02860005
028000         10  FILLER                   PIC  X(54) VALUE SPACES.    02870005
028100                                                                  02880005
028200     05  HL3-HEADING-LINE3.                                       02890005
028300         10  FILLER                   PIC  X(56) VALUE SPACES.    02900005
028400         10  FILLER                   PIC  X(21) VALUE            02910005
028500             'AP CONTROL REPORT FOR'.                             02920005
028600         10  FILLER                   PIC  X(55) VALUE SPACES.    02930005
028700                                                                  02940005
028800     05  HL4-HEADING-LINE4.                                       02950005
028900         10  FILLER                   PIC  X(56) VALUE SPACES.    02960005
029000         10  HL4-FACILITY-NAME        PIC  X(30) VALUE SPACES.    02970005
029100         10  FILLER                   PIC  X(46) VALUE SPACES.    02980005
029200                                                                  02990005
029300     05  CL0-COL-HEADING-LINE0.                                   03000005
P49473*        10  FILLER                   PIC  X(125) VALUE SPACES.   03010006
P49473         10  FILLER                   PIC  X(134) VALUE SPACES.   03011006
029500         10  FILLER                   PIC  X(04) VALUE 'DED/'.    03020005
P49473*        10  FILLER                   PIC  X(03) VALUE SPACES.    03030006
P49473         10  FILLER                   PIC  X(12) VALUE SPACES.    03031006
029700                                                                  03040005
029800     05  CL1-COL-HEADING-LINE1.                                   03050005
029900         10  FILLER                   PIC  X(02) VALUE SPACES.    03060005
030000         10  FILLER                   PIC  X(05) VALUE 'TRANS'.   03070005
030100         10  FILLER                   PIC  X(03) VALUE SPACES.    03080005
030200         10  FILLER                   PIC  X(05) VALUE 'DEBIT'.   03090005
P49473*        10  FILLER                   PIC  X(02) VALUE SPACES.    03100005
P49473         10  FILLER                   PIC  X(11) VALUE SPACES.    03110005
030400         10  FILLER                   PIC  X(04) VALUE 'DEPT'.    03120005
030500         10  FILLER                   PIC  X(02) VALUE SPACES.    03130005
030600         10  FILLER                   PIC  X(05) VALUE 'MAJOR'.   03140005
030700         10  FILLER                   PIC  X(25) VALUE SPACES.    03150005
030800         10  FILLER                   PIC  X(05) VALUE 'TOTAL'.   03160005
030900         10  FILLER                   PIC  X(08) VALUE SPACES.    03170005
031000         10  FILLER                   PIC  X(05) VALUE 'TOTAL'.   03180005
031100         10  FILLER                   PIC  X(06) VALUE SPACES.    03190005
031200         10  FILLER                   PIC  X(07) VALUE 'INBOUND'. 03200005
031300         10  FILLER                   PIC  X(05) VALUE SPACES.    03210005
031400         10  FILLER                   PIC  X(08) VALUE 'OUTBOUND'.03220005
031500         10  FILLER                   PIC  X(04) VALUE SPACES.    03230005
031600         10  FILLER                  PIC  X(09) VALUE 'DEDUCTION'.03240005
031700         10  FILLER                   PIC  X(08) VALUE SPACES.    03250005
031800         10  FILLER                   PIC  X(04) VALUE 'DISC'.    03260005
031900         10  FILLER                   PIC  X(03) VALUE SPACES.    03270005
032000         10  FILLER                   PIC  X(04) VALUE 'DISC'.    03280005
P49473*        10  FILLER                   PIC  X(03) VALUE SPACES.    03290005
P49473         10  FILLER                   PIC  X(12) VALUE SPACES.    03300005
032200     05  CL2-COL-HEADING-LINE2.                                   03310005
032300         10  FILLER                   PIC  X(03) VALUE SPACES.    03320005
032400         10  FILLER                   PIC  X(04) VALUE 'TYPE'.    03330005
032500         10  FILLER                   PIC  X(04) VALUE SPACES.    03340005
032600         10  FILLER                   PIC  X(03) VALUE 'NBR'.     03350005
P49473*        10  FILLER                   PIC  X(04) VALUE SPACES.    03360005
P49473         10  FILLER                   PIC  X(13) VALUE SPACES.    03370005
032800         10  FILLER                   PIC  X(03) VALUE 'NBR'.     03380005
032900         10  FILLER                   PIC  X(02) VALUE SPACES.    03390005
033000         10  FILLER                   PIC  X(05) VALUE 'CLASS'.   03400005
033100         10  FILLER                   PIC  X(26) VALUE SPACES.    03410005
033200         10  FILLER                   PIC  X(04) VALUE 'COST'.    03420005
033300         10  FILLER                   PIC  X(07) VALUE SPACES.    03430005
033400         10  FILLER                   PIC  X(06) VALUE 'RETAIL'.  03440005
033500         10  FILLER                   PIC  X(06) VALUE SPACES.    03450005
033600         10  FILLER                   PIC  X(07) VALUE 'FREIGHT'. 03460005
033700         10  FILLER                   PIC  X(06) VALUE SPACES.    03470005
033800         10  FILLER                   PIC  X(07) VALUE 'FREIGHT'. 03480005
033900         10  FILLER                   PIC  X(10) VALUE SPACES.    03490005
034000         10  FILLER                   PIC  X(03) VALUE 'AMT'.     03500005
034100         10  FILLER                   PIC  X(09) VALUE SPACES.    03510005
034200         10  FILLER                   PIC  X(03) VALUE 'AMT'.     03520005
034300         10  FILLER                   PIC  X(04) VALUE SPACES.    03530005
034400         10  FILLER                   PIC  X(01) VALUE '%'.       03540005
P49473*        10  FILLER                   PIC  X(05) VALUE SPACES.    03550005
P49473         10  FILLER                   PIC  X(14) VALUE SPACES.    03560005
034600                                                                  03570005
034700     05  CL3-COL-HEADING-LINE3.                                   03580005
034800         10  FILLER                   PIC  X(07) VALUE SPACES.    03590005
034900         10  CL3-VENDOR-LEGEND        PIC  X(07) VALUE 'VENDOR:'. 03600005
035000         10  FILLER                   PIC  X(01) VALUE SPACES.    03610005
035100         10  CL3-VENDOR-NAME          PIC  X(30) VALUE SPACES.    03620005
035200         10  FILLER                   PIC  X(02) VALUE SPACES.    03630005
035300         10  CL3-DUNS-LEGEND          PIC  X(07) VALUE 'DUNS #:'. 03640005
035400         10  CL3-DUNS-NBR             PIC  X(09) VALUE SPACES.    03650005
035500         10  FILLER                   PIC  X(69) VALUE SPACES.    03660005
035600                                                                  03670005
035700     05  DL1-DETAIL-LINE-1.                                       03680005
035800         10  FILLER                   PIC  X(04) VALUE SPACES.    03690005
035900         10  DL1-TRAN-TYPE            PIC  X(03) VALUE SPACES.    03700005
036000         10  FILLER                   PIC  X(01) VALUE SPACES.    03710005
P49473*        10  DL1-DEBIT-NBR            PIC  X(08) VALUE SPACES.    03720005
P49473         10  DL1-DEBIT-NBR            PIC  X(16) VALUE SPACES.    03730005
P49473*        10  FILLER                   PIC  X(01) VALUE SPACES.    03740005
P49473         10  FILLER                   PIC  X(02) VALUE SPACES.    03750005
036300         10  DL1-DEPT-NBR             PIC  X(04) VALUE SPACES.    03760005
036400         10  FILLER                   PIC  X(03) VALUE SPACES.    03770005
036500         10  DL1-MAJ-CLASS            PIC  X(02) VALUE SPACES.    03780005
036600         10  FILLER                   PIC  X(21) VALUE SPACES.    03790005
036700         10  DL1-COST-AMT             PIC  ZZZZZZZ9.99-.          03800005
036800         10  FILLER                   PIC  X(01) VALUE SPACES.    03810005
036900         10  DL1-RETAIL-AMT           PIC  ZZZZZZZ9.99-.          03820005
037000         10  FILLER                   PIC  X(01) VALUE SPACES.    03830005
037100         10  DL1-INB-FREIGHT          PIC  ZZZZZZZ9.99-.          03840005
037200         10  FILLER                   PIC  X(01) VALUE SPACES.    03850005
037300         10  DL1-OUTB-FREIGHT         PIC  ZZZZZZZ9.99-.          03860005
037400         10  FILLER                   PIC  X(01) VALUE SPACES.    03870005
037500         10  DL1-DEDUCTION            PIC  ZZZZZZZ9.99.           03880005
037600         10  FILLER                   PIC  X(01) VALUE SPACES.    03890005
037700         10  DL1-DISC-AMT             PIC  ZZZZZZZ9.99.           03900005
037800         10  FILLER                   PIC  X(01) VALUE SPACES.    03910005
037900         10  DL1-DISC-PCT             PIC  ZZ9.99.                03920005
P49473         10  FILLER                   PIC  X(12) VALUE SPACES.    03930005
038000                                                                  03940005
038100     05  TL2-TOTAL-LINE.                                          03950005
038200         10  FILLER                   PIC  X(01) VALUE SPACES.    03960005
038300         10  TL2-LEGEND               PIC  X(30) VALUE SPACES.    03970005
038400         10  FILLER                   PIC  X(01) VALUE SPACES.    03980005
038500         10  TL2-DEBIT-TOTAL          PIC  ZZZZZZZ9.99-.          03990005
P49473*        10  FILLER                   PIC  X(03) VALUE SPACES.    04000005
P49473         10  FILLER                   PIC  X(12) VALUE SPACES.    04010005
038700         10  TL2-COST-AMT             PIC  ZZZZZZZ9.99-.          04020005
038800         10  FILLER                   PIC  X(01) VALUE SPACES.    04030005
038900         10  TL2-RETAIL-AMT           PIC  ZZZZZZZ9.99-.          04040005
039000         10  FILLER                   PIC  X(01) VALUE SPACES.    04050005
039100         10  TL2-INB-FREIGHT          PIC  ZZZZZZZ9.99-.          04060005
039200         10  FILLER                   PIC  X(01) VALUE SPACES.    04070005
039300         10  TL2-OUTB-FREIGHT         PIC  ZZZZZZZ9.99-.          04080005
039400         10  FILLER                   PIC  X(01) VALUE SPACES.    04090005
039500         10  TL2-DEDUCTION            PIC  ZZZZZZZ9.99.           04100005
039600         10  FILLER                   PIC  X(01) VALUE SPACES.    04110005
039700         10  TL2-DISC-AMT             PIC  ZZZZZZZ9.99.           04120005
039800         10  FILLER                   PIC  X(01) VALUE SPACES.    04130005
039900         10  TL2-DISC-PCT             PIC  ZZ9.99.                04140005
040000         10  TL2-DISC-PCT-X REDEFINES TL2-DISC-PCT PIC X(6).      04150005
040100                                                                  04160005
040200                                                                  04170005
040300 LINKAGE SECTION.                                                 04180005
040400                                                                  04190005
040500 PROCEDURE DIVISION.                                              04200005
040600 0000-MAINLINE.                                                   04210005
040700     PERFORM 1000-INITIALIZE                                      04220005
040800                                                                  04230005
040900     PERFORM 2000-PROCESS-EXTRACT                                 04240005
041000         UNTIL PS-EOF-EXTRACT.                                    04250005
041100                                                                  04260005
041200     PERFORM 7000-CONTROL-RECORD.                                 04270005
041300     PERFORM 9000-EOJ.                                            04280005
041400                                                                  04290005
041500     STOP RUN.                                                    04300005
041600                                                                  04310005
041700 1000-INITIALIZE.                                                 04320005
041800     MOVE FUNCTION CURRENT-DATE (1:8)  TO SD-SYSTEM-DATE.         04330005
041900     MOVE FUNCTION CURRENT-DATE (9:6)  TO ST-SYSTEM-TIME.         04340005
042000                                                                  04350005
042100     DISPLAY '** CURRENT RUN DATE  => ' SD-SYSTEM-DATE.           04360005
042200                                                                  04370005
P49473*    MOVE SD-CD-CCYY                  TO DP132-RUN-YEAR.          04380005
P49473*    MOVE SD-CD-MM                    TO DP132-RUN-MONTH.         04390005
P49473*    MOVE SD-CD-DD                    TO DP132-RUN-DAY.           04400005
P49473*                                                                 04410005
P49473*    MOVE ST-CT-HH                    TO DP132-RUN-HOUR.          04420005
P49473*    MOVE ST-CT-MM                    TO DP132-RUN-MINUTE.        04430005
P49473*                                                                 04440005
P49473*    MOVE PC-CURRENT-PGM-RVKUT016     TO DP132-PROGRAM-NAME.      04450005
P49473*    MOVE 1                           TO DP132-REPORT-NUMBER.     04460005
P49473     MOVE SD-CD-CCYY                  TO DP150-RUN-YEAR.          04470005
P49473     MOVE SD-CD-MM                    TO DP150-RUN-MONTH.         04480005
P49473     MOVE SD-CD-DD                    TO DP150-RUN-DAY.           04490005
P49473                                                                  04500005
P49473     MOVE ST-CT-HH                    TO DP150-RUN-HOUR.          04510005
P49473     MOVE ST-CT-MM                    TO DP150-RUN-MINUTE.        04520005
P49473                                                                  04530005
P49473     MOVE PC-CURRENT-PGM-RVKUT016     TO DP150-PROGRAM-NAME.      04540005
P49473     MOVE 1                           TO DP150-REPORT-NUMBER.     04550005
043200                                                                  04560005
043300     OPEN INPUT RV-EXTRACT-FILE.                                  04570005
043400     OPEN OUTPUT AP-TRANSACTION-FILE                              04580005
043500                 REPORT-FILE.                                     04590005
043600     SET PS-NO-PREVIOUS-STR TO TRUE.                              04600005
043610                                                                  04610005
043700     PERFORM 8000-READ-EXTRACT.                                   04620005
043810                                                                  04630005
043900     PERFORM 8200-WRITE-REPORT-HEADINGS.                          04640005
044000                                                                  04650005
044100     IF PS-EOF-EXTRACT                                            04660005
044200         DISPLAY 'NO RTV TRANSACTIONS TO REPORT'                  04670005
044300         WRITE REPORT-LINE FROM PC-EMPTY-REPORT-LINE AFTER 3      04680005
044400     ELSE                                                         04690005
044500         MOVE RV005-STR-NBR           TO PV-PREV-STR-NBR          04700005
044510         MOVE RV005-STR-NAME          TO PV-PREV-STR-NME          04710005
044600         MOVE RV005-ENT-NME-DESC      TO PV-PREV-ENT-NME-DESC     04720005
044700         MOVE RV005-DOC-NBR           TO PV-PREV-DOC-NBR          04730005
044800         MOVE RV005-DEPT-NBR          TO PV-PREV-DEPT-NBR         04740005
044900         MOVE RV005-CL-NBR            TO PV-PREV-CL-NBR           04750005
045000         MOVE RV005-AP-TRN-CDE        TO PV-PREV-AP-TRN-CDE       04760005
045100         MOVE RV005-VENDOR-DUNS-NBR   TO PV-PREV-VENDOR-DUNS-NBR  04770005
045200     END-IF.                                                      04780005
045300                                                                  04790005
045400******************************************************************04800005
045500* MOVE EXTRACT RECORDS TO THE AP TRANSACTION FILE                 04810005
045600******************************************************************04820005
045700 2000-PROCESS-EXTRACT.                                            04830005
045800     INITIALIZE AP045-KEY-FIELDS                                  04840005
045900                AP045-COMMON-FIELDS                               04850005
046000                AP045-DETAIL-FIELDS                               04860005
046100                AP045-PYMT-DUE-DTE                                04870005
046200                AP045-AUTH-NBR.                                   04880005
046300                                                                  04890005
046400     MOVE RV005-VENDOR-DUNS-NBR       TO AP045-VND-NBR            04900005
046500     MOVE RV005-DOC-DTE               TO AP045-DOC-DTE            04910005
046600     MOVE RV005-AP-RECD-TYP-CDE       TO AP045-RECD-TYP-CDE       04920005
046700     MOVE RV005-AP-ENTR-DTE           TO AP045-ENTR-DTE           04930005
046800     MOVE RV005-AP-ENTR-TIME          TO AP045-ENTR-TME           04940005
046900     MOVE RV005-ENTR-ID               TO AP045-ENTR-ID            04950005
047000     MOVE RV005-AP-ORGN-CDE           TO AP045-ORGN-CDE           04960005
047100     MOVE RV005-INV-CUTOFF-DTE        TO AP045-INV-CUTOFF-DTE     04970005
047200     MOVE RV005-ENT-ID                TO AP045-ENT-ID             04980005
047300     MOVE RV005-ENT-NME-DESC          TO AP045-ENT-NME-DESC       04990005
047400     MOVE RV005-STR-NBR               TO AP045-STR-NBR            05000005
047500     MOVE RV005-CL-NBR (3:2)          TO AP045-CL-NBR             05010005
047600     MOVE RV005-DOC-NBR               TO AP045-DOC-NBR            05020005
047700     MOVE RV005-REASON-LINE-1         TO AP045-RSN-1ST-LNE-TXT    05030005
047800     MOVE RV005-GRO-COST-AMT          TO AP045-GRO-COST-AMT       05040005
047900     COMPUTE AP045-FRGT-AMT =                                     05050005
048000                 (RV005-INB-FRGT-AMT + RV005-OUTB-FRGT-AMT).      05060005
048100*******  CAN EITHER BE A DEDUCTION OR A DISC-AMT BUT NOT BOTH     05070005
048200*******  WHICHEVER ONE HAS A VALUE, ADD TO TRD-DISC-AMT           05080005
048300     IF RV005-DEDUCTION < 0 AND                                   05090005
048400        RV005-DISC-AMT = 0                                        05100005
048500         MOVE RV005-DEDUCTION         TO AP045-DTL-TRD-DISC-AMT   05110005
048600     ELSE                                                         05120005
048700         IF RV005-DISC-AMT < 0 AND                                05130005
048800            RV005-DEDUCTION = 0                                   05140005
048900             MOVE RV005-DISC-AMT      TO AP045-DTL-TRD-DISC-AMT   05150005
049000         END-IF                                                   05160005
049100     END-IF                                                       05170005
049200     MOVE RV005-NET-COST-AMT          TO AP045-NET-COST-AMT.      05180005
049300     MOVE RV005-RETAIL-AMT            TO AP045-RETL-AMT.          05190005
049400     MOVE RV005-DEPT-NBR (2:3)        TO AP045-DEPT-NBR.          05200005
049500*******  PCT EXAMPLE: 3.32 SHOULD BE PASSED AS .0332.             05210005
049600     COMPUTE AP045-TRD-DISC-PCT = RV005-DISC-DED-PCT / 100.       05220005
049700     MOVE RV005-AP-TRN-CDE            TO AP045-AP-TRN-CDE         05230005
049800     MOVE RV005-AP-PSTG-TYPE-CDE      TO AP045-PSTG-TYP-CDE       05240005
049900     MOVE RV005-AP-TRN-TYPE-CDE       TO AP045-TRN-TYP-CDE        05250005
050000     MOVE RV005-PS-BTCH-NBR           TO AP045-PS-BTCH-NBR        05260005
050100     MOVE RV005-VND-AUTH-ID           TO AP045-AUTH-NBR           05270005
050200***********  NEED TOTALS FOR CONTROL RECORD                       05280005
050300     ADD 1                            TO PV-CTL-RECORD-COUNT.     05290005
050400     ADD RV005-GRO-COST-AMT           TO PV-CTL-GRO-COST-AMT.     05300005
050500     COMPUTE PV-CTL-FRGT-AMT = (PV-CTL-FRGT-AMT +                 05310005
050600                  RV005-INB-FRGT-AMT + RV005-OUTB-FRGT-AMT).      05320005
050700     ADD AP045-DTL-TRD-DISC-AMT       TO PV-CTL-TRD-DISC-AMT.     05330005
050800     ADD RV005-NET-COST-AMT           TO PV-CTL-NET-COST-AMT.     05340005
050900     ADD RV005-RETAIL-AMT             TO PV-CTL-RETL-AMT.         05350005
051000                                                                  05360005
051100     PERFORM 8100-WRITE-AP-TRANS-REC                              05370005
051200                                                                  05380005
051300*************  CONVERT DEDUCTION AND DISCOUT AMTS TO POSITVE      05390005
051400*************  THEY ARE PASSED TO AP AS NEGATIVE AMOUNTS BUT ON   05400005
051500*************    THE REPORT THEY SHOULD BE SHOWN AS POSITIVE      05410005
051600     COMPUTE RV005-DEDUCTION = RV005-DEDUCTION * -1.              05420005
051700     COMPUTE RV005-DISC-AMT  = RV005-DISC-AMT  * -1.              05430005
051800                                                                  05440005
051900***********  SET UP DETAIL LINE FOR THE AP CONTROL REPORT         05450005
052000     IF RV005-STR-NBR            =  PV-PREV-STR-NBR               05460005
052100         IF RV005-ENT-NME-DESC      =  PV-PREV-ENT-NME-DESC       05470005
052200             IF RV005-DOC-NBR          =  PV-PREV-DOC-NBR         05480005
052300                 IF RV005-DEPT-NBR         =  PV-PREV-DEPT-NBR    05490005
052400                     IF RV005-CL-NBR          =  PV-PREV-CL-NBR   05500005
052500                         CONTINUE                                 05510005
052600                     ELSE                                         05520005
052700                         PERFORM 3400-NEW-CLASS                   05530005
052800                     END-IF                                       05540005
052900                 ELSE                                             05550005
053000                     PERFORM 3300-NEW-DEPT                        05560005
053100                 END-IF                                           05570005
053200             ELSE                                                 05580005
053300                 PERFORM 3200-NEW-DOC-NBR                         05590005
053400             END-IF                                               05600005
053500         ELSE                                                     05610005
053600             PERFORM 3100-NEW-VENDOR                              05620005
053700         END-IF                                                   05630005
053800     ELSE                                                         05640005
053900         PERFORM 3000-NEW-STR-NBR                                 05650005
054000     END-IF.                                                      05660005
054100                                                                  05670005
054200     IF PS-1ST-TIME                                               05680005
054300         PERFORM 2100-SETUP-DETAIL                                05690005
054400         SET PS-NOT-NEW-FACILITY TO TRUE                          05700005
054500     END-IF.                                                      05710005
054600                                                                  05720005
054700***   ADD AMOUNTS TO DEBIT LEVEL AMOUNTS & VENDOR LEVEL           05730005
054800     ADD RV005-GRO-COST-AMT    TO PV-DEBIT-COST                   05740005
054900                                  PV-VENDR-COST.                  05750005
055000     ADD RV005-RETAIL-AMT      TO PV-DEBIT-RETAIL                 05760005
055100                                  PV-VENDR-RETAIL.                05770005
055200     ADD RV005-INB-FRGT-AMT    TO PV-DEBIT-INB-FRGT               05780005
055300                                  PV-VENDR-INB-FRGT.              05790005
055400     ADD RV005-OUTB-FRGT-AMT   TO PV-DEBIT-OUT-FRGT               05800005
055500                                  PV-VENDR-OUT-FRGT.              05810005
055600     ADD RV005-DEDUCTION       TO PV-DEBIT-DEDUCTION              05820005
055700                                  PV-VENDR-DEDUCTION.             05830005
055800     ADD RV005-DISC-AMT        TO PV-DEBIT-DISCOUNT               05840005
055900                                  PV-VENDR-DISCOUNT.              05850005
056000     ADD RV005-DISC-DED-PCT    TO PV-DEBIT-DISC-PCT               05860005
056100                                  PV-VENDR-DISC-PCT.              05870005
056200                                                                  05880005
056300     PERFORM 8000-READ-EXTRACT.                                   05890005
056400                                                                  05900005
056500****************************************************************  05910005
056600*  SET UP DETAIL LINE                                             05920005
056700****************************************************************  05930005
056800 2100-SETUP-DETAIL.                                               05940005
056900     MOVE RV005-AP-TRN-CDE         TO PV-AP-TRN-CDE.              05950005
057000     EVALUATE TRUE                                                05960005
057100         WHEN PV-AP-TRN-CDE-DND                                   05970005
057200             MOVE 'D&D'              TO DL1-TRAN-TYPE             05980005
057300             ADD RV005-GRO-COST-AMT  TO PV-FINAL-COST-DND         05990005
057400                                        PV-FCLTY-COST-DND         06000005
057500             ADD RV005-RETAIL-AMT    TO PV-FINAL-RETAIL-DND       06010005
057600                                        PV-FCLTY-RETAIL-DND       06020005
057700             ADD RV005-INB-FRGT-AMT  TO PV-FINAL-INB-FRGT-DND     06030005
057800                                        PV-FCLTY-INB-FRGT-DND     06040005
057900             ADD RV005-OUTB-FRGT-AMT TO PV-FINAL-OUT-FRGT-DND     06050005
058000                                        PV-FCLTY-OUT-FRGT-DND     06060005
058100             ADD RV005-DEDUCTION     TO PV-FINAL-DEDUCTION-DND    06070005
058200                                        PV-FCLTY-DEDUCTION-DND    06080005
058300             ADD RV005-DISC-AMT      TO PV-FINAL-DISCOUNT-DND     06090005
058400                                        PV-FCLTY-DISCOUNT-DND     06100005
058500             MOVE SPACES             TO PV-FINAL-DISC-PCT-DND-X   06110005
058600                                        PV-FCLTY-DISC-PCT-DND-X   06120005
058700         WHEN PV-AP-TRN-CDE-RTV                                   06130005
058800             MOVE 'RTV'            TO DL1-TRAN-TYPE               06140005
058900             ADD RV005-GRO-COST-AMT  TO PV-FINAL-COST-RTV         06150005
059000                                        PV-FCLTY-COST-RTV         06160005
059100             ADD RV005-RETAIL-AMT    TO PV-FINAL-RETAIL-RTV       06170005
059200                                        PV-FCLTY-RETAIL-RTV       06180005
059300             ADD RV005-INB-FRGT-AMT  TO PV-FINAL-INB-FRGT-RTV     06190005
059400                                        PV-FCLTY-INB-FRGT-RTV     06200005
059500             ADD RV005-OUTB-FRGT-AMT TO PV-FINAL-OUT-FRGT-RTV     06210005
059600                                        PV-FCLTY-OUT-FRGT-RTV     06220005
059700             ADD RV005-DEDUCTION     TO PV-FINAL-DEDUCTION-RTV    06230005
059800                                        PV-FCLTY-DEDUCTION-RTV    06240005
059900             ADD RV005-DISC-AMT      TO PV-FINAL-DISCOUNT-RTV     06250005
060000                                        PV-FCLTY-DISCOUNT-RTV     06260005
060100             MOVE SPACES             TO PV-FINAL-DISC-PCT-RTV-X   06270005
060200                                        PV-FCLTY-DISC-PCT-RTV-X   06280005
060300     END-EVALUATE.                                                06290005
060400                                                                  06300005
060500*** WHEN THE SAME TRAN-CDE, DOC NBR AND DEPT, MOVE SPACES         06310005
060600     IF PV-AP-TRN-CDE    = PV-PREV-AP-TRN-CDE  AND                06320005
060700         RV005-DOC-NBR   = PV-PREV-DOC-NBR     AND                06330005
060800         RV005-DEPT-NBR  = PV-PREV-DEPT-NBR                       06340005
060900         IF PS-1ST-TIME                                           06350005
061000             MOVE RV005-DOC-NBR    TO DL1-DEBIT-NBR               06360005
061100             MOVE RV005-DEPT-NBR   TO DL1-DEPT-NBR                06370005
061200             SET PS-NOT-1ST-TIME TO TRUE                          06380005
061300         ELSE                                                     06390005
061400             IF PS-NEW-FACILITY                                   06400005
061500                 MOVE RV005-DOC-NBR TO DL1-DEBIT-NBR              06410005
061600                 MOVE RV005-DEPT-NBR TO DL1-DEPT-NBR              06420005
061700             ELSE                                                 06430005
061800                 MOVE SPACES       TO DL1-TRAN-TYPE               06440005
061900                                      DL1-DEBIT-NBR               06450005
062000                                      DL1-DEPT-NBR                06460005
062100             END-IF                                               06470005
062200         END-IF                                                   06480005
062300     ELSE                                                         06490005
062400         MOVE RV005-DOC-NBR        TO DL1-DEBIT-NBR               06500005
062500         MOVE RV005-DEPT-NBR       TO DL1-DEPT-NBR                06510005
062600     END-IF.                                                      06520005
062700     MOVE RV005-CL-NBR (3:2)       TO DL1-MAJ-CLASS.              06530005
062800     MOVE RV005-GRO-COST-AMT       TO DL1-COST-AMT.               06540005
062900     MOVE RV005-RETAIL-AMT         TO DL1-RETAIL-AMT.             06550005
063000     MOVE RV005-INB-FRGT-AMT       TO DL1-INB-FREIGHT.            06560005
063100     MOVE RV005-OUTB-FRGT-AMT      TO DL1-OUTB-FREIGHT.           06570005
063200     MOVE RV005-DEDUCTION          TO DL1-DEDUCTION.              06580005
063300     MOVE RV005-DISC-AMT           TO DL1-DISC-AMT.               06590005
063400     MOVE RV005-DISC-DED-PCT       TO DL1-DISC-PCT.               06600005
063500                                                                  06610005
063600****************************************************************  06620005
063700*  NEW STORE                                                      06630005
063800****************************************************************  06640005
063900 3000-NEW-STR-NBR.                                                06650005
064000     SET PS-NEW-FACILITY TO TRUE.                                 06660005
064100     PERFORM 3100-NEW-VENDOR.                                     06670005
064200****** WRITE OUT FACILITY TOTALS                                  06680005
064300     INITIALIZE TL2-TOTAL-LINE.                                   06690005
064400     MOVE PC-FAC-DND-LEGEND     TO TL2-LEGEND.                    06700005
064500     COMPUTE PV-FCLTY-AMT-TOT-DND = PV-FCLTY-COST-DND +           06710005
064600                                PV-FCLTY-INB-FRGT-DND +           06720005
064700                                PV-FCLTY-OUT-FRGT-DND +           06730005
064800                                PV-FCLTY-DEDUCTION-DND +          06740005
064900                                PV-FCLTY-DISCOUNT-DND.            06750005
065000     MOVE PV-FCLTY-AMT-TOT-DND   TO TL2-DEBIT-TOTAL.              06760005
065100     MOVE PV-FCLTY-COST-DND      TO TL2-COST-AMT.                 06770005
065200     MOVE PV-FCLTY-RETAIL-DND    TO TL2-RETAIL-AMT.               06780005
065300     MOVE PV-FCLTY-INB-FRGT-DND  TO TL2-INB-FREIGHT.              06790005
065400     MOVE PV-FCLTY-OUT-FRGT-DND  TO TL2-OUTB-FREIGHT.             06800005
065500     MOVE PV-FCLTY-DEDUCTION-DND TO TL2-DEDUCTION.                06810005
065600     MOVE PV-FCLTY-DISCOUNT-DND  TO TL2-DISC-AMT.                 06820005
065700     MOVE SPACES                 TO TL2-DISC-PCT-X.               06830005
065800     PERFORM 8400-WRITE-TOTAL.                                    06840005
065900                                                                  06850005
066000     INITIALIZE TL2-TOTAL-LINE.                                   06860005
066100     MOVE PC-FAC-RTV-LEGEND     TO TL2-LEGEND.                    06870005
066200     COMPUTE PV-FCLTY-AMT-TOT-RTV = PV-FCLTY-COST-RTV +           06880005
066300                                PV-FCLTY-INB-FRGT-RTV +           06890005
066400                                PV-FCLTY-OUT-FRGT-RTV +           06900005
066500                                PV-FCLTY-DEDUCTION-RTV +          06910005
066600                                PV-FCLTY-DISCOUNT-RTV.            06920005
066700     MOVE PV-FCLTY-AMT-TOT-RTV   TO TL2-DEBIT-TOTAL.              06930005
066800     MOVE PV-FCLTY-COST-RTV      TO TL2-COST-AMT.                 06940005
066900     MOVE PV-FCLTY-RETAIL-RTV    TO TL2-RETAIL-AMT.               06950005
067000     MOVE PV-FCLTY-INB-FRGT-RTV  TO TL2-INB-FREIGHT.              06960005
067100     MOVE PV-FCLTY-OUT-FRGT-RTV  TO TL2-OUTB-FREIGHT.             06970005
067200     MOVE PV-FCLTY-DEDUCTION-RTV TO TL2-DEDUCTION.                06980005
067300     MOVE PV-FCLTY-DISCOUNT-RTV  TO TL2-DISC-AMT.                 06990005
067400     MOVE SPACES                 TO TL2-DISC-PCT-X.               07000005
067500     PERFORM 8400-WRITE-TOTAL.                                    07010005
067600                                                                  07020005
067700     MOVE 0                    TO PV-FCLTY-AMT-TOT-DND            07030005
067800                                  PV-FCLTY-AMT-TOT-RTV            07040005
067900                                  PV-FCLTY-COST-DND               07050005
068000                                  PV-FCLTY-COST-RTV               07060005
068100                                  PV-FCLTY-RETAIL-DND             07070005
068200                                  PV-FCLTY-RETAIL-RTV             07080005
068300                                  PV-FCLTY-INB-FRGT-DND           07090005
068400                                  PV-FCLTY-INB-FRGT-RTV           07100005
068500                                  PV-FCLTY-OUT-FRGT-DND           07110005
068600                                  PV-FCLTY-OUT-FRGT-RTV           07120005
068700                                  PV-FCLTY-DEDUCTION-DND          07130005
068800                                  PV-FCLTY-DEDUCTION-RTV          07140005
068900                                  PV-FCLTY-DISCOUNT-DND           07150005
069000                                  PV-FCLTY-DISCOUNT-RTV.          07160005
069100     MOVE SPACES               TO PV-FCLTY-DISC-PCT-DND-X         07170005
069200                                  PV-FCLTY-DISC-PCT-RTV-X.        07180005
069300                                                                  07190005
069400     MOVE RV005-STR-NBR        TO PV-PREV-STR-NBR.                07200005
069410     MOVE RV005-STR-NAME       TO PV-PREV-STR-NME.                07210005
069500     PERFORM 8200-WRITE-REPORT-HEADINGS.                          07220005
069600     PERFORM 2100-SETUP-DETAIL.                                   07230005
069700     SET PS-NOT-NEW-FACILITY   TO TRUE.                           07240005
069800                                                                  07250005
069900****************************************************************  07260005
070000*  NEW VENDOR                                                     07270005
070100****************************************************************  07280005
070200 3100-NEW-VENDOR.                                                 07290005
070300     PERFORM 3200-NEW-DOC-NBR.                                    07300005
070400     MOVE PC-VENDOR-LEGEND     TO TL2-LEGEND.                     07310005
070500     COMPUTE PV-VENDR-AMT-TOT = PV-VENDR-COST +                   07320005
070600                                PV-VENDR-INB-FRGT  +              07330005
070700                                PV-VENDR-OUT-FRGT  +              07340005
070800                                PV-VENDR-DEDUCTION +              07350005
070900                                PV-VENDR-DISCOUNT.                07360005
071000     MOVE PV-VENDR-AMT-TOT     TO TL2-DEBIT-TOTAL.                07370005
071100     MOVE PV-VENDR-COST        TO TL2-COST-AMT.                   07380005
071200     MOVE PV-VENDR-RETAIL      TO TL2-RETAIL-AMT.                 07390005
071300     MOVE PV-VENDR-INB-FRGT    TO TL2-INB-FREIGHT.                07400005
071400     MOVE PV-VENDR-OUT-FRGT    TO TL2-OUTB-FREIGHT.               07410005
071500     MOVE PV-VENDR-DEDUCTION   TO TL2-DEDUCTION.                  07420005
071600     MOVE PV-VENDR-DISCOUNT    TO TL2-DISC-AMT.                   07430005
071700     MOVE SPACES               TO TL2-DISC-PCT-X.                 07440005
071800     PERFORM 8400-WRITE-TOTAL.                                    07450005
071900     MOVE 0                    TO PV-VENDR-AMT-TOT                07460005
072000                                  PV-VENDR-COST                   07470005
072100                                  PV-VENDR-RETAIL                 07480005
072200                                  PV-VENDR-INB-FRGT               07490005
072300                                  PV-VENDR-OUT-FRGT               07500005
072400                                  PV-VENDR-DEDUCTION              07510005
072500                                  PV-VENDR-DISCOUNT               07520005
072600                                  PV-VENDR-DISC-PCT.              07530005
072700                                                                  07540005
072800     MOVE RV005-ENT-NME-DESC    TO PV-PREV-ENT-NME-DESC.          07550005
072900     MOVE RV005-VENDOR-DUNS-NBR TO PV-PREV-VENDOR-DUNS-NBR.       07560005
073000                                                                  07570005
073100     IF PS-PRINT-VNDR-DUNS                                        07580005
073200         MOVE PC-VNDR-LEGEND   TO CL3-VENDOR-LEGEND               07590005
073300         MOVE PC-DUNS-LEGEND   TO CL3-DUNS-LEGEND                 07600005
073400         IF PS-1ST-TIME                                           07610005
073500             MOVE RV005-ENT-NME-DESC TO CL3-VENDOR-NAME           07620005
073600             MOVE RV005-VENDOR-DUNS-NBR TO CL3-DUNS-NBR           07630005
073700         ELSE                                                     07640005
073800             MOVE PV-PREV-ENT-NME-DESC TO CL3-VENDOR-NAME         07650005
073900             MOVE PV-PREV-VENDOR-DUNS-NBR TO CL3-DUNS-NBR         07660005
074000         END-IF                                                   07670005
074100                                                                  07680005
074200         IF PS-NEW-FACILITY                                       07690005
074300            CONTINUE                                              07700005
074400         ELSE                                                     07710005
074500             WRITE REPORT-LINE FROM CL3-COL-HEADING-LINE3         07720005
074600                 AFTER ADVANCING 3 LINES                          07730005
074700             ADD 3                      TO PV-LINE-COUNT          07740005
074800         END-IF                                                   07750005
074900     ELSE                                                         07760005
075000         MOVE SPACES           TO CL3-VENDOR-LEGEND               07770005
075100                                  CL3-DUNS-LEGEND                 07780005
075200                                  CL3-VENDOR-NAME                 07790005
075300                                  CL3-DUNS-NBR                    07800005
075400     END-IF.                                                      07810005
075500                                                                  07820005
075600     WRITE REPORT-LINE FROM PC-BLANK-LINE                         07830005
075700         AFTER ADVANCING 2 LINES.                                 07840005
075800                                                                  07850005
075900     ADD 2                      TO PV-LINE-COUNT.                 07860005
076000                                                                  07870005
076100****************************************************************  07880005
076200*  NEW DOC NBR (LISTING)                                          07890005
076300****************************************************************  07900005
076400 3200-NEW-DOC-NBR.                                                07910005
076500     PERFORM 3300-NEW-DEPT.                                       07920005
076600                                                                  07930005
076700     MOVE PC-DEBIT-LEGEND      TO TL2-LEGEND.                     07940005
076800     COMPUTE PV-DEBIT-AMT-TOT = PV-DEBIT-COST +                   07950005
076900                                PV-DEBIT-INB-FRGT  +              07960005
077000                                PV-DEBIT-OUT-FRGT  +              07970005
077100                                PV-DEBIT-DEDUCTION +              07980005
077200                                PV-DEBIT-DISCOUNT.                07990005
077300     MOVE PV-DEBIT-AMT-TOT     TO TL2-DEBIT-TOTAL.                08000005
077400     MOVE PV-DEBIT-COST        TO TL2-COST-AMT.                   08010005
077500     MOVE PV-DEBIT-RETAIL      TO TL2-RETAIL-AMT.                 08020005
077600     MOVE PV-DEBIT-INB-FRGT    TO TL2-INB-FREIGHT.                08030005
077700     MOVE PV-DEBIT-OUT-FRGT    TO TL2-OUTB-FREIGHT.               08040005
077800     MOVE PV-DEBIT-DEDUCTION   TO TL2-DEDUCTION.                  08050005
077900     MOVE PV-DEBIT-DISCOUNT    TO TL2-DISC-AMT.                   08060005
078000     MOVE PV-DEBIT-DISC-PCT    TO TL2-DISC-PCT.                   08070005
078100     PERFORM 8400-WRITE-TOTAL.                                    08080005
078200                                                                  08090005
078300     IF RV005-ENT-NME-DESC = PV-PREV-ENT-NME-DESC                 08100005
078400         WRITE REPORT-LINE FROM PC-BLANK-LINE                     08110005
078500             AFTER ADVANCING 1 LINES                              08120005
078600         ADD 1                  TO PV-LINE-COUNT                  08130005
078700     END-IF.                                                      08140005
078800     MOVE 0                    TO PV-DEBIT-COST                   08150005
078900                                  PV-DEBIT-RETAIL                 08160005
079000                                  PV-DEBIT-INB-FRGT               08170005
079100                                  PV-DEBIT-OUT-FRGT               08180005
079200                                  PV-DEBIT-DEDUCTION              08190005
079300                                  PV-DEBIT-DISCOUNT               08200005
079400                                  PV-DEBIT-DISC-PCT.              08210005
079500     MOVE RV005-DOC-NBR        TO PV-PREV-DOC-NBR.                08220005
079600     MOVE RV005-AP-TRN-CDE     TO PV-PREV-AP-TRN-CDE.             08230005
079700                                                                  08240005
079800****************************************************************  08250005
079900*  NEW DEPT                                                       08260005
080000****************************************************************  08270005
080100 3300-NEW-DEPT.                                                   08280005
080200     PERFORM 3400-NEW-CLASS.                                      08290005
080300     MOVE RV005-DEPT-NBR       TO PV-PREV-DEPT-NBR.               08300005
080400                                                                  08310005
080500****************************************************************  08320005
080600*  NEW CLASS                                                      08330005
080700****************************************************************  08340005
080800 3400-NEW-CLASS.                                                  08350005
080900     PERFORM 8300-WRITE-AP-DETAIL-LINE.                           08360005
081000                                                                  08370005
081100     IF PS-NEW-FACILITY                                           08380005
081200         CONTINUE                                                 08390005
081300     ELSE                                                         08400005
081400         PERFORM 2100-SETUP-DETAIL                                08410005
081500     END-IF.                                                      08420005
081600     MOVE RV005-CL-NBR         TO PV-PREV-CL-NBR.                 08430005
081700                                                                  08440005
081800******************************************************************08450005
081900* CREATE CONTROL RECORD AT THE END OF THE TRANSACTION FILE        08460005
082000******************************************************************08470005
082100 7000-CONTROL-RECORD.                                             08480005
082200     INITIALIZE AP045-KEY-FIELDS                                  08490005
082300                AP045-DETAIL-FIELDS                               08500005
082400                AP045-COMMON-FIELDS                               08510005
082500                AP045-CONTROL-FIELDS                              08520005
082600                AP045-PYMT-DUE-DTE                                08530005
082700                AP045-AUTH-NBR.                                   08540005
082800                                                                  08550005
082900** CONTROL                                                        08560005
083000     MOVE '9'                         TO AP045-RECD-TYP-CDE       08570005
083100     MOVE PV-CTL-GRO-COST-AMT         TO AP045-CTL-GRO-COST-AMT   08580005
083200     MOVE PV-CTL-FRGT-AMT             TO AP045-CTL-FRGT-AMT       08590005
083300     MOVE PV-CTL-RETL-AMT             TO AP045-CTL-RETL-AMT       08600005
083400     MOVE PV-CTL-TRD-DISC-AMT         TO AP045-CTL-TRD-DISC-AMT   08610005
083500     COMPUTE PV-CTL-NET-COST-AMT = PV-CTL-GRO-COST-AMT +          08620005
083600             PV-CTL-FRGT-AMT - PV-CTL-TRD-DISC-AMT                08630005
083700     MOVE PV-CTL-NET-COST-AMT         TO AP045-CTL-NET-COST-AMT   08640005
083800     MOVE PV-CTL-RECORD-COUNT         TO AP045-CTL-RECORD-COUNT   08650005
083900                                                                  08660005
084000     PERFORM 8100-WRITE-AP-TRANS-REC.                             08670005
084100                                                                  08680005
084200******************************************************************08690005
084300* READ THE EXTRACT FILE                                           08700005
084400******************************************************************08710005
084500 8000-READ-EXTRACT.                                               08720005
084600     READ RV-EXTRACT-FILE INTO RV005-RECORD                       08730005
084700         AT END                                                   08740005
084800             SET PS-EOF-EXTRACT       TO TRUE                     08750005
084900         NOT AT END                                               08760005
085000             ADD 1                    TO PV-READ-COUNT            08770005
085100     END-READ.                                                    08780005
085200                                                                  08790005
085300******************************************************************08800005
085400* WRITE THE AP TRANSACTION FILE                                   08810005
085500******************************************************************08820005
085600 8100-WRITE-AP-TRANS-REC.                                         08830005
085700     WRITE AP-TRANSACTION-RECORD                                  08840005
085800         FROM AP045-TRANSACTION-FILE.                             08850005
085900     ADD 1                            TO PV-WRITE-TRAN-CNT.       08860005
086000                                                                  08870005
086100******************************************************************08880005
086200*  WRITE OUT THE HEADING LINES OF THE REPORT.                    *08890005
086300******************************************************************08900005
086400 8200-WRITE-REPORT-HEADINGS.                                      08910005
086500     ADD 1              TO PV-PAGE-COUNT.                         08920005
P49473*    MOVE PV-PAGE-COUNT TO DP132-PAGE-NUMBER.                     08930005
P49473     MOVE PV-PAGE-COUNT TO DP150-PAGE-NUMBER.                     08940005
086700                                                                  08950005
P49473*    WRITE REPORT-LINE   FROM DP132-STANDRD-HEADER-132-COLS       08960005
P49473     WRITE REPORT-LINE   FROM DP150-STANDRD-HEADER-150-COLS       08970005
086900         AFTER ADVANCING PAGE.                                    08980005
087000                                                                  08990005
087100     WRITE REPORT-LINE   FROM HL2-HEADING-LINE2                   09000005
087200         AFTER ADVANCING 1 LINE.                                  09010005
087300                                                                  09020005
087400     WRITE REPORT-LINE FROM HL3-HEADING-LINE3                     09030005
087500         AFTER ADVANCING 1 LINES.                                 09040005
087600                                                                  09050005
087700     MOVE SPACES TO HL4-FACILITY-NAME                             09060005
087800                                                                  09070005
087900     IF PS-NOT-GRAND-TOTAL                                        09080005
087901*GB 2/23/12                                                       09090005
087910         IF PS-NEW-FACILITY AND PS-PREVIOUS-STR                   09100005
088000           STRING PV-PREV-STR-NBR DELIMITED BY SIZE               09110005
088100                  '-' DELIMITED BY SIZE                           09120005
088200                   PV-PREV-STR-NME DELIMITED BY '  '              09130005
088300             INTO HL4-FACILITY-NAME                               09140005
088301*GB 2/23/12                                                       09150005
088302         ELSE                                                     09160005
088310           STRING RV005-STR-NBR DELIMITED BY SIZE                 09170005
088320                  '-' DELIMITED BY SIZE                           09180005
088330                  RV005-STR-NAME DELIMITED BY '  '                09190005
088340             INTO HL4-FACILITY-NAME                               09200005
088341             SET PS-PREVIOUS-STR  TO TRUE                         09210005
088350         END-IF                                                   09220005
088400     ELSE                                                         09230005
088500         MOVE PC-GRAND-TOTAL-LEGEND TO HL4-FACILITY-NAME          09240005
088600     END-IF.                                                      09250005
088700                                                                  09260005
088800     WRITE REPORT-LINE FROM HL4-HEADING-LINE4                     09270005
088900         AFTER ADVANCING 1 LINES.                                 09280005
089000                                                                  09290005
089100     WRITE REPORT-LINE FROM CL0-COL-HEADING-LINE0                 09300005
089200         AFTER ADVANCING 2 LINES.                                 09310005
089300                                                                  09320005
089400     WRITE REPORT-LINE FROM CL1-COL-HEADING-LINE1                 09330005
089500         AFTER ADVANCING 1 LINES.                                 09340005
089600                                                                  09350005
089700     WRITE REPORT-LINE FROM CL2-COL-HEADING-LINE2                 09360005
089800         AFTER ADVANCING 1 LINES.                                 09370005
089900                                                                  09380005
090000     IF PS-PRINT-VNDR-DUNS                                        09390005
090100         MOVE PC-VNDR-LEGEND   TO CL3-VENDOR-LEGEND               09400005
090200         MOVE PC-DUNS-LEGEND   TO CL3-DUNS-LEGEND                 09410005
090300         IF PS-1ST-TIME                                           09420005
090400             MOVE RV005-ENT-NME-DESC TO CL3-VENDOR-NAME           09430005
090500             MOVE RV005-VENDOR-DUNS-NBR TO CL3-DUNS-NBR           09440005
090600         ELSE                                                     09450005
090700             MOVE PV-PREV-ENT-NME-DESC TO CL3-VENDOR-NAME         09460005
090800             MOVE PV-PREV-VENDOR-DUNS-NBR TO CL3-DUNS-NBR         09470005
090900         END-IF                                                   09480005
091000         WRITE REPORT-LINE FROM CL3-COL-HEADING-LINE3             09490005
091100             AFTER ADVANCING 2 LINES                              09500005
091200     ELSE                                                         09510005
091300         MOVE SPACES           TO CL3-VENDOR-LEGEND               09520005
091400                                  CL3-DUNS-LEGEND                 09530005
091500                                  CL3-VENDOR-NAME                 09540005
091600                                  CL3-DUNS-NBR                    09550005
091700     END-IF.                                                      09560005
091800                                                                  09570005
091900     WRITE REPORT-LINE FROM PC-BLANK-LINE                         09580005
092000         AFTER ADVANCING 2 LINES.                                 09590005
092100                                                                  09600005
092200     MOVE +12           TO PV-LINE-COUNT.                         09610005
092300                                                                  09620005
092400******************************************************************09630005
092500* WRITE THE RTV - AP REPORT DETAIL LINE                           09640005
092600******************************************************************09650005
092700 8300-WRITE-AP-DETAIL-LINE.                                       09660005
092800     IF PV-LINE-COUNT  > PC-LINE-LIMIT                            09670005
092900         PERFORM 8200-WRITE-REPORT-HEADINGS                       09680005
093000     END-IF.                                                      09690005
093100                                                                  09700005
093200     WRITE REPORT-LINE FROM DL1-DETAIL-LINE-1 AFTER 1.            09710005
093300     INITIALIZE DL1-DETAIL-LINE-1.                                09720005
093400     ADD 1                            TO PV-WRITE-REPT-CNT        09730005
093500                                         PV-LINE-COUNT.           09740005
093600                                                                  09750005
093700******************************************************************09760005
093800* WRITE THE TOTAL LINE                                            09770005
093900******************************************************************09780005
094000 8400-WRITE-TOTAL.                                                09790005
094100     IF PV-LINE-COUNT  > PC-LINE-LIMIT                            09800005
094200         PERFORM 8200-WRITE-REPORT-HEADINGS                       09810005
094300     END-IF.                                                      09820005
094400                                                                  09830005
094500     WRITE REPORT-LINE FROM TL2-TOTAL-LINE AFTER 2.               09840005
094600     INITIALIZE TL2-TOTAL-LINE.                                   09850005
094700                                                                  09860005
094800     ADD 2                            TO PV-LINE-COUNT.           09870005
094900                                                                  09880005
095000******************************************************************09890005
095100* END OF JOB PROCESSING                                           09900005
095200******************************************************************09910005
095300 9000-EOJ.                                                        09920005
095400**** WRITE OUT LAST DETAIL RECORD                                 09930005
095500     PERFORM 8300-WRITE-AP-DETAIL-LINE                            09940005
095600*                                                                 09950005
095700**** WRITE OUT TOTAL LINE FOR LAST LISTING                        09960005
095800     INITIALIZE TL2-TOTAL-LINE.                                   09970005
095900     MOVE PC-DEBIT-LEGEND      TO TL2-LEGEND.                     09980005
096000     COMPUTE PV-DEBIT-AMT-TOT = PV-DEBIT-COST +                   09990005
096100                                PV-DEBIT-INB-FRGT  +              10000005
096200                                PV-DEBIT-OUT-FRGT  +              10010005
096300                                PV-DEBIT-DEDUCTION +              10020005
096400                                PV-DEBIT-DISCOUNT.                10030005
096500     MOVE PV-DEBIT-AMT-TOT     TO TL2-DEBIT-TOTAL.                10040005
096600     MOVE PV-DEBIT-COST        TO TL2-COST-AMT.                   10050005
096700     MOVE PV-DEBIT-RETAIL      TO TL2-RETAIL-AMT.                 10060005
096800     MOVE PV-DEBIT-INB-FRGT    TO TL2-INB-FREIGHT.                10070005
096900     MOVE PV-DEBIT-OUT-FRGT    TO TL2-OUTB-FREIGHT.               10080005
097000     MOVE PV-DEBIT-DEDUCTION   TO TL2-DEDUCTION.                  10090005
097100     MOVE PV-DEBIT-DISCOUNT    TO TL2-DISC-AMT.                   10100005
097200     MOVE PV-DEBIT-DISC-PCT    TO TL2-DISC-PCT.                   10110005
097300     PERFORM 8400-WRITE-TOTAL.                                    10120005
097400*                                                                 10130005
097500**** WRITE OUT TOTAL LINE FOR VENDOR                              10140005
097600     INITIALIZE TL2-TOTAL-LINE.                                   10150005
097700     MOVE PC-VENDOR-LEGEND     TO TL2-LEGEND.                     10160005
097800     COMPUTE PV-VENDR-AMT-TOT = PV-VENDR-COST +                   10170005
097900                                PV-VENDR-INB-FRGT  +              10180005
098000                                PV-VENDR-OUT-FRGT  +              10190005
098100                                PV-VENDR-DEDUCTION +              10200005
098200                                PV-VENDR-DISCOUNT.                10210005
098300     MOVE PV-VENDR-AMT-TOT     TO TL2-DEBIT-TOTAL.                10220005
098400     MOVE PV-VENDR-COST        TO TL2-COST-AMT.                   10230005
098500     MOVE PV-VENDR-RETAIL      TO TL2-RETAIL-AMT.                 10240005
098600     MOVE PV-VENDR-INB-FRGT    TO TL2-INB-FREIGHT.                10250005
098700     MOVE PV-VENDR-OUT-FRGT    TO TL2-OUTB-FREIGHT.               10260005
098800     MOVE PV-VENDR-DEDUCTION   TO TL2-DEDUCTION.                  10270005
098900     MOVE PV-VENDR-DISCOUNT    TO TL2-DISC-AMT.                   10280005
099000     MOVE SPACES               TO TL2-DISC-PCT-X.                 10290005
099100     PERFORM 8400-WRITE-TOTAL.                                    10300005
099200                                                                  10310005
099300**** WRITE OUT FACILITY TOTAL LINE FOR LAST FACILITY              10320005
099400     SET PS-NOT-PRINT-VNDR-DUNS  TO TRUE.                         10330005
099500     INITIALIZE TL2-TOTAL-LINE.                                   10340005
099600     MOVE PC-FAC-DND-LEGEND      TO TL2-LEGEND.                   10350005
099700     COMPUTE PV-FCLTY-AMT-TOT-DND = PV-FCLTY-COST-DND +           10360005
099800                                PV-FCLTY-INB-FRGT-DND  +          10370005
099900                                PV-FCLTY-OUT-FRGT-DND  +          10380005
100000                                PV-FCLTY-DEDUCTION-DND +          10390005
100100                                PV-FCLTY-DISCOUNT-DND.            10400005
100200     MOVE PV-FCLTY-AMT-TOT-DND   TO TL2-DEBIT-TOTAL.              10410005
100300     MOVE PV-FCLTY-COST-DND      TO TL2-COST-AMT.                 10420005
100400     MOVE PV-FCLTY-RETAIL-DND    TO TL2-RETAIL-AMT.               10430005
100500     MOVE PV-FCLTY-INB-FRGT-DND  TO TL2-INB-FREIGHT.              10440005
100600     MOVE PV-FCLTY-OUT-FRGT-DND  TO TL2-OUTB-FREIGHT.             10450005
100700     MOVE PV-FCLTY-DEDUCTION-DND TO TL2-DEDUCTION.                10460005
100800     MOVE PV-FCLTY-DISCOUNT-DND  TO TL2-DISC-AMT.                 10470005
100900     MOVE SPACES                 TO TL2-DISC-PCT-X.               10480005
101000     PERFORM 8400-WRITE-TOTAL.                                    10490005
101100                                                                  10500005
101200     INITIALIZE TL2-TOTAL-LINE.                                   10510005
101300     MOVE PC-FAC-RTV-LEGEND      TO TL2-LEGEND.                   10520005
101400     COMPUTE PV-FCLTY-AMT-TOT-RTV = PV-FCLTY-COST-RTV +           10530005
101500                                PV-FCLTY-INB-FRGT-RTV  +          10540005
101600                                PV-FCLTY-OUT-FRGT-RTV  +          10550005
101700                                PV-FCLTY-DEDUCTION-RTV +          10560005
101800                                PV-FCLTY-DISCOUNT-RTV.            10570005
101900     MOVE PV-FCLTY-AMT-TOT-RTV   TO TL2-DEBIT-TOTAL.              10580005
102000     MOVE PV-FCLTY-COST-RTV      TO TL2-COST-AMT.                 10590005
102100     MOVE PV-FCLTY-RETAIL-RTV    TO TL2-RETAIL-AMT.               10600005
102200     MOVE PV-FCLTY-INB-FRGT-RTV  TO TL2-INB-FREIGHT.              10610005
102300     MOVE PV-FCLTY-OUT-FRGT-RTV  TO TL2-OUTB-FREIGHT.             10620005
102400     MOVE PV-FCLTY-DEDUCTION-RTV TO TL2-DEDUCTION.                10630005
102500     MOVE PV-FCLTY-DISCOUNT-RTV  TO TL2-DISC-AMT.                 10640005
102600     MOVE SPACES                 TO TL2-DISC-PCT-X.               10650005
102700     PERFORM 8400-WRITE-TOTAL.                                    10660005
102800                                                                  10670005
102900     SET PS-GRAND-TOTAL          TO TRUE.                         10680005
103000     PERFORM 8200-WRITE-REPORT-HEADINGS.                          10690005
103100                                                                  10700005
103200****  FINAL (GRAND) TOTALS OF ALL FACILITIES BEING REPORTED       10710005
103300     INITIALIZE TL2-TOTAL-LINE.                                   10720005
103400     MOVE PC-FIN-DND-LEGEND     TO TL2-LEGEND.                    10730005
103500     COMPUTE PV-FINAL-AMT-TOT-DND = PV-FINAL-COST-DND +           10740005
103600                                PV-FINAL-INB-FRGT-DND +           10750005
103700                                PV-FINAL-OUT-FRGT-DND +           10760005
103800                                PV-FINAL-DEDUCTION-DND +          10770005
103900                                PV-FINAL-DISCOUNT-DND.            10780005
104000     MOVE PV-FINAL-AMT-TOT-DND   TO TL2-DEBIT-TOTAL.              10790005
104100     MOVE PV-FINAL-COST-DND      TO TL2-COST-AMT.                 10800005
104200     MOVE PV-FINAL-RETAIL-DND    TO TL2-RETAIL-AMT.               10810005
104300     MOVE PV-FINAL-INB-FRGT-DND  TO TL2-INB-FREIGHT.              10820005
104400     MOVE PV-FINAL-OUT-FRGT-DND  TO TL2-OUTB-FREIGHT.             10830005
104500     MOVE PV-FINAL-DEDUCTION-DND TO TL2-DEDUCTION.                10840005
104600     MOVE PV-FINAL-DISCOUNT-DND  TO TL2-DISC-AMT.                 10850005
104700     MOVE SPACES                 TO TL2-DISC-PCT-X.               10860005
104800     PERFORM 8400-WRITE-TOTAL.                                    10870005
104900                                                                  10880005
105000     INITIALIZE TL2-TOTAL-LINE.                                   10890005
105100     MOVE PC-FIN-RTV-LEGEND     TO TL2-LEGEND.                    10900005
105200     COMPUTE PV-FINAL-AMT-TOT-RTV = PV-FINAL-COST-RTV +           10910005
105300                                PV-FINAL-INB-FRGT-RTV +           10920005
105400                                PV-FINAL-OUT-FRGT-RTV +           10930005
105500                                PV-FINAL-DEDUCTION-RTV +          10940005
105600                                PV-FINAL-DISCOUNT-RTV.            10950005
105700     MOVE PV-FINAL-AMT-TOT-RTV   TO TL2-DEBIT-TOTAL.              10960005
105800     MOVE PV-FINAL-COST-RTV      TO TL2-COST-AMT.                 10970005
105900     MOVE PV-FINAL-RETAIL-RTV    TO TL2-RETAIL-AMT.               10980005
106000     MOVE PV-FINAL-INB-FRGT-RTV  TO TL2-INB-FREIGHT.              10990005
106100     MOVE PV-FINAL-OUT-FRGT-RTV  TO TL2-OUTB-FREIGHT.             11000005
106200     MOVE PV-FINAL-DEDUCTION-RTV TO TL2-DEDUCTION.                11010005
106300     MOVE PV-FINAL-DISCOUNT-RTV  TO TL2-DISC-AMT.                 11020005
106400     MOVE SPACES                 TO TL2-DISC-PCT-X.               11030005
106500     PERFORM 8400-WRITE-TOTAL.                                    11040005
106600                                                                  11050005
106700     WRITE REPORT-LINE    FROM PC-END-OF-REPORT-LINE              11060005
106800          AFTER ADVANCING 3 LINES.                                11070005
106900                                                                  11080005
107000     DISPLAY SPACES                                               11090005
107100     MOVE PV-READ-COUNT               TO PV-DISP-NUMBER           11100005
107200     DISPLAY 'RECS READ    = ' PV-DISP-NUMBER                     11110005
107300     MOVE PV-WRITE-TRAN-CNT           TO PV-DISP-NUMBER           11120005
107400     DISPLAY ' TRANSACTION RECS WRITTEN = ' PV-DISP-NUMBER.       11130005
107500     MOVE PV-WRITE-REPT-CNT           TO PV-DISP-NUMBER           11140005
107600     DISPLAY ' REPORT RECS WRITTEN = ' PV-DISP-NUMBER.            11150005
107700                                                                  11160005
107800     CLOSE RV-EXTRACT-FILE                                        11170005
107900           AP-TRANSACTION-FILE                                    11180005
108000           REPORT-FILE.                                           11190005
108100********************** END OF RVKUT016 ***************************11200005
