000100 IDENTIFICATION DIVISION.                                         00010001
000200 PROGRAM-ID.    APKRP227.                                         00020001
000300 AUTHOR.        ALEXIS KEIKER.                                    00030001
000400 DATE-WRITTEN.  OCTOBER 2001.                                     00040001
000500 DATE-COMPILED.                                                   00050001
000600*---------------------------------------------------------------* 00060007
000700*     REPORT OF INVOICES LOADED IN PENDING REVIEW STATUS        * 00070053
000800*---------------------------------------------------------------* 00080007
000900*    COBOL 390                                                  * 00090001
001000*---------------------------------------------------------------* 00100007
001100*  PURPOSE:  TO CREATE A REPORT OF EDI IMPORT INVOICES LOADED   * 00110001
001200*  IN PENDING REVIEW STATUS.  THIS REPORT IS NEEDED SO THAT THE * 00120053
001300*  AP ASSOCIATE CAN REVIEW THE INVOICE TO DETERMINE IF WE WANT  * 00130053
001400*  TO ACCEPT THE CHARGES THAT ARE OUTSIDE OF TOLERANCE.  IF WE  * 00140053
001500*  WANT TO ACCEPT THEM, THE ASSOCIATE WILL CHANGE THE STATUS TO * 00150053
001600*  'EN'.  IF THE CHARGES ARE NOT TO BE ACCEPTED, THE INVOICE    * 00160053
001700*  WILL BE DELETED.                                             * 00170053
001800*                                                               * 00180053
001900*  INPUT:  PENDING REPORT RECORDS (APRD018)                     * 00190053
002000*  OUTPUT: INVOICES IN PENDING STATUS REPORT                    * 00200053
002100*---------------------------------------------------------------* 00210007
002200* CHANGE LOG:                                                   * 00220002
002300*                                                               * 00230001
002400* DATE  05/22/2003                                              * 00240064
002500*     CHANGE MADE: CHANGE TITLE ON SKU COUNT COLUMN TO 'PO QTY' * 00250064
002600*     AND CALCULATED DECONS RATE TO 'CALC DDF RT/AMT' COLUMN.   * 00260064
002700*     CHANGE LENGTH OF PO QTY TO FIVE.  IN PARAGRAPH B200,      * 00270064
002800*     MOVE THE NEW CALCULATED DDF AMOUNT INSTEAD OF COMPUTING   * 00280064
002900*     THIS RATE.  CHANGE REFERENCES FROM PO-SKU-QTY TO PO-QTY.  * 00290064
003000*     MADE BY: KEVIN CATLIN            WR/IR #: WR24632         * 00300064
003100*                                                               * 00310064
003200* DATE  07/31/2003                                              * 00320088
003300*     CHANGE MADE: ADDED PENDING INFORMATIONAL LINE TO REPORT   * 00330083
003400*     TO DETAIL THE REASON AN INVOICE WAS PUT IN PENDING REVIEW * 00340083
003500*     STATUS.  ADDED CONDITIONAL LOGIC IN B200 TO POPULATE THE  * 00350086
003600*     INFORMATIONAL LINE.  ADDED W400 TO WRITE THIS LINE.       * 00360083
003700*     ADDED COPYBOOK APWS010 TO USE ERROR MESSAGE DETAIL.       * 00370085
003800*     MADE BY: KEVIN CATLIN            WR/IR #: WR24933         * 00380083
003900*                                                               * 00390083
004000* DATE 06/06/2006                                               * 00400099
004100*    CHANGE MADE: REMOVED THE COLUMNS TOTAL DECONSOL AND PO     * 00410093
004200*    WEIGHT FROM THE REPORT.  ALSO CHANGED THE DECONSOLIDATOR   * 00420090
004300*    RATE PER CARTON CALCULATION TO BE THE CHARGE AMOUNT        * 00430098
004400*    DIVIDED BY THE CARTON QUANTITY.                            * 00440098
004500*    MADE BY: KRYSTEN LEARY            WR/IR #: WR30438         * 00450089
004600*                                                               * 00460099
004700* DATE 01/22/2007                                               * 00470099
004800*    CHANGE MADE: CHANGED THE FIELDS SAVE-CALC-DEC AND          * 00480099
004900*    PV-HOLD-CALC-DEC TO HAVE THREE DECIMAL PLACES INSTEAD OF   * 00490099
005000*    TWO.  THIS WILL ALLOW THE DTL-CALC-DEC FIELD TO DISPLAY A  * 00500099
005100*    NUMBER IN THE THIRD DECIMAL PLACE INSTEAD OF A ZERO.       * 00510099
005200*    MADE BY: KRYSTEN LEARY            WR/IR #: WR31493         * 00520099
005300*                                                               * 00530099
005400* DATE  03/16/2009                                              * 00540099
005500*     CHANGE MADE:  RECOMPILE FROM PRODUCTION TO INCORPORATE    * 00550099
005600*     COPYBOOK APWS010 CHANGES.                                 * 00560099
005700*     MADE BY: KEVIN CATLIN            WR/IR #: WR33680         * 00570099
005800*                                                               8 00580099
005900* DATE  10/20/2009                                              * 00590099
006000*     CHANGE MADE:  RECOMPILE FOR 310 EDI PROJECT.              * 00600099
006100*     COPYBOOK APRD018 WENT FROM 475 TO 750 BYTES.              * 00610099
006200*     MADE BY: PAUL STROEDE            WR/IR #: WR23145         * 00620099
006300*                                                               * 00630099
006400* DATE  03/04/2010                                              * 00640099
006500*     CHANGE MADE:  EXPANDED THE REPORT DETAIL LINE FIELD FOR   * 00650099
006600*     INVOICE ID FROM 17 TO 22 CHARACTERS.                      * 00660099
006700*     MADE BY: MIKE BESKE              WR/IR #: WR38171         * 00670099
006710*                                                               * 00671099
006720* DATE  05/25/2010                                              * 00672099
006730*     CHANGE MADE:  RECOMPILE FOR CHANGES TO APWS010 COPYBOOK   * 00673099
006740*     MADE BY: PAUL STROEDE            WR/IR #: PKE000000003991 * 00674099
006750*                                                               * 00675099
006760* DATE  11/04/2014                                              * 00676099
006770*     CHANGE MADE: MODIFIED PO NUMBER LENGTH FROM 7 DIGIT TO 9  * 00677099
006780*     DIGIT IN THE REPORT LAYOUT.                               * 00678099
006790*     MADE BY: COGNIZANT               WR/IR #: CHG0094517      * 00679099
006791*                                                                 00679199
006792* DATE 08/25/2015                                                 00679299
006793*     CHANGE MADE: RECOMPILE FOR CHANGES TO APWS010 COPYBOOK    * 00679399
006794*     MADE BY: MEENAKSHI MITTAL        WR/IR #: CHG0112172      * 00679499
006795*                                                               * 00679599
006796* DATE 10/21/2015                                               * 00679699
006797*     CHANGE MADE: RECOMPILE FOR CHANGES TO APRD018 COPYBOOK    * 00679799
006798*     MADE BY: MEENAKSHI MITTAL        WR/IR #: CHG0126130      * 00679899
006799*                                                               * 00679999
006800* DATE  11/02/2020                                              * 00680099
006801*    CHANGE MADE: RECOMPILED TO INCLUDE CHANGES TO COPYBOOK     * 00680199
006802*    APWS010.                                                   * 00680299
006803*    MADE BY: NANCY EILBES            WR/IR #: CHG0250510       * 00680399
007010*                                                               * 00680499
007020* DATE  05/10/2023                                              * 00680599
007030*    CHANGE MADE: RECOMPILED FOR CHANGES TO COPYBOOK APWS010    * 00680699
007050*    MADE BY: JEAN KURK               WR/IR #: CHG0288104       * 00680799
006810*---------------------------------------------------------------* 00681007
006900 ENVIRONMENT DIVISION.                                            00690001
007000 CONFIGURATION SECTION.                                           00700001
007100 SOURCE-COMPUTER.        IBM-370.                                 00710001
007200 OBJECT-COMPUTER.        IBM-370.                                 00720001
007300                                                                  00730001
007400 INPUT-OUTPUT SECTION.                                            00740001
007500 FILE-CONTROL.                                                    00750001
007600     SELECT PENDING-RPT-FILE     ASSIGN TO INP01.                 00760056
007700     SELECT INVC-IN-PR-REPORT    ASSIGN TO RPT01.                 00770053
007800                                                                  00780001
007900 DATA DIVISION.                                                   00790001
008000 FILE SECTION.                                                    00800001
008100                                                                  00810001
008200 FD  PENDING-RPT-FILE                                             00820053
008300     RECORDING MODE IS F                                          00830001
008400     LABEL RECORDS ARE STANDARD                                   00840001
008500     BLOCK CONTAINS 0 RECORDS                                     00850001
008600     RECORD CONTAINS 750 CHARACTERS                               00860099
008700     DATA RECORD IS PENDING-RPT-REC.                              00870053
008800                                                                  00880001
008900 01  PENDING-RPT-REC                    PIC X(750).               00890099
009000                                                                  00900001
009100 FD  INVC-IN-PR-REPORT                                            00910053
009200     RECORDING MODE IS F                                          00920001
009300     LABEL RECORDS ARE STANDARD                                   00930001
009400     BLOCK CONTAINS 0 RECORDS                                     00940001
009500     RECORD CONTAINS 150 CHARACTERS                               00950002
009600     DATA RECORD IS INVC-IN-PR-REPORT-REC.                        00960053
009700                                                                  00970001
009800 01  INVC-IN-PR-REPORT-REC              PIC X(150).               00980053
009900                                                                  00990001
010000                                                                  01000001
010100 WORKING-STORAGE SECTION.                                         01010001
010200                                                                  01020001
010300 01  PROGRAM-SWITCHES.                                            01030001
010400     05  PS-PENDING-RPT-EOF-SW          PIC X       VALUE 'N'.    01040053
010500         88 PS-PENDING-RPT-NOT-EOF                  VALUE 'N'.    01050053
010600         88 PS-PENDING-RPT-EOF                      VALUE 'Y'.    01060053
010700     05  PS-END-OF-TABLE-CHRG-SW        PIC X       VALUE 'N'.    01070030
010800         88 PS-NOT-END-OF-TABLE-CHRG                VALUE 'N'.    01080030
010900         88 PS-END-OF-TABLE-CHRG                    VALUE 'Y'.    01090030
011000                                                                  01100001
011100 01  PROGRAM-VARIABLES.                                           01110001
011200     05  PV-PENDING-RPT-OUT             PIC 9(12)   VALUE 0.      01120012
011300     05  PV-COUNT-INPUT                 PIC 9(12)   VALUE 0.      01130054
011400     05  PV-HOLD-CHRG-AMT               PIC S9(09)V99 COMP-3.     01140094
011500     05  PV-HOLD-CALC-DEC               PIC S9(05)V999 COMP-3.    01150099
011600     05  MAX-LINES                      PIC  S9(3)  COMP-3        01160001
011700                                                    VALUE +65.    01170079
011800     05  PAGE-COUNT                     PIC S9(9) COMP-3 VALUE +0.01180010
011900     05  LINE-COUNT                     PIC S9(3) COMP-3 VALUE +0.01190010
012000     05  PV-SYSTEM-DATE                 PIC X(08)  VALUE ZERO.    01200001
012100     05  FILLER REDEFINES PV-SYSTEM-DATE.                         01210001
012200         10  PV-SYSTEM-CCYY.                                      01220001
012300             15  PV-SYSTEM-CENTURY      PIC X(02).                01230001
012400             15  PV-SYSTEM-YEAR         PIC X(02).                01240001
012500         10  PV-SYSTEM-MONTH            PIC X(02).                01250001
012600         10  PV-SYSTEM-DAY              PIC X(02).                01260001
012700     05  PV-SYSTEM-TIME.                                          01270001
012800         10  PV-SYSTEM-HOUR             PIC 9(02) VALUE ZERO.     01280010
012900         10  PV-SYSTEM-MINUTE           PIC 9(02) VALUE ZERO.     01290010
013000         10  PV-SYSTEM-SECOND           PIC 9(02) VALUE ZERO.     01300010
013100         10  FILLER                     PIC 9(02) VALUE ZERO.     01310010
013200     05  PV-PROGRAM-NAME                PIC X(8) VALUE 'APKRP227'.01320010
013300     05  SAVE-CHRG-CODE                 PIC X(03) VALUE SPACES.   01330054
013400     05  SAVE-CHRG-AMT                  PIC -------.99            01340054
013500                                                  VALUE ZEROES.   01350054
013600     05  SAVE-CALC-DEC                  PIC S9(05)V999 COMP-3     01360099
013700                                                  VALUE ZEROES.   01370097
013800     05  PV-HOLD-CALC-PO                PIC S9(4)V99 COMP-3       01380099
013900                                                  VALUE ZEROES.   01390053
014000                                                                  01400001
014100*----------------------------------------------------------------*01410007
014200*           KOHLS STANDARD 150 CHARACTER REPORT HEADER           *01420051
014300*----------------------------------------------------------------*01430007
014400     COPY DPWS150O.                                               01440011
014500                                                                  01450001
014600 01  BLANK-LINE                PIC X(150) VALUE SPACES.           01460004
014700                                                                  01470001
014800 01  SAVE-DETAIL-LINE          PIC X(150) VALUE SPACES.           01480054
014900                                                                  01490054
015000 01  HDR-TITLE-1.                                                 01500001
015100     05  FILLER                  PIC  X(57)     VALUE SPACE.      01510004
015200     05  FILLER                  PIC  X(33)     VALUE             01520001
015300             'INVOICES LOADED IN PENDING STATUS'.                 01530002
015400     05  FILLER                  PIC  X(48)     VALUE SPACE.      01540001
015500                                                                  01550001
015600 01  HEADER-1.                                                    01560001
015700     05  FILLER                PIC X(37) VALUE SPACES.            01570099
015800     05  FILLER                PIC X(02) VALUE 'PO'.              01580002
015900     05  FILLER                PIC X(30) VALUE SPACES.            01590099
016000     05  FILLER                PIC X(12) VALUE 'CONTAINER / '.    01600002
016100     05  FILLER                PIC X(04) VALUE SPACES.            01610099
016200     05  FILLER                PIC X(11) VALUE 'NET INVOICE'.     01620002
016300     05  FILLER                PIC X(03) VALUE SPACES.            01630046
016400     05  FILLER                PIC X(04) VALUE 'CHRG'.            01640002
016500     05  FILLER                PIC X(07) VALUE SPACES.            01650095
016600     05  FILLER                PIC X(06) VALUE 'CHARGE'.          01660002
016700     05  FILLER                PIC X(08) VALUE SPACES.            01670095
016800     05  FILLER                PIC X(05) VALUE 'TOTAL'.           01680002
016900     05  FILLER                PIC X(03) VALUE SPACES.            01690095
017000     05  FILLER                PIC X(06) VALUE 'PO CTN'.          01700094
017100     05  FILLER                PIC X(03) VALUE SPACES.            01710095
017200     05  FILLER                PIC X(08) VALUE 'CALC DDF'.        01720058
017300     05  FILLER                PIC X(01) VALUE SPACES.            01730095
017400                                                                  01740001
017500 01  HEADER-2.                                                    01750001
017600     05  FILLER                PIC X(09) VALUE 'VENDOR ID'.       01760002
017700     05  FILLER                PIC X(03) VALUE SPACES.            01770099
017800     05  FILLER                PIC X(11) VALUE 'VENDOR NAME'.     01780002
017900     05  FILLER                PIC X(12) VALUE SPACES.            01790099
018000     05  FILLER                PIC X(06) VALUE 'NUMBER'.          01800002
018100     05  FILLER                PIC X(04) VALUE SPACES.            01810099
018200     05  FILLER                PIC X(15) VALUE 'INVOICE ID'.      01820099
018300     05  FILLER                PIC X(07) VALUE SPACES.            01830099
018400     05  FILLER                PIC X(14) VALUE 'BOL ID / ENTRY'.  01840002
018500     05  FILLER                PIC X(09) VALUE SPACES.            01850099
018600     05  FILLER                PIC X(06) VALUE 'AMOUNT'.          01860002
018700     05  FILLER                PIC X(03) VALUE SPACES.            01870046
018800     05  FILLER                PIC X(04) VALUE 'CODE'.            01880002
018900     05  FILLER                PIC X(07) VALUE SPACES.            01890095
019000     05  FILLER                PIC X(06) VALUE 'AMOUNT'.          01900002
019100     05  FILLER                PIC X(06) VALUE SPACES.            01910095
019200     05  FILLER                PIC X(07) VALUE 'DRAYAGE'.         01920092
019300     05  FILLER                PIC X(04) VALUE SPACES.            01930063
019400     05  FILLER                PIC X(03) VALUE 'QTY'.             01940058
019500     05  FILLER                PIC X(06) VALUE SPACES.            01950095
019600     05  FILLER                PIC X(06) VALUE 'RT/CTN'.          01960090
019700     05  FILLER                PIC X(02) VALUE SPACES.            01970095
019800                                                                  01980001
019900 01  DETAIL-1.                                                    01990001
020000     05  DTL-VENDOR-ID         PIC X(10) VALUE SPACES.            02000024
020100     05  FILLER                PIC X(02) VALUE SPACES.            02010099
020200     05  DTL-VENDOR-NAME       PIC X(20) VALUE SPACES.            02020044
020300     05  FILLER                PIC X(02) VALUE SPACES.            02030099
020400     05  DTL-PO-NUMBER         PIC ZZZZZZZZ9 VALUE ZEROES.        02040099
020500     05  FILLER                PIC X(02) VALUE SPACES.            02050099
020600     05  DTL-INVOICE-ID        PIC X(22) VALUE SPACES.            02060099
020700     05  FILLER                PIC X(01) VALUE SPACES.            02070099
020800     05  DTL-REFERENCE-ID      PIC X(16) VALUE SPACES.            02080024
020900     05  FILLER                PIC X(01) VALUE SPACES.            02090099
021000     05  DTL-NET-INVC-AMT      PIC --------.99                    02100044
021100                                         VALUE ZEROES.            02110030
021200     05  FILLER                PIC X(03) VALUE SPACES.            02120095
021300     05  DTL-CHRG-CODE         PIC X(03) VALUE SPACES.            02130024
021400     05  FILLER                PIC X(04) VALUE SPACES.            02140095
021500     05  DTL-CHRG-AMT          PIC -------.99                     02150044
021600                                         VALUE ZEROES.            02160030
021700     05  FILLER                PIC X(03) VALUE SPACES.            02170095
021800     05  DTL-TOT-DRAYAGE       PIC -------.99                     02180092
021900                                         VALUE ZEROES.            02190030
022000     05  FILLER                PIC X(03) VALUE SPACES.            02200095
022100     05  DTL-PO-QTY            PIC ZZZZ9 VALUE ZEROES.            02210062
022200     05  FILLER                PIC X(05) VALUE SPACES.            02220099
022300     05  DTL-CALC-DEC          PIC -.999 VALUE ZEROES.            02230099
022400     05  FILLER                PIC X(01) VALUE SPACES.            02240099
022500                                                                  02250001
022600 01  PEND-INFO-LINE.                                              02260074
022700     05  FILLER                PIC X(58) VALUE SPACES.            02270071
022800     05  FILLER                PIC X(13) VALUE                    02280080
022900        'PEND REASON: '.                                          02290081
023000     05  PEND-MSG-DETAIL       PIC X(45) VALUE SPACES.            02300074
023100     05  PEND-VARIABLE-DTL     PIC X(10) VALUE SPACES.            02310075
023200     05  FILLER                PIC X(24) VALUE SPACES.            02320080
023300                                                                  02330066
023400 01  END-OF-REPORT.                                               02340001
023500     05  FILLER                PIC X(85) VALUE SPACES.            02350001
023600     05  FILLER                PIC X(29) VALUE                    02360001
023700        '- - - - END OF REPORT - - - -'.                          02370001
023800     05  FILLER                PIC X(45) VALUE SPACES.            02380001
023900                                                                  02390001
024000 01  NO-DATA-TO-REPORT.                                           02400001
024100     05  FILLER                PIC X(63) VALUE SPACES.            02410004
024200     05  FILLER                PIC X(23) VALUE                    02420004
024300        '-  NO DATA TO REPORT  -'.                                02430004
024400     05  FILLER                PIC X(45) VALUE SPACES.            02440001
024500 EJECT                                                            02450001
024600                                                                  02460001
024700*--------------------------------------------------------------*  02470078
024800*  APWS010 RECORD LAYOUT FOR ERROR MESSAGE REPORTING           *  02480078
024900*--------------------------------------------------------------*  02490078
025000 01  WS-EDIT-CODES.                                               02500087
025100     COPY APWS010.                                                02510078
025200                                                                  02520078
025300*--------------------------------------------------------------*  02530001
025400*  APRD018 RECORD LAYOUT FOR PENDING REVIEW TRANSACTIONS       *  02540004
025500*--------------------------------------------------------------*  02550001
025600     COPY APRD018.                                                02560004
025700                                                                  02570001
025800                                                                  02580001
025900 LINKAGE SECTION.                                                 02590001
026000 PROCEDURE DIVISION.                                              02600001
026100                                                                  02610054
026200 A100-MAINLINE-ROUTINE.                                           02620001
026300                                                                  02630001
026400     PERFORM B100-INITIALIZATION.                                 02640001
026500                                                                  02650001
026600     PERFORM B200-CREATE-PENDING-RPT                              02660005
026700       UNTIL PS-PENDING-RPT-EOF.                                  02670053
026800                                                                  02680001
026900     PERFORM B300-TERMINATION.                                    02690034
027000     GOBACK.                                                      02700001
027100                                                                  02710001
027200*--------------------------------------------------------------*  02720001
027300* B100-INITIALIZATION                                          *  02730030
027400*  INITIALIZATION PROCESSING.                                  *  02740001
027500*--------------------------------------------------------------*  02750001
027600 B100-INITIALIZATION.                                             02760001
027700                                                                  02770001
027800     DISPLAY ' '.                                                 02780001
027900     DISPLAY '**--------------- APKRP227 --------------------**'. 02790004
028000     OPEN INPUT  PENDING-RPT-FILE                                 02800053
028100          OUTPUT INVC-IN-PR-REPORT.                               02810053
028200                                                                  02820001
028300     MOVE FUNCTION CURRENT-DATE TO PV-SYSTEM-DATE.                02830012
028400     MOVE PV-SYSTEM-MONTH        TO DP150O-RUN-MONTH.             02840012
028500     MOVE PV-SYSTEM-DAY          TO DP150O-RUN-DAY.               02850012
028600     MOVE PV-SYSTEM-YEAR         TO DP150O-RUN-YEAR.              02860011
028700     ACCEPT PV-SYSTEM-TIME FROM TIME.                             02870001
028800     MOVE PV-SYSTEM-HOUR         TO DP150O-RUN-HOUR.              02880011
028900     MOVE PV-SYSTEM-MINUTE       TO DP150O-RUN-MINUTE.            02890011
029000     MOVE PV-PROGRAM-NAME        TO DP150O-PROGRAM-NAME.          02900011
029100     MOVE '1'                    TO DP150O-REPORT-NUMBER.         02910011
029200     PERFORM W100-WRITE-HEADINGS.                                 02920001
029300                                                                  02930001
029400*  THIS READS THE FIRST RECORD OF THE INPUT FILE AND CHECKS TO SEE02940030
029500*  IF THERE ARE RECORDS TO PROCESS.                               02950030
029600     PERFORM R100-READ-INPUT.                                     02960001
029700                                                                  02970001
029800     IF PS-PENDING-RPT-EOF                                        02980053
029900         DISPLAY ' NO REPORT RECORDS TO PROCESS '                 02990055
030000         WRITE INVC-IN-PR-REPORT-REC FROM NO-DATA-TO-REPORT       03000053
030100             AFTER ADVANCING 1 LINE                               03010001
030200     END-IF.                                                      03020001
030300                                                                  03030001
030400                                                                  03040001
030500*--------------------------------------------------------------*  03050001
030600* B200-CREATE-PENDING-RPT                                      *  03060030
030700*  THIS ROUTINE HOLDS THE MAIN LOGIC FOR PENDING REVIEW        *  03070004
030800*  REPORTING.                                                  *  03080007
030900*--------------------------------------------------------------*  03090001
031000 B200-CREATE-PENDING-RPT.                                         03100004
031100                                                                  03110054
031200     MOVE SPACES TO DETAIL-1.                                     03120082
031300                                                                  03130054
031400     MOVE AP018-VENDOR-NBR           TO DTL-VENDOR-ID.            03140054
031500     MOVE AP018-VENDOR-NAME          TO DTL-VENDOR-NAME.          03150054
031600     MOVE AP018-PO-NBR               TO DTL-PO-NUMBER.            03160054
031700     MOVE AP018-INVOICE-NBR          TO DTL-INVOICE-ID.           03170054
031800     MOVE AP018-REFERENCE-ID-NBR     TO DTL-REFERENCE-ID.         03180057
031900     MOVE AP018-NET-INVC-AMT         TO DTL-NET-INVC-AMT.         03190054
032000     MOVE AP018-TOTAL-DRAYAGE-AMT    TO DTL-TOT-DRAYAGE.          03200092
032100     MOVE AP018-PO-QTY               TO DTL-PO-QTY.               03210058
032200                                                                  03220054
032300     MOVE DETAIL-1 TO SAVE-DETAIL-LINE.                           03230054
032400                                                                  03240054
032500     PERFORM VARYING CHRG-IDX FROM 1 BY 1                         03250054
032600       UNTIL AP018-CHARGE-CDE(CHRG-IDX) = SPACE                   03260054
032700          OR CHRG-IDX > 20                                        03270054
032800             MOVE AP018-CHARGE-CDE(CHRG-IDX) TO DTL-CHRG-CODE     03280054
032900             MOVE AP018-CHARGE-AMT(CHRG-IDX) TO DTL-CHRG-AMT      03290054
033000                                                PV-HOLD-CHRG-AMT  03300094
033100             IF DTL-CHRG-CODE = 'DDF'                             03310093
033200                DIVIDE PV-HOLD-CHRG-AMT BY AP018-PO-QTY           03320094
033300                   GIVING PV-HOLD-CALC-DEC                        03330094
033400                MOVE PV-HOLD-CALC-DEC      TO DTL-CALC-DEC        03340094
033500             END-IF                                               03350093
033600                                                                  03360098
033700             PERFORM W200-WRITE-DETAIL                            03370054
033800             MOVE SPACES TO DETAIL-1                              03380054
033900     END-PERFORM.                                                 03390054
034000                                                                  03400030
034100*** WILL CREATE INFORMATIONAL LINE FOR SPECIFIC ERROR CODES       03410087
034200     PERFORM VARYING AP018-IDX FROM 1 BY 1                        03420065
034300       UNTIL AP018-ERR-CDE(AP018-IDX) = 0                         03430076
034400          OR AP018-IDX > 30                                       03440065
034500             IF AP018-ERR-CDE(AP018-IDX) = 49 OR 50 OR 51         03450085
034600                SET MSG-IDX TO AP018-ERR-CDE(AP018-IDX)           03460085
034700                MOVE WS010-ERROR-MSG(MSG-IDX) TO PEND-MSG-DETAIL  03470085
034800                MOVE AP018-DECON-SCAC-CDE TO PEND-VARIABLE-DTL    03480085
034900                PERFORM W400-WRITE-INFO-LINE                      03490085
035000             END-IF                                               03500085
035100     END-PERFORM.                                                 03510065
035200                                                                  03520065
035300     PERFORM W300-WRITE-BLANK-LINE.                               03530054
035400                                                                  03540054
035500     PERFORM R100-READ-INPUT.                                     03550054
035600                                                                  03560001
035700*--------------------------------------------------------------*  03570001
035800* B300-TERMINATION                                             *  03580034
035900*  END OF PROGRAM PROCESSING.                                  *  03590007
036000*--------------------------------------------------------------*  03600001
036100 B300-TERMINATION.                                                03610034
036200                                                                  03620030
036300     DISPLAY '*************************************'.             03630001
036400     DISPLAY '*************************************'.             03640001
036500     DISPLAY 'EDI IMPORT INVOICE COUNT  ' PV-COUNT-INPUT.         03650054
036600     DISPLAY 'PENDING RECORDS WRITTEN  '  PV-PENDING-RPT-OUT.     03660035
036700     DISPLAY '*************************************'.             03670001
036800     DISPLAY '*************************************'.             03680001
036900                                                                  03690001
037000     CLOSE PENDING-RPT-FILE                                       03700053
037100           INVC-IN-PR-REPORT.                                     03710053
037200                                                                  03720001
037300*--------------------------------------------------------------*  03730001
037400* R100-READ-INPUT                                              *  03740007
037500*  READS A RECORD IN A FILE.                                   *  03750007
037600*--------------------------------------------------------------*  03760001
037700 R100-READ-INPUT.                                                 03770001
037800                                                                  03780030
037900      INITIALIZE AP018-REJECT-IMPORT-INVOICE.                     03790030
038000      READ PENDING-RPT-FILE INTO AP018-REJECT-IMPORT-INVOICE      03800053
038100          AT END                                                  03810001
038200              SET PS-PENDING-RPT-EOF TO TRUE                      03820053
038300      END-READ.                                                   03830001
038400                                                                  03840001
038500      IF PS-PENDING-RPT-NOT-EOF                                   03850053
038600         ADD 1 TO PV-COUNT-INPUT                                  03860054
038700      END-IF.                                                     03870001
038800                                                                  03880001
038900                                                                  03890030
039000                                                                  03900030
039100*--------------------------------------------------------------*  03910007
039200* W100-WRITE-HEADINGS                                          *  03920007
039300*  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                   *  03930007
039400*--------------------------------------------------------------*  03940007
039500 W100-WRITE-HEADINGS.                                             03950001
039600                                                                  03960001
039700     ADD 1 TO PAGE-COUNT.                                         03970001
039800     MOVE PAGE-COUNT TO DP150O-PAGE-NUMBER.                       03980011
039900     WRITE INVC-IN-PR-REPORT-REC                                  03990053
040000       FROM DP150O-STANDRD-HEADER-150-COLS AFTER ADVANCING PAGE.  04000053
040100     WRITE INVC-IN-PR-REPORT-REC FROM HDR-TITLE-1                 04010053
040200         AFTER ADVANCING 1 LINE.                                  04020001
040300     WRITE INVC-IN-PR-REPORT-REC FROM BLANK-LINE                  04030054
040400         AFTER ADVANCING 1 LINE.                                  04040054
040500     WRITE INVC-IN-PR-REPORT-REC FROM HEADER-1                    04050053
040600         AFTER ADVANCING 2 LINES.                                 04060001
040700     WRITE INVC-IN-PR-REPORT-REC FROM HEADER-2                    04070053
040800         AFTER ADVANCING 1 LINE.                                  04080001
040900     WRITE INVC-IN-PR-REPORT-REC FROM BLANK-LINE                  04090053
041000         AFTER ADVANCING 1 LINE.                                  04100001
041100     MOVE +7            TO LINE-COUNT.                            04110005
041200                                                                  04120001
041300*--------------------------------------------------------------*  04130001
041400* W200-WRITE-DETAIL                                            *  04140007
041500*  THIS ROUTINE WRITES THE DETAIL LINES.                       *  04150066
041600*--------------------------------------------------------------*  04160001
041700 W200-WRITE-DETAIL.                                               04170001
041800                                                                  04180001
041900     IF LINE-COUNT >= MAX-LINES                                   04190001
042000        PERFORM W100-WRITE-HEADINGS                               04200001
042100        MOVE DTL-CHRG-CODE    TO SAVE-CHRG-CODE                   04210054
042200        MOVE DTL-CHRG-AMT     TO SAVE-CHRG-AMT                    04220054
042300        MOVE DTL-CALC-DEC     TO SAVE-CALC-DEC                    04230097
042400        MOVE SAVE-DETAIL-LINE TO DETAIL-1                         04240054
042500        MOVE SAVE-CHRG-CODE   TO DTL-CHRG-CODE                    04250054
042600        MOVE SAVE-CHRG-AMT    TO DTL-CHRG-AMT                     04260054
042700        IF DTL-CHRG-CODE = 'DDF'                                  04270097
042800           MOVE SAVE-CALC-DEC TO DTL-CALC-DEC                     04280097
042900        END-IF                                                    04290097
043000     END-IF.                                                      04300001
043100                                                                  04310001
043200     WRITE INVC-IN-PR-REPORT-REC FROM DETAIL-1                    04320054
043300         AFTER ADVANCING 1 LINE.                                  04330054
043400                                                                  04340054
043500     ADD 1 TO LINE-COUNT                                          04350054
043600              PV-PENDING-RPT-OUT.                                 04360005
043700                                                                  04370001
043800*--------------------------------------------------------------*  04380001
043900* W300-WRITE-BLANK-LINE                                        *  04390054
044000*--------------------------------------------------------------*  04400001
044100 W300-WRITE-BLANK-LINE.                                           04410054
044200                                                                  04420001
044300     IF LINE-COUNT >= MAX-LINES                                   04430001
044400        CONTINUE                                                  04440001
044500     ELSE                                                         04450001
044600        WRITE INVC-IN-PR-REPORT-REC FROM BLANK-LINE               04460053
044700        ADD 1 TO LINE-COUNT                                       04470001
044800     END-IF.                                                      04480001
044900                                                                  04490006
045000*--------------------------------------------------------------*  04500066
045100* W400-WRITE-INFO-LINE                                         *  04510066
045200*  THIS ROUTINE WRITES THE PENDING INFORMATIONAL LINE.         *  04520076
045300*--------------------------------------------------------------*  04530066
045400 W400-WRITE-INFO-LINE.                                            04540066
045500                                                                  04550066
045600     WRITE INVC-IN-PR-REPORT-REC FROM PEND-INFO-LINE              04560074
045700        AFTER ADVANCING 1 LINE.                                   04570066
045800                                                                  04580066
045900     ADD 1 TO LINE-COUNT.                                         04590066
046000                                                                  04600066
