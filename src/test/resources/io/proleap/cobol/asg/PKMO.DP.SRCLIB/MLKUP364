       IDENTIFICATION DIVISION.                                         00010016
       PROGRAM-ID.    MLKUP364.                                         00020016
       AUTHOR.        RYAN STAUFFACHER.                                 00030016
       INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040016
       DATE-WRITTEN.  12/13/05.                                         00050016
       DATE-COMPILED.                                                   00060016
      ******************************************************************00070016
W34517* THIS PROGRAM IS THE BRAND VENDOR VERSION OF MLKUP358.          *00080016
      * THIS PROGRAM WILL PROCESS FILES THAT ARE OUTPUT FROM MLK140    *00090016
      * AND ASSIGN BRAND/VENDOR/PRORATION INFORMATION AS APPROPRIATE.  *00100016
      ******************************************************************00110016
      *CHANGE HISTORY:                                                  00120016
      * WR/PROJ DATE       PGMR           DESCRIPTION OF CHANGES        00130016
      * ------- ---------- -------------  ----------------------------- 00140016
      * W28582  01-01-2007 M MACHNIK      ADD AUDIT REPORTS.            00150016
RONNAX* W28582  02-26-2007 R MCDONALD     FIX DA PRORATION WHEN DA IS   00160016
RONNAX*                                   NOT FOUND.                    00170016
J28582* W28582  03-11-2007 J SELWITSCHKA  ADD DEPT TO HOLD MATCH LOGIC. 00180016
W32898* W32898  10-24-2007 B. GRAHAM - STRATAGEM                        00190016
W32898*                                   BRAND VENDOR PHASE II         00200016
W32898*                                   USE INPUT ENT ID AND LBL SEQ  00210016
W32898*                                   FOR PURCH RECORDS IF PRESENT. 00220016
W32898*                                   DO NOT OVERLAY WITH BV VENDOR 00230016
W32898*                                   RESULTS. NEW AP TRANS CODES   00240016
W32898*                                   Z1 THRU Z4.                   00250016
W34309* W34309  03-11-2008 B. GRAHAM - STRATAGEM                        00260016
W34309*                                   PRIVATE BRAND ACCOUNTING      00270016
W34309*                                   GIVEBACK                      00280016
B32898* B32898  07-29-2008 B GRAHAM - STRATAGEM                         00290016
B32898*                                   AP-TRAN-CODES Z1 AND Z2 TO    00300016
B32898*                                   REPLACE 52 AND 53 PROCESS OLD 00310016
B32898*                                   WAY, Z3 THRU Z8 PROCESS NEW   00320016
B32898*                                   WAY                           00330016
W34517* W34517  07-29-2008 J SELWITSCHKA  ADD BV BEGINNING OF MONTH     00340016
W34517*                                   COPY CODE (BVPD101, BVWS101)  00350016
W34517*                                   TO GET BOM BRAND AND VENDOR   00360016
W34517*                                   FOR REASSIGNMENT. WRITE AUDIT 00370016
W34517*                                   RECORDS FOR REASSIGNMENT. ADD 00380016
W34517*                                   NEW TRAN CODE PRORATION LOGIC.00390016
W34517*                                   WRITE NEWLY IDENTIFIED EXPENSE00400016
W34517*                                   VENDORS TO THE EXPENSE VENDOR 00410016
W34517*                                   FILE. WRITE UNCLASSIFIED      00420016
W34517*                                   LICENSE FEE VENDORS TO A FILE.00430016
W31475* W31475  05-20-2009 COGNIZANT      ML PERFORMANCE TUNING         00440016
W31475*                                   CALL TO MLKUP359 IS SUBSTITUTE00450016
W31475*                                   BY DB2 CURSOR.                00460016
W31475*                                   INPD400 IS REPLACED BY INPD40200470016
W31475*                                   FOR BETTER PERFORMANCE.       00480016
W37965* W37965 12-22-2009 SURENDAR  B     BRAND VENDOR - EXCEPTION      00490016
W37965*                                   AND TRANSACTION MANAGEMENT.   00500016
W37965*                                   PROGRAM CHANGED:              00510016
W37965*                                   1)TO ACCESS THE NEW EXPENSE   00520016
W37965*                                   VENDOR DB2 TABLE INSTEAD OF   00530016
W37965*                                   THE EXPENSE VENDOR FILE.      00540016
W37965*                                   2)TO WRITE DETAIL AUDIT FILES 00550016
W37965*                                   FOR PURCHASE ADJUSTMENTS,SALES00560016
W37965*                                   ,PRICE CHANGES AND INVENTORY  00570016
W37965*                                   ADJUSTMENTS.                  00580016
PK8624* PK8624 08-19-2011 COGNIZANT       ADDED 3 BELOW NEW BRAND'S FOR 00590016
PK8624*                                   TRANS CODE - '0N' AND '0P'    00600016
PK8624*                                   3529 - FILA SPORT GOLF        00610016
PK8624*                                   3689 - JENNIFER LOPEZ         00620016
PK8624*                                   3028 - LC BY LAUREN CONRAD    00630016
PK9934* PK9934 09-22-2011 RONNA           TRYING TO FIND FIX FOR        00630116
PK9934*                                   PADJ NET COST/FREIGHT ISSUE.  00630216
PK9934*                                   NOTICED THAT 3H AND 3I AP     00630316
PK9934*                                   TRAN CODES WERE SET UP IN THE 00630416
PK9934*                                   88 LEVEL FOR SKU TRANSACTION  00630516
PK9934*                                   BUT NOT IN THE 88 LEVEL FOR   00630616
PK9934*                                   RCPT GROSS COST PERCENT.      00630716
PK9934*                                   THE RECEIPT GROSS COST IS     00630816
PK9934*                                   THE CATCH ALL                 00630916
PK9934* PK9934 03-05-2012 COGNIZANT      >REMOVED HARD CODED BRANDS IN  00631016
PK9934*                                   PARA - 2870-PURCH-SPCL-BRND   00632016
PK9934*                                  >MADE CHANGES TO BVWS002 &     00633016
PK9934*                                   BVPD002                       00634016
PK9934*                                  >ANY NEW BRANDS THAT NEEDS TO  00635016
PK9934*                                   BE ADDED CAN BE DONE THRU A   00636016
PK9934*                                   DCR INTO THE TABLE            00637016
PK9934*                                                - MLT_VND_ALLOC  00638016
PK9934*                                  >DEFINED 2 NEW EXP TYPES       00639016
PK9934*                                    - 06, 07 IN MLT_EXP_TYP      00639116
RONNA * RONNA  05-09-2012 RONNA M        RECOMPILE TO PICK UP BVPD101   00639216
RONNA *                                  CHANGE TO COMMENT A DISPLAY    00639316
RONNA *                                  SO THAT IT DOESN'T SHOW UP     00639416
RONNA *                                  IN THE OUTPUT.  THIS WAS       00639516
RONNA *                                  DONE TO IMPROVE THE PERFORMANCE00639616
RONNA *                                  FOR INKUT266 PROGRAM THAT      00639716
RONNA *                                  USES BVPD101                   00639816
P49767*P49767  19-09-2014 COGNIZANT      MODIFIED THE CODE TO HANDLE    00639916
P49767*                                  RTV TRANSACTONS WITH MODIFIED  00640016
P49767*                                  DOC NUMBER FROM AP.            00640116
P49767*                                  ML030-PURCH-DOC-16-NBR         00640216
C89593*C89593  19-06-2023 GERMAN BANDA   UPDATE CHANGE P49767 TO ALLOW  00640316
C89593*                                  FOR A VARIABLE LENGTH OF THE   00640416
C89593*                                  DOC NUMBER FROM AP.            00640516
C89593*                                  ML030-PURCH-DOC-16-NBR         00640616
C89593*                                     (1:PV-TEMP-COUNT)           00640716
C89593*                                  THE DOC NUMBER FROM AP WILL    00640816
C89593*                                  STILL CONTAIN ORDERID FOLLOWED 00640916
C89593*                                  BY '_' HOWEVER, NOW WILL BE    00641016
C89593*                                  BE FOLLOWED BY RTV NOT DATE    00641116
C89593*                                  123456789123_RTV - MAX 12      00641216
C89593*                                  NO LEADING ZEROES              00641316
RONNAZ*        09-18-2023 RONNA MCDONALD UPDATE CHANGE C89593 TO ALLOW  00641416
RONNAZ*                   FOR A PRE-CHECK OF AN RTV DOC MATCHING        00641516
RONNAZ*                   THE DOLLAR VALUES IN THE INPUT TRANSACTION    00641616
RONNAZ*                   SO THAT THE ITEMS AND VALUES IN THE RTV TABLE 00641716
RONNAZ*                   CAN BE USED FOR THE BRAND VENDOR RESOLUTION   00641816
RONNAZ*                   IN THE EVENT THAT THE DOLLARS DO NOT MATCH    00641916
RONNAZ*                   OR THE RTV IS NOT FOUND, THE BV WILL GET      00642016
RONNAZ*                   EVENLY PRORATED.  SEE CHG0295071              00642116
RONNAY*                                                                 00642216
RONNAY*        02-09-2024 RONNA MCDONALD                                00642316
RONNAY*                   THE TEST THAT WAS RUN AFTER MOVING TO PROD    00642416
RONNAY*                   SHOWED THAT THE DOLLARS IN DID NOT MATCH      00642516
RONNAY*                   THE DOLLARS OUT.                              00642616
RONNAY*                   AM ROLLING THE CHANGE BACK.                   00642716
RONNAY*                                     SEE CHG0295071              00642816
RONNAW*        02-09-2024 RONNA MCDONALD                                00642916
RONNAW*                   RESTORE CODE FROM LABEL 'RONNAZ' AND FIX      00643016
RONNAW*                   THE ISSUE OF OUT OF BALANCE                   00643116
RONNAW*                                     SEE CHG0305349              00643227
      ******************************************************************00643316
                                                                        00643416
      ******************************************************************00643516
       ENVIRONMENT DIVISION.                                            00643616
      ******************************************************************00643716
                                                                        00643816
       CONFIGURATION SECTION.                                           00643916
                                                                        00644016
       SOURCE-COMPUTER.        IBM-3090.                                00644116
       OBJECT-COMPUTER.        IMB-3090.                                00644216
                                                                        00644316
       INPUT-OUTPUT SECTION.                                            00644416
                                                                        00644516
       FILE-CONTROL.                                                    00644616
           SELECT PURCH-FILE                                            00644716
               ASSIGN TO INP01.                                         00644816
           SELECT SALE-FILE                                             00644916
               ASSIGN TO INP02.                                         00645016
           SELECT PRC-CHG-FILE                                          00645116
               ASSIGN TO INP03.                                         00645216
           SELECT ADJUSTMENT-FILE                                       00646016
               ASSIGN TO INP04.                                         00647016
           SELECT IN-ORACLE-SRC-CTL                                     00648016
               ASSIGN TO INP05.                                         00649016
           SELECT CNTL-DATE-FILE                                        00650016
               ASSIGN TO INP06.                                         00660016
W28582     SELECT CNTL-JOB-FILE                                         00670016
W28582         ASSIGN TO INP07.                                         00680016
W37965*    SELECT BV-EXP-VND-FILE                                       00690016
W37965*        ASSIGN TO INP08.                                         00700016
W37965     SELECT ENT-TYPE-FILE                                         00710016
W37965         ASSIGN TO INP08.                                         00720016
                                                                        00730016
           SELECT BV-PURCH-FILE                                         00740016
               ASSIGN TO OUT01.                                         00750016
           SELECT BV-SALE-FILE                                          00760016
               ASSIGN TO OUT02.                                         00770016
           SELECT BV-PRC-CHG-FILE                                       00780016
               ASSIGN TO OUT03.                                         00790016
           SELECT BV-ADJUSTMENT-FILE                                    00800016
               ASSIGN TO OUT04.                                         00810016
W28582     SELECT BV-ERROR-FILE                                         00820016
W28582         ASSIGN TO OUT05.                                         00830016
W34517     SELECT BV-UNCL-LIC-FILE                                      00840016
W34517         ASSIGN TO OUT06.                                         00850016
W34517     SELECT BV-DEF-EXP-VND-FILE                                   00860016
W34517         ASSIGN TO OUT07.                                         00870016
W34517     SELECT BV-SPEC-NOTFND-FILE                                   00880016
W34517         ASSIGN TO OUT08.                                         00890016
W37965     SELECT BV-PURCH-AUDIT-FILE                                   00900016
W37965         ASSIGN TO OUT09.                                         00910016
W37965     SELECT BV-SALE-AUDIT-FILE                                    00920016
W37965         ASSIGN TO OUT10.                                         00930016
W37965     SELECT BV-PRC-CHG-AUDIT-FILE                                 00940016
W37965         ASSIGN TO OUT11.                                         00950016
W37965     SELECT BV-INV-ADJ-AUDIT-FILE                                 00960016
W37965         ASSIGN TO OUT12.                                         00970016
W28582                                                                  00980016
W28582     SELECT BV-PURCH-AUDIT-RPT                                    00990016
W28582         ASSIGN TO RPT01.                                         01000016
W28582     SELECT BV-SALE-AUDIT-RPT                                     01010016
W28582         ASSIGN TO RPT02.                                         01020016
W28582     SELECT BV-PRC-CHG-AUDIT-RPT                                  01030016
W28582         ASSIGN TO RPT03.                                         01040016
W28582     SELECT BV-ADJUSTMENT-AUDIT-RPT                               01050016
W28582         ASSIGN TO RPT04.                                         01060016
                                                                        01070016
      ******************************************************************01080016
       DATA DIVISION.                                                   01090016
      ******************************************************************01100016
                                                                        01110016
       FILE SECTION.                                                    01120016
       FD  PURCH-FILE                                                   01130016
           RECORDING  MODE IS F                                         01140016
           BLOCK CONTAINS 0 RECORDS.                                    01150016
       01  PURCH-REC                        PIC X(200).                 01160016
                                                                        01170016
       FD  SALE-FILE                                                    01180016
           RECORDING  MODE IS F                                         01190016
           BLOCK CONTAINS 0 RECORDS.                                    01200016
       01  SALE-REC                         PIC X(80).                  01210016
                                                                        01220016
       FD  PRC-CHG-FILE                                                 01230016
           RECORDING  MODE IS F                                         01240016
           BLOCK CONTAINS 0 RECORDS.                                    01250016
       01  PRC-CHG-REC                      PIC X(200).                 01260016
                                                                        01270016
       FD  ADJUSTMENT-FILE                                              01280016
           RECORDING  MODE IS F                                         01290016
           BLOCK CONTAINS 0 RECORDS.                                    01300016
       01  ADJUSTMENT-REC                   PIC X(90).                  01310016
                                                                        01320016
       FD  IN-ORACLE-SRC-CTL                                            01330016
           LABEL RECORDS ARE STANDARD                                   01340016
           RECORDING MODE IS F                                          01350016
           BLOCK CONTAINS 0 RECORDS.                                    01360016
       01  IN-ORA-SRC-CTL-RECORD.                                       01370016
           05  IOC-SRC-SYSTEM       PIC X(04).                          01380016
           05  FILLER               PIC X(01).                          01390016
           05  IOC-USER-NAME        PIC X(08).                          01400016
           05  FILLER               PIC X(01).                          01410016
           05  IOC-USER-LGTH        PIC 9(02).                          01420016
           05  FILLER               PIC X(01).                          01430016
           05  IOC-PASSWORD         PIC X(08).                          01440016
           05  FILLER               PIC X(01).                          01450016
           05  IOC-PASSWORD-LGTH    PIC 9(02).                          01460016
           05  FILLER               PIC X(01).                          01470016
           05  IOC-REST-RECORD      PIC X(51).                          01480016
                                                                        01490016
                                                                        01500016
       FD  CNTL-DATE-FILE                                               01510016
           RECORDING  MODE IS F.                                        01520016
       01  CNTL-DATE-REC                    PIC X(80).                  01530016
                                                                        01540016
W28582 FD  CNTL-JOB-FILE                                                01550016
W28582     RECORDING  MODE IS F.                                        01560016
W28582 01  CNTL-JOB-REC                     PIC X(80).                  01570016
                                                                        01580016
W37965*FD  BV-EXP-VND-FILE                                              01590016
W37965*    RECORDING  MODE IS F                                         01600016
W37965*    BLOCK CONTAINS 0 RECORDS.                                    01610016
W37965*01  BV-EXP-VND-REC                      PIC X(80).               01620016
W37965*                                                                 01630016
W37965 FD  ENT-TYPE-FILE                                                01640016
W37965     RECORDING  MODE IS F                                         01650016
W37965     BLOCK CONTAINS 0 RECORDS.                                    01660016
W37965 01  ENT-TYPE-REC                        PIC X(80).               01670016
W37965                                                                  01680016
       FD  BV-PURCH-FILE                                                01690016
           RECORDING  MODE IS F                                         01700016
           BLOCK CONTAINS 0 RECORDS.                                    01710016
       01  BV-PURCH-REC                        PIC X(200).              01720016
                                                                        01730016
       FD  BV-SALE-FILE                                                 01740016
           RECORDING  MODE IS F                                         01750016
           BLOCK CONTAINS 0 RECORDS.                                    01760016
       01  BV-SALE-REC                         PIC X(80).               01770016
                                                                        01780016
       FD  BV-PRC-CHG-FILE                                              01790016
           RECORDING  MODE IS F                                         01800016
           BLOCK CONTAINS 0 RECORDS.                                    01810016
       01  BV-PRC-CHG-REC                      PIC X(200).              01820016
                                                                        01830016
       FD  BV-ADJUSTMENT-FILE                                           01840016
           RECORDING  MODE IS F                                         01850016
           BLOCK CONTAINS 0 RECORDS.                                    01860016
       01  BV-ADJUSTMENT-REC                   PIC X(90).               01870016
                                                                        01880016
W34517 FD  BV-UNCL-LIC-FILE                                             01890016
W34517     RECORDING  MODE IS F                                         01900016
W34517     BLOCK CONTAINS 0 RECORDS.                                    01910016
W34517 01  BV-UNCL-LIC-REC                     PIC X(80).               01920016
W34517                                                                  01930016
W34517 FD  BV-DEF-EXP-VND-FILE                                          01940016
W34517     RECORDING  MODE IS F                                         01950016
W34517     BLOCK CONTAINS 0 RECORDS.                                    01960016
W34517 01  BV-DEF-EXP-VND-REC                  PIC X(80).               01970016
W34517                                                                  01980016
W34517 FD  BV-SPEC-NOTFND-FILE                                          01990016
W34517     RECORDING  MODE IS F                                         02000016
W34517     BLOCK CONTAINS 0 RECORDS.                                    02010016
W34517 01  BV-SPEC-NOTFND-REC                  PIC X(80).               02020016
W34517                                                                  02030016
W28582 FD  BV-ERROR-FILE                                                02040016
W28582     RECORDING  MODE IS F                                         02050016
W28582     BLOCK CONTAINS 0 RECORDS.                                    02060016
W28582 01  BV-ERROR-REC                        PIC X(247).              02070016
W28582                                                                  02080016
W37965 FD  BV-PURCH-AUDIT-FILE                                          02090016
W37965     RECORDING  MODE IS F                                         02100016
W37965     BLOCK CONTAINS 0 RECORDS.                                    02110016
W37965 01  BV-PURCH-AUDIT-DETAIL-REC           PIC X(200).              02120016
W37965                                                                  02130016
W37965 FD  BV-SALE-AUDIT-FILE                                           02140016
W37965     RECORDING  MODE IS F                                         02150016
W37965     BLOCK CONTAINS 0 RECORDS.                                    02160016
W37965 01  BV-SALE-AUDIT-DETAIL-REC            PIC X(200).              02170016
W37965                                                                  02180016
W37965 FD  BV-PRC-CHG-AUDIT-FILE                                        02190016
W37965     RECORDING  MODE IS F                                         02200016
W37965     BLOCK CONTAINS 0 RECORDS.                                    02210016
W37965 01  BV-PCHG-AUDIT-DETAIL-REC            PIC X(200).              02220016
W37965                                                                  02230016
W37965 FD  BV-INV-ADJ-AUDIT-FILE                                        02240016
W37965     RECORDING  MODE IS F                                         02250016
W37965     BLOCK CONTAINS 0 RECORDS.                                    02260016
W37965 01  BV-INV-ADJ-AUDIT-DETAIL-REC         PIC X(200).              02270016
                                                                        02280016
W28582 FD  BV-PURCH-AUDIT-RPT                                           02290016
W28582     RECORDING  MODE IS F                                         02300016
W28582     BLOCK CONTAINS 0 RECORDS.                                    02310016
W28582 01  BV-PURCH-AUDIT-REC                  PIC X(150).              02320016
W28582                                                                  02330016
W28582 FD  BV-SALE-AUDIT-RPT                                            02340016
W28582     RECORDING  MODE IS F                                         02350016
W28582     BLOCK CONTAINS 0 RECORDS.                                    02360016
W28582 01  BV-SALE-AUDIT-REC                   PIC X(132).              02370016
W28582                                                                  02380016
W28582 FD  BV-PRC-CHG-AUDIT-RPT                                         02390016
W28582     RECORDING  MODE IS F                                         02400016
W28582     BLOCK CONTAINS 0 RECORDS.                                    02410016
W28582 01  BV-PCHG-AUDIT-REC                   PIC X(132).              02420016
W28582                                                                  02430016
W28582 FD  BV-ADJUSTMENT-AUDIT-RPT                                      02440016
W28582     RECORDING  MODE IS F                                         02450016
W28582     BLOCK CONTAINS 0 RECORDS.                                    02460016
W28582 01  BV-ADJ-AUDIT-REC                    PIC X(132).              02470016
W28582                                                                  02480016
       WORKING-STORAGE SECTION.                                         02490016
                                                                        02500016
       01  ABEND-CODE                        PIC S9(4) VALUE ZEROS      02510016
                                                       COMP SYNC.       02520016
           88  AC-OTHER-ERROR                          VALUE +4003.     02530016
           88  AC-SQL-ERROR                            VALUE +4013.     02540016
                                                                        02550016
       01  PS-PROGRAM-SWITCHES.                                         02560016
W28582     05  PS-RUN-TYPE-SW                PIC  X(01)    VALUE ' '.   02570016
W28582         88  PS-NORMAL-RUN                           VALUE '0'.   02580016
W28582         88  PS-RESTART-RUN                          VALUE '9'.   02590016
           05  PS-END-PROCESSING-SW          PIC X(01) VALUE 'N'.       02600016
               88  PS-END-PROCESSING                   VALUE 'Y'.       02610016
               88  PS-NOT-END-PROCESSING               VALUE 'N'.       02620016
           05  PS-CNTL-DATE-FILE-SW          PIC X     VALUE 'N'.       02630016
               88  PS-END-OF-CNTL-DTE-FILE             VALUE 'Y'.       02640016
W28582     05  PS-CNTL-JOB-FILE-SW           PIC X     VALUE 'N'.       02650016
W28582         88  PS-END-OF-CNTL-JOB-FILE             VALUE 'Y'.       02660016
NHOLD$     05  PS-HOLD-MATCH-SW              PIC X(01) VALUE 'N'.       02670016
NHOLD$         88  PS-HOLD-MATCH                       VALUE 'Y'.       02680016
NHOLD$         88  PS-NO-HOLD-MATCH                    VALUE 'N'.       02690016
NHOLD$     05  PS-PREV-DBV-RLTSNHP-CHK-SW    PIC X(01) VALUE SPACE.     02700016
NHOLD$         88  PS-PREV-FOUND-SKU                   VALUE '1'.       02710016
NHOLD$         88  PS-PREV-13-WK-PRRTN                 VALUE '2'.       02720016
NHOLD$         88  PS-PREV-EVEN-PRRTN                  VALUE '3'.       02730016
NHOLD$         88  PS-PREV-USED-UNKNOWN                VALUE '4'.       02740016
NHOLD$         88  PS-PREV-DEBIT-ALLOW                 VALUE '5'.       02750016
NHOLD$         88  PS-PREV-RTV-DOC                     VALUE '6'.       02760016
           05  PS-MORE-PURCH-RECORDS-SW      PIC X(01) VALUE 'Y'.       02770016
               88  PS-MORE-PURCH-RECORDS               VALUE 'Y'.       02780016
               88  PS-NO-MORE-PURCH-RECORDS            VALUE 'N'.       02790016
           05  PS-MORE-ORACLE-CC-SW          PIC X(01) VALUE 'Y'.       02800016
               88  PS-MORE-ORACLE-CC                   VALUE 'Y'.       02810016
               88  PS-NO-MORE-ORACLE-CC                VALUE 'N'.       02820016
           05  PS-MORE-SALE-RECORDS-SW       PIC X(01) VALUE 'Y'.       02830016
               88  PS-MORE-SALE-RECORDS                VALUE 'Y'.       02840016
               88  PS-NO-MORE-SALE-RECORDS             VALUE 'N'.       02850016
           05  PS-MORE-PCHG-RECORDS-SW       PIC X(01) VALUE 'Y'.       02860016
               88  PS-MORE-PCHG-RECORDS                VALUE 'Y'.       02870016
               88  PS-NO-MORE-PCHG-RECORDS             VALUE 'N'.       02880016
           05  PS-MORE-ADJ-RECORDS-SW        PIC X(01) VALUE 'Y'.       02890016
               88  PS-MORE-ADJ-RECORDS                 VALUE 'Y'.       02900016
               88  PS-NO-MORE-ADJ-RECORDS              VALUE 'N'.       02910016
           05  PS-MORE-BVP-RECORDS-SW        PIC X(01) VALUE 'Y'.       02920016
               88  PS-MORE-BVP-RECORDS                 VALUE 'Y'.       02930016
               88  PS-NO-MORE-BVP-RECORDS              VALUE 'N'.       02940016
           05  PS-MORE-RTV-RECORDS-SW        PIC X(01) VALUE 'Y'.       02950016
               88  PS-MORE-RTV-RECORDS                 VALUE 'Y'.       02960016
               88  PS-NO-MORE-RTV-RECORDS              VALUE 'N'.       02970016
W34517     05  PS-PURCH-SKU-SW               PIC X(01) VALUE 'N'.       02980016
W34517         88  PS-PURCH-SKU-YES                    VALUE 'Y'.       02990016
W34517         88  PS-PURCH-SKU-NO                     VALUE 'N'.       03000016
W34517     05  PS-PURCH-RTV-SW               PIC X(01) VALUE 'N'.       03010016
W34517         88  PS-PURCH-RTV-YES                    VALUE 'Y'.       03020016
W34517         88  PS-PURCH-RTV-NO                     VALUE 'N'.       03030016
W34517     05  PS-BOM-ATTR-SW                PIC X(01) VALUE 'N'.       03040016
W34517         88  PS-BOM-ATTR-EQUAL                   VALUE 'Y'.       03050016
W34517         88  PS-BOM-ATTR-NOT-EQUAL               VALUE 'N'.       03060016
W34517     05  PS-EXP-VND-END-OF-FILE-SW     PIC X(01) VALUE 'N'.       03070016
W34517         88  PS-EXP-VND-END                      VALUE 'Y'.       03080016
W34517         88  PS-EXP-VND-NOT-END                  VALUE 'N'.       03090016
W34517     05  PS-EXP-VND-FOUND-SW           PIC X(01) VALUE 'N'.       03100016
W34517         88  PS-EXP-VND-FOUND                    VALUE 'Y'.       03110016
W34517         88  PS-EXP-VND-NOT-FOUND                VALUE 'N'.       03120016
W37965     05  PS-ENT-TYPE-FILE-SW           PIC X     VALUE 'N'.       03130016
W37965         88  PS-END-OF-ENT-TYPE-FILE             VALUE 'Y'.       03140016
W37965         88  PS-NOT-END-OF-ENT-TYPE-FILE         VALUE 'N'.       03150016
           05  PS-RTV-DA-ALW-SW              PIC X(01) VALUE 'N'.       03160016
               88  PS-DA-ALW-OR-RTV                    VALUE 'Y'.       03170016
               88  PS-NOT-DA-ALW-OR-RTV                VALUE 'N'.       03180016
           05  PS-BRND-VNDR-PRRTN-SW         PIC X(02) VALUE SPACES.    03190016
               88  PS-PRRTN-FOR-PCHG                   VALUE 'PC'.      03200016
               88  PS-PRRTN-FOR-PURCH                  VALUE 'PU'.      03210016
               88  PS-PRRTN-FOR-SALE                   VALUE 'SA'.      03220016
           05  PS-PURCH-SYST-ORIG            PIC X(02) VALUE SPACES.    03230016
               88  PS-PURCH-RECEIPT-A                  VALUE '08'.      03240016
               88  PS-PURCH-RECEIPT-B                  VALUE '02'.      03250016
           05  PS-PURCH-TRANS-CDE            PIC X(02) VALUE SPACES.    03260016
               88  PS-PURCH-TRANSFER-FRM-STORE         VALUE '30'.      03270016
               88  PS-PURCH-TRANSFER-TO-STORE          VALUE '31'.      03280016
W34517     05  PS-ENT-ID-PRIVATE             PIC S9(9) VALUE ZEROES.    03290016
W34517         88  PS-ENT-ID-PRIVATE-BRAND             VALUES 103066    03300016
W34517                                                        103067.   03310016
           05  PS-13-WK-PRRTN-INFO-SW        PIC X(01) VALUE 'Y'.       03320016
               88  PS-13-WK-PRRTN-INFO-EXISTS          VALUE 'Y'.       03330016
               88  PS-NO-13-WK-PRRTN-INFO-EXISTS       VALUE 'N'.       03340016
           05  PS-AP-TRANS-CDE               PIC X(02) VALUE SPACES.    03350016
               88  PS-PURCH-AP-TRANS-RTV               VALUES '54' '55'.03360016
               88  PS-PURCH-AP-TRANS-DA                VALUE  '24' '2F'.03370016
               88  PS-PURCH-AP-TRANS-SKU               VALUES           03380016
                   '13' '15' '28' '29' '34' '35' '36' '37' '45'         03390016
W34517*            '46' '52' '53' '0B' '0E' '2A' '2B' '2C' '2E'.        03400016
W34517             '46' '52' '53' '0B' '0E' '2A' '2B' '2C' '2E'         03410016
B32898             '3H' '3I' 'Z1' 'Z2'.                                 03420016
W34517         88  PS-PURCH-AP-TRANS-SPCL              VALUES           03430016
W34517             '0K' '3W' '3X' '3F' '3G' '0N' '0P' '0Q' '0R'         03440016
W34517             '3N' '3R' '3P' '3S' '3Q' '3T' '3Y' '3Z' '1A'         03450016
W34517             '1B' '1C' '1D'.                                      03460016
W34517         88  PS-PURCH-AP-TRANS-SPCL-VND          VALUES           03470016
W34517             '0K' '3W' '3X' '3F' '3G'.                            03480016
W34517         88  PS-PURCH-AP-TRANS-SPCL-BRND         VALUES           03490016
W34517             '0N' '0P'.                                           03500016
W34517         88  PS-PURCH-AP-TRANS-SPCL-BRND2        VALUES           03510016
W34517             '0Q' '0R'.                                           03520016
W34517         88  PS-PURCH-AP-TRANS-SPCL-BV           VALUES           03530016
W34517             '3N' '3R' '3P' '3S' '3Q' '3T' '3Y' '3Z' '1A'         03540016
W34517             '1B' '1C' '1D'.                                      03550016
               88  PS-PURCH-AP-TRANS-VND               VALUES           03560016
W34517*            '03' '04' '05' '06' '07' '08' '09' '0A' '0D' '11'    03570016
W34517             '03' '04' '05' '06' '07' '08' '09' '0A' '11'         03580016
                   '14' '17' '18' '19' '20' '21' '22' '23' '25' '26'    03590016
                   '27' '30' '31' '32' '33' '38' '39' '40' '41' '42'    03600016
                   '43' '44' '50' '51' '56' '57' '58' '59' '5A' '0C'    03610016
W34517*            '2G' '2H' '2I'.                                      03620016
W34517             '2G' '2I'.                                           03630016
W32898         88  PS-PURCH-AP-TRANS-BV-REALIGN        VALUES           03640016
B32898             'Z3' 'Z4' 'Z5' 'Z6' 'Z7' 'Z8'.                       03650016
W34309         88  PS-PURCH-AP-TRANS-GIVEBACK          VALUES           03660016
W34309             '4G' '4H' '4J' '4K'                                  03670016
W34309             '6P' '6Q' '6R' '6S'.                                 03680016
W34517         88  PS-PURCH-AP-LICENSE-FEE             VALUES '0D' '0F'.03690016
               88  PS-PURCH-AP-OTHER                   VALUE SPACES.    03700016
               88  PS-PURCH-AP-STR-RTL                 VALUES '17' '18'.03710016
               88  PS-PURCH-AP-BYR-RTL                 VALUE  '26' '2G'.03720016
               88  PS-PURCH-AP-RCPT-GRS-CST            VALUES           03730016
W34517*            '03' '04' '05' '06' '08' '0B' '0C' '0D' '0E' '11'    03740016
W34517             '03' '04' '05' '06' '08' '0B' '0C' '0E' '11'         03750016
                   '13' '14' '15' '19' '23' '25' '27' '28' '29' '30'    03760016
                   '31' '32' '33' '34' '35' '36' '37' '38' '39' '40'    03770016
                   '41' '42' '43' '44' '45' '46' '50' '51' '52' '53'    03780016
B32898             'Z1' 'Z2'                                            03790016
PK9934             '3H' '3I'                                            03800016
W34517*            '56' '57' '58' '59' '5A' '2A' '2B' '2C' '2E'.        03810016
W34517             '56' '57' '58' '59' '5A' '2A' '2B' '2C' '2E' '0J'    03820016
W34517             '0L' '0M' '0K' '3W' '3X' '3F' '3G'.                  03830016
W34517         88  PS-PURCH-AP-IMP-GRS-CST             VALUES           03840016
W34517             '0G' '0H' '3A' '3B' '3C' '3D' '3E' '3L' '3M'.        03850016
               88  PS-PURCH-AP-RTV-COST                VALUES           03860016
                   '09' '0A' '20' '21' '22'.                            03870016
               88  PS-PURCH-AP-DA-COST                 VALUE  '07' '24' 03880016
W34517*                                                       '2F' '2H' 03890016
W34517*                                                       '2I'.     03900016
W34517                                                        '2F' '2I'.03910016
               88  PS-PCHG-AP-DA-MARKDOWN              VALUE  '24' '2F'.03920016
               88  PS-PCHG-AP-STR-RTL                  VALUES '17'.     03930016
W31475     05  PS-END-OF-BRND-PRRTN-CSR-SW   PIC X(01) VALUE 'N'.       03940016
W31475         88  PS-END-OF-BRND-PRRTN-CSR            VALUE 'Y'.       03950016
W31475         88  PS-NOT-END-OF-BRND-PRRTN-CSR        VALUE 'N'.       03960016
RONNAZ     05  PS-PURCH-RTV-TTL-MATCH-SW     PIC X(01) VALUE 'N'.       03970016
RONNAZ         88  PS-PURCH-RTV-TTL-MATCH-YES          VALUE 'Y'.       03980016
RONNAZ         88  PS-PURCH-RTV-TTL-MATCH-NO           VALUE 'N'.       03981016
RONNAW     05  PS-PURCH-RTV-DOC16-BOM-SW     PIC X(01) VALUE 'N'.       03981125
RONNAW         88  PS-PURCH-RTV-DOC16-BOM-YES          VALUE 'Y'.       03981225
RONNAW         88  PS-PURCH-RTV-DOC16-BOM-NO           VALUE 'N'.       03981325
                                                                        03982016
       01  ABEND-CODE-SQL              PIC S9(04)  VALUE ZERO COMP SYNC.03983016
       01  PC-PROGRAM-CONSTANTS.                                        03984016
           05 PC-PGM-NAME                   PIC X(8)  VALUE 'MLKUP364'. 03985016
W28582     05 PC-JOB-NAME                   PIC X(8)  VALUE SPACES.     03986016
           05 PC-MLKUP359                   PIC X(08) VALUE 'MLKUP359'. 03987016
           05 PC-MAX-RETRIES                PIC S9(03) VALUE 3 COMP-3.  03988016
           05 PC-MAX-LINES                  PIC 9(03) VALUE 60.         03989016
           05 PC-BVD                        PIC X(03) VALUE 'BVD'.      03990016
           05 PC-UNKNOWN-VENDOR             PIC S9(09) VALUE +5161 COMP.04000016
           05 PC-UNKNOWN-BRAND              PIC S9(04) VALUE +2230 COMP.04010016
W34517     05 PC-FREIGHT-TYPE               PIC X(01)  VALUE '1'.       04020016
W34517     05 PC-EXP-VND-MAX                PIC S9(05) VALUE +10000.    04030016
           05  PC-RUN-IN-PROGRESS-CODE      PIC X(01)  VALUE '9'.       04040016
           05  PC-RUN-COMPLETE-CODE         PIC X(01)  VALUE '0'.       04050016
W28582     05  PC-CKPT-INTERVAL             PIC S9(07) VALUE +100000    04060016
                                                        COMP-3.         04070016
W37965     05  PC-FRGT-SALV                 PIC X(05)  VALUE '01,02'.   04080016
W37965     05  PC-LICENSE-FEE               PIC X(03)  VALUE '03'.      04090016
W37965     05  PC-FRGT-SALV-LICENSE-FEE     PIC X(08)  VALUE '01,02,03'.04100016
W37965     05  PC-AUDIT-PRCH-ADJ            PIC X(02)  VALUE '15'.      04110016
                                                                        04120016
       01  PV-PROGRAM-VARIABLES.                                        04130016
           05 PV-DB2-FIELDS.                                            04140016
              10 PV-DB2-DEPT-NBR             PIC  S9(4)V VALUE ZEROES   04150016
                                                         COMP-3.        04160016
              10 PV-DB2-ENT-ID               PIC  S9(9)  COMP.          04170016
              10 PV-DB2-LBL-SEQ-NBR          PIC  S9(4)  COMP.          04180016
              10 PV-DB2-RTV-DOC-NBR          PIC  S9(12)V COMP-3.       04190016
              10 PV-DB2-DATE-EXISTS          PIC   X(1).                04200016
           05 PV-MISC.                                                  04210016
              10 PV-RETRY-COUNTER            PIC S9(04) COMP.           04220016
              10 PV-PAGE-COUNTER             PIC 9(7) VALUE 0.          04230016
              10 PV-LINE-COUNTER             PIC 9(7) VALUE 0.          04240016
              10 PV-PARAGRAPH-NAME           PIC X(30)  VALUE SPACES.   04250016
              10 PV-DB2-OPERATION-ATTEMPTED  PIC X(30)  VALUE SPACES.   04260016
           05 PV-CKPT-STAT-CODE              PIC X(01)  VALUE SPACES.   04270016
W28582     05 PV-RECS-PROC-FOR-CKPT          PIC S9(07) VALUE ZEROS     04280016
W28582                                                  COMP-3.         04290016
W28582     05 PV-CKPT-TAKEN-CNT              PIC S9(07) VALUE ZEROS     04300016
W28582                                                  COMP-3.         04310016
           05 PV-RTV-COUNT                   PIC S9(09) VALUE +0        04320016
                                                        COMP-3.         04330016
           05 PV-RESTART-COUNT               PIC 9(09) VALUE 0.         04340016
P49767     05 PV-TEMP-COUNT                  PIC 9(09) VALUE 0.         04350016
P49767     05 PV-TEMP-DOC-NBR                PIC X(16) JUST RIGHT.      04360016
P49767     05 PV-INSPT-STRING                PIC X(16) VALUE SPACES.    04370016
           05 PV-BRAND-COUNT                 PIC S9(09) VALUE +0        04380016
                                                        COMP-3.         04390016
           05 PV-MAX-BRAND                   PIC S9(4)  VALUE +0        04400016
                                                        COMP.           04410016
           05 PV-TOT-BRANDS                  PIC S9(09) VALUE +0        04420016
                                                        COMP-3.         04430016
           05 PV-PRORATION-PCT               PIC S9(3)V9(7) VALUE +0    04440016
                                                            COMP-3.     04450016
           05 PV-RTV-DOC-9                   PIC 9(16)  VALUE  0.       04460016
           05 PV-NULL                        PIC S9(04) VALUE +0 COMP.  04470016
RONNAZ     05 PV-NULL2                       PIC S9(04) VALUE +0 COMP.  04480016
           05 PV-SQLCODE                     PIC S9(04) VALUE ZERO.     04490016
           05 PV-SQLCODE-DISP                PIC S9(04) VALUE ZERO.     04500016
           05 PV-CURRENT-TMST                PIC X(26)  VALUE SPACES.   04510016
           05 PV-PROCESS-DATE                PIC X(10)  VALUE SPACES.   04520016
RONNAZ     05 PV-DFMEIT-ITEM-NBR-COUNT       PIC S9(09) COMP VALUE +0.  04530016
RONNAZ     05 PV-DFMEIT-ITEM-NBR-ZERO-COUNT  PIC S9(09) COMP VALUE +0.  04531023
RONNAZ     05 PV-SUM-RTL-COST-AMT            PIC S9(7)V9(2) VALUE +0    04540016
RONNAZ                                                      COMP-3.     04550016
RONNAZ     05 PV-SUM-UNIT-COST-AMT           PIC S9(7)V9(2) VALUE +0    04560016
RONNAZ                                                      COMP-3.     04570016
RONNAZ     05 PV-IN-PURCH-EXTD-GRO-COST-AMT  PIC S9(7)V9(2) VALUE +0    04580016
RONNAZ                                                      COMP-3.     04581016
RONNAZ     05 PV-IN-PURCH-FRGT-AMT           PIC S9(7)V9(2) VALUE +0    04582016
RONNAZ                                                      COMP-3.     04583016
RONNAZ     05 PV-IN-PURCH-DISC-AMT           PIC S9(7)V9(2) VALUE +0    04584016
RONNAZ                                                      COMP-3.     04585016
RONNAZ     05 PV-IN-PURCH-EXTD-NET-COST-AMT  PIC S9(7)V9(2) VALUE +0    04586016
RONNAZ                                                      COMP-3.     04587016
RONNAZ     05 PV-IN-PURCH-EXTD-RTL-AMT       PIC S9(7)V9(2) VALUE +0    04588016
RONNAZ                                                      COMP-3.     04589016
RONNAZ     05 PV-AC-PURCH-EXTD-GRO-COST-AMT  PIC S9(7)V9(2) VALUE +0    04590016
RONNAZ                                                      COMP-3.     04590116
RONNAZ     05 PV-AC-PURCH-FRGT-AMT           PIC S9(7)V9(2) VALUE +0    04590216
RONNAZ                                                      COMP-3.     04590316
RONNAZ     05 PV-AC-PURCH-DISC-AMT           PIC S9(7)V9(2) VALUE +0    04590416
RONNAZ                                                      COMP-3.     04590516
RONNAZ     05 PV-AC-PURCH-EXTD-NET-COST-AMT  PIC S9(7)V9(2) VALUE +0    04590616
RONNAZ                                                      COMP-3.     04590716
RONNAZ     05 PV-AC-PURCH-EXTD-RTL-AMT       PIC S9(7)V9(2) VALUE +0    04590816
RONNAZ                                                      COMP-3.     04590916
W34517     05 PV-13WK-1ST-WK-END-DTE         PIC X(10)  VALUE SPACES.   04591016
W34517     05 PV-13WK-13TH-WK-END-DTE        PIC X(10)  VALUE SPACES.   04592016
           05 PV-BV003-PV-RETURN-CDE         PIC 9(04)  VALUE ZEROS.    04593016
           05  PV-EDIT-ORA-SOURCE            PIC X(04)  VALUE SPACES.   04594016
               88  VALID-ORACLE-CONNECT-STRING                          04595016
                                            VALUES 'PRD ', 'TST ',      04596016
                                                   'LRN ', 'QA  ',      04597016
                                                   'PRDT'.              04598016
               88  VALID-DEVELOPMENT-REGION VALUES 'TST ',              04599016
                                                   'LRN ', 'QA  ',      04600016
                                                   'PRDT'.              04610016
               88  ORA-PROD-REGION          VALUE 'PRD '.               04620016
W32898                                                                  04630016
W32898     05  PV-DEPT-NBR-COMP-3           PIC S9(04)V COMP-3.         04640016
W32898     05  PV-ENT-ID-COMP               PIC S9(09) COMP.            04650016
W32898     05  PV-LBL-SEQ-NBR-COMP          PIC S9(04) COMP.            04660016
W32898     05  PV-DISP-LBL-SEQ-NBR          PIC  9(04).                 04670016
W32898     05  PV-DISP-PURCH-IN-CNT         PIC  9(08).                 04680016
W34517     05  PV-DISP-DEPT-NBR             PIC  9(03).                 04690016
W34517     05  PV-DISP-ENT-ID               PIC  9(09).                 04700016
W34517     05  PV-DISP-LO-MDSE-LVL-ID       PIC  9(09).                 04710016
W34517     05  PV-DISP-SKU-NBR              PIC  9(08).                 04720016
W34517     05  PV-SKU-NUM                   PIC  9(08) VALUE ZEROS.     04730016
W34517     05  PV-SKU-CHAR REDEFINES PV-SKU-NUM                         04740016
W34517                                      PIC  X(08).                 04750016
W34517     05  PV-BOM-ML-LO-MDSE-LVL-ID     PIC S9(09) VALUE ZEROS      04760016
W34517                                                 COMP.            04770016
W32898                                                                  04780016
W31475     05  PV-DR-ALW-NBR                PIC  X(16) VALUE SPACE.     04790016
W31475     05  PV-LBL-SEQ-NBR               PIC S9(09) COMP VALUE +0.   04800016
W31475     05  PV-PRRTN-PCT                 PIC S9(03)V99 COMP-3        04810016
W31475                                                    VALUE ZERO.   04820016
                                                                        04830016
           05 PV-BRAND-VENDOR-TOTALS.                                   04840016
              10  PV-REC-TYPE-IN            PIC  X(3) VALUE SPACES.     04850016
              10  PV-TOT-EDIT-ADJ-RECS-IN   PIC  S9(08) COMP-3          04860016
                                                        VALUE ZERO.     04870016
              10  PV-TOT-EDIT-PCHG-RECS-IN  PIC  S9(08) COMP-3          04880016
                                                        VALUE ZERO.     04890016
              10  PV-TOT-EDIT-PURCH-RECS-IN PIC  S9(08) COMP-3          04900016
                                                        VALUE ZERO.     04910016
              10  PV-TOT-EDIT-SALE-RECS-IN  PIC  S9(08) COMP-3          04920016
                                                        VALUE ZERO.     04930016
              10  PV-TOT-EDIT-ADJ-RECS-OUT  PIC  S9(08) COMP-3          04940016
                                                        VALUE ZERO.     04950016
              10  PV-TOT-EDIT-PCHG-RECS-OUT PIC  S9(08) COMP-3          04960016
                                                        VALUE ZERO.     04970016
              10  PV-TOT-EDIT-PURCH-RECS-OUT PIC S9(08) COMP-3          04980016
                                                        VALUE ZERO.     04990016
              10  PV-TOT-EDIT-SALE-RECS-OUT PIC  S9(08) COMP-3          05000016
                                                        VALUE ZERO.     05010016
W34517        10  PV-TOT-EDIT-BV-ORIG-OUT   PIC  S9(08) COMP-3          05020016
W34517                                                  VALUE ZERO.     05030016
W34517        10  PV-TOT-EDIT-BV-REVR-OUT   PIC  S9(08) COMP-3          05040016
W34517                                                  VALUE ZERO.     05050016
W34517        10  PV-TOT-EDIT-BV-REAS-OUT   PIC  S9(08) COMP-3          05060016
W34517                                                  VALUE ZERO.     05070016
W34517        10  PV-TOT-EDIT-BV-UNCH-OUT   PIC  S9(08) COMP-3          05080016
W34517                                                  VALUE ZERO.     05090016
W34517        10  PV-TOT-AUDIT-BV-RECS-OUT  PIC  S9(08) COMP-3          05100016
W34517                                                  VALUE ZERO.     05110016
W34517        10  PV-TOT-ENT-ZERO-BV-UNCH-OUT PIC  S9(08) COMP-3        05120016
W34517                                                  VALUE ZERO.     05130016
W34517        10  PV-TOT-BOM-INSERTED       PIC  S9(08) COMP-3          05140016
W34517                                                  VALUE ZERO.     05150016
W37965        10  PV-TOT-EXP-VDR-INSERTED   PIC  S9(08) COMP-3          05160016
W37965                                                  VALUE ZERO.     05170016
W37965        10  PV-TOT-PADJ-AUDIT-OUT     PIC  S9(08) COMP-3          05180016
W37965                                                  VALUE ZERO.     05190016
W37965        10  PV-TOT-PCHG-AUDIT-OUT     PIC  S9(08) COMP-3          05200016
W37965                                                  VALUE ZERO.     05210016
W37965        10  PV-TOT-SALE-AUDIT-OUT     PIC  S9(08) COMP-3          05220016
W37965                                                  VALUE ZERO.     05230016
W37965        10  PV-TOT-IADJ-AUDIT-OUT     PIC  S9(08) COMP-3          05240016
W37965                                                  VALUE ZERO.     05250016
W34517        10  PV-TOT-BOM-INSERT-DUPS    PIC  S9(08) COMP-3          05260016
W34517                                                  VALUE ZERO.     05270016
W34517        10  PV-TOT-UNCL-LIC-FEE-OUT   PIC  S9(08) COMP-3          05280016
W34517                                                  VALUE ZERO.     05290016
W34517        10  PV-TOT-DEF-EXP-VND-OUT    PIC  S9(08) COMP-3          05300016
W34517                                                  VALUE ZERO.     05310016
W34517        10  PV-TOT-SPEC-BRANDS-NOT-FOUND                          05320016
W34517                                      PIC S9(08) COMP-3           05330016
W34517                                                  VALUE ZERO.     05340016
W34517        10  PV-TOT-RTV-COUNT-ZERO     PIC S9(08) COMP-3           05350016
W34517                                                  VALUE ZERO.     05360016
W34517        10  PV-TOT-RTV-COUNT-NOT-ZERO PIC S9(08) COMP-3           05370016
W34517                                                  VALUE ZERO.     05380016
           05 PV-BRND-PRRTN-TOTS.                                       05390016
              10  PV-TOTAL-AT-RTL-AMT          PIC S9(11)V99 COMP-3     05400016
                                                             VALUE ZERO.05410016
              10  PV-TOTAL-AT-COST-AMT         PIC S9(11)V99 COMP-3     05420016
                                                             VALUE ZERO.05430016
              10  PV-TOTAL-DISC-AMT            PIC S9(07)V99 VALUE ZERO 05440016
                                                             COMP-3.    05450016
              10  PV-TOTAL-EXTD-GRO-COST-AMT   PIC S9(07)V99 VALUE ZERO 05460016
                                                             COMP-3.    05470016
              10  PV-TOTAL-EXTD-NET-COST-AMT   PIC S9(07)V99 VALUE ZERO 05480016
                                                             COMP-3.    05490016
              10  PV-TOTAL-EXTD-RTL-AMT        PIC S9(07)V99 VALUE ZERO 05500016
                                                             COMP-3.    05510016
              10  PV-TOTAL-FRGT-AMT            PIC S9(07)V99 VALUE ZERO 05520016
                                                             COMP-3.    05530016
              10  PV-TOTAL-NEW-PR-AMT          PIC S9(05)V99 COMP-3     05540016
                                                             VALUE ZERO.05550016
              10  PV-TOTAL-OLD-PR-AMT          PIC S9(05)V99 COMP-3     05560016
                                                             VALUE ZERO.05570016
              10  PV-TOT-PADJ-RTV-COST-AMT     PIC S9(07)V99 COMP-3     05580016
                                                             VALUE ZERO.05590016
              10  PV-TOTAL-SALE-EXTD-RTL-AMT   PIC S9(09)V99 COMP-3     05600016
                                                             VALUE ZERO.05610016
              10  PV-TOTAL-PER-UNT-RTL-AMT     PIC S9(05)V99 COMP-3     05620016
                                                             VALUE ZERO.05630016
                                                                        05640016
           05 PV-PRRTN-WORK-FIELDS.                                     05650016
              10  PV-WORK-AT-RTL-AMT        PIC S9(11)V9999  COMP-3     05660016
                                                             VALUE ZERO.05670016
              10  PV-WORK-AT-COST-AMT       PIC S9(11)V9999  COMP-3     05680016
                                                             VALUE ZERO.05690016
              10  PV-WORK-DISC-AMT          PIC S9(07)V9999 VALUE ZERO  05700016
                                                            COMP-3.     05710016
              10  PV-WORK-EXTD-GRO-COST-AMT PIC S9(07)V9999 VALUE ZERO  05720016
                                                            COMP-3.     05730016
              10  PV-WORK-EXTD-NET-COST-AMT PIC S9(07)V9999 VALUE ZERO  05740016
                                                            COMP-3.     05750016
              10  PV-WORK-EXTD-RTL-AMT      PIC S9(07)V9999 VALUE ZERO  05760016
                                                            COMP-3.     05770016
              10  PV-WORK-FRGT-AMT          PIC S9(07)V9999 VALUE ZERO  05780016
                                                            COMP-3.     05790016
              10  PV-WORK-NEW-PR-AMT        PIC S9(05)V9999  COMP-3     05800016
                                                             VALUE ZERO.05810016
              10  PV-WORK-OLD-PR-AMT        PIC S9(05)V9999  COMP-3     05820016
                                                             VALUE ZERO.05830016
              10  PV-WORK-PADJ-RTV-COST-AMT  PIC S9(7)V9999 COMP-3      05840016
                                                            VALUE ZERO. 05850016
              10  PV-WORK-PER-UNT-RTL-AMT    PIC S9(5)V9999 COMP-3      05860016
                                                            VALUE ZERO. 05870016
W34517     05 PV-VENDOR-REC.                                            05880016
W34517        10  PV-VENDOR-ID               PIC 9(09) VALUE ZEROES.    05890016
W34517        10  PV-VENDOR-TYPE             PIC X(01) VALUE SPACES.    05900016
W34517        10  FILLER                     PIC X(70) VALUE SPACES.    05910016
W34517                                                                  05920016
NHOLD$     05 PV-HOLD-FIELDS.                                           05930016
NHOLD$        10  PV-HOLD-FILE-BEING-READ    PIC X(02) VALUE SPACES.    05940016
NHOLD$            88 PV-HOLD-FILE-PADJ       VALUE 'PA'.                05950016
NHOLD$            88 PV-HOLD-FILE-PCHG       VALUE 'PC'.                05960016
NHOLD$            88 PV-HOLD-FILE-PURCH      VALUE 'PU'.                05970016
NHOLD$            88 PV-HOLD-FILE-SALE       VALUE 'SA'.                05980016
NHOLD$        10  PV-HOLD-SYS-ORIG           PIC X(02) VALUE SPACES.    05990016
NHOLD$        10  PV-HOLD-TRANS-CDE          PIC X(02) VALUE SPACES.    06000016
NHOLD$        10  PV-HOLD-AP-TRANS-CDE       PIC X(02) VALUE SPACES.    06010016
NHOLD$        10  PV-HOLD-SKU                PIC X(08) VALUE SPACES.    06020016
NHOLD$        10  PV-HOLD-ENT-ID             PIC 9(09) VALUE ZERO.      06030016
J28582        10  PV-HOLD-DEPT-NBR           PIC 9(03) VALUE ZERO.      06040016
NHOLD$        10  PV-HOLD-ML-LWST-ID         PIC S9(9) COMP VALUE ZERO. 06050016
                                                                        06060016
W37965     05  PV-LOC-NBR                    PIC S9(5).                 06070016
W37965     05  PV-CLASS-NBR                  PIC S9(2).                 06080016
W37965                                                                  06090016
W34517     05 PT-EXP-VND-TABLE.                                         06100016
W34517        10  PT-EXP-VND OCCURS 10000 TIMES INDEXED BY              06110016
W34517                                               PT-EXP-VND-IDX     06120016
W34517                                               PT-EXP-VND-IDX-MAX 06130016
W37965                                               PT-EXP-VND-SAV-IDX.06140016
W34517            15  PT-EXP-VND-ID          PIC 9(09) VALUE ZEROES.    06150016
W34517                                                                  06160016
W37965     05  PV-EXP-TYPE1                PIC S9(4) COMP VALUE ZEROS.  06170016
W37965     05  PV-EXP-TYPE2                PIC S9(4) COMP VALUE ZEROS.  06180016
W37965     05  PV-EXP-TYPE3                PIC S9(4) COMP VALUE ZEROS.  06190016
W37965     05  PV-EXP-TYPE4                PIC S9(4) COMP VALUE ZEROS.  06200016
W37965     05  PV-EXP-TYPE5                PIC S9(4) COMP VALUE ZEROS.  06210016
W37965     05  PV-EXP-TYPE6                PIC S9(4) COMP VALUE ZEROS.  06220016
W37965     05  PV-EXP-TYPE7                PIC S9(4) COMP VALUE ZEROS.  06230016
W37965     05  PV-EXP-TYPE8                PIC S9(4) COMP VALUE ZEROS.  06240016
W37965     05  PV-EXP-TYPE9                PIC S9(4) COMP VALUE ZEROS.  06250016
W37965     05  PV-EXP-TYPE10               PIC S9(4) COMP VALUE ZEROS.  06260016
026900***************************************************************** 06270016
027000*  CODE FROM PGM=MLKUP021 FOR CONTROL CARD DATE PROCESSING.       06280016
027100***************************************************************** 06290016
027200 01  CC-CONTROL-CARD.                                             06300016
027300     05  CC-CALENDAR-TYPE                PIC X(02).               06310016
027400     05  FILLER                          PIC X.                   06320016
027500     05  CC-PROC-DATE-ISO                PIC X(10).               06330016
027600     05  CC-PROC-DATE-RDF  REDEFINES                              06340016
027700         CC-PROC-DATE-ISO.                                        06350016
027800         10  CC-PROC-CC                  PIC X(02).               06360016
027900         10  CC-PROC-YY                  PIC X(02).               06370016
028000         10  FILLER                      PIC X(01).               06380016
028100         10  CC-PROC-MM                  PIC X(02).               06390016
028200         10  FILLER                      PIC X(01).               06400016
028300         10  CC-PROC-DD                  PIC X(02).               06410016
028400     05  FILLER                          PIC X.                   06420016
028500     05  CC-PROCESSING-MODE              PIC X(04).               06430016
028600         88  CC-PROCESSING-MODE-VALID    VALUE 'ML'  'INV' 'BOTH'.06440016
028700         88  CC-PROCESSING-MODE-ML       VALUE 'ML'  'BOTH'.      06450016
028800         88  CC-PROCESSING-MODE-ML-ONLY  VALUE 'ML'.              06460016
028900         88  CC-PROCESSING-MODE-INV      VALUE 'INV' 'BOTH'.      06470016
029000         88  CC-PROCESSING-MODE-INV-ONLY VALUE 'INV'.             06480016
029100     05  FILLER                          PIC X.                   06490016
029200     05  CC-CHECK-INV-DATES-SW           PIC X.                   06500016
029300         88  CC-CHECK-INV-DATES-SW-VALID VALUE 'Y' 'N'.           06510016
029400         88  CC-CHECK-INV-DATES          VALUE 'Y'.               06520016
029500         88  CC-DONT-CHECK-INV-DATES     VALUE 'N'.               06530016
029600     05  FILLER                          PIC X(60).               06540016
                                                                        06550016
026900***************************************************************** 06560016
027000*  CODE FOR CONTROL JOB                                           06570016
027100***************************************************************** 06580016
W28582 01  CC-CONTROL-JOB.                                              06590016
W28582     05  CC-JOB-NAME                     PIC X(08).               06600016
W28582     05  FILLER                          PIC X(72).               06610016
W37965***************************************************************** 06620016
W37965*    USER DEFINED ENT TYP NBR FOR EXPENSE VENDOR CURSOR           06630016
W37965***************************************************************** 06640016
W37965 01  CC-ENT-TYP-CONTROL-CARD.                                     06650016
W37965     05  CC-ENT-TYP                PIC  X(29).                    06660016
W37965     05  FILLER                    PIC  X(51).                    06670016
W28582******************************************************************06680016
W28582*    HEADING LINES FOR THE PURCH FILE AUDIT REPORT               *06690016
W28582******************************************************************06700016
W28582 01  HL1-HEADING-LINE-1.                                          06710016
W28582     05  FILLER                      PIC X(62)      VALUE SPACES. 06720016
W28582     05  FILLER                      PIC X(26)      VALUE         06730016
W28582         'MLKUP364 PURCH FILE REPORT'.                            06740016
W28582     05  FILLER                      PIC X(62)      VALUE SPACES. 06750016
W28582                                                                  06760016
W28582 01  HL1-HEADING-LINE-2.                                          06770016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 06780016
W28582     05  FILLER                      PIC X(17)      VALUE         06790016
W28582         'SYST  PURCH    AP'.                                     06800016
W28582     05  FILLER                      PIC X(28)      VALUE SPACES. 06810016
W28582     05  FILLER                      PIC X(05)      VALUE         06820016
W28582         'GROSS'.                                                 06830016
W28582     05  FILLER                      PIC X(36)      VALUE SPACES. 06840016
W28582     05  FILLER                      PIC X(03)      VALUE         06850016
W28582         'NET'.                                                   06860016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 06870016
W28582     05  FILLER                      PIC X(04)      VALUE         06880016
W28582         'EXTD'.                                                  06890016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 06900016
W28582     05  FILLER                      PIC X(03)      VALUE         06910016
W28582         'UNT'.                                                   06920016
W28582     05  FILLER                      PIC X(20)      VALUE SPACES. 06930016
W28582     05  FILLER                      PIC X(03)      VALUE         06940016
W28582         'LBL'.                                                   06950016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 06960016
W28582     05  FILLER                      PIC X(02)      VALUE         06970016
W28582         'ML'.                                                    06980016
W28582                                                                  06990016
W28582 01  HL1-HEADING-LINE-3.                                          07000016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 07010016
W28582     05  FILLER                      PIC X(18)      VALUE         07020016
W28582         'ORIG  TRANS  TRANS'.                                    07030016
W28582     05  FILLER                      PIC X(28)      VALUE SPACES. 07040016
W28582     05  FILLER                      PIC X(04)      VALUE         07050016
W28582         'COST'.                                                  07060016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 07070016
W28582     05  FILLER                      PIC X(04)      VALUE         07080016
W28582         'FRGT'.                                                  07090016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 07100016
W28582     05  FILLER                      PIC X(04)      VALUE         07110016
W28582         'DISC'.                                                  07120016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 07130016
W28582     05  FILLER                      PIC X(04)      VALUE         07140016
W28582         'COST'.                                                  07150016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 07160016
W28582     05  FILLER                      PIC X(03)      VALUE         07170016
W28582         'RTL'.                                                   07180016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 07190016
W28582     05  FILLER                      PIC X(03)      VALUE         07200016
W28582         'RTL'.                                                   07210016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 07220016
W28582     05  FILLER                      PIC X(03)      VALUE         07230016
W28582         'ENT'.                                                   07240016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 07250016
W28582     05  FILLER                      PIC X(03)      VALUE         07260016
W28582         'SEQ'.                                                   07270016
W28582     05  FILLER                      PIC X(07)      VALUE SPACES. 07280016
W28582     05  FILLER                      PIC X(04)      VALUE         07290016
W28582         'LWST'.                                                  07300016
W28582                                                                  07310016
W28582 01  HL1-HEADING-LINE-4.                                          07320016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 07330016
W28582     05  FILLER                      PIC X(47)      VALUE         07340016
W28582         'CDE   CDE     CDE SKU       LOC   DEPT         '.       07350016
W28582     05  FILLER                      PIC X(51)      VALUE         07360016
W28582         'AMT          AMT          AMT          AMT         '.   07370016
W28582     05  FILLER                      PIC X(51)      VALUE         07380016
W28582         ' AMT          AMT          ID        NBR         ID'.   07390016
W28582                                                                  07400016
W28582******************************************************************07410016
W28582*    HEADING LINES FOR THE SALES FILE AUDIT REPORT               *07420016
W28582******************************************************************07430016
W28582 01  HL2-HEADING-LINE-1.                                          07440016
W28582     05  FILLER                      PIC X(53)      VALUE SPACES. 07450016
W28582     05  FILLER                      PIC X(26)      VALUE         07460016
W28582         'MLKUP364 SALES FILE REPORT'.                            07470016
W28582     05  FILLER                      PIC X(24)      VALUE SPACES. 07480016
W28582                                                                  07490016
W28582 01  HL2-HEADING-LINE-2.                                          07500016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 07510016
W28582     05  FILLER                      PIC X(42)      VALUE         07520016
W28582         'SKU       LOC   DEPT     EXTD RTL         '.            07530016
W28582     05  FILLER                      PIC X(28)      VALUE         07540016
W28582         ' ENT     LBL SEQ     ML LWST'.                          07550016
W28582     05  FILLER                      PIC X(04)      VALUE SPACES. 07560016
W28582                                                                  07570016
W28582 01  HL2-HEADING-LINE-3.                                          07580016
W28582     05  FILLER                      PIC X(58)      VALUE SPACES. 07590016
W28582     05  FILLER                      PIC X(41)      VALUE         07600016
W28582         ' AMT           ID         NBR          ID'.             07610016
W28582     05  FILLER                      PIC X(04)      VALUE SPACES. 07620016
W28582                                                                  07630016
W28582******************************************************************07640016
W28582*    HEADING LINES FOR THE PR CHG FILE AUDIT REPORT              *07650016
W28582******************************************************************07660016
W28582 01  HL3-HEADING-LINE-1.                                          07670016
W28582     05  FILLER                      PIC X(48)      VALUE SPACES. 07680016
W28582     05  FILLER                      PIC X(27)      VALUE         07690016
W28582         'MLKUP364 PR CHG FILE REPORT'.                           07700016
W28582     05  FILLER                      PIC X(57)      VALUE SPACES. 07710016
W28582                                                                  07720016
W28582 01  HL3-HEADING-LINE-2.                                          07730016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 07740016
W28582     05  FILLER                      PIC X(17)      VALUE         07750016
W28582         'SYST   PC      AP'.                                     07760016
W28582     05  FILLER                      PIC X(32)      VALUE SPACES. 07770016
W28582     05  FILLER                      PIC X(04)      VALUE         07780016
W28582         'EXTD'.                                                  07790016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 07800016
W28582     05  FILLER                      PIC X(03)      VALUE         07810016
W28582         'OLD'.                                                   07820016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 07830016
W28582     05  FILLER                      PIC X(03)      VALUE         07840016
W28582         'NEW'.                                                   07850016
W28582     05  FILLER                      PIC X(20)      VALUE SPACES. 07860016
W28582     05  FILLER                      PIC X(03)      VALUE         07870016
W28582         'LBL'.                                                   07880016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 07890016
W28582     05  FILLER                      PIC X(02)      VALUE         07900016
W28582         'ML'.                                                    07910016
W28582     05  FILLER                      PIC X(19)      VALUE SPACES. 07920016
W28582                                                                  07930016
W28582 01  HL3-HEADING-LINE-3.                                          07940016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 07950016
W28582     05  FILLER                      PIC X(18)      VALUE         07960016
W28582         'ORIG  TRANS  TRANS'.                                    07970016
W28582     05  FILLER                      PIC X(32)      VALUE SPACES. 07980016
W28582     05  FILLER                      PIC X(03)      VALUE         07990016
W28582         'RTL'.                                                   08000016
W28582     05  FILLER                      PIC X(12)      VALUE SPACES. 08010016
W28582     05  FILLER                      PIC X(02)      VALUE         08020016
W28582         'PR'.                                                    08030016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 08040016
W28582     05  FILLER                      PIC X(02)      VALUE         08050016
W28582         'PR'.                                                    08060016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 08070016
W28582     05  FILLER                      PIC X(03)      VALUE         08080016
W28582         'ENT'.                                                   08090016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 08100016
W28582     05  FILLER                      PIC X(03)      VALUE         08110016
W28582         'SEQ'.                                                   08120016
W28582     05  FILLER                      PIC X(07)      VALUE SPACES. 08130016
W28582     05  FILLER                      PIC X(04)      VALUE         08140016
W28582         'LWST'.                                                  08150016
W28582     05  FILLER                      PIC X(19)      VALUE SPACES. 08160016
W28582                                                                  08170016
W28582 01  HL3-HEADING-LINE-4.                                          08180016
W28582     05  FILLER                      PIC X(01)      VALUE SPACES. 08190016
W28582     05  FILLER                      PIC X(50)      VALUE         08200016
W28582         'CDE   CDE     CDE   SKU       LOC   DEPT          '.    08210016
W28582     05  FILLER                      PIC X(50)      VALUE         08220016
W28582         'AMT           AMT          AMT          ID        '.    08230016
W28582     05  FILLER                      PIC X(31)      VALUE         08240016
W28582         'NBR         ID                 '.                       08250016
W28582******************************************************************08260016
W28582*    HEADING LINES FOR THE ADJ FILE AUDIT REPORT                  08270016
W28582******************************************************************08280016
W28582 01  HL4-HEADING-LINE-1.                                          08290016
W28582     05  FILLER                      PIC X(53)      VALUE SPACES. 08300016
W28582     05  FILLER                      PIC X(24)      VALUE         08310016
W28582         'MLKUP364 ADJ FILE REPORT'.                              08320016
W28582     05  FILLER                      PIC X(26)      VALUE SPACES. 08330016
W28582                                                                  08340016
W28582 01  HL4-HEADING-LINE-2.                                          08350016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 08360016
W28582     05  FILLER                      PIC X(04)      VALUE         08370016
W28582         'SYST'.                                                  08380016
W28582     05  FILLER                      PIC X(44)      VALUE SPACES. 08390016
W28582     05  FILLER                      PIC X(04)      VALUE         08400016
W28582         'LBL'.                                                   08410016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 08420016
W28582     05  FILLER                      PIC X(02)      VALUE         08430016
W28582         'ML'.                                                    08440016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 08450016
W28582 01  HL4-HEADING-LINE-3.                                          08460016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 08470016
W28582     05  FILLER                      PIC X(04)      VALUE         08480016
W28582         'ORIG'.                                                  08490016
W28582     05  FILLER                      PIC X(33)      VALUE SPACES. 08500016
W28582     05  FILLER                      PIC X(03)      VALUE         08510016
W28582         'ENT'.                                                   08520016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 08530016
W28582     05  FILLER                      PIC X(03)      VALUE         08540016
W28582         'SEQ'.                                                   08550016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 08560016
W28582     05  FILLER                      PIC X(04)      VALUE         08570016
W28582         'LWST'.                                                  08580016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 08590016
W28582 01  HL4-HEADING-LINE-4.                                          08600016
W28582     05  FILLER                      PIC X(29)      VALUE SPACES. 08610016
W28582     05  FILLER                      PIC X(03)      VALUE         08620016
W28582         'CDE'.                                                   08630016
W28582     05  FILLER                      PIC X(03)      VALUE SPACES. 08640016
W28582     05  FILLER                      PIC X(03)      VALUE         08650016
W28582         'SKU'.                                                   08660016
W28582     05  FILLER                      PIC X(08)      VALUE SPACES. 08670016
W28582     05  FILLER                      PIC X(03)      VALUE         08680016
W28582         'LOC'.                                                   08690016
W28582     05  FILLER                      PIC X(04)      VALUE SPACES. 08700016
W28582     05  FILLER                      PIC X(04)      VALUE         08710016
W28582         'DEPT'.                                                  08720016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 08730016
W28582     05  FILLER                      PIC X(02)      VALUE         08740016
W28582         'ID'.                                                    08750016
W28582     05  FILLER                      PIC X(09)      VALUE SPACES. 08760016
W28582     05  FILLER                      PIC X(03)      VALUE         08770016
W28582         'NBR'.                                                   08780016
W28582     05  FILLER                      PIC X(10)      VALUE SPACES. 08790016
W28582     05  FILLER                      PIC X(02)      VALUE         08800016
W28582         'ID'.                                                    08810016
W28582     05  FILLER                      PIC X(11)      VALUE SPACES. 08820016
W28582                                                                  08830016
W28582 01  DT1-PURCH-DETAIL.                                            08840016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     08850016
W28582     05  DT1-SYST-ORIG-CDE           PIC X(02).                   08860016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     08870016
W28582     05  DT1-PURCH-TRANS-CDE         PIC X(02).                   08880016
W28582     05  FILLER                      PIC X(06)  VALUE SPACES.     08890016
W28582     05  DT1-AP-TRANS-CDE            PIC X(02).                   08900016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     08910016
W28582     05  DT1-SKU                     PIC X(08).                   08920016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     08930016
W28582     05  DT1-LOC                     PIC X(04).                   08940016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     08950016
W28582     05  DT1-DEPT                    PIC X(04).                   08960016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     08970016
W28582     05  DT1-GROSS-COST-AMT          PIC ZZZZZZ9.99-.             08980016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     08990016
W28582     05  DT1-FRGT-AMT                PIC ZZZZZZ9.99-.             09000016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09010016
W28582     05  DT1-DISC-AMT                PIC ZZZZZZ9.99-.             09020016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09030016
W28582     05  DT1-NET-COST-AMT            PIC ZZZZZZ9.99-.             09040016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09050016
W28582     05  DT1-EXTD-RTL-AMT            PIC ZZZZZZ9.99-.             09060016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09070016
W28582     05  DT1-UNT-RTL-AMT             PIC ZZZZZZ9.99-.             09080016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09090016
W28582     05  DT1-ENT-ID                  PIC X(09).                   09100016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09110016
W28582     05  DT1-LBL-SEQ-NBR             PIC X(09).                   09120016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09130016
W28582     05  DT1-ML-LWST-ID              PIC X(09).                   09140016
W28582 01  DT1-PURCH-ERROR-LINE.                                        09150016
W28582     05  FILLER                      PIC X(43)  VALUE SPACES.     09160016
W28582     05  FILLER                      PIC X(22)  VALUE             09170016
W28582         '*** SEE ERROR FILE ***'.                                09180016
W28582 01  DT2-SALES-DETAIL.                                            09190016
W28582     05  FILLER                      PIC X(29)  VALUE SPACES.     09200016
W28582     05  DT2-SKU                     PIC X(08).                   09210016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09220016
W28582     05  DT2-LOC                     PIC X(04).                   09230016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09240016
W28582     05  DT2-DEPT                    PIC X(04).                   09250016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09260016
W28582     05  DT2-EXTD-RTL-AMT            PIC ZZZZZZ9.99-.             09270016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09280016
W28582     05  DT2-ENT-ID                  PIC X(09).                   09290016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09300016
W28582     05  DT2-LBL-SEQ-NBR             PIC X(09).                   09310016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09320016
W28582     05  DT2-ML-LWST-ID              PIC X(09).                   09330016
W28582 01  DT2-SALES-ERROR-LINE.                                        09340016
W28582     05  FILLER                      PIC X(49)  VALUE SPACES.     09350016
W28582     05  FILLER                      PIC X(22)  VALUE             09360016
W28582         '*** SEE ERROR FILE ***'.                                09370016
W28582 01  DT3-PCHG-DETAIL.                                             09380016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09390016
W28582     05  DT3-SYST-ORIG-CDE           PIC X(02).                   09400016
W28582     05  FILLER                      PIC X(04)  VALUE SPACES.     09410016
W28582     05  DT3-PC-TRANS-CDE            PIC X(02).                   09420016
W28582     05  FILLER                      PIC X(06)  VALUE SPACES.     09430016
W28582     05  DT3-AP-TRANS-CDE            PIC X(02).                   09440016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09450016
W28582     05  DT3-SKU                     PIC X(08).                   09460016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09470016
W28582     05  DT3-LOC                     PIC X(04).                   09480016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09490016
W28582     05  DT3-DEPT                    PIC X(04).                   09500016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09510016
W28582     05  DT3-EXTD-RTL-AMT            PIC ZZZZZZ9.99-.             09520016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09530016
W28582     05  DT3-OLD-PR-AMT              PIC ZZZZZZ9.99-.             09540016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09550016
W28582     05  DT3-NEW-PR-AMT              PIC ZZZZZZ9.99-.             09560016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09570016
W28582     05  DT3-ENT-ID                  PIC X(09).                   09580016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09590016
W28582     05  DT3-LBL-SEQ-NBR             PIC X(09).                   09600016
W28582     05  FILLER                      PIC X(02)  VALUE SPACES.     09610016
W28582     05  DT3-ML-LWST-ID              PIC X(09).                   09620016
W28582 01  DT3-PCHG-ERROR-LINE.                                         09630016
W28582     05  FILLER                      PIC X(43)  VALUE SPACES.     09640016
W28582     05  FILLER                      PIC X(22)  VALUE             09650016
W28582         '*** SEE ERROR FILE ***'.                                09660016
W28582 01  DT4-ADJ-DETAIL.                                              09670016
W28582     05  FILLER                      PIC X(30)  VALUE SPACES.     09680016
W28582     05  DT4-SYST-ORIG-CDE           PIC X(02).                   09690016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09700016
W28582     05  DT4-SKU                     PIC X(08).                   09710016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09720016
W28582     05  DT4-LOC                     PIC X(04).                   09730016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09740016
W28582     05  DT4-DEPT                    PIC X(04).                   09750016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09760016
W28582     05  DT4-ENT-ID                  PIC X(09).                   09770016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09780016
W28582     05  DT4-LBL-SEQ-NBR             PIC X(09).                   09790016
W28582     05  FILLER                      PIC X(03)  VALUE SPACES.     09800016
W28582     05  DT4-ML-LWST-ID              PIC X(09).                   09810016
W28582 01  DT4-ADJ-ERROR-LINE.                                          09820016
W28582     05  FILLER                      PIC X(59)  VALUE SPACES.     09830016
W28582     05  FILLER                      PIC X(22)  VALUE             09840016
W28582         '*** SEE ERROR FILE ***'.                                09850016
W28582 01  CKPT-RESTART-INFO.                                           09860016
W28582     05 CKPT-REC-TYPE               PIC X(03)  VALUE SPACES.      09870016
W28582     05 CKPT-EDIT-ADJ-RECS-IN       PIC S9(08) VALUE +0 COMP-3.   09880016
W28582     05 CKPT-EDIT-PCHG-RECS-IN      PIC S9(08) VALUE +0 COMP-3.   09890016
W28582     05 CKPT-EDIT-PURCH-RECS-IN     PIC S9(08) VALUE +0 COMP-3.   09900016
W28582     05 CKPT-EDIT-SALE-RECS-IN      PIC S9(08) VALUE +0 COMP-3.   09910016
W28582     05 CKPT-EDIT-ADJ-RECS-OUT      PIC S9(08) VALUE +0 COMP-3.   09920016
W28582     05 CKPT-EDIT-PCHG-RECS-OUT     PIC S9(08) VALUE +0 COMP-3.   09930016
W28582     05 CKPT-EDIT-PURCH-RECS-OUT    PIC S9(08) VALUE +0 COMP-3.   09940016
W28582     05 CKPT-EDIT-SALE-RECS-OUT     PIC S9(08) VALUE +0 COMP-3.   09950016
W34517     05 CKPT-EDIT-BV-ORIG-OUT       PIC S9(08) VALUE +0 COMP-3.   09960016
W34517     05 CKPT-EDIT-BV-REVR-OUT       PIC S9(08) VALUE +0 COMP-3.   09970016
W34517     05 CKPT-EDIT-BV-REAS-OUT       PIC S9(08) VALUE +0 COMP-3.   09980016
W34517     05 CKPT-EDIT-BV-UNCH-OUT       PIC S9(08) VALUE +0 COMP-3.   09990016
W34517     05 CKPT-AUDIT-BV-RECS-OUT      PIC S9(08) VALUE +0 COMP-3.   10000016
W34517     05 CKPT-ENT-ZERO-BV-UNCH-OUT   PIC S9(08) VALUE +0 COMP-3.   10010016
W34517     05 CKPT-BOM-INSERTED           PIC S9(08) VALUE +0 COMP-3.   10020016
W34517     05 CKPT-BOM-INSERT-DUPS        PIC S9(08) VALUE +0 COMP-3.   10030016
W34517     05 CKPT-UNCL-LIC-FEE-OUT       PIC S9(08) VALUE +0 COMP-3.   10040016
W34517     05 CKPT-DEF-EXP-VND-OUT        PIC S9(08) VALUE +0 COMP-3.   10050016
W34517     05 CKPT-SPEC-BRANDS-NOT-FOUND  PIC S9(08) VALUE +0 COMP-3.   10060016
W28582******************************************************************10070016
W28582*    WORK AREA FOR REPORTS                                        10080016
W28582******************************************************************10090016
W28582     COPY DPWS150.                                                10100016
W28582     COPY DPWS132.                                                10110016
W28582                                                                  10120016
      ******************************************************************10130016
      *    WORK AREA PASSED IN CALL TO MLKUP359                        *10140016
      ******************************************************************10150016
           COPY MLWS006.                                                10160016
                                                                        10170016
       01  DP402-COMMAREA             PIC X(1).                         10180016
      ******************************************************************10190016
      *  DB2 SQL ERROR MESSAGE FORMAT AREA                              10200016
      ******************************************************************10210016
           COPY DPWS004.                                                10220016
      ******************************************************************10230016
      * BRAND PRORATION PERCENT TABLE                                   10240016
      ******************************************************************10250016
           EXEC SQL                                                     10260016
             INCLUDE BVT00003                                           10270016
           END-EXEC.                                                    10280016
      ******************************************************************10290016
      * RTV DETAIL TABLE                                                10300016
      ******************************************************************10310016
           EXEC SQL                                                     10320016
             INCLUDE TDFMEIT                                            10330016
           END-EXEC.                                                    10340016
      ******************************************************************10350016
      * DATE TABLE                                                      10360016
      ******************************************************************10370016
W34517* DECLARED IN BVWS101                                             10380016
W34517*    EXEC SQL                                                     10390016
W34517*      INCLUDE TDTATTR                                            10400016
W34517*    END-EXEC.                                                    10410016
W34517******************************************************************10420016
W34517* ML WEEKLY DETAIL LEDGER TABLE (MLT_WKLY_SUM)                    10430016
W34517******************************************************************10440016
W34517     EXEC SQL                                                     10450016
W34517       INCLUDE MLT00005                                           10460016
W34517     END-EXEC.                                                    10470016
W34517******************************************************************10480016
W34517* ML PARTION CONTROL TABLE (MLT_PARTN_CNTL)                       10490016
W34517******************************************************************10500016
W34517     EXEC SQL                                                     10510016
W34517       INCLUDE MLT00003                                           10520016
W34517     END-EXEC.                                                    10530016
W34517******************************************************************10540016
W34517* TENTNME TABLE                                                   10550016
W34517******************************************************************10560016
W34517     EXEC SQL                                                     10570016
W34517       INCLUDE TENTNME                                            10580016
W34517     END-EXEC.                                                    10590016
W31475******************************************************************10600016
W31475* MLTW_DR_ALW_BRND_PRRTN TABLE                                    10610016
W31475******************************************************************10620016
W31475     EXEC SQL                                                     10630016
W31475       INCLUDE MLT00019                                           10640016
W31475     END-EXEC.                                                    10650016
P02048******************************************************************10660016
P02048* MLT_VND_ALLOC TABLE                                             10670016
P02048******************************************************************10680016
W37965     EXEC SQL                                                     10690016
W37965       INCLUDE MLT00025                                           10700016
W37965     END-EXEC.                                                    10710016
      ******************************************************************10720016
      *  SYSTEM DUMMY TABLE                                             10730016
      ******************************************************************10740016
           EXEC SQL                                                     10750016
               INCLUDE SYSDUMMY                                         10760016
           END-EXEC.                                                    10770016
      ******************************************************************10780016
      *  DB2 TABLE DECLARATION - CHECKPOINT RESTART INFO TBL(TCKRSTINF) 10790016
      *  THIS TABLE IS USED TO STORE WORKING STORAGE INFORMATION FOR    10800016
      *  CHECKPOINT RESTARTS.                                           10810016
      ******************************************************************10820016
           EXEC SQL                                                     10830016
               INCLUDE TCKRSTIN                                         10840016
           END-EXEC.                                                    10850016
                                                                        10860016
      ******************************************************************10870016
      *  DB2 TABLE DECLARATION - CHECKPOINT RESTART CONTROL (TCKRSTCNTL)10880016
      *  THIS TABLE IS USED FOR CHECKPOINT RESTARTS.                    10890016
      ******************************************************************10900016
           EXEC SQL                                                     10910016
               INCLUDE TCKRSTCN                                         10920016
           END-EXEC.                                                    10930016
      ***************************************************************** 10940016
      *    DB2 AREA FOR COMMUNICATIONS                                * 10950016
      ***************************************************************** 10960016
           EXEC SQL                                                     10970016
                INCLUDE SQLCA                                           10980016
           END-EXEC.                                                    10990016
                                                                        11000016
      ******************************************************************11010016
      *  MLRD0022 SALES COPYBOOK                                       *11020016
      ******************************************************************11030016
           COPY MLRD022.                                                11040016
           COPY MLRD022 REPLACING ML022 BY SLOUT.                       11050016
                                                                        11060016
      ******************************************************************11070016
      *  MLRD024 INVENTORY ADJUSTMENT RECORDS                          *11080016
      ******************************************************************11090016
           COPY MLRD024.                                                11100016
           COPY MLRD024 REPLACING ML024 BY IAOUT.                       11110016
                                                                        11120016
      ******************************************************************11130016
      *  MLRD029 PRICE CHANGE                                          *11140016
      ******************************************************************11150016
           COPY MLRD029.                                                11160016
           COPY MLRD029 REPLACING ML029 BY PCOUT.                       11170016
                                                                        11180016
      ******************************************************************11190016
      *  MLRD030 PURCHASE ADJUSTMENTS                                  *11200016
      ******************************************************************11210016
           COPY MLRD030.                                                11220016
           COPY MLRD030 REPLACING ML030 BY PAOUT.                       11230016
W34517******************************************************************11240016
W34517*  MLRD081 UNCLASSIFIED LICENSE FEES RECORD LAYOUT                11250016
W34517******************************************************************11260016
W34517     COPY MLRD081.                                                11270016
W34517******************************************************************11280016
W34517*  MLRD082 DEFAULT EXPENSE VENDORS RECORD LAYOUT                  11290016
W34517******************************************************************11300016
W34517     COPY MLRD082.                                                11310016
W34517******************************************************************11320016
W34517*  MLRD083 SPECIFIED BRANDS NOT FOUND RECORD LAYOUT               11330016
W34517******************************************************************11340016
W34517     COPY MLRD083.                                                11350016
W37965******************************************************************11360016
W37965*  AUDIT DETAIL TRANSACTION RECORD LAYOUT                         11370016
W37965******************************************************************11380016
W37965     COPY MLRD090.                                                11390016
      *  MLRD205 ERROR FILE                                             11400016
      ******************************************************************11410016
           COPY MLRD205.                                                11420016
      ******************************************************************11430016
      *  INWS001 PRICING MODULE WS                                      11440016
      ******************************************************************11450016
W31475*    COPY INWS400.                                                11460016
W31475     COPY INWS402.                                                11470016
W31475******************************************************************11480016
W31475*  SKU CROSS REFERENCE LOOKUP TABLE                               11490016
W31475******************************************************************11500016
W31475     EXEC SQL                                                     11510016
W31475         INCLUDE TSKXREF                                          11520016
W31475     END-EXEC.                                                    11530016
W31475                                                                  11540016
W31475******************************************************************11550016
W31475*  VENDOR DEPT TABLE                                              11560016
W31475******************************************************************11570016
W31475     EXEC SQL                                                     11580016
W31475         INCLUDE TVNDDPT                                          11590016
W31475     END-EXEC.                                                    11600016
W31475                                                                  11610016
W31475******************************************************************11620016
W31475*  VENDOR STYLE TABLE                                             11630016
W31475******************************************************************11640016
W31475     EXEC SQL                                                     11650016
W31475         INCLUDE TVNDSTL                                          11660016
W31475     END-EXEC.                                                    11670016
W31475                                                                  11680016
W31475******************************************************************11690016
W31475*  TMDARVS TABLE                                                  11700016
W31475******************************************************************11710016
W31475     EXEC SQL                                                     11720016
W31475         INCLUDE TMDARVS                                          11730016
W31475     END-EXEC.                                                    11740016
W31475                                                                  11750016
W31475******************************************************************11760016
W31475*  UPC TABLE                                                      11770016
W31475******************************************************************11780016
W31475     EXEC SQL                                                     11790016
W31475         INCLUDE TUPC                                             11800016
W31475     END-EXEC.                                                    11810016
W31475                                                                  11820016
W31475******************************************************************11830016
W31475*  TUPCSKU TABLE                                                  11840016
W31475******************************************************************11850016
W31475     EXEC SQL                                                     11860016
W31475         INCLUDE TUPCSKU                                          11870016
W31475     END-EXEC.                                                    11880016
W31475                                                                  11890016
W31475******************************************************************11900016
W31475*  UPCPLS TABLE                                                   11910016
W31475******************************************************************11920016
W31475     EXEC SQL                                                     11930016
W31475         INCLUDE TUPCPLS                                          11940016
W31475     END-EXEC.                                                    11950016
W31475                                                                  11960016
W31475******************************************************************11970016
W31475*  GROUP PRICING TABLE                                            11980016
W31475******************************************************************11990016
W31475     EXEC SQL                                                     12000016
W31475         INCLUDE TMEITGP                                          12010016
W31475     END-EXEC.                                                    12020016
W31475                                                                  12030016
W31475******************************************************************12040016
W31475*  GROUP PRICING TABLE                                            12050016
W31475******************************************************************12060016
W31475     EXEC SQL                                                     12070016
W31475         INCLUDE TMITGPL                                          12080016
W31475     END-EXEC.                                                    12090016
W31475                                                                  12100016
W31475******************************************************************12110016
W31475*  INVENTORY SKU STYLE DELETION TABLE.                            12120016
W31475******************************************************************12130016
W31475     EXEC SQL                                                     12140016
W31475         INCLUDE INT00003                                         12150016
W31475     END-EXEC.                                                    12160016
W31475                                                                  12170016
W31475******************************************************************12180016
W31475     EXEC SQL                                                     12190016
W31475         INCLUDE IMT00015                                         12200016
W31475     END-EXEC.                                                    12210016
W31475                                                                  12220016
W31475******************************************************************12230016
W31475     EXEC SQL                                                     12240016
W31475         INCLUDE IMT00017                                         12250016
W31475     END-EXEC.                                                    12260016
W31475                                                                  12270016
W31475******************************************************************12280016
W31475     EXEC SQL                                                     12290016
W31475         INCLUDE IMT00020                                         12300016
W31475     END-EXEC.                                                    12310016
W31475                                                                  12320016
W31475******************************************************************12330016
W31475     EXEC SQL                                                     12340016
W31475         INCLUDE MLT00011                                         12350016
W31475     END-EXEC.                                                    12360016
W31475                                                                  12370016
W31475******************************************************************12380016
W31475     EXEC SQL                                                     12390016
W31475         INCLUDE MLV00000                                         12400016
W31475     END-EXEC.                                                    12410016
W31475                                                                  12420016
W31475******************************************************************12430016
W31475     EXEC SQL                                                     12440016
W31475         INCLUDE TMDSEAR                                          12450016
W31475     END-EXEC.                                                    12460016
W31475                                                                  12470016
W31475******************************************************************12480016
W31475     EXEC SQL                                                     12490016
W31475         INCLUDE TAPLAVL                                          12500016
W31475     END-EXEC.                                                    12510016
W31475                                                                  12520016
W31475******************************************************************12530016
W31475     EXEC SQL                                                     12540016
W31475         INCLUDE TRSPBAR                                          12550016
W31475     END-EXEC.                                                    12560016
W31475                                                                  12570016
W31475******************************************************************12580016
W31475     EXEC SQL                                                     12590016
W31475         INCLUDE TEXTENT                                          12600016
W31475     END-EXEC.                                                    12610016
W31475                                                                  12620016
W31475******************************************************************12630016
W31475*  PERM PRICING TABLE.                                            12640016
W31475******************************************************************12650016
W31475     EXEC SQL                                                     12660016
W31475         INCLUDE TPPCPRC                                          12670016
W31475     END-EXEC.                                                    12680016
W31475                                                                  12690016
W31475******************************************************************12700016
W31475*  TPPCPRC TABLE LOOKUP.                                          12710016
W31475***************************************************************** 12720016
W31475     EXEC SQL                                                     12730016
W31475          DECLARE TPPCPRC-CSR CURSOR FOR                          12740016
W31475             SELECT RTL_AMT                                       12750016
W31475                   ,MEITGP_NBR                                    12760016
W31475                   ,STATUS_CDE                                    12770016
W31475             FROM TPPCPRC                                         12780016
W31475             WHERE TSK_ITM_NBR = :PPCPRC-TSK-ITM-NBR              12790016
W31475               AND STR_NBR = :PPCPRC-STR-NBR                      12800016
W31475               AND (:PPCPRC-STRT-TMST >= STRT_TMST AND            12810016
W31475                    :PPCPRC-END-TMST <= END_TMST)                 12820016
W31475             ORDER BY END_TMST DESC                               12830016
W31475             FOR FETCH ONLY                                       12840016
W31475             WITH UR                                              12850016
W31475     END-EXEC.                                                    12860016
W31475                                                                  12870016
W31475******************************************************************12880016
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - SKU                            12890016
W31475***************************************************************** 12900016
W31475     EXEC SQL                                                     12910016
W31475        DECLARE SKUSTYL-SKU-CSR CURSOR FOR                        12920016
W31475           SELECT UPC_ID                                          12930016
W31475                 ,LOC_NBR                                         12940016
W31475                 ,EFF_BEG_TMST                                    12950016
W31475                 ,UPC_NBR                                         12960016
W31475                 ,EFF_END_TMST                                    12970016
W31475                 ,UPC_STAT_CDE                                    12980016
W31475                 ,UNT_COST_AMT                                    12990016
W31475                 ,UNT_RTL_AMT                                     13000016
W31475                 ,MEITGP_NBR                                      13010016
W31475                 ,ITM_NBR                                         13020016
W31475                 ,INTR_UPC_ID                                     13030016
W31475                 ,UPC_STAT_CHG_DTE                                13040016
W31475                 ,UNT_RTL_CHG_DTE                                 13050016
W31475                 ,ORIG_CLR_DTE                                    13060016
W31475                 ,MKDN_CDE                                        13070016
W31475                 ,SUB_CL_MDSEAR_ID                                13080016
W31475                 ,VS_ID                                           13090016
W31475                 ,DEPT_NBR                                        13100016
W31475                 ,MAJ_CL_NBR                                      13110016
W31475                 ,SUB_CL_NBR                                      13120016
W31475                 ,SKU_NBR                                         13130016
W31475                 ,ENT_ID                                          13140016
W31475                 ,PLU_DWNLD_IND                                   13150016
W31475            FROM INT_SKU_STYL_DLT                                 13160016
W31475            WHERE SKU_NBR = :INT00003-SKU-NBR                     13170016
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     13180016
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          13190016
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         13200016
W31475               OR  EFF_END_TMST IS NULL)                          13210016
W31475            ORDER BY EFF_END_TMST DESC                            13220016
W31475            WITH UR                                               13230016
W31475     END-EXEC.                                                    13240016
W31475                                                                  13250016
W31475******************************************************************13260016
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - UPC_NBR                        13270016
W31475***************************************************************** 13280016
W31475     EXEC SQL                                                     13290016
W31475        DECLARE SKUSTYL-UPC-CSR CURSOR FOR                        13300016
W31475           SELECT UPC_ID                                          13310016
W31475                 ,LOC_NBR                                         13320016
W31475                 ,EFF_BEG_TMST                                    13330016
W31475                 ,UPC_NBR                                         13340016
W31475                 ,EFF_END_TMST                                    13350016
W31475                 ,UPC_STAT_CDE                                    13360016
W31475                 ,UNT_COST_AMT                                    13370016
W31475                 ,UNT_RTL_AMT                                     13380016
W31475                 ,MEITGP_NBR                                      13390016
W31475                 ,ITM_NBR                                         13400016
W31475                 ,INTR_UPC_ID                                     13410016
W31475                 ,UPC_STAT_CHG_DTE                                13420016
W31475                 ,UNT_RTL_CHG_DTE                                 13430016
W31475                 ,ORIG_CLR_DTE                                    13440016
W31475                 ,MKDN_CDE                                        13450016
W31475                 ,SUB_CL_MDSEAR_ID                                13460016
W31475                 ,VS_ID                                           13470016
W31475                 ,DEPT_NBR                                        13480016
W31475                 ,MAJ_CL_NBR                                      13490016
W31475                 ,SUB_CL_NBR                                      13500016
W31475                 ,SKU_NBR                                         13510016
W31475                 ,ENT_ID                                          13520016
W31475                 ,PLU_DWNLD_IND                                   13530016
W31475            FROM INT_SKU_STYL_DLT                                 13540016
W31475            WHERE UPC_NBR = :INT00003-UPC-NBR                     13550016
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     13560016
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          13570016
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         13580016
W31475               OR  EFF_END_TMST IS NULL)                          13590016
W31475            ORDER BY EFF_END_TMST DESC                            13600016
W31475            WITH UR                                               13610016
W31475     END-EXEC.                                                    13620016
W31475                                                                  13630016
W31475******************************************************************13640016
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - INTR_UPC_ID                    13650016
W31475***************************************************************** 13660016
W31475     EXEC SQL                                                     13670016
W31475        DECLARE SKUSTYL-IUPC-CSR CURSOR FOR                       13680016
W31475           SELECT UPC_ID                                          13690016
W31475                 ,LOC_NBR                                         13700016
W31475                 ,EFF_BEG_TMST                                    13710016
W31475                 ,UPC_NBR                                         13720016
W31475                 ,EFF_END_TMST                                    13730016
W31475                 ,UPC_STAT_CDE                                    13740016
W31475                 ,UNT_COST_AMT                                    13750016
W31475                 ,UNT_RTL_AMT                                     13760016
W31475                 ,MEITGP_NBR                                      13770016
W31475                 ,ITM_NBR                                         13780016
W31475                 ,INTR_UPC_ID                                     13790016
W31475                 ,UPC_STAT_CHG_DTE                                13800016
W31475                 ,UNT_RTL_CHG_DTE                                 13810016
W31475                 ,ORIG_CLR_DTE                                    13820016
W31475                 ,MKDN_CDE                                        13830016
W31475                 ,SUB_CL_MDSEAR_ID                                13840016
W31475                 ,VS_ID                                           13850016
W31475                 ,DEPT_NBR                                        13860016
W31475                 ,MAJ_CL_NBR                                      13870016
W31475                 ,SUB_CL_NBR                                      13880016
W31475                 ,SKU_NBR                                         13890016
W31475                 ,ENT_ID                                          13900016
W31475                 ,PLU_DWNLD_IND                                   13910016
W31475            FROM INT_SKU_STYL_DLT                                 13920016
W31475            WHERE INTR_UPC_ID = :INT00003-INTR-UPC-ID             13930016
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     13940016
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          13950016
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         13960016
W31475               OR  EFF_END_TMST IS NULL)                          13970016
W31475            ORDER BY EFF_END_TMST DESC                            13980016
W31475            WITH UR                                               13990016
W31475     END-EXEC.                                                    14000016
W31475                                                                  14010016
W31475******************************************************************14020016
W31475*  INT_SKU_STYL_DLT TABLE LOOKUP - ITM_NBR                        14030016
W31475******************************************************************14040016
W31475     EXEC SQL                                                     14050016
W31475        DECLARE SKUSTYL-ITM-CSR CURSOR FOR                        14060016
W31475           SELECT UPC_ID                                          14070016
W31475                 ,LOC_NBR                                         14080016
W31475                 ,EFF_BEG_TMST                                    14090016
W31475                 ,UPC_NBR                                         14100016
W31475                 ,EFF_END_TMST                                    14110016
W31475                 ,UPC_STAT_CDE                                    14120016
W31475                 ,UNT_COST_AMT                                    14130016
W31475                 ,UNT_RTL_AMT                                     14140016
W31475                 ,MEITGP_NBR                                      14150016
W31475                 ,ITM_NBR                                         14160016
W31475                 ,INTR_UPC_ID                                     14170016
W31475                 ,UPC_STAT_CHG_DTE                                14180016
W31475                 ,UNT_RTL_CHG_DTE                                 14190016
W31475                 ,ORIG_CLR_DTE                                    14200016
W31475                 ,MKDN_CDE                                        14210016
W31475                 ,SUB_CL_MDSEAR_ID                                14220016
W31475                 ,VS_ID                                           14230016
W31475                 ,DEPT_NBR                                        14240016
W31475                 ,MAJ_CL_NBR                                      14250016
W31475                 ,SUB_CL_NBR                                      14260016
W31475                 ,SKU_NBR                                         14270016
W31475                 ,ENT_ID                                          14280016
W31475                 ,PLU_DWNLD_IND                                   14290016
W31475            FROM INT_SKU_STYL_DLT                                 14300016
W31475            WHERE ITM_NBR = :INT00003-ITM-NBR                     14310016
W31475              AND LOC_NBR = :INT00003-LOC-NBR                     14320016
W31475              AND EFF_BEG_TMST <= :INT00003-EFF-BEG-TMST          14330016
W31475              AND (EFF_END_TMST >= :INT00003-EFF-END-TMST         14340016
W31475               OR  EFF_END_TMST IS NULL)                          14350016
W31475            ORDER BY EFF_END_TMST DESC                            14360016
W31475            WITH UR                                               14370016
W31475     END-EXEC.                                                    14380016
W31475                                                                  14390016
W31475******************************************************************14400016
W31475* BRAND CURSOR.                                                   14410016
W31475******************************************************************14420016
W31475     EXEC SQL                                                     14430016
W31475         DECLARE BV_BRND_CSR CURSOR FOR                           14440016
W31475           SELECT  DEPT_BRND_VND_ID                               14450016
W31475                  ,DEPT_NBR                                       14460016
W31475                  ,ENT_ID                                         14470016
W31475           FROM IMT_DEPT_BRND_VND                                 14480016
W31475           WHERE LBL_SEQ_NBR   = :BV003-PV-WORK-BRAND             14490016
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              14500016
W31475             AND (EFF_END_DTE IS NULL OR                          14510016
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             14520016
W31475           WITH UR                                                14530016
W31475           FOR FETCH ONLY                                         14540016
W31475     END-EXEC.                                                    14550016
W31475                                                                  14560016
W31475************************************************************      14570016
W31475* BRAND DEPT CURSOR.                                              14580016
W31475************************************************************      14590016
W31475     EXEC SQL                                                     14600016
W31475         DECLARE BV_BRND_DEPT_CSR CURSOR FOR                      14610016
W31475           SELECT  DEPT_BRND_VND_ID                               14620016
W31475                  ,ENT_ID                                         14630016
W31475           FROM IMT_DEPT_BRND_VND                                 14640016
W31475           WHERE LBL_SEQ_NBR   = :BV003-PV-WORK-BRAND             14650016
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              14660016
W31475             AND (EFF_END_DTE IS NULL OR                          14670016
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             14680016
W31475             AND DEPT_NBR      = :BV003-PV-WORK-DEPT              14690016
W31475           WITH UR                                                14700016
W31475           FOR FETCH ONLY                                         14710016
W31475     END-EXEC.                                                    14720016
W31475                                                                  14730016
W31475************************************************************      14740016
W31475* VENDOR CURSOR.                                                  14750016
W31475************************************************************      14760016
W31475     EXEC SQL                                                     14770016
W31475         DECLARE BV_VNDR_CSR CURSOR FOR                           14780016
W31475           SELECT  DEPT_BRND_VND_ID                               14790016
W31475                  ,DEPT_NBR                                       14800016
W31475                  ,LBL_SEQ_NBR                                    14810016
W31475           FROM IMT_DEPT_BRND_VND                                 14820016
W31475           WHERE ENT_ID        = :BV003-PV-WORK-ENT-ID            14830016
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              14840016
W31475             AND (EFF_END_DTE IS NULL OR                          14850016
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             14860016
W31475           WITH UR                                                14870016
W31475           FOR FETCH ONLY                                         14880016
W31475     END-EXEC.                                                    14890016
W31475                                                                  14900016
W31475************************************************************      14910016
W31475* VENDOR DEPT CURSOR.                                             14920016
W31475************************************************************      14930016
W31475     EXEC SQL                                                     14940016
W31475         DECLARE BV_VNDR_DEPT_CSR CURSOR FOR                      14950016
W31475           SELECT  DEPT_BRND_VND_ID                               14960016
W31475                  ,LBL_SEQ_NBR                                    14970016
W31475           FROM IMT_DEPT_BRND_VND                                 14980016
W31475           WHERE ENT_ID        = :BV003-PV-WORK-ENT-ID            14990016
W31475             AND EFF_BEG_DTE  <= :BV003-PV-WORK-DATE              15000016
W31475             AND (EFF_END_DTE IS NULL OR                          15010016
W31475                  EFF_END_DTE >= :BV003-PV-WORK-DATE)             15020016
W31475             AND DEPT_NBR      = :BV003-PV-WORK-DEPT              15030016
W31475           WITH UR                                                15040016
W31475           FOR FETCH ONLY                                         15050016
W31475     END-EXEC.                                                    15060016
W31475************************************************************      15070016
W31475* VENDOR DEPT FUTURE CURSOR                                       15080016
W31475************************************************************      15090016
W31475     EXEC SQL                                                     15100016
W31475         DECLARE BV_VND_DPT_FUT_CSR CURSOR FOR                    15110016
W31475           SELECT  DEPT_BRND_VND_ID                               15120016
W31475                  ,LBL_SEQ_NBR                                    15130016
W31475           FROM IMT_DEPT_BRND_VND                                 15140016
W31475           WHERE ENT_ID        = :BV003-PV-WORK-ENT-ID            15150016
W31475             AND EFF_BEG_DTE  >  :BV003-PV-WORK-DATE              15160016
W31475             AND (EFF_END_DTE IS NULL OR                          15170016
W31475                  EFF_END_DTE >  :BV003-PV-WORK-DATE)             15180016
W31475             AND DEPT_NBR      = :BV003-PV-WORK-DEPT              15190016
W31475           WITH UR                                                15200016
W31475           FOR FETCH ONLY                                         15210016
W31475     END-EXEC.                                                    15220016
W31475************************************************************      15230016
W31475* VENDOR DEPT PAST CURSOR                                         15240016
W31475************************************************************      15250016
W31475     EXEC SQL                                                     15260016
W31475         DECLARE BV_VND_DPT_PST_CSR CURSOR FOR                    15270016
W31475           SELECT  DEPT_BRND_VND_ID                               15280016
W31475                  ,LBL_SEQ_NBR                                    15290016
W31475           FROM IMT_DEPT_BRND_VND BV1                             15300016
W31475           WHERE ENT_ID      =  :BV003-PV-WORK-ENT-ID             15310016
W31475             AND EFF_BEG_DTE <  :BV003-PV-WORK-DATE               15320016
W31475             AND EFF_BEG_DTE >= DATE(:BV003-PV-WORK-DATE) -       15330016
W31475                                     :BV003-PV-PAST-MONTHS MONTHS 15340016
W31475             AND DEPT_NBR    =  :BV003-PV-WORK-DEPT               15350016
W31475             AND EFF_END_DTE = (SELECT MAX(EFF_END_DTE)           15360016
W31475                                  FROM IMT_DEPT_BRND_VND BV2      15370016
W31475                                 WHERE BV1.ENT_ID = BV2.ENT_ID    15380016
W31475                                   AND BV1.LBL_SEQ_NBR =          15390016
W31475                                       BV2.LBL_SEQ_NBR            15400016
W31475                                   AND BV1.DEPT_NBR    =          15410016
W31475                                       BV2.DEPT_NBR               15420016
W31475                                   AND BV2.EFF_BEG_DTE <          15430016
W31475                                       :BV003-PV-WORK-DATE        15440016
W31475                                   AND BV2.EFF_BEG_DTE >=         15450016
W31475                                       DATE(:BV003-PV-WORK-DATE) -15460016
W31475                                       :BV003-PV-PAST-MONTHS      15470016
W31475                                        MONTHS)                   15480016
W31475           WITH UR                                                15490016
W31475           FOR FETCH ONLY                                         15500016
W31475     END-EXEC.                                                    15510016
W37965************************************************************      15520016
W37965* EXPENSE VENDOR CURSOR                                           15530016
W37965************************************************************      15540016
W37965     EXEC SQL                                                     15550016
W37965         DECLARE EXP_VEN_CSR CURSOR FOR                           15560016
W37965           SELECT  ENT_ID                                         15570016
W37965           FROM MLT_VND_ALLOC                                     15580016
W37965           WHERE EXP_TYP_NBR IN (:PV-EXP-TYPE1, :PV-EXP-TYPE2,    15590016
W37965                                 :PV-EXP-TYPE3, :PV-EXP-TYPE4,    15600016
W37965                                 :PV-EXP-TYPE5, :PV-EXP-TYPE6,    15610016
W37965                                 :PV-EXP-TYPE7, :PV-EXP-TYPE8,    15620016
W37965                                 :PV-EXP-TYPE9, :PV-EXP-TYPE10)   15630016
W37965             AND :PV-PROCESS-DATE BETWEEN EFF_BEG_DTE AND         15640016
W37965                                          EFF_END_DTE             15650016
W37965           WITH UR                                                15660016
W37965           FOR FETCH ONLY                                         15670016
W37965     END-EXEC.                                                    15680016
      ******************************************************************15690016
      *  BRAND VENDOR UTILITY FUNCTIONS.                               *15700016
      ******************************************************************15710016
      *    COPY BVWS001.                                                15720016
                                                                        15730016
W34517******************************************************************15740016
W34517*  PRORATE AGAINST VENDORS FOR SPECIFC BRANDS WORKING STORAGE     15750016
W34517******************************************************************15760016
W34517     COPY BVWS002.                                                15770016
W34517                                                                  15780016
W34517******************************************************************15790016
W34517*  BEGINNING OF MONTH (BOM) SKU ATTRIBUTE WORKING STORAGE         15800016
W34517******************************************************************15810016
W31475*    COPY BVWS100.                                                15820016
W31475     COPY BVWS101.                                                15830016
W31475                                                                  15840016
W31475******************************************************************15850016
W31475*  DATE ATTRIBUTE TABLE                                           15860016
W31475******************************************************************15870016
W31475     EXEC SQL                                                     15880016
W31475         INCLUDE TDTATTR                                          15890016
W31475     END-EXEC.                                                    15900016
W31475                                                                  15910016
W31475******************************************************************15920016
W31475*  BEGINNING OF MONTH TABLE                                       15930016
W31475******************************************************************15940016
W31475     EXEC SQL                                                     15950016
W31475         INCLUDE XMT00023                                         15960016
W31475     END-EXEC.                                                    15970016
W31475                                                                  15980016
      ***************************************************************** 15990016
      *    THIS CURSOR RETRIEVES RTV DETAIL INFORMATION               * 16000016
      ***************************************************************** 16010016
                                                                        16020016
           EXEC SQL                                                     16030016
                DECLARE BRND-PRRTN-CSR CURSOR WITH HOLD FOR             16040016
                SELECT LBL_SEQ_NBR                                      16050016
                      ,MKDN_BYR_RTL_PCT                                 16060016
                      ,MKDN_STR_RTL_PCT                                 16070016
                      ,RCPT_GRO_COST_PCT                                16080016
                      ,PADJ_DA_COST_PCT                                 16090016
                      ,PADJ_RTV_COST_PCT                                16100016
                      ,SLS_REG_RTL_PCT                                  16110016
                  FROM BVT_BRND_PRRTN_PCT PRCH,                         16120016
                       TDTATTR DT                                       16130016
                 WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE        16140016
                   AND DT.KY_DTE            = :PV-PROCESS-DATE          16150016
                   AND PRCH.ENT_ID          = :PV-DB2-ENT-ID            16160016
                   AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR          16170016
           END-EXEC.                                                    16180016
                                                                        16190016
      ***************************************************************** 16200016
      *    THIS CURSOR RETRIEVES RTV DETAIL INFORMATION               * 16210016
      ***************************************************************** 16220016
                                                                        16230016
           EXEC SQL                                                     16240016
                DECLARE RTV-DOC-CSR CURSOR WITH HOLD FOR                16250016
                SELECT DISTINCT(DFCT_ITEM_NBR)                          16260026
                      ,SUM(RTL_COST_AMT)                                16270016
                      ,SUM(UNIT_COST_AMT)                               16280016
                  FROM TDFMEIT                                          16290016
                 WHERE DFCT_ORD_ID   = :PV-DB2-RTV-DOC-NBR              16300016
RONNAZ             AND MDSE_DEPT_NBR = :DFMEIT-MDSE-DEPT-NBR            16310016
RONNAZ             AND MDSE_CLASS_NBR       = :DFMEIT-MDSE-CLASS-NBR    16320016
                 GROUP BY  DFCT_ITEM_NBR                                16330016
                 ORDER BY DFCT_ITEM_NBR                                 16340016
           END-EXEC.                                                    16350016
W31475******************************************************************16360016
W31475*   THIS CURSOR RETRIEVES DA PRORATION DETAILS (EARLIER ORACLE)  *16370016
W31475******************************************************************16380016
W31475                                                                  16390016
W31475     EXEC SQL                                                     16400016
W31475          DECLARE DA-BRND-PRRTN-CSR CURSOR FOR                    16410016
W31475          SELECT LBL_SEQ_NBR                                      16420016
W31475                ,PRRTN_PCT                                        16430016
W31475            FROM MLTW_DR_ALW_BRND_PRRTN                           16440016
W31475           WHERE DR_ALW_NBR = :PV-DR-ALW-NBR                      16450016
W31475           ORDER BY LBL_SEQ_NBR                                   16460016
W31475           FOR FETCH ONLY                                         16470016
W31475           WITH UR                                                16480016
W31475     END-EXEC.                                                    16490016
      ******************************************************************16500016
       PROCEDURE DIVISION.                                              16510016
      ******************************************************************16520016
                                                                        16530016
       0000-MAINLINE.                                                   16540016
                                                                        16550016
           PERFORM 1000-INITIALIZE.                                     16560016
                                                                        16570016
           PERFORM 1100-PROCESS-INPUT.                                  16580016
                                                                        16590016
           PERFORM 1200-END-PROCESSING.                                 16600016
                                                                        16610016
           STOP RUN.                                                    16620016
      ******************************************************************16630016
      *  PERFORM THE NECESSARY INITIALIZATION STEPS                     16640016
      ******************************************************************16650016
       1000-INITIALIZE.                                                 16660016
           OPEN  INPUT PURCH-FILE                                       16670016
                       SALE-FILE                                        16680016
                       PRC-CHG-FILE                                     16690016
                       ADJUSTMENT-FILE                                  16700016
                       IN-ORACLE-SRC-CTL                                16710016
                       CNTL-DATE-FILE                                   16720016
W28582                 CNTL-JOB-FILE                                    16730016
W37965*                BV-EXP-VND-FILE                                  16740016
W37965                 ENT-TYPE-FILE                                    16750016
                OUTPUT BV-PURCH-FILE                                    16760016
                       BV-SALE-FILE                                     16770016
                       BV-PRC-CHG-FILE                                  16780016
                       BV-ADJUSTMENT-FILE                               16790016
W34517                 BV-UNCL-LIC-FILE                                 16800016
W34517                 BV-DEF-EXP-VND-FILE                              16810016
W34517                 BV-SPEC-NOTFND-FILE                              16820016
W28582                 BV-ERROR-FILE                                    16830016
W37965                 BV-PURCH-AUDIT-FILE                              16840016
W37965                 BV-SALE-AUDIT-FILE                               16850016
W37965                 BV-PRC-CHG-AUDIT-FILE                            16860016
W37965                 BV-INV-ADJ-AUDIT-FILE                            16870016
W28582                 BV-PURCH-AUDIT-RPT                               16880016
W28582                 BV-SALE-AUDIT-RPT                                16890016
W28582                 BV-PRC-CHG-AUDIT-RPT                             16900016
W28582                 BV-ADJUSTMENT-AUDIT-RPT.                         16910016
           EXEC SQL                                                     16920016
              SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                  16930016
           END-EXEC.                                                    16940016
                                                                        16950016
           EVALUATE TRUE                                                16960016
              WHEN SQLCODE = 0                                          16970016
                 CONTINUE                                               16980016
              WHEN OTHER                                                16990016
                 DISPLAY '1000-INITIALIZE'                              17000016
                 PERFORM 9998-SQL-ABEND                                 17010016
           END-EVALUATE.                                                17020016
                                                                        17030016
W37965     PERFORM 9052-READ-ENT-TYPE-FILE.                             17040016
                                                                        17050016
W28582     PERFORM 9051-READ-CNTL-JOB.                                  17060016
W28582                                                                  17070016
W28582*DETERMINE RUN TYPE                                               17080016
W28582     PERFORM 9800-GET-CHECKPOINT-CNTL.                            17090016
W28582     MOVE PV-CKPT-STAT-CODE  TO  PS-RUN-TYPE-SW.                  17100016
W28582     IF PS-RESTART-RUN                                            17110016
W28582         PERFORM 9802-CHECKPOINT-RESTART                          17120016
W28582         MOVE 0 TO PV-RESTART-COUNT                               17130016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 17140016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 17150016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 17160016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 17170016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 17180016
W28582         DISPLAY '***** R E S T A R T I N G ****'                 17190016
W28582     ELSE                                                         17200016
W28582         MOVE PC-RUN-IN-PROGRESS-CODE    TO PV-CKPT-STAT-CODE     17210016
W28582         PERFORM 9804-UPDATE-TCKRSTCNTL                           17220016
W28582         PERFORM 9801-INITIALIZE-TCKRSTINF                        17230016
W28582     END-IF.                                                      17240016
W28582     MOVE PV-CURRENT-TMST(6:2) TO DP132-RUN-MONTH.                17250016
W28582     MOVE PV-CURRENT-TMST(9:2) TO DP132-RUN-DAY.                  17260016
W28582     MOVE PV-CURRENT-TMST(1:4) TO DP132-RUN-YEAR.                 17270016
W28582     MOVE PV-CURRENT-TMST(12:2) TO DP132-RUN-HOUR.                17280016
W28582     MOVE PV-CURRENT-TMST(15:2) TO DP132-RUN-MINUTE.              17290016
W28582     MOVE PC-PGM-NAME TO DP132-PROGRAM-NAME                       17300016
W28582     MOVE 0 TO DP132-PAGE-NUMBER.                                 17310016
W28582     MOVE PV-CURRENT-TMST(6:2) TO DP150-RUN-MONTH.                17320016
W28582     MOVE PV-CURRENT-TMST(9:2) TO DP150-RUN-DAY.                  17330016
W28582     MOVE PV-CURRENT-TMST(1:4) TO DP150-RUN-YEAR.                 17340016
W28582     MOVE PV-CURRENT-TMST(12:2) TO DP150-RUN-HOUR.                17350016
W28582     MOVE PV-CURRENT-TMST(15:2) TO DP150-RUN-MINUTE.              17360016
W28582     MOVE PC-PGM-NAME TO DP150-PROGRAM-NAME                       17370016
W28582     MOVE 0 TO DP150-PAGE-NUMBER.                                 17380016
W28582     MOVE 1 TO DP150-REPORT-NUMBER.                               17390016
W28582     MOVE 3 TO DP132-REPORT-NUMBER.                               17400016
W28582     MOVE 100 TO PV-LINE-COUNTER.                                 17410016
                                                                        17420016
           PERFORM 9040-READ-ORACLE-SRC-CTL.                            17430016
                                                                        17440016
           PERFORM 9050-READ-CNTL-DTE.                                  17450016
                                                                        17460016
      ******************************************************************17470016
      *  PROCESS THE INPUT FILES.                                       17480016
      ******************************************************************17490016
       1100-PROCESS-INPUT.                                              17500016
           MOVE SPACES TO PV-REC-TYPE-IN.                               17510016
           DISPLAY 'PROCESSING PURCH RECORDS'.                          17520016
NHOLD$     SET PV-HOLD-FILE-PURCH TO TRUE.                              17530016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     17540016
           PERFORM 9000-READ-PURCH-FILE.                                17550016
           IF PS-MORE-PURCH-RECORDS                                     17560016
W28582        MOVE 'PUR' TO PV-REC-TYPE-IN                              17570016
              PERFORM 2000-PROCESS-PURCH-RECS                           17580016
                      UNTIL PS-NO-MORE-PURCH-RECORDS                    17590016
           END-IF.                                                      17600016
                                                                        17610016
           DISPLAY 'PROCESSING SALE RECORDS'.                           17620016
NHOLD$     SET PV-HOLD-FILE-SALE TO TRUE.                               17630016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     17640016
           PERFORM 9010-READ-SALE-FILE.                                 17650016
           IF PS-MORE-SALE-RECORDS                                      17660016
W28582        MOVE 'SAL' TO PV-REC-TYPE-IN                              17670016
              PERFORM 3000-PROCESS-SALE-RECS                            17680016
                      UNTIL PS-NO-MORE-SALE-RECORDS                     17690016
           END-IF.                                                      17700016
                                                                        17710016
           DISPLAY 'PROCESSING PRICE CHANGE RECORDS'.                   17720016
NHOLD$     SET PV-HOLD-FILE-PCHG TO TRUE.                               17730016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     17740016
           PERFORM 9020-READ-PRC-CHG-FILE.                              17750016
           IF PS-MORE-PCHG-RECORDS                                      17760016
W28582        MOVE 'PCH' TO PV-REC-TYPE-IN                              17770016
              PERFORM 4000-PROCESS-PCHG-RECS                            17780016
                      UNTIL PS-NO-MORE-PCHG-RECORDS                     17790016
           END-IF.                                                      17800016
                                                                        17810016
           DISPLAY 'PROCESSING ADJUSTMENT RECORDS'.                     17820016
NHOLD$     SET PV-HOLD-FILE-PADJ TO TRUE.                               17830016
NHOLD$     PERFORM 6400-RESET-HOLD.                                     17840016
           PERFORM 9030-READ-ADJUSTMENT-FILE.                           17850016
           IF PS-MORE-ADJ-RECORDS                                       17860016
W28582        MOVE 'ADJ' TO PV-REC-TYPE-IN                              17870016
              PERFORM 5000-PROCESS-ADJ-RECS                             17880016
                      UNTIL PS-NO-MORE-ADJ-RECORDS                      17890016
           END-IF.                                                      17900016
      ******************************************************************17910016
      *  PERFORM THE NECESSARY END PROCESSING STEPS                     17920016
      ******************************************************************17930016
       1200-END-PROCESSING.                                             17940016
           DISPLAY '*************************************************'  17950016
           DISPLAY 'TOT ADJ RECS IN         ' PV-TOT-EDIT-ADJ-RECS-IN   17960016
           DISPLAY 'TOT PRICE CHG RECS IN   ' PV-TOT-EDIT-PCHG-RECS-IN  17970016
           DISPLAY 'TOT PURCH RECORDS IN    ' PV-TOT-EDIT-PURCH-RECS-IN 17980016
           DISPLAY 'TOT SALE RECORDS IN     ' PV-TOT-EDIT-SALE-RECS-IN  17990016
           DISPLAY '*************************************************'  18000016
           DISPLAY 'TOT ADJ RECS OUT        ' PV-TOT-EDIT-ADJ-RECS-OUT  18010016
           DISPLAY 'TOT PRICE CHG RECS OUT  ' PV-TOT-EDIT-PCHG-RECS-OUT 18020016
           DISPLAY 'TOT PURCH RECORDS OUT   ' PV-TOT-EDIT-PURCH-RECS-OUT18030016
           DISPLAY 'TOT SALE RECORDS OUT    ' PV-TOT-EDIT-SALE-RECS-OUT 18040016
           DISPLAY '*************************************************'  18050016
W34517     DISPLAY 'TOT RTV COUNT ZERO               '                  18060016
W34517                                        PV-TOT-RTV-COUNT-ZERO     18070016
W34517     DISPLAY 'TOT RTV COUNT NOT ZERO           '                  18080016
W34517                                        PV-TOT-RTV-COUNT-NOT-ZERO 18090016
W34517     DISPLAY 'TOT ORIGINAL BV RECORDS OUT      '                  18100016
W34517                                        PV-TOT-EDIT-BV-ORIG-OUT   18110016
W34517     DISPLAY 'TOT REVERSAL BV RECORDS OUT      '                  18120016
W34517                                        PV-TOT-EDIT-BV-REVR-OUT   18130016
W34517     DISPLAY 'TOT REASSIGN BV RECORDS OUT      '                  18140016
W34517                                        PV-TOT-EDIT-BV-REAS-OUT   18150016
W34517     DISPLAY 'TOT UNCHANGED BV RECORDS OUT     '                  18160016
W34517                                        PV-TOT-EDIT-BV-UNCH-OUT   18170016
W34517     DISPLAY 'TOT AUDIT BV RECORDS OUT         '                  18180016
W34517                                        PV-TOT-AUDIT-BV-RECS-OUT  18190016
W34517     DISPLAY 'TOT UNCH ENT-ID ZERO RECORDS OUT '                  18200016
W34517                                       PV-TOT-ENT-ZERO-BV-UNCH-OUT18210016
W34517     DISPLAY 'TOT BOM INSERTED                 '                  18220016
W34517                                        PV-TOT-BOM-INSERTED       18230016
W34517     DISPLAY 'TOT BOM DUPLICATES               '                  18240016
W34517                                        PV-TOT-BOM-INSERT-DUPS    18250016
W34517     DISPLAY 'TOT UNCLASSIFIED LICENSE FEES    '                  18260016
W34517                                        PV-TOT-UNCL-LIC-FEE-OUT   18270016
W34517     DISPLAY 'TOT DEFAULT EXPENSE VENDORS      '                  18280016
W34517                                        PV-TOT-DEF-EXP-VND-OUT    18290016
W34517     DISPLAY 'TOT SPEC BRANDS DKEY NOT FOUND   '                  18300016
W34517                                      PV-TOT-SPEC-BRANDS-NOT-FOUND18310016
W37965     DISPLAY 'TOT EXPENSE VENDOR INSERTED      '                  18320016
W37965                                      PV-TOT-EXP-VDR-INSERTED     18330016
W37965     DISPLAY 'TOT PADJ AUDIT RECORDS OUT       '                  18340016
W37965                                      PV-TOT-PADJ-AUDIT-OUT       18350016
W37965     DISPLAY 'TOT PCHG AUDIT RECORDS OUT       '                  18360016
W37965                                      PV-TOT-PCHG-AUDIT-OUT       18370016
W37965     DISPLAY 'TOT SALES AUDIT RECORDS OUT      '                  18380016
W37965                                      PV-TOT-SALE-AUDIT-OUT       18390016
W37965     DISPLAY 'TOT INV ADJ AUDIT RECORDS OUT    '                  18400016
W37965                                      PV-TOT-IADJ-AUDIT-OUT       18410016
W34517     DISPLAY '*************************************************'  18420016
                                                                        18430016
           CLOSE PURCH-FILE                                             18440016
                 SALE-FILE                                              18450016
                 PRC-CHG-FILE                                           18460016
                 ADJUSTMENT-FILE                                        18470016
W37965*          BV-EXP-VND-FILE                                        18480016
W37965           ENT-TYPE-FILE                                          18490016
                 BV-PURCH-FILE                                          18500016
                 BV-SALE-FILE                                           18510016
                 BV-PRC-CHG-FILE                                        18520016
                 BV-ADJUSTMENT-FILE                                     18530016
W34517           BV-UNCL-LIC-FILE                                       18540016
W34517           BV-DEF-EXP-VND-FILE                                    18550016
W34517           BV-SPEC-NOTFND-FILE                                    18560016
W28582           BV-ERROR-FILE                                          18570016
W37965           BV-PURCH-AUDIT-FILE                                    18580016
W37965           BV-SALE-AUDIT-FILE                                     18590016
W37965           BV-PRC-CHG-AUDIT-FILE                                  18600016
W37965           BV-INV-ADJ-AUDIT-FILE                                  18610016
W28582           BV-PURCH-AUDIT-RPT                                     18620016
W28582           BV-SALE-AUDIT-RPT                                      18630016
W28582           BV-PRC-CHG-AUDIT-RPT                                   18640016
W28582           BV-ADJUSTMENT-AUDIT-RPT                                18650016
W28582           CNTL-JOB-FILE.                                         18660016
W28582                                                                  18670016
W28582*  SET CKPT LOGIC TO END OF RUN STATUS CODE ( 0 )                 18680016
W28582                                                                  18690016
W28582     MOVE PC-RUN-COMPLETE-CODE TO PV-CKPT-STAT-CODE.              18700016
W28582     PERFORM 9804-UPDATE-TCKRSTCNTL.                              18710016
                                                                        18720016
      ******************************************************************18730016
      *  PROCESS ALL EDIT PURCH RECORDS                                 18740016
      ******************************************************************18750016
       2000-PROCESS-PURCH-RECS.                                         18760016
           ADD 1 TO PV-TOT-EDIT-PURCH-RECS-IN.                          18770016
W34517     SET PS-PURCH-SKU-NO            TO TRUE.                      18780016
W34517     SET PS-PURCH-RTV-NO            TO TRUE.                      18790016
W32898     MOVE ML030-PURCH-RECORD        TO PAOUT-PURCH-RECORD.        18800016
W32898     MOVE ML030-PURCH-SYST-ORIG-CDE TO PS-PURCH-SYST-ORIG.        18810016
W32898     MOVE ML030-PURCH-TRANS-CDE     TO PS-PURCH-TRANS-CDE.        18820016
W32898     MOVE ML030-PURCH-AP-TRANS-CDE  TO PS-AP-TRANS-CDE.           18830016
                                                                        18840016
W32898     IF PS-PURCH-AP-TRANS-BV-REALIGN                              18850016
W32898         PERFORM 2750-PADJ-REALIGN-PROCESSING                     18860016
W32898     ELSE                                                         18870016
W34309         IF PS-PURCH-AP-TRANS-GIVEBACK                            18880016
W34309             PERFORM 2760-PADJ-GIVEBACK-PROCESSING                18890016
W34309     ELSE                                                         18900016
 ZEROD         IF ML030-PURCH-DEPT-NBR EQUAL ZERO                       18910016
 ZEROD            PERFORM 2900-PURCH-ZERO-DEPT                          18920016
 ZEROD         ELSE                                                     18930016
W34517            IF PS-PURCH-AP-TRANS-SPCL                             18940016
W34517                PERFORM 2850-PURCH-AP-SPECIAL                     18950016
W34517            ELSE                                                  18960016
NHOLD$            PERFORM 6500-CHECK-HOLD-MATCH                         18970016
NHOLD$            IF PS-HOLD-MATCH     AND                              18980016
NHOLD$              (PS-PREV-FOUND-SKU OR PS-PREV-EVEN-PRRTN)           18990016
NHOLD$               PERFORM 2910-PURCH-SKU-MATCH                       19000016
NHOLD$            ELSE                                                  19010016
                    SET PS-NOT-DA-ALW-OR-RTV TO TRUE                    19020016
                    MOVE ML030-PURCH-SYST-ORIG-CDE TO PS-PURCH-SYST-ORIG19030016
                    MOVE ML030-PURCH-TRANS-CDE   TO PS-PURCH-TRANS-CDE  19040016
                    MOVE ML030-PURCH-AP-TRANS-CDE TO PS-AP-TRANS-CDE    19050016
                    IF PS-PURCH-RECEIPT-A OR PS-PURCH-RECEIPT-B OR      19060016
                       PS-PURCH-TRANSFER-FRM-STORE OR                   19070016
                       PS-PURCH-TRANSFER-TO-STORE OR                    19080016
                       PS-PURCH-AP-TRANS-SKU                            19090016
                       PERFORM 2100-PURCH-SKU-PROCESSING                19100016
                    ELSE                                                19110016
                       IF PS-PURCH-AP-TRANS-RTV                         19120016
                          PERFORM 2200-PROCESS-PURCH-RTV-DOC            19130016
                       ELSE                                             19140016
                          IF PS-PURCH-AP-TRANS-VND AND                  19150016
W34517                      (ML030-PURCH-SKU EQUAL ZEROES OR            19160016
W34517                       ML030-PURCH-SKU EQUAL SPACES OR            19170016
W34517                       ML030-PURCH-SKU (6:3) = '000' OR           19180016
W34517                       ML030-PURCH-SKU (6:3) = '999')             19190016
                             PERFORM 2300-PURCH-VNDR-PROCESSING         19200016
                          ELSE                                          19210016
                             IF PS-PURCH-AP-TRANS-DA                    19220016
                                PERFORM 2800-PURCH-DA-PROCESSING        19230016
                             ELSE                                       19240016
                                SET PS-PURCH-AP-OTHER TO TRUE           19250016
                                IF ML030-PURCH-SKU NOT EQUAL ZEROES AND 19260016
                                   ML030-PURCH-SKU NOT EQUAL SPACES     19270016
                                   PERFORM 2100-PURCH-SKU-PROCESSING    19280016
                                ELSE                                    19290016
                                   PERFORM 2300-PURCH-VNDR-PROCESSING   19300016
                                END-IF                                  19310016
                             END-IF                                     19320016
                          END-IF                                        19330016
                       END-IF                                           19340016
                    END-IF                                              19350016
NHOLD$            END-IF                                                19360016
W34517          END-IF                                                  19370016
W32898         END-IF                                                   19380016
W34309       END-IF                                                     19390016
ZEROD      END-IF.                                                      19400016
           PERFORM 9000-READ-PURCH-FILE.                                19410016
      ******************************************************************19420016
      *  DO SKU LEVEL LOOKUP FOR PURCHASE ADJUSTMENTS                   19430016
      ******************************************************************19440016
W28582                                                                  19450016
W28582 2100-PURCH-SKU-PROCESSING.                                       19460016
W34517     SET BV101-PV-BOM-NOT-FOUND                                   19470016
W34517         PS-BOM-ATTR-NOT-EQUAL                                    19480016
W34517         PS-PURCH-SKU-YES         TO TRUE.                        19490016
W34517     IF ML030-PURCH-SKU NOT EQUAL ZEROES                          19500016
W34517         INITIALIZE BV101-PV-INPUT-AREA                           19510016
W34517         SET BV101-PV-SKU-LOOKUP TO TRUE                          19520016
W34517         MOVE ML030-PURCH-SKU            TO BV101-PV-SKU-IN       19530016
W34517         MOVE PV-PROCESS-DATE            TO BV101-PV-EFF-DTE-IN   19540016
W34517         MOVE ML030-PURCH-DEPT-NBR       TO BV101-PV-DEPT-IN-9    19550016
W34517         PERFORM BV101-LOOKUP-BOM                                 19560016
W34517         IF BV101-PV-BOM-FOUND                                    19570016
W34517             PERFORM 2110-CHECK-BOM-RESULT                        19580016
W34517             SET PS-PREV-FOUND-SKU TO TRUE                        19590016
W34517             IF BV101-BOM-ENT-ID-OUT = ML030-PURCH-ENT-ID AND     19600016
W34517                BV101-BOM-LBL-SEQ-NBR-OUT                         19610016
W34517                                     = ML030-PURCH-LBL-SEQ-NBR    19620016
W34517                 SET PS-BOM-ATTR-EQUAL TO TRUE                    19630016
W34517*                DISPLAY 'ML030-PURCH-ENT-ID   '                  19640016
W34517*                         ML030-PURCH-ENT-ID                      19650016
W34517*                DISPLAY 'ML030-PURCH-LBL-SEQ-NBR '               19660016
W34517*                         ML030-PURCH-LBL-SEQ-NBR                 19670016
W34517             ELSE                                                 19680016
W34517                 SET PS-BOM-ATTR-NOT-EQUAL TO TRUE                19690016
W34517             END-IF                                               19700016
W34517         ELSE                                                     19710016
W34517             SET PS-BOM-ATTR-NOT-EQUAL TO TRUE                    19720016
W34517*            DISPLAY 'BOM NOT FOUND'                              19730016
W34517             IF BV101-PV-INVALID-KEY-INPUT                        19740016
W34517                DISPLAY '**********************************'      19750016
W34517                DISPLAY '* ABEND: 2100-PURCH-SKU-PROCESSING'      19760016
W34517                DISPLAY '* BOM LOOKUP RETURN REASON:'             19770016
W34517                DISPLAY BV101-PV-RETURN-RSN                       19780016
W34517                DISPLAY '**********************************'      19790016
W34517                IF BV101-PV-BOM-SQL-ERROR                         19800016
W34517                    PERFORM 9998-SQL-ABEND                        19810016
W34517                ELSE                                              19820016
W34517                    PERFORM 9999-OTHER-ABEND                      19830016
W34517                END-IF                                            19840016
W34517             END-IF                                               19850016
W34517         END-IF                                                   19860016
W34517     ELSE                                                         19870016
W34517         SET BV101-PV-BOM-NOT-FOUND TO TRUE                       19880016
W34517     END-IF.                                                      19890016
W34517     IF BV101-PV-BOM-FOUND                                        19900016
W34517        SET PS-PREV-FOUND-SKU TO TRUE                             19910016
W34517        PERFORM 9400-WRITE-PURCH-REC                              19920016
W34517     ELSE                                                         19930016
W28582        INITIALIZE IN402-PV-INPUT-AREA                            19940016
W28582        SET IN402-PV-SKU-ATTRIB-LOOK TO TRUE                      19950016
W28582        MOVE ML030-PURCH-FIN-LIAB-DTE TO IN402-PV-EFF-DTE-IN      19960016
W28582        MOVE ML030-PURCH-SKU       TO IN402-PV-SKU-IN             19970016
W28582        MOVE '00000'               TO IN402-PV-LOC-IN             19980016
W28582        MOVE ML030-PURCH-DEPT-NBR  TO IN402-PV-DEPT-IN-9          19990016
JAS           MOVE ML030-PURCH-ENT-ID    TO IN402-PV-ENT-ID-IN-9        20000016
W28582        IF ML030-PURCH-SKU NOT EQUAL ZEROES                       20010016
W28582           PERFORM IN402-LOOKUP-RETAIL                            20020016
W28582        END-IF                                                    20030016
W28582        IF (IN402-PV-DBV-FOUND OR ML030-PURCH-SKU EQUAL ZEROES OR 20040016
W28582           ML030-PURCH-SKU EQUAL SPACES)                          20050016
W28582                      AND                                         20060016
W28582           (ML030-PURCH-DEPT-NBR = IN402-ATT-DEPT-OUT)            20070016
W28582           IF BV003-UNKNOWN-INS                                   20080016
W28582              PERFORM 8200-COMMIT                                 20090016
W28582           END-IF                                                 20100016
W28582           IF IN402-PV-DUMMY-SKU-VALID OR                         20110016
W28582              ML030-PURCH-SKU EQUAL ZEROES OR                     20120016
W28582              ML030-PURCH-SKU EQUAL SPACES                        20130016
W28582              IF ML030-PURCH-ENT-ID EQUAL SPACES OR               20140016
W28582                 ML030-PURCH-ENT-ID EQUAL ZERO                    20150016
W28582                 IF IN402-VND-ENT-ID-OUT NOT EQUAL ZERO           20160016
W28582                    MOVE IN402-VND-ENT-ID-OUT TO PV-DB2-ENT-ID    20170016
W28582                 ELSE                                             20180016
W28582                    MOVE PC-UNKNOWN-VENDOR TO PV-DB2-ENT-ID       20190016
W28582                 END-IF                                           20200016
W28582              ELSE                                                20210016
W28582                 MOVE ML030-PURCH-ENT-ID TO PV-DB2-ENT-ID         20220016
W28582              END-IF                                              20230016
W28582              MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR        20240016
W28582              PERFORM 7020-GET-MAX-RCPT-GRO-CST-PCT               20250016
W28582              SET PS-PRRTN-FOR-PURCH TO TRUE                      20260016
W28582              PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                20270016
W28582           ELSE                                                   20280016
NHOLD$              SET PS-PREV-FOUND-SKU TO TRUE                       20290016
W34517              PERFORM 8500-INSERT-BOM                             20300016
W28582              MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                 20310016
W28582                   PAOUT-PURCH-ML-LWST-ID                         20320016
W28582              MOVE IN402-VND-LBL-SEQ-NBR TO                       20330016
W28582                   PAOUT-PURCH-LBL-SEQ-NBR                        20340016
W28582              MOVE IN402-VND-ENT-ID-OUT   TO                      20350016
W28582                   PAOUT-PURCH-ENT-ID                             20360016
W28582              PERFORM 9400-WRITE-PURCH-REC                        20370016
W28582           END-IF                                                 20380016
W28582        ELSE                                                      20390016
W28582           DISPLAY 'ERROR LOOKING UP VENDOR/BRAND WITH SKU: '     20400016
W28582                    IN402-PV-SKU-IN                               20410016
W28582           MOVE 'PUR' TO ML205-ML-TRANSACTION                     20420016
W28582           MOVE IN402-VND-LBL-SEQ-NBR TO ML205-ML-VND-LBL-SEQ-NBR 20430016
W28582           IF IN402-PV-RETURN-RSN = SPACES                        20440016
W28582              CONTINUE                                            20450016
W28582           ELSE                                                   20460016
W28582              MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE           20470016
W28582           END-IF                                                 20480016
W28582           MOVE ML030-PURCH-RECORD TO ML205-ML-ERROR-INPUT-REC    20490016
W28582           WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD             20500016
W28582                                                                  20510016
W28582           MOVE SPACES TO BV-PURCH-AUDIT-REC                      20520016
W28582           WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-ERROR-LINE     20530016
W28582               AFTER ADVANCING 1 LINES                            20540016
W28582           ADD 1 TO PV-LINE-COUNTER                               20550016
W34517*? INSERT IF ERROR LOOKING UP BV IN PRICING MODULE ??             20560016
W34517           PERFORM 8500-INSERT-BOM                                20570016
W28582           MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                    20580016
W28582                PAOUT-PURCH-ML-LWST-ID                            20590016
W28582           MOVE IN402-VND-LBL-SEQ-NBR TO                          20600016
W28582                PAOUT-PURCH-LBL-SEQ-NBR                           20610016
W28582           MOVE IN402-VND-ENT-ID-OUT   TO                         20620016
W28582                PAOUT-PURCH-ENT-ID                                20630016
W28582           PERFORM 9400-WRITE-PURCH-REC                           20640016
W28582        END-IF                                                    20650016
W34517     END-IF.                                                      20660016
W34517******************************************************************20670016
W34517*  GET BRAND VENDOR RELATIONSHIP ID (DKEY) FOR BEGINNING-OF-MONTH 20680016
W34517*  VENDOR AND BRAND.                                              20690016
W34517******************************************************************20700016
W34517                                                                  20710016
W34517 2110-CHECK-BOM-RESULT.                                           20720016
W34517     MOVE BV101-PV-DEPT-IN-9        TO PV-DISP-DEPT-NBR.          20730016
W34517     MOVE BV101-BOM-ENT-ID-OUT      TO PV-DISP-ENT-ID             20740016
W34517                                       BV003-PV-ENT-ID-OUT.       20750016
W34517     MOVE BV101-BOM-LBL-SEQ-NBR-OUT TO PV-DISP-LBL-SEQ-NBR        20760016
W34517                                       BV003-PV-BRAND-OUT.        20770016
W34517     MOVE BV101-BOM-LO-MDSE-LVL-ID-OUT                            20780016
W34517                                    TO PV-DISP-LO-MDSE-LVL-ID     20790016
W34517                                       BV003-PV-RLTNSHP-ID-OUT.   20800016
W34517                                                                  20810016
W34517     EVALUATE TRUE                                                20820016
W34517         WHEN BV101-PV-DKEY-FOUND-NO-EFF                          20830016
W34517             DISPLAY 'DKEY FOUND OUTSIDE EFF DATE'                20840016
W34517             DISPLAY 'SKU      ' BV101-PV-SKU-IN-NUM              20850016
W34517             DISPLAY 'BOM DATE ' BV101-BOM-FSCL-DTE-OUT           20860016
W34517             DISPLAY 'DEPT     ' PV-DISP-DEPT-NBR                 20870016
W34517             DISPLAY 'ENT ID   ' PV-DISP-ENT-ID                   20880016
W34517             DISPLAY 'LBL SEQ  ' PV-DISP-LBL-SEQ-NBR              20890016
W34517             DISPLAY 'DKEY     ' PV-DISP-LO-MDSE-LVL-ID           20900016
W34517         WHEN BV101-PV-DKEY-UNKN-BRAND                            20910016
W34517             DISPLAY 'DKEY FOUND UNKNOWN BRAND'                   20920016
W34517             DISPLAY 'SKU      ' BV101-PV-SKU-IN-NUM              20930016
W34517             DISPLAY 'BOM DATE ' BV101-BOM-FSCL-DTE-OUT           20940016
W34517             DISPLAY 'DEPT     ' PV-DISP-DEPT-NBR                 20950016
W34517             DISPLAY 'ENT ID   ' PV-DISP-ENT-ID                   20960016
W34517             DISPLAY 'LBL SEQ  ' PV-DISP-LBL-SEQ-NBR              20970016
W34517             DISPLAY 'DKEY     ' PV-DISP-LO-MDSE-LVL-ID           20980016
W34517         WHEN BV101-PV-DKEY-UNKN-UNKN                             20990016
W34517             DISPLAY 'DKEY FOUND UNKNOWN/UNKNOWN'                 21000016
W34517             DISPLAY 'SKU      ' BV101-PV-SKU-IN-NUM              21010016
W34517             DISPLAY 'BOM DATE ' BV101-BOM-FSCL-DTE-OUT           21020016
W34517             DISPLAY 'DEPT     ' PV-DISP-DEPT-NBR                 21030016
W34517             DISPLAY 'ENT ID   ' PV-DISP-ENT-ID                   21040016
W34517             DISPLAY 'LBL SEQ  ' PV-DISP-LBL-SEQ-NBR              21050016
W34517             DISPLAY 'DKEY     ' PV-DISP-LO-MDSE-LVL-ID           21060016
W34517         WHEN BV101-PV-DKEY-UNKN-NOT-FOUND                        21070016
W34517             DISPLAY 'DKEY UNKNOWN/UNKNOWN NOT FOUND'             21080016
W34517             DISPLAY 'SKU      ' BV101-PV-SKU-IN-NUM              21090016
W34517             DISPLAY 'BOM DATE ' BV101-BOM-FSCL-DTE-OUT           21100016
W34517             DISPLAY 'DEPT     ' PV-DISP-DEPT-NBR                 21110016
W34517             DISPLAY 'ENT ID   ' PV-DISP-ENT-ID                   21120016
W34517             DISPLAY 'LBL SEQ  ' PV-DISP-LBL-SEQ-NBR              21130016
W34517             DISPLAY 'DKEY     ' PV-DISP-LO-MDSE-LVL-ID           21140016
W34517     END-EVALUATE.                                                21150016
W34517                                                                  21160016
W34517                                                                  21170016
      ******************************************************************21180016
      *  PROCESS RTV FOR A DOC NUMBER, GROUPING BY ITEM NUMBER          21190016
      ******************************************************************21200016
       2200-PROCESS-PURCH-RTV-DOC.                                      21210016
W34517     SET BV101-PV-BOM-NOT-FOUND                                   21220016
W34517         PS-BOM-ATTR-NOT-EQUAL TO TRUE.                           21230016
NHOLD$     SET PS-PREV-RTV-DOC TO TRUE                                  21240016
           SET PS-DA-ALW-OR-RTV TO TRUE                                 21250016
P49767* AP SYSTEM RAN OUT OF 6 DIGIT DEBIT ORDER NUMBERS AND HENCE THEY 21260016
P49767* APPENDED THE TRANSACTION DATE ALONG WITH OLD DOC NBR TO REUSE   21270016
P49767* IT.THE NEW DOC NUMBER FOR RTV CONTAINS 2 PORTIONS THE ACTUAL    21280016
P49767* DEFECT ORDER ID FOLLOWED BY UNDERSCORE AND THE TRANS DATE.HENCE 21290016
P49767* WE ARE USING THE FIRST PART OF THE DOC NUMBER BEFORE '_'        21300016
P49767* AGAINST THE DEFECT ORDER ID IN THE TABLE TDFMEIT.               21310016
P49767     INITIALIZE PV-TEMP-COUNT.                                    21320016
P49767     INITIALIZE PV-TEMP-DOC-NBR.                                  21330016
P49767     MOVE ML030-PURCH-DOC-16-NBR TO PV-INSPT-STRING.              21340016
P49767     INSPECT PV-INSPT-STRING  REPLACING FIRST '_' BY SPACE.       21350016
P49767     INSPECT PV-INSPT-STRING  TALLYING PV-TEMP-COUNT              21360016
P49767             FOR CHARACTERS BEFORE INITIAL SPACE.                 21370016
C89593*                                                                 21380016
C89593*UPDATE CHANGE P49767 TO ALLOW FOR A VARIABLE LENGTH FOR THE      21390016
C89593*DOCUMENT NUMBER C89593                                           21400016
C89593     MOVE ML030-PURCH-DOC-16-NBR(1:PV-TEMP-COUNT)                 21410016
C89593                                TO PV-TEMP-DOC-NBR                21420016
           MOVE PV-TEMP-DOC-NBR       TO PV-DB2-RTV-DOC-NBR             21430016
P49767*GB  EVALUATE TRUE                                                21440016
P49767*GB    WHEN PV-TEMP-COUNT = 6                                     21450016
P49767*GB        MOVE ML030-PURCH-DOC-16-NBR(1:6) TO PV-TEMP-DOC-NBR    21460016
P49767*GB        MOVE PV-TEMP-DOC-NBR             TO PV-DB2-RTV-DOC-NBR 21470016
P49767*GB    WHEN PV-TEMP-COUNT = 8                                     21480016
P49767*GB        MOVE ML030-PURCH-DOC-16-NBR(1:8) TO PV-TEMP-DOC-NBR    21490016
P49767*GB        MOVE PV-TEMP-DOC-NBR             TO PV-DB2-RTV-DOC-NBR 21500016
P49767*GB    WHEN OTHER                                                 21510016
P49767*GB        DISPLAY 'INCORRECT DOC NUMBER FOR RTV TRANSACTION'     21511016
P49767*GB        DISPLAY 'PURCH-DOC-NBR:' ML030-PURCH-DOC-16-NBR        21512016
P49767*GB        PERFORM 9999-OTHER-ABEND                               21513016
P49767*GB  END-EVALUATE.                                                21514016
P49767*    MOVE ML030-PURCH-DOC-16-NBR TO PV-DB2-RTV-DOC-NBR.           21515016
RONNAZ*  GET THE TOTAL DOLLARS FROM THE TDFMEIT TABLE                   21516016
RONNAZ*  FOR THE RTV DOC NUMBER TO DETERMINE IF THE DOLLARS             21517016
RONNAZ*  MATCH THE INPUT RECORD.  WHEN THE DOLLARS MATCH, THEN          21518016
RONNAZ*  FOLLOW LOGIC OF THE RTV DOC NUMBER TO BE FOUND.  WHEN THE      21519016
RONNAZ*  DOLLARS DO NOT MATCH FOLLOW LOGIC TO WHERE THE DOC NUMBER      21520016
RONNAZ*  IS NOT FOUND (RESULTING IN AN EVEN PRORATION OF THE BRAND      21520116
RONNAZ*  VENDOR FOR THE TRANSACTION)                                    21520216
RONNAZ     SET PS-PURCH-RTV-TTL-MATCH-NO TO TRUE.                       21520316
RONNAZ     MOVE ML030-PURCH-DEPT-NBR     TO DFMEIT-MDSE-DEPT-NBR.       21520416
RONNAZ     MOVE ML030-PURCH-CLASS-NBR    TO DFMEIT-MDSE-CLASS-NBR.      21520516
RONNAZ                                                                  21520616
RONNAZ     PERFORM 2220-PRE-CHECK-RTV.                                  21520716
RONNAW     PERFORM 2230-PRE-CHECK-RTV-ZERO-ITM.                         21520825
RONNAW*    WHEN THERE IS NO DOLLAR MATCH FOUND                          21520925
RONNAW*    OR IF ALL OF THE ITEM NUMBERS ON THE TDFMEIT TABLE ARE ZERO  21521025
RONNAW*    THEN FORCE AND END RESULT OF PRORATION OF THE BRAND          21521125
RONNAW*    TO THE 13 WK TABLE OR EVEN PRORATION                         21521225
RONNAW     IF PS-PURCH-RTV-TTL-MATCH-NO OR                              21521325
RONNAW       (PV-DFMEIT-ITEM-NBR-ZERO-COUNT >= 1 AND                    21521425
RONNAW        PV-DFMEIT-ITEM-NBR-COUNT = 1)                             21521525
290824*      WHEN TOTALS DO NOT MATCH INPUT RECORD MOVE ZEROS TO        21522416
290824*      PV-DB2-RTV-DOC-NBR SO THE END RESULT WILL BE AN            21522516
290824*      EVEN PRORATION OF THE BV                                   21522616
290824       MOVE ZEROES                 TO PV-DB2-RTV-DOC-NBR          21522716
RONNAZ       DISPLAY 'ML030-PURCH-DOC-16-NBR :' ML030-PURCH-DOC-16-NBR  21522816
RONNAZ       DISPLAY 'RTV NUMBER IN TDFMEIT TOTALS DO NOT MATCH'        21522916
RONNAZ       DISPLAY 'INPUT RECORD FROM AP.       '                     21523016
RONNAZ       DISPLAY ML030-PURCH-RECORD                                 21523116
RONNAZ     ELSE                                                         21523216
RONNAZ*    WHEN TOTALS DO MATCH THEN SAVE OFF THE DOLLARS FROM THE      21523316
RONNAZ*    INPUT RECORD TO BE USED IN THE CALCULATIONS FOR              21523416
RONNAZ*    DISBURSEMENT.  NOTE THAT THE ONLY DOLLAR FIELDS ON THE       21523516
RONNAZ*    TDFMEIT TABLE ARE FOR THE PURCH-EXTD-NET-COST-AMT AND THE    21523616
RONNAZ*    PURCH-EXTD-RTL-AMT.  THERE COULD ALSO BE DOLLARS IN THE      21523716
RONNAZ*    PURCH-EXT-GRO-COST-AMT, PURCH-RGT-AMT, AND PURCH-DISC-AMT    21523816
RONNAZ*    AND THOSE WILL BE DISBURSED AT THE ITEM LEVEL BASED OFF      21523916
RONNAZ*    A PERCENTAGE OF THE DOLLAR IN THE TDFMEIT TABLE              21524016
RONNAZ*    DIVIDED BY THE ML030-PURCH-EXT-NET-COST-AMT IN THE INPUT     21524116
RONNAZ*    RECORD.                                                      21524216
RONNAZ*    MOVE THE INPUT RECORD VALUES TO PROGRAM VARIABLE INPUT       21524316
RONNAZ*    FIELDS AND SET ACCUMULATER FIELDS TO ZERO TO BE USED         21524416
RONNAZ*    TO DETERMINE IF THERE ARE ANY REMAINING CENTS THAT WOULD     21524516
RONNAZ*    NEED TO GET ACCOUNTED FOR.                                   21524616
RONNAZ*    ****                                                         21524716
RONNAZ       MOVE ML030-PURCH-EXTD-GRO-COST-AMT TO                      21524816
RONNAZ            PV-IN-PURCH-EXTD-GRO-COST-AMT                         21524916
RONNAZ       MOVE ML030-PURCH-FRGT-AMT          TO                      21525016
RONNAZ            PV-IN-PURCH-FRGT-AMT                                  21525116
RONNAZ       MOVE ML030-PURCH-DISC-AMT          TO                      21525216
RONNAZ            PV-IN-PURCH-DISC-AMT                                  21525316
RONNAZ       MOVE ML030-PURCH-EXTD-NET-COST-AMT TO                      21525416
RONNAZ            PV-IN-PURCH-EXTD-NET-COST-AMT                         21525516
RONNAZ       MOVE ML030-PURCH-EXTD-RTL-AMT      TO                      21525616
RONNAZ            PV-IN-PURCH-EXTD-RTL-AMT                              21525716
RONNAZ       MOVE ZEROS                         TO                      21525816
RONNAZ            PV-AC-PURCH-EXTD-GRO-COST-AMT                         21525916
RONNAZ            PV-AC-PURCH-FRGT-AMT                                  21526016
RONNAZ            PV-AC-PURCH-DISC-AMT                                  21526116
RONNAZ            PV-AC-PURCH-EXTD-NET-COST-AMT                         21526216
RONNAZ            PV-AC-PURCH-EXTD-RTL-AMT                              21526316
RONNAZ            PV-TOTAL-EXTD-GRO-COST-AMT                            21526416
RONNAZ            PV-TOTAL-FRGT-AMT                                     21526516
RONNAZ            PV-TOTAL-DISC-AMT                                     21526616
RONNAZ            PV-TOTAL-EXTD-NET-COST-AMT                            21526716
RONNAZ            PV-TOTAL-EXTD-RTL-AMT                                 21526816
RONNAZ     END-IF.                                                      21526916
RONNAZ     MOVE ML030-PURCH-DEPT-NBR TO DFMEIT-MDSE-DEPT-NBR.           21527016
           SET PS-MORE-RTV-RECORDS TO TRUE.                             21527116
           INITIALIZE PV-RTV-COUNT.                                     21527216
           PERFORM 8000-OPEN-RTV-DOC-CSR.                               21527316
           PERFORM 8010-FETCH-RTV-DOC-CSR.                              21527416
RONNAW*    SET SWITCH FOR CHECKING IF THE LOOKUP OF THE RTV DOC 16      21527525
RONNAW*    ITEM IS FOUND IN THE XMT_BOM_SKU_ATTR TABLE AT LEAST ONCE    21527625
RONNAW*    TURN IT OFF HERE, AND IT WILL GET TURNED ON IN 2210*         21527725
RONNAW*    PROCESSING WHEN ATTRIBUTES ARE FOUND FOR AT LEAST ONE ITEM   21527825
RONNAW*    BECAUSE IF NO ATTRIBUTES ARE FOUND THEN THE PV-RTV-COUNT     21527925
RONNAW*    NEEDS TO BE RESET BACK TO 0, SO THAT THE 13 WEEK TABLE       21528025
RONNAW*    OR EVERN PRORATION OCCURS.                                   21528125
RONNAW     SET PS-PURCH-RTV-DOC16-BOM-NO TO TRUE.                       21528225
           PERFORM 2210-PROCESS-RTV-DOC-RECS                            21528316
             UNTIL PS-NO-MORE-RTV-RECORDS.                              21528416
RONNAW*    WHEN PS-PURCH-RTV-DOC16-BOM-YES (AT LEASTE ONE BOM FOUND)    21528525
RONNAW     IF PS-PURCH-RTV-DOC16-BOM-YES                                21528625
RONNAZ*       CHECK TO SEE THAT THE ACCUMLATED FIELD MATCHING THE       21528725
RONNAZ*       INPUT RECORD, AND IF IT DOESN'T ADD UP DISPLAY            21528825
RONNAZ*       THE DIFFERENCES HERE                                      21528925
RONNAZ*       IN THEORY THIS SHOULD NOT HAPPEN BUT WAS CODED TO HELP    21529025
RONNAZ*       PROVIDE A CHECK                                           21529125
RONNAZ        IF (PV-IN-PURCH-EXTD-GRO-COST-AMT =                       21529225
RONNAZ            PV-AC-PURCH-EXTD-GRO-COST-AMT) AND                    21529325
RONNAZ           (PV-IN-PURCH-FRGT-AMT          =                       21529425
RONNAZ            PV-AC-PURCH-FRGT-AMT)          AND                    21529525
RONNAZ           (PV-IN-PURCH-DISC-AMT          =                       21529625
RONNAZ            PV-AC-PURCH-DISC-AMT)          AND                    21529725
RONNAZ           (PV-IN-PURCH-EXTD-NET-COST-AMT =                       21529825
RONNAZ            PV-AC-PURCH-EXTD-NET-COST-AMT) AND                    21529925
RONNAZ           (PV-IN-PURCH-EXTD-RTL-AMT      =                       21530025
RONNAZ            PV-AC-PURCH-EXTD-RTL-AMT)                             21530125
RONNAZ           NEXT SENTENCE                                          21530225
RONNAZ        ELSE                                                      21530325
RONNAZ           DISPLAY 'RTV INPUT AND OUTPUT DOLLARS ARE OFF'         21530425
RONNAZ           DISPLAY 'ML030-DOC-16-NBR: ' ML030-PURCH-DOC-16-NBR    21530525
RONNAZ           DISPLAY 'PV-IN-PURCH-EXTD-GRO-COST-AMT: '              21530625
RONNAZ                    PV-IN-PURCH-EXTD-GRO-COST-AMT                 21530725
RONNAZ           DISPLAY 'PV-AC-PURCH-EXTD-GRO-COST-AMT: '              21530825
RONNAZ                    PV-AC-PURCH-EXTD-GRO-COST-AMT                 21530925
RONNAZ           DISPLAY 'PV-IN-PURCH-FRGT-AMT         : '              21531025
RONNAZ                    PV-IN-PURCH-FRGT-AMT                          21531125
RONNAZ           DISPLAY 'PV-AC-PURCH-FRGT-AMT         : '              21531225
RONNAZ                    PV-AC-PURCH-FRGT-AMT                          21531325
RONNAZ           DISPLAY 'PV-IN-PURCH-DISC-AMT         : '              21531425
RONNAZ                    PV-IN-PURCH-DISC-AMT                          21531525
RONNAZ           DISPLAY 'PV-AC-PURCH-DISC-AMT         : '              21531625
RONNAZ                    PV-AC-PURCH-DISC-AMT                          21531725
RONNAZ           DISPLAY 'PV-IN-PURCH-EXTD-NET-COST-AMT: '              21531825
RONNAZ                    PV-IN-PURCH-EXTD-NET-COST-AMT                 21531925
RONNAZ           DISPLAY 'PV-AC-PURCH-EXTD-NET-COST-AMT: '              21532025
RONNAZ                    PV-AC-PURCH-EXTD-NET-COST-AMT                 21532125
RONNAZ           DISPLAY 'PV-IN-PURCH-EXTD-RTL-AMT     : '              21532225
RONNAZ                    PV-IN-PURCH-EXTD-RTL-AMT                      21532325
RONNAZ           DISPLAY 'PV-AC-PURCH-EXTD-RTL-AMT     : '              21532425
RONNAZ                    PV-AC-PURCH-EXTD-RTL-AMT                      21532525
RONNAZ        END-IF                                                    21532625
RONNAW     ELSE                                                         21532725
RONNAW        MOVE 0 TO PV-RTV-COUNT                                    21532825
RONNAW        DISPLAY 'NO VALID ITEM FOR DOC16 NUMBER'                  21532925
RONNAW     END-IF.                                                      21533025
RONNAZ                                                                  21533116
           PERFORM 8020-CLOSE-RTV-DOC-CSR.                              21533216
RONNAW* IF NO RECORDS ARE FOUND ON THE RTV CURSOR, OR NO BOM FOUND      21533325
RONNAW* FOR ANY OF THE ITEMS IN THE RTV CURSOR, WE NEED TO PRORATE      21533425
      * EVENLY.                                                         21533616
RONNAZ* UPDATING COMMENT HERE TO CLARIFY THAT THE 13 WK TABLE           21533716
RONNAZ* IS USED TO LOOK UP THE BRANDS FOR THE VENDOR'S RECEIPT          21533816
RONNAZ* ACTIVITY PERCENTAGES FOR THE PRORATION OF THE BRANDS            21533916
RONNAZ* UNDER THE VENDOR.  IF THERE IS NOTHING IN THE 13 WEEK TABLE     21534016
RONNAZ* THEN THE BRANDS WILL GET EVENLY PRO-RATED.                      21534116
           IF PV-RTV-COUNT EQUAL ZERO                                   21534216
              MOVE ML030-PURCH-ENT-ID   TO PV-DB2-ENT-ID                21534316
              MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR              21534416
              PERFORM 7030-GET-MAX-PADJ-RTV-COST-PCT                    21534516
              SET PS-PRRTN-FOR-PURCH TO TRUE                            21534616
              PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                      21534716
W34517        ADD 1 TO PV-TOT-RTV-COUNT-ZERO                            21534816
W34517     ELSE                                                         21534916
W34517        ADD 1 TO PV-TOT-RTV-COUNT-NOT-ZERO                        21535016
           END-IF.                                                      21535116
      ******************************************************************21535216
      *  PROCESS ALL THE RECORDS IN THE RTV DOCUMENT CURSOR.            21535316
      ******************************************************************21535416
W28582 2210-PROCESS-RTV-DOC-RECS.                                       21536016
W34517     SET BV101-PV-BOM-NOT-FOUND                                   21537016
W34517         PS-BOM-ATTR-NOT-EQUAL                                    21538016
W34517         PS-PURCH-RTV-YES TO TRUE.                                21539016
W34517     IF DFMEIT-DFCT-ITEM-NBR NOT EQUAL ZEROES                     21540016
W34517         INITIALIZE BV101-PV-INPUT-AREA                           21550016
W34517         SET BV101-PV-ITM-LOOKUP TO TRUE                          21560016
W34517         MOVE DFMEIT-DFCT-ITEM-NBR       TO BV101-PV-ITM-NBR-IN   21570016
W34517         MOVE PV-PROCESS-DATE            TO BV101-PV-EFF-DTE-IN   21580016
W34517         MOVE ML030-PURCH-DEPT-NBR       TO BV101-PV-DEPT-IN-9    21590016
W34517         PERFORM BV101-LOOKUP-BOM                                 21600016
W34517         IF BV101-PV-BOM-FOUND                                    21610016
RONNAW             SET PS-PURCH-RTV-DOC16-BOM-YES TO TRUE               21611025
W34517             PERFORM 2110-CHECK-BOM-RESULT                        21620016
W34517             IF BV101-BOM-ENT-ID-OUT = ML030-PURCH-ENT-ID AND     21630016
W34517                BV101-BOM-LBL-SEQ-NBR-OUT                         21640016
W34517                                     = ML030-PURCH-LBL-SEQ-NBR    21650016
W34517                 SET PS-BOM-ATTR-EQUAL TO TRUE                    21660016
W34517             ELSE                                                 21670016
W34517                 SET PS-BOM-ATTR-NOT-EQUAL TO TRUE                21680016
W34517*                DISPLAY 'BOM-ATTR-NOT-EQUAL'                     21690016
W34517             END-IF                                               21700016
W34517         ELSE                                                     21710016
W34517             SET PS-BOM-ATTR-NOT-EQUAL TO TRUE                    21720016
W34517*            DISPLAY 'BOM NOT FOUND'                              21730016
W34517             IF BV101-PV-INVALID-KEY-INPUT                        21740016
W34517                DISPLAY '**********************************'      21750016
W34517                DISPLAY '* ABEND: 2210-PROCESS-RTV-DOC-RECS'      21760016
W34517                DISPLAY '* BOM LOOKUP RETURN REASON:'             21770016
W34517                DISPLAY BV101-PV-RETURN-RSN                       21780016
W34517                DISPLAY '**********************************'      21790016
W34517                IF BV101-PV-BOM-SQL-ERROR                         21800016
W34517                    PERFORM 9998-SQL-ABEND                        21810016
W34517                ELSE                                              21820016
W34517                    PERFORM 9999-OTHER-ABEND                      21830016
W34517                END-IF                                            21840016
W34517             END-IF                                               21850016
W34517         END-IF                                                   21860016
W34517     ELSE                                                         21870016
W34517         SET BV101-PV-BOM-NOT-FOUND TO TRUE                       21880016
W34517     END-IF.                                                      21890016
W34517     IF BV101-PV-BOM-FOUND                                        21900016
RONNAZ*       IF THIS IS THE LAST ITEM FETCHED THEN COMPUTE THE         21910016
RONNAZ*       REMAINING AMOUNT OF THE INPUT RECORD INTO THE             21920016
RONNAZ*       BUCKETS                                                   21930016
RONNAZ        IF PV-RTV-COUNT = PV-DFMEIT-ITEM-NBR-COUNT                21940016
RONNAZ*          ACCUMULATED TOTAL AND SUBTRACT THAT FROM THE           21941024
RONNAZ*          IN TOTAL TO GET THE REMAINING DIFFERENCE               21942024
RONNAZ*          AND EVERYTHING THAT WAS UNKNOWN WILL GO TO THE         21943024
RONNAZ*          LAST ITEM BRAND VENDOR                                 21944024
RONNAZ           PERFORM 2420-PURCH-PRRTN-LAST                          21950016
RONNAZ           PERFORM 9400-WRITE-PURCH-REC                           21960016
RONNAZ*          ADD THE REMAINDER OF THE AMOUNTS TO THE TOTALS         21970016
RONNAZ           ADD     PAOUT-PURCH-EXTD-NET-COST-AMT TO               21980016
RONNAZ                   PV-AC-PURCH-EXTD-NET-COST-AMT                  21990016
RONNAZ                   PV-TOTAL-EXTD-NET-COST-AMT                     22000016
RONNAZ           ADD     PAOUT-PURCH-EXTD-RTL-AMT      TO               22001016
RONNAZ                   PV-AC-PURCH-EXTD-RTL-AMT                       22002016
RONNAZ                   PV-TOTAL-EXTD-RTL-AMT                          22003016
RONNAZ           ADD     PAOUT-PURCH-EXTD-GRO-COST-AMT TO               22004016
RONNAZ                   PV-AC-PURCH-EXTD-GRO-COST-AMT                  22005016
RONNAZ                   PV-TOTAL-EXTD-GRO-COST-AMT                     22006016
RONNAZ           ADD     PAOUT-PURCH-FRGT-AMT          TO               22007016
RONNAZ                   PV-AC-PURCH-FRGT-AMT                           22008016
RONNAZ                   PV-TOTAL-FRGT-AMT                              22009016
RONNAZ           ADD     PAOUT-PURCH-DISC-AMT          TO               22010016
RONNAZ                   PV-AC-PURCH-DISC-AMT                           22010116
RONNAZ                   PV-TOTAL-DISC-AMT                              22010216
RONNAZ        ELSE                                                      22010316
RONNAZ*1         NEEDED TO ADD CODE TO MAKE THE VALUES FROM THE TDFMEIT 22010416
RONNAZ*1         FOR THE ITEM/SKU                                       22010516
RONNAZ*1         MOVE VALUES TO PAOUT-* FIELDS BECAUSE 9400-* USES      22010616
RONNAZ*1         THE PAOUT*  FIELDS                                     22010716
RONNAZ*1         NOTE THAT THE ML030* INPUT VALUES HAVE BEEN            22010816
RONNAZ*1         SAVED OFF IN PV-IN* FIELDS                             22010916
RONNAZ           MOVE DFMEIT-UNIT-COST-AMT                              22011016
RONNAZ                        TO PAOUT-PURCH-EXTD-NET-COST-AMT          22011116
RONNAZ           MOVE DFMEIT-RTL-COST-AMT                               22011216
RONNAZ                        TO PAOUT-PURCH-EXTD-RTL-AMT               22011316
RONNAZ*1         FIGURE OUT THE PERCENTAGE OF THE NET COST AMOUNT       22011416
RONNAZ*1         AND USE THAT PERCENTAGE FOR THE PURCH-FRGT-AMT         22011516
RONNAZ*1         THE PURCH-DISC-AMT AND EXTD-GRO-COST-AMT               22011616
RONNAZ           COMPUTE PV-PRORATION-PCT        ROUNDED EQUAL          22011716
RONNAZ                   DFMEIT-UNIT-COST-AMT / PV-SUM-UNIT-COST-AMT    22011816
RONNAZ           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL    22011916
RONNAZ                   PV-IN-PURCH-EXTD-GRO-COST-AMT *                22012016
RONNAZ                   PV-PRORATION-PCT                               22012116
RONNAZ           COMPUTE PAOUT-PURCH-FRGT-AMT          ROUNDED EQUAL    22012216
RONNAZ                   PV-IN-PURCH-FRGT-AMT *                         22012316
RONNAZ                   PV-PRORATION-PCT                               22012416
RONNAZ           COMPUTE PAOUT-PURCH-DISC-AMT          ROUNDED EQUAL    22012516
RONNAZ                   PV-IN-PURCH-DISC-AMT *                         22012616
RONNAZ                   PV-PRORATION-PCT                               22012716
RONNAZ*1         ADD DOLLARS TO THE ACCUMULATED FIELDS AND TOTALS       22012816
RONNAZ*          THAT WILL BE USED FOR THE LAST RECORD                  22012916
RONNAZ           ADD     PAOUT-PURCH-EXTD-NET-COST-AMT TO               22013016
RONNAZ                   PV-AC-PURCH-EXTD-NET-COST-AMT                  22013116
RONNAZ                   PV-TOTAL-EXTD-NET-COST-AMT                     22013216
RONNAZ           ADD     PAOUT-PURCH-EXTD-RTL-AMT      TO               22013316
RONNAZ                   PV-AC-PURCH-EXTD-RTL-AMT                       22013416
RONNAZ                   PV-TOTAL-EXTD-RTL-AMT                          22013516
RONNAZ           ADD     PAOUT-PURCH-EXTD-GRO-COST-AMT TO               22013616
RONNAZ                   PV-AC-PURCH-EXTD-GRO-COST-AMT                  22013716
RONNAZ                   PV-TOTAL-EXTD-GRO-COST-AMT                     22013816
RONNAZ           ADD     PAOUT-PURCH-FRGT-AMT          TO               22013916
RONNAZ                   PV-AC-PURCH-FRGT-AMT                           22014016
RONNAZ                   PV-TOTAL-FRGT-AMT                              22014116
RONNAZ           ADD     PAOUT-PURCH-DISC-AMT          TO               22014216
RONNAZ                   PV-AC-PURCH-DISC-AMT                           22014316
RONNAZ                   PV-TOTAL-DISC-AMT                              22014416
W34517           PERFORM 9400-WRITE-PURCH-REC                           22014516
RONNAZ        END-IF                                                    22014616
W34517     ELSE                                                         22014716
RONNAW*       THINK THIS IS WHEN ITEM NUMBER ISN'T FOUND OR IT IS       22014818
RONNAW*       ZEROS                                                     22014918
RONNAW*       JUST SKIP IT AND THE REMAINING DIFFERENCE WILL            22015018
RONNAW*       GET CALCULATED WHEN THE LAST TDFMEIT RECORD IS            22015118
RONNAW*       PROCESSED.                                                22015218
RONNAW        DISPLAY 'DFMEIT-DFCT-ITEM-NBR NOT FOUND'                  22015318
RONNAW        DISPLAY  DFMEIT-DFCT-ITEM-NBR                             22015418
RONNAZ*       IF THIS IS THE LAST ITEM FETCHED THEN COMPUTE THE         22015524
RONNAZ*       REMAINING AMOUNT OF THE INPUT RECORD INTO THE             22015624
RONNAZ*       BUCKETS ONLY WHEN THERE IS AT LEAST ONE BOM ATTR FOUND    22015725
RONNAW*       WHEN NO BOM FOUND FOR AN ITEM CONTINUE PROCESSING         22015825
RONNAW*       TO FALL THROUGH AND USE 13 WEEK OR EVEN PRORATION         22015925
RONNAW        IF PS-PURCH-RTV-DOC16-BOM-NO                              22016025
RONNAW           CONTINUE                                               22016125
RONNAW        ELSE                                                      22016225
RONNAW           IF PV-RTV-COUNT = PV-DFMEIT-ITEM-NBR-COUNT             22016325
RONNAW              DISPLAY 'LAST CURSOR RECORD '                       22016425
RONNAW              DISPLAY 'REMAINING DIFFERENCE GOES TO THE LAST '    22016525
RONNAW              DISPLAY 'BRAND VENDOR                          '    22016625
RONNAW*             ACCUMULATED TOTAL AND SUBTRACT THAT FROM THE        22016725
RONNAW*             IN TOTAL TO GET THE REMAINING DIFFERENCE            22016825
RONNAW*             AND EVERYTHING THAT WAS UNKNOWN WILL GO TO THE      22016925
RONNAW*             LAST ITEM BRAND VENDOR                              22017025
RONNAW              PERFORM 2420-PURCH-PRRTN-LAST                       22017125
RONNAW              PERFORM 9400-WRITE-PURCH-REC                        22017225
RONNAW*             ADD THE REMAINDER OF THE AMOUNTS TO THE TOTALS      22017325
RONNAW              ADD     PAOUT-PURCH-EXTD-NET-COST-AMT TO            22017425
RONNAW                      PV-AC-PURCH-EXTD-NET-COST-AMT               22017525
RONNAW                      PV-TOTAL-EXTD-NET-COST-AMT                  22017625
RONNAW              ADD     PAOUT-PURCH-EXTD-RTL-AMT      TO            22017725
RONNAW                      PV-AC-PURCH-EXTD-RTL-AMT                    22017825
RONNAW                      PV-TOTAL-EXTD-RTL-AMT                       22017925
RONNAW              ADD     PAOUT-PURCH-EXTD-GRO-COST-AMT TO            22018025
RONNAW                      PV-AC-PURCH-EXTD-GRO-COST-AMT               22018125
RONNAW                      PV-TOTAL-EXTD-GRO-COST-AMT                  22018225
RONNAW              ADD     PAOUT-PURCH-FRGT-AMT          TO            22018325
RONNAW                      PV-AC-PURCH-FRGT-AMT                        22018425
RONNAW                      PV-TOTAL-FRGT-AMT                           22018525
RONNAW              ADD     PAOUT-PURCH-DISC-AMT          TO            22018625
RONNAW                      PV-AC-PURCH-DISC-AMT                        22018725
RONNAW                      PV-TOTAL-DISC-AMT                           22018825
RONNAW* COMMENT OUT THE REMAINING LOGIC                                 22018925
RONNAW***                                                               22022024
W28582***     INITIALIZE IN402-PV-INPUT-AREA                            22022124
W28582***     SET IN402-PV-ITEM-ATTRIB-LOOK TO TRUE                     22022224
W28582***     MOVE DFMEIT-DFCT-ITEM-NBR  TO IN402-PV-ITM-NBR-IN         22022324
W28582***     MOVE ML030-PURCH-FIN-LIAB-DTE TO IN402-PV-EFF-DTE-IN      22022424
W28582***     PERFORM IN402-LOOKUP-RETAIL                               22022524
W28582***     IF IN402-PV-DBV-FOUND OR                                  22022624
W28582***        DFMEIT-DFCT-ITEM-NBR EQUAL ZEROES                      22022724
W28582***        IF BV003-UNKNOWN-INS                                   22023017
W28582***           PERFORM 8200-COMMIT                                 22030017
W28582***        END-IF                                                 22040017
W28582***        IF DFMEIT-DFCT-ITEM-NBR EQUAL ZEROES                   22050017
W28582***           IF ML030-PURCH-ENT-ID EQUAL SPACES OR               22060017
W28582***              ML030-PURCH-ENT-ID EQUAL ZERO                    22070017
W28582***              IF BV003-PV-ENT-ID-OUT NOT EQUAL ZERO            22080017
W28582***                 MOVE BV003-PV-ENT-ID-OUT TO PV-DB2-ENT-ID     22090017
W28582***              ELSE                                             22100017
W28582***                 MOVE PC-UNKNOWN-VENDOR TO PV-DB2-ENT-ID       22110017
W28582***              END-IF                                           22120017
W28582***           ELSE                                                22130017
W28582***              MOVE ML030-PURCH-ENT-ID TO PV-DB2-ENT-ID         22140017
W28582***           END-IF                                              22150017
W28582***           MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR        22160017
W28582***           PERFORM 7030-GET-MAX-PADJ-RTV-COST-PCT              22170017
W28582***           SET PS-PRRTN-FOR-PURCH TO TRUE                      22180017
W28582***           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                22190017
W28582***        ELSE                                                   22200017
W28582***           MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                 22210017
W28582***                PAOUT-PURCH-ML-LWST-ID                         22220017
W28582***           MOVE IN402-VND-LBL-SEQ-NBR    TO                    22230017
W28582***                PAOUT-PURCH-LBL-SEQ-NBR                        22240017
W28582***           MOVE IN402-VND-ENT-ID-OUT     TO                    22250017
W28582***                PAOUT-PURCH-ENT-ID                             22260017
W28582***          MOVE DFMEIT-RTL-COST-AMT       TO                    22270017
W28582***               PAOUT-PURCH-EXTD-RTL-AMT                        22280017
W28582***          MOVE DFMEIT-UNIT-COST-AMT      TO                    22290017
W28582***               PAOUT-PURCH-EXTD-GRO-COST-AMT                   22300017
W28582***               PAOUT-PURCH-EXTD-NET-COST-AMT                   22310017
W28582***          PERFORM 9400-WRITE-PURCH-REC                         22320017
W28582***        END-IF                                                 22330017
W28582***     ELSE                                                      22340017
W28582***        DISPLAY 'ERROR PERFORMING BRAND VENDOR LOOKUP '        22350017
W28582***        DISPLAY 'WITH ITEM NUMBER.'                            22360017
W28582***        MOVE 'PUR' TO ML205-ML-TRANSACTION                     22370017
W28582***        MOVE IN402-VND-LBL-SEQ-NBR TO ML205-ML-VND-LBL-SEQ-NBR 22380017
W28582***        IF IN402-PV-RETURN-RSN = SPACES                        22390017
W28582***           CONTINUE                                            22400017
W28582***        ELSE                                                   22410017
W28582***           MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE           22420017
W28582***        END-IF                                                 22430017
W28582***        MOVE ML030-PURCH-RECORD TO ML205-ML-ERROR-INPUT-REC    22440017
W28582***        WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD             22450017
W28582***        MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO                    22460017
W28582***             PAOUT-PURCH-ML-LWST-ID                            22470017
W28582***        MOVE IN402-VND-LBL-SEQ-NBR    TO                       22480017
W28582***             PAOUT-PURCH-LBL-SEQ-NBR                           22490017
W28582***        MOVE IN402-VND-ENT-ID-OUT     TO                       22500017
W28582***             PAOUT-PURCH-ENT-ID                                22510017
W28582***       MOVE DFMEIT-RTL-COST-AMT       TO                       22520017
W28582***            PAOUT-PURCH-EXTD-RTL-AMT                           22530017
W28582***       MOVE DFMEIT-UNIT-COST-AMT      TO                       22540017
W28582***            PAOUT-PURCH-EXTD-GRO-COST-AMT                      22550017
W28582***            PAOUT-PURCH-EXTD-NET-COST-AMT                      22560017
W28582***       PERFORM 9400-WRITE-PURCH-REC                            22570017
W28582***     END-IF                                                    22580017
RONNAW******END OF COMMENTING OUT CODE                                  22582025
RONNAW           END-IF                                                 22583025
RONNAW        END-IF                                                    22584025
W34517     END-IF.                                                      22590019
W28582                                                                  22600016
W28582     PERFORM 8010-FETCH-RTV-DOC-CSR.                              22610016
W28582                                                                  22620016
RONNAZ******************************************************************22630016
RONNAZ*  GET TOTALS FROM THE RTV TABLE TO CHECK AGAINST THE INPUT       22640016
RONNAZ*  RECORD                                                         22650016
RONNAZ******************************************************************22660016
RONNAZ 2220-PRE-CHECK-RTV.                                              22670016
RONNAZ                                                                  22680016
RONNAZ     INITIALIZE PV-DFMEIT-ITEM-NBR-COUNT                          22690016
RONNAZ                PV-SUM-RTL-COST-AMT                               22691016
RONNAZ                PV-SUM-UNIT-COST-AMT                              22692016
RONNAZ                PV-NULL                                           22693016
RONNAZ                PV-NULL2.                                         22694016
RONNAZ                                                                  22695016
RONNAZ     PERFORM                                                      22696016
RONNAZ         WITH TEST AFTER                                          22697016
RONNAZ         VARYING PV-RETRY-COUNTER                                 22698016
RONNAZ         FROM 1 BY 1                                              22699016
RONNAZ         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22700016
RONNAZ                   OR (SQLCODE = ZERO))                           22700116
RONNAZ         EXEC SQL                                                 22700216
RONNAZ            SELECT COUNT(DISTINCT(DFCT_ITEM_NBR))                 22700316
RONNAZ                  ,SUM(RTL_COST_AMT)                              22700416
RONNAZ                  ,SUM(UNIT_COST_AMT)                             22700516
RONNAZ            INTO   :PV-DFMEIT-ITEM-NBR-COUNT                      22700616
RONNAZ                  ,:PV-SUM-RTL-COST-AMT  :PV-NULL                 22700716
RONNAZ                  ,:PV-SUM-UNIT-COST-AMT :PV-NULL2                22700816
RONNAZ            FROM TDFMEIT                                          22700916
RONNAZ            WHERE DFCT_ORD_ID          = :PV-DB2-RTV-DOC-NBR      22701016
RONNAZ              AND MDSE_DEPT_NBR        = :DFMEIT-MDSE-DEPT-NBR    22701116
RONNAZ              AND MDSE_CLASS_NBR       = :DFMEIT-MDSE-CLASS-NBR   22701216
RONNAZ         END-EXEC                                                 22701316
RONNAZ                                                                  22701416
RONNAZ         EVALUATE TRUE                                            22701516
RONNAZ            WHEN SQLCODE = 0                                      22701616
RONNAZ                 IF PV-NULL EQUAL ZERO AND PV-NULL2 EQUAL ZERO    22701716
RONNAZ                    IF PV-SUM-RTL-COST-AMT =                      22701816
RONNAZ                                 ML030-PURCH-EXTD-RTL-AMT AND     22701916
RONNAZ                       PV-SUM-UNIT-COST-AMT =                     22702016
RONNAZ                                 ML030-PURCH-EXTD-GRO-COST-AMT    22702116
RONNAZ                       SET PS-PURCH-RTV-TTL-MATCH-YES TO TRUE     22702216
RONNAZ                    END-IF                                        22702316
RONNAZ                 END-IF                                           22702416
RONNAZ            WHEN SQLCODE = -904                                   22702516
RONNAZ            WHEN SQLCODE = -913                                   22702616
RONNAZ                 CONTINUE                                         22702716
RONNAZ            WHEN SQLWARN0 NOT = SPACES                            22702816
RONNAZ            WHEN SQLCODE < +0                                     22702916
RONNAZ            WHEN SQLCODE > +0                                     22703016
RONNAZ                 DISPLAY '2220-PRE-CHECK-RTV'                     22703116
RONNAZ                 DISPLAY 'PRE CHECK DOLLARS FROM RTV'             22703216
RONNAZ                 PERFORM 9998-SQL-ABEND                           22703316
RONNAZ         END-EVALUATE                                             22703416
RONNAZ     END-PERFORM.                                                 22703516
RONNAZ                                                                  22703616
RONNAZ     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22703716
RONNAZ        DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN STORE RETAIL PCT'  22703816
RONNAZ        PERFORM 9998-SQL-ABEND                                    22703916
RONNAZ     END-IF.                                                      22704016
RONNAZ                                                                  22704116
RONNAW******************************************************************22704224
RONNAW*  GET TOTALS FROM THE RTV TABLE TO CHECK AGAINST THE INPUT       22704324
RONNAW*  RECORD                                                         22704424
RONNAW******************************************************************22704524
RONNAW 2230-PRE-CHECK-RTV-ZERO-ITM.                                     22704624
RONNAW                                                                  22704724
RONNAW     INITIALIZE PV-DFMEIT-ITEM-NBR-ZERO-COUNT.                    22704824
RONNAW                                                                  22704924
RONNAW     PERFORM                                                      22705024
RONNAW         WITH TEST AFTER                                          22705124
RONNAW         VARYING PV-RETRY-COUNTER                                 22705224
RONNAW         FROM 1 BY 1                                              22705324
RONNAW         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               22705424
RONNAW                   OR (SQLCODE = ZERO))                           22705524
RONNAW         EXEC SQL                                                 22705624
RONNAW            SELECT COUNT(DFCT_ITEM_NBR)                           22705724
RONNAW            INTO   :PV-DFMEIT-ITEM-NBR-ZERO-COUNT                 22705824
RONNAW            FROM TDFMEIT                                          22705924
RONNAW            WHERE DFCT_ORD_ID          = :PV-DB2-RTV-DOC-NBR      22706024
RONNAW              AND DFCT_ITEM_NBR        = 0                        22706124
RONNAW              AND MDSE_DEPT_NBR        = :DFMEIT-MDSE-DEPT-NBR    22706224
RONNAW              AND MDSE_CLASS_NBR       = :DFMEIT-MDSE-CLASS-NBR   22706324
RONNAW         END-EXEC                                                 22706424
RONNAW                                                                  22706524
RONNAW         EVALUATE TRUE                                            22706824
RONNAW            WHEN SQLCODE = 0                                      22706924
RONNAW***SET A SWITCH TO SHOW THAT THERE ARE ZERO ITEMS? MAYBE          22707024
RONNAW                 CONTINUE                                         22707124
RONNAW            WHEN SQLCODE = -904                                   22707224
RONNAW            WHEN SQLCODE = -913                                   22707324
RONNAW                 CONTINUE                                         22707424
RONNAW            WHEN SQLWARN0 NOT = SPACES                            22707524
RONNAW            WHEN SQLCODE < +0                                     22707624
RONNAW            WHEN SQLCODE > +0                                     22707724
RONNAW                 DISPLAY '2220-PRE-CHECK-RTV'                     22707824
RONNAW                 DISPLAY 'PRE CHECK DOLLARS FROM RTV'             22707924
RONNAW                 PERFORM 9998-SQL-ABEND                           22708024
RONNAW         END-EVALUATE                                             22708124
RONNAW     END-PERFORM.                                                 22708224
RONNAW                                                                  22708324
RONNAW     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         22708424
RONNAW        DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN STORE RETAIL PCT'  22708524
RONNAW        PERFORM 9998-SQL-ABEND                                    22708624
RONNAW     END-IF.                                                      22708724
RONNAW                                                                  22708824
      ******************************************************************22709824
      *  DO VENDOR LEVEL PROCESSING FOR PURCHASE ADJUSTMENTS            22709924
      ******************************************************************22710024
       2300-PURCH-VNDR-PROCESSING.                                      22710124
           IF ML030-PURCH-ENT-ID EQUAL SPACES OR                        22710224
              ML030-PURCH-ENT-ID EQUAL ZERO                             22710324
              MOVE PC-UNKNOWN-VENDOR  TO PV-DB2-ENT-ID                  22710424
           ELSE                                                         22710524
              MOVE ML030-PURCH-ENT-ID TO PV-DB2-ENT-ID                  22710624
           END-IF.                                                      22710724
           MOVE ML030-PURCH-DEPT-NBR  TO PV-DB2-DEPT-NBR.               22710824
           IF PS-PURCH-AP-STR-RTL                                       22710924
              PERFORM 7000-GET-MAX-MKDN-STR-RTL-PCT                     22711024
           ELSE                                                         22712024
              IF PS-PURCH-AP-BYR-RTL                                    22720016
                 PERFORM 7010-GET-MAX-MKDN-BYR-RTL-PCT                  22730016
              ELSE                                                      22740016
                 IF PS-PURCH-AP-RCPT-GRS-CST OR                         22750016
W34517              PS-PURCH-AP-IMP-GRS-CST OR                          22760016
                    PS-PURCH-RECEIPT-A OR                               22770016
                    PS-PURCH-RECEIPT-B OR                               22780016
                    PS-PURCH-TRANSFER-FRM-STORE OR                      22790016
                    PS-PURCH-TRANSFER-TO-STORE OR                       22800016
                    PS-PURCH-AP-OTHER                                   22810016
                    PERFORM 7020-GET-MAX-RCPT-GRO-CST-PCT               22820016
                 ELSE                                                   22830016
                    IF PS-PURCH-AP-RTV-COST                             22840016
                       PERFORM 7030-GET-MAX-PADJ-RTV-COST-PCT           22850016
                    ELSE                                                22860016
                       IF PS-PURCH-AP-DA-COST                           22870016
                          PERFORM 7040-GET-MAX-PADJ-DA-COST-PCT         22880016
                       END-IF                                           22890016
                    END-IF                                              22900016
                 END-IF                                                 22910016
              END-IF                                                    22920016
           END-IF.                                                      22930016
                                                                        22940016
           SET PS-PRRTN-FOR-PURCH TO TRUE.                              22950016
           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS.                        22960016
                                                                        22970016
      ******************************************************************22980016
      *  DO NECESSARY PROCESSING OF THE BRAND PRORATION CURSOR FOR      22990016
      *  PURCHASE ADJUSTMENTS USING THE 13 WEEK TABLE.                  23000016
      ******************************************************************23010016
       2400-PROCESS-13WK-PURCH.                                         23020016
           IF BVT00003-LBL-SEQ-NBR                                      23030016
              NOT EQUAL PV-MAX-BRAND                                    23040016
              IF PS-PURCH-AP-STR-RTL                                    23050016
                 MOVE BVT00003-MKDN-STR-RTL-PCT TO PV-PRORATION-PCT     23060016
              ELSE                                                      23070016
                 IF PS-PURCH-AP-BYR-RTL                                 23080016
                    MOVE BVT00003-MKDN-BYR-RTL-PCT TO PV-PRORATION-PCT  23090016
                 ELSE                                                   23100016
                    IF PS-PURCH-AP-RCPT-GRS-CST OR                      23110016
W34517                 PS-PURCH-AP-IMP-GRS-CST OR                       23120016
                       PS-PURCH-RECEIPT-A OR                            23130016
                       PS-PURCH-RECEIPT-B OR                            23140016
                       PS-PURCH-TRANSFER-FRM-STORE OR                   23150016
                       PS-PURCH-TRANSFER-TO-STORE OR                    23160016
                       PS-PURCH-AP-OTHER                                23170016
                       MOVE BVT00003-RCPT-GRO-COST-PCT TO               23180016
                            PV-PRORATION-PCT                            23190016
                    ELSE                                                23200016
                       IF PS-PURCH-AP-RTV-COST OR                       23210016
                          PS-PURCH-AP-TRANS-RTV                         23220016
                          MOVE BVT00003-PADJ-RTV-COST-PCT TO            23230016
                               PV-PRORATION-PCT                         23240016
                       ELSE                                             23250016
                          IF PS-PURCH-AP-DA-COST                        23260016
                             MOVE BVT00003-PADJ-DA-COST-PCT TO          23270016
                                  PV-PRORATION-PCT                      23280016
                          END-IF                                        23290016
                       END-IF                                           23300016
                    END-IF                                              23310016
                 END-IF                                                 23320016
              END-IF                                                    23330016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        23340016
                 PERFORM 2410-PURCH-PRRTN-CALC                          23350016
              END-IF                                                    23360016
           ELSE                                                         23370016
              PERFORM 2420-PURCH-PRRTN-LAST                             23380016
           END-IF.                                                      23390016
           IF PV-PRORATION-PCT NOT EQUAL ZERO OR                        23400016
              BVT00003-LBL-SEQ-NBR EQUAL PV-MAX-BRAND                   23410016
              PERFORM 2430-WRITE-PURCH-13WK-REC                         23420016
           END-IF.                                                      23430016
      ******************************************************************23440016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE.        23450016
      ******************************************************************23460016
       2410-PURCH-PRRTN-CALC.                                           23470016
           COMPUTE PV-WORK-EXTD-GRO-COST-AMT ROUNDED EQUAL              23480016
                   ML030-PURCH-EXTD-GRO-COST-AMT *                      23490016
                   (PV-PRORATION-PCT / 100).                            23500016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL          23510016
                   PV-WORK-EXTD-GRO-COST-AMT.                           23520016
                                                                        23530016
           COMPUTE PV-WORK-FRGT-AMT ROUNDED EQUAL                       23540016
                   ML030-PURCH-FRGT-AMT *                               23550016
                   (PV-PRORATION-PCT / 100).                            23560016
           COMPUTE PAOUT-PURCH-FRGT-AMT ROUNDED EQUAL                   23570016
                   PV-WORK-FRGT-AMT.                                    23580016
                                                                        23590016
           COMPUTE PV-WORK-DISC-AMT ROUNDED EQUAL                       23600016
                   ML030-PURCH-DISC-AMT *                               23610016
                   (PV-PRORATION-PCT / 100).                            23620016
           COMPUTE PAOUT-PURCH-DISC-AMT ROUNDED EQUAL                   23630016
                   PV-WORK-DISC-AMT.                                    23640016
                                                                        23650016
           COMPUTE PV-WORK-EXTD-NET-COST-AMT ROUNDED EQUAL              23660016
                   ML030-PURCH-EXTD-NET-COST-AMT *                      23670016
                   (PV-PRORATION-PCT / 100).                            23680016
           COMPUTE PAOUT-PURCH-EXTD-NET-COST-AMT ROUNDED EQUAL          23690016
                   PV-WORK-EXTD-NET-COST-AMT.                           23700016
                                                                        23710016
           COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL                   23720016
                   ML030-PURCH-EXTD-RTL-AMT *                           23730016
                   (PV-PRORATION-PCT / 100).                            23740016
           COMPUTE PAOUT-PURCH-EXTD-RTL-AMT ROUNDED EQUAL               23750016
                   PV-WORK-EXTD-RTL-AMT.                                23760016
                                                                        23770016
           COMPUTE PV-WORK-PER-UNT-RTL-AMT ROUNDED EQUAL                23780016
                   ML030-PURCH-PER-UNT-RTL-AMT *                        23790016
                   (PV-PRORATION-PCT / 100).                            23800016
           COMPUTE PAOUT-PURCH-PER-UNT-RTL-AMT ROUNDED EQUAL            23810016
                   PV-WORK-PER-UNT-RTL-AMT.                             23820016
                                                                        23830016
           ADD PAOUT-PURCH-EXTD-GRO-COST-AMT TO                         23840016
               PV-TOTAL-EXTD-GRO-COST-AMT.                              23850016
           ADD PAOUT-PURCH-FRGT-AMT          TO PV-TOTAL-FRGT-AMT.      23860016
           ADD PAOUT-PURCH-DISC-AMT          TO PV-TOTAL-DISC-AMT.      23870016
           ADD PAOUT-PURCH-EXTD-NET-COST-AMT TO                         23880016
               PV-TOTAL-EXTD-NET-COST-AMT.                              23890016
           ADD PAOUT-PURCH-EXTD-RTL-AMT     TO PV-TOTAL-EXTD-RTL-AMT.   23900016
           ADD PAOUT-PURCH-PER-UNT-RTL-AMT  TO PV-TOTAL-PER-UNT-RTL-AMT.23910016
                                                                        23920016
      ******************************************************************23930016
      *  DO THE NECESSARY CALCULATIONS FOR TO MAKE SURE THE FULL        23940016
      *  QUANTITY IS PRORATED.                                          23950016
      ******************************************************************23960016
       2420-PURCH-PRRTN-LAST.                                           23970016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT  EQUAL                 23980016
                   ML030-PURCH-EXTD-GRO-COST-AMT  -                     23990016
                   PV-TOTAL-EXTD-GRO-COST-AMT.                          24000016
           COMPUTE PAOUT-PURCH-FRGT-AMT EQUAL                           24010016
                   ML030-PURCH-FRGT-AMT - PV-TOTAL-FRGT-AMT.            24020016
           COMPUTE PAOUT-PURCH-DISC-AMT EQUAL                           24030016
                   ML030-PURCH-DISC-AMT - PV-TOTAL-DISC-AMT.            24040016
           COMPUTE PAOUT-PURCH-EXTD-NET-COST-AMT EQUAL                  24050016
                   ML030-PURCH-EXTD-NET-COST-AMT -                      24060016
                   PV-TOTAL-EXTD-NET-COST-AMT.                          24070016
           COMPUTE PAOUT-PURCH-EXTD-RTL-AMT EQUAL                       24080016
                   ML030-PURCH-EXTD-RTL-AMT - PV-TOTAL-EXTD-RTL-AMT.    24090016
           COMPUTE PAOUT-PURCH-PER-UNT-RTL-AMT EQUAL                    24100016
                   ML030-PURCH-PER-UNT-RTL-AMT -                        24110016
                   PV-TOTAL-PER-UNT-RTL-AMT.                            24120016
      ******************************************************************24130016
      *  SET UP THE OUTPUT RECORD AND CALL THE APPROPRIATE FUNCTION TO  24140016
      *  WRITE THE NEW LINE FOR A PURCHASE ADJUSTMENT THAT USED THE 13  24150016
      *  13 WEEK PRORATION TABLE.                                       24160016
      ******************************************************************24170016
       2430-WRITE-PURCH-13WK-REC.                                       24180016
           MOVE BV003-PV-ENT-ID-OUT     TO PAOUT-PURCH-ENT-ID.          24190016
           MOVE BV003-PV-BRAND-OUT      TO PAOUT-PURCH-LBL-SEQ-NBR.     24200016
           MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID.      24210016
           PERFORM 9400-WRITE-PURCH-REC.                                24220016
      ******************************************************************24230016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE         24240016
      *  TO EVEN PRORATE ACROSS ALL BRANDS FORA  VENDOR DEPARTMENT.     24250016
      ******************************************************************24260016
       2500-PURCH-EVEN-MAIN.                                            24270016
NHOLD$     INITIALIZE PV-BRND-PRRTN-TOTS                                24280016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            24290016
              MOVE BV003-PV-ENT-ID-OUT     TO PAOUT-PURCH-ENT-ID        24300016
              MOVE BV003-PV-BRAND-OUT      TO PAOUT-PURCH-LBL-SEQ-NBR   24310016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID    24320016
              PERFORM 9400-WRITE-PURCH-REC                              24330016
           ELSE                                                         24340016
              PERFORM                                                   24350016
                 VARYING PV-BRAND-COUNT                                 24360016
                 FROM 1 BY 1                                            24370016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           24380016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        24390016
                    PERFORM 2410-PURCH-PRRTN-CALC                       24400016
                 ELSE                                                   24410016
                    PERFORM 2420-PURCH-PRRTN-LAST                       24420016
                 END-IF                                                 24430016
                 MOVE BV003-RT-ENT-ID-OUT(PV-BRAND-COUNT)               24440016
                                              TO PAOUT-PURCH-ENT-ID     24450016
                 MOVE BV003-RT-BRND-OUT(PV-BRAND-COUNT)                 24460016
                                              TO PAOUT-PURCH-LBL-SEQ-NBR24470016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(PV-BRAND-COUNT)           24480016
                                              TO PAOUT-PURCH-ML-LWST-ID 24490016
                 PERFORM 9400-WRITE-PURCH-REC                           24500016
              END-PERFORM                                               24510016
           END-IF.                                                      24520016
                                                                        24530016
      ******************************************************************24540016
      *  DO NECESSARY PROCESSING OF THE BRAND PRORATION CURSOR FOR      24550016
      *  PURCHASE ADJUSTMENTS OF AN RTV DOC.                            24560016
      ******************************************************************24570016
       2600-PURCH-13WK-RTV-DOC-MAIN.                                    24580016
           IF BVT00003-LBL-SEQ-NBR                                      24590016
              NOT EQUAL PV-MAX-BRAND                                    24600016
              MOVE BVT00003-PADJ-RTV-COST-PCT TO PV-PRORATION-PCT       24610016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        24620016
                 PERFORM 2610-PURCH-PRRTN-CALC-RTV-DOC                  24630016
              END-IF                                                    24640016
           ELSE                                                         24650016
              PERFORM 2420-PURCH-PRRTN-LAST                             24660016
           END-IF.                                                      24670016
           IF PV-PRORATION-PCT NOT EQUAL ZERO OR                        24680016
              BVT00003-LBL-SEQ-NBR EQUAL PV-MAX-BRAND                   24690016
              PERFORM 2430-WRITE-PURCH-13WK-REC                         24700016
           END-IF.                                                      24710016
      ******************************************************************24720016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE FOR     24730016
      *  AN ITEM ON AN RTV DOC.                                         24740016
      ******************************************************************24750016
       2610-PURCH-PRRTN-CALC-RTV-DOC.                                   24760016
           COMPUTE PV-WORK-EXTD-GRO-COST-AMT ROUNDED EQUAL              24770016
                   DFMEIT-UNIT-COST-AMT * (PV-PRORATION-PCT / 100).     24780016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL          24790016
                   PV-WORK-EXTD-NET-COST-AMT.                           24800016
                                                                        24810016
           COMPUTE PV-WORK-EXTD-NET-COST-AMT ROUNDED EQUAL              24820016
                   DFMEIT-UNIT-COST-AMT * (PV-PRORATION-PCT / 100).     24830016
           COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL          24840016
                   PV-WORK-EXTD-NET-COST-AMT.                           24850016
                                                                        24860016
           COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL                   24870016
                   DFMEIT-RTL-COST-AMT  * (PV-PRORATION-PCT / 100).     24880016
           COMPUTE PAOUT-PURCH-EXTD-RTL-AMT ROUNDED EQUAL               24890016
                   PV-WORK-EXTD-RTL-AMT.                                24900016
                                                                        24910016
           ADD PAOUT-PURCH-EXTD-GRO-COST-AMT TO                         24920016
               PV-TOTAL-EXTD-GRO-COST-AMT.                              24930016
           ADD PAOUT-PURCH-EXTD-NET-COST-AMT TO                         24940016
               PV-TOTAL-EXTD-NET-COST-AMT.                              24950016
           ADD PAOUT-PURCH-EXTD-RTL-AMT      TO PV-TOTAL-EXTD-RTL-AMT.  24960016
                                                                        24970016
      ******************************************************************24980016
      *  CALCULATE QUANTITIES BASED ON THE PRORATION PERCENTAGE.        24990016
      *  FOR AN ITEM ON AN RTV DOC MAKING SURE THAT THE FULL AMOUNT     25000016
      *  IS ACCOUNTED FOR.                                              25010016
      ******************************************************************25020016
       2700-PURCH-EVEN-RTV-DOC.                                         25030016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            25040016
              MOVE BV003-PV-ENT-ID-OUT     TO PAOUT-PURCH-ENT-ID        25050016
              MOVE BV003-PV-BRAND-OUT      TO PAOUT-PURCH-LBL-SEQ-NBR   25060016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID    25070016
              PERFORM 9400-WRITE-PURCH-REC                              25080016
           ELSE                                                         25090016
              PERFORM                                                   25100016
                 VARYING PV-BRAND-COUNT                                 25110016
                 FROM 1 BY 1                                            25120016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           25130016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        25140016
                    PERFORM 2610-PURCH-PRRTN-CALC-RTV-DOC               25150016
                 ELSE                                                   25160016
                    PERFORM 2420-PURCH-PRRTN-LAST                       25170016
                 END-IF                                                 25180016
                 MOVE BV003-RT-ENT-ID-OUT(BV003-PV-RT-SUB-OUT)          25190016
                                              TO PAOUT-PURCH-ENT-ID     25200016
                 MOVE BV003-RT-BRND-OUT(BV003-PV-RT-SUB-OUT)            25210016
                                              TO PAOUT-PURCH-LBL-SEQ-NBR25220016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(BV003-PV-RT-SUB-OUT)      25230016
                                              TO PAOUT-PURCH-ML-LWST-ID 25240016
                 PERFORM 9400-WRITE-PURCH-REC                           25250016
              END-PERFORM                                               25260016
           END-IF.                                                      25270016
W32898******************************************************************25280016
W32898*  PROCESS PURCHASE ADJUSTMENTS FOR RECLASS / BRAND / VENDOR      25290016
W32898*  REASSIGNMENTS                                                  25300016
W32898******************************************************************25310016
W32898                                                                  25320016
W32898 2750-PADJ-REALIGN-PROCESSING.                                    25330016
W32898                                                                  25340016
W32898*   THIS LOOK UP MUST BE DONE AGAIN BECAUSE PREVIOUS              25350016
W32898*   LAYOUT DID NOT HAVE ROOM FOR -ML-LWST-ID. IT WAS LOOKED UP    25360016
W32898*   IN THE NEW PROGRAM MLKUT217 IN JOB MLK545. NO ERROR SHOULD    25370016
W32898*   BE FOUND HERE.                                                25380016
W32898                                                                  25390016
W32898                                                                  25400016
W32898     MOVE PAOUT-PURCH-ENT-ID    TO PV-ENT-ID-COMP.                25410016
W32898     MOVE PAOUT-PURCH-DEPT-NBR  TO PV-DEPT-NBR-COMP-3.            25420016
W32898     MOVE PAOUT-PURCH-LBL-SEQ-NBR                                 25430016
W32898                                TO PV-LBL-SEQ-NBR-COMP.           25440016
W32898                                                                  25450016
W32898     EXEC SQL                                                     25460016
W32898         SELECT ML_LO_MDSE_LVL_ID                                 25470016
W32898           INTO :PAOUT-PURCH-ML-LWST-ID                           25480016
W32898           FROM MLV_BRND_VND                                      25490016
W32898           WHERE  DEPT_NBR      = :PV-DEPT-NBR-COMP-3             25500016
W32898           AND    ENT_ID        = :PV-ENT-ID-COMP                 25510016
W32898           AND    LBL_SEQ_NBR   = :PV-LBL-SEQ-NBR-COMP            25520016
W32898           AND    EFF_BEG_DTE  <= :PAOUT-PURCH-FIN-LIAB-DTE       25530016
W32898           AND   (EFF_END_DTE  >= :PAOUT-PURCH-FIN-LIAB-DTE       25540016
W32898           OR     EFF_END_DTE IS NULL)                            25550016
W32898         WITH UR                                                  25560016
W32898     END-EXEC.                                                    25570016
W32898                                                                  25580016
W32898     EVALUATE TRUE                                                25590016
W32898                                                                  25600016
W32898         WHEN SQLCODE = 0                                         25610016
W32898             CONTINUE                                             25620016
W32898         WHEN SQLCODE = +100                                      25630016
W34517*            PERFORM 2755-LOOKUP-NOT-FOUND                        25640016
W34517             PERFORM 2752-SELECT-LWST-ID-MAX-DTE                  25650016
W32898         WHEN SQLCODE < +0                                        25660016
W32898         WHEN SQLCODE > +0                                        25670016
W32898              DISPLAY '2750-PADJ-REALIGN-PROCESSING '             25680016
W32898                     DISPLAY 'GETTING DATALESS KEY  '             25690016
W32898                     PERFORM 9998-SQL-ABEND                       25700016
W32898     END-EVALUATE.                                                25710016
W32898                                                                  25720016
W32898     PERFORM 9400-WRITE-PURCH-REC.                                25730016
W32898                                                                  25740016
W32898     SET PS-NO-HOLD-MATCH   TO TRUE.                              25750016
W32898     MOVE SPACES            TO PS-PREV-DBV-RLTSNHP-CHK-SW.        25760016
W32898                                                                  25770016
W32898*    NEXT INPUT READ IS PERFORMED AT THE END OF THE PERFORMING    25780016
W32898*    PARAGRAPH 2000-PROCESS-PURCH-RECS.                           25790016
W32898                                                                  25800016
W32898                                                                  25810016
W34517******************************************************************25820016
W34517*  GET ML_LO_MDSE_LVL_ID WITH MAXIMUM EFF_BEG_DTE.                25830016
W34517******************************************************************25840016
W34517 2752-SELECT-LWST-ID-MAX-DTE.                                     25850016
W34517                                                                  25860016
W34517     EXEC SQL                                                     25870016
W34517         SELECT ML_LO_MDSE_LVL_ID                                 25880016
W34517               ,MAX(EFF_BEG_DTE)                                  25890016
W34517           INTO :PAOUT-PURCH-ML-LWST-ID                           25900016
W34517               ,:MLV00000-EFF-BEG-DTE                             25910016
W34517           FROM MLV_BRND_VND                                      25920016
W34517           WHERE  DEPT_NBR    = :PV-DEPT-NBR-COMP-3               25930016
W34517           AND    ENT_ID      = :PV-ENT-ID-COMP                   25940016
W34517           AND    LBL_SEQ_NBR = :PV-LBL-SEQ-NBR-COMP              25950016
W34517         GROUP BY ML_LO_MDSE_LVL_ID                               25960016
W34517         WITH UR                                                  25970016
W34517     END-EXEC.                                                    25980016
W34517                                                                  25990016
W34517     EVALUATE TRUE                                                26000016
W34517                                                                  26010016
W34517         WHEN SQLCODE = 0                                         26020016
W34517             CONTINUE                                             26030016
W34517         WHEN SQLCODE = +100                                      26040016
W34517             PERFORM 2755-LOOKUP-NOT-FOUND                        26050016
W34517         WHEN SQLCODE < +0                                        26060016
W34517         WHEN SQLCODE > +0                                        26070016
W34517              DISPLAY '2752-SELECT-LWST-ID-MAX-DTE  '             26080016
W34517                     DISPLAY 'GETTING DATALESS KEY  '             26090016
W34517                     PERFORM 9998-SQL-ABEND                       26100016
W34517     END-EVALUATE.                                                26110016
W34517                                                                  26120016
W34517                                                                  26130016
W32898 2755-LOOKUP-NOT-FOUND.                                           26140016
W32898                                                                  26150016
W32898     DISPLAY 'DATALESS KEY NOT FOUND FOR :'                       26160016
W32898     DISPLAY 'DEPT :' PAOUT-PURCH-DEPT-NBR.                       26170016
W32898     DISPLAY 'ENT-ID :' PAOUT-PURCH-ENT-ID.                       26180016
W32898     MOVE PAOUT-PURCH-LBL-SEQ-NBR TO PV-DISP-LBL-SEQ-NBR.         26190016
W32898     DISPLAY 'LBL-SEQ :' PV-DISP-LBL-SEQ-NBR.                     26200016
W32898     MOVE PV-TOT-EDIT-PURCH-RECS-IN TO PV-DISP-PURCH-IN-CNT.      26210016
W32898     DISPLAY 'INPUT RECORD # :' PV-DISP-PURCH-IN-CNT.             26220016
W32898                                                                  26230016
W32898                                                                  26240016
W34309 2760-PADJ-GIVEBACK-PROCESSING.                                   26250016
W34309                                                                  26260016
W34309     INITIALIZE BV003-PV-INPUT-AREA.                              26270016
W34309     MOVE PC-BVD                TO BV003-PV-LOOKUP-TYPE-IN.       26280016
W34309     MOVE 'Y'                   TO BV003-PV-VND-PAST-FUT-IN.      26290016
W34309     MOVE 'Y'                   TO BV003-PV-USE-KNWN-UNK-SW.      26300016
W34309     MOVE 06                    TO BV003-PV-PAST-MONTHS.          26310016
W34309     MOVE PAOUT-PURCH-FIN-LIAB-DTE                                26320016
W34309                                TO BV003-PV-EFF-DTE-IN.           26330016
W34309     MOVE PAOUT-PURCH-ENT-ID    TO BV003-PV-ENT-ID-IN-9.          26340016
W34309     MOVE PAOUT-PURCH-LBL-SEQ-NBR                                 26350016
W34309                                TO BV003-PV-BRAND-IN-9.           26360016
W34309     MOVE PAOUT-PURCH-DEPT-NBR  TO BV003-PV-DEPT-IN-9.            26370016
W34309                                                                  26380016
W34309     PERFORM BV003-LOOKUP-MAIN.                                   26390016
W34309                                                                  26400016
W34309                                                                  26410016
W34309     IF BV003-PV-NO-ERRORS-FOUND OR BV003-PV-NO-REL-FOUND         26420016
W34309         MOVE BV003-PV-RLTNSHP-ID-OUT                             26430016
W34309                                TO PAOUT-PURCH-ML-LWST-ID         26440016
W34309                                                                  26450016
W34309         PERFORM 9400-WRITE-PURCH-REC                             26460016
W34309         SET PS-NO-HOLD-MATCH   TO TRUE                           26470016
W34309         MOVE SPACES            TO PS-PREV-DBV-RLTSNHP-CHK-SW     26480016
W34309         IF BV003-UNKNOWN-INS                                     26490016
W34309             PERFORM 8200-COMMIT                                  26500016
W34309         END-IF                                                   26510016
W34309     ELSE                                                         26520016
W34309         PERFORM 2865-LOOKUP-BV-ERROR                             26530016
W34309     END-IF.                                                      26540016
W34309                                                                  26550016
W34309*    NEXT INPUT READ IS PERFORMED AT THE END OF THE PERFORMING    26560016
W34309*    PARAGRAPH 2000-PROCESS-PURCH-RECS.                           26570016
W34309                                                                  26580016
W34309 2865-LOOKUP-BV-ERROR.                                            26590016
W34309                                                                  26600016
W34309     DISPLAY '2865-LOOKUP-BV-ERROR/ GIVEBACK PROCESSING'          26610016
W34309     DISPLAY 'DATALESS KEY NOT FOUND FOR :'                       26620016
W34309     DISPLAY 'DEPT :' PAOUT-PURCH-DEPT-NBR.                       26630016
W34309     DISPLAY 'ENT-ID :' PAOUT-PURCH-ENT-ID.                       26640016
W34309     MOVE PAOUT-PURCH-LBL-SEQ-NBR TO PV-DISP-LBL-SEQ-NBR.         26650016
W34309     DISPLAY 'LBL-SEQ :' PV-DISP-LBL-SEQ-NBR.                     26660016
W34309     MOVE PV-TOT-EDIT-PURCH-RECS-IN TO PV-DISP-PURCH-IN-CNT.      26670016
W34309     DISPLAY 'INPUT RECORD # :' PV-DISP-PURCH-IN-CNT.             26680016
W34309                                                                  26690016
W34309     DISPLAY BV003-PV-RETURN-MSG-1.                               26700016
W34309     DISPLAY BV003-PV-RETURN-MSG-2.                               26710016
W34309     IF BV003-PV-SQL-ERROR                                        26720016
W34309        PERFORM 9998-SQL-ABEND                                    26730016
W34309     ELSE                                                         26740016
W34309        PERFORM 9999-OTHER-ABEND                                  26750016
W34309     END-IF.                                                      26760016
W34309                                                                  26770016
W34309                                                                  26780016
W34309                                                                  26790016
W32898******************************************************************26800016
W32898*  PROCESS A A DEBIT ALLOWANCE MARKDOWN FROM THE PURCH FILE       26810016
W32898******************************************************************26820016
W28582                                                                  26830016
W28582 2800-PURCH-DA-PROCESSING.                                        26840016
W28582     SET PS-PREV-DEBIT-ALLOW TO TRUE                              26850016
W28582     SET PS-DA-ALW-OR-RTV TO TRUE                                 26860016
W28582     INITIALIZE PV-BRND-PRRTN-TOTS.                               26870016
W31475     INITIALIZE PV-DR-ALW-NBR                                     26880016
W31475     INITIALIZE ML006-PARAMETERS.                                 26890016
W31475*    MOVE ML030-PURCH-DOC-16-NBR   TO ML006-DR-ALW-NBR            26900016
W31475*    MOVE IN-ORA-SRC-CTL-RECORD TO ML006-ORACLE-CONNECT-REC       26910016
W31475*    SET ML006-SUCCESSFUL-CALL TO TRUE                            26920016
W31475*    CALL PC-MLKUP359  USING ML006-PARAMETERS                     26930016
W31475     MOVE ML030-PURCH-DOC-16-NBR   TO PV-DR-ALW-NBR               26940016
W31475     SET ML006-SUCCESSFUL-CALL TO TRUE                            26950016
W31475     PERFORM 8300-GET-DA-BRND-PRORATION.                          26960016
                                                                        26970016
W28582     IF ML006-SUCCESSFUL-CALL AND ML006-DA-PRRTN-REC-CNT > 0      26980016
W28582        PERFORM                                                   26990016
W28582           VARYING PV-BRAND-COUNT                                 27000016
W28582           FROM 1 BY 1                                            27010016
W28582           UNTIL (PV-BRAND-COUNT > ML006-DA-PRRTN-REC-CNT)        27020016
W28582           INITIALIZE BV003-PV-INPUT-AREA                         27030016
W28582           IF ML030-PURCH-ENT-ID EQUAL SPACES OR                  27040016
W28582              ML030-PURCH-ENT-ID EQUAL ZERO                       27050016
W28582              MOVE PC-UNKNOWN-VENDOR TO BV003-PV-ENT-ID-IN-9      27060016
W28582           ELSE                                                   27070016
W28582              MOVE ML030-PURCH-ENT-ID TO BV003-PV-ENT-ID-IN-9     27080016
W28582           END-IF                                                 27090016
W28582           MOVE ML030-PURCH-DEPT-NBR TO BV003-PV-DEPT-IN-9        27100016
W28582           MOVE ML006-DA-PRRTN-BRND(PV-BRAND-COUNT) TO            27110016
W28582                BV003-PV-BRAND-IN-9                               27120016
W28582           SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE               27130016
W28582           MOVE ML030-PURCH-FIN-LIAB-DTE TO                       27140016
W28582              BV003-PV-EFF-DTE-IN                                 27150016
W28582           PERFORM BV003-LOOKUP-MAIN                              27160016
W28582           IF BV003-UNKNOWN-INS                                   27170016
W28582              PERFORM 8200-COMMIT                                 27180016
W28582           END-IF                                                 27190016
W28582           IF PV-BRAND-COUNT NOT EQUAL ML006-DA-PRRTN-REC-CNT     27200016
W28582              MOVE ML006-DA-PRRTN-PCT(PV-BRAND-COUNT) TO          27210016
W28582                   PV-PRORATION-PCT                               27220016
W28582              PERFORM 2410-PURCH-PRRTN-CALC                       27230016
W28582           ELSE                                                   27240016
W28582              PERFORM 2420-PURCH-PRRTN-LAST                       27250016
W28582           END-IF                                                 27260016
W28582           MOVE BV003-PV-ENT-ID-OUT     TO                        27270016
W28582                PAOUT-PURCH-ENT-ID                                27280016
W28582           MOVE BV003-PV-BRAND-OUT      TO                        27290016
W28582                PAOUT-PURCH-LBL-SEQ-NBR                           27300016
W28582           MOVE BV003-PV-RLTNSHP-ID-OUT TO                        27310016
W28582                PAOUT-PURCH-ML-LWST-ID                            27320016
W28582           PERFORM 9400-WRITE-PURCH-REC                           27330016
W28582           IF BV003-PV-NO-ERRORS-FOUND OR BV003-NO-RLTNSHP-FOR-DTE27340016
W28582              CONTINUE                                            27350016
W28582           ELSE                                                   27360016
W28582              DISPLAY 'ENT ID:' ML030-PURCH-ENT-ID                27370016
W28582              DISPLAY 'DEPT  :' ML030-PURCH-DEPT-NBR              27380016
W28582              DISPLAY 'BRAND ' ML006-DA-PRRTN-BRND(PV-BRAND-COUNT)27390016
W28582              MOVE 'PUR' TO ML205-ML-TRANSACTION                  27400016
W28582              MOVE BV003-PV-BRAND-OUT TO                          27410016
W28582                 ML205-ML-VND-LBL-SEQ-NBR                         27420016
W28582              STRING 'BV CALL = ' BV003-PV-LOOKUP-TYPE-IN         27430016
W28582                  DELIMITED BY SIZE                               27440016
W28582                  INTO ML205-ML-NOTE                              27450016
W28582              MOVE ML030-PURCH-RECORD TO ML205-ML-ERROR-INPUT-REC 27460016
W28582              WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD          27470016
W28582           END-IF                                                 27480016
W28582        END-PERFORM                                               27490016
W28582     ELSE                                                         27500016
W28582        IF ML006-ERROR-CALL OR ML006-LOGGON-ERROR                 27510016
W28582           DISPLAY 'ERROR GETTING PURCH DA BRAND PRORATION INFO'  27520016
W28582           PERFORM 9999-OTHER-ABEND                               27530016
W28582        ELSE                                                      27540016
W28582           IF ML030-PURCH-ENT-ID EQUAL SPACES OR                  27550016
W28582              ML030-PURCH-ENT-ID EQUAL ZERO                       27560016
W28582              MOVE PC-UNKNOWN-VENDOR    TO PV-DB2-ENT-ID          27570016
W28582           ELSE                                                   27580016
W28582              MOVE ML030-PURCH-ENT-ID   TO PV-DB2-ENT-ID          27590016
W28582           END-IF                                                 27600016
W28582           MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR           27610016
W28582           PERFORM 7040-GET-MAX-PADJ-DA-COST-PCT                  27620016
W28582           SET PS-PRRTN-FOR-PURCH TO TRUE                         27630016
W28582           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                   27640016
W28582        END-IF                                                    27650016
W28582     END-IF.                                                      27660016
W34517                                                                  27670016
W34517******************************************************************27680016
W34517*  PROCESS SPECIAL AP TRAN CODES.                                 27690016
W34517******************************************************************27700016
W34517                                                                  27710016
W34517 2850-PURCH-AP-SPECIAL.                                           27720016
W34517                                                                  27730016
W34517     EVALUATE TRUE                                                27740016
W34517         WHEN PS-PURCH-AP-TRANS-SPCL-VND                          27750016
W34517             PERFORM 2860-PURCH-SPCL-VND                          27760016
W34517         WHEN PS-PURCH-AP-TRANS-SPCL-BRND                         27770016
W34517         WHEN PS-PURCH-AP-TRANS-SPCL-BRND2                        27780016
W34517             PERFORM 2870-PURCH-SPCL-BRND                         27790016
W34517         WHEN PS-PURCH-AP-TRANS-SPCL-BV                           27800016
W34517             PERFORM 2880-PURCH-SPCL-BV                           27810016
W34517     END-EVALUATE.                                                27820016
W34517                                                                  27830016
W34517******************************************************************27840016
W34517*  PROCESS SPECIAL AP TRAN CODES SPECIFIED VENDORS                27850016
W34517******************************************************************27860016
W34517                                                                  27870016
W34517 2860-PURCH-SPCL-VND.                                             27880016
W34517                                                                  27890016
W34517     EVALUATE PS-AP-TRANS-CDE                                     27900016
W34517         WHEN '0K'                                                27910016
W34517*  PRORATE AMOUNTS ACCROSS BRANDS SUPPLIED BY LEE                 27920016
W34517             MOVE  2086 TO PV-DB2-ENT-ID                          27930016
W34517         WHEN '3W'                                                27940016
W34517*  PRORATE AMOUNTS ACCROSS BRANDS SUPPLIED BY KORAMSA             27950016
W34517             MOVE 56209 TO PV-DB2-ENT-ID                          27960016
W34517         WHEN '3X'                                                27970016
W34517*  PRORATE AMOUNTS ACCROSS BRANDS SUPPLIED BY BORDER APPAREL      27980016
W34517             MOVE 60449 TO PV-DB2-ENT-ID                          27990016
W34517         WHEN '3F'                                                28000016
W34517         WHEN '3G'                                                28010016
W34517*  PRORATE AMOUNTS ACCROSS BRANDS SUPPLIED BY LI & FUNG           28020016
W34517             MOVE 10593 TO PV-DB2-ENT-ID                          28030016
W34517     END-EVALUATE.                                                28040016
W34517     MOVE ML030-PURCH-DEPT-NBR TO PV-DB2-DEPT-NBR.                28050016
W34517     PERFORM 7020-GET-MAX-RCPT-GRO-CST-PCT.                       28060016
W34517     SET PS-PRRTN-FOR-PURCH TO TRUE.                              28070016
W34517     PERFORM 6000-VNDR-BRND-PRRTN-PROCESS.                        28080016
W34517                                                                  28090016
W34517******************************************************************28100016
W34517*  PROCESS SPECIAL AP TRAN CODES SPECIFIED BRANDS. APPLIES TO     28110016
W34517*  TRAN CODES '0N' AND '0P'.                                      28120016
W34517******************************************************************28130016
W34517                                                                  28140016
W34517 2870-PURCH-SPCL-BRND.                                            28150016
W34517                                                                  28160016
W34517     INITIALIZE PV-BRND-PRRTN-TOTS                                28170016
W34517                BV002-PV-INPUT-AREA.                              28180016
W34517     EVALUATE TRUE                                                28190016
W34517         WHEN PS-PURCH-AP-TRANS-SPCL-BRND                         28200016
W34517*            MOVE 2456            TO BV002-PV-LBL-SEQ-IN1         28210016
W34517*            MOVE 2510            TO BV002-PV-LBL-SEQ-IN2         28220016
W34517*            MOVE 2496            TO BV002-PV-LBL-SEQ-IN3         28230016
W34517*            MOVE 2688            TO BV002-PV-LBL-SEQ-IN4         28240016
W34517*            MOVE 2532            TO BV002-PV-LBL-SEQ-IN5         28250016
W34517*            MOVE 2767            TO BV002-PV-LBL-SEQ-IN6         28260016
W34517*            MOVE 2875            TO BV002-PV-LBL-SEQ-IN7         28270016
PK8624*            MOVE 3529            TO BV002-PV-LBL-SEQ-IN8         28280016
PK8624*            MOVE 3689            TO BV002-PV-LBL-SEQ-IN9         28290016
PK8624*            MOVE 3028            TO BV002-PV-LBL-SEQ-IN10        28300016
PK9934             MOVE 6               TO BV002-PV-EXP-TYP-NBR-IN      28310016
W34517         WHEN PS-PURCH-AP-TRANS-SPCL-BRND2                        28320016
W34517*            MOVE 2510            TO BV002-PV-LBL-SEQ-IN1         28330016
W34517*            MOVE 2688            TO BV002-PV-LBL-SEQ-IN2         28340016
PK9934             MOVE 7               TO BV002-PV-EXP-TYP-NBR-IN      28350016
W34517     END-EVALUATE.                                                28360016
W34517     MOVE ML030-PURCH-DEPT-NBR    TO BV002-PV-DEPT-IN.            28370016
W34517     MOVE PV-PROCESS-DATE         TO BV002-PV-PRO-DTE-IN.         28380016
W34517     MOVE PV-13WK-1ST-WK-END-DTE  TO BV002-PV-FSC-WK-ST-IN.       28390016
W34517     MOVE PV-13WK-13TH-WK-END-DTE TO BV002-PV-FSC-WK-ED-IN.       28400016
W34517     DISPLAY 'BV002-PV-DEPT-IN '       BV002-PV-DEPT-IN           28410016
W34517     DISPLAY 'BV002-PV-PRO-DTE-IN '    BV002-PV-PRO-DTE-IN        28420016
W34517     DISPLAY 'BV002-PV-FSC-WK-ST-IN '  BV002-PV-FSC-WK-ST-IN      28430016
W34517     DISPLAY 'BV002-PV-FSC-WK-ED-IN '  BV002-PV-FSC-WK-ED-IN      28440016
PK9934     DISPLAY 'BV002-PV-EXP-TYP-NBR  '  BV002-PV-EXP-TYP-NBR-IN    28450016
W34517                                                                  28460016
W34517     PERFORM BV002-LOOKUP-MAIN.                                   28470016
W34517                                                                  28480016
W34517     IF BV002-PV-RETURN-CDE = ZEROES                              28490016
W34517         CONTINUE                                                 28500016
W34517     ELSE                                                         28510016
W34517         DISPLAY '***********************************************'28520016
W34517         DISPLAY '* ABEND: 2870-PURCH-SPCL-BRND'                  28530016
W34517         DISPLAY '* BV002 LOOKUP RETURN CODE: '                   28540016
W34517                                               BV002-PV-RETURN-CDE28550016
W34517         DISPLAY BV002-PV-RETURN-MSG-1                            28560016
W34517         DISPLAY BV002-PV-RETURN-MSG-2                            28570016
W34517         DISPLAY '***********************************************'28580016
W34517         IF BV002-PV-SQL-ERROR                                    28590016
W34517             MOVE BV002-PV-SQLCODE-OUT TO SQLCODE                 28600016
W34517             PERFORM 9998-SQL-ABEND                               28610016
W34517         ELSE                                                     28620016
W34517             PERFORM 9999-OTHER-ABEND                             28630016
W34517         END-IF                                                   28640016
W34517     END-IF.                                                      28650016
W34517                                                                  28660016
W34517     DISPLAY 'BV002-PV-HOLD-IDX ' BV002-PV-HOLD-IDX               28670016
W34517     PERFORM VARYING BV002-PV-IDX FROM 1 BY 1                     28680016
W34517       UNTIL BV002-PV-IDX GREATER BV002-PV-HOLD-IDX               28690016
W34517         MOVE BV002-RT-BRND-OUT (BV002-PV-IDX)                    28700016
W34517           TO PAOUT-PURCH-LBL-SEQ-NBR                             28710016
W34517              BV003-PV-BRAND-IN-9                                 28720016
W34517         MOVE BV002-RT-ENT-ID-OUT (BV002-PV-IDX)                  28730016
W34517           TO PAOUT-PURCH-ENT-ID                                  28740016
W34517              BV003-PV-ENT-ID-IN-9                                28750016
W34517         MOVE ML030-PURCH-DEPT-NBR TO BV003-PV-DEPT-IN-9          28760016
W34517         SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE                 28770016
W34517         MOVE ML030-PURCH-FIN-LIAB-DTE TO BV003-PV-EFF-DTE-IN     28780016
W34517         PERFORM BV003-LOOKUP-MAIN                                28790016
W34517         IF BV003-UNKNOWN-INS                                     28800016
W34517            PERFORM 8200-COMMIT                                   28810016
W34517         END-IF                                                   28820016
W34517         MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID   28830016
W34517         MOVE BV002-RT-PERCENTAGE (BV002-PV-IDX)                  28840016
W34517           TO PV-PRORATION-PCT                                    28850016
W34517         IF BV002-PV-IDX LESS BV002-PV-HOLD-IDX                   28860016
W34517             COMPUTE PV-WORK-EXTD-GRO-COST-AMT ROUNDED EQUAL      28870016
W34517                     ML030-PURCH-EXTD-GRO-COST-AMT *              28880016
W34517                     (PV-PRORATION-PCT / 100)                     28890016
W34517             COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT ROUNDED EQUAL  28900016
W34517                     PV-WORK-EXTD-GRO-COST-AMT                    28910016
W34517             COMPUTE PV-WORK-FRGT-AMT ROUNDED EQUAL               28920016
W34517                     ML030-PURCH-FRGT-AMT *                       28930016
W34517                     (PV-PRORATION-PCT / 100)                     28940016
W34517             COMPUTE PAOUT-PURCH-FRGT-AMT ROUNDED EQUAL           28950016
W34517                     PV-WORK-FRGT-AMT                             28960016
W34517             COMPUTE PV-WORK-DISC-AMT ROUNDED EQUAL               28970016
W34517                     ML030-PURCH-DISC-AMT *                       28980016
W34517                     (PV-PRORATION-PCT / 100)                     28990016
W34517             COMPUTE PAOUT-PURCH-DISC-AMT ROUNDED EQUAL           29000016
W34517                     PV-WORK-DISC-AMT                             29010016
W34517             COMPUTE PV-WORK-EXTD-NET-COST-AMT ROUNDED EQUAL      29020016
W34517                     ML030-PURCH-EXTD-NET-COST-AMT *              29030016
W34517                     (PV-PRORATION-PCT / 100)                     29040016
W34517             COMPUTE PAOUT-PURCH-EXTD-NET-COST-AMT ROUNDED EQUAL  29050016
W34517                     PV-WORK-EXTD-NET-COST-AMT                    29060016
W34517             COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL           29070016
W34517                     ML030-PURCH-EXTD-RTL-AMT *                   29080016
W34517                     (PV-PRORATION-PCT / 100)                     29090016
W34517             COMPUTE PAOUT-PURCH-EXTD-RTL-AMT ROUNDED EQUAL       29100016
W34517                     PV-WORK-EXTD-RTL-AMT                         29110016
W34517             COMPUTE PV-WORK-PER-UNT-RTL-AMT ROUNDED EQUAL        29120016
W34517                     ML030-PURCH-PER-UNT-RTL-AMT *                29130016
W34517                     (PV-PRORATION-PCT / 100)                     29140016
W34517             COMPUTE PAOUT-PURCH-PER-UNT-RTL-AMT ROUNDED EQUAL    29150016
W34517                     PV-WORK-PER-UNT-RTL-AMT                      29160016
W34517             ADD PAOUT-PURCH-EXTD-GRO-COST-AMT TO                 29170016
W34517                 PV-TOTAL-EXTD-GRO-COST-AMT                       29180016
W34517             ADD PAOUT-PURCH-FRGT-AMT TO PV-TOTAL-FRGT-AMT        29190016
W34517             ADD PAOUT-PURCH-DISC-AMT TO PV-TOTAL-DISC-AMT        29200016
W34517             ADD PAOUT-PURCH-EXTD-NET-COST-AMT TO                 29210016
W34517                 PV-TOTAL-EXTD-NET-COST-AMT                       29220016
W34517             ADD PAOUT-PURCH-EXTD-RTL-AMT TO PV-TOTAL-EXTD-RTL-AMT29230016
W34517             ADD PAOUT-PURCH-PER-UNT-RTL-AMT TO                   29240016
W34517                 PV-TOTAL-PER-UNT-RTL-AMT                         29250016
W34517         ELSE                                                     29260016
W34517             PERFORM 2420-PURCH-PRRTN-LAST                        29270016
W34517         END-IF                                                   29280016
W34517         PERFORM 9400-WRITE-PURCH-REC                             29290016
W34517     END-PERFORM.                                                 29300016
W34517                                                                  29310016
W34517* IF SPECIFIED BRANDS ARE NOT FOUND AND LBL-SEQ-NBR IS ZERO,      29320016
W34517* ASSIGN UNKNOWN BRAND.                                           29330016
W34517     IF BV002-PV-HOLD-IDX = ZERO                                  29340016
W34517         IF ML030-PURCH-LBL-SEQ-NBR = ZERO                        29350016
W34517             MOVE PC-UNKNOWN-BRAND TO PAOUT-PURCH-LBL-SEQ-NBR     29360016
W34517         ELSE                                                     29370016
W34517             MOVE ML030-PURCH-LBL-SEQ-NBR                         29380016
W34517                                   TO PAOUT-PURCH-LBL-SEQ-NBR     29390016
W34517         END-IF                                                   29400016
W34517         MOVE PAOUT-PURCH-LBL-SEQ-NBR                             29410016
W34517           TO BV003-PV-BRAND-IN-9                                 29420016
W34517         MOVE ML030-PURCH-ENT-ID                                  29430016
W34517           TO PAOUT-PURCH-ENT-ID                                  29440016
W34517              BV003-PV-ENT-ID-IN-9                                29450016
W34517         MOVE ML030-PURCH-DEPT-NBR TO BV003-PV-DEPT-IN-9          29460016
W34517         SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE                 29470016
W34517         MOVE ML030-PURCH-FIN-LIAB-DTE TO BV003-PV-EFF-DTE-IN     29480016
W34517         PERFORM BV003-LOOKUP-MAIN                                29490016
W34517         IF BV003-UNKNOWN-INS                                     29500016
W34517            PERFORM 8200-COMMIT                                   29510016
W34517         END-IF                                                   29520016
W34517         MOVE BV003-PV-RLTNSHP-ID-OUT  TO PAOUT-PURCH-ML-LWST-ID  29530016
W34517         PERFORM 9400-WRITE-PURCH-REC                             29540016
W34517         MOVE PAOUT-PURCH-ENT-ID       TO PV-DB2-ENT-ID           29550016
W34517         PERFORM 6110-SELECT-PRIM-TYPE-CDE                        29560016
W34517         MOVE PAOUT-PURCH-DEPT-NBR     TO ML083-DEPT-NBR          29570016
W34517         MOVE PAOUT-PURCH-ENT-ID       TO ML083-ENT-ID            29580016
W34517         MOVE ENTNME-ENT-NAME-DESC     TO ML083-ENT-NAME-DESC     29590016
W34517         MOVE PAOUT-PURCH-SKU          TO ML083-SKU               29600016
W34517         MOVE PAOUT-PURCH-AP-TRANS-CDE TO ML083-AP-TRANS-CDE      29610016
W34517         MOVE PAOUT-PURCH-EXTD-RTL-AMT TO ML083-EXTD-RTL-AMT      29620016
W34517         PERFORM 2875-WRITE-SPEC-BRNDS-NOTFND                     29630016
W34517     END-IF.                                                      29640016
W34517                                                                  29650016
W34517******************************************************************29660016
W34517*  WRITE A RECORD TO THE SPECFIED BRANDS NOT FOUND FILE.          29670016
W34517******************************************************************29680016
W34517                                                                  29690016
W34517 2875-WRITE-SPEC-BRNDS-NOTFND.                                    29700016
W34517                                                                  29710016
W34517     WRITE BV-SPEC-NOTFND-REC FROM ML083-SPEC-BRANDS-NOT-FOUND    29720016
W34517     ADD 1 TO PV-TOT-SPEC-BRANDS-NOT-FOUND.                       29730016
W34517                                                                  29740016
W34517******************************************************************29750016
W34517*  PROCESS SPECIAL AP TRAN CODES SPECIFIC BV COMBINATION          29760016
W34517******************************************************************29770016
W34517                                                                  29780016
W34517 2880-PURCH-SPCL-BV.                                              29790016
W34517                                                                  29800016
W34517     EVALUATE PS-AP-TRANS-CDE                                     29810016
W34517         WHEN '3N'                                                29820016
W34517         WHEN '3R'                                                29830016
W34517*  ASSIGN TO ELLE (BRAND) AND LI & FUNG (VENDOR)                  29840016
W34517             MOVE  10593 TO PAOUT-PURCH-ENT-ID                    29850016
W34517             MOVE  2456  TO PAOUT-PURCH-LBL-SEQ-NBR               29860016
W34517         WHEN '3P'                                                29870016
W34517         WHEN '3S'                                                29880016
W34517*  ASSIGN TO FOOD NETWORK (BRAND) AND LI & FUNG (VENDOR)          29890016
W34517             MOVE  10593 TO PAOUT-PURCH-ENT-ID                    29900016
W34517             MOVE  2510  TO PAOUT-PURCH-LBL-SEQ-NBR               29910016
W34517         WHEN '3Q'                                                29920016
W34517         WHEN '3T'                                                29930016
W34517*  ASSIGN TO SVVW (BRAND) AND LI & FUNG (VENDOR)                  29940016
W34517             MOVE  10593 TO PAOUT-PURCH-ENT-ID                    29950016
W34517             MOVE  2496  TO PAOUT-PURCH-LBL-SEQ-NBR               29960016
W34517         WHEN '3Y'                                                29970016
W34517         WHEN '3Z'                                                29980016
W34517*  ASSIGN TO FILA SPORT (BRAND) AND LI & FUNG (VENDOR)            29990016
W34517             MOVE  10593 TO PAOUT-PURCH-ENT-ID                    30000016
W34517             MOVE  2767  TO PAOUT-PURCH-LBL-SEQ-NBR               30010016
W34517         WHEN '1A'                                                30020016
W34517         WHEN '1B'                                                30030016
W34517*  ASSIGN TO CHAPS HOME (BRAND) AND LI & FUNG (VENDOR)            30040016
W34517             MOVE  10593 TO PAOUT-PURCH-ENT-ID                    30050016
W34517             MOVE  2532  TO PAOUT-PURCH-LBL-SEQ-NBR               30060016
W34517         WHEN '1C'                                                30070016
W34517         WHEN '1D'                                                30080016
W34517*  ASSIGN TO DANA BUCHMAN (BRAND) AND LI & FUNG (VENDOR)          30090016
W34517             MOVE  10593 TO PAOUT-PURCH-ENT-ID                    30100016
W34517             MOVE  2875  TO PAOUT-PURCH-LBL-SEQ-NBR               30110016
W34517     END-EVALUATE.                                                30120016
W34517     MOVE PAOUT-PURCH-LBL-SEQ-NBR                                 30130016
W34517       TO BV003-PV-BRAND-IN-9.                                    30140016
W34517     MOVE PAOUT-PURCH-ENT-ID                                      30150016
W34517       TO BV003-PV-ENT-ID-IN-9.                                   30160016
W34517     MOVE ML030-PURCH-DEPT-NBR TO BV003-PV-DEPT-IN-9.             30170016
W34517     SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    30180016
W34517     MOVE ML030-PURCH-FIN-LIAB-DTE TO BV003-PV-EFF-DTE-IN.        30190016
W34517     PERFORM BV003-LOOKUP-MAIN.                                   30200016
W34517     IF BV003-UNKNOWN-INS                                         30210016
W34517        PERFORM 8200-COMMIT                                       30220016
W34517     END-IF.                                                      30230016
W34517     MOVE BV003-PV-RLTNSHP-ID-OUT TO PAOUT-PURCH-ML-LWST-ID.      30240016
W34517     PERFORM 9400-WRITE-PURCH-REC.                                30250016
W34517                                                                  30260016
      ******************************************************************30270016
      *  DISPLAY APPROPRIATE FIELDS FOR A PURCH ZERO DEPARTMENT RECORD  30280016
      ******************************************************************30290016
NHOLD$ 2910-PURCH-SKU-MATCH.                                            30300016
NHOLD$     EVALUATE TRUE                                                30310016
NHOLD$      WHEN PS-PREV-FOUND-SKU                                      30320016
NHOLD$         MOVE BV003-PV-RLTNSHP-ID-OUT  TO  PAOUT-PURCH-ML-LWST-ID 30330016
NHOLD$         MOVE BV003-PV-BRAND-OUT       TO  PAOUT-PURCH-LBL-SEQ-NBR30340016
NHOLD$         MOVE BV003-PV-ENT-ID-OUT      TO  PAOUT-PURCH-ENT-ID     30350016
NHOLD$         PERFORM 9400-WRITE-PURCH-REC                             30360016
NHOLD$      WHEN PS-PREV-EVEN-PRRTN                                     30370016
NHOLD$         PERFORM 2500-PURCH-EVEN-MAIN                             30380016
NHOLD$      END-EVALUATE.                                               30390016
      ******************************************************************30400016
      *  DISPLAY APPROPRIATE FIELDS FOR A PURCH ZERO DEPARTMENT RECORD  30410016
      ******************************************************************30420016
ZEROD  2900-PURCH-ZERO-DEPT.                                            30430016
ZEROD      DISPLAY 'ML030-PURCH-STORE-NBR: ' ML030-PURCH-STORE-NBR      30440016
ZEROD              ' ML030-PURCH-SKU: ' ML030-PURCH-SKU                 30450016
ZEROD              ' ML030-PURCH-ENT-ID: ' ML030-PURCH-ENT-ID           30460016
ZEROD      DISPLAY 'ML030-PURCH-EXTD-GRO-COST-AMT: '                    30470016
ZEROD               ML030-PURCH-EXTD-GRO-COST-AMT                       30480016
ZEROD      DISPLAY 'ML030-PURCH-FRGT-AMT: '                             30490016
ZEROD               ML030-PURCH-FRGT-AMT                                30500016
ZEROD              ' ML030-PURCH-DISC-AMT: '                            30510016
ZEROD               ML030-PURCH-DISC-AMT                                30520016
ZEROD      DISPLAY 'ML030-PURCH-EXTD-NET-COST-AMT: '                    30530016
ZEROD               ML030-PURCH-EXTD-NET-COST-AMT                       30540016
ZEROD              ' ML030-PURCH-EXTD-RTL-AMT: '                        30550016
ZEROD               ML030-PURCH-EXTD-RTL-AMT                            30560016
ZEROD      DISPLAY 'ML030-PURCH-QTY: '                                  30570016
ZEROD               ML030-PURCH-QTY                                     30580016
ZEROD               ' ML030-PURCH-PER-UNT-RTL-AMT: '                    30590016
ZEROD               ML030-PURCH-PER-UNT-RTL-AMT.                        30600016
      ******************************************************************30610016
      *  PROCESS ALL EDIT SALE RECORDS                                  30620016
      ******************************************************************30630016
W28582                                                                  30640016
W28582 3000-PROCESS-SALE-RECS.                                          30650016
W28582     SET PS-NOT-DA-ALW-OR-RTV TO TRUE                             30660016
W28582     ADD 1 TO PV-TOT-EDIT-SALE-RECS-IN                            30670016
W28582     MOVE ML022-SALE-RECORD TO SLOUT-SALE-RECORD                  30680016
ZEROD      IF ML022-SALE-DEPT-NBR EQUAL ZERO                            30690016
ZEROD         PERFORM 3900-SALE-ZERO-DEPT                               30700016
ZEROD      ELSE                                                         30710016
NHOLD$        PERFORM 6500-CHECK-HOLD-MATCH                             30720016
NHOLD$        IF PS-HOLD-MATCH AND                                      30730016
NHOLD$          (PS-PREV-FOUND-SKU OR PS-PREV-EVEN-PRRTN)               30740016
NHOLD$           PERFORM 3800-SALE-HOLD-MATCH                           30750016
NHOLD$        ELSE                                                      30760016
W34517           SET BV101-PV-BOM-NOT-FOUND                             30770016
W34517               PS-BOM-ATTR-NOT-EQUAL TO TRUE                      30780016
W34517           IF ML022-SALE-SKU NOT EQUAL ZEROES                     30790016
W34517               INITIALIZE BV101-PV-INPUT-AREA                     30800016
W34517               SET BV101-PV-SKU-LOOKUP     TO TRUE                30810016
W34517               MOVE ML022-SALE-SKU         TO BV101-PV-SKU-IN     30820016
W34517               MOVE PV-PROCESS-DATE        TO BV101-PV-EFF-DTE-IN 30830016
W34517               MOVE ML022-SALE-DEPT-NBR TO BV101-PV-DEPT-IN-9     30840016
W34517               PERFORM BV101-LOOKUP-BOM                           30850016
W34517               IF BV101-PV-BOM-FOUND                              30860016
W34517                   PERFORM 2110-CHECK-BOM-RESULT                  30870016
W34517                   SET PS-PREV-FOUND-SKU TO TRUE                  30880016
W34517                   IF BV101-BOM-ENT-ID-OUT                        30890016
W34517                                        = ML022-SALE-ENT-ID AND   30900016
W34517                      BV101-BOM-LBL-SEQ-NBR-OUT                   30910016
W34517                                       = ML022-SALE-LBL-SEQ-NBR   30920016
W34517                       SET PS-BOM-ATTR-EQUAL TO TRUE              30930016
W34517                   ELSE                                           30940016
W34517                       SET PS-BOM-ATTR-NOT-EQUAL TO TRUE          30950016
W34517*                      DISPLAY 'BOM-ATTR-NOT-EQUAL'               30960016
W34517                   END-IF                                         30970016
W34517               ELSE                                               30980016
W34517                   SET PS-BOM-ATTR-NOT-EQUAL TO TRUE              30990016
W34517*                  DISPLAY 'BOM NOT FOUND'                        31000016
W34517                   IF BV101-PV-INVALID-KEY-INPUT                  31010016
W34517                      DISPLAY '*******************************'   31020016
W34517                      DISPLAY '* ABEND: 3000-PROCESS-SALE-RECS'   31030016
W34517                      DISPLAY '* BOM LOOKUP RETURN REASON:'       31040016
W34517                      DISPLAY BV101-PV-RETURN-RSN                 31050016
W34517                      DISPLAY '*******************************'   31060016
W34517                      IF BV101-PV-BOM-SQL-ERROR                   31070016
W34517                          PERFORM 9998-SQL-ABEND                  31080016
W34517                      ELSE                                        31090016
W34517                          PERFORM 9999-OTHER-ABEND                31100016
W34517                      END-IF                                      31110016
W34517                   END-IF                                         31120016
W34517               END-IF                                             31130016
W34517           ELSE                                                   31140016
W34517               SET BV101-PV-BOM-NOT-FOUND TO TRUE                 31150016
W34517           END-IF                                                 31160016
W34517           IF BV101-PV-BOM-FOUND                                  31170016
W34517              SET PS-PREV-FOUND-SKU TO TRUE                       31180016
W34517              PERFORM 9500-WRITE-SALE-REC                         31190016
W34517           ELSE                                                   31200016
W34517*             SET IN402-PV-SKU-ATTRIB-LOOK TO TRUE                31210016
W28582              INITIALIZE IN402-PV-INPUT-AREA                      31220016
W34517              SET IN402-PV-SKU-ATTRIB-LOOK TO TRUE                31230016
W28582              MOVE ML022-SALE-SKU        TO IN402-PV-SKU-IN       31240016
W28582              MOVE ML022-SALE-DEPT-NBR   TO IN402-PV-DEPT-IN-9    31250016
W28582              MOVE '00000'               TO IN402-PV-LOC-IN       31260016
W28582              IF ML022-SALE-SKU NOT EQUAL ZEROES                  31270016
W28582                 MOVE ML022-SALE-FIN-LIAB-DTE TO                  31280016
W28582                    IN402-PV-EFF-DTE-IN                           31290016
W28582                 PERFORM IN402-LOOKUP-RETAIL                      31300016
W28582              END-IF                                              31310016
W28582              IF IN402-PV-DBV-FOUND OR                            31320016
W28582                 ML022-SALE-SKU EQUAL ZEROES OR                   31330016
W28582                 ML022-SALE-SKU EQUAL SPACES                      31340016
W28582                 IF BV003-UNKNOWN-INS                             31350016
W28582                    PERFORM 8200-COMMIT                           31360016
W28582                 END-IF                                           31370016
W28582                 IF IN402-PV-DUMMY-SKU-VALID OR                   31380016
W28582                    ML022-SALE-SKU EQUAL ZEROES OR                31390016
W28582                    ML022-SALE-SKU EQUAL SPACES                   31400016
UNCOMP                    IF ML022-SALE-ENT-ID EQUAL ZERO               31410016
W28582                       IF IN402-VND-ENT-ID-OUT NOT EQUAL ZERO     31420016
W28582                        MOVE IN402-VND-ENT-ID-OUT TO PV-DB2-ENT-ID31430016
W28582                       ELSE                                       31440016
W28582                          MOVE PC-UNKNOWN-VENDOR TO PV-DB2-ENT-ID 31450016
W28582                       END-IF                                     31460016
UNCOMP                    ELSE                                          31470016
UNCOMP                       MOVE ML022-SALE-ENT-ID TO PV-DB2-ENT-ID    31480016
UNCOMP                    END-IF                                        31490016
W28582                    MOVE ML022-SALE-DEPT-NBR TO PV-DB2-DEPT-NBR   31500016
W28582                    PERFORM 7060-GET-MAX-SLS-REG-RTL-PCT          31510016
W28582                    SET PS-PRRTN-FOR-SALE TO TRUE                 31520016
W28582                    PERFORM 6000-VNDR-BRND-PRRTN-PROCESS          31530016
W28582                 ELSE                                             31540016
W28582                    SET PS-PREV-FOUND-SKU TO TRUE                 31550016
W34517                    PERFORM 8500-INSERT-BOM                       31560016
W28582                    MOVE IN402-VND-LBL-SEQ-NBR    TO              31570016
W28582                         SLOUT-SALE-LBL-SEQ-NBR                   31580016
W28582                    MOVE IN402-VND-ENT-ID-OUT     TO              31590016
W28582                         SLOUT-SALE-ENT-ID                        31600016
W28582                    MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO           31610016
W28582                         SLOUT-SALE-ML-LWST-ID                    31620016
W28582                    PERFORM 9500-WRITE-SALE-REC                   31630016
W28582                 END-IF                                           31640016
W28582              ELSE                                                31650016
W28582                DISPLAY 'ERROR LOOKING UP VENDOR/BRAND WITH SKU: '31660016
W28582                          ML022-SALE-SKU                          31670016
W28582                 MOVE 'SAL' TO ML205-ML-TRANSACTION               31680016
W28582                 MOVE IN402-VND-LBL-SEQ-NBR TO                    31690016
W28582                    ML205-ML-VND-LBL-SEQ-NBR                      31700016
W28582                 IF IN402-PV-RETURN-RSN = SPACES                  31710016
W28582                    CONTINUE                                      31720016
W28582                 ELSE                                             31730016
W28582                    MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE     31740016
W28582                 END-IF                                           31750016
W28582                MOVE ML022-SALE-RECORD TO ML205-ML-ERROR-INPUT-REC31760016
W28582                 WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD       31770016
W28582                                                                  31780016
W28582                 MOVE SPACES TO BV-SALE-AUDIT-REC                 31790016
W28582                 WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-ERROR-LINE31800016
W28582                     AFTER ADVANCING 1 LINES                      31810016
W28582                 ADD 1 TO PV-LINE-COUNTER                         31820016
W34517*? INSERT IF ERROR LOOKING UP BV IN PRICING MODULE                31830016
W34517                 PERFORM 8500-INSERT-BOM                          31840016
W28582                 MOVE IN402-VND-LBL-SEQ-NBR    TO                 31850016
W28582                      SLOUT-SALE-LBL-SEQ-NBR                      31860016
W28582                 MOVE IN402-VND-ENT-ID-OUT     TO                 31870016
W28582                      SLOUT-SALE-ENT-ID                           31880016
W28582                 MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO              31890016
W28582                      SLOUT-SALE-ML-LWST-ID                       31900016
W28582                 PERFORM 9500-WRITE-SALE-REC                      31910016
W28582              END-IF                                              31920016
W34517           END-IF                                                 31930016
NHOLD$        END-IF                                                    31940016
ZEROD      END-IF.                                                      31950016
W28582     PERFORM 9010-READ-SALE-FILE.                                 31960016
      ******************************************************************31970016
      *  DO 13 WEEK PRORATION PROCESSING FOR A SALE TRANSACTION.        31980016
      ******************************************************************31990016
       3100-PROCESS-13WK-SALE.                                          32000016
           IF BVT00003-LBL-SEQ-NBR                                      32010016
              NOT EQUAL PV-MAX-BRAND                                    32020016
              MOVE BVT00003-SLS-REG-RTL-PCT TO PV-PRORATION-PCT         32030016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        32040016
                 COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL             32050016
                         ML022-SALE-EXTD-RTL-AMT *                      32060016
                         (PV-PRORATION-PCT / 100)                       32070016
                 COMPUTE SLOUT-SALE-EXTD-RTL-AMT ROUNDED EQUAL          32080016
                         PV-WORK-EXTD-RTL-AMT                           32090016
                 ADD SLOUT-SALE-EXTD-RTL-AMT TO                         32100016
                     PV-TOTAL-SALE-EXTD-RTL-AMT                         32110016
              END-IF                                                    32120016
           ELSE                                                         32130016
              COMPUTE SLOUT-SALE-EXTD-RTL-AMT  ROUNDED EQUAL            32140016
                      ML022-SALE-EXTD-RTL-AMT  -                        32150016
                      PV-TOTAL-SALE-EXTD-RTL-AMT                        32160016
           END-IF.                                                      32170016
                                                                        32180016
           IF PV-PRORATION-PCT NOT EQUAL ZERO OR                        32190016
              BVT00003-LBL-SEQ-NBR EQUAL PV-MAX-BRAND                   32200016
              MOVE BV003-PV-ENT-ID-OUT     TO SLOUT-SALE-ENT-ID         32210016
              MOVE BV003-PV-BRAND-OUT      TO SLOUT-SALE-LBL-SEQ-NBR    32220016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO SLOUT-SALE-ML-LWST-ID     32230016
              PERFORM 9500-WRITE-SALE-REC                               32240016
           END-IF.                                                      32250016
      ******************************************************************32260016
      *  DO EVEN PRORATION FOR A SALE TRANSACTION.                      32270016
      ******************************************************************32280016
       3200-SALE-EVEN.                                                  32290016
NHOLD$     INITIALIZE PV-BRND-PRRTN-TOTS                                32300016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            32310016
              MOVE BV003-PV-ENT-ID-OUT     TO SLOUT-SALE-ENT-ID         32320016
              MOVE BV003-PV-BRAND-OUT      TO SLOUT-SALE-LBL-SEQ-NBR    32330016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO SLOUT-SALE-ML-LWST-ID     32340016
              PERFORM 9500-WRITE-SALE-REC                               32350016
           ELSE                                                         32360016
              PERFORM                                                   32370016
                 VARYING PV-BRAND-COUNT                                 32380016
                 FROM 1 BY 1                                            32390016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           32400016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        32410016
                    COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL          32420016
                            ML022-SALE-EXTD-RTL-AMT *                   32430016
                            (PV-PRORATION-PCT / 100)                    32440016
                    COMPUTE SLOUT-SALE-EXTD-RTL-AMT ROUNDED EQUAL       32450016
                            PV-WORK-EXTD-RTL-AMT                        32460016
                    ADD SLOUT-SALE-EXTD-RTL-AMT TO                      32470016
                        PV-TOTAL-SALE-EXTD-RTL-AMT                      32480016
                 ELSE                                                   32490016
                    COMPUTE SLOUT-SALE-EXTD-RTL-AMT  ROUNDED EQUAL      32500016
                            ML022-SALE-EXTD-RTL-AMT  -                  32510016
                            PV-TOTAL-SALE-EXTD-RTL-AMT                  32520016
                 END-IF                                                 32530016
                 MOVE BV003-RT-ENT-ID-OUT(BV003-PV-RT-SUB-OUT)          32540016
                                              TO SLOUT-SALE-ENT-ID      32550016
                 MOVE BV003-RT-BRND-OUT(BV003-PV-RT-SUB-OUT)            32560016
                                              TO SLOUT-SALE-LBL-SEQ-NBR 32570016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(BV003-PV-RT-SUB-OUT)      32580016
                                              TO SLOUT-SALE-ML-LWST-ID  32590016
                 PERFORM 9500-WRITE-SALE-REC                            32600016
              END-PERFORM                                               32610016
           END-IF.                                                      32620016
      ******************************************************************32630016
      *  DISPLAY APPROPRIATE FIELDS FOR A SALE ZERO DEPARTMENT RECORD   32640016
      ******************************************************************32650016
NHOLD$ 3800-SALE-HOLD-MATCH.                                            32660016
NHOLD$     EVALUATE TRUE                                                32670016
NHOLD$      WHEN PS-PREV-FOUND-SKU                                      32680016
NHOLD$         MOVE BV003-PV-BRAND-OUT      TO                          32690016
NHOLD$              SLOUT-SALE-LBL-SEQ-NBR                              32700016
NHOLD$         MOVE BV003-PV-ENT-ID-OUT     TO SLOUT-SALE-ENT-ID        32710016
NHOLD$         MOVE BV003-PV-RLTNSHP-ID-OUT TO                          32720016
NHOLD$              SLOUT-SALE-ML-LWST-ID                               32730016
NHOLD$         PERFORM 9500-WRITE-SALE-REC                              32740016
NHOLD$      WHEN PS-PREV-EVEN-PRRTN                                     32750016
NHOLD$         PERFORM 3200-SALE-EVEN                                   32760016
NHOLD$      END-EVALUATE.                                               32770016
      ******************************************************************32780016
      *  DISPLAY APPROPRIATE FIELDS FOR A SALE ZERO DEPARTMENT RECORD   32790016
      ******************************************************************32800016
ZEROD  3900-SALE-ZERO-DEPT.                                             32810016
ZEROD      DISPLAY 'ML022-SALE-STORE-NBR: ' ML022-SALE-STORE-NBR        32820016
ZEROD              ' ML022-SALE-SKU: ' ML022-SALE-SKU                   32830016
ZEROD              ' ML022-SALE-ENT-ID: ' ML022-SALE-ENT-ID             32840016
ZEROD      DISPLAY ' ML022-SALE-EXTD-RTL-AMT: '                         32850016
ZEROD               ML022-SALE-EXTD-RTL-AMT.                            32860016
      ******************************************************************32870016
      *  PROCESS PRICE CHANGE RECORDS                                   32880016
      ******************************************************************32890016
W28582                                                                  32900016
W28582 4000-PROCESS-PCHG-RECS.                                          32910016
W28582     ADD 1 TO PV-TOT-EDIT-PCHG-RECS-IN                            32920016
W28582     MOVE ML029-PC-RECORD TO PCOUT-PC-RECORD                      32930016
ZEROD      IF ML029-PC-DEPT-NBR EQUAL ZERO                              32940016
ZEROD         PERFORM 4900-PCHG-ZERO-DEPT                               32950016
ZEROD      ELSE                                                         32960016
NHOLD$        PERFORM 6500-CHECK-HOLD-MATCH                             32970016
NHOLD$        IF PS-HOLD-MATCH     AND                                  32980016
NHOLD$          (PS-PREV-FOUND-SKU OR PS-PREV-EVEN-PRRTN)               32990016
NHOLD$           PERFORM 4800-PCHG-HOLD-MATCH                           33000016
NHOLD$        ELSE                                                      33010016
W34517           SET BV101-PV-BOM-NOT-FOUND                             33020016
W34517               PS-BOM-ATTR-NOT-EQUAL TO TRUE                      33030016
W28582           SET PS-NOT-DA-ALW-OR-RTV TO TRUE                       33040016
W28582           MOVE ML029-PC-AP-TRANS-CDE TO PS-AP-TRANS-CDE          33050016
W28582           IF PS-PCHG-AP-DA-MARKDOWN                              33060016
W28582              PERFORM 4200-PROCESS-ALW-BRND-PRRTN                 33070016
W28582           ELSE                                                   33080016
W34517              IF ML029-PC-SKU NOT EQUAL ZEROES                    33090016
W34517                  INITIALIZE BV101-PV-INPUT-AREA                  33100016
W34517                  SET BV101-PV-SKU-LOOKUP TO TRUE                 33110016
W34517                  MOVE ML029-PC-SKU       TO BV101-PV-SKU-IN      33120016
W34517                  MOVE PV-PROCESS-DATE    TO BV101-PV-EFF-DTE-IN  33130016
W34517                  MOVE ML029-PC-DEPT-NBR  TO BV101-PV-DEPT-IN-9   33140016
W34517                  PERFORM BV101-LOOKUP-BOM                        33150016
W34517                  IF BV101-PV-BOM-FOUND                           33160016
W34517                      PERFORM 2110-CHECK-BOM-RESULT               33170016
W34517                      SET PS-PREV-FOUND-SKU TO TRUE               33180016
W34517                      IF BV101-BOM-ENT-ID-OUT                     33190016
W34517                                        = ML029-PC-ENT-ID AND     33200016
W34517                         BV101-BOM-LBL-SEQ-NBR-OUT                33210016
W34517                                        = ML029-PC-LBL-SEQ-NBR    33220016
W34517                          SET PS-BOM-ATTR-EQUAL TO TRUE           33230016
W34517                      ELSE                                        33240016
W34517                          SET PS-BOM-ATTR-NOT-EQUAL TO TRUE       33250016
W34517*                         DISPLAY 'BOM-ATTR-NOT-EQUAL'            33260016
W34517                      END-IF                                      33270016
W34517                  ELSE                                            33280016
W34517                      SET PS-BOM-ATTR-NOT-EQUAL TO TRUE           33290016
W34517*                     DISPLAY 'BOM NOT FOUND'                     33300016
W34517                      IF BV101-PV-INVALID-KEY-INPUT               33310016
W34517                         DISPLAY '*******************************'33320016
W34517                         DISPLAY '* ABEND: 4000-PROCESS-PCHG-RECS'33330016
W34517                         DISPLAY '* BOM LOOKUP RETURN REASON:'    33340016
W34517                         DISPLAY BV101-PV-RETURN-RSN              33350016
W34517                         DISPLAY '*******************************'33360016
W34517                         IF BV101-PV-BOM-SQL-ERROR                33370016
W34517                             PERFORM 9998-SQL-ABEND               33380016
W34517                         ELSE                                     33390016
W34517                             PERFORM 9999-OTHER-ABEND             33400016
W34517                         END-IF                                   33410016
W34517                      END-IF                                      33420016
W34517                  END-IF                                          33430016
W34517              ELSE                                                33440016
W34517                  SET BV101-PV-BOM-NOT-FOUND TO TRUE              33450016
W34517              END-IF                                              33460016
W34517              IF BV101-PV-BOM-FOUND                               33470016
W34517                 SET PS-PREV-FOUND-SKU TO TRUE                    33480016
W34517                 PERFORM 9600-WRITE-PCHG-REC                      33490016
W34517              ELSE                                                33500016
W28582                 INITIALIZE IN402-PV-INPUT-AREA                   33510016
W28582                 MOVE ML029-PC-SKU   TO IN402-PV-SKU-IN           33520016
W28582                 MOVE ML029-PC-DEPT-NBR TO IN402-PV-DEPT-IN-9     33530016
W28582                 MOVE '00000'        TO IN402-PV-LOC-IN           33540016
SJ                     IF ML029-PC-ENT-ID NOT EQUAL ZEROES              33550016
JAS                        MOVE ML029-PC-ENT-ID TO IN402-PV-ENT-ID-IN-9 33560016
SJ                     END-IF                                           33570016
W28582                 IF ML029-PC-SKU NOT EQUAL ZEROES                 33580016
W28582                    SET IN402-PV-SKU-ATTRIB-LOOK TO TRUE          33590016
W28582                    MOVE ML029-PC-FIN-LIAB-DTE TO                 33600016
W28582                       IN402-PV-EFF-DTE-IN                        33610016
W28582                    PERFORM IN402-LOOKUP-RETAIL                   33620016
W28582                 END-IF                                           33630016
W28582                 IF IN402-PV-DBV-FOUND OR                         33640016
W28582                    ML029-PC-SKU EQUAL ZEROES OR                  33650016
W28582                    ML029-PC-SKU EQUAL SPACES                     33660016
W28582                    IF BV003-UNKNOWN-INS                          33670016
W28582                       PERFORM 8200-COMMIT                        33680016
W28582                    END-IF                                        33690016
W28582                    IF IN402-PV-DUMMY-SKU-VALID OR                33700016
W28582                       ML029-PC-SKU EQUAL ZEROES OR               33710016
W28582                       ML029-PC-SKU EQUAL SPACES                  33720016
W28582                       IF ML029-PC-ENT-ID EQUAL SPACES OR         33730016
W28582                          ML029-PC-ENT-ID EQUAL ZERO              33740016
W28582                          IF IN402-VND-ENT-ID-OUT NOT EQUAL ZERO  33750016
W28582                             MOVE IN402-VND-ENT-ID-OUT TO         33760016
W28582                                  PV-DB2-ENT-ID                   33770016
W28582                          ELSE                                    33780016
W28582                             MOVE PC-UNKNOWN-VENDOR               33790016
W28582                                                  TO PV-DB2-ENT-ID33800016
W28582                          END-IF                                  33810016
W28582                       ELSE                                       33820016
W28582                          MOVE ML029-PC-ENT-ID TO PV-DB2-ENT-ID   33830016
W28582                       END-IF                                     33840016
W28582                       MOVE ML029-PC-DEPT-NBR TO PV-DB2-DEPT-NBR  33850016
W28582                       PERFORM 7000-GET-MAX-MKDN-STR-RTL-PCT      33860016
W28582                       SET PS-PRRTN-FOR-PCHG TO TRUE              33870016
W28582                       PERFORM 6000-VNDR-BRND-PRRTN-PROCESS       33880016
W28582                    ELSE                                          33890016
W28582                       SET PS-PREV-FOUND-SKU TO TRUE              33900016
W34517                       PERFORM 8500-INSERT-BOM                    33910016
W28582                       MOVE IN402-VND-LBL-SEQ-NBR TO              33920016
W28582                            PCOUT-PC-LBL-SEQ-NBR                  33930016
W28582                       MOVE IN402-VND-ENT-ID-OUT TO               33940016
W28582                            PCOUT-PC-ENT-ID                       33950016
W28582                       MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO        33960016
W28582                            PCOUT-PC-ML-LWST-ID                   33970016
W28582                       PERFORM 9600-WRITE-PCHG-REC                33980016
W28582                    END-IF                                        33990016
W28582                 ELSE                                             34000016
W28582                    DISPLAY                                       34010016
W28582                           'ERROR LOOKING UP VNDR/BRND WITH SKU: '34020016
W28582                             ML029-PC-SKU                         34030016
W28582                    MOVE 'PRC' TO ML205-ML-TRANSACTION            34040016
W28582                    MOVE IN402-VND-LBL-SEQ-NBR TO                 34050016
W28582                       ML205-ML-VND-LBL-SEQ-NBR                   34060016
W28582                    IF IN402-PV-RETURN-RSN = SPACES               34070016
W28582                       CONTINUE                                   34080016
W28582                    ELSE                                          34090016
W28582                       MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE  34100016
W28582                    END-IF                                        34110016
W28582                    MOVE ML029-PC-RECORD                          34120016
W28582                                       TO ML205-ML-ERROR-INPUT-REC34130016
W28582                    WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD    34140016
W28582                                                                  34150016
W28582                    MOVE SPACES TO BV-PCHG-AUDIT-REC              34160016
W34517*                   WRITE BV-PURCH-AUDIT-REC FROM                 34170016
W34517                    WRITE BV-PCHG-AUDIT-REC FROM                  34180016
W28582                        DT3-PCHG-ERROR-LINE                       34190016
W28582                        AFTER ADVANCING 1 LINES                   34200016
W28582                    ADD 1 TO PV-LINE-COUNTER                      34210016
W34517*? INSERT IF ERROR LOOKING UP BV IN PRICING MODULE                34220016
W34517                    PERFORM 8500-INSERT-BOM                       34230016
W28582                    MOVE IN402-VND-LBL-SEQ-NBR TO                 34240016
W28582                         PCOUT-PC-LBL-SEQ-NBR                     34250016
W28582                    MOVE IN402-VND-ENT-ID-OUT TO                  34260016
W28582                         PCOUT-PC-ENT-ID                          34270016
W28582                    MOVE IN402-VND-ML-LO-MDSE-LVL-ID TO           34280016
W28582                         PCOUT-PC-ML-LWST-ID                      34290016
W28582                    PERFORM 9600-WRITE-PCHG-REC                   34300016
W28582                 END-IF                                           34310016
W34517              END-IF                                              34320016
W28582           END-IF                                                 34330016
NHOLD$        END-IF                                                    34340016
ZEROD      END-IF.                                                      34350016
W28582     PERFORM 9020-READ-PRC-CHG-FILE.                              34360016
      ******************************************************************34370016
      *  DO PRORATION FOR A PRICE CHANGE TRANSACTION USING THE 13 WEEK  34380016
      *  TABLE                                                          34390016
      ******************************************************************34400016
       4100-PROCESS-13WK-PCHG.                                          34410016
RONNAX     IF PS-PCHG-AP-DA-MARKDOWN                                    34420016
RONNAX        MOVE BVT00003-PADJ-DA-COST-PCT  TO PV-PRORATION-PCT       34430016
RONNAX     ELSE                                                         34440016
RONNAX        MOVE BVT00003-MKDN-STR-RTL-PCT  TO PV-PRORATION-PCT       34450016
RONNAX     END-IF.                                                      34460016
RONNAX*    MOVE BVT00003-MKDN-STR-RTL-PCT  TO PV-PRORATION-PCT          34470016
           IF BVT00003-LBL-SEQ-NBR NOT EQUAL PV-MAX-BRAND               34480016
              IF PV-PRORATION-PCT NOT EQUAL ZERO                        34490016
                 COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL             34500016
                         ML029-PC-EXTD-RTL-AMT *                        34510016
                         (PV-PRORATION-PCT / 100)                       34520016
                 COMPUTE PCOUT-PC-EXTD-RTL-AMT ROUNDED EQUAL            34530016
                         PV-WORK-EXTD-RTL-AMT                           34540016
                                                                        34550016
                 COMPUTE PV-WORK-NEW-PR-AMT ROUNDED EQUAL               34560016
                         ML029-PC-NEW-PR-AMT *                          34570016
                         (PV-PRORATION-PCT / 100)                       34580016
                 COMPUTE PCOUT-PC-NEW-PR-AMT ROUNDED EQUAL              34590016
                         PV-WORK-NEW-PR-AMT                             34600016
                                                                        34610016
                 COMPUTE PV-WORK-OLD-PR-AMT ROUNDED EQUAL               34620016
                         ML029-PC-OLD-PR-AMT *                          34630016
                         (PV-PRORATION-PCT / 100)                       34640016
                 COMPUTE PCOUT-PC-OLD-PR-AMT ROUNDED EQUAL              34650016
                         PV-WORK-OLD-PR-AMT                             34660016
                                                                        34670016
                 ADD PCOUT-PC-EXTD-RTL-AMT TO                           34680016
                     PV-TOTAL-EXTD-RTL-AMT                              34690016
                 ADD PCOUT-PC-NEW-PR-AMT   TO PV-TOTAL-NEW-PR-AMT       34700016
                 ADD PCOUT-PC-OLD-PR-AMT   TO PV-TOTAL-OLD-PR-AMT       34710016
              END-IF                                                    34720016
           ELSE                                                         34730016
              COMPUTE PCOUT-PC-EXTD-RTL-AMT EQUAL                       34740016
                      ML029-PC-EXTD-RTL-AMT - PV-TOTAL-EXTD-RTL-AMT     34750016
              COMPUTE PCOUT-PC-NEW-PR-AMT EQUAL                         34760016
                      ML029-PC-NEW-PR-AMT - PV-TOTAL-NEW-PR-AMT         34770016
              COMPUTE PCOUT-PC-OLD-PR-AMT EQUAL                         34780016
                      ML029-PC-OLD-PR-AMT - PV-TOTAL-OLD-PR-AMT         34790016
           END-IF.                                                      34800016
                                                                        34810016
           IF PV-PRORATION-PCT NOT EQUAL ZERO                           34820016
              MOVE BV003-PV-ENT-ID-OUT     TO PCOUT-PC-ENT-ID           34830016
              MOVE BV003-PV-BRAND-OUT      TO PCOUT-PC-LBL-SEQ-NBR      34840016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PCOUT-PC-ML-LWST-ID       34850016
              PERFORM 9600-WRITE-PCHG-REC                               34860016
           END-IF.                                                      34870016
      ******************************************************************34880016
      *  DO PRORATION PROCESSING FOR AN EDIT ADJUSTMENT RECORD THAT HAS 34890016
      *  A DEBIT ALLOWANCE.                                             34900016
      ******************************************************************34910016
W28582                                                                  34920016
W28582 4200-PROCESS-ALW-BRND-PRRTN.                                     34930016
NHOLD$     SET PS-PREV-DEBIT-ALLOW TO TRUE                              34940016
NHOLD$     SET PS-DA-ALW-OR-RTV TO TRUE                                 34950016
W28582     INITIALIZE PV-BRND-PRRTN-TOTS.                               34960016
W31475     INITIALIZE PV-DR-ALW-NBR.                                    34970016
W31475     INITIALIZE ML006-PARAMETERS.                                 34980016
W31475*    MOVE ML029-PC-DOC-16-NBR   TO ML006-DR-ALW-NBR               34990016
W31475*    MOVE IN-ORA-SRC-CTL-RECORD TO ML006-ORACLE-CONNECT-REC       35000016
W31475*    SET ML006-SUCCESSFUL-CALL TO TRUE                            35010016
W31475*    CALL PC-MLKUP359  USING ML006-PARAMETERS                     35020016
W31475     MOVE ML029-PC-DOC-16-NBR   TO PV-DR-ALW-NBR                  35030016
W31475     SET ML006-SUCCESSFUL-CALL TO TRUE                            35040016
W31475     PERFORM 8300-GET-DA-BRND-PRORATION.                          35050016
                                                                        35060016
W28582     IF ML006-SUCCESSFUL-CALL AND ML006-DA-PRRTN-REC-CNT > 0      35070016
W28582        PERFORM                                                   35080016
W28582           VARYING PV-BRAND-COUNT                                 35090016
W28582           FROM 1 BY 1                                            35100016
W28582           UNTIL (PV-BRAND-COUNT > ML006-DA-PRRTN-REC-CNT)        35110016
W28582           INITIALIZE BV003-PV-INPUT-AREA                         35120016
W28582*          DISPLAY 'ML029-PC-ENT-ID ' ML029-PC-ENT-ID             35130016
W28582           IF ML029-PC-ENT-ID EQUAL SPACES OR                     35140016
W28582              ML029-PC-ENT-ID EQUAL ZERO                          35150016
W28582              MOVE PC-UNKNOWN-VENDOR TO BV003-PV-ENT-ID-IN-9      35160016
W28582           ELSE                                                   35170016
W28582              MOVE ML029-PC-ENT-ID TO BV003-PV-ENT-ID-IN-9        35180016
W28582           END-IF                                                 35190016
W28582           MOVE ML029-PC-DEPT-NBR TO BV003-PV-DEPT-IN-9           35200016
W28582           MOVE ML006-DA-PRRTN-BRND(PV-BRAND-COUNT) TO            35210016
W28582                BV003-PV-BRAND-IN-9                               35220016
W28582           SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE               35230016
W28582           MOVE ML029-PC-FIN-LIAB-DTE TO BV003-PV-EFF-DTE-IN      35240016
W28582           PERFORM BV003-LOOKUP-MAIN                              35250016
W28582           IF BV003-UNKNOWN-INS                                   35260016
W28582              PERFORM 8200-COMMIT                                 35270016
W28582           END-IF                                                 35280016
W28582           IF PV-BRAND-COUNT NOT EQUAL ML006-DA-PRRTN-REC-CNT     35290016
W28582              COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL          35300016
W28582                      ML029-PC-EXTD-RTL-AMT *                     35310016
W28582                      (ML006-DA-PRRTN-PCT(PV-BRAND-COUNT)         35320016
W28582                       / 100)                                     35330016
W28582              COMPUTE PCOUT-PC-EXTD-RTL-AMT ROUNDED EQUAL         35340016
W28582                      PV-WORK-EXTD-RTL-AMT                        35350016
W28582                                                                  35360016
W28582              COMPUTE PV-WORK-NEW-PR-AMT ROUNDED EQUAL            35370016
W28582                      ML029-PC-NEW-PR-AMT *                       35380016
W28582                      (ML006-DA-PRRTN-PCT(PV-BRAND-COUNT)         35390016
W28582                       / 100)                                     35400016
W28582              COMPUTE PCOUT-PC-NEW-PR-AMT ROUNDED EQUAL           35410016
W28582                      PV-WORK-NEW-PR-AMT                          35420016
W28582                                                                  35430016
W28582              COMPUTE PV-WORK-OLD-PR-AMT ROUNDED EQUAL            35440016
W28582                      ML029-PC-OLD-PR-AMT *                       35450016
W28582                      (ML006-DA-PRRTN-PCT(PV-BRAND-COUNT)         35460016
W28582                       / 100)                                     35470016
W28582              ADD PCOUT-PC-EXTD-RTL-AMT TO                        35480016
W28582                  PV-TOTAL-EXTD-RTL-AMT                           35490016
W28582              ADD PCOUT-PC-NEW-PR-AMT   TO PV-TOTAL-NEW-PR-AMT    35500016
W28582              ADD PCOUT-PC-OLD-PR-AMT   TO PV-TOTAL-OLD-PR-AMT    35510016
W28582                                                                  35520016
W28582           ELSE                                                   35530016
W28582              COMPUTE PCOUT-PC-EXTD-RTL-AMT EQUAL                 35540016
W28582                      ML029-PC-EXTD-RTL-AMT -                     35550016
W28582                      PV-TOTAL-EXTD-RTL-AMT                       35560016
W28582              COMPUTE PCOUT-PC-NEW-PR-AMT EQUAL                   35570016
W28582                      ML029-PC-NEW-PR-AMT -                       35580016
W28582                      PV-TOTAL-NEW-PR-AMT                         35590016
W28582              COMPUTE PCOUT-PC-OLD-PR-AMT EQUAL                   35600016
W28582                      ML029-PC-OLD-PR-AMT -                       35610016
W28582                      PV-TOTAL-OLD-PR-AMT                         35620016
W28582           END-IF                                                 35630016
W28582           MOVE BV003-PV-ENT-ID-OUT     TO PCOUT-PC-ENT-ID        35640016
W28582*          DISPLAY 'PCOUT-PC-ENT-ID ' PCOUT-PC-ENT-ID             35650016
W28582           MOVE BV003-PV-BRAND-OUT      TO PCOUT-PC-LBL-SEQ-NBR   35660016
W28582           MOVE BV003-PV-RLTNSHP-ID-OUT TO PCOUT-PC-ML-LWST-ID    35670016
W28582           PERFORM 9600-WRITE-PCHG-REC                            35680016
W28582           IF BV003-PV-NO-ERRORS-FOUND OR BV003-NO-RLTNSHP-FOR-DTE35690016
W28582              CONTINUE                                            35700016
W28582           ELSE                                                   35710016
W28582              MOVE 'PRC' TO ML205-ML-TRANSACTION                  35720016
W28582              MOVE BV003-PV-BRAND-IN TO                           35730016
W28582                 ML205-ML-VND-LBL-SEQ-NBR                         35740016
W28582              STRING 'BV CALL = ' BV003-PV-LOOKUP-TYPE-IN         35750016
W28582                  DELIMITED BY SIZE                               35760016
W28582                  INTO ML205-ML-NOTE                              35770016
W28582              MOVE ML029-PC-RECORD TO ML205-ML-ERROR-INPUT-REC    35780016
W28582              WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD          35790016
W28582              DISPLAY 'ML029-PC-DOC-16-NBR: ' ML029-PC-DOC-16-NBR 35800016
W28582              DISPLAY 'BV003-PV-ENT-ID-IN: '  BV003-PV-ENT-ID-IN  35810016
W28582              DISPLAY 'BV003-PV-BRAND-IN: '   BV003-PV-BRAND-IN   35820016
W28582              DISPLAY 'BV003-PV-DEPT-IN:'     BV003-PV-DEPT-IN    35830016
W28582           END-IF                                                 35840016
W28582        END-PERFORM                                               35850016
W28582     ELSE                                                         35860016
W28582        IF ML006-ERROR-CALL OR ML006-LOGGON-ERROR                 35870016
W28582           DISPLAY 'ERROR GETTING PCHG DA BRAND PRORATION INFO'   35880016
W28582           DISPLAY 'ML029-PC-STORE-NBR: ' ML029-PC-STORE-NBR      35890016
W28582           DISPLAY 'ML029-PC-SKU: ' ML029-PC-SKU                  35900016
W28582           DISPLAY 'ML029-PC-FIN-LIAB-DTE: ' ML029-PC-FIN-LIAB-DTE35910016
W28582           DISPLAY 'ML029-PC-SYST-ORIG-CDE: '                     35920016
W28582                    ML029-PC-SYST-ORIG-CDE                        35930016
W28582           DISPLAY 'ML029-PC-TRANS-CDE: ' ML029-PC-TRANS-CDE      35940016
W28582           DISPLAY 'ML029-PC-DOC-16-NBR: ' ML029-PC-DOC-16-NBR    35950016
W28582           DISPLAY 'ML029-PC-ENT-ID: '  ML029-PC-ENT-ID           35960016
W28582           DISPLAY 'ML029-PC-LBL-SEQ-NBR: ' ML029-PC-LBL-SEQ-NBR  35970016
W28582           DISPLAY 'ML029-PC-DEPT-NBR: '   ML029-PC-DEPT-NBR      35980016
W28582           DISPLAY 'ML029-PC-ML-LWST-ID: ' ML029-PC-ML-LWST-ID    35990016
W28582           DISPLAY 'PV-TOT-EDIT-PCHG-RECS-IN '                    36000016
W28582                    PV-TOT-EDIT-PCHG-RECS-IN                      36010016
W28582           DISPLAY 'PV-TOT-EDIT-PCHG-RECS-OUT '                   36020016
W28582                    PV-TOT-EDIT-PCHG-RECS-OUT                     36030016
W28582           PERFORM 9999-OTHER-ABEND                               36040016
W28582        ELSE                                                      36050016
W28582           IF ML029-PC-ENT-ID EQUAL SPACES OR                     36060016
W28582              ML029-PC-ENT-ID EQUAL ZERO                          36070016
W28582              MOVE PC-UNKNOWN-VENDOR TO BV003-PV-ENT-ID-IN        36080016
W28582                                        PV-DB2-ENT-ID             36090016
W28582           ELSE                                                   36100016
W28582              MOVE ML029-PC-ENT-ID TO BV003-PV-ENT-ID-IN          36110016
W28582                                      PV-DB2-ENT-ID               36120016
W28582           END-IF                                                 36130016
W28582           MOVE ML029-PC-DEPT-NBR TO PV-DB2-DEPT-NBR              36140016
W28582           PERFORM 7040-GET-MAX-PADJ-DA-COST-PCT                  36150016
W28582           SET PS-PRRTN-FOR-PCHG TO TRUE                          36160016
W28582           PERFORM 6000-VNDR-BRND-PRRTN-PROCESS                   36170016
W28582        END-IF                                                    36180016
W28582     END-IF.                                                      36190016
      ******************************************************************36200016
      *  EVEN DIVIDE APPROPRIATE FIELDS ON A PRICE CHANGE REC.          36210016
      ******************************************************************36220016
       4300-PCHG-EVEN.                                                  36230016
NHOLD$     INITIALIZE PV-BRND-PRRTN-TOTS                                36240016
           IF BV003-PV-RT-SUB-OUT EQUAL ZERO                            36250016
              MOVE BV003-PV-ENT-ID-OUT     TO PCOUT-PC-ENT-ID           36260016
              MOVE BV003-PV-BRAND-OUT      TO PCOUT-PC-LBL-SEQ-NBR      36270016
              MOVE BV003-PV-RLTNSHP-ID-OUT TO PCOUT-PC-ML-LWST-ID       36280016
              PERFORM 9600-WRITE-PCHG-REC                               36290016
           ELSE                                                         36300016
              PERFORM                                                   36310016
                 VARYING PV-BRAND-COUNT                                 36320016
                 FROM 1 BY 1                                            36330016
                 UNTIL (PV-BRAND-COUNT > BV003-PV-RT-SUB-OUT)           36340016
                 IF PV-BRAND-COUNT NOT EQUAL BV003-PV-RT-SUB-OUT        36350016
                    COMPUTE PV-WORK-EXTD-RTL-AMT ROUNDED EQUAL          36360016
                            ML029-PC-EXTD-RTL-AMT *                     36370016
                            (PV-PRORATION-PCT / 100)                    36380016
                    COMPUTE PCOUT-PC-EXTD-RTL-AMT ROUNDED EQUAL         36390016
                            PV-WORK-EXTD-RTL-AMT                        36400016
                    ADD PCOUT-PC-EXTD-RTL-AMT TO                        36410016
                        PV-TOTAL-EXTD-RTL-AMT                           36420016
                 ELSE                                                   36430016
                    COMPUTE PCOUT-PC-EXTD-RTL-AMT EQUAL                 36440016
                            ML029-PC-EXTD-RTL-AMT -                     36450016
                            PV-TOTAL-EXTD-RTL-AMT                       36460016
                 END-IF                                                 36470016
                 MOVE BV003-RT-ENT-ID-OUT(BV003-PV-RT-SUB-OUT)          36480016
                                              TO PCOUT-PC-ENT-ID        36490016
                 MOVE BV003-RT-BRND-OUT(BV003-PV-RT-SUB-OUT)            36500016
                                              TO PCOUT-PC-LBL-SEQ-NBR   36510016
                 MOVE BV003-RT-RLTNSHP-ID-OUT(BV003-PV-RT-SUB-OUT)      36520016
                                              TO PCOUT-PC-ML-LWST-ID    36530016
                 PERFORM 9600-WRITE-PCHG-REC                            36540016
              END-PERFORM                                               36550016
           END-IF.                                                      36560016
      ******************************************************************36570016
      *  DISPLAY APPROPRIATE FIELDS FOR A PCHG ZERO DEPARTMENT RECORD   36580016
      ******************************************************************36590016
NHOLD$ 4800-PCHG-HOLD-MATCH.                                            36600016
NHOLD$     EVALUATE TRUE                                                36610016
NHOLD$      WHEN PS-PREV-FOUND-SKU                                      36620016
NHOLD$         MOVE BV003-PV-BRAND-OUT TO                               36630016
NHOLD$              PCOUT-PC-LBL-SEQ-NBR                                36640016
NHOLD$         MOVE BV003-PV-ENT-ID-OUT TO PCOUT-PC-ENT-ID              36650016
NHOLD$         MOVE BV003-PV-RLTNSHP-ID-OUT TO                          36660016
NHOLD$              PCOUT-PC-ML-LWST-ID                                 36670016
NHOLD$         PERFORM 9600-WRITE-PCHG-REC                              36680016
NHOLD$      WHEN PS-PREV-EVEN-PRRTN                                     36690016
NHOLD$         PERFORM 4300-PCHG-EVEN                                   36700016
NHOLD$      END-EVALUATE.                                               36710016
      ******************************************************************36720016
      *  DISPLAY APPROPRIATE FIELDS FOR A PCHG ZERO DEPARTMENT RECORD   36730016
      ******************************************************************36740016
ZEROD  4900-PCHG-ZERO-DEPT.                                             36750016
ZEROD      DISPLAY 'ML029-PC-STORE-NBR: ' ML029-PC-STORE-NBR            36760016
ZEROD              ' ML029-PC-SKU: ' ML029-PC-SKU                       36770016
ZEROD              ' ML029-PC-ENT-ID: ' ML029-PC-ENT-ID                 36780016
ZEROD      DISPLAY ' ML029-PC-EXTD-RTL-AMT: '                           36790016
ZEROD               ML029-PC-EXTD-RTL-AMT                               36800016
ZEROD              ' ML029-PC-QTY: ' ML029-PC-QTY                       36810016
ZEROD      DISPLAY 'ML029-PC-OLD-PR-AMT: '                              36820016
ZEROD               ML029-PC-OLD-PR-AMT                                 36830016
ZEROD              ' ML029-PC-NEW-PR-AMT: '                             36840016
ZEROD               ML029-PC-NEW-PR-AMT.                                36850016
      ******************************************************************36860016
      *  PROCESS ALL EDIT ADJUSTMENT RECORDS                            36870016
      ******************************************************************36880016
W28582                                                                  36890016
W28582 5000-PROCESS-ADJ-RECS.                                           36900016
W28582     SET PS-NOT-DA-ALW-OR-RTV TO TRUE                             36910016
W28582     MOVE ML024-ADJ-RECORD      TO IAOUT-ADJ-RECORD               36920016
W28582     ADD 1 TO PV-TOT-EDIT-ADJ-RECS-IN                             36930016
NHOLD$     PERFORM 6500-CHECK-HOLD-MATCH                                36940016
NHOLD$     IF PS-NO-HOLD-MATCH                                          36950016
W28582        INITIALIZE BV003-PV-INPUT-AREA                            36960016
NHOLD$        SET BV003-PV-REL-ID-LOOKUP TO TRUE                        36970016
NHOLD$        MOVE ML024-ADJ-ML-LWST-ID  TO BV003-PV-RLTNSHP-ID-IN      36980016
W28582        MOVE ML024-ADJ-FIN-LIAB-DTE TO BV003-PV-EFF-DTE-IN        36990016
W28582        PERFORM BV003-LOOKUP-MAIN                                 37000016
NHOLD$     END-IF                                                       37010016
W28582     IF BV003-UNKNOWN-INS                                         37020016
W28582        PERFORM 8200-COMMIT                                       37030016
W28582     END-IF                                                       37040016
W28582     MOVE BV003-PV-BRAND-OUT  TO IAOUT-ADJ-LBL-SEQ-NBR            37050016
W28582     MOVE BV003-PV-ENT-ID-OUT TO IAOUT-ADJ-ENT-ID                 37060016
W28582     PERFORM 9700-WRITE-ADJ-REC                                   37070016
W28582     IF BV003-PV-NO-ERRORS-FOUND                                  37080016
W28582        CONTINUE                                                  37090016
W28582     ELSE                                                         37100016
W28582        DISPLAY 'ERROR LOOKING UP BRAND WITH RELATIONSHIP ID: '   37110016
W28582                 ML024-ADJ-ML-LWST-ID                             37120016
W28582        MOVE 'ADJ' TO ML205-ML-TRANSACTION                        37130016
W28582        MOVE BV003-PV-BRAND-OUT TO                                37140016
W28582           ML205-ML-VND-LBL-SEQ-NBR                               37150016
W28582        IF IN402-PV-RETURN-RSN = SPACES                           37160016
W28582           CONTINUE                                               37170016
W28582        ELSE                                                      37180016
W28582           MOVE IN402-PV-RETURN-RSN TO ML205-ML-NOTE              37190016
W28582        END-IF                                                    37200016
W28582        MOVE ML024-ADJ-RECORD TO ML205-ML-ERROR-INPUT-REC         37210016
W28582        WRITE BV-ERROR-REC FROM ML205-ERROR-RECORD                37220016
W28582*       PERFORM 9997-BV-LOOKUP-ERROR                              37230016
W28582     END-IF                                                       37240016
W28582     PERFORM 9030-READ-ADJUSTMENT-FILE.                           37250016
      ****************************************************************  37260016
      * DO NECESSARY BASE PROCESSING FOR VENDOR BRAND PRORATION         37270016
      ****************************************************************  37280016
       6000-VNDR-BRND-PRRTN-PROCESS.                                    37290016
           INITIALIZE PV-BRND-PRRTN-TOTS                                37300016
           IF PS-13-WK-PRRTN-INFO-EXISTS                                37310016
              SET PS-MORE-BVP-RECORDS TO TRUE                           37320016
              PERFORM 8100-OPEN-BRND-PRRTN-CSR                          37330016
              PERFORM 8110-FETCH-BRND-PRRTN-CSR                         37340016
              IF PS-MORE-BVP-RECORDS                                    37350016
                 PERFORM 6010-PROCESS-VB-PRTTN-REC                      37360016
                   UNTIL PS-NO-MORE-BVP-RECORDS                         37370016
              ELSE                                                      37380016
                 SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE              37390016
              END-IF                                                    37400016
              PERFORM 8120-CLOSE-BRND-PRRTN-CSR                         37410016
           END-IF.                                                      37420016
           IF PS-NO-13-WK-PRRTN-INFO-EXISTS                             37430016
              PERFORM 6100-PRORATE-EVENLY                               37440016
NHOLD$     ELSE                                                         37450016
NHOLD$        SET PS-PREV-13-WK-PRRTN TO TRUE                           37460016
           END-IF.                                                      37470016
      ******************************************************************37480016
      *  PROCESS A RECORD ON THE BRAND PRORATION CURSOR                 37490016
      ******************************************************************37500016
W28582                                                                  37510016
W28582 6010-PROCESS-VB-PRTTN-REC.                                       37520016
W28582     INITIALIZE BV003-PV-INPUT-AREA.                              37530016
W28582     SET BV003-PV-BRND-VND-DPT-LOOKUP TO TRUE.                    37540016
W28582     MOVE PV-DB2-ENT-ID        TO BV003-PV-ENT-ID-IN.             37550016
W28582     MOVE PV-DB2-DEPT-NBR      TO BV003-PV-DEPT-IN.               37560016
W28582     MOVE BVT00003-LBL-SEQ-NBR TO BV003-PV-BRAND-IN-9.            37570016
W28582     MOVE PV-PROCESS-DATE TO BV003-PV-EFF-DTE-IN                  37580016
W28582     PERFORM BV003-LOOKUP-MAIN.                                   37590016
W28582     IF BV003-PV-NO-ERRORS-FOUND                                  37600016
W28582        IF BV003-UNKNOWN-INS                                      37610016
W28582           PERFORM 8200-COMMIT                                    37620016
W28582        END-IF                                                    37630016
W28582        EVALUATE TRUE                                             37640016
W28582           WHEN PS-PRRTN-FOR-PURCH                                37650016
W28582              IF NOT PS-PURCH-AP-TRANS-RTV                        37660016
W28582                 OR (PS-PURCH-AP-TRANS-RTV AND                    37670016
W28582                     PV-RTV-COUNT EQUAL ZERO)                     37680016
W28582                 PERFORM 2400-PROCESS-13WK-PURCH                  37690016
W28582              ELSE                                                37700016
W28582                 PERFORM 2600-PURCH-13WK-RTV-DOC-MAIN             37710016
W28582              END-IF                                              37720016
W28582           WHEN PS-PRRTN-FOR-SALE                                 37730016
W28582              PERFORM 3100-PROCESS-13WK-SALE                      37740016
W28582           WHEN PS-PRRTN-FOR-PCHG                                 37750016
W28582              PERFORM 4100-PROCESS-13WK-PCHG                      37760016
W28582           WHEN OTHER                                             37770016
W28582              DISPLAY 'PRORATION TYPE WAS NOT SET'                37780016
W28582        END-EVALUATE                                              37790016
W28582     ELSE                                                         37800016
W28582        DISPLAY 'BV003-PV-RETURN-CDE ' BV003-PV-RETURN-CDE        37810016
W28582        DISPLAY 'ENT ID ~' BV003-PV-ENT-ID-IN '~'                 37820016
W28582        DISPLAY 'DEPT   ~' BV003-PV-DEPT-IN   '~'                 37830016
W28582        DISPLAY 'BRAND  ~' BV003-PV-BRAND-IN  '~'                 37840016
W28582        DISPLAY 'ERROR LOOKING UP BRND/DEPT/VENDOR FOR PRORATION.'37850016
W28582        EVALUATE TRUE                                             37860016
W28582           WHEN PS-PRRTN-FOR-PURCH                                37870016
W28582              DISPLAY ML030-PURCH-RECORD                          37880016
W28582           WHEN PS-PRRTN-FOR-SALE                                 37890016
W28582              DISPLAY ML022-SALE-RECORD                           37900016
W28582           WHEN PS-PRRTN-FOR-PCHG                                 37910016
W28582              DISPLAY ML029-PC-RECORD                             37920016
W28582           WHEN OTHER                                             37930016
W28582              DISPLAY ML024-ADJ-RECORD                            37940016
W28582        END-EVALUATE                                              37950016
W28582        PERFORM 9997-BV-LOOKUP-ERROR                              37960016
W28582     END-IF.                                                      37970016
W28582     PERFORM 8110-FETCH-BRND-PRRTN-CSR.                           37980016
      ****************************************************************  37990016
      * BECAUSE NO RECORDS WERE FOUND ON THE 13 WEEK TABLE, WE WANT     38000016
      * TO RETRIEVE DEPARTMENT BRAND VENDOR RELATIONSHIPS FOR THE       38010016
      * SPECIFIED DEPARTMENT/VENDOR.  IF WE FIND NO CURRENTLY ACTIVE    38020016
      * ROWS, WE DO WANT TO CHECK FOR ROWS THAT EXPIRED IN THE LAST SIX 38030016
      * MONTHS.  IF NONE ARE FOUND, WE SHOULD CHECK THE FUTURE.  IF WE  38040016
      * STILL CAN'T FIND ANYTHING, WE NEED TO GET/CREATE AN KNOWN       38050016
      * VENDOR/UNKNOWN BRAND ROW FOR THE APPROPRIATE VENDOR/DEPARTMENT. 38060016
      ****************************************************************  38070016
       6100-PRORATE-EVENLY.                                             38080016
NHOLD$     IF PS-NOT-DA-ALW-OR-RTV                                      38090016
NHOLD$        SET PS-PREV-EVEN-PRRTN TO TRUE                            38100016
NHOLD$     END-IF                                                       38110016
           SET BV003-PV-VNDR-DEPT-LOOKUP TO TRUE.                       38120016
           SET BV003-VND-LOOK-PAST-FUT   TO TRUE.                       38130016
           SET BV003-USE-KNOWN-UNKNOWN   TO TRUE.                       38140016
           MOVE 6 TO BV003-PV-PAST-MONTHS.                              38150016
           MOVE PV-DB2-ENT-ID   TO BV003-PV-ENT-ID-IN.                  38160016
           MOVE PV-DB2-DEPT-NBR TO BV003-PV-DEPT-IN.                    38170016
           MOVE PV-PROCESS-DATE TO BV003-PV-EFF-DTE-IN                  38180016
           PERFORM BV003-LOOKUP-MAIN.                                   38190016
           IF BV003-PV-NO-ERRORS-FOUND                                  38200016
             IF BV003-UNKNOWN-INS                                       38210016
                PERFORM 8200-COMMIT                                     38220016
             END-IF                                                     38230016
             IF BV003-PV-RT-SUB-OUT NOT EQUAL ZERO                      38240016
                COMPUTE PV-PRORATION-PCT ROUNDED EQUAL                  38250016
                        100 / BV003-PV-RT-SUB-OUT                       38260016
             END-IF                                                     38270016
             EVALUATE TRUE                                              38280016
                WHEN PS-PRRTN-FOR-PURCH                                 38290016
                     IF NOT PS-PURCH-AP-TRANS-RTV                       38300016
                        OR (PS-PURCH-AP-TRANS-RTV AND                   38310016
                            PV-RTV-COUNT EQUAL ZERO)                    38320016
                        PERFORM 2500-PURCH-EVEN-MAIN                    38330016
                     ELSE                                               38340016
                        PERFORM 2700-PURCH-EVEN-RTV-DOC                 38350016
                     END-IF                                             38360016
                WHEN PS-PRRTN-FOR-SALE                                  38370016
                     PERFORM 3200-SALE-EVEN                             38380016
                WHEN PS-PRRTN-FOR-PCHG                                  38390016
                     PERFORM 4300-PCHG-EVEN                             38400016
             END-EVALUATE                                               38410016
           ELSE                                                         38420016
              DISPLAY 'ERROR PERFORMING VENDOR DEPARTMENT LOOKUP'       38430016
              DISPLAY 'PV-DB2-ENT-ID   ' PV-DB2-ENT-ID                  38440016
              DISPLAY 'PV-DB2-DEPT-NBR ' PV-DB2-DEPT-NBR                38450016
              EVALUATE TRUE                                             38460016
                 WHEN PS-PRRTN-FOR-PURCH                                38470016
                    DISPLAY ML030-PURCH-RECORD                          38480016
                 WHEN PS-PRRTN-FOR-SALE                                 38490016
                    DISPLAY ML022-SALE-RECORD                           38500016
                 WHEN PS-PRRTN-FOR-PCHG                                 38510016
                    DISPLAY ML029-PC-RECORD                             38520016
                 WHEN OTHER                                             38530016
                    DISPLAY ML024-ADJ-RECORD                            38540016
              END-EVALUATE                                              38550016
              PERFORM 9997-BV-LOOKUP-ERROR                              38560016
           END-IF.                                                      38570016
W34517******************************************************************38580016
W34517*  SELECT PRIM_TYP_CDE FROM TEXTENT FOR ENT_ID (VENDOR).          38590016
W34517*  IF PRIM_TYP_CDE IS 'M', IT IS A MERCHANDISE VENDOR, OTHERWISE  38600016
W34517*  IT IS AN EXPENSE VENDOR.                                       38610016
W34517******************************************************************38620016
W34517                                                                  38630016
W34517 6110-SELECT-PRIM-TYPE-CDE.                                       38640016
W34517                                                                  38650016
W34517     EXEC SQL                                                     38660016
W34517         SELECT A.PRIM_TYP_CDE                                    38670016
W34517               ,B.ENT_NAME_DESC                                   38680016
W34517           INTO :EXTENT-PRIM-TYP-CDE                              38690016
W34517               ,:ENTNME-ENT-NAME-DESC                             38700016
W34517           FROM TEXTENT A                                         38710016
W34517               ,TENTNME B                                         38720016
W34517           WHERE A.ENT_ID = :PV-DB2-ENT-ID                        38730016
W34517           AND   A.ENT_ID = B.ENT_ID                              38740016
W34517           AND   B.TYPE_CDE = '01'                                38750016
W34517         WITH UR                                                  38760016
W34517     END-EXEC.                                                    38770016
W34517                                                                  38780016
W34517     EVALUATE TRUE                                                38790016
W34517                                                                  38800016
W34517         WHEN SQLCODE = 0                                         38810016
W34517         WHEN SQLCODE = -811                                      38820016
W34517             CONTINUE                                             38830016
W34517         WHEN SQLCODE = +100                                      38840016
W34517             MOVE SPACES TO EXTENT-PRIM-TYP-CDE                   38850016
W34517                            ENTNME-ENT-NAME-DESC                  38860016
W34517         WHEN SQLCODE < +0                                        38870016
W34517         WHEN SQLCODE > +0                                        38880016
W34517              DISPLAY '6110-SELECT-PRIM-TYPE-CDE '                38890016
W34517                     DISPLAY 'GETTING PRIM_TYP_CDE  '             38900016
W34517                     PERFORM 9998-SQL-ABEND                       38910016
W34517     END-EVALUATE.                                                38920016
W34517                                                                  38930016
W34517******************************************************************38940016
W34517*  READ THE EXPENSE (NON-MERCHANDISING) VENDOR FILE.              38950016
W34517******************************************************************38960016
W34517                                                                  38970016
W34517 6120-READ-LOAD-EXP-VND.                                          38980016
W34517                                                                  38990016
W37965     PERFORM 6122-FETCH-EXP-VEN-CSR                               39000016
W34517                                                                  39010016
W34517     IF PS-EXP-VND-NOT-END                                        39020016
W34517        IF PT-EXP-VND-IDX GREATER PC-EXP-VND-MAX                  39030016
W34517            DISPLAY ' **** MAX NUMBER OF EXPENSE VENDORS EXCEEDED'39040016
W34517            DISPLAY ' **** CHECK INTERNAL WORKING STORAGE TABLE'  39050016
W34517            DISPLAY ' **** DEFINED SIZE: ' PC-EXP-VND-MAX         39060016
W34517            PERFORM 9999-OTHER-ABEND                              39070016
W34517        END-IF                                                    39080016
W37965        MOVE MLT00025-ENT-ID TO PT-EXP-VND-ID (PT-EXP-VND-IDX)    39090016
W34517        SET PT-EXP-VND-IDX UP BY 1                                39100016
W34517     END-IF.                                                      39110016
W34517                                                                  39120016
W37965******************************************************************39130016
W37965*  OPEN THE EXPENSE VENDOR CURSOR                                 39140016
W37965******************************************************************39150016
W37965 6121-OPEN-EXP-VEN-CSR.                                           39160016
W37965      EXEC SQL                                                    39170016
W37965          OPEN EXP_VEN_CSR                                        39180016
W37965      END-EXEC.                                                   39190016
W37965                                                                  39200016
W37965      EVALUATE TRUE                                               39210016
W37965          WHEN SQLCODE = +0                                       39220016
W37965              CONTINUE                                            39230016
W37965          WHEN SQLWARN NOT = SPACE                                39240016
W37965          WHEN SQLCODE NOT = +0                                   39250016
W37965              DISPLAY '**************************************'    39260016
W37965              DISPLAY '** ABEND                            **'    39270016
W37965              DISPLAY '** PARA = 6121-OPEN-EXP-VEN-CSR     **'    39280016
W37965              DISPLAY '**************************************'    39290016
W37965              PERFORM 9998-SQL-ABEND                              39300016
W37965      END-EVALUATE.                                               39310016
W37965******************************************************************39320016
W37965*  FETCH A ROW FROM THE EXPENSE VENDOR CURSOR                     39330016
W37965******************************************************************39340016
W37965 6122-FETCH-EXP-VEN-CSR.                                          39350016
W37965     EXEC SQL                                                     39360016
W37965       FETCH EXP_VEN_CSR                                          39370016
W37965         INTO :MLT00025-ENT-ID                                    39380016
W37965     END-EXEC.                                                    39390016
W37965                                                                  39400016
W37965     EVALUATE TRUE                                                39410016
W37965         WHEN SQLCODE = +0                                        39420016
W37965              CONTINUE                                            39430016
W37965         WHEN SQLCODE = +100                                      39440016
W37965             SET PS-EXP-VND-END TO TRUE                           39450016
W37965             SET PT-EXP-VND-SAV-IDX TO PT-EXP-VND-IDX             39460016
W37965         WHEN SQLWARN NOT = SPACE                                 39470016
W37965         WHEN SQLCODE NOT = +0                                    39480016
W37965              DISPLAY '**************************************'    39490016
W37965              DISPLAY '** ABEND                            **'    39500016
W37965              DISPLAY '** PARA = 6122-FETCH-EXP-VEN-CSR    **'    39510016
W37965              DISPLAY '**************************************'    39520016
W37965              PERFORM 9998-SQL-ABEND                              39530016
W37965     END-EVALUATE.                                                39540016
W37965******************************************************************39550016
W37965*  CLOSE THE EXPENSE VENDOR CURSOR                                39560016
W37965******************************************************************39570016
W37965 6123-CLOSE-EXP-VEN-CSR.                                          39580016
W37965     EXEC SQL                                                     39590016
W37965         CLOSE EXP_VEN_CSR                                        39600016
W37965     END-EXEC.                                                    39610016
W37965                                                                  39620016
W37965     EVALUATE TRUE                                                39630016
W37965         WHEN SQLCODE = +0                                        39640016
W37965             CONTINUE                                             39650016
W37965         WHEN SQLWARN NOT = SPACE                                 39660016
W37965         WHEN SQLCODE NOT = +0                                    39670016
W37965             DISPLAY '**************************************'     39680016
W37965             DISPLAY '** ABEND                            **'     39690016
W37965             DISPLAY '** PARA = 6123-CLOSE-EXP-VEN-CSR    **'     39700016
W37965             DISPLAY '**************************************'     39710016
W37965             PERFORM 9998-SQL-ABEND                               39720016
W37965     END-EVALUATE.                                                39730016
W34517******************************************************************39740016
W34517*  WRITE A RECORD TO THE UNCLASSIFIED LICENSE FEE FILE.           39750016
W34517******************************************************************39760016
W34517                                                                  39770016
W34517 6130-WRITE-UNCL-LIC-FEE.                                         39780016
W34517                                                                  39790016
W34517     WRITE BV-UNCL-LIC-REC FROM ML081-UNCL-LIC-REC.               39800016
W34517     ADD 1 TO PV-TOT-UNCL-LIC-FEE-OUT.                            39810016
W34517                                                                  39820016
W34517******************************************************************39830016
W34517*  WRITE A RECORD TO THE DEFAULT EXPENSE VENDOR FILE.             39840016
W34517******************************************************************39850016
W34517                                                                  39860016
W34517 6140-WRITE-DEF-EXP-VND.                                          39870016
W34517                                                                  39880016
W34517     WRITE BV-DEF-EXP-VND-REC FROM ML082-DEF-EXP-VND-REC.         39890016
W34517     ADD 1 TO PV-TOT-DEF-EXP-VND-OUT.                             39900016
                                                                        39910016
      ****************************************************************  39920016
      * RESET THE HOLD FIELDS                                           39930016
      ****************************************************************  39940016
NHOLD$ 6400-RESET-HOLD.                                                 39950016
NHOLD$     INITIALIZE PV-HOLD-SYS-ORIG                                  39960016
NHOLD$                PV-HOLD-TRANS-CDE                                 39970016
NHOLD$                PV-HOLD-AP-TRANS-CDE                              39980016
NHOLD$                PV-HOLD-SKU                                       39990016
NHOLD$                PV-HOLD-ENT-ID                                    40000016
J28582                PV-HOLD-DEPT-NBR                                  40010016
NHOLD$                PV-HOLD-ML-LWST-ID                                40020016
NHOLD$                PS-PREV-DBV-RLTSNHP-CHK-SW.                       40030016
      ****************************************************************  40040016
      * CHECK THE APPROPRIATE HOLD FIELDS FOR THE FILE CURRENTLY        40050016
      * BEING READ.                                                     40060016
      ****************************************************************  40070016
NHOLD$ 6500-CHECK-HOLD-MATCH.                                           40080016
NHOLD$     EVALUATE TRUE                                                40090016
NHOLD$        WHEN PV-HOLD-FILE-PADJ                                    40100016
NHOLD$             IF ML024-ADJ-ML-LWST-ID EQUAL PV-HOLD-ML-LWST-ID     40110016
NHOLD$                SET PS-HOLD-MATCH TO TRUE                         40120016
NHOLD$             ELSE                                                 40130016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      40140016
NHOLD$                MOVE ML024-ADJ-ML-LWST-ID TO PV-HOLD-ML-LWST-ID   40150016
NHOLD$             END-IF                                               40160016
NHOLD$        WHEN PV-HOLD-FILE-PCHG                                    40170016
NHOLD$             IF  ML029-PC-AP-TRANS-CDE  EQUAL PV-HOLD-AP-TRANS-CDE40180016
NHOLD$             AND ML029-PC-SKU              EQUAL PV-HOLD-SKU      40190016
NHOLD$             AND ML029-PC-ENT-ID           EQUAL PV-HOLD-ENT-ID   40200016
J28582             AND ML029-PC-DEPT-NBR         EQUAL PV-HOLD-DEPT-NBR 40210016
NHOLD$                 SET PS-HOLD-MATCH TO TRUE                        40220016
NHOLD$             ELSE                                                 40230016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      40240016
NHOLD$                MOVE ML029-PC-AP-TRANS-CDE TO                     40250016
NHOLD$                     PV-HOLD-AP-TRANS-CDE                         40260016
NHOLD$                MOVE ML029-PC-SKU             TO PV-HOLD-SKU      40270016
NHOLD$                MOVE ML029-PC-ENT-ID          TO PV-HOLD-ENT-ID   40280016
J28582                MOVE ML029-PC-DEPT-NBR        TO PV-HOLD-DEPT-NBR 40290016
NHOLD$             END-IF                                               40300016
NHOLD$        WHEN PV-HOLD-FILE-PURCH                                   40310016
NHOLD$             IF  ML030-PURCH-SYST-ORIG-CDE EQUAL PV-HOLD-SYS-ORIG 40320016
NHOLD$             AND ML030-PURCH-TRANS-CDE     EQUAL PV-HOLD-TRANS-CDE40330016
NHOLD$             AND ML030-PURCH-AP-TRANS-CDE  EQUAL                  40340016
NHOLD$                 PV-HOLD-AP-TRANS-CDE                             40350016
NHOLD$             AND ML030-PURCH-SKU           EQUAL PV-HOLD-SKU      40360016
NHOLD$             AND ML030-PURCH-ENT-ID        EQUAL PV-HOLD-ENT-ID   40370016
J28582             AND ML030-PURCH-DEPT-NBR      EQUAL PV-HOLD-DEPT-NBR 40380016
NHOLD$                 SET PS-HOLD-MATCH TO TRUE                        40390016
NHOLD$             ELSE                                                 40400016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      40410016
NHOLD$                MOVE ML030-PURCH-SYST-ORIG-CDE TO PV-HOLD-SYS-ORIG40420016
NHOLD$                MOVE ML030-PURCH-TRANS-CDE    TO PV-HOLD-TRANS-CDE40430016
NHOLD$                MOVE ML030-PURCH-AP-TRANS-CDE TO                  40440016
NHOLD$                     PV-HOLD-AP-TRANS-CDE                         40450016
NHOLD$                MOVE ML030-PURCH-SKU          TO PV-HOLD-SKU      40460016
NHOLD$                MOVE ML030-PURCH-ENT-ID       TO PV-HOLD-ENT-ID   40470016
J28582                MOVE ML030-PURCH-DEPT-NBR     TO PV-HOLD-DEPT-NBR 40480016
NHOLD$             END-IF                                               40490016
NHOLD$        WHEN PV-HOLD-FILE-SALE                                    40500016
NHOLD$             IF  ML022-SALE-SKU    EQUAL PV-HOLD-SKU              40510016
NHOLD$             AND ML022-SALE-ENT-ID EQUAL PV-HOLD-ENT-ID           40520016
J28582             AND ML022-SALE-DEPT-NBR EQUAL PV-HOLD-DEPT-NBR       40530016
NHOLD$                 SET PS-HOLD-MATCH TO TRUE                        40540016
NHOLD$             ELSE                                                 40550016
NHOLD$                SET PS-NO-HOLD-MATCH TO TRUE                      40560016
NHOLD$                MOVE ML022-SALE-SKU    TO PV-HOLD-SKU             40570016
NHOLD$                MOVE ML022-SALE-ENT-ID TO PV-HOLD-ENT-ID          40580016
J28582                MOVE ML022-SALE-DEPT-NBR TO PV-HOLD-DEPT-NBR      40590016
NHOLD$             END-IF                                               40600016
NHOLD$     END-EVALUATE.                                                40610016
      ****************************************************************  40620016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  40630016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      40640016
      * A MARKDOWN STORE RETAIL PERCENT NOT EQUAL ZERO.                 40650016
      ****************************************************************  40660016
       7000-GET-MAX-MKDN-STR-RTL-PCT.                                   40670016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    40680016
           PERFORM                                                      40690016
               WITH TEST AFTER                                          40700016
               VARYING PV-RETRY-COUNTER                                 40710016
               FROM 1 BY 1                                              40720016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               40730016
                         OR (SQLCODE = ZERO))                           40740016
                  EXEC SQL                                              40750016
                      SELECT MAX(LBL_SEQ_NBR)                           40760016
                        INTO :PV-MAX-BRAND:PV-NULL                      40770016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   40780016
                             TDTATTR DT                                 40790016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  40800016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    40810016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      40820016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    40830016
                         AND MKDN_STR_RTL_PCT     <> 0                  40840016
                  END-EXEC                                              40850016
                                                                        40860016
                  EVALUATE TRUE                                         40870016
                      WHEN SQLCODE = 0                                  40880016
                           IF PV-NULL NOT EQUAL ZERO                    40890016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 40900016
                           END-IF                                       40910016
                      WHEN SQLCODE = -904                               40920016
                      WHEN SQLCODE = -913                               40930016
                           CONTINUE                                     40940016
                      WHEN SQLWARN0 NOT = SPACES                        40950016
                      WHEN SQLCODE < +0                                 40960016
                      WHEN SQLCODE > +0                                 40970016
                           DISPLAY '7000-GET-MAX-MKDN-STR-RTL-PCT'      40980016
                           DISPLAY 'GETTING MAX BRAND '                 40990016
                           PERFORM 9998-SQL-ABEND                       41000016
                  END-EVALUATE                                          41010016
           END-PERFORM.                                                 41020016
                                                                        41030016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41040016
              DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN STORE RETAIL PCT'  41050016
              PERFORM 9998-SQL-ABEND                                    41060016
           END-IF.                                                      41070016
      ****************************************************************  41080016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  41090016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      41100016
      * A MARKDOWN BUYER RETAIL PERCENT NOT EQUAL ZERO.                 41110016
      ****************************************************************  41120016
       7010-GET-MAX-MKDN-BYR-RTL-PCT.                                   41130016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    41140016
           PERFORM                                                      41150016
               WITH TEST AFTER                                          41160016
               VARYING PV-RETRY-COUNTER                                 41170016
               FROM 1 BY 1                                              41180016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41190016
                         OR (SQLCODE = ZERO))                           41200016
                  EXEC SQL                                              41210016
                      SELECT MAX(LBL_SEQ_NBR)                           41220016
                        INTO :PV-MAX-BRAND:PV-NULL                      41230016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   41240016
                             TDTATTR DT                                 41250016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  41260016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    41270016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      41280016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    41290016
                         AND MKDN_BYR_RTL_PCT     <> 0                  41300016
                  END-EXEC                                              41310016
                                                                        41320016
                  EVALUATE TRUE                                         41330016
                      WHEN SQLCODE = 0                                  41340016
                           IF PV-NULL NOT EQUAL ZERO                    41350016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 41360016
                           END-IF                                       41370016
                      WHEN SQLCODE = -904                               41380016
                      WHEN SQLCODE = -913                               41390016
                           CONTINUE                                     41400016
                      WHEN SQLWARN0 NOT = SPACES                        41410016
                      WHEN SQLCODE < +0                                 41420016
                      WHEN SQLCODE > +0                                 41430016
                           DISPLAY '7010-GET-MAX-MKDN-BYR-RTL-PCT'      41440016
                           DISPLAY 'GETTING MAX BRAND '                 41450016
                           PERFORM 9998-SQL-ABEND                       41460016
                  END-EVALUATE                                          41470016
           END-PERFORM.                                                 41480016
                                                                        41490016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41500016
              DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN BUYER RETAIL PCT'  41510016
              PERFORM 9998-SQL-ABEND                                    41520016
           END-IF.                                                      41530016
      ****************************************************************  41540016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  41550016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      41560016
      * A RECEIPT GROSS COST PERCENT NOT EQUAL ZERO.                    41570016
      ****************************************************************  41580016
       7020-GET-MAX-RCPT-GRO-CST-PCT.                                   41590016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    41600016
           PERFORM                                                      41610016
               WITH TEST AFTER                                          41620016
               VARYING PV-RETRY-COUNTER                                 41630016
               FROM 1 BY 1                                              41640016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               41650016
                         OR (SQLCODE = ZERO))                           41660016
                  EXEC SQL                                              41670016
                      SELECT MAX(LBL_SEQ_NBR)                           41680016
                        INTO :PV-MAX-BRAND:PV-NULL                      41690016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   41700016
                             TDTATTR DT                                 41710016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  41720016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    41730016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      41740016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    41750016
                         AND RCPT_GRO_COST_PCT    <> 0                  41760016
                  END-EXEC                                              41770016
                                                                        41780016
                  EVALUATE TRUE                                         41790016
                      WHEN SQLCODE = 0                                  41800016
                           IF PV-NULL NOT EQUAL ZERO                    41810016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 41820016
                           END-IF                                       41830016
                      WHEN SQLCODE = -904                               41840016
                      WHEN SQLCODE = -913                               41850016
                           CONTINUE                                     41860016
                      WHEN SQLWARN0 NOT = SPACES                        41870016
                      WHEN SQLCODE < +0                                 41880016
                      WHEN SQLCODE > +0                                 41890016
                           DISPLAY '7020-GET-MAX-RCPT-GRO-CST-PCT'      41900016
                           DISPLAY 'GETTING MAX BRAND '                 41910016
                           PERFORM 9998-SQL-ABEND                       41920016
                  END-EVALUATE                                          41930016
           END-PERFORM.                                                 41940016
                                                                        41950016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         41960016
              DISPLAY 'RETRIES EXCEEDED FOR MARKDOWN BUYER RETAIL PCT'  41970016
              PERFORM 9998-SQL-ABEND                                    41980016
           END-IF.                                                      41990016
      ****************************************************************  42000016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  42010016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      42020016
      * AN RTV COST PERCENT NOT EQUAL ZERO.                             42030016
      ****************************************************************  42040016
       7030-GET-MAX-PADJ-RTV-COST-PCT.                                  42050016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    42060016
           PERFORM                                                      42070016
               WITH TEST AFTER                                          42080016
               VARYING PV-RETRY-COUNTER                                 42090016
               FROM 1 BY 1                                              42100016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42110016
                         OR (SQLCODE = ZERO))                           42120016
                  EXEC SQL                                              42130016
                      SELECT MAX(LBL_SEQ_NBR)                           42140016
                        INTO :PV-MAX-BRAND:PV-NULL                      42150016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   42160016
                             TDTATTR DT                                 42170016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  42180016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    42190016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      42200016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    42210016
                         AND PADJ_RTV_COST_PCT    <> 0                  42220016
                  END-EXEC                                              42230016
                                                                        42240016
                  EVALUATE TRUE                                         42250016
                      WHEN SQLCODE = 0                                  42260016
                           IF PV-NULL NOT EQUAL ZERO                    42270016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 42280016
                           END-IF                                       42290016
                      WHEN SQLCODE = -904                               42300016
                      WHEN SQLCODE = -913                               42310016
                           CONTINUE                                     42320016
                      WHEN SQLWARN0 NOT = SPACES                        42330016
                      WHEN SQLCODE < +0                                 42340016
                      WHEN SQLCODE > +0                                 42350016
                           DISPLAY '7030-GET-MAX-PADJ-RTV-COST-PCT'     42360016
                           DISPLAY 'GETTING MAX BRAND '                 42370016
                           DISPLAY 'PV-DB2-ENT-ID   ' PV-DB2-ENT-ID     42380016
                           DISPLAY 'PV-DB2-DEPT-NBR ' PV-DB2-DEPT-NBR   42390016
                           PERFORM 9998-SQL-ABEND                       42400016
                  END-EVALUATE                                          42410016
           END-PERFORM.                                                 42420016
                                                                        42430016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         42440016
              DISPLAY 'RETRIES EXCEEDED FOR RTV COST PCT'               42450016
              PERFORM 9998-SQL-ABEND                                    42460016
           END-IF.                                                      42470016
      ****************************************************************  42480016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  42490016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      42500016
      * A DA COST PERCENT NOT EQUAL ZERO.                               42510016
      ****************************************************************  42520016
       7040-GET-MAX-PADJ-DA-COST-PCT.                                   42530016
           SET PS-13-WK-PRRTN-INFO-EXISTS    TO TRUE                    42540016
           PERFORM                                                      42550016
               WITH TEST AFTER                                          42560016
               VARYING PV-RETRY-COUNTER                                 42570016
               FROM 1 BY 1                                              42580016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               42590016
                         OR (SQLCODE = ZERO))                           42600016
                  EXEC SQL                                              42610016
                      SELECT MAX(LBL_SEQ_NBR)                           42620016
                        INTO :PV-MAX-BRAND:PV-NULL                      42630016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   42640016
                             TDTATTR DT                                 42650016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  42660016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    42670016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      42680016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    42690016
                         AND PADJ_DA_COST_PCT     <> 0                  42700016
                  END-EXEC                                              42710016
                                                                        42720016
                  EVALUATE TRUE                                         42730016
                      WHEN SQLCODE = 0                                  42740016
                           IF PV-NULL NOT EQUAL ZERO                    42750016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 42760016
                           END-IF                                       42770016
                      WHEN SQLCODE = -904                               42780016
                      WHEN SQLCODE = -913                               42790016
                           CONTINUE                                     42800016
                      WHEN SQLWARN0 NOT = SPACES                        42810016
                      WHEN SQLCODE < +0                                 42820016
                      WHEN SQLCODE > +0                                 42830016
                           DISPLAY '7040-GET-MAX-PADJ-DA-COST-PCT'      42840016
                           DISPLAY 'GETTING MAX BRAND '                 42850016
                           PERFORM 9998-SQL-ABEND                       42860016
                  END-EVALUATE                                          42870016
           END-PERFORM.                                                 42880016
                                                                        42890016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         42900016
              DISPLAY 'RETRIES EXCEEDED FOR DA COST PCT'                42910016
              PERFORM 9998-SQL-ABEND                                    42920016
           END-IF.                                                      42930016
      ****************************************************************  42940016
      * GET THE HIGHEST BRAND NUMBER FOR A VENDOR/DEPT                  42950016
      * COMBINATION WITH THE CURRENT FISCAL WEEK END DATE THAT HAS      42960016
      * A DA COST AMOUNT PERCENT NOT EQUAL ZERO.                        42970016
      ****************************************************************  42980016
       7060-GET-MAX-SLS-REG-RTL-PCT.                                    42990016
           SET PS-13-WK-PRRTN-INFO-EXISTS TO TRUE                       43000016
           PERFORM                                                      43010016
               WITH TEST AFTER                                          43020016
               VARYING PV-RETRY-COUNTER                                 43030016
               FROM 1 BY 1                                              43040016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43050016
                         OR (SQLCODE = ZERO))                           43060016
                  EXEC SQL                                              43070016
                      SELECT MAX(LBL_SEQ_NBR)                           43080016
                        INTO :PV-MAX-BRAND:PV-NULL                      43090016
                        FROM BVT_BRND_PRRTN_PCT PRCH,                   43100016
                             TDTATTR DT                                 43110016
                       WHERE PRCH.FSCL_WK_END_DTE = DT.FSCL_WK_END_DTE  43120016
                         AND DT.KY_DTE            = :PV-PROCESS-DATE    43130016
                         AND PRCH.ENT_ID          = :PV-DB2-ENT-ID      43140016
                         AND PRCH.DEPT_NBR        = :PV-DB2-DEPT-NBR    43150016
                         AND SLS_REG_RTL_PCT      <> 0                  43160016
                  END-EXEC                                              43170016
                                                                        43180016
                  EVALUATE TRUE                                         43190016
                      WHEN SQLCODE = 0                                  43200016
                           IF PV-NULL NOT EQUAL ZERO                    43210016
                              SET PS-NO-13-WK-PRRTN-INFO-EXISTS TO TRUE 43220016
                           END-IF                                       43230016
                      WHEN SQLCODE = -904                               43240016
                      WHEN SQLCODE = -913                               43250016
                           CONTINUE                                     43260016
                      WHEN SQLWARN0 NOT = SPACES                        43270016
                      WHEN SQLCODE < +0                                 43280016
                      WHEN SQLCODE > +0                                 43290016
                           DISPLAY '7060-GET-MAX-SLS-REG-RTL-PCT'       43300016
                           DISPLAY 'GETTING MAX BRAND '                 43310016
                           PERFORM 9998-SQL-ABEND                       43320016
                  END-EVALUATE                                          43330016
           END-PERFORM.                                                 43340016
                                                                        43350016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         43360016
              DISPLAY 'RETRIES EXCEEDED FOR SALES PCT'                  43370016
              PERFORM 9998-SQL-ABEND                                    43380016
           END-IF.                                                      43390016
      ****************************************************************  43400016
      * VALIDATE THE CONTROL CARD DATE                                  43410016
      ****************************************************************  43420016
       7070-VALIDATE-CNTL-DATE.                                         43430016
           PERFORM                                                      43440016
               WITH TEST AFTER                                          43450016
               VARYING PV-RETRY-COUNTER                                 43460016
               FROM 1 BY 1                                              43470016
               UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43480016
                         OR (SQLCODE = ZERO))                           43490016
                  EXEC SQL                                              43500016
                     SELECT 'Y'                                         43510016
W37965                 ,FSCL_WK_END_DTE                                 43520016
                       INTO :PV-DB2-DATE-EXISTS                         43530016
W37965                      ,:DTATTR-FSCL-WK-END-DTE                    43540016
                       FROM TDTATTR                                     43550016
                      WHERE KY_DTE = :PV-PROCESS-DATE                   43560016
                  END-EXEC                                              43570016
                                                                        43580016
                  EVALUATE TRUE                                         43590016
                      WHEN SQLCODE = 0                                  43600016
                      WHEN SQLCODE = -904                               43610016
                      WHEN SQLCODE = -913                               43620016
                           CONTINUE                                     43630016
                      WHEN SQLWARN0 NOT = SPACES                        43640016
                      WHEN SQLCODE < +0                                 43650016
                      WHEN SQLCODE > +0                                 43660016
                           DISPLAY '7070-VALIDATE-CNTL-DATE'            43670016
                           DISPLAY 'GETTING CURRENT DATE'               43680016
                           PERFORM 9998-SQL-ABEND                       43690016
                  END-EVALUATE                                          43700016
           END-PERFORM.                                                 43710016
                                                                        43720016
           IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         43730016
              DISPLAY 'RETRIES EXCEEDED FOR CURRENT DATE'               43740016
              PERFORM 9998-SQL-ABEND                                    43750016
           END-IF.                                                      43760016
W34517****************************************************************  43770016
W34517* GET THE FIRST WEEK END DATE FOR 13 WEEK HISTORY                 43780016
W34517****************************************************************  43790016
W34517 7080-GET-13WK-1ST-WK-END-DTE.                                    43800016
W34517     PERFORM                                                      43810016
W34517         WITH TEST AFTER                                          43820016
W34517         VARYING PV-RETRY-COUNTER                                 43830016
W34517         FROM 1 BY 1                                              43840016
W34517         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               43850016
W34517                   OR (SQLCODE = ZERO))                           43860016
W34517            EXEC SQL                                              43870016
W34517               SELECT DISTINCT                                    43880016
W34517                      DATE(FSCL_WK_END_DTE - 91 DAYS)             43890016
W34517                 INTO :PV-13WK-1ST-WK-END-DTE                     43900016
W34517                 FROM TDTATTR                                     43910016
W34517                WHERE KY_DTE = :PV-PROCESS-DATE                   43920016
W34517            END-EXEC                                              43930016
W34517                                                                  43940016
W34517            EVALUATE TRUE                                         43950016
W34517                WHEN SQLCODE = 0                                  43960016
W34517                WHEN SQLCODE = -904                               43970016
W34517                WHEN SQLCODE = -913                               43980016
W34517                     CONTINUE                                     43990016
W34517                WHEN SQLWARN0 NOT = SPACES                        44000016
W34517                WHEN SQLCODE < +0                                 44010016
W34517                WHEN SQLCODE > +0                                 44020016
W34517                     DISPLAY '7080-GET-13WK-1ST-WK-END-DTE'       44030016
W34517                     DISPLAY 'GETTING 13 WEEK 1ST WEEK END DATE'  44040016
W34517                     PERFORM 9998-SQL-ABEND                       44050016
W34517            END-EVALUATE                                          44060016
W34517     END-PERFORM.                                                 44070016
W34517                                                                  44080016
W34517     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         44090016
W34517        DISPLAY 'RETRIES EXCEEDED FOR 13 WEEK 1ST WEEK END DATE'  44100016
W34517        PERFORM 9998-SQL-ABEND                                    44110016
W34517     END-IF.                                                      44120016
W34517****************************************************************  44130016
W34517* GET THE 13TH WEEK END DATE FOR 13 WEEK HISTORY                  44140016
W34517****************************************************************  44150016
W34517 7090-GET-13WK-13TH-WK-END-DTE.                                   44160016
W34517     PERFORM                                                      44170016
W34517         WITH TEST AFTER                                          44180016
W34517         VARYING PV-RETRY-COUNTER                                 44190016
W34517         FROM 1 BY 1                                              44200016
W34517         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               44210016
W34517                   OR (SQLCODE = ZERO))                           44220016
W34517            EXEC SQL                                              44230016
W34517               SELECT DISTINCT                                    44240016
W34517                      DATE(FSCL_WK_END_DTE - 7 DAYS)              44250016
W34517                 INTO :PV-13WK-13TH-WK-END-DTE                    44260016
W34517                 FROM TDTATTR                                     44270016
W34517                WHERE KY_DTE = :PV-PROCESS-DATE                   44280016
W34517            END-EXEC                                              44290016
W34517                                                                  44300016
W34517            EVALUATE TRUE                                         44310016
W34517                WHEN SQLCODE = 0                                  44320016
W34517                WHEN SQLCODE = -904                               44330016
W34517                WHEN SQLCODE = -913                               44340016
W34517                     CONTINUE                                     44350016
W34517                WHEN SQLWARN0 NOT = SPACES                        44360016
W34517                WHEN SQLCODE < +0                                 44370016
W34517                WHEN SQLCODE > +0                                 44380016
W34517                     DISPLAY '7090-GET-13WK-13TH-WK-END-DTE'      44390016
W34517                     DISPLAY 'GETTING 13 WEEK 13TH WEEK END DATE' 44400016
W34517                     PERFORM 9998-SQL-ABEND                       44410016
W34517            END-EVALUATE                                          44420016
W34517     END-PERFORM.                                                 44430016
W34517                                                                  44440016
W34517     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         44450016
W34517        DISPLAY 'RETRIES EXCEEDED FOR 13 WEEK 13TH WEEK END DATE' 44460016
W34517        PERFORM 9998-SQL-ABEND                                    44470016
W34517     END-IF.                                                      44480016
      ******************************************************************44490016
      *  OPEN THE RTV DOCUMENT CURSOR                                   44500016
      ******************************************************************44510016
       8000-OPEN-RTV-DOC-CSR.                                           44520016
            EXEC SQL                                                    44530016
                OPEN RTV-DOC-CSR                                        44540016
            END-EXEC.                                                   44550016
                                                                        44560016
            EVALUATE TRUE                                               44570016
                WHEN SQLCODE = +0                                       44580016
                    CONTINUE                                            44590016
                WHEN SQLWARN NOT = SPACE                                44600016
                WHEN SQLCODE NOT = +0                                   44610016
                    DISPLAY '8000-OPEN-RTV-DOC-CSR'                     44620016
                    PERFORM 9998-SQL-ABEND                              44630016
            END-EVALUATE.                                               44640016
                                                                        44650016
      ******************************************************************44660016
      *  FETCH A ROW FROM THE RTV DOCUMENT CURSOR                       44670016
      ******************************************************************44680016
       8010-FETCH-RTV-DOC-CSR.                                          44690016
           EXEC SQL                                                     44700016
             FETCH RTV-DOC-CSR                                          44710016
               INTO :DFMEIT-DFCT-ITEM-NBR                               44720016
RONNAZ*            ,:DFMEIT-MDSE-DEPT-NBR                               44730016
                   ,:DFMEIT-RTL-COST-AMT                                44740016
                   ,:DFMEIT-UNIT-COST-AMT                               44750016
           END-EXEC.                                                    44760016
                                                                        44770016
           EVALUATE TRUE                                                44780016
               WHEN SQLCODE = +0                                        44790016
                    ADD 1 TO PV-RTV-COUNT                               44800016
                    CONTINUE                                            44810016
               WHEN SQLCODE = +100                                      44820016
                   SET PS-NO-MORE-RTV-RECORDS TO TRUE                   44830016
               WHEN SQLWARN NOT = SPACE                                 44840016
               WHEN SQLCODE NOT = +0                                    44850016
                   DISPLAY '8010-FETCH-RTV-DOC-CSR'                     44860016
                   PERFORM 9998-SQL-ABEND                               44870016
           END-EVALUATE.                                                44880016
      ******************************************************************44890016
      *  CLOSE THE RTV DOCUMENT CURSOR                                  44900016
      ******************************************************************44910016
       8020-CLOSE-RTV-DOC-CSR.                                          44920016
           EXEC SQL                                                     44930016
               CLOSE RTV-DOC-CSR                                        44940016
           END-EXEC.                                                    44950016
                                                                        44960016
           EVALUATE TRUE                                                44970016
               WHEN SQLCODE = +0                                        44980016
                   CONTINUE                                             44990016
               WHEN SQLWARN NOT = SPACE                                 45000016
               WHEN SQLCODE NOT = +0                                    45010016
                   DISPLAY '8020-CLOSE-RTV-DOC-CSR'                     45020016
                   PERFORM 9998-SQL-ABEND                               45030016
           END-EVALUATE.                                                45040016
                                                                        45050016
      ******************************************************************45060016
      *  OPEN THE BRAND PRORATION CURSOR                                45070016
      ******************************************************************45080016
       8100-OPEN-BRND-PRRTN-CSR.                                        45090016
            EXEC SQL                                                    45100016
                OPEN BRND-PRRTN-CSR                                     45110016
            END-EXEC.                                                   45120016
                                                                        45130016
            EVALUATE TRUE                                               45140016
                WHEN SQLCODE = +0                                       45150016
                    CONTINUE                                            45160016
                WHEN SQLWARN NOT = SPACE                                45170016
                WHEN SQLCODE NOT = +0                                   45180016
                    DISPLAY '8100-OPEN-BRND-PRRTN-CSR'                  45190016
                    PERFORM 9998-SQL-ABEND                              45200016
            END-EVALUATE.                                               45210016
                                                                        45220016
      ******************************************************************45230016
      *  FETCH A ROW FROM THE BRNAD PRORATION CURSOR                    45240016
      ******************************************************************45250016
       8110-FETCH-BRND-PRRTN-CSR.                                       45260016
           EXEC SQL                                                     45270016
             FETCH BRND-PRRTN-CSR                                       45280016
               INTO :BVT00003-LBL-SEQ-NBR                               45290016
                   ,:BVT00003-MKDN-BYR-RTL-PCT                          45300016
                   ,:BVT00003-MKDN-STR-RTL-PCT                          45310016
                   ,:BVT00003-RCPT-GRO-COST-PCT                         45320016
                   ,:BVT00003-PADJ-DA-COST-PCT                          45330016
                   ,:BVT00003-PADJ-RTV-COST-PCT                         45340016
                   ,:BVT00003-SLS-REG-RTL-PCT                           45350016
           END-EXEC.                                                    45360016
                                                                        45370016
           EVALUATE TRUE                                                45380016
               WHEN SQLCODE = +0                                        45390016
                    CONTINUE                                            45400016
               WHEN SQLCODE = +100                                      45410016
                   SET PS-NO-MORE-BVP-RECORDS TO TRUE                   45420016
               WHEN SQLWARN NOT = SPACE                                 45430016
               WHEN SQLCODE NOT = +0                                    45440016
                   DISPLAY '8110-FETCH-BRND-PRRTN-CSR'                  45450016
                   PERFORM 9998-SQL-ABEND                               45460016
           END-EVALUATE.                                                45470016
      ******************************************************************45480016
      *  CLOSE THE BRAND PRORATION CURSOR                               45490016
      ******************************************************************45500016
       8120-CLOSE-BRND-PRRTN-CSR.                                       45510016
           EXEC SQL                                                     45520016
               CLOSE BRND-PRRTN-CSR                                     45530016
           END-EXEC.                                                    45540016
                                                                        45550016
           EVALUATE TRUE                                                45560016
               WHEN SQLCODE = +0                                        45570016
                   CONTINUE                                             45580016
               WHEN SQLWARN NOT = SPACE                                 45590016
               WHEN SQLCODE NOT = +0                                    45600016
                   DISPLAY '8120-CLOSE-BRND-PRRTN-CSR'                  45610016
                   PERFORM 9998-SQL-ABEND                               45620016
           END-EVALUATE.                                                45630016
                                                                        45640016
      ******************************************************************45650016
      *  PERFORM A DB2 COMMIT                                           45660016
      ******************************************************************45670016
       8200-COMMIT.                                                     45680016
           EXEC SQL                                                     45690016
               COMMIT                                                   45700016
           END-EXEC.                                                    45710016
                                                                        45720016
           EVALUATE TRUE                                                45730016
               WHEN SQLCODE = +0                                        45740016
                   CONTINUE                                             45750016
               WHEN SQLWARN NOT = SPACE                                 45760016
               WHEN SQLCODE NOT = +0                                    45770016
                   DISPLAY '8200-COMMIT'                                45780016
                   PERFORM 9998-SQL-ABEND                               45790016
           END-EVALUATE.                                                45800016
                                                                        45810016
W37965******************************************************************45820016
W37965*    INSERT NEW VENDOR DETAILS INTO EXPENSE VENDOR TABLE.         45830016
W37965******************************************************************45840016
W37965 8400-INSERT-EXP-VND.                                             45850016
W37965                                                                  45860016
W37965         EXEC SQL                                                 45870016
W37965             INSERT INTO MLT_VND_ALLOC                            45880016
W37965                 ( ENT_ID                                         45890016
W37965                  ,EXP_TYP_NBR                                    45900016
W37965                  ,LBL_SEQ_NBR                                    45910016
W37965                  ,EFF_BEG_DTE                                    45920016
W37965                  ,LAST_UPD_USR_ID                                45930016
W37965                  ,LAST_UPD_TMST)                                 45940016
W37965             VALUES (:MLT00025-ENT-ID                             45950016
W37965                    ,:MLT00025-EXP-TYP-NBR                        45960016
W37965                    ,:MLT00025-LBL-SEQ-NBR                        45970016
W37965                    ,:MLT00025-EFF-BEG-DTE                        45980016
W37965                    ,:MLT00025-LAST-UPD-USR-ID                    45990016
W37965                    ,:PV-CURRENT-TMST)                            46000016
W37965         END-EXEC                                                 46010016
W37965                                                                  46020016
W37965         EVALUATE SQLCODE                                         46030016
W37965             WHEN 0                                               46040016
W37965                 ADD 1     TO PV-TOT-EXP-VDR-INSERTED             46050016
W37965             WHEN OTHER                                           46060016
W37965             DISPLAY '**************************************'     46070016
W37965             DISPLAY '** ABEND                            **'     46080016
W37965             DISPLAY '** PARA = 8400-INSERT-EXP-VND       **'     46090016
W37965             DISPLAY '**************************************'     46100016
W37965             PERFORM 9998-SQL-ABEND                               46110016
W37965         END-EVALUATE.                                            46120016
W37965******************************************************************46130016
W37965*    UPDATE THE INTERNAL LOAD TABLE WITH THE NEW VENDOR.          46140016
W37965******************************************************************46150016
W37965 8410-UPDATE-INT-TABLE.                                           46160016
W37965                                                                  46170016
W37965       MOVE PV-DB2-ENT-ID TO PT-EXP-VND-ID (PT-EXP-VND-SAV-IDX)   46180016
W37965       SET PT-EXP-VND-SAV-IDX UP BY 1                             46190016
W37965       SET PT-EXP-VND-IDX-MAX UP BY 1.                            46200016
W34517******************************************************************46210016
W34517*    INSERT TO THE BEGINNING OF MONTH (BOM) SKU ATTRIBUTE TABLE.  46220016
W34517******************************************************************46230016
W34517 8500-INSERT-BOM.                                                 46240016
W34517                                                                  46250016
W34517     MOVE IN402-VND-SKU-OUT                                       46260016
W34517       TO XMT00023-SKU-NBR                                        46270016
W34517          PV-DISP-SKU-NBR.                                        46280016
W34517     MOVE BV101-BOM-FSCL-DTE-OUT                                  46290016
W34517       TO XMT00023-FSCL-BOM-DATE.                                 46300016
W34517     MOVE IN402-VND-DEPT-OUT                                      46310016
W34517       TO XMT00023-DEPT-NBR.                                      46320016
W34517     MOVE IN402-ATT-MCL-OUT                                       46330016
W34517       TO XMT00023-MAJ-CL-NBR.                                    46340016
W34517     MOVE IN402-ATT-SCL-OUT                                       46350016
W34517       TO XMT00023-SUB-CL-NBR.                                    46360016
W34517     MOVE IN402-VND-ENT-ID-OUT                                    46370016
W34517       TO XMT00023-ENT-ID.                                        46380016
W34517     MOVE IN402-VND-LBL-SEQ-NBR                                   46390016
W34517       TO XMT00023-LBL-SEQ-NBR.                                   46400016
W34517     MOVE IN402-VND-UPCID-OUT                                     46410016
W34517       TO XMT00023-INTR-UPC-ID.                                   46420016
W34517     MOVE IN402-VND-ITM-NBR-OUT                                   46430016
W34517       TO XMT00023-ITM-NBR.                                       46440016
W34517     MOVE IN402-ATT-STYL-ID-OUT                                   46450016
W34517       TO XMT00023-STYL-ID.                                       46460016
W34517     MOVE IN402-ATT-VS-NBR-OUT                                    46470016
W34517       TO XMT00023-VS-NBR.                                        46480016
W34517     MOVE IN402-ATT-VS-ID-OUT                                     46490016
W34517       TO XMT00023-VS-ID.                                         46500016
W34517                                                                  46510016
W34517     IF XMT00023-LBL-SEQ-NBR  NOT = PC-UNKNOWN-BRAND AND          46520016
W34517        XMT00023-SKU-NBR      NOT = ZEROS AND                     46530016
W34517        PV-DISP-SKU-NBR (6:3) NOT = ZEROS                         46540016
W34517         EXEC SQL                                                 46550016
W34517             INSERT INTO XMT_BOM_SKU_ATTR                         46560016
W34517                 ( SKU_NBR                                        46570016
W34517                  ,FSCL_BOM_DATE                                  46580016
W34517                  ,DEPT_NBR                                       46590016
W34517                  ,MAJ_CL_NBR                                     46600016
W34517                  ,SUB_CL_NBR                                     46610016
W34517                  ,ENT_ID                                         46620016
W34517                  ,LBL_SEQ_NBR                                    46630016
W34517                  ,INTR_UPC_ID                                    46640016
W34517                  ,ITM_NBR                                        46650016
W34517                  ,STYL_ID                                        46660016
W34517                  ,VS_NBR                                         46670016
W34517                  ,VS_ID )                                        46680016
W34517             VALUES (:XMT00023-SKU-NBR                            46690016
W34517                    ,:XMT00023-FSCL-BOM-DATE                      46700016
W34517                    ,:XMT00023-DEPT-NBR                           46710016
W34517                    ,:XMT00023-MAJ-CL-NBR                         46720016
W34517                    ,:XMT00023-SUB-CL-NBR                         46730016
W34517                    ,:XMT00023-ENT-ID                             46740016
W34517                    ,:XMT00023-LBL-SEQ-NBR                        46750016
W34517                    ,:XMT00023-INTR-UPC-ID                        46760016
W34517                    ,:XMT00023-ITM-NBR                            46770016
W34517                    ,:XMT00023-STYL-ID                            46780016
W34517                    ,:XMT00023-VS-NBR                             46790016
W34517                    ,:XMT00023-VS-ID )                            46800016
W34517         END-EXEC                                                 46810016
W34517         EVALUATE SQLCODE                                         46820016
W34517             WHEN 0                                               46830016
W34517                 ADD 1                  TO PV-TOT-BOM-INSERTED    46840016
W34517                 DISPLAY 'INSERT BOM ROW: ', PV-DISP-SKU-NBR, ' ',46850016
W34517                                            XMT00023-FSCL-BOM-DATE46860016
W34517             WHEN -803                                            46870016
W34517                 ADD 1                  TO PV-TOT-BOM-INSERT-DUPS 46880016
W34517                 DISPLAY 'DUPLICATE BOM ROW  '                    46890016
W34517                 DISPLAY 'SKU:      ' PV-DISP-SKU-NBR             46900016
W34517                 DISPLAY 'ITM:      ' BV101-PV-ITM-NBR-IN         46910016
W34517                 DISPLAY 'BOM DATE: ' XMT00023-FSCL-BOM-DATE      46920016
W34517             WHEN OTHER                                           46930016
W34517                 DISPLAY '8500-INSERT-BOM'                        46940016
W34517                 DISPLAY 'INSERT BEGINNING OF MONTH SKU ATTR'     46950016
W34517                 DISPLAY 'SKU:      ' PV-DISP-SKU-NBR             46960016
W34517                 DISPLAY 'ITM:      ' BV101-PV-ITM-NBR-IN         46970016
W34517                 DISPLAY 'BOM DATE: ' XMT00023-FSCL-BOM-DATE      46980016
W34517                 PERFORM 9998-SQL-ABEND                           46990016
W34517         END-EVALUATE                                             47000016
W34517     ELSE                                                         47010016
W34517         MOVE XMT00023-SKU-NBR     TO PV-DISP-SKU-NBR             47020016
W34517         DISPLAY 'UNKNOWN OR DUMMY NOT INSERTED TO BOM FOR SKU: ',47030016
W34517                                      PV-DISP-SKU-NBR             47040016
W34517         MOVE XMT00023-ENT-ID      TO PV-DISP-ENT-ID              47050016
W34517         DISPLAY 'ENT-ID         : ', PV-DISP-ENT-ID              47060016
W34517         MOVE XMT00023-LBL-SEQ-NBR TO PV-DISP-LBL-SEQ-NBR         47070016
W34517         DISPLAY 'LBL-SEQ-NBR    : ', PV-DISP-LBL-SEQ-NBR         47080016
W34517     END-IF.                                                      47090016
W34517                                                                  47100016
W31475******************************************************************47110016
W31475*  REWRITE OF ORACLE FUNCTIONALITY IN MLKUP359 TO DO PRORATION    47120016
W31475******************************************************************47130016
W31475 8300-GET-DA-BRND-PRORATION.                                      47140016
W31475     PERFORM 8310-OPEN-DA-BRND-PRRTN-CSR.                         47150016
W31475     SET PS-NOT-END-OF-BRND-PRRTN-CSR TO TRUE.                    47160016
W31475     PERFORM 8320-FETCH-DA-BRND-PRRTN-CSR                         47170016
W31475       UNTIL PS-END-OF-BRND-PRRTN-CSR.                            47180016
W31475     PERFORM 8390-CLOSE-DA-BRND-PRRTN-CSR.                        47190016
W31475                                                                  47200016
W31475******************************************************************47210016
W31475*  OPEN THE DA BRAND PRORATION CURSOR                             47220016
W31475******************************************************************47230016
W31475 8310-OPEN-DA-BRND-PRRTN-CSR.                                     47240016
W31475      EXEC SQL                                                    47250016
W31475          OPEN DA-BRND-PRRTN-CSR                                  47260016
W31475      END-EXEC.                                                   47270016
W31475                                                                  47280016
W31475      EVALUATE TRUE                                               47290016
W31475          WHEN SQLCODE = +0                                       47300016
W31475              CONTINUE                                            47310016
W31475          WHEN SQLWARN NOT = SPACE                                47320016
W31475          WHEN SQLCODE NOT = +0                                   47330016
W31475              DISPLAY '8310-OPEN-DA-BRND-PRRTN-CSR'               47340016
W31475              PERFORM 9998-SQL-ABEND                              47350016
W31475      END-EVALUATE.                                               47360016
W31475                                                                  47370016
W31475******************************************************************47380016
W31475*  FETCH THE DA BRAND PRORATION CURSOR                            47390016
W31475******************************************************************47400016
W31475 8320-FETCH-DA-BRND-PRRTN-CSR.                                    47410016
W31475*    INITIALIZE PV-PRRTN-PCT1                                     47420016
W31475     EXEC SQL                                                     47430016
W31475         FETCH DA-BRND-PRRTN-CSR                                  47440016
W31475         INTO                                                     47450016
W31475              :PV-LBL-SEQ-NBR                                     47460016
W31475             ,:PV-PRRTN-PCT                                       47470016
W31475     END-EXEC.                                                    47480016
W31475                                                                  47490016
W31475     EVALUATE TRUE                                                47500016
W31475       WHEN SQLCODE = ZERO                                        47510016
W31475            ADD 1 TO ML006-DA-PRRTN-REC-CNT                       47520016
W31475            MOVE PV-LBL-SEQ-NBR TO ML006-DA-PRRTN-BRND            47530016
W31475                                  (ML006-DA-PRRTN-REC-CNT)        47540016
W31475*           MOVE PV-PRRTN-PCT   TO ML006-DA-PRRTN-PCT             47550016
W31475*                                 (ML006-DA-PRRTN-REC-CNT)        47560016
W31475            COMPUTE ML006-DA-PRRTN-PCT (ML006-DA-PRRTN-REC-CNT)   47570016
W31475               ROUNDED = PV-PRRTN-PCT                             47580016
W31475       WHEN SQLCODE = +100                                        47590016
W31475             SET PS-END-OF-BRND-PRRTN-CSR TO TRUE                 47600016
W31475       WHEN SQLWARN NOT = SPACE                                   47610016
W31475       WHEN SQLCODE NOT = +0                                      47620016
W31475             DISPLAY '8320-FETCH-DA-BRND-PRRTN-CSR'               47630016
W31475             PERFORM 9998-SQL-ABEND                               47640016
W31475                                                                  47650016
W31475     END-EVALUATE.                                                47660016
W31475******************************************************************47670016
W31475*  CLOSE THE DA BRAND PRORATION CURSOR                            47680016
W31475******************************************************************47690016
W31475 8390-CLOSE-DA-BRND-PRRTN-CSR.                                    47700016
W31475      EXEC SQL                                                    47710016
W31475          CLOSE DA-BRND-PRRTN-CSR                                 47720016
W31475      END-EXEC.                                                   47730016
W31475                                                                  47740016
W31475      EVALUATE TRUE                                               47750016
W31475          WHEN SQLCODE = +0                                       47760016
W31475              CONTINUE                                            47770016
W31475          WHEN SQLWARN NOT = SPACE                                47780016
W31475          WHEN SQLCODE NOT = +0                                   47790016
W31475              DISPLAY '8390-CLOSE-DA-BRND-PRRTN-CSR'              47800016
W31475              PERFORM 9998-SQL-ABEND                              47810016
W31475      END-EVALUATE.                                               47820016
W31475                                                                  47830016
      ******************************************************************47840016
      *  BRAND VENDOR RELATIONSHIP UTILITY FUNCTIONS.                   47850016
      ******************************************************************47860016
      *    COPY BVPD001.                                                47870016
      ******************************************************************47880016
      *  READ THE NEXT RECORD FROM THE EDIT PURCH FILE.                 47890016
      ******************************************************************47900016
       9000-READ-PURCH-FILE.                                            47910016
           READ PURCH-FILE                                              47920016
               INTO ML030-PURCH-RECORD                                  47930016
               AT END                                                   47940016
                   SET PS-NO-MORE-PURCH-RECORDS TO TRUE.                47950016
W28582     IF PS-NO-MORE-PURCH-RECORDS                                  47960016
W28582        CONTINUE                                                  47970016
W28582     ELSE                                                         47980016
W28582        MOVE 1 TO DP150-REPORT-NUMBER                             47990016
W28582        PERFORM 9200-WRITE-PURCH-REPORT                           48000016
W28582        IF PS-RESTART-RUN                                         48010016
W28582            ADD 1 TO PV-RESTART-COUNT                             48020016
W28582        END-IF                                                    48030016
W28582     END-IF                                                       48040016
W37965     PERFORM 9305-MOVE-PURCH-DETAIL-AUDIT.                        48050016
      ******************************************************************48060016
      *  READ THE NEXT RECORD FROM THE EDIT SALE FILE.                  48070016
      ******************************************************************48080016
       9010-READ-SALE-FILE.                                             48090016
           READ SALE-FILE                                               48100016
               INTO ML022-SALE-RECORD                                   48110016
               AT END                                                   48120016
                   SET PS-NO-MORE-SALE-RECORDS TO TRUE.                 48130016
W28582     IF PS-NO-MORE-SALE-RECORDS                                   48140016
W28582        CONTINUE                                                  48150016
W28582     ELSE                                                         48160016
W28582        MOVE 2 TO DP132-REPORT-NUMBER                             48170016
W28582        PERFORM 9200-WRITE-SALES-REPORT                           48180016
W28582        IF PS-RESTART-RUN                                         48190016
W28582            ADD 1 TO PV-RESTART-COUNT                             48200016
W28582        END-IF                                                    48210016
W28582     END-IF.                                                      48220016
W37965     PERFORM 9307-MOVE-SALE-DETAIL-AUDIT.                         48230016
      ******************************************************************48240016
      *  READ THE NEXT RECORD FROM THE EDIT PRICE CHANGE FILE.          48250016
      ******************************************************************48260016
       9020-READ-PRC-CHG-FILE.                                          48270016
           READ PRC-CHG-FILE                                            48280016
               INTO ML029-PC-RECORD                                     48290016
               AT END                                                   48300016
                   SET PS-NO-MORE-PCHG-RECORDS TO TRUE.                 48310016
W28582     IF PS-NO-MORE-PCHG-RECORDS                                   48320016
W28582        CONTINUE                                                  48330016
W28582     ELSE                                                         48340016
W28582        MOVE 3 TO DP132-REPORT-NUMBER                             48350016
W28582        PERFORM 9200-WRITE-PCHG-REPORT                            48360016
W28582        IF PS-RESTART-RUN                                         48370016
W28582            ADD 1 TO PV-RESTART-COUNT                             48380016
W28582        END-IF                                                    48390016
W28582     END-IF.                                                      48400016
W37965     PERFORM 9309-MOVE-PCHG-DETAIL-AUDIT.                         48410016
      ******************************************************************48420016
      *  READ THE NEXT RECORD FROM THE INVENTORY ADJUSTMENT FILE.       48430016
      ******************************************************************48440016
       9030-READ-ADJUSTMENT-FILE.                                       48450016
           READ ADJUSTMENT-FILE                                         48460016
               INTO ML024-ADJ-RECORD                                    48470016
               AT END                                                   48480016
                   SET PS-NO-MORE-ADJ-RECORDS TO TRUE.                  48490016
W28582     IF PS-NO-MORE-ADJ-RECORDS                                    48500016
W28582        CONTINUE                                                  48510016
W28582     ELSE                                                         48520016
W28582        MOVE 4 TO DP132-REPORT-NUMBER                             48530016
W28582        PERFORM 9200-WRITE-ADJ-REPORT                             48540016
W28582        IF PS-RESTART-RUN                                         48550016
W28582            ADD 1 TO PV-RESTART-COUNT                             48560016
W28582        END-IF                                                    48570016
W28582     END-IF.                                                      48580016
                                                                        48590016
      ******************************************************************48600016
      * 9040-READ-ORACLE-SRC-CTL.                                       48610016
      *     THE ROUTINE READS IN THE ORACLE SOURCE CONTROL CARD MLCC07*.48620016
      * THE CARD DEFINES WHICH ORACLE ENVIRONMENT WE ARE PROCESSING     48630016
      * FROM.  THIS INFORMATION IS USED BY MLKUP359 WHEN PROCESSING     48640016
      * DEBIT ALLOWANCE TRANSACTIONS.                                   48650016
      ******************************************************************48660016
       9040-READ-ORACLE-SRC-CTL.                                        48670016
           READ IN-ORACLE-SRC-CTL NEXT                                  48680016
               AT END  SET PS-NO-MORE-ORACLE-CC TO TRUE.                48690016
                                                                        48700016
           IF PS-NO-MORE-ORACLE-CC                                      48710016
             DISPLAY '**********************************'               48720016
             DISPLAY '* ABEND: 1000-INITIALIZATION'                     48730016
             DISPLAY '*   MISSING CONTROL CARD MLCC07* INFORMATION'     48740016
             DISPLAY '* THE PROGRAM WILL ABEND'                         48750016
             DISPLAY '**********************************'               48760016
             PERFORM 9999-OTHER-ABEND                                   48770016
           ELSE                                                         48780016
             MOVE IOC-SRC-SYSTEM TO PV-EDIT-ORA-SOURCE                  48790016
             IF (NOT VALID-ORACLE-CONNECT-STRING)                       48800016
               DISPLAY '**********************************'             48810016
               DISPLAY '* ABEND: 1000-INITIALIZATION'                   48820016
               DISPLAY '*   INVALID ORACLE SOURCE SYSTEM INFORMATION'   48830016
               DISPLAY '* EXISTS IN CONTROL CARD MLCC07*'               48840016
               DISPLAY '**********************************'             48850016
               PERFORM 9999-OTHER-ABEND                                 48860016
           END-IF.                                                      48870016
      ******************************************************************48880016
      * 9050-READ-CNTL-DATE.                                            48890016
W34517* - GET THE 1ST AND LAST WEEK END DATES FOR 13 WEEK HISTORY USING 48900016
W34517*   THE CONTROL CARD DATE.                                        48910016
      ******************************************************************48920016
       9050-READ-CNTL-DTE.                                              48930016
           READ CNTL-DATE-FILE INTO CC-CONTROL-CARD                     48940016
               AT END                                                   48950016
                   DISPLAY '** PROGRAM ABEND **'                        48960016
                   DISPLAY 'MLKUP364  - CONTROL DATE EMPTY'             48970016
                   PERFORM 9999-OTHER-ABEND.                            48980016
                                                                        48990016
           DISPLAY '** MLKUP364 CONTROL CARD:' CNTL-DATE-REC            49000016
                                                                        49010016
           MOVE CC-PROC-DATE-ISO TO PV-PROCESS-DATE                     49020016
           PERFORM 7070-VALIDATE-CNTL-DATE.                             49030016
W34517                                                                  49040016
W34517     PERFORM 7080-GET-13WK-1ST-WK-END-DTE.                        49050016
W34517                                                                  49060016
W34517     PERFORM 7090-GET-13WK-13TH-WK-END-DTE.                       49070016
W28582                                                                  49080016
W28582******************************************************************49090016
W28582* 9051-READ-CNTL-JOB.                                             49100016
W28582******************************************************************49110016
W28582 9051-READ-CNTL-JOB.                                              49120016
W28582     READ CNTL-JOB-FILE INTO CC-CONTROL-JOB                       49130016
W28582         AT END                                                   49140016
W28582             DISPLAY '** PROGRAM ABEND **'                        49150016
W28582             DISPLAY 'MLKUP364  - CONTROL JOB EMPTY'              49160016
W28582             PERFORM 9999-OTHER-ABEND.                            49170016
W28582                                                                  49180016
W28582     DISPLAY '** MLKUP364 CONTROL JOB:' CNTL-JOB-REC              49190016
W28582                                                                  49200016
W28582     MOVE CC-JOB-NAME TO PC-JOB-NAME.                             49210016
W37965******************************************************************49220016
W37965* 9052-READ-ENT-TYPE-FILE.                                        49230016
W37965******************************************************************49240016
W37965 9052-READ-ENT-TYPE-FILE.                                         49250016
W37965                                                                  49260016
W37965     READ ENT-TYPE-FILE                                           49270016
W37965         INTO CC-ENT-TYP-CONTROL-CARD                             49280016
W37965         AT END SET PS-END-OF-ENT-TYPE-FILE TO TRUE               49290016
W37965         DISPLAY 'NO USER DEFINED ENT TYPES - DEFAULTS USED'      49300016
W37965         NOT AT END                                               49310016
W37965              PERFORM 9053-SET-UP-VARIABLES                       49320016
W37965     END-READ.                                                    49330016
W37965                                                                  49340016
W37965******************************************************************49350016
W37965* 9053-SET-UP-VARIABLES.                                          49360016
W37965******************************************************************49370016
W37965 9053-SET-UP-VARIABLES.                                           49380016
W37965                                                                  49390016
W37965     DISPLAY 'CC-ENT-TYP: ' CC-ENT-TYP.                           49400016
W37965                                                                  49410016
W37965     EVALUATE TRUE                                                49420016
W37965* * * 01,02,03                                                    49430016
W37965           WHEN CC-ENT-TYP = PC-FRGT-SALV-LICENSE-FEE             49440016
W37965                MOVE +1  TO PV-EXP-TYPE1                          49450016
W37965                MOVE +2  TO PV-EXP-TYPE2                          49460016
W37965                MOVE +3  TO PV-EXP-TYPE3                          49470016
W37965                            PV-EXP-TYPE4                          49480016
W37965                            PV-EXP-TYPE5                          49490016
W37965                            PV-EXP-TYPE6                          49500016
W37965                            PV-EXP-TYPE7                          49510016
W37965                            PV-EXP-TYPE8                          49520016
W37965                            PV-EXP-TYPE9                          49530016
W37965                            PV-EXP-TYPE10                         49540016
W37965                                                                  49550016
W37965* * * 01,02                                                       49560016
W37965           WHEN CC-ENT-TYP = PC-FRGT-SALV                         49570016
W37965                MOVE +1  TO PV-EXP-TYPE1                          49580016
W37965                MOVE +2  TO PV-EXP-TYPE2                          49590016
W37965                            PV-EXP-TYPE3                          49600016
W37965                            PV-EXP-TYPE4                          49610016
W37965                            PV-EXP-TYPE5                          49620016
W37965                            PV-EXP-TYPE6                          49630016
W37965                            PV-EXP-TYPE7                          49640016
W37965                            PV-EXP-TYPE8                          49650016
W37965                            PV-EXP-TYPE9                          49660016
W37965                            PV-EXP-TYPE10                         49670016
W37965                                                                  49680016
W37965* * * 03                                                          49690016
W37965           WHEN CC-ENT-TYP = PC-LICENSE-FEE                       49700016
W37965                MOVE +3  TO PV-EXP-TYPE1                          49710016
W37965                            PV-EXP-TYPE2                          49720016
W37965                            PV-EXP-TYPE3                          49730016
W37965                            PV-EXP-TYPE4                          49740016
W37965                            PV-EXP-TYPE5                          49750016
W37965                            PV-EXP-TYPE6                          49760016
W37965                            PV-EXP-TYPE7                          49770016
W37965                            PV-EXP-TYPE8                          49780016
W37965                            PV-EXP-TYPE9                          49790016
W37965                            PV-EXP-TYPE10                         49800016
W37965                                                                  49810016
W37965           WHEN OTHER                                             49820016
W37965                DISPLAY 'USER DEFINED ENT TYPES NOT RECOGNIZED'   49830016
W37965                DISPLAY 'DEFAULTS WERE USED'                      49840016
W37965     END-EVALUATE.                                                49850016
W28582******************************************************************49860016
W28582* 9201-MOVE-PURCH-DETAIL                                          49870016
W28582******************************************************************49880016
W28582 9201-MOVE-PURCH-DETAIL.                                          49890016
W28582     MOVE ML030-PURCH-SYST-ORIG-CDE TO DT1-SYST-ORIG-CDE          49900016
W28582     MOVE ML030-PURCH-TRANS-CDE     TO DT1-PURCH-TRANS-CDE        49910016
W28582     MOVE ML030-PURCH-AP-TRANS-CDE  TO DT1-AP-TRANS-CDE           49920016
W28582     MOVE ML030-PURCH-SKU           TO DT1-SKU                    49930016
W28582     MOVE ML030-PURCH-STORE-NBR     TO DT1-LOC                    49940016
W28582     MOVE ML030-PURCH-DEPT-NBR      TO DT1-DEPT                   49950016
W28582     MOVE ML030-PURCH-EXTD-GRO-COST-AMT                           49960016
W28582                                    TO DT1-GROSS-COST-AMT         49970016
W28582     MOVE ML030-PURCH-FRGT-AMT      TO DT1-FRGT-AMT               49980016
W28582     MOVE ML030-PURCH-DISC-AMT      TO DT1-DISC-AMT               49990016
W28582     MOVE ML030-PURCH-EXTD-NET-COST-AMT                           50000016
W28582                                    TO DT1-NET-COST-AMT           50010016
W28582     MOVE ML030-PURCH-EXTD-RTL-AMT  TO DT1-EXTD-RTL-AMT           50020016
W28582     MOVE ML030-PURCH-PER-UNT-RTL-AMT                             50030016
W28582                                    TO DT1-UNT-RTL-AMT            50040016
W28582     MOVE ML030-PURCH-ENT-ID        TO DT1-ENT-ID                 50050016
W28582     MOVE ML030-PURCH-LBL-SEQ-NBR   TO DT1-LBL-SEQ-NBR            50060016
W28582     MOVE ML030-PURCH-ML-LWST-ID    TO DT1-ML-LWST-ID.            50070016
W28582******************************************************************50080016
W28582* 9200-WRITE-SALES-REPORT                                         50090016
W28582******************************************************************50100016
W28582 9200-WRITE-SALES-REPORT.                                         50110016
W28582     IF PV-LINE-COUNTER < 51                                      50120016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          50130016
W28582        PERFORM 9202-MOVE-SALES-DETAIL                            50140016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             50150016
W28582            AFTER ADVANCING 2 LINES                               50160016
W28582        ADD 2 TO PV-LINE-COUNTER                                  50170016
W28582     ELSE                                                         50180016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          50190016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  50200016
W28582        MOVE PV-PAGE-COUNTER TO DP132-PAGE-NUMBER                 50210016
W28582        WRITE BV-SALE-AUDIT-REC FROM DP132-STANDRD-HEADER-132-COLS50220016
W28582            AFTER ADVANCING PAGE                                  50230016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          50240016
W28582        WRITE BV-SALE-AUDIT-REC FROM HL2-HEADING-LINE-1           50250016
W28582            AFTER ADVANCING 2 LINES                               50260016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          50270016
W28582        WRITE BV-SALE-AUDIT-REC FROM HL2-HEADING-LINE-2           50280016
W28582            AFTER ADVANCING 1 LINES                               50290016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          50300016
W28582        WRITE BV-SALE-AUDIT-REC FROM HL2-HEADING-LINE-3           50310016
W28582            AFTER ADVANCING 1 LINES                               50320016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          50330016
W28582        PERFORM 9202-MOVE-SALES-DETAIL                            50340016
W28582        MOVE 8 TO PV-LINE-COUNTER                                 50350016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             50360016
W28582            AFTER ADVANCING 2 LINES                               50370016
W28582     END-IF.                                                      50380016
W28582******************************************************************50390016
W28582* 9200-WRITE-ADJ-REPORT                                           50400016
W28582******************************************************************50410016
W28582 9200-WRITE-ADJ-REPORT.                                           50420016
W28582     IF PV-LINE-COUNTER < 51                                      50430016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           50440016
W28582        PERFORM 9204-MOVE-ADJ-DETAIL                              50450016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                50460016
W28582            AFTER ADVANCING 2 LINES                               50470016
W28582        ADD 2 TO PV-LINE-COUNTER                                  50480016
W28582     ELSE                                                         50490016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           50500016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  50510016
W28582        MOVE PV-PAGE-COUNTER TO DP132-PAGE-NUMBER                 50520016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DP132-STANDRD-HEADER-132-COLS 50530016
W28582            AFTER ADVANCING PAGE                                  50540016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           50550016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-1            50560016
W28582            AFTER ADVANCING 2 LINES                               50570016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           50580016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-2            50590016
W28582            AFTER ADVANCING 1 LINES                               50600016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           50610016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-3            50620016
W28582            AFTER ADVANCING 1 LINES                               50630016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           50640016
W28582        WRITE BV-ADJ-AUDIT-REC FROM HL4-HEADING-LINE-4            50650016
W28582            AFTER ADVANCING 1 LINES                               50660016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           50670016
W28582        PERFORM 9204-MOVE-ADJ-DETAIL                              50680016
W28582        MOVE 9 TO PV-LINE-COUNTER                                 50690016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                50700016
W28582            AFTER ADVANCING 2 LINES                               50710016
W28582     END-IF.                                                      50720016
W28582******************************************************************50730016
W28582* 9200-WRITE-PURCH-REPORT                                         50740016
W28582******************************************************************50750016
W28582 9200-WRITE-PURCH-REPORT.                                         50760016
W28582     IF PV-LINE-COUNTER < 51                                      50770016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         50780016
W28582        PERFORM 9201-MOVE-PURCH-DETAIL                            50790016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            50800016
W28582            AFTER ADVANCING 2 LINES                               50810016
W28582        ADD 2 TO PV-LINE-COUNTER                                  50820016
W28582     ELSE                                                         50830016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         50840016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  50850016
W28582        MOVE PV-PAGE-COUNTER TO DP150-PAGE-NUMBER                 50860016
W28582        WRITE BV-PURCH-AUDIT-REC FROM                             50870016
W28582           DP150-STANDRD-HEADER-150-COLS                          50880016
W28582           AFTER ADVANCING PAGE                                   50890016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         50900016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-1          50910016
W28582            AFTER ADVANCING 2 LINES                               50920016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         50930016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-2          50940016
W28582            AFTER ADVANCING 1 LINES                               50950016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         50960016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-3          50970016
W28582            AFTER ADVANCING 1 LINES                               50980016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         50990016
W28582        WRITE BV-PURCH-AUDIT-REC FROM HL1-HEADING-LINE-4          51000016
W28582            AFTER ADVANCING 1 LINES                               51010016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         51020016
W28582        PERFORM 9201-MOVE-PURCH-DETAIL                            51030016
W28582        MOVE 9 TO PV-LINE-COUNTER                                 51040016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            51050016
W28582            AFTER ADVANCING 2 LINES                               51060016
W28582     END-IF.                                                      51070016
W28582******************************************************************51080016
W28582* 9200-WRITE-PCHG-REPORT                                          51090016
W28582******************************************************************51100016
W28582 9200-WRITE-PCHG-REPORT.                                          51110016
W28582     IF PV-LINE-COUNTER < 51                                      51120016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          51130016
W28582        PERFORM 9203-MOVE-PCHG-DETAIL                             51140016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              51150016
W28582            AFTER ADVANCING 2 LINES                               51160016
W28582        ADD 2 TO PV-LINE-COUNTER                                  51170016
W28582     ELSE                                                         51180016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          51190016
W28582        ADD 1 TO PV-PAGE-COUNTER                                  51200016
W28582        MOVE PV-PAGE-COUNTER TO DP132-PAGE-NUMBER                 51210016
W28582        WRITE BV-PCHG-AUDIT-REC FROM                              51220016
W28582           DP132-STANDRD-HEADER-132-COLS                          51230016
W28582           AFTER ADVANCING PAGE                                   51240016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          51250016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-1           51260016
W28582            AFTER ADVANCING 2 LINES                               51270016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          51280016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-2           51290016
W28582            AFTER ADVANCING 1 LINES                               51300016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          51310016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-3           51320016
W28582            AFTER ADVANCING 1 LINES                               51330016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          51340016
W28582        WRITE BV-PCHG-AUDIT-REC FROM HL3-HEADING-LINE-4           51350016
W28582            AFTER ADVANCING 1 LINES                               51360016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          51370016
W28582        PERFORM 9203-MOVE-PCHG-DETAIL                             51380016
W28582        MOVE 9 TO PV-LINE-COUNTER                                 51390016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              51400016
W28582            AFTER ADVANCING 2 LINES                               51410016
W28582     END-IF.                                                      51420016
W28582******************************************************************51430016
W28582* 9202-MOVE-SALES-DETAIL                                          51440016
W28582******************************************************************51450016
W28582 9202-MOVE-SALES-DETAIL.                                          51460016
W28582     MOVE ML022-SALE-SKU            TO DT2-SKU                    51470016
W28582     MOVE ML022-SALE-STORE-NBR      TO DT2-LOC                    51480016
W28582     MOVE ML022-SALE-DEPT-NBR       TO DT2-DEPT                   51490016
W28582     MOVE ML022-SALE-EXTD-RTL-AMT   TO DT2-EXTD-RTL-AMT           51500016
W28582     MOVE ML022-SALE-ENT-ID         TO DT2-ENT-ID                 51510016
W28582     MOVE ML022-SALE-LBL-SEQ-NBR    TO DT2-LBL-SEQ-NBR            51520016
W28582     MOVE ML022-SALE-ML-LWST-ID     TO DT2-ML-LWST-ID.            51530016
W28582******************************************************************51540016
W28582* 9203-MOVE-PCHG-DETAIL                                           51550016
W28582******************************************************************51560016
W28582 9203-MOVE-PCHG-DETAIL.                                           51570016
W28582     MOVE ML029-PC-SYST-ORIG-CDE    TO DT3-SYST-ORIG-CDE          51580016
W28582     MOVE ML029-PC-TRANS-CDE        TO DT3-PC-TRANS-CDE           51590016
W28582     MOVE ML029-PC-AP-TRANS-CDE     TO DT3-AP-TRANS-CDE           51600016
W28582     MOVE ML029-PC-SKU              TO DT3-SKU                    51610016
W28582     MOVE ML029-PC-STORE-NBR        TO DT3-LOC                    51620016
W28582     MOVE ML029-PC-DEPT-NBR         TO DT3-DEPT                   51630016
W28582     MOVE ML029-PC-EXTD-RTL-AMT     TO DT3-EXTD-RTL-AMT           51640016
W28582     MOVE ML029-PC-OLD-PR-AMT       TO DT3-OLD-PR-AMT             51650016
W28582     MOVE ML029-PC-NEW-PR-AMT       TO DT3-NEW-PR-AMT             51660016
W28582     MOVE ML029-PC-ENT-ID           TO DT3-ENT-ID                 51670016
W28582     MOVE ML029-PC-LBL-SEQ-NBR      TO DT3-LBL-SEQ-NBR            51680016
W28582     MOVE ML029-PC-ML-LWST-ID       TO DT3-ML-LWST-ID.            51690016
W28582******************************************************************51700016
W28582* 9204-MOVE-ADJ-DETAIL                                            51710016
W28582******************************************************************51720016
W28582 9204-MOVE-ADJ-DETAIL.                                            51730016
W28582     MOVE ML024-ADJ-SYST-ORIG-CDE   TO DT4-SYST-ORIG-CDE          51740016
W28582     MOVE ML024-ADJ-SKU             TO DT4-SKU                    51750016
W28582     MOVE ML024-ADJ-STORE-NBR       TO DT4-LOC                    51760016
W28582     MOVE ML024-ADJ-DEPT-NBR        TO DT4-DEPT                   51770016
W28582     MOVE ML024-ADJ-ENT-ID          TO DT4-ENT-ID                 51780016
W28582     MOVE ML024-ADJ-LBL-SEQ-NBR     TO DT4-LBL-SEQ-NBR            51790016
W28582     MOVE ML024-ADJ-ML-LWST-ID      TO DT4-ML-LWST-ID.            51800016
W28582******************************************************************51810016
W28582* 9300-WRITE-SALES-DETAIL-OUT                                     51820016
W28582******************************************************************51830016
W28582 9300-WRITE-SALES-DETAIL-OUT.                                     51840016
W28582     IF PV-LINE-COUNTER < 51                                      51850016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          51860016
W28582        PERFORM 9302-MOVE-SALES-DETAIL-OUT                        51870016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             51880016
W28582            AFTER ADVANCING 1 LINES                               51890016
W28582        ADD 1 TO PV-LINE-COUNTER                                  51900016
W28582     ELSE                                                         51910016
W28582        PERFORM 9200-WRITE-SALES-REPORT                           51920016
W28582        MOVE SPACES TO BV-SALE-AUDIT-REC                          51930016
W28582        PERFORM 9302-MOVE-SALES-DETAIL-OUT                        51940016
W28582        ADD 2 TO PV-LINE-COUNTER                                  51950016
W28582        WRITE BV-SALE-AUDIT-REC FROM DT2-SALES-DETAIL             51960016
W28582            AFTER ADVANCING 1 LINES                               51970016
W28582     END-IF.                                                      51980016
W28582******************************************************************51990016
W28582* 9300-WRITE-ADJ-DETAIL-OUT                                       52000016
W28582******************************************************************52010016
W28582 9300-WRITE-ADJ-DETAIL-OUT.                                       52020016
W28582     IF PV-LINE-COUNTER < 51                                      52030016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           52040016
W28582        PERFORM 9304-MOVE-ADJ-DETAIL-OUT                          52050016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                52060016
W28582            AFTER ADVANCING 1 LINES                               52070016
W28582        ADD 1 TO PV-LINE-COUNTER                                  52080016
W28582     ELSE                                                         52090016
W28582        PERFORM 9200-WRITE-ADJ-REPORT                             52100016
W28582        MOVE SPACES TO BV-ADJ-AUDIT-REC                           52110016
W28582        PERFORM 9304-MOVE-ADJ-DETAIL-OUT                          52120016
W28582        ADD 2 TO PV-LINE-COUNTER                                  52130016
W28582        WRITE BV-ADJ-AUDIT-REC FROM DT4-ADJ-DETAIL                52140016
W28582            AFTER ADVANCING 1 LINES                               52150016
W28582     END-IF.                                                      52160016
W28582******************************************************************52170016
W28582* 9300-WRITE-PURCH-DETAIL-OUT                                     52180016
W28582******************************************************************52190016
W28582 9300-WRITE-PURCH-DETAIL-OUT.                                     52200016
W28582     IF PV-LINE-COUNTER < 51                                      52210016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         52220016
W28582        PERFORM 9301-MOVE-PURCH-DETAIL-OUT                        52230016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            52240016
W28582            AFTER ADVANCING 1 LINES                               52250016
W28582        ADD 1 TO PV-LINE-COUNTER                                  52260016
W28582     ELSE                                                         52270016
W28582        PERFORM 9200-WRITE-PURCH-REPORT                           52280016
W28582        MOVE SPACES TO BV-PURCH-AUDIT-REC                         52290016
W28582        PERFORM 9301-MOVE-PURCH-DETAIL-OUT                        52300016
W28582        ADD 2 TO PV-LINE-COUNTER                                  52310016
W28582        WRITE BV-PURCH-AUDIT-REC FROM DT1-PURCH-DETAIL            52320016
W28582            AFTER ADVANCING 1 LINES                               52330016
W28582     END-IF.                                                      52340016
W28582******************************************************************52350016
W28582* 9300-WRITE-PCHG-DETAIL-OUT                                      52360016
W28582******************************************************************52370016
W28582 9300-WRITE-PCHG-DETAIL-OUT.                                      52380016
W28582     IF PV-LINE-COUNTER < 51                                      52390016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          52400016
W28582        PERFORM 9303-MOVE-PCHG-DETAIL-OUT                         52410016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              52420016
W28582            AFTER ADVANCING 1 LINES                               52430016
W28582        ADD 1 TO PV-LINE-COUNTER                                  52440016
W28582     ELSE                                                         52450016
W28582        PERFORM 9200-WRITE-PCHG-REPORT                            52460016
W28582        MOVE SPACES TO BV-PCHG-AUDIT-REC                          52470016
W28582        PERFORM 9303-MOVE-PCHG-DETAIL-OUT                         52480016
W28582        ADD 2 TO PV-LINE-COUNTER                                  52490016
W28582        WRITE BV-PCHG-AUDIT-REC FROM DT3-PCHG-DETAIL              52500016
W28582            AFTER ADVANCING 1 LINES                               52510016
W28582     END-IF.                                                      52520016
W28582******************************************************************52530016
W28582* 9301-MOVE-PURCH-DETAIL-OUT                                      52540016
W28582******************************************************************52550016
W28582 9301-MOVE-PURCH-DETAIL-OUT.                                      52560016
W28582     MOVE SPACES TO DT1-SYST-ORIG-CDE                             52570016
W28582                    DT1-PURCH-TRANS-CDE                           52580016
W28582                    DT1-AP-TRANS-CDE                              52590016
W28582                    DT1-SKU                                       52600016
W28582                    DT1-LOC                                       52610016
W28582                    DT1-DEPT.                                     52620016
W28582     MOVE PAOUT-PURCH-EXTD-GRO-COST-AMT                           52630016
W28582                                    TO DT1-GROSS-COST-AMT         52640016
W28582     MOVE PAOUT-PURCH-FRGT-AMT      TO DT1-FRGT-AMT               52650016
W28582     MOVE PAOUT-PURCH-DISC-AMT      TO DT1-DISC-AMT               52660016
W28582     MOVE PAOUT-PURCH-EXTD-NET-COST-AMT                           52670016
W28582                                    TO DT1-NET-COST-AMT           52680016
W28582     MOVE PAOUT-PURCH-EXTD-RTL-AMT  TO DT1-EXTD-RTL-AMT           52690016
W28582     MOVE PAOUT-PURCH-PER-UNT-RTL-AMT                             52700016
W28582                                    TO DT1-UNT-RTL-AMT            52710016
W28582     MOVE PAOUT-PURCH-ENT-ID        TO DT1-ENT-ID                 52720016
W28582     MOVE PAOUT-PURCH-LBL-SEQ-NBR   TO DT1-LBL-SEQ-NBR            52730016
W28582     MOVE PAOUT-PURCH-ML-LWST-ID    TO DT1-ML-LWST-ID.            52740016
W28582******************************************************************52750016
W28582* 9302-MOVE-SALES-DETAIL-OUT                                      52760016
W28582******************************************************************52770016
W28582 9302-MOVE-SALES-DETAIL-OUT.                                      52780016
W28582     MOVE SPACES TO DT2-SKU                                       52790016
W28582                    DT2-LOC                                       52800016
W28582                    DT2-DEPT.                                     52810016
W28582     MOVE SLOUT-SALE-EXTD-RTL-AMT   TO DT2-EXTD-RTL-AMT.          52820016
W28582     MOVE SLOUT-SALE-ENT-ID         TO DT2-ENT-ID.                52830016
W28582     MOVE SLOUT-SALE-LBL-SEQ-NBR    TO DT2-LBL-SEQ-NBR.           52840016
W28582     MOVE SLOUT-SALE-ML-LWST-ID     TO DT2-ML-LWST-ID.            52850016
W28582******************************************************************52860016
W28582* 9303-MOVE-PCHG-DETAIL-OUT                                       52870016
W28582******************************************************************52880016
W28582 9303-MOVE-PCHG-DETAIL-OUT.                                       52890016
W28582     MOVE SPACES TO DT3-SYST-ORIG-CDE                             52900016
W28582                    DT3-PC-TRANS-CDE                              52910016
W28582                    DT3-AP-TRANS-CDE                              52920016
W28582                    DT3-SKU                                       52930016
W28582                    DT3-LOC                                       52940016
W28582                    DT3-DEPT.                                     52950016
W28582     MOVE PCOUT-PC-EXTD-RTL-AMT     TO DT3-EXTD-RTL-AMT.          52960016
W28582     MOVE PCOUT-PC-OLD-PR-AMT       TO DT3-OLD-PR-AMT.            52970016
W28582     MOVE PCOUT-PC-NEW-PR-AMT       TO DT3-NEW-PR-AMT.            52980016
W28582     MOVE PCOUT-PC-ENT-ID           TO DT3-ENT-ID.                52990016
W28582     MOVE PCOUT-PC-LBL-SEQ-NBR      TO DT3-LBL-SEQ-NBR.           53000016
W28582     MOVE PCOUT-PC-ML-LWST-ID       TO DT3-ML-LWST-ID.            53010016
W28582******************************************************************53020016
W28582* 9304-MOVE-ADJ-DETAIL-OUT                                        53030016
W28582******************************************************************53040016
W28582 9304-MOVE-ADJ-DETAIL-OUT.                                        53050016
W28582     MOVE SPACES TO DT4-SYST-ORIG-CDE                             53060016
W28582                    DT4-SKU                                       53070016
W28582                    DT4-LOC                                       53080016
W28582                    DT4-DEPT.                                     53090016
W28582     MOVE IAOUT-ADJ-ENT-ID          TO DT4-ENT-ID.                53100016
W28582     MOVE IAOUT-ADJ-LBL-SEQ-NBR     TO DT4-LBL-SEQ-NBR.           53110016
W28582     MOVE IAOUT-ADJ-ML-LWST-ID      TO DT4-ML-LWST-ID.            53120016
W37965******************************************************************53130016
W37965* 9305-MOVE-PURCH-DETAIL-AUDIT.                                   53140016
W37965******************************************************************53150016
W37965 9305-MOVE-PURCH-DETAIL-AUDIT.                                    53160016
W37965     INITIALIZE ML090-AUDIT-REC                                   53170016
W37965     MOVE DTATTR-FSCL-WK-END-DTE       TO ML090-FSCL-WK-END-DTE   53180016
W37965     MOVE PV-PROCESS-DATE              TO ML090-PRCG-DTE          53190016
W37965     MOVE 'BVEDIT'                     TO ML090-FINCL-PRC-GP-CDE  53200016
W37965     MOVE ML030-PURCH-DEPT-NBR         TO ML090-DEPT-NBR          53210016
W37965     MOVE ML030-PURCH-CLASS-NBR(1:1)   TO PV-CLASS-NBR            53220016
W37965     COMPUTE ML090-MAJ-CL-NBR = PV-CLASS-NBR * 10                 53230016
W37965     MOVE ML030-PURCH-CLASS-NBR        TO ML090-SUB-CL-NBR        53240016
W37965     MOVE ML030-PURCH-STORE-NBR        TO PV-LOC-NBR              53250016
W37965     MOVE PV-LOC-NBR                   TO ML090-LOC-NBR           53260016
W37965     MOVE ML030-PURCH-ENT-ID           TO ML090-ORIG-ENT-ID       53270016
W37965     MOVE ML030-PURCH-LBL-SEQ-NBR      TO ML090-ORIG-LBL-SEQ-NBR  53280016
W37965     MOVE ML030-PURCH-SYST-ORIG-CDE    TO ML090-SRC-SYS-ID        53290016
W37965     MOVE ML030-PURCH-AP-TRANS-CDE     TO ML090-AP-TRN-CDE        53300016
W37965     MOVE ML030-PURCH-DR-CR-CDE        TO ML090-DR-CR-CDE         53310016
W37965     MOVE 0                            TO ML090-TRN-TYP-CDE (1:1) 53320016
W37965     IF ML030-PURCH-TRANS-CDE = '10' AND                          53330016
W37965       (NOT ML030-PURCH-RECEIPT)                                  53340016
W37965         MOVE PC-AUDIT-PRCH-ADJ        TO ML090-TRN-TYP-CDE (2:2) 53350016
W37965     ELSE                                                         53360016
W37965         MOVE ML030-PURCH-TRANS-CDE    TO ML090-TRN-TYP-CDE (2:2) 53370016
W37965     END-IF                                                       53380016
W37965     IF ML030-PURCH-SKU = ZEROES OR                               53390016
W37965         ML030-PURCH-SKU = SPACES OR                              53400016
W37965         ML030-PURCH-SKU (6:3) = '000' OR                         53410016
W37965         ML030-PURCH-SKU (6:3) = '999'                            53420016
W37965             MOVE 'Y'   TO ML090-DUMMY-SKU-IND                    53430016
W37965     ELSE                                                         53440016
W37965             MOVE 'N'   TO ML090-DUMMY-SKU-IND                    53450016
W37965     END-IF.                                                      53460016
W37965******************************************************************53470016
W37965* 9306-WRITE-PURCH-DETAIL-AUDIT.                                  53480016
W37965******************************************************************53490016
W37965 9306-WRITE-PURCH-DETAIL-AUDIT.                                   53500016
W37965     MOVE PAOUT-PURCH-ML-LWST-ID    TO ML090-ML-LO-MDSE-LVL-ID    53510016
W37965     MOVE PAOUT-PURCH-ENT-ID        TO ML090-ENT-ID               53520016
W37965     MOVE PAOUT-PURCH-LBL-SEQ-NBR   TO ML090-LBL-SEQ-NBR          53530016
W37965     MOVE PAOUT-PURCH-EXTD-GRO-COST-AMT                           53540016
W37965                                    TO ML090-PADJ-GRO-COST-AMT    53550016
W37965     MOVE PAOUT-PURCH-EXTD-NET-COST-AMT                           53560016
W37965                                    TO ML090-PADJ-NET-COST-AMT    53570016
W37965     MOVE PAOUT-PURCH-DISC-AMT      TO ML090-PADJ-DISC-COST-AMT   53580016
W37965     MOVE PAOUT-PURCH-EXTD-RTL-AMT  TO ML090-PADJ-RTL-AMT         53590016
W37965     WRITE BV-PURCH-AUDIT-DETAIL-REC FROM ML090-AUDIT-REC         53600016
W37965     ADD 1                          TO PV-TOT-PADJ-AUDIT-OUT.     53610016
W37965******************************************************************53620016
W37965* 9307-MOVE-SALE-DETAIL-AUDIT.                                    53630016
W37965******************************************************************53640016
W37965 9307-MOVE-SALE-DETAIL-AUDIT.                                     53650016
W37965     INITIALIZE ML090-AUDIT-REC                                   53660016
W37965     MOVE DTATTR-FSCL-WK-END-DTE       TO ML090-FSCL-WK-END-DTE   53670016
W37965     MOVE PV-PROCESS-DATE              TO ML090-PRCG-DTE          53680016
W37965     MOVE 'BVEDIT'                     TO ML090-FINCL-PRC-GP-CDE  53690016
W37965     MOVE ML022-SALE-DEPT-NBR          TO ML090-DEPT-NBR          53700016
W37965     MOVE ML022-SALE-CLASS-NBR(1:1)    TO PV-CLASS-NBR            53710016
W37965     COMPUTE ML090-MAJ-CL-NBR = PV-CLASS-NBR * 10                 53720016
W37965     MOVE ML022-SALE-CLASS-NBR         TO ML090-SUB-CL-NBR        53730016
W37965     MOVE ML022-SALE-STORE-NBR         TO PV-LOC-NBR              53740016
W37965     MOVE PV-LOC-NBR                   TO ML090-LOC-NBR           53750016
W37965     MOVE ML022-SALE-ENT-ID            TO ML090-ORIG-ENT-ID       53760016
W37965     MOVE ML022-SALE-LBL-SEQ-NBR       TO ML090-ORIG-LBL-SEQ-NBR  53770016
W37965     MOVE ML022-SALE-SYST-ORIG-CDE     TO ML090-SRC-SYS-ID        53780016
W37965     MOVE ML022-SALE-TYPE-2            TO ML090-SLS-TYP-CDE       53790016
W37965     MOVE 0                            TO ML090-TRN-TYP-CDE(1:1)  53800016
W37965     MOVE ML022-SALE-TRANS-CDE         TO ML090-TRN-TYP-CDE(2:2)  53810016
W37965     IF ML022-SALE-SKU = ZEROES OR                                53820016
W37965         ML022-SALE-SKU = SPACES OR                               53830016
W37965         ML022-SALE-SKU (6:3) = '000' OR                          53840016
W37965         ML022-SALE-SKU (6:3) = '999'                             53850016
W37965             MOVE 'Y'   TO ML090-DUMMY-SKU-IND                    53860016
W37965     ELSE                                                         53870016
W37965             MOVE 'N'   TO ML090-DUMMY-SKU-IND                    53880016
W37965     END-IF.                                                      53890016
W37965******************************************************************53900016
W37965* 9308-WRITE-SALE-DETAIL-AUDIT.                                   53910016
W37965******************************************************************53920016
W37965 9308-WRITE-SALE-DETAIL-AUDIT.                                    53930016
W37965     MOVE SLOUT-SALE-ML-LWST-ID     TO ML090-ML-LO-MDSE-LVL-ID    53940016
W37965     MOVE SLOUT-SALE-ENT-ID         TO ML090-ENT-ID               53950016
W37965     MOVE SLOUT-SALE-LBL-SEQ-NBR    TO ML090-LBL-SEQ-NBR          53960016
W37965     MOVE SLOUT-SALE-EXTD-RTL-AMT                                 53970016
W37965                                    TO ML090-SLS-RTL-AMT          53980016
W37965     WRITE BV-SALE-AUDIT-DETAIL-REC FROM ML090-AUDIT-REC          53990016
W37965     ADD 1                          TO PV-TOT-SALE-AUDIT-OUT.     54000016
W37965******************************************************************54010016
W37965* 9309-MOVE-PCHG-DETAIL-AUDIT.                                    54020016
W37965******************************************************************54030016
W37965 9309-MOVE-PCHG-DETAIL-AUDIT.                                     54040016
W37965     INITIALIZE ML090-AUDIT-REC                                   54050016
W37965     MOVE DTATTR-FSCL-WK-END-DTE     TO ML090-FSCL-WK-END-DTE     54060016
W37965     MOVE PV-PROCESS-DATE            TO ML090-PRCG-DTE            54070016
W37965     MOVE 'BVEDIT'                   TO ML090-FINCL-PRC-GP-CDE    54080016
W37965     MOVE ML029-PC-DEPT-NBR          TO ML090-DEPT-NBR            54090016
W37965     MOVE ML029-PC-CLASS-NBR(1:1)    TO PV-CLASS-NBR              54100016
W37965     COMPUTE ML090-MAJ-CL-NBR = PV-CLASS-NBR * 10                 54110016
W37965     MOVE ML029-PC-CLASS-NBR         TO ML090-SUB-CL-NBR          54120016
W37965     MOVE ML029-PC-STORE-NBR         TO PV-LOC-NBR                54130016
W37965     MOVE PV-LOC-NBR                 TO ML090-LOC-NBR             54140016
W37965     MOVE ML029-PC-ENT-ID            TO ML090-ORIG-ENT-ID         54150016
W37965     MOVE ML029-PC-LBL-SEQ-NBR       TO ML090-ORIG-LBL-SEQ-NBR    54160016
W37965     MOVE ML029-PC-SYST-ORIG-CDE     TO ML090-SRC-SYS-ID          54170016
W37965     MOVE 0                          TO ML090-TRN-TYP-CDE(1:1)    54180016
W37965     MOVE ML029-PC-TRANS-CDE         TO ML090-TRN-TYP-CDE(2:2)    54190016
W37965     MOVE 0                          TO ML090-PRCHG-RSN-CDE (1:1) 54200016
W37965     MOVE ML029-PC-MKDN-MKUP-RSN-CDE TO ML090-PRCHG-RSN-CDE (2:3) 54210016
W37965     MOVE 0                          TO ML090-PRCHG-CTG-CDE (1:1) 54220016
W37965     MOVE ML029-PC-CATEGORY          TO ML090-PRCHG-CTG-CDE (2:1) 54230016
W37965     IF ML029-PC-SKU = ZEROES OR                                  54240016
W37965         ML029-PC-SKU = SPACES OR                                 54250016
W37965         ML029-PC-SKU (6:3) = '000' OR                            54260016
W37965         ML029-PC-SKU (6:3) = '999'                               54270016
W37965             MOVE 'Y'   TO ML090-DUMMY-SKU-IND                    54280016
W37965     ELSE                                                         54290016
W37965             MOVE 'N'   TO ML090-DUMMY-SKU-IND                    54300016
W37965     END-IF.                                                      54310016
W37965******************************************************************54320016
W37965* 9310-WRITE-PCHG-DETAIL-AUDIT.                                   54330016
W37965******************************************************************54340016
W37965 9310-WRITE-PCHG-DETAIL-AUDIT.                                    54350016
W37965     MOVE PCOUT-PC-ML-LWST-ID       TO ML090-ML-LO-MDSE-LVL-ID    54360016
W37965     MOVE PCOUT-PC-ENT-ID           TO ML090-ENT-ID               54370016
W37965     MOVE PCOUT-PC-LBL-SEQ-NBR      TO ML090-LBL-SEQ-NBR          54380016
W37965     MOVE PCOUT-PC-EXTD-RTL-AMT                                   54390016
W37965                                    TO ML090-PRCHG-RTL-AMT        54400016
W37965     WRITE BV-PCHG-AUDIT-DETAIL-REC FROM ML090-AUDIT-REC          54410016
W37965     ADD 1                          TO PV-TOT-PCHG-AUDIT-OUT.     54420016
W37965******************************************************************54430016
W37965* 9311-WRITE-ADJ-DETAIL-AUDIT.                                    54440016
W37965******************************************************************54450016
W37965 9311-WRITE-ADJ-DETAIL-AUDIT.                                     54460016
W37965     INITIALIZE ML090-AUDIT-REC                                   54470016
W37965     MOVE DTATTR-FSCL-WK-END-DTE       TO ML090-FSCL-WK-END-DTE   54480016
W37965     MOVE PV-PROCESS-DATE              TO ML090-PRCG-DTE          54490016
W37965     MOVE 'BVEDIT'                     TO ML090-FINCL-PRC-GP-CDE  54500016
W37965     MOVE ML024-ADJ-DEPT-NBR           TO ML090-DEPT-NBR          54510016
W37965     MOVE ML024-ADJ-CLASS-NBR(1:1)     TO PV-CLASS-NBR            54520016
W37965     COMPUTE ML090-MAJ-CL-NBR = PV-CLASS-NBR * 10                 54530016
W37965     MOVE ML024-ADJ-CLASS-NBR          TO ML090-SUB-CL-NBR        54540016
W37965     MOVE ML024-ADJ-STORE-NBR          TO PV-LOC-NBR              54550016
W37965     MOVE PV-LOC-NBR                   TO ML090-LOC-NBR           54560016
W37965     MOVE IAOUT-ADJ-ENT-ID             TO ML090-ENT-ID            54570016
W37965     MOVE IAOUT-ADJ-LBL-SEQ-NBR        TO ML090-LBL-SEQ-NBR       54580016
W37965     MOVE ML024-ADJ-SYST-ORIG-CDE      TO ML090-SRC-SYS-ID        54590016
W37965     MOVE ML024-ADJ-ML-LWST-ID         TO ML090-ML-LO-MDSE-LVL-ID 54600016
W37965     MOVE ML024-ADJ-AT-RTL-AMT         TO ML090-INV-ADJ-RTL-AMT   54610016
W37965     MOVE ML024-ADJ-AT-COST-AMT        TO ML090-INV-ADJ-COST-AMT  54620016
W37965     MOVE 0                            TO ML090-TRN-TYP-CDE(1:1)  54630016
W37965     MOVE ML024-ADJ-TRANS-CDE          TO ML090-TRN-TYP-CDE(2:2)  54640016
W37965     WRITE BV-INV-ADJ-AUDIT-DETAIL-REC FROM ML090-AUDIT-REC.      54650016
W37965     ADD 1                             TO PV-TOT-IADJ-AUDIT-OUT.  54660016
W28582******************************************************************54670016
W28582*    WRITE A RECORD TO THE PURCH OUTPUT FILE.                     54680016
W28582******************************************************************54690016
W28582 9400-WRITE-PURCH-REC.                                            54700016
W34517     IF PS-PURCH-SKU-YES OR PS-PURCH-RTV-YES                      54710016
W34517        IF BV101-PV-BOM-FOUND AND PS-BOM-ATTR-NOT-EQUAL           54720016
W34517            IF ML030-PURCH-ENT-ID NOT = ZEROES                    54730016
W34517               MOVE ML030-PURCH-ENT-ID TO PAOUT-PURCH-ENT-ID      54740016
W34517               MOVE ML030-PURCH-LBL-SEQ-NBR                       54750016
W34517                                        TO PAOUT-PURCH-LBL-SEQ-NBR54760016
W34517               MOVE ML030-PURCH-ML-LWST-ID                        54770016
W34517                                        TO PAOUT-PURCH-ML-LWST-ID 54780016
W34517               ADD 1 TO PV-TOT-AUDIT-BV-RECS-OUT                  54790016
W34517                        PV-TOT-EDIT-BV-ORIG-OUT                   54800016
W34517               SET PAOUT-PURCH-ORIGINAL TO TRUE                   54810016
W34517               WRITE BV-PURCH-REC                                 54820016
W34517                   FROM PAOUT-PURCH-RECORD                        54830016
W34517               COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT =            54840016
W34517                       PAOUT-PURCH-EXTD-GRO-COST-AMT * -1         54850016
W34517               COMPUTE PAOUT-PURCH-FRGT-AMT  =                    54860016
W34517                       PAOUT-PURCH-FRGT-AMT  * -1                 54870016
W34517               COMPUTE PAOUT-PURCH-DISC-AMT  =                    54880016
W34517                       PAOUT-PURCH-DISC-AMT  * -1                 54890016
W34517               COMPUTE PAOUT-PURCH-EXTD-NET-COST-AMT =            54900016
W34517                       PAOUT-PURCH-EXTD-NET-COST-AMT * -1         54910016
W34517               COMPUTE PAOUT-PURCH-EXTD-RTL-AMT =                 54920016
W34517                       PAOUT-PURCH-EXTD-RTL-AMT * -1              54930016
W34517               COMPUTE PAOUT-PURCH-QTY = PAOUT-PURCH-QTY * -1     54940016
W34517               COMPUTE PAOUT-PURCH-PER-UNT-RTL-AMT =              54950016
W34517                       PAOUT-PURCH-PER-UNT-RTL-AMT * -1           54960016
W34517               ADD 1 TO PV-TOT-AUDIT-BV-RECS-OUT                  54970016
W34517                        PV-TOT-EDIT-BV-REVR-OUT                   54980016
W34517               SET PAOUT-PURCH-REVERSAL TO TRUE                   54990016
W34517               WRITE BV-PURCH-REC                                 55000016
W34517                   FROM PAOUT-PURCH-RECORD                        55010016
W34517               COMPUTE PAOUT-PURCH-EXTD-GRO-COST-AMT =            55020016
W34517                       PAOUT-PURCH-EXTD-GRO-COST-AMT * -1         55030016
W34517               COMPUTE PAOUT-PURCH-FRGT-AMT  =                    55040016
W34517                       PAOUT-PURCH-FRGT-AMT  * -1                 55050016
W34517               COMPUTE PAOUT-PURCH-DISC-AMT  =                    55060016
W34517                       PAOUT-PURCH-DISC-AMT  * -1                 55070016
W34517               COMPUTE PAOUT-PURCH-EXTD-NET-COST-AMT =            55080016
W34517                       PAOUT-PURCH-EXTD-NET-COST-AMT * -1         55090016
W34517               COMPUTE PAOUT-PURCH-EXTD-RTL-AMT =                 55100016
W34517                       PAOUT-PURCH-EXTD-RTL-AMT * -1              55110016
W34517               COMPUTE PAOUT-PURCH-QTY = PAOUT-PURCH-QTY * -1     55120016
W34517               COMPUTE PAOUT-PURCH-PER-UNT-RTL-AMT =              55130016
W34517                       PAOUT-PURCH-PER-UNT-RTL-AMT * -1           55140016
W34517            END-IF                                                55150016
W34517            MOVE BV101-BOM-ENT-ID-OUT TO PAOUT-PURCH-ENT-ID       55160016
W34517            MOVE BV101-BOM-LBL-SEQ-NBR-OUT                        55170016
W34517                                       TO PAOUT-PURCH-LBL-SEQ-NBR 55180016
W34517            MOVE BV101-BOM-LO-MDSE-LVL-ID-OUT                     55190016
W34517                                       TO PAOUT-PURCH-ML-LWST-ID  55200016
W34517            SET PAOUT-PURCH-REASSIGN TO TRUE                      55210016
W34517            ADD 1 TO PV-TOT-EDIT-BV-REAS-OUT                      55220016
W34517        ELSE                                                      55230016
W34517            EVALUATE TRUE                                         55240016
W34517               WHEN BV101-PV-BOM-NOT-FOUND                        55250016
W34517                  IF PAOUT-PURCH-LBL-SEQ-NBR = ZERO               55260016
W34517                      MOVE IN402-VND-ENT-ID-OUT                   55270016
W34517                                        TO PAOUT-PURCH-ENT-ID     55280016
W34517                      MOVE IN402-VND-LBL-SEQ-NBR                  55290016
W34517                                        TO PAOUT-PURCH-LBL-SEQ-NBR55300016
W34517                      MOVE IN402-VND-ML-LO-MDSE-LVL-ID            55310016
W34517                                        TO PAOUT-PURCH-ML-LWST-ID 55320016
W34517                  END-IF                                          55330016
W34517               WHEN PS-BOM-ATTR-EQUAL                             55340016
W34517               WHEN ML030-PURCH-ENT-ID = ZEROES                   55350016
W34517                  MOVE BV101-BOM-ENT-ID-OUT TO PAOUT-PURCH-ENT-ID 55360016
W34517                  MOVE BV101-BOM-LBL-SEQ-NBR-OUT                  55370016
W34517                                       TO PAOUT-PURCH-LBL-SEQ-NBR 55380016
W34517                  MOVE BV101-BOM-LO-MDSE-LVL-ID-OUT               55390016
W34517                                       TO PAOUT-PURCH-ML-LWST-ID  55400016
W34517                  IF ML030-PURCH-ENT-ID = ZEROES                  55410016
W34517                     ADD 1 TO PV-TOT-ENT-ZERO-BV-UNCH-OUT         55420016
W34517                  END-IF                                          55430016
W34517            END-EVALUATE                                          55440016
W34517            SET PAOUT-PURCH-UNCHNGED TO TRUE                      55450016
W34517            ADD 1 TO PV-TOT-EDIT-BV-UNCH-OUT                      55460016
W34517        END-IF                                                    55470016
W34517     END-IF.                                                      55480016
W28582     ADD 1 TO PV-TOT-EDIT-PURCH-RECS-OUT.                         55490016
W28582     WRITE BV-PURCH-REC                                           55500016
W28582         FROM PAOUT-PURCH-RECORD.                                 55510016
W28582     PERFORM 9300-WRITE-PURCH-DETAIL-OUT.                         55520016
W37965     PERFORM 9306-WRITE-PURCH-DETAIL-AUDIT.                       55530016
W28582     PERFORM 9807-CKPT-LOGIC.                                     55540016
W28582     IF PS-RESTART-RUN                                            55550016
W28582        IF PV-RESTART-COUNT > 1                                   55560016
W28582           CONTINUE                                               55570016
W28582        ELSE                                                      55580016
W28582           DISPLAY PV-RESTART-COUNT                               55590016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    55600016
W28582           DISPLAY PAOUT-PURCH-RECORD                             55610016
W28582        END-IF                                                    55620016
W28582     END-IF.                                                      55630016
W28582                                                                  55640016
W34517* IF UNKNOWN BRAND, CHECK IF THIS IS AN EXPENSE VENDOR. IF SO     55650016
W34517* WRITE ANY NEWLY IDENTIFIED EXPENSE VENDORS TO THE DEFAULT       55660016
W34517* EXPENSE VENDOR FILE OR THE UNCLASSIFIED LICENSE FEE FILE.       55670016
W34517     MOVE PAOUT-PURCH-ENT-ID TO PS-ENT-ID-PRIVATE.                55680016
W34517     IF PAOUT-PURCH-LBL-SEQ-NBR = PC-UNKNOWN-BRAND AND            55690016
W34517       (NOT PS-ENT-ID-PRIVATE-BRAND)                              55700016
W34517         MOVE PAOUT-PURCH-ENT-ID TO PV-DB2-ENT-ID                 55710016
W34517         PERFORM 6110-SELECT-PRIM-TYPE-CDE                        55720016
W34517         IF EXTENT-PRIM-TYP-CDE NOT = 'M'                         55730016
W34517             IF PS-EXP-VND-NOT-END                                55740016
W34517                 SET PT-EXP-VND-IDX-MAX TO 1                      55750016
W37965                 PERFORM 6121-OPEN-EXP-VEN-CSR                    55760016
W34517                 PERFORM 6120-READ-LOAD-EXP-VND                   55770016
W34517                   UNTIL PS-EXP-VND-END                           55780016
W37965                 PERFORM 6123-CLOSE-EXP-VEN-CSR                   55790016
W34517                 SET PT-EXP-VND-IDX-MAX TO PT-EXP-VND-IDX         55800016
W34517                 SET PT-EXP-VND-IDX-MAX DOWN BY 1                 55810016
W34517             END-IF                                               55820016
W34517             SET PS-EXP-VND-NOT-FOUND TO TRUE                     55830016
W34517             PERFORM VARYING PT-EXP-VND-IDX FROM 1 BY 1           55840016
W34517               UNTIL PT-EXP-VND-IDX GREATER PT-EXP-VND-IDX-MAX    55850016
W34517                  OR PS-EXP-VND-FOUND                             55860016
W34517                 IF PT-EXP-VND-ID (PT-EXP-VND-IDX) = PV-DB2-ENT-ID55870016
W34517                     SET PS-EXP-VND-FOUND TO TRUE                 55880016
W34517                 END-IF                                           55890016
W34517             END-PERFORM                                          55900016
W34517             IF PS-EXP-VND-NOT-FOUND                              55910016
W34517                 IF PS-PURCH-AP-LICENSE-FEE                       55920016
W34517                     MOVE PV-DB2-DEPT-NBR TO ML081-DEPT-NBR       55930016
W34517                     MOVE PV-DB2-ENT-ID   TO ML081-ENT-ID         55940016
W34517                     MOVE ENTNME-ENT-NAME-DESC                    55950016
W34517                                          TO ML081-ENT-NAME-DESC  55960016
W34517                     MOVE PS-AP-TRANS-CDE TO ML081-AP-TRANS-CDE   55970016
W34517                     MOVE PAOUT-PURCH-EXTD-RTL-AMT                55980016
W34517                                          TO ML081-EXTD-RTL-AMT   55990016
W34517                     PERFORM 6130-WRITE-UNCL-LIC-FEE              56000016
W34517                 ELSE                                             56010016
W34517                     MOVE PV-DB2-DEPT-NBR TO ML082-DEPT-NBR       56020016
W34517                     MOVE PV-DB2-ENT-ID   TO ML082-ENT-ID         56030016
W37965                     MOVE PV-DB2-ENT-ID   TO MLT00025-ENT-ID      56040016
W37965                     MOVE CC-PROC-DATE-ISO TO MLT00025-EFF-BEG-DTE56050016
W37965                     MOVE PV-EXP-TYPE1 TO MLT00025-EXP-TYP-NBR    56060016
W37965                     MOVE ZERO         TO MLT00025-LBL-SEQ-NBR    56070016
W37965                     MOVE PC-PGM-NAME  TO MLT00025-LAST-UPD-USR-ID56080016
W37965                     PERFORM 8400-INSERT-EXP-VND                  56090016
W37965                     PERFORM 8410-UPDATE-INT-TABLE                56100016
W34517                     MOVE ENTNME-ENT-NAME-DESC                    56110016
W34517                                          TO ML082-ENT-NAME-DESC  56120016
W34517                     MOVE PS-AP-TRANS-CDE TO ML082-AP-TRANS-CDE   56130016
W34517                     MOVE PAOUT-PURCH-EXTD-RTL-AMT                56140016
W34517                                          TO ML082-EXTD-RTL-AMT   56150016
W34517                     PERFORM 6140-WRITE-DEF-EXP-VND               56160016
W34517                 END-IF                                           56170016
W34517             END-IF                                               56180016
W34517         END-IF                                                   56190016
W34517     END-IF.                                                      56200016
W28582******************************************************************56210016
W28582*    WRITE A RECORD TO THE SALE OUTPUT FILE.                      56220016
W28582******************************************************************56230016
W28582 9500-WRITE-SALE-REC.                                             56240016
W34517     IF BV101-PV-BOM-FOUND AND PS-BOM-ATTR-NOT-EQUAL              56250016
W34517         IF ML022-SALE-ENT-ID NOT = ZEROES                        56260016
W34517            MOVE ML022-SALE-ENT-ID   TO SLOUT-SALE-ENT-ID         56270016
W34517            MOVE ML022-SALE-LBL-SEQ-NBR TO SLOUT-SALE-LBL-SEQ-NBR 56280016
W34517            MOVE ML022-SALE-ML-LWST-ID TO SLOUT-SALE-ML-LWST-ID   56290016
W34517            ADD 1 TO PV-TOT-AUDIT-BV-RECS-OUT                     56300016
W34517                     PV-TOT-EDIT-BV-ORIG-OUT                      56310016
W34517            SET SLOUT-SALE-ORIGINAL TO TRUE                       56320016
W34517            WRITE BV-SALE-REC                                     56330016
W34517                FROM SLOUT-SALE-RECORD                            56340016
W34517            COMPUTE SLOUT-SALE-EXTD-RTL-AMT  =                    56350016
W34517                    SLOUT-SALE-EXTD-RTL-AMT  * -1                 56360016
W34517            ADD 1 TO PV-TOT-AUDIT-BV-RECS-OUT                     56370016
W34517                     PV-TOT-EDIT-BV-REVR-OUT                      56380016
W34517            SET SLOUT-SALE-REVERSAL TO TRUE                       56390016
W34517            WRITE BV-SALE-REC                                     56400016
W34517                FROM SLOUT-SALE-RECORD                            56410016
W34517            COMPUTE SLOUT-SALE-EXTD-RTL-AMT  =                    56420016
W34517                    SLOUT-SALE-EXTD-RTL-AMT  * -1                 56430016
W34517         END-IF                                                   56440016
W34517         MOVE BV101-BOM-ENT-ID-OUT  TO SLOUT-SALE-ENT-ID          56450016
W34517         MOVE BV101-BOM-LBL-SEQ-NBR-OUT                           56460016
W34517                                    TO SLOUT-SALE-LBL-SEQ-NBR     56470016
W34517         MOVE BV101-BOM-LO-MDSE-LVL-ID-OUT                        56480016
W34517                                    TO SLOUT-SALE-ML-LWST-ID      56490016
W34517         SET SLOUT-SALE-REASSIGN TO TRUE                          56500016
W34517         ADD 1 TO PV-TOT-EDIT-BV-REAS-OUT                         56510016
W34517     ELSE                                                         56520016
W34517         EVALUATE TRUE                                            56530016
W34517            WHEN BV101-PV-BOM-NOT-FOUND                           56540016
W34517               IF SLOUT-SALE-LBL-SEQ-NBR = ZERO                   56550016
W34517                   MOVE IN402-VND-ENT-ID-OUT TO SLOUT-SALE-ENT-ID 56560016
W34517                   MOVE IN402-VND-LBL-SEQ-NBR                     56570016
W34517                                         TO SLOUT-SALE-LBL-SEQ-NBR56580016
W34517                   MOVE IN402-VND-ML-LO-MDSE-LVL-ID               56590016
W34517                                         TO SLOUT-SALE-ML-LWST-ID 56600016
W34517               END-IF                                             56610016
W34517            WHEN PS-BOM-ATTR-EQUAL                                56620016
W34517            WHEN ML022-SALE-ENT-ID = ZEROES                       56630016
W34517               MOVE BV101-BOM-ENT-ID-OUT TO SLOUT-SALE-ENT-ID     56640016
W34517               MOVE BV101-BOM-LBL-SEQ-NBR-OUT                     56650016
W34517                                    TO SLOUT-SALE-LBL-SEQ-NBR     56660016
W34517               MOVE BV101-BOM-LO-MDSE-LVL-ID-OUT                  56670016
W34517                                    TO SLOUT-SALE-ML-LWST-ID      56680016
W34517               IF ML022-SALE-ENT-ID = ZEROES                      56690016
W34517                  ADD 1 TO PV-TOT-ENT-ZERO-BV-UNCH-OUT            56700016
W34517               END-IF                                             56710016
W34517         END-EVALUATE                                             56720016
W34517         SET SLOUT-SALE-UNCHNGED TO TRUE                          56730016
W34517         ADD 1 TO PV-TOT-EDIT-BV-UNCH-OUT                         56740016
W34517     END-IF.                                                      56750016
W28582     ADD 1 TO PV-TOT-EDIT-SALE-RECS-OUT.                          56760016
W28582     WRITE BV-SALE-REC                                            56770016
W28582         FROM SLOUT-SALE-RECORD.                                  56780016
W28582     PERFORM 9300-WRITE-SALES-DETAIL-OUT.                         56790016
W37965     PERFORM 9308-WRITE-SALE-DETAIL-AUDIT.                        56800016
W28582     PERFORM 9807-CKPT-LOGIC.                                     56810016
W28582     IF PS-RESTART-RUN                                            56820016
W28582        IF PV-RESTART-COUNT > 1                                   56830016
W28582           CONTINUE                                               56840016
W28582        ELSE                                                      56850016
W28582           DISPLAY PV-RESTART-COUNT                               56860016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    56870016
W28582           DISPLAY SLOUT-SALE-RECORD                              56880016
W28582        END-IF                                                    56890016
W28582     END-IF.                                                      56900016
W28582                                                                  56910016
W28582******************************************************************56920016
W28582*    WRITE A RECORD TO THE PRICE CHANGE OUTPUT FILE.              56930016
W28582******************************************************************56940016
W28582 9600-WRITE-PCHG-REC.                                             56950016
W34517     IF (BV101-PV-BOM-FOUND AND PS-BOM-ATTR-NOT-EQUAL) AND        56960016
W34517        NOT PS-PCHG-AP-DA-MARKDOWN                                56970016
W34517         IF ML029-PC-ENT-ID NOT = ZEROES                          56980016
W34517            MOVE ML029-PC-ENT-ID     TO PCOUT-PC-ENT-ID           56990016
W34517            MOVE ML029-PC-LBL-SEQ-NBR TO PCOUT-PC-LBL-SEQ-NBR     57000016
W34517            MOVE ML029-PC-ML-LWST-ID TO PCOUT-PC-ML-LWST-ID       57010016
W34517            ADD 1 TO PV-TOT-AUDIT-BV-RECS-OUT                     57020016
W34517                     PV-TOT-EDIT-BV-ORIG-OUT                      57030016
W34517            SET PCOUT-PC-ORIGINAL TO TRUE                         57040016
W34517            WRITE BV-PRC-CHG-REC                                  57050016
W34517                FROM PCOUT-PC-RECORD                              57060016
W34517            COMPUTE PCOUT-PC-QTY           =                      57070016
W34517                    PCOUT-PC-QTY           * -1                   57080016
W34517            COMPUTE PCOUT-PC-EXTD-RTL-AMT  =                      57090016
W34517                    PCOUT-PC-EXTD-RTL-AMT  * -1                   57100016
W34517            ADD 1 TO PV-TOT-AUDIT-BV-RECS-OUT                     57110016
W34517                     PV-TOT-EDIT-BV-REVR-OUT                      57120016
W34517            SET PCOUT-PC-REVERSAL TO TRUE                         57130016
W34517            WRITE BV-PRC-CHG-REC                                  57140016
W34517                FROM PCOUT-PC-RECORD                              57150016
W34517            COMPUTE PCOUT-PC-QTY           =                      57160016
W34517                    PCOUT-PC-QTY           * -1                   57170016
W34517            COMPUTE PCOUT-PC-EXTD-RTL-AMT  =                      57180016
W34517                    PCOUT-PC-EXTD-RTL-AMT  * -1                   57190016
W34517         END-IF                                                   57200016
W34517         MOVE BV101-BOM-ENT-ID-OUT  TO PCOUT-PC-ENT-ID            57210016
W34517         MOVE BV101-BOM-LBL-SEQ-NBR-OUT                           57220016
W34517                                    TO PCOUT-PC-LBL-SEQ-NBR       57230016
W34517         MOVE BV101-BOM-LO-MDSE-LVL-ID-OUT                        57240016
W34517                                    TO PCOUT-PC-ML-LWST-ID        57250016
W34517         SET PCOUT-PC-REASSIGN TO TRUE                            57260016
W34517         ADD 1 TO PV-TOT-EDIT-BV-REAS-OUT                         57270016
W34517     ELSE                                                         57280016
W34517         EVALUATE TRUE                                            57290016
W34517            WHEN PS-PCHG-AP-DA-MARKDOWN                           57300016
W34517               CONTINUE                                           57310016
W34517            WHEN BV101-PV-BOM-NOT-FOUND                           57320016
W34517               IF PCOUT-PC-LBL-SEQ-NBR = ZERO                     57330016
W34517                   MOVE IN402-VND-ENT-ID-OUT TO PCOUT-PC-ENT-ID   57340016
W34517                   MOVE IN402-VND-LBL-SEQ-NBR                     57350016
W34517                                           TO PCOUT-PC-LBL-SEQ-NBR57360016
W34517                   MOVE IN402-VND-ML-LO-MDSE-LVL-ID               57370016
W34517                                           TO PCOUT-PC-ML-LWST-ID 57380016
W34517               END-IF                                             57390016
W34517            WHEN PS-BOM-ATTR-EQUAL                                57400016
W34517            WHEN ML029-PC-ENT-ID = ZEROES                         57410016
W34517               MOVE BV101-BOM-ENT-ID-OUT TO PCOUT-PC-ENT-ID       57420016
W34517               MOVE BV101-BOM-LBL-SEQ-NBR-OUT                     57430016
W34517                                    TO PCOUT-PC-LBL-SEQ-NBR       57440016
W34517               MOVE BV101-BOM-LO-MDSE-LVL-ID-OUT                  57450016
W34517                                    TO PCOUT-PC-ML-LWST-ID        57460016
W34517               IF ML029-PC-ENT-ID = ZEROES                        57470016
W34517                  ADD 1 TO PV-TOT-ENT-ZERO-BV-UNCH-OUT            57480016
W34517               END-IF                                             57490016
W34517         END-EVALUATE                                             57500016
W34517         SET PCOUT-PC-UNCHNGED TO TRUE                            57510016
W34517         ADD 1 TO PV-TOT-EDIT-BV-UNCH-OUT                         57520016
W34517     END-IF.                                                      57530016
W28582     ADD 1 TO PV-TOT-EDIT-PCHG-RECS-OUT.                          57540016
W28582     WRITE BV-PRC-CHG-REC                                         57550016
W28582         FROM PCOUT-PC-RECORD.                                    57560016
W28582     PERFORM 9300-WRITE-PCHG-DETAIL-OUT.                          57570016
W37965     PERFORM 9310-WRITE-PCHG-DETAIL-AUDIT.                        57580016
W28582     PERFORM 9807-CKPT-LOGIC.                                     57590016
W28582     IF PS-RESTART-RUN                                            57600016
W28582        IF PV-RESTART-COUNT > 1                                   57610016
W28582           CONTINUE                                               57620016
W28582        ELSE                                                      57630016
W28582           DISPLAY PV-RESTART-COUNT                               57640016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    57650016
W28582           DISPLAY PCOUT-PC-RECORD                                57660016
W28582        END-IF                                                    57670016
W28582     END-IF.                                                      57680016
W28582                                                                  57690016
W28582******************************************************************57700016
W28582*    WRITE A RECORD TO THE INVENTORY ADJUSTMENT OUTPUT FILE.      57710016
W28582******************************************************************57720016
W28582 9700-WRITE-ADJ-REC.                                              57730016
W28582     ADD 1 TO PV-TOT-EDIT-ADJ-RECS-OUT.                           57740016
W28582     WRITE BV-ADJUSTMENT-REC                                      57750016
W28582         FROM IAOUT-ADJ-RECORD.                                   57760016
W28582     PERFORM 9300-WRITE-ADJ-DETAIL-OUT.                           57770016
W37965     PERFORM 9311-WRITE-ADJ-DETAIL-AUDIT.                         57780016
W28582     PERFORM 9807-CKPT-LOGIC.                                     57790016
W28582     IF PS-RESTART-RUN                                            57800016
W28582        IF PV-RESTART-COUNT > 1                                   57810016
W28582           CONTINUE                                               57820016
W28582        ELSE                                                      57830016
W28582           DISPLAY PV-RESTART-COUNT                               57840016
W28582           DISPLAY 'RESTARTING ... OUTPUT FROM FIRST REC READ'    57850016
W28582           DISPLAY IAOUT-ADJ-RECORD                               57860016
W28582        END-IF                                                    57870016
W28582     END-IF.                                                      57880016
W28582                                                                  57890016
      ******************************************************************57900016
      *  ABEND CALL FOR ERRORS RETURNED BY BRAND VENDOR LOOKUP UTILITY  57910016
      ******************************************************************57920016
       9997-BV-LOOKUP-ERROR.                                            57930016
           DISPLAY '***************************************************'57940016
           DISPLAY BV003-PV-RETURN-MSG-1                                57950016
           DISPLAY '***************************************************'57960016
           DISPLAY BV003-PV-RETURN-MSG-2                                57970016
           DISPLAY '***************************************************'57980016
           IF BV003-PV-SQL-ERROR                                        57990016
              MOVE BV003-PV-SQLCODE-OUT TO PV-SQLCODE                   58000016
              MOVE PV-SQLCODE TO PV-SQLCODE-DISP                        58010016
              DISPLAY 'SQL CODE = ' PV-SQLCODE-DISP                     58020016
              PERFORM 9998-SQL-ABEND                                    58030016
           ELSE                                                         58040016
              PERFORM 9999-OTHER-ABEND                                  58050016
           END-IF.                                                      58060016
W28582******************************************************************58070016
W28582* SELECT CHECKPOINT RESTART CONTROL VALUE TO SEE IF THIS RUN     *58080016
W28582* IS NORMAL (0) OR A RESTART (9).                                *58090016
W28582******************************************************************58100016
W28582 9800-GET-CHECKPOINT-CNTL.                                        58110016
W28582                                                                  58120016
W28582     PERFORM WITH TEST AFTER                                      58130016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 58140016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         58150016
W28582                     SQLCODE = ZERO                               58160016
W28582                                                                  58170016
W28582       EXEC SQL                                                   58180016
W28582        SELECT CKPT_STAT_CODE                                     58190016
W28582         INTO :PV-CKPT-STAT-CODE                                  58200016
W28582         FROM TCKRSTCNTL                                          58210016
W28582         WHERE JOB_NAME = :PC-JOB-NAME AND                        58220016
W28582               PLAN_NAME = :PC-PGM-NAME                           58230016
W28582       END-EXEC                                                   58240016
W28582                                                                  58250016
W28582       EVALUATE TRUE                                              58260016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          58270016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            58280016
W28582               DISPLAY '*****************************************'58290016
W28582               DISPLAY '** ABEND                               **'58300016
W28582               DISPLAY '** PROGRAM = MLKUP364                  **'58310016
W28582               DISPLAY '** PARAGRAPH = 9800-GET-CHECKPOINT-CNTL**'58320016
W28582               DISPLAY '** CHECKING IF RUN IS NORMAL OR RESTART**'58330016
W28582               DISPLAY '*****************************************'58340016
W28582               PERFORM 9998-SQL-ABEND                             58350016
W28582       END-EVALUATE                                               58360016
W28582     END-PERFORM.                                                 58370016
W28582                                                                  58380016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    58390016
W28582         SQLCODE NOT = ZERO                                       58400016
W28582         DISPLAY '****************************************'       58410016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       58420016
W28582         DISPLAY '** SELECT TCKRSTCNTL                  **'       58430016
W28582         DISPLAY '** PARAGRAPH = 9800-GET-CHECKPOINT-CNTL*'       58440016
W28582         DISPLAY '****************************************'       58450016
W28582         PERFORM 9998-SQL-ABEND                                   58460016
W28582     END-IF.                                                      58470016
W28582                                                                  58480016
W28582******************************************************************58490016
W28582* THIS WILL INITIALIZE THE WORKING STORAGE DESC TEXT THAT IS      58500016
W28582* UPDATED DURING A NORMAL PROGRAM RUN AND USED TO RESTART IN CASE 58510016
W28582* OF AN ABEND. THIS PARAGRAPH IS ONLY EXECUTED DURING A NORMAL RUN58520016
W28582******************************************************************58530016
W28582 9801-INITIALIZE-TCKRSTINF.                                       58540016
W28582                                                                  58550016
W28582     MOVE SPACES TO CKPT-RESTART-INFO.                            58560016
W28582     PERFORM 9806-UPDATE-TCKRSTINF.                               58570016
W28582                                                                  58580016
W28582******************************************************************58590016
W28582* CHECKPOINT-RESTART                                             *58600016
W28582* RETRIEVE THE WORKING STORAGE FIELDS FROM THE DB2 TABLE, THEN   *58610016
W28582* MOVE THE STORED ACCUMULATOR VALUES BACK TO WORKING STORAGE     *58620016
W28582* BEFORE THE PROCESSING FOR THE RESTART CONTINUES. THIS IS DONE  *58630016
W28582* SO THE REPORT STATISTICS IN THE SYSOUT ARE ACCURATE AFTER A    *58640016
W28582* RESTART IS DONE, OTHERWISE THE SYSOUT WOULD ONLY REFLECT WHAT  *58650016
W28582* WAS PROCESSED FROM THE RESTART POINT.                          *58660016
W28582******************************************************************58670016
W28582 9802-CHECKPOINT-RESTART.                                         58680016
W28582                                                                  58690016
W28582     PERFORM 9803-GET-CHECKPOINT-WK-STORG.                        58700016
W28582     MOVE TCKRSTINF-WORK-STRG-DESC-TEXT TO CKPT-RESTART-INFO.     58710016
W28582                                                                  58720016
W28582*RE-LOAD THE STAT VARIABLES FROM TCKRSTINF WORK STORAGE           58730016
W28582*SO THE PROPER STATISTICS WILL BE DISPLAYED UPON PGM COMPLETION.  58740016
W28582                                                                  58750016
W28582     MOVE CKPT-EDIT-ADJ-RECS-IN    TO PV-TOT-EDIT-ADJ-RECS-IN.    58760016
W28582     MOVE CKPT-EDIT-PCHG-RECS-IN   TO PV-TOT-EDIT-PCHG-RECS-IN.   58770016
W28582     MOVE CKPT-EDIT-PURCH-RECS-IN  TO PV-TOT-EDIT-PURCH-RECS-IN.  58780016
W28582     MOVE CKPT-EDIT-SALE-RECS-IN   TO PV-TOT-EDIT-SALE-RECS-IN.   58790016
W28582     MOVE CKPT-EDIT-ADJ-RECS-OUT   TO PV-TOT-EDIT-ADJ-RECS-OUT.   58800016
W28582     MOVE CKPT-EDIT-PCHG-RECS-OUT  TO PV-TOT-EDIT-PCHG-RECS-OUT.  58810016
W28582     MOVE CKPT-EDIT-PURCH-RECS-OUT TO PV-TOT-EDIT-PURCH-RECS-OUT. 58820016
W28582     MOVE CKPT-EDIT-SALE-RECS-OUT  TO PV-TOT-EDIT-SALE-RECS-OUT.  58830016
W34517     MOVE CKPT-EDIT-BV-ORIG-OUT    TO PV-TOT-EDIT-BV-ORIG-OUT.    58840016
W34517     MOVE CKPT-EDIT-BV-REVR-OUT    TO PV-TOT-EDIT-BV-REVR-OUT.    58850016
W34517     MOVE CKPT-EDIT-BV-REAS-OUT    TO PV-TOT-EDIT-BV-REAS-OUT.    58860016
W34517     MOVE CKPT-EDIT-BV-UNCH-OUT    TO PV-TOT-EDIT-BV-UNCH-OUT.    58870016
W34517     MOVE CKPT-AUDIT-BV-RECS-OUT   TO PV-TOT-AUDIT-BV-RECS-OUT.   58880016
W34517     MOVE CKPT-ENT-ZERO-BV-UNCH-OUT                               58890016
W34517                                   TO PV-TOT-ENT-ZERO-BV-UNCH-OUT.58900016
W34517     MOVE CKPT-BOM-INSERTED        TO PV-TOT-BOM-INSERTED.        58910016
W34517     MOVE CKPT-BOM-INSERT-DUPS     TO PV-TOT-BOM-INSERT-DUPS.     58920016
W34517     MOVE CKPT-UNCL-LIC-FEE-OUT    TO PV-TOT-UNCL-LIC-FEE-OUT.    58930016
W34517     MOVE CKPT-DEF-EXP-VND-OUT     TO PV-TOT-DEF-EXP-VND-OUT.     58940016
W34517     MOVE CKPT-SPEC-BRANDS-NOT-FOUND                              58950016
W34517                                  TO PV-TOT-SPEC-BRANDS-NOT-FOUND.58960016
W28582                                                                  58970016
W28582******************************************************************58980016
W28582*    SELECT CHECKPOINT RESTART WORKING STORAGE INFORMATION.       58990016
W28582*    THIS FIELD ON THE DCLGEN IS LVC. IT HAS A LENGTH OF 4022.    59000016
W28582******************************************************************59010016
W28582 9803-GET-CHECKPOINT-WK-STORG.                                    59020016
W28582                                                                  59030016
W28582     PERFORM WITH TEST AFTER                                      59040016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 59050016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         59060016
W28582                     SQLCODE = ZERO                               59070016
W28582                                                                  59080016
W28582       EXEC SQL                                                   59090016
W28582        SELECT WORK_STRG_DESC                                     59100016
W28582         INTO :TCKRSTINF-WORK-STRG-DESC                           59110016
W28582         FROM TCKRSTINF                                           59120016
W28582        WHERE JOB_NAME = :PC-JOB-NAME   AND                       59130016
W28582              PLAN_NAME = :PC-PGM-NAME                            59140016
W28582       END-EXEC                                                   59150016
W28582                                                                  59160016
W28582       EVALUATE TRUE                                              59170016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          59180016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            59190016
W28582             DISPLAY '******************************************' 59200016
W28582             DISPLAY '* ABEND                                   ' 59210016
W28582             DISPLAY '* PROGRAM = MLKUP364                      ' 59220016
W28582             DISPLAY '* PARAGRAPH = 9803-GET-CHECKPOINT-WK-STORG' 59230016
W28582             DISPLAY '* GETTING RESTART WORKING STORAGE INFO    ' 59240016
W28582             DISPLAY '******************************************' 59250016
W28582             PERFORM 9998-SQL-ABEND                               59260016
W28582       END-EVALUATE                                               59270016
W28582     END-PERFORM.                                                 59280016
W28582                                                                  59290016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    59300016
W28582         SQLCODE NOT = ZERO                                       59310016
W28582         DISPLAY '****************************************'       59320016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       59330016
W28582         DISPLAY '** SELECT TCKRSTINF                   **'       59340016
W28582         DISPLAY '** PARAGRAPH = 9803-GET-CHECKPOINT-WK-STORG'    59350016
W28582         DISPLAY '****************************************'       59360016
W28582         PERFORM 9998-SQL-ABEND                                   59370016
W28582     END-IF.                                                      59380016
W28582                                                                  59390016
W28582******************************************************************59400016
W28582*    UPDATES THE CHECKPOINT RESTART CONTROL TABLE.  THE STATUS   *59410016
W28582*    CODE IS SET TO '9' (RUN IN PROGRESS) OR '0' (RUN COMPLETE). *59420016
W28582******************************************************************59430016
W28582 9804-UPDATE-TCKRSTCNTL.                                          59440016
W28582                                                                  59450016
W28582     PERFORM WITH TEST AFTER                                      59460016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 59470016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         59480016
W28582                     SQLCODE = ZERO                               59490016
W28582                                                                  59500016
W28582       EXEC SQL                                                   59510016
W28582         UPDATE TCKRSTCNTL                                        59520016
W28582         SET CKPT_STAT_CODE   = :PV-CKPT-STAT-CODE                59530016
W28582         WHERE JOB_NAME       = :PC-JOB-NAME AND                  59540016
W28582               PLAN_NAME      = :PC-PGM-NAME                      59550016
W28582       END-EXEC                                                   59560016
W28582                                                                  59570016
W28582       EVALUATE TRUE                                              59580016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          59590016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            59600016
W28582               DISPLAY '****************************************' 59610016
W28582               DISPLAY '** ABEND                              **' 59620016
W28582               DISPLAY '** PROGRAM = MLKUP364                 **' 59630016
W28582               DISPLAY '** PARAGRAPH = 9804-UPDATE-TCKRSTCNTL **' 59640016
W28582               DISPLAY '** UPDATING CKPT STAT CODE            **' 59650016
W28582               DISPLAY '****************************************' 59660016
W28582               PERFORM 9998-SQL-ABEND                             59670016
W28582       END-EVALUATE                                               59680016
W28582     END-PERFORM.                                                 59690016
W28582                                                                  59700016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    59710016
W28582         SQLCODE NOT = ZERO                                       59720016
W28582         DISPLAY '****************************************'       59730016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       59740016
W28582         DISPLAY '** UPDATE TCKRSTCNTL                  **'       59750016
W28582         DISPLAY '** PARAGRAPH = 9804-UPDATE-TCKRSTCNTL **'       59760016
W28582         DISPLAY '****************************************'       59770016
W28582         PERFORM 9998-SQL-ABEND                                   59780016
W28582     END-IF.                                                      59790016
W28582                                                                  59800016
W28582******************************************************************59810016
W28582* THE DATA FROM THESE FIELDS WILL BE STORED IN THE CHECKPOINT    *59820016
W28582* RESTART INFO DESC.                                              59830016
W28582******************************************************************59840016
W28582 9805-SAVE-DATA-FOR-RESTART.                                      59850016
W28582     MOVE PV-REC-TYPE-IN             TO CKPT-REC-TYPE.            59860016
W28582     MOVE PV-TOT-EDIT-ADJ-RECS-IN    TO CKPT-EDIT-ADJ-RECS-IN.    59870016
W28582     MOVE PV-TOT-EDIT-PCHG-RECS-IN   TO CKPT-EDIT-PCHG-RECS-IN.   59880016
W28582     MOVE PV-TOT-EDIT-PURCH-RECS-IN  TO CKPT-EDIT-PURCH-RECS-IN.  59890016
W28582     MOVE PV-TOT-EDIT-SALE-RECS-IN   TO CKPT-EDIT-SALE-RECS-IN.   59900016
W28582     MOVE PV-TOT-EDIT-ADJ-RECS-OUT   TO CKPT-EDIT-ADJ-RECS-OUT.   59910016
W28582     MOVE PV-TOT-EDIT-PCHG-RECS-OUT  TO CKPT-EDIT-PCHG-RECS-OUT.  59920016
W28582     MOVE PV-TOT-EDIT-PURCH-RECS-OUT TO CKPT-EDIT-PURCH-RECS-OUT. 59930016
W28582     MOVE PV-TOT-EDIT-SALE-RECS-OUT  TO CKPT-EDIT-SALE-RECS-OUT.  59940016
W34517     MOVE PV-TOT-EDIT-BV-ORIG-OUT    TO CKPT-EDIT-BV-ORIG-OUT.    59950016
W34517     MOVE PV-TOT-EDIT-BV-REVR-OUT    TO CKPT-EDIT-BV-REVR-OUT.    59960016
W34517     MOVE PV-TOT-EDIT-BV-REAS-OUT    TO CKPT-EDIT-BV-REAS-OUT.    59970016
W34517     MOVE PV-TOT-EDIT-BV-UNCH-OUT    TO CKPT-EDIT-BV-UNCH-OUT.    59980016
W34517     MOVE PV-TOT-AUDIT-BV-RECS-OUT   TO CKPT-AUDIT-BV-RECS-OUT.   59990016
W34517     MOVE PV-TOT-ENT-ZERO-BV-UNCH-OUT                             60000016
W34517                                     TO CKPT-ENT-ZERO-BV-UNCH-OUT.60010016
W34517     MOVE PV-TOT-BOM-INSERTED        TO CKPT-BOM-INSERTED.        60020016
W34517     MOVE PV-TOT-BOM-INSERT-DUPS     TO CKPT-BOM-INSERT-DUPS.     60030016
W34517     MOVE PV-TOT-UNCL-LIC-FEE-OUT    TO CKPT-UNCL-LIC-FEE-OUT.    60040016
W34517     MOVE PV-TOT-DEF-EXP-VND-OUT     TO CKPT-DEF-EXP-VND-OUT.     60050016
W34517     MOVE PV-TOT-SPEC-BRANDS-NOT-FOUND                            60060016
W34517                                    TO CKPT-SPEC-BRANDS-NOT-FOUND.60070016
W28582                                                                  60080016
W28582******************************************************************60090016
W28582*  UPDATES THE CHECKPOINT RESTART INFORMATION TABLE.  THIS        60100016
W28582*  INFORMATION WOULD BE USED TO RESTART JOB IN CASE OF AN ABEND  *60110016
W28582******************************************************************60120016
W28582 9806-UPDATE-TCKRSTINF.                                           60130016
W28582                                                                  60140016
W28582     MOVE CKPT-RESTART-INFO    TO TCKRSTINF-WORK-STRG-DESC-TEXT.  60150016
W28582     MOVE 4022                 TO TCKRSTINF-WORK-STRG-DESC-LEN.   60160016
W28582                                                                  60170016
W28582     PERFORM WITH TEST AFTER                                      60180016
W28582             VARYING PV-RETRY-COUNTER FROM 1 BY 1                 60190016
W28582             UNTIL   PV-RETRY-COUNTER > PC-MAX-RETRIES OR         60200016
W28582                     SQLCODE = ZERO                               60210016
W28582                                                                  60220016
W28582       EXEC SQL                                                   60230016
W28582          UPDATE TCKRSTINF                                        60240016
W28582           SET WORK_STRG_DESC   = :TCKRSTINF-WORK-STRG-DESC       60250016
W28582           WHERE JOB_NAME       = :PC-JOB-NAME AND                60260016
W28582                 PLAN_NAME      = :PC-PGM-NAME                    60270016
W28582       END-EXEC                                                   60280016
W28582                                                                  60290016
W28582       EVALUATE TRUE                                              60300016
W28582           WHEN SQLCODE EQUAL ZERO                                60310016
W28582              CONTINUE                                            60320016
W28582           WHEN SQLWARN0 NOT EQUAL SPACE                          60330016
W28582           WHEN SQLCODE NOT EQUAL ZERO                            60340016
W28582               DISPLAY '*****************************************'60350016
W28582               DISPLAY '** ABEND                                 '60360016
W28582               DISPLAY '** PROGRAM = MLKUP364                    '60370016
W28582               DISPLAY '** PARAGRAPH = 9806-UPDATE-TCKRSTINF     '60380016
W28582               DISPLAY '** UNSUCCESSFUL UPDATE TCKRSTINF         '60390016
W28582               DISPLAY '*****************************************'60400016
W28582               PERFORM 9998-SQL-ABEND                             60410016
W28582       END-EVALUATE                                               60420016
W28582     END-PERFORM.                                                 60430016
W28582                                                                  60440016
W28582     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES AND                    60450016
W28582         SQLCODE NOT = ZERO                                       60460016
W28582         DISPLAY '****************************************'       60470016
W28582         DISPLAY '** MAX RETRIES EXCEEDED ATTEMPTING TO **'       60480016
W28582         DISPLAY '** UPDATE TO TCKRSTINF                **'       60490016
W28582         DISPLAY '** PARAGRAPH = 9806-UPDATE-TCKRSTINF  **'       60500016
W28582         DISPLAY '****************************************'       60510016
W28582         PERFORM 9998-SQL-ABEND                                   60520016
W28582     END-IF.                                                      60530016
W28582******************************************************************60540016
W28582* SAVE THE CURRENT SUMMARY STATISTICS TO BE USED TO RE-POPULATE  *60550016
W28582* VARIABLES AFTER RESTART. UPDATE THE CHECKPOINT RESTART INFOR-  *60560016
W28582* MATION WORKING STORAGE DESCRIPTION TEXT.                       *60570016
W28582******************************************************************60580016
W28582 9807-CKPT-LOGIC.                                                 60590016
W28582                                                                  60600016
W28582     ADD +1 TO PV-RECS-PROC-FOR-CKPT.                             60610016
W28582                                                                  60620016
W28582     IF PV-RECS-PROC-FOR-CKPT > PC-CKPT-INTERVAL                  60630016
W28582*SAVE CKPT DATA                                                   60640016
W28582         PERFORM 9805-SAVE-DATA-FOR-RESTART                       60650016
W28582*PLACE CKPT DATA IN RESTART TABLE                                 60660016
W28582         PERFORM 9806-UPDATE-TCKRSTINF                            60670016
W28582*COMMIT                                                           60680016
W28582         PERFORM 8200-COMMIT                                      60690016
W28582         MOVE ZEROS TO PV-RECS-PROC-FOR-CKPT                      60700016
W28582         ADD +1 TO PV-CKPT-TAKEN-CNT                              60710016
W28582*LEAVE DISPLAY IN PROGRAM                                         60720016
W28582         DISPLAY 'PV-CKPT-TAKEN-CNT ' PV-CKPT-TAKEN-CNT           60730016
W28582     END-IF.                                                      60740016
W28582                                                                  60750016
W28582                                                                  60760016
      ******************************************************************60770016
      *  STANDARD DB2 ERROR ABEND ROUTINE                               60780016
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.             60790016
      ******************************************************************60800016
       9998-SQL-ABEND.                                                  60810016
           DISPLAY '*************************************************'  60820016
           DISPLAY 'TOT ADJ RECS IN        ' PV-TOT-EDIT-ADJ-RECS-IN    60830016
           DISPLAY 'TOT PRICE CHG RECS IN  ' PV-TOT-EDIT-PCHG-RECS-IN   60840016
           DISPLAY 'TOT PURCH RECORDS IN   ' PV-TOT-EDIT-PURCH-RECS-IN  60850016
           DISPLAY 'TOT SALE RECORDS IN    ' PV-TOT-EDIT-SALE-RECS-IN   60860016
           DISPLAY '*************************************************'  60870016
                                                                        60880016
           SET AC-SQL-ERROR           TO TRUE.                          60890016
           DISPLAY '**  ABEND     **'.                                  60900016
           DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  60910016
                                                                        60920016
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE         60930016
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.        60940016
                                                                        60950016
           COPY DPPD004.                                                60960016
                                                                        60970016
           CALL 'ILBOABN0'  USING ABEND-CODE.                           60980016
                                                                        60990016
      ******************************************************************61000016
      * DO THE NECESSARY PROCESSING TO ABEND FOR MISCELLANEOUS REASONS.*61010016
      ******************************************************************61020016
       9999-OTHER-ABEND.                                                61030016
           DISPLAY '*************************************************'  61040016
           DISPLAY 'TOT ADJ RECS IN        ' PV-TOT-EDIT-ADJ-RECS-IN    61050016
           DISPLAY 'TOT PRICE CHG RECS IN  ' PV-TOT-EDIT-PCHG-RECS-IN   61060016
           DISPLAY 'TOT PURCH RECORDS IN   ' PV-TOT-EDIT-PURCH-RECS-IN  61070016
           DISPLAY 'TOT SALE RECORDS IN    ' PV-TOT-EDIT-SALE-RECS-IN   61080016
           DISPLAY '*************************************************'  61090016
           SET AC-OTHER-ERROR TO TRUE.                                  61100016
           DISPLAY '**  ABEND     **'.                                  61110016
           DISPLAY '**  PROGRAM   **  = ' PC-PGM-NAME.                  61120016
           DISPLAY '************************************************'.  61130016
           CALL 'ILBOABN0' USING ABEND-CODE.                            61140016
                                                                        61150016
W28582******************************************************************61160016
W28582* PRICING MODULE CODE                                             61170016
W28582******************************************************************61180016
W31475*    COPY INPD400.                                                61190016
W31475     COPY INPD402.                                                61200016
W34517******************************************************************61210016
W34517* CODE TO PRORATE AGAINST VENDORS FOR SPECIFC BRANDS              61220016
W34517******************************************************************61230016
W34517     COPY BVPD002.                                                61240016
W34517******************************************************************61250016
W34517* BEGINNING OF MONTH (BOM) SKU ATTRIBUTE CODE                     61260016
W34517******************************************************************61270016
W31475     COPY BVPD101.                                                61280016
