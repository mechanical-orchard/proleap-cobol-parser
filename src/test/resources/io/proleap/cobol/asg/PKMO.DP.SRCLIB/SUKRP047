000100 IDENTIFICATION DIVISION.                                         00010000
000200                                                                  00020000
000300 PROGRAM-ID.             SUKRP047.                                00030000
000400 AUTHOR.                 GERMAN BANDA.                            00040000
000500 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00050000
000600 DATE-WRITTEN            MAY, 2006.                               00060000
000700 DATE-COMPILED.                                                   00070000
000800***************************************************************** 00080000
000900* CREATE 'NEW TO STORE TRAILER SUMMARY REPORT'              *     00090000
001000*                                                               * 00100000
001100* REPORT THE NUMBER OF CARTONS BY BUSINESS AREA AND             * 00110000
001200* MERCHANDISE PROGRAM FOR CARTONS THAT HAVE ITEMS THAT ARE      * 00120000
001300* NEW TO THE STORE.                                             * 00130000
001400***************************************************************** 00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600                                                                  00160000
001700 CONFIGURATION SECTION.                                           00170000
001800                                                                  00180000
001900 SOURCE-COMPUTER.        IBM-3090.                                00190000
002000 OBJECT-COMPUTER.        IBM-3090.                                00200000
002100                                                                  00210000
002200 INPUT-OUTPUT SECTION.                                            00220000
002300                                                                  00230000
002400 FILE-CONTROL.                                                    00240000
002500                                                                  00250000
002600     SELECT TRIP-FILE                                             00260000
002700         ASSIGN TO INP01.                                         00270000
002800                                                                  00280000
002900     SELECT REPORT-FILE                                           00290000
003000         ASSIGN TO RPT01.                                         00300000
003100                                                                  00310000
003200 DATA DIVISION.                                                   00320000
003300                                                                  00330000
003400 FILE SECTION.                                                    00340000
003500*                                                                 00350000
003600 FD  TRIP-FILE                                                    00360000
003700     RECORDING MODE IS F                                          00370000
003800     LABEL RECORDS ARE STANDARD                                   00380000
003900     BLOCK CONTAINS 0 RECORDS.                                    00390000
004000 01  TRIP-RECORD                     PIC X(100).                  00400000
004100*                                                                 00410000
004200 FD  REPORT-FILE                                                  00420000
004300     RECORDING MODE IS F                                          00430000
004400     LABEL RECORDS ARE STANDARD                                   00440000
004500     BLOCK CONTAINS 0 RECORDS.                                    00450000
004600 01  REPORT-RECORD                   PIC X(132).                  00460000
004700                                                                  00470000
004800 WORKING-STORAGE SECTION.                                         00480000
004810*                                                                 00481018
004820*** NULL INDICATORS                                               00482019
004830*                                                                 00483019
004840 01  DN-DB2-NULL-INDICATORS.                                      00484019
004850     05  DN-DIST-NBR                  PIC S9(04) COMP VALUE ZERO. 00485019
004900*                                                                 00490000
005000*** PROGRAM SWITCHES                                              00500000
005100*                                                                 00510000
005200 01  PROGRAM-SWITCHES.                                            00520000
005300     05  PS-DATA-SW                   PIC X(01) VALUE 'N'.        00530000
005400         88  PS-DATA-NO                         VALUE 'N'.        00540000
005500         88  PS-DATA-YES                        VALUE 'Y'.        00550000
005600     05  PS-EOF-INPUT-SW              PIC X(01) VALUE 'N'.        00560000
005700         88  PS-EOF-INPUT-YES                   VALUE 'Y'.        00570000
005800         88  PS-EOF-INPUT-NO                    VALUE 'N'.        00580000
005900     05  PS-DISTRICT-ON-HAND-SW       PIC X(01) VALUE 'N'.        00590000
006000         88  PS-DISTRICT-ON-HAND-YES            VALUE 'Y'.        00600000
006100         88  PS-DISTRICT-ON-HAND-NO             VALUE 'N'.        00610000
006200     05  PS-PROCESS-STORE-SW          PIC X(01) VALUE 'N'.        00620000
006300         88  PS-PROCESS-STORE-YES               VALUE 'Y'.        00630000
006400         88  PS-PROCESS-STORE-NO                VALUE 'N'.        00640000
006500     05  PS-TRIP-SML-CSR-SW           PIC X(01) VALUE 'N'.        00650000
006600         88  PS-TRIP-SML-EOF-YES                VALUE 'Y'.        00660000
006700         88  PS-TRIP-SML-EOF-NO                 VALUE 'N'.        00670000
006800     05  PS-FIRST-ITEM-SW             PIC X(01) VALUE 'Y'.        00680000
006900         88  PS-FIRST-ITEM-YES                  VALUE 'Y'.        00690000
007000         88  PS-FIRST-ITEM-NO                   VALUE 'N'.        00700000
007100     05  PS-FIRST-FETCH-SW            PIC X(01) VALUE 'N'.        00710000
007200         88  PS-FIRST-FETCH-FND                 VALUE 'Y'.        00720000
007300         88  PS-FIRST-FETCH-NOT-FND             VALUE 'N'.        00730000
007400     05  PS-PRINT-BUSINESS-AREA-SW    PIC X(01) VALUE 'Y'.        00740000
007500         88  PS-PRINT-BUS-AREA-YES              VALUE 'Y'.        00750000
007600         88  PS-PRINT-BUS-AREA-NO               VALUE 'N'.        00760000
007800                                                                  00780000
007900                                                                  00790000
008000 01  PV-PROGRAM-VARIABLES.                                        00800000
008100                                                                  00810000
008110     05  PC-END-OF-PAGE              PIC S9(03)  VALUE +60        00811000
008120                                                 COMP-3.          00812000
008130                                                                  00813000
008200     05  PC-RF                       PIC  X(02)    VALUE 'RF'.    00820000
008201     05  PC-B                        PIC  X(01)    VALUE 'B'.     00820100
008202     05  PC-H                        PIC  X(01)    VALUE 'H'.     00820200
008203     05  PC-F                        PIC  X(01)    VALUE 'F'.     00820300
008204     05  PC-MERCH-BRAND              PIC  X(20)    VALUE          00820406
008205         'MERCHANDISE BRAND  '.                                   00820506
008210     05  PC-CURRENT-PROGRAM-NAME     PIC  X(08)    VALUE          00821000
008300         'SUKRP047'.                                              00830000
008310     05  PC-DEFAULT-TMST             PIC X(26)  VALUE             00831000
008320                                     '0001-01-01-01.01.01.000000'.00832000
008330     05  PC-BEGIN-TMST               PIC X(26)  VALUE             00833000
008340                                     '2006-08-13-01.01.01.000000'.00834000
008400                                                                  00840000
008500     05  PV-PAGE-COUNT               PIC S9(04)   VALUE ZERO      00850000
008600                                                  COMP-3.         00860000
008700     05  PV-LINE-COUNT               PIC S9(03)   VALUE ZERO      00870000
008800                                                  COMP-3.         00880000
008900                                                                  00890000
008910     05  PV-HANG-IND-COUNT           PIC S9(09)   COMP.           00891035
008911     05  PV-FOLD-IND-COUNT           PIC S9(09)   COMP.           00891135
008920     05  PV-NEW-IND-COUNT            PIC S9(09)   COMP.           00892035
008930     05  PV-READ-COUNT               PIC S9(09)   COMP            00893035
008940                                                  VALUE ZEROS.    00894035
009000     05  PV-TODAYS-DATE.                                          00900000
009100         10  PV-TODAYS-DATE-CCYY     PIC  9(04)    VALUE ZEROS.   00910000
009200         10  PV-TODAYS-DATE-MM       PIC  9(02)    VALUE ZEROS.   00920000
009300         10  PV-TODAYS-DATE-DD       PIC  9(02)    VALUE ZEROS.   00930000
009400     05  PV-TODAYS-TIME.                                          00940000
009500         10  PV-TODAYS-TIME-HH       PIC  9(02)    VALUE ZEROS.   00950000
009600         10  PV-TODAYS-TIME-MM       PIC  9(02)    VALUE ZEROS.   00960000
009700         10  PV-TODAYS-TIME-SS       PIC  9(02)    VALUE ZEROS.   00970000
009800         10  FILLER                  PIC  9(02)    VALUE ZEROS.   00980000
009900     05  PV-FORMAT-DATE.                                          00990000
010000         10  PV-FORMAT-DATE-MM       PIC  X(02)    VALUE SPACES.  01000000
010100         10  FILLER                  PIC  X(01)    VALUE '/'.     01010000
010200         10  PV-FORMAT-DATE-DD       PIC  X(02)    VALUE SPACES.  01020000
010300         10  FILLER                  PIC  X(01)    VALUE '/'.     01030000
010400         10  PV-FORMAT-DATE-YYYY     PIC  X(04)    VALUE SPACES.  01040000
010500                                                                  01050000
010600     05  PV-DISP-STORE          PIC  Z(04)     VALUE ZEROES.      01060000
010700     05  PV-DISP-DC             PIC  Z(04)     VALUE ZEROES.      01070000
010800     05  PV-DISP-TRIP           PIC  Z(09)     VALUE ZEROES.      01080000
010810     05  PV-DISP-PREV-TRIP      PIC  Z(09)     VALUE ZEROES.      01081019
010900     05  PV-DISP-ORCNCE         PIC  Z(09)     VALUE ZEROES.      01090000
011000     05  PV-DISP-TRLR-SRL       PIC  Z(09)     VALUE ZEROES.      01100000
011100     05  PV-DISP-DISTRICT       PIC  Z(04)     VALUE ZEROES.      01110000
011200     05  PV-DISP-UNITS          PIC  Z(09)     VALUE ZEROES.      01120000
011300     05  PV-DISP-SQLCODE        PIC  -999.                        01130000
011400     05  PV-DISP-SML            PIC  X(18).                       01140000
011500     05  PV-DISP-SKU            PIC  9(08).                       01150000
011510     05  PV-DISP-READ-COUNT     PIC  ZZZ,ZZZ,ZZ9                  01151035
011520                                               VALUE ZEROES.      01152035
011600*                                                                 01160000
011700     05  PV-TRIP-ID             PIC S9(09)      VALUE ZEROES.     01170000
011800     05  PV-TRIP-OCRNC          PIC S9(09)      VALUE ZEROES.     01180000
011900     05  PV-STORE-DEST          PIC  9(04)      VALUE ZEROES.     01190000
012000     05  PV-STORE-NUMBER        PIC  9(04)      VALUE ZEROES.     01200000
012100     05  PV-STORE-NAME          PIC  X(40)      VALUE SPACES.     01210000
012200     05  PV-DC-NUMBER           PIC S9(04) COMP VALUE ZEROES.     01220000
012300     05  PV-DC-NAME             PIC  X(40)      VALUE SPACES.     01230000
012400     05  PV-DC-SCAC             PIC  X(04)      VALUE SPACES.     01240000
012500     05  PV-DC-TRLR-ID          PIC  X(12)      VALUE SPACES.     01250000
012600     05  PV-PREV-STORE          PIC  9(04)      VALUE ZEROES.     01260000
012700     05  PV-PREV-DC             PIC  9(04)      VALUE ZEROES.     01270000
012800     05  PV-PREV-TRIP           PIC  9(09)      VALUE ZEROES.     01280000
012900     05  PV-PREV-ORCNC          PIC  9(09)      VALUE ZEROES.     01290000
013000     05  PV-TRIP-STATUS         PIC  X(30)      VALUE SPACES.     01300000
013100     05  PV-PREV-SML            PIC  9(18)      VALUE ZEROES.     01310000
013200     05  PV-PREV-DIVERT         PIC  9(26)      VALUE ZEROES.     01320000
013300     05  PV-TABLE-1             PIC  X(30)      VALUE SPACES.     01330000
013400     05  PV-TABLE-2             PIC  X(30)      VALUE SPACES.     01340000
013500     05  PV-TABLE-3             PIC  X(30)      VALUE SPACES.     01350000
013600     05  PV-TRIP-BEGIN-TMST     PIC  X(26)      VALUE SPACES.     01360000
013700     05  PV-TRIP-END-TMST       PIC  X(26)      VALUE SPACES.     01370000
013800     05  PV-QUARTER-BEGIN-TMST  PIC  X(26)      VALUE SPACES.     01380000
013900     05  PV-QUARTER-END-TMST    PIC  X(26)      VALUE SPACES.     01390000
014000                                                                  01400000
014100     05  PV-TRIP-CARTON-COUNT   PIC S9(04)  VALUE +0              01410000
014200                                                 COMP.            01420000
014300     05  PV-DISP-TRIP-COUNT     PIC  Z(09)      VALUE ZEROS.      01430000
014400     05  PV-DISP-QUART-COUNT    PIC  Z(06)     VALUE ZEROES.      01440000
014500     05  PV-DISP-CART-REMAIN    PIC  Z(06)     VALUE ZEROES.      01450000
014600     05  PV-HARDLINE-UNITS      PIC S9(09) COMP VALUE ZEROS.      01460000
014700     05  PV-SOFTLINE-UNITS      PIC S9(09) COMP VALUE ZEROS.      01470000
014800     05  PV-HANG-UNITS          PIC S9(09) COMP VALUE ZEROS.      01480000
014900     05  PV-FOLD-UNITS          PIC S9(09) COMP VALUE ZEROS.      01490000
015000     05  PV-NULL-IND-1          PIC S9(04)      VALUE ZEROS       01500000
015100                                                COMP SYNC.        01510000
015200     05  PV-NULL-IND-2          PIC S9(04)      VALUE ZEROS       01520000
015300                                                COMP SYNC.        01530000
015400*                                                                 01540000
015500     05  PV-WORK-TMST           PIC  X(26)     VALUE SPACES.      01550000
015600     05  PV-WORK-TMST-R REDEFINES PV-WORK-TMST.                   01560000
015700         10  PV-WORK-TMST-YY    PIC  9(04).                       01570000
015800         10  FILLER             PIC  X(01).                       01580000
015900         10  PV-WORK-TMST-MM    PIC  9(02).                       01590000
016000         10  FILLER             PIC  X(01).                       01600000
016100         10  PV-WORK-TMST-DD    PIC  9(02).                       01610000
016200         10  PV-FILLER          PIC  X(16).                       01620000
016300*                                                                 01630000
016400     05  PV-WORK-DATE           PIC  9(08).                       01640000
016500     05  PV-WORK-DATE-R REDEFINES PV-WORK-DATE.                   01650000
016600         10  PV-WORK-DATE-YY    PIC  9(04).                       01660000
016700         10  PV-WORK-DATE-MM    PIC  9(02).                       01670000
016800         10  PV-WORK-DATE-DD    PIC  9(02).                       01680000
016900*                                                                 01690000
017000     05  PV-WORK-OPEN           PIC  X(10)     VALUE SPACES.      01700000
017100     05  PV-WORK-OPEN-R REDEFINES PV-WORK-OPEN.                   01710000
017200         10  PV-WORK-OPEN-YY    PIC  9(04).                       01720000
017300         10  FILLER             PIC  X(01).                       01730000
017400         10  PV-WORK-OPEN-MM    PIC  9(02).                       01740000
017500         10  FILLER             PIC  X(01).                       01750000
017600         10  PV-WORK-OPEN-DD    PIC  9(02).                       01760000
017700*                                                                 01770000
017800     05  PV-WORK-OPEN-DATE         PIC  9(08).                    01780000
017900     05  PV-WORK-OPEN-DATE-R REDEFINES PV-WORK-OPEN-DATE.         01790000
018000         10  PV-WORK-OPEN-DATE-YY  PIC  9(04).                    01800000
018100         10  PV-WORK-OPEN-DATE-MM  PIC  9(02).                    01810000
018200         10  PV-WORK-OPEN-DATE-DD  PIC  9(02).                    01820000
018300                                                                  01830000
018400*                                                                 01840000
018500     05  PV-NO-ITEMS-READ          PIC S9(09)  COMP.              01850006
018510     05  PV-SKU-COUNT              PIC S9(09)  COMP.              01851006
018600     05  PV-MSDSE-AREA-CRTN-COUNT  PIC S9(09)  COMP.              01860000
018700     05  PV-TRAILER-CRTN-COUNT     PIC S9(09)  COMP.              01870000
018800     05  PV-TOTAL-SKU-COUNT        PIC S9(09)  COMP.              01880000
018900     05  PV-TOTAL-UNIT-COUNT       PIC S9(09)  COMP.              01890000
019000     05  PV-SKU-UNIT-QTY           PIC S9(09)  COMP.              01900000
019100*                                                                 01910000
019200     05  PV-CRTNS-ON-TRLR          PIC  9(06)     VALUE ZEROES.   01920000
019300     05  PV-CRTNS-PER-QUARTER      PIC  9(06)     VALUE ZEROES.   01930000
019400     05  PV-CRTNS-PER-QUARTER-REM  PIC  9(06)     VALUE ZEROES.   01940000
019500     05  PV-CRTNS-1ST-QUART        PIC  9(06)     VALUE ZEROES.   01950000
019600     05  PV-CRTNS-2ND-QUART        PIC  9(06)     VALUE ZEROES.   01960000
019700     05  PV-CRTNS-3RD-QUART        PIC  9(06)     VALUE ZEROES.   01970000
019800     05  PV-CRTNS-4TH-QUART        PIC  9(06)     VALUE ZEROES.   01980000
019900     05  PV-CURRENT-QUART-COUNT    PIC  9(06)     VALUE ZEROES.   01990000
020000                                                                  02000000
020100     05  PV-PARAGRAPH-NAME         PIC  X(30)     VALUE SPACE.    02010000
020200     05  PV-ERROR-MESSAGE-1        PIC  X(50)     VALUE SPACE.    02020000
020300     05  PV-ERROR-MESSAGE-2        PIC  X(50)     VALUE SPACE.    02030000
020400     05  PV-ABEND-CODE             PIC S9(04)     VALUE ZERO.     02040000
020500**** SAVE FIELDS                                                  02050000
020600 01  PV-SAVE-VARIABLES.                                           02060000
020700     05  PV-SAVE-BUS-AREA-ID     PIC  S9(2)V COMP-3 VALUE 0.      02070000
020800     05  PV-SAVE-MDSE-PGM-ID     PIC  S9(10)V COMP-3 VALUE 0.     02080000
020810     05  PV-SAVE-BRND-ID         PIC  S9(4)  COMP   VALUE 0.      02081029
020900     05  PV-SAVE-SHIPT-UNT-ID    PIC  S9(18)V COMP-3 VALUE 0.     02090000
021000     05  PV-SAVE-SKU-NBR         PIC  S9(8)V COMP-3 VALUE 0.      02100000
021010     05  PV-SAVE-DTL-BUS-AREA    PIC  S9(2)V COMP-3 VALUE 0.      02101000
021020     05  PV-SAVE-DTL-BUS-DESC    PIC  X(25)  VALUE SPACE.         02102000
021030     05  PV-SAVE-DTL-BUS-DASH    PIC  X(05)  VALUE SPACE.         02103000
021100                                                                  02110000
021200*    TRIP SUMMARY - INPUT FILE LAYOUT                             02120000
021300     COPY SURD069.                                                02130000
021400                                                                  02140000
021500/                                                                 02150000
021600*STANDARD REPORT HEADER FOR 132 COLUMN REPORT                     02160000
021700     COPY DPWS132.                                                02170000
021800                                                                  02180000
021900*                                                                 02190000
022000*** HEADING LINES                                                 02200000
022100*                                                                 02210000
022200 01  HEADING-LINE1.                                               02220000
022300     05  FILLER                  PIC  X(48)    VALUE SPACE.       02230000
022400     05  FILLER                  PIC  X(36)    VALUE              02240000
022500         'DAILY - NEW TO STORE TRAILER SUMMARY'.                  02250000
022600     05  FILLER                  PIC  X(48)    VALUE SPACE.       02260000
022700                                                                  02270000
022800 01  HEADING-LINE2.                                               02280000
022900     05  FILLER                  PIC  X(08)    VALUE 'STORE - '.  02290000
023000     05  HL2-STORE-NBR           PIC  9(04)    VALUE ZEROES.      02300000
023100     05  FILLER                  PIC  X(02)    VALUE SPACES.      02310000
023200     05  HL2-STORE-NAME          PIC  X(40)    VALUE SPACES.      02320000
023300     05  FILLER                  PIC  X(68)    VALUE SPACE.       02330000
023400                                                                  02340000
023500 01  HEADING-LINE3.                                               02350000
023600     05  FILLER                  PIC  X(08)    VALUE 'DC    - '.  02360000
023700     05  HL3-DC-NBR              PIC  Z(04)    VALUE ZEROES.      02370000
023800     05  FILLER                  PIC  X(02)    VALUE SPACES.      02380000
023900     05  HL3-DC-NAME             PIC  X(40)    VALUE SPACES.      02390000
024000     05  FILLER                  PIC  X(68)    VALUE SPACE.       02400000
024100                                                                  02410000
024200                                                                  02420000
024300 01  HEADING-LINE5.                                               02430000
024400     05  FILLER                  PIC  X(17)    VALUE              02440000
024500                                 'SCAC:            '.             02450000
024600     05  HL5-SCAC                PIC  X(04)    VALUE SPACES.      02460000
024700     05  FILLER                  PIC  X(111)   VALUE SPACES.      02470000
024800                                                                  02480000
024900 01  HEADING-LINE6.                                               02490000
025000     05  FILLER                  PIC  X(17)    VALUE              02500000
025100                                 'TRAILER ID:      '.             02510000
025200     05  HL6-TRLR-ID             PIC  X(12)    VALUE SPACES.      02520000
025300     05  FILLER                  PIC  X(103)   VALUE SPACES.      02530000
025400                                                                  02540000
025500 01  HEADING-LINE7.                                               02550000
025600     05  FILLER                  PIC  X(17)    VALUE              02560000
025700                                 'TRAILER SERIAL:  '.             02570000
025800     05  HL7-TRLR-SRL            PIC  Z(09)    VALUE ZEROES.      02580000
025900     05  FILLER                  PIC  X(106)   VALUE SPACES.      02590000
026000                                                                  02600000
026100 01  HEADING-LINE8.                                               02610000
026200     05  FILLER                  PIC  X(14)    VALUE              02620000
026300                                 'BUSINESS AREA '.                02630000
026400     05  FILLER                  PIC  X(23)    VALUE SPACES.      02640000
026500     05  HL8-MDSE-DESC           PIC  X(20)    VALUE SPACES.      02650006
026700     05  FILLER                  PIC  X(24)    VALUE SPACES.      02670000
026800     05  FILLER                  PIC  X(08)    VALUE              02680000
026900                                 'CARTONS '.                      02690000
027000     05  FILLER                  PIC  X(03)    VALUE SPACES.      02700000
027100     05  FILLER                  PIC  X(04)    VALUE              02710000
027200                                 'SKUS'.                          02720000
027300     05  FILLER                  PIC  X(03)    VALUE SPACES.      02730000
027400     05  FILLER                  PIC  X(03)    VALUE              02740000
027500                                 'NEW'.                           02750000
027501     05  FILLER                  PIC  X(03)    VALUE SPACES.      02750100
027510     05  FILLER                  PIC  X(06)    VALUE              02751000
027520                                 'UNITS '.                        02752000
027530     05  FILLER                  PIC  X(01)    VALUE SPACES.      02753000
027600     05  FILLER                  PIC  X(20)    VALUE              02760000
027610                                 'HANG-H/FOLD-F/BOTH-B'.          02761000
027700                                                                  02770000
027800*                                                                 02780000
027900 01  DL-DETAIL-LINE1.                                             02790000
028000     05  FILLER                  PIC  X(02)    VALUE SPACE.       02800000
028100     05  DL1-BUSINESS-AREA       PIC  X(02).                      02810000
028200     05  DL1-DASH1               PIC  X(05)    VALUE              02820000
028300                                              '  -  '.            02830000
028400     05  DL1-BUS-AREA-DESC       PIC  X(25)    VALUE SPACE.       02840000
028500     05  FILLER                  PIC  X(03)    VALUE SPACE.       02850000
028600     05  DL1-MERCHANDISE-LBL     PIC  X(43)    VALUE SPACE.       02860006
028700     05  FILLER                  PIC  X(01)    VALUE SPACE.       02870000
028800     05  DL1-CARTON-COUNT        PIC  ZZ,ZZ9.                     02880000
028900     05  FILLER                  PIC  X(03)    VALUE SPACE.       02890000
029000     05  DL1-SKU-COUNT           PIC  ZZ,ZZ9.                     02900000
029010     05  FILLER                  PIC  X(04)    VALUE SPACE.       02901000
029020     05  DL1-NEW-IND             PIC  X(01).                      02902000
029100     05  FILLER                  PIC  X(02)    VALUE SPACE.       02910000
029200     05  DL1-UNIT-COUNT          PIC  ZZZ,ZZ9.                    02920000
029210     05  FILLER                  PIC  X(12)    VALUE SPACE.       02921000
029220     05  DL1-HANG-FOLD-IND       PIC  X(01).                      02922000
029300     05  FILLER                  PIC  X(18)    VALUE SPACE.       02930000
029500*                                                                 02950000
030700*** GRAND - TOTALS                                                03070000
030800*                                                                 03080000
030900 01  TOTAL-LINE.                                                  03090000
031000     05  FILLER                  PIC  X(40)    VALUE              03100000
031100       'NEW TO STORE TRAILER SUMMARY TOTALS     '.                03110000
031200     05  FILLER                  PIC  X(41)    VALUE SPACES.      03120000
031300     05  TL-GRAND-CRTNS          PIC ZZ,ZZ9    VALUE ZEROES.      03130000
031400     05  FILLER                  PIC  X(03)    VALUE SPACES.      03140000
031500     05  TL-GRAND-SKUS           PIC ZZ,ZZ9    VALUE ZEROES.      03150000
031600     05  FILLER                  PIC  X(08)    VALUE SPACES.      03160000
031700     05  TL-GRAND-UNITS          PIC ZZ,ZZ9    VALUE ZEROES.      03170000
031800*                                                                 03180000
031900*** MISCELLANEOUS LINES                                           03190000
032000*                                                                 03200000
032100 01  MISCELLANEOUS-LINES.                                         03210000
032200     05  END-OF-REPORT-LINE.                                      03220000
032300         10  FILLER                  PIC  X(44)    VALUE SPACES.  03230000
032400         10  FILLER                  PIC  X(45)    VALUE          03240000
032500             '*******   E N D   O F   R E P O R T   *******'.     03250000
032600         10  FILLER                  PIC  X(43)    VALUE SPACES.  03260000
032700     05  NO-DATA-TO-REPORT-LINE.                                  03270000
032800         10  FILLER                  PIC  X(40)    VALUE SPACES.  03280000
032900         10  FILLER                  PIC  X(52)    VALUE          03290000
033000         '*******  N O   D A T A   T O   R E P O R T   *******'.  03300000
033100         10  FILLER                  PIC  X(40)    VALUE SPACES.  03310000
033200     05  NO-NEW-ITEMS-TO-REPORT-LINE.                             03320000
033300         10  FILLER                  PIC  X(40)    VALUE SPACES.  03330000
033400         10  FILLER                  PIC  X(55)    VALUE          03340000
033500         '*****  N O  N E W  I T E M S *** N O  N E W  I T E M S'.03350000
033600         10  FILLER                  PIC  X(37)    VALUE SPACES.  03360000
033700     05  BL-BLANK-LINE               PIC X(132)    VALUE SPACE.   03370000
033800                                                                  03380000
033900*                                                                 03390000
034000*  COPY BOOK FOR XLT_LOC DATABASE                                 03400000
034100*                                                                 03410000
034200     EXEC SQL                                                     03420000
034300          INCLUDE XLT00010                                        03430000
034400     END-EXEC.                                                    03440000
034500*                                                                 03450000
034600*  COPY BOOK FOR TKRPRPM DATABASE (PARAMETERS)                    03460000
034700*                                                                 03470000
034800     EXEC SQL                                                     03480000
034900          INCLUDE TKRPRPM                                         03490000
035000     END-EXEC.                                                    03500000
035100*                                                                 03510000
035200*  COPY BOOK FOR TRAILER ID TABLE                                 03520000
035300*                                                                 03530000
035400     EXEC SQL                                                     03540000
035500          INCLUDE TCNTRID                                         03550000
035600     END-EXEC.                                                    03560000
035700*                                                                 03570000
035800*  COPY BOOK FOR STATUS CODE TABLE                                03580000
035900*                                                                 03590000
036000     EXEC SQL                                                     03600000
036100          INCLUDE TSUOBSC                                         03610000
036200     END-EXEC.                                                    03620000
036300*                                                                 03630000
036400*  COPY BOOK FOR SUM_TRIP_DTL_SUM                                 03640000
036500*                                                                 03650000
036600     EXEC SQL                                                     03660000
036700          INCLUDE SUT00095                                        03670000
036800     END-EXEC.                                                    03680000
036900*                                                                 03690000
037000*  COPY BOOK FOR SUM_TRIP_SUM                                     03700000
037100*                                                                 03710000
037200     EXEC SQL                                                     03720000
037300          INCLUDE SUT00007                                        03730000
037400     END-EXEC.                                                    03740000
037500*                                                                 03750000
037600*  COPY BOOK FOR OUTBOUND TRIP TABLE                              03760000
037700*                                                                 03770000
037800     EXEC SQL                                                     03780000
037900          INCLUDE TSUOBTR                                         03790000
038000     END-EXEC.                                                    03800000
038100                                                                  03810000
038200*                                                                 03820000
038300*  COPY BOOK FOR BUSINESS AREA ID                                 03830000
038400*                                                                 03840000
038500     EXEC SQL                                                     03850000
038600          INCLUDE XLT00000                                        03860000
038700     END-EXEC.                                                    03870000
038800                                                                  03880000
039500                                                                  03950000
039510*                                                                 03951002
039520*  COPY BOOK FOR XLT_BRND                                         03952002
039530*                                                                 03953002
039540     EXEC SQL                                                     03954002
039550          INCLUDE XLT00043                                        03955002
039560     END-EXEC.                                                    03956002
039570                                                                  03957002
039600***************************************************************** 03960000
039700*  DB2 COMMUNICATION AREA                                         03970000
039800***************************************************************** 03980000
039900     EXEC SQL                                                     03990000
040000         INCLUDE SQLCA                                            04000000
040100     END-EXEC.                                                    04010000
040200                                                                  04020000
041900                                                                  04190000
041910*---------------------------------------------------------------* 04191005
041920*   TRIP CURSOR - BRINGS BACK ALL SML/SKUS FOR A GIVEN TRIP     * 04192005
041921*   BY BRAND                                                    * 04192105
041930*---------------------------------------------------------------* 04193005
041940     EXEC SQL                                                     04194005
041950          DECLARE TRIP_SML_BRND_CSR CURSOR FOR                    04195005
041960              SELECT DISTINCT                                     04196005
041970                     BUS_AREA_ID                                  04197005
041980                    ,BRND_ID                                      04198005
041990                    ,SKU_NBR                                      04199005
041991                FROM SUT_TRIP_DTL_SUM                             04199105
041992               WHERE TRIP_OCRNC_ID  =  :SUT00095-TRIP-OCRNC-ID    04199205
041993                 AND PRC_MSG_CDE     = 'RF'                       04199305
041994          ORDER BY                                                04199405
041995                BUS_AREA_ID                                       04199505
041996               ,BRND_ID                                           04199605
041997     END-EXEC.                                                    04199705
042000                                                                  04200000
042100*                                                                 04210000
042200                                                                  04220000
042300*    COPY DPWS004.                                                04230000
042400                                                                  04240000
042500/                                                                 04250000
042600 PROCEDURE DIVISION.                                              04260000
042700                                                                  04270000
042800******************************************************************04280000
042900*                                                                 04290000
043000******************************************************************04300000
043100 0000-MAINLINE.                                                   04310000
043200***  DISPLAY '0000-MAINLINE              '.                       04320027
043300                                                                  04330000
043400     PERFORM 1000-INITIALIZE.                                     04340000
043500                                                                  04350000
043600     PERFORM 2000-MAIN-PROCESS                                    04360000
043700         UNTIL PS-EOF-INPUT-YES                                   04370000
043800                                                                  04380000
043900     PERFORM 9005-END-PROCESS.                                    04390000
044000                                                                  04400000
044010     MOVE PV-READ-COUNT TO PV-DISP-READ-COUNT.                    04401035
044011     DISPLAY ' '.                                                 04401136
044020     DISPLAY 'INPUT RECORD COUNT:  ' PV-DISP-READ-COUNT.          04402035
044030                                                                  04403035
044100     GOBACK.                                                      04410000
044200                                                                  04420000
044300******************************************************************04430000
044400*                                                                 04440000
044500******************************************************************04450000
044600 1000-INITIALIZE.                                                 04460000
044700******************************************************************04470000
044800***  DISPLAY '1000-INITIALIZE            '.                       04480027
044900     OPEN INPUT  TRIP-FILE                                        04490000
045000          OUTPUT REPORT-FILE.                                     04500000
045100                                                                  04510000
045200     ACCEPT PV-TODAYS-DATE FROM DATE YYYYMMDD.                    04520000
045300     ACCEPT PV-TODAYS-TIME FROM TIME.                             04530000
045400                                                                  04540000
045500     MOVE PV-TODAYS-DATE-MM        TO DP132-RUN-MONTH.            04550000
045600     MOVE PV-TODAYS-DATE-DD        TO DP132-RUN-DAY.              04560000
045700     MOVE PV-TODAYS-DATE-CCYY      TO DP132-RUN-YEAR.             04570000
045800     MOVE PV-TODAYS-TIME-HH        TO DP132-RUN-HOUR.             04580000
045900     MOVE PV-TODAYS-TIME-MM        TO DP132-RUN-MINUTE.           04590000
046000     MOVE PC-CURRENT-PROGRAM-NAME  TO DP132-PROGRAM-NAME.         04600000
046100                                                                  04610000
046200     PERFORM 8000-READ-INPUT-FIRST-TIME                           04620000
046300       UNTIL PS-PROCESS-STORE-YES                                 04630000
046400          OR PS-EOF-INPUT-YES.                                    04640000
046500                                                                  04650000
046600     MOVE SU069-OTBND-TRIP-ID  TO  PV-TRIP-ID.                    04660000
046700     MOVE SU069-TRIP-OCRNC-ID  TO  PV-TRIP-OCRNC.                 04670000
046800     MOVE SU069-LOC-NBR        TO  PV-STORE-DEST.                 04680000
046900                                                                  04690000
047000     IF  PS-PROCESS-STORE-YES                                     04700000
047100         PERFORM 8040-GET-DC-STORE-NAME                           04710000
047200         PERFORM 8050-GET-TRAILER-INFO                            04720000
047300         PERFORM 8060-GET-STATUS-DESC                             04730000
047400     END-IF.                                                      04740000
047500                                                                  04750000
047600     PERFORM 8100-PRINT-REPORT-HEADINGS                           04760000
047700                                                                  04770000
047800     IF  PS-EOF-INPUT-YES                                         04780000
047900         SET PS-DATA-NO               TO TRUE                     04790000
048000         WRITE REPORT-RECORD                                      04800000
048100          FROM NO-NEW-ITEMS-TO-REPORT-LINE                        04810000
048200         AFTER ADVANCING 3 LINE                                   04820000
048210         ADD 3 TO PV-LINE-COUNT                                   04821000
048300     ELSE                                                         04830000
048400         SET  PS-DATA-YES             TO TRUE                     04840000
048500         MOVE PV-STORE-NUMBER         TO PV-PREV-STORE            04850000
048600         MOVE PV-DC-NUMBER            TO PV-PREV-DC               04860000
048700         MOVE SU069-OTBND-TRIP-ID     TO PV-PREV-TRIP             04870000
048800         MOVE SU069-TRIP-OCRNC-ID     TO PV-PREV-ORCNC            04880000
048900     END-IF.                                                      04890000
049000                                                                  04900000
049100*                                                                 04910000
049200******************************************************************04920000
049300 2000-MAIN-PROCESS.                                               04930000
049400***  DISPLAY '2000-MAIN-PROCESS          '.                       04940027
049401                                                                  04940119
049410     MOVE  SU069-OTBND-TRIP-ID  TO  PV-DISP-TRIP.                 04941019
049420     MOVE  PV-PREV-TRIP         TO  PV-DISP-PREV-TRIP.            04942019
049430     DISPLAY 'TRIP:'  PV-DISP-TRIP.                               04943019
049440     DISPLAY 'PREV:'  PV-DISP-PREV-TRIP.                          04944019
049441     DISPLAY 'PS-PROCESS-STORE-SW:'  PS-PROCESS-STORE-SW.         04944119
049450                                                                  04945019
049500                                                                  04950000
049600     IF  PS-PROCESS-STORE-YES                                     04960000
049700         EVALUATE TRUE                                            04970000
049800             WHEN SU069-OTBND-TRIP-ID  =  PV-PREV-TRIP            04980000
049900                  SET  PS-FIRST-ITEM-YES TO TRUE                  04990000
050000                  SET  PS-TRIP-SML-EOF-NO    TO  TRUE             05000000
050010                  MOVE ZERO TO PV-NO-ITEMS-READ                   05001039
050100                  MOVE  SU069-TRIP-OCRNC-ID                       05010000
050200                                TO  SUT00095-TRIP-OCRNC-ID        05020000
050210                  PERFORM 4101-OPEN-TRIP-SML-B-CSR                05021006
050220                  PERFORM 4111-FETCH-TRIP-SML-B-CSR               05022006
050221                  DISPLAY 'ITEMS READ = ' PV-NO-ITEMS-READ        05022126
050230                  IF PV-NO-ITEMS-READ > 0                         05023031
050240                     CONTINUE                                     05024031
050250                  ELSE                                            05025031
050252                     PERFORM 4121-CLOSE-TRIP-SML-B-CSR            05025231
050410                  END-IF                                          05041031
050500                  IF PS-FIRST-FETCH-FND                           05050000
050600                     SET PS-PRINT-BUS-AREA-YES TO TRUE            05060000
050670                     MOVE PC-MERCH-BRAND TO HL8-MDSE-DESC         05067031
050700                     WRITE REPORT-RECORD                          05070000
050800                       FROM HEADING-LINE8                         05080000
050900                         AFTER ADVANCING 2 LINES                  05090000
050910                     ADD 2 TO PV-LINE-COUNT                       05091000
050920                     IF PV-LINE-COUNT > PC-END-OF-PAGE            05092000
050930                         PERFORM 8100-PRINT-REPORT-HEADINGS       05093000
050940                     END-IF                                       05094000
051000                                                                  05100000
051220                     PERFORM 4001-PROCESS-TRIP                    05122032
051230                         UNTIL PS-TRIP-SML-EOF-YES                05123031
051232                     PERFORM 4121-CLOSE-TRIP-SML-B-CSR            05123234
051240                     PERFORM 4201-PROCESS-AREA-TOTALS             05124031
051300                                                                  05130000
051500                     PERFORM 9001-PROCESS-TRIP-TOTALS             05150000
051600                  ELSE                                            05160000
051700                     PERFORM 8999-END-NO-NEW-DATA                 05170000
051800                  END-IF                                          05180000
052000             WHEN OTHER                                           05200000
052100                  MOVE  SU069-OTBND-TRIP-ID TO PV-TRIP-ID         05210000
052200                  MOVE  SU069-TRIP-OCRNC-ID TO PV-TRIP-OCRNC      05220000
052300                  IF  SU069-LOC-NBR  =  PV-STORE-DEST             05230000
052400                      CONTINUE                                    05240000
052500                  ELSE                                            05250000
052600                      MOVE  ZERO TO  PV-PAGE-COUNT                05260000
052700                      PERFORM 8040-GET-DC-STORE-NAME              05270000
052800                      MOVE SU069-LOC-NBR  TO  PV-STORE-DEST       05280000
052900                  END-IF                                          05290000
053000                  PERFORM 8050-GET-TRAILER-INFO                   05300006
053100                  PERFORM 8060-GET-STATUS-DESC                    05310000
053200                  PERFORM 8100-PRINT-REPORT-HEADINGS              05320000
053300                  SET  PS-FIRST-ITEM-YES TO TRUE                  05330000
053400                  SET  PS-TRIP-SML-EOF-NO    TO  TRUE             05340000
053410                  MOVE ZERO TO PV-NO-ITEMS-READ                   05341039
053500                  MOVE  SU069-TRIP-OCRNC-ID                       05350000
053600                               TO  SUT00095-TRIP-OCRNC-ID         05360000
053620                  PERFORM 4101-OPEN-TRIP-SML-B-CSR                05362006
053630                  PERFORM 4111-FETCH-TRIP-SML-B-CSR               05363006
053640                  IF PV-NO-ITEMS-READ > 0                         05364006
053650                     CONTINUE                                     05365006
053660                  ELSE                                            05366006
053662                     PERFORM 4121-CLOSE-TRIP-SML-B-CSR            05366227
053810                  END-IF                                          05381006
053900                  IF PS-FIRST-FETCH-FND                           05390000
054000                     SET PS-PRINT-BUS-AREA-YES TO TRUE            05400000
054061                     MOVE PC-MERCH-BRAND TO HL8-MDSE-DESC         05406131
054100                     WRITE REPORT-RECORD                          05410000
054200                       FROM HEADING-LINE8                         05420000
054300                         AFTER ADVANCING 2 LINES                  05430000
054310                     ADD 2 TO PV-LINE-COUNT                       05431000
054320                     IF PV-LINE-COUNT > PC-END-OF-PAGE            05432000
054330                         PERFORM 8100-PRINT-REPORT-HEADINGS       05433000
054340                     END-IF                                       05434000
054400                                                                  05440000
054740                     PERFORM 4001-PROCESS-TRIP                    05474031
054750                         UNTIL PS-TRIP-SML-EOF-YES                05475031
054752                     PERFORM 4121-CLOSE-TRIP-SML-B-CSR            05475234
054760                     PERFORM 4201-PROCESS-AREA-TOTALS             05476031
054900                     PERFORM 9001-PROCESS-TRIP-TOTALS             05490000
055000                  ELSE                                            05500000
055100                     PERFORM 8999-END-NO-NEW-DATA                 05510000
055200                  END-IF                                          05520000
055400         END-EVALUATE                                             05540000
055500     END-IF.                                                      05550000
055600                                                                  05560000
055700     SET  PS-PROCESS-STORE-NO  TO  TRUE.                          05570000
055800                                                                  05580000
055900     PERFORM 8010-READ-TRIP-FILE.                                 05590000
056000     IF PS-EOF-INPUT-YES                                          05600000
056100        CONTINUE                                                  05610000
056200     ELSE                                                         05620000
056300        PERFORM 8005-PREP                                         05630000
056400     END-IF.                                                      05640000
056500                                                                  05650000
056600                                                                  05660000
065510******************************************************************06551006
065520* BY BRAND                                                        06552006
065530******************************************************************06553006
065540 4001-PROCESS-TRIP.                                               06554006
065550***  DISPLAY '4001-PROCESS-TRIP          '.                       06555027
065560                                                                  06556006
065570     INITIALIZE PV-PREV-SML.                                      06557006
065580                                                                  06558006
065590*    THE CURSOR BELOW WILL SELECT ALL OF THE CARTONS ATTACHED TO  06559006
065591*    THE TRAILER  THAT HAVE ITEMS THAT ARE NEW TO THE STORE       06559106
065592                                                                  06559206
065593     IF PS-TRIP-SML-EOF-YES                                       06559306
065594        CONTINUE                                                  06559406
065595     ELSE                                                         06559506
065596        IF SUT00095-BUS-AREA-ID NOT = PV-SAVE-BUS-AREA-ID         06559606
065597           IF PS-FIRST-ITEM-YES                                   06559706
065598              SET PS-FIRST-ITEM-NO TO TRUE                        06559806
065599              MOVE SUT00095-BUS-AREA-ID   TO PV-SAVE-BUS-AREA-ID  06559906
065600              MOVE SUT00095-BRND-ID       TO PV-SAVE-BRND-ID      06560006
065601              MOVE SUT00095-SKU-NBR       TO PV-SAVE-SKU-NBR      06560106
065602              PERFORM 4500-SUM-SKU-UNITS                          06560206
065603              MOVE  +1                    TO PV-SKU-COUNT         06560306
065604              MOVE SUT00095-UNT-QTY       TO PV-SKU-UNIT-QTY      06560406
065605           ELSE                                                   06560506
065607              PERFORM 4201-PROCESS-AREA-TOTALS                    06560706
065608              SET PS-PRINT-BUS-AREA-YES TO TRUE                   06560806
065609           END-IF                                                 06560906
065610        ELSE                                                      06561006
065611           IF SUT00095-BRND-ID NOT = PV-SAVE-BRND-ID              06561106
065612              PERFORM 4201-PROCESS-AREA-TOTALS                    06561206
065613           ELSE                                                   06561306
065614              IF SUT00095-SKU-NBR NOT = PV-SAVE-SKU-NBR           06561406
065615                 MOVE SUT00095-SKU-NBR TO PV-SAVE-SKU-NBR         06561506
065616                 ADD +1                    TO PV-SKU-COUNT        06561606
065617                 PERFORM 4500-SUM-SKU-UNITS                       06561706
065618                 ADD SUT00095-UNT-QTY      TO PV-SKU-UNIT-QTY     06561806
065619              END-IF                                              06561906
065620           END-IF                                                 06562006
065621        END-IF                                                    06562106
065622     END-IF.                                                      06562206
065623                                                                  06562306
065624     PERFORM 4111-FETCH-TRIP-SML-B-CSR.                           06562407
065625                                                                  06562506
067910******************************************************************06791006
067920* BY BRAND                                                        06792006
067930******************************************************************06793006
067940 4101-OPEN-TRIP-SML-B-CSR.                                        06794006
067950***  DISPLAY '4101-OPEN-TRIP-SML-B-CSR     '.                     06795027
067960                                                                  06796006
067970     MOVE '4101-OPEN-TRIP-SML-B-CSR    '                          06797006
067980                                 TO PV-PARAGRAPH-NAME.            06798006
067990     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       06799006
067991     MOVE '                              '  TO  PV-TABLE-2.       06799106
067992     MOVE '                              '  TO  PV-TABLE-3.       06799206
067993                                                                  06799306
067994     EXEC SQL                                                     06799406
067995         OPEN TRIP_SML_BRND_CSR                                   06799506
067996     END-EXEC.                                                    06799606
067997                                                                  06799706
067998     EVALUATE TRUE                                                06799806
067999         WHEN SQLCODE = ZEROS                                     06799906
068000              CONTINUE                                            06800006
068001         WHEN OTHER                                               06800106
068002              PERFORM Z999-SQL-ERROR                              06800206
068003     END-EVALUATE.                                                06800306
068005                                                                  06800506
068006                                                                  06800606
071110******************************************************************07111006
071120*    BY BRAND                                                     07112006
071130******************************************************************07113006
071140 4111-FETCH-TRIP-SML-B-CSR.                                       07114006
071150                                                                  07115006
071160***  DISPLAY '                           '.                       07116006
071170***  DISPLAY '4111-FETCH-TRIP-SML-B-CSR    '.                     07117027
071180                                                                  07118006
071190     MOVE '4111-FETCH-TRIP-SML-B-CSR    '                         07119006
071191                                 TO PV-PARAGRAPH-NAME.            07119106
071192     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       07119206
071193     MOVE '                              '  TO  PV-TABLE-2.       07119306
071194     MOVE '                              '  TO  PV-TABLE-3.       07119406
071195                                                                  07119506
071196     INITIALIZE  SUT00095-UNT-QTY.                                07119606
071197                                                                  07119706
071198     EXEC SQL                                                     07119806
071199          FETCH TRIP_SML_BRND_CSR                                 07119911
071200          INTO :SUT00095-BUS-AREA-ID                              07120006
071201              ,:SUT00095-BRND-ID                                  07120106
071202              ,:SUT00095-SKU-NBR                                  07120206
071203     END-EXEC.                                                    07120306
071204                                                                  07120406
071205     EVALUATE TRUE                                                07120506
071206         WHEN SQLCODE = ZEROS                                     07120606
071207              SET PS-FIRST-FETCH-FND TO TRUE                      07120706
071208              ADD +1 TO PV-NO-ITEMS-READ                          07120806
071209         WHEN SQLCODE = +100                                      07120906
071210              SET  PS-TRIP-SML-EOF-YES TO  TRUE                   07121006
071211         WHEN OTHER                                               07121106
071212              PERFORM Z999-SQL-ERROR                              07121206
071213     END-EVALUATE.                                                07121306
071215                                                                  07121506
073410******************************************************************07341006
073420* BY BRAND                                                        07342006
073430******************************************************************07343006
073440 4121-CLOSE-TRIP-SML-B-CSR.                                       07344006
073450***  DISPLAY '4121-CLOSE-TRIP-SML-B-CSR    '.                     07345027
073460                                                                  07346006
073470     MOVE '4121-CLOSE-TRIP-SML-B-CSR    '                         07347006
073480                                 TO PV-PARAGRAPH-NAME.            07348006
073490     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       07349006
073491     MOVE '                              '  TO  PV-TABLE-2.       07349106
073492     MOVE '                              '  TO  PV-TABLE-3.       07349206
073493                                                                  07349306
073494     EXEC SQL                                                     07349406
073495         CLOSE TRIP_SML_BRND_CSR                                  07349506
073496     END-EXEC.                                                    07349606
073497                                                                  07349706
073498     EVALUATE TRUE                                                07349806
073499         WHEN SQLCODE = ZEROS                                     07349906
073500              CONTINUE                                            07350006
073501         WHEN OTHER                                               07350106
073502              PERFORM Z999-SQL-ERROR                              07350206
073503     END-EVALUATE.                                                07350306
077503 4201-PROCESS-AREA-TOTALS.                                        07750306
077504***   DISPLAY '4201- ' PV-SAVE-BUS-AREA-ID.                       07750427
077505                                                                  07750506
077506      IF PS-PRINT-BUS-AREA-YES                                    07750606
077507         SET PS-PRINT-BUS-AREA-NO   TO TRUE                       07750706
077508         PERFORM 5000-GET-BUS-AREA-DESC                           07750806
077509         MOVE PV-SAVE-BUS-AREA-ID     TO DL1-BUSINESS-AREA        07750906
077510                                         PV-SAVE-DTL-BUS-AREA     07751006
077511         MOVE XLT00000-BUS-AREA-DESC  TO DL1-BUS-AREA-DESC        07751106
077512                                         PV-SAVE-DTL-BUS-DESC     07751206
077513         MOVE '  -  '  TO   DL1-DASH1                             07751306
077514                            PV-SAVE-DTL-BUS-DASH                  07751406
077515      ELSE                                                        07751506
077516         MOVE SPACES TO  DL1-BUSINESS-AREA                        07751606
077517                         DL1-DASH1                                07751706
077518                         DL1-BUS-AREA-DESC                        07751806
077519      END-IF                                                      07751906
077520                                                                  07752006
077521      PERFORM 5101-GET-BRAND-DESC                                 07752106
077522      PERFORM 5200B-MDSE-AREA-CRTN-COUNT                          07752206
077523      ADD  PV-SKU-COUNT            TO PV-TOTAL-SKU-COUNT          07752306
077524      ADD  PV-SKU-UNIT-QTY         TO PV-TOTAL-UNIT-COUNT         07752406
077525                                                                  07752506
077526                                                                  07752606
077527      MOVE XLT00043-BRND-DESC      TO DL1-MERCHANDISE-LBL         07752706
077529      MOVE PV-MSDSE-AREA-CRTN-COUNT                               07752906
077530                                   TO DL1-CARTON-COUNT            07753006
077531                                                                  07753106
077532      MOVE PV-SKU-COUNT            TO DL1-SKU-COUNT               07753206
077533      MOVE PV-SKU-UNIT-QTY         TO DL1-UNIT-COUNT              07753306
077534                                                                  07753406
077535      MOVE ZEROES                TO PV-NEW-IND-COUNT              07753506
077536                                    PV-HANG-IND-COUNT             07753606
077537                                    PV-FOLD-IND-COUNT             07753707
077538      PERFORM 4211-FIND-NEW-IND                                   07753807
077539      PERFORM 4221-FIND-HANG-IND                                  07753907
077540      PERFORM 4231-FIND-FOLD-IND                                  07754007
077541         EVALUATE TRUE                                            07754106
077542            WHEN (PV-HANG-IND-COUNT > 0  AND                      07754206
077543                  PV-FOLD-IND-COUNT > 0)                          07754306
077544                 MOVE PC-B  TO DL1-HANG-FOLD-IND                  07754406
077545            WHEN (PV-HANG-IND-COUNT = 0  AND                      07754506
077546                  PV-FOLD-IND-COUNT = 0)                          07754606
077547                 MOVE SPACE TO DL1-HANG-FOLD-IND                  07754706
077548            WHEN (PV-HANG-IND-COUNT > 0  AND                      07754806
077549                  PV-FOLD-IND-COUNT = 0)                          07754906
077550                 MOVE PC-H  TO DL1-HANG-FOLD-IND                  07755006
077551            WHEN (PV-HANG-IND-COUNT = 0  AND                      07755106
077552                  PV-FOLD-IND-COUNT > 0)                          07755206
077553                 MOVE PC-F  TO DL1-HANG-FOLD-IND                  07755306
077554            WHEN OTHER                                            07755406
077555                 DISPLAY 'SOMETHING WRONG'                        07755506
077556         END-EVALUATE                                             07755606
077557      IF PV-LINE-COUNT > PC-END-OF-PAGE                           07755706
077558          PERFORM 8100-PRINT-REPORT-HEADINGS                      07755806
077559          MOVE PV-SAVE-DTL-BUS-AREA TO DL1-BUSINESS-AREA          07755906
077560          MOVE PV-SAVE-DTL-BUS-DESC TO DL1-BUS-AREA-DESC          07756006
077561          MOVE PV-SAVE-DTL-BUS-DASH TO DL1-DASH1                  07756106
077562      END-IF                                                      07756206
077563      PERFORM 8120-PRINT-DETAIL-LINES1.                           07756306
077564      IF PS-PRINT-BUS-AREA-NO                                     07756406
077565          MOVE SPACES TO DL1-BUSINESS-AREA                        07756506
077566                         DL1-DASH1                                07756606
077567                         DL1-BUS-AREA-DESC                        07756706
077568      END-IF                                                      07756806
077569                                                                  07756906
077570      MOVE SUT00095-BUS-AREA-ID  TO PV-SAVE-BUS-AREA-ID.          07757006
077571                                                                  07757113
077572      MOVE SUT00095-BRND-ID      TO PV-SAVE-BRND-ID.              07757212
077573      MOVE SUT00095-SKU-NBR      TO PV-SAVE-SKU-NBR.              07757306
077574                                                                  07757406
077575      MOVE +0                    TO PV-SKU-COUNT                  07757506
077576                                    PV-SKU-UNIT-QTY               07757606
077577                                    PV-MSDSE-AREA-CRTN-COUNT.     07757706
077578      ADD   +1                   TO PV-SKU-COUNT.                 07757806
077579      PERFORM 4500-SUM-SKU-UNITS.                                 07757906
077580      ADD  SUT00095-UNT-QTY       TO PV-SKU-UNIT-QTY.             07758006
077613 4211-FIND-NEW-IND.                                               07761306
077614***  DISPLAY '4211-FIND-NEW-IND            '.                     07761427
077615                                                                  07761506
077616     EXEC SQL                                                     07761606
077617         SELECT COUNT(PRC_MSG_CDE)                                07761706
077618         INTO  :PV-NEW-IND-COUNT                                  07761806
077619         FROM SUT_TRIP_DTL_SUM                                    07761906
077620        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    07762006
077621         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       07762106
077622         AND   BRND_ID               = :PV-SAVE-BRND-ID           07762206
077623         AND   PRC_MSG_CDE           = :PC-RF                     07762306
077624        WITH UR                                                   07762406
077625     END-EXEC.                                                    07762506
077626                                                                  07762606
077627     EVALUATE TRUE                                                07762706
077628         WHEN SQLCODE = ZERO                                      07762806
077629              IF PV-NEW-IND-COUNT > 0                             07762906
077630                 MOVE 'Y'    TO  DL1-NEW-IND                      07763006
077631              ELSE                                                07763106
077632                 MOVE SPACES TO  DL1-NEW-IND                      07763206
077633              END-IF                                              07763306
077634         WHEN SQLWARN0 NOT = SPACE                                07763406
077635         WHEN SQLCODE  NOT = +0                                   07763506
077636              MOVE '4211-FIND-NEW-IND'                            07763606
077637                                      TO PV-PARAGRAPH-NAME        07763706
077638              MOVE 'SUT_TRIP_DTL_SUM' TO PV-TABLE-1               07763806
077639              PERFORM Z999-SQL-ERROR                              07763906
077640     END-EVALUATE.                                                07764006
077669 4221-FIND-HANG-IND.                                              07766906
077670***  DISPLAY '4221-FIND-HANG-IND           '.                     07767027
077671                                                                  07767106
077672     EXEC SQL                                                     07767206
077673         SELECT COUNT(HNG_FOLD_SEQ_NBR)                           07767306
077674         INTO  :PV-HANG-IND-COUNT                                 07767406
077675         FROM SUT_TRIP_DTL_SUM                                    07767506
077676        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    07767606
077677         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       07767706
077678         AND   BRND_ID               = :PV-SAVE-BRND-ID           07767806
077679         AND   HNG_FOLD_SEQ_NBR      = 1                          07767906
077680        WITH UR                                                   07768006
077681     END-EXEC.                                                    07768106
077682                                                                  07768206
077683     EVALUATE TRUE                                                07768306
077684         WHEN SQLCODE = ZERO                                      07768406
077685              CONTINUE                                            07768506
077686         WHEN SQLWARN0 NOT = SPACE                                07768606
077687         WHEN SQLCODE  NOT = +0                                   07768706
077688              MOVE '4221-FIND-HANG-IND'                           07768806
077689                                      TO PV-PARAGRAPH-NAME        07768906
077690              MOVE 'SUT_TRIP_DTL_SUM' TO PV-TABLE-1               07769006
077691              PERFORM Z999-SQL-ERROR                              07769106
077692     END-EVALUATE.                                                07769206
077721 4231-FIND-FOLD-IND.                                              07772106
077722***  DISPLAY '4231-FIND-FOLD-IND           '.                     07772227
077723                                                                  07772306
077724     EXEC SQL                                                     07772406
077725         SELECT COUNT(HNG_FOLD_SEQ_NBR)                           07772506
077726         INTO  :PV-FOLD-IND-COUNT                                 07772606
077727         FROM SUT_TRIP_DTL_SUM                                    07772706
077728        WHERE  TRIP_OCRNC_ID         = :SUT00095-TRIP-OCRNC-ID    07772806
077729         AND   BUS_AREA_ID           = :PV-SAVE-BUS-AREA-ID       07772906
077730         AND   BRND_ID               = :PV-SAVE-BRND-ID           07773006
077731         AND   HNG_FOLD_SEQ_NBR      = 2                          07773106
077732        WITH UR                                                   07773206
077733     END-EXEC.                                                    07773306
077734                                                                  07773406
077735     EVALUATE TRUE                                                07773506
077736         WHEN SQLCODE = ZERO                                      07773606
077737              CONTINUE                                            07773706
077738         WHEN SQLWARN0 NOT = SPACE                                07773806
077739         WHEN SQLCODE  NOT = +0                                   07773906
077740              MOVE '4231-FIND-FOLD-IND'                           07774006
077741                                      TO PV-PARAGRAPH-NAME        07774106
077742              MOVE 'SUT_TRIP_DTL_SUM' TO PV-TABLE-1               07774206
077743              PERFORM Z999-SQL-ERROR                              07774306
077744     END-EVALUATE.                                                07774406
077746                                                                  07774600
077750 8300-PROCESS-PROGRAM-TOTALS.                                     07775000
077760***  DISPLAY '8300-PROCESS-PROGRAM-TOTALS  '.                     07776027
077770                                                                  07777020
077800      PERFORM 5201-TRAILER-CRTN-COUNT.                            07780000
077900      MOVE PV-TRAILER-CRTN-COUNT  TO TL-GRAND-CRTNS.              07790000
078000      MOVE PV-TOTAL-SKU-COUNT     TO TL-GRAND-SKUS.               07800000
078100      MOVE PV-TOTAL-UNIT-COUNT    TO TL-GRAND-UNITS.              07810000
078200                                                                  07820000
078300      WRITE REPORT-RECORD                                         07830000
078400       FROM TOTAL-LINE                                            07840000
078500      AFTER ADVANCING 3 LINES                                     07850000
078510      ADD 3 TO PV-LINE-COUNT.                                     07851000
078600                                                                  07860000
078700      MOVE ZEROES                 TO PV-TOTAL-SKU-COUNT           07870000
078800                                     PV-TOTAL-UNIT-COUNT.         07880000
078900******************************************************************07890000
079000 4500-SUM-SKU-UNITS.                                              07900000
079100******************************************************************07910000
079200***  DISPLAY '4500-SUM-SKU-UNITS  '.                              07920027
079300                                                                  07930000
079400     MOVE '4500-SUM-SKU-UNITS  '                                  07940000
079500                                 TO PV-PARAGRAPH-NAME.            07950000
079600     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       07960000
079700     MOVE '                              '  TO  PV-TABLE-2.       07970000
079800     MOVE '                              '  TO  PV-TABLE-3.       07980000
079900                                                                  07990000
080000                                                                  08000000
080100     EXEC SQL                                                     08010000
080200        SELECT SUM(UNT_QTY)                                       08020000
080300        INTO   :SUT00095-UNT-QTY                                  08030000
080400        FROM   SUT_TRIP_DTL_SUM                                   08040000
080500        WHERE  TRIP_OCRNC_ID  =  :SUT00095-TRIP-OCRNC-ID          08050000
080600          AND  SKU_NBR        =  :PV-SAVE-SKU-NBR                 08060000
080700     END-EXEC.                                                    08070000
080800                                                                  08080000
080900     EVALUATE TRUE                                                08090000
081000         WHEN SQLCODE = ZEROS                                     08100000
081100              CONTINUE                                            08110000
081200         WHEN OTHER                                               08120000
081300              PERFORM Z999-SQL-ERROR                              08130000
081400     END-EVALUATE.                                                08140000
081500                                                                  08150000
081600                                                                  08160000
081700******************************************************************08170000
081800******************************************************************08180000
081900*                                                                 08190000
082000******************************************************************08200000
082100 5000-GET-BUS-AREA-DESC.                                          08210000
082200***  DISPLAY '5000-GET-BUS-AREA-DESC '.                           08220027
082300                                                                  08230000
082400     MOVE '5000-GET-BUS-AREA-DESC '                               08240000
082500                                 TO PV-PARAGRAPH-NAME.            08250000
082600     MOVE 'XLT_BUS_AREA                  '  TO  PV-TABLE-1.       08260000
082700     MOVE '                              '  TO  PV-TABLE-2.       08270000
082800     MOVE '                              '  TO  PV-TABLE-3.       08280000
083000     MOVE  PV-SAVE-BUS-AREA-ID  TO XLT00000-BUS-AREA-ID.          08300000
083010/    MOVE  SUT00095-BUS-AREA-ID TO XLT00000-BUS-AREA-ID.          08301000
083100                                                                  08310000
083200     EXEC SQL                                                     08320000
083300         SELECT BUS_AREA_DESC                                     08330000
083400           INTO :XLT00000-BUS-AREA-DESC                           08340000
083500           FROM XLT_BUS_AREA                                      08350000
083600          WHERE BUS_AREA_ID = :XLT00000-BUS-AREA-ID               08360000
083700     END-EXEC.                                                    08370000
083800                                                                  08380000
083900     EVALUATE TRUE                                                08390000
084000         WHEN SQLCODE = ZEROS                                     08400000
084100              CONTINUE                                            08410000
084200         WHEN SQLCODE = +100                                      08420000
084300              MOVE 'UNKNOWN ' TO XLT00000-BUS-AREA-DESC           08430000
084400         WHEN OTHER                                               08440000
084500              PERFORM Z999-SQL-ERROR                              08450000
084600     END-EVALUATE.                                                08460000
084700                                                                  08470000
087510******************************************************************08751006
087520*                                                                 08752006
087530******************************************************************08753006
087540 5101-GET-BRAND-DESC.                                             08754006
087550***  DISPLAY '5101-GET-BRAND-DESC'.                               08755027
087560                                                                  08756006
087570     MOVE '5101-GET-BRAND-DESC'                                   08757016
087580                                 TO PV-PARAGRAPH-NAME.            08758006
087590     MOVE 'XLT_BRND                      '  TO  PV-TABLE-1.       08759006
087591     MOVE '                              '  TO  PV-TABLE-2.       08759106
087592     MOVE '                              '  TO  PV-TABLE-3.       08759206
087593                                                                  08759306
087594     EXEC SQL                                                     08759406
087595         SELECT BRND_DESC                                         08759506
087596           INTO :XLT00043-BRND-DESC                               08759606
087597           FROM XLT_BRND                                          08759706
087598          WHERE BRND_ID = :PV-SAVE-BRND-ID                        08759806
087599     END-EXEC.                                                    08759906
087600                                                                  08760006
087601     EVALUATE TRUE                                                08760106
087602         WHEN SQLCODE = ZEROS                                     08760206
087603              CONTINUE                                            08760306
087604         WHEN SQLCODE = +100                                      08760406
087605              MOVE 'UNKNOWN ' TO XLT00043-BRND-DESC               08760506
087606         WHEN OTHER                                               08760606
087607              PERFORM Z999-SQL-ERROR                              08760706
087608     END-EVALUATE.                                                08760806
087609                                                                  08760906
087610                                                                  08761000
087700******************************************************************08770000
087800*                                                                 08780000
087900******************************************************************08790000
088000 5200-MDSE-AREA-CRTN-COUNT.                                       08800000
088100***  DISPLAY '5200-MDSE-AREA-CRTN-COUNT '                         08810027
088200                                                                  08820000
088300     MOVE '5200-MDSE-AREA-CRTN-COUNT '                            08830000
088400                                 TO PV-PARAGRAPH-NAME.            08840000
088500     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       08850000
088600     MOVE '                              '  TO  PV-TABLE-2.       08860000
088700     MOVE '                              '  TO  PV-TABLE-3.       08870000
088800                                                                  08880000
088900     EXEC SQL                                                     08890000
089000         SELECT COUNT(DISTINCT B.SHIPT_UNT_ID)                    08900000
089100          INTO :PV-MSDSE-AREA-CRTN-COUNT                          08910000
089200         FROM SUT_TRIP_DTL_SUM   A                                08920000
089300            , SUT_TRIP_DTL_SUM   B                                08930000
089400         WHERE A.TRIP_OCRNC_ID   =  :SUT00095-TRIP-OCRNC-ID       08940000
089500           AND A.PRC_MSG_CDE     = 'RF'                           08950000
089600           AND A.BUS_AREA_ID     = :PV-SAVE-BUS-AREA-ID           08960000
089700           AND A.MDSE_PGM_ID     = :PV-SAVE-MDSE-PGM-ID           08970000
089800           AND B.TRIP_OCRNC_ID = A.TRIP_OCRNC_ID                  08980000
089900           AND B.SKU_NBR = A.SKU_NBR                              08990000
090000     END-EXEC.                                                    09000000
090100                                                                  09010000
090200     EVALUATE TRUE                                                09020000
090300         WHEN SQLCODE = ZEROS                                     09030000
090400              CONTINUE                                            09040000
090500         WHEN SQLCODE = +100                                      09050000
090600              MOVE ZEROES TO PV-MSDSE-AREA-CRTN-COUNT             09060000
090700         WHEN OTHER                                               09070000
090800              PERFORM Z999-SQL-ERROR                              09080000
090900     END-EVALUATE.                                                09090000
091000                                                                  09100000
091010******************************************************************09101006
091020* BY BRAND                                                        09102006
091030******************************************************************09103006
091040 5200B-MDSE-AREA-CRTN-COUNT.                                      09104006
091050***  DISPLAY '5200B-MDSE-AREA-CRTN-COUNT '                        09105027
091060                                                                  09106006
091070     MOVE '5200B-MDSE-AREA-CRTN-COUNT '                           09107006
091080                                 TO PV-PARAGRAPH-NAME.            09108006
091090     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       09109006
091091     MOVE '                              '  TO  PV-TABLE-2.       09109106
091092     MOVE '                              '  TO  PV-TABLE-3.       09109206
091093                                                                  09109306
091094     EXEC SQL                                                     09109406
091095         SELECT COUNT(DISTINCT B.SHIPT_UNT_ID)                    09109506
091096          INTO :PV-MSDSE-AREA-CRTN-COUNT                          09109606
091097         FROM SUT_TRIP_DTL_SUM   A                                09109706
091098            , SUT_TRIP_DTL_SUM   B                                09109806
091099         WHERE A.TRIP_OCRNC_ID   =  :SUT00095-TRIP-OCRNC-ID       09109906
091100           AND A.PRC_MSG_CDE     = 'RF'                           09110006
091101           AND A.BUS_AREA_ID     = :PV-SAVE-BUS-AREA-ID           09110106
091102           AND A.BRND_ID         = :PV-SAVE-BRND-ID               09110206
091103           AND B.TRIP_OCRNC_ID = A.TRIP_OCRNC_ID                  09110306
091104           AND B.SKU_NBR = A.SKU_NBR                              09110406
091105     END-EXEC.                                                    09110506
091106                                                                  09110606
091107     EVALUATE TRUE                                                09110706
091108         WHEN SQLCODE = ZEROS                                     09110806
091109              CONTINUE                                            09110906
091110         WHEN SQLCODE = +100                                      09111006
091111              MOVE ZEROES TO PV-MSDSE-AREA-CRTN-COUNT             09111106
091112         WHEN OTHER                                               09111206
091113              PERFORM Z999-SQL-ERROR                              09111306
091114     END-EVALUATE.                                                09111406
091120                                                                  09112000
091200 5201-TRAILER-CRTN-COUNT.                                         09120000
091300***  DISPLAY '5201-TRAILER-CRTN-COUNT   '                         09130027
091400                                                                  09140000
091500     MOVE '5201-TRAILER-CRTN-COUNT   '                            09150000
091600                                 TO PV-PARAGRAPH-NAME.            09160000
091700     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       09170000
091800     MOVE '                              '  TO  PV-TABLE-2.       09180000
091900     MOVE '                              '  TO  PV-TABLE-3.       09190000
092000                                                                  09200000
092100     EXEC SQL                                                     09210000
092200         SELECT COUNT(DISTINCT B.SHIPT_UNT_ID)                    09220000
092300          INTO :PV-TRAILER-CRTN-COUNT                             09230000
092400         FROM SUT_TRIP_DTL_SUM   A                                09240000
092500            , SUT_TRIP_DTL_SUM   B                                09250000
092600         WHERE A.TRIP_OCRNC_ID   =  :SUT00095-TRIP-OCRNC-ID       09260000
092700           AND A.PRC_MSG_CDE     = 'RF'                           09270000
092800           AND B.TRIP_OCRNC_ID = A.TRIP_OCRNC_ID                  09280000
092900           AND B.SKU_NBR = A.SKU_NBR                              09290000
093000     END-EXEC.                                                    09300000
093100                                                                  09310000
093200     EVALUATE TRUE                                                09320000
093300         WHEN SQLCODE = ZEROS                                     09330000
093400              CONTINUE                                            09340000
093500         WHEN SQLCODE = +100                                      09350000
093600              MOVE ZEROES TO PV-TRAILER-CRTN-COUNT                09360000
093700         WHEN OTHER                                               09370000
093800              PERFORM Z999-SQL-ERROR                              09380000
093900     END-EVALUATE.                                                09390000
094000                                                                  09400000
094100                                                                  09410000
094200******************************************************************09420000
094300*                                                                 09430000
094400******************************************************************09440000
094500 6000-TOTAL-TRIP-CRTN-COUNT.                                      09450000
094600***  DISPLAY '6000-TOTAL-TRIP-CRTN-COUNT '                        09460027
094700                                                                  09470000
094800     MOVE '6000-TOTAL-TRIP-CRTN-COUNT '                           09480000
094900                                 TO PV-PARAGRAPH-NAME.            09490000
095000     MOVE 'SUT_TRIP_DTL_SUM              '  TO  PV-TABLE-1.       09500000
095100     MOVE '                              '  TO  PV-TABLE-2.       09510000
095200     MOVE '                              '  TO  PV-TABLE-3.       09520000
095300                                                                  09530000
095400     EXEC SQL                                                     09540000
095500         SELECT COUNT(DISTINCT B.SHIPT_UNT_ID)                    09550000
095600          INTO :PV-TRIP-CARTON-COUNT                              09560000
095700         FROM SUT_TRIP_DTL_SUM   A                                09570000
095800            , SUT_TRIP_DTL_SUM   B                                09580000
095900         WHERE A.TRIP_OCRNC_ID   =  :SUT00095-TRIP-OCRNC-ID       09590000
096000           AND A.PRC_MSG_CDE     = 'RF'                           09600000
096100           AND B.TRIP_OCRNC_ID = A.TRIP_OCRNC_ID                  09610000
096200           AND B.SKU_NBR = A.SKU_NBR                              09620000
096300     END-EXEC.                                                    09630000
096400                                                                  09640000
096500     EVALUATE TRUE                                                09650000
096600         WHEN SQLCODE = ZEROS                                     09660000
096700              CONTINUE                                            09670000
096800         WHEN OTHER                                               09680000
096900              PERFORM Z999-SQL-ERROR                              09690000
097000     END-EVALUATE.                                                09700000
097100                                                                  09710000
097200                                                                  09720000
097300******************************************************************09730000
097400*                                                                 09740000
097500******************************************************************09750000
097600 8000-READ-INPUT-FIRST-TIME.                                      09760000
097700***  DISPLAY '                           '.                       09770027
097800***  DISPLAY '8000-READ-INPUT-FIRST-TIME '.                       09780027
097900                                                                  09790000
098000     PERFORM 8010-READ-TRIP-FILE.                                 09800000
098100     IF  PV-PREV-STORE  =  SU069-LOC-NBR                          09810000
098200         CONTINUE                                                 09820000
098300     ELSE                                                         09830000
098500         PERFORM 8040-GET-DC-STORE-NAME                           09850000
098510         PERFORM 8025-CHECK-PARM-STORE-LEVEL                      09851000
098520         IF KRPRPM-FUNC-BEG-TMST = PC-DEFAULT-TMST                09852000
098530            PERFORM 8030-GET-DISTRICT-PARM                        09853000
098540         ELSE                                                     09854000
098550            SET  PS-DISTRICT-ON-HAND-YES  TO  TRUE                09855000
098560         END-IF                                                   09856000
098700         MOVE  SU069-LOC-NBR  TO  PV-PREV-STORE                   09870000
098900     END-IF.                                                      09890000
099000                                                                  09900000
099100      MOVE  SU069-OTBND-STAT-TMST  TO  PV-WORK-TMST.              09910000
099200      MOVE  PV-WORK-TMST-YY        TO  PV-WORK-DATE-YY.           09920000
099300      MOVE  PV-WORK-TMST-MM        TO  PV-WORK-DATE-MM.           09930000
099400      MOVE  PV-WORK-TMST-DD        TO  PV-WORK-DATE-DD.           09940000
099500                                                                  09950000
099600      MOVE  XLT00010-OPN-DTE       TO  PV-WORK-OPEN.              09960000
099700      MOVE  PV-WORK-OPEN-YY        TO  PV-WORK-OPEN-DATE-YY.      09970000
099800      MOVE  PV-WORK-OPEN-MM        TO  PV-WORK-OPEN-DATE-MM.      09980000
099900      MOVE  PV-WORK-OPEN-DD        TO  PV-WORK-OPEN-DATE-DD.      09990000
100000                                                                  10000000
100100*  SKIP E-COMMERCE TRIP                                           10010000
100200*  SKIP NON-STORE TRIPS                                           10020000
100300*  SKIP TRIPS WHERE STORE IS NOT OPEN YET (SHIPPED BEFORE OPEN)   10030000
100400*  SKIP TRIPS WHERE DISTRICT IS NOT TURNED ON FOR ON-HAND         10040000
100500                                                                  10050000
100600     IF  XLT00010-E-BUS-IND       =  'Y'  OR                      10060000
100700         XLT00010-LOC-TYP-CDE NOT = 'DS' OR                       10070000
100800         PV-WORK-OPEN-DATE        >  PV-WORK-DATE  OR             10080000
100900         PS-DISTRICT-ON-HAND-NO                                   10090000
101000             SET PS-PROCESS-STORE-NO  TO  TRUE                    10100000
101100     ELSE                                                         10110000
101200         SET PS-PROCESS-STORE-YES     TO  TRUE                    10120000
101300     END-IF.                                                      10130000
101400                                                                  10140000
101500                                                                  10150000
102400*                                                                 10240000
102500******************************************************************10250000
102600 8005-PREP.                                                       10260000
102700***  DISPLAY '                           '.                       10270000
102800***  DISPLAY '8005-PREP                  '.                       10280027
102900                                                                  10290000
103000     IF  PV-PREV-STORE  =  SU069-LOC-NBR                          10300000
103100         CONTINUE                                                 10310000
103200     ELSE                                                         10320000
103400         PERFORM 8040-GET-DC-STORE-NAME                           10340000
103410         PERFORM 8025-CHECK-PARM-STORE-LEVEL                      10341000
103420         IF KRPRPM-FUNC-BEG-TMST = PC-DEFAULT-TMST                10342000
103430            PERFORM 8030-GET-DISTRICT-PARM                        10343000
103440         ELSE                                                     10344000
103450            SET  PS-DISTRICT-ON-HAND-YES  TO  TRUE                10345000
103460         END-IF                                                   10346000
103600         MOVE  SU069-LOC-NBR  TO  PV-PREV-STORE                   10360000
103700     END-IF.                                                      10370000
103800                                                                  10380000
103900      MOVE  SU069-OTBND-STAT-TMST  TO  PV-WORK-TMST.              10390000
104000      MOVE  PV-WORK-TMST-YY        TO  PV-WORK-DATE-YY.           10400000
104100      MOVE  PV-WORK-TMST-MM        TO  PV-WORK-DATE-MM.           10410000
104200      MOVE  PV-WORK-TMST-DD        TO  PV-WORK-DATE-DD.           10420000
104300                                                                  10430000
104400      MOVE  XLT00010-OPN-DTE       TO  PV-WORK-OPEN.              10440000
104500      MOVE  PV-WORK-OPEN-YY        TO  PV-WORK-OPEN-DATE-YY.      10450000
104600      MOVE  PV-WORK-OPEN-MM        TO  PV-WORK-OPEN-DATE-MM.      10460000
104700      MOVE  PV-WORK-OPEN-DD        TO  PV-WORK-OPEN-DATE-DD.      10470000
104800                                                                  10480000
104900*  SKIP E-COMMERCE TRIP                                           10490000
105000*  SKIP NON-STORE TRIPS                                           10500000
105100*  SKIP TRIPS WHERE STORE IS NOT OPEN YET (SHIPPED BEFORE OPEN)   10510000
105200*  SKIP TRIPS WHERE DISTRICT IS NOT TURNED ON FOR ON-HAND         10520000
105300                                                                  10530000
105400     IF  XLT00010-E-BUS-IND       =  'Y'  OR                      10540000
105500         XLT00010-LOC-TYP-CDE NOT = 'DS' OR                       10550000
105600         PV-WORK-OPEN-DATE        >  PV-WORK-DATE OR              10560000
105700         PS-DISTRICT-ON-HAND-NO                                   10570000
105800             SET PS-PROCESS-STORE-NO  TO  TRUE                    10580000
105900     ELSE                                                         10590000
106000         SET PS-PROCESS-STORE-YES     TO  TRUE                    10600000
106100     END-IF.                                                      10610000
107000                                                                  10700000
107100                                                                  10710000
107200******************************************************************10720000
107300*                                                                 10730000
107400******************************************************************10740000
107500 8010-READ-TRIP-FILE.                                             10750000
107600***  DISPLAY '                           '.                       10760000
107700***  DISPLAY '8010-READ-TRIP-FILE        '.                       10770027
107800                                                                  10780000
107900     READ TRIP-FILE INTO SU069-EXTRACT-RECORD                     10790000
108000         AT END                                                   10800000
108100             SET PS-EOF-INPUT-YES     TO TRUE                     10810000
108200     END-READ.                                                    10820000
108300                                                                  10830000
108400     MOVE  SU069-OTBND-TRIP-ID  TO  PV-DISP-TRIP.                 10840000
108500     MOVE  SU069-TRIP-OCRNC-ID  TO  PV-DISP-ORCNCE.               10850000
108600                                                                  10860000
108700     IF  PS-EOF-INPUT-YES                                         10870000
108800         CONTINUE                                                 10880000
108900     ELSE                                                         10890000
109000         DISPLAY '      '                                         10900000
109100         DISPLAY 'TRIP: ' PV-DISP-TRIP                            10910000
109200                 '         OCRNC: ' PV-DISP-ORCNCE                10920000
109210         ADD +1 TO PV-READ-COUNT                                  10921035
109300     END-IF.                                                      10930000
109400                                                                  10940000
109500                                                                  10950000
109510******************************************************************10951000
109520* CHECK IF ALL STORES TURNED ON                                   10952000
109530* IF KRPRPM-FUNC-BEG-TMST NOT EQUAL TO DEFAULT OF                 10953000
109540*  '0001-01-01-01.01.01.000000' THEN ALL STORES TURNED ON         10954000
109550******************************************************************10955000
109560 8025-CHECK-PARM-STORE-LEVEL.                                     10956000
109570***  DISPLAY '8025-CHECK-PARM-STORE-LEVEL'.                       10957027
109580                                                                  10958000
109590     MOVE '8025-CHECK-PARM-STORE-LEVEL '                          10959000
109591                                 TO PV-PARAGRAPH-NAME.            10959100
109592     MOVE 'TKRPRPM                       '  TO  PV-TABLE-1.       10959200
109593     MOVE '                              '  TO  PV-TABLE-2.       10959300
109594     MOVE '                              '  TO  PV-TABLE-3.       10959400
109595                                                                  10959500
109596                                                                  10959600
109597     EXEC SQL                                                     10959700
109598        SELECT  FUNC_BEG_TMST                                     10959800
109599          INTO  :KRPRPM-FUNC-BEG-TMST                             10959900
109600          FROM  TKRPRPM                                           10960000
109601         WHERE SYS_PRC_FUNC_CDE   = 'BALONH'                      10960100
109602           AND FUNC_PRC_STAT_CDE  =  'AC'                         10960200
109603           AND LOC_ID             =  090                          10960300
109604     END-EXEC.                                                    10960400
109605                                                                  10960500
109606     EVALUATE TRUE                                                10960600
109607         WHEN SQLCODE = ZEROS                                     10960700
109608         WHEN SQLCODE = +100                                      10960800
109609              CONTINUE                                            10960900
109611         WHEN OTHER                                               10961100
109612              PERFORM Z999-SQL-ERROR                              10961200
109613     END-EVALUATE.                                                10961300
109614                                                                  10961400
109615                                                                  10961500
109620******************************************************************10962000
109700*                                                                 10970000
109800******************************************************************10980000
109900******************************************************************10990000
110000* CHECK IF DISTRICT IS TURNED ON FOR ZERO ON-HAND PROCESSING      11000000
110100******************************************************************11010000
110200 8030-GET-DISTRICT-PARM.                                          11020000
110300***  DISPLAY '8030-GET-DISTRICT-PARM     '.                       11030027
110400                                                                  11040000
110500     MOVE '8030-GET-DISTRICT-PARM    '                            11050000
110600                                 TO PV-PARAGRAPH-NAME.            11060000
110700     MOVE 'TKRPRPM                       '  TO  PV-TABLE-1.       11070000
110800     MOVE '                              '  TO  PV-TABLE-2.       11080000
110900     MOVE '                              '  TO  PV-TABLE-3.       11090000
111000                                                                  11100000
111100     MOVE XLT00010-DIST-NBR  TO KRPRPM-LOC-ID                     11110000
111200                                                                  11120000
111300     EXEC SQL                                                     11130000
111400          SELECT   FUNC_TXT                                       11140000
111500            INTO  :KRPRPM-FUNC-TXT                                11150000
111600            FROM  TKRPRPM B                                       11160000
111700           WHERE  B.LOC_ID            =  :KRPRPM-LOC-ID           11170000
111800             AND  B.INTFC_SYS_CDE     =  'STR'                    11180000
111900             AND  B.SYS_PRC_FUNC_CDE  =  'PRCONH'                 11190000
112000             AND  B.FUNC_BEG_TMST     <  :SU069-OTBND-STAT-TMST   11200000
112100             AND  B.FUNC_TXT          =  'Y'                      11210000
112200     END-EXEC.                                                    11220000
112300                                                                  11230000
112400     EVALUATE TRUE                                                11240000
112500         WHEN SQLCODE = ZEROS                                     11250000
112600              SET  PS-DISTRICT-ON-HAND-YES  TO  TRUE              11260000
112700         WHEN SQLCODE = +100                                      11270000
112800              SET  PS-DISTRICT-ON-HAND-NO   TO  TRUE              11280000
112900         WHEN OTHER                                               11290000
113000              PERFORM Z999-SQL-ERROR                              11300000
113100     END-EVALUATE.                                                11310000
113200                                                                  11320000
113300                                                                  11330000
113400******************************************************************11340000
113500*                                                                 11350000
113600******************************************************************11360000
113700 8040-GET-DC-STORE-NAME.                                          11370000
113800***  DISPLAY '8040-GET-DC-STORE-NAME     '.                       11380027
113900                                                                  11390000
114000     MOVE '8040-GET-DC-STORE-NAME   '                             11400000
114100                                 TO  PV-PARAGRAPH-NAME.           11410000
114200     MOVE 'TSUOBTR                       '  TO  PV-TABLE-1.       11420000
114300     MOVE 'XLT_LOC                       '  TO  PV-TABLE-2.       11430000
114400     MOVE 'XLT_LOC                       '  TO  PV-TABLE-3.       11440000
114500                                                                  11450000
114600     MOVE  SU069-OTBND-TRIP-ID   TO  SUOBTR-OTBND-TRIP-ID.        11460000
114700                                                                  11470000
114800     EXEC SQL                                                     11480000
114900          SELECT A.ORGN_OPER_UNT_ID                               11490000
115000                ,B.LOC_NM                                         11500000
115100                ,C.LOC_NM                                         11510000
115200                ,C.DIST_NBR                                       11520000
115300                ,C.OPN_DTE                                        11530000
115400                ,C.E_BUS_IND                                      11540000
115500                ,C.LOC_TYP_CDE                                    11550000
115600           INTO  :PV-DC-NUMBER                                    11560000
115700                ,:PV-DC-NAME                                      11570000
115800                ,:PV-STORE-NAME                                   11580000
115900                ,:XLT00010-DIST-NBR :DN-DIST-NBR                  11590001
116000                ,:XLT00010-OPN-DTE                                11600000
116100                ,:XLT00010-E-BUS-IND                              11610000
116200                ,:XLT00010-LOC-TYP-CDE                            11620000
116300           FROM   TSUOBTR A                                       11630000
116400                 ,XLT_LOC B                                       11640000
116500                 ,XLT_LOC C                                       11650000
116600          WHERE  A.OTBND_TRIP_ID     =  :SUOBTR-OTBND-TRIP-ID     11660000
116700            AND  A.ORGN_OPER_UNT_ID  =  B.LOC_NBR                 11670000
116800            AND  A.DEST_OPER_UNT_ID  =  C.LOC_NBR                 11680000
116900     END-EXEC.                                                    11690000
117000                                                                  11700000
117100     EVALUATE TRUE                                                11710000
117200         WHEN SQLCODE = ZEROS                                     11720000
117310           IF DN-DIST-NBR = 0                                     11731001
117320              CONTINUE                                            11732001
117330           ELSE                                                   11733001
117340              MOVE  ZERO         TO  XLT00010-DIST-NBR            11734001
117350           END-IF                                                 11735001
117400         WHEN OTHER                                               11740000
117500              PERFORM Z999-SQL-ERROR                              11750000
117600     END-EVALUATE.                                                11760000
117700                                                                  11770000
117800                                                                  11780000
117900******************************************************************11790000
118000*                                                                 11800000
118100******************************************************************11810000
118200 8050-GET-TRAILER-INFO.                                           11820000
118300***  DISPLAY '8050-GET-TRAILER-INFO      '.                       11830027
118400                                                                  11840000
118500     MOVE '8050-GET-TRAILER-INFO    '                             11850000
118600                                 TO  PV-PARAGRAPH-NAME.           11860000
118700                                                                  11870000
118800     MOVE  SU069-OTBND-TRIP-SRL-NBR TO  CNTRID-TRLR-SRL-NBR.      11880000
118900     MOVE 'TCNTRID                       '  TO  PV-TABLE-1.       11890000
119000     MOVE '                              '  TO  PV-TABLE-2.       11900000
119100     MOVE '                              '  TO  PV-TABLE-3.       11910000
119200                                                                  11920000
119300     EXEC SQL                                                     11930000
119400          SELECT SCAC_CDE                                         11940000
119500                ,TRLR_ID                                          11950000
119600           INTO  :PV-DC-SCAC                                      11960000
119700                ,:PV-DC-TRLR-ID                                   11970000
119800           FROM   TCNTRID                                         11980000
119900          WHERE  TRLR_SRL_NBR  =  :CNTRID-TRLR-SRL-NBR            11990000
120000     END-EXEC.                                                    12000000
120100                                                                  12010000
120200     EVALUATE TRUE                                                12020000
120300         WHEN SQLCODE = ZEROS                                     12030000
120400              CONTINUE                                            12040000
120500         WHEN OTHER                                               12050000
120600              PERFORM Z999-SQL-ERROR                              12060000
120700     END-EVALUATE.                                                12070000
120800                                                                  12080000
120900                                                                  12090000
121000******************************************************************12100000
121100*                                                                 12110000
121200******************************************************************12120000
121300 8060-GET-STATUS-DESC.                                            12130000
121400***  DISPLAY '8060-GET-STATUS-DESC       '.                       12140027
121500                                                                  12150000
121600     MOVE '8060-GET-STATUS-DESC     '                             12160000
121700                                 TO  PV-PARAGRAPH-NAME.           12170000
121800     MOVE 'TSUOBSC                       '  TO  PV-TABLE-1.       12180000
121900     MOVE '                              '  TO  PV-TABLE-2.       12190000
122000     MOVE '                              '  TO  PV-TABLE-3.       12200000
122100                                                                  12210000
122200     MOVE  SU069-TRIP-STAT-CDE   TO  SUOBSC-TRIP-STAT-CDE         12220000
122300                                                                  12230000
122400     EXEC SQL                                                     12240000
122500          SELECT TRIP_STAT_DESC                                   12250000
122600           INTO  :PV-TRIP-STATUS                                  12260000
122700           FROM   TSUOBSC                                         12270000
122800          WHERE  TRIP_STAT_CDE  =  :SUOBSC-TRIP-STAT-CDE          12280000
122900     END-EXEC.                                                    12290000
123000                                                                  12300000
123100     EVALUATE TRUE                                                12310000
123200         WHEN SQLCODE = ZEROS                                     12320000
123300              CONTINUE                                            12330000
123400         WHEN OTHER                                               12340000
123500              PERFORM Z999-SQL-ERROR                              12350000
123600     END-EVALUATE.                                                12360000
123700                                                                  12370000
123800                                                                  12380000
123900******************************************************************12390000
124000*                                                                 12400000
124100******************************************************************12410000
124200 8100-PRINT-REPORT-HEADINGS.                                      12420000
124300***  DISPLAY '8100-PRINT-REPORT-HEADINGS  '.                      12430027
124400                                                                  12440000
124500     ADD 1                        TO PV-PAGE-COUNT.               12450000
124600     MOVE PV-PAGE-COUNT           TO DP132-PAGE-NUMBER.           12460000
124700                                                                  12470000
124800     MOVE ZERO                    TO PV-LINE-COUNT.               12480000
124900     MOVE 1                       TO DP132-REPORT-NUMBER.         12490000
125000                                                                  12500000
125100                                                                  12510000
125200     MOVE  SU069-LOC-NBR             TO HL2-STORE-NBR.            12520000
125300     MOVE  PV-STORE-NAME             TO HL2-STORE-NAME.           12530000
125400     MOVE  PV-DC-NUMBER              TO HL3-DC-NBR.               12540000
125500     MOVE  PV-DC-NAME                TO HL3-DC-NAME.              12550000
125700     MOVE  PV-DC-SCAC                TO HL5-SCAC.                 12570000
125800     MOVE  PV-DC-TRLR-ID             TO HL6-TRLR-ID               12580000
125900     MOVE  SU069-OTBND-TRIP-SRL-NBR  TO HL7-TRLR-SRL.             12590000
126000                                                                  12600000
126100     WRITE REPORT-RECORD                                          12610000
126200       FROM DP132-STANDRD-HEADER-132-COLS                         12620000
126300         AFTER ADVANCING PAGE.                                    12630000
126400                                                                  12640000
126500     WRITE REPORT-RECORD                                          12650000
126600       FROM HEADING-LINE1                                         12660000
126700         AFTER ADVANCING 2 LINES.                                 12670000
126800                                                                  12680000
126900     WRITE REPORT-RECORD                                          12690000
127000       FROM HEADING-LINE2                                         12700000
127100         AFTER ADVANCING 2 LINES.                                 12710000
127200                                                                  12720000
127300     WRITE REPORT-RECORD                                          12730000
127400       FROM HEADING-LINE3                                         12740000
127500         AFTER ADVANCING 1 LINE.                                  12750000
127700                                                                  12770000
127800     WRITE REPORT-RECORD                                          12780000
127900       FROM HEADING-LINE5                                         12790000
128000         AFTER ADVANCING 1 LINE.                                  12800000
128100                                                                  12810000
128200     WRITE REPORT-RECORD                                          12820000
128300       FROM HEADING-LINE6                                         12830000
128400         AFTER ADVANCING 1 LINE.                                  12840000
128500                                                                  12850000
128600     WRITE REPORT-RECORD                                          12860000
128700       FROM HEADING-LINE7                                         12870000
128800         AFTER ADVANCING 1 LINE.                                  12880000
128810     ADD 8 TO PV-LINE-COUNT.                                      12881000
128900                                                                  12890000
129000                                                                  12900000
129100******************************************************************12910000
129200*                                                                 12920000
129300******************************************************************12930000
129400 8120-PRINT-DETAIL-LINES1.                                        12940000
129500***  DISPLAY '8120-PRINT-REPORT           '.                      12950027
129600                                                                  12960000
129700     WRITE REPORT-RECORD                                          12970000
129800       FROM DL-DETAIL-LINE1                                       12980000
129900         AFTER ADVANCING 2 LINES                                  12990000
129910     ADD 2 TO PV-LINE-COUNT.                                      12991000
130000                                                                  13000000
130100******************************************************************13010000
130200*                                                                 13020000
130300******************************************************************13030000
130400 8999-END-NO-NEW-DATA.                                            13040000
130500                                                                  13050000
130600     WRITE REPORT-RECORD                                          13060000
130700      FROM NO-NEW-ITEMS-TO-REPORT-LINE                            13070000
130800     AFTER ADVANCING 5 LINE                                       13080000
130810     ADD 5 TO PV-LINE-COUNT.                                      13081000
130900                                                                  13090000
131000     WRITE REPORT-RECORD                                          13100000
131100      FROM END-OF-REPORT-LINE                                     13110000
131200     AFTER ADVANCING 5 LINES                                      13120000
131210     ADD 5 TO PV-LINE-COUNT.                                      13121000
131300                                                                  13130000
131400     SET PS-FIRST-FETCH-NOT-FND TO TRUE.                          13140000
131500                                                                  13150000
131600******************************************************************13160000
131700*                                                                 13170000
131800******************************************************************13180000
131900 9001-PROCESS-TRIP-TOTALS.                                        13190000
132000                                                                  13200000
132100     PERFORM 8300-PROCESS-PROGRAM-TOTALS.                         13210000
132200                                                                  13220000
132300         WRITE REPORT-RECORD                                      13230000
132400          FROM END-OF-REPORT-LINE                                 13240000
132500         AFTER ADVANCING 3 LINES                                  13250000
132510         ADD 3 TO PV-LINE-COUNT.                                  13251000
132600     SET PS-FIRST-FETCH-NOT-FND TO TRUE.                          13260000
132700                                                                  13270000
132800******************************************************************13280000
132900*                                                                 13290000
133000******************************************************************13300000
133100 9005-END-PROCESS.                                                13310000
133200                                                                  13320000
133300     CLOSE TRIP-FILE                                              13330000
133400           REPORT-FILE.                                           13340000
133500                                                                  13350000
133600                                                                  13360000
133700******************************************************************13370000
133800*  PERFORMS A NON-SQL ABEND FOR THE PROGRAM                       13380000
133900******************************************************************13390000
134000 9200-ABEND.                                                      13400000
134100***  DISPLAY '9200-ABEND                  '.                      13410000
134200                                                                  13420000
134300     DISPLAY '***************************'.                       13430000
134400     DISPLAY '**       ABEND           **'.                       13440000
134500     DISPLAY '**  IN PROGRAM SUKRP047  **'.                       13450000
134600     DISPLAY '***************************'.                       13460000
134700     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        13470000
134800     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-1.       13480000
134900     DISPLAY '**                 ** = ' PV-ERROR-MESSAGE-2.       13490000
135000                                                                  13500000
135100     MOVE +4014                  TO PV-ABEND-CODE.                13510000
135200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         13520000
135300                                                                  13530000
135400******************************************************************13540000
135500*  PERFORMS AN SQL ABEND FOR THE PROGRAM                          13550000
135600******************************************************************13560000
135700 Z999-SQL-ERROR.                                                  13570000
135800***  DISPLAY 'Z999-SQL-ERROR              '.                      13580000
135900                                                                  13590000
136000     MOVE SU069-LOC-NBR             TO PV-DISP-STORE.             13600000
136100     MOVE SU069-OTBND-TRIP-ID       TO PV-DISP-TRIP.              13610000
136200     MOVE SU069-OTBND-TRIP-SRL-NBR  TO PV-DISP-TRLR-SRL.          13620000
136300     MOVE SU069-TRIP-OCRNC-ID       TO PV-DISP-ORCNCE.            13630000
136400     MOVE SQLCODE                   TO PV-DISP-SQLCODE.           13640000
136500                                                                  13650000
136600     DISPLAY '*********************************'                  13660000
136700     DISPLAY '** PROGRAM        ** =  SUKRP047'.                  13670000
136800     DISPLAY '*********************************'                  13680000
136900     DISPLAY '** PARAGRAPH      ** = ' PV-PARAGRAPH-NAME.         13690000
137000     DISPLAY '** SQLCODE        ** = ' PV-DISP-SQLCODE.           13700000
137100     DISPLAY '** DC             ** = ' PV-DISP-DC.                13710000
137200     DISPLAY '** DISTRICT       ** = ' PV-DISP-DISTRICT.          13720000
137300     DISPLAY '** STORE          ** = ' PV-DISP-STORE.             13730000
137400     DISPLAY '** OUTBOUND TRIP  ** = ' PV-DISP-TRIP.              13740000
137500     DISPLAY '** TRAILER SERIAL ** = ' PV-DISP-TRLR-SRL.          13750000
137600     DISPLAY '** SCAC           ** = ' PV-DC-SCAC.                13760000
137700     DISPLAY '** TRAILER        ** = ' PV-DC-TRLR-ID.             13770000
137800     DISPLAY '** OCCURANCE      ** = ' PV-DISP-ORCNCE.            13780000
137900     DISPLAY '**                **   '.                           13790000
138000     DISPLAY '** QUARTER BEGIN  **   ' PV-QUARTER-BEGIN-TMST.     13800000
138100     DISPLAY '** QUARTER END    **   ' PV-QUARTER-END-TMST.       13810000
138200     DISPLAY '**                **   '.                           13820000
138300     DISPLAY '** DB2 TABLE 1    ** = ' PV-TABLE-1.                13830000
138400     DISPLAY '** DB2 TABLE 2    ** = ' PV-TABLE-2.                13840000
138500     DISPLAY '** DB2 TABLE 3    ** = ' PV-TABLE-3.                13850000
138600     DISPLAY '*********************************'                  13860000
138700                                                                  13870000
138800     MOVE +4013 TO PV-ABEND-CODE.                                 13880000
138900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         13890000
