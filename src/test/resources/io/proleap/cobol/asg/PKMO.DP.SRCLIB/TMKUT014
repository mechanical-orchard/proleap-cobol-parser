000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400                                                                  00040000
000500 PROGRAM-ID.             TMKUT014.                                00050099
000600 AUTHOR.                 TKMA497.                                 00060099
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070000
000800 DATE-WRITTEN            FEBRUARY 2004.                           00080099
000900 DATE-COMPILED.                                                   00090000
001000                                                                  00100000
001100*----------------------------------------------------------------*00110000
001200* THIS PROGRAM EXTRACTS "TROUBLE" INFORMATION FROM THE TROUBLE   *00120000
001300* TABLES FOR FALSE FAILED AUDIT REPORTING.                       *00130099
001300* THIS PROGRAM WAS COPIED FROM TMKUT002.                         *00140099
001400*----------------------------------------------------------------*00150000
001500                                                                  00160000
001600******************************************************************00170000
001700 ENVIRONMENT DIVISION.                                            00180000
001800******************************************************************00190000
001900                                                                  00200000
002000 CONFIGURATION SECTION.                                           00210000
002100                                                                  00220000
002200 SOURCE-COMPUTER.        IBM-3090.                                00230000
002300 OBJECT-COMPUTER.        IBM-3090.                                00240000
002400                                                                  00250000
002500 INPUT-OUTPUT SECTION.                                            00260000
002600                                                                  00270000
002700 FILE-CONTROL.                                                    00280000
002800                                                                  00290000
002900      SELECT TROUBLE-EXTRACT-FILE   ASSIGN TO OUT01.              00300099
003000                                                                  00310099
003100******************************************************************00320099
003200 DATA DIVISION.                                                   00330099
003300******************************************************************00340099
003400                                                                  00350099
003500 FILE SECTION.                                                    00360099
003600 FD  TROUBLE-EXTRACT-FILE                                         00370099
003700     LABEL RECORDS ARE STANDARD                                   00380099
003800     BLOCK CONTAINS 0 RECORDS                                     00390099
003900     RECORDING MODE IS F                                          00400099
004000     RECORD CONTAINS 300 CHARACTERS                               00410099
004100     DATA RECORD IS TROUBLE-EXTRACT-RECORD.                       00420099
004200                                                                  00430099
004300 01 TROUBLE-EXTRACT-RECORD          PIC X(300).                   00440099
004400*------------------------------------------------------*          00450099
004500 WORKING-STORAGE SECTION.                                         00460099
004600*------------------------------------------------------*          00470099
004700 01 PC-PROGRAM-CONSTANTS.                                         00480099
004800    05 PC-PROGRAM-NAME               PIC X(08) VALUE 'TMKUT014'.  00490099
004900    05 PC-DEFAULT-CC-DATE            PIC X(10) VALUE '9999-09-09'.00500099
005000    05 PC-DEFAULT-DATE-TIME          PIC X(14) VALUE              00510099
005100                                                 '99990909090909'.00520099
005200    05 PC-DEFAULT-TIMESTAMP          PIC X(26) VALUE              00530099
005300                                     '9999-09-09-09.09.09.999999'.00540099
005400    05 PC-ZERO                       PIC 9(01) VALUE 0.           00550099
005500    05 PC-ONE                        PIC 9(01) VALUE 1.           00560099
005600    05 PC-TWO                        PIC 9(01) VALUE 2.           00570099
005700    05 PC-SEVEN                      PIC 9(02) VALUE 7.           00580099
005800    05 PC-TWENTY-EIGHT               PIC 9(02) VALUE 28.          00590099
005900    05 PC-RESOLVED                   PIC X(01) VALUE 'R'.         00600099
006000    05 PC-APPROVED                   PIC X(01) VALUE 'A'.         00610099
006100    05 PC-NEW                        PIC X(01) VALUE 'N'.         00620099
006200    05 PC-VE                         PIC X(02) VALUE 'VE'.        00630099
006300    05 PC-SPRING                     PIC X(06) VALUE 'SPRING'.    00640099
006400    05 PC-FALL                       PIC X(06) VALUE '  FALL'.    00650099
006500    05 PC-A                          PIC X(01) VALUE 'A'.         00660099
006600    05 PC-T                          PIC X(01) VALUE 'T'.         00670005
006700    05 PC-3ZEROS                     PIC X(03) VALUE '000'.       00680005
007000    05 PC-DAY-BEGIN-TIME             PIC X(15)                    00690099
007100                                     VALUE '00.00.00.000001'.     00700099
007200    05 PC-DAY-END-TIME               PIC X(15)                    00710099
007300                                     VALUE '24.00.00.000000'.     00720099
007400 01 DK-DATABASE-KEYS.                                             00730099
007500    05 DK-START-EXTRACT              PIC X(26) VALUE SPACE.       00740099
007600    05 DK-END-EXTRACT                PIC X(26) VALUE SPACE.       00750099
007800 01 PV-PROGRAM-VARIABLES.                                         00760099
007900    05 PV-ABEND-CODE                 PIC  9(04) VALUE 0.          00770099
008100    05 PV-CURRENT-DB2-DATE           PIC  X(10).                  00780099
008600    05 PV-CURR-DATE.                                              00790099
008700       10 PV-CURRENT-DB2-CCYY.                                    00800099
008800          15 PV-CURRENT-DB2-CC       PIC  9(02)    VALUE 0.       00810099
008900          15 PV-CURRENT-DB2-YY       PIC  9(02)    VALUE 0.       00820099
009000       10 FILLER                     PIC  X(01)    VALUE '-'.     00830099
009100       10 PV-CURRENT-DB2-MM          PIC  9(02)    VALUE 0.       00840099
009200       10 FILLER                     PIC  X(01)    VALUE '-'.     00850099
009300       10 PV-CURRENT-DB2-DD          PIC  9(02)    VALUE 0.       00860099
009400    05 PV-CURRENT-DATE.                                           00870000
009500       10 PV-CURRENT-CCYY.                                        00880099
009600          15 PV-CURRENT-CC           PIC  9(02)    VALUE 0.       00890099
009700          15 PV-CURRENT-YY           PIC  9(02)    VALUE 0.       00900099
009800       10 PV-CURRENT-MM              PIC  9(02)    VALUE 0.       00910099
009900       10 PV-CURRENT-DD              PIC  9(02)    VALUE 0.       00920099
010000    05 PV-CURRENT-YYMMDD-DATE.                                    00930000
010100       10 PV-CURRENT-YYMMDD-YY       PIC  9(02)    VALUE 0.       00940099
010200       10 PV-CURRENT-YYMMDD-MM       PIC  9(02)    VALUE 0.       00950099
010300       10 PV-CURRENT-YYMMDD-DD       PIC  9(02)    VALUE 0.       00960099
010400    05 PV-PARA-NAME                  PIC  X(30)    VALUE SPACE.   00970099
010500    05 PV-YEAR-FORMAT.                                            00980099
010600       10 PV-YEAR-FORMAT-CC          PIC  9(02)    VALUE 0.       00990099
010700       10 PV-YEAR-FORMAT-YY          PIC  9(02)    VALUE 0.       01000099
010800    05 PV-BEG-DATE.                                               01010099
010900       10 PV-BEG-YYYY.                                            01020099
011000          15 PV-BEG-CC               PIC  9(02)    VALUE 0.       01030099
011100          15 PV-BEG-YY               PIC  9(02)    VALUE 0.       01040099
011200       10 PV-BEG-MM                  PIC  9(02)    VALUE 0.       01050099
011300       10 PV-BEG-DD                  PIC  9(02)    VALUE 0.       01060099
011400    05 PV-END-DATE.                                               01070099
011500       10 PV-END-YYYY.                                            01080099
011600          15 PV-END-CC               PIC  9(02)    VALUE 0.       01090099
011700          15 PV-END-YY               PIC  9(02)    VALUE 0.       01100099
011800       10 PV-END-MM                  PIC  9(02)    VALUE 0.       01110099
011900       10 PV-END-DD                  PIC  9(02)    VALUE 0.       01120099
012000    05 PV-RESOLVE-CHECK-DATE.                                     01130099
012100       10 PV-RESOLVE-CHECK-YYYY      PIC 9(04)     VALUE 0.       01140099
012200       10 PV-RESOLVE-CHECK-MM        PIC 9(02)     VALUE 0.       01150099
012300       10 PV-RESOLVE-CHECK-DD        PIC 9(02)     VALUE 0.       01160099
012400    05 PV-DATE-AREA.                                              01170099
012500       10 PV-DATE-AREA-MM            PIC  9(02)    VALUE 0.       01180099
012600       10 PV-DATE-AREA-DD            PIC  9(02)    VALUE 0.       01190099
012700       10 PV-DATE-AREA-CC            PIC  9(02)    VALUE 0.       01200099
012800       10 PV-DATE-AREA-YY            PIC  9(02)    VALUE 0.       01210099
012900    05 PV-REFORMAT-TMST.                                          01220099
013000       10 PV-RF-YYYY                 PIC 9(04)     VALUE 0.       01230099
013100       10 FILLER                     PIC X(01)     VALUE SPACE.   01240099
013200       10 PV-RF-MM                   PIC 9(02)     VALUE 0.       01250099
013300       10 FILLER                     PIC X(01)     VALUE SPACE.   01260099
013400       10 PV-RF-DD                   PIC 9(02)     VALUE 0.       01270099
013500       10 FILLER                     PIC X(01)     VALUE SPACE.   01280099
013600       10 PV-RF-HH                   PIC 9(02)     VALUE 0.       01290099
013700       10 FILLER                     PIC X(01)     VALUE SPACE.   01300099
013800       10 PV-RF-MIN                  PIC 9(02)     VALUE 0.       01310099
013900       10 FILLER                     PIC X(01)     VALUE SPACE.   01320099
014000       10 PV-RF-SS                   PIC 9(02)     VALUE 0.       01330099
014100       10 FILLER                     PIC X(01)     VALUE SPACE.   01340099
014200       10 PV-RF-MSS                  PIC 9(06)     VALUE 0.       01350099
014300    05 PV-REFORMATED-TMST.                                        01360099
014400       10 PV-RFMTED-DATE.                                         01370099
014500          15 PV-RFMTED-YYYY          PIC 9(04)     VALUE 0.       01380099
014600          15 PV-RFMTED-MM            PIC 9(02)     VALUE 0.       01390099
014700          15 PV-RFMTED-DD            PIC 9(02)     VALUE 0.       01400099
014800       10 PV-RFMTED-TIME.                                         01410099
014900          15 PV-RFMTED-HH            PIC 9(02)     VALUE 0.       01420099
015000          15 PV-RFMTED-MIN           PIC 9(02)     VALUE 0.       01430099
015100          15 PV-RFMTED-SS            PIC 9(02)     VALUE 0.       01440099
015200    05 PV-START-EXTRACT              PIC X(10)     VALUE SPACE.   01450099
015300    05 FILLER  REDEFINES PV-START-EXTRACT.                        01460099
015400       10 PV-START-EXTRACT-YYYY      PIC 9999.                    01470099
015500       10 PV-START-EXTRACT-1ST       PIC X.                       01480099
015600       10 PV-START-EXTRACT-MM        PIC 99.                      01490099
015700       10 PV-START-EXTRACT-2ND       PIC X.                       01500099
015800       10 PV-START-EXTRACT-DD        PIC 99.                      01510099
015900    05 PV-END-EXTRACT                PIC X(10)     VALUE SPACE.   01520016
016000    05 FILLER  REDEFINES PV-END-EXTRACT.                          01530099
016100       10 PV-END-EXTRACT-YYYY        PIC 9999.                    01540099
016200       10 PV-END-EXTRACT-1ST         PIC X.                       01550099
016300       10 PV-END-EXTRACT-MM          PIC 99.                      01560099
016400       10 PV-END-EXTRACT-2ND         PIC X.                       01570099
016500       10 PV-END-EXTRACT-DD          PIC 99.                      01580099
016600    05 PV-ABEND-PARA-NAME            PIC X(30)     VALUE SPACE.   01590000
016700    05 PV-DB2-OPERATION-MSG-1        PIC X(40)     VALUE SPACE.   01600099
016800    05 PV-DB2-OPERATION-MSG-2        PIC X(40)     VALUE SPACE.   01610099
016900    05 PV-DB2-TABLE-1                PIC X(20)     VALUE SPACE.   01620099
016900    05 PV-DB2-TABLE-2                PIC X(20)     VALUE SPACE.   01630099
017000    05 PV-SQLCODE-X.                                              01640099
017000        10 PV-SQLCODE                PIC Z(8)9-.                  01650099
017100    05 PV-PARAGRAPH-NAME             PIC X(30)     VALUE SPACE.   01660099
017500    05 PV-RECORD-COUNT               PIC S9(08)    VALUE 0        01670099
017600                                                   COMP.          01680099
017700    05 PV-NOTIF-NBR                  PIC  9(09)    VALUE 0.       01690099
017800    05 PV-RECORD-COUNT-DISPLAY       PIC Z(07)9    VALUE ZEROS.   01700099
017900    05 PV-RCVRS-VRFYD-QTY            PIC S9(9)     COMP-3 VALUE 0.01710099
018000    05 PV-RCVRS-TRBL-QTY             PIC S9(9)     COMP-3 VALUE 0.01720099
018100    05 PV-SEASON-DESC                PIC X(06)     VALUE SPACES.  01730099
018200    05  PV-START-RCVR.                                            01740099
018300        10  PV-START-RCVR-DATE.                                   01750099
018400            15  PV-START-RCVR-DATE-YYYY PIC  X(04).               01760099
018500            15  FILLER                  PIC  X(01)  VALUE '-'.    01770099
018600            15  PV-START-RCVR-DATE-MM   PIC  X(02).               01780099
018700            15  FILLER                  PIC  X(01)  VALUE '-'.    01790099
018800            15  PV-START-RCVR-DATE-DD   PIC  X(02).               01800099
018900        10  PV-START-RCVR-TIME          PIC  X(16)  VALUE         01810099
019000                  '-00.00.00.000000'.                             01820099
019100    05  PV-START-RCVR-TMST REDEFINES PV-START-RCVR PIC X(26).     01830099
019200                                                                  01840099
019300    05  PV-END-RCVR.                                              01850099
019400        10  PV-END-RCVR-DATE.                                     01860099
019500            15  PV-END-RCVR-DATE-YYYY PIC    X(04).               01870099
019600            15  FILLER                  PIC  X(01)  VALUE '-'.    01880099
019700            15  PV-END-RCVR-DATE-MM     PIC  X(02).               01890099
019800            15  FILLER                  PIC  X(01)  VALUE '-'.    01900099
019900            15  PV-END-RCVR-DATE-DD     PIC  X(02).               01910099
020000        10  PV-END-RCVR-TIME            PIC  X(16)  VALUE         01920099
020100                  '-23.59.59.999999'.                             01930099
020200    05  PV-END-RCVR-TMST REDEFINES PV-END-RCVR PIC X(26).         01940099
020300 01 PS-PROGRAM-SWITCHES.                                          01950000
020400    05 PS-END-OF-DATA-SW             PIC X(01)     VALUE SPACE.   01960000
020500       88 PS-EOD                     VALUE 'Y'.                   01970000
020600       88 PS-NOT-EOD                 VALUE 'N'.                   01980000
020400    05 PS-END-OF-SU-AUDIT-SW         PIC X(01)     VALUE SPACE.   01990099
020500       88 PS-END-OF-SU-AUDIT         VALUE 'Y'.                   02000099
020700    05 PS-RUN-TYPE-SW                PIC X(01)     VALUE SPACE.   02010000
020800       88 PS-SPECIAL-RUN             VALUE 'S'.                   02020000
020900       88 PS-NORMAL-RUN              VALUE 'N'.                   02030000
021000 01 PS-DETERMINE-DATE-RANGE-SW       PIC X(01)     VALUE SPACE.   02040000
021100    88 PS-DETERMINE-DT-RANGE         VALUE 'Y'.                   02050000
021200    88 PS-DO-NOT-DETERMINE-DT-RANGE  VALUE 'N'.                   02060000
021300 01 PS-MONDAY-SW                     PIC X(01)     VALUE SPACE.   02070025
021400    88 PS-MONDAY                     VALUE 'M'.                   02080025
021500    88 PS-NOT-MONDAY                 VALUE 'N'.                   02090025
021300 01 PS-XLKUT001-CALL-SW              PIC X(01)     VALUE SPACE.   02100099
102810    88 PS-XLKUT001-CALL              VALUE 'Y'.                   02110099
021600                                                                  02120000
021700 01 CC-CONTROL-CARD-PARAMETERS.                                   02130000
021800    05 CC-BEG-DATE.                                               02140000
021900       10 CC-BEG-YYYY                 PIC 9(04) VALUE 0.          02150000
022000       10 FILLER                      PIC X(01) VALUE SPACE.      02160000
022100       10 CC-BEG-MM                   PIC 9(02) VALUE 0.          02170000
022200       10 FILLER                      PIC X(01) VALUE SPACE.      02180000
022300       10 CC-BEG-DD                   PIC 9(02) VALUE 0.          02190000
022400    05 FILLER                       PIC X(01) VALUE SPACE.        02200000
022500    05 CC-END-DATE.                                               02210000
022600       10 CC-END-YYYY                 PIC 9(04) VALUE 0.          02220000
022700       10 FILLER                      PIC X(01) VALUE SPACE.      02230099
022800       10 CC-END-MM                   PIC 9(02) VALUE 0.          02240099
022900       10 FILLER                      PIC X(01) VALUE SPACE.      02250099
023000       10 CC-END-DD                   PIC 9(02) VALUE 0.          02260099
023100    05 FILLER                       PIC X(01) VALUE SPACE.        02270099
023200    05 CC-MODE-IND                  PIC X(01) VALUE SPACE.        02280099
023300       88 CC-VALID-MODE-IND         VALUE 'W'.                    02290099
023300*      88 CC-VALID-MODE-IND         VALUE 'W', 'M'.               02300099
023600       88 CC-WEEKLY-EXTRACT         VALUE 'W'.                    02310099
023700*      88 CC-MONTHLY-EXTRACT        VALUE 'M'.                    02320099
024100    05 FILLER                       PIC X(01) VALUE SPACE.        02330099
024200    05 CC-TIMEFRAME-IND             PIC X(01) VALUE SPACE.        02340099
024300       88 CC-VALID-TIMEFRAME-IND    VALUE ' ', 'A'.               02350099
024400       88 CC-ACTUAL-TIMEFRAME       VALUE 'A'.                    02360099
024500    05 FILLER                       PIC X(59) VALUE SPACE.        02370099
024600                                                                  02380099
024700                                                                  02390099
024800     COPY DPWS500.                                                02400099
024900                                                                  02410099
025000     COPY TMRD002.                                                02420099
024900                                                                  02430099
024900     COPY XLWS001.                                                02440099
024900                                                                  02450099
024900     COPY XLWS067.                                                02460099
024900                                                                  02470099
024900     COPY XLWS071.                                                02480099
025400*                                                                 02490099
025200*** DB2 MESSAGE AREAS ****                                        02500099
025300     COPY DPWS004.                                                02510099
025400*                                                                 02520099
025500     EXEC SQL                                                     02530099
025600          INCLUDE SQLCA                                           02540099
025700     END-EXEC.                                                    02550099
025800                                                                  02560099
026300     EXEC SQL                                                     02570099
026400          INCLUDE TTRBNTF                                         02580099
026500     END-EXEC.                                                    02590099
027000                                                                  02600099
026300     EXEC SQL                                                     02610099
026400          INCLUDE TTRBRSN                                         02620099
026500     END-EXEC.                                                    02630099
027000                                                                  02640099
027100     EXEC SQL                                                     02650099
027200          INCLUDE TCOCNTL                                         02660099
027300     END-EXEC.                                                    02670099
027000                                                                  02680099
027500     EXEC SQL                                                     02690099
027600          INCLUDE TENTNME                                         02700099
027700     END-EXEC.                                                    02710099
027400                                                                  02720099
027500     EXEC SQL                                                     02730099
027600          INCLUDE TPURCHS                                         02740099
027700     END-EXEC.                                                    02750099
027800                                                                  02760099
027500     EXEC SQL                                                     02770099
027600          INCLUDE TPURITM                                         02780099
027700     END-EXEC.                                                    02790099
027800                                                                  02800099
027500     EXEC SQL                                                     02810099
027600          INCLUDE TRECITM                                         02820099
027700     END-EXEC.                                                    02830099
027800                                                                  02840099
027500     EXEC SQL                                                     02850099
027600          INCLUDE TPOPRPK                                         02860099
027700     END-EXEC.                                                    02870099
027800                                                                  02880099
068100*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             02890099
068200*    (SUT_PO_AUD_REQ)                                             02900099
068400     EXEC SQL                                                     02910099
068500          INCLUDE SUT00015                                        02920099
068600     END-EXEC.                                                    02930099
027800                                                                  02940099
066100*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE AUDIT SHIPPING UPC 02950099
066200*  TABLE                                                          02960099
027500     EXEC SQL                                                     02970099
027600          INCLUDE TSUAUPC                                         02980099
 27700     END-EXEC.                                                    02990099
027800                                                                  03000099
027900      EXEC SQL                                                    03010099
028000          DECLARE TROUBLE-CSR CURSOR FOR                          03020099
028100             SELECT                                               03030099
028300                   A.OPER_UNT_ID                                  03040099
028700                  ,A.PO_NBR                                       03050099
028800                  ,A.PO_LNE_NBR                                   03060099
028900                  ,A.REC_SEQ_NBR                                  03070099
                        ,A.TRBL_RSN_CDE                                 03080099
                        ,A.PREPK_ID                                     03090099
                        ,B.TRBL_LONG_DESC                               03100099
030700             FROM TTRBNTF A                                       03110099
                       ,TTRBRSN B                                       03120099
030900             WHERE DATE(A.NOTIF_TMST) <= :PV-END-EXTRACT          03130099
031000               AND DATE(A.NOTIF_TMST) >= :PV-START-EXTRACT        03140099
                     AND A.TRBL_RSN_CDE IN (804,805,806)                03150099
                     AND A.TRBL_RSN_CDE      = B.TRBL_RSN_CDE           03160099
031300          FOR FETCH ONLY                                          03170099
031400      END-EXEC.                                                   03180099
                                                                        03190099
027900      EXEC SQL                                                    03200099
028000          DECLARE SU-AUDIT-CSR-804 CURSOR FOR                     03210099
028100             SELECT DISTINCT                                      03220099
                         B.AUD_CNTL_NBR                                 03230099
                        ,B.UPC_NBR                                      03240099
                        ,B.AUD_USR_ID                                   03250099
068200             FROM  SUT_PO_AUD_REQ A                               03260099
027600                  ,TSUAUPC B                                      03270099
                   WHERE A.PO_NBR       = :TRBNTF-PO-NBR                03280099
                     AND A.PO_LNE_NBR   = :TRBNTF-PO-LNE-NBR            03290099
                     AND A.PO_PREPK_ID  = :TRBNTF-PREPK-ID              03300099
                     AND A.OPER_UNT_ID  = :TRBNTF-OPER-UNT-ID           03310099
                     AND A.RCVR_SEQ_NBR = :TRBNTF-REC-SEQ-NBR           03320099
                     AND A.AUD_CNTL_NBR = B.AUD_CNTL_NBR                03330099
                     AND B.SKU_NBR      = :XL001-SKU-NBR                03340099
031300          FOR FETCH ONLY                                          03350099
031400      END-EXEC.                                                   03360099
027900      EXEC SQL                                                    03370099
028000          DECLARE SU-AUDIT-CSR-805 CURSOR FOR                     03380099
028100             SELECT DISTINCT                                      03390099
                         B.AUD_CNTL_NBR                                 03400099
                        ,B.UPC_NBR                                      03410099
                        ,B.AUD_USR_ID                                   03420099
068200             FROM  SUT_PO_AUD_REQ A                               03430099
027600                  ,TSUAUPC B                                      03440099
                   WHERE A.PO_NBR       = :TRBNTF-PO-NBR                03450099
                     AND A.PO_LNE_NBR   = :TRBNTF-PO-LNE-NBR            03460099
                     AND A.PO_PREPK_ID  = :TRBNTF-PREPK-ID              03470099
                     AND A.OPER_UNT_ID  = :TRBNTF-OPER-UNT-ID           03480099
                     AND A.RCVR_SEQ_NBR = :TRBNTF-REC-SEQ-NBR           03490099
                     AND A.AUD_CNTL_NBR = B.AUD_CNTL_NBR                03500099
031300          FOR FETCH ONLY                                          03510099
031400      END-EXEC.                                                   03520099
027900      EXEC SQL                                                    03530099
028000          DECLARE SU-AUDIT-CSR-806 CURSOR FOR                     03540099
028100             SELECT DISTINCT                                      03550099
                         B.AUD_CNTL_NBR                                 03560099
                        ,B.AUD_USR_ID                                   03570099
068200             FROM  SUT_PO_AUD_REQ A                               03580099
027600                  ,TSUAUPC B                                      03590099
                   WHERE A.PO_NBR       = :TRBNTF-PO-NBR                03600099
                     AND A.PO_LNE_NBR   = :TRBNTF-PO-LNE-NBR            03610099
                     AND A.PO_PREPK_ID  = :TRBNTF-PREPK-ID              03620099
                     AND A.OPER_UNT_ID  = :TRBNTF-OPER-UNT-ID           03630099
                     AND A.RCVR_SEQ_NBR = :TRBNTF-REC-SEQ-NBR           03640099
                     AND A.AUD_CNTL_NBR = B.AUD_CNTL_NBR                03650099
031300          FOR FETCH ONLY                                          03660099
031400      END-EXEC.                                                   03670099
031600******************************************************************03680099
031500                                                                  03690099
032000********************************************************          03700099
032100 PROCEDURE DIVISION.                                              03710099
032200********************************************************          03720099
032300 0000-MAIN.                                                       03730099
032400                                                                  03740099
032500     PERFORM 1000-INITIALIZATION                                  03750099
032600     PERFORM 2000-MAIN-LOOP UNTIL PS-EOD                          03760099
032800     PERFORM 3000-CLOSE-TROUBLE-CSR.                              03770099
032900     CLOSE  TROUBLE-EXTRACT-FILE.                                 03780099
033000     MOVE PV-RECORD-COUNT           TO PV-RECORD-COUNT-DISPLAY.   03790099
033100     DISPLAY 'DETAIL RECORDS WRITTEN ' PV-RECORD-COUNT-DISPLAY.   03800099
033200     STOP RUN.                                                    03810099
033300                                                                  03820099
033400 1000-INITIALIZATION.                                             03830099
033500                                                                  03840099
033600     EXEC SQL                                                     03850099
033800         SELECT  CURRENT DATE                                     03860099
034100           INTO  :PV-CURRENT-DB2-DATE                             03870099
034300           FROM  TCOCNTL                                          03880099
034400          WHERE  OPER_UNT_ID = 90                                 03890099
034500     END-EXEC.                                                    03900099
034600                                                                  03910099
034700     EVALUATE TRUE                                                03920099
034800         WHEN SQLCODE = ZERO                                      03930099
034900             MOVE PV-CURRENT-DB2-DATE    TO PV-CURR-DATE          03940099
035000             MOVE PV-CURRENT-DB2-CC      TO PV-CURRENT-CC         03950099
035100             MOVE PV-CURRENT-DB2-YY      TO PV-CURRENT-YY         03960099
035200                                            PV-CURRENT-YYMMDD-YY  03970099
035300             MOVE PV-CURRENT-DB2-MM      TO PV-CURRENT-MM         03980099
035400                                            PV-CURRENT-YYMMDD-MM  03990099
035500             MOVE PV-CURRENT-DB2-DD      TO PV-CURRENT-DD         04000099
035600                                            PV-CURRENT-YYMMDD-DD  04010099
035700         WHEN OTHER                                               04020099
035800              MOVE '1000-INITIALIZATION'      TO                  04030099
035900                   PV-ABEND-PARA-NAME                             04040099
036000              MOVE 'SET DATE   '       TO PV-DB2-OPERATION-MSG-1  04050099
036100              MOVE 'NONE   '           TO PV-DB2-TABLE-1          04060099
036200              PERFORM 9998-SQL-ABEND                              04070099
036300      END-EVALUATE.                                               04080099
036400     ACCEPT CC-CONTROL-CARD-PARAMETERS FROM SYSIN.                04090099
036500                                                                  04100000
036600     DISPLAY 'CONTROL CARD SET-UP FOR THIS RUN IS:  '             04110033
036700             CC-CONTROL-CARD-PARAMETERS.                          04120033
036800                                                                  04130033
084700     MOVE CC-MODE-IND    TO TM002-RUN-FREQ-CDE.                   04140099
036900     PERFORM 1100-CHECK-CC-PARAMETERS                             04150099
           MOVE PS-RUN-TYPE-SW TO TM002-RUN-TYPE-CDE                    04160099
037000     PERFORM 1200-SET-DATABASE-KEYS.                              04170099
037100     OPEN OUTPUT TROUBLE-EXTRACT-FILE.                            04180099
086200     DISPLAY 'TROUBLE PULL BEGIN DATE IS:  '                      04190099
086300                TM002-RUN-BEGIN-DATE                              04200099
086400             '  AND TROUBLE PULL END DATE IS:    '                04210099
086500             TM002-RUN-END-DATE.                                  04220099
037500     PERFORM 1600-OPEN-TROUBLE-CSR.                               04230099
037600                                                                  04240000
037900 1100-CHECK-CC-PARAMETERS.                                        04250000
038000     MOVE '1100-CHECK-CC-PARAMETERS'   TO PV-PARA-NAME            04260000
038100                                                                  04270000
038200     IF NOT CC-VALID-MODE-IND                                     04280000
038300        DISPLAY '***************************'                     04290000
038400        DISPLAY 'CONTROL PARAMETERS: '                            04300000
038500                 CC-CONTROL-CARD-PARAMETERS                       04310000
038600        DISPLAY 'MODE INDICATOR "' CC-MODE-IND '"'                04320000
038700                ' IS INVALID.'                                    04330000
038800        DISPLAY 'RUN ABORTED'                                     04340000
038900        DISPLAY '***************************'                     04350000
039000        MOVE 4003  TO PV-ABEND-CODE                               04360000
039100        PERFORM 9999-ABORT                                        04370099
039200     END-IF                                                       04380000
039300                                                                  04390000
039400     IF NOT CC-VALID-TIMEFRAME-IND                                04400000
039500        DISPLAY '***************************'                     04410000
039600        DISPLAY 'CONTROL PARAMETERS: '                            04420000
039700                 CC-CONTROL-CARD-PARAMETERS                       04430000
039800        DISPLAY 'TIME INDICATOR "' CC-TIMEFRAME-IND '"'           04440099
039900                ' IS INVALID.'                                    04450000
040000        DISPLAY 'RUN ABORTED'                                     04460000
040100        DISPLAY '***************************'                     04470000
040200        MOVE 4003  TO PV-ABEND-CODE                               04480000
040300        PERFORM 9999-ABORT                                        04490099
040400     END-IF                                                       04500000
040500                                                                  04510000
040600     IF CC-BEG-DATE IS  = PC-DEFAULT-CC-DATE AND                  04520000
040700        CC-END-DATE IS  = PC-DEFAULT-CC-DATE                      04530000
040800        SET PS-NORMAL-RUN           TO TRUE                       04540000
           ELSE                                                         04550099
               PERFORM 1110-SPECIAL-RUN                                 04560099
041000     END-IF.                                                      04570000
       1110-SPECIAL-RUN.                                                04580099
038000     MOVE '1110-SPECIAL-RUN' TO PV-PARA-NAME                      04590099
041200     SET PS-SPECIAL-RUN    TO TRUE                                04600000
041300                                                                  04610000
041400     MOVE CC-BEG-YYYY      TO PV-BEG-YYYY                         04620000
041500     MOVE CC-BEG-MM        TO PV-BEG-MM                           04630000
041600     MOVE CC-BEG-DD        TO PV-BEG-DD                           04640000
041700     MOVE CC-END-YYYY      TO PV-END-YYYY                         04650000
041800     MOVE CC-END-MM        TO PV-END-MM                           04660000
041900     MOVE CC-END-DD        TO PV-END-DD                           04670000
042000                                                                  04680000
042100     IF  PV-BEG-DATE IS NOT < PV-END-DATE  AND                    04690000
042200         PV-BEG-DATE IS NOT = PV-END-DATE                         04700000
042300         DISPLAY '***************************'                    04710000
042400         DISPLAY 'CONTROL PARAMETERS: '                           04720000
042500                  CC-CONTROL-CARD-PARAMETERS                      04730000
042600         DISPLAY                                                  04740000
042700           'THE BEGINNING DATE MUST BE LESS THAN OR EQUAL TO THE E04750000
042800-          'NDING DATE'                                           04760000
042900         DISPLAY 'RUN ABORTED'                                    04770000
043000         DISPLAY '***************************'                    04780000
043100         MOVE 4003  TO PV-ABEND-CODE                              04790000
043200         PERFORM 9999-ABORT                                       04800099
043300     END-IF                                                       04810099
043400     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              04820099
043500     SET DPG51-FISCAL-454-CALENDAR   TO TRUE                      04830099
043600     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      04840099
043700     SET DPG52-LK-DTE-GREG-CC        TO TRUE                      04850099
043800                                                                  04860099
043900     MOVE PV-BEG-CC                  TO PV-DATE-AREA-CC           04870099
044000     MOVE PV-BEG-YY                  TO PV-DATE-AREA-YY           04880099
044100     MOVE PV-BEG-MM                  TO PV-DATE-AREA-MM           04890099
044200     MOVE PV-BEG-DD                  TO PV-DATE-AREA-DD           04900099
044300     MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT       04910099
044500     PERFORM 9100-CALL-DATE-MODULE                                04920099
044700     IF DPG54-DATE-INVALID                                        04930099
044800        DISPLAY '***************************'                     04940099
044900        DISPLAY 'CONTROL PARAMETERS: '                            04950099
045000                 CC-CONTROL-CARD-PARAMETERS                       04960099
045100        DISPLAY 'BEGINNING DATE  '                                04970099
045200                CC-BEG-DATE                                       04980099
045300                ' IS INVALID.'                                    04990099
045400        DISPLAY 'RUN ABORTED'                                     05000099
045500        DISPLAY '***************************'                     05010099
045600        MOVE 4003  TO PV-ABEND-CODE                               05020099
045700        PERFORM 9999-ABORT                                        05030099
045800     END-IF.                                                      05040099
045900                                                                  05050099
046000     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              05060099
046100     SET DPG51-FISCAL-454-CALENDAR   TO TRUE                      05070099
046200     SET DPG51-DO-NOT-INCR-DECR-DATE TO TRUE                      05080099
046300     SET DPG52-LK-DTE-GREG-CC        TO TRUE                      05090099
046400                                                                  05100099
046500     MOVE PV-END-CC                  TO PV-DATE-AREA-CC           05110099
046600     MOVE PV-END-YY                  TO PV-DATE-AREA-YY           05120099
046700     MOVE PV-END-MM                  TO PV-DATE-AREA-MM           05130099
046800     MOVE PV-END-DD                  TO PV-DATE-AREA-DD           05140099
046900     MOVE PV-DATE-AREA               TO DPG52-LK-DATE-INPUT       05150099
047000                                                                  05160099
047100     PERFORM 9100-CALL-DATE-MODULE                                05170099
047200                                                                  05180099
047300     IF DPG54-DATE-INVALID                                        05190099
047400        DISPLAY '***************************'                     05200099
047500        DISPLAY 'CONTROL PARAMETERS: '                            05210099
047600                 CC-CONTROL-CARD-PARAMETERS                       05220099
047700        DISPLAY 'ENDING DATE '                                    05230099
047800                CC-END-DATE                                       05240099
047900                ' IS INVALID.'                                    05250099
048000        DISPLAY 'RUN ABORTED'                                     05260099
048100        DISPLAY '***************************'                     05270099
048200        MOVE 4003  TO PV-ABEND-CODE                               05280099
048300        PERFORM 9999-ABORT                                        05290099
048400     END-IF.                                                      05300099
048500                                                                  05310099
048800 1200-SET-DATABASE-KEYS.                                          05320099
048900     IF PS-NORMAL-RUN                                             05330099
049000        PERFORM 1210-DETERMINE-DATE-RANGE                         05340099
049100     ELSE                                                         05350099
049200        MOVE CC-BEG-DATE         TO PV-START-EXTRACT              05360099
                                          TM002-RUN-BEGIN-DATE          05370099
049300        MOVE CC-END-DATE         TO PV-END-EXTRACT                05380099
                                          TM002-RUN-END-DATE            05390099
049400     END-IF.                                                      05400099
049500                                                                  05410099
049600     DISPLAY '**************************************************'.05420099
049610     DISPLAY 'EXTRACT START:  ' PV-START-EXTRACT.                 05430099
049700     DISPLAY 'EXTRACT END  :  ' PV-END-EXTRACT.                   05440099
049710     DISPLAY '**************************************************'.05450099
050000                                                                  05460000
050100 1210-DETERMINE-DATE-RANGE.                                       05470000
050200                                                                  05480000
050300     EVALUATE TRUE                                                05490000
051200       WHEN CC-WEEKLY-EXTRACT                                     05500000
051300            PERFORM 1212-WEEKLY-RPT-DTE-RANGE                     05510000
051500*      WHEN CC-MONTHLY-EXTRACT                                    05520099
051600*               PERFORM 1213-MONTHLY-RPT-DTE-RANGE                05530099
052700     END-EVALUATE.                                                05540000
053000                                                                  05550000
060000 1212-WEEKLY-RPT-DTE-RANGE.                                       05560000
060100     MOVE '1212-WEEKLY-RPT-DTE-RANGE'  TO PV-PARA-NAME            05570000
060200**** GET START/END DATES OF THE PREVIOUS WEEK.                    05580000
060300     MOVE   PV-CURRENT-CC      TO  PV-DATE-AREA-CC.               05590000
060400     MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY.               05600000
060500     MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM.               05610000
060600     MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD.               05620000
060700     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56               05630025
060800     MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT.           05640000
060900     MOVE   PC-SEVEN           TO DPG51-INCR-DECR-DAYS-9.         05650024
061000                                                                  05660000
061100     SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      05670000
061200     SET DPG51-DECREMENT-DATE       TO TRUE.                      05680000
061300     SET DPG52-LK-DTE-GREG-CC       TO TRUE.                      05690000
061400                                                                  05700000
061500     PERFORM 9100-CALL-DATE-MODULE                                05710099
061600                                                                  05720000
061700     IF DPG54-DATE-VALID                                          05730000
061800         MOVE DPG55-1ST-WKDY-DB2ISO-FMT  TO PV-START-EXTRACT      05740000
                                                  TM002-RUN-BEGIN-DATE  05750099
061900         MOVE DPG55-LAST-WKDY-DB2ISO-FMT TO PV-END-EXTRACT        05760000
                                                  TM002-RUN-END-DATE    05770099
062000     END-IF.                                                      05780000
062200                                                                  05790000
062300*1213-MONTHLY-RPT-DTE-RANGE.                                      05800099
062400*    MOVE '1213-MONTHLY-RPT-DTE-RANGE'  TO PV-PARA-NAME           05810099
062500*** GET START/END DATES OF THE PREVIOUS MONTH.                    05820000
062600*    MOVE   PV-CURRENT-CC      TO  PV-DATE-AREA-CC                05830099
062700*    MOVE   PV-CURRENT-YY      TO  PV-DATE-AREA-YY                05840099
062800*    MOVE   PV-CURRENT-MM      TO  PV-DATE-AREA-MM                05850099
062900*    MOVE   PV-CURRENT-DD      TO  PV-DATE-AREA-DD                05860099
063000*    INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56               05870099
063100*    MOVE   PV-DATE-AREA       TO  DPG52-LK-DATE-INPUT            05880099
063200*                                                                 05890099
063300*    MOVE PC-TWENTY-EIGHT      TO DPG51-INCR-DECR-DAYS-9          05900099
063400*                                                                 05910099
063500*    SET DPG51-FISCAL-454-CALENDAR  TO TRUE.                      05920099
063600*    SET DPG51-DECREMENT-DATE       TO TRUE.                      05930099
063700*    SET DPG52-LK-DTE-GREG-CC       TO TRUE.                      05940099
063800*                                                                 05950099
063900*    PERFORM 9100-CALL-DATE-MODULE                                05960099
064000*    MOVE DPG56-FIRST-FP-DB2-ISO-FMT TO                           05970099
064100*                                 PV-START-EXTRACT                05980099
064200*    MOVE DPG56-LAST-FP-DB2-ISO-FMT  TO                           05990099
064300*                                 PV-END-EXTRACT.                 06000099
086700                                                                  06010000
086800 1600-OPEN-TROUBLE-CSR.                                           06020099
086900        EXEC SQL                                                  06030000
087000             OPEN TROUBLE-CSR                                     06040099
087100        END-EXEC.                                                 06050000
087200                                                                  06060000
087300        EVALUATE TRUE                                             06070000
087400           WHEN SQLCODE = ZERO                                    06080000
087500                CONTINUE                                          06090000
087600           WHEN OTHER                                             06100000
087700                MOVE '1600-TROUBLE-CSR'  TO PV-ABEND-PARA-NAME    06110099
087800                MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-106120000
087900                MOVE 'TTRBNTF'           TO PV-DB2-TABLE-1        06130099
088000                PERFORM 9998-SQL-ABEND                            06140099
088100        END-EVALUATE.                                             06150000
088300                                                                  06160000
088400 3000-CLOSE-TROUBLE-CSR.                                          06170099
088500        EXEC SQL                                                  06180000
088600            CLOSE TROUBLE-CSR                                     06190099
088700        END-EXEC.                                                 06200000
088900                                                                  06210000
089000 2000-MAIN-LOOP.                                                  06220000
089100        EXEC SQL                                                  06230000
089200          FETCH TROUBLE-CSR                                       06240099
089400           INTO  :TRBNTF-OPER-UNT-ID                              06250099
089800                ,:TRBNTF-PO-NBR                                   06260000
089900                ,:TRBNTF-PO-LNE-NBR                               06270000
090000                ,:TRBNTF-REC-SEQ-NBR                              06280000
090100                ,:TRBNTF-TRBL-RSN-CDE                             06290000
                      ,:TRBNTF-PREPK-ID                                 06300099
                      ,:TRBRSN-TRBL-LONG-DESC                           06310099
091800        END-EXEC.                                                 06320099
091900                                                                  06330099
092000       EVALUATE TRUE                                              06340099
092100            WHEN SQLCODE = ZERO                                   06350099
092200                PERFORM 2100-PROCESS-ROW                          06360099
092300            WHEN SQLCODE = +100                                   06370099
092400                SET  PS-EOD              TO TRUE                  06380099
092500            WHEN OTHER                                            06390099
092600                MOVE '2000-MAIN-LOOP'    TO PV-ABEND-PARA-NAME    06400099
092700                MOVE 'FETCH TROUBLE-CSR'                          06410099
092800                                         TO PV-DB2-OPERATION-MSG-106420099
092900                MOVE 'TTRBNTF'           TO PV-DB2-TABLE-1        06430099
092900                MOVE 'TTRBRSN'           TO PV-DB2-TABLE-2        06440099
093000                PERFORM 9998-SQL-ABEND                            06450099
093100        END-EVALUATE.                                             06460099
                                                                        06470099
093400 2100-PROCESS-ROW.                                                06480099
093500     INITIALIZE TM002-DETAIL-DATA.                                06490099
093600                                                                  06500099
094000     MOVE  TRBNTF-OPER-UNT-ID       TO TM002-OPER-UNT-ID          06510099
095600     MOVE  TRBNTF-PO-NBR            TO TM002-PO-NBR               06520099
095700     MOVE  TRBNTF-REC-SEQ-NBR       TO TM002-REC-SEQ-NBR          06530099
095602     MOVE  TRBNTF-PO-LNE-NBR        TO TM002-PO-LNE-NBR           06540099
095602     MOVE  TRBNTF-PREPK-ID          TO TM002-PO-PREPK-ID          06550099
095900     MOVE  TRBNTF-TRBL-RSN-CDE      TO TM002-TRBL-RSN-CDE         06560099
           MOVE  TRBRSN-TRBL-LONG-DESC    TO TM002-TRBL-LONG-DESC       06570099
094300     PERFORM 2110-DC-NAME                                         06580099
094300     PERFORM 2120-VENDOR-DATA                                     06590099
           EVALUATE TRUE                                                06600099
108000         WHEN TRBNTF-TRBL-RSN-CDE = 804                           06610099
                   PERFORM 2130-PACK-SKU-NBR                            06620099
                   PERFORM 2142-SKU-USING-TRECITM                       06630099
108000         WHEN TRBNTF-TRBL-RSN-CDE = 805                           06640099
                   PERFORM 2140-SKU-USING-TPURITM                       06650099
108000         WHEN OTHER                                               06660099
                   MOVE SPACES TO TM002-SKU-NBR-X                       06670099
           END-EVALUATE.                                                06680099
092400     INITIALIZE PS-END-OF-SU-AUDIT-SW                             06690099
095900     EVALUATE TRBNTF-TRBL-RSN-CDE                                 06700099
095900       WHEN 806                                                   06710099
037500         PERFORM 2160-OPEN-SU-AUDIT-CSR-806                       06720099
104000         PERFORM 2162-SU-AUDIT-DATA-AND-OUT                       06730099
               IF PS-END-OF-SU-AUDIT                                    06740099
032800             PERFORM 2164-CLOSE-SU-AUDIT-CSR-806                  06750099
                   MOVE SPACES                                          06760099
                              TO TM002-UPC-NBR-X                        06770099
                   MOVE ' NOT FOUND'                                    06780099
                              TO TM002-AUD-CNTL-NBR-X                   06790099
                   MOVE 'NOT FOUND                               '      06800099
                              TO TM002-ASSOCIATE-NAME                   06810099
099800             WRITE TROUBLE-EXTRACT-RECORD FROM                    06820099
099900                                  TM002-TROUBLE-EXT-RECORD        06830099
100000             ADD  1         TO PV-RECORD-COUNT                    06840099
095900         ELSE                                                     06850099
104000             PERFORM 2162-SU-AUDIT-DATA-AND-OUT                   06860099
092400                UNTIL PS-END-OF-SU-AUDIT                          06870099
032800             PERFORM 2164-CLOSE-SU-AUDIT-CSR-806                  06880099
               END-IF                                                   06890099
           WHEN 805                                                     06900099
037500         PERFORM 2150-OPEN-SU-AUDIT-CSR-805                       06910099
104000         PERFORM 2152-SU-AUDIT-DATA-AND-OUT                       06920099
               IF PS-END-OF-SU-AUDIT                                    06930099
032800             PERFORM 2154-CLOSE-SU-AUDIT-CSR-805                  06940099
                   MOVE ' NOT FOUND'                                    06950099
                              TO TM002-AUD-CNTL-NBR-X                   06960099
                   MOVE '      NOT FOUND'                               06970099
                              TO TM002-UPC-NBR-X                        06980099
                   MOVE 'NOT FOUND                               '      06990099
                              TO TM002-ASSOCIATE-NAME                   07000099
099800             WRITE TROUBLE-EXTRACT-RECORD FROM                    07010099
099900                                  TM002-TROUBLE-EXT-RECORD        07020099
100000             ADD  1         TO PV-RECORD-COUNT                    07030099
               ELSE                                                     07040099
104000             PERFORM 2152-SU-AUDIT-DATA-AND-OUT                   07050099
092400                UNTIL PS-END-OF-SU-AUDIT                          07060099
032800             PERFORM 2154-CLOSE-SU-AUDIT-CSR-805                  07070099
               END-IF                                                   07080099
           WHEN 804                                                     07090099
      ***   AND XL001-SKU-NBR FOUND (SKU IS IN THE DECLARE)             07100099
               IF XL001-SUCCESSFUL                                      07110099
037500             PERFORM 2170-OPEN-SU-AUDIT-CSR-804                   07120099
104000             PERFORM 2172-SU-AUDIT-DATA-AND-OUT                   07130099
                   IF PS-END-OF-SU-AUDIT                                07140099
032800                 PERFORM 2174-CLOSE-SU-AUDIT-CSR-804              07150099
                       MOVE ' NOT FOUND'                                07160099
                              TO TM002-AUD-CNTL-NBR-X                   07170099
                       MOVE '      NOT FOUND'                           07180099
                              TO TM002-UPC-NBR-X                        07190099
                       MOVE 'NOT FOUND                               '  07200099
                              TO TM002-ASSOCIATE-NAME                   07210099
099800                 WRITE TROUBLE-EXTRACT-RECORD FROM                07220099
099900                                  TM002-TROUBLE-EXT-RECORD        07230099
100000                 ADD  1 TO PV-RECORD-COUNT                        07240099
                   ELSE                                                 07250099
104000                 PERFORM 2172-SU-AUDIT-DATA-AND-OUT               07260099
092400                    UNTIL PS-END-OF-SU-AUDIT                      07270099
032800                 PERFORM 2174-CLOSE-SU-AUDIT-CSR-804              07280099
               ELSE                                                     07290099
                   MOVE ' NOT FOUND'                                    07300099
                              TO TM002-AUD-CNTL-NBR-X                   07310099
                   MOVE '      NOT FOUND'                               07320099
                              TO TM002-UPC-NBR-X                        07330099
                   MOVE 'NOT FOUND                               '      07340099
                              TO TM002-ASSOCIATE-NAME                   07350099
099800             WRITE TROUBLE-EXTRACT-RECORD FROM                    07360099
099900                                  TM002-TROUBLE-EXT-RECORD        07370099
100000             ADD  1 TO PV-RECORD-COUNT                            07380099
               END-IF                                                   07390099
           END-EVALUATE.                                                07400099
100100                                                                  07410099
094300 2110-DC-NAME.                                                    07420099
000398     INITIALIZE XL071-COMMAREA-REC                                07430099
           MOVE TRBNTF-OPER-UNT-ID TO XL071-LOCATION-NUMBER             07440099
000398     CALL XL071-LOCATION-MODULE USING XL071-COMMAREA-REC          07450099
                                                                        07460099
105300     EVALUATE TRUE                                                07470099
105400         WHEN XL071-NO-ERRORS                                     07480099
105600             MOVE XL071-LOC-NM        TO TM002-DC-NAME            07490099
105400         WHEN XL071-LOC-NOT-FOUND                                 07500099
                   MOVE 'NOT FOUND'         TO TM002-DC-NAME            07510099
105800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07520099
105900             DISPLAY '*** SQLCODE +100, CALL XLKUT071  '          07530099
106100             DISPLAY '*** TTRBNTF PO      :' TRBNTF-PO-NBR        07540099
106200             DISPLAY '*** TTRBNTF REC SEQ :' TRBNTF-REC-SEQ-NBR   07550099
106300             DISPLAY '*** TTRBNTF TRBL RSN:' TRBNTF-TRBL-RSN-CDE  07560099
106300             DISPLAY '*** TTRBNTF OPER UNT:' TRBNTF-OPER-UNT-ID   07570099
106400             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07580099
106500         WHEN XL071-BAD-DB2-RETURN                                07590099
106600             MOVE '2110-DC-NAME     ' TO PV-ABEND-PARA-NAME       07600099
106700             MOVE 'SELECT LOCATION NAME'                          07610099
106800                                      TO PV-DB2-OPERATION-MSG-1   07620099
106900             MOVE 'XLT_LOC'           TO PV-DB2-TABLE-1           07630099
106900             MOVE 'XLT_LOC_TYP_CDE'   TO PV-DB2-TABLE-2           07640099
                   MOVE XL071-SQLCA         TO SQLCA                    07650099
107000             PERFORM 9998-SQL-ABEND                               07660099
107100     END-EVALUATE.                                                07670099
                                                                        07680099
104000 2120-VENDOR-DATA.                                                07690099
104100     EXEC SQL                                                     07700099
104300         SELECT B.ENT_ID                                          07710099
                    , B.ENT_NAME_DESC                                   07720099
104600         INTO   :ENTNME-ENT-ID                                    07730099
104700              , :ENTNME-ENT-NAME-DESC                             07740099
104800         FROM   TPURCHS A                                         07750099
104800              , TENTNME B                                         07760099
104900         WHERE  A.PO_NBR         = :TRBNTF-PO-NBR                 07770099
105000           AND  A.VER_STATUS_CDE = 'A'                            07780099
                 AND  B.ENT_ID         = A.ENT_ID                       07790099
                 AND  B.TYPE_CDE       = '01'                           07800099
105100     END-EXEC.                                                    07810099
105200                                                                  07820000
105300     EVALUATE TRUE                                                07830099
105400         WHEN SQLCODE = +0                                        07840099
105500             MOVE ENTNME-ENT-ID        TO TM002-ENT-ID            07850099
105600             MOVE ENTNME-ENT-NAME-DESC TO TM002-ENT-NAME-DESC     07860099
105700         WHEN SQLCODE = +100                                      07870099
105500             MOVE SPACES               TO TM002-ENT-ID-X          07880099
                   MOVE 'NOT FOUND'          TO TM002-ENT-NAME-DESC     07890099
105800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07900099
105900             DISPLAY '*** SQLCODE +100, SELECT TPURCHS, TENTNME'  07910099
106100             DISPLAY '*** TTRBNTF PO      :' TRBNTF-PO-NBR        07920099
106200             DISPLAY '*** TTRBNTF REC SEQ :' TRBNTF-REC-SEQ-NBR   07930099
106300             DISPLAY '*** TTRBNTF TRBL RSN:' TRBNTF-TRBL-RSN-CDE  07940099
106400             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  07950099
106500         WHEN OTHER                                               07960099
106600             MOVE '2120-VENDER-DATA      ' TO PV-ABEND-PARA-NAME  07970099
106700             MOVE 'SELECT TPURCHS, TENTNME'                       07980099
106800                                      TO PV-DB2-OPERATION-MSG-1   07990099
106900             MOVE 'TPURCHS'           TO PV-DB2-TABLE-1           08000099
106900             MOVE 'TENTNME'           TO PV-DB2-TABLE-2           08010099
107000             PERFORM 9998-SQL-ABEND                               08020099
107100     END-EVALUATE.                                                08030099
                                                                        08040099
       2130-PACK-SKU-NBR.                                               08050099
107800     EXEC SQL                                                     08060099
107900         SELECT                                                   08070099
108700              PK_SKU_NBR                                          08080099
108100         INTO                                                     08090099
108200             :POPRPK-PK-SKU-NBR                                   08100099
108300         FROM                                                     08110099
108400             TPOPRPK                                              08120099
108500         WHERE                                                    08130099
108600             PO_NBR      = :TRBNTF-PO-NBR                         08140099
108000         AND PO_PREPK_ID = :TRBNTF-PREPK-ID                       08150099
108800     END-EXEC.                                                    08160099
105300     EVALUATE TRUE                                                08170099
105400         WHEN SQLCODE = +0                                        08180099
105500             MOVE POPRPK-PK-SKU-NBR  TO TM002-SKU-NBR             08190099
105700         WHEN SQLCODE = +100                                      08200099
105600             MOVE 'NOT FND '         TO TM002-SKU-NBR-X           08210099
105800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  08220099
105900             DISPLAY '*** SQLCODE +100, SELECT TPOPRPK'           08230099
106100             DISPLAY '*** TTRBNTF PO      :' TRBNTF-PO-NBR        08240099
106200             DISPLAY '*** TTRBNTF LINE    :' TRBNTF-PREPK-ID      08250099
106400             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  08260099
106500         WHEN OTHER                                               08270099
106600             MOVE '2130-PACK SKU-NBR' TO PV-ABEND-PARA-NAME       08280099
106700             MOVE 'SELECT TPOPRPK'                                08290099
106800                                      TO PV-DB2-OPERATION-MSG-1   08300099
106900             MOVE 'TPOPRPK'           TO PV-DB2-TABLE-1           08310099
107000             PERFORM 9998-SQL-ABEND                               08320099
107100     END-EVALUATE.                                                08330099
                                                                        08340099
       2140-SKU-USING-TPURITM.                                          08350099
090200     EXEC SQL                                                     08360099
090300         SELECT                                                   08370099
090400            ITM_NBR                                               08380099
090600         INTO                                                     08390099
090700           :PURITM-ITM-NBR                                        08400099
090900         FROM                                                     08410099
091100            TPURITM                                               08420099
091400        WHERE PO_NBR              = :TRBNTF-PO-NBR                08430099
091400          AND PO_LNE_NBR          = :TRBNTF-PO-LNE-NBR            08440099
091600          AND VER_STATUS_CDE      = 'A'                           08450099
091700     END-EXEC.                                                    08460099
105300     EVALUATE TRUE                                                08470099
105400         WHEN SQLCODE = +0                                        08480099
                   INITIALIZE XL001-ITEM-COMMAREA                       08490099
102810             MOVE PURITM-ITM-NBR     TO XL001-KEY-ITM-NBR         08500099
                   PERFORM 2144-FINISH-SKU-NBR                          08510099
105700         WHEN SQLCODE = +100                                      08520099
105600             MOVE 'NOT FND '         TO TM002-SKU-NBR-X           08530099
105800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  08540099
105900             DISPLAY '*** SQLCODE +100, SELECT TPURITM'           08550099
106100             DISPLAY '*** TTRBNTF PO      :' TRBNTF-PO-NBR        08560099
106200             DISPLAY '*** TTRBNTF LINE    :' TRBNTF-PO-LNE-NBR    08570099
106400             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  08580099
106500         WHEN OTHER                                               08590099
106600             MOVE '2140-SKU-USING-TPURITM'                        08600099
106600                                      TO PV-ABEND-PARA-NAME       08610099
106800             MOVE 'SELECT TPURITM'    TO PV-DB2-OPERATION-MSG-1   08620099
106900             MOVE 'TPURITM'           TO PV-DB2-TABLE-1           08630099
106900             MOVE SPACES              TO PV-DB2-TABLE-2           08640099
107000             PERFORM 9998-SQL-ABEND                               08650099
107100     END-EVALUATE.                                                08660099
       2142-SKU-USING-TRECITM.                                          08670099
090200     EXEC SQL                                                     08680099
090300         SELECT                                                   08690099
090400            ITM_NBR                                               08700099
090600         INTO                                                     08710099
090700           :RECITM-ITM-NBR                                        08720099
090900         FROM                                                     08730099
091100            TRECITM                                               08740099
091400        WHERE ORD_NBR             = :TRBNTF-PO-NBR                08750099
091400          AND REC_SEQ_NBR         = :TRBNTF-REC-SEQ-NBR           08760099
                AND PREPK_ID            = :TRBNTF-PREPK-ID              08770099
                AND PREPK_DRV_LNE_CDE   = 'A'                           08780099
091600          AND VER_STATUS_CDE      = 'A'                           08790099
091700     END-EXEC.                                                    08800099
105300     EVALUATE TRUE                                                08810099
105400         WHEN SQLCODE = +0                                        08820099
                   INITIALIZE XL001-ITEM-COMMAREA                       08830099
102810             MOVE RECITM-ITM-NBR     TO XL001-KEY-ITM-NBR         08840099
                   PERFORM 2144-FINISH-SKU-NBR                          08850099
105700         WHEN SQLCODE = +100                                      08860099
105600             MOVE 'NOT FND '         TO TM002-SKU-NBR-X           08870099
105800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  08880099
105900             DISPLAY '*** SQLCODE +100, SELECT TRECITM'           08890099
106100             DISPLAY '*** TTRBNTF PO      :' TRBNTF-PO-NBR        08900099
106200             DISPLAY '*** TTRBNTF REC SEQ :' TRBNTF-REC-SEQ-NBR   08910099
106200             DISPLAY '*** TTRBNTF PACK ID :' TRBNTF-PREPK-ID      08920099
106400             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  08930099
106500         WHEN OTHER                                               08940099
106600             MOVE '2142-SKU-USING-TPURITM'                        08950099
106600                                      TO PV-ABEND-PARA-NAME       08960099
106800             MOVE 'SELECT TRECITM'    TO PV-DB2-OPERATION-MSG-1   08970099
106900             MOVE 'TRECITM'           TO PV-DB2-TABLE-1           08980099
106900             MOVE SPACES              TO PV-DB2-TABLE-2           08990099
107000             PERFORM 9998-SQL-ABEND                               09000099
107100     END-EVALUATE.                                                09010099
       2144-FINISH-SKU-NBR.                                             09020099
102810     SET  XL001-BY-ITEM                                           09030099
102810          XL001-SELECT-SKU                                        09040099
                PS-XLKUT001-CALL      TO TRUE.                          09050099
102810                                                                  09060099
102810     CALL XL001-VSM-PGM USING XL001-ITEM-COMMAREA.                09070099
102810     EVALUATE TRUE                                                09080099
              WHEN XL001-SUCCESSFUL                                     09090099
108000             IF TRBNTF-TRBL-RSN-CDE = 805                         09100099
                       MOVE XL001-SKU-NBR   TO TM002-SKU-NBR            09110099
                   END-IF                                               09120099
              WHEN XL001-SKU-NOT-FOUND                                  09130099
108000             IF TRBNTF-TRBL-RSN-CDE = 805                         09140099
105600                 MOVE 'NOT FND '      TO TM002-SKU-NBR-X          09150099
                   END-IF                                               09160099
105800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  09170099
105900             DISPLAY '*** SQLCODE +100, XLT_SKU BY XLKUT001'      09180099
106100             DISPLAY '*** TTRBNTF PO      :' TRBNTF-PO-NBR        09190099
106200             DISPLAY '*** TTRBNTF LINE    :' TRBNTF-PO-LNE-NBR    09200099
106400             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  09210099
106500        WHEN OTHER                                                09220099
106600             MOVE '2144-FINISH-SKU-NBR'                           09230099
106600                                      TO PV-ABEND-PARA-NAME       09240099
106800             MOVE 'CALL XLKUT001'     TO PV-DB2-OPERATION-MSG-1   09250099
106900             MOVE 'XLK_SKU'           TO PV-DB2-TABLE-1           09260099
106900             MOVE SPACES              TO PV-DB2-TABLE-2           09270099
107000             PERFORM 9998-SQL-ABEND                               09280099
           END-EVALUATE.                                                09290099
           INITIALIZE PS-XLKUT001-CALL-SW.                              09300099
                                                                        09310099
086800 2150-OPEN-SU-AUDIT-CSR-805.                                      09320099
086900        EXEC SQL                                                  09330099
087000             OPEN SU-AUDIT-CSR-805                                09340099
087100        END-EXEC.                                                 09350099
087200                                                                  09360099
087300        EVALUATE TRUE                                             09370099
087400           WHEN SQLCODE = ZERO                                    09380099
087500                CONTINUE                                          09390099
087600           WHEN OTHER                                             09400099
087700                MOVE '2150-SU-AUDIT-CSR-805' TO PV-ABEND-PARA-NAME09410099
087800                MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-109420099
068200                MOVE 'SUT_PO_AUD_REQ'    TO PV-DB2-TABLE-1        09430099
087900                MOVE 'TSUAUPC'           TO PV-DB2-TABLE-2        09440099
088000                PERFORM 9998-SQL-ABEND                            09450099
088100        END-EVALUATE.                                             09460099
088300                                                                  09470099
104000 2152-SU-AUDIT-DATA-AND-OUT.                                      09480099
090200     EXEC SQL                                                     09490099
090300         FETCH  SU-AUDIT-CSR-805                                  09500099
                INTO :SUAUPC-AUD-CNTL-NBR                               09510099
                    ,:SUAUPC-UPC-NBR                                    09520099
                    ,:SUAUPC-AUD-USR-ID                                 09530099
091800     END-EXEC.                                                    09540099
091900                                                                  09550099
092000     EVALUATE TRUE                                                09560099
092100         WHEN SQLCODE = ZERO                                      09570099
                   MOVE SUAUPC-AUD-CNTL-NBR TO TM002-AUD-CNTL-NBR       09580099
                   MOVE SUAUPC-UPC-NBR      TO TM002-UPC-NBR            09590099
092200             PERFORM 2180-ASSOCIATE-NAME                          09600099
099800             WRITE TROUBLE-EXTRACT-RECORD FROM                    09610099
099900                                  TM002-TROUBLE-EXT-RECORD        09620099
100000             ADD  1                   TO PV-RECORD-COUNT          09630099
092300         WHEN SQLCODE = +100                                      09640099
092400             SET  PS-END-OF-SU-AUDIT  TO TRUE                     09650099
092500         WHEN OTHER                                               09660099
092400             SET  PS-END-OF-SU-AUDIT  TO TRUE                     09670099
092600             MOVE '2152-SU-AUDIT'     TO PV-ABEND-PARA-NAME       09680099
092700             MOVE 'FETCH SU-AUDIT-CSR'                            09690099
092800                                      TO PV-DB2-OPERATION-MSG-1   09700099
092900             MOVE 'SUT_PO_AUD_REQ'    TO PV-DB2-TABLE-1           09710099
092900             MOVE 'TSUAUPC'           TO PV-DB2-TABLE-2           09720099
093000             PERFORM 9998-SQL-ABEND                               09730099
093100     END-EVALUATE.                                                09740099
                                                                        09750099
088400 2154-CLOSE-SU-AUDIT-CSR-805.                                     09760099
088500        EXEC SQL                                                  09770099
088600            CLOSE SU-AUDIT-CSR-805                                09780099
088700        END-EXEC.                                                 09790099
                                                                        09800099
086800 2160-OPEN-SU-AUDIT-CSR-806.                                      09810099
086900        EXEC SQL                                                  09820099
087000             OPEN SU-AUDIT-CSR-806                                09830099
087100        END-EXEC.                                                 09840099
087200                                                                  09850099
087300        EVALUATE TRUE                                             09860099
087400           WHEN SQLCODE = ZERO                                    09870099
087500                CONTINUE                                          09880099
087600           WHEN OTHER                                             09890099
087700                MOVE '2160-SU-AUDIT-CSR-806' TO PV-ABEND-PARA-NAME09900099
087800                MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-109910099
068200                MOVE 'SUT_PO_AUD_REQ'    TO PV-DB2-TABLE-1        09920099
087900                MOVE 'TSUAUPC'           TO PV-DB2-TABLE-2        09930099
088000                PERFORM 9998-SQL-ABEND                            09940099
088100        END-EVALUATE.                                             09950099
088300                                                                  09960099
104000 2162-SU-AUDIT-DATA-AND-OUT.                                      09970099
090200     EXEC SQL                                                     09980099
090300         FETCH  SU-AUDIT-CSR-806                                  09990099
                INTO :SUAUPC-AUD-CNTL-NBR                               10000099
                    ,:SUAUPC-AUD-USR-ID                                 10010099
091800     END-EXEC.                                                    10020099
091900                                                                  10030099
092000     EVALUATE TRUE                                                10040099
092100         WHEN SQLCODE = ZERO                                      10050099
                   MOVE SPACES              TO TM002-UPC-NBR-X          10060099
                   MOVE SUAUPC-AUD-CNTL-NBR TO TM002-AUD-CNTL-NBR       10070099
092200             PERFORM 2180-ASSOCIATE-NAME                          10080099
099800             WRITE TROUBLE-EXTRACT-RECORD FROM                    10090099
099900                                  TM002-TROUBLE-EXT-RECORD        10100099
100000             ADD  1                   TO PV-RECORD-COUNT          10110099
092300         WHEN SQLCODE = +100                                      10120099
092400             SET  PS-END-OF-SU-AUDIT  TO TRUE                     10130099
092500         WHEN OTHER                                               10140099
092400             SET  PS-END-OF-SU-AUDIT  TO TRUE                     10150099
092600             MOVE '2162-SU-AUDIT-DATA-AND-OUT'                    10160099
092600                                      TO PV-ABEND-PARA-NAME       10170099
092700             MOVE 'FETCH SU-AUDIT-CSR'                            10180099
092800                                      TO PV-DB2-OPERATION-MSG-1   10190099
092900             MOVE 'SUT_PO_AUD_REQ'    TO PV-DB2-TABLE-1           10200099
092900             MOVE 'TSUAUPC'           TO PV-DB2-TABLE-2           10210099
093000             PERFORM 9998-SQL-ABEND                               10220099
093100     END-EVALUATE.                                                10230099
                                                                        10240099
088400 2164-CLOSE-SU-AUDIT-CSR-806.                                     10250099
088500        EXEC SQL                                                  10260099
088600            CLOSE SU-AUDIT-CSR-806                                10270099
088700        END-EXEC.                                                 10280099
086800 2170-OPEN-SU-AUDIT-CSR-804.                                      10290099
086900        EXEC SQL                                                  10300099
087000             OPEN SU-AUDIT-CSR-804                                10310099
087100        END-EXEC.                                                 10320099
087200                                                                  10330099
087300        EVALUATE TRUE                                             10340099
087400           WHEN SQLCODE = ZERO                                    10350099
087500                CONTINUE                                          10360099
087600           WHEN OTHER                                             10370099
087700                MOVE '2170-SU-AUDIT-CSR-804' TO PV-ABEND-PARA-NAME10380099
087800                MOVE 'OPEN CURSOR'       TO PV-DB2-OPERATION-MSG-110390099
068200                MOVE 'SUT_PO_AUD_REQ'    TO PV-DB2-TABLE-1        10400099
087900                MOVE 'TSUAUPC'           TO PV-DB2-TABLE-2        10410099
088000                PERFORM 9998-SQL-ABEND                            10420099
088100        END-EVALUATE.                                             10430099
088300                                                                  10440099
104000 2172-SU-AUDIT-DATA-AND-OUT.                                      10450099
090200     EXEC SQL                                                     10460099
090300         FETCH  SU-AUDIT-CSR-804                                  10470099
                INTO :SUAUPC-AUD-CNTL-NBR                               10480099
                    ,:SUAUPC-UPC-NBR                                    10490099
                    ,:SUAUPC-AUD-USR-ID                                 10500099
091800     END-EXEC.                                                    10510099
091900                                                                  10520099
092000     EVALUATE TRUE                                                10530099
092100         WHEN SQLCODE = ZERO                                      10540099
                   MOVE SUAUPC-UPC-NBR      TO TM002-UPC-NBR            10550099
                   MOVE SUAUPC-AUD-CNTL-NBR TO TM002-AUD-CNTL-NBR       10560099
092200             PERFORM 2180-ASSOCIATE-NAME                          10570099
099800             WRITE TROUBLE-EXTRACT-RECORD FROM                    10580099
099900                                  TM002-TROUBLE-EXT-RECORD        10590099
100000             ADD  1                   TO PV-RECORD-COUNT          10600099
092300         WHEN SQLCODE = +100                                      10610099
092400             SET  PS-END-OF-SU-AUDIT  TO TRUE                     10620099
092500         WHEN OTHER                                               10630099
092400             SET  PS-END-OF-SU-AUDIT  TO TRUE                     10640099
092600             MOVE '2172-SU-AUDIT-DATA-AND-OUT'                    10650099
092600                                      TO PV-ABEND-PARA-NAME       10660099
092700             MOVE 'FETCH SU-AUDIT-CSR'                            10670099
092800                                      TO PV-DB2-OPERATION-MSG-1   10680099
092900             MOVE 'SUT_PO_AUD_REQ'    TO PV-DB2-TABLE-1           10690099
092900             MOVE 'TSUAUPC'           TO PV-DB2-TABLE-2           10700099
093000             PERFORM 9998-SQL-ABEND                               10710099
093100     END-EVALUATE.                                                10720099
                                                                        10730099
088400 2174-CLOSE-SU-AUDIT-CSR-804.                                     10740099
088500        EXEC SQL                                                  10750099
088600            CLOSE SU-AUDIT-CSR-804                                10760099
088700        END-EXEC.                                                 10770099
                                                                        10780099
092200 2180-ASSOCIATE-NAME.                                             10790099
002000     INITIALIZE XL067-USER-COMMAREA                               10800099
           SET XL067-BY-USER-ID                                         10810099
               XL067-SELECT-KOHLS-USER TO TRUE                          10820099
125200     MOVE SUAUPC-AUD-USR-ID      TO XL067-KEY-USER-ID             10830099
001700     CALL XL067-USER-PGM USING XL067-USER-COMMAREA                10840099
125600     EVALUATE TRUE                                                10850099
               WHEN XL067-SUCCESSFUL                                    10860099
                   MOVE XL067-COMBINED-NAME-1 TO TM002-ASSOCIATE-NAME   10870099
105700         WHEN OTHER                                               10880099
105600             STRING SUAUPC-AUD-USR-ID ' NOT FOUND'                10890099
                       DELIMITED BY SIZE    INTO TM002-ASSOCIATE-NAME   10900099
105800             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  10910099
105900             DISPLAY '*** NOT FOUND USING XLKUT067'               10920099
105900             DISPLAY '*** RETURN CODE     : ' XL067-RETURN-CODE   10930099
106100             DISPLAY '*** TTRBNTF PO      : ' TRBNTF-PO-NBR       10940099
106200             DISPLAY '*** USER ID         : ' SUAUPC-AUD-USR-ID   10950099
106400             DISPLAY '* * * * * * * * * * * * * * * * * * * * *'  10960099
                                                                        10970099
107100     END-EVALUATE.                                                10980099
110000                                                                  10990099
110100 9100-CALL-DATE-MODULE.                                           11000099
110200     CALL DP500-KOHLS-CALENDAR-ROUTINE                            11010000
110300                           USING DPG51 DPG52 DPG53                11020000
110400                                 DPG54 DPG55 DPG56.               11030000
110500     IF  PV-PARA-NAME = '1110-SPECIAL-RUN'                        11040099
  0600       AND DPG54-DATE-INVALID                                     11050099
110700         CONTINUE                                                 11060099
110900     ELSE                                                         11070099
111100         EVALUATE TRUE                                            11080099
111200             WHEN DPG54-SEVERE-ERROR                              11090099
111300                 DISPLAY '** ABEND **'                            11100099
111400                 DISPLAY '** PGM = TMKUT014'                      11110099
111500                 DISPLAY PV-PARA-NAME                             11120099
111600             DISPLAY '** INVALID RETURN FROM CALENDAR ROUTINE. '  11130000
111700                 DISPLAY '** ERROR MESSAGE = '                    11140099
111800                     DPG54-ERROR-MESSAGE                          11150000
111900                 DISPLAY '** DPG51 = ' DPG51                      11160099
112000                 DISPLAY '** DPG52 = ' DPG52                      11170099
112100                 DISPLAY '** DPG53 = ' DPG53                      11180099
112200                 DISPLAY '** DPG54 = ' DPG54                      11190099
112300                 MOVE +4003 TO PV-ABEND-CODE                      11200099
112400                 CALL 'ILBOABN0' USING PV-ABEND-CODE              11210099
112500             WHEN OTHER                                           11220099
112600                 CONTINUE                                         11230099
112700         END-EVALUATE                                             11240099
           END-IF.                                                      11250099
112900                                                                  11260000
113000 9998-SQL-ABEND.                                                  11270000
113100     MOVE SQLCODE       TO PV-SQLCODE                             11280099
           IF XL071-BAD-DB2-RETURN                                      11290099
               MOVE XL071-SQLCODE TO PV-SQLCODE-X                       11300099
           END-IF.                                                      11310099
102810     IF PS-XLKUT001-CALL                                          11320099
             AND XL001-SKU-SQLCODE NOT = ZERO                           11330099
               MOVE XL001-SKU-SQLCODE TO PV-SQLCODE                     11340099
           END-IF.                                                      11350099
113200     DISPLAY '** ABEND           ** = SQLABEND'.                  11360000
113300     DISPLAY '** PROGRAM         ** = ' PC-PROGRAM-NAME.          11370000
113400     DISPLAY '** PARAGRAPH       ** = ' PV-ABEND-PARA-NAME        11380099
113500     DISPLAY '** TABLE 1         ** = ' PV-DB2-TABLE-1.           11390099
113500     DISPLAY '** TABLE 2         ** = ' PV-DB2-TABLE-2.           11400099
113600     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MSG-1.   11410099
113700     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MSG-2.   11420099
113800     DISPLAY '** SQLCODE         ** = ' PV-SQLCODE-X.             11430099
113900     COPY DPPD004.                                                11440099
114000                                                                  11450099
114100     MOVE +4013                  TO PV-ABEND-CODE.                11460099
114200     CALL 'ILBOABN0'   USING PV-ABEND-CODE.                       11470099
114400                                                                  11480099
114500 9999-ABORT.                                                      11490099
114600      DISPLAY 'PV-ABEND-CODE = ' PV-ABEND-CODE                    11500099
114700      CALL 'ILBOABN0'   USING PV-ABEND-CODE.                      11510099
114800                                                                  11520099
