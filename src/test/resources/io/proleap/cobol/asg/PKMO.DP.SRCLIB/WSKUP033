000100******************************************************************00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300******************************************************************00030000
000400 PROGRAM-ID.   WSKUP033.                                          00040000
000500 AUTHOR.       BUDDY BARNES.                                      00050000
000600 INSTALLATION. KOHLS DEPARTMENT STORES.                           00060000
000700 DATE-WRITTEN. AUG 2009.                                          00070016
000800 DATE-COMPILED.                                                   00080000
000900******************************************************************00090000
001000*          SURCHARGE MISMATCH UPDATE AND EXTRACT                  00100000
001100*                                                                 00110000
001420*-------------------------                                        00116000
001500* THE MODIFIED FIELDS ARE:                                        00117000
001600*-------------------------                                        00118000
001700*        EFF-END-TMST                                             00119000
002000******************************************************************00140000
002100 ENVIRONMENT DIVISION.                                            00150000
002200******************************************************************00160000
002300 CONFIGURATION SECTION.                                           00170000
002400 SOURCE-COMPUTER.        IBM-3090.                                00180000
002500 OBJECT-COMPUTER.        IBM-3090.                                00190000
002600                                                                  00200000
002700 INPUT-OUTPUT SECTION.                                            00210000
002800 FILE-CONTROL.                                                    00220000
002900     SELECT OUTPUT1-FILE                ASSIGN TO OUT01.          00230000
003700******************************************************************00310000
003800 DATA DIVISION.                                                   00320000
003900******************************************************************00330000
004000 FILE SECTION.                                                    00340000
004100                                                                  00350000
004200 FD  OUTPUT1-FILE                                                 00360000
004300     RECORDING MODE IS F                                          00370000
004400     LABEL RECORDS ARE STANDARD                                   00380000
004500     BLOCK CONTAINS 0 RECORDS.                                    00390000
004600 01  OUTPUT1-RECORD                 PIC X(100).                   00400018
004700                                                                  00410000
009000******************************************************************00840000
009100 WORKING-STORAGE SECTION.                                         00850000
009200******************************************************************00860000
021100                                                                  00861006
021200 01  DK-DATABASE-KEYS.                                            00862006
021400     05  DK-INTR-UPC-ID            PIC S9(09) COMP.               00864013
021100                                                                  00865006
009300 01  PS-PROGRAM-SWITCHES.                                         00870000
009400     05  PS-END-OF-SRCHRG-CSR-SW       PIC X(01) VALUE 'N'.       00910002
009500         88  PS-END-OF-SRCHRG-CSR-YES            VALUE 'Y'.       00920002
009600         88  PS-END-OF-SRCHRG-CSR-NO             VALUE 'N'.       00930002
009400     05  PS-COMPARE-SW                 PIC X(01) VALUE 'N'.       00931007
009500         88  PS-COMPARE-SW-YES                   VALUE 'Y'.       00932007
009600         88  PS-COMPARE-SW-NO                    VALUE 'N'.       00933007
012700                                                                  00940002
011000 01  PC-PROGRAM-CONSTANTS.                                        01070000
011100     05  PC-CURRENT-PROGRAM-NAME     PIC X(08)  VALUE 'WSKUP033'. 01080000
011200     05  PC-MAX-RETRIES              PIC S9(3)  VALUE +5 COMP-3.  01090000
012700                                                                  01240000
012800 01  PA-PROGRAM-ACCUMULATORS.                                     01250000
012900     05  PA-TOTALS.                                               01260000
013000         10 PA-TOTAL-RECS-READ       PIC S9(07) VALUE +0 COMP-3.  01270000
013000         10 PA-TOTAL-SURCHARGE-UPD   PIC S9(07) VALUE +0 COMP-3.  01271000
013100         10 PA-TOTAL-RECS-WRITTEN    PIC S9(07) VALUE +0 COMP-3.  01280000
013200                                                                  01290000
013300 01  PV-PROGRAM-VARIABLES.                                        01300000
013400     05  PV-RETRY-COUNTER            PIC S9(4)  VALUE +0 COMP.    01310000
013500     05  PV-SQLCODE                  PIC S9(9).                   01320000
013600     05  PV-DISPLAY-SQLCODE          PIC -------999.              01330000
013700     05  PV-ABEND-CODE               PIC S9(4)  VALUE +0          01340000
013800                                                       COMP SYNC. 01350000
013900     05  PV-ABEND-PROGRAM            PIC X(08)  VALUE 'WSKUP033'. 01360000
014000     05  PV-ABEND-PARAGRAPH          PIC X(25)  VALUE SPACES.     01370000
014100     05  PV-ABEND-OPERATION          PIC X(20)  VALUE SPACES.     01380000
014200     05  PV-ABEND-STRUCTURE-1        PIC X(08)  VALUE SPACES.     01390000
014300     05  PV-DB2-OPERATION-MESSAGE-1  PIC X(79)  VALUE SPACES.     01401003
013600     05  PV-DISPLAY-RECORD           PIC ZZZZZZZ999.              01402007
011500     05  PV-NULL-IND-1            PIC S9(4) VALUE +0 COMP.        01403008
015200                                                                  01490000
017400******************************************************************01710000
017500*  DB2 FORMATTED MESSAGE AREA                                     01720000
017600******************************************************************01730000
017700     COPY DPWS004.                                                01740000
017800                                                                  01750000
017400******************************************************************01750119
017500*  COPYBOOK FOR ITEM SURCHARGE MISMATCH RECORD                    01750219
017600******************************************************************01750319
017700     COPY WSRD057.                                                01751018
017800                                                                  01752018
017900******************************************************************01760000
018000*  COMMUNICATIONS AREA FOR DB2                                    01770000
018100******************************************************************01780000
018200     EXEC SQL                                                     01790000
018300         INCLUDE SQLCA                                            01800000
018400     END-EXEC.                                                    01810000
018500                                                                  01820000
018600******************************************************************01830000
018700*  DB2 TABLE DECLARATION - TWEBITM                                01840000
018900******************************************************************01860000
019000     EXEC SQL                                                     01870000
019100         INCLUDE TWEBITM                                          01880000
019200     END-EXEC.                                                    01880118
019300                                                                  01881018
019400******************************************************************01882018
019500*  DB2 TABLE DECLARATION - WST_SRCHRG_RECNCL TABLE                01883018
019700******************************************************************01885018
019800     EXEC SQL                                                     01886018
019900         INCLUDE WST00013                                         01887018
020000     END-EXEC.                                                    01888018
019300                                                                  01900000
019400******************************************************************01910000
019500*  DB2 TABLE DECLARATION - XLT_SKU TABLE                          01920020
019700******************************************************************01940000
019800     EXEC SQL                                                     01950000
019900         INCLUDE XLT00003                                         01960020
020000     END-EXEC.                                                    01970000
019300                                                                  01971020
019400******************************************************************01972020
019500*  DB2 TABLE DECLARATION - XLT_VND_STYL TABLE                     01973020
019700******************************************************************01974020
019800     EXEC SQL                                                     01975020
019900         INCLUDE XLT00004                                         01976020
020000     END-EXEC.                                                    01977020
020100                                                                  01980000
020200******************************************************************01990000
020300* COBOL CURSOR DELCARATION TO READ E-FULFILLMENT LOAD CONTROL    *02000000
020400******************************************************************02010000
020500     EXEC SQL                                                     02020000
020600       DECLARE SRCHRG-CSR CURSOR WITH HOLD FOR                    02030002
020700        SELECT INTR_UPC_ID                                        02040002
020800             , EFF_END_TMST                                       02050001
020800             , SHIP_SRCHG_FEE_AMT                                 02051002
020800             , CUBE_SRCHG_FEE_AMT                                 02052002
020900          FROM WST_SRCHRG_RECNCL                                  02060002
021000         WHERE EFF_END_TMST IS NULL                               02070002
021500        FOR UPDATE OF EFF_END_TMST                                02120000
021600     END-EXEC.                                                    02130000
021700                                                                  02140000
022900******************************************************************02260000
023000 LINKAGE SECTION.                                                 02270000
023100******************************************************************02280000
023300                                                                  02300000
023400******************************************************************02310002
023500 PROCEDURE DIVISION.                                              02320000
023600******************************************************************02330000
023700 0000-PROGRAM-MAINLINE.                                           02340000
023800     DISPLAY '************ START OF WSKUP033 ***************'     02350000
024000     PERFORM 1000-INITIALIZE.                                     02360002
024300     PERFORM 2000-PROCESS-OUTPUT-RECORDS.                         02370002
           PERFORM 9000-EOJ-ROUTINE.                                    02371003
024700     CLOSE OUTPUT1-FILE.                                          02380002
023920     DISPLAY '************  END OF WSKUP033  ***************'     02420002
023930     STOP RUN.                                                    02431002
024413                                                                  02440000
028500******************************************************************02730000
028600*                                                                *02740000
028700*                I N I T I A L I Z A T I O N                     *02750000
028800*                                                                *02760000
028900******************************************************************02770000
029000 1000-INITIALIZE.                                                 02780000
029100                                                                  02790000
029200*INIT COUNTERS.                                                   02800000
029300     INITIALIZE PA-TOTAL-RECS-READ                                02810000
029400                PA-TOTAL-RECS-WRITTEN                             02820000
029410                PA-TOTAL-SURCHARGE-UPD.                           02830002
029500                                                                  02840000
031100     OPEN OUTPUT OUTPUT1-FILE.                                    03040002
031300                                                                  03060000
034300******************************************************************03360000
034400*                                                                *03370000
034500*        P R O C E S S   I N P U T 1   R E C O R D S             *03380000
034600*                                                                *03390000
034700******************************************************************03400000
034800 2000-PROCESS-OUTPUT-RECORDS.                                     03410000
034900                                                                  03420000
035000     PERFORM 2100-OPEN-SRCHRG-CURSOR.                             03430002
035100                                                                  03440000
035200     PERFORM 2200-FETCH-SRCHRG-CURSOR                             03450002
035300         UNTIL                                                    03460002
035400            PS-END-OF-SRCHRG-CSR-YES.                             03470002
037000                                                                  03670003
037400     PERFORM 2800-COMMIT.                                         03710003
038100                                                                  03780003
038200     PERFORM 2500-CLOSE-SRCHRG-CURSOR.                            03790002
038300                                                                  03800000
038400******************************************************************03810000
038500 2100-OPEN-SRCHRG-CURSOR.                                         03820002
038600                                                                  03830000
038700     EXEC SQL                                                     03840000
038800         OPEN SRCHRG-CSR                                          03850002
038900     END-EXEC.                                                    03860000
039000                                                                  03870000
039100     EVALUATE TRUE                                                03880000
039200       WHEN SQLCODE = ZERO                                        03890000
039300           SET PS-END-OF-SRCHRG-CSR-NO  TO TRUE                   03900007
039400                                                                  03910000
039500       WHEN OTHER                                                 03920000
039600           MOVE '2100-OPEN-SRCHRG-CURSOR'                         03930002
039700                                 TO PV-ABEND-PARAGRAPH            03940000
039800           MOVE 'OPEN SRCHRG-CSR' TO PV-ABEND-OPERATION           03950002
039900           PERFORM 9900-DB2-ABEND                                 03960000
040000     END-EVALUATE.                                                03970000
040100                                                                  03980000
040200******************************************************************03990000
040300 2200-FETCH-SRCHRG-CURSOR.                                        04000005
040400                                                                  04010000
040500     EXEC SQL                                                     04020000
040600         FETCH SRCHRG-CSR                                         04030002
040700          INTO :WST00013-INTR-UPC-ID                              04040002
040800             , :WST00013-EFF-END-TMST :PV-NULL-IND-1              04050008
040800             , :WST00013-SHIP-SRCHG-FEE-AMT                       04051002
040800             , :WST00013-CUBE-SRCHG-FEE-AMT                       04052002
040900     END-EXEC.                                                    04060000
041000                                                                  04070000
041100     EVALUATE TRUE                                                04080000
041200       WHEN SQLCODE = ZERO                                        04090000
059700           ADD +1   TO PA-TOTAL-RECS-READ                         04100005
                 MOVE WST00013-INTR-UPC-ID TO DK-INTR-UPC-ID            04101105
                 PERFORM 2300-GET-TWEBITM                               04101205
                 IF PS-COMPARE-SW-NO                                    04101418
                     CONTINUE                                           04102005
                 ELSE                                                   04102105
                     IF WEBITM-SHIP-SRCHG-FEE-AMT                       04102205
                            = WST00013-CUBE-SRCHG-FEE-AMT               04102310
037100                   PERFORM 2400-UPDATE-EFF-END-TMST               04102407
                     ELSE                                               04102505
                         PERFORM 2600-GET-XLT-SKU                       04102618
                         PERFORM 3400-WRITE-OUTPUT-FILE                 04102705
                     END-IF                                             04102805
                 END-IF                                                 04102905
037200                                                                  04104003
041500       WHEN SQLCODE = +100                                        04120000
041600           SET PS-END-OF-SRCHRG-CSR-YES TO TRUE                   04130007
041700                                                                  04140000
041800       WHEN OTHER                                                 04150000
041900           MOVE '2200-FETCH-SRCHRG-CURSOR'                        04160002
042000                                  TO PV-ABEND-PARAGRAPH           04170000
042100           MOVE 'FETCH SRCHRG-CSR' TO PV-ABEND-OPERATION          04180002
042200           PERFORM 9900-DB2-ABEND                                 04190000
042300     END-EVALUATE.                                                04200000
041700                                                                  04200105
144300***************************************************************** 04201005
144400 2300-GET-TWEBITM.                                                04202005
145100     EXEC SQL                                                     04209005
145200        SELECT INTR_UPC_ID                                        04209105
146800             , SHIP_WD_QTY                                        04210718
146800             , SHIP_DPTH_QTY                                      04210818
146800             , SHIP_HT_QTY                                        04210918
146800             , SHIP_WT_QTY                                        04211018
146800             , SHIP_SRCHG_FEE_AMT                                 04211118
147800          INTO :WEBITM-INTR-UPC-ID                                04211705
149400             , :WEBITM-SHIP-WD-QTY                                04213418
149400             , :WEBITM-SHIP-DPTH-QTY                              04213518
149400             , :WEBITM-SHIP-HT-QTY                                04213618
149400             , :WEBITM-SHIP-WT-QTY                                04213718
149400             , :WEBITM-SHIP-SRCHG-FEE-AMT                         04213818
150400          FROM TWEBITM                                            04214305
150500         WHERE INTR_UPC_ID  = :DK-INTR-UPC-ID                     04214405
150600           AND EFF_END_TMST IS NULL                               04214509
150700     END-EXEC.                                                    04214605
150800                                                                  04214705
150900     EVALUATE TRUE                                                04214805
151000       WHEN SQLCODE = ZERO                                        04214905
151400           SET PS-COMPARE-SW-YES TO TRUE                          04215007
151200                                                                  04215205
151300       WHEN SQLCODE = +100                                        04215305
151400           SET PS-COMPARE-SW-NO TO TRUE                           04215407
152400                                                                  04216305
152500       WHEN OTHER                                                 04216405
039600           MOVE '2300-GET-TWEBITM       '                         04216505
039700                                 TO PV-ABEND-PARAGRAPH            04216605
039800           MOVE 'SELECT TWEBITM ' TO PV-ABEND-OPERATION           04216705
039900           PERFORM 9900-DB2-ABEND                                 04216805
153900                                                                  04218205
154000     END-EVALUATE.                                                04218305
042400                                                                  04219000
042500******************************************************************04220000
046000 2400-UPDATE-EFF-END-TMST.                                        04570002
046100                                                                  04580000
046200     EXEC SQL                                                     04590000
046300         UPDATE WST_SRCHRG_RECNCL                                 04600002
046500            SET EFF_END_TMST = CURRENT TIMESTAMP                  04620002
046600          WHERE CURRENT OF SRCHRG-CSR                             04630002
046700     END-EXEC.                                                    04640000
046800                                                                  04650000
046900     EVALUATE TRUE                                                04660000
047000       WHEN SQLCODE = ZERO                                        04670000
047100           ADD +1 TO PA-TOTAL-SURCHARGE-UPD                       04680002
047200                                                                  04690000
047300       WHEN OTHER                                                 04700000
047400           MOVE '2400-UPDATE-EFF-END-TMST'                        04710002
047500                                      TO PV-ABEND-PARAGRAPH       04720000
047600           MOVE 'UPDATE WST_SRCHRG' TO PV-ABEND-OPERATION         04730002
047700           PERFORM 9900-DB2-ABEND                                 04740000
047800     END-EVALUATE.                                                04750000
047900                                                                  04760000
048000******************************************************************04770000
048100 2500-CLOSE-SRCHRG-CURSOR.                                        04780002
048200                                                                  04790000
048300     EXEC SQL                                                     04800000
048400         CLOSE SRCHRG-CSR                                         04810002
048500     END-EXEC.                                                    04820000
048600                                                                  04830000
048700     EVALUATE TRUE                                                04840000
048800       WHEN SQLCODE = ZERO                                        04850000
048900           CONTINUE                                               04860000
049000                                                                  04870000
049100       WHEN OTHER                                                 04880000
049200           MOVE '2500-CLOSE-SRCHRG-CURSOR'                        04890002
049300                                  TO PV-ABEND-PARAGRAPH           04900000
049400           MOVE 'CLOSE SRCHRG-CSR' TO PV-ABEND-OPERATION          04910002
049500           PERFORM 9900-DB2-ABEND                                 04920000
049600     END-EVALUATE.                                                04930000
049700                                                                  04940000
552400****************************************************************  04941018
552700* GET THE SKU NBR, SKU DESC, DEPT                                 04942018
552800****************************************************************  04943018
552900 2600-GET-XLT-SKU.                                                04944018
553300                                                                  04945018
      ***  MOVE WS057-INTR-UPC-ID TO DK-INTR-UPC-ID.                    04946022
                                                                        04948018
553300     EXEC SQL                                                     04949018
553300        SELECT  A.SKU_NBR                                         04949119
553300               ,A.SKU_DESC                                        04949219
553300               ,B.DEPT_NBR                                        04949319
553300         INTO  :XLT00003-SKU-NBR                                  04949418
553300              ,:XLT00003-SKU-DESC                                 04949518
553300              ,:XLT00004-DEPT-NBR                                 04949618
553300         FROM   XLT_SKU A, XLT_VND_STYL B                         04949718
553300        WHERE   A.INTR_UPC_ID = :DK-INTR-UPC-ID                   04949819
553300          AND   A.STYL_ID   = B.STYL_ID                           04949919
053300     END-EXEC.                                                    04950018
553300                                                                  04950118
000693     EVALUATE TRUE                                                04950218
000694         WHEN SQLCODE = 0                                         04950318
000696             MOVE XLT00003-SKU-NBR     TO WS057-SKU-NBR           04950418
000696             MOVE XLT00003-SKU-DESC    TO WS057-SKU-DESC          04950518
000696             MOVE XLT00004-DEPT-NBR    TO WS057-DEPT              04950619
000694         WHEN SQLCODE = +100                                      04950719
000696             MOVE 'UNKNOWN'    TO WS057-SKU-DESC                  04950918
000728         WHEN OTHER                                               04951218
000729             MOVE SQLCODE TO PV-SQLCODE                           04951321
000729             MOVE PV-SQLCODE TO PV-DISPLAY-SQLCODE                04951421
000730             DISPLAY '******************************************' 04951520
000731             DISPLAY '* ABEND                                   ' 04951620
000732             DISPLAY '* PROGRAM = WSKUP033                      ' 04951720
000733             DISPLAY '* PARAGRAPH = 2600-GET-XLTSKU'              04951820
000735             DISPLAY '** SQLCODE   = ' PV-DISPLAY-SQLCODE         04951920
000736             DISPLAY '******************************************' 04952020
000737             PERFORM 9900-DB2-ABEND                               04952120
000738     END-EVALUATE.                                                04952220
553300                                                                  04952320
049800******************************************************************04953000
049900 2800-COMMIT.                                                     04960000
050000                                                                  04970000
050100     EXEC SQL                                                     04980000
050200         COMMIT                                                   04990000
050300     END-EXEC.                                                    05000000
050400                                                                  05010000
050500     EVALUATE TRUE                                                05020000
050600       WHEN SQLCODE = ZERO                                        05030000
050700           CONTINUE                                               05040000
050800                                                                  05050000
050900       WHEN OTHER                                                 05060000
051000           MOVE '2800-COMMIT'         TO PV-ABEND-PARAGRAPH       05070000
051100           MOVE 'COMMIT WST_SRCHRG  ' TO PV-ABEND-OPERATION       05080002
051200           PERFORM 9900-DB2-ABEND                                 05090000
051300     END-EVALUATE.                                                05100000
051400                                                                  05110000
051500******************************************************************05120000
051600******************************************************************05130000
059000 3400-WRITE-OUTPUT-FILE.                                          05870000
059200     MOVE WST00013-INTR-UPC-ID                                    05890003
059300                           TO WS057-INTR-UPC-ID.                  05900018
059400     MOVE WEBITM-SHIP-SRCHG-FEE-AMT                               05910011
059300                           TO WS057-SHIP-SRCHG-FEE-AMT.           05911018
059400     MOVE WEBITM-SHIP-WD-QTY                                      05911118
059300                           TO WS057-ITEM-WIDTH.                   05911218
059400     MOVE WEBITM-SHIP-DPTH-QTY                                    05911318
059300                           TO WS057-ITEM-LENGTH.                  05911418
059400     MOVE WEBITM-SHIP-HT-QTY                                      05911518
059300                           TO WS057-ITEM-HEIGHT.                  05911618
059400     MOVE WEBITM-SHIP-WT-QTY                                      05911718
059300                           TO WS057-ITEM-WEIGHT.                  05911818
059400     MOVE WST00013-CUBE-SRCHG-FEE-AMT                             05912118
059300                           TO WS057-CUBE-SRCHG-FEE-AMT.           05913018
059500     WRITE OUTPUT1-RECORD                                         05920003
059600         FROM WS057-ITEM-SURCHARGE-RECORD                         05930018
059700         ADD +1   TO PA-TOTAL-RECS-WRITTEN.                       05940003
059900                                                                  05960000
066600******************************************************************06630000
066700*                                                                *06640000
066800*                   E O J   P R O C E S S I N G                  *06650000
066900*                                                                *06660000
067000******************************************************************06670000
067100 9000-EOJ-ROUTINE.                                                06680000
067200                                                                  06690000
067300      DISPLAY ' '.                                                06700000
067400      DISPLAY '*********************************************'.    06710000
067700      DISPLAY '       -------------------------     '.            06720002
067800      DISPLAY '       SURCHARGE MISMATCH TOTALS     '.            06730002
067900      DISPLAY '       -------------------------     '.            06740002
068000      MOVE PA-TOTAL-RECS-READ              TO PV-DISPLAY-RECORD.  06750000
068100      DISPLAY '      TOTAL RECORDS READ    =' PV-DISPLAY-RECORD.  06760000
068200      DISPLAY ' '.                                                06770000
068300      MOVE PA-TOTAL-RECS-WRITTEN           TO PV-DISPLAY-RECORD.  06780000
068400      DISPLAY '      TOTAL RECORDS WRITTEN =' PV-DISPLAY-RECORD.  06790000
068200      DISPLAY ' '.                                                06791002
068300      MOVE PA-TOTAL-SURCHARGE-UPD          TO PV-DISPLAY-RECORD.  06792002
068400      DISPLAY '      TOT SURCHARGE UPDATES =' PV-DISPLAY-RECORD.  06793002
068500      DISPLAY '*********************************************'.    06800000
068600      DISPLAY ' '.                                                06810000
068700                                                                  06820000
068800******************************************************************06830000
068900* 9900-DB2-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      06840000
069000* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 06850000
069100******************************************************************06860000
069200 9900-DB2-ABEND.                                                  06870000
069300                                                                  06880000
069400     MOVE SQLCODE    TO PV-SQLCODE.                               06890000
069500     MOVE PV-SQLCODE TO PV-DISPLAY-SQLCODE.                       06900000
069600     DISPLAY '*** DB2 ERROR ***'.                                 06910000
069700     DISPLAY '*** SQLCODE   = ' PV-DISPLAY-SQLCODE.               06920000
069800     DISPLAY '*** PROGRAM   = ' PV-ABEND-PROGRAM.                 06930000
069900     DISPLAY '*** PARAGRAPH = ' PV-ABEND-PARAGRAPH.               06940000
070000     DISPLAY '*** OPERATION = ' PV-ABEND-OPERATION.               06950000
070100     DISPLAY '*** MESSAGE   = ' PV-DB2-OPERATION-MESSAGE-1.       06960000
070200     DISPLAY '*** TABLE 1   = ' PV-ABEND-STRUCTURE-1.             06970000
070300                                                                  06980000
070400******************************************************************06990000
070500* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    07000000
070600* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         07010000
070700* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     07020000
070800* FORMAT.                                                         07030000
070900******************************************************************07040000
071000     COPY DPPD004.                                                07050000
071100                                                                  07060000
071200     IF SQLCODE NOT = -911                                        07070000
071300         EXEC SQL                                                 07080000
071400             ROLLBACK                                             07090000
071500         END-EXEC                                                 07100000
071600     END-IF.                                                      07110000
071700                                                                  07120000
071800     MOVE +4013         TO PV-ABEND-CODE.                         07130000
071900     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         07140000
072000******************************************************************07150000
072100******************************************************************07160000
