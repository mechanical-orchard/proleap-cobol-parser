000100******************************************************************00010002
000200 IDENTIFICATION DIVISION.                                         00020002
000300******************************************************************00030002
000400                                                                  00040002
000500 PROGRAM-ID.             ARKUT108.                                00050002
000600 AUTHOR.                 JAMES ALT.                               00060002
000700 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00070002
000800 DATE-WRITTEN            06/14/2013.                              00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100******************************************************************00110086
001200*  THIS PROGRAM READS IN THE EVOLVE ACTIVITY FILE RECEIVED FROM   00120086
001300*  FIRST DATA AND SELECTS ALL RECORDS WITH A PROMISE SECURED      00130086
001400*  DURING A GIVEN TIME PERIOD.  THE RECORDS ARE SUMMARIZED BY     00140086
001500*  THE AGENT WHO SECURED THE PROMISE.  FOR EACH AGENT, A COMMA-   00150086
001600*  DELIMITED RECORD IS WRITTEN FOR PROCESSING BY A THIRD-PARTY    00160086
001700*  VENDOR. THE RECORD CONTAINS THE PROMISE DATE, AGENT ID AND     00170086
001800*  NUMBER OF PROMISES SECURED ALONG WITH SOME STATIC INFORMATION. 00180086
001900******************************************************************00190086
002000*CHANGES:                                                         00200099
002100*06/14/2013  JAMES ALT                                            00210099
002200*            CREATED PROGRAM -- CHG0056702                        00220099
002300*08/09/2013  JAMES ALT                                            00230099
002400*            SET RETURN CODE TO 4095 IF THERE IS NO OUTPUT        00240099
002500*            CHG0059980                                           00250099
      *06/12/2014  BASKARAN SRINIVASAN                                  00260099
      *            SKIP BAD RECORD FROM PROMISES SECURED FILE IF NO     00270099
      *            AGENT ACTIVITY                                       00280099
      *            CHG0083835                                           00290099
      *08/18/2015  SUSHANTO HALDER - COGNIZANT                          00291099
      *            CHANGED FTP PARAMETER TO MFT PARAMETERS IN PROGRAM   00292099
      *            CHG0119022                                           00294099
002600******************************************************************00300002
002700                                                                  00310002
002800******************************************************************00320002
002900 ENVIRONMENT DIVISION.                                            00330002
003000******************************************************************00340002
003100                                                                  00350002
003200 CONFIGURATION SECTION.                                           00360002
003300                                                                  00370002
003400 SOURCE-COMPUTER.        IBM-3090.                                00380002
003500 OBJECT-COMPUTER.        IBM-3090.                                00390002
003600                                                                  00400002
003700 INPUT-OUTPUT SECTION.                                            00410002
003800                                                                  00420002
003900 FILE-CONTROL.                                                    00430002
004000                                                                  00440002
004100      SELECT EVOLVE-ACTIVITY-FILE   ASSIGN TO INP01.              00450083
004200      SELECT CONTROL-DATE-FILE      ASSIGN TO UPD01.              00460053
004300      SELECT PROMISES-SECURED-FILE  ASSIGN TO OUT01.              00470052
004400      SELECT MFT-FILE               ASSIGN TO OUT02.              00480099
004500                                                                  00490002
004600******************************************************************00500002
004700 DATA DIVISION.                                                   00510002
004800******************************************************************00520002
004900                                                                  00530002
005000 FILE SECTION.                                                    00540002
005100 FD  EVOLVE-ACTIVITY-FILE                                         00550083
005200     LABEL RECORDS ARE STANDARD                                   00560002
005300     RECORDING MODE IS F                                          00570007
005400     BLOCK CONTAINS 0 RECORDS                                     00580002
005500     RECORD CONTAINS 192 CHARACTERS                               00590007
005600     DATA RECORD IS EVOLVE-ACTIVITY-RECORD.                       00600095
005700                                                                  00610020
005800 01  EVOLVE-ACTIVITY-RECORD          PIC  X(192).                 00620095
005900                                                                  00630002
006000 FD  CONTROL-DATE-FILE                                            00640054
006100     LABEL RECORDS ARE STANDARD                                   00650053
006200     RECORDING MODE IS F                                          00660053
006300     BLOCK CONTAINS 0 RECORDS                                     00670053
006400     RECORD CONTAINS 80 CHARACTERS                                00680053
006500     DATA RECORD IS AR092-RECORD.                                 00690084
006600                                                                  00700053
006700     COPY ARRD092.                                                00710055
006800                                                                  00720053
006900 FD  PROMISES-SECURED-FILE                                        00730052
007000     LABEL RECORDS ARE STANDARD                                   00740002
007100     RECORDING MODE IS F                                          00750007
007200     BLOCK CONTAINS 0 RECORDS                                     00760002
007300     RECORD CONTAINS 69 CHARACTERS                                00770099
007400     DATA RECORD IS PROMISES-SECURED-RECORD.                      00780095
007500                                                                  00790002
007600 01  PROMISES-SECURED-RECORD         PIC  X(69).                  00800099
007700                                                                  00810002
007800 FD  MFT-FILE                                                     00820099
007900     LABEL RECORDS ARE STANDARD                                   00830098
008000     RECORDING MODE IS F                                          00840098
008100     BLOCK CONTAINS 0 RECORDS                                     00850098
008200     RECORD CONTAINS 80 CHARACTERS                                00860098
008300     DATA RECORD IS MFT-RECORD.                                   00870099
008400                                                                  00880098
008500 01  MFT-RECORD                      PIC  X(80).                  00890099
008600                                                                  00900098
008700*------------------------------------------------------*          00910002
008800 WORKING-STORAGE SECTION.                                         00920002
008900*------------------------------------------------------*          00930002
009000 01  ABEND-CODE                  PIC S9(04)         VALUE ZERO    00940099
009100                                 COMP SYNC.                       00950002
009200                                                                  00960002
009300 01 PC-PROGRAM-CONSTANTS.                                         00970003
009400    05 PC-PROGRAM-NAME               PIC  X(08) VALUE 'ARKUT108'. 00980003
009500                                                                  00990003
009600 01 PV-PROGRAM-VARIABLES.                                         01000002
009700    05 PV-INPUT-COUNT                PIC  9(09) VALUE ZERO.       01010099
009800    05 PV-BYPASS-COUNT               PIC  9(09) VALUE ZERO.       01020099
009900    05 PV-PROCESS-COUNT              PIC  9(09) VALUE ZERO.       01030099
010000    05 PV-WRITE-COUNT                PIC  9(09) VALUE ZERO.       01040099
010100    05 PV-HEADER-COUNT               PIC  9(09) VALUE ZERO.       01050099
010200    05 PV-DETAIL-COUNT               PIC  9(09) VALUE ZERO.       01060099
010300    05 PV-TRAILER-COUNT              PIC  9(09) VALUE ZERO.       01070099
010400    05 PV-TRANSACTION-COUNT          PIC  9(09) VALUE ZERO.       01080099
010500    05 PV-DISPLAY-COUNT              PIC  ZZZ,ZZZ,ZZ9.            01090003
010600    05 PV-PROMISES-COUNT             PIC  9(04) VALUE ZERO.       01100099
010700    05 PV-ABEND-CODE                 PIC  9(04) VALUE ZERO.       01110099
010800    05 PV-ABEND-PARA-NAME            PIC  X(30) VALUE SPACE.      01120024
010900    05 PV-PARAGRAPH-NAME             PIC  X(30) VALUE SPACE.      01130024
011000    05 PV-OPERATION-MSG-1            PIC  X(50) VALUE SPACE.      01140069
011100    05 PV-OPERATION-MSG-2            PIC  X(50) VALUE SPACE.      01150069
011200    05 PV-OPER                       PIC  X(08) VALUE SPACE.      01160039
011300    05 PV-ACTVTY-FILE-DATE           PIC  X(10) VALUE SPACE.      01170099
011400    05 PV-WORLD-FILE-DATE            PIC  X(10) VALUE SPACE.      01180099
011500    05 PV-SAVE-DT.                                                01190080
011600       10 PV-SAVE-YEAR               PIC  9(04) VALUE ZERO.       01200099
011700       10 PV-SAVE-MONTH              PIC  9(02) VALUE ZERO.       01210099
011800       10 PV-SAVE-DAY                PIC  9(02) VALUE ZERO.       01220099
011900    05 PV-ENTR-DT.                                                01230080
012000       10 PV-ENTR-YEAR               PIC  9(04) VALUE ZERO.       01240099
012100       10 PV-ENTR-MONTH              PIC  9(02) VALUE ZERO.       01250099
012200       10 PV-ENTR-DAY                PIC  9(02) VALUE ZERO.       01260099
012300    05 PV-ENTR-DT-FMT.                                            01270077
012400       10 PV-ENTR-MONTH-FMT          PIC  9(02) VALUE ZERO.       01280099
012500       10 FILLER                     PIC  X(01) VALUE '/'.        01290078
012600       10 PV-ENTR-DAY-FMT            PIC  9(02) VALUE ZERO.       01300099
012700       10 FILLER                     PIC  X(01) VALUE '/'.        01310078
012800       10 PV-ENTR-YEAR-FMT           PIC  9(04) VALUE ZERO.       01320099
012900    05 PV-ISO-DATE                   PIC  9(08) VALUE ZERO.       01330099
013000                                                                  01340002
013100 01 PS-PROGRAM-SWITCHES.                                          01350002
013200    05 PS-END-OF-PTP-FILE-IND        PIC  X(01) VALUE 'N'.        01360099
013300       88 PS-END-OF-PTP-FILE                    VALUE 'Y'.        01370099
013400       88 PS-NOT-END-OF-PTP-FILE                VALUE 'N'.        01380099
013500    05 PS-END-OF-CDF-FILE-IND        PIC  X(01) VALUE 'N'.        01390099
013600       88 PS-END-OF-CDF-FILE                    VALUE 'Y'.        01400099
013700       88 PS-NOT-END-OF-CDF-FILE                VALUE 'N'.        01410099
013800    05 PS-ERROR-FOUND-IND            PIC  X(01) VALUE 'N'.        01420094
013900       88 PS-ERROR-FOUND                        VALUE 'Y'.        01430099
014000       88 PS-ERROR-NOT-FOUND                    VALUE 'N'.        01440024
014100    05 PS-FIRST-TIME-IND             PIC  X(01) VALUE 'Y'.        01450099
014200       88 PS-FIRST-TIME                         VALUE 'Y'.        01460099
014300       88 PS-NOT-FIRST-TIME                     VALUE 'N'.        01470099
014400    05 PS-WRITE-HEADER-ONLY-IND      PIC  X(01) VALUE 'N'.        01480099
014500       88 PS-WRITE-HEADER-ONLY                  VALUE 'Y'.        01490099
014600       88 PS-DO-NOT-WRITE-HEADER-ONLY           VALUE 'N'.        01500099
014700                                                                  01510002
014800 01 CD-CURRENT-DATE.                                              01520099
014900    05 CD-CURRENT-YEAR               PIC  9(02) VALUE ZERO.       01530099
015000    05 CD-CURRENT-MONTH              PIC  9(02) VALUE ZERO.       01540099
015100    05 CD-CURRENT-DAY                PIC  9(02) VALUE ZERO.       01550099
015200                                                                  01560099
015300 01 CT-CURRENT-TIME.                                              01570099
015400    05 CT-CURRENT-HOUR               PIC  9(02) VALUE ZERO.       01580099
015500    05 CT-CURRENT-MINUTE             PIC  9(02) VALUE ZERO.       01590099
015600    05 CT-CURRENT-SECOND             PIC  9(02) VALUE ZERO.       01600099
015700    05 FILLER                        PIC  X(02).                  01610099
015800                                                                  01620099
015900     COPY ARRD090.                                                01630049
016000                                                                  01640020
016100     COPY DPWS500.                                                01650023
016200                                                                  01660098
016300 01 PV-MFT-RECORD.                                                01670099
016400    05 FILLER                        PIC  X(17)                   01680099
016500                                     VALUE 'SET %DIR1 = %DIR1'.   01690099
016600    05 FILLER                        PIC  X(23)                   01700099
016700                            VALUE ' + "PromisesSecuredRMO-'.      01710099
016800    05 MFT-DATE-TIME.                                             01720099
016900       10 MFT-DATE.                                               01730099
017000          15 FILLER                  PIC  X(02)  VALUE '20'.      01740099
017100          15 MFT-YEAR                PIC  X(02).                  01750099
017200          15 MFT-MONTH               PIC  X(02).                  01760099
017300          15 MFT-DAY                 PIC  X(02).                  01770099
017400       10 MFT-TIME.                                               01780099
017500          15 MFT-HOUR                PIC  X(02).                  01790099
017600          15 MFT-MINUTE              PIC  X(02).                  01800099
017700          15 MFT-SECOND              PIC  X(02).                  01810099
017800    05 FILLER                        PIC  X(01)  VALUE '-'.       01820099
017900    05 MFT-COUNT                     PIC  9(05)  VALUE ZERO.      01830099
018000    05 FILLER                        PIC  X(05)                   01840099
018100                                   VALUE '.csv"'.                 01850099
018200    05 FILLER                        PIC  X(15)  VALUE SPACE.     01860099
018300                                                                  01870098
018400********************************************************          01880015
018500 PROCEDURE DIVISION.                                              01890002
018600********************************************************          01900002
018700 0000-MAIN-LINE.                                                  01910002
018800                                                                  01920002
018900     PERFORM 1000-INITIALIZATION.                                 01930002
019000     PERFORM 2000-PROCESS-INPUT                                   01940005
019100       UNTIL PS-END-OF-PTP-FILE.                                  01950056
019200     PERFORM 3000-UPDATE-CONTROL-FILE.                            01960064
019300     PERFORM 4000-FINISH.                                         01970064
019400                                                                  01980002
019500     STOP RUN.                                                    01990015
019600                                                                  02000015
019700 1000-INITIALIZATION.                                             02010002
019800                                                                  02020003
019900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              02030032
020000                                                                  02040025
020100     OPEN INPUT  EVOLVE-ACTIVITY-FILE                             02050083
020200                 CONTROL-DATE-FILE                                02060064
020300          OUTPUT PROMISES-SECURED-FILE                            02070098
020400                 MFT-FILE.                                        02080099
020500                                                                  02090098
020600     READ EVOLVE-ACTIVITY-FILE INTO AR090-PTP-RECORD              02100098
020700         AT END                                                   02110098
020800            MOVE '1000-INITIALIZATION'                            02120098
020900                                 TO PV-PARAGRAPH-NAME             02130098
021000            MOVE 'EVOLVE-ACTIVITY-FILE IS EMPTY'                  02140098
021100                                 TO PV-OPERATION-MSG-1            02150098
021200            MOVE SPACES          TO PV-OPERATION-MSG-2            02160098
021300            MOVE +4001           TO ABEND-CODE                    02170098
021400            PERFORM 9999-ABEND                                    02180098
021500     END-READ.                                                    02190098
021600                                                                  02200098
021700     READ CONTROL-DATE-FILE                                       02210098
021800         AT END                                                   02220098
021900            MOVE '1000-INITIALIZATION'                            02230098
022000                                 TO PV-PARAGRAPH-NAME             02240098
022100            MOVE 'CONTROL-DATE-FILE IS EMPTY'                     02250098
022200                                 TO PV-OPERATION-MSG-1            02260098
022300            MOVE SPACES          TO PV-OPERATION-MSG-2            02270098
022400            MOVE +4002           TO ABEND-CODE                    02280098
022500            PERFORM 9999-ABEND                                    02290098
022600     END-READ.                                                    02300098
022700                                                                  02310098
022800     MOVE AR092-ACTVTY-DATE      TO PV-ACTVTY-FILE-DATE.          02320099
022900     MOVE AR092-WORLD-DATE       TO PV-WORLD-FILE-DATE.           02330099
023000                                                                  02340098
023100     CLOSE CONTROL-DATE-FILE.                                     02350098
023200                                                                  02360098
023300 2000-PROCESS-INPUT.                                              02370098
023400                                                                  02380098
023500     ADD 1 TO PV-INPUT-COUNT.                                     02390098
023600                                                                  02400098
023700     EVALUATE TRUE                                                02410098
023800         WHEN AR090-88-HEADER                                     02420098
023900             MOVE AR090-PTP-RECORD                                02430098
024000                                 TO AR090-PTP-HEADER              02440098
024100             MOVE AR090-HDR-DT   TO PV-ISO-DATE                   02450098
024200             IF AR090-HDR-DT = PV-ACTVTY-FILE-DATE                02460099
024300                 SET PS-WRITE-HEADER-ONLY TO TRUE                 02470099
024400                 PERFORM 2400-WRITE-OUTPUT-FILE                   02480099
024500                 SET PS-END-OF-PTP-FILE TO TRUE                   02490099
024600                 MOVE 4095       TO RETURN-CODE                   02500099
024700             ELSE                                                 02510099
024800                 PERFORM 2100-DECREMENT-DATE                      02520099
024900                     UNTIL DPG55-DB2-ISO-DATE =                   02530099
025000                           PV-ACTVTY-FILE-DATE                    02540099
025100             END-IF                                               02550099
025200             ADD 1 TO PV-HEADER-COUNT                             02560098
025300             ADD 1 TO PV-BYPASS-COUNT                             02570098
025400         WHEN AR090-88-TRAILER                                    02580098
025500             MOVE AR090-PTP-RECORD                                02590098
025600                                 TO AR090-PTP-TRAILER             02600098
025700             ADD 1 TO PV-TRAILER-COUNT                            02610098
025800             ADD 1 TO PV-BYPASS-COUNT                             02620098
025900         WHEN OTHER                                               02630098
026000             MOVE AR090-PTP-RECORD                                02640098
026100                                 TO AR090-PTP-DETAIL              02650098
026200             ADD 1 TO PV-DETAIL-COUNT                             02660098
026300             PERFORM 2300-EVALUATE-RECORD                         02670098
026400     END-EVALUATE.                                                02680098
026500                                                                  02690098
026600     IF PS-NOT-END-OF-PTP-FILE                                    02700099
026700         PERFORM 2200-READ-INPUT-FILE                             02710099
026800     END-IF.                                                      02720099
026900                                                                  02730099
027000******************************************************************02740098
027100 2100-DECREMENT-DATE.                                             02750098
027200******************************************************************02760098
027300                                                                  02770098
027400     SET DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                     02780098
027500     SET DPG51-DECREMENT-DATE        TO TRUE.                     02790098
027600     SET DPG52-LK-DTE-ISO            TO TRUE.                     02800098
027700                                                                  02810098
027800     MOVE 1                      TO DPG51-INCR-DECR-DAYS-9.       02820098
027900     MOVE PV-ISO-DATE            TO DPG52-LK-DATE-INPUT.          02830098
028000                                                                  02840098
028100     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    02850098
028200                                             DPG54 DPG55 DPG56.   02860098
028300                                                                  02870098
028400     IF DPG54-SEVERE-ERROR                                        02880098
028500     OR DPG54-WARNING-ERROR                                       02890098
028600        MOVE '2100-DECREMENT-DATE'                                02900098
028700                                 TO PV-PARAGRAPH-NAME             02910098
028800        MOVE PV-ISO-DATE         TO PV-OPERATION-MSG-1            02920098
028900        MOVE DPG54-ERROR-MESSAGE TO PV-OPERATION-MSG-2            02930098
029000        MOVE +4008               TO ABEND-CODE                    02940098
029100        PERFORM 9999-ABEND                                        02950098
029200     END-IF.                                                      02960098
029300                                                                  02970098
029400     MOVE DPG55-DB2-ISO-DATE     TO PV-ISO-DATE.                  02980098
029500                                                                  02990098
029600 2200-READ-INPUT-FILE.                                            03000098
029700                                                                  03010098
029800     INITIALIZE AR090-PTP-RECORD.                                 03020098
029900                                                                  03030098
030000     READ EVOLVE-ACTIVITY-FILE INTO AR090-PTP-RECORD              03040098
030100         AT END                                                   03050098
030200            SET PS-END-OF-PTP-FILE TO TRUE                        03060098
030300     END-READ.                                                    03070098
030400                                                                  03080098
030500 2300-EVALUATE-RECORD.                                            03090098
030600                                                                  03100098
030700     MOVE AR090-ENTR-YEAR        TO PV-ENTR-YEAR.                 03110098
030800     MOVE AR090-ENTR-MONTH       TO PV-ENTR-MONTH.                03120098
030900     MOVE AR090-ENTR-DAY         TO PV-ENTR-DAY.                  03130098
031000                                                                  03140098
031100     IF PV-ENTR-DT >= DPG55-DB2-ISO-DATE                          03150098
031200         ADD 1 TO PV-PROCESS-COUNT                                03160098
031300         IF PV-OPER  = SPACES                                     03170098
031400             MOVE AR090-OPER     TO PV-OPER                       03180098
031500         END-IF                                                   03190098
031600         IF AR090-OPER = PV-OPER                                  03200098
031700             ADD 1 TO PV-PROMISES-COUNT                           03210098
031800             MOVE PV-ENTR-DT     TO PV-SAVE-DT                    03220098
031900         ELSE                                                     03230098
032000             ADD 1 TO PV-TRANSACTION-COUNT                        03240098
032100             PERFORM 2400-WRITE-OUTPUT-FILE                       03250098
032200             MOVE AR090-OPER     TO PV-OPER                       03260098
032300             MOVE 1              TO PV-PROMISES-COUNT             03270098
032400         END-IF                                                   03280098
032500     ELSE                                                         03290098
032600         ADD 1 TO PV-BYPASS-COUNT                                 03300098
032700         IF PV-ENTR-DT < DPG55-DB2-ISO-DATE                       03310098
032800             ADD 1 TO PV-TRANSACTION-COUNT                        03320098
032900             PERFORM 2400-WRITE-OUTPUT-FILE                       03330098
033000             SET PS-END-OF-PTP-FILE TO TRUE                       03340098
033100         END-IF                                                   03350098
033200     END-IF.                                                      03360098
033300                                                                  03370098
033400 2400-WRITE-OUTPUT-FILE.                                          03380098
033500                                                                  03390098
033600     IF PS-FIRST-TIME OR PS-WRITE-HEADER-ONLY                     03400099
033700         PERFORM 2410-WRITE-HEADER                                03410099
033800         SET PS-NOT-FIRST-TIME TO TRUE                            03420099
033900     END-IF.                                                      03430099
034000                                                                  03440099
034100     IF PS-WRITE-HEADER-ONLY                                      03450099
034200         SET PS-DO-NOT-WRITE-HEADER-ONLY TO TRUE                  03460099
034300     ELSE                                                         03470099
             IF PV-SAVE-YEAR  = 0 OR                                    03480099
                PV-SAVE-MONTH = 0 OR                                    03490099
                PV-SAVE-DAY   = 0                                       03500099
                CONTINUE                                                03510099
             ELSE                                                       03520099
034400         PERFORM 2420-WRITE-DETAIL                                03530099
             END-IF                                                     03540099
034500     END-IF.                                                      03550099
034600                                                                  03560099
034700 2410-WRITE-HEADER.                                               03570099
034800                                                                  03580099
034900     INITIALIZE PROMISES-SECURED-RECORD.                          03590099
035000                                                                  03600099
035100     STRING 'Promise Date'      DELIMITED BY SIZE                 03610099
035200            ','                 DELIMITED BY SIZE                 03620099
035300            'Agent ID'          DELIMITED BY SIZE                 03630099
035400            ','                 DELIMITED BY SIZE                 03640099
035500            'Dun Lvl'           DELIMITED BY SIZE                 03650099
035600            ','                 DELIMITED BY SIZE                 03660099
035700            'Trxn Cnt'          DELIMITED BY SIZE                 03670099
035800            ','                 DELIMITED BY SIZE                 03680099
035900            'Promise Cnt'       DELIMITED BY SIZE                 03690099
036000            ','                 DELIMITED BY SIZE                 03700099
036100            'LOB'               DELIMITED BY SIZE                 03710099
036200            ','                 DELIMITED BY SIZE                 03720099
036300            'Source'            DELIMITED BY SIZE                 03730099
036400         INTO PROMISES-SECURED-RECORD                             03740099
036500     END-STRING.                                                  03750099
036600                                                                  03760099
036700     WRITE PROMISES-SECURED-RECORD.                               03770099
036800                                                                  03780098
036900 2420-WRITE-DETAIL.                                               03790099
037000                                                                  03800099
037100     INITIALIZE PROMISES-SECURED-RECORD.                          03810098
037200                                                                  03820098
037300     MOVE PV-SAVE-YEAR           TO PV-ENTR-YEAR-FMT.             03830098
037400     MOVE PV-SAVE-MONTH          TO PV-ENTR-MONTH-FMT.            03840098
037500     MOVE PV-SAVE-DAY            TO PV-ENTR-DAY-FMT.              03850098
037600                                                                  03860098
037700     STRING PV-ENTR-DT-FMT          DELIMITED BY SIZE             03870098
037800            ','                     DELIMITED BY SIZE             03880098
037900            PV-OPER                 DELIMITED BY SPACE            03890098
038000            ','                     DELIMITED BY SIZE             03900098
038100**** This is the Dun Level field; using 'N/A' for now             03910099
038200            'N/A'                   DELIMITED BY SIZE             03920099
038300            ','                     DELIMITED BY SIZE             03930098
038400            PV-TRANSACTION-COUNT    DELIMITED BY SIZE             03940098
038500            ','                     DELIMITED BY SIZE             03950098
038600            PV-PROMISES-COUNT       DELIMITED BY SIZE             03960098
038700            ','                     DELIMITED BY SIZE             03970098
038800            'RMO'                   DELIMITED BY SIZE             03980098
038900            ','                     DELIMITED BY SIZE             03990098
039000            'FirstData-PromisesSecuredRMO'                        04000098
039100                                    DELIMITED BY SIZE             04010098
039200       INTO PROMISES-SECURED-RECORD                               04020098
039300     END-STRING.                                                  04030098
039400                                                                  04040098
039500     WRITE PROMISES-SECURED-RECORD.                               04050098
039600                                                                  04060098
039700     ADD 1 TO PV-WRITE-COUNT.                                     04070098
039800                                                                  04080098
039900 3000-UPDATE-CONTROL-FILE.                                        04090098
040000                                                                  04100098
040100     OPEN OUTPUT CONTROL-DATE-FILE.                               04110098
040200                                                                  04120098
040300     MOVE SPACES                 TO AR092-FILLER                  04130099
040400                                    AR092-FUTURE-USE.             04140099
040500     MOVE AR090-HDR-DT           TO AR092-ACTVTY-DATE.            04150099
040600     MOVE PV-WORLD-FILE-DATE     TO AR092-WORLD-DATE.             04160099
040700                                                                  04170098
040800     WRITE AR092-RECORD.                                          04180098
040900                                                                  04190098
041000 4000-FINISH.                                                     04200098
041100                                                                  04210098
041200     DISPLAY '***********************************'.               04220098
041300     DISPLAY 'CURR HEADER DATE = ' AR090-HDR-DT.                  04230098
041400     DISPLAY 'PREV HEADER DATE = ' PV-ACTVTY-FILE-DATE.           04240099
041500     DISPLAY 'PROCESSING DATE  = ' DPG55-DB2-ISO-DATE.            04250098
041600     DISPLAY ' '.                                                 04260098
041700     MOVE PV-HEADER-COUNT        TO PV-DISPLAY-COUNT.             04270098
041800     DISPLAY '  HEADERS READ:     ' PV-DISPLAY-COUNT.             04280098
041900     MOVE PV-DETAIL-COUNT        TO PV-DISPLAY-COUNT.             04290098
042000     DISPLAY '+ DETAILS READ:     ' PV-DISPLAY-COUNT.             04300098
042100     MOVE PV-TRAILER-COUNT       TO PV-DISPLAY-COUNT.             04310098
042200     DISPLAY '+ TRAILERS READ:    ' PV-DISPLAY-COUNT.             04320098
042300     MOVE PV-INPUT-COUNT         TO PV-DISPLAY-COUNT.             04330098
042400     DISPLAY '= RECORDS READ:     ' PV-DISPLAY-COUNT.             04340098
042500     DISPLAY ' '.                                                 04350098
042600     MOVE PV-BYPASS-COUNT        TO PV-DISPLAY-COUNT.             04360098
042700     DISPLAY '  RECORDS BYPASSED: ' PV-DISPLAY-COUNT.             04370098
042800     MOVE PV-PROCESS-COUNT       TO PV-DISPLAY-COUNT.             04380098
042900     DISPLAY '+ RECORDS PROCESSED:' PV-DISPLAY-COUNT.             04390098
043000     MOVE PV-INPUT-COUNT         TO PV-DISPLAY-COUNT.             04400098
043100     DISPLAY '= RECORDS READ:     ' PV-DISPLAY-COUNT.             04410098
043200     DISPLAY ' '.                                                 04420098
043300     MOVE PV-WRITE-COUNT         TO PV-DISPLAY-COUNT.             04430098
043400     DISPLAY 'RECORDS WRITTEN:    ' PV-DISPLAY-COUNT.             04440098
043500     DISPLAY '***********************************'.               04450098
043600                                                                  04460099
043700     ACCEPT CD-CURRENT-DATE      FROM DATE.                       04470099
043800     MOVE   CD-CURRENT-YEAR      TO MFT-YEAR.                     04480099
043900     MOVE   CD-CURRENT-MONTH     TO MFT-MONTH.                    04490099
044000     MOVE   CD-CURRENT-DAY       TO MFT-DAY.                      04500099
044100     ACCEPT CT-CURRENT-TIME      FROM TIME.                       04510099
044200     MOVE   CT-CURRENT-HOUR      TO MFT-HOUR.                     04520099
044300     MOVE   CT-CURRENT-MINUTE    TO MFT-MINUTE.                   04530099
044400     MOVE   CT-CURRENT-SECOND    TO MFT-SECOND.                   04540099
044500     MOVE   PV-WRITE-COUNT       TO MFT-COUNT.                    04550099
044600                                                                  04560098
044700     WRITE MFT-RECORD FROM PV-MFT-RECORD.                         04570099
044800                                                                  04580098
044900     CLOSE EVOLVE-ACTIVITY-FILE                                   04590098
045000           CONTROL-DATE-FILE                                      04600098
045100           PROMISES-SECURED-FILE                                  04610098
045200           MFT-FILE.                                              04620099
045300                                                                  04630098
045400 9999-ABEND.                                                      04640098
045500                                                                  04650098
045600     DISPLAY '** ABEND OCCURRED  **'.                             04660098
045700     DISPLAY '** PROGRAM NAME    ** = ' PC-PROGRAM-NAME.          04670098
045800     DISPLAY '** PARAGRAPH NAME  ** = ' PV-PARAGRAPH-NAME.        04680098
045900     DISPLAY '** MESSAGE         ** = ' PV-OPERATION-MSG-1.       04690098
046000     DISPLAY '** MESSAGE (CONT.) ** = ' PV-OPERATION-MSG-2.       04700098
046100                                                                  04710098
046200     CALL 'ILBOABN0' USING ABEND-CODE.                            04720098
