000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.    APKRP006.                                         00020000
000300 AUTHOR.        MIKE BESKE.                                       00030000
000400 DATE-WRITTEN.  JUNE 2000.                                        00040000
000500 DATE-COMPILED.                                                   00050000
000600***************************************************************** 00060000
000700*        VENDOR PURCHASES BY VENDOR YEAR TO DATE REPORT         * 00070000
000800***************************************************************** 00080000
000900*    COBOL II                                                   * 00090000
001000***************************************************************** 00100000
001100*  PURPOSE:  CREATES THE MONTHLY VENDOR PURCHASES BY VENDOR YEAR* 00110000
001200*  TO DATE REPORT.                                              * 00120000
001300***************************************************************** 00130000
001400* CHANGES:                                                      * 00140000
001500*                                                               * 00150000
001600* 10/14/02  ADDED THE VENDOR NUMBER TO THE REPORT.              * 00160012
001700*           BY MIKE BESKE                 WR/PITS#: 24208       * 00170012
001800*                                                               * 00180000
001900* 04/22/04  RECOMPILED TO PICK UP CHANGES TO STOREEXT COPYBOOK. * 00190014
002000*           BY MIKE BESKE                 WR/PITS#: 25805       * 00200014
002100*                                                               * 00210014
002200*                                                               * 00220000
002210* 02/12/08  FOR PRIVATE LABEL ACCOUNTING PROJECT CHANGED SORT   * 00221020
002211*           CARD AND LET PROGRAM ACCUMULATE TOTALS FOR CORRECT  * 00221119
002212*           FIELD EITHER UNIT COST FOR IMPORTS OR 1ST COST FOR  * 00221219
002213*           DOMESTIC                                            * 00221319
002220*           BY GREG WISIALOWSKI           WR/PITS#: 32664       * 00222019
002230*                                                               * 00223019
002240* 09/11/08  APK592 ABENDED DUE TO TOO MUCH SPACE NEEDED FOR THE * 00224028
002250*           SORT OF THE INPUT FILE.  THE FILE WAS DECREASED     * 00225021
002260*           IN SIZE FROM 300 TO 80 CHARACTERS.  A NEW COPYBOOK, * 00226021
002270*           APRD412, WAS CREATED TO DEFINE THE FIELDS IN THE    * 00227022
002280*           SMALLER FILE, REPLACING THE COPYBOOK STOREEXT       * 00228022
002281*           THAT WAS USED TO DEFINE THE LARGER FILE.            * 00228127
002290*           BY MICHELE RINDFLEISCH     WR/IR #: INC000000501631 * 00229022
002300***************************************************************** 00230000
002400*                                                                 00240000
002500     EJECT                                                        00250000
002600 ENVIRONMENT DIVISION.                                            00260000
002700 CONFIGURATION SECTION.                                           00270000
002800 SOURCE-COMPUTER.    IBM-3090.                                    00280000
002900 OBJECT-COMPUTER.    IBM-3090.                                    00290000
003000                                                                  00300000
003100 INPUT-OUTPUT SECTION.                                            00310000
003200 FILE-CONTROL.                                                    00320000
003300                                                                  00330000
003400     SELECT INPUT-FILE              ASSIGN TO INP01.              00340000
003500     SELECT REPORT-FILE             ASSIGN TO RPT01.              00350000
003600*                                                                 00360000
003700 DATA DIVISION.                                                   00370000
003800*                                                                 00380000
003900 FILE SECTION.                                                    00390000
004000*                                                                 00400000
004100 FD  INPUT-FILE                                                   00410000
004200     RECORDING MODE IS F                                          00420000
004300     LABEL RECORDS ARE STANDARD                                   00430000
004400     RECORD CONTAINS 80 CHARACTERS                                00440021
004500     BLOCK CONTAINS 0  RECORDS                                    00450000
004600     DATA RECORD IS INPUT-RECORD.                                 00460000
004700 01  INPUT-RECORD                  PIC  X(80).                    00470021
004800*                                                                 00480000
004900 FD  REPORT-FILE                                                  00490000
005000     RECORDING MODE IS F                                          00500000
005100     LABEL RECORDS ARE STANDARD                                   00510000
005200     RECORD CONTAINS 132 CHARACTERS                               00520000
005300     BLOCK CONTAINS 0  RECORDS                                    00530000
005400     DATA RECORD IS REPORT-RECORD.                                00540000
005500 01  REPORT-RECORD                 PIC X(132).                    00550000
005600*                                                                 00560000
005700     EJECT                                                        00570000
005800 WORKING-STORAGE SECTION.                                         00580000
005900*                                                                 00590000
006000******************************************************************00600000
006100**   APRD412 STORE DETAIL RECORDS                               **00610029
006200******************************************************************00620000
006300     COPY APRD412.                                                00630021
006400*                                                                 00640000
006500*                                                                 00650000
006600 01  HF-HOLD-BREAK-FIELDS.                                        00660000
006700     05  HF-HOLD-BREAK-VEND         PIC  X(25)  VALUE SPACE.      00670000
006800     05  HF-HOLD-BREAK-VEND-NBR     PIC  X(09)  VALUE SPACE.      00680011
006900     05  HF-HOLD-BREAK-DEPT         PIC  9(03)  VALUE ZEROES.     00690004
007000*                                                                 00700000
007100 01  MC-MISCELLANEOUS-CONSTANTS.                                  00710000
007200     05  MC-RPT-TOTAL-MAX           PIC  S9(4)  COMP SYNC         00720000
007300                                                VALUE +3.         00730000
007400     05  MC-LEVEL-1                 PIC S9(04)  COMP SYNC         00740000
007500                                                VALUE +1.         00750000
007600     05  MC-LEVEL-2                 PIC S9(04)  COMP SYNC         00760000
007700                                                VALUE +2.         00770000
007800     05  MC-LEVEL-3                 PIC S9(04)  COMP SYNC         00780000
007900                                                VALUE +3.         00790000
008000     05  MC-PAGE-SIZE               PIC  S9(3)  COMP-3            00800000
008100                                                VALUE +56.        00810000
008200     05  MC-PROGRAM-NAME            PIC  X(8)   VALUE 'APKRP006'. 00820000
008300     05  MC-BLANK-LINE              PIC  X(132) VALUE SPACES.     00830000
008400     05  MC-ADVANCE-1-LINE          PIC  9(1)   VALUE 1.          00840000
008500     05  MC-ADVANCE-2-LINES         PIC  9(1)   VALUE 2.          00850000
008600     05  MC-ADVANCE-3-LINES         PIC  9(1)   VALUE 3.          00860000
008700*                                                                 00870000
008800 01  PC-PROGRAM-COUNTERS.                                         00880000
008900     05  PC-LINE-COUNT              PIC S9(03)  VALUE +99         00890000
009000                                                COMP-3.           00900000
009100     05  PC-PAGE-COUNT              PIC S9(05)  VALUE ZERO        00910000
009200                                                COMP-3.           00920000
009300*                                                                 00930000
009400 01  PV-PROGRAM-VARIABLES.                                        00940000
009500     05  PV-BREAK-LEVEL             PIC S9(04)  COMP SYNC         00950000
009600                                                VALUE ZERO.       00960000
009700         88  PV-BREAK-LEVEL-1                   VALUE +1.         00970000
009800         88  PV-BREAK-LEVEL-2                   VALUE +2.         00980000
009900         88  PV-BREAK-LEVEL-3                   VALUE +3.         00990000
010000     05  PV-NUMBER-OF-LINES         PIC 9(1)     VALUE ZERO.      01000000
010100*                                                                 01010000
010200 01  REPORT-TITLES.                                               01020000
010300     05  REPORT-TITLE-VALUES.                                     01030000
010400         10  RPT-VEND-1             PIC X(25)    VALUE            01040000
010500             '    **  GRAND TOTALS  ** '.                         01050000
010600         10  RPT-VEND-NBR-1         PIC X(9)     VALUE SPACES.    01060011
010700         10  FILLER                 PIC X(3)     VALUE SPACES.    01070011
010800         10  RPT-VEND-2             PIC X(25)    VALUE            01080011
010900             '  * VENDOR TOTALS *      '.                         01090011
011000         10  RPT-VEND-NBR-2         PIC X(9)     VALUE SPACES.    01100011
011100         10  FILLER                 PIC X(3)     VALUE SPACES.    01110011
011200         10  RPT-VEND-3             PIC X(25)    VALUE SPACES.    01120011
011300         10  RPT-VEND-NBR-3         PIC X(9)     VALUE SPACES.    01130011
011400         10  RPT-DEPT-3             PIC X(3)     VALUE SPACES.    01140011
011500     05  REPORT-TITLE-TABLE  REDEFINES  REPORT-TITLE-VALUES.      01150011
011600         10  RPT-TITLES OCCURS 3 TIMES                            01160011
011700                         INDEXED BY REPORT-TITLES-INDEX.          01170011
011800             15  RPT-TITLE-VEND     PIC X(25).                    01180011
011900             15  RPT-TITLE-VEND-NBR PIC X(9).                     01190011
012000             15  RPT-TITLE-DEPT     PIC X(3).                     01200011
012100                                                                  01210011
012200* THE FOLLOWING CONTAINS THE ACCUMULATED TOTALS FOR THIS REPORT.  01220011
012300* TABLE OCCURANCE (1) CONTAINS HIGHEST LEVEL (GRAND) TOTALS, AND  01230011
012400* TABLE OCCURANCE (3) CONTAINS THE LOWEST LEVEL TOTALS            01240011
012500*                                                                 01250011
012600 01  REPORT-TOTAL-TABLE.                                          01260011
012700     05  RPT-TOTALS  OCCURS  3 TIMES                              01270011
012800                     INDEXED BY REPORT-TOTALS-INDEX               01280011
012900                                REPORT-TOTALS-INDEX-NEXT.         01290011
013000         10  RPT-TOT-COST           PIC S9(11)V99   COMP-3.       01300011
013100         10  RPT-TOT-RETAIL         PIC S9(11)V99   COMP-3.       01310011
013200*                                                                 01320011
013300 01  SF-SYSTEM-FIELDS.                                            01330011
013400     05  SF-SYSTEM-DATE.                                          01340011
013500         10  SF-SYSTEM-YEAR         PIC  9(02)  VALUE ZERO.       01350011
013600         10  SF-SYSTEM-MONTH        PIC  9(02)  VALUE ZERO.       01360011
013700         10  SF-SYSTEM-DAY          PIC  9(02)  VALUE ZERO.       01370011
013800     05  SF-SYSTEM-TIME.                                          01380011
013900         10  SF-SYSTEM-HOUR         PIC  9(02)  VALUE ZERO.       01390011
014000         10  SF-SYSTEM-MINUTE       PIC  9(02)  VALUE ZERO.       01400011
014100         10  SF-SYSTEM-SECOND       PIC  9(02)  VALUE ZERO.       01410011
014200         10  FILLER                 PIC  9(02)  VALUE ZERO.       01420011
014300*                                                                 01430011
014400 01  SW-SWITCHES.                                                 01440011
014500     05  SW-BREAKS-FOUND-SW         PIC  X(01)  VALUE 'N'.        01450011
014600         88  SW-NO-BREAKS-FOUND                 VALUE 'N'.        01460011
014700         88  SW-BREAKS-FOUND                    VALUE 'Y'.        01470011
014800     05  SW-END-OF-FILE-SW          PIC  X(01)  VALUE 'N'.        01480011
014900         88  SW-END-OF-FILE                     VALUE 'Y'.        01490011
015000         88  SW-NOT-END-OF-FILE                 VALUE 'N'.        01500011
015100     05  SW-NEED-BLANK-LINE-SW      PIC  X(01)  VALUE 'N'.        01510011
015200         88  SW-DONT-NEED-BLANK-LINE            VALUE 'N'.        01520011
015300         88  SW-NEED-BLANK-LINE                 VALUE 'Y'.        01530011
015400     05  SW-FIRST-READ-SW           PIC  X(01)  VALUE 'Y'.        01540011
015500         88  SW-FIRST-READ                      VALUE 'Y'.        01550011
015600         88  SW-NOT-FIRST-READ                  VALUE 'N'.        01560011
015700                                                                  01570011
015800     EJECT                                                        01580011
015900******************************************************************01590011
016000**          KOHLS STANDARD 132 CHARACTER REPORT HEADER          **01600011
016100******************************************************************01610011
016200     COPY DPWS132O.                                               01620011
016300*                                                                 01630011
016400 01  RH1-REPORT-HEAD1.                                            01640011
016500     05  FILLER                     PIC  X(45)  VALUE SPACE.      01650011
016600     05  FILLER                     PIC  X(43)  VALUE             01660011
016700         'VENDOR PURCHASES BY VENDOR FOR YEAR TO DATE'.           01670011
016800     05  FILLER                     PIC  X(44)  VALUE SPACE.      01680011
016900*                                                                 01690011
017000 01  CH1-COLUMN-HEAD1.                                            01700011
017100     05  FILLER                     PIC  X(51)  VALUE             01710011
017200       '       VENDOR NAME           VNDR NBR   DEPT       '.     01720013
017300     05  FILLER                     PIC  X(40)  VALUE             01730011
017400       ' MERCH COST              RETAIL         '.                01740011
017500     05  FILLER                     PIC  X(41)  VALUE             01750011
017600       '                                        '.                01760011
017700*                                                                 01770011
017800 01  DL1-DETAIL-LINE1.                                            01780011
017900     05  FILLER                     PIC  X(02)  VALUE SPACE.      01790011
018000     05  DL1-VENDOR-NAME            PIC  X(25)  VALUE SPACE.      01800011
018100     05  FILLER                     PIC  X(02)  VALUE SPACE.      01810011
018200     05  DL1-VENDOR-NUMBER          PIC  X(09)  VALUE SPACE.      01820011
018300     05  FILLER                     PIC  X(02)  VALUE SPACE.      01830011
018400     05  DL1-DEPT                   PIC  999    VALUE ZERO        01840011
018500                                                BLANK WHEN ZERO.  01850011
018600     05  FILLER                     PIC  X(02)  VALUE SPACE.      01860011
018700     05  DL1-MERCH-COST             PIC  ZZ,ZZZ,ZZZ,ZZZ.99-       01870011
018800                                                VALUE ZERO        01880011
018900                                                BLANK WHEN ZERO.  01890011
019000     05  FILLER                     PIC  X(02)  VALUE SPACE.      01900011
019100     05  DL1-RETAIL                 PIC  ZZ,ZZZ,ZZZ,ZZZ.99-       01910011
019200                                                VALUE ZERO        01920011
019300                                                BLANK WHEN ZERO.  01930011
019400     05  FILLER                     PIC  X(63)  VALUE SPACE.      01940011
019500*                                                                 01950011
019600 01  RE1-REPORT-END-LINE1.                                        01960011
019700     05  FILLER                     PIC  X(49)  VALUE SPACE.      01970011
019800     05  FILLER                     PIC  X(34)  VALUE             01980011
019900         '***  END OF REPORT APKRP006-1  ***'.                    01990011
020000     05  FILLER                     PIC  X(49)  VALUE SPACE.      02000011
020100*                                                                 02010011
020200/                                                                 02020011
020300 PROCEDURE DIVISION.                                              02030011
020400*                                                                 02040011
020500 A000-MAINLINE-PROCESSING.                                        02050011
020600                                                                  02060011
020700     PERFORM B100-INITIALIZATION.                                 02070011
020800     PERFORM B200-PROCESS-FILE                                    02080011
020900         UNTIL SW-END-OF-FILE.                                    02090011
021000     MOVE HF-HOLD-BREAK-DEPT TO RPT-DEPT-3.                       02100011
021100     PERFORM B300-TERMINATION.                                    02110011
021200     STOP RUN.                                                    02120011
021300                                                                  02130011
021400*                                                                 02140011
021500******************************************************************02150011
021600**                    B100-INITIALIZATION                       **02160011
021700**  SET UP THE STANDARD REPORT HEADER, DO AN INITIAL FILE READ. **02170011
021800**  WRITE FIRST REPORT HEADINGS. SAVE FIRST RECORD KEY VALUES   **02180011
021900**  FOR LATER COMPARISON.                                       **02190011
022000******************************************************************02200011
022100 B100-INITIALIZATION.                                             02210011
022200                                                                  02220011
022300     OPEN INPUT INPUT-FILE                                        02230011
022400         OUTPUT REPORT-FILE.                                      02240011
022500                                                                  02250011
022600     ACCEPT SF-SYSTEM-DATE FROM DATE.                             02260011
022700     MOVE SF-SYSTEM-MONTH        TO DP132O-RUN-MONTH.             02270011
022800     MOVE SF-SYSTEM-DAY          TO DP132O-RUN-DAY.               02280011
022900     MOVE SF-SYSTEM-YEAR         TO DP132O-RUN-YEAR.              02290011
023000     ACCEPT SF-SYSTEM-TIME FROM TIME.                             02300011
023100     MOVE SF-SYSTEM-HOUR         TO DP132O-RUN-HOUR.              02310011
023200     MOVE SF-SYSTEM-MINUTE       TO DP132O-RUN-MINUTE.            02320011
023300     MOVE MC-PROGRAM-NAME        TO DP132O-PROGRAM-NAME.          02330011
023400     MOVE '1'                    TO DP132O-REPORT-NUMBER.         02340011
023500                                                                  02350011
023600     INITIALIZE REPORT-TOTAL-TABLE.                               02360011
023700                                                                  02370011
023800     PERFORM S100-HEADINGS.                                       02380011
023900                                                                  02390011
024000     PERFORM R100-READ-INPUT.                                     02400011
024100                                                                  02410011
024200     IF SW-FIRST-READ                                             02420011
024300         SET SW-NOT-FIRST-READ     TO TRUE                        02430011
024400         MOVE AP412-DEPT           TO HF-HOLD-BREAK-DEPT          02440029
024500         MOVE AP412-VENDOR-NAME-DUNNS TO HF-HOLD-BREAK-VEND       02450029
024600                                      RPT-VEND-3                  02460011
024700         MOVE AP412-VENDOR-NO-DUNNS TO HF-HOLD-BREAK-VEND-NBR     02470029
024800                                      RPT-VEND-NBR-3              02480011
024900     END-IF.                                                      02490011
025000                                                                  02500011
025100*                                                                 02510011
025200******************************************************************02520011
025300**                    B200-PROCESS-FILE                         **02530011
025400**  FOR EACH RECORD READ FROM INPUT FILE, DETERMINE WHETHER OR  **02540011
025500**  NOT A TOTAL FIELD HAS HAD A BREAK SINCE THE PREVIOUS RECORD.**02550011
025600**  IF A BREAK HAS OCCURRED, SET A SWITCH WHICH TELLS AT WHICH  **02560011
025700**  LEVEL THIS BREAK HAS HAPPENED AND PERFORM THE PARAGRAPH     **02570011
025800**  WHICH PRINTS TOTAL LINES. REGARDLESS OF WHETHER OR NOT ANY  **02580011
025900**  TOTAL BREAKS HAVE OCCURRED, INCREMENT THE PROGRAM TOTAL     **02590011
026000**  TABLES FOR THE INPUT RECORD AFTER CALCULATING VALUES.       **02600011
026100**  SAVE THE CURRENT RECORD BREAK VALUES, AND READ ANOTHER      **02610011
026200**  INPUT RECORD.                                               **02620011
026300******************************************************************02630011
026400 B200-PROCESS-FILE.                                               02640011
026500                                                                  02650011
026600     MOVE HF-HOLD-BREAK-DEPT TO RPT-DEPT-3.                       02660011
026700                                                                  02670011
026800     SET SW-NO-BREAKS-FOUND TO TRUE.                              02680011
026900                                                                  02690011
027000* DETERMINE IF ANY TOTAL BREAKS HAVE TAKEN PLACE                  02700011
027100     IF AP412-VENDOR-NAME-DUNNS   NOT EQUAL HF-HOLD-BREAK-VEND    02710029
027200         SET PV-BREAK-LEVEL-2 TO TRUE                             02720011
027300         SET SW-BREAKS-FOUND TO TRUE                              02730011
027400     ELSE                                                         02740011
027500         IF AP412-DEPT           NOT EQUAL HF-HOLD-BREAK-DEPT     02750029
027600             SET PV-BREAK-LEVEL-3 TO TRUE                         02760011
027700             SET SW-BREAKS-FOUND TO TRUE                          02770011
027800         END-IF                                                   02780011
027900     END-IF.                                                      02790011
028000                                                                  02800011
028100* IF THERE WERE TOTAL BREAKS, WRITE OUT TOTAL LINES.              02810011
028200     IF SW-BREAKS-FOUND                                           02820011
028300         PERFORM C100-PROCESS-TOTAL-BREAK                         02830011
028400             VARYING REPORT-TOTALS-INDEX                          02840011
028500                 FROM MC-RPT-TOTAL-MAX BY -1                      02850011
028600                     UNTIL REPORT-TOTALS-INDEX                    02860011
028700                         LESS THAN PV-BREAK-LEVEL                 02870011
028800     END-IF.                                                      02880011
028900                                                                  02890011
029000* INCREMENT THE PROGRAM TOTAL TABLE FOR CURRENT INPUT RECORD.     02900011
029010     IF AP412-PO-TYP-CDE = 'IM'OR'IE'OR 'IF' OR 'CD'              02901029
029100         ADD AP412-COST-EXTENSION    TO RPT-TOT-COST              02910029
029200                                       (MC-RPT-TOTAL-MAX)         02920015
029210     ELSE                                                         02921017
029211         ADD AP412-1ST-COST-EXTENSION TO RPT-TOT-COST             02921129
029212                                       (MC-RPT-TOTAL-MAX)         02921215
029213     END-IF.                                                      02921315
029220                                                                  02922015
029400                                                                  02940011
029500     ADD AP412-RETAIL-EXTENSION  TO RPT-TOT-RETAIL                02950029
029600                                    (MC-RPT-TOTAL-MAX).           02960011
029700                                                                  02970011
029800* SAVE THE BREAK VALUES FOR THE CURRENT RECORD.                   02980011
029900     IF SW-NOT-END-OF-FILE                                        02990011
030000         MOVE AP412-DEPT           TO HF-HOLD-BREAK-DEPT          03000029
030100         MOVE AP412-VENDOR-NAME-DUNNS TO HF-HOLD-BREAK-VEND       03010029
030200         MOVE AP412-VENDOR-NO-DUNNS TO HF-HOLD-BREAK-VEND-NBR     03020029
030300     END-IF.                                                      03030011
030400                                                                  03040011
030500     PERFORM R100-READ-INPUT.                                     03050011
030600                                                                  03060011
030700*                                                                 03070011
030800******************************************************************03080011
030900**               B300-TERMINATION                               **03090011
031000**  PROCESS THE REMAINING TOTALS LEFT TO BE PRINTED (THE LEFT-  **03100011
031100**  OVER TOTALS IN THE PROGRAM TOTAL TABLE) AND THE GRAND TOTAL.**03110011
031200******************************************************************03120011
031300 B300-TERMINATION.                                                03130011
031400                                                                  03140011
031500     SET PV-BREAK-LEVEL-1 TO TRUE.                                03150011
031600     SET REPORT-TOTALS-INDEX TO +1.                               03160011
031700     PERFORM C100-PROCESS-TOTAL-BREAK                             03170011
031800         VARYING REPORT-TOTALS-INDEX                              03180011
031900             FROM MC-RPT-TOTAL-MAX BY -1                          03190011
032000                 UNTIL REPORT-TOTALS-INDEX                        03200011
032100                     LESS THAN PV-BREAK-LEVEL.                    03210011
032200                                                                  03220011
032300     WRITE REPORT-RECORD FROM RE1-REPORT-END-LINE1                03230011
032400         AFTER ADVANCING 2 LINES.                                 03240011
032500                                                                  03250011
032600     CLOSE INPUT-FILE                                             03260011
032700           REPORT-FILE.                                           03270011
032800                                                                  03280011
032900*                                                                 03290011
033000******************************************************************03300011
033100**               C100-PROCESS-TOTAL-BREAK                       **03310011
033200**  PRINT PAGE HEADINGS IF NEEDED. ADD THE CURRENT BREAK LEVEL  **03320011
033300**  TOTALS TO THE NEXT HIGHER LEVEL'S TOTALS. SET THE INDEX FOR **03330011
033400**  THE PRINT LINE TITLE TO BE THE SAME INDEX LEVEL AS THE TOTAL**03340011
033500**  NUMBERS WHICH ARE BEING PRINTED. MOVE THE TOTALS TO THE OUT-**03350011
033600**  PUT PRINT LINE. WRITE THE PRINT LINE AND ZERO OUT THE TOTAL **03360011
033700**  TABLE LEVEL WHICH WAS JUST PRINTED.                         **03370011
033800******************************************************************03380011
033900 C100-PROCESS-TOTAL-BREAK.                                        03390011
034000                                                                  03400011
034100     IF PC-LINE-COUNT GREATER THAN MC-PAGE-SIZE                   03410011
034200         PERFORM S100-HEADINGS                                    03420011
034300     END-IF.                                                      03430011
034400                                                                  03440011
034500* ADD THE CURRENT LEVEL TOTALS TO THE NEXT HIGHER LEVEL TOTALS IN 03450011
034600* THE TABLE.                                                      03460011
034700     SET REPORT-TOTALS-INDEX-NEXT TO REPORT-TOTALS-INDEX.         03470029
034800     SET REPORT-TOTALS-INDEX-NEXT DOWN BY 1.                      03480011
034900                                                                  03490011
035000     IF REPORT-TOTALS-INDEX-NEXT GREATER THAN ZERO                03500011
035100         ADD RPT-TOT-COST (REPORT-TOTALS-INDEX) TO                03510011
035200              RPT-TOT-COST (REPORT-TOTALS-INDEX-NEXT)             03520011
035300         ADD RPT-TOT-RETAIL (REPORT-TOTALS-INDEX) TO              03530011
035400              RPT-TOT-RETAIL (REPORT-TOTALS-INDEX-NEXT)           03540011
035500     END-IF.                                                      03550011
035600                                                                  03560011
035700* SET THE LINE TITLE INDEX TO THE SAME LEVEL AS THE TOTAL LEVEL   03570011
035800* TO BE PRINTED.                                                  03580011
035900     SET REPORT-TITLES-INDEX TO REPORT-TOTALS-INDEX.              03590011
036000     MOVE RPT-TITLE-VEND (REPORT-TITLES-INDEX) TO                 03600011
036100                                     DL1-VENDOR-NAME.             03610011
036200     MOVE RPT-TITLE-VEND-NBR (REPORT-TITLES-INDEX) TO             03620011
036300                                     DL1-VENDOR-NUMBER.           03630011
036400     MOVE RPT-TITLE-DEPT (REPORT-TITLES-INDEX) TO                 03640011
036500                                     DL1-DEPT.                    03650011
036600                                                                  03660011
036700* FILL THE OUTPUT PRINT LINE.                                     03670011
036800     MOVE RPT-TOT-COST (REPORT-TOTALS-INDEX) TO                   03680011
036900                               DL1-MERCH-COST.                    03690011
037000     MOVE RPT-TOT-RETAIL (REPORT-TOTALS-INDEX) TO                 03700011
037100                               DL1-RETAIL.                        03710011
037200                                                                  03720011
037300* SET THE NUMBER OF LINES TO BE ADVANCED ACCORDING TO THE TOTAL   03730011
037400* LEVEL BEING PRINTED.                                            03740011
037500     EVALUATE REPORT-TOTALS-INDEX                                 03750011
037600         WHEN MC-LEVEL-1                                          03760011
037700             MOVE MC-ADVANCE-3-LINES TO PV-NUMBER-OF-LINES        03770011
037800         WHEN MC-LEVEL-2                                          03780011
037900             MOVE MC-ADVANCE-2-LINES  TO PV-NUMBER-OF-LINES       03790011
038000         WHEN MC-LEVEL-3                                          03800011
038100             MOVE MC-ADVANCE-1-LINE TO PV-NUMBER-OF-LINES         03810011
038200     END-EVALUATE.                                                03820011
038300                                                                  03830011
038400* WRITE A BLANK LINE BEFORE PRINTING THE LOWEST LEVEL (DEPARTMENT)03840011
038500* TOTALS IF THE LAST TOTAL PRINTED WAS A HIGHER LEVEL TOTAL (VENDO03850011
038600     IF REPORT-TOTALS-INDEX EQUAL MC-LEVEL-3                      03860011
038700         IF SW-NEED-BLANK-LINE                                    03870011
038800             WRITE REPORT-RECORD FROM MC-BLANK-LINE               03880011
038900                 AFTER ADVANCING 1 LINE                           03890011
039000             ADD +1 TO PC-LINE-COUNT                              03900011
039100             SET SW-DONT-NEED-BLANK-LINE TO TRUE                  03910011
039200         END-IF                                                   03920011
039300     END-IF.                                                      03930011
039400                                                                  03940011
039500* WRITE THE PRINT LINE                                            03950011
039600     WRITE REPORT-RECORD FROM DL1-DETAIL-LINE1                    03960011
039700         AFTER ADVANCING PV-NUMBER-OF-LINES LINES.                03970011
039800     ADD PV-NUMBER-OF-LINES TO PC-LINE-COUNT.                     03980011
039900                                                                  03990011
040000* ZERO OUT THE TOTAL LEVEL JUST PRINTED                           04000011
040100     MOVE ZEROES TO RPT-TOT-COST (REPORT-TOTALS-INDEX)            04010011
040200                    RPT-TOT-RETAIL (REPORT-TOTALS-INDEX).         04020011
040300                                                                  04030011
040400* ONLY PRINT VENDOR NAME (BREAK LEVEL 2) ON THE FIRST DEPARTMENT  04040011
040500* (BREAK LEVEL 3) LINE WHICH IS PRINTED FOR A PARTICULAR VENDOR.  04050011
040600     IF PV-BREAK-LEVEL-2                                          04060011
040700         MOVE AP412-VENDOR-NAME-DUNNS   TO RPT-VEND-3             04070029
040800         MOVE AP412-VENDOR-NO-DUNNS     TO RPT-VEND-NBR-3         04080029
040900         SET SW-NEED-BLANK-LINE TO TRUE                           04090011
041000     ELSE                                                         04100011
041100         MOVE SPACES TO RPT-VEND-3                                04110011
041200                        RPT-VEND-NBR-3                            04120011
041300     END-IF.                                                      04130011
041400                                                                  04140011
041500*                                                                 04150011
041600******************************************************************04160011
041700**                       R100-READ-INPUT                        **04170011
041800**  READ A RECORD FROM THE INPUT STORE EXTRACT FILE             **04180011
041900**                                                              **04190011
042000******************************************************************04200011
042100 R100-READ-INPUT.                                                 04210011
042200                                                                  04220011
042300     READ INPUT-FILE INTO APRD412-STORE-DETAIL-LINE               04230029
042400         AT END                                                   04240011
042500             SET SW-END-OF-FILE TO TRUE.                          04250011
042600                                                                  04260011
042700*                                                                 04270011
042800******************************************************************04280011
042900**                       S100-HEADINGS                          **04290011
043000**  PRODUCE THE PAGE HEADINGS FOR THE REPORT.                   **04300011
043100**                                                              **04310011
043200******************************************************************04320011
043300 S100-HEADINGS.                                                   04330011
043400                                                                  04340011
043500     ADD 1 TO PC-PAGE-COUNT.                                      04350011
043600     MOVE PC-PAGE-COUNT TO DP132O-PAGE-NUMBER.                    04360011
043700     WRITE REPORT-RECORD FROM DP132O-STANDRD-HEADER-132-COLS      04370011
043800         AFTER ADVANCING PAGE.                                    04380011
043900     WRITE REPORT-RECORD FROM RH1-REPORT-HEAD1                    04390011
044000         AFTER ADVANCING 1 LINE.                                  04400011
044100     WRITE REPORT-RECORD FROM CH1-COLUMN-HEAD1                    04410011
044200         AFTER ADVANCING 2 LINES.                                 04420011
044300     WRITE REPORT-RECORD FROM MC-BLANK-LINE                       04430011
044400         AFTER ADVANCING 1 LINE.                                  04440011
044500     MOVE +6            TO PC-LINE-COUNT.                         04450011
