000100*-----------------------*                                         00010024
000200 IDENTIFICATION DIVISION.                                         00020024
000300*-----------------------*                                         00030024
000400 PROGRAM-ID.    PCKCS157.                                         00040024
000500 AUTHOR.        BETH A. BILSKI.                                   00050024
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060024
000700 DATE-WRITTEN.  02/15.                                            00070024
000800 DATE-COMPILED.                                                   00080024
000900                                                                  00090024
001000*---------------------------------------------------------------* 00100024
001100*    NOTE:  WHEN VEND_OUTR_PACK_QTY IS ADDED TO THE DB2P TSK      00110024
001200*           TABLE, DO A "C ALL '*OUTR' TO '     '" & RECOMPILE    00120024
001300*---------------------------------------------------------------* 00130024
001400*    E157 - WORK ORDER INSTRUCTION LIST.                        * 00140024
001500*                                                               * 00150024
001600*    THIS PROGRAM GENERATES A LIST OF WORK ORDER INSTRUCTIONS   * 00160024
001700*    FOR THE REQUESTED WORK ORDER.                              * 00170024
001800*                                                               * 00180024
001900*    IR-103:  ALLOW ZERO TO BE ENTERED INTO THE ACTUAL CARTON   * 00190024
002000*             COUNT FIELD; DEFAULT TO ZERO IF NOTHING ENTERED.  * 00200024
002100*             BY M. FURLICK, 5/25/94.                           * 00210024
002200*                                                               * 00220024
002300*    DC-162:  WHEN MORE THERE IS MORE DATA THAN CAN FIT ON ONE  * 00230024
002400*             SCREEN THE USER IS UNABLE TO ADD; OPER SET ID IS  * 00240024
002500*             VALIDATED INCORRECTLY:  FIXED                     * 00250024
002600*             BY M. FURLICK, 7/18/94.                           * 00260024
002700*                                                               * 00270024
002800*    DC-198:  CHECK FOR DUPLICATE WORK ORDER INSTRUCTIONS       * 00280024
002900*             BEFORE ADDING A NEW INSTRUCTION.                  * 00290024
003000*             BY B. BILSKI,  8/16/94.                           * 00300024
003100*                                                               * 00310024
003200*    WR-28767 REMOVE ARCHIVING OF TRECEIVER SEGMENT REPLACE     * 00320024
003300*             WITH UPDATE.                                      * 00330024
003400*             BY GARDNER     8/26/94                            * 00340024
003500*                                                               * 00350024
003600*---------------------------------------------------------------* 00360024
003610* DATE  11/04/2021                                                00361047
003620*            - CHANGE CALL OF 'DPKUT100' TO                     * 00362047
003630*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00363047
003640*              MAKING THE CALL DYNAMIC VS STATIC                * 00364047
003650*     MADE BY: GERMAN BANDA            WR/IR #: CHG0264232        00365048
1122RM*---------------------------------------------------------------- 00365149
1122RM* DATE  11/07/2022                                              * 00365249
1122RM*            - ADD COPYBOOK DPWS930                             * 00365349
1122RM*              CHANGE CALL TO DPWS030 FROM STATIC TO            * 00365449
1122RM*              DYNAMIC.                                         * 00365549
1122RM*     MADE BY: BOB MCASEY              WR/IR #: CHG0277910      * 00365649
003660*-----------------------------------------------------------------00366047
003700/                                                                 00370024
003800 ENVIRONMENT DIVISION.                                            00380024
003900                                                                  00390024
004000 DATA DIVISION.                                                   00400024
004100                                                                  00410024
004200 WORKING-STORAGE SECTION.                                         00420024
004300 01  DK-DB2-KEYS.                                                 00430024
004400*    REQUIRED FIELDS                                              00440024
004500     05  DK-ORD-NBR                     PIC S9(09)  COMP.         00450024
004600     05  DK-LINE-NBR                    PIC S9(09)  COMP.         00460024
004700     05  DK-OPERATING-UNIT-ID           PIC S9(04)  COMP.         00470024
004800     05  DK-FACT                        PIC S9(04)  COMP.         00480024
004900     05  DK-RCVR-SEQ-NBR                PIC S9(09)  COMP.         00490024
005000     05  DK-OPER-SET-ID                 PIC S9(04)  COMP.         00500024
005100                                                                  00510024
005200 01  PC-PROGRAM-CONSTANTS.                                        00520024
005300     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00530024
005400                                                    'PC157A  '.   00540024
005500     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00550024
005600                                                    'PCKM157 '.   00560024
005700     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00570024
005800                                                    'PCKCS157'.   00580024
005900     05  PC-AUDIT-RTN                   PIC  X(08)  VALUE         00590024
006000                                                    'RCKCS290'.   00600024
006100     05  PC-AUDIT-RTN-LENGTH            PIC S9(04)  VALUE  +300   00610024
006200                                                    COMP SYNC.    00620024
006300     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00630024
006400     05  PC-SEL-QUEUE-SEQ2              PIC  9(01)  VALUE 3.      00640024
006500     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +08     00650024
006600                                                    COMP SYNC.    00660024
006700     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00670024
006800                                                    COMP SYNC.    00680024
006900     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00690024
007000                                                    COMP SYNC.    00700024
007100     05  PC-A                           PIC  X(01)  VALUE 'A'.    00710024
007200     05  PC-N                           PIC  X(01)  VALUE 'N'.    00720024
007300     05  PC-AC                          PIC  X(02)  VALUE 'AC'.   00730024
007400     05  PC-CM                          PIC  X(02)  VALUE 'CM'.   00740024
007500     05  PC-IP                          PIC  X(02)  VALUE 'IP'.   00750024
007600     05  PC-VE                          PIC  X(02)  VALUE 'VE'.   00760024
007700     05  PC-5                           PIC  9(01)  VALUE 5.      00770024
007800     05  PC-DUMMY-CCYY                  PIC  X(04)  VALUE '9989'. 00780024
007900                                                                  00790024
008000     05  PC-LQW-SAVE-FIELDS.                                      00800024
008100         10  PC-SAVE-PO-NBR                 PIC  ZZZZZZZ9.        00810024
008200         10  PC-LINE-NBR                    PIC S9(09)  COMP.     00820024
008300         10  PC-WRK-ORD                     PIC S9(04)  COMP      00830024
008400                                                VALUE +1.         00840024
008500         10  PC-ITM-NBR                     PIC S9(15)V           00850024
008600                                                 COMP-3.          00860024
008700         10  PC-ACTUAL-CART-QTY             PIC S9(09) COMP.      00870024
008800         10  PC-INSTR-ACTL-CART-QTY         PIC S9(09) COMP.      00880024
008900         10  PC-INSTR-EXPT-CART-QTY         PIC S9(09) COMP.      00890024
009000         10  PC-ACTUAL-ITEM-QTY             PIC S9(09) COMP.      00900024
009100         10  PC-ZERO                        PIC S9(09) COMP       00910024
009200                                                 VALUE +0.        00920024
009300         10  PC-SPACE1                      PIC X(01)             00930024
009400                                                VALUE SPACES.     00940024
009500         10  PC-SPACE5                      PIC X(05)             00950024
009600                                                VALUE SPACES.     00960024
009700         10  PC-SET-ID                      PIC S9(04)  COMP.     00970024
009800         10  PC-INSTR-SEQ-NBR               PIC S9(04)  COMP.     00980024
009900         10  PC-STRT-TMST                   PIC X(26)   VALUE     00990024
010000                             '9999-09-09-09.09.09.999999'.        01000024
010100         10  PC-STOP-TMST                   PIC X(26)   VALUE     01010024
010200                             '9999-09-09-09.09.09.999999'.        01020024
010300     05  PC-CURRENT-DATE.                                         01030024
010400         10  PC-CURR-MM                     PIC X(02).            01040024
010500         10  FILLER                         PIC X(01) VALUE '/'.  01050024
010600         10  PC-CURR-DD                     PIC X(02).            01060024
010700         10  FILLER                         PIC X(01) VALUE '/'.  01070024
010800         10  PC-CURR-YY                     PIC X(02).            01080024
010900     05  PC-CURRENT-TIME.                                         01090024
011000         10  PC-CURR-HH                     PIC X(02).            01100024
011100         10  FILLER                         PIC X(01) VALUE ':'.  01110024
011200         10  PC-CURR-MIN                    PIC X(02).            01120024
011300     05  PC-INTER-APPL-CODES.                                     01130024
011400         10  PC-INTER-APPL-CRIT-SPEC                              01140024
011500                                  PIC  X(01)  VALUE '1'.          01150024
011600         10  PC-INTER-APPL-LIST   PIC  X(01)  VALUE '5'.          01160024
011700                                                                  01170024
011800     05  PC-TSYMSG-NUMBERS.                                       01180024
011900         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  01190024
012000         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  01200024
012100         10  PC-TSYMSG-00010            PIC  9(05)  VALUE 00010.  01210024
012200         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  01220024
012300         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  01230024
012400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  01240024
012500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  01250024
012600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  01260024
012700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  01270024
012800         10  PC-TSYMSG-00117            PIC  9(05)  VALUE 00117.  01280024
012900         10  PC-TSYMSG-00148            PIC  9(05)  VALUE 00148.  01290024
013000         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  01300024
013100         10  PC-TSYMSG-00627            PIC  9(05)  VALUE 00627.  01310024
013200         10  PC-TSYMSG-00749            PIC  9(05)  VALUE 00749.  01320024
013300*                                                                 01330024
013400 01  PS-PROGRAM-SWITCHES.                                         01340024
013500     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    01350024
013600         88  PS-NO-ERROR                            VALUE 'Y'.    01360024
013700         88  PS-ERROR                               VALUE 'N'.    01370024
013800     05  PS-DATA-OK-SW                  PIC  X(01)  VALUE 'N'.    01380024
013900         88  PS-DATA-OK                             VALUE 'Y'.    01390024
014000         88  PS-DATA-NOT-OK                         VALUE 'N'.    01400024
014100     05  PS-OPER-SET-ENTERED-SW         PIC  X(01)  VALUE 'N'.    01410024
014200         88  PS-OPER-SET-ENTERED                    VALUE 'Y'.    01420024
014300     05  PS-OPER-SET-ERROR-SW           PIC  X(01)  VALUE ' '.    01430024
014400         88  PS-NOT-NUMERIC-OPER-SET                VALUE 'N'.    01440024
014500         88  PS-OPER-SET-IS-ZERO                    VALUE '0'.    01450024
014600         88  PS-INVALID-OPER-SET                    VALUE 'I'.    01460024
014700*                                                                 01470024
014800 01  PV-PROGRAM-VARIABLES.                                        01480024
014900     05  PV-SUB                         PIC S9(04)  VALUE +0      01490024
015000                                                    COMP SYNC.    01500024
015100     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      01510024
015200                                                    COMP SYNC.    01520024
015300     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      01530024
015400                                                    COMP-3.       01540024
015500     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01550024
015600                                                    COMP-3.       01560024
015700     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01570024
015800                                                    COMP-3.       01580024
015900     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01590024
016000                                                    COMP-3.       01600024
016100     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01610024
016200                                                    COMP-3.       01620024
016300     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01630024
016400                                                    COMP-3.       01640024
016500     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01650024
016600                                                    COMP SYNC.    01660024
016700     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01670024
016800                                                    COMP SYNC.    01680024
016900     05  PV-ITEM                        PIC S9(04)  VALUE +0      01690024
017000                                                    COMP SYNC.    01700024
017100     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01710024
017200                                                    COMP SYNC.    01720024
017300     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01730024
017400                                                    COMP SYNC.    01740024
017500     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01750024
017600                                                    COMP SYNC.    01760024
017700     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01770024
017800                                                    COMP SYNC.    01780024
017900     05  PV-NULL-IND                    PIC S9(4)   VALUE +0      01790024
018000                                                    COMP.         01800024
018100     05  PV-DB2-COUNT                   PIC S9(9)   VALUE +0      01810024
018200                                                    COMP-3.       01820024
018300     05  PV-CURRENT-YEAR                PIC S9(09)  VALUE ZERO    01830024
018400                                        COMP SYNC.                01840024
018500     05  PV-SKU                         PIC  X(08).               01850027
018600     05  PV-DEPT                        PIC  X(03).               01860027
018700     05  PV-CL                          PIC  X(02).               01870027
018800     05  PV-DISPLAY-SKU-NBR             PIC X(08).                01880029
018900                                                                  01890029
019000 01  IC-ISO-CURRENT-DATE-AREA.                                    01900024
019100     05  IC-ISO-CURRENT-DATE-X.                                   01910024
019200         10  IC-CURRENT-YEAR     PIC 9(4)     VALUE ZERO.         01920024
019300         10  FILLER              PIC X(6)     VALUE SPACES.       01930024
019400     05  FILLER                  REDEFINES IC-ISO-CURRENT-DATE-X. 01940024
019500         10  FILLER              PIC X(2).                        01950024
019600         10  IC-CURRENT-YY-MM-DD PIC X(8).                        01960024
019700     05  IC-ISO-CURRENT-DATE     REDEFINES IC-ISO-CURRENT-DATE-X  01970024
019800                                 PIC X(10).                       01980024
019900                                                                  01990024
020000 01  ST-SYSTEM-TIME-AREA.                                         02000024
020100     05  ST-ABSTIME              PIC S9(18)   VALUE ZERO          02010024
020200                                 COMP SYNC.                       02020024
020300     05  ST-TIME-EDIT.                                            02030024
020400         10  ST-TIME-HHMM        PIC X(5)     VALUE SPACES.       02040024
020500         10  FILLER              PIC X(3)     VALUE SPACES.       02050024
020600                                                                  02060024
020700/                                                                 02070024
020800*----------------------------------------------------------------*02080024
020900*   THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.    *02090024
021000*   THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE            *02100024
021100*   APPLICATION-SPECIFIC COMMAREA.                               *02110024
021200*----------------------------------------------------------------*02120024
021300 01  LQW-LIST-QUEUE-WORK-AREA.                                    02130024
021400     05  LQW-BLOCK-MODIFIED             PIC  X(01)    VALUE SPACE.02140024
021500     05  LQW-ITEM-ENTRIES               OCCURS 08 TIMES           02150024
021600                                        INDEXED BY LQW-IDX.       02160024
021700         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)    COMP-3.     02170024
021800         10  LQW-LINE-NBR               PIC  X(04).               02180024
021900         10  LQW-WRK-ORD                PIC S9(04)    COMP.       02190024
022000         10  LQW-CL-NBR                 PIC  X(02).               02200024
022100*        10  LQW-SEQ-NBR                PIC  X(03).               02210040
022200         10  LQW-NIS-SEQ-NBR            PIC  X(08).               02220040
022300         10  LQW-SKU-DESC               PIC  X(25).               02230024
022400         10  LQW-ITM-NBR                PIC S9(15)V               02240024
022500                                            COMP-3.               02250024
022600         10  LQW-VER-NBR                PIC S9(09)                02260024
022700                                            COMP.                 02270024
022800         10  LQW-STAT                   PIC  X(02).               02280024
022900         10  LQW-ACTUAL-CART-QTY-X.                               02290024
023000             15  LQW-ACTUAL-CART-QTY    PIC  9(05).               02300024
023100         10  LQW-ACTUAL-CART-SW         PIC  X(01)    VALUE 'Y'.  02310024
023200             88  LQW-ACTUAL-CART-NOERR                VALUE 'Y'.  02320024
023300             88  LQW-ACTUAL-CART-ERR                  VALUE 'N'.  02330024
023400         10  LQW-ACTUAL-ITEM-QTY-X.                               02340024
023500             15  LQW-ACTUAL-ITEM-QTY    PIC  9(05).               02350024
023600         10  LQW-ACTUAL-ITEM-SW         PIC  X(01)    VALUE 'Y'.  02360024
023700             88  LQW-ACTUAL-ITEM-NOERR                VALUE 'Y'.  02370024
023800             88  LQW-ACTUAL-ITEM-ERR                  VALUE 'N'.  02380024
023900         10  LQW-CREATE-DATE            PIC  X(08).               02390024
024000         10  LQW-CREATE-TIME            PIC  X(05).               02400024
024100         10  LQW-OPER-SET-ID-X.                                   02410024
024200             15  LQW-OPER-SET-ID        PIC  9(03).               02420024
024300         10  LQW-OPER-SET-ID-SW         PIC  X(01)    VALUE 'Y'.  02430024
024400             88  LQW-OPER-SET-NOERR                   VALUE 'Y'.  02440024
024500             88  LQW-OPER-SET-ERR                     VALUE 'N'.  02450024
024600/                                                                 02460024
024700*---------------------------------------------------------------* 02470024
024800*  RECORD LAYOUT 'INSERT AUDIT MODULE'  RCKCS290                * 02480024
024900*---------------------------------------------------------------* 02490024
025000                                                                  02500024
025100     COPY RCWS031.                                                02510024
025200                                                                  02520024
025300/                                                                 02530024
025400*---------------------------------------------------------------* 02540024
025500*  RECORD LAYOUT FOR THE INPUT SELECTION QUEUE.                 * 02550024
025600*---------------------------------------------------------------* 02560024
025700                                                                  02570024
025800     COPY PCWS016.                                                02580024
025900                                                                  02590024
026000/                                                                 02600024
026100*---------------------------------------------------------------* 02610024
026200*    MAP LAYOUT                                                 * 02620024
026300*---------------------------------------------------------------* 02630024
026400                                                                  02640024
026500     COPY PCKM157.                                                02650024
026600*                                                                 02660024
026700 01  MR-OCCURS-LAYOUT                   REDEFINES  PC157AO.       02670024
026800     05  FILLER                         PIC X(125).               02680033
026900     05  MR-SCROLL-AREA                 OCCURS  8 TIMES.          02690024
027000         10  MR-LINEL                   PIC S9(04) COMP.          02700024
027100         10  MR-LINEA                   PIC  X(01).               02710024
027200         10  MR-LINEC                   PIC  X(01).               02720024
027300         10  MR-LINEH                   PIC  X(01).               02730024
027400         10  MR-LINE-X.                                           02740024
027500             15  MR-LINE                PIC  ZZZ9.                02750024
027600                                                                  02760024
027700         10  MR-WORK-ORDL               PIC S9(04) COMP.          02770024
027800         10  MR-WORK-ORDA               PIC  X(01).               02780024
027900         10  MR-WORK-ORDC               PIC  X(01).               02790024
028000         10  MR-WORK-ORDH               PIC  X(01).               02800024
028100         10  MR-WORK-ORD-X.                                       02810024
028200             15  MR-WORK-ORD            PIC  ZZ9.                 02820024
028300                                                                  02830024
028400         10  MR-CLL                     PIC S9(04) COMP.          02840034
028500         10  MR-CLA                     PIC  X(01).               02850034
028600         10  MR-CLC                     PIC  X(01).               02860034
028700         10  MR-CLH                     PIC  X(01).               02870034
028800         10  MR-CL                      PIC  X(02).               02880034
028900                                                                  02890024
029000         10  MR-SKUL                    PIC S9(04) COMP.          02900041
029100         10  MR-SKUA                    PIC  X(01).               02910034
029200         10  MR-SKUC                    PIC  X(01).               02920034
029300         10  MR-SKUH                    PIC  X(01).               02930034
029400         10  MR-SKU                     PIC  X(08).               02940034
029500                                                                  02950034
029600         10  MR-SKU-DESCL               PIC S9(04) COMP.          02960024
029700         10  MR-SKU-DESCA               PIC  X(01).               02970024
029800         10  MR-SKU-DESCC               PIC  X(01).               02980024
029900         10  MR-SKU-DESCH               PIC  X(01).               02990024
030000         10  MR-SKU-DESC                PIC  X(20).               03000024
030100                                                                  03010024
030200         10  MR-STATUSL                 PIC S9(04) COMP.          03020024
030300         10  MR-STATUSA                 PIC  X(01).               03030024
030400         10  MR-STATUSC                 PIC  X(01).               03040024
030500         10  MR-STATUSH                 PIC  X(01).               03050024
030600         10  MR-STATUS                  PIC  X(02).               03060024
030700                                                                  03070024
030800         10  MR-ACTUL-QTYL              PIC S9(04) COMP.          03080024
030900         10  MR-ACTUL-QTYA              PIC  X(01).               03090024
031000         10  MR-ACTUL-QTYC              PIC  X(01).               03100024
031100         10  MR-ACTUL-QTYH              PIC  X(01).               03110024
031200         10  MR-ACTUL-QTY-X.                                      03120024
031300             15  MR-ACTUL-QTY           PIC  ZZZZ9.               03130024
031400                                                                  03140024
031500         10  MR-AITEM-QTYL              PIC S9(04) COMP.          03150024
031600         10  MR-AITEM-QTYA              PIC  X(01).               03160024
031700         10  MR-AITEM-QTYC              PIC  X(01).               03170024
031800         10  MR-AITEM-QTYH              PIC  X(01).               03180024
031900         10  MR-AITEM-QTY-X.                                      03190024
032000             15  MR-AITEM-QTY           PIC  ZZZZ9.               03200024
032100                                                                  03210024
032200         10  MR-CREATE-DTEL             PIC S9(04) COMP.          03220024
032300         10  MR-CREATE-DTEA             PIC  X(01).               03230024
032400         10  MR-CREATE-DTEC             PIC  X(01).               03240024
032500         10  MR-CREATE-DTEH             PIC  X(01).               03250024
032600         10  MR-CREATE-DTE              PIC  X(08).               03260024
032700                                                                  03270024
032800         10  MR-CREATE-TMEL             PIC S9(04) COMP.          03280024
032900         10  MR-CREATE-TMEA             PIC  X(01).               03290024
033000         10  MR-CREATE-TMEC             PIC  X(01).               03300024
033100         10  MR-CREATE-TMEH             PIC  X(01).               03310024
033200         10  MR-CREATE-TME              PIC  X(05).               03320024
033300                                                                  03330024
033400         10  MR-OPER-SETL               PIC S9(04) COMP.          03340024
033500         10  MR-OPER-SETA               PIC  X(01).               03350024
033600         10  MR-OPER-SETC               PIC  X(01).               03360024
033700         10  MR-OPER-SETH               PIC  X(01).               03370024
033800         10  MR-OPER-SET-X.                                       03380024
033900             15  MR-OPER-SET            PIC  ZZ9.                 03390024
034000                                                                  03400024
034100/                                                                 03410024
034200*---------------------------------------------------------------* 03420024
034300*    ATTRIBUTE SETTINGS COPYBOOK.                               * 03430024
034400*---------------------------------------------------------------* 03440024
034500                                                                  03450024
034600     COPY DPWS015.                                                03460024
034700                                                                  03470024
034800*---------------------------------------------------------------* 03480024
034900*    FUNCTION KEYS COPYBOOK.                                    * 03490024
035000*---------------------------------------------------------------* 03500024
035100                                                                  03510024
035200     COPY DPWS016.                                                03520024
035300                                                                  03530024
035400*---------------------------------------------------------------* 03540024
035500*    DATE AND TIME COPYBOOK.                                    * 03550024
035600*---------------------------------------------------------------* 03560024
035700                                                                  03570024
035800     COPY DPWS017.                                                03580024
035900                                                                  03590024
036000*---------------------------------------------------------------* 03600024
036100*    NUMERIC EDIT LAYOUT.                                       * 03610024
036200*---------------------------------------------------------------* 03620024
036300                                                                  03630024
036400     COPY DPWS010I.                                               03640024
036500/                                                                 03650024
036600*---------------------------------------------------------------* 03660024
036700*    PARAMETERS FOR CALLING CICS ARCHITECTURE API (DPKCS030).   * 03670024
036800*---------------------------------------------------------------* 03680024
036900                                                                  03690024
037000     COPY DPWS030.                                                03700024
1122RM     COPY DPWS930.                                                03701049
037100/                                                                 03710024
037200*---------------------------------------------------------------* 03720024
037300*    STANDARD COMMAREA.                                         * 03730024
037400*---------------------------------------------------------------* 03740024
037500                                                                  03750024
037600     COPY DPWS020.                                                03760024
037700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                03770024
037800                                                                  03780024
037900         10  INTER-APPL-COMM-AREA       PIC X(200).               03790024
038000     COPY PCWS000.                                                03800024
038100*---------------------------------------------------------------* 03810024
038200*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 03820024
038300*---------------------------------------------------------------* 03830024
038400                                                                  03840024
038500         10  ASC-SPECIFIC-COMMAREA.                               03850024
038600             15  ASC-LIST-KEYS.                                   03860024
038700                 20  ASC-OPERATING-UNIT-ID           PIC S9(04)   03870024
038800                                                     COMP.        03880024
038900                 20  ASC-FACILITY-ID                 PIC S9(04)   03890024
039000                                                     COMP.        03900024
039100                 20  ASC-KEY-PO-NBR                  PIC S9(09)   03910024
039200                                                     COMP.        03920024
039300                 20  ASC-KEY-OPER-UNT-ID             PIC S9(04)   03930024
039400                                                     COMP.        03940024
039500                 20  ASC-KEY-FCLTY-ID                PIC S9(04)   03950024
039600                                                     COMP.        03960024
039700*                20  ASC-KEY-PO-NBR                  PIC 9(08).   03970024
039800                 20  ASC-PO-VER-NBR                  PIC S9(09)   03980024
039900                                                     COMP.        03990024
040000                 20  ASC-RECITM-PO-VER-NBR           PIC S9(09)   04000024
040100                                                     COMP.        04010024
040200                 20  ASC-KEY-RCVR-SEQ-NBR            PIC S9(09)   04020024
040300                                                     COMP.        04030024
040400                 20  ASC-DEPT-NBR                    PIC  X(03).  04040036
040500*                20  ASC-KEY-RCVR-SEQ-NBR            PIC  9(03).  04050024
040600                 20  ASC-OPERATION-SET-ID-X.                      04060024
040700                     25  ASC-OPERATION-SET-ID        PIC  9(03).  04070024
040800                 20  ASC-ACTUAL-CART-CNT             PIC  9(05).  04080024
040900                 20  ASC-EXPTED-CART-CNT             PIC  9(05).  04090024
041000                 20  ASC-STATUS                      PIC  X(02).  04100024
041100             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                04110024
041200                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  04120024
041300                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   04130024
041400                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   04140024
041500                                                                  04150024
041600                 20  ASC-ITEM-ARRAY.                              04160024
041700                     25  ASC-ITEM-ENTRIES OCCURS 08 TIMES.        04170024
041800                         30  ASC-LIST-ITEM-NUMBER                 04180024
041900                                                     PIC S9(09)   04190024
042000                                                     COMP-3.      04200024
042100                         30  ASC-LINE-NBR            PIC  X(04).  04210024
042200                         30  ASC-WRK-ORD             PIC S9(04)   04220024
042300                                                          COMP.   04230024
042400                         30  ASC-CL-NBR              PIC  X(02).  04240024
042500*                        30  ASC-SEQ-NBR             PIC  X(03).  04250027
042600                         30  ASC-NIS-SEQ-NBR         PIC  X(08).  04260027
042700                         30  ASC-SKU-DESC            PIC  X(25).  04270024
042800                         30  ASC-ITM-NBR             PIC S9(15)V  04280024
042900                                                         COMP-3.  04290024
043000                         30  ASC-VER-NBR             PIC S9(09)   04300024
043100                                                         COMP.    04310024
043200                         30  ASC-STAT                PIC  X(02).  04320024
043300                         30  ASC-ACTUAL-CART-QTY-X.               04330024
043400                             35  ASC-ACTUAL-CART-QTY PIC  9(05).  04340024
043500                         30  ASC-ACTL-CART-SW        PIC X(01).   04350024
043600                             88  ASC-ACTL-CART-NOERR VALUE 'Y'.   04360024
043700                             88  ASC-ACTL-CART-ERR   VALUE 'N'.   04370024
043800                         30  ASC-ACTUAL-ITEM-QTY-X.               04380024
043900                             35  ASC-ACTUAL-ITEM-QTY PIC  9(05).  04390024
044000                         30  ASC-ACTL-ITEM-SW        PIC X(01).   04400024
044100                             88  ASC-ACTL-ITEM-NOERR VALUE 'Y'.   04410024
044200                             88  ASC-ACTL-ITEM-ERR   VALUE 'N'.   04420024
044300                         30  ASC-CREATE-DATE         PIC  X(08).  04430024
044400                         30  ASC-CREATE-TIME         PIC  X(05).  04440024
044500                         30  ASC-OPER-SET-ID-X.                   04450024
044600                             35  ASC-OPER-SET-ID     PIC  9(03).  04460024
044700                         30  ASC-OPER-SET-ID-SW      PIC X(01).   04470024
044800                             88  ASC-OPER-SET-NOERR  VALUE 'Y'.   04480024
044900                             88  ASC-OPER-SET-ERR    VALUE 'N'.   04490024
045000             15  ASC-BLK-SUB                         PIC S9(04)   04500024
045100                                                          COMP    04510024
045200                                                          SYNC.   04520024
045300             15  ASC-ITEM-SUB                        PIC S9(04)   04530024
045400                                                          COMP    04540024
045500                                                          SYNC.   04550024
045600             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   04560024
045700                                                          COMP-3. 04570024
045800             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   04580024
045900                                                          COMP-3. 04590024
046000             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   04600024
046100                                                          COMP-3. 04610024
046200             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   04620024
046300                                                          COMP-3. 04630024
046400             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   04640024
046500                                                          COMP-3. 04650024
046600             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   04660024
046700                                                          COMP    04670024
046800                                                          SYNC.   04680024
046900             15  ASC-START-OF-SELECTED-RANGE         PIC S9(09)   04690024
047000                                                          COMP-3. 04700024
047100             15  ASC-END-OF-SELECTED-RANGE           PIC S9(09)   04710024
047200                                                          COMP-3. 04720024
047300             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  04730024
047400                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   04740024
047500                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   04750024
047600             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  04760024
047700                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   04770024
047800                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   04780024
047900             15  ASC-LIST-QUEUE-NAME.                             04790024
048000                 20  ASC-LIST-TERM-ID                PIC  X(04).  04800024
048100                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   04810024
048200                                                          COMP-3. 04820024
048300                 20  ASC-LIST-SEQ                    PIC  9(01).  04830024
048400             15  ASC-SEL-QUEUE-NAME.                              04840024
048500                 20  ASC-SEL-TERM-ID                 PIC  X(04).  04850024
048600                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   04860024
048700                                                          COMP-3. 04870024
048800                 20  ASC-SEL-SEQ                     PIC  9(01).  04880024
048900             15  ASC-SEL-QUEUE-NAME2.                             04890024
049000                 20  ASC-SEL-TERM-ID2                PIC  X(04).  04900024
049100                 20  ASC-SEL-TASK-NUMBER2            PIC S9(05)   04910024
049200                                                          COMP-3. 04920024
049300                 20  ASC-SEL-SEQ2                    PIC  9(01).  04930024
049400                                                                  04940024
049500             15  ASC-INT-APPL-FORMAT-IND             PIC  X(01).  04950024
049600             15  ASC-USE-SELECTION-QUEUE-IND                      04960024
049700                                           PIC  X(01).            04970024
049800                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 04980024
049900             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    04990024
050000             15  ASC-SEL-SUB               PIC S9(04)  COMP.      05000024
050100             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      05010024
050200                                                                  05020024
050300             15  ASC-PACK-BY-ST-IND                  PIC  X(01).  05030024
050400             15  ASC-CURSOR-SW                       PIC  X(01).  05040024
050500                 88  ASC-NO-CURSOR                   VALUE 'Z'.   05050024
050600                 88  ASC-SYSTEM-ID-CURSOR            VALUE 'S'.   05060024
050700                 88  ASC-MESSAGE-NUMBER-CURSOR       VALUE 'N'.   05070024
050800                 88  ASC-MESSAGE-TEXT-CURSOR         VALUE 'T'.   05080024
050900             15  ASC-START-ITEM-REQUEST.                          05090024
051000                 20  ASC-START-ITEM-REQUEST-N        PIC  9(05).  05100024
051100             15  ASC-EDIT-CONTROL-SW                 PIC  X(01).  05110024
051200                 88  ASC-RECORD-NOT-ADDED            VALUE 'N'.   05120024
051300                 88  ASC-RECORD-ADDED                VALUE 'Y'.   05130024
051400             15  ASC-LOCATION              PIC  9(04).            05140041
051500             15  ASC-RECEIV-STATUS-CDE     PIC  X(02).            05150024
051600             15  ASC-ML-POST-TMST          PIC  X(26).            05160024
051700             15  FILLER  REDEFINES  ASC-ML-POST-TMST.             05170024
051800                 20  ASC-ML-POST-CCYY      PIC  X(04).            05180024
051900                 20  FILLER                PIC  X(22).            05190024
052000             15  ASC-FS-POST-TMST          PIC  X(26).            05200024
052100             15  FILLER  REDEFINES  ASC-FS-POST-TMST.             05210024
052200                 20  ASC-FS-POST-CCYY      PIC  X(04).            05220024
052300                 20  FILLER                PIC  X(22).            05230024
052400             15  ASC-HOLD-INTER-APPL                 PIC X(200).  05240024
052500/                                                                 05250024
052600*---------------------------------------------------------------* 05260024
052700*    ABEND PROCESSING COPYBOOK.                                 * 05270024
052800*---------------------------------------------------------------* 05280024
052900                                                                  05290024
053000     COPY DPWS013.                                                05300024
053100                                                                  05310024
053200/                                                                 05320024
053300*---------------------------------------------------------------* 05330028
053400*    LOGISTICS DOMAIN ITEM ACCESS MODULE COPYBOOK.              * 05340031
053500*---------------------------------------------------------------* 05350028
053600                                                                  05360028
053700     COPY XLWS001.                                                05370028
053800                                                                  05380028
053900/                                                                 05390028
054000*---------------------------------------------------------------* 05400024
054100*    DB2 AREA FOR TWKORIN                                       * 05410024
054200*---------------------------------------------------------------* 05420024
054300     EXEC SQL                                                     05430024
054400          INCLUDE TWKORIN                                         05440024
054500     END-EXEC.                                                    05450024
054600*---------------------------------------------------------------* 05460024
054700*    DB2 AREA FOR TWRKORD                                       * 05470024
054800*---------------------------------------------------------------* 05480024
054900     EXEC SQL                                                     05490024
055000          INCLUDE TWRKORD                                         05500024
055100     END-EXEC.                                                    05510024
055200*---------------------------------------------------------------* 05520024
055300*    DB2 AREA FOR TRECITM                                       * 05530024
055400*---------------------------------------------------------------* 05540024
055500     EXEC SQL                                                     05550024
055600          INCLUDE TRECITM                                         05560024
055700     END-EXEC.                                                    05570024
055800*---------------------------------------------------------------* 05580024
055900*    DB2 AREA FOR TRECEIV                                       * 05590024
056000*---------------------------------------------------------------* 05600024
056100     EXEC SQL                                                     05610024
056200          INCLUDE TRECEIV                                         05620024
056300     END-EXEC.                                                    05630024
056400*---------------------------------------------------------------* 05640024
056500*    DB2 AREA FOR TOSOPFA                                       * 05650024
056600*---------------------------------------------------------------* 05660024
056700     EXEC SQL                                                     05670024
056800          INCLUDE TOSOPFA                                         05680024
056900     END-EXEC.                                                    05690024
057000*---------------------------------------------------------------* 05700024
057100*    DB2 AREA FOR TOPRSET                                       * 05710024
057200*---------------------------------------------------------------* 05720024
057300     EXEC SQL                                                     05730024
057400          INCLUDE TOPRSET                                         05740024
057500     END-EXEC.                                                    05750024
057600*---------------------------------------------------------------* 05760024
057700*    DB2 AREA FOR COMMUNICATIONS                                * 05770024
057800*---------------------------------------------------------------* 05780024
057900     EXEC SQL                                                     05790024
058000          INCLUDE SQLCA                                           05800024
058100     END-EXEC.                                                    05810024
058200                                                                  05820024
058300*---------------------------------------------------------------* 05830024
058400*    CURSOR DECLARATION FOR LIST.                               * 05840024
058500*---------------------------------------------------------------* 05850024
058600                                                                  05860024
058700     EXEC SQL                                                     05870024
058800          DECLARE TOSOPFA_CSR CURSOR                              05880024
058900          FOR SELECT                                              05890024
059000                OPER_SET_ID                                       05900024
059100               ,OPER_ID                                           05910024
059200               ,OPER_UNT_ID                                       05920024
059300               ,FCLTY_ID                                          05930024
059400               ,FCLTY_AREA_ID                                     05940024
059500               ,PRC_FCLTY_AREA_ID                                 05950024
059600               ,CRE_TMST                                          05960024
059700               ,VER_STATUS_CDE                                    05970024
059800               ,CRE_UID_ID                                        05980024
059900               ,SCRN_SEQ_NBR                                      05990024
060000          FROM                                                    06000024
060100                TOSOPFA                                           06010024
060200          WHERE                                                   06020024
060300                OPER_SET_ID        =  :PC-SET-ID                  06030024
060400            AND OPER_UNT_ID        =  :DK-OPERATING-UNIT-ID       06040045
060500          ORDER BY                                                06050024
060600                SCRN_SEQ_NBR                                      06060024
060700     END-EXEC.                                                    06070024
060800                                                                  06080024
060900*---------------------------------------------------------------* 06090024
061000*    CURSOR DECLARATION PACK SLIP.                              * 06100024
061100*---------------------------------------------------------------* 06110024
061200                                                                  06120024
061300/                                                                 06130024
061400 LINKAGE SECTION.                                                 06140024
061500                                                                  06150024
061600 01  DFHCOMMAREA.                                                 06160024
061700     05  FILLER                         OCCURS  1 TO 4072 TIMES   06170024
061800                                        DEPENDING ON EIBCALEN.    06180024
061900         10  FILLER                     PIC X.                    06190024
062000                                                                  06200024
062100 PROCEDURE DIVISION.                                              06210024
062200**--------------------------------------------------------------**06220024
062300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **06230024
062400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **06240024
062500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **06250024
062600**--------------------------------------------------------------**06260024
062700                                                                  06270024
062800 0000-MAIN-MODULE.                                                06280024
062900                                                                  06290024
063000     INITIALIZE DP030-CICS-API-FIELDS.                            06300024
063100     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06310024
063200     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06320024
063300     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06330024
063400     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06340024
063500                                                                  06350024
063600     MOVE LENGTH OF PC157AI        TO DP030-MAP-LENGTH (1).       06360024
063700     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06370024
063800     PERFORM 0001-CALL-CICS-ARCH-API.                             06380024
063900                                                                  06390024
064000     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       06400024
064100                                                                  06410024
064200     EXEC CICS                                                    06420024
064300         ASKTIME                                                  06430024
064400             ABSTIME(ST-ABSTIME)                                  06440024
064500     END-EXEC.                                                    06450024
064600     EXEC CICS                                                    06460024
064700         FORMATTIME                                               06470024
064800             ABSTIME(ST-ABSTIME)                                  06480024
064900             YYMMDD(IC-CURRENT-YY-MM-DD)                          06490024
065000             DATESEP('-')                                         06500024
065100     END-EXEC.                                                    06510024
065200     EXEC CICS                                                    06520024
065300         FORMATTIME                                               06530024
065400             ABSTIME(ST-ABSTIME)                                  06540024
065500             YEAR(PV-CURRENT-YEAR)                                06550024
065600     END-EXEC.                                                    06560024
065700                                                                  06570024
065800     MOVE PV-CURRENT-YEAR TO IC-CURRENT-YEAR.                     06580024
065900     MOVE DP017-CURRENT-YMD-YEAR    TO PC-CURR-YY.                06590024
066000     MOVE DP017-CURRENT-YMD-MONTH   TO PC-CURR-MM.                06600024
066100     MOVE DP017-CURRENT-YMD-DAY     TO PC-CURR-DD.                06610024
066200                                                                  06620024
066300     MOVE DP017-CURRENT-TIME-HOUR   TO PC-CURR-HH.                06630024
066400     MOVE DP017-CURRENT-TIME-MINUTE TO PC-CURR-MIN.               06640024
066500                                                                  06650024
066600     PERFORM 1000-CONTROL-PROCESSING                              06660024
066700                                                                  06670024
066800     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06680024
066900     PERFORM 0001-CALL-CICS-ARCH-API.                             06690024
067000                                                                  06700024
067100*----------------------------------------------------------------*06710024
067200*   THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE    *06720024
067300*   AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.          *06730024
067400*----------------------------------------------------------------*06740024
067500                                                                  06750024
067600 0001-CALL-CICS-ARCH-API.                                         06760024
067700                                                                  06770024
1122RM*    CALL 'DPKCS030' USING DFHEIBLK                               06780049
1122RM     CALL DP930-CICS-ARCH-API                                     06781049
1122RM                     USING DFHEIBLK                               06782049
067900                           DFHCOMMAREA                            06790024
068000                           DP030-CICS-API-FIELDS                  06800024
068100                           DP020-STANDARD-COMMAREA                06810024
068200                           PC157AI.                               06820024
068300                                                                  06830024
068400     IF  DP030-RC-CALL-SUCCESSFUL                                 06840024
068500         CONTINUE                                                 06850024
068600     ELSE                                                         06860024
068700         SET DP013-NO-ROLLBACK                                    06870024
068800             DP013-XCTL-DISPLAY-RESTART                           06880024
068900             DP013-CICS-ABEND      TO TRUE                        06890024
069000         MOVE '0001-CALL-CICS-ARCH-API'                           06900024
069100                                   TO DP013-PARAGRAPH             06910024
1122RM*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX06920049
1122RM*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      06930049
1122RM         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06931049
1122RM-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06932049
069400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      06940024
069500         PERFORM DP013-0000-PROCESS-ABEND                         06950024
069600     END-IF.                                                      06960024
069700                                                                  06970024
069800*----------------------------------------------------------------*06980024
069900* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *06990024
070000* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *07000024
070100*                                                                *07010024
070200* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *07020024
070300*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *07030024
070400*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *07040024
070500*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *07050024
070600*----------------------------------------------------------------*07060024
070700                                                                  07070024
070800 1000-CONTROL-PROCESSING.                                         07080024
070900                                                                  07090024
071000     EVALUATE TRUE                                                07100024
071100         WHEN DP020-NEXT-ACT-INITIAL                              07110024
071200              PERFORM 1100-FIND-OBJECT-KEYS                       07120024
071300              IF  PS-ERROR                                        07130024
071400                  CONTINUE                                        07140024
071500              ELSE                                                07150024
071600                  MOVE INTER-APPL-COMM-AREA                       07160024
071700                                   TO ASC-HOLD-INTER-APPL         07170024
071800                  MOVE EIBTRMID    TO ASC-LIST-TERM-ID            07180024
071900                                      ASC-SEL-TERM-ID2            07190024
072000                  MOVE DP020-SRC-TASK-NUMBER                      07200024
072100                                   TO ASC-LIST-TASK-NUMBER        07210024
072200                                      ASC-SEL-TASK-NUMBER2        07220024
072300                  MOVE PC-LIST-QUEUE-SEQ                          07230024
072400                                   TO ASC-LIST-SEQ                07240024
072500                  MOVE PC-SEL-QUEUE-SEQ2                          07250024
072600                                   TO ASC-SEL-SEQ2                07260024
072700                                                                  07270024
072800                  PERFORM 4000-BUILD-INITIAL-PANEL                07280024
072900                  IF  ASC-NUMBER-OF-ITEMS-READ = ZERO             07290024
073000                      SET DP020-NEXT-ACT-APPL-ERROR TO TRUE       07300024
073100                  END-IF                                          07310024
073200              END-IF                                              07320024
073300                                                                  07330024
073400         WHEN DP020-NEXT-ACT-READ-MAP                             07340024
073500              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07350024
073600                                   TO PV-TOP-ITEM                 07360024
073700              PERFORM 2000-PROCESS-PANEL                          07370024
073800                                                                  07380024
073900         WHEN DP020-NEXT-ACT-RETURN                               07390024
074000              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       07400024
074100                                   TO PV-TOP-ITEM                 07410024
074200              MOVE ZERO            TO ASC-ITEM-AT-TOP-OF-PANEL    07420024
074300              MOVE ASC-HOLD-INTER-APPL                            07430024
074400                                   TO INTER-APPL-COMM-AREA        07440024
074500              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                07450024
074600              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  07460024
074700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07470024
074800                                                                  07480024
074900         WHEN OTHER                                               07490024
075000              SET DP013-LOGIC-ABEND TO TRUE                       07500024
075100              SET DP013-NO-ROLLBACK TO TRUE                       07510024
075200              MOVE '1000-CONTROL-PROCESSING'                      07520024
075300                                   TO DP013-PARAGRAPH             07530024
075400              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   07540024
075500                                   TO DP013-MESSAGE-TEXT(1)       07550024
075600              PERFORM DP013-0000-PROCESS-ABEND                    07560024
075700     END-EVALUATE.                                                07570024
075800                                                                  07580024
075900*----------------------------------------------------------------*07590024
076000*  DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE    *07600024
076100*  INTER-APPLICATION FORMAT CODE.                                *07610024
076200*----------------------------------------------------------------*07620024
076300                                                                  07630024
076400 1100-FIND-OBJECT-KEYS.                                           07640024
076500                                                                  07650024
076600     INITIALIZE ASC-SPECIFIC-COMMAREA.                            07660024
076700     MOVE DP020-LOCATION-NBR       TO  ASC-LOCATION.              07670041
076800     MOVE DP020-INT-APPL-FORMAT-IND                               07680024
076900                                   TO  ASC-INT-APPL-FORMAT-IND.   07690024
077000                                                                  07700024
077100     EVALUATE DP020-INT-APPL-FORMAT-IND                           07710024
077200         WHEN PC-INTER-APPL-LIST                                  07720024
077300              SET ASC-USE-SELECTION-QUEUE TO TRUE                 07730024
077400              MOVE PC000-OPERATING-UNIT-ID                        07740024
077500                                   TO ASC-OPERATING-UNIT-ID       07750024
077600              MOVE PC000-FACILITY-ID                              07760024
077700                                   TO  ASC-FACILITY-ID            07770024
077800              MOVE PC000-NUMBER-OF-SELECTED-ITEMS                 07780024
077900                                   TO ASC-NUMBER-OF-SELECTED-ITEMS07790024
078000              MOVE PC000-NUMBER-OF-TS-ITEMS                       07800024
078100                                   TO  ASC-NUMBER-OF-TS-ITEMS     07810024
078200              MOVE PC000-SEL-QUEUE-NAME                           07820024
078300                                   TO  ASC-SEL-QUEUE-NAME         07830024
078400                                                                  07840024
078500         WHEN OTHER                                               07850024
078600              MOVE PC-TSYMSG-00148 TO  DP020-MSG-NUMBER           07860024
078700              SET DP020-MSG-FATAL                                 07870024
078800                  DP020-FK-RETURN (DP020-SRC-AID)                 07880024
078900                  PS-ERROR                                        07890024
079000                                   TO TRUE                        07900024
079100     END-EVALUATE.                                                07910024
079200                                                                  07920024
079300*----------------------------------------------------------------*07930024
079400* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *07940024
079500* STORAGE QUEUE PASSED FROM THE LIST.                            *07950024
079600*----------------------------------------------------------------*07960024
079700                                                                  07970024
079800 1120-PREPARE-LIST-ENTRY.                                         07980024
079900                                                                  07990024
080000     MOVE PC016-MAX-ITEMS          TO ASC-SEL-SUB.                08000024
080100     MOVE ZERO                     TO ASC-SEL-ITEM.               08010024
080200     PERFORM 2101-GET-NEXT-AREA.                                  08020024
080300     IF  DK-OPERATING-UNIT-ID = ASC-LOCATION                      08030041
080400         CONTINUE                                                 08040024
080500     ELSE                                                         08050024
080600         MOVE PC-TSYMSG-00749 TO  DP020-MSG-NUMBER                08060024
080700         SET DP020-MSG-FATAL                                      08070024
080800             DP020-FK-RETURN (DP020-SRC-AID)                      08080024
080900             PS-ERROR   TO TRUE                                   08090024
081000     END-IF.                                                      08100024
081100                                                                  08110024
081200/                                                                 08120024
081300*----------------------------------------------------------------*08130024
081400* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *08140024
081500* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *08150024
081600* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *08160024
081700* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *08170024
081800* FUNCTION KEYS CAN GET THIS FAR.                                *08180024
081900*----------------------------------------------------------------*08190024
082000                                                                  08200024
082100 2000-PROCESS-PANEL.                                              08210024
082200                                                                  08220024
082300     IF  PC000-PO-NBR-N NOT GREATER THAN ZERO                     08230024
082400         MOVE ASC-HOLD-INTER-APPL TO INTER-APPL-COMM-AREA         08240024
082500     END-IF.                                                      08250024
082600                                                                  08260024
082700     EVALUATE TRUE                                                08270024
082800         WHEN DP020-SRC-AID = DP016-CLEAR                         08280024
082900             MOVE ASC-HOLD-INTER-APPL                             08290024
083000                                   TO INTER-APPL-COMM-AREA        08300024
083100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    08310024
083200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   08320024
083300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 08330024
083400                                                                  08340024
083500         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    08350024
083600             MOVE ASC-HOLD-INTER-APPL                             08360024
083700                                   TO INTER-APPL-COMM-AREA        08370024
083800             PERFORM 2050-DELETE-LIST-QUEUE                       08380024
083900             PERFORM 4000-BUILD-INITIAL-PANEL                     08390024
084000                                                                  08400024
084100         WHEN OTHER                                               08410024
084200              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                08420024
084300                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              08430024
084400                  IF  PS-NO-ERROR                                 08440024
084500                      SET DP030-CONTINUE-GO                       08450024
084600                                 TO TRUE                          08460024
084700                      PERFORM 2100-CHECK-FUNCTION-KEY             08470024
084800                  ELSE                                            08480024
084900                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        08490024
085000                      SET DP030-OVERRIDE-GO                       08500024
085100                                 TO TRUE                          08510024
085200                  END-IF                                          08520024
085300     END-EVALUATE.                                                08530024
085400/                                                                 08540024
085500*----------------------------------------------------------------*08550024
085600*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *08560024
085700*----------------------------------------------------------------*08570024
085800 2050-DELETE-LIST-QUEUE.                                          08580024
085900                                                                  08590024
086000     EXEC CICS                                                    08600024
086100         DELETEQ TS                                               08610024
086200             QUEUE (ASC-LIST-QUEUE-NAME)                          08620024
086300             RESP  (PV-CICS-RESP)                                 08630024
086400     END-EXEC.                                                    08640024
086500                                                                  08650024
086600     IF (PV-CICS-RESP = DFHRESP(NORMAL)                           08660024
086700     OR  PV-CICS-RESP = DFHRESP(QIDERR))                          08670024
086800         CONTINUE                                                 08680024
086900     ELSE                                                         08690024
087000         SET DP013-CICS-ABEND      TO TRUE                        08700024
087100         SET DP013-NO-ROLLBACK     TO TRUE                        08710024
087200                                                                  08720024
087300         MOVE '2050-DELETE-LIST-QUEUE'                            08730024
087400                                   TO DP013-PARAGRAPH             08740024
087500         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    08750024
087600                                   TO DP013-MESSAGE-TEXT (1)      08760024
087700         PERFORM DP013-0000-PROCESS-ABEND                         08770024
087800     END-IF.                                                      08780024
087900                                                                  08790024
088000     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  08800024
088100/                                                                 08810024
088200*----------------------------------------------------------------*08820024
088300* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*08830024
088400* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *08840024
088500* CICS ARCHITECTURE API.                                         *08850024
088600*----------------------------------------------------------------*08860024
088700                                                                  08870024
088800 2100-CHECK-FUNCTION-KEY.                                         08880024
088900                                                                  08890024
089000     EVALUATE TRUE                                                08900024
089100         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               08910024
089200             IF ASC-RECORD-NOT-ADDED                              08920024
089300                 MOVE +1       TO ASC-BLK-SUB                     08930024
089400                 PERFORM 8100-WRITE-TEMP-STORAGE                  08940024
089500                 ADD +1        TO ASC-BLK-SUB                     08950024
089600                 PERFORM 8100-WRITE-TEMP-STORAGE                  08960024
089700                 SET PC016-IDX TO 1                               08970024
089800                                                                  08980024
089900                 PERFORM 3002-UPDATE-WORKORDS                     08990024
090000                     VARYING PV-ITEM                              09000024
090100                     FROM 1 BY 1                                  09010024
090200                     UNTIL PV-ITEM >                              09020024
090300                       ASC-HIGHEST-BLOCK-WRITTEN                  09030024
090400                                                                  09040024
090500                 IF  PC016-IDX > 1                                09050024
090600                     MOVE PV-ITEM      TO PV-SAVE-ITEM            09060024
090700                     PERFORM 8111-WRITE-LIST-QUEUE                09070024
090800                 END-IF                                           09080024
090900                                                                  09090024
091000                 INITIALIZE ASC-BLOCK-ENTRIES (1)                 09100024
091100                            ASC-BLOCK-ENTRIES (2)                 09110024
091200                                                                  09120024
091300                 DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL         09130024
091400                     GIVING PV-BLOCK-NUMBER                       09140024
091500                     REMAINDER PV-REMAINDER                       09150024
091600                 IF  PV-REMAINDER > ZERO                          09160024
091700                     ADD +1 TO PV-BLOCK-NUMBER                    09170024
091800                 END-IF                                           09180024
091900                 MOVE +1    TO ASC-BLK-SUB                        09190024
092000                 PERFORM 4410-READ-TEMP-STORAGE                   09200024
092100                 ADD +1     TO ASC-BLK-SUB                        09210024
092200                               PV-BLOCK-NUMBER                    09220024
092300                 PERFORM 4410-READ-TEMP-STORAGE                   09230024
092400                 SET ASC-RECORD-ADDED  TO TRUE                    09240024
092500             ELSE                                                 09250024
092600                 SET PS-ERROR                                     09260024
092700                     DP020-MSG-FATAL   TO TRUE                    09270024
092800                 MOVE PC-TSYMSG-00117  TO DP020-MSG-NUMBER        09280024
092900                 MOVE -1               TO AOSETIDL                09290024
093000                 SET DP030-SET-CURSOR-APPL-1                      09300024
093100                                       TO TRUE                    09310024
093200             END-IF                                               09320024
093300             COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +               09330024
093400                     ASC-ITEMS-DISPLAYED - 1                      09340024
093500             PERFORM 3100-SET-SUBSCRIPTS                          09350024
093600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09360024
093700                                                                  09370024
093800         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  09380024
093900             MOVE +1               TO PV-TOP-ITEM                 09390024
094000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09400024
094100                                                                  09410024
094200         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   09420024
094300             PERFORM 2110-BROWSE-BACKWARD                         09430024
094400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09440024
094500                                                                  09450024
094600         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   09460024
094700             PERFORM 2120-BROWSE-FORWARD                          09470024
094800             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09480024
094900                                                                  09490024
095000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             09500024
095100              IF  ASC-USE-SELECTION-QUEUE                         09510024
095200                  PERFORM 2101-GET-NEXT-AREA                      09520024
095300                  PERFORM 4000-BUILD-INITIAL-PANEL                09530024
095400                  PERFORM 3200-RESET-ATTRIBUTES                   09540024
095500              ELSE                                                09550024
095600*                 --- BOTTOM OF LIST ---                          09560024
095700                  MOVE PC-TSYMSG-00070                            09570024
095800                                   TO DP020-MSG-NUMBER            09580024
095900                  SET DP020-MSG-INFORMATIONAL                     09590024
096000                                   TO TRUE                        09600024
096100                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            09610024
096200              END-IF                                              09620024
096300                                                                  09630024
096400         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             09640024
096500              IF  ASC-USE-SELECTION-QUEUE                         09650024
096600                  PERFORM 2102-GET-PREV-AREA                      09660024
096700                  PERFORM 4000-BUILD-INITIAL-PANEL                09670024
096800                  PERFORM 3200-RESET-ATTRIBUTES                   09680024
096900              ELSE                                                09690024
097000*                 --- TOP OF LIST ---                             09700024
097100                  MOVE PC-TSYMSG-00069                            09710024
097200                                   TO DP020-MSG-NUMBER            09720024
097300                  SET DP020-MSG-INFORMATIONAL                     09730024
097400                                   TO TRUE                        09740024
097500                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            09750024
097600              END-IF                                              09760024
097700                                                                  09770024
097800         WHEN DP020-SRC-AID = DP016-ENTER                         09780024
097900             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   09790024
098000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 09800024
098100                                                                  09810024
098200         WHEN OTHER                                               09820024
098300             SET DP013-NO-ROLLBACK                                09830024
098400                 DP013-XCTL-DISPLAY-RESTART                       09840024
098500                 DP013-CICS-ABEND  TO TRUE                        09850024
098600             MOVE '2100-CHECK-FUNCTION-KEY'                       09860024
098700                                   TO DP013-PARAGRAPH             09870024
098800             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      09880024
098900                                   TO DP013-MESSAGE-TEXT (1)      09890024
099000             PERFORM DP013-0000-PROCESS-ABEND                     09900024
099100     END-EVALUATE.                                                09910024
099200                                                                  09920024
099300*----------------------------------------------------------------*09930024
099400*    RETRIEVE THE NEXT KEY FOR PROCESSING.                       *09940024
099500*----------------------------------------------------------------*09950024
099600                                                                  09960024
099700 2101-GET-NEXT-AREA.                                              09970024
099800                                                                  09980024
099900     ADD +1                        TO  ASC-SEL-SUB.               09990024
100000     IF  ASC-SEL-SUB > PC016-MAX-ITEMS                            10000024
100100         ADD +1                    TO  ASC-SEL-ITEM               10010024
100200         MOVE +1                   TO  ASC-SEL-SUB                10020024
100300     END-IF.                                                      10030024
100400                                                                  10040024
100500     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                10050024
100600         PERFORM 9100-READ-SEL-QUEUE                              10060024
100700         IF  PC016-ITEM (ASC-SEL-SUB) > ZERO                      10070024
100800             MOVE PC016-PO-NBR-N (ASC-SEL-SUB)                    10080024
100900                                   TO  ASC-KEY-PO-NBR             10090024
101000                                       DK-ORD-NBR                 10100024
101100             MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)               10110024
101200                                   TO  ASC-KEY-RCVR-SEQ-NBR       10120024
101300                                       DK-RCVR-SEQ-NBR            10130024
101400             MOVE PC016-OPER-UNT-ID   (ASC-SEL-SUB)               10140024
101500                                   TO  DK-OPERATING-UNIT-ID       10150024
101600                                       ASC-KEY-OPER-UNT-ID        10160024
101700             MOVE PC016-FCLTY-ID      (ASC-SEL-SUB)               10170024
101800                                   TO  DK-FACT                    10180024
101900                                       ASC-KEY-FCLTY-ID           10190024
102000             MOVE PC016-LINE-NBR-N    (ASC-SEL-SUB)               10200024
102100                                   TO  DK-LINE-NBR                10210024
102200             MOVE PC016-DEPT (ASC-SEL-SUB)                        10220036
102300                                   TO  ASC-DEPT-NBR               10230036
102400             SET PC016-INQ (ASC-SEL-SUB)                          10240024
102500                                   TO  TRUE                       10250024
102600             PERFORM 9200-REWRITE-LIST-QUEUE                      10260024
102700         ELSE                                                     10270024
102800             SUBTRACT +1 FROM ASC-SEL-SUB                         10280024
102900*            --- BOTTOM OF LIST ---                               10290024
103000             MOVE PC-TSYMSG-00070  TO  DP020-MSG-NUMBER           10300024
103100             SET DP020-MSG-INFORMATIONAL                          10310024
103200                                   TO  TRUE                       10320024
103300         END-IF                                                   10330024
103400     ELSE                                                         10340024
103500         SUBTRACT +1 FROM ASC-SEL-ITEM                            10350024
103600         MOVE PC016-MAX-ITEMS      TO  ASC-SEL-SUB                10360024
103700         MOVE PC-TSYMSG-00070      TO  DP020-MSG-NUMBER           10370024
103800         SET DP020-MSG-INFORMATIONAL                              10380024
103900                                   TO  TRUE                       10390024
104000     END-IF.                                                      10400024
104100                                                                  10410024
104200*----------------------------------------------------------------*10420024
104300*  GET THE MESSAGE NUMBER (KEY) OF THE PREVIOUS SELECTED         *10430024
104400*  OBJECT FROM THE SELECTED-ITEMS TEMP. STORAGE QUEUE.           *10440024
104500*----------------------------------------------------------------*10450024
104600                                                                  10460024
104700 2102-GET-PREV-AREA.                                              10470024
104800                                                                  10480024
104900     SUBTRACT +1 FROM ASC-SEL-SUB.                                10490024
105000     IF  ASC-SEL-SUB < +1                                         10500024
105100         SUBTRACT +1 FROM ASC-SEL-ITEM                            10510024
105200         MOVE PC016-MAX-ITEMS      TO ASC-SEL-SUB                 10520024
105300     END-IF.                                                      10530024
105400                                                                  10540024
105500     IF  ASC-SEL-ITEM > ZERO                                      10550024
105600         PERFORM 9100-READ-SEL-QUEUE                              10560024
105700         MOVE PC016-PO-NBR-N (ASC-SEL-SUB)                        10570024
105800                                   TO ASC-KEY-PO-NBR              10580024
105900         MOVE PC016-REC-SEQ-NBR-N (ASC-SEL-SUB)                   10590024
106000                                   TO  ASC-KEY-RCVR-SEQ-NBR       10600024
106100                                       DK-RCVR-SEQ-NBR            10610024
106200         MOVE PC016-OPER-UNT-ID(ASC-SEL-SUB)                      10620024
106300                                   TO  DK-OPERATING-UNIT-ID       10630024
106400         MOVE PC016-FCLTY-ID (ASC-SEL-SUB)                        10640024
106500                                   TO  DK-FACT                    10650024
106600         MOVE PC016-DEPT (ASC-SEL-SUB)                            10660036
106700                               TO  ASC-DEPT-NBR                   10670036
106800     ELSE                                                         10680024
106900         MOVE +1                   TO ASC-SEL-ITEM                10690024
107000                                      ASC-SEL-SUB                 10700024
107100*        --- TOP OF LIST ---                                      10710024
107200         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10720024
107300         SET DP020-MSG-INFORMATIONAL                              10730024
107400                                   TO TRUE                        10740024
107500     END-IF.                                                      10750024
107600                                                                  10760024
107700*----------------------------------------------------------------*10770024
107800*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *10780024
107900*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *10790024
108000*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *10800024
108100*    MESSAGE.                                                    *10810024
108200*----------------------------------------------------------------*10820024
108300                                                                  10830024
108400 2110-BROWSE-BACKWARD.                                            10840024
108500                                                                  10850024
108600     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    10860024
108700         GIVING PV-TOP-ITEM.                                      10870024
108800                                                                  10880024
108900     IF  ((PV-TOP-ITEM < +1)                                      10890024
109000       OR (PV-TOP-ITEM = +1))                                     10900024
109100         MOVE +1                   TO PV-TOP-ITEM                 10910024
109200*        -- TOP OF LIST --                                        10920024
109300         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            10930024
109400         SET DP020-MSG-INFORMATIONAL TO TRUE                      10940024
109500     END-IF.                                                      10950024
109600                                                                  10960024
109700/                                                                 10970024
109800*----------------------------------------------------------------*10980024
109900*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *10990024
110000*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *11000024
110100*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *11010024
110200*----------------------------------------------------------------*11020024
110300                                                                  11030024
110400 2120-BROWSE-FORWARD.                                             11040024
110500                                                                  11050024
110600     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              11060024
110700         GIVING PV-TOP-ITEM.                                      11070024
110800     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   11080024
110900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11090024
111000                                   TO PV-TOP-ITEM                 11100024
111100*        -- BOTTOM OF LIST --                                     11110024
111200         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            11120024
111300         SET DP020-MSG-INFORMATIONAL                              11130024
111400                                   TO TRUE                        11140024
111500     ELSE                                                         11150024
111600         COMPUTE PV-BOTTOM-ITEM =                                 11160024
111700             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 11170024
111800         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            11180024
111900*            -- BOTTOM OF LIST --                                 11190024
112000             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            11200024
112100             SET DP020-MSG-INFORMATIONAL                          11210024
112200                                   TO TRUE                        11220024
112300         END-IF                                                   11230024
112400     END-IF.                                                      11240024
112500/                                                                 11250024
112600*----------------------------------------------------------------*11260024
112700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *11270024
112800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *11280024
112900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *11290024
113000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *11300024
113100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *11310024
113200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *11320024
113300*----------------------------------------------------------------*11330024
113400                                                                  11340024
113500 2130-CHECK-FOR-JUMP-BROWSE.                                      11350024
113600                                                                  11360024
113700     SET PS-NO-ERROR               TO TRUE.                       11370024
113800     IF (ASC-START-ITEM-REQUEST = SPACE)                          11380024
113900         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            11390024
114000                                   TO PV-TOP-ITEM                 11400024
114100     ELSE                                                         11410024
114200         MOVE ASC-START-ITEM-REQUEST                              11420024
114300                                   TO DP010I-UNEDITED-FIELD       11430024
114400         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       11440024
114500         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     11450024
114600         SET DP010I-NEGATIVE-NOT-ALLOWED                          11460024
114700                                   TO TRUE                        11470024
114810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         11481046
114820                         USING DP010I-NUMERIC-EDIT-AREA           11482046
114900                                                                  11490024
115000         IF  NOT DP010I-ERROR-DETECTED                            11500024
115100             MOVE DP010I-NUMERIC-FIELD                            11510024
115200                                   TO  ASC-START-ITEM-REQUEST-N   11520024
115300             IF  ASC-START-ITEM-REQUEST-N > ZERO                  11530024
115400                 IF  ASC-START-ITEM-REQUEST-N >                   11540024
115500                                          ASC-NUMBER-OF-ITEMS-READ11550024
115600                     MOVE SPACE TO ASC-START-ITEM-REQUEST         11560024
115700                     COMPUTE PV-TOP-ITEM =                        11570024
115800                             ASC-NUMBER-OF-ITEMS-READ             11580024
115900                             - PC-ITEMS-PER-PANEL + 1             11590024
116000                     IF  PV-TOP-ITEM < +1                         11600024
116100                         MOVE +1   TO PV-TOP-ITEM                 11610024
116200                         MOVE PC-TSYMSG-00070                     11620024
116300                                   TO DP020-MSG-NUMBER            11630024
116400                         SET DP020-MSG-INFORMATIONAL              11640024
116500                                   TO TRUE                        11650024
116600                     END-IF                                       11660024
116700                 ELSE                                             11670024
116800                     MOVE ASC-START-ITEM-REQUEST-N                11680024
116900                                   TO PV-TOP-ITEM                 11690024
117000                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      11700024
117100                     COMPUTE PV-BOTTOM-ITEM =                     11710024
117200                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     11720024
117300                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ11730024
117400*                        -- BOTTOM OF LIST --                     11740024
117500                         MOVE PC-TSYMSG-00070                     11750024
117600                                   TO DP020-MSG-NUMBER            11760024
117700                         SET DP020-MSG-INFORMATIONAL              11770024
117800                                   TO TRUE                        11780024
117900                     END-IF                                       11790024
118000                 END-IF                                           11800024
118100             ELSE                                                 11810024
118200*                --- VALUE OUT OF RANGE ----                      11820024
118300                 MOVE PC-TSYMSG-00101                             11830024
118400                                   TO DP020-MSG-NUMBER            11840024
118500                 MOVE -1           TO ASTRTITL                    11850024
118600                 SET DP030-SET-CURSOR-APPL-1                      11860024
118700                                   TO TRUE                        11870024
118800                 MOVE DP015-REVERSE                               11880024
118900                                   TO ASTRTITH                    11890024
119000                 MOVE DP015-RED    TO ASTRTITC                    11900024
119100                 MOVE DP015-UNP-NUM-BRT-OFF                       11910024
119200                                   TO ASTRTITA                    11920024
119300                 SET DP020-MSG-FATAL                              11930024
119400                                   TO TRUE                        11940024
119500                 SET PS-ERROR      TO TRUE                        11950024
119600             END-IF                                               11960024
119700                                                                  11970024
119800         ELSE                                                     11980024
119900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            11990024
120000             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  12000024
120100             SET DP020-MSG-FATAL   TO TRUE                        12010024
120200             SET PS-ERROR          TO TRUE                        12020024
120300         END-IF                                                   12030024
120400     END-IF.                                                      12040024
120500/                                                                 12050024
120600*----------------------------------------------------------------*12060024
120700*  MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE     *12070024
120800*  SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM.  *12080024
120900*----------------------------------------------------------------*12090024
121000                                                                  12100024
121100 2200-MOVE-SCREEN-TO-COMMAREA.                                    12110024
121200                                                                  12120024
121300     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             12130024
121400     MOVE +1                       TO PV-SUB.                     12140024
121500                                                                  12150024
121600     PERFORM 3100-SET-SUBSCRIPTS.                                 12160024
121700                                                                  12170024
121800     IF  ASTRTITL > ZERO                                          12180024
121900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          12190024
122000     ELSE                                                         12200024
122100         IF  ASTRTITF EQUAL DP015-ERASE-EOF                       12210024
122200             INITIALIZE ASC-START-ITEM-REQUEST                    12220024
122300         END-IF                                                   12230024
122400     END-IF.                                                      12240024
122500                                                                  12250024
122600     IF  AOSETIDL > ZERO                                          12260024
122700         MOVE AOSETIDI             TO ASC-OPERATION-SET-ID-X      12270024
122800         SET PS-OPER-SET-ENTERED   TO TRUE                        12280024
122900     ELSE                                                         12290024
123000         IF  AOSETIDF EQUAL DP015-ERASE-EOF                       12300024
123100             INITIALIZE ASC-OPERATION-SET-ID                      12310024
123200         END-IF                                                   12320024
123300     END-IF.                                                      12330024
123400                                                                  12340024
123500     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          12350024
123600         VARYING PV-SUB                                           12360024
123700         FROM 1 BY 1                                              12370024
123800         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      12380024
123900                                                                  12390024
124000******************************************************************12400024
124100** MOVE THE ENTERABLE FIELDS ON EACH LIST LINE INTO THE COMMAREA**12410024
124200******************************************************************12420024
124300                                                                  12430024
124400 2210-MOVE-LINES-TO-COMMAREA.                                     12440024
124500                                                                  12450024
124600     IF  MR-ACTUL-QTYL     (PV-SUB) > ZERO                        12460024
124700         SET ASC-BLOCK-MODIFIED     (ASC-BLK-SUB)                 12470024
124800                                   TO TRUE                        12480024
124900         MOVE MR-ACTUL-QTY-X   (PV-SUB) TO ASC-ACTUAL-CART-QTY-X  12490024
125000                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      12500024
125100     ELSE                                                         12510024
125200         IF  MR-ACTUL-QTYA     (PV-SUB) = DP015-ERASE-EOF         12520024
125300             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              12530024
125400                                   TO TRUE                        12540024
125500             MOVE ZERO             TO ASC-ACTUAL-CART-QTY         12550024
125600                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      12560024
125700         END-IF                                                   12570024
125800     END-IF.                                                      12580024
125900                                                                  12590024
126000                                                                  12600024
126100     IF  MR-AITEM-QTYL     (PV-SUB) > ZERO                        12610024
126200         SET ASC-BLOCK-MODIFIED     (ASC-BLK-SUB)                 12620024
126300                                   TO TRUE                        12630024
126400         MOVE MR-AITEM-QTY-X   (PV-SUB) TO ASC-ACTUAL-ITEM-QTY-X  12640024
126500                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      12650024
126600     ELSE                                                         12660024
126700         IF  MR-AITEM-QTYA     (PV-SUB) = DP015-ERASE-EOF         12670024
126800             SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)              12680024
126900                                   TO TRUE                        12690024
127000             MOVE ZERO             TO ASC-ACTUAL-ITEM-QTY         12700024
127100                                 (ASC-BLK-SUB, ASC-ITEM-SUB)      12710024
127200         END-IF                                                   12720024
127300     END-IF.                                                      12730024
127400                                                                  12740024
127500         IF  MR-OPER-SETL      (PV-SUB) > ZERO                    12750024
127600             SET ASC-BLOCK-MODIFIED     (ASC-BLK-SUB)             12760024
127700                                   TO TRUE                        12770024
127800             MOVE MR-OPER-SET      (PV-SUB) TO ASC-OPER-SET-ID    12780024
127900                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  12790024
128000         ELSE                                                     12800024
128100             IF  MR-OPER-SETA      (PV-SUB) = DP015-ERASE-EOF     12810024
128200                 SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)          12820024
128300                                   TO TRUE                        12830024
128400                 MOVE ZERO             TO ASC-OPER-SET-ID         12840024
128500                                     (ASC-BLK-SUB, ASC-ITEM-SUB)  12850024
128600             END-IF                                               12860024
128700         END-IF.                                                  12870024
128800                                                                  12880024
128900     ADD +1                        TO ASC-ITEM-SUB.               12890024
129000     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        12900024
129100         ADD +1                    TO ASC-BLK-SUB                 12910024
129200         MOVE +1                   TO ASC-ITEM-SUB                12920024
129300     END-IF.                                                      12930024
129400                                                                  12940024
129500*----------------------------------------------------------------*12950024
129600*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *12960024
129700*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *12970024
129800*----------------------------------------------------------------*12980024
129900                                                                  12990024
130000 3000-EDIT-DATA-IN-COMMAREA.                                      13000024
130100                                                                  13010024
130200     PERFORM 3200-RESET-ATTRIBUTES.                               13020024
130300     SET PS-NO-ERROR               TO TRUE.                       13030024
130400                                                                  13040024
130500*DC-162 FROM HERE                                                 13050024
130600     IF  PS-OPER-SET-ENTERED                                      13060024
130700         PERFORM 3003-VALIDATE-OPER-SET                           13070024
130800     END-IF.                                                      13080024
130900*DC-162 TO HERE                                                   13090024
131000                                                                  13100024
131100     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     13110024
131200**                                                                13120024
131300* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              13130024
131400* EDITTING IS DONE FROM THE BOTTOM UP.                            13140024
131500**                                                                13150024
131600     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       13160024
131700         ASC-ITEMS-DISPLAYED - 1.                                 13170024
131800     PERFORM 3100-SET-SUBSCRIPTS.                                 13180024
131900     PERFORM 3300-EDIT-SELECTIONS                                 13190024
132000         VARYING PV-SUB                                           13200024
132100         FROM PV-SUB BY -1                                        13210024
132200         UNTIL PV-SUB < +1.                                       13220024
132300                                                                  13230024
132400     IF  PS-OPER-SET-ERROR-SW GREATER THAN SPACES                 13240024
132500         MOVE DP015-UNP-ALP-BRT-OFF                               13250024
132600                                   TO AOSETIDA                    13260024
132700         MOVE DP015-RED            TO AOSETIDC                    13270024
132800         MOVE DP015-REVERSE        TO AOSETIDH                    13280024
132900         MOVE -1                   TO AOSETIDL                    13290024
133000         MOVE ASC-OPERATION-SET-ID-X                              13300024
133100                                   TO AOSETIDO                    13310024
133200         SET DP030-SET-CURSOR-APPL-1                              13320024
133300                                                                  13330024
133400             PS-ERROR                                             13340024
133500             DP020-MSG-FATAL       TO TRUE                        13350024
133600                                                                  13360024
133700         EVALUATE TRUE                                            13370024
133800             WHEN PS-NOT-NUMERIC-OPER-SET                         13380024
133900                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        13390024
134000                                                                  13400024
134100             WHEN PS-INVALID-OPER-SET                             13410024
134200                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        13420024
134300                                                                  13430024
134400             WHEN PS-OPER-SET-IS-ZERO                             13440024
134500                 MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER        13450024
134600         END-EVALUATE                                             13460024
134700     END-IF.                                                      13470024
134800                                                                  13480024
134900                                                                  13490024
135000/                                                                 13500024
135100 3002-UPDATE-WORKORDS.                                            13510024
135200     PERFORM 8112-READ-LIST-QUEUE.                                13520024
135300                                                                  13530024
135400     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       13540024
135500         PERFORM                                                  13550024
135600           VARYING LQW-IDX                                        13560024
135700           FROM 1 BY 1                                            13570024
135800           UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL          13580024
135900             OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO        13590024
136000           MOVE LQW-LINE-NBR (LQW-IDX) TO PC-LINE-NBR             13600024
136100           MOVE LQW-WRK-ORD  (LQW-IDX) TO PC-WRK-ORD              13610024
136200           MOVE LQW-ITM-NBR  (LQW-IDX) TO PC-ITM-NBR              13620024
136300           MOVE LQW-OPER-SET-ID (LQW-IDX) TO PC-SET-ID            13630024
136400           MOVE PC-IP                  TO LQW-STAT (LQW-IDX)      13640024
136500           MOVE PC-CURRENT-DATE        TO LQW-CREATE-DATE         13650024
136600                                                   (LQW-IDX)      13660024
136700           MOVE PC-CURRENT-TIME        TO LQW-CREATE-TIME         13670024
136800                                                   (LQW-IDX)      13680024
136900           MOVE LQW-ACTUAL-CART-QTY  (LQW-IDX)                    13690024
137000                                       TO PC-ACTUAL-CART-QTY      13700024
137100           MOVE LQW-ACTUAL-ITEM-QTY  (LQW-IDX)                    13710024
137200                                       TO PC-ACTUAL-ITEM-QTY      13720024
137300           PERFORM 7530-UPDATE-RECITM                             13730024
137400           PERFORM 7550-CREATE-INSTRUCTIONS-LOOP                  13740024
137500         END-PERFORM                                              13750024
137600      END-IF.                                                     13760024
137700                                                                  13770024
137800     IF  LQW-IDX > 1                                              13780024
137900         MOVE PV-ITEM      TO PV-SAVE-ITEM                        13790024
138000         PERFORM 8111-WRITE-LIST-QUEUE                            13800024
138100         SET LQW-IDX TO 1                                         13810024
138200     END-IF.                                                      13820024
138300/                                                                 13830024
138400 3003-VALIDATE-OPER-SET.                                          13840024
138500                                                                  13850024
138600     MOVE ASC-OPERATION-SET-ID-X                                  13860024
138700                               TO  DP010I-UNEDITED-FIELD          13870024
138800     MOVE LENGTH OF ASC-OPERATION-SET-ID-X                        13880024
138900                               TO  DP010I-MAXIMUM-DIGITS          13890024
139000     MOVE ZERO                 TO  DP010I-MAXIMUM-DECIMALS        13900024
139100     SET DP010I-NEGATIVE-NOT-ALLOWED                              13910024
139200                               TO  TRUE                           13920024
139310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             13931046
139320                         USING DP010I-NUMERIC-EDIT-AREA           13932046
139400                                                                  13940024
139500     IF  DP010I-ERROR-DETECTED                                    13950024
139600         SET PS-ERROR                                             13960024
139700             PS-NOT-NUMERIC-OPER-SET                              13970024
139800             DP020-MSG-FATAL   TO TRUE                            13980024
139900         SET DP030-SET-CURSOR-APPL-1                              13990024
140000                               TO TRUE                            14000024
140100     ELSE                                                         14010024
140200         MOVE DP010I-NUMERIC-FIELD                                14020024
140300                               TO ASC-OPERATION-SET-ID            14030024
140400                                  DK-OPER-SET-ID                  14040024
140500         IF  DP010I-NUMERIC-FIELD EQUAL ZERO                      14050024
140600             SET PS-OPER-SET-IS-ZERO                              14060024
140700                               TO TRUE                            14070024
140800         ELSE                                                     14080024
140900                                                                  14090024
141000             PERFORM 7400-VALIDATE-OPER-SET-ID                    14100024
141100             IF  SQLCODE = +0                                     14110024
141200                 MOVE +1               TO ASC-BLK-SUB             14120024
141300                 PERFORM 8100-WRITE-TEMP-STORAGE                  14130024
141400                 ADD +1                TO ASC-BLK-SUB             14140024
141500                 PERFORM 8100-WRITE-TEMP-STORAGE                  14150024
141600                 SET PC016-IDX         TO 1                       14160024
141700                                                                  14170024
141800                 PERFORM 3004-OPER-SET-ID                         14180024
141900                         VARYING PV-ITEM                          14190024
142000                         FROM 1 BY 1                              14200024
142100                         UNTIL PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN14210024
142200                                                                  14220024
142300                 IF  PC016-IDX > 1                                14230024
142400                     MOVE PV-ITEM      TO PV-SAVE-ITEM            14240024
142500                     PERFORM 8111-WRITE-LIST-QUEUE                14250024
142600                 END-IF                                           14260024
142700                                                                  14270024
142800                 INITIALIZE ASC-BLOCK-ENTRIES (1)                 14280024
142900                        ASC-BLOCK-ENTRIES (2)                     14290024
143000                                                                  14300024
143100                 DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL         14310024
143200                        GIVING PV-BLOCK-NUMBER                    14320024
143300                        REMAINDER PV-REMAINDER                    14330024
143400                 IF  PV-REMAINDER > ZERO                          14340024
143500                     ADD +1 TO PV-BLOCK-NUMBER                    14350024
143600                 END-IF                                           14360024
143700                 MOVE +1    TO ASC-BLK-SUB                        14370024
143800                 PERFORM 4410-READ-TEMP-STORAGE                   14380024
143900                 ADD +1     TO ASC-BLK-SUB                        14390024
144000                               PV-BLOCK-NUMBER                    14400024
144100                 PERFORM 4410-READ-TEMP-STORAGE                   14410024
144200                 MOVE ZERO             TO AOSETIDO                14420024
144300             ELSE                                                 14430024
144400                 SET PS-ERROR                                     14440024
144500                     PS-INVALID-OPER-SET                          14450024
144600                     DP020-MSG-FATAL   TO TRUE                    14460024
144700             END-IF                                               14470024
144800         END-IF                                                   14480024
144900     END-IF.                                                      14490024
145000 3004-OPER-SET-ID.                                                14500024
145100     PERFORM 8112-READ-LIST-QUEUE.                                14510024
145200                                                                  14520024
145300     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       14530024
145400         PERFORM                                                  14540024
145500           VARYING LQW-IDX                                        14550024
145600           FROM 1 BY 1                                            14560024
145700           UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL          14570024
145800             OR  LQW-LIST-ITEM-NUMBER (LQW-IDX) EQUAL ZERO        14580024
145900         MOVE ASC-OPERATION-SET-ID TO LQW-OPER-SET-ID (LQW-IDX)   14590024
146000         END-PERFORM                                              14600024
146100      END-IF.                                                     14610024
146200                                                                  14620024
146300     IF  LQW-IDX > 1                                              14630024
146400         MOVE PV-ITEM      TO PV-SAVE-ITEM                        14640024
146500         PERFORM 8111-WRITE-LIST-QUEUE                            14650024
146600         SET LQW-IDX TO 1                                         14660024
146700     END-IF.                                                      14670024
146800/                                                                 14680024
146900*----------------------------------------------------------------*14690024
147000*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *14700024
147100*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*14710024
147200*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *14720024
147300*                                                                *14730024
147400*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *14740024
147500*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *14750024
147600*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *14760024
147700*    US IN THE 2ND BLOCK OF THE ARRAY.                           *14770024
147800*----------------------------------------------------------------*14780024
147900                                                                  14790024
148000 3100-SET-SUBSCRIPTS.                                             14800024
148100                                                                  14810024
148200     COMPUTE ASC-ITEM-SUB =                                       14820024
148300         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        14830024
148400                                                                  14840024
148500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         14850024
148600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            14860024
148700                                                                  14870024
148800         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               14880024
148900     ELSE                                                         14890024
149000         MOVE +1                     TO ASC-BLK-SUB               14900024
149100     END-IF.                                                      14910024
149200                                                                  14920024
149300*----------------------------------------------------------------*14930024
149400*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *14940024
149500*----------------------------------------------------------------*14950024
149600                                                                  14960024
149700 3200-RESET-ATTRIBUTES.                                           14970024
149800                                                                  14980024
149900     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   14990024
150000     MOVE DP015-GREEN              TO ASTRTITC.                   15000024
150100     MOVE DP015-UNDERLINE          TO ASTRTITH.                   15010024
150200     MOVE DP015-UNP-ALP-NOR-OFF    TO AOSETIDA.                   15020024
150300     MOVE DP015-GREEN              TO AOSETIDC.                   15030024
150400     MOVE DP015-UNDERLINE          TO AOSETIDH.                   15040024
150500                                                                  15050024
150600     PERFORM                                                      15060024
150700         VARYING PV-SUB                                           15070024
150800         FROM 1 BY 1                                              15080024
150900         UNTIL PV-SUB > PC-ITEMS-PER-PANEL                        15090024
151000         MOVE DP015-UNP-ALP-NOR-OFF                               15100024
151100                                   TO MR-ACTUL-QTYA (PV-SUB)      15110024
151200                                      MR-AITEM-QTYA (PV-SUB)      15120024
151300                                      MR-OPER-SETA  (PV-SUB)      15130024
151400         MOVE DP015-GREEN          TO MR-ACTUL-QTYC (PV-SUB)      15140024
151500                                      MR-AITEM-QTYC (PV-SUB)      15150024
151600                                      MR-OPER-SETC  (PV-SUB)      15160024
151700         MOVE DP015-UNDERLINE      TO MR-ACTUL-QTYH (PV-SUB)      15170024
151800                                      MR-AITEM-QTYH (PV-SUB)      15180024
151900                                      MR-OPER-SETH  (PV-SUB)      15190024
152000     END-PERFORM.                                                 15200024
152100                                                                  15210024
152200*----------------------------------------------------------------*15220024
152300*  EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS     *15230024
152400*  WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'    *15240024
152500*  IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR     *15250024
152600*  WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.              *15260024
152700*----------------------------------------------------------------*15270024
152800                                                                  15280024
152900 3300-EDIT-SELECTIONS.                                            15290024
153000                                                                  15300024
153100*-->     ** OPER SET ID NUMERIC EDIT CHECK                        15310024
153200     MOVE ASC-OPER-SET-ID-X     (ASC-BLK-SUB ASC-ITEM-SUB)        15320024
153300                               TO  DP010I-UNEDITED-FIELD          15330024
153400     MOVE LENGTH OF ASC-OPER-SET-ID-X                             15340024
153500                               TO  DP010I-MAXIMUM-DIGITS          15350024
153600     MOVE ZERO                 TO  DP010I-MAXIMUM-DECIMALS        15360024
153700     SET DP010I-NEGATIVE-NOT-ALLOWED                              15370024
153800                               TO  TRUE                           15380024
153910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             15391046
153920                         USING DP010I-NUMERIC-EDIT-AREA           15392046
154000                                                                  15400024
154100     IF  DP010I-ERROR-DETECTED                                    15410024
154200         SET PS-ERROR                                             15420024
154300             DP020-MSG-FATAL   TO TRUE                            15430024
154400         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                15440024
154500         MOVE DP015-UNP-ALP-BRT-MDT                               15450024
154600                               TO MR-OPER-SETA     (PV-SUB)       15460024
154700         MOVE DP015-RED        TO MR-OPER-SETC     (PV-SUB)       15470024
154800         MOVE DP015-REVERSE    TO MR-OPER-SETH     (PV-SUB)       15480024
154900         MOVE -1               TO MR-OPER-SETL     (PV-SUB)       15490024
155000         SET DP030-SET-CURSOR-APPL-1                              15500024
155100                               TO TRUE                            15510024
155200         SET  PS-ERROR         TO TRUE                            15520024
155300     ELSE                                                         15530024
155400         MOVE DP010I-NUMERIC-FIELD                                15540024
155500                               TO ASC-OPER-SET-ID                 15550024
155600                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     15560024
155700         SET ASC-BLOCK-MODIFIED   (ASC-BLK-SUB)                   15570024
155800                               TO TRUE                            15580024
155900         IF  ASC-OPER-SET-ID                                      15590024
156000                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     15600024
156100                                   EQUAL ZERO                     15610024
156200             SET PS-ERROR                                         15620024
156300                 DP020-MSG-FATAL   TO TRUE                        15630024
156400             MOVE PC-TSYMSG-00010  TO DP020-MSG-NUMBER            15640024
156500             MOVE DP015-UNP-ALP-BRT-MDT                           15650024
156600                                   TO MR-OPER-SETA     (PV-SUB)   15660024
156700             MOVE DP015-RED        TO MR-OPER-SETC     (PV-SUB)   15670024
156800             MOVE DP015-REVERSE    TO MR-OPER-SETH     (PV-SUB)   15680024
156900             MOVE -1               TO MR-OPER-SETL     (PV-SUB)   15690024
157000             SET DP030-SET-CURSOR-APPL-1                          15700024
157100                                   TO TRUE                        15710024
157200             SET  PS-ERROR         TO TRUE                        15720024
157300         ELSE                                                     15730024
157400             MOVE ASC-OPER-SET-ID                                 15740024
157500                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     15750024
157600                                       TO DK-OPER-SET-ID          15760024
157700             PERFORM 7400-VALIDATE-OPER-SET-ID                    15770024
157800             IF  SQLCODE = +0                                     15780024
157900                 CONTINUE                                         15790024
158000             ELSE                                                 15800024
158100                 SET PS-ERROR                                     15810024
158200                     DP020-MSG-FATAL   TO TRUE                    15820024
158300                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        15830024
158400                 MOVE DP015-UNP-ALP-BRT-MDT                       15840024
158500                                       TO MR-OPER-SETA (PV-SUB)   15850024
158600                 MOVE DP015-RED        TO MR-OPER-SETC (PV-SUB)   15860024
158700                 MOVE DP015-REVERSE    TO MR-OPER-SETH (PV-SUB)   15870024
158800                 MOVE -1               TO MR-OPER-SETL (PV-SUB)   15880024
158900                 SET DP030-SET-CURSOR-APPL-1                      15890024
159000                                       TO TRUE                    15900024
159100                 SET  PS-ERROR         TO TRUE                    15910024
159200             END-IF                                               15920024
159300         END-IF                                                   15930024
159400     END-IF.                                                      15940024
159500                                                                  15950024
159600*-->     ** ACTUAL ITEM CART QTY NUMERIC EDIT CHECK               15960024
159700     MOVE ASC-ACTUAL-ITEM-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)        15970024
159800                               TO  DP010I-UNEDITED-FIELD          15980024
159900     MOVE PC-5                 TO  DP010I-MAXIMUM-DIGITS          15990024
160000     MOVE ZERO                 TO  DP010I-MAXIMUM-DECIMALS        16000024
160100     SET DP010I-NEGATIVE-NOT-ALLOWED                              16010024
160200                               TO  TRUE                           16020024
160310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             16031046
160320                         USING DP010I-NUMERIC-EDIT-AREA           16032046
160400                                                                  16040024
160500     IF  DP010I-ERROR-DETECTED                                    16050024
160600         SET PS-ERROR                                             16060024
160700             DP020-MSG-FATAL   TO TRUE                            16070024
160800         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                16080024
160900         MOVE DP015-UNP-ALP-BRT-MDT                               16090024
161000                               TO MR-AITEM-QTYA    (PV-SUB)       16100024
161100         MOVE DP015-RED        TO MR-AITEM-QTYC    (PV-SUB)       16110024
161200         MOVE DP015-REVERSE    TO MR-AITEM-QTYH    (PV-SUB)       16120024
161300         MOVE -1               TO MR-AITEM-QTYL    (PV-SUB)       16130024
161400         SET DP030-SET-CURSOR-APPL-1                              16140024
161500                               TO TRUE                            16150024
161600         SET  PS-ERROR         TO TRUE                            16160024
161700     ELSE                                                         16170024
161800         MOVE DP010I-NUMERIC-FIELD                                16180024
161900                               TO ASC-ACTUAL-ITEM-QTY             16190024
162000                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     16200024
162100         SET ASC-BLOCK-MODIFIED   (ASC-BLK-SUB)                   16210024
162200                               TO TRUE                            16220024
162300     END-IF.                                                      16230024
162400                                                                  16240024
162500*-->     ** ACTUAL CART QTY NUMERIC EDIT CHECK                    16250024
162600     MOVE ASC-ACTUAL-CART-QTY-X (ASC-BLK-SUB ASC-ITEM-SUB)        16260024
162700                               TO  DP010I-UNEDITED-FIELD          16270024
162800     MOVE PC-5                 TO  DP010I-MAXIMUM-DIGITS          16280024
162900     MOVE ZERO                 TO  DP010I-MAXIMUM-DECIMALS        16290024
163000     SET DP010I-NEGATIVE-NOT-ALLOWED                              16300024
163100                               TO  TRUE                           16310024
163210     CALL DP010I-NUMERIC-EDIT-ROUTINE                             16321046
163220                         USING DP010I-NUMERIC-EDIT-AREA           16322046
163300                                                                  16330024
163400     IF  DP010I-ERROR-DETECTED                                    16340024
163500         SET PS-ERROR                                             16350024
163600             DP020-MSG-FATAL   TO TRUE                            16360024
163700         MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER                16370024
163800         MOVE DP015-UNP-ALP-BRT-MDT                               16380024
163900                               TO MR-ACTUL-QTYA    (PV-SUB)       16390024
164000         MOVE DP015-RED        TO MR-ACTUL-QTYC    (PV-SUB)       16400024
164100         MOVE DP015-REVERSE    TO MR-ACTUL-QTYH    (PV-SUB)       16410024
164200         MOVE -1               TO MR-ACTUL-QTYL    (PV-SUB)       16420024
164300         SET DP030-SET-CURSOR-APPL-1                              16430024
164400                               TO TRUE                            16440024
164500         SET  PS-ERROR         TO TRUE                            16450024
164600     ELSE                                                         16460024
164700         MOVE DP010I-NUMERIC-FIELD                                16470024
164800                               TO ASC-ACTUAL-CART-QTY             16480024
164900                                  (ASC-BLK-SUB, ASC-ITEM-SUB)     16490024
165000         SET ASC-BLOCK-MODIFIED   (ASC-BLK-SUB)                   16500024
165100                               TO TRUE                            16510024
165200     END-IF.                                                      16520024
165300                                                                  16530024
165400     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 16540024
165500     SUBTRACT +1 FROM ASC-ITEM-SUB.                               16550024
165600     IF  ASC-ITEM-SUB < 1                                         16560024
165700         SUBTRACT +1 FROM ASC-BLK-SUB                             16570024
165800         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                16580024
165900     END-IF.                                                      16590024
166000                                                                  16600024
166100/                                                                 16610024
166200*----------------------------------------------------------------*16620024
166300*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *16630024
166400*    INITIALIZE ALL COUNTERS AND FLAGS.                          *16640024
166500*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *16650024
166600*    DISPLAY THE PANEL TO USER.                                  *16660024
166700*----------------------------------------------------------------*16670024
166800                                                                  16680024
166900 4000-BUILD-INITIAL-PANEL.                                        16690024
167000                                                                  16700024
167100     SET ASC-RECORD-NOT-ADDED TO TRUE.                            16710024
167200                                                                  16720024
167300     PERFORM 5120-DELETE-ASC-LISTQ.                               16730024
167400     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            16740024
167500                                 ASC-BLOCK-ENTRIES (2).           16750024
167600     MOVE +1                 TO ASC-BLK-SUB.                      16760024
167700     SET ASC-ITEMS-LEFT-ON-DB                                     16770024
167800                             TO TRUE.                             16780024
167900                                                                  16790024
168000     MOVE +0                 TO ASC-ITEM-SUB                      16800024
168100                                ASC-NUMBER-OF-ITEMS-READ          16810024
168200                                ASC-HIGHEST-BLOCK-WRITTEN         16820024
168300                                ASC-START-OF-SELECTED-RANGE       16830024
168400                                ASC-END-OF-SELECTED-RANGE         16840024
168500                                ASC-ITEM-AT-TOP-OF-PANEL.         16850024
168600                                                                  16860024
168700     PERFORM 4100-PREPARE-CURSOR.                                 16870024
168800                                                                  16880024
168900     PERFORM 4005-CONTINUE-BUILD.                                 16890024
169000                                                                  16900024
169100 4005-CONTINUE-BUILD.                                             16910024
169200                                                                  16920024
169300     PERFORM 1120-PREPARE-LIST-ENTRY.                             16930024
169400*                                                                 16940024
169500*    SHOULD BE THE FOLLOWING IF TEST IF THE USER CANNOT UPDATE    16950024
169600*    AN ITEM THAT IS NOT IN THEIR AREA.                           16960024
169700*    IF  PS-ERROR                                                 16970024
169800*        CONTINUE                                                 16980024
169900*    ELSE  .....  DO THE REST OF THIS PARAGRAPH.                  16990024
170000*                                                                 17000024
170100     PERFORM 4200-GET-TRECEIV-INFO.                               17010024
170200     SET PS-DATA-OK                   TO  TRUE.                   17020026
170300     IF  SQLCODE EQUAL ZERO                                       17030026
170400         MOVE RECEIV-STATUS-CDE       TO ASC-STATUS               17040026
170500         MOVE RECEIV-EXPTED-CART-CNT  TO ASC-EXPTED-CART-CNT      17050026
170600         MOVE RECEIV-ACTL-CART-CNT    TO ASC-ACTUAL-CART-CNT      17060026
170700     END-IF.                                                      17070026
170800                                                                  17080026
170900*IR-102  -- RESTRUCTURE TO ALLOW 'CM' AND SOME 'VE' STATUS CODES  17090024
171000*                                                                 17100024
171100     EVALUATE RECEIV-STATUS-CDE                                   17110024
171200         WHEN PC-IP                                               17120024
171300         WHEN PC-CM                                               17130024
171400              PERFORM 4006-CONTINUE-AGAIN                         17140024
171500                                                                  17150024
171600         WHEN PC-VE                                               17160024
171700              IF (ASC-ML-POST-CCYY GREATER PC-DUMMY-CCYY          17170024
171800              AND ASC-FS-POST-CCYY GREATER PC-DUMMY-CCYY)         17180024
171900                  PERFORM 4006-CONTINUE-AGAIN                     17190024
172000              ELSE                                                17200024
172100                  SET DP020-MSG-FATAL   TO  TRUE                  17210024
172200                  SET DP020-FK-RETURN (DP020-SRC-AID)             17220024
172300                                        TO  TRUE                  17230024
172400                  MOVE PC-TSYMSG-00627  TO  DP020-MSG-NUMBER      17240024
172500              END-IF                                              17250024
172600     END-EVALUATE.                                                17260024
172700*                                                                 17270024
172800*IR-102  -- RESTRUCTURE TO ALLOW 'CM' AND SOME 'VE' STATUS CODES  17280024
172900                                                                  17290024
173000 4006-CONTINUE-AGAIN.                                             17300024
173100                                                                  17310024
173200     MOVE RECEIV-STATUS-CDE    TO  ASC-RECEIV-STATUS-CDE.         17320024
173300     PERFORM UNTIL ASC-NUMBER-OF-ITEMS-READ =                     17330024
173400                   ASC-NUMBER-OF-SELECTED-ITEMS                   17340024
173500                                                                  17350027
173600         PERFORM 4300-READ-ITEMS-FROM-TS                          17360024
173700         PERFORM 2101-GET-NEXT-AREA                               17370024
173800     END-PERFORM.                                                 17380024
173900                                                                  17390024
174000     PERFORM 4307-END-OF-READS.                                   17400024
174100                                                                  17410024
174200     MOVE +1                   TO  PV-TOP-ITEM.                   17420024
174300     MOVE SPACE                TO  ASC-START-ITEM-REQUEST.        17430024
174400                                                                  17440024
174500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          17450024
174600         SET DP020-MSG-FATAL   TO  TRUE                           17460024
174700         SET DP020-FK-RETURN (DP020-SRC-AID) TO TRUE              17470024
174800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               17480024
174900     ELSE                                                         17490024
175000         MOVE -1               TO AOSETIDL                        17500024
175100         SET DP030-SET-CURSOR-APPL-1                              17510024
175200                                   TO TRUE                        17520024
175300         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     17530024
175400     END-IF.                                                      17540024
175500/                                                                 17550024
175600*----------------------------------------------------------------*17560024
175700*    SET UP THE HOST VARIABLES.                                  *17570024
175800*----------------------------------------------------------------*17580024
175900                                                                  17590024
176000 4100-PREPARE-CURSOR.                                             17600024
176100                                                                  17610024
176200     IF  ASC-INT-APPL-FORMAT-IND EQUAL PC-INTER-APPL-CRIT-SPEC    17620024
176300         MOVE PC000-PO-NBR-N   TO  ASC-KEY-PO-NBR                 17630024
176400         MOVE PC000-REC-SEQ-NBR-N                                 17640024
176500                               TO  ASC-KEY-RCVR-SEQ-NBR           17650024
176600                                   DK-RCVR-SEQ-NBR                17660024
176700         MOVE PC000-OPERATING-UNIT-ID                             17670024
176800                               TO  DK-OPERATING-UNIT-ID           17680024
176900         MOVE PC000-FACILITY-ID                                   17690024
177000                               TO  DK-FACT                        17700024
177100     END-IF.                                                      17710024
177200/                                                                 17720024
177300*----------------------------------------------------------------*17730024
177400*    GET THE 'STATIC' INFORMATION FOR THE TOP OF THE SCREEN.     *17740024
177500*    1ST - ENSURE THE DATA EXISTS.                               *17750024
177600*----------------------------------------------------------------*17760024
177700                                                                  17770024
177800 4200-GET-TRECEIV-INFO.                                           17780024
177900                                                                  17790024
178000     EXEC SQL                                                     17800024
178100          SELECT ORD_NBR                                          17810024
178200                ,REC_SEQ_NBR                                      17820024
178300                ,STATUS_CDE                                       17830024
178400                ,EXPTED_CART_CNT                                  17840024
178500                ,ACTL_CART_CNT                                    17850024
178600                ,PO_VER_NBR                                       17860024
178700                ,PACK_BY_ST_IND                                   17870024
178800                ,ML_POST_TMST                                     17880024
178900                ,FS_POST_TMST                                     17890024
179000          INTO   :RECEIV-ORD-NBR                                  17900024
179100                ,:RECEIV-REC-SEQ-NBR                              17910024
179200                ,:RECEIV-STATUS-CDE                               17920024
179300                ,:RECEIV-EXPTED-CART-CNT                          17930024
179400                ,:RECEIV-ACTL-CART-CNT                            17940024
179500                ,:ASC-PO-VER-NBR                                  17950024
179600                ,:ASC-PACK-BY-ST-IND                              17960024
179700                ,:ASC-ML-POST-TMST                                17970024
179800                ,:ASC-FS-POST-TMST                                17980024
179900                                                                  17990024
180000          FROM  TRECEIV                                           18000024
180100          WHERE ORD_NBR     = :DK-ORD-NBR                         18010024
180200            AND REC_SEQ_NBR = :DK-RCVR-SEQ-NBR                    18020024
180300            AND OPER_UNT_ID = :DK-OPERATING-UNIT-ID               18030024
180400            AND FCLTY_ID    = :DK-FACT                            18040024
180500            AND VER_STATUS_CDE = 'A'                              18050024
180600     END-EXEC.                                                    18060024
180700                                                                  18070024
180800     EVALUATE TRUE                                                18080024
180900         WHEN SQLCODE = +0                                        18090024
181000         WHEN SQLCODE = +100                                      18100024
181100              CONTINUE                                            18110024
181200                                                                  18120024
181300         WHEN SQLWARN0 NOT = SPACES                               18130024
181400         WHEN SQLCODE < +0                                        18140024
181500         WHEN SQLCODE > +0                                        18150024
181600              MOVE '4200-GET-TRECIEV-INFO'                        18160024
181700                              TO DP013-PARAGRAPH                  18170024
181800              MOVE 'UNSUCCESSFUL SELECT ON TRECEIV'               18180024
181900                              TO DP013-MESSAGE-TEXT (1)           18190024
182000              MOVE SQLCA      TO DP013-SQLCA                      18200024
182100              MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)         18210024
182200              SET DP013-DB2-ABEND                                 18220024
182300                  DP013-XCTL-DISPLAY-RESTART                      18230024
182400                              TO TRUE                             18240024
182500              PERFORM DP013-0000-PROCESS-ABEND                    18250024
182600     END-EVALUATE.                                                18260024
182700                                                                  18270024
182800/                                                                 18280024
182900*----------------------------------------------------------------*18290024
183000*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *18300024
183100*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *18310024
183200*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *18320024
183300*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *18330024
183400*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *18340024
183500*                                                                *18350024
183600*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *18360024
183700*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *18370024
183800*    UPON INITIALIZATION.                                        *18380024
183900*----------------------------------------------------------------*18390024
184000*>>>>>>>>>>>                                                      18400027
184100 4300-READ-ITEMS-FROM-TS.                                         18410024
184200                                                                  18420024
184300     IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                        18430024
184400         ADD +1        TO ASC-ITEM-SUB                            18440024
184500     ELSE                                                         18450024
184600         ADD +1        TO ASC-BLK-SUB                             18460024
184700         MOVE +1       TO ASC-ITEM-SUB                            18470024
184800                                                                  18480024
184900         IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY                 18490024
185000             MOVE +1   TO ASC-BLK-SUB                             18500024
185100             SET ASC-BLOCK-MODIFIED (1)                           18510024
185200                       TO TRUE                                    18520024
185300             PERFORM 8100-WRITE-TEMP-STORAGE                      18530024
185400             MOVE ASC-BLOCK-ENTRIES                               18540024
185500                       (PC-MAX-BLOCKS-IN-ARRAY)                   18550024
185600                       TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)          18560024
185700             ADD +1    TO ASC-BLK-SUB                             18570024
185800             INITIALIZE ASC-BLOCK-ENTRIES(ASC-BLK-SUB)            18580024
185900             SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)              18590024
186000                       TO TRUE                                    18600024
186100         END-IF                                                   18610024
186200     END-IF.                                                      18620024
186300                                                                  18630024
186400     ADD +1            TO ASC-NUMBER-OF-ITEMS-READ.               18640024
186500     MOVE ASC-NUMBER-OF-ITEMS-READ                                18650024
186600                           TO ASC-LIST-ITEM-NUMBER                18660024
186700                              (ASC-BLK-SUB ASC-ITEM-SUB).         18670024
186800     MOVE PC016-LINE-NBR-N    (ASC-SEL-SUB)                       18680024
186900                           TO  ASC-LINE-NBR                       18690024
187000                               (ASC-BLK-SUB ASC-ITEM-SUB)         18700024
187100                               DK-LINE-NBR.                       18710024
187200     MOVE 001                                                     18720024
187300                           TO  ASC-WRK-ORD                        18730024
187400                               (ASC-BLK-SUB ASC-ITEM-SUB).        18740024
187500     MOVE PC016-CL (ASC-SEL-SUB)                                  18750024
187600                           TO  ASC-CL-NBR                         18760024
187700                               (ASC-BLK-SUB ASC-ITEM-SUB).        18770024
187800*    MOVE PC016-SEQ (ASC-SEL-SUB)                                 18780027
187900*                          TO  ASC-SEQ-NBR                        18790027
188000*                              (ASC-BLK-SUB ASC-ITEM-SUB).        18800027
188100     MOVE PC016-SKU-DESC (ASC-SEL-SUB)                            18810024
188200                           TO  ASC-SKU-DESC                       18820024
188300                               (ASC-BLK-SUB ASC-ITEM-SUB).        18830024
188400     MOVE PC016-ITM-NBR  (ASC-SEL-SUB)                            18840024
188500                           TO  ASC-ITM-NBR                        18850024
188600                               (ASC-BLK-SUB ASC-ITEM-SUB).        18860024
188700                                                                  18870027
188800     PERFORM 4310-CALL-CICS-API-ARCH                              18880027
188900                                                                  18890027
189000     MOVE 'NF'             TO  ASC-STAT                           18900027
189100                               (ASC-BLK-SUB ASC-ITEM-SUB).        18910024
189200     PERFORM 4320-GET-TRECITM-INFO.                               18920024
189300     IF  SQLCODE = +0                                             18930024
189400         IF  RECITM-DTL-CK-ITM-QTY > 0                            18940024
189500             MOVE RECITM-DTL-CK-ITM-QTY                           18950024
189600                           TO ASC-ACTUAL-ITEM-QTY                 18960024
189700                               (ASC-BLK-SUB ASC-ITEM-SUB)         18970024
189800         ELSE                                                     18980024
189900             MOVE RECITM-PKSL-ITM-QTY                             18990024
190000                           TO ASC-ACTUAL-ITEM-QTY                 19000024
190100                               (ASC-BLK-SUB ASC-ITEM-SUB)         19010024
190200                                                                  19020024
190300         END-IF                                                   19030024
190400     ELSE                                                         19040024
190500         MOVE ZEROES       TO ASC-ACTUAL-ITEM-QTY                 19050024
190600                               (ASC-BLK-SUB ASC-ITEM-SUB)         19060024
190700     END-IF.                                                      19070024
190800                                                                  19080027
190900 4307-END-OF-READS.                                               19090024
191000     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          19100024
191100         MOVE +1               TO ASC-BLK-SUB                     19110024
191200         PERFORM 8100-WRITE-TEMP-STORAGE                          19120024
191300         ADD +1                TO ASC-BLK-SUB                     19130024
191400         PERFORM 8100-WRITE-TEMP-STORAGE                          19140024
191500                                                                  19150024
191600         MOVE 1                TO ASC-BLK-SUB                     19160024
191700                                  PV-BLOCK-NUMBER                 19170024
191800         PERFORM 4410-READ-TEMP-STORAGE                           19180024
191900         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             19190024
192000             MOVE 2            TO ASC-BLK-SUB                     19200024
192100                                  PV-BLOCK-NUMBER                 19210024
192200             PERFORM 4410-READ-TEMP-STORAGE                       19220024
192300         END-IF                                                   19230024
192400     END-IF.                                                      19240024
192500                                                                  19250024
192600/                                                                 19260024
192700 4310-CALL-CICS-API-ARCH.                                         19270027
192800                                                                  19280027
192900      INITIALIZE XL001-ITEM-COMMAREA                              19290027
193000                                                                  19300027
193100      MOVE ASC-ITM-NBR (ASC-BLK-SUB ASC-ITEM-SUB)                 19310027
193200                            TO XL001-KEY-ITM-NBR.                 19320027
193300                                                                  19330027
193400      SET  XL001-BY-ITEM                                          19340027
193500           XL001-SELECT-SKU TO TRUE.                              19350027
193600                                                                  19360027
193700      CALL XL001-VSM-PGM USING  DFHEIBLK                          19370032
193800                                XL001-COMMAREA                    19380032
193900                                XL001-ITEM-COMMAREA.              19390032
194000                                                                  19400032
194100      EVALUATE TRUE                                               19410027
194200                                                                  19420027
194300          WHEN XL001-SUCCESSFUL                                   19430027
194400               MOVE XL001-SKU-NBR     TO ASC-NIS-SEQ-NBR          19440027
194500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19450027
194600                                                                  19460027
194700          WHEN XL001-SQL-ERROR                                    19470027
194800               IF XL001-SKU-SQLCODE = +100                        19480027
194900                  MOVE '00000000'     TO ASC-NIS-SEQ-NBR          19490027
195000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  19500027
195100               ELSE                                               19510027
195200                  MOVE XL001-SKU-NBR  TO PV-DISPLAY-SKU-NBR       19520027
195300                  MOVE '4310-CALL-CICS-API-ARCH'                  19530027
195400                                      TO DP013-PARAGRAPH          19540027
195500                  MOVE 'UNSUCCESSFUL SELECT ON XLV SKU'           19550027
195600                                      TO DP013-MESSAGE-TEXT (1)   19560027
195700                  STRING 'XL VIEW ERROR PARA- '                   19570027
195800                                      DELIMITED BY SIZE           19580027
195900                  XL001-ERROR-PARAGRAPH-NBR DELIMITED BY SIZE     19590027
196000                                  INTO DP013-MESSAGE-TEXT (2)     19600027
196100                  STRING 'SKU NUMBER : ' DELIMITED BY SIZE        19610027
196200                      PV-DISPLAY-SKU-NBR DELIMITED BY SIZE        19620027
196300                                  INTO DP013-MESSAGE-TEXT (3)     19630027
196400                  MOVE XL001-SKU-SQLCODE TO DP013-SQLCA           19640027
196500                  MOVE 'XLV_SKU'  TO DP013-DB2-TABLE-NAME (1)     19650027
196600                  SET DP013-DB2-ABEND                             19660027
196700                      DP013-XCTL-DISPLAY-RESTART                  19670027
196800                                  TO TRUE                         19680027
196900                  PERFORM DP013-0000-PROCESS-ABEND                19690027
197000               END-IF                                             19700027
197100               WHEN XL001-INVALID-ACCESS                          19710027
197200                  MOVE 'ACCESS INFO FOR XLKUT001 INCORRECT'       19720027
197300                                     TO DP013-PARAGRAPH           19730027
197400                  MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'           19740027
197500                                     TO DP013-MESSAGE-TEXT (1)    19750027
197600                  MOVE SQLCA         TO DP013-SQLCA               19760027
197700                  MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)  19770027
197800                  SET DP013-DB2-ABEND                             19780027
197900                      DP013-XCTL-DISPLAY-RESTART                  19790027
198000                                     TO TRUE                      19800027
198100                                                                  19810027
198200                  PERFORM DP013-0000-PROCESS-ABEND                19820027
198300                                                                  19830027
198400             WHEN OTHER                                           19840027
198500                  MOVE '4310-CALL-CICS-API-ARCH'                  19850027
198600                                     TO DP013-PARAGRAPH           19860027
198700                  MOVE 'UNSUCCESSFUL SELECT ON XLV_SKU'           19870027
198800                                     TO DP013-MESSAGE-TEXT (1)    19880027
198900                  MOVE SQLCA         TO DP013-SQLCA               19890027
199000                  MOVE 'XLV_SKU'     TO DP013-DB2-TABLE-NAME (1)  19900027
199100                  SET DP013-DB2-ABEND                             19910027
199200                      DP013-XCTL-DISPLAY-RESTART                  19920027
199300                                     TO TRUE                      19930027
199400                                                                  19940027
199500                  PERFORM DP013-0000-PROCESS-ABEND                19950027
199600             END-EVALUATE.                                        19960027
199700                                                                  19970027
199800/                                                                 19980027
199900                                                                  19990027
200000 4320-GET-TRECITM-INFO.                                           20000024
200100                                                                  20010024
200200     EXEC SQL                                                     20020024
200300          SELECT  PKSL_ITM_QTY                                    20030024
200400                 ,DTL_CK_ITM_QTY                                  20040024
200500                 ,EXPTED_CART_CNT                                 20050024
200600                 ,ACTL_CART_CNT                                   20060024
200700                 ,PO_VER_NBR                                      20070024
200800            INTO :RECITM-PKSL-ITM-QTY                             20080024
200900                ,:RECITM-DTL-CK-ITM-QTY                           20090024
201000                ,:RECITM-EXPTED-CART-CNT                          20100024
201100                ,:RECITM-ACTL-CART-CNT                            20110024
201200                ,:ASC-RECITM-PO-VER-NBR                           20120024
201300            FROM TRECITM                                          20130024
201400           WHERE  ORD_NBR        = :DK-ORD-NBR                    20140024
201500             AND  ORD_LNE_NBR    = :DK-LINE-NBR                   20150024
201600             AND  REC_SEQ_NBR    = :DK-RCVR-SEQ-NBR               20160024
201700             AND  OPER_UNT_ID    = :DK-OPERATING-UNIT-ID          20170024
201800             AND  FCLTY_ID       = :DK-FACT                       20180024
201900             AND  VER_STATUS_CDE = 'A'                            20190024
202000             AND  PO_VER_NBR =                                    20200024
202100                 (SELECT MAX(PO_VER_NBR)                          20210024
202200                    FROM TRECITM                                  20220024
202300                   WHERE ORD_NBR     = :DK-ORD-NBR                20230024
202400                     AND ORD_LNE_NBR = :DK-LINE-NBR               20240024
202500                     AND REC_SEQ_NBR = :DK-RCVR-SEQ-NBR           20250024
202600                     AND OPER_UNT_ID = :DK-OPERATING-UNIT-ID      20260024
202700                     AND FCLTY_ID    = :DK-FACT                   20270024
202800                     AND  VER_STATUS_CDE = 'A')                   20280024
202900     END-EXEC.                                                    20290024
203000                                                                  20300024
203100     EVALUATE TRUE                                                20310024
203200         WHEN SQLCODE = +0                                        20320024
203300         WHEN SQLCODE = +100                                      20330024
203400              CONTINUE                                            20340024
203500                                                                  20350024
203600         WHEN SQLWARN0 NOT = SPACES                               20360024
203700         WHEN SQLCODE < +0                                        20370024
203800         WHEN SQLCODE > +0                                        20380024
203900              MOVE '4320-GET-TRECITM-INFO'                        20390024
204000                              TO DP013-PARAGRAPH                  20400024
204100              MOVE 'UNSUCCESSFUL SELECT ON TRECITM'               20410024
204200                              TO DP013-MESSAGE-TEXT (1)           20420024
204300              MOVE SQLCA      TO DP013-SQLCA                      20430024
204400              MOVE 'TRECITM ' TO DP013-DB2-TABLE-NAME (1)         20440024
204500              SET DP013-DB2-ABEND                                 20450024
204600                  DP013-XCTL-DISPLAY-RESTART                      20460024
204700                              TO TRUE                             20470024
204800              PERFORM DP013-0000-PROCESS-ABEND                    20480024
204900     END-EVALUATE.                                                20490024
205000                                                                  20500024
205100*----------------------------------------------------------------*20510024
205200* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *20520024
205300*----------------------------------------------------------------*20530024
205400                                                                  20540024
205500 4400-MOVE-COMMAREA-TO-SCREEN.                                    20550024
205600                                                                  20560024
205700     MOVE ASC-KEY-PO-NBR           TO  PC-SAVE-PO-NBR.            20570024
205800     MOVE PC-SAVE-PO-NBR           TO  APONBRO.                   20580024
205900     MOVE ASC-KEY-RCVR-SEQ-NBR     TO  ASEQNBRO.                  20590024
206000     MOVE ASC-STATUS               TO  ASTATO.                    20600024
206100     MOVE ASC-EXPTED-CART-CNT      TO  AEXQTYO.                   20610024
206200     MOVE ASC-ACTUAL-CART-CNT      TO  AACQTYO.                   20620024
206300     MOVE ASC-OPERATING-UNIT-ID    TO  AOPUNTO.                   20630024
206400     MOVE ASC-FACILITY-ID          TO  AFACTYO.                   20640024
206500     MOVE ASC-DEPT-NBR             TO  ADEPTNOO.                  20650038
206600                                                                  20660024
206700                                                                  20670024
206800     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             20680024
206900         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          20690024
207000         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          20700024
207100             MOVE +1    TO ASC-BLK-SUB                            20710024
207200             PERFORM 8100-WRITE-TEMP-STORAGE                      20720024
207300             ADD +1     TO ASC-BLK-SUB                            20730024
207400             PERFORM 8100-WRITE-TEMP-STORAGE                      20740024
207500             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             20750024
207600                 GIVING PV-BLOCK-NUMBER                           20760024
207700                 REMAINDER PV-REMAINDER                           20770024
207800             IF  PV-REMAINDER > ZERO                              20780024
207900                 ADD +1 TO PV-BLOCK-NUMBER                        20790024
208000             END-IF                                               20800024
208100             MOVE +1    TO ASC-BLK-SUB                            20810024
208200             PERFORM 4410-READ-TEMP-STORAGE                       20820024
208300             ADD +1     TO ASC-BLK-SUB                            20830024
208400                           PV-BLOCK-NUMBER                        20840024
208500             PERFORM 4410-READ-TEMP-STORAGE                       20850024
208600     END-IF.                                                      20860024
208700                                                                  20870024
208800     MOVE +1            TO ASC-BLK-SUB.                           20880024
208900     COMPUTE ASC-ITEM-SUB =                                       20890024
209000         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              20900024
209100         + PC-ITEMS-PER-PANEL).                                   20910024
209200                                                                  20920024
209300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        20930024
209400         ADD +1         TO ASC-BLK-SUB                            20940024
209500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            20950024
209600     END-IF.                                                      20960024
209700                                                                  20970024
209800     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           20980024
209900         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                20990024
210000     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        21000024
210100     PERFORM 4420-FORMAT-LIST-LINES                               21010024
210200         VARYING PV-SUB                                           21020024
210300         FROM PC-ITEMS-PER-PANEL BY -1                            21030024
210400         UNTIL PV-SUB < +1.                                       21040024
210500                                                                  21050024
210600     COMPUTE ASC-ITEMS-DISPLAYED =                                21060024
210700         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          21070024
210800     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    21080024
210900                                      ASTRTITO.                   21090024
211000     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    21100024
211100     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    21110024
211200     MOVE SPACE                    TO  ASC-START-ITEM-REQUEST.    21120024
211300                                                                  21130024
211400     IF  DP020-MSG-NUMBER-X = SPACE                               21140024
211500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  21150024
211600*            --- MORE ITEMS TO DISPLAY ----                       21160024
211700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            21170024
211800             SET DP020-MSG-INFORMATIONAL TO TRUE                  21180024
211900         END-IF                                                   21190024
212000     END-IF.                                                      21200024
212100                                                                  21210024
212200*----------------------------------------------------------------*21220024
212300*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *21230024
212400*----------------------------------------------------------------*21240024
212500                                                                  21250024
212600 4410-READ-TEMP-STORAGE.                                          21260024
212700                                                                  21270024
212800     EXEC CICS                                                    21280024
212900         READQ TS                                                 21290024
213000             QUEUE (ASC-LIST-QUEUE-NAME)                          21300024
213100             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21310024
213200             ITEM  (PV-BLOCK-NUMBER)                              21320024
213300             RESP  (PV-CICS-RESP)                                 21330024
213400     END-EXEC.                                                    21340024
213500                                                                  21350024
213600     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       21360024
213700       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     21370024
213800         CONTINUE                                                 21380024
213900     ELSE                                                         21390024
214000         SET DP013-CICS-ABEND     TO TRUE                         21400024
214100         SET DP013-NO-ROLLBACK    TO TRUE                         21410024
214200         MOVE '4410-READ-TEMP-STORAGE'                            21420024
214300                                  TO DP013-PARAGRAPH              21430024
214400         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      21440024
214500                                  TO DP013-MESSAGE-TEXT(1)        21450024
214600         PERFORM DP013-0000-PROCESS-ABEND                         21460024
214700     END-IF.                                                      21470024
214800                                                                  21480024
214900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             21490024
215000                                                                  21500024
215100     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         21510024
215200         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               21520024
215300     END-IF.                                                      21530024
215400/                                                                 21540024
215500*----------------------------------------------------------------*21550024
215600*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *21560024
215700*----------------------------------------------------------------*21570024
215800                                                                  21580024
215900 4420-FORMAT-LIST-LINES.                                          21590024
216000                                                                  21600024
216100     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      21610024
216200         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                21620024
216300         MOVE DP015-ASK-DRK-OFF TO                                21630024
216400                                   MR-ACTUL-QTYA    (PV-SUB)      21640024
216500                                   MR-AITEM-QTYA    (PV-SUB)      21650024
216600                                   MR-OPER-SETA     (PV-SUB)      21660024
216700         MOVE SPACE             TO  MR-LINE-X         (PV-SUB)    21670024
216800                                    MR-WORK-ORD-X     (PV-SUB)    21680024
216900                                    MR-CL             (PV-SUB)    21690035
217000                                    MR-SKU            (PV-SUB)    21700035
217100                                    MR-SKU-DESC       (PV-SUB)    21710024
217200                                    MR-STATUS         (PV-SUB)    21720024
217300                                    MR-ACTUL-QTY-X    (PV-SUB)    21730024
217400                                    MR-AITEM-QTY-X    (PV-SUB)    21740024
217500                                    MR-CREATE-DTE     (PV-SUB)    21750024
217600                                    MR-CREATE-TME     (PV-SUB)    21760024
217700                                    MR-OPER-SET-X     (PV-SUB)    21770024
217800     ELSE                                                         21780024
217900                                                                  21790024
218000         MOVE ASC-LINE-NBR      (ASC-BLK-SUB ASC-ITEM-SUB)        21800024
218100                             TO MR-LINE          (PV-SUB)         21810024
218200         MOVE ASC-WRK-ORD       (ASC-BLK-SUB ASC-ITEM-SUB)        21820024
218300                             TO MR-WORK-ORD      (PV-SUB)         21830024
218400*        MOVE ASC-DEPT-NBR     (ASC-BLK-SUB ASC-ITEM-SUB)         21840036
218500         MOVE ASC-DEPT-NBR                                        21850036
218600                             TO PV-DEPT                           21860024
218700         MOVE ASC-CL-NBR       (ASC-BLK-SUB ASC-ITEM-SUB)         21870024
218800                             TO PV-CL                             21880024
218900                                MR-CL     (PV-SUB)                21890035
219000         MOVE ASC-NIS-SEQ-NBR      (ASC-BLK-SUB ASC-ITEM-SUB)     21900027
219100                             TO MR-SKU           (PV-SUB)         21910024
219200         MOVE ASC-SKU-DESC      (ASC-BLK-SUB ASC-ITEM-SUB)        21920024
219300                             TO MR-SKU-DESC      (PV-SUB)         21930024
219400         MOVE ASC-STAT          (ASC-BLK-SUB ASC-ITEM-SUB)        21940024
219500                             TO MR-STATUS        (PV-SUB)         21950024
219600         IF  MR-ACTUL-QTYC (PV-SUB) EQUAL DP015-RED               21960024
219700             CONTINUE                                             21970024
219800         ELSE                                                     21980024
219900            MOVE ASC-ACTUAL-CART-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    21990024
220000                             TO MR-ACTUL-QTY     (PV-SUB)         22000024
220100         END-IF                                                   22010024
220200         IF  MR-AITEM-QTYC (PV-SUB) EQUAL DP015-RED               22020024
220300             CONTINUE                                             22030024
220400         ELSE                                                     22040024
220500            MOVE ASC-ACTUAL-ITEM-QTY(ASC-BLK-SUB ASC-ITEM-SUB)    22050024
220600                             TO MR-AITEM-QTY     (PV-SUB)         22060024
220700         END-IF                                                   22070024
220800         MOVE ASC-CREATE-DATE   (ASC-BLK-SUB ASC-ITEM-SUB)        22080024
220900                             TO MR-CREATE-DTE    (PV-SUB)         22090024
221000         MOVE ASC-CREATE-TIME(ASC-BLK-SUB ASC-ITEM-SUB)           22100024
221100                             TO MR-CREATE-TME(PV-SUB)             22110024
221200         IF  MR-OPER-SETC (PV-SUB) EQUAL DP015-RED                22120024
221300             CONTINUE                                             22130024
221400         ELSE                                                     22140024
221500             MOVE ASC-OPER-SET-ID   (ASC-BLK-SUB ASC-ITEM-SUB)    22150024
221600                             TO MR-OPER-SET      (PV-SUB)         22160024
221700         END-IF                                                   22170024
221800     END-IF.                                                      22180024
221900                                                                  22190024
222000     SUBTRACT +1 FROM ASC-ITEM-SUB                                22200024
222100     IF  ASC-ITEM-SUB < + 1                                       22210024
222200         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  22220024
222300         MOVE +1                 TO ASC-BLK-SUB                   22230024
222400     END-IF.                                                      22240024
222500                                                                  22250024
222600******************************************************************22260024
222700** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **22270024
222800** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **22280024
222900** ISSUE A WARNING.                                             **22290024
223000******************************************************************22300024
223100                                                                  22310024
223200 4430-CHECK-FOR-BEGIN-AND-END.                                    22320024
223300                                                                  22330024
223400     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       22340024
223500         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     22350024
223600*            -- NO END-OF-RANGE SPECFIED ---                      22360024
223700             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            22370024
223800             SET DP020-MSG-WARNING TO TRUE                        22380024
223900             PERFORM 4431-POSITION-AT-WARNING                     22390024
224000         END-IF                                                   22400024
224100     ELSE                                                         22410024
224200         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     22420024
224300*            -- NO BEGINNING-OF-RANGE SPECFIED ---                22430024
224400             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            22440024
224500             SET DP020-MSG-WARNING TO TRUE                        22450024
224600             PERFORM 4431-POSITION-AT-WARNING                     22460024
224700         END-IF                                                   22470024
224800     END-IF.                                                      22480024
224900******************************************************************22490024
225000** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **22500024
225100** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **22510024
225200** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **22520024
225300** POSITION THE CURSOR THERE.                                   **22530024
225400******************************************************************22540024
225500                                                                  22550024
225600 4431-POSITION-AT-WARNING.                                        22560024
225700                                                                  22570024
225800     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 22580024
225900                    - PV-TOP-ITEM + 1.                            22590024
226000     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22600024
226100         CONTINUE                                                 22610024
226200     ELSE                                                         22620024
226300         SET DP030-SET-CURSOR-APPL-1                              22630024
226400                                   TO TRUE                        22640024
226500         MOVE -1                   TO MR-ACTUL-QTYL (PV-SUB)      22650024
226600         MOVE DP015-REVERSE        TO MR-ACTUL-QTYH (PV-SUB)      22660024
226700         MOVE DP015-YELLOW         TO MR-ACTUL-QTYC (PV-SUB)      22670024
226800     END-IF.                                                      22680024
226900                                                                  22690024
227000     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   22700024
227100                    - PV-TOP-ITEM + 1.                            22710024
227200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      22720024
227300         CONTINUE                                                 22730024
227400     ELSE                                                         22740024
227500         SET DP030-SET-CURSOR-APPL-1                              22750024
227600                                   TO TRUE                        22760024
227700         MOVE -1                   TO MR-ACTUL-QTYL (PV-SUB)      22770024
227800         MOVE DP015-REVERSE        TO MR-ACTUL-QTYH (PV-SUB)      22780024
227900         MOVE DP015-YELLOW         TO MR-ACTUL-QTYC (PV-SUB)      22790024
228000     END-IF.                                                      22800024
228100/                                                                 22810024
228200******************************************************************22820024
228300** DELETE THE LIST TEMP STORAGE QUEUE.                          **22830024
228400******************************************************************22840024
228500                                                                  22850024
228600 5120-DELETE-ASC-LISTQ.                                           22860024
228700                                                                  22870024
228800     EXEC CICS                                                    22880024
228900          DELETEQ TS                                              22890024
229000             QUEUE (ASC-LIST-QUEUE-NAME)                          22900024
229100             RESP  (PV-CICS-RESP)                                 22910024
229200     END-EXEC.                                                    22920024
229300                                                                  22930024
229400     IF (PV-CICS-RESP = DFHRESP (NORMAL)                          22940024
229500     OR  PV-CICS-RESP = DFHRESP (QIDERR))                         22950024
229600         CONTINUE                                                 22960024
229700     ELSE                                                         22970024
229800         SET DP013-CICS-ABEND      TO TRUE                        22980024
229900         SET DP013-NO-ROLLBACK     TO TRUE                        22990024
230000         MOVE '5120-DELETE-ASC-LISTQ'                             23000024
230100                                   TO DP013-PARAGRAPH             23010024
230200         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           23020024
230300                                   TO DP013-MESSAGE-TEXT(1)       23030024
230400         PERFORM DP013-0000-PROCESS-ABEND                         23040024
230500     END-IF.                                                      23050024
230600/                                                                 23060024
230700*----------------------------------------------------------------*23070024
230800*  WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION,  *23080024
230900*  SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT  *23090024
231000*  THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO     *23100024
231100*  THE USER.                                                     *23110024
231200*----------------------------------------------------------------*23120024
231300                                                                  23130024
231400 6000-REFRESH-PANEL-FROM-TEMP.                                    23140024
231500                                                                  23150024
231600     IF  ASC-UPDATE-TSQ                                           23160024
231700         SET ASC-NO-TSQ-UPDATE TO TRUE                            23170024
231800         MOVE ZERO                 TO PV-SAVE-ITEM                23180024
231900                                      PV-SEL-QUEUE-ITEM           23190024
232000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        23200024
232100                                   TO PV-HOLD-SELECTED-ITEMS      23210024
232200         PERFORM 6100-UPDATE-TSQ                                  23220024
232300             UNTIL PV-ITEMS-PROCESSED >                           23230024
232400                                     ASC-NUMBER-OF-SELECTED-ITEMS 23240024
232500         PERFORM 6010-DELETE-SEL-QUEUE                            23250024
232600         INITIALIZE ASC-BLOCK-ENTRIES (1)                         23260024
232700                    ASC-BLOCK-ENTRIES (2)                         23270024
232800                                                                  23280024
232900         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 23290024
233000                GIVING PV-BLOCK-NUMBER                            23300024
233100                REMAINDER PV-REMAINDER                            23310024
233200         IF  PV-REMAINDER > ZERO                                  23320024
233300             ADD +1     TO PV-BLOCK-NUMBER                        23330024
233400         END-IF                                                   23340024
233500         MOVE +1        TO ASC-BLK-SUB                            23350024
233600         PERFORM 4410-READ-TEMP-STORAGE                           23360024
233700         ADD +1         TO ASC-BLK-SUB                            23370024
233800                           PV-BLOCK-NUMBER                        23380024
233900         PERFORM 4410-READ-TEMP-STORAGE                           23390024
234000     END-IF.                                                      23400024
234100                                                                  23410024
234200*----------------------------------------------------------------*23420024
234300*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *23430024
234400*----------------------------------------------------------------*23440024
234500                                                                  23450024
234600 6010-DELETE-SEL-QUEUE.                                           23460024
234700                                                                  23470024
234800     EXEC CICS                                                    23480024
234900         DELETEQ TS                                               23490024
235000             QUEUE (ASC-SEL-QUEUE-NAME2)                          23500024
235100             RESP  (PV-CICS-RESP)                                 23510024
235200     END-EXEC.                                                    23520024
235300                                                                  23530024
235400     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      23540024
235500        (PV-CICS-RESP = DFHRESP(QIDERR)))                         23550024
235600         CONTINUE                                                 23560024
235700     ELSE                                                         23570024
235800         SET DP013-CICS-ABEND TO TRUE                             23580024
235900         SET DP013-NO-ROLLBACK TO TRUE                            23590024
236000         MOVE '6010-DELETE-SEL-QUEUE'                             23600024
236100                        TO DP013-PARAGRAPH                        23610024
236200         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         23620024
236300                        TO DP013-MESSAGE-TEXT (1)                 23630024
236400         PERFORM DP013-0000-PROCESS-ABEND                         23640024
236500     END-IF.                                                      23650024
236600                                                                  23660024
236700*----------------------------------------------------------------*23670024
236800*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *23680024
236900*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *23690024
237000*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *23700024
237100*    THE TEMP QUEUE.                                             *23710024
237200*----------------------------------------------------------------*23720024
237300                                                                  23730024
237400 6100-UPDATE-TSQ.                                                 23740024
237500                                                                  23750024
237600     ADD 1                     TO  PV-SEL-QUEUE-ITEM.             23760024
237700     PERFORM 6105-READ-SEL-QUEUE.                                 23770024
237800     PERFORM                                                      23780024
237900         VARYING PC016-IDX                                        23790024
238000         FROM 1 BY 1                                              23800024
238100         UNTIL ((PV-ITEMS-PROCESSED >                             23810024
238200                              PV-HOLD-SELECTED-ITEMS)             23820024
238300         OR (PC016-IDX GREATER THAN PC016-MAX-ITEMS))             23830024
238400         IF  PC016-ACTION-SW (PC016-IDX) > SPACE                  23840024
238500             PERFORM 6110-PROCESS-ITEMS                           23850024
238600         END-IF                                                   23860024
238700         ADD +1                TO PV-ITEMS-PROCESSED              23870024
238800     END-PERFORM.                                                 23880024
238900     PERFORM 8111-WRITE-LIST-QUEUE.                               23890024
239000*----------------------------------------------------------------*23900024
239100*    READ THE LIST QUEUE RECORD.                                 *23910024
239200*----------------------------------------------------------------*23920024
239300                                                                  23930024
239400 6105-READ-SEL-QUEUE.                                             23940024
239500                                                                  23950024
239600     EXEC CICS                                                    23960024
239700          READQ TS                                                23970024
239800              QUEUE (ASC-SEL-QUEUE-NAME2)                         23980024
239900              INTO  (PC016-TS-SEL-REC)                            23990024
240000              ITEM  (PV-SEL-QUEUE-ITEM)                           24000024
240100              RESP  (PV-CICS-RESP)                                24010024
240200     END-EXEC.                                                    24020024
240300                                                                  24030024
240400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24040024
240500         CONTINUE                                                 24050024
240600     ELSE                                                         24060024
240700         SET DP013-CICS-ABEND      TO  TRUE                       24070024
240800         SET DP013-NO-ROLLBACK     TO  TRUE                       24080024
240900         MOVE '6105-READ-SEL-QUEUE'                               24090024
241000                                   TO  DP013-PARAGRAPH            24100024
241100         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           24110024
241200                                   TO  DP013-MESSAGE-TEXT(1)      24120024
241300         PERFORM DP013-0000-PROCESS-ABEND                         24130024
241400     END-IF.                                                      24140024
241500/                                                                 24150024
241600*----------------------------------------------------------------*24160024
241700*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*24170024
241800*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*24180024
241900*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *24190024
242000*----------------------------------------------------------------*24200024
242100                                                                  24210024
242200 6110-PROCESS-ITEMS.                                              24220024
242300                                                                  24230024
242400     COMPUTE PV-ITEM = 1 + ((PC016-ITEM (PC016-IDX) - 1)          24240024
242500                     / PC-ITEMS-PER-PANEL).                       24250024
242600                                                                  24260024
242700     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           24270024
242800         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          24280024
242900             PERFORM 8111-WRITE-LIST-QUEUE                        24290024
243000         END-IF                                                   24300024
243100         MOVE PV-ITEM          TO PV-SAVE-ITEM                    24310024
243200                                                                  24320024
243300         PERFORM 8112-READ-LIST-QUEUE                             24330024
243400         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               24340024
243500             CONTINUE                                             24350024
243600         END-IF                                                   24360024
243700     END-IF.                                                      24370024
243800                                                                  24380024
243900     COMPUTE PV-SUB = (PC016-ITEM (PC016-IDX)                     24390024
244000                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              24400024
244100/                                                                 24410024
244200 7400-VALIDATE-OPER-SET-ID.                                       24420024
244300                                                                  24430024
244400      MOVE ASC-OPERATING-UNIT-ID TO DK-OPERATING-UNIT-ID          24440044
244500                                                                  24450042
244600      EXEC SQL                                                    24460024
244700           SELECT OPER_SET_ID                                     24470024
244800           INTO :OPRSET-OPER-SET-ID                               24480024
244900           FROM TOPRSET                                           24490024
245000           WHERE OPER_SET_ID = :DK-OPER-SET-ID                    24500024
245100             AND OPER_UNT_ID = :DK-OPERATING-UNIT-ID              24510042
245200      END-EXEC.                                                   24520024
245300                                                                  24530024
245400                                                                  24540024
245500     EVALUATE TRUE                                                24550024
245600         WHEN SQLCODE = ZERO                                      24560024
245700         WHEN SQLCODE = +100                                      24570024
245800              CONTINUE                                            24580024
245900         WHEN SQLWARN0 NOT EQUAL SPACE                            24590024
246000         WHEN SQLCODE NOT EQUAL ZERO                              24600024
246100              MOVE '7400-VALIDATE-OPER-SET-ID'                    24610024
246200                               TO DP013-PARAGRAPH                 24620024
246300              MOVE 'SELECT TOPRSET'                               24630024
246400                               TO DP013-MESSAGE-TEXT (1)          24640024
246500              MOVE SQLCA       TO DP013-SQLCA                     24650024
246600              SET DP013-DB2-ABEND                                 24660024
246700                               TO TRUE                            24670024
246800              PERFORM DP013-0000-PROCESS-ABEND                    24680024
246900     END-EVALUATE.                                                24690024
247000                                                                  24700024
247100/                                                                 24710024
247200*----------------------------------------------------------------*24720024
247300*    SET THE STATUS CODE TO COMPLETE FOR THIS ITEM.              *24730024
247400*    RATHER THAN JUST UPDATING THE "CURRENT" ROW, WE MUST        *24740024
247500*    SET THE VER_STATUS_CODE TO INACTIVE, AND INSERT A NEW       *24750024
247600*    ROW WITH THE PROPER STATUS CODE.                            *24760024
247700*----------------------------------------------------------------*24770024
247800                                                                  24780024
247900 7530-UPDATE-RECITM.                                              24790024
248000                                                                  24800024
248100     PERFORM 7540-INSERT-TWRKORD.                                 24810024
248200     MOVE ASC-KEY-PO-NBR            TO DK-ORD-NBR.                24820026
248300     MOVE ASC-KEY-RCVR-SEQ-NBR      TO DK-RCVR-SEQ-NBR.           24830026
248400     MOVE ASC-KEY-OPER-UNT-ID       TO DK-OPERATING-UNIT-ID.      24840026
248500     MOVE ASC-KEY-FCLTY-ID          TO DK-FACT.                   24850026
248600     PERFORM 4200-GET-TRECEIV-INFO.                               24860026
248700     IF RECEIV-STATUS-CDE EQUAL PC-CM                             24870026
248800         PERFORM 7600-UPDATE-TRECEIV                              24880024
248900     END-IF.                                                      24890024
249000/                                                                 24900024
249100*----------------------------------------------------------------*24910024
249200*    SINCE TIMESTAMP ENSURE UNIQUENESS, AND IT IS NOT USED IN    *24920024
249300*    SUBSEQUENT PROGRAMS IN THE WHERE CLAUSE, WE FIRST CHECK     *24930024
249400*    FOR A "DUPLICATE" ROW BY THE FIRST 6 COLUMNS.  IF THE ROW   *24940024
249500*    IS FOUND, NO NEW ROW IS INSERTED, OTHERWISE,                *24950024
249600*    INSERT THE NEW ACTIVE, COMPLETED ROW.                       *24960024
249700*----------------------------------------------------------------*24970024
249800                                                                  24980024
249900 7540-INSERT-TWRKORD.                                             24990024
250000                                                                  25000024
250100     MOVE ZERO              TO  PV-DB2-COUNT.                     25010024
250200     EXEC SQL                                                     25020024
250300          SELECT COUNT(*)                                         25030024
250400          INTO  :PV-DB2-COUNT :PV-NULL-IND                        25040024
250500          FROM   TWRKORD                                          25050024
250600          WHERE                                                   25060024
250700                 ORD_NBR            =  :ASC-KEY-PO-NBR            25070024
250800            AND  RCVR_SEQ_NBR       =  :ASC-KEY-RCVR-SEQ-NBR      25080024
250900            AND  ORD_LNE_NBR        =  :PC-LINE-NBR               25090024
251000            AND  WORK_ORD_SEQ_NBR   =  :PC-WRK-ORD                25100024
251100            AND  OPER_UNT_ID        =  :ASC-OPERATING-UNIT-ID     25110024
251200            AND  FCLTY_ID           =  :ASC-FACILITY-ID           25120024
251300            AND  VER_STATUS_CDE     =  :PC-A                      25130024
251400     END-EXEC.                                                    25140024
251500                                                                  25150024
251600     EVALUATE TRUE                                                25160024
251700         WHEN SQLCODE = ZERO                                      25170024
251800         WHEN SQLCODE = +100                                      25180024
251900              CONTINUE                                            25190024
252000         WHEN SQLWARN0 NOT = SPACE                                25200024
252100         WHEN SQLCODE NOT = ZERO                                  25210024
252200              MOVE '7540-INSERT-TWRKORD'                          25220024
252300                               TO DP013-PARAGRAPH                 25230024
252400              MOVE 'INSERT TWRKORD'                               25240024
252500                               TO DP013-MESSAGE-TEXT (1)          25250024
252600              MOVE SQLCA       TO DP013-SQLCA                     25260024
252700              MOVE 'TWRKORD '  TO DP013-DB2-TABLE-NAME (1)        25270024
252800              SET DP013-DB2-ABEND                                 25280024
252900                               TO TRUE                            25290024
253000              PERFORM DP013-0000-PROCESS-ABEND                    25300024
253100     END-EVALUATE.                                                25310024
253200                                                                  25320024
253300     IF  PV-DB2-COUNT EQUAL ZERO                                  25330024
253400         PERFORM 7541-REAL-INSERT-TWRKORD                         25340024
253500     ELSE                                                         25350024
253600         SET PS-ERROR                                             25360024
253700             DP020-MSG-FATAL   TO TRUE                            25370024
253800         MOVE PC-TSYMSG-00117  TO DP020-MSG-NUMBER                25380024
253900         MOVE -1               TO AOSETIDL                        25390024
254000         SET DP030-SET-CURSOR-APPL-1                              25400024
254100                               TO TRUE                            25410024
254200     END-IF.                                                      25420024
254300                                                                  25430024
254400 7541-REAL-INSERT-TWRKORD.                                        25440024
254500                                                                  25450024
254600     EXEC SQL                                                     25460024
254700          INSERT                                                  25470024
254800          INTO  TWRKORD                                           25480024
254900               (ORD_NBR                                           25490024
255000              , RCVR_SEQ_NBR                                      25500024
255100              , ORD_LNE_NBR                                       25510024
255200              , WORK_ORD_SEQ_NBR                                  25520024
255300              , OPER_UNT_ID                                       25530024
255400              , FCLTY_ID                                          25540024
255500              , CRE_TMST                                          25550024
255600              , VER_STATUS_CDE                                    25560024
255700              , CRE_UID_ID                                        25570024
255800              , EXPTED_CART_CNT                                   25580024
255900              , EXPTED_ITM_CNT                                    25590024
256000              , ACTL_CART_CNT                                     25600024
256100              , ACTL_ITM_CNT                                      25610024
256200              , STAT_CDE                                          25620024
256300              , WORK_ORD_DISTR_IND                                25630024
256400              , OPER_SET_ID)                                      25640024
256500          VALUES                                                  25650024
256600              (:ASC-KEY-PO-NBR                                    25660024
256700              ,:ASC-KEY-RCVR-SEQ-NBR                              25670024
256800              ,:PC-LINE-NBR                                       25680024
256900              ,:PC-WRK-ORD                                        25690024
257000              ,:ASC-OPERATING-UNIT-ID                             25700024
257100              ,:ASC-FACILITY-ID                                   25710024
257200              , CURRENT TIMESTAMP                                 25720024
257300              ,:PC-A                                              25730024
257400              ,:DP020-USERID                                      25740024
257500              ,:PC-ACTUAL-CART-QTY                                25750024
257600              ,:PC-ACTUAL-ITEM-QTY                                25760024
257700              ,:PC-ACTUAL-CART-QTY                                25770024
257800              ,:PC-ACTUAL-ITEM-QTY                                25780024
257900              ,:PC-IP                                             25790024
258000              ,:PC-AC                                             25800024
258100              ,:PC-SET-ID)                                        25810024
258200     END-EXEC.                                                    25820024
258300                                                                  25830024
258400     EVALUATE TRUE                                                25840024
258500         WHEN SQLCODE = ZERO                                      25850024
258600              CONTINUE                                            25860024
258700         WHEN SQLWARN0 NOT = SPACE                                25870024
258800         WHEN SQLCODE NOT = ZERO                                  25880024
258900              MOVE '7541-REAL-INSERT-TWRKORD'                     25890024
259000                               TO DP013-PARAGRAPH                 25900024
259100              MOVE 'INSERT TWRKORD'                               25910024
259200                               TO DP013-MESSAGE-TEXT (1)          25920024
259300              MOVE SQLCA       TO DP013-SQLCA                     25930024
259400              MOVE 'TWRKORD '  TO DP013-DB2-TABLE-NAME (1)        25940024
259500              SET DP013-DB2-ABEND                                 25950024
259600                               TO TRUE                            25960024
259700              PERFORM DP013-0000-PROCESS-ABEND                    25970024
259800     END-EVALUATE.                                                25980024
259900/                                                                 25990024
260000                                                                  26000024
260100 7550-CREATE-INSTRUCTIONS-LOOP.                                   26010024
260200                                                                  26020024
260300     PERFORM 7551-OPEN-CURSOR.                                    26030024
260400                                                                  26040024
260500     MOVE +1 TO PC-INSTR-SEQ-NBR.                                 26050024
260600     PERFORM 7553-CREATE-INSTR.                                   26060024
260700     SET ASC-ITEMS-LEFT-ON-DB TO TRUE.                            26070024
260800                                                                  26080024
260900     PERFORM 7552-CLOSE-CURSOR.                                   26090024
261000                                                                  26100024
261100/                                                                 26110024
261200 7551-OPEN-CURSOR.                                                26120024
261300                                                                  26130024
261400     EXEC SQL                                                     26140024
261500          OPEN TOSOPFA_CSR                                        26150024
261600     END-EXEC                                                     26160024
261700                                                                  26170024
261800     EVALUATE TRUE                                                26180024
261900         WHEN SQLCODE = ZERO                                      26190024
262000              CONTINUE                                            26200024
262100         WHEN SQLWARN0 NOT EQUAL SPACE                            26210024
262200         WHEN SQLCODE NOT EQUAL ZERO                              26220024
262300              MOVE '7551-OPEN-CURSOR'                             26230024
262400                               TO DP013-PARAGRAPH                 26240024
262500              MOVE SQLCA       TO DP013-SQLCA                     26250024
262600              SET DP013-DB2-ABEND                                 26260024
262700                               TO TRUE                            26270024
262800              PERFORM DP013-0000-PROCESS-ABEND                    26280024
262900     END-EVALUATE.                                                26290024
263000                                                                  26300024
263100/                                                                 26310024
263200*----------------------------------------------------------------*26320024
263300* CLOSE THE TMESSAGE CURSOR.                                     *26330024
263400*----------------------------------------------------------------*26340024
263500                                                                  26350024
263600 7552-CLOSE-CURSOR.                                               26360024
263700                                                                  26370024
263800     EXEC SQL                                                     26380024
263900         CLOSE TOSOPFA_CSR                                        26390024
264000     END-EXEC                                                     26400024
264100                                                                  26410024
264200     EVALUATE TRUE                                                26420024
264300         WHEN SQLCODE = ZERO                                      26430024
264400              CONTINUE                                            26440024
264500         WHEN SQLWARN0 NOT EQUAL SPACE                            26450024
264600         WHEN SQLCODE NOT EQUAL ZERO                              26460024
264700              MOVE '7552-CLOSE-CURSOR'                            26470024
264800                               TO DP013-PARAGRAPH                 26480024
264900              MOVE SQLCA       TO DP013-SQLCA                     26490024
265000              SET DP013-DB2-ABEND                                 26500024
265100                               TO TRUE                            26510024
265200              PERFORM DP013-0000-PROCESS-ABEND                    26520024
265300     END-EVALUATE.                                                26530024
265400                                                                  26540024
265500/                                                                 26550024
265600 7553-CREATE-INSTR.                                               26560024
265700     PERFORM                                                      26570024
265800         VARYING PV-READ-COUNT                                    26580024
265900         FROM 1 BY 1                                              26590024
266000         UNTIL (ASC-NO-ITEMS-LEFT-ON-DB)                          26600024
266100                                                                  26610024
266200         PERFORM 7554-FETCH-TOSOPFA                               26620024
266300                                                                  26630024
266400         IF  ASC-ITEMS-LEFT-ON-DB                                 26640024
266500             IF  PC-INSTR-SEQ-NBR = +1                            26650024
266600                 MOVE PC-ACTUAL-CART-QTY TO PC-INSTR-ACTL-CART-QTY26660024
266700                                            PC-INSTR-EXPT-CART-QTY26670024
266800             ELSE                                                 26680024
266900                 MOVE PC-ZERO            TO PC-INSTR-ACTL-CART-QTY26690024
267000                                            PC-INSTR-EXPT-CART-QTY26700024
267100             END-IF                                               26710024
267200             PERFORM 7555-INSERT-TWKORIN                          26720024
267300             ADD +1            TO PC-INSTR-SEQ-NBR                26730024
267400         END-IF                                                   26740024
267500     END-PERFORM.                                                 26750024
267600/                                                                 26760024
267700 7554-FETCH-TOSOPFA.                                              26770024
267800     EXEC SQL                                                     26780024
267900          FETCH TOSOPFA_CSR                                       26790024
268000          INTO  :OSOPFA-OPER-SET-ID                               26800024
268100               ,:OSOPFA-OPER-ID                                   26810024
268200               ,:OSOPFA-OPER-UNT-ID                               26820024
268300               ,:OSOPFA-FCLTY-ID                                  26830024
268400               ,:OSOPFA-FCLTY-AREA-ID                             26840024
268500               ,:OSOPFA-PRC-FCLTY-AREA-ID                         26850024
268600               ,:OSOPFA-CRE-TMST                                  26860024
268700               ,:OSOPFA-VER-STATUS-CDE                            26870024
268800               ,:OSOPFA-CRE-UID-ID                                26880024
268900               ,:OSOPFA-SCRN-SEQ-NBR                              26890024
269000     END-EXEC.                                                    26900024
269100                                                                  26910024
269200                                                                  26920024
269300     EVALUATE TRUE                                                26930024
269400         WHEN SQLCODE = ZERO                                      26940024
269500         WHEN SQLCODE = +100                                      26950024
269600              CONTINUE                                            26960024
269700         WHEN SQLWARN0 NOT EQUAL SPACE                            26970024
269800         WHEN SQLCODE NOT EQUAL ZERO                              26980024
269900              MOVE '7554-FETCH-TOSOPFA'                           26990024
270000                               TO DP013-PARAGRAPH                 27000024
270100              MOVE 'FETCH TOSOPFA CURSOR'                         27010024
270200                               TO DP013-MESSAGE-TEXT (1)          27020024
270300              MOVE SQLCA       TO DP013-SQLCA                     27030024
270400              SET DP013-DB2-ABEND                                 27040024
270500                               TO TRUE                            27050024
270600              PERFORM DP013-0000-PROCESS-ABEND                    27060024
270700     END-EVALUATE.                                                27070024
270800                                                                  27080024
270900     IF  SQLCODE EQUAL +100                                       27090024
271000         SET ASC-NO-ITEMS-LEFT-ON-DB                              27100024
271100                                   TO TRUE                        27110024
271200     END-IF.                                                      27120024
271300                                                                  27130024
271400 7555-INSERT-TWKORIN.                                             27140024
271500                                                                  27150024
271600     EXEC SQL                                                     27160024
271700          INSERT                                                  27170024
271800          INTO  TWKORIN                                           27180024
271900              ( ORD_NBR                                           27190024
272000               ,RCVR_SEQ_NBR                                      27200024
272100               ,ORD_LNE_NBR                                       27210024
272200               ,WORK_ORD_SEQ_NBR                                  27220024
272300               ,OPER_UNT_ID                                       27230024
272400               ,FCLTY_ID                                          27240024
272500               ,WO_INSTR_SEQ_NBR                                  27250024
272600               ,CRE_TMST                                          27260024
272700               ,VER_STATUS_CDE                                    27270024
272800               ,CRE_UID_ID                                        27280024
272900               ,OPER_ID                                           27290024
273000               ,FCLTY_AREA_ID                                     27300024
273100               ,PRC_FCLTY_AREA_ID                                 27310024
273200               ,EXPTED_CART_CNT                                   27320024
273300               ,ACTL_CART_CNT                                     27330024
273400               ,ALLOC_IND                                         27340024
273500               ,REPACK_IND                                        27350024
273600               ,STRT_TMST                                         27360024
273700               ,STOP_TMST                                         27370024
273800               ,SCREEN_SEQ_NBR                                    27380024
273900               ,LNE_LOC_CDE                                       27390024
274000               ,REC_SEL_IND)                                      27400024
274100          VALUES                                                  27410024
274200              (:ASC-KEY-PO-NBR                                    27420024
274300              ,:ASC-KEY-RCVR-SEQ-NBR                              27430024
274400              ,:PC-LINE-NBR                                       27440024
274500              ,:PC-WRK-ORD                                        27450024
274600              ,:ASC-OPERATING-UNIT-ID                             27460024
274700              ,:ASC-FACILITY-ID                                   27470024
274800              ,:PC-INSTR-SEQ-NBR                                  27480024
274900              , CURRENT TIMESTAMP                                 27490024
275000              ,:PC-A                                              27500024
275100              ,:DP020-USERID                                      27510024
275200              ,:OSOPFA-OPER-ID                                    27520024
275300              ,:OSOPFA-FCLTY-AREA-ID                              27530024
275400              ,:OSOPFA-PRC-FCLTY-AREA-ID                          27540024
275500              ,:PC-INSTR-EXPT-CART-QTY                            27550024
275600              ,:PC-INSTR-ACTL-CART-QTY                            27560024
275700              ,:PC-N                                              27570024
275800              ,:PC-N                                              27580024
275900              ,:PC-STRT-TMST                                      27590024
276000              ,:PC-STOP-TMST                                      27600024
276100              ,:OSOPFA-SCRN-SEQ-NBR                               27610024
276200              ,:PC-SPACE5                                         27620024
276300              ,:PC-SPACE1)                                        27630024
276400     END-EXEC.                                                    27640024
276500                                                                  27650024
276600     EVALUATE TRUE                                                27660024
276700         WHEN SQLCODE = ZERO                                      27670024
276800              CONTINUE                                            27680024
276900         WHEN SQLWARN0 NOT = SPACE                                27690024
277000         WHEN SQLCODE NOT = ZERO                                  27700024
277100              MOVE '7555-INSERT-TWKORIN'                          27710024
277200                               TO DP013-PARAGRAPH                 27720024
277300              MOVE 'INSERT TWRKORD'                               27730024
277400                               TO DP013-MESSAGE-TEXT (1)          27740024
277500              MOVE SQLCA       TO DP013-SQLCA                     27750024
277600              MOVE 'TWKORIN '  TO DP013-DB2-TABLE-NAME (1)        27760024
277700              SET DP013-DB2-ABEND                                 27770024
277800                               TO TRUE                            27780024
277900              PERFORM DP013-0000-PROCESS-ABEND                    27790024
278000     END-EVALUATE.                                                27800024
278100/                                                                 27810024
278200*IR-102: 7600 PARAGRAPHS ADDED.                                   27820024
278300*----------------------------------------------------------------*27830024
278400*    THE STATUS MUST HAVE BEEN CM OR VE.  NOW, WE MUST UPDATE IT *27840024
278500*    TO IP BECAUSE A WORKORDER HAS BEEN INSERTED.                *27850024
278600*----------------------------------------------------------------*27860024
278700                                                                  27870024
278800 7600-UPDATE-TRECEIV.                                             27880024
278900                                                                  27890024
279000     PERFORM 7610-LINK-AUDIT-MODULE.                              27900024
279100     IF RC031-CALL-SUCCESSFUL                                     27910024
279200         PERFORM 7620-UPDATE-TRECEIV                              27920024
279300     END-IF.                                                      27930024
279400                                                                  27940024
279500/                                                                 27950024
279600*----------------------------------------------------------------*27960024
279700*    LINK TO AUDIT MODULE * RCKCS290                             *27970024
279800*----------------------------------------------------------------*27980024
279900                                                                  27990024
280000 7610-LINK-AUDIT-MODULE.                                          28000024
280100                                                                  28010024
280200     MOVE 'V'                   TO RC031-TABLE-TO-AUDIT.          28020024
280300     MOVE 'B'                   TO RC031-AUD-TYP-CDE.             28030024
280400     MOVE 'U'                   TO RC031-AUD-FUNC-CDE.            28040024
280500     MOVE ASC-KEY-OPER-UNT-ID   TO RC031-OPER-UNT-ID.             28050024
280600     MOVE ASC-KEY-FCLTY-ID      TO RC031-FCLTY-ID.                28060024
280700     MOVE ASC-KEY-PO-NBR        TO RC031-PO-NBR.                  28070024
280800     MOVE ASC-KEY-RCVR-SEQ-NBR  TO RC031-REC-SEQ-NBR.             28080024
280900                                                                  28090024
281000     EXEC CICS                                                    28100024
281100          LINK PROGRAM  (PC-AUDIT-RTN)                            28110024
281200          COMMAREA (RC031-FIELDS)                                 28120024
281300          LENGTH   (PC-AUDIT-RTN-LENGTH)                          28130024
281400     END-EXEC.                                                    28140024
281500                                                                  28150024
281600     EVALUATE TRUE                                                28160024
281700         WHEN RC031-CALL-SUCCESSFUL                               28170024
281800         WHEN RC031-TRECEIV-REC-NOT-FOUND                         28180024
281900             CONTINUE                                             28190024
282000         WHEN OTHER                                               28200024
282100             MOVE '7610-LINK-AUDIT-MODULE'                        28210024
282200                                 TO DP013-PARAGRAPH               28220024
282300             MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'                28230024
282400                                 TO DP013-MESSAGE-TEXT (1)        28240024
282500             MOVE RC031-RETURN-DESC                               28250024
282600                                 TO DP013-MESSAGE-TEXT (2)        28260024
282700             MOVE RC031-SQLCA    TO DP013-SQLCA                   28270024
282800             SET DP013-DB2-ABEND                                  28280024
282900                 DP013-XCTL-DISPLAY-RESTART                       28290024
283000                                 TO TRUE                          28300024
283100             PERFORM DP013-0000-PROCESS-ABEND                     28310024
283200     END-EVALUATE.                                                28320024
283300/                                                                 28330024
283400*----------------------------------------------------------------*28340024
283500*    CHANGE THE CURRENT ROW TO NOT ACTIVE.                       *28350024
283600*----------------------------------------------------------------*28360024
283700                                                                  28370024
283800 7620-UPDATE-TRECEIV.                                             28380024
283900                                                                  28390024
284000     EXEC SQL                                                     28400024
284100          UPDATE                                                  28410024
284200                TRECEIV                                           28420024
284300          SET   STATUS_CDE         =  :PC-IP                      28430024
284400               ,VER_STATUS_CDE     =  :PC-A                       28440024
284500               ,UPD_TMST           =  CURRENT TIMESTAMP           28450024
284600               ,UPD_UID            =  :DP020-USERID               28460024
284700               ,UPD_PGM_ID         =  :PC-CURRENT-PROGRAM-NAME    28470024
284800          WHERE                                                   28480024
284900                ORD_NBR            =  :ASC-KEY-PO-NBR             28490024
285000          AND   REC_SEQ_NBR        =  :ASC-KEY-RCVR-SEQ-NBR       28500024
285100          AND   OPER_UNT_ID        =  :ASC-KEY-OPER-UNT-ID        28510024
285200          AND   FCLTY_ID           =  :ASC-KEY-FCLTY-ID           28520024
285300          AND   VER_STATUS_CDE     =  :PC-A                       28530024
285400     END-EXEC.                                                    28540024
285500                                                                  28550024
285600     EVALUATE TRUE                                                28560024
285700         WHEN SQLCODE = ZERO                                      28570024
285800         WHEN SQLCODE = +100                                      28580024
285900              CONTINUE                                            28590024
286000         WHEN SQLWARN0 NOT = SPACE                                28600024
286100         WHEN SQLCODE NOT = ZERO                                  28610024
286200              MOVE '7620-UPDATE-TRECEIV'                          28620024
286300                               TO DP013-PARAGRAPH                 28630024
286400              MOVE 'UPDATE TRECEIV STATUS CODE'                   28640024
286500                               TO DP013-MESSAGE-TEXT (1)          28650024
286600              MOVE SQLCA       TO DP013-SQLCA                     28660024
286700              MOVE 'TRECEIV '  TO DP013-DB2-TABLE-NAME (1)        28670024
286800              SET DP013-DB2-ABEND                                 28680024
286900                               TO TRUE                            28690024
287000              PERFORM DP013-0000-PROCESS-ABEND                    28700024
287100     END-EVALUATE.                                                28710024
287200/                                                                 28720024
287300*----------------------------------------------------------------*28730024
287400*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *28740024
287500*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *28750024
287600*----------------------------------------------------------------*28760024
287700                                                                  28770024
287800 8100-WRITE-TEMP-STORAGE.                                         28780024
287900                                                                  28790024
288000     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     28800024
288100                                   TO PV-LIST-ITEM-NUMBER.        28810024
288200     COMPUTE PV-BLOCK-NUMBER =                                    28820024
288300         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    28830024
288400                                                                  28840024
288500     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             28850024
288600     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             28860024
288700         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      28870024
288800             PERFORM 8105-REWRITE-ASC-LISTQ                       28880024
288900         END-IF                                                   28890024
289000     ELSE                                                         28900024
289100         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       28910024
289200         ASC-HIGHEST-BLOCK-WRITTEN + 1                            28920024
289300         PERFORM 8110-WRITE-ASC-LISTQ                             28930024
289400         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   28940024
289500     END-IF.                                                      28950024
289600                                                                  28960024
289700     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             28970024
289800                                                                  28980024
289900******************************************************************28990024
290000** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **29000024
290100** SPECIFIC COMMAREA.                                           **29010024
290200******************************************************************29020024
290300                                                                  29030024
290400 8105-REWRITE-ASC-LISTQ.                                          29040024
290500                                                                  29050024
290600     EXEC CICS                                                    29060024
290700         WRITEQ TS                                                29070024
290800             QUEUE (ASC-LIST-QUEUE-NAME)                          29080024
290900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29090024
291000             ITEM  (PV-BLOCK-NUMBER)                              29100024
291100             REWRITE                                              29110024
291200             RESP  (PV-CICS-RESP)                                 29120024
291300     END-EXEC.                                                    29130024
291400                                                                  29140024
291500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           29150024
291600         CONTINUE                                                 29160024
291700     ELSE                                                         29170024
291800         SET DP013-CICS-ABEND            TO TRUE                  29180024
291900         SET DP013-NO-ROLLBACK           TO TRUE                  29190024
292000         MOVE '8105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       29200024
292100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     29210024
292200                                         TO DP013-MESSAGE-TEXT(1) 29220024
292300         PERFORM DP013-0000-PROCESS-ABEND                         29230024
292400     END-IF.                                                      29240024
292500                                                                  29250024
292600******************************************************************29260024
292700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **29270024
292800** SPECIFIC COMMAREA.                                           **29280024
292900******************************************************************29290024
293000                                                                  29300024
293100 8110-WRITE-ASC-LISTQ.                                            29310024
293200                                                                  29320024
293300     EXEC CICS                                                    29330024
293400         WRITEQ TS                                                29340024
293500             QUEUE (ASC-LIST-QUEUE-NAME)                          29350024
293600             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               29360024
293700             ITEM  (PV-BLOCK-NUMBER)                              29370024
293800             RESP  (PV-CICS-RESP)                                 29380024
293900     END-EXEC.                                                    29390024
294000     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      29400024
294100         SET DP013-CICS-ABEND      TO TRUE                        29410024
294200         SET DP013-NO-ROLLBACK     TO TRUE                        29420024
294300         MOVE '8110-WRITE-ASC-LISTQ'                              29430024
294400                                   TO DP013-PARAGRAPH             29440024
294500         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           29450024
294600                                   TO DP013-MESSAGE-TEXT(1)       29460024
294700         PERFORM DP013-0000-PROCESS-ABEND                         29470024
294800     END-IF.                                                      29480024
294900                                                                  29490024
295000*----------------------------------------------------------------*29500024
295100*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *29510024
295200*----------------------------------------------------------------*29520024
295300                                                                  29530024
295400 8111-WRITE-LIST-QUEUE.                                           29540024
295500                                                                  29550024
295600     EXEC CICS                                                    29560024
295700         WRITEQ TS                                                29570024
295800             QUEUE (ASC-LIST-QUEUE-NAME)                          29580024
295900             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     29590024
296000             ITEM  (PV-SAVE-ITEM)                                 29600024
296100             REWRITE                                              29610024
296200             RESP  (PV-CICS-RESP)                                 29620024
296300     END-EXEC.                                                    29630024
296400                                                                  29640024
296500     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29650024
296600         CONTINUE                                                 29660024
296700     ELSE                                                         29670024
296800         SET DP013-CICS-ABEND  TO  TRUE                           29680024
296900         SET DP013-NO-ROLLBACK TO  TRUE                           29690024
297000         MOVE '8111-WRITE-LIST-QUEUE'                             29700024
297100                               TO  DP013-PARAGRAPH                29710024
297200         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  29720024
297300                               TO  DP013-MESSAGE-TEXT(1)          29730024
297400         PERFORM DP013-0000-PROCESS-ABEND                         29740024
297500     END-IF.                                                      29750024
297600/                                                                 29760024
297700*----------------------------------------------------------------*29770024
297800*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*29780024
297900*----------------------------------------------------------------*29790024
298000                                                                  29800024
298100 8112-READ-LIST-QUEUE.                                            29810024
298200                                                                  29820024
298300     EXEC CICS                                                    29830024
298400         READQ TS                                                 29840024
298500             QUEUE (ASC-LIST-QUEUE-NAME)                          29850024
298600             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     29860024
298700             ITEM  (PV-ITEM)                                      29870024
298800             RESP  (PV-CICS-RESP)                                 29880024
298900     END-EXEC.                                                    29890024
299000                                                                  29900024
299100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          29910024
299200         CONTINUE                                                 29920024
299300     ELSE                                                         29930024
299400         SET DP013-CICS-ABEND        TO TRUE                      29940024
299500         SET DP013-NO-ROLLBACK       TO TRUE                      29950024
299600         MOVE '8112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           29960024
299700         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    29970024
299800                                     TO DP013-MESSAGE-TEXT(1)     29980024
299900         PERFORM DP013-0000-PROCESS-ABEND                         29990024
300000     END-IF.                                                      30000024
300100/                                                                 30010024
300200*----------------------------------------------------------------*30020024
300300* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *30030024
300400*----------------------------------------------------------------*30040024
300500                                                                  30050024
300600 9100-READ-SEL-QUEUE.                                             30060024
300700                                                                  30070024
300800     EXEC CICS                                                    30080024
300900         READQ TS                                                 30090024
301000             QUEUE (ASC-SEL-QUEUE-NAME)                           30100024
301100             INTO  (PC016-TS-SEL-REC)                             30110024
301200             ITEM  (ASC-SEL-ITEM)                                 30120024
301300             RESP  (PV-CICS-RESP)                                 30130024
301400     END-EXEC.                                                    30140024
301500                                                                  30150024
301600     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       30160024
301700         CONTINUE                                                 30170024
301800     ELSE                                                         30180024
301900         SET DP013-LOGIC-ABEND                                    30190024
302000             DP013-NO-ROLLBACK     TO TRUE                        30200024
302100         MOVE '9100-READ-SEL-QUEUE'                               30210024
302200                                   TO DP013-PARAGRAPH             30220024
302300         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   30230024
302400                                   TO DP013-MESSAGE-TEXT (1)      30240024
302500         PERFORM DP013-0000-PROCESS-ABEND                         30250024
302600     END-IF.                                                      30260024
302700                                                                  30270024
302800*----------------------------------------------------------------*30280024
302900* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *30290024
303000*----------------------------------------------------------------*30300024
303100                                                                  30310024
303200 9200-REWRITE-LIST-QUEUE.                                         30320024
303300                                                                  30330024
303400     EXEC CICS                                                    30340024
303500          WRITEQ TS                                               30350024
303600              QUEUE  (ASC-SEL-QUEUE-NAME)                         30360024
303700              FROM   (PC016-TS-SEL-REC)                           30370024
303800              ITEM   (ASC-SEL-ITEM)                               30380024
303900              RESP   (PV-CICS-RESP)                               30390024
304000              REWRITE                                             30400024
304100     END-EXEC.                                                    30410024
304200                                                                  30420024
304300     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   30430024
304400         SET DP013-CICS-ABEND                                     30440024
304500             DP013-NO-ROLLBACK     TO TRUE                        30450024
304600         MOVE '9200-REWRITE-LIST-QUEUE'                           30460024
304700                                   TO DP013-PARAGRAPH             30470024
304800         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   30480024
304900                                   TO DP013-MESSAGE-TEXT (1)      30490024
305000         PERFORM DP013-0000-PROCESS-ABEND                         30500024
305100     END-IF.                                                      30510024
305200/                                                                 30520024
305300*----------------------------------------------------------------*30530024
305400*    DATE/TIME CALCULATIONS                                      *30540024
305500*----------------------------------------------------------------*30550024
305600                                                                  30560024
305700     COPY DPPD017.                                                30570024
305800/                                                                 30580024
305900*----------------------------------------------------------------*30590024
306000*    ABEND PROCESSOR MODULE                                      *30600024
306100*----------------------------------------------------------------*30610024
306200                                                                  30620024
306300     COPY DPPD013.                                                30630024
