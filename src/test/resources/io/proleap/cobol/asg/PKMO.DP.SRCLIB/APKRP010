000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP010.                                        00020001
000300 AUTHOR.         KRYSTEN LEARY.                                   00030001
000400 DATE-WRITTEN.   OCTOBER 2005.                                    00040001
000500                                                                  00050001
000600*************************************************************     00060000
000700*    COBOL 2 WITH SQL                                       *     00070000
000800*-----------------------------------------------------------*     00080001
000810* THIS PROGRAM EXTRACTS DATA FROM THE TPOINST, TEXTENT,     *     00081039
000820* TPURCHS, AND TINSTCD TABLES BASED ON A DATE RANGE TO      *     00082039
000830* CREATE A FILE OF SPECIAL PO INSTRUCTIONS.                 *     00083039
000900*-----------------------------------------------------------*     00090001
001300* INPUT:                                                    *     00130000
001400*  1. AP CONTROL TABLE                        (TAPCNTL)     *     00140021
001500*  2. PURCHASE ORDER TABLE                    (TPURCHS)     *     00150002
001600*  3. PLANNED SHIPMENT TABLE                  (TPLNSHP)     *     00160002
002100*  4. PO INSTRUCTIONS TABLE                   (TPOINST)     *     00210012
002200*  5. SPECIAL INSTRUCTIONS CODE TABLE         (TINSTCD)     *     00220002
002300*                                                           *     00230000
002400* OUTPUT:                                                   *     00240000
002500* 1. PO EXTRACT INFORMATION                   (APRD011)     *     00250025
002600* 2. REPORT OF PO EXTRACT INFORMATION                       *     00260001
002700*-----------------------------------------------------------*     00270001
002800* CHANGE LOG:                                               *     00280000
002900*                                                           *     00290000
003000*  10/26/2005                                               *     00300040
003100*     CHANGE MADE: INITIAL IMPLEMENTATION.                  *     00310001
003200*  MADE BY: KRYSTEN LEARY              WR/IR#: WR29456      *     00320040
003210*                                                           *     00321041
003300*  04/02/2006                                               *     00330041
003400*     CHANGE MADE: EDITED PARAGRAPH B200- TO PERFORM A      *     00340041
003410*     FETCH ON THE SPECIAL INSTRUCTION TABLE UNTIL A +100   *     00341041
003420*     SQLCODE IS FOUND.  THIS WAS DONE TO GUARANTEE THAT    *     00342041
003430*     ALL INSTRUCTIONS RELATED TO A PURCHASE ORDER ARE      *     00343041
003440*     DISPLAYED ON THE REPORT.  ALSO CREATED PARAGRAPH      *     00344041
003450*     C100- TO FORMAT AND WRITE THE INFORMATION TO THE      *     00345041
003460*     REPORT.                                               *     00346041
003500*  MADE BY: KRYSTEN LEARY              WR/IR#: P000868085   *     00350046
004800*************************************************************     00480000
004900                                                                  00490000
005000 ENVIRONMENT DIVISION.                                            00500000
005200 INPUT-OUTPUT SECTION.                                            00520000
005300                                                                  00530000
005400 FILE-CONTROL.                                                    00540000
005500                                                                  00550000
005600     SELECT AP-PO-EXTRACT-FILE         ASSIGN TO OUT01.           00560001
005700     SELECT AP-PO-REPORT-FILE          ASSIGN TO RPT01.           00570007
006100                                                                  00610000
006200 DATA DIVISION.                                                   00620000
006400 FILE SECTION.                                                    00640000
006500                                                                  00650000
006600 FD  AP-PO-EXTRACT-FILE                                           00660000
006700     RECORDING MODE IS F                                          00670001
006800     LABEL RECORDS ARE STANDARD                                   00680001
006900     BLOCK CONTAINS 0 RECORDS                                     00690001
007000     DATA RECORD IS AP-PO-EXTRACT-RECORD.                         00700001
007100 01  AP-PO-EXTRACT-RECORD            PIC X(175).                  00710007
007300                                                                  00730000
007400 FD  AP-PO-REPORT-FILE                                            00740001
007500     RECORDING MODE IS F                                          00750000
007600     LABEL RECORDS ARE STANDARD                                   00760001
007610     BLOCK CONTAINS 0 RECORDS.                                    00761001
007700 01  AP-PO-REPORT-RECORD             PIC X(200).                  00770005
007800                                                                  00780001
008000 WORKING-STORAGE SECTION.                                         00800000
008010*----------------------------------------------------------------*00801001
008020* SQLCA FORMATTED MESSAGE AREA                                   *00802001
008030*----------------------------------------------------------------*00803001
008040     COPY DPWS004.                                                00804001
008050                                                                  00805001
008060*----------------------------------------------------------------*00806001
008070* AP/PO OUTPUT FILE LAYOUT                                       *00807001
008080*----------------------------------------------------------------*00808001
008100     COPY APRD011.                                                00810007
008101                                                                  00810107
008102*----------------------------------------------------------------*00810201
008103*  COMMUNICATIONS AREA2 FOR DB2                                  *00810301
008104*----------------------------------------------------------------*00810401
008105     COPY SQLCA2.                                                 00810501
008106                                                                  00810601
008107*----------------------------------------------------------------*00810701
008108* STANDARD HEADER LAYOUT                                         *00810801
008109*----------------------------------------------------------------*00810901
008110     COPY DPWS200O.                                               00811005
008111                                                                  00811101
008112 01  PROGRAM-CONSTANTS.                                           00811201
008120     05  PC-PROGRAM-NAME           PIC X(08)  VALUE 'APKRP010'.   00812001
008130     05  PC-MAX-RETRIES            PIC 9(02)  VALUE 3.            00813001
008140                                                                  00814001
008147 01  PROGRAM-COUNTERS.                                            00814701
008148     05  PC-COUNT                  PIC 9(09)  VALUE ZEROS.        00814807
008149     05  PC-COUNT-DISPLAY          PIC ZZZZZZZZ9.                 00814907
008151                                                                  00815101
008152 01  PROGRAM-VARIABLES.                                           00815201
008153     05  PV-RPT-STRT-DTE           PIC X(10)  VALUE SPACES.       00815338
008155     05  PV-RETRY-COUNTER          PIC 9(02)  VALUE ZEROS.        00815501
008156     05  PV-HOLD-INSTR-DESC        PIC X(150) VALUE SPACES.       00815641
008163                                                                  00816301
008164 01  PROGRAM-SWITCHES.                                            00816401
008165     05  WS-PO-CSR-SW              PIC X(01)  VALUE 'N'.          00816501
008166         88  END-OF-POS                       VALUE 'Y'.          00816601
008167         88  NOT-END-OF-POS                   VALUE 'N'.          00816701
008168     05  WS-INSTRUCTION-SW         PIC X(01)  VALUE 'N'.          00816801
008169         88  END-OF-INSTRUCTIONS              VALUE 'Y'.          00816901
008170         88  NOT-END-OF-INSTRUCTIONS          VALUE 'N'.          00817001
008180                                                                  00818001
008181 01  DATE-WORK-AREA.                                              00818105
008182     05  SYSTEM-DATE               PIC 9(06)  VALUE ZERO.         00818205
008183     05  FILLER REDEFINES SYSTEM-DATE.                            00818305
008184         10  SYSTEM-YEAR           PIC 9(02).                     00818405
008185         10  SYSTEM-MONTH          PIC 9(02).                     00818505
008186         10  SYSTEM-DAY            PIC 9(02).                     00818605
008187     05  SYSTEM-TIME               PIC 9(08)  VALUE ZERO.         00818705
008188     05  FILLER REDEFINES SYSTEM-TIME.                            00818805
008189         10  SYSTEM-HOUR           PIC 9(02).                     00818905
008190         10  SYSTEM-MINUTE         PIC 9(02).                     00819005
008191         10  SYSTEM-SECOND         PIC 9(02).                     00819105
008192         10  FILLER                PIC 9(02).                     00819205
008193                                                                  00819305
008194 01  REPORT-CONTROLS.                                             00819403
008195     05  PAGE-COUNT                PIC S9(04) COMP-3 VALUE ZERO.  00819503
008196     05  LINE-COUNT                PIC S9(04) COMP-3 VALUE ZERO.  00819603
008197 01  BLANK-LINE                    PIC X(200) VALUE SPACES.       00819710
008198                                                                  00819803
008199 01  HDR-LINE-1.                                                  00819903
008200     05  FILLER                    PIC X(89)  VALUE SPACES.       00820008
008201     05  FILLER                    PIC X(23)  VALUE               00820105
008202         'PO SPECIAL INSTRUCTIONS'.                               00820203
008203     05  FILLER                    PIC X(88)  VALUE SPACES.       00820308
008204                                                                  00820403
008205 01  HDR-LINE-2.                                                  00820503
008206     05  FILLER                    PIC X(78)  VALUE SPACES.       00820608
008207     05  FILLER                    PIC X(15)  VALUE               00820705
008208         'FOR THE PERIOD '.                                       00820803
008209     05  HDR2-START-MM             PIC X(02)  VALUE SPACES.       00820904
008210     05  FILLER                    PIC X(01)  VALUE '-'.          00821004
008211     05  HDR2-START-DD             PIC X(02)  VALUE SPACES.       00821104
008212     05  FILLER                    PIC X(01)  VALUE '-'.          00821204
008213     05  HDR2-START-YYYY           PIC X(04)  VALUE SPACES.       00821304
008214     05  FILLER                    PIC X(09)  VALUE ' THROUGH '.  00821404
008215     05  HDR2-END-MM               PIC X(02)  VALUE SPACES.       00821504
008216     05  FILLER                    PIC X(01)  VALUE '-'.          00821604
008217     05  HDR2-END-DD               PIC X(02)  VALUE SPACES.       00821704
008218     05  FILLER                    PIC X(01)  VALUE '-'.          00821804
008219     05  HDR2-END-YYYY             PIC X(04)  VALUE SPACES.       00821904
008220     05  FILLER                    PIC X(78)  VALUE SPACES.       00822008
008221                                                                  00822104
008222 01  HDR-LINE-3.                                                  00822204
008223     05  FILLER                    PIC X(02)  VALUE SPACES.       00822308
008224     05  FILLER                    PIC X(06)  VALUE 'PO NBR'.     00822404
008225     05  FILLER                    PIC X(07)  VALUE SPACES.       00822508
008226     05  FILLER                    PIC X(10)  VALUE 'VENDOR NBR'. 00822604
008227     05  FILLER                    PIC X(04)  VALUE SPACES.       00822708
008228     05  FILLER                    PIC X(08)  VALUE 'DEPT NBR'.   00822804
008229     05  FILLER                    PIC X(04)  VALUE SPACES.       00822908
008230     05  FILLER                    PIC X(08)  VALUE 'PO NOTES'.   00823004
008231     05  FILLER                    PIC X(142) VALUE SPACES.       00823108
008232     05  FILLER                    PIC X(09)  VALUE SPACES.       00823208
008233                                                                  00823304
008234 01  DH-DETAIL-LINE-1.                                            00823405
008235     05  FILLER                    PIC X(02)  VALUE SPACES.       00823508
008236     05  DH-PO-NBR                 PIC X(09)  VALUE SPACES.       00823605
008237     05  FILLER                    PIC X(04)  VALUE SPACES.       00823708
008238     05  DH-VENDOR-NBR             PIC X(09)  VALUE SPACES.       00823805
008239     05  FILLER                    PIC X(08)  VALUE SPACES.       00823908
008240     05  DH-DEPT-NBR               PIC X(03)  VALUE SPACES.       00824005
008241     05  FILLER                    PIC X(06)  VALUE SPACES.       00824108
008242     05  DH-PO-NOTES               PIC X(150) VALUE SPACES.       00824208
008243     05  FILLER                    PIC X(09)  VALUE SPACES.       00824308
008244                                                                  00824405
008245 01  EOR-END-OF-REPORT.                                           00824505
008246     05  FILLER                    PIC X(88)  VALUE SPACES.       00824608
008247     05  FILLER                    PIC X(25)  VALUE               00824705
008248         '***** END OF REPORT *****'.                             00824805
008249     05  FILLER                    PIC X(87)  VALUE SPACES.       00824908
008250                                                                  00825005
008280*----------------------------------------------------------------*00828001
008300* DB2 ABEND AREA                                                 *00830001
008310*----------------------------------------------------------------*00831001
008400 01  ABEND-CODE                   PIC S9(4) COMP SYNC VALUE ZEROS.00840001
008700     88 AC-EMPTY-FILE                       VALUE +4005.          00870002
008900     88 AC-DB2-ERROR                        VALUE +4013.          00890002
009000                                                                  00900000
009010 01  ABEND-AREAS.                                                 00901001
009020     05  AA-ABEND-LIT             PIC X(40) VALUE                 00902001
009030           '*****       ABEND'.                                   00903001
009040     05  AA-PROGRAM-LIT           PIC X(40) VALUE                 00904001
009050             '*****   PROGRAM:         '.                         00905001
009060     05  AA-PARAGRAPH-LIT.                                        00906001
009070         10  FILLER               PIC X(17) VALUE                 00907001
009080             '***** PARAGRAPH: '.                                 00908001
009090         10  AA-PARAGRAPH-NAME    PIC X(35) VALUE SPACES.         00909001
009091     05  AA-MESSAGE-LINE.                                         00909101
009092         10  FILLER               PIC X(06) VALUE '*****'.        00909201
009093         10  AA-MESSAGE           PIC X(127) VALUE SPACES.        00909301
009094     05  AA-DB2-ERROR-LIT         PIC X(40) VALUE                 00909401
009095             '*****    DB2 ERROR'.                                00909501
009096     05  AA-DB2-OPERATION-LIT.                                    00909601
009097         10  FILLER               PIC X(17) VALUE                 00909701
009098             '***** OPERATION: '.                                 00909801
009099         10  AA-DB2-OPERATION.                                    00909901
009100             15  AA-DB2-OP-1      PIC X(25) VALUE SPACES.         00910001
009101             15  AA-DB2-OP-2      PIC X(25) VALUE SPACES.         00910101
009102     05  AA-DB2-TABLE1            PIC X(08) VALUE SPACES.         00910202
009103     05  AA-DB2-TABLE2            PIC X(08) VALUE SPACES.         00910302
009106                                                                  00910601
017600*--------------------------------------------------------------*  01760001
017700*  DB2 AREA FOR COMMUNICATIONS                                 *  01770002
017800*--------------------------------------------------------------*  01780001
017900     EXEC SQL                                                     01790000
018000          INCLUDE SQLCA                                           01800000
018100     END-EXEC.                                                    01810000
018200                                                                  01820001
018210*--------------------------------------------------------------*  01821021
018220*  AP CONTROL TABLE                                            *  01822021
018230*--------------------------------------------------------------*  01823021
018240     EXEC SQL                                                     01824021
018250          INCLUDE TAPCNTL                                         01825021
018260     END-EXEC.                                                    01826021
018270                                                                  01827021
018300*--------------------------------------------------------------*  01830001
018400*  PURCHASE ORDER TABLE                                        *  01840002
018500*--------------------------------------------------------------*  01850001
018600     EXEC SQL                                                     01860000
018700          INCLUDE TPURCHS                                         01870000
018800     END-EXEC.                                                    01880000
018900                                                                  01890001
019000*--------------------------------------------------------------*  01900001
019100*  PLAN SHIP TABLE                                             *  01910002
019200*--------------------------------------------------------------*  01920001
019300     EXEC SQL                                                     01930000
019400          INCLUDE TPLNSHP                                         01940000
019500     END-EXEC.                                                    01950000
019600                                                                  01960001
022500*--------------------------------------------------------------*  02250001
022600*  PURCHASE ORDER INSTRUCTIONS TABLE                           *  02260002
022700*--------------------------------------------------------------*  02270001
022800     EXEC SQL                                                     02280000
022900          INCLUDE TPOINST                                         02290000
023000     END-EXEC.                                                    02300000
023100                                                                  02310001
023200*--------------------------------------------------------------*  02320001
023300*  SPECIAL INSTRUCTIONS TABLE                                  *  02330002
023400*--------------------------------------------------------------*  02340001
023500     EXEC SQL                                                     02350000
023600          INCLUDE TINSTCD                                         02360000
023700     END-EXEC.                                                    02370000
023800                                                                  02380001
023810*--------------------------------------------------------------*  02381002
023820*  VENDOR TABLE                                                *  02382002
023830*--------------------------------------------------------------*  02383002
023840     EXEC SQL                                                     02384002
023850          INCLUDE TEXTENT                                         02385002
023860     END-EXEC.                                                    02386002
023870                                                                  02387002
023900*--------------------------------------------------------------*  02390001
024000* PURCHASE ORDER CURSOR                                        *  02400002
024100*--------------------------------------------------------------*  02410001
024200     EXEC SQL                                                     02420000
024300         DECLARE PO_CSR CURSOR FOR                                02430000
024400          SELECT A.PO_NBR                                         02440002
025700               , A.DEPT_NBR                                       02570002
025900               , A.ENT_ID                                         02590002
027400            FROM TPURCHS A                                        02740002
027500               , TPLNSHP B                                        02750002
027600           WHERE A.VER_STATUS_CDE = 'A'                           02760002
027700             AND A.PO_CATEG_CDE = 'MR'                            02770002
027800             AND A.PO_NBR = B.PO_NBR                              02780002
027900             AND A.VER_STATUS_CDE = B.VER_STATUS_CDE              02790002
027910             AND B.DONT_SHIP_BEF_DTE > :APCNTL-PREV-WK-END-DTE    02791044
027920             AND B.DONT_SHIP_BEF_DTE <= :APCNTL-CURR-WK-END-DTE   02792044
028200         END-EXEC.                                                02820000
028300                                                                  02830001
028400*---------------------------------------------------------------* 02840000
028500* DECLARE SPECIAL INSTRUCTION CURSOR                            * 02850000
028600*---------------------------------------------------------------* 02860000
028700     EXEC SQL                                                     02870000
028800        DECLARE INSTRUC_CSR CURSOR FOR                            02880001
028900          SELECT B.INSTR_DESC                                     02890006
029200            FROM TPOINST A                                        02920002
029300               , TINSTCD B                                        02930002
029400          WHERE A.PO_NBR = :PURCHS-PO-NBR                         02940002
029500            AND A.RECIP_CDE IN ('AP', 'VN')                       02950002
029600            AND A.INSTR_NBR = B.INSTR_NBR                         02960002
029800         END-EXEC.                                                02980000
029900                                                                  02990000
031400*-----------------------*                                         03140001
031700 PROCEDURE DIVISION.                                              03170008
031800*-----------------------*                                         03180001
031900                                                                  03190000
032000     PERFORM B100-INITIALIZATION.                                 03200001
032200     PERFORM B200-PROCESS-EXTRACT-FILE                            03220010
032300         UNTIL END-OF-POS.                                        03230002
032410     PERFORM W400-WRITE-END-OF-REPORT.                            03241008
032500     PERFORM B300-END-OF-JOB.                                     03250002
032700     GOBACK.                                                      03270000
032900                                                                  03290001
033000*--------------------------------------------------------------*  03300001
033100* INITIALIZATION PROCESSING                                    *  03310001
033200*--------------------------------------------------------------*  03320001
033300 B100-INITIALIZATION.                                             03330001
033500                                                                  03350000
033600     ACCEPT SYSTEM-DATE FROM DATE.                                03360005
033700     MOVE SYSTEM-YEAR                    TO DP200O-RUN-YEAR.      03370005
033710     MOVE SYSTEM-MONTH                   TO DP200O-RUN-MONTH.     03371005
033720     MOVE SYSTEM-DAY                     TO DP200O-RUN-DAY.       03372005
033730     ACCEPT SYSTEM-TIME FROM TIME.                                03373005
033740     MOVE SYSTEM-HOUR                    TO DP200O-RUN-HOUR.      03374005
033750     MOVE SYSTEM-MINUTE                  TO DP200O-RUN-MINUTE.    03375005
033760     MOVE PC-PROGRAM-NAME                TO DP200O-PROGRAM-NAME.  03376010
033770     MOVE 1                              TO DP200O-REPORT-NUMBER. 03377005
033780     DISPLAY 'RUN DATE = ' SYSTEM-DATE.                           03378005
033790     DISPLAY 'RUN TIME = ' SYSTEM-TIME.                           03379005
033791                                                                  03379105
033810     OPEN OUTPUT AP-PO-EXTRACT-FILE                               03381021
033820                 AP-PO-REPORT-FILE.                               03382009
033900                                                                  03390000
034000     INITIALIZE DCLTPURCHS                                        03400000
034100                DCLTPLNSHP                                        03410000
034600                DCLTPOINST                                        03460000
034700                DCLTINSTCD                                        03470000
034710                DCLTEXTENT                                        03471021
034720                DCLTAPCNTL.                                       03472021
035380                                                                  03538005
035390     PERFORM S050-GET-RUN-DATES.                                  03539033
035420     MOVE PV-RPT-STRT-DTE(1:4)               TO HDR2-START-YYYY.  03542038
035430     MOVE PV-RPT-STRT-DTE(6:2)               TO HDR2-START-MM.    03543038
035440     MOVE PV-RPT-STRT-DTE(9:2)               TO HDR2-START-DD.    03544038
035450     MOVE APCNTL-CURR-WK-END-DTE(1:4)        TO HDR2-END-YYYY.    03545038
035460     MOVE APCNTL-CURR-WK-END-DTE(6:2)        TO HDR2-END-MM.      03546038
035470     MOVE APCNTL-CURR-WK-END-DTE(9:2)        TO HDR2-END-DD.      03547038
035480     PERFORM W200-WRITE-REPORT-HEADERS.                           03548017
035490                                                                  03549017
039700     PERFORM Y100-OPEN-PO-CURSOR.                                 03970002
039900     PERFORM S100-FETCH-PO-CURSOR.                                03990002
040100     IF END-OF-POS                                                04010002
040300        DISPLAY '** NO PURCHASE ORDERS MET DATA CRITERIA **'      04030002
040600     END-IF.                                                      04060000
040610                                                                  04061002
040700*--------------------------------------------------------------*  04070002
040710* PROCESS PURCHASE ORDERS                                      *  04071041
040720*--------------------------------------------------------------*  04072002
040800 B200-PROCESS-EXTRACT-FILE.                                       04080002
040900                                                                  04090002
046900     PERFORM S300-FETCH-DUNS-NBR.                                 04690002
052800     PERFORM Y200-OPEN-INSTRUC-CURSOR.                            05280041
052801     PERFORM S200-FETCH-INSTRUC-CURSOR                            05280141
052810       UNTIL END-OF-INSTRUCTIONS.                                 05281042
052820     PERFORM Y400-CLOSE-INSTRUC-CURSOR.                           05282041
052830     SET NOT-END-OF-INSTRUCTIONS       TO TRUE.                   05283041
052900     PERFORM S100-FETCH-PO-CURSOR.                                05290041
053000                                                                  05300016
057300*--------------------------------------------------------------*  05730002
057310* END OF JOB PROCESSING                                        *  05731002
057320*--------------------------------------------------------------*  05732002
057400 B300-END-OF-JOB.                                                 05740002
057900                                                                  05790000
058000     PERFORM Y300-CLOSE-PO-CURSOR.                                05800010
058100                                                                  05810000
058310     CLOSE AP-PO-EXTRACT-FILE                                     05831022
058320           AP-PO-REPORT-FILE.                                     05832009
058400                                                                  05840000
058500     MOVE PC-COUNT TO PC-COUNT-DISPLAY.                           05850007
058600     DISPLAY '*****************************************'.         05860000
058700     DISPLAY 'TOTAL POS EXTRACTED = ' PC-COUNT-DISPLAY.           05870007
058800     DISPLAY '*****************************************'.         05880000
058900                                                                  05890002
058910*--------------------------------------------------------------*  05891041
058920* FORMAT AND WRITE PURCHASE ORDERS TO REPORT/OUTPUT FILE       *  05892041
058930*--------------------------------------------------------------*  05893041
058940 C100-FORMAT-AND-WRITE-POS.                                       05894041
058950                                                                  05895041
058951     IF PV-HOLD-INSTR-DESC NOT EQUAL SPACES                       05895141
058953        MOVE PURCHS-PO-NBR             TO AP011-PO-NBR            05895341
058954                                          DH-PO-NBR               05895441
058955        MOVE PURCHS-DEPT-NBR           TO AP011-DEPT-NBR          05895541
058956                                          DH-DEPT-NBR             05895641
058957        MOVE EXTENT-DUN-NBR            TO AP011-DUN-NBR           05895741
058958                                          DH-VENDOR-NBR           05895841
058959        MOVE INSTCD-INSTR-DESC         TO AP011-SPECIAL-INSTR     05895941
058960                                          DH-PO-NOTES             05896041
058961        PERFORM W100-WRITE-PO-EXTRACT                             05896141
058962        PERFORM W300-WRITE-REPORT-DETAIL                          05896241
058963        INITIALIZE PV-HOLD-INSTR-DESC                             05896341
058964     END-IF.                                                      05896441
058966                                                                  05896641
058967*--------------------------------------------------------------*  05896720
058968* DETERMINE THE STARTING AND ENDING DATE RANGE FOR EXTRACT     *  05896820
058969*--------------------------------------------------------------*  05896920
058970 S050-GET-RUN-DATES.                                              05897033
058971                                                                  05897133
058972     PERFORM WITH TEST AFTER                                      05897233
058973        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      05897333
058974          UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                 05897433
058975             OR SQLCODE = ZERO                                    05897533
058976             OR SQLCODE = +100                                    05897633
058977                                                                  05897733
058978        EXEC SQL                                                  05897833
058979           SELECT PREV_WK_END_DTE                                 05897934
058980                , CURR_WK_END_DTE                                 05898033
058981                , (PREV_WK_END_DTE + 1 DAY)                       05898138
058982             INTO :APCNTL-PREV-WK-END-DTE                         05898236
058983                , :APCNTL-CURR-WK-END-DTE                         05898336
058984                , :PV-RPT-STRT-DTE                                05898438
058985             FROM TAPCNTL                                         05898533
058986        END-EXEC                                                  05898633
058987                                                                  05898733
058988        EVALUATE TRUE                                             05898833
058989           WHEN SQLCODE = ZERO                                    05898933
058990           WHEN SQLCODE = -904                                    05899033
058991           WHEN SQLCODE = -912                                    05899133
058992             CONTINUE                                             05899233
058993           WHEN SQLWARN0 NOT = SPACES                             05899333
058994           WHEN SQLCODE NOT = ZERO                                05899433
058995             MOVE 'S050-GET-RUN-DATES'   TO AA-PARAGRAPH-NAME     05899533
058996             MOVE 'UNSUCCESSFUL SELECT TAPCNTL'                   05899633
058997                                         TO AA-DB2-OPERATION      05899733
058998             MOVE 'TAPCNTL'              TO AA-DB2-TABLE1         05899833
058999             MOVE SPACES                 TO AA-DB2-TABLE2         05899933
059000             PERFORM Z999-DB2-ABEND                               05900033
059001        END-EVALUATE                                              05900133
059002     END-PERFORM.                                                 05900233
059003                                                                  05900333
059004     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         05900433
059005        MOVE 'S050-GET-RUN-DATES'        TO AA-PARAGRAPH-NAME     05900533
059006        MOVE 'MAX RETRIES EXCEEDED ON SELECT TAPCNTL'             05900633
059007                                         TO AA-DB2-OPERATION      05900733
059008        MOVE 'TAPCNTL'                   TO AA-DB2-TABLE1         05900833
059009        MOVE SPACES                      TO AA-DB2-TABLE2         05900933
059010        PERFORM Z999-DB2-ABEND                                    05901033
059011     END-IF.                                                      05901133
059012                                                                  05901233
059013*--------------------------------------------------------------*  05901302
059014* FETCH PO_CSR CURSOR                                          *  05901402
059015*--------------------------------------------------------------*  05901502
059020 S100-FETCH-PO-CURSOR.                                            05902002
059100                                                                  05910000
059200     PERFORM WITH TEST AFTER                                      05920000
059300        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      05930010
059400          UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                 05940010
059500             OR SQLCODE = ZERO                                    05950000
059600             OR SQLCODE = +100                                    05960000
059610                                                                  05961002
059700        EXEC SQL                                                  05970000
059800            FETCH PO_CSR                                          05980000
059900             INTO :PURCHS-PO-NBR                                  05990002
061200                , :PURCHS-DEPT-NBR                                06120002
061300                , :PURCHS-ENT-ID                                  06130002
062900        END-EXEC                                                  06290000
063000                                                                  06300000
063100        EVALUATE TRUE                                             06310000
063200          WHEN SQLCODE = ZERO                                     06320002
063300            CONTINUE                                              06330002
063400          WHEN SQLCODE = +100                                     06340002
063500            SET END-OF-POS                TO TRUE                 06350007
063600          WHEN SQLCODE = -904                                     06360002
063700          WHEN SQLCODE = -913                                     06370002
063800            CONTINUE                                              06380002
063900          WHEN SQLWARN0 NOT = SPACES                              06390002
064000          WHEN SQLCODE  NOT = ZERO                                06400002
064100            MOVE 'S100-FETCH-PO-CURSOR'   TO AA-PARAGRAPH-NAME    06410002
064300            MOVE 'UNSUCCESSFUL FETCH TPURCHS' TO AA-DB2-OPERATION 06430002
064500            MOVE 'TPURCHS'                TO AA-DB2-TABLE1        06450002
064600            MOVE 'TPLNSHP'                TO AA-DB2-TABLE2        06460002
064700            PERFORM Z999-DB2-ABEND                                06470010
064800        END-EVALUATE                                              06480002
064900     END-PERFORM.                                                 06490000
065000                                                                  06500000
065100     IF PV-RETRY-COUNTER > 3                                      06510010
065200        MOVE 'S100-FETCH-PO-CURSOR'      TO AA-PARAGRAPH-NAME     06520002
065400        MOVE 'MAX RETRIES EXCEEDED ON FETCH TPURCHS'              06540002
065500                                         TO AA-DB2-OPERATION      06550002
065600        MOVE 'TPURCHS'                   TO AA-DB2-TABLE1         06560002
065700        MOVE 'TPLNSHP'                   TO AA-DB2-TABLE2         06570002
065800        PERFORM Z999-DB2-ABEND                                    06580010
065900     END-IF.                                                      06590000
065901                                                                  06590102
065910*--------------------------------------------------------------*  06591002
065911* FETCH INSTRUC_CSR CURSOR                                     *  06591102
065912*--------------------------------------------------------------*  06591202
065920 S200-FETCH-INSTRUC-CURSOR.                                       06592002
065930                                                                  06593002
065940     PERFORM WITH TEST AFTER                                      06594002
065950        VARYING PV-RETRY-COUNTER FROM 1 BY 1                      06595010
065960          UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                 06596010
065970             OR SQLCODE = ZERO                                    06597002
065980             OR SQLCODE = +100                                    06598002
065981                                                                  06598102
065990        EXEC SQL                                                  06599002
065991            FETCH INSTRUC_CSR                                     06599102
065992             INTO :INSTCD-INSTR-DESC                              06599202
065995        END-EXEC                                                  06599502
065996                                                                  06599602
065997        EVALUATE TRUE                                             06599702
065998          WHEN SQLCODE = ZERO                                     06599802
065999            MOVE INSTCD-INSTR-DESC           TO PV-HOLD-INSTR-DESC06599941
066000            PERFORM C100-FORMAT-AND-WRITE-POS                     06600041
066001          WHEN SQLCODE = +100                                     06600102
066002            SET END-OF-INSTRUCTIONS          TO TRUE              06600241
066003          WHEN SQLCODE = -904                                     06600302
066004          WHEN SQLCODE = -913                                     06600402
066005            CONTINUE                                              06600502
066006          WHEN SQLWARN0 NOT = SPACES                              06600602
066007          WHEN SQLCODE  NOT = ZERO                                06600702
066008            MOVE 'S200-FETCH-INSTRUC-CURSOR' TO AA-PARAGRAPH-NAME 06600802
066009            MOVE 'UNSUCCESSFUL FETCH TPOINST' TO AA-DB2-OPERATION 06600902
066010            MOVE 'TPOINST'                   TO AA-DB2-TABLE1     06601002
066011            MOVE 'TINSTCD'                   TO AA-DB2-TABLE2     06601102
066012            PERFORM Z999-DB2-ABEND                                06601210
066013        END-EVALUATE                                              06601302
066014     END-PERFORM.                                                 06601402
066015                                                                  06601502
066016     IF PV-RETRY-COUNTER > 3                                      06601610
066017        MOVE 'S200-FETCH-INSTRUC-CURSOR'  TO AA-PARAGRAPH-NAME    06601702
066019        MOVE 'MAX RETRIES EXCEEDED ON FETCH TPOINST'              06601902
066020                                          TO AA-DB2-OPERATION     06602002
066021        MOVE 'TPOINST'                    TO AA-DB2-TABLE1        06602102
066022        MOVE 'TINSTCD'                    TO AA-DB2-TABLE2        06602202
066023        PERFORM Z999-DB2-ABEND                                    06602310
066024     END-IF.                                                      06602402
066025                                                                  06602502
066026*--------------------------------------------------------------*  06602602
066027* FETCH VENDOR NUMBER                                          *  06602702
066028*--------------------------------------------------------------*  06602802
066029 S300-FETCH-DUNS-NBR.                                             06602902
066030                                                                  06603002
066031     PERFORM WITH TEST AFTER                                      06603102
066032         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     06603210
066033           UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                06603310
066034              OR SQLCODE = ZERO                                   06603402
066035                                                                  06603502
066036         EXEC SQL                                                 06603602
066037             SELECT DUN_NBR                                       06603702
066038               INTO :EXTENT-DUN-NBR                               06603802
066039               FROM TEXTENT                                       06603902
066040              WHERE ENT_ID = :PURCHS-ENT-ID                       06604002
066041         END-EXEC                                                 06604102
066042                                                                  06604202
066043         EVALUATE TRUE                                            06604302
066044            WHEN SQLCODE = ZERO                                   06604402
066045            WHEN SQLCODE = -904                                   06604502
066046            WHEN SQLCODE = -913                                   06604602
066047              CONTINUE                                            06604702
066048            WHEN OTHER                                            06604802
066049              MOVE 'S300-FETCH-DUNS-NBR'  TO AA-PARAGRAPH-NAME    06604902
066050              MOVE 'DUNS NBR NOT FOUND ON TEXTENT TABLE'          06605002
066051                                          TO AA-DB2-OPERATION     06605102
066052              MOVE 'TEXTENT'              TO AA-DB2-TABLE1        06605202
066053              MOVE SPACES                 TO AA-DB2-TABLE2        06605302
066054              PERFORM Z999-DB2-ABEND                              06605410
066055         END-EVALUATE                                             06605502
066056     END-PERFORM.                                                 06605602
066057                                                                  06605702
066058     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         06605810
066059        MOVE 'S300-FETCH-DUNS-NBR'  TO AA-PARAGRAPH-NAME          06605902
066060        MOVE 'MAX RETRIES EXCEEDED ON TEXTENT SELECT'             06606002
066061                                    TO AA-DB2-OPERATION           06606102
066062        MOVE 'TEXTENT'              TO AA-DB2-TABLE1              06606202
066063        MOVE SPACES                 TO AA-DB2-TABLE2              06606302
066064        PERFORM Z999-DB2-ABEND                                    06606410
066065     END-IF.                                                      06606502
066066                                                                  06606602
066067*--------------------------------------------------------------*  06606702
066068* WRITE EXTRACT OUTPUT FILE                                    *  06606802
066069*--------------------------------------------------------------*  06606902
066070 W100-WRITE-PO-EXTRACT.                                           06607003
066071                                                                  06607102
066072     WRITE AP-PO-EXTRACT-RECORD FROM AP011-PO-EXTRACT-RECORD.     06607207
066073     ADD 1                      TO PC-COUNT.                      06607307
066074     INITIALIZE AP011-PO-EXTRACT-RECORD.                          06607441
066075                                                                  06607502
066076*--------------------------------------------------------------*  06607605
066077* WRITE REPORT HEADINGS                                        *  06607705
066078*--------------------------------------------------------------*  06607805
066079 W200-WRITE-REPORT-HEADERS.                                       06607905
066080                                                                  06608005
066081     INITIALIZE LINE-COUNT.                                       06608105
066082     ADD 1                     TO PAGE-COUNT.                     06608205
066083     MOVE PAGE-COUNT           TO DP200O-PAGE-NUMBER.             06608305
066084     WRITE AP-PO-REPORT-RECORD                                    06608405
066085           FROM DP200O-STANDRD-HEADER-200-COLS AFTER PAGE.        06608509
066086                                                                  06608605
066087     WRITE AP-PO-REPORT-RECORD FROM HDR-LINE-1 AFTER 1.           06608705
066088     WRITE AP-PO-REPORT-RECORD FROM HDR-LINE-2 AFTER 1.           06608805
066089     WRITE AP-PO-REPORT-RECORD FROM BLANK-LINE AFTER 1.           06608905
066090     WRITE AP-PO-REPORT-RECORD FROM HDR-LINE-3 AFTER 1.           06609005
066091     ADD 5                     TO LINE-COUNT.                     06609105
066092                                                                  06609205
066093*--------------------------------------------------------------*  06609305
066094* WRITE REPORT DETAILS                                         *  06609405
066095*--------------------------------------------------------------*  06609505
066096 W300-WRITE-REPORT-DETAIL.                                        06609605
066097                                                                  06609705
066098     IF LINE-COUNT > 59                                           06609805
066099        PERFORM W200-WRITE-REPORT-HEADERS                         06609905
066100     END-IF.                                                      06610005
066101                                                                  06610105
066102     WRITE AP-PO-REPORT-RECORD FROM DH-DETAIL-LINE-1 AFTER 1.     06610205
066103     ADD 1                     TO LINE-COUNT.                     06610305
066104     INITIALIZE DH-DETAIL-LINE-1.                                 06610419
066105                                                                  06610505
066106*--------------------------------------------------------------*  06610605
066107* WRITE END OF REPORT LINE                                     *  06610705
066108*--------------------------------------------------------------*  06610805
066109 W400-WRITE-END-OF-REPORT.                                        06610905
066110                                                                  06611005
066111     WRITE AP-PO-REPORT-RECORD FROM EOR-END-OF-REPORT AFTER 1.    06611109
066112                                                                  06611205
066113*--------------------------------------------------------------*  06611302
066114* OPEN PO_CSR CURSOR                                           *  06611402
066115*--------------------------------------------------------------*  06611502
066120 Y100-OPEN-PO-CURSOR.                                             06612002
066200                                                                  06620000
066300     PERFORM WITH TEST AFTER                                      06630000
066400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     06640010
066500           UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                06650010
066600              OR SQLCODE = ZERO                                   06660002
066700              OR SQLCODE = +100                                   06670002
066800                                                                  06680000
066900         EXEC SQL                                                 06690000
067000            OPEN PO_CSR                                           06700000
067100         END-EXEC                                                 06710000
067200                                                                  06720000
067300         EVALUATE TRUE                                            06730000
067400           WHEN SQLCODE = ZERO                                    06740002
067500           WHEN SQLCODE = +100                                    06750002
067600           WHEN SQLCODE = -904                                    06760002
067700           WHEN SQLCODE = -913                                    06770002
067800             CONTINUE                                             06780002
068000           WHEN SQLWARN0 NOT = SPACES                             06800002
068100           WHEN SQLCODE  NOT = ZERO                               06810002
068200             MOVE 'Y100-OPEN-PO-CURSOR' TO AA-PARAGRAPH-NAME      06820002
068400             MOVE 'UNSUCCESSFUL OPEN TPURCHS'                     06840002
068500                                        TO AA-DB2-OPERATION       06850002
068600             MOVE 'TPURCHS'             TO AA-DB2-TABLE1          06860002
068700             MOVE 'TPLNSHP'             TO AA-DB2-TABLE2          06870002
068800             PERFORM Z999-DB2-ABEND                               06880010
068900         END-EVALUATE                                             06890000
069000     END-PERFORM.                                                 06900000
069100                                                                  06910000
069200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         06920010
069300        MOVE 'Y100-OPEN-PO-CURSOR'  TO AA-PARAGRAPH-NAME          06930002
069500        MOVE 'MAX RETRIES EXCEEDED ON OPEN TPURCHS'               06950002
069600                                    TO AA-DB2-OPERATION           06960002
069700        MOVE 'TPURCHS'              TO AA-DB2-TABLE1              06970002
069800        MOVE 'TPLNSHP'              TO AA-DB2-TABLE2              06980002
069900        PERFORM Z999-DB2-ABEND                                    06990010
070000     END-IF.                                                      07000002
070100                                                                  07010002
070101*--------------------------------------------------------------*  07010102
070102* OPEN INSTRUC_CSR CURSOR                                      *  07010202
070103*--------------------------------------------------------------*  07010302
070104 Y200-OPEN-INSTRUC-CURSOR.                                        07010402
070105                                                                  07010502
070106     PERFORM WITH TEST AFTER                                      07010602
070107         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07010710
070108           UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                07010810
070109              OR SQLCODE = ZERO                                   07010902
070110              OR SQLCODE = +100                                   07011002
070111                                                                  07011102
070112         EXEC SQL                                                 07011202
070113            OPEN INSTRUC_CSR                                      07011302
070114         END-EXEC                                                 07011402
070115                                                                  07011502
070116         EVALUATE TRUE                                            07011602
070117           WHEN SQLCODE = ZERO                                    07011702
070118           WHEN SQLCODE = +100                                    07011802
070119           WHEN SQLCODE = -904                                    07011902
070120           WHEN SQLCODE = -913                                    07012002
070121             CONTINUE                                             07012102
070122           WHEN SQLWARN0 NOT = SPACES                             07012202
070123           WHEN SQLCODE  NOT = ZERO                               07012302
070124             MOVE 'Y200-OPEN-INSTRUC-CURSOR' TO AA-PARAGRAPH-NAME 07012402
070125             MOVE 'UNSUCCESSFUL OPEN TPOINST' TO AA-DB2-OPERATION 07012502
070126             MOVE 'TPOINST'                  TO AA-DB2-TABLE1     07012602
070127             MOVE 'TINSTCD'                  TO AA-DB2-TABLE2     07012702
070128             PERFORM Z999-DB2-ABEND                               07012810
070129         END-EVALUATE                                             07012902
070130     END-PERFORM.                                                 07013002
070131                                                                  07013102
070132     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         07013210
070133        MOVE 'Y200-OPEN-INSTRUC-CURSOR'  TO AA-PARAGRAPH-NAME     07013302
070134        MOVE 'MAX RETRIES EXCEEDED ON OPEN TPOINST'               07013402
070135                                         TO AA-DB2-OPERATION      07013502
070136        MOVE 'TPOINST'                   TO AA-DB2-TABLE1         07013602
070137        MOVE 'TINSTCD'                   TO AA-DB2-TABLE2         07013702
070138        PERFORM Z999-DB2-ABEND                                    07013810
070139     END-IF.                                                      07013902
070140                                                                  07014002
070141*--------------------------------------------------------------*  07014102
070142* CLOSE PO_CSR CURSOR                                          *  07014202
070150*--------------------------------------------------------------*  07015002
070200 Y300-CLOSE-PO-CURSOR.                                            07020002
070300                                                                  07030000
070400     PERFORM WITH TEST AFTER                                      07040000
070500         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     07050010
070600           UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                07060010
070700              OR SQLCODE = ZERO                                   07070000
070800              OR SQLCODE = +100                                   07080000
070900                                                                  07090000
071000         EXEC SQL                                                 07100000
071100            CLOSE PO_CSR                                          07110000
071200         END-EXEC                                                 07120000
071300                                                                  07130000
071400         EVALUATE TRUE                                            07140000
071500           WHEN SQLCODE = ZERO                                    07150002
071600           WHEN SQLCODE = +100                                    07160002
071700           WHEN SQLCODE = -904                                    07170002
071800           WHEN SQLCODE = -913                                    07180002
071900             CONTINUE                                             07190002
072000           WHEN SQLWARN0 NOT = SPACES                             07200002
072100           WHEN SQLCODE  NOT = ZERO                               07210002
072200             MOVE 'Y300-CLOSE-PO-CURSOR'  TO AA-PARAGRAPH-NAME    07220002
072400             MOVE 'UNSUCCESSFUL CLOSE TPURCHS'                    07240002
072500                                          TO AA-DB2-OPERATION     07250002
072600             MOVE 'TPURCHS'               TO AA-DB2-TABLE1        07260002
072700             MOVE 'TPLNSHP'               TO AA-DB2-TABLE2        07270002
072800             PERFORM Z999-DB2-ABEND                               07280010
072900         END-EVALUATE                                             07290000
073000     END-PERFORM.                                                 07300000
073100                                                                  07310000
073200     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         07320010
073300        MOVE 'Y300-CLOSE-PO-CURSOR'    TO AA-PARAGRAPH-NAME       07330002
073500        MOVE 'MAX RETRIES EXCEEDED ON CLOSE TPURCHS'              07350002
073600                                       TO AA-DB2-OPERATION        07360002
073700        MOVE 'TPURCHS'                 TO AA-DB2-TABLE1           07370002
073800        MOVE 'TPLNSHP'                 TO AA-DB2-TABLE2           07380002
073900        PERFORM Z999-DB2-ABEND                                    07390010
073910     END-IF.                                                      07391002
073911                                                                  07391102
073920*--------------------------------------------------------------*  07392002
073930* CLOSE INSTRUC_CSR CURSOR                                     *  07393002
073940*--------------------------------------------------------------*  07394002
111100 Y400-CLOSE-INSTRUC-CURSOR.                                       11110002
111200                                                                  11120000
111300     PERFORM WITH TEST AFTER                                      11130000
111400         VARYING PV-RETRY-COUNTER FROM 1 BY 1                     11140010
111500           UNTIL PV-RETRY-COUNTER > PC-MAX-RETRIES                11150010
111600              OR SQLCODE = ZERO                                   11160000
111700              OR SQLCODE = +100                                   11170000
111800                                                                  11180000
111900         EXEC SQL                                                 11190000
112000            CLOSE INSTRUC_CSR                                     11200000
112100         END-EXEC                                                 11210000
112200                                                                  11220000
112300         EVALUATE TRUE                                            11230000
112400           WHEN SQLCODE = ZERO                                    11240002
112500           WHEN SQLCODE = +100                                    11250002
112600           WHEN SQLCODE = -904                                    11260002
112700           WHEN SQLCODE = -913                                    11270002
112800             CONTINUE                                             11280002
112900           WHEN SQLWARN0 NOT = SPACES                             11290002
113000           WHEN SQLCODE  NOT = ZERO                               11300002
113100             MOVE 'Y400-CLOSE-INSTRUC-CURSOR' TO AA-PARAGRAPH-NAME11310002
113300             MOVE 'UNSUCCESSFUL CLOSE TPOINST' TO AA-DB2-OPERATION11330002
113500             MOVE 'TPOINST'                   TO AA-DB2-TABLE1    11350002
113600             MOVE 'TINSTCD'                   TO AA-DB2-TABLE2    11360002
113700             PERFORM Z999-DB2-ABEND                               11370010
113800         END-EVALUATE                                             11380000
113900     END-PERFORM.                                                 11390000
114000                                                                  11400000
114100     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         11410010
114200        MOVE 'Y400-CLOSE-INSTRUC-CURSOR'  TO AA-PARAGRAPH-NAME    11420002
114400        MOVE 'MAX RETRIES EXCEEDED ON CLOSE TPOINST'              11440002
114500                                          TO AA-DB2-OPERATION     11450002
114600        MOVE 'TPOINST'                    TO AA-DB2-TABLE1        11460002
114700        MOVE 'TINSTCD'                    TO AA-DB2-TABLE2        11470002
114800        PERFORM Z999-DB2-ABEND                                    11480010
114810     END-IF.                                                      11481002
114900                                                                  11490002
133710*--------------------------------------------------------------*  13371002
133720* PROCESS DB2 ABENDS                                           *  13372002
133730*--------------------------------------------------------------*  13373002
133800 Z999-DB2-ABEND.                                                  13380002
133900                                                                  13390002
134400     DISPLAY AA-ABEND-LIT.                                        13440002
134500     DISPLAY AA-DB2-ERROR-LIT.                                    13450002
134600     DISPLAY AA-PROGRAM-LIT.                                      13460002
134700     DISPLAY AA-PARAGRAPH-LIT.                                    13470002
134800     DISPLAY AA-DB2-OPERATION-LIT.                                13480002
134810     DISPLAY AA-DB2-TABLE1.                                       13481002
134820     DISPLAY AA-DB2-TABLE2.                                       13482002
134850     SET AC-DB2-ERROR TO TRUE.                                    13485002
134860                                                                  13486002
135400     COPY DPPD004.                                                13540000
135500     CALL 'ILBOABN0' USING ABEND-CODE.                            13550000
135600                                                                  13560000
