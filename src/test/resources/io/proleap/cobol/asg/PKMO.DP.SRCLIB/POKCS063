000100*-----------------------*                                         00010099
000200 IDENTIFICATION DIVISION.                                         00020099
000300*-----------------------*                                         00030099
000400 PROGRAM-ID.    POKCS063.                                         00040099
000500 AUTHOR.        TIM SMITH.                                        00050099
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060099
000700 DATE-WRITTEN.  02-22-94.                                         00070099
000800 DATE-COMPILED.                                                   00080099
000900                                                                  00090099
001000*---------------------------------------------------------------* 00100099
001100*    W063 - PO LINE - DC SUMMARY                                * 00110099
001200*                                                               * 00120099
001300*    DISPLAYS A SUMMARY OF PO LINES AND THEIR ASSOCIATED        * 00130099
001400*    ORDER AND RECEIPT QUANTITIES BY DC.                        * 00140099
001500*                                                               * 00150099
001600*---------------------------------------------------------------* 00160099
002400***************************************************************** 00160199
002500* DATE     WHO      DESCRIPTION                                 * 00160299
GH0407* 040706   TKMAB56  WR #21643, ADD CODE FOR PF22.               * 00160399
002400***************************************************************** 00160599
002600* 011701   TKMA537  WR #21643, E-COMMERCE EDITS                 * 00160799
002700*                   ADDED CODE TO HIGHLIGHT WEB ITEMS IN RED    * 00160899
003000***************************************************************** 00160999
W24803* 04/25/03 - RAMAKRISHNA PRASAD V, IGSI - WR NO. 24803          * 00161099
W24803*    - IN MAP POKM063 REPLACED CLASS AND SEQUENCE NUMBER WITH   * 00161199
W24803*      MAJOR CLASS, SUB CLASS AND SKU NUMBER.                   * 00161299
W24803*    - ADDED A NEW FILLER FIELD WITH SIZE 166 BYTES AFTER THE   * 00161399
W24803*      STRUCTURE ASC-SPECIFIC-COMMAREA.                         * 00161499
W24803*    - REPLACED ALL CLASS AND 3 DIGIT SEQUENCE NUMBER WITH      * 00161599
W24803*      SUB CLASS, MAJOR CLASS AND SKU NUMBER RESPECTIVELY FOR   * 00161699
W24803*      NI-SKU CONVERSION.                                       * 00161799
W24803*    - PARA 4450-CHECK-TWEBUPC NAME IS CHANGED TO               * 00161899
W24803*      4450-CHECK-TWEBITM                                       * 00161999
W24803*    - IN PARA 4450-CHECK-TWEBUPC, TWEBITM AND TUPCPLS TABLES   * 00162099
W24803*      ARE NOT REPLACED BY LOGISTICS DOMAIN TABLES BECAUSE OF   * 00162199
W24803*      PERFORMANCE ISSUES.                                      * 00162299
W24803***************************************************************** 00162399
C98147* DATE  20/11/2014                                              * 00162699
C98147*       CHANGE MADE: PO EXTENDED DIGIT CHANGES.                 * 00162799
C98147*       EXTENDED PO# FROM 7 TO 8 IN MAP POKM063.                * 00162899
C98147*      MADE BY: COGNIZANT              WR/IR: CHG0098147        * 00162999
C98147***************************************************************** 00163099
076319* DATE  10/27/2021                                                00163199
076320*            - CHANGE CALL OF 'DPKUT100' TO                     * 00163299
076321*              CALL DP010I-NUMERIC-EDIT-ROUTINE                 * 00163399
076322*              MAKING THE CALL DYNAMIC VS STATIC                * 00163499
076323*     MADE BY: GERMAN BANDA            WR/IR #: CHG0263126        00163599
076312*                                                               * 00163699
076318*---------------------------------------------------------------* 00163799
CICS  *  CHANGED 11/14/2022    BY BARB SCHULTZ    WR: CHG0278485      * 00163899
CICS  *                                                               * 00163999
CICS  *  ADDED COPYBOOK DPWS930 AND MADE THE CICS ARCHITECTURE CALL   * 00164099
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.    * 00164199
076318*---------------------------------------------------------------* 00164499
001610                                                                  00164599
001620 EJECT                                                            00164699
001630 ENVIRONMENT DIVISION.                                            00164799
001640                                                                  00164899
001650 DATA DIVISION.                                                   00164999
001660                                                                  00165099
001670 WORKING-STORAGE SECTION.                                         00165199
001680                                                                  00165299
001690 01  DK-DB2-KEYS.                                                 00165399
001700     15  DK-PO-NUMBER                   PIC S9(09)  VALUE ZERO    00165499
001800                                                    COMP.         00165599
004100     05  DK-PO-LNE-NBR                  PIC S9(9)   COMP VALUE +0.00165699
001900                                                                  00165799
002000 01  PC-PROGRAM-CONSTANTS.                                        00166099
00059      05  PC-PERCENT                     PIC  X(01)  VALUE '%'.    00166199
00060      05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00166299
00061      05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00166399
00062      05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00166499
00063      05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00166599
002100     05  PC-CURRENT-MAP-NAME            PIC  X(08)  VALUE         00167099
002200                                                    'PO063A  '.   00168099
002300     05  PC-CURRENT-MAPSET-NAME         PIC  X(08)  VALUE         00169099
002400                                                    'POKM063 '.   00170099
002500     05  PC-CURRENT-PROGRAM-NAME        PIC  X(08)  VALUE         00180099
002600                                                    'POKCS063'.   00190099
002700     05  PC-LIST-QUEUE-SEQ              PIC  9(01)  VALUE 1.      00200099
002800     05  PC-SEL-QUEUE-SEQ               PIC  9(01)  VALUE 2.      00210099
002900     05  PC-CRIT-SPEC-FORMAT            PIC  X(01)  VALUE '1'.    00220099
003000     05  PC-ITEMS-PER-PANEL             PIC S9(04)  VALUE +07     00230099
003100                                                    COMP SYNC.    00240099
003200     05  PC-MAX-BLOCKS-IN-ARRAY         PIC S9(04)  VALUE +2      00250099
003300                                                    COMP SYNC.    00260099
003400     05  PC-MAX-ITEMS                   PIC S9(09)  VALUE         00270099
003500                                                    +1000000      00280099
003600                                                    COMP-3.       00290099
003700     05  PC-MSG-NUMBER-LENGTH           PIC S9(04)  VALUE +5      00300099
003800                                                    COMP SYNC.    00310099
003900     05  PC-MAX-RETRIES                 PIC S9(03)  VALUE 3       00320099
004000                                                    COMP-3.       00330099
004100     05  PC-PCT                         PIC  X(01)  VALUE '%'.    00340099
004200     05  PC-DCX                         PIC S9(04)  COMP.         00350099
004300     05  PC-HEADA                       PIC X(17) VALUE           00360099
004400        '   QTY   QTY  PCT'.                                      00370099
004500                                                                  00380099
004600                                                                  00390099
004700     05  PC-DC1-HEAD                    PIC X(59).                00400099
004800     05  FILLER REDEFINES PC-DC1-HEAD.                            00410099
004900         10  PC-DC1-HEADA               PIC X(17).                00420099
005000         10  FILLER                     PIC X(02).                00430099
005100         10  PC-DC1-HEADB               PIC X(5).                 00440099
005110         10  FILLER                     PIC X(02).                00450099
005120         10  PC-DC1-HEADC               PIC X(5).                 00460099
005121         10  FILLER                     PIC X(02).                00470099
005122         10  PC-DC1-HEADD               PIC X(5).                 00480099
005123         10  FILLER                     PIC X(02).                00490099
005124         10  PC-DC1-HEADE               PIC X(5).                 00500099
005125         10  FILLER                     PIC X(02).                00510099
005126         10  PC-DC1-HEADF               PIC X(5).                 00511099
005127         10  FILLER                     PIC X(02).                00512099
005128         10  PC-DC1-HEADG               PIC X(5).                 00512199
005129                                                                  00512299
005130     05  PC-HEADB                       PIC X(17) VALUE           00512399
005140        '   ORD   REC  REC'.                                      00512499
005141     05  PC-HEAD-DC1                    PIC X(14) VALUE           00512599
005142        '    ORD   RECV'.                                         00512699
005143     05  PC-HEAD-DC2                    PIC X(14) VALUE           00512799
005144        '    ORD   RECV'.                                         00512899
005145     05  PC-HEAD-DC3                    PIC X(14) VALUE           00512999
005146        '    ORD   RECV'.                                         00513099
005147                                                                  00514099
005148     05  PC-DC1-HEAD2                   PIC X(59).                00514199
005149     05  FILLER REDEFINES PC-DC1-HEAD2.                           00514299
005150         10  PC-HEAD-NAMEB                  PIC X(17).            00514399
005151         10  PC-HEAD-DC10                   PIC X(14).            00514499
005152         10  PC-HEAD-DC20                   PIC X(14).            00514599
005153         10  PC-HEAD-DC30                   PIC X(14).            00514699
005154                                                                  00514799
005155     05  PC-QTY-HEAD                   PIC X(50)   VALUE          00514899
005156       '                                  QTY    QTY   PCT'.      00514999
005157     05  PC-QTY-HEAD2                  PIC X(50)   VALUE          00515099
005158       '     DESCRIPTION           STS    ORD    REC   REC'.      00515199
005159*                                                                 00515299
005160     05  PC-TSYMSG-NUMBERS.                                       00515399
005170         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00515499
005180         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00515599
005190         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00515699
005200         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00515799
005300         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00515899
005400         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00515999
005500         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00516099
005600         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00517099
005700         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00518099
005800         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00519099
005900         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00520099
006000         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00530099
006100         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00540099
006200         10  PC-TSYMSG-00994            PIC  9(05)  VALUE 00994.  00550099
006300         10  PC-TSYMSG-00227            PIC  9(05)  VALUE 00227.  00560099
006400         10  PC-TSYMSG-00228            PIC  9(05)  VALUE 00228.  00570099
006500         10  PC-TSYMSG-99901            PIC  9(05)  VALUE 99901.  00580099
006600*                                                                 00590099
006700 01  PS-PROGRAM-SWITCHES.                                         00600099
006800     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00610099
006900         88  PS-NO-ERROR                            VALUE 'Y'.    00620099
007000         88  PS-ERROR                               VALUE 'N'.    00630099
007100     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00640099
007200         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00650099
007300         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00660099
007400     05  PS-DONE-SW                     PIC  X(01)  VALUE 'N'.    00670099
007500         88  PS-DONE                                VALUE 'Y'.    00680099
007600         88  PS-NOT-DONE                            VALUE 'N'.    00690099
007700     05  PS-END-OF-DC-SW                PIC  X(01)  VALUE 'N'.    00700099
007800         88  PS-END-OF-DC                           VALUE 'Y'.    00710099
007900         88  PS-NOT-END-OF-DC                       VALUE 'N'.    00720099
007910     05  PS-TABLE-OVERFLOW-SW           PIC  X(01)  VALUE 'N'.    00730099
007920         88  PS-TABLE-OVERFLOW                      VALUE 'Y'.    00740099
007930         88  PS-NOT-TABLE-OVERFLOW                  VALUE 'N'.    00750099
007980*                                                                 00760099
007990 01  PV-PROGRAM-VARIABLES.                                        00770099
007991                                                                  00780099
007992     05  PV-DC-COUNT                    PIC S9(09)  VALUE +0      00790099
007993                                                    COMP-3.       00791099
007996     05  PV-DC-REC-DATE                 PIC X(10).                00792099
007997     05  PV-ALLOC-DATE                  PIC X(10).                00793099
007998                                                                  00794099
007999    05  PV-NORMAL-TOTALS.                                         00795099
008000        10  FILLER                         PIC X(31).             00796099
008001        10  PV-TOT-ORD                     PIC ZZZZZ9.            00797099
008002        10  FILLER                         PIC X(01).             00798099
008003        10  PV-TOT-REC                     PIC ZZZZZ9.            00799099
008004        10  FILLER                         PIC X(03).             00800099
008005        10  PV-TOTRECPCT-X.                                       00800199
008006           15 PV-TREC-PCT                  PIC  ZZ9.              00800299
008007           15 PV-TREC-PCT-SIGN             PIC  X(01).            00800399
008008        10  FILLER                         PIC X(08).             00800499
008009                                                                  00800599
008010    05  PV-DC-TOTALS.                                             00800699
008011        10  PV-TOT-ORD2                    PIC ZZZZZ9.            00800799
008012        10  PV-TOT-REC2                    PIC ZZZZZ9.            00800899
008013        10  FILLER                         PIC X(02).             00800999
008014        10  PV-TOTRECPCT2-X.                                      00801099
008015           15 PV-TREC-PCT2                 PIC  ZZ9.              00801199
008016           15 PV-TREC-PCT-SIGN2            PIC  X(01).            00801299
008017        10  PV-TOT-DC1-ORD                 PIC ZZZZZZ.            00801399
008018        10  FILLER                         PIC X(01).             00801499
008019        10  PV-TOT-DC1-REC                 PIC ZZZZZZ.            00801599
008020        10  FILLER                         PIC X(01).             00801699
008021        10  PV-TOT-DC2-ORD                 PIC ZZZZZZ.            00801799
008022        10  FILLER                         PIC X(01).             00801899
008023        10  PV-TOT-DC2-REC                 PIC ZZZZZZ.            00801999
008024        10  FILLER                         PIC X(01).             00802099
008025        10  PV-TOT-DC3-ORD                 PIC ZZZZZZ.            00802199
008026        10  FILLER                         PIC X(01).             00802299
008027        10  PV-TOT-DC3-REC                 PIC ZZZZZZ.            00802399
008028                                                                  00802499
008029    05  PV-NORMAL-LINE.                                           00802599
008030     10  FILLER                         PIC  X(02).               00802699
008032     10  PV-DESC                        PIC  X(22).               00802799
008033     10  FILLER                         PIC  X(03).               00802899
008034                                                                  00802999
008035     10  PV-STATUS                      PIC  X(02).               00803099
008036     10  FILLER                         PIC  X(02).               00803199
008037                                                                  00803299
008038     10  PV-QTY-X.                                                00803399
008039         20 PV-QTY                      PIC  ZZZZZZ.              00803499
008040     10  FILLER                         PIC  X(01).               00803599
008041                                                                  00803699
008042     10  PV-REC-QTY-X.                                            00803799
008043         20 PV-REC-QTY                  PIC  ZZZZZZ.              00803899
008044     10  FILLER                         PIC  X(03).               00803999
008045                                                                  00804099
008046     10  PV-RECPCT-X.                                             00804199
008047         20 PV-REC-PCT                  PIC  ZZZ.                 00804299
008048         20 PV-REC-PCT-SIGN             PIC  X(01).               00804399
008049                                                                  00804499
008050 05  PV-DC1-LINE.                                                 00804599
008051     10  PV-QTY-DC-X.                                             00804699
008052         15 PV-QTY-DC                   PIC  ZZZZZZ.              00804799
008053                                                                  00804899
008054     10  PV-REC-QTY-DC-X.                                         00804999
008055         15 PV-REC-QTY-DC               PIC  ZZZZZZ.              00805099
008056     10  FILLER                         PIC  X(02).               00805199
008057                                                                  00805299
008058     10  PV-RECPCT-DC-X.                                          00805399
008059         15 PV-REC-PCT-DC               PIC  ZZZ.                 00805499
008060         15 PV-REC-PCT-SIGN-DC          PIC  X(01).               00805599
008061                                                                  00805699
008062     10  PV-DC1-X.                                                00805799
008063         15 PV-DC1                      PIC ZZZZZZ.               00805899
008064     10  FILLER                         PIC  X(01).               00805999
008065     10  PV-REC-DC1-X.                                            00806099
008066         15  PV-REC-DC1                 PIC ZZZZZZ.               00806199
008067     10  FILLER                         PIC  X(01).               00806299
008068     10  PV-DC2-X.                                                00806399
008069         15  PV-DC2                     PIC ZZZZZZ.               00806499
008070     10  FILLER                         PIC  X(01).               00806599
008071     10  PV-REC-DC2-X.                                            00806699
008072         15  PV-REC-DC2                 PIC ZZZZZZ.               00806799
008073     10  FILLER                         PIC  X(01).               00806899
008074     10  PV-DC3-X.                                                00806999
008075         15  PV-DC3                     PIC ZZZZZZ.               00807099
008076     10  FILLER                         PIC  X(01).               00807199
008077     10  PV-REC-DC3-X.                                            00807299
008078         15  PV-REC-DC3                 PIC ZZZZZZ.               00807399
008082     10  PV-STATUS-DC                    PIC  X(02).              00807499
008083                                                                  00807599
008084                                                                  00807699
008200     05  PV-SUB                         PIC S9(04)  VALUE +0      00807799
008300                                                    COMP SYNC.    00807899
008400     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00807999
008500                                                    COMP SYNC.    00808099
008600     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00809099
008700                                                    COMP-3.       00810099
008800     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      00820099
008900                                                    COMP-3.       00830099
009000     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      00840099
009100                                                    COMP-3.       00850099
009200     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      00860099
009300                                                    COMP-3.       00870099
009400     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      00880099
009500                                                    COMP-3.       00890099
009600     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      00900099
009700                                                    COMP-3.       00910099
009800     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      00920099
009900                                                    COMP-3.       00930099
010000     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      00940099
010100                                                    COMP SYNC.    00950099
010200     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      00960099
010300                                                    COMP SYNC.    00970099
010400     05  PV-ITEM                        PIC S9(04)  VALUE +0      00980099
010500                                                    COMP SYNC.    00990099
010600     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01000099
010700                                                    COMP SYNC.    01010099
010800     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01020099
010900                                                    COMP SYNC.    01030099
011000     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01040099
011100                                                    COMP SYNC.    01050099
011200     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01060099
011300                                                    COMP SYNC.    01070099
011400     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01080099
011500                                                    COMP SYNC.    01090099
011600     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01100099
011700                                                    COMP SYNC.    01110099
011800     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01120099
011900                                                    COMP SYNC.    01130099
012000     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01140099
012100                                                    COMP SYNC.    01150099
012200     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01160099
012300                                                    COMP SYNC.    01170099
012400     05  PV-SQL-SUB                     PIC S9(04)  VALUE +0      01180099
012500                                                    COMP SYNC.    01190099
012600     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01200099
012700                                                    COMP SYNC.    01210099
016900     05  PV-DB2-COUNT                   PIC S9(09)  VALUE +0      01220099
017000                                                    COMP-3.       01230099
012800     05  PV-DC-SPLIT-QTY                PIC S9(09)  VALUE +0      01240099
012900                                                    COMP.         01250099
013000     05  PV-DC-REC-QTY                  PIC S9(09)  VALUE +0      01260099
013100                                                    COMP.         01270099
013200     05  PV-DC-ORD-QTY                  PIC S9(09)  VALUE +0      01280099
013300                                                    COMP.         01290099
013400     05  PV-TOT-REC-QTY                 PIC S9(09)  VALUE +0      01300099
013500                                                    COMP.         01310099
013600     05  PV-QTY-NULL                    PIC S9(04)  VALUE +0      01320099
013700                                                    COMP.         01330099
013800     05  PV-TOT-REC-PCT                 PIC  S9(03)V99            01340099
013900                                                   COMP-3.        01350099
014000     05  PV-END-QTY-ORD                 PIC 9(06)  VALUE ZERO.    01360099
014100     05  PV-END-QTY-REC                 PIC 9(06)  VALUE ZERO.    01370099
W24803     05  PV-NULL-INDICATORS.                                      01380099
W24803         10 PV-MAJ-CL-NBR-IND           PIC S9(04) VALUE +0       01390099
W24803                                                   COMP.          01400099
W24803         10 PV-SUB-CL-NBR-IND           PIC S9(04) VALUE +0       01410099
W24803                                                   COMP.          01411099
W24803         10 PV-SKU-NBR-IND              PIC S9(04) VALUE +0       01412099
W24803                                                   COMP.          01413099
W24803         10 PV-SKU-DESC-IND             PIC S9(04) VALUE +0       01414099
W24803                                                   COMP.          01415099
W24803     05  PV-TEMP-SKU.                                             01416099
W24803         10 PV-TEMP-SKU-DEPT            PIC 9(03)  VALUE 0.       01417099
W24803         10 PV-TEMP-SKU-CLASS           PIC 9(02)  VALUE 0.       01418099
W24803         10 PV-TEMP-SKU-SEQ             PIC 9(03)  VALUE 0.       01419099
W24803     05  PV-SKU-NBR REDEFINES PV-TEMP-SKU                         01419199
W24803                                        PIC 9(08).                01419299
W24803     05  PV-MAJ-CL.                                               01419399
W24803         10 PV-MAJ-CL-1                 PIC 9      VALUE 0.       01419499
W24803         10 FILLER                      PIC 9      VALUE 0.       01419599
W24803     05  PV-MAJ-CLASS REDEFINES PV-MAJ-CL                         01419699
W24803                                        PIC 9(02).                01419799
014200******************************************************************01419899
014300**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01419999
014400**  THIS MUST BE THE EXACT SAME FORMAT A BLOCK IN THE           **01420099
014500**  APPLICATION-SPECIFIC COMMAREA.                              **01430099
014600******************************************************************01440099
014700 01  LQW-LIST-QUEUE-WORK-AREA.                                    01450099
014800     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01460099
014900     05  LQW-ITEM-ENTRIES               OCCURS 10 TIMES           01470099
015000                                        INDEXED BY LQW-IDX.       01480099
015100         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01490099
015200         10  LQW-LINE                   PIC  9(03).               01500099
W24803         10  LQW-MCL                    PIC  9(02).               01510099
W24803         10  LQW-SCL                    PIC  9(02).               01520099
W24803         10  LQW-SKU                    PIC  9(08).               01530099
015600         10  LQW-DESC                   PIC  X(20).               01540099
015700         10  LQW-QTY                    PIC  9(06).               01550099
015800         10  LQW-STATUS                 PIC  X(02).               01560099
015900         10  LQW-REC-QTY                PIC  9(06).               01570099
016000         10  LQW-REC-PCT                PIC  S9(3)V99 COMP-3.     01580099
016100         10  LQW-DC                     PIC  9(06).               01590099
016200         10  LQW-REC-DC                 PIC  9(06).               01600099
00153          10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01601099
00154          10  LQW-SELECTED-SW            PIC  X(01).               01602099
00155              88  LQW-SELECT                         VALUE 'S'.    01603099
00156              88  LQW-DESELECT                       VALUE ' '.    01604099
00157          10  LQW-ACTION                 PIC  X(03).               01605099
00158          10  LQW-MESSAGE-NUMBER         PIC S9(05)  COMP-3.       01606099
00159          10  LQW-SYSTEM-ID              PIC  X(02).               01607099
00160          10  LQW-MESSAGE-TEXT           PIC  X(55).               01608099
00161          10  LQW-REVIEW-IND             PIC  X(01).               01609099
016300                                                                  01610099
016400     EJECT                                                        01620099
016500                                                                  01630099
00164 *---------------------------------------------------------------* 01632299
00165 *  RECORD LAYOUT FOR THE MESSAGE SELECTION TEMP STORAGE QUEUE.  * 01632399
00166 *---------------------------------------------------------------* 01633099
00167                                                                   01634099
00168      COPY DPWS057.                                                01635099
00169                                                                   01636099
00170      EJECT                                                        01637099
016600*---------------------------------------------------------------* 01640099
016700*    MAP LAYOUT                                                 * 01650099
016800*---------------------------------------------------------------* 01660099
016900                                                                  01670099
017000     COPY POKM063.                                                01680099
017100*                                                                 01690099
017200 01  MR-OCCURS-LAYOUT                   REDEFINES  PO063AO.       01700099
C98147     05  FILLER                         PIC X(104).               01710099
017301                                                                  01720099
017302     05  MR-HEAD1L             PIC S9(04) COMP.                   01730099
017303     05  MR-HEAD1A             PIC  X(01).                        01730199
017304     05  MR-HEAD1C             PIC  X(01).                        01730299
017305     05  MR-HEAD1H             PIC  X(01).                        01730399
017310     05  MR-HEAD1              PIC  X(59).                        01730499
017311                                                                  01730599
017312     05  MR-HEAD2L             PIC S9(04) COMP.                   01730699
017313     05  MR-HEAD2A             PIC  X(01).                        01730799
017314     05  MR-HEAD2C             PIC  X(01).                        01730899
017315     05  MR-HEAD2H             PIC  X(01).                        01730999
017320     05  MR-HEAD2              PIC  X(59).                        01731099
017330                                                                  01731199
017400     05  MR-SCROLL-AREA                 OCCURS 10 TIMES.          01731299
017500                                                                  01731399
017600         10  MR-LINEL                   PIC S9(04) COMP.          01731499
017700         10  MR-LINEA                   PIC  X(01).               01731599
017800         10  MR-LINEC                   PIC  X(01).               01731699
017900         10  MR-LINEH                   PIC  X(01).               01731799
018000         10  MR-LINE-X.                                           01731899
018100             15 MR-LINE                 PIC ZZZ.                  01731999
018200                                                                  01732099
W24803         10  MR-MCLL                    PIC S9(04) COMP.          01733099
W24803         10  MR-MCLA                    PIC  X(01).               01734099
W24803         10  MR-MCLC                    PIC  X(01).               01735099
W24803         10  MR-MCLH                    PIC  X(01).               01736099
W24803         10  MR-MCL                     PIC  X(02).               01737099
W24803                                                                  01738099
W24803         10  MR-SCLL                    PIC S9(04) COMP.          01739099
W24803         10  MR-SCLA                    PIC  X(01).               01740099
W24803         10  MR-SCLC                    PIC  X(01).               01750099
W24803         10  MR-SCLH                    PIC  X(01).               01760099
W24803         10  MR-SCL                     PIC  X(02).               01770099
W24803*                                                                 01780099
019500         10  MR-SKU-NBRL                PIC S9(04) COMP.          01790099
019600         10  MR-SKU-NBRA                PIC  X(01).               01800099
019700         10  MR-SKU-NBRC                PIC  X(01).               01810099
019800         10  MR-SKU-NBRH                PIC  X(01).               01820099
W24803         10  MR-SKU-NBR                 PIC  X(08).               01830099
019910                                                                  01840099
019920         10  MR-LINE-AREAL              PIC S9(04) COMP.          01850099
019930         10  MR-LINE-AREAA              PIC  X(01).               01860099
019940         10  MR-LINE-AREAC              PIC  X(01).               01870099
019950         10  MR-LINE-AREAH              PIC  X(01).               01880099
020000         10  MR-LINE-AREA               PIC  X(59).               01890099
020001                                                                  01900099
020010     05  MR-TOTAL-LINEL             PIC S9(04) COMP.              01910099
020020     05  MR-TOTAL-LINEA             PIC  X(01).                   01920099
020030     05  MR-TOTAL-LINEC             PIC  X(01).                   01930099
020040     05  MR-TOTAL-LINEH             PIC  X(01).                   01940099
020100     05  MR-TOTAL-LINE              PIC  X(59).                   01950099
025454                                                                  01960099
025455     EJECT                                                        01970099
025456*---------------------------------------------------------------* 01980099
025457*    ATTRIBUTE SETTINGS COPYBOOK.                               * 01990099
025458*---------------------------------------------------------------* 02000099
025459                                                                  02010099
025460     COPY DPWS015.                                                02020099
025470                                                                  02030099
025480*---------------------------------------------------------------* 02040099
025490*    FUNCTION KEYS COPYBOOK.                                    * 02050099
025500*---------------------------------------------------------------* 02060099
025600                                                                  02070099
025700     COPY DPWS016.                                                02080099
025800                                                                  02090099
025900*---------------------------------------------------------------* 02100099
026000*    NUMERIC EDIT LAYOUT.                                       * 02110099
026100*---------------------------------------------------------------* 02120099
026200                                                                  02130099
026300     COPY DPWS010I.                                               02140099
026400 EJECT                                                            02150099
026500*---------------------------------------------------------------* 02160099
CICS  *    PARAMETERS FOR CALLING THE CICS ARCHITECTURE API.          * 02170099
026700*---------------------------------------------------------------* 02180099
026800                                                                  02190099
026900     COPY DPWS030.                                                02200099
CICS       COPY DPWS930.                                                02201099
027000 EJECT                                                            02210099
027100*---------------------------------------------------------------* 02220099
027200*    STANDARD COMMAREA.                                         * 02230099
027300*---------------------------------------------------------------* 02240099
027400                                                                  02250099
027500     COPY DPWS020.                                                02260099
027600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02270099
027700                                                                  02280099
027800*---------------------------------------------------------------* 02290099
027900* INTER-APPLICATION COMMAREA.                                   * 02300099
028000*---------------------------------------------------------------* 02310099
028100                                                                  02320099
028200         10  INTER-APPL-COMM-AREA       PIC X(200).               02330099
028300     COPY POWS011.                                                02340099
028400*---------------------------------------------------------------* 02350099
028500*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02360099
028600*---------------------------------------------------------------* 02370099
028700         10  ASC-SPECIFIC-COMMAREA.                               02380099
028800             15  ASC-LIST-KEYS.                                   02390099
028900                 20  ASC-KEY-PO-NUMBER               PIC S9(09)   02400099
029000                                                     COMP.        02410099
029100                 20  ASC-KEY-DEPT                    PIC X(03).   02420099
029200                 20  ASC-KEY-VENDOR                  PIC X(30).   02430099
029300                 20  ASC-TOT-ORD                     PIC S9(09)   02440099
029400                                                         COMP-3.  02450099
029500                 20  ASC-TOT-REC                     PIC S9(09)   02460099
029600                                                         COMP-3.  02470099
029700                 20  ASC-TOT-PCT                     PIC X(4).    02480099
029800                 20  FILLER REDEFINES ASC-TOT-PCT.                02490099
029900                     25  ASC-TOT-PCT-N               PIC  9(03).  02500099
030000                     25  ASC-TOT-PCT-SIGN            PIC  X(01).  02510099
030100                                                                  02520099
030200             15  ASC-DC-ORD OCCURS 10 TIMES.                      02530099
030300                 20  ASC-TOT-DC-ORD          PIC S9(09) COMP-3.   02540099
030400             15  ASC-DC-REC OCCURS 10 TIMES.                      02550099
030500                 20  ASC-TOT-DC-REC          PIC S9(09) COMP-3.   02560099
030600                                                                  02570099
030700* IF NUMBER OF DC'S INCREASES JUST CHANGE CODE THAT RUNS WHEN     02580099
      *   PF24 IS HIT.                                                  02590099
030800            15  ASC-DC-TABLE OCCURS 10 TIMES.                     02600099
030900                20 ASC-DC-NBR                    PIC S9(4)        02610099
031000                                                 COMP SYNC.       02620099
031100                20 ASC-DC-NAME                   PIC X(5).        02630099
031200                                                                  02640099
031300             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                02650099
031400                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  02660099
031500                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   02670099
031600                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   02680099
031700                                                                  02690099
031800                 20  ASC-ITEM-ARRAY.                              02700099
031900                     25  ASC-ITEM-ENTRIES OCCURS 07 TIMES.        02710099
032000                         30  ASC-LIST-ITEM-NUMBER                 02720099
032100                                          PIC S9(09) COMP-3.      02730099
032200                         30  ASC-LINE                PIC  9(03).  02740099
W24803                         30  ASC-MCL                 PIC  9(02).  02750099
W24803                         30  ASC-SCL                 PIC  9(02).  02760099
W24803                         30  ASC-SKU                 PIC  9(08).  02770099
032600                         30  ASC-DESC                PIC  X(20).  02780099
032700                         30  ASC-QTY                 PIC  9(06).  02790099
032800                         30  ASC-STATUS              PIC  X(02).  02800099
032900                         30  ASC-REC-QTY             PIC  9(06).  02810099
032910                         30  ASC-REC-PCT             PIC S9(03)V9902820099
032911                                                         COMP-3.  02830099
032912                     30 ASC-DC-ARRAY.                             02840099
032913                         35  ASC-DC-QTY OCCURS 10 TIMES.          02850099
032914                           40  ASC-DC                  PIC  9(06).02860099
032915                           40  ASC-REC-DC              PIC  9(06).02870099
032916                                                                  02880099
032917             15  ASC-BLK-SUB                         PIC S9(04)   02890099
032918                                                          COMP    02900099
032919                                                          SYNC.   02910099
032920             15  ASC-ITEM-SUB                        PIC S9(04)   02920099
032930                                                          COMP    02930099
032940                                                          SYNC.   02940099
00308              15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(09)   02941099
00309                                                           COMP-3. 02942099
032950             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(09)   02950099
032960                                                          COMP-3. 02960099
032970             15  ASC-ITEMS-DISPLAYED                 PIC S9(03)   02970099
032980                                                          COMP-3. 02980099
032990             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(04)   02990099
033000                                                          COMP    03000099
033100                                                          SYNC.   03010099
033200             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(09)   03020099
033300                                                          COMP-3. 03030099
033400             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(09)   03040099
033500                                                          COMP-3. 03050099
033600             15  ASC-DC-END-SW                       PIC  X(01).  03060099
033700                 88  ASC-DC-END                      VALUE 'Y'.   03070099
033800                 88  ASC-NOT-DC-END                  VALUE 'N'.   03080099
033900             15  ASC-DISPLAY-SW                      PIC X(01).   03090099
034000                 88  ASC-DISPLAY-QTY                 VALUE 'Q'.   03100099
034100                 88  ASC-DISPLAY-DC                  VALUE 'F'.   03110099
034200             15  ASC-NEXT-DC-SW                      PIC X(01).   03120099
034300                 88  ASC-MORE-DC                     VALUE 'Q'.   03130099
034400                 88  ASC-NO-MORE-DC                  VALUE 'F'.   03140099
034500             15  ASC-ITEMS-LEFT-INDICATOR            PIC  X(01).  03150099
034600                 88  ASC-ITEMS-LEFT-ON-DB            VALUE 'Y'.   03160099
034700                 88  ASC-NO-ITEMS-LEFT-ON-DB         VALUE 'N'.   03170099
034800             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC  X(01).  03180099
034900                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   03190099
035000                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   03200099
035100             15  ASC-LIST-QUEUE-NAME.                             03210099
035200                 20  ASC-LIST-TERM-ID                PIC  X(04).  03220099
035300                 20  ASC-LIST-TASK-NUMBER            PIC S9(05)   03230099
035400                                                          COMP-3. 03240099
035500                 20  ASC-LIST-SEQ                    PIC  9(01).  03250099
035600             15  ASC-SEL-QUEUE-NAME.                              03260099
035700                 20  ASC-SEL-TERM-ID                 PIC  X(04).  03270099
035800                 20  ASC-SEL-TASK-NUMBER             PIC S9(05)   03280099
035900                                                          COMP-3. 03290099
036000                 20  ASC-SEL-SEQ                     PIC  9(01).  03300099
036100                 20  ASC-DC-COUNTER        PIC S9(09) COMP.       03310099
036210                 20  ASC-DC-COUNTER-DC     PIC S9(04) COMP.       03320099
036300                                                                  03330099
036400             15  ASC-START-ITEM-REQUEST.                          03340099
036500                 20  ASC-START-ITEM-REQUEST-N        PIC  9(07).  03350099
GH0407*        10  FILLER                                  PIC  X(96).  03360099
036600                                                                  03370099
036700     EJECT                                                        03380099
036800*---------------------------------------------------------------* 03390099
036900*    ABEND PROCESSING COPYBOOK.                                 * 03400099
037000*---------------------------------------------------------------* 03410099
037100                                                                  03420099
037200     COPY DPWS013.                                                03430099
037300                                                                  03440099
037400 EJECT                                                            03450099
037500*---------------------------------------------------------------* 03460099
037600*    DB2 AREA FOR TPURCHS                                       * 03470099
037700*---------------------------------------------------------------* 03480099
037800     EXEC SQL                                                     03490099
037900          INCLUDE TPURCHS                                         03500099
038000     END-EXEC.                                                    03510099
038100*---------------------------------------------------------------* 03520099
038200*    DB2 AREA FOR TPURITM                                       * 03530099
038300*---------------------------------------------------------------* 03540099
038400     EXEC SQL                                                     03550099
038500          INCLUDE TPURITM                                         03560099
038600     END-EXEC.                                                    03570099
038700*---------------------------------------------------------------* 03580099
038800*    DB2 AREA FOR TALLPLN                                       * 03590099
038900*---------------------------------------------------------------* 03600099
039000     EXEC SQL                                                     03610099
039100          INCLUDE TALLPLN                                         03620099
039200     END-EXEC.                                                    03630099
039300*---------------------------------------------------------------* 03640099
039400*    DB2 AREA FOR TENTNME                                       * 03650099
039500*---------------------------------------------------------------* 03660099
039600     EXEC SQL                                                     03670099
039700          INCLUDE TENTNME                                         03680099
039800     END-EXEC.                                                    03690099
039900*---------------------------------------------------------------* 03700099
040000*    DB2 AREA FOR TRECITM                                       * 03710099
040100*---------------------------------------------------------------* 03720099
040200     EXEC SQL                                                     03730099
040300          INCLUDE TRECITM                                         03740099
040400     END-EXEC.                                                    03750099
040500*---------------------------------------------------------------* 03760099
040600*    DB2 AREA FOR TRECDIS                                       * 03770099
040700*---------------------------------------------------------------* 03780099
040800     EXEC SQL                                                     03790099
040900          INCLUDE TRECDIS                                         03800099
041000     END-EXEC.                                                    03810099
      *---------------------------------------------------------------* 03820099
      *    DB2 AREA FOR LOCATION                                      * 03830099
      *---------------------------------------------------------------* 03840099
           EXEC SQL                                                     03850099
                INCLUDE XMT00001                                        03860099
           END-EXEC.                                                    03870099
                                                                        03880099
      *---------------------------------------------------------------* 03890099
      *    DB2 AREA FOR DC LOCATION ASSIGNMENT                        * 03900099
      *---------------------------------------------------------------* 03910099
           EXEC SQL                                                     03920099
                INCLUDE XMT00002                                        03930099
           END-EXEC.                                                    03940099
041700*---------------------------------------------------------------* 03950099
041800*    DB2 AREA FOR TPLNSHP                                       * 03960099
041900*---------------------------------------------------------------* 03970099
042000     EXEC SQL                                                     03980099
042010          INCLUDE TPLNSHP                                         03990099
042020     END-EXEC.                                                    04000099
W24803*---------------------------------------------------------------* 04010099
W24803*    DB2 AREA FOR XLT_SKU TABLE                                   04020099
W24803*---------------------------------------------------------------* 04030099
W24803                                                                  04040099
W24803     EXEC SQL                                                     04050099
W24803         INCLUDE XLT00003                                         04051099
W24803     END-EXEC.                                                    04052099
W24803*---------------------------------------------------------------* 04053099
W24803*    DB2 AREA FOR XLT_VND_STYL TABLE                              04054099
W24803*---------------------------------------------------------------* 04055099
W24803                                                                  04056099
W24803     EXEC SQL                                                     04057099
W24803         INCLUDE XLT00004                                         04058099
W24803     END-EXEC.                                                    04059099
W24803*---------------------------------------------------------------* 04059199
W24803*    DB2 AREA FOR TUPCPLS                                         04059299
W24803*---------------------------------------------------------------* 04059399
W24803                                                                  04059499
W24803     EXEC SQL                                                     04059599
W24803         INCLUDE TUPCPLS                                          04059699
W24803     END-EXEC.                                                    04059799
W24803*---------------------------------------------------------------* 04059899
W24803*    DB2 AREA FOR TWEBITM                                         04059999
W24803*---------------------------------------------------------------* 04060099
W24803                                                                  04060199
W24803     EXEC SQL                                                     04060299
W24803         INCLUDE TWEBITM                                          04060399
W24803     END-EXEC.                                                    04060499
042030*---------------------------------------------------------------* 04060599
042040*    DB2 AREA FOR COMMUNICATIONS                                * 04060699
042050*---------------------------------------------------------------* 04060799
042060     EXEC SQL                                                     04060899
042070          INCLUDE SQLCA                                           04060999
042080     END-EXEC.                                                    04061099
042100*---------------------------------------------------------------* 04062099
042200*    TPURITM CURSOR                                             * 04063099
042300*---------------------------------------------------------------* 04064099
042400                                                                  04065099
042500     EXEC SQL                                                     04066099
042600          DECLARE LINE-CSR1  CURSOR                               04067099
042700          FOR SELECT                                              04068099
042800                A.PO_NBR,                                         04069099
042900                A.TOT_UNT_QTY,                                    04070099
043000                A.STATUS_CDE,                                     04080099
043100                B.STATUS_CDE,                                     04090099
043200                B.APP_PO_LNE_NBR,                                 04100099
043300                B.PO_LNE_NBR,                                     04110099
W24803                D.MAJ_CL_NBR,                                     04120099
W24803                D.SUB_CL_NBR,                                     04130099
W24803                C.SKU_NBR,                                        04140099
W24803                C.SKU_DESC,                                       04150099
W24803                B.CL_NBR,                                         04160099
W24803                B.SKU_SEQ_NBR,                                    04170099
W24803                B.SKU_DESC,                                       04180099
043800                B.UNT_QTY                                         04190099
043900          FROM                                                    04200099
044000                TPURCHS A,                                        04210099
044100                TPURITM B                                         04220099
W24803          LEFT OUTER JOIN                                         04230099
W24803                XLT_SKU C                                         04240099
W24803          ON    B.ITM_NBR = C.ITM_NBR                             04250099
W24803          LEFT OUTER JOIN                                         04260099
W24803                XLT_VND_STYL D                                    04270099
W24803          ON    C.STYL_ID = D.STYL_ID                             04280099
044200          WHERE                                                   04290099
W24803                 A.PO_NBR         = :PURCHS-PO-NBR                04300099
044400            AND  A.VER_STATUS_CDE = 'A'                           04310099
044500            AND  A.PO_NBR         = B.PO_NBR                      04320099
044600            AND  B.VER_STATUS_CDE = A.VER_STATUS_CDE              04330099
044700          ORDER BY                                                04340099
044800                5, 6                                              04350099
044900     END-EXEC.                                                    04360099
045000                                                                  04370099
045100*---------------------------------------------------------------* 04380099
045200*    DC CURSOR                                                  * 04390099
045300*---------------------------------------------------------------* 04400099
045400     EXEC SQL                                                     04410099
045500          DECLARE DC-CSR CURSOR FOR                               04420099
045600          SELECT XL.LOC_NBR,                                      04430099
045610                 XL.LOC_5_ABBR_NM                                 04440099
045620            FROM XMT_LOC XL                                       04450099
045630           WHERE LOC_TYP_CDE = 'DC'                               04460099
045640             AND CLO_DTE > CURRENT DATE                           04470099
045641             AND XL.LOC_NBR =                                     04480099
045642                (SELECT DC_NBR                                    04490099
045643                   FROM XMT_DC_LOC_ASGMT DLA1                     04500099
045644                  WHERE DLA1.LOC_NBR = XL.LOC_NBR                 04510099
045645                    AND DLA1.PO_STRT_DTE =                        04520099
                             (SELECT MAX(PO_STRT_DTE)                   04530099
                                FROM XMT_DC_LOC_ASGMT DLA2              04540099
                               WHERE DLA2.PO_STRT_DTE <= :PV-DC-REC-DATE04550099
                                 AND DLA1.LOC_NBR = DLA2.LOC_NBR))      04560099
GH0407           ORDER BY XL.LOC_NBR                                    04560199
045646     END-EXEC.                                                    04561099
045647                                                                  04562099
045648 EJECT                                                            04563099
045649 LINKAGE SECTION.                                                 04564099
045650                                                                  04564199
045660 01  DFHCOMMAREA.                                                 04564299
045670     05  FILLER                         OCCURS  1 TO 4072 TIMES   04564399
045680                                        DEPENDING ON EIBCALEN.    04564499
045690         10  FILLER                     PIC X.                    04564599
045700                                                                  04564699
045800 EJECT                                                            04564799
045900 PROCEDURE DIVISION.                                              04564899
046000******************************************************************04564999
046100**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **04565099
046200**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **04566099
046300**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **04567099
046400******************************************************************04568099
046500 0000-MAIN-MODULE.                                                04569099
046600     INITIALIZE DP030-CICS-API-FIELDS.                            04570099
046700     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04580099
046800     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04590099
046900     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04600099
047000     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04610099
047100     MOVE LENGTH OF PO063AI        TO DP030-MAP-LENGTH (1).       04620099
047200     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04630099
047300     PERFORM 0001-CALL-CICS-ARCH-API.                             04640099
047400*                                                                 04650099
GH0407     IF PO011-LAST-PROGRAM = 'POKCS129'                           04651099
GH0407         MOVE SPACES TO PO011-LAST-PROGRAM                        04652099
GH0407         MOVE 'R'    TO DP020-NEXT-APPL-ACTIVITY                  04653099
GH0407     END-IF.                                                      04654099
GH0407                                                                  04655099
047500     PERFORM 1000-CONTROL-PROCESSING                              04660099
047600*                                                                 04670099
047700     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04680099
047800     PERFORM 0001-CALL-CICS-ARCH-API.                             04690099
047900                                                                  04700099
048000******************************************************************04710099
048100**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **04720099
048200**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **04730099
048300******************************************************************04740099
048400 0001-CALL-CICS-ARCH-API.                                         04750099
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04760099
048600                                    DFHCOMMAREA                   04770099
048700                                    DP030-CICS-API-FIELDS         04780099
048800                                    DP020-STANDARD-COMMAREA       04790099
048900                                    PO063AI.                      04800099
049000*                                                                 04810099
049100     IF  DP030-RC-CALL-SUCCESSFUL                                 04820099
049200         CONTINUE                                                 04830099
049300     ELSE                                                         04840099
049400         SET DP013-NO-ROLLBACK                                    04850099
049500             DP013-XCTL-DISPLAY-RESTART                           04860099
049600             DP013-CICS-ABEND      TO TRUE                        04870099
049700         MOVE '0001-CALL-CICS-ARCH-API'                           04880099
049800                                   TO DP013-PARAGRAPH             04890099
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04900099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04910099
050100         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04920099
050200         PERFORM DP013-0000-PROCESS-ABEND                         04930099
050300     END-IF.                                                      04940099
050400*----------------------------------------------------------------*04950099
050500* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04960099
050600* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04970099
050700*                                                                *04980099
050800* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04990099
050900*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *05000099
051000*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *05010099
051100*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *05020099
051200*----------------------------------------------------------------*05030099
051300                                                                  05040099
051400 1000-CONTROL-PROCESSING.                                         05050099
051500                                                                  05060099
051600     EVALUATE TRUE                                                05070099
051700         WHEN DP020-NEXT-ACT-INITIAL                              05080099
051800             INITIALIZE ASC-SPECIFIC-COMMAREA                     05090099
051900             MOVE EIBTRMID         TO ASC-LIST-TERM-ID            05100099
052000                                      ASC-SEL-TERM-ID             05110099
052100             MOVE DP020-SRC-TASK-NUMBER                           05120099
052200                                   TO ASC-LIST-TASK-NUMBER        05130099
052300                                      ASC-SEL-TASK-NUMBER         05140099
052400             MOVE PC-LIST-QUEUE-SEQ                               05150099
052500                                   TO ASC-LIST-SEQ                05160099
052600             MOVE PC-SEL-QUEUE-SEQ TO ASC-SEL-SEQ                 05170099
052700             PERFORM 1100-PROCESS-INTER-APPL-COMM                 05180099
052800***-----$TEMPLATE NOTE$-------------------------------------------05190099
052900*** IF THE DATA EXPECTED IS NOT RECEIVED FROM CALLING APPLICATION,05200099
053000*** SETUP APPROPRIATE MESSAGE AND SEVERITY AND SET APPL-ERROR TO  05210099
053100*** TRUE, THIS WILL RETURN TO CALLING APPLICATION WHEN API CALLED.05220099
053200***---------------------------------------------------------------05230099
053300             IF  PS-COMMAREA-NOT-VALID                            05240099
053400***              MOVE PC-TSYMSG-99901                             05250099
053500***                                TO DP020-MSG-NUMBER            05260099
053600***              SET DP020-MSG-FATAL                              05270099
053700***                                TO TRUE                        05280099
053800                 SET DP020-NEXT-ACT-APPL-ERROR                    05290099
053900                                   TO TRUE                        05300099
054000             ELSE                                                 05310099
054100                 PERFORM 1200-LOAD-DC-TABLE                       05320099
054200                 PERFORM 4000-BUILD-INITIAL-PANEL                 05330099
054300                 PERFORM 3200-RESET-ATTRIBUTES                    05340099
054400             END-IF                                               05350099
054500                                                                  05360099
00531          WHEN DP020-NEXT-ACT-RETURN                               05361099
00532              MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05362099
00533                                    TO PV-TOP-ITEM                 05363099
00534              MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    05364099
00536              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05366099
00537              PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05367099
00538                                                                   05368099
054600         WHEN DP020-NEXT-ACT-READ-MAP                             05370099
054700             MOVE ASC-ITEM-AT-TOP-OF-PANEL                        05380099
054800                                   TO PV-TOP-ITEM                 05390099
054900             PERFORM 2000-PROCESS-PANEL                           05400099
055000                                                                  05410099
055100         WHEN OTHER                                               05420099
055200             SET DP013-LOGIC-ABEND TO TRUE                        05430099
055300             SET DP013-NO-ROLLBACK TO TRUE                        05440099
055400             MOVE '1000-CONTROL-PROCESSING'                       05450099
055500                                   TO DP013-PARAGRAPH             05460099
055600             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05470099
055700                                   TO DP013-MESSAGE-TEXT(1)       05480099
055800             PERFORM DP013-0000-PROCESS-ABEND                     05490099
055900     END-EVALUATE.                                                05500099
056000                                                                  05510099
056100 EJECT                                                            05520099
056200*----------------------------------------------------------------*05530099
056300* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05540099
056400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05550099
056500*----------------------------------------------------------------*05560099
056600                                                                  05570099
056700 1100-PROCESS-INTER-APPL-COMM.                                    05580099
056800                                                                  05590099
056900     SET PS-COMMAREA-VALID         TO TRUE.                       05600099
057000     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     05610099
057100     MOVE PO011-PO-NBR             TO ASC-KEY-PO-NUMBER           05620099
057200                                      DK-PO-NUMBER.               05630099
057300     IF PO011-PO-NBR = 0                                          05640099
057400         SET PS-COMMAREA-NOT-VALID TO TRUE                        05650099
057500     END-IF.                                                      05660099
057600 EJECT                                                            05670099
057700                                                                  05680099
057800*----------------------------------------------------------------*05690099
057900* LOADS A DC TABLE WITH ALL OF THE VALID DC NAMES.               *05700099
058000*----------------------------------------------------------------*05710099
058100 1200-LOAD-DC-TABLE.                                              05720099
058110                                                                  05730099
058111     SET PS-NOT-END-OF-DC TO TRUE.                                05740099
058112     SET PS-NOT-TABLE-OVERFLOW TO TRUE.                           05750099
058113                                                                  05760099
058114     PERFORM 1210-GET-DONT-SHIP-BEF-DTE.                          05770099
058115                                                                  05780099
058116     IF PLNSHP-DONT-SHIP-BEF-DTE > PV-ALLOC-DATE                  05790099
058117         MOVE PLNSHP-DONT-SHIP-BEF-DTE TO PV-DC-REC-DATE          05800099
058118     ELSE                                                         05810099
058119         MOVE PV-ALLOC-DATE TO PV-DC-REC-DATE                     05811099
058120     END-IF.                                                      05811199
058121                                                                  05811299
058122     PERFORM 4010-OPEN-DC-CSR.                                    05811399
058123     PERFORM 4015-PROCESS-DC-CSR.                                 05811499
058124     PERFORM 4020-CLOSE-DC-CSR.                                   05811599
058125                                                                  05811699
GH0407*    IF PS-TABLE-OVERFLOW                                         05811799
GH0407*        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    05811899
GH0407*        SET DP020-MSG-FATAL TO TRUE                              05811999
GH0407*        MOVE PC-TSYMSG-00994 TO DP020-MSG-NUMBER                 05812099
GH0407*    END-IF.                                                      05812199
058131 EJECT                                                            05812299
058132*----------------------------------------------------------------*05812399
058133* RETRIEVE DO NOT SHIP BEFORE DATE TO USE IN VALIDATING A DC     *05812499
058134*----------------------------------------------------------------*05812599
058135 1210-GET-DONT-SHIP-BEF-DTE.                                      05812699
058136                                                                  05812799
058137     PERFORM                                                      05812899
058138         WITH TEST AFTER                                          05812999
058139         VARYING PV-RETRY-COUNTER                                 05813099
058140         FROM 1 BY 1                                              05813199
058141         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               05813299
058142             OR (SQLCODE = ZERO))                                 05813399
058143                                                                  05813499
058144             EXEC SQL                                             05813599
058145                 SELECT DONT_SHIP_BEF_DTE,                        05813699
058146                        CURRENT DATE                              05813799
058147                 INTO :PLNSHP-DONT-SHIP-BEF-DTE,                  05813899
058148                      :PV-ALLOC-DATE                              05813999
058149                 FROM TPLNSHP                                     05814099
058150                 WHERE PO_NBR = :ASC-KEY-PO-NUMBER                05814199
058151                   AND VER_STATUS_CDE = 'A'                       05814299
058152             END-EXEC                                             05814399
058153                                                                  05814499
058154         EVALUATE TRUE                                            05814599
058155             WHEN SQLCODE = ZERO                                  05814699
058156             WHEN SQLCODE = -904                                  05814799
058157             WHEN SQLCODE = -913                                  05814899
058158                 CONTINUE                                         05814999
058159             WHEN SQLWARN0 NOT = SPACES                           05815099
058160             WHEN SQLCODE < ZERO                                  05815199
058161             WHEN SQLCODE > ZERO                                  05815299
058162                 MOVE '1210-GET-DONT-SHIP-BEF-DTE'                05815399
058163                                   TO DP013-PARAGRAPH             05815499
058164                 MOVE 'SQL ERROR SELECTING PO'                    05815599
058165                                   TO DP013-MESSAGE-TEXT (1)      05815699
058166                 MOVE SQLCA        TO DP013-SQLCA                 05815799
058167                 MOVE 'TPLNSHP '   TO DP013-DB2-TABLE-NAME (1)    05815899
058168                 SET DP013-DB2-ABEND                              05815999
058169                     DP013-XCTL-DISPLAY-RESTART TO TRUE           05816099
058170                 PERFORM DP013-0000-PROCESS-ABEND                 05816199
058171         END-EVALUATE                                             05816299
058172     END-PERFORM.                                                 05816399
058173*                                                                 05816499
058174     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        05816599
058175         MOVE '1210-GET-DONT-SHIP-BEF-DTE'                        05816699
058176                                   TO DP013-PARAGRAPH             05816799
058177         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT PO'  05816899
058178                                   TO DP013-MESSAGE-TEXT (1)      05816999
058179         MOVE SQLCA                TO DP013-SQLCA                 05817099
058180         MOVE 'TPLNSHP '           TO DP013-DB2-TABLE-NAME (1)    05817199
058181         SET DP013-DB2-ABEND                                      05817299
058182             DP013-XCTL-DISPLAY-RESTART                           05817399
058183                                   TO TRUE                        05817499
058184         PERFORM DP013-0000-PROCESS-ABEND                         05817599
058185     END-IF.                                                      05817699
058186                                                                  05817799
058187 EJECT                                                            05817899
058188*----------------------------------------------------------------*05817999
058189* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05818099
058190* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *05818199
058200* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *05818299
058300* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *05818399
058400* FUNCTION KEYS CAN GET THIS FAR.                                *05818499
058500*----------------------------------------------------------------*05818599
058600                                                                  05818699
058700 2000-PROCESS-PANEL.                                              05818799
058800     EVALUATE TRUE                                                05818899
058900         WHEN DP020-SRC-AID = DP016-CLEAR                         05818999
059000             SET ASC-DISPLAY-QTY TO TRUE                          05819099
059100             MOVE ZERO             TO ASC-ITEM-AT-TOP-OF-PANEL    05820099
059200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05830099
059300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05840099
059400             PERFORM 3200-RESET-ATTRIBUTES                        05850099
059500                                                                  05860099
059600         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    05870099
059700             SET ASC-DISPLAY-QTY TO TRUE                          05880099
059800             MOVE ASC-KEY-PO-NUMBER                               05890099
059900                                   TO DK-PO-NUMBER                05900099
060000             PERFORM 2050-DELETE-LIST-QUEUE                       05910099
060010             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05920099
060020             PERFORM 4000-BUILD-INITIAL-PANEL                     05930099
060030             PERFORM 3200-RESET-ATTRIBUTES                        05940099
060040                                                                  05950099
060050         WHEN OTHER                                               05960099
060060             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05970099
060070             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05980099
060080             IF  PS-NO-ERROR                                      05990099
060090                 SET DP030-CONTINUE-GO                            06000099
060100                                 TO TRUE                          06001099
060200                 PERFORM 2100-CHECK-FUNCTION-KEY                  06002099
060300             ELSE                                                 06003099
060400                 SET DP030-OVERRIDE-GO                            06004099
060500                                 TO TRUE                          06005099
060600             END-IF                                               06006099
060700     END-EVALUATE.                                                06007099
060800 EJECT                                                            06008099
060900*----------------------------------------------------------------*06009099
061000*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *06010099
061100*----------------------------------------------------------------*06020099
061200 2050-DELETE-LIST-QUEUE.                                          06030099
061300                                                                  06040099
061400     EXEC CICS                                                    06050099
061500         DELETEQ TS                                               06060099
061600             QUEUE (ASC-LIST-QUEUE-NAME)                          06070099
061700             RESP  (PV-CICS-RESP)                                 06080099
061800     END-EXEC.                                                    06090099
061900                                                                  06100099
062000     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       06110099
062100        (PV-CICS-RESP = DFHRESP(QIDERR))                          06120099
062200         CONTINUE                                                 06130099
062300     ELSE                                                         06140099
062400         SET DP013-CICS-ABEND      TO TRUE                        06150099
062500         SET DP013-NO-ROLLBACK     TO TRUE                        06160099
062600                                                                  06170099
062700         MOVE '2050-DELETE-LIST-QUEUE'                            06180099
062800                                   TO DP013-PARAGRAPH             06190099
062900         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    06200099
063000                                   TO DP013-MESSAGE-TEXT (1)      06210099
063100         PERFORM DP013-0000-PROCESS-ABEND                         06220099
063200     END-IF.                                                      06230099
063300                                                                  06240099
063400     MOVE +0                       TO ASC-HIGHEST-BLOCK-WRITTEN.  06250099
063500 EJECT                                                            06260099
063600*----------------------------------------------------------------*06270099
063700* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*06280099
063800* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *06290099
063900* CICS ARCHITECTURE API.                                         *06300099
064000*----------------------------------------------------------------*06310099
064100 2100-CHECK-FUNCTION-KEY.                                         06320099
064200     EVALUATE TRUE                                                06330099
064300                                                                  06340099
064400         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06350099
064500             MOVE +1               TO PV-TOP-ITEM                 06360099
064600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06370099
064700             PERFORM 3200-RESET-ATTRIBUTES                        06380099
064800                                                                  06390099
064900         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06400099
065000             PERFORM 2110-BROWSE-BACKWARD                         06410099
065100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06420099
065200             PERFORM 3200-RESET-ATTRIBUTES                        06430099
065300                                                                  06440099
065400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06450099
065500             PERFORM 2120-BROWSE-FORWARD                          06460099
065600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06470099
065700             PERFORM 3200-RESET-ATTRIBUTES                        06480099
065800                                                                  06490099
065900         WHEN DP020-SRC-AID = DP016-ENTER                         06500099
066000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06510099
066100             IF  PS-ERROR                                         06520099
066200                 CONTINUE                                         06530099
066300             ELSE                                                 06540099
066400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06550099
066500                 PERFORM 3200-RESET-ATTRIBUTES                    06560099
066600             END-IF                                               06570099
GH0407* PF22 WAS HIT (DCDETL2 - TRANSFER TO POKCS129)                   06580099
GH0407         WHEN DP020-FK-LOCAL-FUNC-03(DP020-SRC-AID)               06590099
GH0407           MOVE ASC-DC-NBR (9) TO PO011-LAST-DC-LOC-NBR           06600099
GH0407           MOVE PO011-PO-LNE-NBR TO PO011-LAST-PO-LNE-NBR         06601099
GH0407           MOVE ASC-BLK-SUB TO PO011-BLK-SUB                      06601199
GH0407           MOVE +7           TO PO011-ITEM-SUB                    06620099
GH0407           MOVE ASC-HIGHEST-BLOCK-WRITTEN                         06623099
GH0407             TO PO011-BLOCK-NUMBER                                06624099
066930                                                                  06691299
066700* PF23 WAS HIT (SCROLL LEFT)                                      06691399
066800         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               06691499
066900           SUBTRACT +3 FROM ASC-DC-COUNTER                        06691599
066910           IF ASC-DC-COUNTER < 1                                  06691699
066911               MOVE PC-TSYMSG-00227 TO DP020-MSG-NUMBER           06691799
066912               SET DP020-MSG-INFORMATIONAL TO TRUE                06691899
066913               SET ASC-DISPLAY-QTY TO TRUE                        06691999
066914             IF ASC-DC-COUNTER < -2                               06692099
066915               ADD +3 TO ASC-DC-COUNTER                           06692199
066916             END-IF                                               06692299
066917           END-IF                                                 06692399
066918           MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM           06692499
066919           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   06692599
066920           PERFORM 3200-RESET-ATTRIBUTES                          06692699
066930                                                                  06692799
066940* PF24 WAS HIT (SCROLL RIGHT)                                     06692899
      * IF TENTH DC IS ADDED JUST INCREASE 7 TO 10 IN THIS PARAGRAPH    06692999
066941         WHEN DP020-FK-LOCAL-FUNC-02(DP020-SRC-AID)               06693099
066942         IF ASC-MORE-DC                                           06693199
066943           ADD +3 TO ASC-DC-COUNTER                               06693299
066946                                                                  06693399
066948           IF ASC-DC-COUNTER > 7                                  06693499
066949              SUBTRACT +3 FROM ASC-DC-COUNTER                     06693599
066951           END-IF                                                 06693699
066952                                                                  06694099
066954           IF ASC-DC-COUNTER = 7  AND ASC-DC-COUNTER-DC < 7       06695099
066955              SUBTRACT +3 FROM ASC-DC-COUNTER                     06695199
066956              MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER            06695299
066960              SET DP020-MSG-INFORMATIONAL TO TRUE                 06695399
066961            ELSE                                                  06695499
066962              IF ASC-DC-COUNTER = 7                               06695599
066963                MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER          06695699
066964                SET DP020-MSG-INFORMATIONAL TO TRUE               06695799
066965              END-IF                                              06695899
066966           END-IF                                                 06695999
066967                                                                  06696099
066968           SET ASC-DISPLAY-DC TO TRUE                             06696199
066969         ELSE                                                     06696299
066970              MOVE PC-TSYMSG-00228 TO DP020-MSG-NUMBER            06696399
066971              SET DP020-MSG-INFORMATIONAL TO TRUE                 06696499
066972         END-IF                                                   06696599
066973           MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM           06696699
066974           PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                   06696799
066975           PERFORM 3200-RESET-ATTRIBUTES                          06696899
066976                                                                  06696999
066977         WHEN OTHER                                               06697099
066978             SET DP013-NO-ROLLBACK                                06697199
066979                 DP013-XCTL-DISPLAY-RESTART                       06697299
066980                 DP013-CICS-ABEND  TO TRUE                        06697399
066990             MOVE '2100-CHECK-FUNCTION-KEY'                       06697499
067000                                   TO DP013-PARAGRAPH             06697599
067100             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06697699
067200                                   TO DP013-MESSAGE-TEXT (1)      06697799
067300             PERFORM DP013-0000-PROCESS-ABEND                     06697899
067400     END-EVALUATE.                                                06697999
067500*                                                                 06698099
067600*----------------------------------------------------------------*06699099
067700*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06700099
067800*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06710099
067900*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06720099
068000*    MESSAGE.                                                    *06730099
068100*----------------------------------------------------------------*06740099
068200                                                                  06750099
068300 2110-BROWSE-BACKWARD.                                            06760099
068400     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    06770099
068500         GIVING PV-TOP-ITEM.                                      06780099
068600*                                                                 06790099
068700     IF  ((PV-TOP-ITEM < +1)                                      06800099
068800       OR (PV-TOP-ITEM = +1))                                     06810099
068900         MOVE +1                   TO PV-TOP-ITEM                 06820099
069000*        -- TOP OF LIST --                                        06830099
069100         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            06840099
069200         SET DP020-MSG-INFORMATIONAL TO TRUE                      06850099
069300     END-IF.                                                      06860099
069400                                                                  06870099
069500 EJECT                                                            06880099
069600*----------------------------------------------------------------*06890099
069700*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *06900099
069800*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *06910099
069900*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *06920099
070000*----------------------------------------------------------------*06930099
070100                                                                  06940099
070200 2120-BROWSE-FORWARD.                                             06950099
070300                                                                  06960099
070400     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              06970099
070500         GIVING PV-TOP-ITEM.                                      06980099
070600     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   06990099
070700         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07000099
070800                                   TO PV-TOP-ITEM                 07010099
070900*        -- BOTTOM OF LIST --                                     07020099
071000         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07030099
071100         SET DP020-MSG-INFORMATIONAL                              07040099
071200                                   TO TRUE                        07050099
071300     ELSE                                                         07060099
071400         COMPUTE PV-BOTTOM-ITEM =                                 07070099
071500             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07080099
071600         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07090099
071700*            -- BOTTOM OF LIST --                                 07100099
071800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07110099
071900             SET DP020-MSG-INFORMATIONAL                          07120099
072000                                   TO TRUE                        07130099
072100         END-IF                                                   07140099
072200     END-IF.                                                      07150099
072300 EJECT                                                            07160099
072400*----------------------------------------------------------------*07170099
072500*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07180099
072600*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07190099
072700*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07200099
072800*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *07210099
072900*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07220099
073000*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07230099
073100*----------------------------------------------------------------*07240099
073200                                                                  07250099
073300 2130-CHECK-FOR-JUMP-BROWSE.                                      07260099
073400     SET PS-NO-ERROR               TO TRUE.                       07270099
073500     IF (ASC-START-ITEM-REQUEST = SPACE)                          07280099
073600         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            07290099
073700                                   TO PV-TOP-ITEM                 07300099
073800     ELSE                                                         07310099
073900         MOVE ASC-START-ITEM-REQUEST                              07320099
074000                                   TO DP010I-UNEDITED-FIELD       07330099
074100         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07340099
074200         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07350099
074300         SET DP010I-NEGATIVE-NOT-ALLOWED                          07360099
074400                                   TO TRUE                        07370099
264220         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07381099
264230                         USING DP010I-NUMERIC-EDIT-AREA           07382099
074600                                                                  07390099
074700         IF  NOT DP010I-ERROR-DETECTED                            07400099
074800             MOVE DP010I-NUMERIC-FIELD                            07410099
074900                                   TO  ASC-START-ITEM-REQUEST-N   07420099
075000             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07430099
075100                 IF  ASC-START-ITEM-REQUEST-N >                   07440099
075200                                          ASC-NUMBER-OF-ITEMS-READ07450099
075300                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07460099
075400                     COMPUTE PV-TOP-ITEM =                        07470099
075500                             ASC-NUMBER-OF-ITEMS-READ             07480099
075600                             - PC-ITEMS-PER-PANEL + 1             07490099
075700                     IF  PV-TOP-ITEM < +1                         07500099
075800                         MOVE +1   TO PV-TOP-ITEM                 07510099
075900                         MOVE PC-TSYMSG-00070                     07520099
076000                                   TO DP020-MSG-NUMBER            07530099
076100                         SET DP020-MSG-INFORMATIONAL              07540099
076200                                   TO TRUE                        07550099
076300                     END-IF                                       07560099
076400                 ELSE                                             07570099
076500                     MOVE ASC-START-ITEM-REQUEST-N                07580099
076600                                   TO PV-TOP-ITEM                 07590099
076700                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07600099
076800                     COMPUTE PV-BOTTOM-ITEM =                     07610099
076900                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07620099
077000                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07630099
077100*                        -- BOTTOM OF LIST --                     07640099
077200                         MOVE PC-TSYMSG-00070                     07650099
077300                                   TO DP020-MSG-NUMBER            07660099
077400                         SET DP020-MSG-INFORMATIONAL              07670099
077500                                   TO TRUE                        07680099
077600                     END-IF                                       07690099
077700                 END-IF                                           07700099
077800             ELSE                                                 07710099
077900*                --- VALUE OUT OF RANGE ----                      07720099
078000                 MOVE PC-TSYMSG-00101                             07730099
078100                                   TO DP020-MSG-NUMBER            07740099
078200                 MOVE -1           TO ASTRTITL                    07750099
078300                 SET DP030-SET-CURSOR-APPL-1                      07760099
078400                                   TO TRUE                        07770099
078500                 MOVE DP015-REVERSE                               07780099
078600                                   TO ASTRTITH                    07790099
078700                 MOVE DP015-RED    TO ASTRTITC                    07800099
078800                 MOVE DP015-UNP-NUM-BRT-MDT                       07810099
078900                                   TO ASTRTITA                    07820099
079000                 SET DP020-MSG-FATAL                              07830099
079100                                   TO TRUE                        07840099
079200                 SET PS-ERROR      TO TRUE                        07850099
079300             END-IF                                               07860099
079400                                                                  07870099
079500         ELSE                                                     07880099
079600             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07890099
079700             MOVE -1               TO ASTRTITL                    07900099
079800             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07910099
079900             MOVE DP015-REVERSE    TO ASTRTITH                    07920099
080000             MOVE DP015-RED        TO ASTRTITC                    07930099
080100             MOVE DP015-UNP-NUM-BRT-MDT                           07940099
080200                                   TO ASTRTITA                    07950099
080300             SET DP020-MSG-FATAL   TO TRUE                        07960099
080400             SET PS-ERROR          TO TRUE                        07970099
080500         END-IF                                                   07980099
080600     END-IF.                                                      07990099
080700 EJECT                                                            08000099
080800******************************************************************08010099
080900** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **08020099
081000** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **08030099
081100******************************************************************08040099
081200 2200-MOVE-SCREEN-TO-COMMAREA.                                    08050099
081300                                                                  08060099
081400     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             08070099
081500     MOVE +1                       TO PV-SUB.                     08080099
081600*                                                                 08090099
081700     PERFORM 3100-SET-SUBSCRIPTS.                                 08100099
081800     IF  ASTRTITL > ZERO                                          08110099
081900         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          08120099
082000     ELSE                                                         08130099
082100         IF  ASTRTITF = DP015-ERASE-EOF                           08140099
082200             INITIALIZE ASC-START-ITEM-REQUEST                    08150099
082300         END-IF                                                   08160099
082400     END-IF.                                                      08170099
082500*    PERFORM 2210-MOVE-LINES-TO-COMMAREA                          08180099
082600*        VARYING PV-SUB                                           08190099
082700*        FROM 1 BY 1                                              08200099
082800*        UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      08210099
082900*                                                                 08220099
083000*2210-MOVE-LINES-TO-COMMAREA.                                     08230099
083100*    IF  MR-SELECTL (PV-SUB) > ZERO                               08240099
083200*        SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE             08250099
083300*        MOVE MR-SELECTI (PV-SUB)                                 08260099
083400*                                  TO ASC-TEMP-SELECTED-SW        08270099
083500*                                (ASC-BLK-SUB, ASC-ITEM-SUB)      08280099
083600*    ELSE                                                         08290099
083700*        IF  MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                08300099
083800*                SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB) TO TRUE     08310099
083900*                MOVE SPACE        TO ASC-TEMP-SELECTED-SW        08320099
084000*                                (ASC-BLK-SUB, ASC-ITEM-SUB)      08330099
084100*        END-IF                                                   08340099
084200*    END-IF.                                                      08350099
084300*    ADD +1                        TO ASC-ITEM-SUB.               08360099
084400*    IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        08370099
084500*        ADD +1                    TO ASC-BLK-SUB                 08380099
084600*        MOVE +1                   TO ASC-ITEM-SUB                08390099
084700*    END-IF.                                                      08400099
084800*                                                                 08410099
084900*----------------------------------------------------------------*08420099
085000*  EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE       *08430099
085100*  COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY).  *08440099
085200*----------------------------------------------------------------*08450099
085300 3000-EDIT-DATA-IN-COMMAREA.                                      08460099
085400                                                                  08470099
085401     SET PS-NO-ERROR               TO TRUE.                       08480099
085402                                                                  08490099
085403     PERFORM 3200-RESET-ATTRIBUTES.                               08500099
085404                                                                  08510099
085405     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     08520099
085406**                                                                08530099
085407* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              08540099
085408* EDITTING IS DONE FROM THE BOTTOM UP.                            08540199
085409**                                                                08540299
085410     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       08540399
085411         ASC-ITEMS-DISPLAYED - 1.                                 08540499
085412                                                                  08540599
085413     PERFORM 3100-SET-SUBSCRIPTS.                                 08540699
085414                                                                  08540799
085415                                                                  08540899
085416 3100-SET-SUBSCRIPTS.                                             08540999
085417                                                                  08541099
085418     COMPUTE ASC-ITEM-SUB =                                       08541199
085419                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.08541299
085420                                                                  08541399
085430     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         08541499
085440         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            08541599
085450         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               08541699
085460     ELSE                                                         08541799
085470         MOVE +1 TO ASC-BLK-SUB.                                  08541899
085480                                                                  08541999
085490*----------------------------------------------------------------*08542099
085500*  RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.      *08543099
085600*----------------------------------------------------------------*08544099
085700                                                                  08545099
085800 3200-RESET-ATTRIBUTES.                                           08546099
085900                                                                  08547099
086000     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   08548099
086100     MOVE DP015-GREEN              TO ASTRTITC.                   08549099
086200     MOVE DP015-UNDERLINE          TO ASTRTITH.                   08550099
086300     MOVE -1                       TO ASTRTITL.                   08560099
086400     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       08570099
086420                                                                  08580099
086430*----------------------------------------------------------------*08590099
086440*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *08600099
086450*    INITIALIZE ALL COUNTERS AND FLAGS.                          *08610099
086460*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *08620099
086470*    DISPLAY THE PANEL TO USER.                                  *08630099
086480*----------------------------------------------------------------*08640099
086490                                                                  08641099
086500 4000-BUILD-INITIAL-PANEL.                                        08642099
086600                                                                  08643099
086700     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            08644099
086800                                 ASC-BLOCK-ENTRIES (2).           08645099
086900     MOVE +1                 TO ASC-BLK-SUB.                      08646099
087000* THIS IS TO ENSURE THAT WE START WITH DC-COUNTER = 1 WHEN        08647099
087100* DISPLAYING DC SCREENS.                                          08648099
087200     MOVE -2 TO ASC-DC-COUNTER.                                   08649099
087300     SET ASC-ITEMS-LEFT-ON-DB                                     08650099
087400                             TO TRUE.                             08660099
087500     SET ASC-DISPLAY-QTY TO TRUE.                                 08670099
087600                                                                  08680099
087700     MOVE +0                 TO ASC-ITEM-SUB                      08690099
087800                                ASC-NUMBER-OF-ITEMS-READ          08700099
087900                                ASC-HIGHEST-BLOCK-WRITTEN         08710099
088100                                ASC-ITEM-AT-TOP-OF-PANEL.         08720099
088200                                                                  08730099
088300     PERFORM 4005-GET-HEADER-FIELDS.                              08740099
088400                                                                  08750099
088500     PERFORM 4010-OPEN-CURSOR.                                    08760099
088600                                                                  08770099
088700     PERFORM 4300-READ-ITEMS-FROM-DB.                             08780099
088800                                                                  08790099
088900     PERFORM 4020-CLOSE-CURSOR.                                   08800099
089000                                                                  08810099
089100     PERFORM 4050-GET-PO-TOTALS.                                  08820099
089200                                                                  08830099
089300     MOVE +1                   TO  PV-TOP-ITEM.                   08840099
089400     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          08850099
089500         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    08860099
089600         SET DP020-MSG-FATAL   TO  TRUE                           08870099
089700         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               08880099
089800     ELSE                                                         08890099
089900         SET DP030-SET-CURSOR-APPL-1                              08900099
090000                               TO TRUE                            08910099
090100         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     08920099
090200     END-IF.                                                      08930099
090300 EJECT                                                            08940099
090400*----------------------------------------------------------------*08950099
090500* OPEN THE DC CURSOR                                             *08960099
090600*----------------------------------------------------------------*08970099
090700 4010-OPEN-DC-CSR.                                                08980099
090800                                                                  08990099
090900     PERFORM                                                      09000099
091000         WITH TEST AFTER                                          09010099
091100         VARYING PV-RETRY-COUNTER                                 09020099
091101         FROM 1 BY 1                                              09030099
091102         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09040099
091103                   OR (SQLCODE = ZERO))                           09050099
091104                                                                  09060099
091105                 EXEC SQL                                         09070099
091106                      OPEN DC-CSR                                 09080099
091107                 END-EXEC                                         09090099
091108                                                                  09100099
091109         EVALUATE TRUE                                            09110099
091110             WHEN SQLCODE = ZERO                                  09111099
091111             WHEN SQLCODE = -904                                  09111199
091112             WHEN SQLCODE = -913                                  09111299
091113                 CONTINUE                                         09111399
091114             WHEN SQLWARN0 NOT = SPACES                           09111499
091115             WHEN SQLCODE < ZERO                                  09111599
091116             WHEN SQLCODE > ZERO                                  09111699
091117                 MOVE '4010-OPEN-DC-CURSOR'                       09111799
091118                                   TO DP013-PARAGRAPH             09111899
091119                 MOVE 'OPEN DC CURSOR - '                         09111999
091120                                   TO DP013-MESSAGE-TEXT (1)      09112099
091121                 MOVE SQLCA        TO DP013-SQLCA                 09112199
091122                 MOVE 'XMT_LOC '   TO DP013-DB2-TABLE-NAME (1)    09112299
091123                 SET DP013-DB2-ABEND                              09112399
091124                     DP013-XCTL-DISPLAY-RESTART TO TRUE           09112499
091125                 PERFORM DP013-0000-PROCESS-ABEND                 09112599
091126         END-EVALUATE                                             09112699
091127     END-PERFORM.                                                 09112799
091128                                                                  09112899
091129     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09112999
091130         MOVE '4010-OPEN-DC-CSR'   TO DP013-PARAGRAPH             09113099
091131         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   09113199
091132                                   TO DP013-MESSAGE-TEXT (1)      09113299
091133         MOVE SQLCA                TO DP013-SQLCA                 09113399
091134         MOVE 'XMT_LOC '           TO DP013-DB2-TABLE-NAME (1)    09113499
091135         SET DP013-DB2-ABEND                                      09113599
091136             DP013-XCTL-DISPLAY-RESTART                           09113699
091137                                   TO TRUE                        09113799
091138         PERFORM DP013-0000-PROCESS-ABEND                         09113899
091139     END-IF.                                                      09113999
091140                                                                  09114099
091141                                                                  09114199
091142*----------------------------------------------------------------*09114299
091143* PROCESS THE DC CURSOR                                          *09114399
091144*----------------------------------------------------------------*09114499
091145                                                                  09114599
091146 4015-PROCESS-DC-CSR.                                             09114699
091147                                                                  09114799
091148     PERFORM VARYING PV-DC-COUNT                                  09114899
091149        FROM 1 BY 1                                               09114999
091150       UNTIL PS-END-OF-DC OR PS-TABLE-OVERFLOW                    09115099
091151                                                                  09115199
091152           PERFORM 4016-FETCH-DC-CSR                              09115299
091153           IF PS-END-OF-DC                                        09115399
091154               CONTINUE                                           09115499
091155           ELSE                                                   09115599
091156* IF WE HAVE MORE THAN 10 DIST CENTERS, BUMP THE NUMBER UP FROM   09115699
091157* 10 TO THE NUMBER OF OCCURS IN THE ASC-DC-TABLE.                 09115799
091158               IF PV-DC-COUNT > 10                                09115899
091159                   SET PS-TABLE-OVERFLOW TO TRUE                  09115999
091160               ELSE                                               09116099
091161                   ADD +1 TO ASC-DC-COUNTER-DC                    09116199
091162                   MOVE XMT00001-LOC-NBR                          09116299
091163                     TO ASC-DC-NBR (PV-DC-COUNT)                  09116399
091164                   MOVE XMT00001-LOC-5-ABBR-NM                    09116499
091165                     TO ASC-DC-NAME (PV-DC-COUNT)                 09116599
091166               END-IF                                             09116699
091167           END-IF                                                 09116799
091173     END-PERFORM.                                                 09116899
091175           IF ASC-DC-COUNTER-DC > 0                               09116999
091176            SET ASC-MORE-DC TO TRUE                               09117099
091177           ELSE                                                   09117199
091178            SET ASC-NO-MORE-DC TO TRUE                            09117299
091179           END-IF.                                                09117399
091180                                                                  09117499
091181*----------------------------------------------------------------*09117599
091182*    FETCH THE DC CURSOR                                         *09117699
091183*----------------------------------------------------------------*09117799
091184                                                                  09117899
091185 4016-FETCH-DC-CSR.                                               09117999
091186                                                                  09118099
091187     EXEC SQL                                                     09118199
091188          FETCH DC-CSR                                            09118299
091189          INTO  :XMT00001-LOC-NBR,                                09118399
091190                :XMT00001-LOC-5-ABBR-NM                           09118499
091191     END-EXEC.                                                    09118599
091192                                                                  09118699
091193     EVALUATE TRUE                                                09118799
091194         WHEN SQLCODE = ZERO                                      09118899
091195              CONTINUE                                            09118999
091196         WHEN SQLCODE = +100                                      09119099
091197              SET PS-END-OF-DC TO TRUE                            09119199
091198         WHEN SQLWARN0 NOT = SPACE                                09119299
091199         WHEN SQLCODE NOT = ZERO                                  09119399
091200              MOVE '4016-FETCH-DC-CSR'                            09119499
091201                                   TO DP013-PARAGRAPH             09119599
091202              MOVE 'FETCH DC CURSOR'                              09119699
091203                                   TO DP013-MESSAGE-TEXT (1)      09119799
091204              MOVE SQLCA           TO DP013-SQLCA                 09119899
091205              SET DP013-DB2-ABEND                                 09119999
091206                                   TO TRUE                        09120099
091207              PERFORM DP013-0000-PROCESS-ABEND                    09120199
091208     END-EVALUATE.                                                09120299
091209                                                                  09120399
091210*----------------------------------------------------------------*09120499
091211* CLOSE THE DC CURSOR                                            *09120599
091212*----------------------------------------------------------------*09120699
091213 4020-CLOSE-DC-CSR.                                               09120799
091214                                                                  09120899
091215     EXEC SQL                                                     09120999
091216         CLOSE DC-CSR                                             09121099
091217     END-EXEC.                                                    09121199
091218                                                                  09121299
091219     EVALUATE TRUE                                                09121399
091220         WHEN SQLCODE = ZERO                                      09121499
091221             CONTINUE                                             09121599
091222         WHEN SQLWARN0 NOT = SPACES                               09121699
091223         WHEN SQLCODE < ZERO                                      09121799
091224         WHEN SQLCODE > ZERO                                      09121899
091225             MOVE '4020-CLOSE-DC-CSR'                             09121999
091226                                   TO DP013-PARAGRAPH             09122099
091227             MOVE 'CLOSE DC CURSOR '                              09122199
091228                                   TO DP013-MESSAGE-TEXT (1)      09122299
091229             MOVE SQLCA            TO DP013-SQLCA                 09122399
091230             MOVE 'XMT_LOC '       TO DP013-DB2-TABLE-NAME (1)    09122499
091231             SET DP013-DB2-ABEND                                  09122599
091232                 DP013-XCTL-DISPLAY-RESTART TO TRUE               09122699
091233             PERFORM DP013-0000-PROCESS-ABEND                     09122799
091234     END-EVALUATE.                                                09122899
091235                                                                  09122999
091236*----------------------------------------------------------------*09123099
091237* FORMAT THE HEADER FIELDS ON THE SCREEN.                        *09123199
091240*----------------------------------------------------------------*09123299
091250 4005-GET-HEADER-FIELDS.                                          09123399
091260     PERFORM                                                      09123499
091270         WITH TEST AFTER                                          09123599
091280         VARYING PV-RETRY-COUNTER                                 09123699
091290         FROM 1 BY 1                                              09123799
091300         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09123899
091400                   OR (SQLCODE = ZERO))                           09123999
091500         EXEC SQL                                                 09124099
091600             SELECT A.DEPT_NBR,                                   09125099
091700                    B.ENT_NAME_DESC                               09126099
091800               INTO :PURCHS-DEPT-NBR,                             09127099
091900                    :ENTNME-ENT-NAME-DESC                         09128099
092000               FROM TPURCHS A,                                    09129099
092100                    TENTNME B                                     09130099
092200              WHERE                                               09140099
092300                    A.PO_NBR = :DK-PO-NUMBER                      09150099
092400                AND A.VER_STATUS_CDE = 'A'                        09160099
092500                AND (A.ENT_ID = B.ENT_ID                          09170099
092600                AND  B.TYPE_CDE = '01')                           09180099
092700         END-EXEC                                                 09190099
092800                                                                  09200099
092900         EVALUATE TRUE                                            09210099
093000             WHEN SQLCODE = ZERO                                  09220099
093100                 MOVE PURCHS-DEPT-NBR      TO ASC-KEY-DEPT        09230099
093200                 MOVE ENTNME-ENT-NAME-DESC TO ASC-KEY-VENDOR      09240099
093300             WHEN SQLCODE = -904                                  09250099
093400             WHEN SQLCODE = -913                                  09260099
093500                 CONTINUE                                         09270099
093600             WHEN SQLWARN0 NOT = SPACES                           09280099
093700             WHEN SQLCODE < ZERO                                  09290099
093800             WHEN SQLCODE > ZERO                                  09300099
093900                 MOVE '4005-GET-HEADER'                           09310099
094000                                   TO DP013-PARAGRAPH             09320099
094100                 MOVE 'RETRIEVING HDR FIELDS'                     09330099
094200                                   TO DP013-MESSAGE-TEXT (1)      09340099
094300                 MOVE SQLCA        TO DP013-SQLCA                 09350099
094400                 MOVE 'TPURCHS '   TO DP013-DB2-TABLE-NAME (1)    09360099
094500                 SET DP013-DB2-ABEND                              09370099
094600                     DP013-XCTL-DISPLAY-RESTART TO TRUE           09380099
094700                 PERFORM DP013-0000-PROCESS-ABEND                 09390099
094800         END-EVALUATE                                             09400099
094900     END-PERFORM.                                                 09410099
095000*                                                                 09420099
095100     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09430099
095200         MOVE '4005-GET-HEADER-FIELDS' TO DP013-PARAGRAPH         09440099
095300         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   09450099
095400                                   TO DP013-MESSAGE-TEXT (1)      09460099
095500         MOVE SQLCA                TO DP013-SQLCA                 09470099
095600         MOVE 'TPURCHS '           TO DP013-DB2-TABLE-NAME (1)    09480099
095700         MOVE 'TENTNME '           TO DP013-DB2-TABLE-NAME (2)    09490099
095800         SET DP013-DB2-ABEND                                      09500099
095900             DP013-XCTL-DISPLAY-RESTART                           09510099
096000                                   TO TRUE                        09520099
096100         PERFORM DP013-0000-PROCESS-ABEND                         09530099
096200     END-IF.                                                      09540099
096300                                                                  09550099
096400*----------------------------------------------------------------*09560099
096500* OPEN THE TMESSAGE CURSOR.                                      *09570099
096600*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *09580099
096700*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *09590099
096800*   USER.                                                        *09600099
096900*----------------------------------------------------------------*09610099
097000                                                                  09620099
097100 4010-OPEN-CURSOR.                                                09630099
W24803     MOVE DK-PO-NUMBER  TO  PURCHS-PO-NBR                         09631099
097200     PERFORM                                                      09632099
097300         WITH TEST AFTER                                          09633099
097400         VARYING PV-RETRY-COUNTER                                 09634099
097500         FROM 1 BY 1                                              09635099
097600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               09636099
097700                   OR (SQLCODE = ZERO))                           09637099
097800                 MOVE 'CURSOR:  LINE-CURSOR1'                     09638099
097900                                   TO DP013-MESSAGE-TEXT (2)      09639099
098000         EXEC SQL                                                 09640099
098100              OPEN LINE-CSR1                                      09650099
098200         END-EXEC                                                 09660099
098300                                                                  09670099
098400         EVALUATE TRUE                                            09680099
098500             WHEN SQLCODE = ZERO                                  09690099
098600             WHEN SQLCODE = -904                                  09700099
098700             WHEN SQLCODE = -913                                  09710099
098800                 CONTINUE                                         09720099
098900             WHEN SQLWARN0 NOT = SPACES                           09730099
099000             WHEN SQLCODE < ZERO                                  09740099
099100             WHEN SQLCODE > ZERO                                  09750099
099200                 MOVE '4010-OPEN-CURSOR'                          09760099
099300                                   TO DP013-PARAGRAPH             09770099
099400                 MOVE 'OPEN LINE CURSOR - '                       09780099
099500                                   TO DP013-MESSAGE-TEXT (1)      09790099
099600                 MOVE SQLCA        TO DP013-SQLCA                 09800099
099700                 MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (1)    09810099
099800                 SET DP013-DB2-ABEND                              09820099
099900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           09830099
100000                 PERFORM DP013-0000-PROCESS-ABEND                 09840099
100100         END-EVALUATE                                             09850099
100200     END-PERFORM.                                                 09860099
100300*                                                                 09870099
100400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        09880099
100500         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             09890099
100600         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   09900099
100700                                   TO DP013-MESSAGE-TEXT (1)      09910099
100800         MOVE SQLCA                TO DP013-SQLCA                 09920099
100900         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    09930099
101000         SET DP013-DB2-ABEND                                      09940099
101100             DP013-XCTL-DISPLAY-RESTART                           09950099
101200                                   TO TRUE                        09960099
101300         PERFORM DP013-0000-PROCESS-ABEND                         09970099
101400     END-IF.                                                      09980099
101500                                                                  09990099
101600 EJECT                                                            10000099
101700*----------------------------------------------------------------*10010099
101800* CLOSE THE LINE CURSOR.                                         *10020099
101900*----------------------------------------------------------------*10030099
102000 4020-CLOSE-CURSOR.                                               10040099
102100     EXEC SQL                                                     10050099
102200          CLOSE LINE-CSR1                                         10060099
102300     END-EXEC                                                     10070099
102400                                                                  10080099
102500*                                                                 10090099
102600     EVALUATE TRUE                                                10100099
102700         WHEN SQLCODE = ZERO                                      10110099
102800             CONTINUE                                             10120099
102900         WHEN SQLWARN0 NOT = SPACES                               10130099
103000         WHEN SQLCODE < ZERO                                      10140099
103100         WHEN SQLCODE > ZERO                                      10150099
103200             MOVE '4020-CLOSE-CURSOR'                             10160099
103300                               TO DP013-PARAGRAPH                 10170099
103400             MOVE 'CLOSE LINE CURSOR '                            10180099
103500                               TO DP013-MESSAGE-TEXT (1)          10190099
103600             MOVE SQLCA        TO DP013-SQLCA                     10200099
103700             MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (1)        10210099
103800             SET DP013-DB2-ABEND                                  10220099
103900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10230099
104000             PERFORM DP013-0000-PROCESS-ABEND                     10240099
104100     END-EVALUATE.                                                10250099
104200                                                                  10260099
104300*----------------------------------------------------------------*10270099
104400* GET THE PO TOTALS.                                             *10280099
104500*----------------------------------------------------------------*10290099
104600 4050-GET-PO-TOTALS.                                              10300099
104700                                                                  10310099
104820     MOVE PURCHS-TOT-UNT-QTY     TO ASC-TOT-ORD.                  10320099
104900     MOVE PV-END-QTY-REC         TO ASC-TOT-REC.                  10330099
105000                                                                  10340099
105100     IF ASC-TOT-REC = 0 OR ASC-TOT-ORD = 0                        10350099
105200         MOVE ZEROES TO ASC-TOT-PCT-N                             10360099
105300         MOVE SPACES TO ASC-TOT-PCT-SIGN                          10370099
105400     ELSE                                                         10380099
105500         COMPUTE PV-TOT-REC-PCT                                   10390099
105510         ROUNDED =                                                10400099
105600                 (ASC-TOT-REC / ASC-TOT-ORD)                      10410099
105610         COMPUTE PV-TOT-REC-PCT =                                 10420099
105620                 PV-TOT-REC-PCT * 100                             10430099
105700         MOVE PC-PCT         TO ASC-TOT-PCT-SIGN                  10440099
105800         IF PV-TOT-REC-PCT = ZERO AND ASC-TOT-REC > ZERO          10450099
105801             MOVE 1 TO ASC-TOT-PCT-N                              10460099
105802         ELSE                                                     10470099
105803             MOVE PV-TOT-REC-PCT TO ASC-TOT-PCT-N                 10480099
105804         END-IF                                                   10490099
105805     END-IF.                                                      10500099
105806                                                                  10510099
105807     SET ASC-NOT-DC-END TO TRUE.                                  10520099
105808     PERFORM VARYING PV-DC-COUNT                                  10530099
105809       FROM 1 BY 1                                                10540099
105810        UNTIL ASC-DC-END                                          10550099
105820                                                                  10560099
105830     MOVE ASC-DC-NBR(PV-DC-COUNT) TO PC-DCX                       10570099
105840     PERFORM 4060-GET-PO-DC-ORD                                   10580099
105850     MOVE PV-DC-ORD-QTY        TO ASC-TOT-DC-ORD(PV-DC-COUNT)     10580199
105860                                                                  10580299
105870     MOVE ASC-DC-NBR(PV-DC-COUNT) TO PC-DCX                       10580399
105880     PERFORM 4065-GET-PO-DC-REC                                   10580499
105890     MOVE PV-DC-REC-QTY        TO ASC-TOT-DC-REC(PV-DC-COUNT)     10580599
105900                                                                  10580699
106000     IF ASC-DC-NBR(PV-DC-COUNT) = 0                               10580799
106100        SET ASC-DC-END TO TRUE                                    10580899
106101     END-IF                                                       10580999
106102                                                                  10581099
106103     IF PV-DC-COUNT > 9                                           10582099
106104        SET ASC-DC-END TO TRUE                                    10583099
106105     END-IF                                                       10584099
106106     END-PERFORM.                                                 10585099
106107                                                                  10586099
106108*----------------------------------------------------------------*10587099
106109* RETRIEVE THE ORDER QUANTITY FOR A DC.                          *10588099
106110*----------------------------------------------------------------*10589099
106120 4060-GET-PO-DC-ORD.                                              10590099
106130                                                                  10600099
106140     MOVE +0                       TO PV-DC-ORD-QTY.              10610099
106150                                                                  10610199
106160     PERFORM                                                      10610299
106170         WITH TEST AFTER                                          10610399
106180         VARYING PV-RETRY-COUNTER                                 10610499
106190         FROM 1 BY 1                                              10610599
106200         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               10610699
106300                   OR (SQLCODE = ZERO)                            10610799
106400                   OR (SQLCODE = 100))                            10610899
106500         EXEC SQL                                                 10610999
106600             SELECT SUM(CURR_SPLIT_QTY)                           10611099
106700               INTO :PV-DC-ORD-QTY:PV-QTY-NULL                    10612099
106800               FROM TPURITM A,                                    10613099
106900                    TALLPLN B                                     10614099
107000              WHERE                                               10615099
107100                    A.PO_NBR         = :DK-PO-NUMBER              10616099
107200                AND A.VER_STATUS_CDE = 'A'                        10617099
107300                AND A.STATUS_CDE NOT IN ('CA')                    10618099
107400                AND A.PO_NBR         = B.PO_NBR                   10619099
107500                AND A.PO_LNE_NBR     = B.PO_LNE_NBR               10620099
107600                AND B.DEST_NBR       = :PC-DCX                    10630099
107700         END-EXEC                                                 10640099
107800                                                                  10650099
107900         EVALUATE TRUE                                            10660099
108000             WHEN SQLCODE = ZERO                                  10670099
108100                 CONTINUE                                         10680099
108200             WHEN SQLCODE = +100                                  10690099
108300                 CONTINUE                                         10700099
108400             WHEN SQLCODE = -904                                  10710099
108500             WHEN SQLCODE = -913                                  10720099
108600                 CONTINUE                                         10730099
108700             WHEN SQLWARN0 NOT = SPACES                           10740099
108800             WHEN SQLCODE < ZERO                                  10750099
108900             WHEN SQLCODE > ZERO                                  10760099
109000                 MOVE '4060-GET-PO-DC-ORD'                        10770099
109100                                   TO DP013-PARAGRAPH             10780099
109200                 MOVE 'RETRIEVING DC ORDER QTY'                   10790099
109300                                   TO DP013-MESSAGE-TEXT (1)      10800099
109400                 MOVE SQLCA        TO DP013-SQLCA                 10810099
109500                 MOVE 'TPURITM '   TO DP013-DB2-TABLE-NAME (1)    10820099
109600                 MOVE 'TALLPLN '   TO DP013-DB2-TABLE-NAME (2)    10830099
109700                 SET DP013-DB2-ABEND                              10840099
109800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           10850099
109900                 PERFORM DP013-0000-PROCESS-ABEND                 10860099
110000         END-EVALUATE                                             10870099
110100     END-PERFORM.                                                 10880099
110200*                                                                 10890099
110300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        10900099
110400         MOVE '4060-GET-PO-DC-ORD' TO DP013-PARAGRAPH             10910099
110500         MOVE 'MAXIMUM RETRIES EXCEEDED'                          10920099
110600                                   TO DP013-MESSAGE-TEXT (1)      10930099
110700         MOVE SQLCA                TO DP013-SQLCA                 10940099
110800         MOVE 'TPURITM '           TO DP013-DB2-TABLE-NAME (1)    10950099
110900         MOVE 'TALLPLN '           TO DP013-DB2-TABLE-NAME (2)    10960099
111000         SET DP013-DB2-ABEND                                      10970099
111100             DP013-XCTL-DISPLAY-RESTART                           10980099
111200                                   TO TRUE                        10990099
111300         PERFORM DP013-0000-PROCESS-ABEND                         11000099
111400     END-IF.                                                      11010099
111500                                                                  11020099
111600                                                                  11030099
111700 EJECT                                                            11040099
111800*----------------------------------------------------------------*11050099
111900* RETRIEVE THE RECEIVED QUANTITY FOR A DC.                       *11060099
112000*----------------------------------------------------------------*11070099
112100 4065-GET-PO-DC-REC.                                              11080099
112200                                                                  11090099
112300     MOVE +0                       TO PV-DC-REC-QTY.              11100099
112400                                                                  11110099
112500     PERFORM                                                      11120099
112600         WITH TEST AFTER                                          11130099
112700         VARYING PV-RETRY-COUNTER                                 11140099
112800         FROM 1 BY 1                                              11150099
112900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11160099
113000                   OR (SQLCODE = ZERO)                            11170099
113100                   OR (SQLCODE = 100))                            11180099
113200         EXEC SQL                                                 11190099
113300             SELECT SUM(AP_VERIFY_ITM_QTY)                        11200099
113400               INTO :PV-DC-REC-QTY:PV-QTY-NULL                    11210099
113500               FROM TRECITM A,                                    11220099
113600                    TRECDIS B                                     11230099
113700              WHERE                                               11240099
113800                    A.ORD_NBR        = :DK-PO-NUMBER              11250099
113900                AND A.VER_STATUS_CDE = 'A'                        11260099
114000                AND A.OPER_UNT_ID    = :PC-DCX                    11270099
114100                AND A.STATUS_CDE     = 'VE'                       11280099
114200                AND A.ORD_NBR        = B.ORD_NBR                  11290099
114300                AND A.ORD_LNE_NBR    = B.ORD_LNE_NBR              11300099
114400                AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR              11310099
114500                AND A.OPER_UNT_ID    = B.OPER_UNT_ID              11320099
114600                AND A.FCLTY_ID       = B.FCLTY_ID                 11330099
114700                AND B.VER_STATUS_CDE = 'A'                        11340099
114800         END-EXEC                                                 11350099
114900                                                                  11360099
115000         EVALUATE TRUE                                            11370099
115100             WHEN SQLCODE = ZERO                                  11380099
115200                 CONTINUE                                         11390099
115300             WHEN SQLCODE = +100                                  11400099
115400                 CONTINUE                                         11410099
115500             WHEN SQLCODE = -904                                  11420099
115600             WHEN SQLCODE = -913                                  11430099
115700                 CONTINUE                                         11440099
115800             WHEN SQLWARN0 NOT = SPACES                           11450099
115900             WHEN SQLCODE < ZERO                                  11460099
116000             WHEN SQLCODE > ZERO                                  11470099
116100                 MOVE '4065-GET-PO-DC-REC'                        11480099
116200                                   TO DP013-PARAGRAPH             11490099
116300                 MOVE 'RETRIEVING RECEIVED QTY'                   11500099
116400                                   TO DP013-MESSAGE-TEXT (1)      11510099
116500                 MOVE SQLCA        TO DP013-SQLCA                 11520099
116600                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    11530099
116700                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (2)    11540099
116800                 SET DP013-DB2-ABEND                              11550099
116900                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11560099
117000                 PERFORM DP013-0000-PROCESS-ABEND                 11570099
117100         END-EVALUATE                                             11580099
117200     END-PERFORM.                                                 11590099
117300*                                                                 11600099
117400     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        11610099
117500         MOVE '4065-GET-PO-DC-REC'  TO DP013-PARAGRAPH            11620099
117600         MOVE 'MAXIMUM RETRIES EXCEEDED'                          11630099
117700                                   TO DP013-MESSAGE-TEXT (1)      11640099
117800         MOVE SQLCA                TO DP013-SQLCA                 11650099
117900         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    11660099
118000         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (2)    11670099
118100         SET DP013-DB2-ABEND                                      11680099
118200             DP013-XCTL-DISPLAY-RESTART                           11690099
118300                                   TO TRUE                        11700099
118400         PERFORM DP013-0000-PROCESS-ABEND                         11710099
118500     END-IF.                                                      11720099
118600*----------------------------------------------------------------*11730099
118700*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *11740099
118800*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *11750099
118900*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *11760099
119000*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *11770099
119100*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *11780099
119200*                                                                *11790099
119300*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *11800099
119400*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *11810099
119500*    UPON INITIALIZATION.                                        *11820099
119600*----------------------------------------------------------------*11830099
119700                                                                  11840099
119800 4300-READ-ITEMS-FROM-DB.                                         11850099
119900                                                                  11860099
120000     PERFORM                                                      11870099
120100         VARYING PV-READ-COUNT                                    11880099
120200         FROM 1 BY 1                                              11890099
120300         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    11900099
120400            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         11910099
120500                                                                  11920099
120600         PERFORM 4310-FETCH                                       11930099
120700                                                                  11940099
120800         IF  ASC-ITEMS-LEFT-ON-DB                                 11950099
120900             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                11960099
121000                 ADD +1            TO ASC-ITEM-SUB                11970099
121100             ELSE                                                 11980099
121200                 ADD +1            TO ASC-BLK-SUB                 11990099
121300                 MOVE +1           TO ASC-ITEM-SUB                12000099
121400                                                                  12010099
121500                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         12020099
121600                     MOVE +1       TO ASC-BLK-SUB                 12030099
121700                     SET ASC-BLOCK-MODIFIED (1)                   12040099
121800                                   TO TRUE                        12050099
121900                     PERFORM 5100-WRITE-TEMP-STORAGE              12060099
122000                     MOVE ASC-BLOCK-ENTRIES                       12070099
122100                               (PC-MAX-BLOCKS-IN-ARRAY)           12080099
122200                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 12090099
122300                     ADD +1        TO ASC-BLK-SUB                 12100099
122400                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   12110099
122500                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      12120099
122600                                   TO TRUE                        12130099
122700                 END-IF                                           12140099
122800             END-IF                                               12150099
122900             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    12160099
123000             MOVE ASC-NUMBER-OF-ITEMS-READ TO                     12170099
123100                   ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB)12180099
123200             IF PURCHS-STATUS-CDE = 'FE' OR 'WK' OR 'PA' OR 'RJ'  12190099
123300                 MOVE PURITM-PO-LNE-NBR                           12200099
123400                                   TO ASC-LINE                    12210099
123500                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12220099
123600             ELSE                                                 12230099
123700                 MOVE PURITM-APP-PO-LNE-NBR                       12240099
123800                                   TO ASC-LINE                    12250099
123900                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12260099
124000             END-IF                                               12270099
W24803             IF PV-SKU-NBR-IND = +0                               12280099
W24803               MOVE XLT00004-MAJ-CL-NBR TO ASC-MCL                12290099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12300099
W24803               MOVE XLT00004-SUB-CL-NBR TO ASC-SCL                12310099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12320099
W24803               MOVE XLT00003-SKU-NBR    TO ASC-SKU                12330099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12340099
W24803               MOVE XLT00003-SKU-DESC   TO ASC-DESC               12350099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12360099
W24803             ELSE                                                 12370099
W24803               MOVE ASC-KEY-DEPT        TO PV-TEMP-SKU-DEPT       12380099
W24803               MOVE PURITM-CL-NBR       TO ASC-SCL                12390099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12400099
W24803                                           PV-TEMP-SKU-CLASS      12410099
W24803               MOVE PURITM-SKU-SEQ-NBR  TO PV-TEMP-SKU-SEQ        12420099
W24803               MOVE PURITM-CL-NBR (1:1) TO PV-MAJ-CL-1            12430099
W24803               MOVE PV-MAJ-CLASS        TO ASC-MCL                12440099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12441099
W24803               MOVE PV-SKU-NBR          TO ASC-SKU                12442099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12443099
W24803               MOVE PURITM-SKU-DESC     TO ASC-DESC               12444099
W24803                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12445099
W24803             END-IF                                               12446099
125000             MOVE PURITM-UNT-QTY                                  12447099
125100                               TO ASC-QTY                         12448099
125200                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12449099
125300     SET ASC-NOT-DC-END TO TRUE                                   12450099
125400     PERFORM VARYING PV-DC-COUNT                                  12460099
125500       FROM 1 BY 1                                                12470099
125600        UNTIL ASC-DC-END                                          12480099
125700                                                                  12490099
125800     MOVE ASC-DC-NBR(PV-DC-COUNT) TO PC-DCX                       12500099
125900     PERFORM 4320-GET-DC-SPLIT                                    12510099
126000     MOVE PV-DC-SPLIT-QTY TO                                      12520099
126100                  ASC-DC(ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)    12530099
126200                                                                  12540099
126300     MOVE ASC-DC-NBR(PV-DC-COUNT) TO PC-DCX                       12550099
126400     PERFORM 4330-GET-DC-REC                                      12560099
126500     MOVE PV-DC-REC-QTY TO                                        12570099
126600                  ASC-REC-DC(ASC-BLK-SUB ASC-ITEM-SUB PV-DC-COUNT)12580099
126700     IF ASC-DC-NBR(PV-DC-COUNT) = 0                               12590099
126800* NO MORE DCS, GET OUT OF LOOP.                                   12600099
126900        SET ASC-DC-END TO TRUE                                    12610099
127000     END-IF                                                       12620099
127100                                                                  12630099
127200     IF PV-DC-COUNT >  9                                          12640099
127300        SET ASC-DC-END TO TRUE                                    12650099
127400     END-IF                                                       12660099
127500     END-PERFORM                                                  12670099
127600                                                                  12680099
127900             MOVE PURITM-STATUS-CDE      TO                       12690099
128000                      ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)       12700099
128100             PERFORM 4360-GET-TOT-REC                             12710099
128200             MOVE PV-TOT-REC-QTY                                  12720099
128300                               TO ASC-REC-QTY                     12730099
128400                                       (ASC-BLK-SUB ASC-ITEM-SUB) 12740099
128500             ADD PV-TOT-REC-QTY TO PV-END-QTY-REC                 12750099
128600                    GIVING PV-END-QTY-REC                         12760099
128700         IF ASC-QTY (ASC-BLK-SUB ASC-ITEM-SUB) = ZEROS            12770099
128800           MOVE ZEROS TO ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB)   12780099
128900         ELSE                                                     12790099
129000           COMPUTE ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB)         12800099
129100                    ROUNDED =                                     12810099
129200               (ASC-REC-QTY (ASC-BLK-SUB ASC-ITEM-SUB) /          12820099
129300               ASC-QTY    (ASC-BLK-SUB ASC-ITEM-SUB))             12830099
129330           COMPUTE ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB) =       12840099
129340               ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB) * 100       12850099
129400            IF ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB) = 0         12860099
129500           AND ASC-REC-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > 0         12870099
129600              MOVE 1 TO ASC-REC-PCT                               12880099
129700                           (ASC-BLK-SUB ASC-ITEM-SUB)             12890099
129800            END-IF                                                12900099
129900         END-IF                                                   12910099
130000      END-IF                                                      12920099
130100     END-PERFORM.                                                 12930099
130200                                                                  12940099
130300     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          12950099
130400         MOVE +1               TO ASC-BLK-SUB                     12960099
130500         PERFORM 5100-WRITE-TEMP-STORAGE                          12970099
130600         ADD +1                TO ASC-BLK-SUB                     12980099
130700         PERFORM 5100-WRITE-TEMP-STORAGE                          12990099
130800                                                                  13000099
130900         MOVE 1                TO ASC-BLK-SUB                     13010099
131000                                  PV-BLOCK-NUMBER                 13020099
131100         PERFORM 4410-READ-TEMP-STORAGE                           13030099
131200         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             13040099
131300             MOVE 2            TO ASC-BLK-SUB                     13050099
131400                                  PV-BLOCK-NUMBER                 13060099
131500             PERFORM 4410-READ-TEMP-STORAGE                       13070099
131600         END-IF                                                   13080099
131700     END-IF.                                                      13090099
131800 EJECT                                                            13100099
131900*----------------------------------------------------------------*13110099
132000*    FETCH THE MESSAGE CURSOR.                                   *13120099
132100*----------------------------------------------------------------*13130099
132200                                                                  13140099
132300 4310-FETCH.                                                      13150099
132400                                                                  13160099
132500     EXEC SQL                                                     13170099
132600          FETCH LINE-CSR1                                         13180099
132700                INTO  :PURCHS-PO-NBR                              13190099
132800                    , :PURCHS-TOT-UNT-QTY                         13200099
132900                    , :PURCHS-STATUS-CDE                          13210099
133000                    , :PURITM-STATUS-CDE                          13220099
133100                    , :PURITM-APP-PO-LNE-NBR                      13230099
133200                    , :PURITM-PO-LNE-NBR                          13240099
W24803                    , :XLT00004-MAJ-CL-NBR:PV-MAJ-CL-NBR-IND      13250099
W24803                    , :XLT00004-SUB-CL-NBR:PV-SUB-CL-NBR-IND      13260099
W24803                    , :XLT00003-SKU-NBR:PV-SKU-NBR-IND            13270099
W24803                    , :XLT00003-SKU-DESC:PV-SKU-DESC-IND          13280099
W24803                    , :PURITM-CL-NBR                              13290099
W24803                    , :PURITM-SKU-SEQ-NBR                         13300099
W24803                    , :PURITM-SKU-DESC                            13310099
133700                    , :PURITM-UNT-QTY                             13320099
133800     END-EXEC.                                                    13330099
133900                                                                  13340099
134000     EVALUATE TRUE                                                13350099
134100         WHEN SQLCODE = ZERO                                      13360099
134200         WHEN SQLCODE = +100                                      13370099
134300              CONTINUE                                            13380099
134400         WHEN SQLWARN0 NOT = SPACE                                13390099
134500         WHEN SQLCODE NOT = ZERO                                  13400099
134600              MOVE '4310-FETCH-CURSOR'                            13410099
134700                               TO DP013-PARAGRAPH                 13420099
134800              MOVE 'FETCH LINE CURSOR'                            13430099
134900                               TO DP013-MESSAGE-TEXT (1)          13440099
135000              MOVE SQLCA       TO DP013-SQLCA                     13450099
135100              SET DP013-DB2-ABEND                                 13460099
135200                               TO TRUE                            13470099
135300              PERFORM DP013-0000-PROCESS-ABEND                    13480099
135400     END-EVALUATE.                                                13490099
135500                                                                  13500099
135600     IF  SQLCODE EQUAL +100                                       13510099
135700         SET ASC-NO-ITEMS-LEFT-ON-DB                              13520099
135800                                   TO TRUE                        13530099
135900     END-IF.                                                      13540099
136000                                                                  13550099
136100 EJECT                                                            13560099
136200*----------------------------------------------------------------*13570099
136300* RETRIEVE THE ORDER QUANTITY FOR A DC. (LINE)                   *13580099
136400*----------------------------------------------------------------*13590099
136500 4320-GET-DC-SPLIT.                                               13600099
136600                                                                  13610099
136700     PERFORM                                                      13620099
136800         WITH TEST AFTER                                          13630099
136900         VARYING PV-RETRY-COUNTER                                 13640099
137000         FROM 1 BY 1                                              13650099
137100         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               13660099
137200                   OR (SQLCODE = ZERO)                            13670099
137300                   OR (SQLCODE = 100))                            13680099
137400         EXEC SQL                                                 13690099
137500             SELECT CURR_SPLIT_QTY                                13700099
137600               INTO :PV-DC-SPLIT-QTY                              13710099
137700               FROM TALLPLN                                       13720099
137800              WHERE                                               13730099
137900                    PO_NBR     = :DK-PO-NUMBER                    13740099
138000                AND PO_LNE_NBR = :PURITM-PO-LNE-NBR               13750099
138100                AND DEST_NBR   = :PC-DCX                          13760099
138200         END-EXEC                                                 13770099
138300                                                                  13780099
138400         EVALUATE TRUE                                            13790099
138500             WHEN SQLCODE = ZERO                                  13800099
138600                 CONTINUE                                         13810099
138700             WHEN SQLCODE = +100                                  13820099
138800                 MOVE +0         TO PV-DC-SPLIT-QTY               13830099
138900             WHEN SQLCODE = -904                                  13840099
139000             WHEN SQLCODE = -913                                  13850099
139100                 CONTINUE                                         13860099
139200             WHEN SQLWARN0 NOT = SPACES                           13870099
139300             WHEN SQLCODE < ZERO                                  13880099
139400             WHEN SQLCODE > ZERO                                  13890099
139500                 MOVE '4320-GET-DC-SPLIT'                         13900099
139600                                   TO DP013-PARAGRAPH             13910099
139700                 MOVE 'RETRIEVING TALLPLN'                        13920099
139800                                   TO DP013-MESSAGE-TEXT (1)      13930099
139900                 MOVE SQLCA        TO DP013-SQLCA                 13940099
140000                 MOVE 'TALLPLN '   TO DP013-DB2-TABLE-NAME (1)    13950099
140100                 SET DP013-DB2-ABEND                              13960099
140200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           13970099
140300                 PERFORM DP013-0000-PROCESS-ABEND                 13980099
140400         END-EVALUATE                                             13990099
140500     END-PERFORM.                                                 14000099
140600*                                                                 14010099
140700     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14020099
140800         MOVE '4320-GET-DC-SPLIT' TO DP013-PARAGRAPH              14030099
140900         MOVE 'MAXIMUM RETRIES EXCEEDED'                          14040099
141000                                   TO DP013-MESSAGE-TEXT (1)      14050099
141100         MOVE SQLCA                TO DP013-SQLCA                 14060099
141200         MOVE 'TALLPLN '           TO DP013-DB2-TABLE-NAME (1)    14070099
141300         SET DP013-DB2-ABEND                                      14080099
141400             DP013-XCTL-DISPLAY-RESTART                           14090099
141500                                   TO TRUE                        14100099
141600         PERFORM DP013-0000-PROCESS-ABEND                         14110099
141700     END-IF.                                                      14120099
141800*----------------------------------------------------------------*14130099
141900* RETRIEVE THE RECEIVED QUANTITY FOR A DC.(LINE)                 *14140099
142000*----------------------------------------------------------------*14150099
142100 4330-GET-DC-REC.                                                 14160099
142200                                                                  14170099
142300     MOVE +0                       TO PV-DC-REC-QTY.              14180099
142400                                                                  14190099
142500     PERFORM                                                      14200099
142600         WITH TEST AFTER                                          14210099
142700         VARYING PV-RETRY-COUNTER                                 14220099
142800         FROM 1 BY 1                                              14230099
142900         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14240099
143000                   OR (SQLCODE = ZERO)                            14250099
143100                   OR (SQLCODE = 100))                            14260099
143200         EXEC SQL                                                 14270099
143300             SELECT SUM(AP_VERIFY_ITM_QTY)                        14280099
143400               INTO :PV-DC-REC-QTY:PV-QTY-NULL                    14290099
143500               FROM TRECITM A,                                    14300099
143600                    TRECDIS B                                     14310099
143700              WHERE                                               14320099
143800                    A.ORD_NBR        = :DK-PO-NUMBER              14330099
143900                AND A.ORD_LNE_NBR    = :PURITM-APP-PO-LNE-NBR     14340099
144000                AND A.VER_STATUS_CDE = 'A'                        14350099
144100                AND A.OPER_UNT_ID    = :PC-DCX                    14360099
144200                AND A.STATUS_CDE     = 'VE'                       14370099
144300                AND A.ORD_NBR        = B.ORD_NBR                  14380099
144400                AND A.ORD_LNE_NBR    = B.ORD_LNE_NBR              14390099
144500                AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR              14400099
144600                AND A.OPER_UNT_ID    = B.OPER_UNT_ID              14410099
144700                AND A.FCLTY_ID       = B.FCLTY_ID                 14420099
144800                AND B.VER_STATUS_CDE = 'A'                        14430099
144900         END-EXEC                                                 14440099
145000                                                                  14450099
145100         EVALUATE TRUE                                            14460099
145200             WHEN SQLCODE = ZERO                                  14470099
145300                 CONTINUE                                         14480099
145400             WHEN SQLCODE = +100                                  14490099
145500                 CONTINUE                                         14500099
145600             WHEN SQLCODE = -904                                  14510099
145700             WHEN SQLCODE = -913                                  14520099
145800                 CONTINUE                                         14530099
145900             WHEN SQLWARN0 NOT = SPACES                           14540099
146000             WHEN SQLCODE < ZERO                                  14550099
146100             WHEN SQLCODE > ZERO                                  14560099
146200                 MOVE '4330-GET-DC-REC'                           14570099
146300                                   TO DP013-PARAGRAPH             14580099
146400                 MOVE 'RETRIEVING RECEIVED QTY'                   14590099
146500                                   TO DP013-MESSAGE-TEXT (1)      14600099
146600                 MOVE SQLCA        TO DP013-SQLCA                 14610099
146700                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    14620099
146800                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (2)    14630099
146900                 SET DP013-DB2-ABEND                              14640099
147000                     DP013-XCTL-DISPLAY-RESTART TO TRUE           14650099
147100                 PERFORM DP013-0000-PROCESS-ABEND                 14660099
147200         END-EVALUATE                                             14670099
147300     END-PERFORM.                                                 14680099
147400*                                                                 14690099
147500     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        14700099
147600         MOVE '4330-GET-DC-REC' TO DP013-PARAGRAPH                14710099
147700         MOVE 'MAXIMUM RETRIES EXCEEDED'                          14720099
147800                                   TO DP013-MESSAGE-TEXT (1)      14730099
147900         MOVE SQLCA                TO DP013-SQLCA                 14740099
148000         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    14750099
148100         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (2)    14760099
148200         SET DP013-DB2-ABEND                                      14770099
148300             DP013-XCTL-DISPLAY-RESTART                           14780099
148400                                   TO TRUE                        14790099
148500         PERFORM DP013-0000-PROCESS-ABEND                         14800099
148600     END-IF.                                                      14810099
148700*----------------------------------------------------------------*14820099
148800* RETRIEVE THE TOTAL RECEIVED QUANTITY. (LINE)                   *14830099
148900*----------------------------------------------------------------*14840099
149000 4360-GET-TOT-REC.                                                14850099
149100                                                                  14860099
149200     MOVE +0                     TO PV-TOT-REC-QTY.               14870099
149300                                                                  14880099
149400     PERFORM                                                      14890099
149500         WITH TEST AFTER                                          14900099
149600         VARYING PV-RETRY-COUNTER                                 14910099
149700         FROM 1 BY 1                                              14920099
149800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               14930099
149900                   OR (SQLCODE = ZERO)                            14940099
150000                   OR (SQLCODE = 100))                            14950099
150100         EXEC SQL                                                 14960099
150200             SELECT SUM(AP_VERIFY_ITM_QTY)                        14970099
150300               INTO :PV-TOT-REC-QTY:PV-QTY-NULL                   14980099
150400               FROM TRECITM A,                                    14990099
150500                    TRECDIS B                                     15000099
150600              WHERE                                               15010099
150700                    A.ORD_NBR        = :DK-PO-NUMBER              15020099
150800                AND A.ORD_LNE_NBR    = :PURITM-APP-PO-LNE-NBR     15030099
150900                AND A.VER_STATUS_CDE = 'A'                        15040099
151000                AND A.STATUS_CDE     = 'VE'                       15050099
151100                AND A.ORD_NBR        = B.ORD_NBR                  15060099
151200                AND A.ORD_LNE_NBR    = B.ORD_LNE_NBR              15070099
151300                AND A.REC_SEQ_NBR    = B.REC_SEQ_NBR              15080099
151400                AND A.OPER_UNT_ID    = B.OPER_UNT_ID              15090099
151500                AND A.FCLTY_ID       = B.FCLTY_ID                 15100099
151600                AND B.VER_STATUS_CDE = 'A'                        15110099
151700         END-EXEC                                                 15120099
151800                                                                  15130099
151900         EVALUATE TRUE                                            15140099
152000             WHEN SQLCODE = ZERO                                  15150099
152100                 CONTINUE                                         15160099
152200             WHEN SQLCODE = +100                                  15170099
152300                 MOVE +0         TO PV-TOT-REC-QTY                15180099
152400             WHEN SQLCODE = -904                                  15190099
152500             WHEN SQLCODE = -913                                  15200099
152600                 CONTINUE                                         15210099
152700             WHEN SQLWARN0 NOT = SPACES                           15220099
152800             WHEN SQLCODE < ZERO                                  15230099
152900             WHEN SQLCODE > ZERO                                  15240099
153000                 MOVE '4360-GET-TOT-REC'                          15250099
153100                                   TO DP013-PARAGRAPH             15260099
153200                 MOVE 'RETRIEVING RECEIVED QTY'                   15270099
153300                                   TO DP013-MESSAGE-TEXT (1)      15280099
153400                 MOVE SQLCA        TO DP013-SQLCA                 15290099
153500                 MOVE 'TRECITM '   TO DP013-DB2-TABLE-NAME (1)    15300099
153600                 MOVE 'TRECDIS '   TO DP013-DB2-TABLE-NAME (2)    15310099
153700                 SET DP013-DB2-ABEND                              15320099
153800                     DP013-XCTL-DISPLAY-RESTART TO TRUE           15330099
153900                 PERFORM DP013-0000-PROCESS-ABEND                 15340099
154000         END-EVALUATE                                             15350099
154100     END-PERFORM.                                                 15360099
154200*                                                                 15370099
154300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        15380099
154400         MOVE '4360-GET-TOT-REC'   TO DP013-PARAGRAPH             15390099
154500         MOVE 'MAXIMUM RETRIES EXCEEDED'                          15400099
154600                                   TO DP013-MESSAGE-TEXT (1)      15410099
154700         MOVE SQLCA                TO DP013-SQLCA                 15420099
154800         MOVE 'TRECITM '           TO DP013-DB2-TABLE-NAME (1)    15430099
154900         MOVE 'TRECDIS '           TO DP013-DB2-TABLE-NAME (2)    15440099
155000         SET DP013-DB2-ABEND                                      15450099
155100             DP013-XCTL-DISPLAY-RESTART                           15460099
155200                                   TO TRUE                        15470099
155300         PERFORM DP013-0000-PROCESS-ABEND                         15480099
155400     END-IF.                                                      15490099
155500*----------------------------------------------------------------*15500099
155600* MOVE THE DISPLAYED FIELDS FROM THE COMMAREA TO THE SCREEN.     *15510099
155700*----------------------------------------------------------------*15520099
155800                                                                  15530099
155900 4400-MOVE-COMMAREA-TO-SCREEN.                                    15540099
156036                                                                  15550099
156090     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             15560099
156100         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          15570099
156200         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          15580099
156300             MOVE +1    TO ASC-BLK-SUB                            15590099
156400             PERFORM 5100-WRITE-TEMP-STORAGE                      15600099
156500             ADD +1     TO ASC-BLK-SUB                            15610099
156600             PERFORM 5100-WRITE-TEMP-STORAGE                      15620099
156700             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             15630099
156800                 GIVING PV-BLOCK-NUMBER                           15640099
156900                 REMAINDER PV-REMAINDER                           15650099
157000             IF  PV-REMAINDER > ZERO                              15660099
157100                 ADD +1 TO PV-BLOCK-NUMBER                        15670099
157200             END-IF                                               15680099
157300             MOVE +1    TO ASC-BLK-SUB                            15690099
157400             PERFORM 4410-READ-TEMP-STORAGE                       15700099
157500             ADD +1     TO ASC-BLK-SUB                            15710099
157600                           PV-BLOCK-NUMBER                        15720099
157700             PERFORM 4410-READ-TEMP-STORAGE                       15730099
157800     END-IF.                                                      15740099
157900     MOVE +1            TO ASC-BLK-SUB.                           15750099
158000     COMPUTE ASC-ITEM-SUB =                                       15760099
158100         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              15770099
158200         + PC-ITEMS-PER-PANEL).                                   15780099
158300*                                                                 15790099
158400     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        15800099
158500         ADD +1         TO ASC-BLK-SUB                            15810099
158600         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            15820099
158700     END-IF.                                                      15830099
158800*                                                                 15840099
158900     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           15850099
159000         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                15860099
159100     MOVE SPACE TO PV-NORMAL-LINE PV-DC1-LINE PV-NORMAL-TOTALS    15870099
159110                                              PV-DC-TOTALS.       15880099
159200     PERFORM 4420-FORMAT-LIST-LINES                               15890099
159300         VARYING PV-SUB                                           15900099
159400         FROM PC-ITEMS-PER-PANEL BY -1                            15910099
159500         UNTIL PV-SUB < +1.                                       15920099
159600*                                                                 15930099
159700     COMPUTE ASC-ITEMS-DISPLAYED =                                15940099
159800         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          15950099
159900     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    15960099
160000                                      ASTRTITO.                   15970099
160100     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    15980099
160200     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    15990099
160300*                                                                 16000099
160400     IF ASC-DISPLAY-QTY                                           16010099
160600          MOVE PC-QTY-HEAD       TO MR-HEAD1                      16020099
160700          MOVE PC-QTY-HEAD2      TO MR-HEAD2                      16030099
160800          MOVE ASC-TOT-ORD       TO PV-TOT-ORD                    16040099
160900          MOVE ASC-TOT-REC       TO PV-TOT-REC                    16050099
161000          MOVE ASC-TOT-PCT-N     TO PV-TREC-PCT                   16060099
161100          MOVE ASC-TOT-PCT-SIGN  TO PV-TREC-PCT-SIGN              16070099
161200          MOVE PV-NORMAL-TOTALS  TO MR-TOTAL-LINE                 16080099
161300      ELSE                                                        16090099
161400       IF ASC-DISPLAY-DC                                          16100099
161600         MOVE ASC-TOT-ORD       TO PV-TOT-ORD2                    16110099
161700         MOVE ASC-TOT-REC       TO PV-TOT-REC2                    16120099
161800         MOVE ASC-TOT-PCT-N     TO PV-TREC-PCT2                   16130099
161900         MOVE ASC-TOT-PCT-SIGN   TO PV-TREC-PCT-SIGN2             16140099
162000         MOVE ASC-TOT-DC-ORD(ASC-DC-COUNTER) TO PV-TOT-DC1-ORD    16150099
162100         MOVE ASC-TOT-DC-REC(ASC-DC-COUNTER) TO PV-TOT-DC1-REC    16160099
162200         MOVE ASC-TOT-DC-ORD(ASC-DC-COUNTER + 1) TO PV-TOT-DC2-ORD16170099
162300         MOVE ASC-TOT-DC-REC(ASC-DC-COUNTER + 1) TO PV-TOT-DC2-REC16180099
162400         MOVE ASC-TOT-DC-ORD(ASC-DC-COUNTER + 2) TO PV-TOT-DC3-ORD16190099
162500         MOVE ASC-TOT-DC-REC(ASC-DC-COUNTER + 2) TO PV-TOT-DC3-REC16200099
162600         MOVE PV-DC-TOTALS TO MR-TOTAL-LINE                       16210099
162700         MOVE PC-HEADA          TO PC-DC1-HEADA                   16220099
162800         MOVE ASC-DC-NAME(ASC-DC-COUNTER) TO PC-DC1-HEADB         16230099
162900         MOVE ASC-DC-NAME(ASC-DC-COUNTER) TO PC-DC1-HEADC         16240099
163000         MOVE ASC-DC-NAME(ASC-DC-COUNTER + 1) TO PC-DC1-HEADD     16250099
163100         MOVE ASC-DC-NAME(ASC-DC-COUNTER + 1) TO PC-DC1-HEADE     16260099
163200         MOVE ASC-DC-NAME(ASC-DC-COUNTER + 2) TO PC-DC1-HEADF     16270099
163300         MOVE ASC-DC-NAME(ASC-DC-COUNTER + 2) TO PC-DC1-HEADG     16280099
163400         MOVE PC-DC1-HEAD       TO MR-HEAD1                       16290099
163500         MOVE PC-HEADB          TO PC-HEAD-NAMEB                  16300099
163600          IF ASC-DC-NAME(ASC-DC-COUNTER) = SPACES                 16310099
163700            MOVE SPACES TO PC-HEAD-DC10                           16320099
163800          ELSE                                                    16330099
163900            MOVE PC-HEAD-DC1 TO PC-HEAD-DC10                      16340099
164000          END-IF                                                  16350099
164100          IF ASC-DC-NAME(ASC-DC-COUNTER + 1) = SPACES             16360099
164200            MOVE SPACES TO PC-HEAD-DC20                           16370099
164300          ELSE                                                    16380099
164400            MOVE PC-HEAD-DC2 TO PC-HEAD-DC20                      16390099
164500          END-IF                                                  16400099
164600          IF ASC-DC-NAME(ASC-DC-COUNTER + 2) = SPACES             16410099
164700            MOVE SPACES TO PC-HEAD-DC30                           16420099
164800          ELSE                                                    16430099
164900            MOVE PC-HEAD-DC3 TO PC-HEAD-DC30                      16440099
165000          END-IF                                                  16450099
165100          MOVE PC-DC1-HEAD2      TO MR-HEAD2                      16460099
165200       END-IF.                                                    16470099
165300                                                                  16480099
165400     IF  DP020-MSG-NUMBER-X = SPACE                               16490099
165500         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  16500099
165600*            --- MORE ITEMS TO DISPLAY ----                       16510099
165700             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            16520099
165800             SET DP020-MSG-INFORMATIONAL TO TRUE                  16530099
165900         END-IF                                                   16540099
166000     END-IF.                                                      16550099
166100                                                                  16560099
166200     MOVE ASC-KEY-PO-NUMBER        TO APONUMO.                    16570099
166300     MOVE ASC-KEY-DEPT             TO ADEPTO.                     16580099
166400     MOVE ASC-KEY-VENDOR           TO AVENDNMO.                   16590099
166500                                                                  16600099
166600*----------------------------------------------------------------*16610099
166700*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *16620099
166800*----------------------------------------------------------------*16630099
166900                                                                  16640099
167000 4410-READ-TEMP-STORAGE.                                          16650099
167100                                                                  16660099
167200     EXEC CICS                                                    16670099
167300         READQ TS                                                 16680099
167400             QUEUE (ASC-LIST-QUEUE-NAME)                          16690099
167500             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               16700099
167600             ITEM  (PV-BLOCK-NUMBER)                              16710099
167700             RESP  (PV-CICS-RESP)                                 16720099
167800     END-EXEC.                                                    16730099
167900                                                                  16740099
168000     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       16750099
168100       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     16760099
168200         CONTINUE                                                 16770099
168300     ELSE                                                         16780099
168400         SET DP013-CICS-ABEND     TO TRUE                         16790099
168500         SET DP013-NO-ROLLBACK    TO TRUE                         16800099
168600         MOVE '4410-READ-TEMP-STORAGE'                            16810099
168700                                  TO DP013-PARAGRAPH              16820099
168800         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      16830099
168900                                  TO DP013-MESSAGE-TEXT(1)        16840099
169000         PERFORM DP013-0000-PROCESS-ABEND                         16850099
169100     END-IF.                                                      16860099
169200                                                                  16870099
169300     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             16880099
169400*                                                                 16890099
169500     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         16900099
169600         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               16910099
169700     END-IF.                                                      16920099
169800 EJECT                                                            16930099
169900*----------------------------------------------------------------*16940099
170000*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *16950099
170100*----------------------------------------------------------------*16960099
170200                                                                  16970099
170300 4420-FORMAT-LIST-LINES.                                          16980099
170400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      16990099
170500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                17000099
170600         MOVE SPACE              TO MR-LINE-X (PV-SUB)            17010099
W24803                                    MR-MCL    (PV-SUB)            17020099
W24803                                    MR-SCL    (PV-SUB)            17030099
170900                                    MR-SKU-NBR (PV-SUB)           17040099
171000                                    MR-LINE-AREA (PV-SUB)         17050099
171010                                    MR-TOTAL-LINE                 17060099
171100     ELSE                                                         17070099
171200*                                                                 17080099
171300         IF  DP030-SET-CURSOR-TRAILER                             17090099
171400             IF (PV-SUB = 1)                                      17100099
171500                SET DP030-SET-CURSOR-APPL-1 TO TRUE               17110099
171600             END-IF                                               17120099
171700         END-IF                                                   17130099
171800*                                                                 17140099
171900         IF  PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL           17150099
172000             MOVE ASC-LINE   (ASC-BLK-SUB ASC-ITEM-SUB)           17160099
172100                                 TO MR-LINE (PV-SUB)              17170099
                                          DK-PO-LNE-NBR                 17180099
W24803             MOVE ASC-MCL    (ASC-BLK-SUB ASC-ITEM-SUB)           17190099
W24803                                 TO MR-MCL (PV-SUB)               17200099
W24803             MOVE ASC-SCL    (ASC-BLK-SUB ASC-ITEM-SUB)           17210099
W24803                                 TO MR-SCL (PV-SUB)               17220099
172600             MOVE ASC-SKU    (ASC-BLK-SUB ASC-ITEM-SUB)           17230099
172700                                 TO MR-SKU-NBR (PV-SUB)           17240099
GH0407             IF PV-SUB = 1                                        17241099
GH0407                 MOVE DK-PO-LNE-NBR TO PO011-PO-LNE-NBR           17242099
GH0407             END-IF                                               17243099
172800*        END-IF                                                   17250099
W24803         PERFORM 4450-CHECK-TWEBITM                               17260099
                                                                        17270099
               IF PV-DB2-COUNT > 0                                      17280099
W24803            MOVE DP015-RED  TO MR-MCLC (PV-SUB)                   17281099
W24803                               MR-SCLC (PV-SUB)                   17282099
                                     MR-SKU-NBRC (PV-SUB)               17283099
               ELSE                                                     17284099
W24803            MOVE DP015-BLUE TO MR-MCLC  (PV-SUB)                  17285099
W24803                               MR-SCLC  (PV-SUB)                  17286099
                                     MR-SKU-NBRC (PV-SUB)               17287099
               END-IF                                                   17288099
               END-IF                                                   17289099
172900         IF ASC-DISPLAY-QTY                                       17290099
173000            PERFORM 4425-MOVE-QTY                                 17300099
173100         ELSE                                                     17310099
173200         IF ASC-DISPLAY-DC                                        17320099
173300            PERFORM 4428-MOVE-DC1                                 17330099
173400         END-IF.                                                  17340099
173500                                                                  17350099
173600     SUBTRACT +1 FROM ASC-ITEM-SUB                                17360099
173700     IF  ASC-ITEM-SUB < + 1                                       17370099
173800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  17380099
173900         MOVE +1                 TO ASC-BLK-SUB                   17390099
174000     END-IF.                                                      17400099
174100                                                                  17410099
174200 4425-MOVE-QTY.                                                   17420099
174300      MOVE ASC-DESC   (ASC-BLK-SUB ASC-ITEM-SUB)                  17430099
174400                                 TO PV-DESC.                      17440099
174500      MOVE ASC-QTY    (ASC-BLK-SUB ASC-ITEM-SUB)                  17450099
174600                                 TO PV-QTY.                       17460099
174700      MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)                  17470099
174800                                 TO PV-STATUS.                    17480099
174900      MOVE ASC-REC-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                 17490099
175000                                 TO PV-REC-QTY.                   17500099
175100      MOVE ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB)                 17510099
175200                                 TO PV-REC-PCT.                   17520099
175300      IF ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB) = 0               17530099
175400            MOVE SPACES TO PV-REC-PCT-SIGN                        17540099
175500         ELSE                                                     17550099
175600            MOVE PC-PCT TO PV-REC-PCT-SIGN                        17560099
175700      END-IF.                                                     17570099
175800      MOVE PV-NORMAL-LINE TO MR-LINE-AREA(PV-SUB).                17580099
175900                                                                  17590099
176000 4428-MOVE-DC1.                                                   17600099
176100      MOVE ASC-STATUS (ASC-BLK-SUB ASC-ITEM-SUB)                  17610099
176200                                 TO PV-STATUS-DC.                 17620099
176300      MOVE ASC-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                     17630099
176400                                 TO PV-QTY-DC.                    17640099
176500      MOVE ASC-REC-QTY (ASC-BLK-SUB ASC-ITEM-SUB)                 17650099
176600                                 TO PV-REC-QTY-DC.                17660099
176700      MOVE ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB)                 17670099
176800                                 TO PV-REC-PCT-DC.                17680099
176900      IF ASC-REC-PCT (ASC-BLK-SUB ASC-ITEM-SUB) = 0               17690099
177000            MOVE SPACES TO PV-REC-PCT-SIGN-DC                     17700099
177100         ELSE                                                     17710099
177200            MOVE PC-PCT TO PV-REC-PCT-SIGN-DC                     17720099
177300      END-IF.                                                     17730099
177400     MOVE ASC-DC    (ASC-BLK-SUB ASC-ITEM-SUB ASC-DC-COUNTER)     17740099
177500                                 TO PV-DC1.                       17750099
177600     MOVE ASC-REC-DC (ASC-BLK-SUB ASC-ITEM-SUB ASC-DC-COUNTER)    17760099
177700                                 TO PV-REC-DC1.                   17770099
177800     MOVE ASC-DC (ASC-BLK-SUB ASC-ITEM-SUB ASC-DC-COUNTER + 1)    17780099
177900                                 TO PV-DC2.                       17790099
178000     MOVE ASC-REC-DC (ASC-BLK-SUB ASC-ITEM-SUB ASC-DC-COUNTER + 1)17800099
178100                                 TO PV-REC-DC2.                   17810099
178200     MOVE ASC-DC (ASC-BLK-SUB ASC-ITEM-SUB ASC-DC-COUNTER + 2)    17820099
178300                                 TO PV-DC3.                       17830099
178400     MOVE ASC-REC-DC (ASC-BLK-SUB ASC-ITEM-SUB ASC-DC-COUNTER + 2)17840099
178500                                 TO PV-REC-DC3.                   17850099
178600     MOVE PV-DC1-LINE TO MR-LINE-AREA(PV-SUB).                    17860099
178700                                                                  17870099
378800*----------------------------------------------------------------*17871099
W24803* DETERMINE IF LINE ITEM IS ON TWEBITM TABLE                     *17872099
W24803* NOTE : TWEBITM AND TUPCPLS TABLES ARE NOT REPLACED BY LOGISTICS*17872199
W24803*        DOMAIN TABLES BECAUSE OF PERFORMANCE ISSUES.            *17872299
379100*----------------------------------------------------------------*17872399
W24803 4450-CHECK-TWEBITM.                                              17872499
W24803     INITIALIZE PURCHS-PO-NBR                                     17872599
W24803                PURITM-PO-LNE-NBR.                                17872699
W24803     MOVE ASC-KEY-PO-NUMBER TO PURCHS-PO-NBR.                     17872799
W24803     MOVE DK-PO-LNE-NBR     TO PURITM-PO-LNE-NBR.                 17872899
373400     PERFORM                                                      17872999
373500         WITH TEST AFTER                                          17873099
373600         VARYING PV-RETRY-COUNTER                                 17874099
373700         FROM 1 BY 1                                              17875099
373800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               17876099
373900             OR (SQLCODE = +0) OR (SQLCODE = +100))               17877099
               EXEC SQL                                                 17878099
                    SELECT COUNT(*)                                     17879099
                     INTO :PV-DB2-COUNT                                 17880099
                     FROM TWEBITM A                                     17881099
                         ,TUPCPLS C                                     17882099
                         ,TPURITM E                                     17882199
                         ,TPURCHS F                                     17882299
W24803             WHERE F.PO_NBR = :PURCHS-PO-NBR                      17882399
                     AND F.PO_NBR = E.PO_NBR                            17882499
                     AND F.VER_STATUS_CDE = 'A'                         17882599
                     AND E.VER_STATUS_CDE = 'A'                         17882699
W24803               AND E.PO_LNE_NBR = :PURITM-PO-LNE-NBR              17882799
                     AND E.ITM_NBR = C.ITM_NBR                          17882899
                     AND C.OPERCO_NBR = '03'                            17882999
                     AND C.STR_NBR = 0                                  17883099
                     AND ((C.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      17883199
                           C.EFF_END_TMST IS NULL) OR                   17883299
                          (C.EFF_BEG_TMST <= CURRENT TIMESTAMP AND      17883399
                           C.EFF_END_TMST > CURRENT TIMESTAMP))         17883499
                     AND   C.UPC_ID = A.INTR_UPC_ID                     17883599
                     AND  (A.EFF_BEG_TMST <= CURRENT TIMESTAMP          17883699
                             AND A.EFF_END_TMST IS NULL)                17883799
               END-EXEC                                                 17883899
               EVALUATE TRUE                                            17883999
                   WHEN SQLCODE = +0                                    17884099
                   WHEN SQLCODE = +100                                  17884199
                   WHEN SQLCODE = -904                                  17884299
                   WHEN SQLCODE = -913                                  17884399
                        CONTINUE                                        17884499
                   WHEN SQLWARN0 NOT = SPACES                           17884599
                   WHEN SQLCODE < +0                                    17884699
                   WHEN SQLCODE > +0                                    17884799
W24803                  MOVE '4450-CHECK-TWEBITM'                       17884899
376100                                  TO DP013-PARAGRAPH              17884999
376200                  MOVE 'UNSUCCESSFUL SELECT COUNT(*)'             17885099
376300                                  TO DP013-MESSAGE-TEXT (1)       17885199
376400                  MOVE SQLCA      TO DP013-SQLCA                  17885299
W24803                  MOVE 'TWEBITM ' TO DP013-DB2-TABLE-NAME (1)     17885399
W24803                  MOVE 'TUPCPLS ' TO DP013-DB2-TABLE-NAME (2)     17885499
W24803                  MOVE 'TPURITM ' TO DP013-DB2-TABLE-NAME (3)     17885599
W24803                  MOVE 'TPURCHS ' TO DP013-DB2-TABLE-NAME (4)     17885699
376600                  SET DP013-DB2-ABEND                             17885799
376700                  DP013-XCTL-DISPLAY-RESTART                      17885899
376800                                  TO TRUE                         17885999
376900                  PERFORM DP013-0000-PROCESS-ABEND                17886099
377000         END-EVALUATE                                             17886199
377100     END-PERFORM.                                                 17886299
377200                                                                  17886399
377300     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        17886499
W24803         MOVE '4450-CHECK-TWEBITM' TO DP013-PARAGRAPH             17886599
W24803         MOVE 'MAX RETRIES EXCEEDED FOR SELECT OF TWEBITM'        17886699
377600                                   TO DP013-MESSAGE-TEXT (1)      17886799
377700         MOVE SQLCA               TO DP013-SQLCA                  17886899
W24803         MOVE 'TWEBITM '       TO DP013-DB2-TABLE-NAME (1)        17886999
W24803         MOVE 'TUPCPLS '       TO DP013-DB2-TABLE-NAME (2)        17887099
W24803         MOVE 'TPURITM '       TO DP013-DB2-TABLE-NAME (3)        17887199
W24803         MOVE 'TPURCHS '       TO DP013-DB2-TABLE-NAME (4)        17887299
377900         SET DP013-DB2-ABEND                                      17887399
378000             DP013-XCTL-DISPLAY-RESTART                           17887499
378100                                  TO TRUE                         17887599
378200         PERFORM DP013-0000-PROCESS-ABEND                         17887699
378300     END-IF.                                                      17887799
206400                                                                  17887899
178800                                                                  17887999
178900 5100-WRITE-TEMP-STORAGE.                                         17888099
179000                                                                  17888199
179100     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1) TO                 17888299
179200                                              PV-LIST-ITEM-NUMBER.17888399
179300     COMPUTE PV-BLOCK-NUMBER = 1 +                                17888499
179400                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).17888599
179500                                                                  17888699
179600     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           17888799
179700        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       17888899
179800                                                                  17888999
179900            PERFORM 5105-REWRITE-ASC-LISTQ                        17889099
180000                                                                  17890099
180100        END-IF                                                    17900099
180200     ELSE                                                         17910099
180300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       17920099
180400                                     ASC-HIGHEST-BLOCK-WRITTEN + 117930099
180500         PERFORM 5110-WRITE-ASC-LISTQ                             17940099
180600                                                                  17950099
180700         ADD +1 TO ASC-HIGHEST-BLOCK-WRITTEN                      17960099
180800     END-IF.                                                      17970099
180900                                                                  17980099
181000     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB) TO TRUE.            17990099
181100                                                                  18000099
181200 5105-REWRITE-ASC-LISTQ.                                          18010099
181300                                                                  18020099
181400     EXEC CICS WRITEQ TS QUEUE   (ASC-LIST-QUEUE-NAME)            18030099
181500                         FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB)) 18040099
181600                         ITEM    (PV-BLOCK-NUMBER)                18050099
181700                         REWRITE                                  18060099
181800                         RESP    (PV-CICS-RESP)                   18070099
181900                         END-EXEC.                                18080099
182000                                                                  18090099
182100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       18100099
182200         SET DP013-CICS-ABEND                                     18110099
182300             DP013-NO-ROLLBACK TO TRUE                            18120099
182400         MOVE '5105-REWRITE-ASC-LISTQ' TO DP013-PARAGRAPH         18130099
182500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'18140099
182600                                         TO DP013-MESSAGE-TEXT (1)18150099
182700         PERFORM DP013-0000-PROCESS-ABEND.                        18160099
182800                                                                  18170099
182900 5110-WRITE-ASC-LISTQ.                                            18180099
183000                                                                  18190099
183100     EXEC CICS WRITEQ TS QUEUE (ASC-LIST-QUEUE-NAME)              18200099
183200                         FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))  18210099
183300                         ITEM  (PV-BLOCK-NUMBER)                  18220099
183400                         RESP  (PV-CICS-RESP)                     18230099
183500                         END-EXEC.                                18240099
183600                                                                  18250099
183700     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      18260099
183800         SET DP013-CICS-ABEND                                     18270099
183900             DP013-NO-ROLLBACK TO TRUE                            18280099
184000         MOVE '5110-WRITE-ASC-LISTQ' TO DP013-PARAGRAPH           18290099
184100         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  18300099
184200                                         TO DP013-MESSAGE-TEXT (1)18310099
184300         PERFORM DP013-0000-PROCESS-ABEND.                        18320099
184400                                                                  18330099
184500 EJECT                                                            18340099
184600*----------------------------------------------------------------*18367599
184700*    ABEND PROCESSOR MODULE                                      *18368099
184800*----------------------------------------------------------------*18370099
184900                                                                  18380099
185000     COPY DPPD013.                                                18390099
