000100 IDENTIFICATION DIVISION.                                         00010023
000200 PROGRAM-ID.    RCKCS279.                                         00020000
000300 AUTHOR.        MARY SARDINA.                                     00030000
000400 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00040000
000500 DATE-WRITTEN.  02-26-96                                          00050000
000600 DATE-COMPILED.                                                   00060000
000700******************************************************************00070000
000800*    E279 - LIST PANEL WHICH ALLOWS AJUSTMENTS TO VERIFIED        00080000
000900*           RECEIVERS.                                            00090000
001000******************************************************************00100000
001010*---------------------------------------------------------------* 00101022
001020* CHANGED 11/11/2021    BY JIM HUNTER      WR: CHG0263784         00102023
001030* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00103022
001040* MAKING THE CALL DYNAMIC VS STATIC.                              00104022
001050*---------------------------------------------------------------* 00105022
001100 ENVIRONMENT DIVISION.                                            00110000
001200 DATA DIVISION.                                                   00120000
001300 WORKING-STORAGE SECTION.                                         00130000
001400                                                                  00140000
001500 01  PA-PROGRAM-ACCUMULATORS.                                     00150000
001600     05  PA-UPDATE-TO-QTY             PIC S9(9) VALUE +0.         00160000
001700     05  PA-UPDATE-FROM-QTY           PIC S9(9) VALUE +0.         00170000
001800     05  PA-UPDATE-DIFF-QTY           PIC S9(9) VALUE +0.         00180000
001900     05  PA-ACCUM-UPDATE-QTY          PIC S9(9) VALUE +0.         00190000
002000                                                                  00200000
002100 01  PC-PROGRAM-CONSTANTS.                                        00210000
002200     05  PC-TMKCS520              PIC  X(08)  VALUE  'TMKCS520'.  00220000
002300     05  PC-CURRENT-MAP-NAME          PIC X(8)  VALUE 'RC279A  '. 00230000
002400     05  PC-CURRENT-MAPSET-NAME       PIC X(8)  VALUE 'RCKM279 '. 00240000
002500     05  PC-CURRENT-PROGRAM-NAME      PIC X(8)  VALUE 'RCKCS279'. 00250000
002600     05  PC-AUDIT-RTN                 PIC X(08) VALUE 'RCKCS290'. 00260000
002700     05  PC-AUDIT-RTN-LENGTH          PIC S9(04) VALUE +300       00270000
002800                                                    COMP SYNC.    00280000
002900     05  PC-LIST-QUEUE-SEQ            PIC 9     VALUE 1.          00290000
003000     05  PC-SEL-QUEUE-SEQ             PIC 9     VALUE 2.          00300000
003100     05  PC-TRB-QUEUE-SEQ             PIC 9     VALUE 3.          00310000
003200     05  PC-VRFY-ADJ-QUEUE-SEQ        PIC 9     VALUE 6.          00320000
003300     05  PC-ITEMS-PER-PANEL           PIC S9(4) VALUE +10         00330000
003400                                                COMP SYNC.        00340000
003500     05  PC-MAX-BLOCKS-IN-ARRAY       PIC S9(4) VALUE +2          00350000
003600                                                COMP SYNC.        00360000
003700     05  PC-MAX-ITEMS                 PIC S9(4) VALUE +9999       00370000
003800                                                COMP SYNC.        00380000
003900     05  PC-01                        PIC X(02) VALUE '01'.       00390000
004000     05  PC-01-COMP                   PIC S9(4) COMP VALUE 1.     00400000
004100     05  PC-AC                        PIC X(02) VALUE 'AC'.       00410000
004200     05  PC-CM                        PIC X(02) VALUE 'CM'.       00420000
004300     05  PC-RV                        PIC X(02) VALUE 'RV'.       00430000
004400     05  PC-CB                        PIC X(02) VALUE 'CB'.       00440000
004500     05  PC-CA                        PIC X(02) VALUE 'CA'.       00450000
004600     05  PC-DC                        PIC X(02) VALUE 'DC'.       00460000
004700     05  PC-VE                        PIC X(02) VALUE 'VE'.       00470000
004800     05  PC-ACTIVE                    PIC X(01) VALUE 'A'.        00480000
004900     05  PC-INACTIVE                  PIC X(01) VALUE 'I'.        00490000
005000     05  PC-I                         PIC X(01) VALUE 'I'.        00500000
005100     05  PC-A                         PIC X(01) VALUE 'A'.        00510000
005200     05  PC-N                         PIC X(01) VALUE 'N'.        00520000
005300     05  PC-M                         PIC X(01) VALUE 'M'.        00530000
005400     05  PC-W                         PIC X(01) VALUE 'W'.        00540000
005500     05  PC-J                         PIC X(01) VALUE 'J'.        00550000
005600     05  PC-DASH                      PIC X(01) VALUE '-'.        00560000
005700     05  PC-INTER-APPL-CODES.                                     00570000
005800         10  PC-INTER-APPL-WO         PIC X(01) VALUE '1'.        00580000
005900         10  PC-INTER-APPL-VERIFY     PIC X(01) VALUE '2'.        00590000
006000     05  PC-CALENDAR-ROUTINE       PIC  X(08)  VALUE  'DPKUT500'. 00600000
006100     05  PC-INQ                         PIC  X(03)  VALUE 'INQ'.  00610000
006200     05  PC-UPD                         PIC  X(03)  VALUE 'UPD'.  00620000
006300     05  PC-DEL                         PIC  X(03)  VALUE 'DEL'.  00630000
006400     05  PC-ERR                         PIC  X(03)  VALUE 'ERR'.  00640000
006500     05  PC-DEFAULT-TMST              PIC X(26)  VALUE            00650000
006600                     '9999-09-09-09.09.09.999999'.                00660000
006700     05  PC-DEFAULT-DATE              PIC X(10)  VALUE            00670000
006800                     '09/09/9999'.                                00680000
006900     05  PC-DISPLAY-PO                PIC 9(8)   VALUE ZEROS.     00690000
007000     05  PC-DISPLAY-RCVR              PIC 9(8)   VALUE ZEROS.     00700000
007100     05  PC-DISPLAY-LINE              PIC 9(8)   VALUE ZEROS.     00710000
007200     05  PC-DISPLAY-OPER              PIC 9(4)   VALUE ZEROS.     00720000
007300     05  PC-DISPLAY-SQL-CODE          PIC 9999-  VALUE ZEROS.     00730000
007400     05  PC-DISPLAY-CICS-RESP         PIC 999999999-              00740000
007500                                                 VALUE ZEROS.     00750000
007600                                                                  00760000
007700     05  PC-TSYMSG-NUMBERS.                                       00770000
007800         10  PC-TSYMSG-00005          PIC 9(5)  VALUE 00005.      00780000
007900*            INVALID VALUE                                        00790000
008000         10  PC-TSYMSG-00045          PIC 9(5)  VALUE 00045.      00800000
008100*            INVALID FUNCTION KEY                                 00810000
008200         10  PC-TSYMSG-00008          PIC 9(5)  VALUE 00008.      00820000
008300*            MUST BE NUMERIC                                      00830000
008400         10  PC-TSYMSG-00050          PIC 9(5)  VALUE 00050.      00840000
008500*            NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  00850000
008600         10  PC-TSYMSG-00051          PIC 9(5)  VALUE 00051.      00860000
008700*            NO END OF RANGE HAS BEEN SPECIFIED                   00870000
008800         10  PC-TSYMSG-00052          PIC 9(5)  VALUE 00052.      00880000
008900*            END OF RANGE PRECEDES START OF RANGE                 00890000
009000         10  PC-TSYMSG-00053          PIC 9(5)  VALUE 00053.      00900000
009100*            NO START OF RANGE HAS BEEN SPECIFIED                 00910000
009200         10  PC-TSYMSG-00054          PIC 9(5)  VALUE 00054.      00920000
009300*            ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   00930000
009400         10  PC-TSYMSG-00055          PIC 9(5)  VALUE 00055.      00940000
009500*            ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     00950000
009600         10  PC-TSYMSG-00057          PIC 9(5)  VALUE 00057.      00960000
009700*            A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       00970000
009800         10  PC-TSYMSG-00059          PIC 9(5)  VALUE 00059.      00980000
009900*            UPDATE(S) SUCCESSFUL                                 00990000
010000         10  PC-TSYMSG-00069          PIC 9(5)  VALUE 00069.      01000000
010100*            TOP OF LIST                                          01010000
010200         10  PC-TSYMSG-00070          PIC 9(5)  VALUE 00070.      01020000
010300*            BOTTOM OF LIST                                       01030000
010400         10  PC-TSYMSG-00101          PIC 9(5)  VALUE 00101.      01040000
010500*            VALUE MUST BE GREATER THAN ZERO AND < 1,000,000      01050000
010600         10  PC-TSYMSG-00279          PIC 9(5)  VALUE 00279.      01060000
010700*            MORE ITEMS TO DISPLAY                                01070000
010800         10  PC-TSYMSG-00551          PIC 9(5)  VALUE 00551.      01080000
010900*            WAIT 15 SECONDS;RETRY FUNCTION AGAIN;IF UNSUCCESSFUL 01090000
011000*            CALL HELP DESK                                       01100000
011100         10  PC-TSYMSG-00734          PIC 9(5)  VALUE 00734.      01110000
011200*            UPDATE FUNCTION INVALID WITH RECEIVER STATUS         01120000
011300         10  PC-TSYMSG-00866          PIC 9(5)  VALUE 00866.      01130000
011400*            RCVR LNE QTY AND DISTR LNE QTY MUST MATCH            01140000
011500         10  PC-TSYMSG-01264          PIC 9(5)  VALUE 01264.      01150000
011600*            ADJUSTMENT WILL CREATE PACK-BY-STORE OVERAGE,        01160000
011700*            PRESS F2 TO CONFIRM                                  01170000
011800         10  PC-TSYMSG-01265          PIC 9(5)  VALUE 01265.      01180000
011900*            ADJUSTMENTS NOT UPDATED - FAILED TO PRESS F2 TO      01190000
012000*            CONFIRM UPDATES                                      01200000
012100         10  PC-TSYMSG-02875          PIC 9(05)  VALUE 02875.     01210000
012200*            PROBLEM ENCOUNTED WITH UNITS WORKED PROCESSING -     01220000
012300*            CONTACT HELP DESK                                    01230000
012400                                                                  01240000
012500*----------------------------------------------------------------*01250000
012600* INCLUDED PROGRAM CONSTANTS PC-000 AND PC-999.      WR # 21361  *01260000
012700*----------------------------------------------------------------*01270000
012800     05  PC-000                       PIC X(03) VALUE '000'.      01280000
012900     05  PC-999                       PIC X(03) VALUE '999'.      01290000
013000*----------------------------------------------------------------*01300000
013100* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *01310000
013200*----------------------------------------------------------------*01320000
013300                                                                  01330000
013400 01  PS-PROGRAM-SWITCHES.                                         01340000
013500     05  PS-ERROR-SW                  PIC  X    VALUE 'N'.        01350000
013600         88  PS-NO-ERROR                        VALUE 'N'.        01360000
013700         88  PS-ERROR                           VALUE 'Y'.        01370000
013800     05  PS-NEXT-SCREEN-SW            PIC  X    VALUE 'N'.        01380000
013900         88  PS-NO-NEXT-SCREEN                  VALUE 'N'.        01390000
014000         88  PS-NEXT-SCREEN                     VALUE 'Y'.        01400000
014100     05  PS-WRITE-LIST-QUEUE-SW       PIC  X    VALUE 'N'.        01410000
014200         88  PS-DONT-WRITE-LIST-QUEUE           VALUE 'N'.        01420000
014300         88  PS-WRITE-LIST-QUEUE                VALUE 'Y'.        01430000
014400     05  PS-UPDATE-TRECITM-SW         PIC  X    VALUE 'N'.        01440000
014500         88  PS-DONT-UPDATE-TRECITM             VALUE 'N'.        01450000
014600         88  PS-UPDATE-TRECITM                  VALUE 'Y'.        01460000
014700     05  PS-DATA-OK-SW              PIC  X(01)  VALUE 'N'.        01470000
014800         88  PS-DATA-OK                         VALUE 'Y'.        01480000
014900         88  PS-DATA-NOT-OK                     VALUE 'N'.        01490000
015000     05  PS-UPDATE-SW                 PIC  X    VALUE 'N'.        01500000
015100         88  PS-NO-UPDATES-DONE                 VALUE 'N'.        01510000
015200         88  PS-UPDATES-DONE                    VALUE 'Y'.        01520000
015300     05  PS-ALL-LINES-PROTECTED-SW    PIC X(01) VALUE 'N'.        01530000
015400         88  PS-ALL-LINES-PROTECTED             VALUE 'Y'.        01540000
015500         88  PS-ALL-LINES-NOT-PROTECTED         VALUE 'N'.        01550000
015600     05  PS-CAN-UPDATE-SW             PIC X.                      01560000
015700         88  PS-CAN-UPDATE                      VALUE 'Y'.        01570000
015800         88  PS-CANT-UPDATE                     VALUE 'N'.        01580000
015900     05  PS-TABLE-LOADED-SW           PIC X.                      01590000
016000         88  PS-TABLE-LOADED                    VALUE 'Y'.        01600000
016100         88  PS-TABLE-NOT-LOADED                VALUE 'N'.        01610000
016200     05  PS-EOT-TRB-SW                PIC X.                      01620000
016300         88  PS-EOT-TRB-TABLE                   VALUE 'Y'.        01630000
016400         88  PS-NOT-EOT-TRB-TABLE               VALUE 'N'.        01640000
016500     05  PS-TRECDIS-UPDATE-SW         PIC X(01) VALUE 'N'.        01650000
016600         88  PS-TRECDIS-UPDATE-DONE             VALUE 'Y'.        01660000
016700         88  PS-TRECDIS-UPDATE-NOT-DONE         VALUE 'N'.        01670000
016800     05  PS-UNITS-WORKED-ERROR-SW     PIC X(01) VALUE 'N'.        01680000
016900         88  PS-UNITS-WORKED-ERROR              VALUE 'Y'.        01690000
017000         88  PS-NO-UNITS-WORKED-ERROR           VALUE 'N'.        01700000
017100     05  PS-FIRST-TIME-UPDATE-SW      PIC X(01) VALUE 'Y'.        01710000
017200         88 PS-FIRST-TIME-UPDATE                VALUE 'Y'.        01720000
017300         88 PS-NOT-FIRST-TIME-UPDATE            VALUE 'N'.        01730000
017400     05  PS-CHECK-FOR-RMS-PO-SW       PIC X(01) VALUE 'N'.        01740004
017500         88  PS-CHECKED-FOR-RMS-PO              VALUE 'Y'.        01750005
017600     05  PS-RMS-PO-SW                 PIC X(01) VALUE 'N'.        01760005
017700         88  PS-RMS-PO                          VALUE 'Y'.        01770005
017800         88  PS-NO-RMS-PO                       VALUE 'N'.        01780005
017900     05  PS-DC-FLUSH-SW           PIC  X(01)  VALUE  'Y'.         01790019
018000         88  PS-DC-FLUSH-YES                  VALUE  'Y'.         01800020
018100         88  PS-DC-FLUSH-NO                   VALUE  'N'.         01810020
018200     05  PC-TRBL-ALREADY-EXISTS-MSG   PIC  X(56) VALUE            01820001
018300       'NNNNN-I-REQUESTED TRBL ALREADY EXISTS FOR PO OR PO LINE'. 01830000
018400                                                                  01840000
018500*----------------------------------------------------------------*01850000
018600*  INCLUDED PROGRAM SWITCHES FOR XLKUT001       **   WR # 21361  *01860000
018700*----------------------------------------------------------------*01870000
018800     05  PS-CALL-API-SW               PIC  X    VALUE 'N'.        01880000
018900         88  PS-CALL-API-NO                     VALUE 'N'.        01890000
019000         88  PS-CALL-API-YES                    VALUE 'Y'.        01900000
019100*----------------------------------------------------------------*01910000
019200* CHANGES MADE FOR WR # 21361 ENDS HERE.        *                 01920000
019300*----------------------------------------------------------------*01930000
019400                                                                  01940000
019500 01  DK-DB2-KEYS.                                                 01950000
019600     05  DK-PO-NBR                    PIC S9(9) COMP VALUE +0.    01960000
019700     05  DK-PKSL-LNE-NBR              PIC S9(9) COMP VALUE +0.    01970000
019800     05  DK-REC-SEQ-NBR               PIC S9(9) COMP VALUE +0.    01980000
019900     05  DK-STR-NBR                   PIC S9(4) COMP VALUE +0.    01990000
020000     05  DK-STR-NBR-N                 PIC 9(4).                   02000000
020100     05  DK-STORE                     PIC S9(4) COMP VALUE +0.    02010006
020200                                                                  02020000
020300*----------------------------------------------------------------*02030000
020400*                                                    WR # 21361  *02040000
020500* REMOVED THE STRUCTURE OF PV-SKU-NBR     AND ADDED NEW FIELDS   *02050000
020600* DEPT,CLASS,SKU AND  SKU FIELD VARIABLES                        *02060000
020700*----------------------------------------------------------------*02070000
020800 01  PV-PROGRAM-VARIABLES.                                        02080000
020900     05  PV-CICS-MSG-AREA             PIC  X(100) VALUE SPACE.    02090000
021000     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        02100000
021100                                                COMP SYNC.        02110000
021200                                                                  02120000
021300     05  PV-CICS-RESPONSE             PIC S9(04)  VALUE +0        02130000
021400                                                COMP SYNC.        02140000
021500     05  PV-SUB                       PIC S9(4) VALUE ZERO        02150000
021600                                                COMP SYNC.        02160000
021700     05  PV-REMAINDER                 PIC S9(4) VALUE ZERO        02170000
021800                                                COMP SYNC.        02180000
021900     05  PV-READ-COUNT                PIC S9(9) VALUE ZERO        02190000
022000                                                COMP-3.           02200000
022100     05  PV-ITEMS-PROCESSED           PIC S9(9) VALUE ZERO        02210000
022200                                                COMP-3.           02220000
022300     05  PV-HOLD-SELECTED-ITEMS       PIC S9(9) VALUE ZERO        02230000
022400                                                COMP-3.           02240000
022500     05  PV-EXPECTED-QTY              PIC S9(9) VALUE ZERO        02250000
022600                                                COMP-3.           02260000
022700     05  PV-AP-VERIFY-ITM-QTY         PIC S9(9) VALUE ZERO        02270000
022800                                                COMP-3.           02280000
022900     05  PV-ITEM-IN-USE               PIC S9(9) VALUE ZERO        02290000
023000                                                COMP-3.           02300000
023100     05  PV-TOP-ITEM                  PIC S9(9) VALUE ZERO        02310000
023200                                                COMP-3.           02320000
023300     05  PV-BOTTOM-ITEM               PIC S9(9) VALUE ZERO        02330000
023400                                                COMP-3.           02340000
023500     05  PV-TEMP-BLOCK-NUMBER         PIC S9(9) VALUE ZERO        02350000
023600                                                COMP-3.           02360000
023700     05  PV-DB2-COUNT                 PIC S9(9) VALUE ZERO        02370000
023800                                                COMP-3.           02380000
023900     05  PV-DEPT-NBR-KEY              PIC S9(4) VALUE +0          02390005
024000                                                COMP-3.           02400005
024100     05  PV-BLOCK-NUMBER              PIC S9(4) VALUE ZERO        02410000
024200                                                COMP SYNC.        02420000
024300     05  PV-CICS-RESP                 PIC S9(4) VALUE ZERO        02430000
024400                                                COMP SYNC.        02440000
024500     05  PV-ITEM                      PIC S9(4) VALUE ZERO        02450000
024600                                                COMP SYNC.        02460000
024700     05  PV-NULL-IND                  PIC S9(4) VALUE ZERO        02470000
024800                                                COMP SYNC.        02480000
024900     05  PV-SEL-QUEUE-ITEM            PIC S9(4) VALUE ZERO        02490000
025000                                                COMP SYNC.        02500000
025100     05  PV-SAVE-ITEM                 PIC S9(4) VALUE ZERO        02510000
025200                                                COMP SYNC.        02520000
025300     05  PV-VRFY-ITEM                 PIC S9(4) VALUE ZERO        02530000
025400                                                COMP SYNC.        02540000
025500     05  PV-HIGHEST-BLOCK-WRITTEN     PIC S9(4) VALUE ZERO        02550000
025600                                                COMP SYNC.        02560000
025700     05  PV-LIST-ITEM-NUMBER          PIC S9(4) VALUE ZERO        02570000
025800                                                COMP SYNC.        02580000
025900     05  PV-FIRST-BLOCK-IN-ARRAY      PIC S9(4) VALUE ZERO        02590000
026000                                                COMP SYNC.        02600000
026100     05  PV-NEXT-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        02610000
026200                                                COMP SYNC.        02620000
026300     05  PV-PREV-BLOCK-IN-ARRAY       PIC S9(4) VALUE ZERO        02630000
026400                                                COMP SYNC.        02640000
026500     05  PV-FIRST-BLOCK-IN-RANGE      PIC S9(4) VALUE ZERO        02650000
026600                                                COMP SYNC.        02660000
026700     05  PV-LAST-BLOCK-IN-RANGE       PIC S9(4) VALUE ZERO        02670000
026800                                                COMP SYNC.        02680000
026900     05  PV-START-OF-SELECTED-RANGE   PIC S9(4) VALUE ZERO        02690000
027000                                                COMP SYNC.        02700000
027100     05  PV-END-OF-SELECTED-RANGE     PIC S9(4) VALUE ZERO        02710000
027200                                                COMP SYNC.        02720000
027300     05  PV-DISTR-LNE-QTY             PIC S9(9) VALUE ZERO        02730000
027400                                                COMP SYNC.        02740000
027500     05  PV-DEPT-NBR-X.                                           02750005
027600         10  PV-DEPT-NBR              PIC  9(3).                  02760005
027700                                                                  02770001
027800     05  PV-SN-DEPT-NBR               PIC  X(3).                  02780001
027900     05  PV-SN-CL-NBR                 PIC  X(2).                  02790001
028000     05  PV-SKU-NBR                   PIC  X(8).                  02800001
028100     05  PV-AD-DATE-MM-DD-CCYY.                                   02810000
028200         10  PV-AD-DATE-MM            PIC X(02) VALUE SPACES.     02820000
028300         10  FILLER                   PIC X(01) VALUE '-'.        02830000
028400         10  PV-AD-DATE-DD            PIC X(02) VALUE SPACES.     02840000
028500         10  FILLER                   PIC X(01) VALUE '-'.        02850000
028600         10  PV-AD-DATE-CCYY          PIC X(04) VALUE SPACES.     02860000
028700     05  PV-DB2-INV-FORMAT            PIC X(10).                  02870000
028800     05  PV-DB2-DATE-FORMAT           PIC X(10).                  02880000
028900     05  PV-DB2-DATE-FORMAT-REDE.                                 02890000
029000         10  PV-DB2-CCYY.                                         02900000
029100             15  PV-DB2-CC            PIC X(02) VALUE SPACES.     02910000
029200             15  PV-DB2-YY            PIC X(02) VALUE SPACES.     02920000
029300         10  FILLER                   PIC X(01) VALUE '-'.        02930000
029400         10  PV-DB2-MM                PIC X(02) VALUE SPACES.     02940000
029500         10  FILLER                   PIC X(01) VALUE '-'.        02950000
029600         10  PV-DB2-DD                PIC X(02) VALUE SPACES.     02960000
029700     05  PV-SCREEN-DATE-FORMAT.                                   02970000
029800         10  PV-SCREEN-DATE-MM        PIC X(02) VALUE SPACES.     02980000
029900         10  PV-SCREEN-DATE-DD        PIC X(02) VALUE SPACES.     02990000
030000         10  PV-SCREEN-DATE-YY        PIC X(02) VALUE SPACES.     03000000
030100     05  PV-CHECK-FOR-DEFAULT-DATE    PIC X(10) VALUE SPACES.     03010000
030200         88  PV-DEFAULT-DATE                    VALUES            03020000
030300                                                '0001-01-01',     03030000
030400                                                '9999-09-09'.     03040000
030500     05  PV-DB2-CURRENT-TMST          PIC X(26).                  03050000
030600                                                                  03060000
030700     05  PV-CURRENT-TIMESTAMP         PIC X(26) VALUE SPACE.      03070000
030800                                                                  03080000
030900     05  PV-WORK-TMST.                                            03090000
031000         10  PV-WORK-TMST-1.                                      03100000
031100             15  PV-WK-CCYY           PIC  X(04)  VALUE SPACE.    03110000
031200             15  FILLER                   PIC  X(01)  VALUE SPACE.03120000
031300             15  PV-WK-MO                 PIC  X(02)  VALUE SPACE.03130000
031400             15  FILLER                   PIC  X(01)  VALUE SPACE.03140000
031500             15  PV-WK-DA                 PIC  X(02)  VALUE SPACE.03150000
031600         10  PV-WORK-TMST-2.                                      03160000
031700             15  FILLER                   PIC  X(01)  VALUE SPACE.03170000
031800             15  PV-WK-HH                 PIC  X(02)  VALUE SPACE.03180000
031900             15  FILLER                   PIC  X(01)  VALUE SPACE.03190000
032000             15  PV-WK-MM                 PIC  X(02)  VALUE SPACE.03200000
032100             15  FILLER                   PIC  X(01)  VALUE SPACE.03210000
032200             15  PV-WK-SS                 PIC  X(02)  VALUE SPACE.03220000
032300             15  FILLER                   PIC  X(01)  VALUE SPACE.03230000
032400             15  FILLER                   PIC  X(06)  VALUE ZERO. 03240000
032500     05  PV-RCPT-DISTR-UPD-CDE        PIC X(01)  VALUE SPACE.     03250000
032600                                                                  03260000
032700     05  PV-NULL                      PIC S9(04)  VALUE +0        03270000
032800                                              COMP SYNC.          03280000
032900     05  PV-ACTL-CTOFF-YYYYMMDD       PIC  X(08).                 03290000
033000     05  PV-VERIFY-DTE-YYYYMMDD                                   03300000
033100                                      PIC  X(08).                 03310000
033200     05  PV-RECEIPT-DTE-YYYYMMDD                                  03320000
033300                                      PIC  X(08).                 03330000
033400     05  PV-CURRENT-DTE-YYYYMMDD      PIC  X(08).                 03340000
033500     05  PV-NOTIF-NBR                 PIC S9(9) VALUE ZERO        03350000
033600                                                COMP SYNC.        03360000
033700     05  PV-CYC-ADJ-NBR               PIC S9(9) VALUE ZERO        03370000
033800                                                COMP SYNC.        03380000
033900     05  PV-NOTIF-BEF                 PIC S9(9) VALUE ZERO        03390000
034000                                                COMP SYNC.        03400000
034100     05  PV-CYC-ADJ-BEF               PIC S9(9) VALUE ZERO        03410000
034200                                                COMP SYNC.        03420000
034300                                                                  03430000
034400     05  PV-NOT-SELECTED              PIC S9(09) VALUE +0.        03440000
034500                                                                  03450000
034600     05  PV-CURR-OPER-UNT-ID          PIC S9(4)  COMP             03460000
034700                                                 VALUE ZERO.      03470000
034800     05  PV-XLT00010-TYPE-CODE        PIC X(2)   VALUE SPACES.    03480007
034900         88  PV-XLT00010-TYPE-DC                  VALUE 'DC'.     03490007
035000     05  PV-DISPLAY-NO-ZERO           PIC Z(5).                   03500000
035100     05  PV-DISPLAY-ZERO              PIC Z(4)9.                  03510000
035200     05  PV-PCKCS756                  PIC X(08)  VALUE 'PCKCS756'.03520000
035300     05  PV-TMST                      PIC X(26).                  03530000
035400     05  FILLER REDEFINES PV-TMST.                                03540000
035500         10  PV-CCYY                  PIC X(04).                  03550000
035600         10  FILLER                   PIC X(01).                  03560000
035700         10  PV-MM                    PIC X(02).                  03570000
035800         10  FILLER                   PIC X(01).                  03580000
035900         10  PV-DD                    PIC X(02).                  03590000
036000         10  FILLER                   PIC X(01).                  03600000
036100         10  PV-HH                    PIC X(02).                  03610000
036200         10  FILLER                   PIC X(01).                  03620000
036300         10  PV-MIN                   PIC X(02).                  03630000
036400         10  FILLER                   PIC X(01).                  03640000
036500         10  PV-SEC                   PIC X(02).                  03650000
036600         10  FILLER                   PIC X(01).                  03660000
036700         10  FILLER                   PIC X(06).                  03670000
036800*----------------------------------------------------------------*03680000
036900* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *03690000
037000*----------------------------------------------------------------*03700000
037100                                                                  03710000
037200 01  MSG-QUEUE-ITEM.                                              03720000
037300     05  FILLER                       PIC X(11)  VALUE            03730000
037400         'QUEUE NAME '.                                           03740000
037500     05  MSG-QUEUE-NAME               PIC X(08).                  03750000
037600     05  FILLER                       PIC X(14)  VALUE            03760000
037700         '  ITEM NUMBER '.                                        03770000
037800     05  MSG-SEL-ITEM                 PIC 9(04).                  03780000
037900                                                                  03790000
038000 01  MSG1-PO-REC.                                                 03800000
038100     05  FILLER                       PIC X(07)  VALUE            03810000
038200         'PO NBR '.                                               03820000
038300     05  MSG1-PO-NBR                  PIC 9(09).                  03830000
038400     05  FILLER                       PIC X(11)  VALUE            03840000
038500         '  REC SEQ  '.                                           03850000
038600     05  MSG1-REC-SEQ-NBR-N           PIC 9(09).                  03860000
038700     05  FILLER                       PIC X(12)  VALUE            03870000
038800         '  OPER UNIT '.                                          03880000
038900     05  MSG1-OPER-UNT-ID             PIC X(04).                  03890000
039000     05  FILLER                       PIC X(11)  VALUE            03900000
039100         '  FACILITY '.                                           03910000
039200     05  MSG1-FACILITY-ID             PIC X(04).                  03920000
039300                                                                  03930000
039400                                                                  03940000
039500 01  LQW-LIST-QUEUE-WORK-AREA.                                    03950000
039600     05  LQW-BLOCK-MODIFIED           PIC X(01)  VALUE SPACE.     03960000
039700     05  LQW-ITEM-ENTRIES             OCCURS 10 TIMES             03970000
039800                                      INDEXED BY LQW-IDX.         03980000
039900         10  LQW-LIST-ITEM-NUMBER     PIC S9(9)  COMP-3.          03990000
040000         10  LQW-TEMP-SELECTED-SW     PIC X(01).                  04000000
040100         10  LQW-SELECTED-SW          PIC X(01).                  04010000
040200             88  LQW-SELECT                      VALUE 'S'.       04020000
040300             88  LQW-DESELECT                    VALUE ' '.       04030000
040400         10  LQW-ACTION               PIC  X(03).                 04040000
040500             88  LQW-UPDATE                         VALUE 'UPD'.  04050000
040600             88  LQW-INQUIRE                        VALUE 'INQ'.  04060000
040700             88  LQW-ERROR                          VALUE 'ERR'.  04070000
040800         10  LQW-ADJ-QTY              PIC  X(05).                 04080000
040900         10  LQW-ADJ-QTY-N REDEFINES LQW-ADJ-QTY                  04090000
041000                                      PIC 9(05).                  04100000
041100         10  LQW-STR-NBR              PIC X(04).                  04110000
041200         10  LQW-STR-NBR-N REDEFINES LQW-STR-NBR                  04120000
041300                                      PIC 9(04).                  04130000
041400         10  LQW-PCKSLP-QTY.                                      04140000
041500             15 LQW-PCKSLP-QTY-N       PIC 9(05).                 04150000
041600         10  LQW-ACTUAL-QTY.                                      04160000
041700             15 LQW-ACTUAL-QTY-N      PIC 9(05).                  04170000
041800         10  LQW-VERFD-QTY.                                       04180000
041900             15 LQW-VERFD-QTY-N       PIC 9(05).                  04190000
042000         10  LQW-MESSAGE              PIC  X(18).                 04200000
042100         10  LQW-PACK-BY-ST-OVERAGE-SW                            04210000
042200                                      PIC X(01).                  04220000
042300             88  LQW-PACK-BY-ST-OVERAGE                           04230000
042400                                      VALUE 'Y'.                  04240000
042500             88  LQW-NO-PACK-BY-ST-OVERAGE                        04250000
042600                                      VALUE 'N'.                  04260000
042700         10  LQW-UPDATE-SW                                        04270000
042800                                      PIC X(01).                  04280000
042900             88  LQW-UPDATE-NO                                    04290000
043000                                      VALUE 'N'.                  04300000
043100             88  LQW-UPDATE-YES                                   04310000
043200                                      VALUE 'Y'.                  04320000
043300         10  LQW-SEL-ZERO-SW         PIC X(01).                   04330000
043400             88  LQW-SEL-ZERO-YES    VALUE 'Y'.                   04340000
043500             88  LQW-SEL-ZERO-NO     VALUE 'N'.                   04350000
043600                                                                  04360000
043700******************************************************************04370000
043800*    SELECTED ITEMS TEMPORARY STORAGE QUEUE ITEM LAYOUT           04380000
043900******************************************************************04390000
044000     COPY RCWS013.                                                04400005
044100                                                                  04410000
044200     COPY RCWS031.                                                04420005
044300                                                                  04430000
044400******************************************************************04440000
044500*    SELECTED ITEMS TEMPORARY STORAGE QUEUE WO ITEM LAYOUT        04450000
044600******************************************************************04460000
044700     COPY PCWS016.                                                04470005
044800                                                                  04480000
044900******************************************************************04490000
045000*  TEMPORARY STORAGE QUEUE - STORE UNIT ADJUSTMENTS TO BE SENT    04500000
045100*  TO RMS PO BY PCKCS759.                                         04510000
045200******************************************************************04520000
045300     COPY PCWS241.                                                04530005
045400                                                                  04540000
045500******************************************************************04550000
045600*    BMS MAP                                                      04560000
045700******************************************************************04570000
045800     COPY RCKM279.                                                04580000
045900                                                                  04590000
046000*----------------------------------------------------------------*04600000
046100* SINCE SKU FIELD IS SPLIT INTO THREE FIELDS         WR # 21361  *04610000
046200* DEPT,CLASS AND SKU IN THE MAP ADJUST THE FILLER OF             *04620000
046300* MR-OCCURS-LAYOUT STRUCTURE FROM 206 TO 219                     *04630000
046400*----------------------------------------------------------------*04640000
046500 01  MR-OCCURS-LAYOUT                 REDEFINES RC279AO.          04650000
046600     05  FILLER                       PIC X(219).                 04660000
046700                                                                  04670000
046800     05  MR-SCROLL-AREA               OCCURS 10 TIMES.            04680000
046900         10  MR-SELECTL               PIC S9(4) COMP.             04690000
047000         10  MR-SELECTA               PIC X.                      04700000
047100         10  MR-SELECTC               PIC X.                      04710000
047200         10  MR-SELECTH               PIC X.                      04720000
047300         10  MR-SELECTI               PIC X.                      04730000
047400                                                                  04740000
047500         10  MR-ACTIONL                 PIC S9(04) COMP.          04750000
047600         10  MR-ACTIONA                 PIC  X(01).               04760000
047700         10  MR-ACTIONC                 PIC  X(01).               04770000
047800         10  MR-ACTIONH                 PIC  X(01).               04780000
047900         10  MR-ACTION                  PIC  X(03).               04790000
048000                                                                  04800000
048100                                                                  04810000
048200         10  MR-ADJ-QTY-L             PIC S9(4) COMP.             04820000
048300         10  MR-ADJ-QTY-A             PIC X.                      04830000
048400         10  MR-ADJ-QTY-C             PIC X.                      04840000
048500         10  MR-ADJ-QTY-H             PIC X.                      04850000
048600         10  MR-ADJ-QTY               PIC X(05).                  04860000
048700                                                                  04870000
048800         10  MR-STR-NBR-L             PIC S9(4) COMP.             04880000
048900         10  MR-STR-NBR-A             PIC X.                      04890000
049000         10  MR-STR-NBR-C             PIC X.                      04900000
049100         10  MR-STR-NBR-H             PIC X.                      04910000
049200         10  MR-STR-NBR               PIC X(04).                  04920000
049300                                                                  04930000
049400         10  MR-PKSLP-ITM-QTY-L       PIC S9(4) COMP.             04940000
049500         10  MR-PKSLP-ITM-QTY-A       PIC X.                      04950000
049600         10  MR-PKSLP-ITM-QTY-C       PIC X.                      04960000
049700         10  MR-PKSLP-ITM-QTY-H       PIC X.                      04970000
049800         10  MR-PKSLP-ITM-QTY.                                    04980000
049900             15  MR-PKSLP-ITM-QTY-EDITED                          04990000
050000                                      PIC ZZZZ9.                  05000000
050100         10  MR-ACTUAL-ITM-QTY-L      PIC S9(4) COMP.             05010000
050200         10  MR-ACTUAL-ITM-QTY-A      PIC X.                      05020000
050300         10  MR-ACTUAL-ITM-QTY-C      PIC X.                      05030000
050400         10  MR-ACTUAL-ITM-QTY-H      PIC X.                      05040000
050500         10  MR-ACTUAL-ITM-QTY.                                   05050000
050600             15  MR-ACTUAL-ITM-QTY-EDITED                         05060000
050700                                      PIC ZZZZ9.                  05070000
050800                                                                  05080000
050900         10  MR-VERFD-ITM-QTY-L       PIC S9(4) COMP.             05090000
051000         10  MR-VERFD-ITM-QTY-A       PIC X.                      05100000
051100         10  MR-VERFD-ITM-QTY-C       PIC X.                      05110000
051200         10  MR-VERFD-ITM-QTY-H       PIC X.                      05120000
051300         10  MR-VERFD-ITM-QTY.                                    05130000
051400             15  MR-VERFD-ITM-QTY-EDITED                          05140000
051500                                      PIC ZZZZ9.                  05150000
051600                                                                  05160000
051700         10  MR-MESSAGE-L             PIC S9(4) COMP.             05170000
051800         10  MR-MESSAGE-A             PIC X.                      05180000
051900         10  MR-MESSAGE-C             PIC X.                      05190000
052000         10  MR-MESSAGE-H             PIC X.                      05200000
052100         10  MR-MESSAGE.                                          05210000
052200             15  MR-MESSAGE-EDITED                                05220000
052300                                      PIC XXXXXXXXXXXXXXXXXX.     05230000
052400     05 FILLER                        PIC X(12).                  05240000
052500                                                                  05250000
052600*----------------------------------------------------------------*05260000
052700* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *05270000
052800*----------------------------------------------------------------*05280000
052900                                                                  05290000
053000*----------------------------------------------------------------*05300000
053100*    CURRENT DATE COPYBOOK.                                      *05310000
053200*----------------------------------------------------------------*05320000
053300                                                                  05330000
053400     COPY DPWS017.                                                05340005
053500*----------------------------------------------------------------*05350000
053600*    COPY BOOK FOR CALENDAR SUBROUTINE (DPKUT500)                 05360000
053700*----------------------------------------------------------------*05370000
053800                                                                  05380000
053900     COPY DPWS500.                                                05390005
054000******************************************************************05400000
054100*    BMS ATTRIBUTES                                               05410000
054200******************************************************************05420000
054300     COPY DPWS015.                                                05430005
054400                                                                  05440000
054500******************************************************************05450000
054600*    FUNCTION KEYS                                                05460000
054700******************************************************************05470000
054800     COPY DPWS016.                                                05480005
054900                                                                  05490000
055000******************************************************************05500000
055100*    PARAMETER LIST FOR NUMERIC EDIT SUBROUTINE                   05510000
055200******************************************************************05520000
055300     COPY DPWS010I.                                               05530005
055400                                                                  05540000
055500******************************************************************05550000
055600*    PARAMETER LIST FOR CICS API                                  05560000
055700******************************************************************05570000
055800     COPY DPWS030.                                                05580005
055810     COPY DPWS930.                                                05581024
055900                                                                  05590000
056000******************************************************************05600000
056100*    GLOBAL COMMUNICATION AREA                                    05610000
056200******************************************************************05620000
056300     COPY DPWS020.                                                05630005
056400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                05640000
056500                                                                  05650000
056600******************************************************************05660000
056700*    INTER-APPLICATION COMMUNICATION AREA                         05670000
056800*    RCWS017 = INPUT FROM PACK SLIP LINE SUMMARY PROGRAM          05680000
056900******************************************************************05690000
057000         10  INTER-APPL-COMM-AREA       PIC X(200).               05700000
057100     COPY RCWS017.                                                05710005
057200     COPY PCWS000.                                                05720005
057300     COPY RCWS015.                                                05730005
057400                                                                  05740000
057500******************************************************************05750000
057600*    APPLICATION SPECIFIC COMMUNICATION AREA                      05760000
057700******************************************************************05770000
057800*----------------------------------------------------------------*05780000
057900*                                             WR # 21361         *05790000
058000* CHANGED THE STRUCTURE OF ASC TO MATCH THE APPL COMMAREA.       *05800000
058100* OLD ASC-SKU-NBR FIELD IS COMMENTED OUT AND NEW FIELDS DEPT,*    05810000
058200* CLASS AND NEW ASC-SKU-NBR FIELDS ARE ADDED                     *05820000
058300*----------------------------------------------------------------*05830000
058400         10  ASC-SPECIFIC-COMMAREA.                               05840000
058500             15  ASC-KEY-NOTIF-NBR              PIC S9(09)        05850000
058600                                                 COMP.            05860000
058700             15  ASC-LIST-HEADER-INFO.                            05870000
058800                 20  ASC-KEY-RECEIVER.                            05880000
058900                     25  ASC-KEY-PO-NBR.                          05890000
059000** CHG0094517  CHANGED PO-NBR FROM 7 TO 8                         05900021
059100                         30  ASC-KEY-PO-NBR-N   PIC 9(08).        05910021
059200                     25  ASC-KEY-REC-DASH       PIC X(01).        05920000
059300                     25  ASC-KEY-REC-SEQ-NBR.                     05930000
059400                         30  ASC-KEY-REC-SEQ-NBR-N                05940000
059500                                                PIC 9(04).        05950000
059600                 20  ASC-KEY-PKSL-LNE-NBR       PIC 9(04).        05960000
059700                 20  ASC-KEY-AD-EVNT-DTE        PIC X(10).        05970000
059800                 20  ASC-KEY-VENDOR-NAME        PIC X(30).        05980000
059900                 20  ASC-KEY-REC-LNE-QTY        PIC 9(06).        05990000
060000                 20  ASC-KEY-INNR-PACK-QTY      PIC 9(03).        06000000
060100                 20  ASC-KEY-CASE-PACK-QTY      PIC 9(03).        06010000
060200                 20  ASC-KEY-DISTR-LNE-QTY      PIC 9(06).        06020000
060300                 20  ASC-KEY-TOTAL-OTR          PIC Z(05)9.       06030000
060400                 20  ASC-KEY-TOTAL-OTR-X REDEFINES                06040000
060500                     ASC-KEY-TOTAL-OTR          PIC X(06).        06050000
060600*                20  ASC-KEY-SEQ-NBR            PIC S9(4) COMP.   06060000
060700                 20  ASC-KEY-OPER-UNT-ID        PIC S9(4) COMP.   06070000
060800                 20  ASC-KEY-FCLTY-ID           PIC S9(4) COMP.   06080000
060900                 20  ASC-KEY-FCLTY-DESC         PIC X(30).        06090000
061000                 20  ASC-KEY-PKSL-NBR           PIC X(10).        06100000
061100                 20  ASC-DEPT                   PIC X(03).        06110000
061200                 20  ASC-CLASS                  PIC X(02).        06120000
061300                 20  ASC-SKU-NBR                PIC X(08).        06130000
061400             15  ASC-BLOCK-ENTRIES  OCCURS 2 TIMES.               06140000
061500                 20  ASC-BLOCK-MODIFIED-SW           PIC X.       06150000
061600                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   06160000
061700                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   06170000
061800                                                                  06180000
061900                 20  ASC-ITEM-ARRAY.                              06190000
062000                     25  ASC-ITEM-ENTRIES  OCCURS 10 TIMES.       06200000
062100                         30  ASC-LIST-ITEM-NUMBER    PIC S9(9)    06210000
062200                                                     COMP-3.      06220000
062300                         30  ASC-TEMP-SELECTED-SW    PIC X.       06230000
062400                             88  ASC-VALID-SELECT    VALUE ' '    06240000
062500                                                           'S'    06250000
062600                                                           'B'    06260000
062700                                                           'E'.   06270000
062800                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   06280000
062900                             88  ASC-TEMP-SELECT     VALUE 'S'.   06290000
063000                             88  ASC-TEMP-BEGIN      VALUE 'B'.   06300000
063100                             88  ASC-TEMP-END        VALUE 'E'.   06310000
063200                         30  ASC-SELECTED-SW         PIC  X.      06320000
063300                             88  ASC-NO-SELECT       VALUE ' '.   06330000
063400                             88  ASC-SELECT          VALUE 'S'.   06340000
063500                             88  ASC-BEGIN           VALUE 'B'.   06350000
063600                             88  ASC-END             VALUE 'E'.   06360000
063700                         30  ASC-ACTION              PIC  X(03).  06370000
063800                         30  ASC-ADJ-QTY             PIC  X(05).  06380000
063900                         30  ASC-ADJ-QTY-N REDEFINES ASC-ADJ-QTY  06390000
064000                                                     PIC 9(05).   06400000
064100                         30  ASC-STR-NBR             PIC X(04).   06410000
064200                         30  ASC-STR-NBR-N REDEFINES ASC-STR-NBR  06420000
064300                                                     PIC 9(04).   06430000
064400                         30  ASC-PCKSLP-QTY.                      06440000
064500                             35  ASC-PCKSLP-QTY-N    PIC 9(05).   06450000
064600                         30  ASC-ACTUAL-QTY.                      06460000
064700                             35  ASC-ACTUAL-QTY-N    PIC 9(05).   06470000
064800                         30  ASC-VERFD-QTY.                       06480000
064900                             35  ASC-VERFD-QTY-N     PIC 9(05).   06490000
065000                         30  ASC-MESSAGE             PIC X(18).   06500000
065100                         30  ASC-PACK-BY-ST-OVERAGE-SW            06510000
065200                                                     PIC X(01).   06520000
065300                             88  ASC-PACK-BY-ST-OVERAGE           06530000
065400                                                     VALUE 'Y'.   06540000
065500                             88  ASC-NO-PACK-BY-ST-OVERAGE        06550000
065600                                                     VALUE 'N'.   06560000
065700                         30  ASC-UPDATE-STORE-SW                  06570000
065800                                                     PIC X(01).   06580000
065900                             88  ASC-UPDATE-YES                   06590000
066000                                                     VALUE 'Y'.   06600000
066100                             88  ASC-UPDATE-NO                    06610000
066200                                                     VALUE 'N'.   06620000
066300                         30  ASC-SEL-ZERO-SW         PIC X(01).   06630000
066400                             88  ASC-SEL-ZERO-YES    VALUE 'Y'.   06640000
066500                             88  ASC-SEL-ZERO-NO     VALUE 'N'.   06650000
066600             15  ASC-BLK-SUB                         PIC S9(4)    06660000
066700                                                     COMP SYNC.   06670000
066800             15  ASC-ITEM-SUB                        PIC S9(4)    06680000
066900                                                     COMP SYNC.   06690000
067000             15  ASC-SEL-SUB                         PIC S9(4)    06700000
067100                                                     COMP.        06710000
067200             15  ASC-SEL-ITEM                        PIC S9(4)    06720000
067300                                                     COMP.        06730000
067400             15  ASC-NUMBER-OF-ITEMS-READ            PIC S9(9)    06740000
067500                                                     COMP-3.      06750000
067600             15  ASC-NUMBER-OF-SELECTED-ITEMS        PIC S9(9)    06760000
067700                                                     COMP-3.      06770000
067800             15  ASC-NUMBER-OF-TS-ITEMS              PIC S9(5)    06780000
067900                                                     COMP-3.      06790000
068000             15  ASC-ITEMS-DISPLAYED                 PIC S999     06800000
068100                                                     COMP-3.      06810000
068200             15  ASC-ITEM-AT-TOP-OF-PANEL            PIC S9(9)    06820000
068300                                                     COMP-3.      06830000
068400             15  ASC-ITEM-AT-BOT-OF-PANEL            PIC S9(9)    06840000
068500                                                     COMP-3.      06850000
068600             15  ASC-HIGHEST-BLOCK-WRITTEN           PIC S9(4)    06860000
068700                                                     COMP SYNC.   06870000
068800             15  ASC-START-OF-SELECTED-RANGE         PIC S9(9)    06880000
068900                                                     COMP-3.      06890000
069000             15  ASC-END-OF-SELECTED-RANGE           PIC S9(9)    06900000
069100                                                     COMP-3.      06910000
069200             15  ASC-TOT-PCKSLP-QTY                  PIC S9(09)   06920000
069300                                                        COMP-3.   06930000
069400             15  ASC-TOT-ACTUAL-QTY                  PIC S9(09)   06940000
069500                                                        COMP-3.   06950000
069600             15  ASC-TOT-VERIFY-QTY                  PIC S9(09)   06960000
069700                                                        COMP-3.   06970000
069800             15  ASC-TOT-ADJ-QTY                     PIC S9(09)   06980000
069900                                                        COMP-3.   06990000
070000             15  ASC-TEMP-QUEUE-UPDATE-SW            PIC X.       07000000
070100                 88  ASC-UPDATE-TSQ                  VALUE 'Y'.   07010000
070200                 88  ASC-NO-TSQ-UPDATE               VALUE ' '.   07020000
070300             15  ASC-LIST-QUEUE-NAME.                             07030000
070400                 20  ASC-LIST-TERM-ID                PIC X(4).    07040000
070500                 20  ASC-LIST-TASK-NUMBER            PIC S9(5)    07050000
070600                                                     COMP-3.      07060000
070700                 20  ASC-LIST-SEQ                    PIC 9.       07070000
070800             15  ASC-SEL-QUEUE-NAME-IN               PIC X(8).    07080000
070900             15  ASC-TRB-QUEUE-NAME-IN               PIC X(8).    07090000
071000             15  ASC-SEL-QUEUE-NAME-OUT.                          07100000
071100                 20  ASC-SEL-TERM-ID                 PIC X(4).    07110000
071200                 20  ASC-SEL-TASK-NUMBER             PIC S9(5)    07120000
071300                                                     COMP-3.      07130000
071400                 20  ASC-SEL-SEQ                     PIC 9.       07140000
071500             15  ASC-TRB-QUEUE-NAME.                              07150000
071600                 20  ASC-TRB-TERM-ID                 PIC X(4).    07160000
071700                 20  ASC-TRB-TASK-NUMBER             PIC S9(5)    07170000
071800                                                      COMP-3.     07180000
071900                 20  ASC-TRB-SEQ                     PIC 9.       07190000
072000             15  ASC-VRFY-ADJ-QUEUE-NAME.                         07200000
072100                 20  ASC-VRFY-ADJ-TERM-ID            PIC X(4).    07210000
072200                 20  ASC-VRFY-ADJ-TASK-NUMBER        PIC S9(5)    07220000
072300                                                      COMP-3.     07230000
072400                 20  ASC-VRFY-ADJ-SEQ                PIC 9.       07240000
072500             15  ASC-START-ITEM-REQUEST.                          07250000
072600                 20  ASC-START-ITEM-REQUEST-N        PIC 9(5).    07260000
072700             15  ASC-RECDIS-SW                       PIC X.       07270000
072800                 88  ASC-MORE-RECDIS                 VALUE 'Y'.   07280000
072900                 88  ASC-NO-MORE-RECDIS              VALUE 'N'.   07290000
073000             15  ASC-AURECD-SW                       PIC X.       07300000
073100                 88  ASC-MORE-AURECD                 VALUE 'Y'.   07310000
073200                 88  ASC-NO-MORE-AURECD              VALUE 'N'.   07320000
073300             15  ASC-USE-SELECTION-QUEUE-IND         PIC X(1).    07330000
073400                 88  ASC-USE-SELECTION-QUEUE         VALUE 'Y'.   07340000
073500             15  ASC-VEND-STYL-NAME                  PIC X(20).   07350000
073600             15  ASC-PURCHS-STATUS-CDE               PIC X(02).   07360000
073700             15  ASC-RECITM-STATUS-CDE               PIC X(02).   07370000
073800             15  ASC-PURITM-STATUS-CDE               PIC X(02).   07380000
073900             15  ASC-RECEIV-STATUS-CDE               PIC X(02).   07390000
074000             15  ASC-PURITM-UNT-QTY                  PIC S9(9)    07400000
074100                                                         COMP.    07410000
074200             15  ASC-HOLD-INTER-APPL                 PIC X(200).  07420000
074300             15  ASC-INTER-APPL-CODE-IND             PIC X(01).   07430000
074400                 88  ASC-INTER-APPL-WO-LIST          VALUE '1'.   07440000
074500                 88  ASC-INTER-APPL-VERIFY           VALUE '2'.   07450000
074600             15 ASC-TRBL-FOUND-SW                    PIC  X.      07460000
074700                 88 ASC-TRBL-EXISTS             VALUE 'Y'.        07470000
074800                 88 ASC-NO-TRBL-EXISTS          VALUE 'N'.        07480000
074900             15  ASC-TRBL-LVL-IND                PIC X(01).       07490000
075000                 88  ASC-PO-LEVEL-TRBL           VALUE 'P'.       07500000
075100                 88  ASC-LINE-LEVEL-TRBL         VALUE 'L'        07510000
075200                                                       'S'        07520000
075300                                                       'X'        07530000
075400                                                       'M'.       07540000
075500             15  ASC-STORE-TYPE-SW                   PIC  X(01).  07550000
075600                 88  ASC-NOT-DC-STORE-TYPE           VALUE 'N'.   07560000
075700                 88  ASC-DC-STORE-TYPE               VALUE 'D'.   07570000
075800             15  ASC-UPDATE-SW                       PIC  X(01).  07580000
075900                 88  ASC-CAN-UPDATE                  VALUE 'Y'.   07590000
076000                 88  ASC-CANT-UPDATE                 VALUE 'N'.   07600000
076100             15  ASC-CONFIRM-SWITCH                  PIC X.       07610000
076200                 88  ASC-CONFIRMED                   VALUE 'Y'.   07620000
076300                 88  ASC-NOT-CONFIRMED               VALUE 'N'.   07630000
076400             15  ASC-OVERAGE-SW                      PIC X.       07640000
076500                 88  ASC-OVERAGE               VALUE 'Y'.         07650000
076600                 88  ASC-NO-OVERAGE            VALUE 'N'.         07660000
076700             15  ASC-OVERAGE-COUNT    PIC 9.                      07670000
076800                 88  ASC-OVERAGE-1             VALUE 1.           07680000
076900                 88  ASC-OVERAGE-2             VALUE 2.           07690000
077000                 88  ASC-OVERAGE-3             VALUE 3.           07700000
077100/                                                                 07710000
077200*----------------------------------------------------------------*07720000
077300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *07730000
077400*----------------------------------------------------------------*07740000
077500*----------------------------------------------------------------*07750000
077600*    COMMAREA FOR TMKCS520.                                      *07760000
077700*----------------------------------------------------------------*07770000
077800                                                                  07780000
077900     COPY TMWS500.                                                07790005
078000/                                                                 07800000
078100******************************************************************07810000
078200*    HELD TROUBLE SCREEN                                          07820000
078300******************************************************************07830000
078400     COPY TMWS003.                                                07840005
078500/                                                                 07850000
078600******************************************************************07860000
078700*    ABEND PROCESSING                                             07870000
078800******************************************************************07880000
078900     COPY DPWS013.                                                07890005
079000/                                                                 07900000
079100******************************************************************07910000
079200*  COMMAREA LAYOUT FOR THE UNITS WORKED MODULE (PCKCS756)        *07920000
079300******************************************************************07930000
079400     COPY PCWS238.                                                07940005
079500/                                                                 07950000
079600*---------------------------------------------------------------* 07960000
079700*                                                **   WR # 21361* 07970000
079800*  RECORD LAYOUT FOR LOGISTICS DOMAIN ITEM ACCESS MODULE        * 07980000
079900*---------------------------------------------------------------* 07990000
080000     COPY XLWS001.                                                08000000
080100/                                                                 08010000
080200*----------------------------------------------------------------*08020000
080300*   CHANGES MADE FOR WR # 21361 ENDS HERE.                        08030000
080400*----------------------------------------------------------------*08040000
080500******************************************************************08050000
080600*    DB2 SQL COMMUNICATION AREA                                   08060000
080700******************************************************************08070000
080800     EXEC SQL                                                     08080000
080900          INCLUDE SQLCA                                           08090000
081000     END-EXEC.                                                    08100000
081100/                                                                 08110000
081200******************************************************************08120000
081300*    DB2 DCLGEN FOR PURCHASE ORDER TABLE                          08130000
081400******************************************************************08140000
081500     EXEC SQL                                                     08150000
081600          INCLUDE TPURCHS                                         08160000
081700     END-EXEC.                                                    08170000
081800/                                                                 08180000
081900******************************************************************08190000
082000*    DB2 DCLGEN FOR PURCHASE ORDER ITEM TABLE                     08200000
082100******************************************************************08210000
082200     EXEC SQL                                                     08220000
082300          INCLUDE TPURITM                                         08230000
082400     END-EXEC.                                                    08240000
082500/                                                                 08250000
082600******************************************************************08260000
082700*    DB2 DCLGEN FOR RECEIVER TABLE                                08270000
082800******************************************************************08280000
082900     EXEC SQL                                                     08290000
083000          INCLUDE TRECEIV                                         08300000
083100     END-EXEC.                                                    08310000
083200/                                                                 08320000
083300******************************************************************08330000
083400*    DB2 DCLGEN FOR RECEIVER ITEM TABLE                           08340000
083500******************************************************************08350000
083600     EXEC SQL                                                     08360000
083700          INCLUDE TRECITM                                         08370000
083800     END-EXEC.                                                    08380000
083900/                                                                 08390000
084000******************************************************************08400000
084100*    DB2 DCLGEN FOR RECEIVER DISTRIBUTION TABLE                   08410000
084200******************************************************************08420000
084300     EXEC SQL                                                     08430000
084400          INCLUDE TRECDIS                                         08440000
084500     END-EXEC.                                                    08450000
084600/                                                                 08460000
084700******************************************************************08470000
084800*    DB2 DCLGEN FOR VENDOR ENTERPRISE NAME TABLE                  08480000
084900******************************************************************08490000
085000     EXEC SQL                                                     08500000
085100          INCLUDE TENTNME                                         08510000
085200     END-EXEC.                                                    08520000
085300/                                                                 08530000
085400*----------------------------------------------------------------*08540000
085500*    DB2 DCLGEN FOR THE TROUBLE NOTIFICATION TABLE                08550000
085600*----------------------------------------------------------------*08560000
085700     EXEC SQL                                                     08570000
085800          INCLUDE TTRBNTF                                         08580000
085900     END-EXEC.                                                    08590000
086000/                                                                 08600000
086100*----------------------------------------------------------------*08610000
086200*    DB2 DCLGEN FOR THE TROUBLE REASON TABLE                      08620000
086300*----------------------------------------------------------------*08630000
086400     EXEC SQL                                                     08640000
086500          INCLUDE TTRBRSN                                         08650000
086600     END-EXEC.                                                    08660000
086700*----------------------------------------------------------------*08670000
086800*    XLT_LOC TABLE                                               *08680007
086900*----------------------------------------------------------------*08690000
087000                                                                  08700000
087100     EXEC SQL                                                     08710000
087200          INCLUDE XLT00010                                        08720007
087300     END-EXEC.                                                    08730000
087400                                                                  08740000
087500*----------------------------------------------------------------*08750000
087600*    INVENTORY PARAMETERS TABLE                                  *08760000
087700*----------------------------------------------------------------*08770000
087800                                                                  08780000
087900     EXEC SQL                                                     08790000
088000          INCLUDE XLT00025                                        08800019
088100     END-EXEC.                                                    08810000
088200                                                                  08820000
088300*----------------------------------------------------------------*08830020
088400*    PARAMETER TABLE                                              08840015
088500*----------------------------------------------------------------*08850015
088600     EXEC SQL                                                     08860015
088700          INCLUDE TKRPRPM                                         08870015
088800     END-EXEC.                                                    08880015
088900                                                                  08890015
089000***************************************************************** 08900001
089100*    DB2 AREA FOR THE PO/RMS ROLLOUT CONTROL TABLE              * 08910001
089200*    (POT_RMS_RLOUT_CTL)                                        * 08920001
089300***************************************************************** 08930001
089400     EXEC SQL                                                     08940001
089500          INCLUDE POT00006                                        08950001
089600     END-EXEC.                                                    08960001
089700*                                                                 08970001
089800******************************************************************08980000
089900*    DB2 CURSOR DEFINITION FOR RETRIEVAL OF RECEIVER DISTRIBUTION 08990000
090000******************************************************************09000000
090100     EXEC SQL                                                     09010000
090200          DECLARE RECDIS-CURSOR CURSOR FOR                        09020000
090300           SELECT EXPTED_ITM_QTY,                                 09030000
090400                  VERIFY_ITM_QTY,                                 09040000
090500                  AP_VERIFY_ITM_QTY,                              09050000
090600                  STR_NBR,                                        09060000
090700                  AP_PRC_CDE                                      09070000
090800             FROM TRECDIS                                         09080000
090900            WHERE ORD_NBR        = :DK-PO-NBR                     09090000
091000              AND ORD_LNE_NBR    = :DK-PKSL-LNE-NBR               09100000
091100              AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                09110000
091200              AND OPER_UNT_ID    = :ASC-KEY-OPER-UNT-ID           09120000
091300              AND FCLTY_ID       = :ASC-KEY-FCLTY-ID              09130000
091500         ORDER BY STR_NBR                                         09150000
091600     END-EXEC.                                                    09160000
091700                                                                  09170000
091800/                                                                 09180000
091900 LINKAGE SECTION.                                                 09190000
092000                                                                  09200000
092100 01  DFHCOMMAREA.                                                 09210000
092200     05  FILLER                       OCCURS 1 TO 4072 TIMES      09220000
092300                                      DEPENDING ON EIBCALEN.      09230000
092400         10  FILLER                   PIC X.                      09240000
092500                                                                  09250000
092600                                                                  09260000
092700 PROCEDURE DIVISION.                                              09270000
092800                                                                  09280000
092900 0000-MAIN-MODULE.                                                09290000
093000                                                                  09300000
093100     INITIALIZE DP030-CICS-API-FIELDS.                            09310000
093200                                                                  09320000
093300     MOVE +1                     TO DP030-NUMBER-OF-MAPS.         09330000
093400     MOVE PC-CURRENT-MAPSET-NAME TO DP030-MAPSET-NAME.            09340000
093500     MOVE PC-CURRENT-MAP-NAME    TO DP030-MAP-NAME (1).           09350000
093600     SET DP030-RECEIVE-APPL-MAP  TO TRUE.                         09360000
093700     MOVE LENGTH OF RC279AI      TO DP030-MAP-LENGTH (1).         09370000
093800     MOVE 'PROGRAM ENTRY CALL'   TO DP013-MESSAGE-TEXT (1).       09380000
093900     SET DP030-OVERRIDE-APPL-ERROR                                09390000
094000                                 TO TRUE.                         09400000
094100                                                                  09410000
094200     PERFORM 0001-CALL-CICS-ARCH-API.                             09420000
094300                                                                  09430000
094400     PERFORM 1000-CONTROL-PROCESSING.                             09440000
094500                                                                  09450000
094600     MOVE 'PROGRAM EXIT CALL'    TO DP013-MESSAGE-TEXT (1).       09460000
094700                                                                  09470000
094800     PERFORM 0001-CALL-CICS-ARCH-API.                             09480000
094900                                                                  09490000
095000 0001-CALL-CICS-ARCH-API.                                         09500000
095100                                                                  09510000
095210     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      09521024
095300                                    DFHCOMMAREA                   09530024
095400                                    DP030-CICS-API-FIELDS         09540024
095500                                    DP020-STANDARD-COMMAREA       09550024
095600                                    RC279AI.                      09560024
095700                                                                  09570000
095800     IF DP030-RC-CALL-SUCCESSFUL OR                               09580000
095900        DP030-RC-APPL-ERROR                                       09590000
096000         CONTINUE                                                 09600000
096100     ELSE                                                         09610000
096200         SET DP013-CICS-ABEND                                     09620000
096300             DP013-NO-ROLLBACK                                    09630000
096400             DP013-XCTL-DISPLAY-RESTART                           09640000
096500                                 TO TRUE                          09650000
096600         MOVE '0001-CALL-CICS-ARCH-API'                           09660000
096700                                 TO DP013-PARAGRAPH               09670000
096720         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN CODE O09672024
096730-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      09673024
097000         MOVE DP030-RETURN-CODE  TO DP013-MESSAGE-TEXT (3)        09700000
097100                                                                  09710000
097200         PERFORM DP013-0000-PROCESS-ABEND.                        09720000
097300                                                                  09730000
097400 1000-CONTROL-PROCESSING.                                         09740000
097500                                                                  09750000
097600     EVALUATE TRUE                                                09760000
097700                                                                  09770000
097800         WHEN DP030-RC-APPL-ERROR                                 09780000
097900              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       09790000
098000                                 TO PV-TOP-ITEM                   09800000
098100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      09810000
098200                                                                  09820000
098300              PERFORM 6000-REFRESH-PANEL-FROM-TEMP                09830000
098400                                                                  09840000
098500              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  09850000
098600                                                                  09860000
098700              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                09870000
098800                                                                  09880000
098900                                                                  09890000
099000         WHEN DP020-NEXT-ACT-INITIAL                              09900000
099100              INITIALIZE ASC-SPECIFIC-COMMAREA                    09910000
099200              MOVE EIBTRMID      TO ASC-LIST-TERM-ID              09920000
099300                                    ASC-SEL-TERM-ID               09930000
099400                                    ASC-VRFY-ADJ-TERM-ID          09940000
099500              MOVE DP020-SRC-TASK-NUMBER                          09950000
099600                                 TO ASC-LIST-TASK-NUMBER          09960000
099700                                    ASC-SEL-TASK-NUMBER           09970000
099800                                    ASC-VRFY-ADJ-TASK-NUMBER      09980000
099900              MOVE PC-LIST-QUEUE-SEQ                              09990000
100000                                 TO ASC-LIST-SEQ                  10000000
100100              MOVE PC-SEL-QUEUE-SEQ                               10010000
100200                                 TO ASC-SEL-SEQ                   10020000
100300              MOVE PC-VRFY-ADJ-QUEUE-SEQ                          10030000
100400                                 TO ASC-VRFY-ADJ-SEQ              10040000
100500              SET PS-NO-ERROR    TO TRUE                          10050000
100600                                                                  10060000
100700              PERFORM 1100-PROCESS-INTER-APPL-COMM                10070000
100800                                                                  10080000
100900              IF PS-NO-ERROR                                      10090000
101000                  MOVE INTER-APPL-COMM-AREA                       10100000
101100                                 TO ASC-HOLD-INTER-APPL           10110000
101200                  PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT 10120000
101300                  PERFORM 3200-RESET-ATTRIBUTES                   10130000
101400              END-IF                                              10140000
101500                                                                  10150000
101600                                                                  10160000
101700         WHEN DP020-NEXT-ACT-READ-MAP                             10170000
101800              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10180000
101900                                 TO PV-TOP-ITEM                   10190000
102000                                                                  10200000
102100              PERFORM 2000-PROCESS-PANEL                          10210000
102200                                                                  10220000
102300                                                                  10230000
102400         WHEN DP020-NEXT-ACT-RETURN                               10240000
102500              MOVE ASC-ITEM-AT-TOP-OF-PANEL                       10250000
102600                                 TO PV-TOP-ITEM                   10260000
102700              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      10270000
102800              MOVE ASC-HOLD-INTER-APPL                            10280000
102900                                 TO INTER-APPL-COMM-AREA          10290000
103000*             THIS PROGRAM REQUIRES THAT ANY ADDED OR CHANGED     10300000
103100*             INFORMATION BE DISPLAYED UPON RETURN TO THIS        10310000
103200*             PROGRAM.  THEREFORE THE LIST QUEUE IS REBUILT.      10320000
103300                                                                  10330000
103400              PERFORM 2050-DELETE-LIST-QUEUE                      10340000
103500              PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT     10350000
103600              PERFORM 3200-RESET-ATTRIBUTES                       10360000
103700                                                                  10370000
103800         WHEN OTHER                                               10380000
103900              SET DP013-LOGIC-ABEND                               10390000
104000                  DP013-NO-ROLLBACK                               10400000
104100                                 TO TRUE                          10410000
104200              MOVE '1000-CONTROL-PROCESSING'                      10420000
104300                                 TO DP013-PARAGRAPH               10430000
104400              MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'   10440000
104500                                 TO DP013-MESSAGE-TEXT(1)         10450000
104600                                                                  10460000
104700              PERFORM DP013-0000-PROCESS-ABEND                    10470000
104800                                                                  10480000
104900     END-EVALUATE.                                                10490000
105000                                                                  10500000
105100 1100-PROCESS-INTER-APPL-COMM.                                    10510000
105200                                                                  10520000
105300     MOVE SPACE                  TO ASC-START-ITEM-REQUEST.       10530000
105400     MOVE DP020-INT-APPL-FORMAT-IND                               10540000
105500                                 TO ASC-INTER-APPL-CODE-IND.      10550000
105600                                                                  10560000
105700     EVALUATE DP020-INT-APPL-FORMAT-IND                           10570000
105800         WHEN PC-INTER-APPL-WO                                    10580000
105900             IF PC000-NUMBER-OF-SELECTED-ITEMS = ZERO             10590000
106000                 SET ASC-NO-TSQ-UPDATE                            10600000
106100                                 TO TRUE                          10610000
106200                 SET DP020-MSG-FATAL                              10620000
106300                     DP020-NEXT-ACT-APPL-ERROR                    10630000
106400                     PS-ERROR    TO TRUE                          10640000
106500                 MOVE PC-TSYMSG-00057                             10650000
106600                                 TO DP020-MSG-NUMBER              10660000
106700             ELSE                                                 10670000
106800                 MOVE PC000-PO-NBR-N                              10680000
106900                                 TO ASC-KEY-PO-NBR-N              10690000
107000                 MOVE PC000-REC-SEQ-NBR-N                         10700000
107100                                 TO ASC-KEY-REC-SEQ-NBR-N         10710000
107200                 MOVE PC000-OPERATING-UNIT-ID                     10720000
107300                                 TO ASC-KEY-OPER-UNT-ID           10730000
107400                 MOVE PC000-FACILITY-ID                           10740000
107500                                 TO ASC-KEY-FCLTY-ID              10750000
107600                                                                  10760000
107700                 SET ASC-USE-SELECTION-QUEUE                      10770000
107800                                 TO TRUE                          10780000
107900                                                                  10790000
108000                 MOVE PC000-NUMBER-OF-SELECTED-ITEMS              10800000
108100                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  10810000
108200                 MOVE PC000-NUMBER-OF-TS-ITEMS                    10820000
108300                                 TO ASC-NUMBER-OF-TS-ITEMS        10830000
108400                 MOVE PC000-SEL-QUEUE-NAME                        10840000
108500                                 TO ASC-SEL-QUEUE-NAME-IN         10850000
108600                 MOVE PC016-MAX-ITEMS                             10860000
108700                                 TO ASC-SEL-SUB                   10870000
108800                 MOVE ZERO       TO ASC-SEL-ITEM                  10880000
108900             END-IF                                               10890000
109000                                                                  10900000
109100         WHEN OTHER                                               10910000
109200             IF RC017-NUMBER-OF-TS-ITEMS = ZERO                   10920000
109300                 SET ASC-NO-TSQ-UPDATE                            10930000
109400                                 TO TRUE                          10940000
109500                 SET DP020-MSG-FATAL                              10950000
109600                     DP020-NEXT-ACT-APPL-ERROR                    10960000
109700                     PS-ERROR    TO TRUE                          10970000
109800                 MOVE PC-TSYMSG-00057                             10980000
109900                                 TO DP020-MSG-NUMBER              10990000
110000             ELSE                                                 11000000
110100                 SET RC017-TROUBLE-UPDATED TO TRUE                11010000
110200                 MOVE RC017-PO-NBR                                11020000
110300                                 TO ASC-KEY-PO-NBR-N              11030000
110400                                    DK-PO-NBR                     11040000
110500                 MOVE RC017-PO-LNE-NBR                            11050000
110600                                 TO ASC-KEY-PKSL-LNE-NBR          11060000
110700*                MOVE RC017-SEQ-NBR                               11070000
110800*                                TO ASC-KEY-SEQ-NBR               11080000
110900                 MOVE RC017-REC-SEQ-NBR                           11090000
111000                                 TO ASC-KEY-REC-SEQ-NBR-N         11100000
111100                                    DK-REC-SEQ-NBR                11110000
111200                 MOVE RC017-OPER-UNT-ID                           11120000
111300                                 TO ASC-KEY-OPER-UNT-ID           11130000
111400                 MOVE RC017-FCLTY-ID                              11140000
111500                                 TO ASC-KEY-FCLTY-ID              11150000
111600                 MOVE RC017-FCLTY-NME                             11160000
111700                                 TO ASC-KEY-FCLTY-DESC            11170000
111800                 MOVE RC017-PO-NBR                                11180000
111900                                 TO ASC-KEY-PKSL-NBR              11190000
112000                 MOVE RC017-PO-LNE-NBR                            11200000
112100                                 TO ASC-KEY-PKSL-LNE-NBR          11210000
112200                                    DK-PKSL-LNE-NBR               11220000
112300                 MOVE  RC017-PKSL-STAT-CDES                       11230000
112400                                 TO  ASC-RECEIV-STATUS-CDE        11240000
112500                 SET ASC-USE-SELECTION-QUEUE                      11250000
112600                                 TO TRUE                          11260000
112700                                                                  11270000
112800                 MOVE RC017-NUMBER-OF-SELECTED-ITEMS              11280000
112900                                 TO ASC-NUMBER-OF-SELECTED-ITEMS  11290000
113000                 MOVE RC017-NUMBER-OF-TS-ITEMS                    11300000
113100                                 TO ASC-NUMBER-OF-TS-ITEMS        11310000
113200                 MOVE RC017-TRB-QUEUE-NAME                        11320000
113300                                 TO ASC-TRB-QUEUE-NAME-IN         11330000
113400                 MOVE RC017-SEL-QUEUE-NAME                        11340000
113500                                 TO ASC-SEL-QUEUE-NAME-IN         11350000
113600                 MOVE RC013-MAX-ITEMS                             11360000
113700                                 TO ASC-SEL-SUB                   11370000
113800                 MOVE ZERO       TO ASC-SEL-ITEM                  11380000
113900                 PERFORM 2300-GET-NEXT-RECORD                     11390000
114000             END-IF                                               11400000
114100     END-EVALUATE.                                                11410000
114200                                                                  11420000
114300                                                                  11430000
114400                                                                  11440000
114500 2000-PROCESS-PANEL.                                              11450000
114600                                                                  11460000
114700     SET PS-NEXT-SCREEN TO TRUE.                                  11470000
114800     EVALUATE TRUE                                                11480000
114900                                                                  11490000
115000         WHEN DP020-SRC-AID = DP016-CLEAR                         11500000
115100              MOVE ZERO          TO ASC-ITEM-AT-TOP-OF-PANEL      11510000
115200                                                                  11520000
115300              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  11530000
115400                                                                  11540000
115500              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11550000
115600                                                                  11560000
115700                                                                  11570000
115800         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    11580000
115900                                                                  11590000
116000              PERFORM 2050-DELETE-LIST-QUEUE                      11600000
116100                                                                  11610000
116200              SET ASC-NO-OVERAGE TO TRUE                          11620000
116300                                                                  11630000
116400              PERFORM 4000-BUILD-INITIAL-PANEL THRU 4000-EXIT     11640000
116500                                                                  11650000
116600              PERFORM 3200-RESET-ATTRIBUTES                       11660000
116700                                                                  11670000
116800         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   11680000
116900                                                                  11690000
117000              PERFORM 2140-DESELECT-ALL-ITEMS                     11700000
117100                                                                  11710000
117200              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11720000
117300                                                                  11730000
117400         WHEN DP020-FK-SELECT-ALL (DP020-SRC-AID)                 11740000
117500         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              11750000
117600                                                                  11760000
117700              PERFORM 2150-SELECT-ALL-ITEMS                       11770000
117800              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                11780000
117900                                                                  11790000
118000         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             11800000
118100             IF ASC-USE-SELECTION-QUEUE                           11810000
118200                 IF ASC-OVERAGE                                   11820000
118300                     ADD +1 TO ASC-OVERAGE-COUNT                  11830000
118400                     IF ASC-OVERAGE-2                             11840000
118500                         SET ASC-NO-OVERAGE TO TRUE               11850000
118600                         MOVE 0 TO ASC-OVERAGE-COUNT              11860000
118700                         PERFORM 6200-DEL-LIST-QUEUE              11870000
118800                         PERFORM 2300-GET-NEXT-RECORD             11880000
118900                         PERFORM 4000-BUILD-INITIAL-PANEL         11890000
119000                             THRU 4000-EXIT                       11900000
119100                         PERFORM 3200-RESET-ATTRIBUTES            11910000
119200                     ELSE                                         11920000
119300                         PERFORM 3200-RESET-ATTRIBUTES            11930000
119400                         MOVE PC-TSYMSG-01264                     11940000
119500                            TO DP020-MSG-NUMBER                   11950000
119600                         SET DP020-MSG-FATAL                      11960000
119700                                     TO TRUE                      11970000
119800                     END-IF                                       11980000
119900                 ELSE                                             11990000
120000                     PERFORM 6200-DEL-LIST-QUEUE                  12000000
120100                         PERFORM 2300-GET-NEXT-RECORD             12010000
120200                     PERFORM 4000-BUILD-INITIAL-PANEL             12020000
120300                         THRU 4000-EXIT                           12030000
120400                     PERFORM 3200-RESET-ATTRIBUTES                12040000
120500             ELSE                                                 12050000
120600*                --- BOTTOM OF LIST ---                           12060000
120700                 IF ASC-OVERAGE                                   12070000
120800                     MOVE PC-TSYMSG-01264                         12080000
120900                                 TO DP020-MSG-NUMBER              12090000
121000                     SET DP020-MSG-INFORMATIONAL                  12100000
121100                                 TO TRUE                          12110000
121200                 ELSE                                             12120000
121300                     MOVE PC-TSYMSG-00070                         12130000
121400                                 TO DP020-MSG-NUMBER              12140000
121500                     SET DP020-MSG-INFORMATIONAL                  12150000
121600                                 TO TRUE                          12160000
121700                 END-IF                                           12170000
121800             END-IF                                               12180000
121900                                                                  12190000
122000         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             12200000
122100             IF ASC-USE-SELECTION-QUEUE                           12210000
122200                 IF ASC-OVERAGE                                   12220000
122300                     ADD +1 TO ASC-OVERAGE-COUNT                  12230000
122400                     IF ASC-OVERAGE-2                             12240000
122500                         SET ASC-NO-OVERAGE TO TRUE               12250000
122600                         MOVE 0 TO ASC-OVERAGE-COUNT              12260000
122700                         PERFORM 6200-DEL-LIST-QUEUE              12270000
122800                         PERFORM 2310-GET-PREV-RECORD             12280000
122900                         PERFORM 4000-BUILD-INITIAL-PANEL         12290000
123000                             THRU 4000-EXIT                       12300000
123100                         PERFORM 3200-RESET-ATTRIBUTES            12310000
123200                     ELSE                                         12320000
123300                         PERFORM 3200-RESET-ATTRIBUTES            12330000
123400                         MOVE PC-TSYMSG-01264                     12340000
123500                            TO DP020-MSG-NUMBER                   12350000
123600                         SET DP020-MSG-FATAL                      12360000
123700                                     TO TRUE                      12370000
123800                         END-IF                                   12380000
123900                 ELSE                                             12390000
124000                     PERFORM 6200-DEL-LIST-QUEUE                  12400000
124100                     IF ASC-INTER-APPL-WO-LIST                    12410000
124200                         PERFORM 2410-GET-PREV-WO-RECORD          12420000
124300                     ELSE                                         12430000
124400                         PERFORM 2310-GET-PREV-RECORD             12440000
124500                     END-IF                                       12450000
124600                     PERFORM 4000-BUILD-INITIAL-PANEL             12460000
124700                         THRU 4000-EXIT                           12470000
124800                     PERFORM 3200-RESET-ATTRIBUTES                12480000
124900*                --- TOP OF LIST ---                              12490000
125000               ELSE                                               12500000
125100                 IF ASC-OVERAGE                                   12510000
125200                     MOVE PC-TSYMSG-01264                         12520000
125300                        TO DP020-MSG-NUMBER                       12530000
125400                     SET DP020-MSG-INFORMATIONAL                  12540000
125500                                 TO TRUE                          12550000
125600                 ELSE                                             12560000
125700                     MOVE PC-TSYMSG-00069                         12570000
125800                        TO DP020-MSG-NUMBER                       12580000
125900                     SET DP020-MSG-INFORMATIONAL                  12590000
126000                                 TO TRUE                          12600000
126100                 END-IF                                           12610000
126200             END-IF                                               12620000
126300                                                                  12630000
126400                                                                  12640000
126500         WHEN OTHER                                               12650000
126600                                                                  12660000
126700              PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                12670000
126800                                                                  12680000
126900              PERFORM 3000-EDIT-DATA-IN-COMMAREA                  12690000
127000                                                                  12700000
127100              IF PS-NO-ERROR                                      12710000
127200                  SET DP030-CONTINUE-GO                           12720000
127300                                 TO TRUE                          12730000
127400                                                                  12740000
127500                  PERFORM 2100-CHECK-FUNCTION-KEY                 12750000
127600                                                                  12760000
127700              ELSE                                                12770000
127800                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            12780000
127900                  SET DP030-OVERRIDE-GO                           12790000
128000                                 TO TRUE                          12800000
128100              END-IF                                              12810000
128200                                                                  12820000
128300     END-EVALUATE.                                                12830000
128400                                                                  12840000
128500 2050-DELETE-LIST-QUEUE.                                          12850000
128600                                                                  12860000
128700     EXEC CICS DELETEQ TS QUEUE (ASC-LIST-QUEUE-NAME)             12870000
128800                          RESP  (PV-CICS-RESP)                    12880000
128900                          END-EXEC.                               12890000
129000                                                                  12900000
129100     IF (PV-CICS-RESP = DFHRESP (NORMAL)) OR                      12910000
129200        (PV-CICS-RESP = DFHRESP (QIDERR))                         12920000
129300         CONTINUE                                                 12930000
129400     ELSE                                                         12940000
129500         SET DP013-CICS-ABEND                                     12950000
129600             DP013-NO-ROLLBACK   TO TRUE                          12960000
129700         MOVE '2050-DELETE-LIST-QUEUE'                            12970000
129800                                 TO DP013-PARAGRAPH               12980000
129900         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE DELETE' 12990000
130000                                 TO DP013-MESSAGE-TEXT (1)        13000000
130100                                                                  13010000
130200         PERFORM DP013-0000-PROCESS-ABEND                         13020000
130300     END-IF.                                                      13030000
130400                                                                  13040000
130500     MOVE ZERO                   TO ASC-HIGHEST-BLOCK-WRITTEN.    13050000
130600                                                                  13060000
130700 2100-CHECK-FUNCTION-KEY.                                         13070000
130800                                                                  13080000
130900*    SET ASC-NOT-CONFIRMED TO TRUE.                               13090000
131000     SET PS-NEXT-SCREEN TO TRUE.                                  13100000
131100     EVALUATE TRUE                                                13110000
131200         WHEN DP020-FK-LOCAL-GOTO (DP020-SRC-AID)                 13120000
131300              IF (PS-CANT-UPDATE                                  13130000
131400              AND DP020-SRC-AID EQUAL DP016-PF22)                 13140000
131500                  MOVE PC-TSYMSG-00734                            13150000
131600                                 TO  DP020-MSG-NUMBER             13160000
131700                  SET PS-ERROR                                    13170000
131800                      DP030-OVERRIDE-GO                           13180000
131900                      DP020-MSG-FATAL                             13190000
132000                                 TO TRUE                          13200000
132100              ELSE                                                13210000
132200                  MOVE ASC-NUMBER-OF-SELECTED-ITEMS               13220000
132300                                 TO RC017-NUMBER-OF-SELECTED-ITEMS13230000
132400                  MOVE ASC-KEY-PO-NBR-N                           13240000
132500                                 TO RC017-PO-NBR                  13250000
132600                  MOVE ASC-KEY-REC-SEQ-NBR-N                      13260000
132700                                 TO RC017-REC-SEQ-NBR             13270000
132800                  MOVE ASC-KEY-OPER-UNT-ID                        13280000
132900                                 TO RC017-OPER-UNT-ID             13290000
133000                  MOVE ASC-KEY-FCLTY-ID                           13300000
133100                                 TO RC017-FCLTY-ID                13310000
133200                  MOVE ASC-KEY-FCLTY-DESC                         13320000
133300                                 TO RC017-FCLTY-NME               13330000
133400                  MOVE ASC-KEY-PKSL-LNE-NBR                       13340000
133500                                 TO RC017-PO-LNE-NBR              13350000
133600                  MOVE ASC-KEY-PKSL-NBR                           13360000
133700                                 TO RC017-PO-NBR                  13370000
133800                  PERFORM 5000-PREPARE-SEL-QUEUE                  13380000
133900                  IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO          13390000
134000                      SET ASC-NO-TSQ-UPDATE                       13400000
134100                                 TO TRUE                          13410000
134200                  END-IF                                          13420000
134300              END-IF                                              13430000
134400                                                                  13440000
134500         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              13450000
134600              IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO              13460000
134700                  SET ASC-NO-TSQ-UPDATE                           13470000
134800                                 TO TRUE                          13480000
134900                  SET DP030-OVERRIDE-GO                           13490000
135000                      DP020-MSG-WARNING                           13500000
135100                                 TO TRUE                          13510000
135200                  MOVE PC-TSYMSG-00057                            13520000
135300                                 TO DP020-MSG-NUMBER              13530000
135400                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            13540000
135500                  PERFORM 3200-RESET-ATTRIBUTES                   13550000
135600              ELSE                                                13560000
135700                  IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          13570000
135800                      IF ASC-INTER-APPL-WO-LIST                   13580000
135900                          INITIALIZE PC000-INTER-APPL-COMMAREA    13590000
136000                          MOVE ASC-NUMBER-OF-SELECTED-ITEMS       13600000
136100                                TO PC000-NUMBER-OF-SELECTED-ITEMS 13610000
136200                          MOVE ASC-KEY-PO-NBR-N                   13620000
136300                                 TO PC000-PO-NBR-N                13630000
136400                          PERFORM 5000-PREPARE-SEL-QUEUE          13640000
136500                                                                  13650000
136600                          SET ASC-NO-TSQ-UPDATE                   13660000
136700                                 TO TRUE                          13670000
136800                      ELSE                                        13680000
136900                          PERFORM 9500-READ-TRB-QUEUE             13690000
137000                          MOVE ASC-NUMBER-OF-SELECTED-ITEMS       13700000
137100                                 TO RC017-NUMBER-OF-SELECTED-ITEMS13710000
137200                          MOVE ASC-KEY-PO-NBR-N                   13720000
137300                                 TO RC017-PO-NBR                  13730000
137400                          MOVE ASC-KEY-PKSL-LNE-NBR               13740000
137500                                 TO RC017-PO-LNE-NBR              13750000
137600                          IF RC017-PACK-BY-STORE                  13760000
137700                               PERFORM 5005-PREPARE-SEL-QUEUE     13770000
137800                               IF ASC-OVERAGE                     13780000
137900                                   SET ASC-CONFIRMED              13790000
138000                                        TO TRUE                   13800000
138100                                    MOVE PC-TSYMSG-01264          13810000
138200                                    TO  DP020-MSG-NUMBER          13820000
138300                                     SET PS-ERROR                 13830000
138400                                     DP030-OVERRIDE-GO            13840000
138500                                     DP020-MSG-FATAL              13850000
138600                                              TO TRUE             13860000
138700                                ELSE                              13870000
138800                                    PERFORM 2105-PERFORM-UPDATES  13880000
138900                                    SET ASC-CONFIRMED TO TRUE     13890000
139000                                    SET ASC-NO-OVERAGE TO TRUE    13900000
139100                                END-IF                            13910000
139200                             ELSE                                 13920000
139300                               PERFORM 2105-PERFORM-UPDATES       13930000
139400                          END-IF                                  13940000
139500                  END-IF                                          13950000
139600              END-IF                                              13960000
139700           END-IF                                                 13970000
139800                                                                  13980000
139900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              13990000
140000             INITIALIZE RC015-INTER-APPL-COMMAREA                 14000000
140100             MOVE ASC-KEY-OPER-UNT-ID                             14010000
140200                                 TO RC015-OPER-UNT-ID             14020000
140300             MOVE ASC-KEY-FCLTY-ID                                14030000
140400                                 TO RC015-FCLTY-ID                14040000
140500             MOVE ASC-KEY-PO-NBR-N                                14050000
140600                                 TO RC015-PO-NBR                  14060000
140700             MOVE ASC-KEY-REC-SEQ-NBR-N                           14070000
140800                                 TO RC015-REC-SEQ-NBR             14080000
140900             MOVE ASC-KEY-PKSL-LNE-NBR                            14090000
141000                                 TO RC015-PKSL-LNE-NBR            14100000
141100                                                                  14110000
141200         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    14120000
141300            IF ASC-NUMBER-OF-SELECTED-ITEMS = ZERO                14130000
141400                 SET ASC-NO-TSQ-UPDATE                            14140000
141500                                TO TRUE                           14150000
141600                 SET DP030-OVERRIDE-GO                            14160000
141700                      DP020-MSG-WARNING                           14170000
141800                                 TO TRUE                          14180000
141900                 MOVE PC-TSYMSG-00057                             14190000
142000                                 TO DP020-MSG-NUMBER              14200000
142100                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            14210000
142200                  PERFORM 3200-RESET-ATTRIBUTES                   14220000
142300            ELSE                                                  14230000
142400                  IF ASC-NUMBER-OF-SELECTED-ITEMS > ZERO          14240000
142500                      IF ASC-INTER-APPL-WO-LIST                   14250000
142600                          INITIALIZE PC000-INTER-APPL-COMMAREA    14260000
142700                          MOVE ASC-NUMBER-OF-SELECTED-ITEMS       14270000
142800                                TO PC000-NUMBER-OF-SELECTED-ITEMS 14280000
142900                          MOVE ASC-KEY-PO-NBR-N                   14290000
143000                                 TO PC000-PO-NBR-N                14300000
143100                          PERFORM 5000-PREPARE-SEL-QUEUE          14310000
143200                                                                  14320000
143300                          SET ASC-NO-TSQ-UPDATE                   14330000
143400                                 TO TRUE                          14340000
143500                      ELSE                                        14350000
143600                          IF ASC-CONFIRMED                        14360000
143700                              MOVE ASC-NUMBER-OF-SELECTED-ITEMS   14370000
143800                                TO RC017-NUMBER-OF-SELECTED-ITEMS 14380000
143900                              MOVE ASC-KEY-PO-NBR-N               14390000
144000                                 TO RC017-PO-NBR                  14400000
144100                              MOVE ASC-KEY-PKSL-LNE-NBR           14410000
144200                                  TO RC017-PO-LNE-NBR             14420000
144300                              PERFORM 2105-PERFORM-UPDATES        14430000
144400                              SET ASC-NOT-CONFIRMED TO TRUE       14440000
144500                          ELSE                                    14450000
144600                             SET DP030-OVERRIDE-GO                14460000
144700                                 DP020-MSG-WARNING                14470000
144800                                 TO TRUE                          14480000
144900                             MOVE PC-TSYMSG-00045                 14490000
145000                                 TO DP020-MSG-NUMBER              14500000
145100                             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN 14510000
145200                             PERFORM 3200-RESET-ATTRIBUTES        14520000
145300                         END-IF                                   14530000
145400                      END-IF                                      14540000
145500             END-IF                                               14550000
145600        END-IF                                                    14560000
145700                                                                  14570000
145800         WHEN DP020-FK-FIRST-PAGE (DP020-SRC-AID)                 14580000
145900             MOVE +1             TO PV-TOP-ITEM                   14590000
146000             IF ASC-OVERAGE                                       14600000
146100                 MOVE PC-TSYMSG-01264                             14610000
146200                          TO DP020-MSG-NUMBER                     14620000
146300                SET DP020-MSG-FATAL                               14630000
146400                                     TO TRUE                      14640000
146500             ELSE                                                 14650000
146600                 MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER      14660000
146700                 SET DP020-MSG-INFORMATIONAL                      14670000
146800                                     TO TRUE                      14680000
146900                                                                  14690000
147000             END-IF                                               14700000
147100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14710000
147200             PERFORM 3200-RESET-ATTRIBUTES                        14720000
147300                                                                  14730000
147400         WHEN DP020-FK-PREV-PAGE (DP020-SRC-AID)                  14740000
147500                                                                  14750000
147600             PERFORM 2110-BROWSE-BACKWARD                         14760000
147700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14770000
147800             PERFORM 3200-RESET-ATTRIBUTES                        14780000
147900                                                                  14790000
148000         WHEN DP020-FK-NEXT-PAGE (DP020-SRC-AID)                  14800000
148100                                                                  14810000
148200             PERFORM 2120-BROWSE-FORWARD                          14820000
148300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 14830000
148400             PERFORM 3200-RESET-ATTRIBUTES                        14840000
148500                                                                  14850000
148600                                                                  14860000
148700         WHEN DP020-SRC-AID = DP016-ENTER                         14870000
148800                                                                  14880000
148900             PERFORM 2180-CHECK-FOR-JUMP-BROWSE                   14890000
149000                                                                  14900000
149100             IF PS-NO-ERROR                                       14910000
149200                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             14920000
149300                 PERFORM 3200-RESET-ATTRIBUTES                    14930000
149400             END-IF                                               14940000
149500                                                                  14950000
149600         WHEN OTHER                                               14960000
149700             SET DP013-CICS-ABEND                                 14970000
149800                 DP013-NO-ROLLBACK                                14980000
149900                 DP013-XCTL-DISPLAY-RESTART                       14990000
150000                                 TO TRUE                          15000000
150100             MOVE '2100-CHECK-FUNCTION-KEY'                       15010000
150200                                 TO DP013-PARAGRAPH               15020000
150300             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      15030000
150400                                 TO DP013-MESSAGE-TEXT (1)        15040000
150500                                                                  15050000
150600             PERFORM DP013-0000-PROCESS-ABEND                     15060000
150700     END-EVALUATE.                                                15070000
150800                                                                  15080000
150900 2105-PERFORM-UPDATES.                                            15090000
151000     SET ASC-NO-OVERAGE TO TRUE.                                  15100000
151100     PERFORM 4012-LOOK-FOR-TROUBLE.                               15110000
151200     IF ASC-NO-TRBL-EXISTS                                        15120000
151300          PERFORM 4060-CREATE-TROUBLE-ROW                         15130000
151400          PERFORM 4070-UPDATE-TRB-QUEUE                           15140000
151500     END-IF.                                                      15150000
151600     PERFORM 5000-PREPARE-SEL-QUEUE                               15160000
151700     SET ASC-NO-TSQ-UPDATE                                        15170000
151800         TO TRUE.                                                 15180000
151900                                                                  15190000
152000 2110-BROWSE-BACKWARD.                                            15200000
152100                                                                  15210000
152200     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    15220000
152300         GIVING PV-TOP-ITEM.                                      15230000
152400                                                                  15240000
152500     IF PV-TOP-ITEM NOT > +1                                      15250000
152600         MOVE +1                 TO PV-TOP-ITEM                   15260000
152700         IF ASC-OVERAGE                                           15270000
152800             MOVE PC-TSYMSG-01264                                 15280000
152900                      TO DP020-MSG-NUMBER                         15290000
153000            SET DP020-MSG-FATAL                                   15300000
153100                                 TO TRUE                          15310000
153200         ELSE                                                     15320000
153300             MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER          15330000
153400             SET DP020-MSG-INFORMATIONAL                          15340000
153500                                 TO TRUE                          15350000
153600         END-IF                                                   15360000
153700     END-IF.                                                      15370000
153800                                                                  15380000
153900 2120-BROWSE-FORWARD.                                             15390000
154000                                                                  15400000
154100     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              15410000
154200         GIVING PV-TOP-ITEM.                                      15420000
154300                                                                  15430000
154400     IF PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                    15440000
154500         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            15450000
154600                                 TO PV-TOP-ITEM                   15460000
154700         IF ASC-OVERAGE                                           15470000
154800             MOVE PC-TSYMSG-01264                                 15480000
154900                      TO DP020-MSG-NUMBER                         15490000
155000            SET DP020-MSG-FATAL                                   15500000
155100                                 TO TRUE                          15510000
155200         ELSE                                                     15520000
155300             MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER          15530000
155400             SET DP020-MSG-INFORMATIONAL                          15540000
155500                                 TO TRUE                          15550000
155600         END-IF                                                   15560000
155700     ELSE                                                         15570000
155800         COMPUTE PV-BOTTOM-ITEM =                                 15580000
155900             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 15590000
156000         IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ             15600000
156100             IF ASC-OVERAGE                                       15610000
156200                 MOVE PC-TSYMSG-01264                             15620000
156300                          TO DP020-MSG-NUMBER                     15630000
156400                SET DP020-MSG-FATAL                               15640000
156500                                     TO TRUE                      15650000
156600             ELSE                                                 15660000
156700                 MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER      15670000
156800                 SET DP020-MSG-INFORMATIONAL                      15680000
156900                                     TO TRUE                      15690000
157000             END-IF                                               15700000
157100         END-IF.                                                  15710000
157200                                                                  15720000
157300 2140-DESELECT-ALL-ITEMS.                                         15730000
157400                                                                  15740000
157500     MOVE +1                     TO ASC-BLK-SUB.                  15750000
157600                                                                  15760000
157700     PERFORM 2141-CLEAR-SELECTED-INDS                             15770000
157800             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    15780000
157900             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           15790000
158000                                                                  15800000
158100     ADD +1                      TO ASC-BLK-SUB.                  15810000
158200                                                                  15820000
158300     PERFORM 2141-CLEAR-SELECTED-INDS                             15830000
158400             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    15840000
158500             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           15850000
158600                                                                  15860000
158700     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              15870000
158800                                 TO PV-LIST-ITEM-NUMBER.          15880000
158900                                                                  15890000
159000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            15900000
159100             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).15910000
159200                                                                  15920000
159300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     15930000
159400              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)15940000
159500         MOVE +1                 TO ASC-BLK-SUB                   15950000
159600                                                                  15960000
159700         PERFORM 5100-WRITE-TEMP-STORAGE                          15970000
159800                                                                  15980000
159900         MOVE +1                 TO PV-BLOCK-NUMBER               15990000
160000                                                                  16000000
160100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16010000
160200                                       PV-FIRST-BLOCK-IN-ARRAY - 116020000
160300                                                                  16030000
160400         PERFORM                                                  16040000
160500           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         16050000
160600                                                                  16060000
160700                 PERFORM 4410-READ-TEMP-STORAGE                   16070000
160800                                                                  16080000
160900                 PERFORM 2141-CLEAR-SELECTED-INDS                 16090000
161000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16100000
161100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16110000
161200                                                                  16120000
161300                 PERFORM 5100-WRITE-TEMP-STORAGE                  16130000
161400                                                                  16140000
161500                 ADD +1          TO PV-BLOCK-NUMBER               16150000
161600                                                                  16160000
161700         END-PERFORM                                              16170000
161800                                                                  16180000
161900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         16190000
162000                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY16200000
162100                                                                  16210000
162200         PERFORM                                                  16220000
162300           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         16230000
162400                                         ASC-HIGHEST-BLOCK-WRITTEN16240000
162500                                                                  16250000
162600                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      16260000
162700                                 TO PV-BLOCK-NUMBER               16270000
162800                                                                  16280000
162900                 PERFORM 4410-READ-TEMP-STORAGE                   16290000
163000                                                                  16300000
163100                 PERFORM 2141-CLEAR-SELECTED-INDS                 16310000
163200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        16320000
163300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL16330000
163400                                                                  16340000
163500                 PERFORM 5100-WRITE-TEMP-STORAGE                  16350000
163600                                                                  16360000
163700                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        16370000
163800                                                                  16380000
163900         END-PERFORM                                              16390000
164000                                                                  16400000
164100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             16410000
164200                                 TO PV-BLOCK-NUMBER               16420000
164300                                                                  16430000
164400         PERFORM 4410-READ-TEMP-STORAGE                           16440000
164500                                                                  16450000
164600     END-IF.                                                      16460000
164700                                                                  16470000
164800     MOVE ZERO                   TO ASC-NUMBER-OF-SELECTED-ITEMS  16480000
164900                                    ASC-START-OF-SELECTED-RANGE   16490000
165000                                    ASC-END-OF-SELECTED-RANGE.    16500000
165100                                                                  16510000
165200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        16520000
165300                                                                  16530000
165400 2141-CLEAR-SELECTED-INDS.                                        16540000
165500                                                                  16550000
165600     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO16560000
165700        IF NOT ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           16570000
165800            SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          16580000
165900                ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     16590000
166000                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  16600000
166100                                 TO TRUE.                         16610000
166200                                                                  16620000
166300 2150-SELECT-ALL-ITEMS.                                           16630000
166400                                                                  16640000
166500     MOVE +1                     TO ASC-BLK-SUB.                  16650000
166600                                                                  16660000
166700     PERFORM 2151-SET-SELECTED-INDS                               16670000
166800             VARYING ASC-ITEM-SUB FROM 1 BY 1                     16680000
166900             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16690000
167000                                                                  16700000
167100     ADD +1                      TO ASC-BLK-SUB.                  16710000
167200                                                                  16720000
167300     PERFORM 2151-SET-SELECTED-INDS                               16730000
167400             VARYING ASC-ITEM-SUB FROM 1 BY 1                     16740000
167500             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           16750000
167600                                                                  16760000
167700     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              16770000
167800                                 TO PV-LIST-ITEM-NUMBER.          16780000
167900                                                                  16790000
168000     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            16800000
168100             1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).16810000
168200                                                                  16820000
168300     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     16830000
168400              (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)16840000
168500         MOVE +1                 TO ASC-BLK-SUB                   16850000
168600                                                                  16860000
168700         PERFORM 5100-WRITE-TEMP-STORAGE                          16870000
168800                                                                  16880000
168900         MOVE +1                 TO PV-BLOCK-NUMBER               16890000
169000                                                                  16900000
169100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         16910000
169200                                       PV-FIRST-BLOCK-IN-ARRAY - 116920000
169300                                                                  16930000
169400         PERFORM                                                  16940000
169500           UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY         16950000
169600                                                                  16960000
169700                 PERFORM 4410-READ-TEMP-STORAGE                   16970000
169800                                                                  16980000
169900                 PERFORM 2151-SET-SELECTED-INDS                   16990000
170000                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17000000
170100                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17010000
170200                                                                  17020000
170300                 PERFORM 5100-WRITE-TEMP-STORAGE                  17030000
170400                                                                  17040000
170500                 ADD +1          TO PV-BLOCK-NUMBER               17050000
170600                                                                  17060000
170700         END-PERFORM                                              17070000
170800                                                                  17080000
170900         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         17090000
171000                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY17100000
171100                                                                  17110000
171200         PERFORM                                                  17120000
171300           UNTIL PV-NEXT-BLOCK-IN-ARRAY >                         17130000
171400                                         ASC-HIGHEST-BLOCK-WRITTEN17140000
171500                                                                  17150000
171600                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      17160000
171700                                 TO PV-BLOCK-NUMBER               17170000
171800                                                                  17180000
171900                 PERFORM 4410-READ-TEMP-STORAGE                   17190000
172000                                                                  17200000
172100                 PERFORM 2151-SET-SELECTED-INDS                   17210000
172200                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        17220000
172300                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL17230000
172400                                                                  17240000
172500                 PERFORM 5100-WRITE-TEMP-STORAGE                  17250000
172600                                                                  17260000
172700                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        17270000
172800                                                                  17280000
172900         END-PERFORM                                              17290000
173000                                                                  17300000
173100         MOVE PV-FIRST-BLOCK-IN-ARRAY                             17310000
173200                                 TO PV-BLOCK-NUMBER               17320000
173300                                                                  17330000
173400         PERFORM 4410-READ-TEMP-STORAGE                           17340000
173500     END-IF.                                                      17350000
173600                                                                  17360000
173700     MOVE ASC-NUMBER-OF-ITEMS-READ                                17370000
173800                                 TO ASC-NUMBER-OF-SELECTED-ITEMS. 17380000
173900     SUBTRACT PV-NOT-SELECTED  FROM                               17390000
174000                       ASC-NUMBER-OF-SELECTED-ITEMS.              17400000
174100                                                                  17410000
174200     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        17420000
174300                                                                  17430000
174400 2151-SET-SELECTED-INDS.                                          17440000
174500                                                                  17450000
174600     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT = ZERO17460000
174700        IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)              17470000
174800            SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)             17480000
174900                ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        17490000
175000                ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                  17500000
175100                                 TO TRUE                          17510000
175200        END-IF                                                    17520000
175300        IF   DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)               17530000
175400             IF  ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)         17540000
175500                 SET ASC-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     17550000
175600                     ASC-TEMP-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB) 17560000
175700                     ASC-SEL-ZERO-NO (ASC-BLK-SUB ASC-ITEM-SUB)   17570000
175800                     ASC-BLOCK-MODIFIED (ASC-BLK-SUB)             17580000
175900                                 TO TRUE                          17590000
176000                  ADD  1  TO  PV-NOT-SELECTED                     17600000
176100             ELSE                                                 17610000
176200                 MOVE  ZEROES TO ASC-ADJ-QTY                      17620000
176300                                 (ASC-BLK-SUB ASC-ITEM-SUB)       17630000
176400                 SET  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       17640000
176500                      ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)  17650000
176600                      ASC-BLOCK-MODIFIED (ASC-BLK-SUB)            17660000
176700                      ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB) 17670000
176800                          TO  TRUE                                17680000
176900            END-IF                                                17690000
177000        END-IF                                                    17700000
177100     END-IF.                                                      17710000
177200                                                                  17720000
177300 2180-CHECK-FOR-JUMP-BROWSE.                                      17730000
177400                                                                  17740000
177500     SET PS-NO-ERROR             TO TRUE.                         17750000
177600                                                                  17760000
177700     IF ASC-START-ITEM-REQUEST = SPACE                            17770000
177800         MOVE ASC-ITEM-AT-TOP-OF-PANEL                            17780000
177900                                 TO PV-TOP-ITEM                   17790000
178000     ELSE                                                         17800000
178100         MOVE ASC-START-ITEM-REQUEST                              17810000
178200                                 TO DP010I-UNEDITED-FIELD         17820000
178300         MOVE +5                 TO DP010I-MAXIMUM-DIGITS         17830000
178400         MOVE ZERO               TO DP010I-MAXIMUM-DECIMALS       17840000
178500         SET DP010I-NEGATIVE-NOT-ALLOWED                          17850000
178600                                 TO TRUE                          17860000
178700                                                                  17870000
178810         CALL DP010I-NUMERIC-EDIT-ROUTINE                         17881022
178820              USING DP010I-NUMERIC-EDIT-AREA                      17882022
178900                                                                  17890000
179000         IF NOT DP010I-ERROR-DETECTED                             17900000
179100             MOVE DP010I-NUMERIC-FIELD                            17910000
179200                                 TO ASC-START-ITEM-REQUEST-N      17920000
179300             IF ASC-START-ITEM-REQUEST-N > ZERO                   17930000
179400                IF ASC-START-ITEM-REQUEST-N >                     17940000
179500                                          ASC-NUMBER-OF-ITEMS-READ17950000
179600                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        17960000
179700                    COMPUTE PV-TOP-ITEM = ASC-NUMBER-OF-ITEMS-READ17970000
179800                                          - PC-ITEMS-PER-PANEL + 117980000
179900                    IF PV-TOP-ITEM < +1                           17990000
180000                        MOVE +1  TO PV-TOP-ITEM                   18000000
180100                        IF ASC-OVERAGE                            18010000
180200                            MOVE PC-TSYMSG-01264                  18020000
180300                                     TO DP020-MSG-NUMBER          18030000
180400                           SET DP020-MSG-FATAL                    18040000
180500                                                TO TRUE           18050000
180600                        ELSE                                      18060000
180700                            MOVE PC-TSYMSG-00069                  18070000
180800                                     TO DP020-MSG-NUMBER          18080000
180900                            SET DP020-MSG-INFORMATIONAL           18090000
181000                                                TO TRUE           18100000
181100                                                                  18110000
181200                        END-IF                                    18120000
181300                    ELSE                                          18130000
181400                        MOVE  PV-TOP-ITEM                         18140000
181500                          TO  ASC-START-ITEM-REQUEST-N            18150000
181600                     END-IF                                       18160000
181700                ELSE                                              18170000
181800                    MOVE ASC-START-ITEM-REQUEST-N                 18180000
181900                                 TO PV-TOP-ITEM                   18190000
182000                    MOVE SPACE   TO ASC-START-ITEM-REQUEST        18200000
182100                    COMPUTE PV-BOTTOM-ITEM = PV-TOP-ITEM +        18210000
182200                                           PC-ITEMS-PER-PANEL - 1 18220000
182300                    IF PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ  18230000
182400                         SUBTRACT  PV-TOP-ITEM                    18240000
182500                             FROM  ASC-NUMBER-OF-ITEMS-READ       18250000
182600                           GIVING  ASC-ITEMS-DISPLAYED            18260000
182700                         MOVE  ASC-NUMBER-OF-ITEMS-READ           18270000
182800                           TO  PV-BOTTOM-ITEM                     18280000
182900*2/05                   MOVE +1  TO PV-TOP-ITEM                   18290000
183000                        IF ASC-OVERAGE                            18300000
183100                            MOVE PC-TSYMSG-01264                  18310000
183200                                     TO DP020-MSG-NUMBER          18320000
183300                           SET DP020-MSG-FATAL                    18330000
183400                                                TO TRUE           18340000
183500                        ELSE                                      18350000
183600                            MOVE PC-TSYMSG-00070                  18360000
183700                                            TO DP020-MSG-NUMBER   18370000
183800                            SET DP020-MSG-INFORMATIONAL           18380000
183900                                                TO TRUE           18390000
184000                                                                  18400000
184100                        END-IF                                    18410000
184200                    END-IF                                        18420000
184300                END-IF                                            18430000
184400             ELSE                                                 18440000
184500                 MOVE PC-TSYMSG-00101                             18450000
184600                                 TO DP020-MSG-NUMBER              18460000
184700                 SET DP030-SET-CURSOR-APPL-1                      18470000
184800                                 TO TRUE                          18480000
184900                 MOVE -1         TO ASTRTITL                      18490000
185000                 MOVE DP015-UNP-NUM-BRT-MDT                       18500000
185100                                 TO ASTRTITA                      18510000
185200                 MOVE DP015-RED  TO ASTRTITC                      18520000
185300                 MOVE DP015-REVERSE                               18530000
185400                                 TO ASTRTITH                      18540000
185500                 SET PS-ERROR                                     18550000
185600                     DP020-MSG-FATAL                              18560000
185700                                 TO TRUE                          18570000
185800             END-IF                                               18580000
185900         ELSE                                                     18590000
186000             MOVE PC-TSYMSG-00008                                 18600000
186100                                 TO DP020-MSG-NUMBER              18610000
186200             SET DP030-SET-CURSOR-APPL-1                          18620000
186300                                 TO TRUE                          18630000
186400             MOVE -1             TO ASTRTITL                      18640000
186500             MOVE DP015-UNP-NUM-BRT-MDT                           18650000
186600                                 TO ASTRTITA                      18660000
186700             MOVE DP015-RED      TO ASTRTITC                      18670000
186800             MOVE DP015-REVERSE  TO ASTRTITH                      18680000
186900             SET PS-ERROR                                         18690000
187000                 DP020-MSG-FATAL TO TRUE                          18700000
187100         END-IF                                                   18710000
187200     END-IF.                                                      18720000
187300                                                                  18730000
187400 2200-MOVE-SCREEN-TO-COMMAREA.                                    18740000
187500                                                                  18750000
187600     MOVE PV-TOP-ITEM            TO PV-ITEM-IN-USE.               18760000
187700     MOVE +1                     TO PV-SUB.                       18770000
187800                                                                  18780000
187900     PERFORM 3100-SET-SUBSCRIPTS.                                 18790000
188000                                                                  18800000
188100     IF ASTRTITL > ZERO                                           18810000
188200         MOVE ASTRTITI           TO ASC-START-ITEM-REQUEST        18820000
188300     ELSE                                                         18830000
188400         IF ASTRTITF = DP015-ERASE-EOF                            18840000
188500             INITIALIZE ASC-START-ITEM-REQUEST                    18850000
188600         END-IF                                                   18860000
188700     END-IF.                                                      18870000
188800                                                                  18880000
188900     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          18890000
189000             VARYING PV-SUB  FROM 1 BY 1                          18900000
189100             UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED.                18910000
189200                                                                  18920000
189300 2210-MOVE-LINES-TO-COMMAREA.                                     18930000
189400                                                                  18940000
189500     IF MR-SELECTL (PV-SUB) > ZERO                                18950000
189600         SET ASC-BLOCK-MODIFIED    (ASC-BLK-SUB)                  18960000
189700                                 TO TRUE                          18970000
189800         MOVE MR-SELECTI (PV-SUB)                                 18980000
189900                                 TO ASC-TEMP-SELECTED-SW          18990000
190000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19000000
190100     ELSE                                                         19010000
190200         IF MR-SELECTA (PV-SUB) = DP015-ERASE-EOF                 19020000
190300             SET ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                 19030000
190400                                 TO TRUE                          19040000
190500             MOVE SPACE          TO ASC-TEMP-SELECTED-SW          19050000
190600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19060000
190700         END-IF                                                   19070000
190800     END-IF.                                                      19080000
190900                                                                  19090000
191000     IF MR-ADJ-QTY-L (PV-SUB) > ZERO                              19100000
191100         MOVE MR-ADJ-QTY (PV-SUB)                                 19110000
191200                                 TO ASC-ADJ-QTY                   19120000
191300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19130000
191400     ELSE                                                         19140000
191500         IF MR-ADJ-QTY-A (PV-SUB) = DP015-ERASE-EOF               19150000
191600             MOVE SPACES         TO ASC-ADJ-QTY                   19160000
191700                                   (ASC-BLK-SUB ASC-ITEM-SUB)     19170000
191800         END-IF                                                   19180000
191900     END-IF.                                                      19190000
192000                                                                  19200000
192100     ADD +1                      TO ASC-ITEM-SUB.                 19210000
192200                                                                  19220000
192300     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         19230000
192400         ADD  +1                 TO ASC-BLK-SUB                   19240000
192500         MOVE +1                 TO ASC-ITEM-SUB                  19250000
192600     END-IF.                                                      19260000
192700                                                                  19270000
192800******************************************************************19280000
192900* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE              *19290000
193000* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *19300000
193100******************************************************************19310000
193200 2300-GET-NEXT-RECORD.                                            19320000
193300                                                                  19330000
193400     ADD +1                      TO ASC-SEL-SUB.                  19340000
193500                                                                  19350000
193600     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             19360000
193700         ADD +1                  TO ASC-SEL-ITEM                  19370000
193800         MOVE +1                 TO ASC-SEL-SUB                   19380000
193900     END-IF.                                                      19390000
194000                                                                  19400000
194100     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 19410000
194200         PERFORM 9100-READ-SEL-QUEUE                              19420000
194300         IF RC013-ITEM (ASC-SEL-SUB) > ZERO                       19430000
194400             MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                19440000
194500                                 TO ASC-KEY-PKSL-LNE-NBR          19450000
194600             SET RC013-INQ (ASC-SEL-SUB)                          19460000
194700                                 TO TRUE                          19470000
194800             ADD +1 TO RC017-NUMBER-OF-TS-ITEMS                   19480000
194900             PERFORM 9200-REWRITE-LIST-QUEUE                      19490000
195000         ELSE                                                     19500000
195100             SUBTRACT +1 FROM ASC-SEL-SUB                         19510000
195200*            --- BOTTOM OF LIST ---                               19520000
195300             MOVE PC-TSYMSG-00070                                 19530000
195400                                 TO DP020-MSG-NUMBER              19540000
195500             SET DP020-MSG-INFORMATIONAL                          19550000
195600                                 TO TRUE                          19560000
195700         END-IF                                                   19570000
195800     ELSE                                                         19580000
195900         SUBTRACT +1 FROM ASC-SEL-ITEM                            19590000
196000         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   19600000
196100         IF ASC-OVERAGE                                           19610000
196200             MOVE PC-TSYMSG-01264                                 19620000
196300                      TO DP020-MSG-NUMBER                         19630000
196400            SET DP020-MSG-FATAL                                   19640000
196500                                 TO TRUE                          19650000
196600         ELSE                                                     19660000
196700             MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER          19670000
196800             SET DP020-MSG-INFORMATIONAL                          19680000
196900                                 TO TRUE                          19690000
197000         END-IF                                                   19700000
197100     END-IF.                                                      19710000
197200                                                                  19720000
197300/                                                                 19730000
197400******************************************************************19740000
197500* GET THE KEYS OF THE PREVIOUS SELECTED OBJECT FROM THE          *19750000
197600* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *19760000
197700******************************************************************19770000
197800 2310-GET-PREV-RECORD.                                            19780000
197900                                                                  19790000
198000     SUBTRACT +1 FROM ASC-SEL-SUB.                                19800000
198100                                                                  19810000
198200     IF ASC-SEL-SUB < +1                                          19820000
198300         SUBTRACT +1 FROM ASC-SEL-ITEM                            19830000
198400         MOVE RC013-MAX-ITEMS    TO ASC-SEL-SUB                   19840000
198500     END-IF.                                                      19850000
198600                                                                  19860000
198700     IF ASC-SEL-ITEM > ZERO                                       19870000
198800         PERFORM 9100-READ-SEL-QUEUE                              19880000
198900         MOVE RC013-PKSL-LNE-NBR (ASC-SEL-SUB)                    19890000
199000                                 TO ASC-KEY-PKSL-LNE-NBR          19900000
199100     ELSE                                                         19910000
199200         MOVE +1                 TO ASC-SEL-ITEM                  19920000
199300                                    ASC-SEL-SUB                   19930000
199400*        --- TOP OF LIST ---                                      19940000
199500         IF ASC-OVERAGE                                           19950000
199600             MOVE PC-TSYMSG-01264                                 19960000
199700                      TO DP020-MSG-NUMBER                         19970000
199800            SET DP020-MSG-FATAL                                   19980000
199900                                 TO TRUE                          19990000
200000         ELSE                                                     20000000
200100             MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER          20010000
200200             SET DP020-MSG-INFORMATIONAL                          20020000
200300                                 TO TRUE                          20030000
200400         END-IF                                                   20040000
200500                                                                  20050000
200600     END-IF.                                                      20060000
200700                                                                  20070000
200800******************************************************************20080000
200900* GET THE KEYS OF THE NEXT SELECTED OBJECT FROM THE WO           *20090000
201000* INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                       *20100000
201100******************************************************************20110000
201200 2400-GET-NEXT-WO-RECORD.                                         20120000
201300                                                                  20130000
201400     ADD +1                      TO ASC-SEL-SUB.                  20140000
201500                                                                  20150000
201600     IF ASC-SEL-SUB > RC013-MAX-ITEMS                             20160000
201700         ADD +1                  TO ASC-SEL-ITEM                  20170000
201800         MOVE +1                 TO ASC-SEL-SUB                   20180000
201900     END-IF.                                                      20190000
202000                                                                  20200000
202100     IF ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                 20210000
202200         PERFORM 9300-READ-WO-SEL-QUEUE                           20220000
202300         IF PC016-ITEM (ASC-SEL-SUB) > ZERO                       20230000
202400             MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                  20240000
202500                                 TO ASC-KEY-PKSL-LNE-NBR          20250000
202600             SET PC016-INQ (ASC-SEL-SUB)                          20260000
202700                                 TO TRUE                          20270000
202800             PERFORM 9400-REWRITE-WO-LIST-QUEUE                   20280000
202900         ELSE                                                     20290000
203000             SUBTRACT +1 FROM ASC-SEL-SUB                         20300000
203100*            --- BOTTOM OF LIST ---                               20310000
203200             MOVE PC-TSYMSG-00070                                 20320000
203300                                 TO DP020-MSG-NUMBER              20330000
203400             SET DP020-MSG-INFORMATIONAL                          20340000
203500                                 TO TRUE                          20350000
203600         END-IF                                                   20360000
203700     ELSE                                                         20370000
203800         SUBTRACT +1 FROM ASC-SEL-ITEM                            20380000
203900         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   20390000
204000         MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER              20400000
204100         SET DP020-MSG-INFORMATIONAL                              20410000
204200                                 TO TRUE                          20420000
204300     END-IF.                                                      20430000
204400                                                                  20440000
204500/                                                                 20450000
204600******************************************************************20460000
204700* GET THE KEYS OF THE PREVIOUS SELECTED WORK ORDER OBJECT FROM   *20470000
204800* THE INPUT SELECTED-ITEMS TEMP STORAGE QUEUE.                   *20480000
204900******************************************************************20490000
205000 2410-GET-PREV-WO-RECORD.                                         20500000
205100                                                                  20510000
205200     SUBTRACT +1 FROM ASC-SEL-SUB.                                20520000
205300                                                                  20530000
205400     IF ASC-SEL-SUB < +1                                          20540000
205500         SUBTRACT +1 FROM ASC-SEL-ITEM                            20550000
205600         MOVE PC016-MAX-ITEMS    TO ASC-SEL-SUB                   20560000
205700     END-IF.                                                      20570000
205800                                                                  20580000
205900     IF ASC-SEL-ITEM > ZERO                                       20590000
206000         PERFORM 9300-READ-WO-SEL-QUEUE                           20600000
206100         MOVE PC016-LINE-NBR-N (ASC-SEL-SUB)                      20610000
206200                                 TO ASC-KEY-PKSL-LNE-NBR          20620000
206300     ELSE                                                         20630000
206400         MOVE +1                 TO ASC-SEL-ITEM                  20640000
206500                                    ASC-SEL-SUB                   20650000
206600*        --- TOP OF LIST ---                                      20660000
206700         MOVE PC-TSYMSG-00069    TO DP020-MSG-NUMBER              20670000
206800         SET DP020-MSG-INFORMATIONAL                              20680000
206900                                 TO TRUE                          20690000
207000     END-IF.                                                      20700000
207100                                                                  20710000
207200 3000-EDIT-DATA-IN-COMMAREA.                                      20720000
207300                                                                  20730000
207400     SET PS-NO-ERROR             TO TRUE.                         20740000
207500                                                                  20750000
207600     PERFORM 3200-RESET-ATTRIBUTES.                               20760000
207700                                                                  20770000
207800     MOVE ASC-ITEMS-DISPLAYED    TO PV-SUB.                       20780000
207900     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       20790000
208000                                          ASC-ITEMS-DISPLAYED - 1.20800000
208100     PERFORM 3100-SET-SUBSCRIPTS.                                 20810000
208200                                                                  20820000
208300     PERFORM 3300-EDIT-SELECTIONS                                 20830000
208400             VARYING PV-SUB  FROM PV-SUB BY -1                    20840000
208500             UNTIL   PV-SUB < +1.                                 20850000
208600                                                                  20860000
208700     IF PS-NO-ERROR                                               20870000
208800         PERFORM 3400-CHECK-RANGE-SEQUENCE                        20880000
208900     END-IF.                                                      20890000
209000                                                                  20900000
209100     IF PS-NO-ERROR AND                                           20910000
209200        ASC-START-OF-SELECTED-RANGE > ZERO AND                    20920000
209300        ASC-END-OF-SELECTED-RANGE > ZERO                          20930000
209400                                                                  20940000
209500         PERFORM 3500-MARK-RANGE-AS-SELECTED                      20950000
209600     END-IF.                                                      20960000
209700                                                                  20970000
209800                                                                  20980000
209900 3100-SET-SUBSCRIPTS.                                             20990000
210000                                                                  21000000
210100     COMPUTE ASC-ITEM-SUB =                                       21010000
210200                (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER (1 1)) + 1.21020000
210300                                                                  21030000
210400     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         21040000
210500         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            21050000
210600         MOVE PC-MAX-BLOCKS-IN-ARRAY                              21060000
210700                                 TO ASC-BLK-SUB                   21070000
210800     ELSE                                                         21080000
210900         MOVE +1                 TO ASC-BLK-SUB                   21090000
211000     END-IF.                                                      21100000
211100                                                                  21110000
211200 3200-RESET-ATTRIBUTES.                                           21120000
211300                                                                  21130000
211400     SET PS-ALL-LINES-PROTECTED    TO TRUE.                       21140000
211500     IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-VERIFY          21150000
211600         MOVE DP015-ASK-DRK-OFF  TO AHDR1A                        21160000
211700                                    AHDR2A                        21170000
211800                                    AHDR3A                        21180000
211900             PERFORM VARYING PV-SUB  FROM 1 BY 1                  21190000
212000                 UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED             21200000
212100                 MOVE DP015-ASK-DRK-OFF TO                        21210000
212200                     MR-SELECTA       (PV-SUB)                    21220000
212300                     MR-ADJ-QTY-A     (PV-SUB)                    21230000
212400       MOVE SPACE    TO MR-SELECTI       (PV-SUB)                 21240000
212500                        MR-ADJ-QTY       (PV-SUB)                 21250000
212600                        MR-STR-NBR       (PV-SUB)                 21260000
212700                        MR-PKSLP-ITM-QTY (PV-SUB)                 21270000
212800                        MR-ACTUAL-ITM-QTY (PV-SUB)                21280000
212900                        MR-VERFD-ITM-QTY (PV-SUB)                 21290000
213000             END-PERFORM                                          21300000
213100     END-IF.                                                      21310000
213200                                                                  21320000
213300     MOVE DP015-HL-OFF           TO APKTOTH.                      21330000
213400     MOVE DP015-BLUE             TO APKTOTC.                      21340000
213500                                                                  21350000
213600     MOVE DP015-HL-OFF           TO AACTOTH.                      21360000
213700     MOVE DP015-BLUE             TO AACTOTC.                      21370000
213800                                                                  21380000
213900     MOVE DP015-HL-OFF           TO AVFTOTH.                      21390000
214000     MOVE DP015-BLUE             TO AVFTOTC.                      21400000
214100                                                                  21410000
214200     MOVE DP015-UNP-ALP-NOR-OFF  TO ASTRTITA.                     21420000
214300     MOVE DP015-GREEN            TO ASTRTITC.                     21430000
214400     MOVE DP015-UNDERLINE        TO ASTRTITH.                     21440000
214500                                                                  21450000
214600                                                                  21460000
214700     IF ASC-CANT-UPDATE                                           21470000
214800         SET PS-ERROR TO TRUE                                     21480000
214900         PERFORM VARYING PV-SUB  FROM 1 BY 1                      21490000
215000                 UNTIL   PV-SUB > PC-ITEMS-PER-PANEL              21500000
215100                 MOVE DP015-ASK-NOR-OFF                           21510000
215200                                 TO MR-SELECTA   (PV-SUB)         21520000
215300                                    MR-ADJ-QTY-A (PV-SUB)         21530000
215400                 MOVE DP015-BLUE                                  21540000
215500                                 TO MR-SELECTC   (PV-SUB)         21550000
215600                                    MR-ADJ-QTY-C (PV-SUB)         21560000
215700                 MOVE DP015-HL-OFF                                21570000
215800                                 TO MR-SELECTH   (PV-SUB)         21580000
215900                                    MR-ADJ-QTY-H (PV-SUB)         21590000
216000         END-PERFORM                                              21600000
216100     ELSE                                                         21610000
216200          PERFORM VARYING PV-SUB  FROM 1 BY 1                     21620000
216300              UNTIL   PV-SUB > ASC-ITEMS-DISPLAYED                21630000
216400         IF MR-ADJ-QTY-A (PV-SUB) = DP015-ASK-DRK-OFF             21640000
216500              CONTINUE                                            21650000
216600         ELSE                                                     21660000
216700              IF ASC-OVERAGE                                      21670000
216800                  IF MR-ADJ-QTY-C (PV-SUB) = DP015-YELLOW         21680000
216900                     MOVE DP015-PRO-NOR-OFF                       21690000
217000                                     TO MR-SELECTA   (PV-SUB)     21700000
217100                     MOVE DP015-PRO-NOR-OFF                       21710000
217200                                     TO MR-ADJ-QTY-A (PV-SUB)     21720000
217300                     MOVE DP015-UNDERLINE                         21730000
217400                                 TO MR-SELECTH   (PV-SUB)         21740000
217500                                    MR-ADJ-QTY-H (PV-SUB)         21750000
217600                     MOVE DP015-BLUE                              21760000
217700                                 TO MR-SELECTC   (PV-SUB)         21770000
217800                 ELSE                                             21780000
217900                     MOVE DP015-PRO-NOR-OFF                       21790000
218000                                     TO MR-SELECTA   (PV-SUB)     21800000
218100                     MOVE SPACE                                   21810000
218200                                     TO MR-SELECTI   (PV-SUB)     21820000
218300                     MOVE DP015-PRO-NOR-OFF                       21830000
218400                                     TO MR-ADJ-QTY-A (PV-SUB)     21840000
218500                     IF MR-ADJ-QTY-C (PV-SUB) =                   21850000
218600                                       DP015-GREEN                21860000
218700                         MOVE DP015-BLUE                          21870000
218800                                     TO MR-ADJ-QTY-C (PV-SUB)     21880000
218900                     ELSE                                         21890000
219000                         CONTINUE                                 21900000
219100                     END-IF                                       21910000
219200                     MOVE DP015-BLUE                              21920000
219300                                     TO MR-SELECTC   (PV-SUB)     21930000
219400                     MOVE DP015-UNDERLINE                         21940000
219500                                     TO MR-SELECTH   (PV-SUB)     21950000
219600                                        MR-ADJ-QTY-H (PV-SUB)     21960000
219700                 END-IF                                           21970000
219800             ELSE                                                 21980000
219900                     MOVE DP015-UNP-ALP-NOR-OFF                   21990000
220000                                 TO MR-SELECTA   (PV-SUB)         22000000
220100                     MOVE DP015-UNP-NUM-NOR-OFF                   22010000
220200                                 TO MR-ADJ-QTY-A (PV-SUB)         22020000
220300                     MOVE DP015-GREEN                             22030000
220400                                 TO MR-SELECTC   (PV-SUB)         22040000
220500                                    MR-ADJ-QTY-C (PV-SUB)         22050000
220600                     MOVE DP015-UNDERLINE                         22060000
220700                                 TO MR-SELECTH   (PV-SUB)         22070000
220800                                    MR-ADJ-QTY-H (PV-SUB)         22080000
220900                     MOVE DP015-BLUE                              22090000
221000                                 TO MR-STR-NBR-C (PV-SUB)         22100000
221100           END-IF                                                 22110000
221200         END-IF                                                   22120000
221300       END-PERFORM                                                22130000
221400     END-IF.                                                      22140000
221500                                                                  22150000
221600 3300-EDIT-SELECTIONS.                                            22160000
221700                                                                  22170000
221800     EVALUATE TRUE                                                22180000
221900         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   22190000
222000                   ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     22200000
222100              CONTINUE                                            22210000
222200                                                                  22220000
222300         WHEN ASC-TEMP-SELECT   (ASC-BLK-SUB ASC-ITEM-SUB)        22230000
222400              IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        22240000
222500                  ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS  22250000
222600                  MOVE ASC-TEMP-SELECTED-SW                       22260000
222700                                        (ASC-BLK-SUB ASC-ITEM-SUB)22270000
222800                                 TO ASC-SELECTED-SW               22280000
222900                                        (ASC-BLK-SUB ASC-ITEM-SUB)22290000
223000              END-IF                                              22300000
223100                                                                  22310000
223200         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) =   22320000
223300                                                             SPACE22330000
223400              EVALUATE TRUE                                       22340000
223500                  WHEN ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)     22350000
223600                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS22360000
223700                     MOVE SPACE  TO ASC-SELECTED-SW               22370000
223800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22380000
223900                                                                  22390000
224000                  WHEN ASC-BEGIN   (ASC-BLK-SUB ASC-ITEM-SUB)     22400000
224100                       MOVE ZERO TO ASC-START-OF-SELECTED-RANGE   22410000
224200                       MOVE SPACE                                 22420000
224300                                 TO ASC-SELECTED-SW               22430000
224400                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22440000
224500                                                                  22450000
224600                  WHEN ASC-END     (ASC-BLK-SUB ASC-ITEM-SUB)     22460000
224700                       MOVE ZERO TO ASC-END-OF-SELECTED-RANGE     22470000
224800                       MOVE SPACE                                 22480000
224900                                 TO ASC-SELECTED-SW               22490000
225000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22500000
225100             END-EVALUATE                                         22510000
225200                                                                  22520000
225300         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           22530000
225400              IF ASC-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)           22540000
225500                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   22550000
225600              END-IF                                              22560000
225700                                                                  22570000
225800              PERFORM 3310-EDIT-RANGE                             22580000
225900                                                                  22590000
226000         WHEN ASC-TEMP-END  (ASC-BLK-SUB ASC-ITEM-SUB)            22600000
226100              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22610000
226200                  SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS   22620000
226300              END-IF                                              22630000
226400                                                                  22640000
226500              PERFORM 3310-EDIT-RANGE                             22650000
226600                                                                  22660000
226700         WHEN OTHER                                               22670000
226800              MOVE PC-TSYMSG-00005                                22680000
226900                                 TO DP020-MSG-NUMBER              22690000
227000              SET PS-ERROR                                        22700000
227100                  DP020-MSG-FATAL                                 22710000
227200                  DP030-SET-CURSOR-APPL-1                         22720000
227300                                 TO TRUE                          22730000
227400              MOVE -1            TO MR-SELECTL (PV-SUB)           22740000
227500              MOVE DP015-RED     TO MR-SELECTC (PV-SUB)           22750000
227600              MOVE DP015-REVERSE TO MR-SELECTH (PV-SUB)           22760000
227700              IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            22770000
227800                  SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    22780000
227900                  MOVE SPACE     TO ASC-SELECTED-SW               22790000
228000                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22800000
228100              END-IF                                              22810000
228200     END-EVALUATE.                                                22820000
228300                                                                  22830000
228400     IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)                     22840000
228500         IF ASC-ADJ-QTY (ASC-BLK-SUB ASC-ITEM-SUB) > SPACES       22850000
228600             MOVE ASC-ADJ-QTY      (ASC-BLK-SUB ASC-ITEM-SUB)     22860000
228700                                 TO DP010I-UNEDITED-FIELD         22870000
228800             MOVE LENGTH OF ASC-ADJ-QTY                           22880000
228900                                   (ASC-BLK-SUB ASC-ITEM-SUB)     22890000
229000                                 TO DP010I-MAXIMUM-DIGITS         22900000
229100             MOVE ZERO           TO DP010I-MAXIMUM-DECIMALS       22910000
229200             SET DP010I-NEGATIVE-NOT-ALLOWED                      22920000
229300                                 TO TRUE                          22930000
229410             CALL DP010I-NUMERIC-EDIT-ROUTINE                     22941022
229420                  USING DP010I-NUMERIC-EDIT-AREA                  22942022
229500                                                                  22950000
229600             IF  DP010I-ERROR-DETECTED                            22960000
229700                 SET PS-ERROR                                     22970000
229800                     DP020-MSG-FATAL                              22980000
229900                     DP030-SET-CURSOR-APPL-1                      22990000
230000                                 TO TRUE                          23000000
230100                 MOVE PC-TSYMSG-00005                             23010000
230200                                 TO DP020-MSG-NUMBER              23020000
230300                 MOVE -1         TO MR-ADJ-QTY-L (PV-SUB)         23030000
230400                 MOVE DP015-RED  TO MR-ADJ-QTY-C (PV-SUB)         23040000
230500                 MOVE DP015-REVERSE                               23050000
230600                                 TO MR-ADJ-QTY-H (PV-SUB)         23060000
230700                 SET DP030-SET-CURSOR-APPL-1                      23070000
230800                                 TO TRUE                          23080000
230900                 IF ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)         23090000
231000                      SUBTRACT 1 FROM                             23100000
231100                         ASC-NUMBER-OF-SELECTED-ITEMS             23110000
231200                      MOVE SPACE     TO ASC-SELECTED-SW           23120000
231300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     23130000
231400                 END-IF                                           23140000
231500             ELSE                                                 23150000
231600                 MOVE DP010I-NUMERIC-FIELD                        23160000
231700                                 TO ASC-ADJ-QTY-N                 23170000
231800                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23180000
231900                 ADD ASC-ADJ-QTY-N                                23190000
232000                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23200000
232100                         TO ASC-KEY-DISTR-LNE-QTY                 23210000
232200                 MOVE ASC-KEY-DISTR-LNE-QTY TO AVFTOTO            23220000
232300                 MOVE ASC-ADJ-QTY-N (ASC-BLK-SUB ASC-ITEM-SUB)    23230000
232400                                 TO MR-ADJ-QTY (PV-SUB)           23240000
232500             END-IF                                               23250000
232600         ELSE                                                     23260000
232700             MOVE ASC-ADJ-QTY-N(ASC-BLK-SUB ASC-ITEM-SUB)         23270000
232800                                    TO ASC-ADJ-QTY-N              23280000
232900                                    (ASC-BLK-SUB ASC-ITEM-SUB)    23290000
233000                                    MR-ADJ-QTY (PV-SUB)           23300000
233100         END-IF                                                   23310000
233200     END-IF.                                                      23320000
233300                                                                  23330000
233400     SUBTRACT +1 FROM PV-ITEM-IN-USE                              23340000
233500                      ASC-ITEM-SUB.                               23350000
233600                                                                  23360000
233700     IF ASC-ITEM-SUB < 1                                          23370000
233800         SUBTRACT +1 FROM ASC-BLK-SUB                             23380000
233900         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  23390000
234000     END-IF.                                                      23400000
234100                                                                  23410000
234200 3310-EDIT-RANGE.                                                 23420000
234300                                                                  23430000
234400     IF ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                 23440000
234500        IF ASC-START-OF-SELECTED-RANGE = ZERO                     23450000
234600            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  23460000
234700                   TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)  23470000
234800            MOVE PV-ITEM-IN-USE  TO ASC-START-OF-SELECTED-RANGE   23480000
234900        ELSE                                                      23490000
235000            IF ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE       23500000
235100                CONTINUE                                          23510000
235200            ELSE                                                  23520000
235300                MOVE PC-TSYMSG-00054                              23530000
235400                                 TO DP020-MSG-NUMBER              23540000
235500                SET DP020-MSG-FATAL                               23550000
235600                    PS-ERROR                                      23560000
235700                    DP030-SET-CURSOR-APPL-1                       23570000
235800                                 TO TRUE                          23580000
235900                MOVE -1          TO MR-SELECTL (PV-SUB)           23590000
236000                MOVE DP015-RED   TO MR-SELECTC (PV-SUB)           23600000
236100                MOVE DP015-UNDERLINE                              23610000
236200                                 TO MR-SELECTH (PV-SUB)           23620000
236300            END-IF                                                23630000
236400        END-IF                                                    23640000
236500     ELSE                                                         23650000
236600         IF ASC-END-OF-SELECTED-RANGE = ZERO                      23660000
236700             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23670000
236800                    TO ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 23680000
236900             MOVE PV-ITEM-IN-USE TO ASC-END-OF-SELECTED-RANGE     23690000
237000         ELSE                                                     23700000
237100             IF ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE        23710000
237200                 CONTINUE                                         23720000
237300             ELSE                                                 23730000
237400                MOVE PC-TSYMSG-00055                              23740000
237500                                 TO DP020-MSG-NUMBER              23750000
237600                SET DP020-MSG-FATAL                               23760000
237700                    PS-ERROR                                      23770000
237800                    DP030-SET-CURSOR-APPL-1                       23780000
237900                                 TO TRUE                          23790000
238000                MOVE -1          TO MR-SELECTL (PV-SUB)           23800000
238100             END-IF                                               23810000
238200         END-IF                                                   23820000
238300     END-IF.                                                      23830000
238400                                                                  23840000
238500                                                                  23850000
238600 3400-CHECK-RANGE-SEQUENCE.                                       23860000
238700                                                                  23870000
238800     IF ASC-START-OF-SELECTED-RANGE > ZERO AND                    23880000
238900        ASC-END-OF-SELECTED-RANGE   > ZERO AND                    23890000
239000        ASC-START-OF-SELECTED-RANGE > ASC-END-OF-SELECTED-RANGE   23900000
239100         MOVE PC-TSYMSG-00052    TO DP020-MSG-NUMBER              23910000
239200         SET PS-ERROR                                             23920000
239300             DP020-MSG-FATAL     TO TRUE                          23930000
239400                                                                  23940000
239500         PERFORM 3410-POSITION-AT-ERROR                           23950000
239600     END-IF.                                                      23960000
239700                                                                  23970000
239800 3410-POSITION-AT-ERROR.                                          23980000
239900                                                                  23990000
240000     SET DP030-SET-CURSOR-APPL-1 TO TRUE.                         24000000
240100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               24010000
240200                                                  PV-TOP-ITEM + 1.24020000
240300     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       24030000
240400         CONTINUE                                                 24040000
240500     ELSE                                                         24050000
240600         MOVE -1                 TO MR-SELECTL (PV-SUB)           24060000
240700         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           24070000
240800         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           24080000
240900     END-IF.                                                      24090000
241000                                                                  24100000
241100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.24110000
241200     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       24120000
241300         CONTINUE                                                 24130000
241400     ELSE                                                         24140000
241500         MOVE -1                 TO MR-SELECTL (PV-SUB)           24150000
241600         MOVE DP015-RED          TO MR-SELECTC (PV-SUB)           24160000
241700         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           24170000
241800     END-IF.                                                      24180000
241900                                                                  24190000
242000 3500-MARK-RANGE-AS-SELECTED.                                     24200000
242100                                                                  24210000
242200     MOVE +1                     TO ASC-BLK-SUB.                  24220000
242300                                                                  24230000
242400     PERFORM 3510-MARK-SELECTED-INDS                              24240000
242500             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    24250000
242600             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           24260000
242700                                                                  24270000
242800     ADD +1                      TO ASC-BLK-SUB.                  24280000
242900                                                                  24290000
243000     PERFORM 3510-MARK-SELECTED-INDS                              24300000
243100             VARYING ASC-ITEM-SUB  FROM 1 BY 1                    24310000
243200             UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.           24320000
243300                                                                  24330000
243400     MOVE ASC-LIST-ITEM-NUMBER (1 1)                              24340000
243500                                 TO PV-LIST-ITEM-NUMBER.          24350000
243600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY = 1 +                        24360000
243700                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).24370000
243800     MOVE ASC-START-OF-SELECTED-RANGE                             24380000
243900                                 TO PV-START-OF-SELECTED-RANGE.   24390000
244000     COMPUTE PV-FIRST-BLOCK-IN-RANGE = 1 +                        24400000
244100             ((PV-START-OF-SELECTED-RANGE - 1) /                  24410000
244200                                              PC-ITEMS-PER-PANEL).24420000
244300     MOVE ASC-END-OF-SELECTED-RANGE                               24430000
244400                                 TO PV-END-OF-SELECTED-RANGE.     24440000
244500     COMPUTE PV-LAST-BLOCK-IN-RANGE = 1 +                         24450000
244600             ((PV-END-OF-SELECTED-RANGE - 1) /                    24460000
244700                                              PC-ITEMS-PER-PANEL).24470000
244800     COMPUTE PV-NEXT-BLOCK-IN-ARRAY = PV-FIRST-BLOCK-IN-ARRAY + 1.24480000
244900                                                                  24490000
245000     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    24500000
245100        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        24510000
245200         MOVE +1                 TO ASC-BLK-SUB                   24520000
245300                                                                  24530000
245400         PERFORM 5100-WRITE-TEMP-STORAGE                          24540000
245500                                                                  24550000
245600         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         24560000
245700                                       PV-FIRST-BLOCK-IN-ARRAY - 124570000
245800                                                                  24580000
245900         PERFORM                                                  24590000
246000           UNTIL PV-FIRST-BLOCK-IN-RANGE > PV-PREV-BLOCK-IN-ARRAY 24600000
246100                 MOVE PV-FIRST-BLOCK-IN-RANGE                     24610000
246200                                 TO PV-BLOCK-NUMBER               24620000
246300                                                                  24630000
246400                 PERFORM 4410-READ-TEMP-STORAGE                   24640000
246500                                                                  24650000
246600                 PERFORM 3510-MARK-SELECTED-INDS                  24660000
246700                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        24670000
246800                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL24680000
246900                                                                  24690000
247000                 PERFORM 5100-WRITE-TEMP-STORAGE                  24700000
247100                                                                  24710000
247200                 ADD +1          TO PV-FIRST-BLOCK-IN-RANGE       24720000
247300         END-PERFORM                                              24730000
247400                                                                  24740000
247500         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         24750000
247600                  PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY24760000
247700         PERFORM                                                  24770000
247800           UNTIL PV-NEXT-BLOCK-IN-ARRAY > PV-LAST-BLOCK-IN-RANGE  24780000
247900                 MOVE PV-NEXT-BLOCK-IN-ARRAY                      24790000
248000                                 TO PV-BLOCK-NUMBER               24800000
248100                                                                  24810000
248200                 PERFORM 4410-READ-TEMP-STORAGE                   24820000
248300                                                                  24830000
248400                 PERFORM 3510-MARK-SELECTED-INDS                  24840000
248500                         VARYING ASC-ITEM-SUB  FROM 1 BY 1        24850000
248600                         UNTIL   ASC-ITEM-SUB > PC-ITEMS-PER-PANEL24860000
248700                                                                  24870000
248800                 PERFORM 5100-WRITE-TEMP-STORAGE                  24880000
248900                                                                  24890000
249000                 ADD +1          TO PV-NEXT-BLOCK-IN-ARRAY        24900000
249100         END-PERFORM                                              24910000
249200                                                                  24920000
249300         MOVE PV-FIRST-BLOCK-IN-ARRAY                             24930000
249400                                 TO PV-BLOCK-NUMBER               24940000
249500                                                                  24950000
249600         PERFORM 4410-READ-TEMP-STORAGE                           24960000
249700                                                                  24970000
249800     END-IF.                                                      24980000
249900                                                                  24990000
250000     MOVE ZERO                   TO ASC-START-OF-SELECTED-RANGE   25000000
250100                                    ASC-END-OF-SELECTED-RANGE.    25010000
250200                                                                  25020000
250300 3510-MARK-SELECTED-INDS.                                         25030000
250400                                                                  25040000
250500     IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT <     25050000
250600                                       ASC-START-OF-SELECTED-RANGE25060000
250700        IF ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB ASC-ITEM-SUB) NOT >  25070000
250800                                         ASC-END-OF-SELECTED-RANGE25080000
250900           IF NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)           25090000
251000               SET ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)          25100000
251100                   ASC-BLOCK-MODIFIED (ASC-BLK-SUB)               25110000
251200                   ASC-TEMP-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)     25120000
251300                                 TO TRUE                          25130000
251400               ADD +1            TO ASC-NUMBER-OF-SELECTED-ITEMS  25140000
251500           END-IF                                                 25150000
251600        END-IF                                                    25160000
251700     END-IF.                                                      25170000
251800     EJECT                                                        25180000
251900 4000-BUILD-INITIAL-PANEL.                                        25190000
252000                                                                  25200000
252100     INITIALIZE ASC-BLOCK-ENTRIES (1)                             25210000
252200                ASC-BLOCK-ENTRIES (2).                            25220000
252300                                                                  25230000
252400     MOVE +1                     TO ASC-BLK-SUB.                  25240000
252500     SET ASC-MORE-RECDIS         TO TRUE.                         25250000
252600                                                                  25260000
252700     MOVE ZERO                   TO ASC-ITEM-SUB                  25270000
252800                                    ASC-NUMBER-OF-ITEMS-READ      25280000
252900                                    ASC-NUMBER-OF-SELECTED-ITEMS  25290000
253000                                    ASC-HIGHEST-BLOCK-WRITTEN     25300000
253100                                    ASC-START-OF-SELECTED-RANGE   25310000
253200                                    ASC-END-OF-SELECTED-RANGE     25320000
253300                                    ASC-ITEM-AT-TOP-OF-PANEL.     25330000
253400                                                                  25340000
253500     PERFORM 4010-FORMAT-KEYS.                                    25350000
253600                                                                  25360000
253700                                                                  25370000
253800     PERFORM 4020-GET-TRECITM-DATA.                               25380000
253900     PERFORM 4011-LOOK-FOR-TROUBLE.                               25390000
254000                                                                  25400000
254100     PERFORM 4300-GET-DEPARTMENT.                                 25410000
254200     PERFORM 4100-SELECT-PURITM-DATA.                             25420000
254300                                                                  25430000
254400*----------------------------------------------------------------*25440000
254500*                                                    WR # 21361  *25450000
254600* ADDED CODE TO CHECK FOR THE DUMMY SKU AND CALL TO XLKUT001     *25460000
254700*----------------------------------------------------------------*25470000
254800     IF PURITM-ITM-NBR < 0                                        25480000
254900        MOVE '4000-BUILD-INITIAL-PANEL'  TO DP013-PARAGRAPH       25490000
255000        MOVE 'ITEM NUMBER IS LESS THAN ZERO'                      25500000
255100                              TO DP013-MESSAGE-TEXT (1)           25510000
255200        PERFORM DP013-0000-PROCESS-ABEND                          25520000
255300     END-IF.                                                      25530000
255400                                                                  25540000
255500     IF PURITM-ITM-NBR = 0                                        25550000
255600        IF PURITM-SKU-SEQ-NBR = PC-000                            25560000
255700           MOVE '00000000'  TO PV-SKU-NBR                         25570000
255800        ELSE                                                      25580000
255900           IF PURITM-SKU-SEQ-NBR = PC-999                         25590000
256000              MOVE '99999999' TO PV-SKU-NBR                       25600000
256100           ELSE                                                   25610000
256200              MOVE '4000-BUILD-INITIAL-PANEL'                     25620000
256300                      TO DP013-PARAGRAPH                          25630000
256400              MOVE 'ITEM NUMBER IS NOT VALID'                     25640000
256500                      TO DP013-MESSAGE-TEXT (1)                   25650000
256600              PERFORM DP013-0000-PROCESS-ABEND                    25660000
256700           END-IF                                                 25670000
256800        END-IF                                                    25680000
256900     END-IF                                                       25690000
257000                                                                  25700000
257100     IF PURITM-ITM-NBR > 0 AND                                    25710000
257200      PS-CALL-API-YES    AND                                      25720000
257300      ((PURITM-SKU-SEQ-NBR NOT = PC-000) AND                      25730000
257400      (PURITM-SKU-SEQ-NBR NOT = PC-999))                          25740000
257500        PERFORM 4105-CALL-XLKUT-DOMAIN-PGM                        25750000
257600     END-IF.                                                      25760000
257700                                                                  25770000
257800     MOVE PV-SN-DEPT-NBR   TO ASC-DEPT.                           25780000
257900     MOVE PV-SN-CL-NBR     TO ASC-CLASS.                          25790000
258000     MOVE PV-SKU-NBR       TO ASC-SKU-NBR.                        25800000
258100*----------------------------------------------------------------*25810000
258200* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *25820000
258300*----------------------------------------------------------------*25830000
258400     PERFORM 5820-GET-RECDIS-QTY.                                 25840000
258500     MOVE RECDIS-AP-VERIFY-ITM-QTY  TO ASC-TOT-VERIFY-QTY.        25850000
258600     MOVE RECDIS-VERIFY-ITM-QTY     TO ASC-TOT-ACTUAL-QTY.        25860000
258700     MOVE RECDIS-EXPTED-ITM-QTY     TO ASC-TOT-PCKSLP-QTY.        25870000
258800                                                                  25880000
258900     PERFORM 4280-GET-FACILITY-DESC.                              25890000
259000     PERFORM 4290-GET-TRECEIV.                                    25900000
259100                                                                  25910000
259200     PERFORM 4240-OPEN-CURSOR.                                    25920000
259300     PERFORM 4250-GET-REC-DISTRO.                                 25930000
259400     PERFORM 4270-CLOSE-CURSOR.                                   25940000
259500                                                                  25950000
259600                                                                  25960000
259700     MOVE PV-DISTR-LNE-QTY       TO ASC-KEY-DISTR-LNE-QTY.        25970000
259800                                                                  25980000
259900                                                                  25990000
260000                                                                  26000000
260100     MOVE +1                     TO PV-TOP-ITEM.                  26010000
260200                                                                  26020000
260300         SET DP030-SET-CURSOR-APPL-1                              26030000
260400                                 TO TRUE                          26040000
260500         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                    26050000
260600 4000-EXIT.                                                       26060000
260700     EXIT.                                                        26070000
260800                                                                  26080000
260900 4010-FORMAT-KEYS.                                                26090000
261000                                                                  26100000
261100     MOVE ASC-KEY-PO-NBR-N       TO DK-PO-NBR.                    26110000
261200     MOVE ASC-KEY-PKSL-LNE-NBR   TO DK-PKSL-LNE-NBR.              26120000
261300     MOVE ASC-KEY-REC-SEQ-NBR-N  TO DK-REC-SEQ-NBR.               26130000
261400                                                                  26140000
261500 4011-LOOK-FOR-TROUBLE.                                           26150000
261600                                                                  26160000
261700     EXEC SQL                                                     26170000
261800         SELECT B.TRBL_SHT_DESC                                   26180000
261900         INTO :TRBRSN-TRBL-SHT-DESC                               26190000
262000         FROM  TTRBNTF A                                          26200000
262100              ,TTRBRSN B                                          26210000
262200         WHERE  A.PO_NBR           =   :DK-PO-NBR                 26220000
262300         AND    A.REC_SEQ_NBR      =   :DK-REC-SEQ-NBR            26230000
262400         AND  ((A.PO_LNE_NBR       =   :DK-PKSL-LNE-NBR           26240000
262500         AND    B.TRBL_LVL_IND      <> :PC-M)                     26250000
262600         OR    (A.PREPK_ID         =   :RECITM-PREPK-ID           26260000
262700         AND    B.TRBL_LVL_IND      =  :PC-M))                    26270000
262800         AND    A.RESOLVED_IND     IN (:PC-N, :PC-I)              26280000
262900         AND    A.TRBL_RSN_CDE     =    B.TRBL_RSN_CDE            26290000
263000         AND    B.PO_UPD_IND       =   :PC-A                      26300000
263100     END-EXEC                                                     26310000
263200                                                                  26320000
263300     EVALUATE TRUE                                                26330000
263400         WHEN SQLCODE = ZERO                                      26340000
263500             SET ASC-TRBL-EXISTS           TO TRUE                26350000
263600         WHEN SQLCODE = -811                                      26360000
263700         WHEN SQLCODE = +100                                      26370000
263800             SET ASC-NO-TRBL-EXISTS        TO TRUE                26380000
263900         WHEN SQLCODE = -904                                      26390000
264000         WHEN SQLCODE = -911                                      26400000
264100         WHEN SQLCODE = -913                                      26410000
264200             PERFORM 9900-SOFT-ABORT                              26420000
264300         WHEN SQLWARN0 NOT = SPACE                                26430000
264400         WHEN SQLCODE < ZERO                                      26440000
264500         WHEN SQLCODE > ZERO                                      26450000
264600             MOVE '4011-LOOK-FOR-TROUBLE'                         26460000
264700                             TO DP013-PARAGRAPH                   26470000
264800             MOVE 'SELECT ON TTRBNTF/TTRBRSN'                     26480000
264900                             TO DP013-MESSAGE-TEXT (1)            26490000
265000             MOVE SQLCA          TO DP013-SQLCA                   26500000
265100             MOVE 'TTRBNTF'      TO DP013-DB2-TABLE-NAME (1)      26510000
265200             MOVE 'TTRBRSN'      TO DP013-DB2-TABLE-NAME (2)      26520000
265300             SET DP013-DB2-ABEND                                  26530000
265400                 DP013-XCTL-DISPLAY-RESTART                       26540000
265500                             TO TRUE                              26550000
265600              PERFORM DP013-0000-PROCESS-ABEND                    26560000
265700     END-EVALUATE.                                                26570000
265800                                                                  26580000
265900                                                                  26590000
266000*----------------------------------------------------------------*26600000
266100*    GET THE STORE TYPE.                                         *26610000
266200*----------------------------------------------------------------*26620000
266300                                                                  26630000
266400 4014-GET-STORE-TYPE.                                             26640000
266500                                                                  26650000
266600                                                                  26660000
266700     EXEC SQL                                                     26670000
266800          SELECT                                                  26680000
266900                 LOC_TYP_CDE                                      26690007
267000                ,LOC_NBR                                          26700007
267100           INTO                                                   26710000
267200                :XLT00010-LOC-TYP-CDE                             26720007
267300               ,:XLT00010-LOC-NBR                                 26730007
267400           FROM                                                   26740000
267500                 XLT_LOC                                          26750007
267600           WHERE                                                  26760009
267700                 LOC_NBR          =  :RECEIV-OPER-UNT-ID          26770007
267800     END-EXEC.                                                    26780000
267900                                                                  26790000
268000     EVALUATE TRUE                                                26800000
268100         WHEN SQLCODE = ZERO                                      26810000
268200              MOVE RECDIS-STR-NBR  TO DK-STR-NBR-N                26820006
268300                                      DK-STORE                    26830006
268400              IF  XLT00010-LOC-TYP-CDE EQUAL PC-DC                26840007
268500                  SET ASC-DC-STORE-TYPE                           26850000
268600                               TO  TRUE                           26860000
268700              ELSE                                                26870000
268800                  SET ASC-NOT-DC-STORE-TYPE                       26880000
268900                               TO  TRUE                           26890000
269000              END-IF                                              26900000
269100         WHEN SQLWARN0 NOT = SPACES                               26910000
269200         WHEN SQLCODE < ZERO                                      26920000
269300         WHEN SQLCODE > ZERO                                      26930000
269400             MOVE '4030-GET-STORE-TYPE'                           26940000
269500                               TO DP013-PARAGRAPH                 26950000
269600             MOVE 'GET STORE TYPE'                                26960000
269700                               TO DP013-MESSAGE-TEXT (1)          26970000
269800             MOVE SQLCA        TO DP013-SQLCA                     26980000
269900             MOVE 'XLT_LOC '   TO DP013-DB2-TABLE-NAME (1)        26990007
270000             SET DP013-DB2-ABEND                                  27000000
270100                 DP013-XCTL-DISPLAY-RESTART TO TRUE               27010000
270200             PERFORM DP013-0000-PROCESS-ABEND                     27020000
270300     END-EVALUATE.                                                27030000
270400                                                                  27040000
270500                                                                  27050000
270600 4012-LOOK-FOR-TROUBLE.                                           27060000
270700      PERFORM 9500-READ-TRB-QUEUE.                                27070000
270800      IF TM003-CYC-ADJ-NBR = 0                                    27080000
270900           SET ASC-NO-TRBL-EXISTS TO TRUE                         27090000
271000      ELSE                                                        27100000
271100          SET LINE-INDEX TO 1                                     27110000
271200          PERFORM 4013-SEARCH-TRB-TABLE                           27120000
271300             UNTIL PS-EOT-TRB-TABLE                               27130000
271400      END-IF.                                                     27140000
271500                                                                  27150000
271600                                                                  27160000
271700 4013-SEARCH-TRB-TABLE.                                           27170000
271800      IF TM003-TBL-LNE-NBR (LINE-INDEX) = RC017-PO-LNE-NBR        27180000
271900           AND TM003-TBL-LNE-UPDATED (LINE-INDEX)                 27190000
272000                 SET ASC-TRBL-EXISTS TO TRUE                      27200000
272100                 MOVE TM003-CYC-ADJ-NBR TO PV-CYC-ADJ-NBR         27210000
272200                                           PV-CYC-ADJ-BEF         27220000
272300                 MOVE TM003-TBL-NOTIF-NBR (LINE-INDEX) TO         27230000
272400                                     PV-NOTIF-NBR                 27240000
272500                                     PV-NOTIF-BEF                 27250000
272600                 SET PS-EOT-TRB-TABLE TO TRUE                     27260000
272700       ELSE                                                       27270000
272800           IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                  27280000
272900               SET ASC-NO-TRBL-EXISTS TO TRUE                     27290000
273000               SET PS-EOT-TRB-TABLE TO TRUE                       27300000
273100     END-IF.                                                      27310000
273200     SET LINE-INDEX UP BY 1.                                      27320000
273300                                                                  27330000
273400                                                                  27340000
273500 4020-GET-TRECITM-DATA.                                           27350000
273600     EXEC SQL                                                     27360000
273700           SELECT PREPK_ID                                        27370000
273800             INTO :RECITM-PREPK-ID                                27380000
273900             FROM TRECITM                                         27390000
274000            WHERE ORD_NBR            = :DK-PO-NBR                 27400000
274100              AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR           27410000
274200              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            27420000
274300              AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID       27430000
274400              AND FCLTY_ID           = :ASC-KEY-FCLTY-ID          27440000
274500              AND VER_STATUS_CDE     = :PC-ACTIVE                 27450000
274600     END-EXEC                                                     27460000
274700                                                                  27470000
274800     EVALUATE TRUE                                                27480000
274900         WHEN SQLCODE = ZERO                                      27490000
275000         WHEN SQLCODE = +100                                      27500000
275100              CONTINUE                                            27510000
275200         WHEN SQLCODE = -904                                      27520000
275300         WHEN SQLCODE = -911                                      27530000
275400         WHEN SQLCODE = -913                                      27540000
275500             PERFORM 9900-SOFT-ABORT                              27550000
275600         WHEN SQLWARN0 NOT = SPACES                               27560000
275700         WHEN SQLCODE  NOT = ZERO                                 27570000
275800             MOVE '4020-GET-TRECITM-DATA'                         27580000
275900                                 TO DP013-PARAGRAPH               27590000
276000             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                27600000
276100                                 TO DP013-MESSAGE-TEXT (1)        27610000
276200             MOVE SQLCA         TO DP013-SQLCA                    27620000
276300             MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)       27630000
276400             SET DP013-DB2-ABEND                                  27640000
276500                 DP013-XCTL-DISPLAY-RESTART                       27650000
276600                                 TO TRUE                          27660000
276700                                                                  27670000
276800             PERFORM DP013-0000-PROCESS-ABEND                     27680000
276900     END-EVALUATE.                                                27690000
277000                                                                  27700000
277100                                                                  27710000
277200                                                                  27720000
277300 4060-CREATE-TROUBLE-ROW.                                         27730000
277400     INITIALIZE TM500-FIELDS.                                     27740000
277500     SET TM500-ADD-DETAILS                                        27750000
277600         TM500-CREATE-MANUAL       TO  TRUE.                      27760000
277700                                                                  27770000
277800     MOVE ASC-KEY-NOTIF-NBR        TO  TM500-NOTIF-NBR.           27780000
277900     MOVE ASC-KEY-OPER-UNT-ID      TO  TM500-OPER-UNT-ID.         27790000
278000     MOVE ASC-KEY-FCLTY-ID         TO  TM500-FCLTY-ID.            27800000
278100                                                                  27810000
278200     MOVE RC017-PO-NBR             TO  TM500-PO-NBR.              27820000
278300                                                                  27830000
278400     IF  ASC-PO-LEVEL-TRBL                                        27840000
278500         SET TM500-PO-LEVEL        TO  TRUE                       27850000
278600         MOVE ZERO                 TO  TM500-PO-LNE-NBR           27860000
278700     ELSE                                                         27870000
278800         SET TM500-LINE-LEVEL      TO  TRUE                       27880000
278900         MOVE RC017-PO-LNE-NBR     TO  TM500-PO-LNE-NBR           27890000
279000     END-IF                                                       27900000
279100                                                                  27910000
279200     MOVE RC017-REC-SEQ-NBR        TO  TM500-REC-SEQ-NBR.         27920000
279300     MOVE TM003-TRBL-RSN-CDE       TO  TM500-TRBL-RSN-CDE.        27930000
279400                                                                  27940000
279500     MOVE DP020-USERID             TO  TM500-CRE-UID              27950000
279600                                       TM500-NOTIF-UID.           27960000
279700                                                                  27970000
279800     IF  TM003-FREEFORM-TEXT = SPACES                             27980000
279900         MOVE '.' TO TM500-FREEFORM-TEXT                          27990000
280000     ELSE                                                         28000000
280100         MOVE TM003-FREEFORM-TEXT  TO  TM500-FREEFORM-TEXT.       28010000
280200                                                                  28020000
280300     PERFORM 4100-LINK-TO-UPDATE.                                 28030000
280400     IF TM500-CALL-SUCCESSFUL         OR                          28040000
280500         TM500-TPURCHS-SELECT-NOT-FND OR                          28050000
280600         TM500-TTRBNTF-UPDATE-NOT-FND OR                          28060000
280700         TM500-DIDNT-ALLOC-DUE-TO-TRBL                            28070000
280800             CONTINUE                                             28080000
280900     ELSE                                                         28090000
281000         IF  TM500-DUPLICATE-TROUBLE                              28100000
281100             SET DP020-MSG-FATAL                                  28110000
281200                 PS-ERROR          TO  TRUE                       28120000
281300             MOVE PC-TRBL-ALREADY-EXISTS-MSG                      28130000
281400                                   TO  DP020-MSG-MESSAGE          28140000
281500         ELSE                                                     28150000
281600             PERFORM 4110-FORMAT-ERROR                            28160000
281700         END-IF                                                   28170000
281800     END-IF.                                                      28180000
281900                                                                  28190000
282000 4070-UPDATE-TRB-QUEUE.                                           28200000
282100     SET TM003-UPDATE TO TRUE.                                    28210000
282200     IF TM003-CYC-ADJ-NBR = 0                                     28220000
282300         MOVE TM500-NOTIF-NBR TO TM003-CYC-ADJ-NBR                28230000
282400                                     PV-CYC-ADJ-NBR               28240000
282500         MOVE  0                 TO PV-CYC-ADJ-BEF                28250000
282600         MOVE  0                 TO PV-NOTIF-BEF                  28260000
282700     ELSE                                                         28270000
282800         MOVE TM003-CYC-ADJ-NBR TO                                28280000
282900                                     PV-CYC-ADJ-NBR               28290000
283000     END-IF.                                                      28300000
283100     SET LINE-INDEX TO 1.                                         28310000
283200     PERFORM 4080-LOAD-QUEUE-TBL                                  28320000
283300        UNTIL PS-TABLE-LOADED.                                    28330000
283400                                                                  28340000
283500 4080-LOAD-QUEUE-TBL.                                             28350000
283600     IF TM003-TBL-LNE-NBR (LINE-INDEX) = 0                        28360000
283700        MOVE TM500-PO-LNE-NBR TO TM003-TBL-LNE-NBR (LINE-INDEX)   28370000
283800        MOVE TM500-NOTIF-NBR TO TM003-TBL-NOTIF-NBR (LINE-INDEX)  28380000
283900                                PV-NOTIF-NBR                      28390000
284000        SET TM003-TBL-LNE-UPDATED (LINE-INDEX) TO TRUE            28400000
284100        SET PS-TABLE-LOADED TO TRUE                               28410000
284200     ELSE                                                         28420000
284300        SET LINE-INDEX UP BY 1                                    28430000
284400     END-IF.                                                      28440000
284500 4100-LINK-TO-UPDATE.                                             28450000
284600                                                                  28460000
284700     EXEC CICS LINK                                               28470000
284800          PROGRAM (PC-TMKCS520)                                   28480000
284900          COMMAREA(TM500-FIELDS)                                  28490000
285000          RESP    (PV-CICS-RESP)                                  28500000
285100     END-EXEC.                                                    28510000
285200                                                                  28520000
285300     IF  PV-CICS-RESPONSE NOT EQUAL DFHRESP(NORMAL)               28530000
285400         SET DP013-LOGIC-ABEND                                    28540000
285500             DP013-NO-ROLLBACK     TO TRUE                        28550000
285600         MOVE '4100-LINK-TO-UPDATE'                               28560000
285700                                   TO DP013-PARAGRAPH             28570000
285800         MOVE 'ATTEMPTING TO LINK TO CENTRAL PROCESSING'          28580000
285900                                   TO DP013-MESSAGE-TEXT (1)      28590000
286000         PERFORM DP013-0000-PROCESS-ABEND                         28600000
286100     END-IF.                                                      28610000
286200                                                                  28620000
286300 4110-FORMAT-ERROR.                                               28630000
286400                                                                  28640000
286500     SET PS-ERROR                                                 28650000
286600         DP020-MSG-FATAL           TO  TRUE.                      28660000
286700     STRING 'NNNNN-E-'                                            28670000
286800            TM500-RETURN-MSG                                      28680000
286900            '-'                                                   28690000
287000            TM500-RETURN-CODE                                     28700000
287100            ', SQLCODE='                                          28710000
287200            TM500-SQLCODE DELIMITED BY SIZE                       28720000
287300                                 INTO  DP020-MSG-MESSAGE.         28730000
287400/                                                                 28740000
287500 4150-CHECK-INVENTORY-DATE.                                       28750000
287600                                                                  28760000
287700     SET ASC-UPDATE-YES (ASC-BLK-SUB ASC-ITEM-SUB)                28770000
287800                                TO TRUE.                          28780000
287900     PERFORM 4014-GET-STORE-TYPE.                                 28790000
288000     PERFORM 4200A-READ-DC-FLUSH-PARM.                            28800015
288100     IF PS-DC-FLUSH-YES                                           28810015
288200         PERFORM 4200-READ-INV-PARM                               28820015
288300         IF PV-NULL = 0                                           28830015
288400             PERFORM 4210-FMT-CUTOFF-DTS-FOR-CMPARE               28840015
288500             PERFORM 4215-CHCK-INV-DATE-FOR-UPDATE                28850015
288600         ELSE                                                     28860015
288700             CONTINUE                                             28870015
288800         END-IF                                                   28880015
288900     END-IF.                                                      28890015
289000 4160-CHECK-AP-CODE.                                              28900000
289100     IF RECDIS-AP-PRC-CDE = PC-W OR PC-J OR PC-M                  28910000
289200         SET ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)             28920000
289300                                TO TRUE                           28930000
289400         IF ASC-MESSAGE (ASC-BLK-SUB ASC-ITEM-SUB) = SPACES       28940000
289500             MOVE 'MATCHED TO INVOICE' TO                         28950000
289600                 ASC-MESSAGE (ASC-BLK-SUB ASC-ITEM-SUB)           28960000
289700         END-IF                                                   28970000
289800     END-IF.                                                      28980000
289900                                                                  28990015
290000******************************************************************29000015
290100*  CHECK TKRPRPM TO SEE IF THE DC'S NEED TO BE FLUSHED.           29010015
290200******************************************************************29020015
290300 4200A-READ-DC-FLUSH-PARM.                                        29030015
290400                                                                  29040015
290500     EXEC SQL                                                     29050015
290600          SELECT  FUNC_TXT                                        29060015
290700          INTO   :KRPRPM-FUNC-TXT                                 29070015
290800          FROM  TKRPRPM                                           29080015
290900          WHERE LOC_ID            =  90                           29090015
291000            AND SYS_PRC_FUNC_CDE  =  'FLUSH'                      29100015
291100            AND FUNC_PRC_STAT_CDE =  'AC'                         29110015
291200     END-EXEC.                                                    29120015
291300                                                                  29130015
291400     EVALUATE TRUE                                                29140015
291500         WHEN SQLCODE = +0                                        29150015
291600            IF KRPRPM-FUNC-TXT = 'N'                              29160015
291700                SET PS-DC-FLUSH-NO  TO TRUE                       29170015
291800            ELSE                                                  29180015
291900                SET PS-DC-FLUSH-YES TO TRUE                       29190015
292000            END-IF                                                29200015
292100         WHEN OTHER                                               29210015
292200                SET PS-DC-FLUSH-NO  TO TRUE                       29220015
292300     END-EVALUATE.                                                29230015
292400                                                                  29240015
292500*----------------------------------------------------------------*29250000
292600*     GET THE ACTUAL DATE .                                      *29260000
292700*----------------------------------------------------------------*29270000
292800 4200-READ-INV-PARM.                                              29280011
292900                                                                  29290000
293000         EXEC SQL                                                 29300000
293100             SELECT                                               29310000
293200                    MAX (INV_DTE)                                 29320014
293300             INTO                                                 29330000
293400                    :XLT00025-INV-DTE :PV-NULL                    29340011
293500             FROM                                                 29350000
293600                    XLT_MDSE_INV_PARM                             29360018
293700             WHERE                                                29370000
293800                    LOC_NBR           =  :DK-STORE                29380016
293900               AND  ACTV_IND          =  'Y'                      29390017
294000               AND  LOC_INV_STAT_CDE  =  'IN'                     29400016
294100         END-EXEC.                                                29410000
294200                                                                  29420000
294300         EVALUATE TRUE                                            29430000
294400             WHEN SQLCODE = ZERO                                  29440000
294500                  IF PV-NULL = 0                                  29450000
294600                      MOVE XLT00025-INV-DTE                       29460013
294700                         TO PV-DB2-INV-FORMAT                     29470000
294800                  END-IF                                          29480000
294900             WHEN SQLCODE = +100                                  29490000
295000                  SET PS-ERROR    TO  TRUE                        29500000
295100             WHEN SQLCODE = -904                                  29510000
295200             WHEN SQLCODE = -913                                  29520000
295300                  PERFORM 9900-SOFT-ABORT                         29530000
295400             WHEN SQLWARN0 NOT = SPACES                           29540000
295500             WHEN SQLCODE NOT EQUAL ZERO                          29550000
295600                 MOVE '4200-READ-INV-PARM - 1'                    29560011
295700                                   TO DP013-PARAGRAPH             29570000
295800                 MOVE 'SELECT STORE NAME'                         29580000
295900                                   TO DP013-MESSAGE-TEXT (1)      29590000
296000                 MOVE SQLCA        TO DP013-SQLCA                 29600000
296100                 MOVE 'XLT_MDSE_INV_PARM'                         29610011
296200                                   TO DP013-DB2-TABLE-NAME (1)    29620011
296300                 SET DP013-DB2-ABEND                              29630000
296400                     DP013-XCTL-DISPLAY-RESTART                   29640000
296500                                   TO TRUE                        29650000
296600                 PERFORM DP013-0000-PROCESS-ABEND                 29660000
296700         END-EVALUATE.                                            29670000
296800                                                                  29680000
296900     IF  SQLCODE EQUAL ZERO AND                                   29690000
297000         PV-NULL = 0                                              29700000
297100                                                                  29710000
297200         EXEC SQL                                                 29720000
297300             SELECT                                               29730000
297400                    DC_CTOFF_DTE                                  29740012
297500             INTO                                                 29750000
297600                    :XLT00025-DC-CTOFF-DTE                        29760011
297700             FROM                                                 29770000
297800                    XLT_MDSE_INV_PARM                             29780018
297900             WHERE                                                29790000
298000                    LOC_NBR          = :DK-STORE                  29800016
298100               AND  INV_DTE          = :PV-DB2-INV-FORMAT         29810016
298200               AND  ACTV_IND         = 'Y'                        29820017
298300               AND  LOC_INV_STAT_CDE = 'IN'                       29830016
298400         END-EXEC                                                 29840000
298500                                                                  29850000
298600         EVALUATE TRUE                                            29860000
298700             WHEN SQLCODE = ZERO                                  29870000
298800             WHEN SQLCODE = +100                                  29880000
298900                 CONTINUE                                         29890000
299000             WHEN SQLCODE = -904                                  29900000
299100             WHEN SQLCODE = -913                                  29910000
299200                  PERFORM 9900-SOFT-ABORT                         29920000
299300             WHEN SQLWARN0 NOT = SPACES                           29930000
299400             WHEN SQLCODE NOT EQUAL ZERO                          29940000
299500                 MOVE '4200-READ-INV-PARM - 2'                    29950011
299600                                   TO DP013-PARAGRAPH             29960000
299700                 MOVE 'SELECT STORE NAME'                         29970000
299800                                   TO DP013-MESSAGE-TEXT (1)      29980000
299900                 MOVE SQLCA        TO DP013-SQLCA                 29990000
300000                 MOVE 'XLT_MDSE_INV_PARM'                         30000011
300100                                   TO DP013-DB2-TABLE-NAME (1)    30010011
300200                 SET DP013-DB2-ABEND                              30020000
300300                     DP013-XCTL-DISPLAY-RESTART                   30030000
300400                                   TO TRUE                        30040000
300500                 PERFORM DP013-0000-PROCESS-ABEND                 30050000
300600         END-EVALUATE                                             30060000
300700     END-IF.                                                      30070000
300800                                                                  30080000
300900                                                                  30090000
301000*----------------------------------------------------------------*30100000
301100*    FORMAT THE CUTOFF DATES.                                    *30110000
301200*----------------------------------------------------------------*30120000
301300                                                                  30130000
301400 4210-FMT-CUTOFF-DTS-FOR-CMPARE.                                  30140000
301500     PERFORM DP017-0000-GET-CURR-DATE-TIME.                       30150000
301600     MOVE DP017-CURRENT-DATE-YMD      TO DPG51-SYSTEM-DATE.       30160000
301700     SET  DPG51-ACTUAL-CALENDAR-ONLY  TO TRUE.                    30170000
301800     SET  DPG51-DO-NOT-INCR-DECR-DATE TO TRUE.                    30180000
301900     MOVE ZERO                      TO DPG51-INCR-DECR-DAYS-9     30190000
302000                                       DPG51-INCR-DECR-BUS-DAYS-9.30200000
302100     SET  DPG52-LK-DTE-ISO-FMT        TO TRUE.                    30210000
302200                                                                  30220000
302300*    *------------------------------------------------------------30230000
302400*    * FORMAT THE CUTOFF DATE DATE FROM XLT_MDSE_INV_PARM         30240011
302500*    *------------------------------------------------------------30250000
302600     MOVE XLT00025-DC-CTOFF-DTE TO DPG52-LK-DATE-INPUT.           30260011
302700*                                                                 30270000
302800*    STRING ' RCKCS279 - '      DELIMITED BY SIZE                 30280000
302900*           ' READY TO CALL CALENDER ROUTINE - INVPAR DATE '      30290000
303000*                               DELIMITED BY SIZE                 30300000
303100*           DPG52-LK-DATE-INPUT DELIMITED BY SIZE                 30310000
303200*                        INTO PV-CICS-MSG-AREA.                   30320000
303300*    MOVE LENGTH OF PV-CICS-MSG-AREA                              30330000
303400*                          TO PV-COMMAREA-LENGTH.                 30340000
303500*    PERFORM 9700-WRITE-TO-CICS-LOG.                              30350000
303600                                                                  30360000
303700     IF  XLT00025-DC-CTOFF-DTE EQUAL '9999-09-09'                 30370011
303800         MOVE XLT00025-DC-CTOFF-DTE                               30380011
303900           TO PV-ACTL-CTOFF-YYYYMMDD                              30390000
304000     ELSE                                                         30400000
304100         PERFORM 4220-CALL-CALENDAR-ROUTINE                       30410000
304200         MOVE DPG55-DB2-ISO-DATE TO PV-ACTL-CTOFF-YYYYMMDD        30420000
304300     END-IF.                                                      30430000
304400                                                                  30440000
304500*    *------------------------------------------------------------30450000
304600*    * FORMAT THE VERIFY DATE FORM TRECEIV.                       30460000
304700*    *------------------------------------------------------------30470000
304800     MOVE RECEIV-VERFYD-TMST  TO      PV-WORK-TMST.               30480000
304900     MOVE PV-WORK-TMST-1      TO      DPG52-LK-DATE-INPUT.        30490000
305000*                                                                 30500000
305100*    STRING ' RCKCS279 - '      DELIMITED BY SIZE                 30510000
305200*           ' READY TO CALL CALENDER ROUTINE - VERIFY DATE '      30520000
305300*                               DELIMITED BY SIZE                 30530000
305400*           DPG52-LK-DATE-INPUT DELIMITED BY SIZE                 30540000
305500*                        INTO PV-CICS-MSG-AREA.                   30550000
305600*    MOVE LENGTH OF PV-CICS-MSG-AREA                              30560000
305700*                          TO PV-COMMAREA-LENGTH.                 30570000
305800*    PERFORM 9700-WRITE-TO-CICS-LOG.                              30580000
305900                                                                  30590000
306000     PERFORM 4220-CALL-CALENDAR-ROUTINE.                          30600000
306100     MOVE DPG55-DB2-ISO-DATE TO PV-VERIFY-DTE-YYYYMMDD.           30610000
306200                                                                  30620000
306300*    *------------------------------------------------------------30630000
306400*    * FORMAT THE RECEIPT DATE FORM TRECEIV.                      30640000
306500*    *------------------------------------------------------------30650000
306600     MOVE RECEIV-REC-TMST     TO      PV-WORK-TMST.               30660000
306700     MOVE PV-WORK-TMST-1      TO      DPG52-LK-DATE-INPUT.        30670000
306800*                                                                 30680000
306900*    STRING ' RCKCS279 - '      DELIMITED BY SIZE                 30690000
307000*           ' READY TO CALL CALENDER ROUTINE - RECEIPT DATE '     30700000
307100*                               DELIMITED BY SIZE                 30710000
307200*           DPG52-LK-DATE-INPUT DELIMITED BY SIZE                 30720000
307300*                        INTO PV-CICS-MSG-AREA.                   30730000
307400*    MOVE LENGTH OF PV-CICS-MSG-AREA                              30740000
307500*                          TO PV-COMMAREA-LENGTH.                 30750000
307600*    PERFORM 9700-WRITE-TO-CICS-LOG.                              30760000
307700                                                                  30770000
307800     PERFORM 4220-CALL-CALENDAR-ROUTINE.                          30780000
307900     MOVE DPG55-DB2-ISO-DATE TO PV-RECEIPT-DTE-YYYYMMDD.          30790000
308000                                                                  30800000
308100*    *------------------------------------------------------------30810000
308200*    * FORMAT THE CURRENT SYSTEM DATE.                            30820000
308300*    *------------------------------------------------------------30830000
308400     MOVE DP017-EDITED-DATE-YYYYMMDD TO DPG52-LK-DATE-INPUT.      30840000
308500*                                                                 30850000
308600*    STRING ' RCKCS279 - '      DELIMITED BY SIZE                 30860000
308700*           ' READY TO CALL CALENDER ROUTINE - CURRENT DATE '     30870000
308800*                               DELIMITED BY SIZE                 30880000
308900*           DPG52-LK-DATE-INPUT DELIMITED BY SIZE                 30890000
309000*                        INTO PV-CICS-MSG-AREA.                   30900000
309100*    MOVE LENGTH OF PV-CICS-MSG-AREA                              30910000
309200*                          TO PV-COMMAREA-LENGTH.                 30920000
309300*    PERFORM 9700-WRITE-TO-CICS-LOG.                              30930000
309400                                                                  30940000
309500     PERFORM 4220-CALL-CALENDAR-ROUTINE.                          30950000
309600     MOVE DPG55-DB2-ISO-DATE TO PV-CURRENT-DTE-YYYYMMDD.          30960000
309700                                                                  30970000
309800 4215-CHCK-INV-DATE-FOR-UPDATE.                                   30980000
309900                                                                  30990000
310000     MOVE SPACES TO                                               31000000
310100         ASC-MESSAGE (ASC-BLK-SUB ASC-ITEM-SUB).                  31010000
310200     IF  ASC-INTER-APPL-VERIFY                                    31020000
310300          SET PS-CAN-UPDATE        TO TRUE                        31030000
310400     END-IF.                                                      31040000
310500     IF ASC-DC-STORE-TYPE                                         31050000
310600          IF ((PV-VERIFY-DTE-YYYYMMDD < PV-ACTL-CTOFF-YYYYMMDD    31060000
310700          OR  PV-VERIFY-DTE-YYYYMMDD = PV-ACTL-CTOFF-YYYYMMDD)    31070000
310800          AND PV-CURRENT-DTE-YYYYMMDD > PV-ACTL-CTOFF-YYYYMMDD)   31080000
310900              SET ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)        31090000
311000                                TO TRUE                           31100000
311100              MOVE 'DC CUTOFF PHY INV' TO                         31110000
311200                  ASC-MESSAGE (ASC-BLK-SUB ASC-ITEM-SUB)          31120000
311300                  PERFORM 5510-ADD-TRIGGER-AUDIT-BEFORE           31130000
311400          END-IF                                                  31140000
311500      END-IF.                                                     31150000
311600     IF ASC-NOT-DC-STORE-TYPE                                     31160000
311700         IF ((PV-RECEIPT-DTE-YYYYMMDD < PV-ACTL-CTOFF-YYYYMMDD    31170000
311800         OR  PV-RECEIPT-DTE-YYYYMMDD  =   PV-ACTL-CTOFF-YYYYMMDD) 31180000
311900         AND PV-CURRENT-DTE-YYYYMMDD > PV-ACTL-CTOFF-YYYYMMDD)    31190000
312000              SET ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)        31200000
312100                                TO TRUE                           31210000
312200              MOVE 'DC CUTOFF PHY INV' TO                         31220000
312300                  ASC-MESSAGE (ASC-BLK-SUB ASC-ITEM-SUB)          31230000
312400                  PERFORM 5510-ADD-TRIGGER-AUDIT-BEFORE           31240000
312500          END-IF                                                  31250000
312600      END-IF.                                                     31260000
312700                                                                  31270000
312800 4220-CALL-CALENDAR-ROUTINE.                                      31280000
312900     CALL PC-CALENDAR-ROUTINE USING DPG51                         31290000
313000                                    DPG52                         31300000
313100                                    DPG53                         31310000
313200                                    DPG54                         31320000
313300                                    DPG55                         31330000
313400                                    DPG56.                        31340000
313500     EVALUATE TRUE                                                31350000
313600         WHEN DPG54-SEVERE-ERROR                                  31360000
313700         WHEN DPG54-DATE-INVALID                                  31370000
313800             MOVE '2175-FMT-STKRM-DTES-FOR-CMPARE'                31380000
313900                                   TO  DP013-PARAGRAPH            31390000
314000             MOVE 'ERROR DETECTED BY CALENDAR ROUTINE:'           31400000
314100                                   TO  DP013-MESSAGE-TEXT (1)     31410000
314200             MOVE DPG54-ERROR-MESSAGE                             31420000
314300                                   TO  DP013-MESSAGE-TEXT (2)     31430000
314400             MOVE DPG52-LK-DATE-INPUT                             31440000
314500                                   TO  DP013-MESSAGE-TEXT (3)     31450000
314600             SET DP013-LOGIC-ABEND TO  TRUE                       31460000
314700             PERFORM DP013-0000-PROCESS-ABEND                     31470000
314800     END-EVALUATE.                                                31480000
314900                                                                  31490000
315000/                                                                 31500000
315100 4230-GET-VENDOR-NAME.                                            31510000
315200                                                                  31520000
315300     EXEC SQL                                                     31530000
315400          SELECT B.ENT_NAME_DESC                                  31540000
315500               , A.DEPT_NBR                                       31550000
315600               , A.STATUS_CDE                                     31560000
315700            INTO :ENTNME-ENT-NAME-DESC                            31570000
315800               , :PURCHS-DEPT-NBR                                 31580000
315900               , :ASC-PURCHS-STATUS-CDE                           31590000
316000            FROM TPURCHS A,                                       31600000
316100                 TENTNME B                                        31610000
316200           WHERE A.VER_STATUS_CDE = :PC-ACTIVE                    31620000
316300             AND A.PO_NBR             = :DK-PO-NBR                31630000
316400             AND A.ENT_ID             = B.ENT_ID                  31640000
316500             AND B.TYPE_CDE           = :PC-01                    31650000
316600     END-EXEC                                                     31660000
316700                                                                  31670000
316800     EVALUATE TRUE                                                31680000
316900         WHEN SQLCODE = ZERO                                      31690000
317000             MOVE ENTNME-ENT-NAME-DESC                            31700000
317100                                 TO ASC-KEY-VENDOR-NAME           31710000
317200         WHEN SQLCODE = +100                                      31720000
317300             MOVE 'VENDOR NOT FOUND'                              31730000
317400                                 TO ASC-KEY-VENDOR-NAME           31740000
317500         WHEN SQLCODE = -904                                      31750000
317600         WHEN SQLCODE = -911                                      31760000
317700         WHEN SQLCODE = -913                                      31770000
317800             PERFORM 9900-SOFT-ABORT                              31780000
317900         WHEN SQLWARN0 NOT = SPACES                               31790000
318000         WHEN SQLCODE      NOT = ZERO                             31800000
318100             MOVE '4230-GET-VENDOR-NAME'                          31810000
318200                             TO DP013-PARAGRAPH                   31820000
318300             MOVE 'UNSUCCESSFUL SELECT OF VENDOR NAME'            31830000
318400                             TO DP013-MESSAGE-TEXT (1)            31840000
318500             MOVE SQLCA         TO DP013-SQLCA                    31850000
318600             MOVE 'TENTNME' TO DP013-DB2-TABLE-NAME (1)           31860000
318700             SET DP013-DB2-ABEND                                  31870000
318800                  DP013-XCTL-DISPLAY-RESTART                      31880000
318900                             TO TRUE                              31890000
319000             PERFORM DP013-0000-PROCESS-ABEND                     31900000
319100     END-EVALUATE.                                                31910000
319200                                                                  31920000
319300 4240-OPEN-CURSOR.                                                31930000
319400                                                                  31940000
319500     EXEC SQL                                                     31950000
319600          OPEN RECDIS-CURSOR                                      31960000
319700     END-EXEC                                                     31970000
319800                                                                  31980000
319900     EVALUATE TRUE                                                31990000
320000         WHEN SQLCODE = ZERO                                      32000000
320100              CONTINUE                                            32010000
320200         WHEN SQLCODE = -904                                      32020000
320300         WHEN SQLCODE = -911                                      32030000
320400         WHEN SQLCODE = -913                                      32040000
320500             PERFORM 9900-SOFT-ABORT                              32050000
320600         WHEN SQLWARN0 NOT = SPACES                               32060000
320700         WHEN SQLCODE      NOT = ZERO                             32070000
320800              MOVE '4240-OPEN-CURSOR'                             32080000
320900                             TO DP013-PARAGRAPH                   32090000
321000              MOVE 'UNSUCCESSFUL RECDIS CURSOR OPEN'              32100000
321100                             TO DP013-MESSAGE-TEXT (1)            32110000
321200              MOVE SQLCA         TO DP013-SQLCA                   32120000
321300              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          32130000
321400              SET DP013-XCTL-DISPLAY-RESTART                      32140000
321500                  DP013-DB2-ABEND                                 32150000
321600                             TO TRUE                              32160000
321700                                                                  32170000
321800              PERFORM DP013-0000-PROCESS-ABEND                    32180000
321900     END-EVALUATE.                                                32190000
322000                                                                  32200000
322100 4250-GET-REC-DISTRO.                                             32210000
322200                                                                  32220000
322300     PERFORM VARYING PV-READ-COUNT  FROM 1 BY 1                   32230000
322400         UNTIL PV-READ-COUNT > PC-MAX-ITEMS OR                    32240000
322500               ASC-NO-MORE-RECDIS                                 32250000
322600                                                                  32260000
322700         PERFORM 4260-FETCH-RECDIS                                32270000
322800                                                                  32280000
322900         IF ASC-MORE-RECDIS                                       32290000
323000             IF ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                 32300000
323100                 ADD +1          TO ASC-ITEM-SUB                  32310000
323200             ELSE                                                 32320000
323300                 ADD +1          TO ASC-BLK-SUB                   32330000
323400                 MOVE +1         TO ASC-ITEM-SUB                  32340000
323500                                                                  32350000
323600                 IF ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY          32360000
323700                     MOVE +1     TO ASC-BLK-SUB                   32370000
323800                     SET ASC-BLOCK-MODIFIED (1)                   32380000
323900                                 TO TRUE                          32390000
324000                                                                  32400000
324100                     PERFORM 5100-WRITE-TEMP-STORAGE              32410000
324200                                                                  32420000
324300                     MOVE ASC-BLOCK-ENTRIES                       32430000
324400                                          (PC-MAX-BLOCKS-IN-ARRAY)32440000
324500                                 TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB)32450000
324600                     ADD +1      TO ASC-BLK-SUB                   32460000
324700                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   32470000
324800                     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)     32480000
324900                                 TO TRUE                          32490000
325000                 END-IF                                           32500000
325100             END-IF                                               32510000
325200             ADD +1              TO ASC-NUMBER-OF-ITEMS-READ      32520000
325300             MOVE ASC-NUMBER-OF-ITEMS-READ                        32530000
325400                                 TO ASC-LIST-ITEM-NUMBER          32540000
325500                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32550000
325600             PERFORM 4150-CHECK-INVENTORY-DATE                    32560000
325700             IF ASC-UPDATE-YES                                    32570000
325800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32580000
325900                 PERFORM 4160-CHECK-AP-CODE                       32590000
326000             END-IF                                               32600000
326100                                                                  32610000
326200             MOVE RECDIS-STR-NBR TO ASC-STR-NBR-N                 32620000
326300                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32630000
326400                                   DK-STR-NBR                     32640000
326500                                                                  32650000
326600             MOVE RECDIS-EXPTED-ITM-QTY                           32660000
326700                                 TO ASC-PCKSLP-QTY-N              32670000
326800                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32680000
326900                                                                  32690000
327000             MOVE RECDIS-VERIFY-ITM-QTY                           32700000
327100                                 TO ASC-ACTUAL-QTY-N              32710000
327200                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32720000
327300                                                                  32730000
327400             MOVE RECDIS-AP-VERIFY-ITM-QTY                        32740000
327500                                 TO ASC-VERFD-QTY-N               32750000
327600                                   (ASC-BLK-SUB ASC-ITEM-SUB)     32760000
327700                                                                  32770000
327800                                                                  32780000
327900             IF DP020-INT-APPL-FORMAT-IND = PC-INTER-APPL-VERIFY  32790000
328000                 CONTINUE                                         32800000
328100             ELSE                                                 32810000
328200                 CONTINUE                                         32820000
328300             END-IF                                               32830000
328400                                                                  32840000
328500         END-IF                                                   32850000
328600     END-PERFORM.                                                 32860000
328700                                                                  32870000
328800     IF ASC-NUMBER-OF-ITEMS-READ > ZERO                           32880000
328900         MOVE +1                 TO ASC-BLK-SUB                   32890000
329000                                                                  32900000
329100         PERFORM 5100-WRITE-TEMP-STORAGE                          32910000
329200                                                                  32920000
329300         ADD +1                  TO ASC-BLK-SUB                   32930000
329400                                                                  32940000
329500         PERFORM 5100-WRITE-TEMP-STORAGE                          32950000
329600                                                                  32960000
329700         MOVE +1                 TO ASC-BLK-SUB                   32970000
329800                                    PV-BLOCK-NUMBER               32980000
329900                                                                  32990000
330000         PERFORM 4410-READ-TEMP-STORAGE                           33000000
330100                                                                  33010000
330200         IF ASC-HIGHEST-BLOCK-WRITTEN > 1                         33020000
330300             MOVE +2             TO ASC-BLK-SUB                   33030000
330400                                    PV-BLOCK-NUMBER               33040000
330500                                                                  33050000
330600             PERFORM 4410-READ-TEMP-STORAGE                       33060000
330700         END-IF                                                   33070000
330800     END-IF.                                                      33080000
330900                                                                  33090000
331000 4260-FETCH-RECDIS.                                               33100000
331100                                                                  33110000
331200     EXEC SQL                                                     33120000
331300          FETCH  RECDIS-CURSOR                                    33130000
331400           INTO :RECDIS-EXPTED-ITM-QTY,                           33140000
331500                :RECDIS-VERIFY-ITM-QTY,                           33150000
331600                :RECDIS-AP-VERIFY-ITM-QTY,                        33160000
331700                :RECDIS-STR-NBR,                                  33170000
331800                :RECDIS-AP-PRC-CDE                                33180000
331900     END-EXEC.                                                    33190000
332000                                                                  33200000
332100     EVALUATE TRUE                                                33210000
332200         WHEN SQLCODE = ZERO                                      33220000
332300         WHEN SQLCODE = +100                                      33230000
332400              CONTINUE                                            33240000
332500         WHEN SQLCODE = -904                                      33250000
332600         WHEN SQLCODE = -911                                      33260000
332700         WHEN SQLCODE = -913                                      33270000
332800             PERFORM 9900-SOFT-ABORT                              33280000
332900         WHEN SQLWARN0 NOT = SPACES                               33290000
333000         WHEN SQLCODE  NOT = ZERO                                 33300000
333100              MOVE '4260-FETCH-RECDIS'                            33310000
333200                                 TO DP013-PARAGRAPH               33320000
333300              MOVE 'UNSUCCESSFUL FETCH OF RECDIS CURSOR'          33330000
333400                                 TO DP013-MESSAGE-TEXT (1)        33340000
333500              MOVE SQLCA         TO DP013-SQLCA                   33350000
333600              MOVE 'TRECDIS'     TO DP013-DB2-TABLE-NAME (1)      33360000
333700              SET DP013-DB2-ABEND                                 33370000
333800                  DP013-XCTL-DISPLAY-RESTART                      33380000
333900                                 TO TRUE                          33390000
334000                                                                  33400000
334100              PERFORM DP013-0000-PROCESS-ABEND                    33410000
334200     END-EVALUATE.                                                33420000
334300                                                                  33430000
334400     IF SQLCODE = +100                                            33440000
334500         SET ASC-NO-MORE-RECDIS  TO TRUE                          33450000
334600     END-IF.                                                      33460000
334700                                                                  33470000
334800                                                                  33480000
334900 4270-CLOSE-CURSOR.                                               33490000
335000                                                                  33500000
335100     EXEC SQL                                                     33510000
335200          CLOSE RECDIS-CURSOR                                     33520000
335300     END-EXEC.                                                    33530000
335400                                                                  33540000
335500     EVALUATE TRUE                                                33550000
335600         WHEN SQLCODE = ZERO                                      33560000
335700              CONTINUE                                            33570000
335800         WHEN SQLCODE = -904                                      33580000
335900         WHEN SQLCODE = -911                                      33590000
336000         WHEN SQLCODE = -913                                      33600000
336100             PERFORM 9900-SOFT-ABORT                              33610000
336200         WHEN SQLWARN0 NOT = SPACES                               33620000
336300         WHEN SQLCODE  NOT = ZERO                                 33630000
336400              MOVE '4270-CLOSE-CURSOR'                            33640000
336500                                 TO DP013-PARAGRAPH               33650000
336600              MOVE 'UNSUCCESSFUL RECDIS CURSOR CLOSE'             33660000
336700                                 TO DP013-MESSAGE-TEXT (1)        33670000
336800              MOVE SQLCA         TO DP013-SQLCA                   33680000
336900              MOVE 'TRECDIS '    TO DP013-DB2-TABLE-NAME (1)      33690000
337000              SET DP013-DB2-ABEND                                 33700000
337100                  DP013-XCTL-DISPLAY-RESTART                      33710000
337200                                 TO TRUE                          33720000
337300                                                                  33730000
337400              PERFORM DP013-0000-PROCESS-ABEND                    33740000
337500     END-EVALUATE.                                                33750000
337600                                                                  33760000
337700******************************************************************33770000
337800*  GET THE FACILITY DESCRIPTION FROM THE FACILITY TABLE          *33780000
337900******************************************************************33790000
338000                                                                  33800000
338100 4280-GET-FACILITY-DESC.                                          33810000
338200                                                                  33820000
338300       EXEC SQL                                                   33830000
338400          SELECT LOC_NM                                           33840007
338500            INTO :ASC-KEY-FCLTY-DESC                              33850000
338600            FROM XLT_LOC                                          33860007
338700           WHERE LOC_NBR     = :ASC-KEY-OPER-UNT-ID               33870007
338800       END-EXEC                                                   33880000
338900                                                                  33890000
339000       EVALUATE TRUE                                              33900000
339100           WHEN SQLCODE = +0                                      33910000
339200           WHEN SQLCODE = +100                                    33920000
339300             CONTINUE                                             33930000
339400           WHEN SQLCODE = -904                                    33940000
339500           WHEN SQLCODE = -911                                    33950000
339600           WHEN SQLCODE = -913                                    33960000
339700             PERFORM 9900-SOFT-ABORT                              33970000
339800           WHEN SQLWARN0 NOT = SPACES                             33980000
339900           WHEN SQLCODE < +0                                      33990000
340000           WHEN SQLCODE > +0                                      34000000
340100               MOVE '4280-GET-FACILITY-DESC'                      34010000
340200                               TO DP013-PARAGRAPH                 34020000
340300               MOVE 'SELECT FACILITY DESC'                        34030000
340400                               TO DP013-MESSAGE-TEXT (1)          34040000
340500               MOVE SQLCA        TO DP013-SQLCA                   34050000
340600               MOVE 'XLT_LOC'    TO DP013-DB2-TABLE-NAME (1)      34060007
340700               SET DP013-DB2-ABEND                                34070000
340800                               TO TRUE                            34080000
340900               SET DP013-XCTL-DISPLAY-RESTART                     34090000
341000                               TO TRUE                            34100000
341100               PERFORM DP013-0000-PROCESS-ABEND                   34110000
341200       END-EVALUATE.                                              34120000
341300                                                                  34130000
341400/                                                                 34140000
341500 4290-GET-TRECEIV.                                                34150000
341600                                                                  34160000
341700     EXEC SQL                                                     34170000
341800          SET :PV-DB2-CURRENT-TMST = CURRENT TIMESTAMP            34180000
341900     END-EXEC.                                                    34190000
342000                                                                  34200000
342100     EXEC SQL                                                     34210000
342200          SELECT                                                  34220000
342300                  A.OPER_UNT_ID                                   34230000
342400                , A.REC_TMST                                      34240000
342500                , A.ML_POST_TMST                                  34250000
342600                , A.FS_POST_TMST                                  34260000
342700                , A.VERFYD_TMST                                   34270000
342800                , A.STATUS_CDE                                    34280000
342900                , B.STATUS_CDE                                    34290000
343000            INTO                                                  34300000
343100                  :RECEIV-OPER-UNT-ID                             34310000
343200                , :RECEIV-REC-TMST                                34320000
343300                , :RECEIV-ML-POST-TMST                            34330000
343400                , :RECEIV-FS-POST-TMST                            34340000
343500                , :RECEIV-VERFYD-TMST                             34350000
343600                , :RECEIV-STATUS-CDE                              34360000
343700                , :RECITM-STATUS-CDE                              34370000
343800            FROM                                                  34380000
343900                  TRECEIV A                                       34390000
344000                , TRECITM B                                       34400000
344100            WHERE                                                 34410000
344200                  A.ORD_NBR          = :DK-PO-NBR                 34420000
344300              AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            34430000
344400              AND A.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       34440000
344500              AND A.FCLTY_ID         = :ASC-KEY-FCLTY-ID          34450000
344600              AND A.VER_STATUS_CDE   = :PC-ACTIVE                 34460000
344700              AND                                                 34470000
344800                  B.ORD_NBR          = :DK-PO-NBR                 34480000
344900              AND B.REC_SEQ_NBR      = :DK-REC-SEQ-NBR            34490000
345000              AND B.OPER_UNT_ID      = :ASC-KEY-OPER-UNT-ID       34500000
345100              AND B.FCLTY_ID         = :ASC-KEY-FCLTY-ID          34510000
345200              AND B.VER_STATUS_CDE   = :PC-ACTIVE                 34520000
345300              AND B.ORD_LNE_NBR      = :DK-PKSL-LNE-NBR           34530000
345400     END-EXEC.                                                    34540000
345500                                                                  34550000
345600     EVALUATE TRUE                                                34560000
345700         WHEN SQLCODE = ZERO                                      34570000
345800              MOVE RECITM-STATUS-CDE TO ASC-RECITM-STATUS-CDE     34580000
345900         WHEN SQLCODE = +100                                      34590000
346000              CONTINUE                                            34600000
346100         WHEN SQLCODE = -904                                      34610000
346200         WHEN SQLCODE = -911                                      34620000
346300         WHEN SQLCODE = -913                                      34630000
346400             PERFORM 9900-SOFT-ABORT                              34640000
346500         WHEN SQLWARN0 NOT = SPACES                               34650000
346600         WHEN SQLCODE  NOT = ZERO                                 34660000
346700             MOVE '4290-GET-TRECEIV'                              34670000
346800                                 TO DP013-PARAGRAPH               34680000
346900             MOVE 'UNSUCCESSFUL SELECT OF TRECEIV'                34690000
347000                                 TO DP013-MESSAGE-TEXT (1)        34700000
347100             MOVE SQLCA         TO DP013-SQLCA                    34710000
347200             MOVE 'TRECEIV'     TO DP013-DB2-TABLE-NAME (1)       34720000
347300             MOVE 'TRECITM'     TO DP013-DB2-TABLE-NAME (2)       34730000
347400             SET DP013-DB2-ABEND                                  34740000
347500                 DP013-XCTL-DISPLAY-RESTART                       34750000
347600                                 TO TRUE                          34760000
347700                                                                  34770000
347800             PERFORM DP013-0000-PROCESS-ABEND                     34780000
347900     END-EVALUATE.                                                34790000
348000/                                                                 34800000
348100******************************************************************34810000
348200*    GET THE AD EVENT DATE TO DISPLAY IN THE HEADER AREA          34820000
348300******************************************************************34830000
348400/                                                                 34840000
348500 4300-GET-DEPARTMENT.                                             34850000
348600                                                                  34860000
348700     EXEC SQL                                                     34870000
348800          SELECT DEPT_NBR                                         34880000
348900          INTO                                                    34890000
349000                :PV-SN-DEPT-NBR                                   34900000
349100          FROM                                                    34910000
349200                 TPURCHS                                          34920000
349300          WHERE                                                   34930000
349400                 PO_NBR             =  :DK-PO-NBR                 34940000
349500          AND    VER_STATUS_CDE     =  :PC-A                      34950000
349600     END-EXEC.                                                    34960000
349700                                                                  34970000
349800     EVALUATE TRUE                                                34980000
349900         WHEN SQLCODE = ZERO                                      34990000
350000              CONTINUE                                            35000000
350100         WHEN SQLCODE = -904                                      35010000
350200         WHEN SQLCODE = -911                                      35020000
350300         WHEN SQLCODE = -913                                      35030000
350400             PERFORM 9900-SOFT-ABORT                              35040000
350500         WHEN SQLCODE = +100                                      35050000
350600              CONTINUE                                            35060000
350700         WHEN SQLWARN0 NOT = SPACE                                35070000
350800         WHEN SQLCODE NOT = ZERO                                  35080000
350900              MOVE '4300-GET-DEPARTMENT'                          35090000
351000                               TO DP013-PARAGRAPH                 35100000
351100              MOVE 'GET THE DEPARTMENT NUMBER'                    35110000
351200                               TO DP013-MESSAGE-TEXT (1)          35120000
351300              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        35130000
351400              MOVE SQLCA       TO DP013-SQLCA                     35140000
351500              SET DP013-DB2-ABEND                                 35150000
351600                               TO TRUE                            35160000
351700              PERFORM DP013-0000-PROCESS-ABEND                    35170000
351800     END-EVALUATE.                                                35180000
351900******************************************************************35190000
352000*    GET THE AD EVENT DATE TO DISPLAY IN THE HEADER AREA          35200000
352100******************************************************************35210000
352200*----------------------------------------------------------------*35220000
352300* INCLUDED NEW VARIABLE ITM_NBR IN THE QUERY.        WR # 21361  *35230000
352400* IF THE SQL STATEMENT IS SUCCESSFUL, THEN SET PS-CALL-API-YES   *35240000
352500* TO TRUE.                                                       *35250000
352600*----------------------------------------------------------------*35260000
352700                                                                  35270000
352800 4100-SELECT-PURITM-DATA.                                         35280000
352900                                                                  35290000
353000     SET PS-CALL-API-NO      TO TRUE.                             35300000
353100                                                                  35310000
353200     EXEC SQL                                                     35320000
353300           SELECT AD_EVNT_DTE                                     35330000
353400                , PO_LNE_NBR                                      35340000
353500                , CL_NBR                                          35350000
353600                , SKU_SEQ_NBR                                     35360000
353700                , VEND_STYL_NAME                                  35370000
353800                , STATUS_CDE                                      35380000
353900                , UNT_QTY                                         35390000
354000                , ITM_NBR                                         35400000
354100             INTO :PURITM-AD-EVNT-DTE                             35410000
354200                , :PURITM-PO-LNE-NBR                              35420000
354300                , :PURITM-CL-NBR                                  35430000
354400                , :PURITM-SKU-SEQ-NBR                             35440000
354500                , :PURITM-VEND-STYL-NAME                          35450000
354600                , :ASC-PURITM-STATUS-CDE                          35460000
354700                , :ASC-PURITM-UNT-QTY                             35470000
354800                , :PURITM-ITM-NBR                                 35480000
354900             FROM TPURITM                                         35490000
355000            WHERE PO_NBR             = :DK-PO-NBR                 35500000
355100              AND APP_PO_LNE_NBR = :DK-PKSL-LNE-NBR               35510000
355200              AND VER_STATUS_CDE = :PC-ACTIVE                     35520000
355300     END-EXEC                                                     35530000
355400                                                                  35540000
355500     EVALUATE TRUE                                                35550000
355600         WHEN SQLCODE = ZERO                                      35560000
355700             MOVE PURITM-CL-NBR  TO PV-SN-CL-NBR                  35570000
355800             SET PS-CALL-API-YES     TO TRUE                      35580000
355900         WHEN SQLCODE = +100                                      35590000
356000              CONTINUE                                            35600000
356100         WHEN SQLCODE = -904                                      35610000
356200         WHEN SQLCODE = -911                                      35620000
356300         WHEN SQLCODE = -913                                      35630000
356400              PERFORM 9900-SOFT-ABORT                             35640000
356500         WHEN SQLWARN0 NOT = SPACES                               35650000
356600         WHEN SQLCODE      NOT = ZERO                             35660000
356700              MOVE '4100-SELECT-PURITM-DATA'                      35670000
356800                             TO DP013-PARAGRAPH                   35680000
356900              MOVE 'UNSUCCESSFUL SELECT OF PURITM'                35690000
357000                             TO DP013-MESSAGE-TEXT (1)            35700000
357100              MOVE SQLCA         TO DP013-SQLCA                   35710000
357200              MOVE 'TPURITM' TO DP013-DB2-TABLE-NAME (1)          35720000
357300              SET DP013-DB2-ABEND                                 35730000
357400                  DP013-XCTL-DISPLAY-RESTART                      35740000
357500                             TO TRUE                              35750000
357600                                                                  35760000
357700              PERFORM DP013-0000-PROCESS-ABEND                    35770000
357800     END-EVALUATE.                                                35780000
357900*----------------------------------------------------------------*35790000
358000* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *35800000
358100*----------------------------------------------------------------*35810000
358200                                                                  35820000
358300*----------------------------------------------------------------*35830000
358400*                                               **   WR # 21361  *35840000
358500*  ADDED NEW PARAGRAPH TO INCLUDE XLKUT001 LOGIC                 *35850000
358600*----------------------------------------------------------------*35860000
358700                                                                  35870000
358800 4105-CALL-XLKUT-DOMAIN-PGM.                                      35880000
358900     INITIALIZE XL001-ITEM-COMMAREA                               35890000
359000     MOVE PURITM-ITM-NBR   TO XL001-KEY-ITM-NBR                   35900000
359100                                                                  35910000
359200     SET  XL001-BY-ITEM                                           35920000
359300          XL001-SELECT-SKU TO TRUE                                35930000
359400                                                                  35940000
359500     CALL XL001-VSM-PGM USING  DFHEIBLK                           35950000
359600                               XL001-COMMAREA                     35960000
359700                               XL001-ITEM-COMMAREA                35970000
359800                                                                  35980000
359900     EVALUATE TRUE                                                35990000
360000                                                                  36000000
360100          WHEN XL001-SKU-SQLCODE = +0                             36010000
360200               MOVE XL001-SKU-NBR     TO PV-SKU-NBR               36020000
360300                                                                  36030000
360400          WHEN XL001-SKU-SQLCODE = +100                           36040000
360500               MOVE SPACES  TO PV-SKU-NBR                         36050000
360600                                                                  36060000
360700          WHEN XL001-SKU-CONTENTION                               36070000
360800               PERFORM 9900-SOFT-ABORT                            36080000
360900                                                                  36090000
361000          WHEN OTHER                                              36100000
361100               MOVE '4105-CALL-XLKUT-DOMAIN-PGM'                  36110000
361200                                  TO DP013-PARAGRAPH              36120000
361300               MOVE 'INVALID RETURN'                              36130000
361400                                  TO DP013-MESSAGE-TEXT (1)       36140000
361500               MOVE 'XLV_SKU '  TO DP013-DB2-TABLE-NAME (1)       36150000
361600               MOVE XL001-SQLCA   TO DP013-SQLCA                  36160000
361700               SET DP013-DB2-ABEND                                36170000
361800                                  TO TRUE                         36180000
361900               PERFORM DP013-0000-PROCESS-ABEND                   36190000
362000          END-EVALUATE.                                           36200000
362100                                                                  36210000
362200*----------------------------------------------------------------*36220000
362300* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *36230000
362400*----------------------------------------------------------------*36240000
362500******************************************************************36250000
362600*    SELECT RECEIVER ITEM DATA TO DISPLAY IN THE HEADER AREA      36260000
362700******************************************************************36270000
362800                                                                  36280000
362900 4310-SELECT-RECITM-DATA.                                         36290000
363000                                                                  36300000
363100     INITIALIZE DCLTRECITM.                                       36310000
363200                                                                  36320000
363300     EXEC SQL                                                     36330000
363400           SELECT INNR_PACK_QTY,                                  36340000
363500                  CASE_PACK_QTY,                                  36350000
363600                  PKSL_ITM_QTY,                                   36360000
363700                  DTL_CK_ITM_QTY,                                 36370000
363800                  CRE_TMST                                        36380000
363900             INTO :RECITM-INNR-PACK-QTY,                          36390000
364000                  :RECITM-CASE-PACK-QTY,                          36400000
364100                  :RECITM-PKSL-ITM-QTY,                           36410000
364200                  :RECITM-DTL-CK-ITM-QTY,                         36420000
364300                  :RECITM-CRE-TMST                                36430000
364400             FROM TRECITM                                         36440000
364500            WHERE ORD_NBR            = :DK-PO-NBR                 36450000
364600              AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR           36460000
364700              AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR            36470000
364800              AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID       36480000
364900              AND FCLTY_ID           = :ASC-KEY-FCLTY-ID          36490000
365000              AND VER_STATUS_CDE = :PC-ACTIVE                     36500000
365100     END-EXEC                                                     36510000
365200                                                                  36520000
365300     EVALUATE TRUE                                                36530000
365400         WHEN SQLCODE = ZERO                                      36540000
365500         WHEN SQLCODE = +100                                      36550000
365600              CONTINUE                                            36560000
365700         WHEN SQLCODE = -904                                      36570000
365800         WHEN SQLCODE = -911                                      36580000
365900         WHEN SQLCODE = -913                                      36590000
366000             PERFORM 9900-SOFT-ABORT                              36600000
366100         WHEN SQLWARN0 NOT = SPACES                               36610000
366200         WHEN SQLCODE      NOT = ZERO                             36620000
366300              MOVE '4310-SELECT-RECITM-DATA'                      36630000
366400                             TO DP013-PARAGRAPH                   36640000
366500              MOVE 'UNSUCCESSFUL SELECT OF RECITM HEADER DATA'    36650000
366600                             TO DP013-MESSAGE-TEXT (1)            36660000
366700              MOVE SQLCA         TO DP013-SQLCA                   36670000
366800              MOVE 'TRECITM' TO DP013-DB2-TABLE-NAME (1)          36680000
366900              SET DP013-DB2-ABEND                                 36690000
367000                  DP013-XCTL-DISPLAY-RESTART                      36700000
367100                             TO TRUE                              36710000
367200                                                                  36720000
367300              PERFORM DP013-0000-PROCESS-ABEND                    36730000
367400     END-EVALUATE.                                                36740000
367500                                                                  36750000
367600******************************************************************36760000
367700*  MOVES THE COMMAREA TO THE SCREEN.                              36770000
367800******************************************************************36780000
367900/                                                                 36790000
368000 4400-MOVE-COMMAREA-TO-SCREEN.                                    36800000
368100                                                                  36810000
368200     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1)) AND         36820000
368300           (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1))) OR         36830000
368400           (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))            36840000
368500             MOVE +1             TO ASC-BLK-SUB                   36850000
368600                                                                  36860000
368700             PERFORM 5100-WRITE-TEMP-STORAGE                      36870000
368800                                                                  36880000
368900             ADD +1              TO ASC-BLK-SUB                   36890000
369000                                                                  36900000
369100             PERFORM 5100-WRITE-TEMP-STORAGE                      36910000
369200                                                                  36920000
369300             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             36930000
369400                 GIVING PV-BLOCK-NUMBER                           36940000
369500                 REMAINDER PV-REMAINDER                           36950000
369600             IF PV-REMAINDER > ZERO                               36960000
369700                 ADD +1          TO PV-BLOCK-NUMBER               36970000
369800             END-IF                                               36980000
369900             MOVE +1             TO ASC-BLK-SUB                   36990000
370000                                                                  37000000
370100             PERFORM 4410-READ-TEMP-STORAGE                       37010000
370200                                                                  37020000
370300             ADD +1              TO ASC-BLK-SUB                   37030000
370400                                    PV-BLOCK-NUMBER               37040000
370500                                                                  37050000
370600             PERFORM 4410-READ-TEMP-STORAGE                       37060000
370700                                                                  37070000
370800     END-IF.                                                      37080000
370900                                                                  37090000
371000     MOVE +1                     TO ASC-BLK-SUB.                  37100000
371100     COMPUTE ASC-ITEM-SUB =                                       37110000
371200         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              37120000
371300                       + PC-ITEMS-PER-PANEL).                     37130000
371400                                                                  37140000
371500     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         37150000
371600         ADD +1                  TO ASC-BLK-SUB                   37160000
371700         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            37170000
371800     END-IF.                                                      37180000
371900                                                                  37190000
372000     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           37200000
372100         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                37210000
372200                                                                  37220000
372300     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        37230000
372400                                                                  37240000
372500     SET PS-ALL-LINES-PROTECTED TO TRUE.                          37250000
372600     PERFORM 4420-FORMAT-LIST-LINES                               37260000
372700         VARYING PV-SUB  FROM PC-ITEMS-PER-PANEL BY -1            37270000
372800         UNTIL   PV-SUB < +1.                                     37280000
372900                                                                  37290000
373000     IF PS-ALL-LINES-PROTECTED                                    37300000
373100         MOVE -1                   TO ASTRTITL                    37310000
373200     END-IF.                                                      37320000
373300                                                                  37330000
373400     COMPUTE ASC-ITEMS-DISPLAYED =                                37340000
373500                   ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).37350000
373600     MOVE PV-TOP-ITEM            TO ASC-ITEM-AT-TOP-OF-PANEL      37360000
373700                                    ASTRTITO.                     37370000
373800     MOVE ASC-ITEM-AT-BOT-OF-PANEL                                37380000
373900                                 TO AENDITO.                      37390000
374000     MOVE ASC-NUMBER-OF-ITEMS-READ                                37400000
374100                                 TO ATOTITO.                      37410000
374200     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            37420000
374300                                 TO ASELITO.                      37430000
374400                                                                  37440000
374500     MOVE PC-DASH                TO ASC-KEY-REC-DASH.             37450000
374600     MOVE ASC-KEY-PO-NBR         TO ARCVNBRO.                     37460000
374700     MOVE ASC-KEY-PKSL-LNE-NBR   TO ALINEO.                       37470000
374800     MOVE ASC-KEY-REC-SEQ-NBR    TO ARCVSEQO.                     37480000
374900     MOVE ASC-KEY-OPER-UNT-ID    TO AOPERO.                       37490000
375000     MOVE ASC-KEY-FCLTY-ID       TO AFCLTYO.                      37500000
375100     MOVE ASC-KEY-FCLTY-DESC     TO AFCLNAMO.                     37510000
375200*----------------------------------------------------------------*37520000
375300* MOVE THE VALUE OF DEPT AND CLASS TO SCREEN         WR # 21361  *37530000
375400*----------------------------------------------------------------*37540000
375500     MOVE ASC-DEPT               TO ADEPTO.                       37550000
375600     MOVE ASC-CLASS              TO ACLASSO.                      37560000
375700*----------------------------------------------------------------*37570000
375800* CHANGES MADE FOR WR # 21361 ENDS HERE.                         *37580000
375900*----------------------------------------------------------------*37590000
376000     MOVE ASC-SKU-NBR            TO ASKUO.                        37600000
376100     MOVE ASC-TOT-PCKSLP-QTY     TO APKTOTO.                      37610000
376200     MOVE ASC-TOT-ACTUAL-QTY     TO AACTOTO.                      37620000
376300     MOVE ASC-TOT-VERIFY-QTY     TO AVFTOTO.                      37630000
376400     MOVE ASC-RECEIV-STATUS-CDE  TO ASTATUSO.                     37640000
376500                                                                  37650000
376600     IF DP020-MSG-NUMBER-X = SPACE                                37660000
376700        IF ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ    37670000
376800             IF ASC-OVERAGE                                       37680000
376900                 MOVE PC-TSYMSG-01264                             37690000
377000                          TO DP020-MSG-NUMBER                     37700000
377100                SET DP020-MSG-FATAL                               37710000
377200                                     TO TRUE                      37720000
377300             ELSE                                                 37730000
377400                 MOVE PC-TSYMSG-00279    TO DP020-MSG-NUMBER      37740000
377500                 SET DP020-MSG-INFORMATIONAL                      37750000
377600                                     TO TRUE                      37760000
377700             END-IF                                               37770000
377800        ELSE                                                      37780000
377900             IF ASC-OVERAGE                                       37790000
378000                 MOVE PC-TSYMSG-01264                             37800000
378100                          TO DP020-MSG-NUMBER                     37810000
378200                SET DP020-MSG-FATAL                               37820000
378300                                     TO TRUE                      37830000
378400             ELSE                                                 37840000
378500                 MOVE PC-TSYMSG-00070    TO DP020-MSG-NUMBER      37850000
378600                 SET DP020-MSG-INFORMATIONAL                      37860000
378700                                     TO TRUE                      37870000
378800             END-IF                                               37880000
378900        END-IF                                                    37890000
379000     END-IF.                                                      37900000
379100                                                                  37910000
379200 4410-READ-TEMP-STORAGE.                                          37920000
379300                                                                  37930000
379400     EXEC CICS READQ TS                                           37940000
379500               QUEUE (ASC-LIST-QUEUE-NAME)                        37950000
379600               INTO  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            37960000
379700               ITEM  (PV-BLOCK-NUMBER)                            37970000
379800               RESP  (PV-CICS-RESP)                               37980000
379900     END-EXEC.                                                    37990000
380000                                                                  38000000
380100     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     38010000
380200         (PV-CICS-RESP = DFHRESP (ITEMERR)))                      38020000
380300         CONTINUE                                                 38030000
380400     ELSE                                                         38040000
380500         SET DP013-CICS-ABEND                                     38050000
380600             DP013-NO-ROLLBACK   TO TRUE                          38060000
380700         MOVE '4410-READ-TEMP-STORAGE'                            38070000
380800                                 TO DP013-PARAGRAPH               38080000
380900         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   38090000
381000                                 TO DP013-MESSAGE-TEXT (1)        38100000
381100                                                                  38110000
381200         PERFORM DP013-0000-PROCESS-ABEND                         38120000
381300     END-IF.                                                      38130000
381400                                                                  38140000
381500     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     38150000
381600                                 TO TRUE.                         38160000
381700                                                                  38170000
381800     IF PV-CICS-RESP = DFHRESP (ITEMERR)                          38180000
381900         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               38190000
382000     END-IF.                                                      38200000
382100                                                                  38210000
382200 4420-FORMAT-LIST-LINES.                                          38220000
382300                                                                  38230000
382400     IF ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ       38240000
382500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                38250000
382600         MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA       (PV-SUB)     38260000
382700                                    MR-ADJ-QTY-A     (PV-SUB)     38270000
382800         MOVE DP015-HL-OFF       TO MR-SELECTH       (PV-SUB)     38280000
382900                                    MR-ADJ-QTY-H     (PV-SUB)     38290000
383000         MOVE SPACE              TO MR-SELECTI       (PV-SUB)     38300000
383100                                    MR-ADJ-QTY       (PV-SUB)     38310000
383200                                    MR-STR-NBR       (PV-SUB)     38320000
383300                                    MR-VERFD-ITM-QTY (PV-SUB)     38330000
383400                                    MR-ACTION        (PV-SUB)     38340000
383500                                    MR-PKSLP-ITM-QTY (PV-SUB)     38350000
383600                                    MR-ACTUAL-ITM-QTY (PV-SUB)    38360000
383700     ELSE                                                         38370000
383800         IF ASC-UPDATE-NO (ASC-BLK-SUB ASC-ITEM-SUB)              38380000
383900             MOVE DP015-ASK-DRK-OFF TO MR-SELECTA (PV-SUB)        38390000
384000                                       MR-ADJ-QTY-A (PV-SUB)      38400000
384100             MOVE DP015-BLUE                                      38410000
384200                                    TO MR-ADJ-QTY-C (PV-SUB)      38420000
384300                                       MR-SELECTC   (PV-SUB)      38430000
384400         ELSE                                                     38440000
384500             MOVE -1                TO MR-SELECTL (PV-SUB)        38450000
384600             MOVE DP015-GREEN                                     38460000
384700                                    TO MR-ADJ-QTY-C (PV-SUB)      38470000
384800                                       MR-SELECTC   (PV-SUB)      38480000
384900             SET PS-ALL-LINES-NOT-PROTECTED TO TRUE               38490000
385000         END-IF                                                   38500000
385100         IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >     38510000
385200                                                             SPACE38520000
385300             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 38530000
385400                                 TO MR-SELECTI (PV-SUB)           38540000
385500         ELSE                                                     38550000
385600             MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      38560000
385700                                 TO MR-SELECTI (PV-SUB)           38570000
385800         END-IF                                                   38580000
385900                                                                  38590000
386000         IF DP030-SET-CURSOR-TRAILER                              38600000
386100            IF ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) >  38610000
386200                                                             SPACE38620000
386300               OR PV-SUB = 1                                      38630000
386400                SET DP030-SET-CURSOR-APPL-1                       38640000
386500                                 TO TRUE                          38650000
386600            END-IF                                                38660000
386700         END-IF                                                   38670000
386800                                                                  38680000
386900*02/05 - BEGIN                                                    38690000
387000         IF  ASC-UPDATE-NO    (ASC-BLK-SUB ASC-ITEM-SUB)          38700000
387100             CONTINUE                                             38710000
387200         ELSE                                                     38720000
387300         IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)          38730000
387400             MOVE ASC-ADJ-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          38740000
387500                                   TO PV-DISPLAY-ZERO             38750000
387600             MOVE PV-DISPLAY-ZERO                                 38760000
387700                                   TO MR-ADJ-QTY (PV-SUB)         38770000
387800             MOVE DP015-UNP-ALP-NOR-MDT                           38780000
387900                                   TO MR-ADJ-QTY-A (PV-SUB)       38790000
388000         ELSE                                                     38800000
388100             MOVE ASC-ADJ-QTY (ASC-BLK-SUB ASC-ITEM-SUB)          38810000
388200                                   TO PV-DISPLAY-NO-ZERO          38820000
388300             MOVE PV-DISPLAY-NO-ZERO                              38830000
388400                                   TO MR-ADJ-QTY (PV-SUB)         38840000
388500         END-IF                                                   38850000
388600         END-IF                                                   38860000
388700*02/05 - END                                                      38870000
388800                                                                  38880000
388900         IF PV-TOP-ITEM NOT = ASC-ITEM-AT-TOP-OF-PANEL            38890000
389000             MOVE ASC-ACTION  (ASC-BLK-SUB ASC-ITEM-SUB)          38900000
389100                          TO MR-ACTION          (PV-SUB)          38910000
389200             MOVE ASC-VERFD-QTY-N    (ASC-BLK-SUB ASC-ITEM-SUB)   38920000
389300                             TO MR-VERFD-ITM-QTY-EDITED(PV-SUB)   38930000
389400             MOVE ASC-MESSAGE        (ASC-BLK-SUB ASC-ITEM-SUB)   38940000
389500                             TO MR-MESSAGE-EDITED(PV-SUB)         38950000
389600             MOVE ASC-PCKSLP-QTY-N   (ASC-BLK-SUB ASC-ITEM-SUB)   38960000
389700                            TO MR-PKSLP-ITM-QTY-EDITED(PV-SUB)    38970000
389800             MOVE ASC-ACTUAL-QTY-N   (ASC-BLK-SUB ASC-ITEM-SUB)   38980000
389900                            TO MR-ACTUAL-ITM-QTY-EDITED(PV-SUB)   38990000
390000                                                                  39000000
390100             IF  ASC-SEL-ZERO-YES (ASC-BLK-SUB ASC-ITEM-SUB)      39010000
390200                 MOVE ASC-ADJ-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      39020000
390300                                   TO PV-DISPLAY-ZERO             39030000
390400                 MOVE PV-DISPLAY-ZERO                             39040000
390500                                   TO MR-ADJ-QTY (PV-SUB)         39050000
390600                 MOVE DP015-UNP-ALP-NOR-MDT                       39060000
390700                                   TO MR-ADJ-QTY-A (PV-SUB)       39070000
390800             ELSE                                                 39080000
390900                 MOVE ASC-ADJ-QTY (ASC-BLK-SUB ASC-ITEM-SUB)      39090000
391000                                   TO PV-DISPLAY-NO-ZERO          39100000
391100                 MOVE PV-DISPLAY-NO-ZERO                          39110000
391200                                   TO MR-ADJ-QTY (PV-SUB)         39120000
391300             END-IF                                               39130000
391400                                                                  39140000
391500             MOVE ASC-STR-NBR        (ASC-BLK-SUB ASC-ITEM-SUB)   39150000
391600                          TO MR-STR-NBR         (PV-SUB)          39160000
391700                                                                  39170000
391800             IF  ((DP020-FK-PREV-PAGE (DP020-SRC-AID)  OR         39180000
391900                   DP020-FK-NEXT-PAGE (DP020-SRC-AID)  OR         39190000
392000                   DP020-FK-FIRST-PAGE (DP020-SRC-AID) OR         39200000
392100                   DP020-SRC-AID = DP016-ENTER)    AND            39210000
392200                   NOT ASC-OVERAGE  AND                           39220000
392300                   NOT ASC-NO-OVERAGE)           OR               39230000
392400                 ASC-NO-OVERAGE                                   39240000
392500                 CONTINUE                                         39250000
392600             ELSE                                                 39260000
392700             IF  ASC-PACK-BY-ST-OVERAGE(ASC-BLK-SUB ASC-ITEM-SUB) 39270000
392800                 IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        39280000
392900                     MOVE DP015-YELLOW TO MR-STR-NBR-C (PV-SUB)   39290000
393000                                          MR-ADJ-QTY-C (PV-SUB)   39300000
393100                                          MR-SELECTC   (PV-SUB)   39310000
393200                 END-IF                                           39320000
393300                 MOVE DP015-BLUE       TO MR-SELECTC   (PV-SUB)   39330000
393400                 MOVE DP015-PRO-NOR-OFF                           39340000
393500                                       TO MR-SELECTA   (PV-SUB)   39350000
393600             ELSE                                                 39360000
393700                 MOVE DP015-BLUE       TO MR-STR-NBR-C (PV-SUB)   39370000
393800                                          MR-ADJ-QTY-C (PV-SUB)   39380000
393900                                          MR-SELECTC   (PV-SUB)   39390000
394000                 MOVE DP015-PRO-NOR-OFF                           39400000
394100                                       TO MR-SELECTA   (PV-SUB)   39410000
394200                 MOVE SPACE            TO MR-SELECTI   (PV-SUB)   39420000
394300                 MOVE DP015-PRO-NOR-OFF                           39430000
394400                                       TO MR-ADJ-QTY-A (PV-SUB)   39440000
394500             END-IF                                               39450000
394600             IF  ASC-OVERAGE                                      39460000
394700                  CONTINUE                                        39470000
394800             ELSE                                                 39480000
394900                  SET  ASC-NO-PACK-BY-ST-OVERAGE                  39490000
395000                      (ASC-BLK-SUB ASC-ITEM-SUB)  TO TRUE         39500000
395100             END-IF                                               39510000
395200             IF  ASC-UPDATE-NO                                    39520000
395300                      (ASC-BLK-SUB ASC-ITEM-SUB)                  39530000
395400                 MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA(PV-SUB)    39540000
395500                                            MR-ADJ-QTY-A(PV-SUB)  39550000
395600             END-IF                                               39560000
395700         END-IF                                                   39570000
395800     END-IF.                                                      39580000
395900                                                                  39590000
396000     SUBTRACT +1 FROM ASC-ITEM-SUB.                               39600000
396100                                                                  39610000
396200     IF ASC-ITEM-SUB < +1                                         39620000
396300         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  39630000
396400         MOVE +1                 TO ASC-BLK-SUB.                  39640000
396500                                                                  39650000
396600 4430-CHECK-FOR-BEGIN-AND-END.                                    39660000
396700                                                                  39670000
396800     IF ASC-START-OF-SELECTED-RANGE > ZERO                        39680000
396900        IF ASC-END-OF-SELECTED-RANGE = ZERO                       39690000
397000            MOVE PC-TSYMSG-00051 TO DP020-MSG-NUMBER              39700000
397100            SET DP020-MSG-WARNING                                 39710000
397200                                 TO TRUE                          39720000
397300                                                                  39730000
397400            PERFORM 4440-POSITION-AT-WARNING                      39740000
397500                                                                  39750000
397600         END-IF                                                   39760000
397700     ELSE                                                         39770000
397800         IF ASC-END-OF-SELECTED-RANGE > ZERO                      39780000
397900             MOVE PC-TSYMSG-00053                                 39790000
398000                                 TO DP020-MSG-NUMBER              39800000
398100             SET DP020-MSG-WARNING                                39810000
398200                                 TO TRUE                          39820000
398300                                                                  39830000
398400             PERFORM 4440-POSITION-AT-WARNING                     39840000
398500                                                                  39850000
398600         END-IF                                                   39860000
398700     END-IF.                                                      39870000
398800                                                                  39880000
398900 4440-POSITION-AT-WARNING.                                        39890000
399000                                                                  39900000
399100     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE -               39910000
399200                                                  PV-TOP-ITEM + 1.39920000
399300     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       39930000
399400         CONTINUE                                                 39940000
399500     ELSE                                                         39950000
399600         SET DP030-SET-CURSOR-APPL-1                              39960000
399700                                 TO TRUE                          39970000
399800         MOVE -1                 TO MR-SELECTL (PV-SUB)           39980000
399900         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           39990000
400000         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           40000000
400100     END-IF.                                                      40010000
400200                                                                  40020000
400300     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE - PV-TOP-ITEM + 1.40030000
400400                                                                  40040000
400500     IF PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                       40050000
400600         CONTINUE                                                 40060000
400700     ELSE                                                         40070000
400800         SET DP030-SET-CURSOR-APPL-1                              40080000
400900                                 TO TRUE                          40090000
401000         MOVE -1                 TO MR-SELECTL (PV-SUB)           40100000
401100         MOVE DP015-YELLOW       TO MR-SELECTC (PV-SUB)           40110000
401200         MOVE DP015-REVERSE      TO MR-SELECTH (PV-SUB)           40120000
401300     END-IF.                                                      40130000
401400                                                                  40140000
401500 5000-PREPARE-SEL-QUEUE.                                          40150000
401600                                                                  40160000
401700     MOVE +1                     TO ASC-BLK-SUB.                  40170000
401800                                                                  40180000
401900     PERFORM 5100-WRITE-TEMP-STORAGE.                             40190000
402000                                                                  40200000
402100     ADD +1                      TO ASC-BLK-SUB.                  40210000
402200                                                                  40220000
402300     PERFORM 5100-WRITE-TEMP-STORAGE.                             40230000
402400                                                                  40240000
402500     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC017-SEL-QUEUE-NAME.         40250000
402600                                                                  40260000
402700     PERFORM 6010-DELETE-SEL-QUEUE.                               40270000
402800                                                                  40280000
402900     SET ASC-UPDATE-TSQ          TO TRUE.                         40290000
403000     SET RC013-IDX               TO 1.                            40300000
403100     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        40310000
403200                                                                  40320000
403300     EVALUATE TRUE                                                40330000
403400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              40340000
403500         WHEN  DP020-FK-CONFIRM(DP020-SRC-AID)                    40350000
403600             SET ASC-NO-OVERAGE TO TRUE                           40360000
403700             MOVE ASC-KEY-PO-NBR-N                                40370000
403800                                 TO DK-PO-NBR                     40380000
403900             MOVE ASC-KEY-PKSL-LNE-NBR                            40390000
404000                                 TO DK-PKSL-LNE-NBR               40400000
404100             MOVE ASC-KEY-REC-SEQ-NBR-N                           40410000
404200                                 TO DK-REC-SEQ-NBR                40420000
404300             PERFORM 5300-SEARCH-FOR-SELECTION                    40430000
404400                 VARYING PV-ITEM  FROM 1 BY 1                     40440000
404500                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      40450000
404600             IF  PS-TRECDIS-UPDATE-DONE                           40460000
404700**CALL UNITS WORKED EVEN OF 'NET' UPDATE QTY IS ZERO              40470000
404800*GB              IF  PA-ACCUM-UPDATE-QTY NOT EQUAL TO ZERO        40480000
404900                     PERFORM 7500-PROCESS-UNITS-WORK              40490000
405000*GB              END-IF                                           40500000
405100             END-IF                                               40510000
405200             IF  ASC-PURITM-UNT-QTY GREATER THAN ZERO             40520000
405300                 IF ASC-RECITM-STATUS-CDE = PC-VE                 40530000
405400                     PERFORM 5800-CHECK-PO-STATUS                 40540000
405500                 END-IF                                           40550000
405600             END-IF                                               40560000
405700             MOVE PC-TSYMSG-00059                                 40570000
405800                                 TO DP020-MSG-NUMBER              40580000
405900             SET DP020-MSG-INFORMATIONAL                          40590000
406000                                 TO TRUE                          40600000
406100             PERFORM 9000-UPDATE-SELECTION-QUEUE                  40610000
406200                                                                  40620000
406300             INITIALIZE ASC-BLOCK-ENTRIES (1)                     40630000
406400                        ASC-BLOCK-ENTRIES (2)                     40640000
406500             MOVE +1             TO ASC-BLK-SUB                   40650000
406600                                                                  40660000
406700             MOVE ZERO           TO ASC-ITEM-SUB                  40670000
406800                                    ASC-NUMBER-OF-SELECTED-ITEMS  40680000
406900                                    ASC-START-OF-SELECTED-RANGE   40690000
407000                                    ASC-END-OF-SELECTED-RANGE     40700000
407100                                    ASC-ITEM-AT-TOP-OF-PANEL      40710000
407200                                                                  40720000
407300             PERFORM 4410-READ-TEMP-STORAGE                       40730000
407400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 40740000
407500             PERFORM 3200-RESET-ATTRIBUTES                        40750000
407600                                                                  40760000
407700         WHEN OTHER                                               40770000
407800             PERFORM 5200-FILL-SEL-QUEUE-RECORD                   40780000
407900                 VARYING PV-ITEM  FROM 1 BY 1                     40790000
408000                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      40800000
408100                                                                  40810000
408200     END-EVALUATE.                                                40820000
408300                                                                  40830000
408400     IF RC013-IDX > 1                                             40840000
408500         PERFORM 5205-WRITE-SEL-QUEUE                             40850000
408600         ADD +1                  TO RC017-NUMBER-OF-TS-ITEMS      40860000
408700     END-IF.                                                      40870000
408800 5005-PREPARE-SEL-QUEUE.                                          40880000
408900                                                                  40890000
409000     MOVE +1                     TO ASC-BLK-SUB.                  40900000
409100                                                                  40910000
409200     PERFORM 5100-WRITE-TEMP-STORAGE.                             40920000
409300                                                                  40930000
409400     ADD +1                      TO ASC-BLK-SUB.                  40940000
409500                                                                  40950000
409600     PERFORM 5100-WRITE-TEMP-STORAGE.                             40960000
409700                                                                  40970000
409800     MOVE ASC-SEL-QUEUE-NAME-OUT TO RC017-SEL-QUEUE-NAME.         40980000
409900                                                                  40990000
410000     PERFORM 6010-DELETE-SEL-QUEUE.                               41000000
410100                                                                  41010000
410200     SET ASC-UPDATE-TSQ          TO TRUE.                         41020000
410300     SET RC013-IDX               TO 1.                            41030000
410400     MOVE ZERO                   TO RC017-NUMBER-OF-TS-ITEMS.     41040000
410500     INITIALIZE RC013-SELECTED-ITEM-ARRAY.                        41050000
410600                                                                  41060000
410700     EVALUATE TRUE                                                41070000
410800         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              41080000
410900             MOVE ASC-KEY-PO-NBR-N                                41090000
411000                                 TO DK-PO-NBR                     41100000
411100             MOVE ASC-KEY-PKSL-LNE-NBR                            41110000
411200                                 TO DK-PKSL-LNE-NBR               41120000
411300             MOVE ASC-KEY-REC-SEQ-NBR-N                           41130000
411400                                 TO DK-REC-SEQ-NBR                41140000
411500             PERFORM 5305-SEARCH-FOR-SELECTION                    41150000
411600                 VARYING PV-ITEM  FROM 1 BY 1                     41160000
411700                 UNTIL   PV-ITEM > ASC-HIGHEST-BLOCK-WRITTEN      41170000
411800                                                                  41180000
411900             INITIALIZE ASC-BLOCK-ENTRIES (1)                     41190000
412000                        ASC-BLOCK-ENTRIES (2)                     41200000
412100             MOVE +1             TO ASC-BLK-SUB                   41210000
412200                                    PV-TOP-ITEM                   41220000
412300                                                                  41230000
412400             MOVE ZERO           TO ASC-ITEM-SUB                  41240000
412500                                    ASC-START-OF-SELECTED-RANGE   41250000
412600                                    ASC-END-OF-SELECTED-RANGE     41260000
412700                                    ASC-ITEM-AT-TOP-OF-PANEL      41270000
412800                                                                  41280000
412900             PERFORM 4410-READ-TEMP-STORAGE                       41290000
413000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 41300000
413100             PERFORM 3200-RESET-ATTRIBUTES                        41310000
413200                                                                  41320000
413300                                                                  41330000
413400     IF RC013-IDX > 1                                             41340000
413500         PERFORM 5205-WRITE-SEL-QUEUE                             41350000
413600         ADD +1                  TO RC017-NUMBER-OF-TS-ITEMS      41360000
413700     END-IF.                                                      41370000
413800                                                                  41380000
413900 5100-WRITE-TEMP-STORAGE.                                         41390000
414000                                                                  41400000
414100     MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)                    41410000
414200                                 TO PV-LIST-ITEM-NUMBER.          41420000
414300     COMPUTE PV-BLOCK-NUMBER = 1 +                                41430000
414400                 ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).41440000
414500                                                                  41450000
414600     IF PV-BLOCK-NUMBER NOT > ASC-HIGHEST-BLOCK-WRITTEN           41460000
414700        IF ASC-BLOCK-MODIFIED (ASC-BLK-SUB)                       41470000
414800                                                                  41480000
414900            PERFORM 5105-REWRITE-ASC-LISTQ                        41490000
415000                                                                  41500000
415100        END-IF                                                    41510000
415200     ELSE                                                         41520000
415300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       41530000
415400                                     ASC-HIGHEST-BLOCK-WRITTEN + 141540000
415500         PERFORM 5110-WRITE-ASC-LISTQ                             41550000
415600                                                                  41560000
415700         ADD +1                  TO ASC-HIGHEST-BLOCK-WRITTEN     41570000
415800     END-IF.                                                      41580000
415900                                                                  41590000
416000     SET ASC-BLOCK-NOT-MODIFIED (ASC-BLK-SUB)                     41600000
416100                                 TO TRUE.                         41610000
416200                                                                  41620000
416300 5105-REWRITE-ASC-LISTQ.                                          41630000
416400                                                                  41640000
416500     EXEC CICS WRITEQ TS                                          41650000
416600               QUEUE   (ASC-LIST-QUEUE-NAME)                      41660000
416700               FROM    (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))           41670000
416800               ITEM    (PV-BLOCK-NUMBER)                          41680000
416900               REWRITE                                            41690000
417000               RESP    (PV-CICS-RESP)                             41700000
417100     END-EXEC.                                                    41710000
417200                                                                  41720000
417300     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       41730000
417400         SET DP013-CICS-ABEND                                     41740000
417500             DP013-NO-ROLLBACK   TO TRUE                          41750000
417600         MOVE '5105-REWRITE-ASC-LISTQ'                            41760000
417700                                 TO DP013-PARAGRAPH               41770000
417800         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'41780000
417900                                 TO DP013-MESSAGE-TEXT (1)        41790000
418000         PERFORM DP013-0000-PROCESS-ABEND                         41800000
418100     END-IF.                                                      41810000
418200                                                                  41820000
418300 5110-WRITE-ASC-LISTQ.                                            41830000
418400                                                                  41840000
418500     EXEC CICS WRITEQ TS                                          41850000
418600               QUEUE (ASC-LIST-QUEUE-NAME)                        41860000
418700               FROM  (ASC-BLOCK-ENTRIES (ASC-BLK-SUB))            41870000
418800               ITEM  (PV-BLOCK-NUMBER)                            41880000
418900               RESP  (PV-CICS-RESP)                               41890000
419000     END-EXEC.                                                    41900000
419100                                                                  41910000
419200     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      41920000
419300         SET DP013-CICS-ABEND                                     41930000
419400             DP013-NO-ROLLBACK   TO TRUE                          41940000
419500         MOVE '5110-WRITE-ASC-LISTQ'                              41950000
419600                                 TO DP013-PARAGRAPH               41960000
419700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE WRITE'  41970000
419800                                 TO DP013-MESSAGE-TEXT (1)        41980000
419900         PERFORM DP013-0000-PROCESS-ABEND                         41990000
420000     END-IF.                                                      42000000
420100                                                                  42010000
420200 5200-FILL-SEL-QUEUE-RECORD.                                      42020000
420300                                                                  42030000
420400     PERFORM 6112-READ-LIST-QUEUE.                                42040000
420500                                                                  42050000
420600     IF PV-CICS-RESP = DFHRESP (NORMAL)                           42060000
420700         PERFORM                                                  42070000
420800         VARYING LQW-IDX  FROM 1 BY 1                             42080000
420900         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  42090000
421000                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            42100000
421100                 SET RC013-IDX UP BY 1                            42110000
421200                 IF RC013-IDX > RC013-MAX-ITEMS                   42120000
421300                                                                  42130000
421400                     PERFORM 5205-WRITE-SEL-QUEUE                 42140000
421500                                                                  42150000
421600                     ADD +1      TO RC017-NUMBER-OF-TS-ITEMS      42160000
421700                     INITIALIZE RC013-SELECTED-ITEM-ARRAY         42170000
421800                 END-IF                                           42180000
421900         END-PERFORM                                              42190000
422000     END-IF.                                                      42200000
422100                                                                  42210000
422200 5205-WRITE-SEL-QUEUE.                                            42220000
422300                                                                  42230000
422400     MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            42240000
422500                                 TO RC013-SELECTED-ITEMS.         42250000
422600                                                                  42260000
422700     EXEC CICS WRITEQ TS                                          42270000
422800               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     42280000
422900               FROM  (RC013-DC-SELECT-RECORD)                     42290000
423000               ITEM  (PV-SEL-QUEUE-ITEM)                          42300000
423100               RESP  (PV-CICS-RESP)                               42310000
423200     END-EXEC.                                                    42320000
423300                                                                  42330000
423400     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       42340000
423500         SET DP013-CICS-ABEND                                     42350000
423600             DP013-NO-ROLLBACK   TO TRUE                          42360000
423700         MOVE '5205-WRITE-SEL-QUEUE'                              42370000
423800                                 TO DP013-PARAGRAPH               42380000
423900         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE WRITE'   42390000
424000                                 TO DP013-MESSAGE-TEXT (1)        42400000
424100         PERFORM DP013-0000-PROCESS-ABEND                         42410000
424200     END-IF.                                                      42420000
424300                                                                  42430000
424400 5300-SEARCH-FOR-SELECTION.                                       42440000
424500                                                                  42450000
424600     PERFORM 6112-READ-LIST-QUEUE.                                42460000
424700                                                                  42470000
424800     IF PV-CICS-RESP = DFHRESP (NORMAL)                           42480000
424900         PERFORM                                                  42490000
425000         VARYING LQW-IDX  FROM 1 BY 1                             42500000
425100         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  42510000
425200                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            42520000
425300                                                                  42530000
425400             IF LQW-SELECT (LQW-IDX)                              42540000
425500                 MOVE LQW-STR-NBR (LQW-IDX)                       42550000
425600                                 TO RECDIS-STR-NBR                42560000
425700                 PERFORM 5400-SELECT-RECDIS                       42570000
425800                 IF PS-DATA-OK                                    42580000
425900                     PERFORM 5505-ADD-TO-RECD-AUDIT-BEFORE        42590000
426000                 END-IF                                           42600000
426100                 SUBTRACT LQW-VERFD-QTY-N (LQW-IDX)               42610000
426200                        FROM   ASC-TOT-VERIFY-QTY                 42620000
426300                 MOVE LQW-VERFD-QTY-N (LQW-IDX)                   42630000
426400                                 TO PA-UPDATE-FROM-QTY            42640000
426500                 MOVE LQW-ADJ-QTY (LQW-IDX)                       42650000
426600                                 TO RECDIS-AP-VERIFY-ITM-QTY      42660000
426700                                  LQW-VERFD-QTY (LQW-IDX)         42670000
426800                                  PA-UPDATE-TO-QTY                42680000
426900                 SUBTRACT PA-UPDATE-FROM-QTY                      42690000
427000                     FROM PA-UPDATE-TO-QTY                        42700000
427100                   GIVING PA-UPDATE-DIFF-QTY                      42710000
427200                 ADD PA-UPDATE-DIFF-QTY TO                        42720000
427300                     PA-ACCUM-UPDATE-QTY                          42730000
427400                 SET PS-TRECDIS-UPDATE-DONE TO TRUE               42740000
427500                 ADD RECDIS-AP-VERIFY-ITM-QTY                     42750000
427600                          TO   ASC-TOT-VERIFY-QTY                 42760000
427700                 SUBTRACT LQW-ACTUAL-QTY-N (LQW-IDX)              42770000
427800                        FROM   ASC-TOT-ACTUAL-QTY                 42780000
427900                 ADD RECDIS-VERIFY-ITM-QTY                        42790000
428000                          TO   ASC-TOT-ACTUAL-QTY                 42800000
428100                 PERFORM 5500-UPDATE-RECDIS                       42810000
428200                 IF PS-DATA-OK                                    42820000
428300                     PERFORM 5515-ADD-TO-RECD-AUDIT-AFTER         42830000
428400                 END-IF                                           42840000
428500* DMH 4/18/04 - BEGIN                                             42850000
428600                 MOVE  ASC-KEY-PO-NBR-N                           42860000
428700                                       TO PC241-PO-NBR            42870000
428800                 MOVE  ASC-KEY-PKSL-LNE-NBR                       42880000
428900                                       TO PC241-PO-LNE-NBR        42890000
429000                 MOVE  ASC-KEY-REC-SEQ-NBR-N                      42900000
429100                                       TO PC241-REC-SEQ-NBR       42910000
429200                 MOVE  ASC-KEY-OPER-UNT-ID                        42920000
429300                                       TO PC241-OPER-UNT-ID       42930000
429400                 MOVE  ASC-KEY-FCLTY-ID                           42940000
429500                                       TO PC241-FCLTY-ID          42950000
429600                 MOVE  LQW-STR-NBR (LQW-IDX)                      42960000
429700                                       TO PC241-STR-NBR           42970000
429800                 MOVE  PA-UPDATE-DIFF-QTY                         42980000
429900                                       TO PC241-STR-ADJ-QTY       42990000
430000                 ADD   1               TO PV-VRFY-ITEM            43000000
430100                 PERFORM 6150-WRITE-VRFY-ADJ-QUEUE                43010000
430200* DMH 4/18/04 - END                                               43020000
430300                 ADD +1          TO RC017-NUMBER-OF-TS-ITEMS      43030000
430400                 SET LQW-DESELECT (LQW-IDX)                       43040000
430500                                 TO TRUE                          43050000
430600                 SET LQW-UPDATE (LQW-IDX)  TO TRUE                43060000
430700                 MOVE LQW-SELECTED-SW (LQW-IDX)                   43070000
430800                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)43080000
430900                 SUBTRACT 1    FROM ASC-NUMBER-OF-SELECTED-ITEMS  43090000
431000             END-IF                                               43100000
431100         END-PERFORM                                              43110000
431200     END-IF.                                                      43120000
431300                                                                  43130000
431400     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 43140000
431500     PERFORM 6111-WRITE-LIST-QUEUE.                               43150000
431600     PERFORM 9600-WRITE-TRB-QUEUE.                                43160000
431700 5305-SEARCH-FOR-SELECTION.                                       43170000
431800                                                                  43180000
431900     PERFORM 6112-READ-LIST-QUEUE.                                43190000
432000                                                                  43200000
432100     IF PV-CICS-RESP = DFHRESP (NORMAL)                           43210000
432200         PERFORM                                                  43220000
432300         VARYING LQW-IDX  FROM 1 BY 1                             43230000
432400         UNTIL   LQW-IDX > PC-ITEMS-PER-PANEL OR                  43240000
432500                 LQW-LIST-ITEM-NUMBER (LQW-IDX) = ZERO            43250000
432600                                                                  43260000
432700             IF LQW-SELECT (LQW-IDX)                              43270000
432800                 MOVE LQW-STR-NBR (LQW-IDX)                       43280000
432900                                 TO RECDIS-STR-NBR                43290000
433000                 PERFORM 5400-SELECT-RECDIS                       43300000
433100                 MOVE LQW-ADJ-QTY (LQW-IDX) TO                    43310000
433200                    PV-EXPECTED-QTY                               43320000
433300                 IF PV-EXPECTED-QTY                               43330000
433400                                > RECDIS-EXPTED-ITM-QTY           43340000
433500                       SET  LQW-PACK-BY-ST-OVERAGE (LQW-IDX)      43350000
433600                                  TO TRUE                         43360000
433700                       SET ASC-OVERAGE  TO TRUE                   43370000
433800                 END-IF                                           43380000
433900                 ADD +1          TO RC017-NUMBER-OF-TS-ITEMS      43390000
434000                 MOVE LQW-SELECTED-SW (LQW-IDX)                   43400000
434100                                 TO LQW-TEMP-SELECTED-SW (LQW-IDX)43410000
434200             END-IF                                               43420000
434300         END-PERFORM                                              43430000
434400     END-IF.                                                      43440000
434500                                                                  43450000
434600     MOVE PV-ITEM                TO PV-SAVE-ITEM.                 43460000
434700     PERFORM 6111-WRITE-LIST-QUEUE.                               43470000
434800     PERFORM 9600-WRITE-TRB-QUEUE.                                43480000
434900                                                                  43490000
435000/                                                                 43500000
435100                                                                  43510000
435200 5400-SELECT-RECDIS.                                              43520000
435300                                                                  43530000
435400     EXEC SQL                                                     43540000
435500         SELECT ORD_NBR,                                          43550000
435600                ORD_LNE_NBR,                                      43560000
435700                REC_SEQ_NBR,                                      43570000
435800                OPER_UNT_ID,                                      43580000
435900                FCLTY_ID,                                         43590000
436000                CRE_TMST,                                         43600000
436100                CRE_UID,                                          43610000
436200                VER_STATUS_CDE,                                   43620000
436300                EXPTED_ITM_QTY,                                   43630000
436400                VERIFY_ITM_QTY,                                   43640000
436500                AP_VERIFY_ITM_QTY,                                43650000
436600                STR_NBR,                                          43660000
436700                STR_FCLTY_ID,                                     43670000
436800                PLAN_ITM_QTY,                                     43680000
436900                AP_PRC_CDE,                                       43690000
437000                AP_PRC_DTE,                                       43700000
437100                CURRENT TIMESTAMP                                 43710000
437200          INTO      :RECDIS-ORD-NBR,                              43720000
437300                :RECDIS-ORD-LNE-NBR,                              43730000
437400                :RECDIS-REC-SEQ-NBR,                              43740000
437500                :RECDIS-OPER-UNT-ID,                              43750000
437600                :RECDIS-FCLTY-ID,                                 43760000
437700                :RECDIS-CRE-TMST,                                 43770000
437800                :RECDIS-CRE-UID,                                  43780000
437900                :RECDIS-VER-STATUS-CDE,                           43790000
438000                :RECDIS-EXPTED-ITM-QTY,                           43800000
438100                :RECDIS-VERIFY-ITM-QTY,                           43810000
438200                :RECDIS-AP-VERIFY-ITM-QTY,                        43820000
438300                :RECDIS-STR-NBR,                                  43830000
438400                :RECDIS-STR-FCLTY-ID,                             43840000
438500                :RECDIS-PLAN-ITM-QTY,                             43850000
438600                :RECDIS-AP-PRC-CDE,                               43860000
438700                :RECDIS-AP-PRC-DTE,                               43870000
438800                :PV-CURRENT-TIMESTAMP                             43880000
438900           FROM TRECDIS                                           43890000
439000          WHERE ORD_NBR            = :DK-PO-NBR                   43900000
439100            AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR             43910000
439200            AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR              43920000
439300            AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID         43930000
439400            AND FCLTY_ID           = :ASC-KEY-FCLTY-ID            43940000
439500            AND STR_NBR            = :RECDIS-STR-NBR              43950000
439600            AND STR_FCLTY_ID       = 1                            43960000
439800     END-EXEC                                                     43980000
439900                                                                  43990000
440000     EVALUATE TRUE                                                44000000
440100         WHEN SQLCODE = ZERO                                      44010000
440200             SET PS-DATA-OK TO TRUE                               44020000
440300         WHEN SQLCODE = +100                                      44030000
440400              CONTINUE                                            44040000
440500         WHEN SQLCODE = -904                                      44050000
440600         WHEN SQLCODE = -911                                      44060000
440700         WHEN SQLCODE = -913                                      44070000
440800             PERFORM 9900-SOFT-ABORT                              44080000
440900         WHEN SQLWARN0 NOT = SPACES                               44090000
441000         WHEN SQLCODE      NOT = ZERO                             44100000
441100              MOVE '5400-SELECT-RECDIS'                           44110000
441200                             TO DP013-PARAGRAPH                   44120000
441300              MOVE 'UNSUCCESSFUL SELECT OF TRECDIS'               44130000
441400                             TO DP013-MESSAGE-TEXT (1)            44140000
441500              MOVE SQLCA         TO DP013-SQLCA                   44150000
441600              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          44160000
441700              SET DP013-DB2-ABEND                                 44170000
441800                  DP013-XCTL-DISPLAY-RESTART                      44180000
441900                             TO TRUE                              44190000
442000              PERFORM DP013-0000-PROCESS-ABEND                    44200000
442100     END-EVALUATE.                                                44210000
442200/                                                                 44220000
442300 5505-ADD-TO-RECD-AUDIT-BEFORE.                                   44230000
442400                                                                  44240000
442500     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       44250000
442600     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          44260000
442700     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         44270000
442800     MOVE RECDIS-ORD-NBR           TO RC031-PO-NBR.               44280000
442900     MOVE RECDIS-ORD-LNE-NBR                                      44290000
443000                                   TO RC031-PO-LNE-NBR.           44300000
443100     MOVE RECDIS-REC-SEQ-NBR                                      44310000
443200                                   TO RC031-REC-SEQ-NBR.          44320000
443300     MOVE RECDIS-OPER-UNT-ID                                      44330000
443400                                   TO RC031-OPER-UNT-ID.          44340000
443500     MOVE RECDIS-FCLTY-ID          TO RC031-FCLTY-ID.             44350000
443600     MOVE RECDIS-STR-NBR           TO RC031-STR-NBR.              44360000
443700     MOVE DP020-USERID             TO RC031-UPD-UID.              44370000
443800     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           44380000
443900     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             44390000
444000     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            44400000
444100     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          44410000
444200     EXEC CICS                                                    44420000
444300         LINK PROGRAM  (PC-AUDIT-RTN)                             44430000
444400              COMMAREA (RC031-FIELDS)                             44440000
444500              LENGTH   (PC-AUDIT-RTN-LENGTH)                      44450000
444600     END-EXEC.                                                    44460000
444700     EVALUATE TRUE                                                44470000
444800         WHEN RC031-CALL-SUCCESSFUL                               44480000
444900             CONTINUE                                             44490000
445000                                                                  44500000
445100         WHEN OTHER                                               44510000
445200              MOVE '5505-ADD-TO-RECD-AUDIT-BEFORE'                44520000
445300                                    TO DP013-PARAGRAPH            44530000
445400              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               44540000
445500                                TO DP013-MESSAGE-TEXT (1)         44550000
445600              MOVE RC031-RETURN-DESC                              44560000
445700                                TO DP013-MESSAGE-TEXT (2)         44570000
445800              MOVE RC031-SQLCA      TO DP013-SQLCA                44580000
445900              SET DP013-DB2-ABEND                                 44590000
446000                  DP013-XCTL-DISPLAY-RESTART                      44600000
446100                                    TO TRUE                       44610000
446200              PERFORM DP013-0000-PROCESS-ABEND                    44620000
446300     END-EVALUATE.                                                44630000
446400                                                                  44640000
446500 5510-ADD-TRIGGER-AUDIT-BEFORE.                                   44650000
446600                                                                  44660000
446700     EXEC SQL                                                     44670000
446800          SET :PV-CURRENT-TIMESTAMP = CURRENT TIMESTAMP           44680000
446900     END-EXEC.                                                    44690000
447000     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       44700000
447100     MOVE 'B'                      TO RC031-AUD-TYP-CDE.          44710000
447200     MOVE 'T'                      TO RC031-AUD-FUNC-CDE.         44720000
447300     MOVE DK-PO-NBR                TO RC031-PO-NBR.               44730000
447400     MOVE DK-PKSL-LNE-NBR                                         44740000
447500                                   TO RC031-PO-LNE-NBR.           44750000
447600     MOVE DK-REC-SEQ-NBR                                          44760000
447700                                   TO RC031-REC-SEQ-NBR.          44770000
447800     MOVE ASC-KEY-OPER-UNT-ID                                     44780000
447900                                   TO RC031-OPER-UNT-ID.          44790000
448000     MOVE ASC-KEY-FCLTY-ID          TO RC031-FCLTY-ID.            44800000
448100     MOVE RECDIS-STR-NBR           TO RC031-STR-NBR.              44810000
448200     MOVE DP020-USERID             TO RC031-UPD-UID.              44820000
448300     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           44830000
448400     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             44840000
448500     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            44850000
448600     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          44860000
448700     EXEC CICS                                                    44870000
448800         LINK PROGRAM  (PC-AUDIT-RTN)                             44880000
448900              COMMAREA (RC031-FIELDS)                             44890000
449000              LENGTH   (PC-AUDIT-RTN-LENGTH)                      44900000
449100     END-EXEC.                                                    44910000
449200     EVALUATE TRUE                                                44920000
449300         WHEN RC031-CALL-SUCCESSFUL                               44930000
449400             CONTINUE                                             44940000
449500                                                                  44950000
449600         WHEN OTHER                                               44960000
449700              MOVE '5510-ADD-TRIGGER-AUDIT-BEFORE'                44970000
449800                                    TO DP013-PARAGRAPH            44980000
449900              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               44990000
450000                                TO DP013-MESSAGE-TEXT (1)         45000000
450100              MOVE RC031-RETURN-DESC                              45010000
450200                                TO DP013-MESSAGE-TEXT (2)         45020000
450300              MOVE RC031-SQLCA      TO DP013-SQLCA                45030000
450400              SET DP013-DB2-ABEND                                 45040000
450500                  DP013-XCTL-DISPLAY-RESTART                      45050000
450600                                    TO TRUE                       45060000
450700              PERFORM DP013-0000-PROCESS-ABEND                    45070000
450800     END-EVALUATE.                                                45080000
450900                                                                  45090000
451000 5515-ADD-TO-RECD-AUDIT-AFTER.                                    45100000
451100                                                                  45110000
451200     MOVE 'D'                      TO RC031-TABLE-TO-AUDIT.       45120000
451300     MOVE 'A'                      TO RC031-AUD-TYP-CDE.          45130000
451400     MOVE 'U'                      TO RC031-AUD-FUNC-CDE.         45140000
451500     MOVE RECDIS-ORD-NBR           TO RC031-PO-NBR.               45150000
451600     MOVE RECDIS-ORD-LNE-NBR       TO RC031-PO-LNE-NBR.           45160000
451700     MOVE RECDIS-REC-SEQ-NBR       TO RC031-REC-SEQ-NBR.          45170000
451800     MOVE RECDIS-OPER-UNT-ID       TO RC031-OPER-UNT-ID.          45180000
451900     MOVE RECDIS-FCLTY-ID          TO RC031-FCLTY-ID.             45190000
452000     MOVE RECDIS-STR-NBR           TO RC031-STR-NBR.              45200000
452100     MOVE DP020-USERID             TO RC031-UPD-UID.              45210000
452200     MOVE PC-CURRENT-PROGRAM-NAME  TO RC031-UPD-PGM-ID.           45220000
452300     MOVE PV-CURRENT-TIMESTAMP     TO RC031-UPD-TMST.             45230000
452400     MOVE PV-NOTIF-NBR             TO RC031-NOTIF-NBR.            45240000
452500     MOVE PV-CYC-ADJ-NBR           TO RC031-ADJ-CYC-NBR.          45250000
452600     EXEC CICS                                                    45260000
452700         LINK PROGRAM  (PC-AUDIT-RTN)                             45270000
452800              COMMAREA (RC031-FIELDS)                             45280000
452900              LENGTH   (PC-AUDIT-RTN-LENGTH)                      45290000
453000     END-EXEC.                                                    45300000
453100     EVALUATE TRUE                                                45310000
453200         WHEN RC031-CALL-SUCCESSFUL                               45320000
453300             CONTINUE                                             45330000
453400                                                                  45340000
453500         WHEN OTHER                                               45350000
453600              MOVE '5515-ADD-TO-RECD-AUDIT-AFTER'                 45360000
453700                                    TO DP013-PARAGRAPH            45370000
453800              MOVE 'UNSUCCESSFUL CALL TO AUDIT RTN'               45380000
453900                                TO DP013-MESSAGE-TEXT (1)         45390000
454000              MOVE RC031-RETURN-DESC                              45400000
454100                                TO DP013-MESSAGE-TEXT (2)         45410000
454200              MOVE RC031-SQLCA      TO DP013-SQLCA                45420000
454300              SET DP013-DB2-ABEND                                 45430000
454400                  DP013-XCTL-DISPLAY-RESTART                      45440000
454500                                    TO TRUE                       45450000
454600              PERFORM DP013-0000-PROCESS-ABEND                    45460000
454700     END-EVALUATE.                                                45470000
454800                                                                  45480000
454900/                                                                 45490000
455000 5500-UPDATE-RECDIS.                                              45500000
455100                                                                  45510000
455200     EXEC SQL                                                     45520000
455300       UPDATE TRECDIS                                             45530000
455400          SET AP_VERIFY_ITM_QTY  = :RECDIS-AP-VERIFY-ITM-QTY      45540000
455500             ,VERIFY_ITM_QTY     = :RECDIS-VERIFY-ITM-QTY         45550000
455600        WHERE ORD_NBR            = :DK-PO-NBR                     45560000
455700          AND ORD_LNE_NBR        = :DK-PKSL-LNE-NBR               45570000
455800          AND REC_SEQ_NBR        = :DK-REC-SEQ-NBR                45580000
455900          AND OPER_UNT_ID        = :ASC-KEY-OPER-UNT-ID           45590000
456000          AND FCLTY_ID           = :ASC-KEY-FCLTY-ID              45600000
456100          AND STR_NBR            = :RECDIS-STR-NBR                45610000
456200          AND STR_FCLTY_ID       = 1                              45620000
456400     END-EXEC                                                     45640000
456500                                                                  45650000
456600     EVALUATE TRUE                                                45660000
456700         WHEN SQLCODE = ZERO                                      45670000
456800         WHEN SQLCODE = +100                                      45680000
456900              CONTINUE                                            45690000
457000         WHEN SQLCODE = -904                                      45700000
457100         WHEN SQLCODE = -911                                      45710000
457200         WHEN SQLCODE = -913                                      45720000
457300             SET PS-UPDATES-DONE TO TRUE                          45730000
457400             PERFORM 9900-SOFT-ABORT                              45740000
457500         WHEN SQLWARN0 NOT = SPACES                               45750000
457600         WHEN SQLCODE      NOT = ZERO                             45760000
457700              MOVE '5500-UPDATE-RECDIS'                           45770000
457800                             TO DP013-PARAGRAPH                   45780000
457900              MOVE 'UNSUCCESSFUL UPDATE OF TRECDIS'               45790000
458000                             TO DP013-MESSAGE-TEXT (1)            45800000
458100              MOVE SQLCA         TO DP013-SQLCA                   45810000
458200              MOVE 'TRECDIS' TO DP013-DB2-TABLE-NAME (1)          45820000
458300              SET DP013-DB2-ABEND                                 45830000
458400                  DP013-XCTL-DISPLAY-RESTART                      45840000
458500                             TO TRUE                              45850000
458600              PERFORM DP013-0000-PROCESS-ABEND                    45860000
458700     END-EVALUATE.                                                45870000
458800/                                                                 45880000
458900/                                                                 45890000
459000*----------------------------------------------------------------*45900000
459100*    SINCE THE RECEDIS VERIFY QUANTITY HAS CHANGED, WE MUST      *45910000
459200*    CHECK IF IT IS NOW LESS THAN PURITM.  IF SO, RESET THE      *45920000
459300*    STATUS CODE TO IP AND CHECK THE PURCHS ROW.                 *45930000
459400*----------------------------------------------------------------*45940000
459500                                                                  45950000
459600 5800-CHECK-PO-STATUS.                                            45960000
459700                                                                  45970000
459800     MOVE ZERO              TO  PV-AP-VERIFY-ITM-QTY.             45980000
459900                                                                  45990000
460000     PERFORM 5825-GET-RECDIS-FOR-PO-CHECK.                        46000000
460100                                                                  46010000
460200     IF (ASC-PURITM-UNT-QTY GREATER PV-AP-VERIFY-ITM-QTY          46020000
460300     AND ASC-PURITM-STATUS-CDE EQUAL PC-CM)                       46030000
460400         MOVE PC-AC               TO  ASC-PURITM-STATUS-CDE       46040000
460500         PERFORM 5830-UPDATE-PURITM-STATUS                        46050000
460600         IF  ASC-PURCHS-STATUS-CDE EQUAL PC-CM                    46060000
460700             MOVE PC-AC           TO  ASC-PURCHS-STATUS-CDE       46070000
460800***          PERFORM 5850-UPDATE-PURCHS-STATUS                    46080005
460900         END-IF                                                   46090000
461000     ELSE                                                         46100000
461100         IF (ASC-PURITM-UNT-QTY NOT > PV-AP-VERIFY-ITM-QTY        46110000
461200         AND ASC-PURITM-STATUS-CDE NOT EQUAL PC-CM)               46120000
461300             MOVE PC-CM           TO  ASC-PURITM-STATUS-CDE       46130000
461400             PERFORM 5830-UPDATE-PURITM-STATUS                    46140000
461500             IF  ASC-PURCHS-STATUS-CDE NOT EQUAL PC-CM            46150000
461600                 MOVE PC-CM       TO  ASC-PURCHS-STATUS-CDE       46160000
461700***              PERFORM 5850-UPDATE-PURCHS-STATUS                46170005
461800             END-IF                                               46180000
461900         END-IF                                                   46190000
462000     END-IF.                                                      46200000
462100/                                                                 46210000
462200 5820-GET-RECDIS-QTY.                                             46220000
462300                                                                  46230000
462400     EXEC SQL                                                     46240000
462500          SELECT                                                  46250000
462600                 SUM(C.AP_VERIFY_ITM_QTY)                         46260000
462700                ,SUM(C.VERIFY_ITM_QTY)                            46270000
462800                ,SUM(C.EXPTED_ITM_QTY)                            46280000
462900           INTO                                                   46290000
463000                 :RECDIS-AP-VERIFY-ITM-QTY :PV-NULL-IND           46300000
463100                ,:RECDIS-VERIFY-ITM-QTY :PV-NULL-IND              46310000
463200                ,:RECDIS-EXPTED-ITM-QTY :PV-NULL-IND              46320000
463300           FROM                                                   46330000
463400                 TRECEIV A                                        46340000
463500               , TRECITM B                                        46350000
463600               , TRECDIS C                                        46360000
463700           WHERE                                                  46370000
463800                 A.ORD_NBR         =  :DK-PO-NBR                  46380000
463900            AND  A.ORD_NBR         =  B.ORD_NBR                   46390000
464000            AND  A.ORD_NBR         =  C.ORD_NBR                   46400000
464100            AND  B.ORD_LNE_NBR     =  :DK-PKSL-LNE-NBR            46410000
464200            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               46420000
464300            AND  A.VER_STATUS_CDE  =  :PC-A                       46430000
464400            AND  B.VER_STATUS_CDE  =  :PC-A                       46440000
464600            AND  B.STATUS_CDE      =  :PC-VE                      46460000
464700            AND  A.REC_SEQ_NBR     =  :DK-REC-SEQ-NBR             46470000
464800            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               46480000
464900            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               46490000
465000     END-EXEC.                                                    46500000
465100                                                                  46510000
465200     EVALUATE TRUE                                                46520000
465300         WHEN SQLCODE = ZERO                                      46530000
465400         WHEN SQLCODE = +100                                      46540000
465500              CONTINUE                                            46550000
465600         WHEN SQLCODE = -904                                      46560000
465700         WHEN SQLCODE = -911                                      46570000
465800         WHEN SQLCODE = -913                                      46580000
465900             PERFORM 9900-SOFT-ABORT                              46590000
466000         WHEN SQLWARN0 NOT = SPACE                                46600000
466100         WHEN SQLCODE NOT = ZERO                                  46610000
466200              MOVE '5820-GET-RECDIS-QTY'                          46620000
466300                               TO DP013-PARAGRAPH                 46630000
466400              MOVE 'SUM RECDIS VERIFY QUANTITY'                   46640000
466500                               TO DP013-MESSAGE-TEXT (1)          46650000
466600              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        46660000
466700              MOVE SQLCA       TO DP013-SQLCA                     46670000
466800              SET DP013-DB2-ABEND                                 46680000
466900                               TO TRUE                            46690000
467000              PERFORM DP013-0000-PROCESS-ABEND                    46700000
467100     END-EVALUATE.                                                46710000
467200/                                                                 46720000
467300*----------------------------------------------------------------*46730000
467400*    THE FOLLOWING SELECT OF TRECDIS WILL SUMMARIZE THE          *46740000
467500*    QUANTITIES FOR ALL OF THE VERIFIED RECEIVERS FOR THE LINE   *46750000
467600*    BEING PROCESSED.  IT IS THE SUMMARIZED QUANTITY FOR ALL     *46760000
467700*    RECEIVERS WHICH MUST BE COMPARED TO THE PURCHASE ORDER ITEM *46770000
467800*    QUANTITY TO DETERMINE THE PROPER STATUS FOR THE PURCHASE    *46780000
467900*    ORDER.                                                      *46790000
468000*----------------------------------------------------------------*46800000
468100                                                                  46810000
468200 5825-GET-RECDIS-FOR-PO-CHECK.                                    46820000
468300                                                                  46830000
468400     EXEC SQL                                                     46840000
468500          SELECT                                                  46850000
468600                 SUM(C.AP_VERIFY_ITM_QTY)                         46860000
468700           INTO                                                   46870000
468800                 :PV-AP-VERIFY-ITM-QTY :PV-NULL-IND               46880000
468900           FROM                                                   46890000
469000                 TRECEIV A                                        46900000
469100               , TRECITM B                                        46910000
469200               , TRECDIS C                                        46920000
469300           WHERE                                                  46930000
469400                 A.ORD_NBR         =  :DK-PO-NBR                  46940000
469500            AND  A.ORD_NBR         =  B.ORD_NBR                   46950000
469600            AND  A.ORD_NBR         =  C.ORD_NBR                   46960000
469700            AND  B.ORD_LNE_NBR     =  :DK-PKSL-LNE-NBR            46970000
469800            AND  B.ORD_LNE_NBR     =  C.ORD_LNE_NBR               46980000
469900            AND  A.VER_STATUS_CDE  =  :PC-A                       46990000
470000            AND  B.VER_STATUS_CDE  =  :PC-A                       47000000
470200            AND  B.STATUS_CDE      =  :PC-VE                      47020000
470300            AND  A.REC_SEQ_NBR     =  B.REC_SEQ_NBR               47030000
470400            AND  A.REC_SEQ_NBR     =  C.REC_SEQ_NBR               47040000
470500     END-EXEC.                                                    47050000
470600                                                                  47060000
470700     EVALUATE TRUE                                                47070000
470800         WHEN SQLCODE = ZERO                                      47080000
470900         WHEN SQLCODE = +100                                      47090000
471000              CONTINUE                                            47100000
471100         WHEN SQLCODE = -904                                      47110000
471200         WHEN SQLCODE = -911                                      47120000
471300         WHEN SQLCODE = -913                                      47130000
471400             PERFORM 9900-SOFT-ABORT                              47140000
471500         WHEN SQLWARN0 NOT = SPACE                                47150000
471600         WHEN SQLCODE NOT = ZERO                                  47160000
471700              MOVE '5820-GET-RECDIS-QTY'                          47170000
471800                               TO DP013-PARAGRAPH                 47180000
471900              MOVE 'SUM RECDIS VERIFY QUANTITY'                   47190000
472000                               TO DP013-MESSAGE-TEXT (1)          47200000
472100              MOVE 'TRECDIS '  TO DP013-DB2-TABLE-NAME (1)        47210000
472200              MOVE SQLCA       TO DP013-SQLCA                     47220000
472300              SET DP013-DB2-ABEND                                 47230000
472400                               TO TRUE                            47240000
472500              PERFORM DP013-0000-PROCESS-ABEND                    47250000
472600     END-EVALUATE.                                                47260000
472700/                                                                 47270000
472800*----------------------------------------------------------------*47280000
472900*    TO UPDATE THE PURCHASE ITEM ROW, WE REALLY MAKE THE CURRENT *47290000
473000*    ROW INACTIVE AND INSERT A NEW ROW WITH AN ACTIVE STATUS.    *47300000
473100*                                                                *47310001
473200*    ** NOTE **                                                  *47320001
473300*    WE WILL NOT BE MAKING THE CURRENT ROW ACTIVE AND INSERTING  *47330001
473400*    A NEW ROW WITH AN ACTIVE STATUS FOR PUCHASE ITEM ROWS ON    *47340001
473500*    PURCHASE ORDERS THAT ARE IN RMS.                            *47350001
473600*----------------------------------------------------------------*47360000
473700                                                                  47370000
473800 5830-UPDATE-PURITM-STATUS.                                       47380000
473900                                                                  47390000
474000     PERFORM 5831-GET-PURITM.                                     47400000
474100     IF  SQLCODE EQUAL ZERO                                       47410000
474200     AND PURITM-STATUS-CDE NOT = PC-RV                            47420000
474300         IF ASC-PURITM-STATUS-CDE = PC-AC                         47430000
474400             MOVE ASC-DEPT          TO PV-DEPT-NBR-X              47440001
474500             MOVE PV-DEPT-NBR       TO PV-DEPT-NBR-KEY            47450001
474600             SET PS-NO-RMS-PO       TO TRUE                       47460001
474700*** CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO      47470001
474800*** VERSION THE TPURITM ROWS; WE JUST WANT TO UPDATE THE ROW.     47480001
474900             PERFORM 5856-CHECK-FOR-RMS-PO                        47490001
475000             IF PV-DB2-COUNT > ZERO                               47500001
475100                 SET PS-RMS-PO      TO TRUE                       47510001
475200                 PERFORM 5834-ONLY-UPDATE-PURITM                  47520001
475300             ELSE                                                 47530001
475400                 PERFORM 5832-UPDATE-PURITM                       47540001
475500                 ADD 1              TO  PURITM-VER-NBR            47550001
475600                 PERFORM 5833-INSERT-PURITM                       47560001
475700             END-IF                                               47570001
475800          ELSE                                                    47580000
475900             PERFORM 5834-ONLY-UPDATE-PURITM                      47590000
476000          END-IF                                                  47600000
476100     END-IF.                                                      47610000
476200                                                                  47620000
476300 5831-GET-PURITM.                                                 47630000
476400                                                                  47640000
476500     EXEC SQL                                                     47650000
476600          SELECT                                                  47660000
476700                  PO_NBR                                          47670000
476800                , VER_NBR                                         47680000
476900                , PO_LNE_NBR                                      47690000
477000                , VER_STATUS_CDE                                  47700000
477100                , SKU_SEQ_NBR                                     47710000
477200                , CL_NBR                                          47720000
477300                , VEND_STYL_NAME                                  47730000
477400                , COLOR_DESC                                      47740000
477500                , SIZE_DESC                                       47750000
477600                , UM_IND                                          47760000
477700                , UNT_QTY                                         47770000
477800                , UNT_RTL_PR_AMT                                  47780000
477900                , UNT_COST_AMT                                    47790000
478000                , TOT_VAL_COST_AMT                                47800000
478100                , TOT_VAL_RTL_AMT                                 47810000
478200                , MU_PCT                                          47820000
478300                , CRE_TMST                                        47830000
478400                , LAST_UPD_TMST                                   47840000
478500                , ITM_NBR                                         47850000
478600                , SKU_DESC                                        47860000
478700                , COLOR_CDE                                       47870000
478800                , SIZE_CDE                                        47880000
478900                , AD_EVNT_DTE                                     47890000
479000                , STATUS_CDE                                      47900000
479100                , CRE_BY_UID                                      47910000
479200                , LAST_UPD_BY_UID                                 47920000
479300                , GP_RTL_AMT                                      47930000
479400                , GP_QTY                                          47940000
479500                , APP_PO_LNE_NBR                                  47950000
479600                , PIC_ITM_IND                                     47960000
479700                , PIC_PG_NBR                                      47970000
479800                , PRD_1ST_COST_AMT                                47980000
479900                , PO_PREPK_ID                                     47990000
480000                , PREPK_RATO_QTY                                  48000000
480100                , SHIP_TO_TMP_DC_IND                              48010000
480200                , RMS_PO_SKU_NBR                                  48020000
480300                , CNCLD_UNT_QTY                                   48030004
480400           INTO                                                   48040000
480500                  :PURITM-PO-NBR                                  48050000
480600                , :PURITM-VER-NBR                                 48060000
480700                , :PURITM-PO-LNE-NBR                              48070000
480800                , :PURITM-VER-STATUS-CDE                          48080000
480900                , :PURITM-SKU-SEQ-NBR                             48090000
481000                , :PURITM-CL-NBR                                  48100000
481100                , :PURITM-VEND-STYL-NAME                          48110000
481200                , :PURITM-COLOR-DESC                              48120000
481300                , :PURITM-SIZE-DESC                               48130000
481400                , :PURITM-UM-IND                                  48140000
481500                , :PURITM-UNT-QTY                                 48150000
481600                , :PURITM-UNT-RTL-PR-AMT                          48160000
481700                , :PURITM-UNT-COST-AMT                            48170000
481800                , :PURITM-TOT-VAL-COST-AMT                        48180000
481900                , :PURITM-TOT-VAL-RTL-AMT                         48190000
482000                , :PURITM-MU-PCT                                  48200000
482100                , :PURITM-CRE-TMST                                48210000
482200                , :PURITM-LAST-UPD-TMST                           48220000
482300                , :PURITM-ITM-NBR                                 48230000
482400                , :PURITM-SKU-DESC                                48240000
482500                , :PURITM-COLOR-CDE                               48250000
482600                , :PURITM-SIZE-CDE                                48260000
482700                , :PURITM-AD-EVNT-DTE                             48270000
482800                , :PURITM-STATUS-CDE                              48280000
482900                , :PURITM-CRE-BY-UID                              48290000
483000                , :PURITM-LAST-UPD-BY-UID                         48300000
483100                , :PURITM-GP-RTL-AMT                              48310000
483200                , :PURITM-GP-QTY                                  48320000
483300                , :PURITM-APP-PO-LNE-NBR                          48330000
483400                , :PURITM-PIC-ITM-IND                             48340000
483500                , :PURITM-PIC-PG-NBR                              48350000
483600                , :PURITM-PRD-1ST-COST-AMT                        48360000
483700                , :PURITM-PO-PREPK-ID                             48370000
483800                , :PURITM-PREPK-RATO-QTY                          48380000
483900                , :PURITM-SHIP-TO-TMP-DC-IND                      48390000
484000                , :PURITM-RMS-PO-SKU-NBR                          48400000
484100                , :PURITM-CNCLD-UNT-QTY                           48410004
484200           FROM                                                   48420000
484300                  TPURITM                                         48430000
484400          WHERE                                                   48440000
484500                  PO_NBR             =  :DK-PO-NBR                48450000
484600           AND    APP_PO_LNE_NBR     =  :DK-PKSL-LNE-NBR          48460000
484700           AND    VER_STATUS_CDE     =  :PC-A                     48470000
484800     END-EXEC.                                                    48480000
484900                                                                  48490000
485000     EVALUATE TRUE                                                48500000
485100         WHEN SQLCODE = ZERO                                      48510000
485200         WHEN SQLCODE = +100                                      48520000
485300              CONTINUE                                            48530000
485400         WHEN SQLCODE = -904                                      48540000
485500         WHEN SQLCODE = -911                                      48550000
485600         WHEN SQLCODE = -913                                      48560000
485700             PERFORM 9900-SOFT-ABORT                              48570000
485800         WHEN SQLWARN0 NOT = SPACE                                48580000
485900         WHEN SQLCODE NOT = ZERO                                  48590000
486000              MOVE '5831-GET-PURITM'                              48600000
486100                               TO DP013-PARAGRAPH                 48610000
486200              MOVE 'SUM RECDIS VERIFY QUANTITY'                   48620000
486300                               TO DP013-MESSAGE-TEXT (1)          48630000
486400              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        48640000
486500              MOVE SQLCA       TO DP013-SQLCA                     48650000
486600              SET DP013-DB2-ABEND                                 48660000
486700                               TO TRUE                            48670000
486800              PERFORM DP013-0000-PROCESS-ABEND                    48680000
486900     END-EVALUATE.                                                48690000
487000/                                                                 48700000
487100 5832-UPDATE-PURITM.                                              48710000
487200                                                                  48720000
487300     EXEC SQL                                                     48730000
487400          UPDATE                                                  48740000
487500                 TPURITM                                          48750000
487600          SET    VER_STATUS_CDE   =  :PC-I                        48760000
487700          WHERE                                                   48770000
487800                 PO_NBR           =  :DK-PO-NBR                   48780000
487900          AND    APP_PO_LNE_NBR   =  :DK-PKSL-LNE-NBR             48790000
488000          AND    VER_STATUS_CDE   =  :PC-A                        48800000
488100     END-EXEC.                                                    48810000
488200                                                                  48820000
488300     EVALUATE TRUE                                                48830000
488400         WHEN SQLCODE = ZERO                                      48840000
488500              CONTINUE                                            48850000
488600         WHEN SQLCODE = -904                                      48860000
488700         WHEN SQLCODE = -911                                      48870000
488800         WHEN SQLCODE = -913                                      48880000
488900             SET PS-UPDATES-DONE TO TRUE                          48890000
489000             PERFORM 9900-SOFT-ABORT                              48900000
489100         WHEN SQLWARN0 NOT = SPACE                                48910000
489200         WHEN SQLCODE NOT = ZERO                                  48920000
489300              MOVE '5832-UPDATE-PURITM'                           48930000
489400                               TO DP013-PARAGRAPH                 48940000
489500              MOVE 'SET CURRENT ROW TO INACTIVE'                  48950000
489600                               TO DP013-MESSAGE-TEXT (1)          48960000
489700              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        48970000
489800              MOVE SQLCA       TO DP013-SQLCA                     48980000
489900              SET DP013-DB2-ABEND                                 48990000
490000                               TO TRUE                            49000000
490100              PERFORM DP013-0000-PROCESS-ABEND                    49010000
490200     END-EVALUATE.                                                49020000
490300/                                                                 49030000
490400 5833-INSERT-PURITM.                                              49040000
490500                                                                  49050000
490600     EXEC SQL                                                     49060000
490700          INSERT                                                  49070000
490800           INTO   TPURITM                                         49080000
490900                 (PO_NBR                                          49090000
491000                , VER_NBR                                         49100000
491100                , PO_LNE_NBR                                      49110000
491200                , VER_STATUS_CDE                                  49120000
491300                , SKU_SEQ_NBR                                     49130000
491400                , CL_NBR                                          49140000
491500                , VEND_STYL_NAME                                  49150000
491600                , COLOR_DESC                                      49160000
491700                , SIZE_DESC                                       49170000
491800                , UM_IND                                          49180000
491900                , UNT_QTY                                         49190000
492000                , UNT_RTL_PR_AMT                                  49200000
492100                , UNT_COST_AMT                                    49210000
492200                , TOT_VAL_COST_AMT                                49220000
492300                , TOT_VAL_RTL_AMT                                 49230000
492400                , MU_PCT                                          49240000
492500                , CRE_TMST                                        49250000
492600                , LAST_UPD_TMST                                   49260000
492700                , ITM_NBR                                         49270000
492800                , SKU_DESC                                        49280000
492900                , COLOR_CDE                                       49290000
493000                , SIZE_CDE                                        49300000
493100                , AD_EVNT_DTE                                     49310000
493200                , STATUS_CDE                                      49320000
493300                , CRE_BY_UID                                      49330000
493400                , LAST_UPD_BY_UID                                 49340000
493500                , GP_RTL_AMT                                      49350000
493600                , GP_QTY                                          49360000
493700                , APP_PO_LNE_NBR                                  49370000
493800                , PIC_ITM_IND                                     49380000
493900                , PIC_PG_NBR                                      49390000
494000                , PRD_1ST_COST_AMT                                49400000
494100                , STAT_TMST                                       49410000
494200                , PO_PREPK_ID                                     49420000
494300                , PREPK_RATO_QTY                                  49430000
494400                , SHIP_TO_TMP_DC_IND                              49440000
494500                , RMS_PO_SKU_NBR                                  49450000
494600                , CNCLD_UNT_QTY                                   49460004
494700                  )                                               49470000
494800          VALUES                                                  49480000
494900                 (:PURITM-PO-NBR                                  49490000
495000                , :PURITM-VER-NBR                                 49500000
495100                , :PURITM-PO-LNE-NBR                              49510000
495200                , :PC-A                                           49520000
495300                , :PURITM-SKU-SEQ-NBR                             49530000
495400                , :PURITM-CL-NBR                                  49540000
495500                , :PURITM-VEND-STYL-NAME                          49550000
495600                , :PURITM-COLOR-DESC                              49560000
495700                , :PURITM-SIZE-DESC                               49570000
495800                , :PURITM-UM-IND                                  49580000
495900                , :PURITM-UNT-QTY                                 49590000
496000                , :PURITM-UNT-RTL-PR-AMT                          49600000
496100                , :PURITM-UNT-COST-AMT                            49610000
496200                , :PURITM-TOT-VAL-COST-AMT                        49620000
496300                , :PURITM-TOT-VAL-RTL-AMT                         49630000
496400                , :PURITM-MU-PCT                                  49640000
496500                , :PURITM-CRE-TMST                                49650000
496600                ,  CURRENT TIMESTAMP                              49660000
496700                , :PURITM-ITM-NBR                                 49670000
496800                , :PURITM-SKU-DESC                                49680000
496900                , :PURITM-COLOR-CDE                               49690000
497000                , :PURITM-SIZE-CDE                                49700000
497100                , :PURITM-AD-EVNT-DTE                             49710000
497200                , :ASC-PURITM-STATUS-CDE                          49720000
497300                , :PURITM-CRE-BY-UID                              49730000
497400                , :DP020-USERID                                   49740000
497500                , :PURITM-GP-RTL-AMT                              49750000
497600                , :PURITM-GP-QTY                                  49760000
497700                , :PURITM-APP-PO-LNE-NBR                          49770000
497800                , :PURITM-PIC-ITM-IND                             49780000
497900                , :PURITM-PIC-PG-NBR                              49790000
498000                , :PURITM-PRD-1ST-COST-AMT                        49800000
498100                , CURRENT TIMESTAMP                               49810000
498200                , :PURITM-PO-PREPK-ID                             49820000
498300                , :PURITM-PREPK-RATO-QTY                          49830000
498400                , :PURITM-SHIP-TO-TMP-DC-IND                      49840000
498500                , :PURITM-RMS-PO-SKU-NBR                          49850000
498600                , :PURITM-CNCLD-UNT-QTY                           49860004
498700                  )                                               49870000
498800     END-EXEC.                                                    49880000
498900                                                                  49890000
499000     EVALUATE TRUE                                                49900000
499100         WHEN SQLCODE = ZERO                                      49910000
499200              CONTINUE                                            49920000
499300         WHEN SQLCODE = -904                                      49930000
499400         WHEN SQLCODE = -911                                      49940000
499500         WHEN SQLCODE = -913                                      49950000
499600             SET PS-UPDATES-DONE TO TRUE                          49960000
499700             PERFORM 9900-SOFT-ABORT                              49970000
499800         WHEN SQLWARN0 NOT = SPACE                                49980000
499900         WHEN SQLCODE NOT = ZERO                                  49990000
500000              MOVE '5833-INSERT-PURITM'                           50000000
500100                               TO DP013-PARAGRAPH                 50010000
500200              MOVE 'INSERT NEW ROW IN TPURITM TABLE'              50020000
500300                               TO DP013-MESSAGE-TEXT (1)          50030000
500400              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        50040000
500500              MOVE SQLCA       TO DP013-SQLCA                     50050000
500600              SET DP013-DB2-ABEND                                 50060000
500700                               TO TRUE                            50070000
500800              PERFORM DP013-0000-PROCESS-ABEND                    50080000
500900     END-EVALUATE.                                                50090000
501000/                                                                 50100000
501100 5834-ONLY-UPDATE-PURITM.                                         50110000
501200                                                                  50120000
501300     EXEC SQL                                                     50130000
501400          UPDATE                                                  50140000
501500                 TPURITM                                          50150000
501600          SET    STATUS_CDE       =  :ASC-PURITM-STATUS-CDE       50160000
501700               , STAT_TMST        =  CURRENT TIMESTAMP            50170000
501800          WHERE                                                   50180000
501900                 PO_NBR           =  :DK-PO-NBR                   50190000
502000          AND    APP_PO_LNE_NBR   =  :DK-PKSL-LNE-NBR             50200000
502100          AND    VER_STATUS_CDE   =  :PC-A                        50210000
502200     END-EXEC.                                                    50220000
502300                                                                  50230000
502400     EVALUATE TRUE                                                50240000
502500         WHEN SQLCODE = ZERO                                      50250000
502600              CONTINUE                                            50260000
502700         WHEN SQLCODE = -904                                      50270000
502800         WHEN SQLCODE = -911                                      50280000
502900         WHEN SQLCODE = -913                                      50290000
503000             SET PS-UPDATES-DONE TO TRUE                          50300000
503100             PERFORM 9900-SOFT-ABORT                              50310000
503200         WHEN SQLWARN0 NOT = SPACE                                50320000
503300         WHEN SQLCODE NOT = ZERO                                  50330000
503400              MOVE '5832-ONLY-UPDATE-PURITM'                      50340000
503500                               TO DP013-PARAGRAPH                 50350000
503600              MOVE 'SET CURRENT ROW TO INACTIVE'                  50360000
503700                               TO DP013-MESSAGE-TEXT (1)          50370000
503800              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        50380000
503900              MOVE SQLCA       TO DP013-SQLCA                     50390000
504000              SET DP013-DB2-ABEND                                 50400000
504100                               TO TRUE                            50410000
504200              PERFORM DP013-0000-PROCESS-ABEND                    50420000
504300     END-EVALUATE.                                                50430000
504400/                                                                 50440000
504500*----------------------------------------------------------------*50450000
504600*    HERE, WE CHECK IF ALL PURCHASE ITEM LINES ARE EQUAL TO      *50460000
504700*    'CM' 'CB' OR 'CA' IF WE ARE TRYING TO CHANGE THE PURCHASE   *50470000
504800*    HEADER TO 'CM'.  OTHERWISE, JUST UPDATE THE PO HEADER TO    *50480000
504900*    A STATUS OF 'AC' WITH NO CHECK ON PURITM.                   *50490000
505000*                                                                *50500001
505100* ** 06/02/2003 CHANGE **                                        *50510001
505200*    CHECK IF THIS IS AN RMS PO.  IF IT IS, WE DO NOT WANT TO    *50520001
505300*    UPDATE THE PURCHASE ORDER TABLE.  THIS TABLE WILL GET       *50530001
505400*    UPDATED THROUGH AN RMS PROCESS.                             *50540001
505500*----------------------------------------------------------------*50550000
505600                                                                  50560000
505700 5850-UPDATE-PURCHS-STATUS.                                       50570000
505800                                                                  50580000
505900     IF  ASC-PURCHS-STATUS-CDE EQUAL PC-CM                        50590000
506000         PERFORM 5851-COUNT-PO-LINE-ROWS                          50600000
506100         IF  PV-DB2-COUNT EQUAL ZERO                              50610000
506200             IF  PS-RMS-PO                                        50620001
506300                 CONTINUE                                         50630001
506400             ELSE                                                 50640001
506500                 IF  PS-CHECKED-FOR-RMS-PO                        50650001
506600                     PERFORM 5852-GET-TPURCHS-STATUS              50660001
506700                     PERFORM 5855-ONLY-UPDATE-PURCHS-STATUS       50670001
506800                 ELSE                                             50680001
506900                     MOVE ASC-DEPT     TO PV-DEPT-NBR-X           50690001
507000                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         50700001
507100                     SET PS-NO-RMS-PO  TO TRUE                    50710001
507200                     PERFORM 5856-CHECK-FOR-RMS-PO                50720001
507300                     IF  PV-DB2-COUNT = ZERO                      50730001
507400                         PERFORM 5852-GET-TPURCHS-STATUS          50740001
507500                         PERFORM 5855-ONLY-UPDATE-PURCHS-STATUS   50750001
507600                     END-IF                                       50760001
507700                 END-IF                                           50770001
507800             END-IF                                               50780001
507900         ELSE                                                     50790000
508000             IF  PS-RMS-PO                                        50800001
508100                 CONTINUE                                         50810001
508200             ELSE                                                 50820001
508300                 IF  PS-CHECKED-FOR-RMS-PO                        50830001
508400                     MOVE PC-AC        TO  ASC-PURCHS-STATUS-CDE  50840001
508500                 ELSE                                             50850001
508600                     MOVE ASC-DEPT     TO PV-DEPT-NBR-X           50860001
508700                     MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY         50870001
508800                     SET PS-NO-RMS-PO  TO TRUE                    50880001
508900                     PERFORM 5856-CHECK-FOR-RMS-PO                50890001
509000                     IF  PV-DB2-COUNT = ZERO                      50900001
509100                         MOVE PC-AC    TO  ASC-PURCHS-STATUS-CDE  50910001
509200                     END-IF                                       50920001
509300                 END-IF                                           50930001
509400             END-IF                                               50940001
509500         END-IF                                                   50950000
509600     ELSE                                                         50960000
509700         IF  PS-RMS-PO                                            50970001
509800             CONTINUE                                             50980001
509900         ELSE                                                     50990001
510000             IF  PS-CHECKED-FOR-RMS-PO                            51000001
510100                 PERFORM 5852-GET-TPURCHS-STATUS                  51010001
510200                 PERFORM 5853-UPDATE-PURCHS-STATUS                51020001
510300                 ADD 1             TO  PURCHS-VER-NBR             51030001
510400                 PERFORM 5854-INSERT-PURCHS                       51040001
510500             ELSE                                                 51050001
510600                 MOVE ASC-DEPT     TO PV-DEPT-NBR-X               51060002
510700                 MOVE PV-DEPT-NBR  TO PV-DEPT-NBR-KEY             51070001
510800                 SET PS-NO-RMS-PO  TO TRUE                        51080001
510900                 PERFORM 5856-CHECK-FOR-RMS-PO                    51090001
511000                 IF  PV-DB2-COUNT = ZERO                          51100001
511100                     PERFORM 5852-GET-TPURCHS-STATUS              51110001
511200                     PERFORM 5853-UPDATE-PURCHS-STATUS            51120001
511300                     ADD 1         TO  PURCHS-VER-NBR             51130001
511400                     PERFORM 5854-INSERT-PURCHS                   51140001
511500                 END-IF                                           51150001
511600             END-IF                                               51160001
511700         END-IF                                                   51170001
511800     END-IF.                                                      51180000
511900                                                                  51190000
512000 5851-COUNT-PO-LINE-ROWS.                                         51200000
512100                                                                  51210000
512200     MOVE ZERO            TO  PV-DB2-COUNT.                       51220000
512300     EXEC SQL                                                     51230000
512400          SELECT                                                  51240000
512500                COUNT(*)                                          51250000
512600          INTO                                                    51260000
512700                :PV-DB2-COUNT :PV-NULL-IND                        51270000
512800          FROM                                                    51280000
512900                TPURITM                                           51290000
513000          WHERE                                                   51300000
513100                PO_NBR             =  :DK-PO-NBR                  51310000
513200          AND   VER_STATUS_CDE     =  :PC-A                       51320000
513300          AND  (STATUS_CDE        ^=  :PC-CM                      51330000
513400           AND  STATUS_CDE        ^=  :PC-CB                      51340000
513500           AND  STATUS_CDE        ^=  :PC-CA)                     51350000
513600     END-EXEC.                                                    51360000
513700                                                                  51370000
513800     EVALUATE TRUE                                                51380000
513900         WHEN SQLCODE = ZERO                                      51390000
514000         WHEN SQLCODE = +100                                      51400000
514100              CONTINUE                                            51410000
514200         WHEN SQLCODE = -904                                      51420000
514300         WHEN SQLCODE = -911                                      51430000
514400         WHEN SQLCODE = -913                                      51440000
514500             PERFORM 9900-SOFT-ABORT                              51450000
514600         WHEN SQLWARN0 NOT = SPACE                                51460000
514700         WHEN SQLCODE NOT = ZERO                                  51470000
514800              MOVE '5851-COUNT-PO-LINE-ROWS'                      51480000
514900                               TO DP013-PARAGRAPH                 51490000
515000              MOVE 'COUNT NUMBER OF "CM", "CB", "CA" STATUS ROWS' 51500000
515100                               TO DP013-MESSAGE-TEXT (1)          51510000
515200              MOVE 'TPURITM '  TO DP013-DB2-TABLE-NAME (1)        51520000
515300              MOVE SQLCA       TO DP013-SQLCA                     51530000
515400              SET DP013-DB2-ABEND                                 51540000
515500                               TO TRUE                            51550000
515600              PERFORM DP013-0000-PROCESS-ABEND                    51560000
515700     END-EVALUATE.                                                51570000
515800                                                                  51580000
515900 5852-GET-TPURCHS-STATUS.                                         51590000
516000                                                                  51600000
516100     EXEC SQL                                                     51610000
516200          SELECT                                                  51620000
516300                  PO_NBR                                          51630000
516400                , VER_NBR                                         51640000
516500                , VER_STATUS_CDE                                  51650000
516600                , PO_TYP_CDE                                      51660000
516700                , PO_CATEG_CDE                                    51670000
516800                , EDI_IND                                         51680000
516900                , TOT_UNT_QTY                                     51690000
517000                , TOT_VAL_COST_AMT                                51700000
517100                , TOT_VAL_RTL_AMT                                 51710000
517200                , TOT_MU_PCT                                      51720000
517300                , TOT_SKUS_QTY                                    51730000
517400                , IMPRT_AGNT_PO_NBR                               51740000
517500                , IMPRT_ORD_OFF_NAME                              51750000
517600                , IMPRT_VEND_NAME                                 51760000
517700                , IMPRT_FCTRY_NAME                                51770000
517800                , IMPRT_CNTRY_NAME                                51780000
517900                , VEND_CNTRY_NAME                                 51790000
518000                , NEW_STR_PO_IND                                  51800000
518100                , IMPRT_PO_IND                                    51810000
518200                , IMPRT_AGNT_PO_IND                               51820000
518300                , STATUS_TMST                                     51830000
518400                , LAST_UPD_TMST                                   51840000
518500                , EDI_REXMIT_IND                                  51850000
518600                , EDI_REXMIT_TMST                                 51860000
518700                , DIR_STR_IND                                     51870000
518800                , LAST_UPD_BY_UID                                 51880000
518900                , APP_BY_UID                                      51890000
519000                , OTB_PER_NBR                                     51900000
519100                , DEPT_NBR                                        51910000
519200                , ENT_ID                                          51920000
519300                , STATUS_CDE                                      51930000
519400                , CRE_BY_UID                                      51940000
519500                , REJ_CT                                          51950000
519600                , REJ_UID                                         51960000
519700                , ORD_DTE                                         51970000
519800                , REVISION_CT                                     51980000
519900                , ADR_SEQ_NBR                                     51990000
520000                , DEST_KNOWN_IND                                  52000000
520100                , RLSE_IND                                        52010000
520200                , RLSE_DTE                                        52020000
520300                , PLCMNT_CNTRY_CDE                                52030000
520400                , PROD_CNTRY_CDE                                  52040000
520500                , UNT_PER_CBMT_QTY                                52050000
520600                , CRE_TMST                                        52060000
520700                , PRG_LAST_ACTVY_DTE                              52070000
520800                , PKGNG_CDE                                       52080000
520900                , SEASET_YR                                       52090000
521000                , SEASET_SHRT_NM                                  52100000
521100                , QTA_CTG_CDE                                     52110000
521200                , PO_IN_RMS_IND                                   52120000
521300                , RMS_PO_UPD_TMST                                 52130001
521400                , DUP_SKU_IND                                     52140001
521500                , ORIG_PKGNG_CDE                                  52150001
521600           INTO                                                   52160000
521700                 :PURCHS-PO-NBR                                   52170000
521800                ,:PURCHS-VER-NBR                                  52180000
521900                ,:PURCHS-VER-STATUS-CDE                           52190000
522000                ,:PURCHS-PO-TYP-CDE                               52200000
522100                ,:PURCHS-PO-CATEG-CDE                             52210000
522200                ,:PURCHS-EDI-IND                                  52220000
522300                ,:PURCHS-TOT-UNT-QTY                              52230000
522400                ,:PURCHS-TOT-VAL-COST-AMT                         52240000
522500                ,:PURCHS-TOT-VAL-RTL-AMT                          52250000
522600                ,:PURCHS-TOT-MU-PCT                               52260000
522700                ,:PURCHS-TOT-SKUS-QTY                             52270000
522800                ,:PURCHS-IMPRT-AGNT-PO-NBR                        52280000
522900                ,:PURCHS-IMPRT-ORD-OFF-NAME                       52290000
523000                ,:PURCHS-IMPRT-VEND-NAME                          52300000
523100                ,:PURCHS-IMPRT-FCTRY-NAME                         52310000
523200                ,:PURCHS-IMPRT-CNTRY-NAME                         52320000
523300                ,:PURCHS-VEND-CNTRY-NAME                          52330000
523400                ,:PURCHS-NEW-STR-PO-IND                           52340000
523500                ,:PURCHS-IMPRT-PO-IND                             52350000
523600                ,:PURCHS-IMPRT-AGNT-PO-IND                        52360000
523700                ,:PURCHS-STATUS-TMST                              52370000
523800                ,:PURCHS-LAST-UPD-TMST                            52380000
523900                ,:PURCHS-EDI-REXMIT-IND                           52390000
524000                ,:PURCHS-EDI-REXMIT-TMST                          52400000
524100                ,:PURCHS-DIR-STR-IND                              52410000
524200                ,:PURCHS-LAST-UPD-BY-UID                          52420000
524300                ,:PURCHS-APP-BY-UID                               52430000
524400                ,:PURCHS-OTB-PER-NBR                              52440000
524500                ,:PURCHS-DEPT-NBR                                 52450000
524600                ,:PURCHS-ENT-ID                                   52460000
524700                ,:PURCHS-STATUS-CDE                               52470000
524800                ,:PURCHS-CRE-BY-UID                               52480000
524900                ,:PURCHS-REJ-CT                                   52490000
525000                ,:PURCHS-REJ-UID                                  52500000
525100                ,:PURCHS-ORD-DTE                                  52510000
525200                ,:PURCHS-REVISION-CT                              52520000
525300                ,:PURCHS-ADR-SEQ-NBR                              52530000
525400                ,:PURCHS-DEST-KNOWN-IND                           52540000
525500                ,:PURCHS-RLSE-IND                                 52550000
525600                ,:PURCHS-RLSE-DTE                                 52560000
525700                ,:PURCHS-PLCMNT-CNTRY-CDE                         52570000
525800                ,:PURCHS-PROD-CNTRY-CDE                           52580000
525900                ,:PURCHS-UNT-PER-CBMT-QTY                         52590000
526000                ,:PURCHS-CRE-TMST                                 52600000
526100                ,:PURCHS-PRG-LAST-ACTVY-DTE                       52610000
526200                ,:PURCHS-PKGNG-CDE                                52620000
526300                ,:PURCHS-SEASET-YR                                52630000
526400                ,:PURCHS-SEASET-SHRT-NM                           52640000
526500                ,:PURCHS-QTA-CTG-CDE                              52650000
526600                ,:PURCHS-PO-IN-RMS-IND                            52660000
526700                ,:PURCHS-RMS-PO-UPD-TMST                          52670001
526800                ,:PURCHS-DUP-SKU-IND                              52680001
526900                ,:PURCHS-ORIG-PKGNG-CDE                           52690001
527000          FROM                                                    52700000
527100                 TPURCHS                                          52710000
527200          WHERE                                                   52720000
527300                PO_NBR             =  :DK-PO-NBR                  52730000
527400          AND   VER_STATUS_CDE     =  :PC-A                       52740000
527500     END-EXEC.                                                    52750000
527600                                                                  52760000
527700     EVALUATE TRUE                                                52770000
527800         WHEN SQLCODE = ZERO                                      52780000
527900         WHEN SQLCODE = +100                                      52790000
528000              CONTINUE                                            52800000
528100         WHEN SQLCODE = -904                                      52810000
528200         WHEN SQLCODE = -911                                      52820000
528300         WHEN SQLCODE = -913                                      52830000
528400             PERFORM 9900-SOFT-ABORT                              52840000
528500         WHEN SQLWARN0 NOT = SPACE                                52850000
528600         WHEN SQLCODE NOT = ZERO                                  52860000
528700              MOVE '5852-GET-TPURCHS-STATUS'                      52870000
528800                               TO DP013-PARAGRAPH                 52880000
528900              MOVE 'GET THE PURCHASE HEADER'                      52890000
529000                               TO DP013-MESSAGE-TEXT (1)          52900000
529100              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        52910000
529200              MOVE SQLCA       TO DP013-SQLCA                     52920000
529300              SET DP013-DB2-ABEND                                 52930000
529400                               TO TRUE                            52940000
529500              PERFORM DP013-0000-PROCESS-ABEND                    52950000
529600     END-EVALUATE.                                                52960000
529700/                                                                 52970000
529800 5853-UPDATE-PURCHS-STATUS.                                       52980000
529900                                                                  52990000
530000     EXEC SQL                                                     53000000
530100          UPDATE                                                  53010000
530200                TPURCHS                                           53020000
530300           SET                                                    53030000
530400                VER_STATUS_CDE     =  :PC-I                       53040000
530500          WHERE                                                   53050000
530600                PO_NBR             =  :DK-PO-NBR                  53060000
530700          AND   VER_STATUS_CDE     =  :PC-A                       53070000
530800     END-EXEC.                                                    53080000
530900                                                                  53090000
531000     EVALUATE TRUE                                                53100000
531100         WHEN SQLCODE = ZERO                                      53110000
531200         WHEN SQLCODE = +100                                      53120000
531300              CONTINUE                                            53130000
531400         WHEN SQLCODE = -904                                      53140000
531500         WHEN SQLCODE = -911                                      53150000
531600         WHEN SQLCODE = -913                                      53160000
531700             SET PS-UPDATES-DONE TO TRUE                          53170000
531800             PERFORM 9900-SOFT-ABORT                              53180000
531900         WHEN SQLWARN0 NOT = SPACE                                53190000
532000         WHEN SQLCODE NOT = ZERO                                  53200000
532100              MOVE '5853-UPDATE-PURCHS-STATUS'                    53210000
532200                               TO DP013-PARAGRAPH                 53220000
532300              MOVE 'GET THE PURCHASE HEADER'                      53230000
532400                               TO DP013-MESSAGE-TEXT (1)          53240000
532500              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        53250000
532600              MOVE SQLCA       TO DP013-SQLCA                     53260000
532700              SET DP013-DB2-ABEND                                 53270000
532800                               TO TRUE                            53280000
532900              PERFORM DP013-0000-PROCESS-ABEND                    53290000
533000     END-EVALUATE.                                                53300000
533100/                                                                 53310000
533200 5854-INSERT-PURCHS.                                              53320000
533300                                                                  53330000
533400     EXEC SQL                                                     53340000
533500          INSERT                                                  53350000
533600           INTO   TPURCHS                                         53360000
533700                 (PO_NBR                                          53370000
533800                , VER_NBR                                         53380000
533900                , VER_STATUS_CDE                                  53390000
534000                , PO_TYP_CDE                                      53400000
534100                , PO_CATEG_CDE                                    53410000
534200                , EDI_IND                                         53420000
534300                , TOT_UNT_QTY                                     53430000
534400                , TOT_VAL_COST_AMT                                53440000
534500                , TOT_VAL_RTL_AMT                                 53450000
534600                , TOT_MU_PCT                                      53460000
534700                , TOT_SKUS_QTY                                    53470000
534800                , IMPRT_AGNT_PO_NBR                               53480000
534900                , IMPRT_ORD_OFF_NAME                              53490000
535000                , IMPRT_VEND_NAME                                 53500000
535100                , IMPRT_FCTRY_NAME                                53510000
535200                , IMPRT_CNTRY_NAME                                53520000
535300                , VEND_CNTRY_NAME                                 53530000
535400                , NEW_STR_PO_IND                                  53540000
535500                , IMPRT_PO_IND                                    53550000
535600                , IMPRT_AGNT_PO_IND                               53560000
535700                , STATUS_TMST                                     53570000
535800                , LAST_UPD_TMST                                   53580000
535900                , EDI_REXMIT_IND                                  53590000
536000                , EDI_REXMIT_TMST                                 53600000
536100                , DIR_STR_IND                                     53610000
536200                , LAST_UPD_BY_UID                                 53620000
536300                , APP_BY_UID                                      53630000
536400                , OTB_PER_NBR                                     53640000
536500                , DEPT_NBR                                        53650000
536600                , ENT_ID                                          53660000
536700                , STATUS_CDE                                      53670000
536800                , CRE_BY_UID                                      53680000
536900                , REJ_CT                                          53690000
537000                , REJ_UID                                         53700000
537100                , ORD_DTE                                         53710000
537200                , REVISION_CT                                     53720000
537300                , ADR_SEQ_NBR                                     53730000
537400                , DEST_KNOWN_IND                                  53740000
537500                , RLSE_IND                                        53750000
537600                , RLSE_DTE                                        53760000
537700                , PLCMNT_CNTRY_CDE                                53770000
537800                , PROD_CNTRY_CDE                                  53780000
537900                , UNT_PER_CBMT_QTY                                53790000
538000                , CRE_TMST                                        53800000
538100                , PRG_LAST_ACTVY_DTE                              53810000
538200                , PKGNG_CDE                                       53820000
538300                , SEASET_YR                                       53830000
538400                , SEASET_SHRT_NM                                  53840000
538500                , QTA_CTG_CDE                                     53850000
538600                , PO_IN_RMS_IND                                   53860000
538700                , RMS_PO_UPD_TMST                                 53870001
538800                , DUP_SKU_IND                                     53880001
538900                , ORIG_PKGNG_CDE                                  53890001
539000                  )                                               53900000
539100         VALUES                                                   53910000
539200                (:PURCHS-PO-NBR                                   53920000
539300                ,:PURCHS-VER-NBR                                  53930000
539400                ,:PC-A                                            53940000
539500                ,:PURCHS-PO-TYP-CDE                               53950000
539600                ,:PURCHS-PO-CATEG-CDE                             53960000
539700                ,:PURCHS-EDI-IND                                  53970000
539800                ,:PURCHS-TOT-UNT-QTY                              53980000
539900                ,:PURCHS-TOT-VAL-COST-AMT                         53990000
540000                ,:PURCHS-TOT-VAL-RTL-AMT                          54000000
540100                ,:PURCHS-TOT-MU-PCT                               54010000
540200                ,:PURCHS-TOT-SKUS-QTY                             54020000
540300                ,:PURCHS-IMPRT-AGNT-PO-NBR                        54030000
540400                ,:PURCHS-IMPRT-ORD-OFF-NAME                       54040000
540500                ,:PURCHS-IMPRT-VEND-NAME                          54050000
540600                ,:PURCHS-IMPRT-FCTRY-NAME                         54060000
540700                ,:PURCHS-IMPRT-CNTRY-NAME                         54070000
540800                ,:PURCHS-VEND-CNTRY-NAME                          54080000
540900                ,:PURCHS-NEW-STR-PO-IND                           54090000
541000                ,:PURCHS-IMPRT-PO-IND                             54100000
541100                ,:PURCHS-IMPRT-AGNT-PO-IND                        54110000
541200                , CURRENT TIMESTAMP                               54120000
541300                , CURRENT TIMESTAMP                               54130000
541400                ,:PURCHS-EDI-REXMIT-IND                           54140000
541500                ,:PURCHS-EDI-REXMIT-TMST                          54150000
541600                ,:PURCHS-DIR-STR-IND                              54160000
541700                ,:DP020-USERID                                    54170000
541800                ,:PURCHS-APP-BY-UID                               54180000
541900                ,:PURCHS-OTB-PER-NBR                              54190000
542000                ,:PURCHS-DEPT-NBR                                 54200000
542100                ,:PURCHS-ENT-ID                                   54210000
542200                ,:ASC-PURCHS-STATUS-CDE                           54220000
542300                ,:PURCHS-CRE-BY-UID                               54230000
542400                ,:PURCHS-REJ-CT                                   54240000
542500                ,:PURCHS-REJ-UID                                  54250000
542600                ,:PURCHS-ORD-DTE                                  54260000
542700                ,:PURCHS-REVISION-CT                              54270000
542800                ,:PURCHS-ADR-SEQ-NBR                              54280000
542900                ,:PURCHS-DEST-KNOWN-IND                           54290000
543000                ,:PURCHS-RLSE-IND                                 54300000
543100                ,:PURCHS-RLSE-DTE                                 54310000
543200                ,:PURCHS-PLCMNT-CNTRY-CDE                         54320000
543300                ,:PURCHS-PROD-CNTRY-CDE                           54330000
543400                ,:PURCHS-UNT-PER-CBMT-QTY                         54340000
543500                ,:PURCHS-CRE-TMST                                 54350000
543600                ,:PURCHS-PRG-LAST-ACTVY-DTE                       54360000
543700                ,:PURCHS-PKGNG-CDE                                54370000
543800                ,:PURCHS-SEASET-YR                                54380000
543900                ,:PURCHS-SEASET-SHRT-NM                           54390000
544000                ,:PURCHS-QTA-CTG-CDE                              54400000
544100                ,:PURCHS-PO-IN-RMS-IND                            54410000
544200                ,:PURCHS-RMS-PO-UPD-TMST                          54420001
544300                ,:PURCHS-DUP-SKU-IND                              54430001
544400                ,:PURCHS-ORIG-PKGNG-CDE                           54440001
544500                 )                                                54450000
544600     END-EXEC.                                                    54460000
544700                                                                  54470000
544800     EVALUATE TRUE                                                54480000
544900         WHEN SQLCODE = ZERO                                      54490000
545000              CONTINUE                                            54500000
545100         WHEN SQLCODE = -904                                      54510000
545200         WHEN SQLCODE = -911                                      54520000
545300         WHEN SQLCODE = -913                                      54530000
545400             SET PS-UPDATES-DONE TO TRUE                          54540000
545500             PERFORM 9900-SOFT-ABORT                              54550000
545600         WHEN SQLWARN0 NOT = SPACE                                54560000
545700         WHEN SQLCODE NOT = ZERO                                  54570000
545800              MOVE '5854-INSERT-PURCHS'                           54580000
545900                               TO DP013-PARAGRAPH                 54590000
546000              MOVE 'INSERT PURCHASE HEADER'                       54600000
546100                               TO DP013-MESSAGE-TEXT (1)          54610000
546200              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        54620000
546300              MOVE SQLCA       TO DP013-SQLCA                     54630000
546400              SET DP013-DB2-ABEND                                 54640000
546500                               TO TRUE                            54650000
546600              PERFORM DP013-0000-PROCESS-ABEND                    54660000
546700     END-EVALUATE.                                                54670000
546800/                                                                 54680000
546900 5855-ONLY-UPDATE-PURCHS-STATUS.                                  54690000
547000                                                                  54700000
547100     EXEC SQL                                                     54710000
547200          UPDATE                                                  54720000
547300                TPURCHS                                           54730000
547400           SET                                                    54740000
547500                VER_STATUS_CDE     =  :PC-A                       54750000
547600              , STATUS_TMST        =  (CURRENT TIMESTAMP)         54760000
547700              , LAST_UPD_TMST      =  (CURRENT TIMESTAMP)         54770000
547800              , STATUS_CDE         =  :ASC-PURCHS-STATUS-CDE      54780000
547900          WHERE                                                   54790000
548000                PO_NBR             =  :DK-PO-NBR                  54800000
548100          AND   VER_STATUS_CDE     =  :PC-A                       54810000
548200     END-EXEC.                                                    54820000
548300                                                                  54830000
548400     EVALUATE TRUE                                                54840000
548500         WHEN SQLCODE = ZERO                                      54850000
548600         WHEN SQLCODE = +100                                      54860000
548700              CONTINUE                                            54870000
548800         WHEN SQLCODE = -904                                      54880000
548900         WHEN SQLCODE = -911                                      54890000
549000         WHEN SQLCODE = -913                                      54900000
549100             SET PS-UPDATES-DONE TO TRUE                          54910000
549200             PERFORM 9900-SOFT-ABORT                              54920000
549300         WHEN SQLWARN0 NOT = SPACE                                54930000
549400         WHEN SQLCODE NOT = ZERO                                  54940000
549500              MOVE '5855-ONLY-UPDATE-PURCHS-STATUS'               54950000
549600                               TO DP013-PARAGRAPH                 54960000
549700              MOVE 'GET THE PURCHASE HEADER'                      54970000
549800                               TO DP013-MESSAGE-TEXT (1)          54980000
549900              MOVE 'TPURCHS '  TO DP013-DB2-TABLE-NAME (1)        54990000
550000              MOVE SQLCA       TO DP013-SQLCA                     55000000
550100              SET DP013-DB2-ABEND                                 55010000
550200                               TO TRUE                            55020000
550300              PERFORM DP013-0000-PROCESS-ABEND                    55030000
550400     END-EVALUATE.                                                55040000
550500                                                                  55050001
550600*----------------------------------------------------------------*55060001
550700*    CHECK TO SEE IF THIS DEPARTMENT HAS BEEN CONVERTED TO RMS.  *55070001
550800*    IF IT HAS, THE COUNT RETURNED FROM THIS FUNCTION WILL BE    *55080001
550900*    GREATER THAN ZERO AND WE CAN UPDATE TPURITM AND TPURCHS     *55090001
551000*    CORRECTLY.                                                  *55100001
551100*----------------------------------------------------------------*55110001
551200 5856-CHECK-FOR-RMS-PO.                                           55120001
551300                                                                  55130001
551400     INITIALIZE PV-DB2-COUNT.                                     55140001
551500                                                                  55150001
551600     EXEC SQL                                                     55160001
551700          SELECT                                                  55170001
551800                  COUNT(*)                                        55180001
551900           INTO                                                   55190001
552000                  :PV-DB2-COUNT :PV-NULL-IND                      55200001
552100           FROM                                                   55210001
552200                  POT_RMS_RLOUT_CTL                               55220001
552300          WHERE                                                   55230001
552400                  DEPT_NBR            = :PV-DEPT-NBR-KEY          55240001
552500           AND    PO_ENTR_IN_RMS_DTE <=  CURRENT_DATE             55250003
552600     END-EXEC.                                                    55260001
552700                                                                  55270001
552800     EVALUATE TRUE                                                55280001
552900         WHEN SQLCODE = ZERO                                      55290001
553000         WHEN SQLCODE = +100                                      55300001
553100              SET PS-CHECKED-FOR-RMS-PO                           55310001
553200                               TO TRUE                            55320001
553300         WHEN SQLWARN0 NOT = SPACE                                55330001
553400         WHEN SQLCODE = -904                                      55340001
553500         WHEN SQLCODE = -911                                      55350001
553600         WHEN SQLCODE = -913                                      55360001
553700              PERFORM 9900-SOFT-ABORT                             55370001
553800         WHEN SQLCODE NOT = ZERO                                  55380001
553900              MOVE '5856-CHECK-FOR-RMS-PO'                        55390001
554000                               TO DP013-PARAGRAPH                 55400001
554100              MOVE 'CHECK IF DEPT NBR CONVERTED FOR RMS'          55410001
554200                               TO DP013-MESSAGE-TEXT (1)          55420001
554300              STRING 'DEPARTMENT NUMBER: ' DELIMITED BY SIZE      55430001
554400                     PV-DEPT-NBR-X         DELIMITED BY SIZE      55440001
554500                             INTO DP013-MESSAGE-TEXT (2)          55450001
554600              MOVE 'POT_RMS_RLOUT_CTL'                            55460001
554700                               TO DP013-DB2-TABLE-NAME (1)        55470001
554800              MOVE SQLCA       TO DP013-SQLCA                     55480001
554900              SET DP013-DB2-ABEND                                 55490001
555000                               TO TRUE                            55500001
555100              PERFORM DP013-0000-PROCESS-ABEND                    55510001
555200     END-EVALUATE.                                                55520001
555300/                                                                 55530001
555400 6000-REFRESH-PANEL-FROM-TEMP.                                    55540001
555500                                                                  55550001
555600     IF ASC-UPDATE-TSQ                                            55560001
555700         SET ASC-NO-TSQ-UPDATE   TO TRUE                          55570001
555800         MOVE ZERO               TO PV-SAVE-ITEM                  55580001
555900                                    PV-SEL-QUEUE-ITEM             55590000
556000         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        55600000
556100                                 TO PV-HOLD-SELECTED-ITEMS        55610000
556200         PERFORM 6100-UPDATE-TSQ                                  55620000
556300           UNTIL PV-ITEMS-PROCESSED > ASC-NUMBER-OF-SELECTED-ITEMS55630000
556400                                                                  55640000
556500         PERFORM 6010-DELETE-SEL-QUEUE                            55650000
556600                                                                  55660000
556700         INITIALIZE ASC-BLOCK-ENTRIES (1)                         55670000
556800                    ASC-BLOCK-ENTRIES (2)                         55680000
556900                                                                  55690000
557000         DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL                 55700000
557100                GIVING    PV-BLOCK-NUMBER                         55710000
557200                REMAINDER PV-REMAINDER                            55720000
557300                                                                  55730000
557400         IF PV-REMAINDER > ZERO                                   55740000
557500             ADD +1              TO PV-BLOCK-NUMBER               55750000
557600         END-IF                                                   55760000
557700                                                                  55770000
557800         MOVE +1                 TO ASC-BLK-SUB                   55780000
557900                                                                  55790000
558000         PERFORM 4410-READ-TEMP-STORAGE                           55800000
558100                                                                  55810000
558200         ADD +1                  TO ASC-BLK-SUB                   55820000
558300                            PV-BLOCK-NUMBER                       55830000
558400         PERFORM 4410-READ-TEMP-STORAGE                           55840000
558500                                                                  55850000
558600     END-IF.                                                      55860000
558700                                                                  55870000
558800 6010-DELETE-SEL-QUEUE.                                           55880000
558900                                                                  55890000
559000     EXEC CICS DELETEQ TS                                         55900000
559100               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     55910000
559200               RESP  (PV-CICS-RESP)                               55920000
559300     END-EXEC.                                                    55930000
559400                                                                  55940000
559500     IF ((PV-CICS-RESP = DFHRESP (NORMAL)) OR                     55950000
559600         (PV-CICS-RESP = DFHRESP (QIDERR)))                       55960000
559700         CONTINUE                                                 55970000
559800     ELSE                                                         55980000
559900         SET DP013-CICS-ABEND                                     55990000
560000             DP013-NO-ROLLBACK   TO TRUE                          56000000
560100         MOVE '6010-DELETE-SEL-QUEUE'                             56010000
560200                                 TO DP013-PARAGRAPH               56020000
560300         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE DELETE'  56030000
560400                                 TO DP013-MESSAGE-TEXT (1)        56040000
560500         PERFORM DP013-0000-PROCESS-ABEND                         56050000
560600     END-IF.                                                      56060000
560700                                                                  56070000
560800 6100-UPDATE-TSQ.                                                 56080000
560900                                                                  56090000
561000     ADD 1                       TO PV-SEL-QUEUE-ITEM.            56100000
561100                                                                  56110000
561200     PERFORM 6105-READ-SEL-QUEUE.                                 56120000
561300                                                                  56130000
561400     PERFORM                                                      56140000
561500     VARYING RC013-IDX  FROM 1 BY 1                               56150000
561600     UNTIL   PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS OR       56160000
561700             RC013-IDX > RC013-MAX-ITEMS                          56170000
561800                                                                  56180000
561900         IF RC013-ACTION-SW (RC013-IDX) > SPACE                   56190000
562000            PERFORM 6110-PROCESS-ITEMS                            56200000
562100            SET PS-WRITE-LIST-QUEUE                               56210000
562200                                 TO TRUE                          56220000
562300         END-IF                                                   56230000
562400                                                                  56240000
562500         ADD +1                  TO PV-ITEMS-PROCESSED            56250000
562600     END-PERFORM.                                                 56260000
562700                                                                  56270000
562800     IF PS-WRITE-LIST-QUEUE                                       56280000
562900         PERFORM 6111-WRITE-LIST-QUEUE                            56290000
563000     END-IF.                                                      56300000
563100                                                                  56310000
563200                                                                  56320000
563300 6105-READ-SEL-QUEUE.                                             56330000
563400                                                                  56340000
563500     EXEC CICS READQ TS                                           56350000
563600               QUEUE (ASC-SEL-QUEUE-NAME-OUT)                     56360000
563700               INTO  (RC013-DC-SELECT-RECORD)                     56370000
563800               ITEM  (PV-SEL-QUEUE-ITEM)                          56380000
563900               RESP  (PV-CICS-RESP)                               56390000
564000     END-EXEC.                                                    56400000
564100                                                                  56410000
564200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       56420000
564300         SET DP013-CICS-ABEND                                     56430000
564400             DP013-NO-ROLLBACK   TO TRUE                          56440000
564500         MOVE '6105-READ-SEL-QUEUE'                               56450000
564600                                 TO DP013-PARAGRAPH               56460000
564700         MOVE 'UNSUCCESSFUL SEL ITEMS TEMP STORAGE QUEUE READ'    56470000
564800                                 TO DP013-MESSAGE-TEXT (1)        56480000
564900         PERFORM DP013-0000-PROCESS-ABEND                         56490000
565000     END-IF.                                                      56500000
565100                                                                  56510000
565200 6110-PROCESS-ITEMS.                                              56520000
565300                                                                  56530000
565400     COMPUTE PV-ITEM = 1 + ((RC013-ITEM (RC013-IDX) - 1)          56540000
565500                                            / PC-ITEMS-PER-PANEL).56550000
565600                                                                  56560000
565700     IF PV-ITEM NOT = PV-SAVE-ITEM                                56570000
565800        IF PV-SAVE-ITEM NOT = ZERO                                56580000
565900                                                                  56590000
566000            PERFORM 6111-WRITE-LIST-QUEUE                         56600000
566100                                                                  56610000
566200        END-IF                                                    56620000
566300        MOVE PV-ITEM             TO PV-SAVE-ITEM                  56630000
566400                                                                  56640000
566500        PERFORM 6112-READ-LIST-QUEUE                              56650000
566600                                                                  56660000
566700     END-IF.                                                      56670000
566800                                                                  56680000
566900     COMPUTE PV-SUB = (RC013-ITEM (RC013-IDX) -                   56690000
567000                                    LQW-LIST-ITEM-NUMBER (1)) + 1.56700000
567100     SET LQW-DESELECT (PV-SUB)   TO TRUE                          56710000
567200     MOVE LQW-SELECTED-SW (PV-SUB)                                56720000
567300                                 TO LQW-TEMP-SELECTED-SW (PV-SUB).56730000
567400                                                                  56740000
567500     EVALUATE TRUE                                                56750000
567600         WHEN RC013-INQ (RC013-IDX)                               56760000
567700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             56770000
567800                                                                  56780000
567900         WHEN RC013-UPD (RC013-IDX)                               56790000
568000              MOVE PC-UPD      TO LQW-ACTION (PV-SUB)             56800000
568100                                                                  56810000
568200         WHEN RC013-DEL (RC013-IDX)                               56820000
568300              MOVE PC-DEL      TO LQW-ACTION (PV-SUB)             56830000
568400                                                                  56840000
568500         WHEN RC013-ERR (RC013-IDX)                               56850000
568600              MOVE PC-ERR      TO LQW-ACTION (PV-SUB)             56860000
568700     END-EVALUATE.                                                56870000
568800                                                                  56880000
568900     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                56890000
569000                                                                  56900000
569100 6111-WRITE-LIST-QUEUE.                                           56910000
569200                                                                  56920000
569300     EXEC CICS WRITEQ TS                                          56930000
569400               QUEUE (ASC-LIST-QUEUE-NAME)                        56940000
569500               FROM  (LQW-LIST-QUEUE-WORK-AREA)                   56950000
569600               ITEM  (PV-SAVE-ITEM)                               56960000
569700               REWRITE                                            56970000
569800               RESP  (PV-CICS-RESP)                               56980000
569900     END-EXEC.                                                    56990000
570000                                                                  57000000
570100     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57010000
570200         SET DP013-CICS-ABEND                                     57020000
570300             DP013-NO-ROLLBACK   TO TRUE                          57030000
570400         MOVE '6111-WRITE-LIST-QUEUE'                             57040000
570500                                 TO DP013-PARAGRAPH               57050000
570600         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'57060000
570700                                 TO DP013-MESSAGE-TEXT(1)         57070000
570800         PERFORM DP013-0000-PROCESS-ABEND                         57080000
570900     END-IF.                                                      57090000
571000                                                                  57100000
571100 6112-READ-LIST-QUEUE.                                            57110000
571200                                                                  57120000
571300     EXEC CICS READQ TS                                           57130000
571400               QUEUE (ASC-LIST-QUEUE-NAME)                        57140000
571500               INTO  (LQW-LIST-QUEUE-WORK-AREA)                   57150000
571600               ITEM  (PV-ITEM)                                    57160000
571700               RESP  (PV-CICS-RESP)                               57170000
571800     END-EXEC.                                                    57180000
571900                                                                  57190000
572000     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57200000
572100         SET DP013-CICS-ABEND                                     57210000
572200             DP013-NO-ROLLBACK   TO TRUE                          57220000
572300         MOVE '6112-READ-LIST-QUEUE'                              57230000
572400                                 TO DP013-PARAGRAPH               57240000
572500         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE READ'   57250000
572600                                 TO DP013-MESSAGE-TEXT(1)         57260000
572700         PERFORM DP013-0000-PROCESS-ABEND                         57270000
572800     END-IF.                                                      57280000
572900                                                                  57290000
573000******************************************************************57300000
573100* WRITE ENTRIES TO VERIFY ADJUSTMENT QUEUE                       *57310000
573200******************************************************************57320000
573300 6150-WRITE-VRFY-ADJ-QUEUE.                                       57330000
573400                                                                  57340000
573500     EXEC CICS WRITEQ TS                                          57350000
573600               QUEUE (ASC-VRFY-ADJ-QUEUE-NAME)                    57360000
573700               FROM  (PC241-FIELDS)                               57370000
573800               ITEM  (PV-VRFY-ITEM)                               57380000
573900               RESP  (PV-CICS-RESP)                               57390000
574000     END-EXEC.                                                    57400000
574100                                                                  57410000
574200     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       57420000
574300         SET DP013-CICS-ABEND                                     57430000
574400             DP013-NO-ROLLBACK   TO TRUE                          57440000
574500         MOVE '6150-WRITE-VRFY-ADJ-QUEUE'                         57450000
574600                                 TO DP013-PARAGRAPH               57460000
574700         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE'        57470000
574800                                 TO DP013-MESSAGE-TEXT(1)         57480000
574900         PERFORM DP013-0000-PROCESS-ABEND                         57490000
575000     END-IF.                                                      57500000
575100                                                                  57510000
575200******************************************************************57520000
575300* DELETE THE LIST QUEUE WHEN PREV-SEL OR NEXT-SEL WAS ENTERED.   *57530000
575400******************************************************************57540000
575500 6200-DEL-LIST-QUEUE.                                             57550000
575600                                                                  57560000
575700     EXEC CICS                                                    57570000
575800         DELETEQ TS                                               57580000
575900             QUEUE (ASC-LIST-QUEUE-NAME)                          57590000
576000             RESP  (PV-CICS-RESP)                                 57600000
576100     END-EXEC.                                                    57610000
576200                                                                  57620000
576300     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      57630000
576400        (PV-CICS-RESP = DFHRESP(QIDERR)))                         57640000
576500         CONTINUE                                                 57650000
576600     ELSE                                                         57660000
576700        SET DP013-CICS-ABEND     TO TRUE                          57670000
576800        SET DP013-NO-ROLLBACK    TO TRUE                          57680000
576900        MOVE '6200-DEL-LIST-QUEUE'                                57690000
577000                                 TO DP013-PARAGRAPH               57700000
577100        MOVE 'ERROR TRYING TO DELETE LIST TS QUEUE'               57710000
577200                                 TO DP013-MESSAGE-TEXT (1)        57720000
577300        PERFORM DP013-0000-PROCESS-ABEND                          57730000
577400     END-IF.                                                      57740000
577500/                                                                 57750000
577600******************************************************************57760000
577700* THIS PARAGRAPH WILL CONTROL THE PROCESSING ASSOCIATED TO THE   *57770000
577800* UNITS WORKED ROUTINE.                                           57780000
577900******************************************************************57790000
578000 7500-PROCESS-UNITS-WORK.                                         57800000
578100                                                                  57810000
578200     PERFORM 7600-RECEIV-PURITM-JOIN.                             57820000
578300     PERFORM 7800-UNITS-WORK-ROUTINE.                             57830000
578400                                                                  57840000
578500/                                                                 57850000
578600******************************************************************57860000
578700*  THIS PARAGRAPH WILL BE USED TO GET SOME FIELDS TO DETERMINE   *57870000
578800*  IF THE UNITS WORKED MODULE NEEDS TO BE CALLED (IF THE FULL-   *57880000
578900*  CASE TIMESTAMP IS A VALUE OTHER THAN 9'S, THEN THE LINE IS    *57890000
579000*  CONFIRMED AND THE UNITS WORKED MODULE WILL NEED TO BE CALLED  *57900000
579100*  FOR CONFIRMATION UNIT ADJUSTMENTS.  THE OTHER FIELDS ARE USED *57910000
579200*  BY THE MODULE TO DETERMINE THE RETAIL VALUE OF THE ADJUSTMENT *57920000
579300*  AND WHAT OPER UNIT AND PROCESS AREA THE ADJUSTMENT SHOULD BE  *57930000
579400*  POSTED TO WITHIN THE UNITS WORKED SYSTEM.                     *57940000
579500******************************************************************57950000
579600 7600-RECEIV-PURITM-JOIN.                                         57960000
579700                                                                  57970000
579800     EXEC SQL                                                     57980000
579900     SELECT A.CURR_OPER_UNT_ID,                                   57990000
580000            C.UNT_RTL_PR_AMT,                                     58000000
580100            D.LOC_TYP_CDE                                         58010010
580200         INTO :PV-CURR-OPER-UNT-ID                                58020000
580300         ,    :PURITM-UNT-RTL-PR-AMT                              58030000
580400         ,    :PV-XLT00010-TYPE-CODE                              58040007
580500         FROM                                                     58050000
580600             TRECEIV A                                            58060000
580700         ,   TRECITM B                                            58070000
580800         ,   TPURITM C                                            58080000
580900         ,   XLT_LOC D                                            58090007
581000         WHERE A.ORD_NBR          = :DK-PO-NBR                    58100000
581100           AND A.REC_SEQ_NBR      = :DK-REC-SEQ-NBR               58110007
581200           AND B.ORD_NBR          = A.ORD_NBR                     58120000
581300           AND B.REC_SEQ_NBR      = A.REC_SEQ_NBR                 58130000
581400           AND B.ORD_LNE_NBR      = :DK-PKSL-LNE-NBR              58140000
581500           AND C.PO_NBR           = B.ORD_NBR                     58150000
581600           AND C.APP_PO_LNE_NBR   = B.ORD_LNE_NBR                 58160000
581700           AND C.VER_NBR          = B.PO_VER_NBR                  58170000
581800           AND D.LOC_NBR          = A.CURR_OPER_UNT_ID            58180007
581900     END-EXEC.                                                    58190000
582000*                                                                 58200000
582100     EVALUATE TRUE                                                58210000
582200         WHEN SQLCODE = ZERO                                      58220000
582300             CONTINUE                                             58230000
582400         WHEN SQLCODE = -904                                      58240000
582500         WHEN SQLCODE = -911                                      58250000
582600         WHEN SQLCODE = -913                                      58260000
582700             PERFORM 9900-SOFT-ABORT                              58270000
582800                                                                  58280000
582900         WHEN SQLWARN0 NOT = SPACES                               58290000
583000         WHEN SQLCODE < ZERO                                      58300000
583100         WHEN SQLCODE > ZERO                                      58310000
583200             MOVE '7600-RECEIV-PURITM-JOIN'                       58320000
583300                                  TO DP013-PARAGRAPH              58330000
583400             MOVE 'UNSUCCESSFUL JOIN OF 3 TABLES'                 58340000
583500                                  TO DP013-MESSAGE-TEXT (1)       58350000
583600             MOVE SQLCA      TO DP013-SQLCA                       58360000
583700             MOVE 'TRECEIV ' TO DP013-DB2-TABLE-NAME (1)          58370000
583800             SET DP013-DB2-ABEND                                  58380000
583900                 DP013-NO-ROLLBACK                                58390000
584000                                  TO TRUE                         58400000
584100             PERFORM DP013-0000-PROCESS-ABEND                     58410000
584200     END-EVALUATE.                                                58420000
584300                                                                  58430000
584400******************************************************************58440000
584500* THIS PARAGRAPH WILL FORMAT ALL OF THE DATA NEEDED FOR THE      *58450000
584600* UNITS WORKED ROUTINE AND WILL THEN CALL THE ROUTINE AND        *58460000
584700* THE RESULTS RETURNED FROM THE ROUTINE.                         *58470000
584800******************************************************************58480000
584900 7800-UNITS-WORK-ROUTINE.                                         58490000
585000                                                                  58500000
585100     INITIALIZE PC238-COMM-AREA.                                  58510000
585200                                                                  58520000
585300     EXEC SQL                                                     58530000
585400         SET :PV-TMST =  CURRENT_TIMESTAMP                        58540000
585500     END-EXEC                                                     58550000
585600                                                                  58560000
585700     MOVE PV-TMST                 TO PC238-WRKD-TMST.             58570000
585800                                                                  58580000
585900     IF  PV-XLT00010-TYPE-DC                                      58590007
586000         NEXT SENTENCE                                            58600000
586100     ELSE                                                         58610000
586200         MOVE 'Y'                   TO PC238-DIRECT-STORE-SW      58620000
586300     END-IF.                                                      58630000
586400                                                                  58640000
586500     MOVE PV-CURR-OPER-UNT-ID     TO PC238-WRKD-OPER-UNT-ID.      58650000
586600     MOVE DK-PO-NBR               TO PC238-PO-NBR.                58660000
586700     MOVE DK-REC-SEQ-NBR          TO PC238-RCVR-SEQ-NBR.          58670000
586800     MOVE DK-PKSL-LNE-NBR         TO PC238-PO-LNE-NBR.            58680000
586900                                                                  58690000
587000     MOVE PA-ACCUM-UPDATE-QTY     TO PC238-WRKD-UNT-QTY.          58700000
587100     MOVE PURITM-UNT-RTL-PR-AMT   TO PC238-UNT-RETAIL-PRC.        58710000
587200     SET  PC238-TRANS-POST-VRFY-ADJ TO TRUE.                      58720000
587300     SET  PC238-MANUAL-VERIFY     TO TRUE.                        58730000
587400     MOVE ASC-VRFY-ADJ-QUEUE-NAME TO PC238-VRFY-ADJ-QUEUE-NAME.   58740000
587500     MOVE PV-VRFY-ITEM            TO PC238-TOT-QUEUE-ITEMS.       58750000
587600                                                                  58760000
587700************************************************                  58770000
587800*                                                                 58780000
587900*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    58790000
588000*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  58800000
588100*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  58810000
588200*    MOVE PC238-WRKD-OPER-UNT-ID                                  58820000
588300*                            TO PC-DISPLAY-OPER.                  58830000
588400*    STRING ' RCKCS279 - '      DELIMITED BY SIZE                 58840000
588500*           ' CALLING PCKCS756 WITH KEY INFO - '                  58850000
588600*                               DELIMITED BY SIZE                 58860000
588700*           PC-DISPLAY-PO       DELIMITED BY SIZE                 58870000
588800*           ' - '               DELIMITED BY SIZE                 58880000
588900*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 58890000
589000*           ' - '               DELIMITED BY SIZE                 58900000
589100*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 58910000
589200*           ' - '               DELIMITED BY SIZE                 58920000
589300*           PC-DISPLAY-OPER     DELIMITED BY SIZE                 58930000
589400*                        INTO PV-CICS-MSG-AREA.                   58940000
589500*    MOVE LENGTH OF PV-CICS-MSG-AREA                              58950000
589600*                          TO PV-COMMAREA-LENGTH.                 58960000
589700*    PERFORM 9700-WRITE-TO-CICS-LOG.                              58970000
589800*                                                                 58980000
589900************************************************                  58990000
590000                                                                  59000000
590100     MOVE LENGTH OF PC238-COMM-AREA                               59010000
590200                                  TO PV-COMMAREA-LENGTH.          59020000
590300                                                                  59030000
590400     EXEC CICS                                                    59040000
590500         LINK PROGRAM  (PV-PCKCS756)                              59050000
590600              COMMAREA (PC238-COMM-AREA)                          59060000
590700              LENGTH   (PV-COMMAREA-LENGTH)                       59070000
590800              RESP     (PV-CICS-RESPONSE)                         59080000
590900     END-EXEC.                                                    59090000
591000                                                                  59100000
591100************************************************                  59110000
591200*                                                                 59120000
591300*    MOVE PC238-PO-NBR       TO PC-DISPLAY-PO.                    59130000
591400*    MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR.                  59140000
591500*    MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE.                  59150000
591600*    MOVE PC238-WRKD-OPER-UNT-ID                                  59160000
591700*                            TO PC-DISPLAY-OPER.                  59170000
591800*    STRING ' RCKCS279 - '      DELIMITED BY SIZE                 59180000
591900*           ' RETURN FROM PCKCS756 - '                            59190000
592000*                               DELIMITED BY SIZE                 59200000
592100*           PC-DISPLAY-PO       DELIMITED BY SIZE                 59210000
592200*           ' - '               DELIMITED BY SIZE                 59220000
592300*           PC-DISPLAY-RCVR     DELIMITED BY SIZE                 59230000
592400*           ' - '               DELIMITED BY SIZE                 59240000
592500*           PC-DISPLAY-LINE     DELIMITED BY SIZE                 59250000
592600*           ' - '               DELIMITED BY SIZE                 59260000
592700*           PC238-MOD-SUCCESS-CDE                                 59270000
592800*                               DELIMITED BY SIZE                 59280000
592900*           ' - '               DELIMITED BY SIZE                 59290000
593000*           PC238-UNSUCCESSFUL-CDE                                59300000
593100*                               DELIMITED BY SIZE                 59310000
593200*                        INTO PV-CICS-MSG-AREA.                   59320000
593300*    MOVE LENGTH OF PV-CICS-MSG-AREA                              59330000
593400*                          TO PV-COMMAREA-LENGTH.                 59340000
593500*    PERFORM 9700-WRITE-TO-CICS-LOG.                              59350000
593600*                                                                 59360000
593700************************************************                  59370000
593800                                                                  59380000
593900     EVALUATE TRUE                                                59390000
594000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 59400000
594100              IF  PC238-MOD-UNSUCCESSFUL                          59410000
594200                  PERFORM 7810-MOD-UNSUCCESSFUL                   59420000
594300              END-IF                                              59430000
594400         WHEN OTHER                                               59440000
594500              MOVE PC238-PO-NBR       TO PC-DISPLAY-PO            59450000
594600              MOVE PC238-RCVR-SEQ-NBR TO PC-DISPLAY-RCVR          59460000
594700              MOVE PC238-PO-LNE-NBR   TO PC-DISPLAY-LINE          59470000
594800              MOVE PC238-WRKD-OPER-UNT-ID                         59480000
594900                                      TO PC-DISPLAY-OPER          59490000
595000              MOVE PC238-BAD-SQL-CDE  TO PC-DISPLAY-SQL-CODE      59500000
595100              MOVE PV-CICS-RESPONSE   TO PC-DISPLAY-CICS-RESP     59510000
595200              SET PS-UNITS-WORKED-ERROR  TO TRUE                  59520000
595300              STRING ' RCKCS279 - '      DELIMITED BY SIZE        59530000
595400                     ' 7800-UNITS-WORK-ROUTINE '                  59540000
595500                                         DELIMITED BY SIZE        59550000
595600                     ' BAD CALL TO UNITS WORKED MODULE '          59560000
595700                                         DELIMITED BY SIZE        59570000
595800                     ' - CICS RESP '                              59580000
595900                                         DELIMITED BY SIZE        59590000
596000                     PC-DISPLAY-CICS-RESP                         59600000
596100                                         DELIMITED BY SIZE        59610000
596200                                      INTO PV-CICS-MSG-AREA       59620000
596300              MOVE LENGTH OF PV-CICS-MSG-AREA                     59630000
596400                                        TO PV-COMMAREA-LENGTH     59640000
596500              PERFORM 9700-WRITE-TO-CICS-LOG                      59650000
596600              MOVE SPACES TO PV-CICS-MSG-AREA                     59660000
596700              STRING ' RCKCS279 - '      DELIMITED BY SIZE        59670000
596800                     ' 7800-UNITS-WORK-ROUTINE '                  59680000
596900                                         DELIMITED BY SIZE        59690000
597000                     ' KEY INFO - '      DELIMITED BY SIZE        59700000
597100                     PC-DISPLAY-PO       DELIMITED BY SIZE        59710000
597200                     ' - '               DELIMITED BY SIZE        59720000
597300                     PC-DISPLAY-RCVR     DELIMITED BY SIZE        59730000
597400                     ' - '               DELIMITED BY SIZE        59740000
597500                     PC-DISPLAY-LINE     DELIMITED BY SIZE        59750000
597600                                  INTO PV-CICS-MSG-AREA           59760000
597700              MOVE LENGTH OF PV-CICS-MSG-AREA                     59770000
597800                                    TO PV-COMMAREA-LENGTH         59780000
597900              PERFORM 9700-WRITE-TO-CICS-LOG                      59790000
598000              PERFORM 9900-SOFT-ABORT                             59800000
598100     END-EVALUATE.                                                59810000
598200                                                                  59820000
598300******************************************************************59830000
598400* THIS PARAGRAPH WILL MANAGE THE DISPLAY OF INFORMATION TO CSSL  *59840000
598500* FOR WHEN THE UNITS WORKED ROUTINE WAS UNSUCCESSFUL.  THIS      *59850000
598600* PARAGRAPH WILL FORMAT A MESSAGE AND GET IT WRITTEN TO THE      *59860000
598700* CICS LOG AND THEN SOFT ABORT THE PROGRAM.                      *59870000
598800******************************************************************59880000
598900 7810-MOD-UNSUCCESSFUL.                                           59890000
599000                                                                  59900000
599100     MOVE PC238-PO-NBR              TO PC-DISPLAY-PO.             59910000
599200     MOVE PC238-RCVR-SEQ-NBR        TO PC-DISPLAY-RCVR.           59920000
599300     MOVE PC238-PO-LNE-NBR          TO PC-DISPLAY-LINE.           59930000
599400     MOVE PC238-WRKD-OPER-UNT-ID    TO PC-DISPLAY-OPER.           59940000
599500     MOVE PC238-BAD-SQL-CDE         TO PC-DISPLAY-SQL-CODE.       59950000
599600     SET  PS-UNITS-WORKED-ERROR     TO TRUE.                      59960000
599700     SET  PS-UPDATES-DONE           TO TRUE.                      59970000
599800                                                                  59980000
599900     IF  PC238-MOD-BAD-TMST                                       59990000
600000         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60000000
600100                ' 7800-UNITS-WORK-ROUTINE '                       60010000
600200                                    DELIMITED BY SIZE             60020000
600300                ' BAD TIMESTAMP '   DELIMITED BY SIZE             60030000
600400                PC238-WRKD-TMST     DELIMITED BY SIZE             60040000
600500                             INTO PV-CICS-MSG-AREA                60050000
600600         MOVE LENGTH OF PV-CICS-MSG-AREA                          60060000
600700                               TO PV-COMMAREA-LENGTH              60070000
600800         PERFORM 9700-WRITE-TO-CICS-LOG                           60080000
600900         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60090000
601000                ' 7800-UNITS-WORK-ROUTINE '                       60100000
601100                                    DELIMITED BY SIZE             60110000
601200                ' KEY INFO - '      DELIMITED BY SIZE             60120000
601300                PC-DISPLAY-PO       DELIMITED BY SIZE             60130000
601400                ' - '               DELIMITED BY SIZE             60140000
601500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             60150000
601600                ' - '               DELIMITED BY SIZE             60160000
601700                PC-DISPLAY-LINE     DELIMITED BY SIZE             60170000
601800                             INTO PV-CICS-MSG-AREA                60180000
601900         MOVE LENGTH OF PV-CICS-MSG-AREA                          60190000
602000                               TO PV-COMMAREA-LENGTH              60200000
602100         PERFORM 9700-WRITE-TO-CICS-LOG                           60210000
602200         PERFORM 9900-SOFT-ABORT                                  60220000
602300     ELSE                                                         60230000
602400     IF  PC238-MOD-BAD-OPER                                       60240000
602500         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60250000
602600                ' 7800-UNITS-WORK-ROUTINE '                       60260000
602700                                    DELIMITED BY SIZE             60270000
602800                ' BAD OPER UNIT '   DELIMITED BY SIZE             60280000
602900                PC-DISPLAY-OPER     DELIMITED BY SIZE             60290000
603000                             INTO PV-CICS-MSG-AREA                60300000
603100         MOVE LENGTH OF PV-CICS-MSG-AREA                          60310000
603200                               TO PV-COMMAREA-LENGTH              60320000
603300         PERFORM 9700-WRITE-TO-CICS-LOG                           60330000
603400         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60340000
603500                ' 7800-UNITS-WORK-ROUTINE '                       60350000
603600                                    DELIMITED BY SIZE             60360000
603700                ' KEY INFO - '      DELIMITED BY SIZE             60370000
603800                PC-DISPLAY-PO       DELIMITED BY SIZE             60380000
603900                ' - '               DELIMITED BY SIZE             60390000
604000                PC-DISPLAY-RCVR     DELIMITED BY SIZE             60400000
604100                ' - '               DELIMITED BY SIZE             60410000
604200                PC-DISPLAY-LINE     DELIMITED BY SIZE             60420000
604300                             INTO PV-CICS-MSG-AREA                60430000
604400         MOVE LENGTH OF PV-CICS-MSG-AREA                          60440000
604500                               TO PV-COMMAREA-LENGTH              60450000
604600         PERFORM 9700-WRITE-TO-CICS-LOG                           60460000
604700         PERFORM 9900-SOFT-ABORT                                  60470000
604800     ELSE                                                         60480000
604900     IF  PC238-MOD-BAD-TRANS-TYPE                                 60490000
605000         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60500000
605100                ' 7800-UNITS-WORK-ROUTINE '                       60510000
605200                                    DELIMITED BY SIZE             60520000
605300                ' BAD TRAN TYPE '   DELIMITED BY SIZE             60530000
605400                PC238-TRANS-TYPE-CDE                              60540000
605500                                    DELIMITED BY SIZE             60550000
605600                             INTO PV-CICS-MSG-AREA                60560000
605700         MOVE LENGTH OF PV-CICS-MSG-AREA                          60570000
605800                               TO PV-COMMAREA-LENGTH              60580000
605900         PERFORM 9700-WRITE-TO-CICS-LOG                           60590000
606000         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60600000
606100                ' 7800-UNITS-WORK-ROUTINE '                       60610000
606200                                    DELIMITED BY SIZE             60620000
606300                ' KEY INFO - '      DELIMITED BY SIZE             60630000
606400                PC-DISPLAY-PO       DELIMITED BY SIZE             60640000
606500                ' - '               DELIMITED BY SIZE             60650000
606600                PC-DISPLAY-RCVR     DELIMITED BY SIZE             60660000
606700                ' - '               DELIMITED BY SIZE             60670000
606800                PC-DISPLAY-LINE     DELIMITED BY SIZE             60680000
606900                             INTO PV-CICS-MSG-AREA                60690000
607000         MOVE LENGTH OF PV-CICS-MSG-AREA                          60700000
607100                               TO PV-COMMAREA-LENGTH              60710000
607200         PERFORM 9700-WRITE-TO-CICS-LOG                           60720000
607300         PERFORM 9900-SOFT-ABORT                                  60730000
607400     ELSE                                                         60740000
607500     IF  PC238-MOD-BAD-PO                                         60750000
607600         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60760000
607700                ' 7800-UNITS-WORK-ROUTINE '                       60770000
607800                                    DELIMITED BY SIZE             60780000
607900                ' BAD PO NUMBER '   DELIMITED BY SIZE             60790000
608000                PC-DISPLAY-PO       DELIMITED BY SIZE             60800000
608100                             INTO PV-CICS-MSG-AREA                60810000
608200         MOVE LENGTH OF PV-CICS-MSG-AREA                          60820000
608300                               TO PV-COMMAREA-LENGTH              60830000
608400         PERFORM 9700-WRITE-TO-CICS-LOG                           60840000
608500         STRING ' RCKCS279 - '      DELIMITED BY SIZE             60850000
608600                ' 7800-UNITS-WORK-ROUTINE '                       60860000
608700                                    DELIMITED BY SIZE             60870000
608800                ' KEY INFO - '      DELIMITED BY SIZE             60880000
608900                PC-DISPLAY-PO       DELIMITED BY SIZE             60890000
609000                ' - '               DELIMITED BY SIZE             60900000
609100                PC-DISPLAY-RCVR     DELIMITED BY SIZE             60910000
609200                ' - '               DELIMITED BY SIZE             60920000
609300                PC-DISPLAY-LINE     DELIMITED BY SIZE             60930000
609400                             INTO PV-CICS-MSG-AREA                60940000
609500         MOVE LENGTH OF PV-CICS-MSG-AREA                          60950000
609600                               TO PV-COMMAREA-LENGTH              60960000
609700         PERFORM 9700-WRITE-TO-CICS-LOG                           60970000
609800         PERFORM 9900-SOFT-ABORT                                  60980000
609900     ELSE                                                         60990000
610000     IF  PC238-MOD-BAD-RCVR                                       61000000
610100         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61010000
610200                ' 7800-UNITS-WORK-ROUTINE '                       61020000
610300                                    DELIMITED BY SIZE             61030000
610400                ' BAD RCVR NBR  '   DELIMITED BY SIZE             61040000
610500                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61050000
610600                             INTO PV-CICS-MSG-AREA                61060000
610700         MOVE LENGTH OF PV-CICS-MSG-AREA                          61070000
610800                               TO PV-COMMAREA-LENGTH              61080000
610900         PERFORM 9700-WRITE-TO-CICS-LOG                           61090000
611000         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61100000
611100                ' 7800-UNITS-WORK-ROUTINE '                       61110000
611200                                    DELIMITED BY SIZE             61120000
611300                ' KEY INFO - '      DELIMITED BY SIZE             61130000
611400                PC-DISPLAY-PO       DELIMITED BY SIZE             61140000
611500                ' - '               DELIMITED BY SIZE             61150000
611600                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61160000
611700                ' - '               DELIMITED BY SIZE             61170000
611800                PC-DISPLAY-LINE     DELIMITED BY SIZE             61180000
611900                             INTO PV-CICS-MSG-AREA                61190000
612000         MOVE LENGTH OF PV-CICS-MSG-AREA                          61200000
612100                               TO PV-COMMAREA-LENGTH              61210000
612200         PERFORM 9700-WRITE-TO-CICS-LOG                           61220000
612300         PERFORM 9900-SOFT-ABORT                                  61230000
612400     ELSE                                                         61240000
612500     IF  PC238-MOD-BAD-LINE                                       61250000
612600         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61260000
612700                ' 7800-UNITS-WORK-ROUTINE '                       61270000
612800                                    DELIMITED BY SIZE             61280000
612900                ' BAD LINE NBR  '   DELIMITED BY SIZE             61290000
613000                PC-DISPLAY-LINE     DELIMITED BY SIZE             61300000
613100                             INTO PV-CICS-MSG-AREA                61310000
613200         MOVE LENGTH OF PV-CICS-MSG-AREA                          61320000
613300                               TO PV-COMMAREA-LENGTH              61330000
613400         PERFORM 9700-WRITE-TO-CICS-LOG                           61340000
613500         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61350000
613600                ' 7800-UNITS-WORK-ROUTINE '                       61360000
613700                                    DELIMITED BY SIZE             61370000
613800                ' KEY INFO - '      DELIMITED BY SIZE             61380000
613900                PC-DISPLAY-PO       DELIMITED BY SIZE             61390000
614000                ' - '               DELIMITED BY SIZE             61400000
614100                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61410000
614200                ' - '               DELIMITED BY SIZE             61420000
614300                PC-DISPLAY-LINE     DELIMITED BY SIZE             61430000
614400                             INTO PV-CICS-MSG-AREA                61440000
614500         MOVE LENGTH OF PV-CICS-MSG-AREA                          61450000
614600                               TO PV-COMMAREA-LENGTH              61460000
614700         PERFORM 9700-WRITE-TO-CICS-LOG                           61470000
614800         PERFORM 9900-SOFT-ABORT                                  61480000
614900     ELSE                                                         61490000
615000     IF  PC238-MOD-BAD-NO-SHIFT                                   61500000
615100         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61510000
615200                ' 7800-UNITS-WORK-ROUTINE '                       61520000
615300                                    DELIMITED BY SIZE             61530000
615400                ' SHIFT NOT FOUND ' DELIMITED BY SIZE             61540000
615500                PC238-WRKD-TMST     DELIMITED BY SIZE             61550000
615600                ' FOR OPER '        DELIMITED BY SIZE             61560000
615700                PC-DISPLAY-OPER     DELIMITED BY SIZE             61570000
615800                             INTO PV-CICS-MSG-AREA                61580000
615900         MOVE LENGTH OF PV-CICS-MSG-AREA                          61590000
616000                               TO PV-COMMAREA-LENGTH              61600000
616100         PERFORM 9700-WRITE-TO-CICS-LOG                           61610000
616200         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61620000
616300                ' 7800-UNITS-WORK-ROUTINE '                       61630000
616400                                    DELIMITED BY SIZE             61640000
616500                ' KEY INFO - '      DELIMITED BY SIZE             61650000
616600                PC-DISPLAY-PO       DELIMITED BY SIZE             61660000
616700                ' - '               DELIMITED BY SIZE             61670000
616800                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61680000
616900                ' - '               DELIMITED BY SIZE             61690000
617000                PC-DISPLAY-LINE     DELIMITED BY SIZE             61700000
617100                             INTO PV-CICS-MSG-AREA                61710000
617200         MOVE LENGTH OF PV-CICS-MSG-AREA                          61720000
617300                               TO PV-COMMAREA-LENGTH              61730000
617400         PERFORM 9700-WRITE-TO-CICS-LOG                           61740000
617500         PERFORM 9900-SOFT-ABORT                                  61750000
617600     ELSE                                                         61760000
617700         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61770000
617800                ' 7800-UNITS-WORK-ROUTINE '                       61780000
617900                                    DELIMITED BY SIZE             61790000
618000                ' DB ERROR - SQL CODE '                           61800000
618100                                    DELIMITED BY SIZE             61810000
618200                PC-DISPLAY-SQL-CODE DELIMITED BY SIZE             61820000
618300                ' FUNC: '           DELIMITED BY SIZE             61830000
618400                PC238-BAD-TABLE-FUNCTION                          61840000
618500                                    DELIMITED BY SIZE             61850000
618600                ' TABLE: '          DELIMITED BY SIZE             61860000
618700                PC238-BAD-TABLE-NAME                              61870000
618800                                    DELIMITED BY SIZE             61880000
618900                             INTO PV-CICS-MSG-AREA                61890000
619000         MOVE LENGTH OF PV-CICS-MSG-AREA                          61900000
619100                               TO PV-COMMAREA-LENGTH              61910000
619200         PERFORM 9700-WRITE-TO-CICS-LOG                           61920000
619300         STRING ' RCKCS279 - '      DELIMITED BY SIZE             61930000
619400                ' 7800-UNITS-WORK-ROUTINE '                       61940000
619500                                    DELIMITED BY SIZE             61950000
619600                ' KEY INFO - '      DELIMITED BY SIZE             61960000
619700                PC-DISPLAY-PO       DELIMITED BY SIZE             61970000
619800                ' - '               DELIMITED BY SIZE             61980000
619900                PC-DISPLAY-RCVR     DELIMITED BY SIZE             61990000
620000                ' - '               DELIMITED BY SIZE             62000000
620100                PC-DISPLAY-LINE     DELIMITED BY SIZE             62010000
620200                             INTO PV-CICS-MSG-AREA                62020000
620300         MOVE LENGTH OF PV-CICS-MSG-AREA                          62030000
620400                               TO PV-COMMAREA-LENGTH              62040000
620500         PERFORM 9700-WRITE-TO-CICS-LOG                           62050000
620600         PERFORM 9900-SOFT-ABORT                                  62060000
620700     END-IF                                                       62070000
620800     END-IF                                                       62080000
620900     END-IF                                                       62090000
621000     END-IF                                                       62100000
621100     END-IF                                                       62110000
621200     END-IF                                                       62120000
621300     END-IF.                                                      62130000
621400                                                                  62140000
621500******************************************************************62150000
621600* RECORD IN THE SELECTION TEMP STORAGE QUEUE THE FACT THAT THIS  *62160000
621700* OBJECT WAS UPDATED.                                            *62170000
621800******************************************************************62180000
621900 9000-UPDATE-SELECTION-QUEUE.                                     62190000
622000                                                                  62200000
622100     IF ASC-INTER-APPL-WO-LIST                                    62210000
622200         PERFORM 9300-READ-WO-SEL-QUEUE                           62220000
622300     ELSE                                                         62230000
622400         PERFORM 9100-READ-SEL-QUEUE                              62240000
622500     END-IF.                                                      62250000
622600                                                                  62260000
622700     IF ASC-INTER-APPL-WO-LIST                                    62270000
622800         SET PC016-UPD (ASC-SEL-SUB) TO TRUE                      62280000
622900         PERFORM 9400-REWRITE-WO-LIST-QUEUE                       62290000
623000     ELSE                                                         62300000
623100         SET RC013-UPD (ASC-SEL-SUB) TO TRUE                      62310000
623200         PERFORM 9200-REWRITE-LIST-QUEUE                          62320000
623300     END-IF.                                                      62330000
623400                                                                  62340000
623500/                                                                 62350000
623600******************************************************************62360000
623700* READ AN ITEM FROM THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *62370000
623800******************************************************************62380000
623900 9100-READ-SEL-QUEUE.                                             62390000
624000                                                                  62400000
624100     EXEC CICS                                                    62410000
624200         READQ TS                                                 62420000
624300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        62430000
624400             INTO  (RC013-DC-SELECT-RECORD)                       62440000
624500             ITEM  (ASC-SEL-ITEM)                                 62450000
624600             RESP  (PV-CICS-RESP)                                 62460000
624700     END-EXEC.                                                    62470000
624800                                                                  62480000
624900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        62490000
625000         CONTINUE                                                 62500000
625100     ELSE                                                         62510000
625200         SET DP013-LOGIC-ABEND                                    62520000
625300             DP013-NO-ROLLBACK   TO TRUE                          62530000
625400         MOVE '9100-READ-SEL-QUEUE'                               62540000
625500                                 TO DP013-PARAGRAPH               62550000
625600         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    62560000
625700                                 TO DP013-MESSAGE-TEXT (1)        62570000
625800         PERFORM DP013-0000-PROCESS-ABEND                         62580000
625900     END-IF.                                                      62590000
626000                                                                  62600000
626100/                                                                 62610000
626200******************************************************************62620000
626300* UPDATE AN ITEM IN THE INPUT SELECTED ITEMS TEMP STORAGE QUEUE. *62630000
626400******************************************************************62640000
626500 9200-REWRITE-LIST-QUEUE.                                         62650000
626600     EXEC CICS                                                    62660000
626700          WRITEQ TS                                               62670000
626800              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     62680000
626900              FROM    (RC013-DC-SELECT-RECORD)                    62690000
627000              ITEM    (ASC-SEL-ITEM)                              62700000
627100              RESP    (PV-CICS-RESP)                              62710000
627200              REWRITE                                             62720000
627300     END-EXEC.                                                    62730000
627400                                                                  62740000
627500     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    62750000
627600         SET DP013-CICS-ABEND                                     62760000
627700             DP013-NO-ROLLBACK   TO TRUE                          62770000
627800         MOVE '9200-REWRITE-LIST-QUEUE'                           62780000
627900                                 TO DP013-PARAGRAPH               62790000
628000         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   62800000
628100                                 TO DP013-MESSAGE-TEXT (1)        62810000
628200         PERFORM DP013-0000-PROCESS-ABEND                         62820000
628300     END-IF.                                                      62830000
628400/                                                                 62840000
628500******************************************************************62850000
628600* READ AN ITEM FROM THE INPUT SELECTED WORK ORDER ITEMS          *62860000
628700* TEMP STORAGE QUEUE.                                            *62870000
628800******************************************************************62880000
628900 9300-READ-WO-SEL-QUEUE.                                          62890000
629000                                                                  62900000
629100     EXEC CICS                                                    62910000
629200         READQ TS                                                 62920000
629300             QUEUE (ASC-SEL-QUEUE-NAME-IN)                        62930000
629400             INTO  (PC016-TS-SEL-REC)                             62940000
629500             ITEM  (ASC-SEL-ITEM)                                 62950000
629600             RESP  (PV-CICS-RESP)                                 62960000
629700     END-EXEC.                                                    62970000
629800                                                                  62980000
629900     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        62990000
630000         CONTINUE                                                 63000000
630100     ELSE                                                         63010000
630200         SET DP013-LOGIC-ABEND                                    63020000
630300             DP013-NO-ROLLBACK   TO TRUE                          63030000
630400         MOVE '9300-READ-WO-SEL-QUEUE'                            63040000
630500                                 TO DP013-PARAGRAPH               63050000
630600         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    63060000
630700                                 TO DP013-MESSAGE-TEXT (1)        63070000
630800         MOVE ASC-SEL-QUEUE-NAME-IN TO MSG-QUEUE-NAME             63080000
630900         MOVE ASC-SEL-ITEM       TO MSG-SEL-ITEM                  63090000
631000         MOVE MSG-QUEUE-ITEM     TO DP013-MESSAGE-TEXT (2)        63100000
631100         MOVE PC000-PO-NBR-N     TO MSG1-PO-NBR                   63110000
631200         MOVE PC000-REC-SEQ-NBR-N                                 63120000
631300                                 TO MSG1-REC-SEQ-NBR-N            63130000
631400         MOVE PC000-OPERATING-UNIT-ID                             63140000
631500                                 TO MSG1-OPER-UNT-ID              63150000
631600         MOVE PC000-FACILITY-ID  TO MSG1-FACILITY-ID              63160000
631700         MOVE MSG1-PO-REC        TO DP013-MESSAGE-TEXT (3)        63170000
631800         PERFORM DP013-0000-PROCESS-ABEND                         63180000
631900     END-IF.                                                      63190000
632000                                                                  63200000
632100/                                                                 63210000
632200******************************************************************63220000
632300* UPDATE AN ITEM IN THE INPUT SELECTED WORK ORDER ITEMS          *63230000
632400* TEMP STORAGE QUEUE.                                            *63240000
632500******************************************************************63250000
632600 9400-REWRITE-WO-LIST-QUEUE.                                      63260000
632700     EXEC CICS                                                    63270000
632800          WRITEQ TS                                               63280000
632900              QUEUE   (ASC-SEL-QUEUE-NAME-IN)                     63290000
633000              FROM    (PC016-TS-SEL-REC)                          63300000
633100              ITEM    (ASC-SEL-ITEM)                              63310000
633200              RESP    (PV-CICS-RESP)                              63320000
633300              REWRITE                                             63330000
633400     END-EXEC.                                                    63340000
633500                                                                  63350000
633600     IF PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                    63360000
633700         SET DP013-CICS-ABEND                                     63370000
633800             DP013-NO-ROLLBACK   TO TRUE                          63380000
633900         MOVE '9400-REWRITE-WO-LIST-QUEUE'                        63390000
634000                                 TO DP013-PARAGRAPH               63400000
634100         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   63410000
634200                                 TO DP013-MESSAGE-TEXT (1)        63420000
634300         PERFORM DP013-0000-PROCESS-ABEND                         63430000
634400     END-IF.                                                      63440000
634500/                                                                 63450000
634600******************************************************************63460000
634700* READ AN ITEM FROM THE INPUT TROUBLE RECORD                     *63470000
634800* TEMP STORAGE QUEUE.                                            *63480000
634900******************************************************************63490000
635000 9500-READ-TRB-QUEUE.                                             63500000
635100                                                                  63510000
635200     EXEC CICS                                                    63520000
635300         READQ TS                                                 63530000
635400             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        63540000
635500             INTO  (TM003-TRB-QUEUE-WORK-AREA)                    63550000
635600             ITEM  (PC-01-COMP)                                   63560000
635700             RESP  (PV-CICS-RESP)                                 63570000
635800     END-EXEC.                                                    63580000
635900                                                                  63590000
636000     IF PV-CICS-RESP EQUAL DFHRESP(NORMAL)                        63600000
636100         CONTINUE                                                 63610000
636200     ELSE                                                         63620000
636300         SET DP013-LOGIC-ABEND                                    63630000
636400             DP013-NO-ROLLBACK   TO TRUE                          63640000
636500         MOVE '9500-READ-TRB-QUEUE'                               63650000
636600                                 TO DP013-PARAGRAPH               63660000
636700         MOVE 'ATTEMPTING TO READ TO LIST SELECTIONS TS QUEUE'    63670000
636800                                 TO DP013-MESSAGE-TEXT (1)        63680000
636900         MOVE ASC-TRB-QUEUE-NAME-IN TO MSG-QUEUE-NAME             63690000
637000         MOVE ASC-SEL-ITEM       TO MSG-SEL-ITEM                  63700000
637100         MOVE MSG-QUEUE-ITEM     TO DP013-MESSAGE-TEXT (2)        63710000
637200         MOVE RC017-PO-NBR       TO MSG1-PO-NBR                   63720000
637300         MOVE RC017-REC-SEQ-NBR                                   63730000
637400                                 TO MSG1-REC-SEQ-NBR-N            63740000
637500         MOVE RC017-OPER-UNT-ID                                   63750000
637600                                 TO MSG1-OPER-UNT-ID              63760000
637700         MOVE RC017-FCLTY-ID     TO MSG1-FACILITY-ID              63770000
637800         MOVE MSG1-PO-REC        TO DP013-MESSAGE-TEXT (3)        63780000
637900         PERFORM DP013-0000-PROCESS-ABEND                         63790000
638000     END-IF.                                                      63800000
638100                                                                  63810000
638200/                                                                 63820000
638300 9600-WRITE-TRB-QUEUE.                                            63830000
638400                                                                  63840000
638500*  RCKCS277 WRITES ONLY 1 QUEUE RECORD SO THE ITEM NUMBER         63850000
638600*  WILL ALWAYS EQUAL 1.                                           63860000
638700     EXEC CICS WRITEQ TS                                          63870000
638800             QUEUE (ASC-TRB-QUEUE-NAME-IN)                        63880000
638900             FROM  (TM003-TRB-QUEUE-WORK-AREA)                    63890000
639000             ITEM  (PC-01-COMP)                                   63900000
639100             RESP  (PV-CICS-RESP)                                 63910000
639200             REWRITE                                              63920000
639300     END-EXEC.                                                    63930000
639400                                                                  63940000
639500     IF PV-CICS-RESP NOT = DFHRESP (NORMAL)                       63950000
639600         SET DP013-CICS-ABEND                                     63960000
639700             DP013-NO-ROLLBACK   TO TRUE                          63970000
639800         MOVE '9600-WRITE-TRB-QUEUE'                              63980000
639900                                 TO DP013-PARAGRAPH               63990000
640000         MOVE 'UNSUCCESSFUL LIST ITEMS TEMP STORAGE QUEUE REWRITE'64000000
640100                                 TO DP013-MESSAGE-TEXT(1)         64010000
640200         PERFORM DP013-0000-PROCESS-ABEND                         64020000
640300     END-IF.                                                      64030000
640400*----------------------------------------------------------------*64040000
640500 9700-WRITE-TO-CICS-LOG.                                          64050000
640600                                                                  64060000
640700     EXEC CICS                                                    64070000
640800          WRITEQ TD                                               64080000
640900          QUEUE  ('CSSL')                                         64090000
641000          FROM  (PV-CICS-MSG-AREA)                                64100000
641100          LENGTH  (PV-COMMAREA-LENGTH)                            64110000
641200          RESP  (PV-CICS-RESP)                                    64120000
641300     END-EXEC.                                                    64130000
641400                                                                  64140000
641500     MOVE SPACES TO PV-CICS-MSG-AREA.                             64150000
641600                                                                  64160000
641700******************************************************************64170000
641800*    THE DB2 RESOURCE IS NOT AVAILABLE, SET THE ERROR MESSAGE    *64180000
641900*    AND THE ERROR SWITCHES.                                     *64190000
642000******************************************************************64200000
642100 9900-SOFT-ABORT.                                                 64210000
642200     SET PS-ERROR         TO TRUE.                                64220000
642300     SET DP020-MSG-FATAL  TO TRUE.                                64230000
642400                                                                  64240000
642500     IF  PS-UNITS-WORKED-ERROR                                    64250000
642600         MOVE PC-TSYMSG-02875 TO DP020-MSG-NUMBER                 64260000
642700     ELSE                                                         64270000
642800         MOVE PC-TSYMSG-00551 TO DP020-MSG-NUMBER                 64280000
642900     END-IF.                                                      64290000
643000                                                                  64300000
643100     IF PS-NO-NEXT-SCREEN                                         64310000
643200        SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                     64320000
643300     END-IF.                                                      64330000
643400     PERFORM 9901-BACKUP.                                         64340000
643500     MOVE 'PROGRAM EXIT CALL' TO DP013-MESSAGE-TEXT (1).          64350000
643600     PERFORM 0001-CALL-CICS-ARCH-API.                             64360000
643700                                                                  64370000
643800 9901-BACKUP.                                                     64380000
643900     EXEC CICS SYNCPOINT                                          64390000
644000          ROLLBACK                                                64400000
644100     END-EXEC.                                                    64410000
644200                                                                  64420000
644300/                                                                 64430000
644400*----------------------------------------------------------------*64440000
644500*    CURRENT SYSTEM DATE/TIME MODULE                              64450000
644600*----------------------------------------------------------------*64460000
644700                                                                  64470000
644800     COPY DPPD017.                                                64480005
644900                                                                  64490000
645000******************************************************************64500000
645100*    ABEND PROCESSING                                             64510000
645200******************************************************************64520000
645300     COPY DPPD013.                                                64530005
