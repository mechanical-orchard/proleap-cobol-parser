000100*-----------------------*                                         00010001
000200 IDENTIFICATION DIVISION.                                         00020001
000210*-----------------------*                                         00021001
000220 PROGRAM-ID.    SUKCS773.                                         00022001
000230 AUTHOR.        CHRISTINE TWIEHAUS                                00023001
000240 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00024001
000250 DATE-WRITTEN.  NOVEMBER, 2008.                                   00025001
000260 DATE-COMPILED.                                                   00026001
000270                                                                  00027001
000280*---------------------------------------------------------------* 00028001
000290*    S773 - DIRECTIVE CARTON HISTORY LIST                       * 00029001
000300*---------------------------------------------------------------* 00030001
000300*-CHANGE BY: CHERI PARMLEY  DATE: 01/25/2014                    * 00031099
000300*            ADDED CODE BEGINNING AT 4305- TO CHECK FOR WHAT    * 00031199
000300*            TYPE OF AUDIT IS BEING DONE. ADDED AUDIT TYPE TO   * 00031299
000300*            SCREEN. IF A COMBO AUDIT HIGHLIGHT THE SML/P2L DEST* 00031399
000300*            CARTON WHEN BOTH THE RFID AND QC ARE FAILED. THIS  * 00031499
000300*            CODE BEGINS AT 4307- THRU 4308A-.                  * 00031599
000300*---------------------------------------------------------------* 00032099
263968* CHANGED 11/15/2021    BY JIM HUNTER      WR: CHG0263968         00034099
263968* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00035099
263968* MAKING THE CALL DYNAMIC VS STATIC.                              00036099
001130*                                                                 00036199
001110* CHANGED 01/09/2023    BY JEAN KURK       WR: CHG0278099         00036299
001120* CHANGE CALL OF DPKCS030 TO BE DYNAMIC                           00036399
263968*---------------------------------------------------------------* 00037099
000400 ENVIRONMENT DIVISION.                                            00040001
000500 DATA DIVISION.                                                   00050001
000600                                                                  00060001
000700 WORKING-STORAGE SECTION.                                         00070001
000800                                                                  00080001
000900 01  DK-DB2-KEYS.                                                 00090001
001000     05  DK-OPER-UNT-ID            PIC S9(04) COMP VALUE +0.      00100001
001100     05  DK-LGCL-LOC-NM            PIC X(32)       VALUE SPACES.  00110099
001101     05  DK-LOC-SENT-DESC          PIC X(04)       VALUE SPACES.  00110199
001110     05  DK-TYPE-CODE              PIC X(02)       VALUE SPACES.  00111099
001200     05  DK-CART-ID                PIC X(22)       VALUE SPACES.  00120051
001300     05  DK-CART-ID-PACKED         PIC S9(18) COMP-3              00130013
001310                                                   VALUE ZEROS.   00131064
001400     05  DK-SHIPT-UNT-ID           PIC X(18)       VALUE SPACES.  00140068
001500     05  DK-SHIPT-UNT-ID-PACKED    PIC S9(18) COMP-3              00150064
001700                                                   VALUE ZEROS.   00170006
001710     05  DK-AUDIT-NO               PIC  X(09).                    00171021
001720                                                                  00172071
001721     05  DK-PO-NUMBER              PIC S9(9) COMP  VALUE ZERO.    00172171
001723     05  DK-RCVR-NUMBER            PIC S9(3) COMP  VALUE ZERO.    00172371
001724                                                                  00172499
001725     05  DK-DIR-TYPE-NM.                                          00172599
001726         10  DK-DIR-TYPE-NM-1      PIC X(01).                     00172699
001727         10  FILLER                PIC X(05).                     00172799
001730                                                                  00173071
001800 01  PC-PROGRAM-CONSTANTS.                                        00180001
001900     05  PC-CURRENT-MAP-NAME       PIC  X(08)  VALUE 'SUK773  '.  00190001
002000     05  PC-CURRENT-MAPSET-NAME    PIC  X(08)  VALUE 'SUKM773 '.  00200001
002100     05  PC-CURRENT-PROGRAM-NAME   PIC  X(08)  VALUE 'SUKCS773'.  00210001
002200     05  PC-APPL-MAP               PIC S9(04)  VALUE  +1          00220001
002300                                                     COMP.        00230001
002400     05  PC-LIST-QUEUE-SEQ         PIC  9(01)  VALUE 1.           00240001
002500     05  PC-SEL-QUEUE-SEQ          PIC  9(01)  VALUE 2.           00250001
002600     05  PC-CRIT-SPEC-FORMAT       PIC  X(01)  VALUE '1'.         00260001
002700     05  PC-DETAIL-SCREEN          PIC  X(01)  VALUE '2'.         00270001
002710     05  PC-LIST-FORMAT            PIC  X(01)  VALUE '2'.         00271091
002800     05  PC-ITEMS-PER-PANEL        PIC S9(04)  VALUE +9           00280099
002900                                               COMP SYNC.         00290001
003000     05  PC-MAX-BLOCKS-IN-ARRAY    PIC S9(04)  VALUE +2           00300001
003100                                               COMP SYNC.         00310001
003200     05  PC-MAX-ITEMS              PIC S9(09)  VALUE +1000000     00320001
003300                                               COMP-3.            00330001
003400     05  PC-MSG-NUMBER-LENGTH      PIC S9(04)  VALUE +5           00340001
003500                                               COMP SYNC.         00350001
003501     05  PC-MAX-RETRIES            PIC S9(03)  VALUE 3            00350119
003502                                               COMP-3.            00350219
003510     05  PC-INQ                    PIC  X(03)  VALUE 'INQ'.       00351019
003520     05  PC-CART                   PIC  X(04)  VALUE 'CART'.      00352019
003530     05  PC-01                     PIC  X(02)  VALUE '01'.        00353019
003540     05  PC-A                      PIC  X(01)  VALUE 'A'.         00354019
003550     05  PC-D                      PIC  X(01)  VALUE 'D'.         00355019
003560     05  PC-S                      PIC  X(01)  VALUE 'S'.         00356019
003570     05  PC-U                      PIC  X(01)  VALUE 'U'.         00357019
003570     05  PC-F                      PIC  X(01)  VALUE 'F'.         00357199
003570     05  PC-RF                     PIC  X(02)  VALUE 'RF'.        00357299
003580     05  PC-MULTI                  PIC  X(05)  VALUE 'MULTI'.     00358019
      *CLP 01/25/14 - START                                             00358199
003580     05  PC-MAN-AUDT               PIC  X(09)  VALUE 'MAN AUDT '. 00358299
003580     05  PC-QC-AUDIT               PIC  X(09)  VALUE 'QC AUDIT '. 00358399
003580     05  PC-RFID-AUDT              PIC  X(09)  VALUE 'RFID AUDT'. 00358499
      *CLP 01/25/14 - END                                               00358599
003581                                                                  00358699
003582     05  PC-MULTIPLE-SKU-PPK       PIC  X(21)  VALUE              00358799
003583         'M - MULTI SKU PREPACK'.                                 00358899
003584     05  PC-SINGLE-SKU-PPK         PIC  X(22)  VALUE              00358999
003585         'S - SINGLE SKU PREPACK'.                                00359099
003586     05  PC-INNER-PPK              PIC  X(17)  VALUE              00359199
003587         'I - INNER PREPACK'.                                     00359299
003588     05  PC-BULK-PPK               PIC  X(13)  VALUE              00359399
003589         'B - BULK PACK'.                                         00359499
003590     05  PC-CASEPACK               PIC  X(12)  VALUE              00359599
003591         'C - CASEPACK'.                                          00359699
003592     05  PC-PBS                    PIC  X(13)  VALUE              00359799
003593         'PACK BY STORE'.                                         00359899
003594                                                                  00359999
003595     05  WS-TIMESTAMP.                                            00360099
003596         10  WS-DATE-YEAR-DASH            PIC  X(05).             00360199
003597         10  WS-DATE.                                             00360299
003598             15  WS-DATE-MONTH            PIC  X(02).             00360399
003599             15  WS-DASH1                 PIC  X(01).             00360499
003600             15  WS-DATE-DAY              PIC  X(02).             00360599
003601         10  WS-FILLER                    PIC  X(01).             00360699
003602         10  WS-TIME.                                             00360799
003603             15  WS-TIME-HH               PIC  X(02).             00360899
003604             15  WS-COLON1                PIC  X(01).             00360999
003605             15  WS-TIME-MM               PIC  X(02).             00361099
003606             15  WS-COLON2                PIC  X(01).             00361199
003607             15  WS-TIME-SS               PIC  X(02).             00361299
003608         10  FILLER                       PIC  X(07).             00362099
004220                                                                  00422019
004230*----------------------------------------------------------------*00423001
004240*  SYSTEM MESSAGES                                               *00424001
004250*----------------------------------------------------------------*00425001
004260*   00005 = INVALID VALUE                                        *00426001
004270*   00008 = MUST BE NUMERIC                                      *00427001
004280*   00050 - NO LIST ITEMS WERE FOUND FOR THE CRITERIA SPECIFIED  *00428001
004290*   00051 - NO END OF RANGE HAS BEEN SPECIFIED                   *00429001
004300*   00052 - END OF RANGE PRECEDES START OF RANGE                 *00430001
004400*   00053 - NO START OF RANGE HAS BEEN SPECIFIED                 *00440001
004500*   00054 - ONLY ONE START OF RANGE INDICATOR MAY BE SPECIFIED   *00450001
004600*   00055 - ONLY ONE END OF RANGE INDICATOR MAY BE SPECIFIED     *00460001
004700*   00057 - A LIST ITEM MUST BE SELECTED FOR THIS FUNCTION       *00470001
004800*   00069 - TOP OF LIST                                          *00480001
004900*   00070 - BOTTOM OF LIST                                       *00490001
005000*   00101 - VALUE MUST BE > ZERO AND  < 1,000,000                *00500001
005100*   00279 - MORE ITEMS TO DISPLAY                                *00510001
005200*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00520001
005300*   02575 - STORE ASSIGNMNT FUNCTION ONLY VALID FOR CART TYPES SHI00530001
005400*----------------------------------------------------------------*00540001
005500     05  PC-TSYMSG-NUMBERS.                                       00550001
005600         10  PC-TSYMSG-00005            PIC  9(05)  VALUE 00005.  00560001
005700         10  PC-TSYMSG-00008            PIC  9(05)  VALUE 00008.  00570001
005710         10  PC-TSYMSG-00045            PIC  9(05)  VALUE 00045.  00571099
005800         10  PC-TSYMSG-00050            PIC  9(05)  VALUE 00050.  00580001
005900         10  PC-TSYMSG-00051            PIC  9(05)  VALUE 00051.  00590001
006000         10  PC-TSYMSG-00052            PIC  9(05)  VALUE 00052.  00600001
006100         10  PC-TSYMSG-00053            PIC  9(05)  VALUE 00053.  00610001
006200         10  PC-TSYMSG-00054            PIC  9(05)  VALUE 00054.  00620001
006300         10  PC-TSYMSG-00055            PIC  9(05)  VALUE 00055.  00630001
006400         10  PC-TSYMSG-00057            PIC  9(05)  VALUE 00057.  00640001
006500         10  PC-TSYMSG-00069            PIC  9(05)  VALUE 00069.  00650001
006600         10  PC-TSYMSG-00070            PIC  9(05)  VALUE 00070.  00660001
006700         10  PC-TSYMSG-00101            PIC  9(05)  VALUE 00101.  00670001
006800         10  PC-TSYMSG-00279            PIC  9(05)  VALUE 00279.  00680001
006900         10  PC-TSYMSG-02571            PIC  9(05)  VALUE 02571.  00690001
007000         10  PC-TSYMSG-02575            PIC  9(05)  VALUE 02575.  00700001
007100*                                                                 00710001
007200 01  PS-PROGRAM-SWITCHES.                                         00720001
007300     05  PS-ERROR-SW                    PIC  X(01)  VALUE 'Y'.    00730001
007400         88  PS-NO-ERROR                            VALUE 'Y'.    00740001
007500         88  PS-ERROR                               VALUE 'N'.    00750001
007600     05  PS-BLOCK-ERROR-SW              PIC  X(01)  VALUE 'Y'.    00760001
007700         88  PS-NO-BLOCK-ERROR                      VALUE 'Y'.    00770001
007800         88  PS-BLOCK-ERROR                         VALUE 'N'.    00780001
007900     05  PS-CONFIRM-PROCESSING-IND      PIC  X(01)  VALUE  'N'.   00790001
008000         88  PS-CONFIRM-PROCESSING                  VALUE  'Y'.   00800001
008100         88  PS-NOT-CONFIRM-PROCESSING              VALUE  'N'.   00810001
008200     05  PS-SOFT-ABORT-ERROR-SW         PIC  X(01)  VALUE 'N'.    00820001
008300         88  PS-SOFT-ABORT-ERROR                    VALUE 'Y'.    00830001
008400         88  PS-NO-SOFT-ABORT-ERROR                 VALUE 'N'.    00840001
008500     05  PS-COMMAREA-SW                 PIC  X(01)  VALUE 'N'.    00850001
008600         88  PS-COMMAREA-VALID                      VALUE 'Y'.    00860001
008700         88  PS-COMMAREA-NOT-VALID                  VALUE 'N'.    00870001
008800     05  PS-LIST-END-SW                 PIC  X(01)  VALUE 'N'.    00880001
008900         88  PS-LIST-END                            VALUE 'Y'.    00890001
009000         88  PS-NO-LIST-END                         VALUE 'N'.    00900001
008800     05  PS-AUDIT-TYPE-SW               PIC  X(01)  VALUE ' '.    00901099
008900         88  PS-MANUAL-AUDIT                        VALUE 'M'.    00902099
009000         88  PS-QC-AUDIT                            VALUE 'Q'.    00903099
009000         88  PS-RFID-AUDIT                          VALUE 'R'.    00904099
008800     05  PS-AUDIT-COMBO-SW              PIC  X(01)  VALUE 'N'.    00905099
008900         88  PS-COMBO-AUDIT                         VALUE 'Y'.    00906099
008900         88  PS-NOT-COMBO-AUDIT                     VALUE 'Y'.    00907099
008800     05  PS-HIGHLIGHT-CARTON-SW         PIC  X(01)  VALUE 'N'.    00908099
008900         88  PS-HIGHLIGHT-CARTON                    VALUE 'Y'.    00909099
008900         88  PS-NOT-HIGHLIGHT-CARTON                VALUE 'N'.    00909199
009100                                                                  00910073
009101     05  PS-PKGNG-CD                 PIC  X(01).                  00910173
009102         88  PS-PRE-PACK-ORDER            VALUE 'I', 'M'.         00910273
009103         88  PS-INNER-PREPK                    VALUE 'I'.         00910373
009104         88  PS-MULTI-SKU-PREPK                VALUE 'M'.         00910473
009105         88  PS-SINGLE-SKU-PREPK               VALUE 'S'.         00910573
009106         88  PS-CASEPACK                       VALUE 'C'.         00910673
009107         88  PS-BULK-PACK                      VALUE 'B'.         00910773
009108         88  PS-PBS                            VALUE ' '.         00910873
009110                                                                  00911073
009200 01  PV-PROGRAM-VARIABLES.                                        00920001
      *CLP 01/25/14                                                     00920199
006561     05  PV-NULL-IND                    PIC S9(4)   VALUE ZERO    00921099
006562                                                     COMP SYNC.   00922099
009300     05  PV-CICS-RESPONSE               PIC S9(08)  VALUE ZEROES  00930001
009400                                        COMP SYNC.                00940001
009500     05  PV-SUB                         PIC S9(04)  VALUE +0      00950001
009600                                                    COMP SYNC.    00960001
009700     05  PV-REMAINDER                   PIC S9(04)  VALUE +0      00970001
009800                                                    COMP SYNC.    00980001
009900     05  PV-READ-COUNT                  PIC S9(09)  VALUE +0      00990001
010000                                                    COMP-3.       01000001
010100     05  PV-ITEMS-PROCESSED             PIC S9(09)  VALUE +0      01010001
010200                                                    COMP-3.       01020001
010300     05  PV-HOLD-SELECTED-ITEMS         PIC S9(09)  VALUE +0      01030001
010400                                                    COMP-3.       01040001
010500     05  PV-ITEM-IN-USE                 PIC S9(09)  VALUE +0      01050001
010600                                                    COMP-3.       01060001
010700     05  PV-TOP-ITEM                    PIC S9(09)  VALUE +0      01070001
010800                                                    COMP-3.       01080001
010900     05  PV-BOTTOM-ITEM                 PIC S9(09)  VALUE +0      01090001
011000                                                    COMP-3.       01100001
011100     05  PV-TEMP-BLOCK-NUMBER           PIC S9(09)  VALUE +0      01110001
011200                                                    COMP-3.       01120001
011300     05  PV-BLOCK-NUMBER                PIC S9(04)  VALUE +0      01130001
011400                                                    COMP SYNC.    01140001
011500     05  PV-CICS-RESP                   PIC S9(04)  VALUE +0      01150001
011600                                                    COMP SYNC.    01160001
011700     05  PV-ITEM                        PIC S9(04)  VALUE +0      01170001
011800                                                    COMP SYNC.    01180001
011900     05  PV-SEL-QUEUE-ITEM              PIC S9(04)  VALUE +0      01190001
012000                                                    COMP SYNC.    01200001
012100     05  PV-SAVE-ITEM                   PIC S9(04)  VALUE +0      01210001
012200                                                    COMP SYNC.    01220001
012300     05  PV-HIGHEST-BLOCK-WRITTEN       PIC S9(04)  VALUE +0      01230001
012400                                                    COMP SYNC.    01240001
012500     05  PV-LIST-ITEM-NUMBER            PIC S9(04)  VALUE +0      01250001
012600                                                    COMP SYNC.    01260001
012700     05  PV-FIRST-BLOCK-IN-ARRAY        PIC S9(04)  VALUE +0      01270001
012800                                                    COMP SYNC.    01280001
012900     05  PV-NEXT-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01290001
013000                                                    COMP SYNC.    01300001
013100     05  PV-PREV-BLOCK-IN-ARRAY         PIC S9(04)  VALUE +0      01310001
013200                                                    COMP SYNC.    01320001
013300     05  PV-FIRST-BLOCK-IN-RANGE        PIC S9(04)  VALUE +0      01330001
013400                                                    COMP SYNC.    01340001
013500     05  PV-LAST-BLOCK-IN-RANGE         PIC S9(04)  VALUE +0      01350001
013600                                                    COMP SYNC.    01360001
013700     05  PV-START-OF-SELECTED-RANGE     PIC S9(04)  VALUE +0      01370001
013800                                                    COMP SYNC.    01380001
013900     05  PV-END-OF-SELECTED-RANGE       PIC S9(04)  VALUE +0      01390001
014000                                                    COMP SYNC.    01400001
014100     05  PV-RETRY-COUNTER               PIC S9(04)  VALUE +0      01410001
014200                                                    COMP SYNC.    01420001
014300     05  PV-SOFT-ABORT-MSG.                                       01430001
014400         10  FILLER            PIC X(12) VALUE ' SUKCS773 - '.    01440001
014500         10  FILLER            PIC X(09) VALUE 'SQLCODE: '.       01450001
014600         10  PV-SOFT-SQLCODE   PIC ZZZZZZZZ9-.                    01460001
014700         10  FILLER            PIC X(12) VALUE ' PARAGRAPH: '.    01470001
014800         10  PV-SOFT-PARAGRAPH PIC X(30).                         01480001
014900     05  PV-COMMAREA-LENGTH              PIC S9(04)  VALUE +0     01490001
015000                                                     COMP SYNC.   01500001
015100     05  PV-CICS-MSG-AREA                PIC  X(80)  VALUE SPACE. 01510001
015200     05  PV-CICS-MSG-AREA2               PIC  X(100) VALUE SPACE. 01520001
015300     05  PV-CICS-MSG-HOLD.                                        01530001
015400         10  FILLER                      PIC  X(01)  VALUE SPACE. 01540001
015500         10  PV-CICS-MSG-DATA            PIC  X(79)  VALUE SPACE. 01550001
015600     05  PV-CICS-MSG-HOLD2.                                       01560001
015700         10  FILLER                      PIC  X(01)  VALUE SPACE. 01570001
015800         10  PV-CICS-MSG-DATA2           PIC  X(99)  VALUE SPACE. 01580001
015900                                                                  01590001
016000     05  PV-ORIGINAL-BLOCK               PIC S9(04)  VALUE +0     01600001
016100                                                     COMP SYNC.   01610001
016200     05  PV-ITEMS-HOLD                   PIC S9(03)  COMP-3.      01620001
016300     05  PV-ITEMS-DIFF                   PIC S9(03)  COMP-3.      01630001
016400     05  PV-CASE-NBR                     PIC  X(10).              01640001
016500     05  PV-UNION-TYPE                   PIC  X(01) VALUE SPACE.  01650001
016510     05  PV-NAME                         PIC  X(30).              01651082
016520     05  PV-NAME-TRUNCATE REDEFINES PV-NAME.                      01652082
      *CLP 01/25/14                                                     01652199
016530         10  PV-NAME-15                  PIC  X(15).              01653099
016540         10  FILLER                      PIC  X(15).              01654099
021224     05  PV-AUD-STAT-CDE                 PIC  X(01) VALUE SPACE.  01655099
016600                                                                  01660001
016700******************************************************************01670001
016800**  THIS IS THE LAYOUT FOR THE LIST ITEMS TEMP STORAGE QUEUE.   **01680001
016900**  THIS MUST BE THE EXACT SAME FORMAT AS BLOCK IN THE          **01690001
017000**  APPLICATION-SPECIFIC COMMAREA.                              **01700001
017100******************************************************************01710001
017200 01  LQW-LIST-QUEUE-WORK-AREA.                                    01720001
017300     05  LQW-BLOCK-MODIFIED             PIC  X(01)  VALUE SPACE.  01730001
017400     05  LQW-ITEM-ENTRIES               OCCURS 11 TIMES           01740001
017500                                        INDEXED BY LQW-IDX.       01750001
017600         10  LQW-LIST-ITEM-NUMBER       PIC S9(09)  COMP-3.       01760001
017700         10  LQW-TEMP-SELECTED-SW       PIC  X(01).               01770001
017800         10  LQW-SELECTED-SW            PIC  X(01).               01780001
017900             88  LQW-SELECT                         VALUE 'S'.    01790001
018000             88  LQW-DESELECT                       VALUE ' '.    01800001
018100         10  LQW-ACTION                 PIC  X(03).               01810028
018200             88  LQW-ADD                            VALUE 'ADD'.  01820028
018300             88  LQW-INQ                            VALUE 'INQ'.  01830028
018400             88  LQW-UPD                            VALUE 'UPD'.  01840028
018500             88  LQW-ERR                            VALUE 'ERR'.  01850028
018600         10  LQW-AUDIT-NUMBER           PIC  X(09).               01860004
      *CLP 01/25/14                                                     01861099
018700         10  LQW-AUDIT-TYPE             PIC  X(09).               01870099
018700         10  LQW-FAIL-RSN-CODE          PIC  X(04).               01871099
018800         10  LQW-DIR-TYPE               PIC  X(01).               01880004
018810         10  LQW-DIR-CODE               PIC  X(03).               01881004
018900         10  LQW-LOC-SENT               PIC  X(04).               01890004
019000*        10  LQW-DIVERT-LOC             PIC  X(04).               01900099
019110         10  LQW-CREATE-TIME            PIC  X(05).               01911004
019120         10  LQW-CREATE-DATE            PIC  X(08).               01912099
019200         10  LQW-CASI                   PIC  X(01).               01920004
019210         10  LQW-USER-ID                PIC  X(08).               01921004
019220         10  LQW-USER-NAME              PIC  X(15).               01922099
019300                                                                  01930001
019400*---------------------------------------------------------------* 01940001
019500* SELECTION QUEUE LAYOUT                                        * 01950001
019600*---------------------------------------------------------------* 01960001
019700     COPY SUWS102.                                                01970001
019800                                                                  01980001
019810*----------------------------------------------------------------*01981083
019820***  LAYOUT FOR THE TEMP ASSOC INFO SUBROUTINE                    01982083
019821***      USED TO GET ASSOCIATE'S NAME                             01982183
019830*----------------------------------------------------------------*01983083
019840     COPY XLWS067.                                                01984083
019850                                                                  01985083
019900*---------------------------------------------------------------* 01990001
020000*    MAP LAYOUT                                                 * 02000001
020100*---------------------------------------------------------------* 02010001
020200     COPY SUKM773.                                                02020008
020300*                                                                 02030001
020400 01  MR-OCCURS-LAYOUT                   REDEFINES  SUK773O.       02040009
020500     05  FILLER                         PIC X(144).               02050099
020600     05  MR-SCROLL-AREA                 OCCURS 11 TIMES.          02060008
021800                                                                  02180007
021900         10  MR-AUDIT-NO-IDL           PIC S9(04) COMP.           02190008
022000         10  MR-AUDIT-NO-IDA           PIC  X(01).                02200008
022100         10  MR-AUDIT-NO-IDC           PIC  X(01).                02210008
022200         10  MR-AUDIT-NO-IDH           PIC  X(01).                02220008
022300         10  MR-AUDIT-NO-ID            PIC  X(09).                02230008
022400                                                                  02240007
      *CLP 01/25/14 - START                                             02240199
021900         10  MR-AUDIT-TYPL             PIC S9(04) COMP.           02241099
022000         10  MR-AUDIT-TYPA             PIC  X(01).                02242099
022100         10  MR-AUDIT-TYPC             PIC  X(01).                02243099
022200         10  MR-AUDIT-TYPH             PIC  X(01).                02244099
022300         10  MR-AUDIT-TYP              PIC  X(09).                02245099
      *CLP 01/25/14 - END                                               02245199
022400                                                                  02246099
022500         10  MR-FAIL-RSNL              PIC S9(04) COMP.           02250009
022600         10  MR-FAIL-RSNA              PIC  X(01).                02260009
022700         10  MR-FAIL-RSNC              PIC  X(01).                02270009
022800         10  MR-FAIL-RSNH              PIC  X(01).                02280009
022900         10  MR-FAIL-RSN               PIC  X(04).                02290009
023000                                                                  02300007
023100         10  MR-TYPEL                  PIC S9(04) COMP.           02310009
023200         10  MR-TYPEA                  PIC  X(01).                02320009
023300         10  MR-TYPEC                  PIC  X(01).                02330009
023400         10  MR-TYPEH                  PIC  X(01).                02340009
023500         10  MR-TYPE                   PIC  X(01).                02350009
023600                                                                  02360007
023700         10  MR-DIR-CODEL              PIC S9(04) COMP.           02370009
023800         10  MR-DIR-CODEA              PIC  X(01).                02380009
023900         10  MR-DIR-CODEC              PIC  X(01).                02390009
024000         10  MR-DIR-CODEH              PIC  X(01).                02400009
024100         10  MR-DIR-CODE               PIC  X(03).                02410009
024200                                                                  02420007
024300         10  MR-LOC-SENTL              PIC S9(04) COMP.           02430009
024400         10  MR-LOC-SENTA              PIC  X(01).                02440009
024500         10  MR-LOC-SENTC              PIC  X(01).                02450009
024600         10  MR-LOC-SENTH              PIC  X(01).                02460009
024700         10  MR-LOC-SENT               PIC  X(04).                02470009
024701                                                                  02470107
024702         10  MR-DATEL                  PIC S9(04) COMP.           02470209
024703         10  MR-DATEA                  PIC  X(01).                02470309
024704         10  MR-DATEC                  PIC  X(01).                02470409
024705         10  MR-DATEH                  PIC  X(01).                02470509
024706         10  MR-DATE                   PIC  X(05).                02470609
024707                                                                  02470707
024708         10  MR-TIMEL                  PIC S9(04) COMP.           02470809
024709         10  MR-TIMEA                  PIC  X(01).                02470909
024710         10  MR-TIMEC                  PIC  X(01).                02471009
024711         10  MR-TIMEH                  PIC  X(01).                02471109
024712         10  MR-TIME                   PIC  X(08).                02471209
024714                                                                  02471409
024715         10  MR-CASIL                  PIC S9(04) COMP.           02471509
024716         10  MR-CASIA                  PIC  X(01).                02471609
024717         10  MR-CASIC                  PIC  X(01).                02471709
024718         10  MR-CASIH                  PIC  X(01).                02471809
024719         10  MR-CASI                   PIC  X(01).                02471951
024721                                                                  02472109
024722         10  MR-USERL                  PIC S9(04) COMP.           02472209
024723         10  MR-USERA                  PIC  X(01).                02472309
024724         10  MR-USERC                  PIC  X(01).                02472409
024725         10  MR-USERH                  PIC  X(01).                02472509
024726         10  MR-USER                   PIC  X(08).                02472609
024735                                                                  02473509
024736         10  MR-NAMEL                  PIC S9(04) COMP.           02473609
024737         10  MR-NAMEA                  PIC  X(01).                02473709
024738         10  MR-NAMEC                  PIC  X(01).                02473809
024739         10  MR-NAMEH                  PIC  X(01).                02473909
024740         10  MR-NAME                   PIC  X(15).                02474099
      *CLP 01/25/14                                                     02474199
024741                                                                  02474209
024742*    05  FILLER                         PIC  X(12).               02474399
024743                                                                  02474407
024744*----------------------------------------------------------------*02474501
024745*  SENDING/RECEIVING AREA FOR THE                                 02474601
024746*  PRINTER VALIDATION ROUTING (DPKCS060)                          02474701
024747*----------------------------------------------------------------*02474801
024748     COPY DPWS072.                                                02474901
024749                                                                  02475001
024750*---------------------------------------------------------------* 02475101
024751*    ATTRIBUTE SETTINGS COPYBOOK.                               * 02475201
024760*---------------------------------------------------------------* 02476001
024770     COPY DPWS015.                                                02477001
024780                                                                  02478001
024790*---------------------------------------------------------------* 02479001
024800*    FUNCTION KEYS COPYBOOK.                                    * 02480001
024900*---------------------------------------------------------------* 02490001
025000     COPY DPWS016.                                                02500001
025100                                                                  02510001
025200*---------------------------------------------------------------* 02520001
025300*    NUMERIC EDIT LAYOUT.                                       * 02530001
025400*---------------------------------------------------------------* 02540001
025500     COPY DPWS010I.                                               02550001
025600                                                                  02560001
025700*---------------------------------------------------------------* 02570001
025800*    PARAMETERS FOR CALLING CICS ARCHITECTURE API               * 02580099
025900*---------------------------------------------------------------* 02590001
026000     COPY DPWS030.                                                02600001
026000     COPY DPWS930.                                                02601099
026100                                                                  02610001
026200*---------------------------------------------------------------* 02620001
026300*    STANDARD COMMAREA.                                         * 02630001
026400*---------------------------------------------------------------* 02640001
026500     COPY DPWS020.                                                02650001
026600     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                02660001
026700                                                                  02670001
026800*---------------------------------------------------------------* 02680001
026900* INTER-APPLICATION COMMAREA.                                   * 02690001
027000*   SUWS100 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02700001
027100*             SPEC SCREEN.                                      * 02710001
027200*   SUWS101 - IS THE OUTPUT LAYOUT THAT WILL BE PASSED FROM     * 02720001
027300*             THIS LIST PROGRAMMING FOR A LOCAL-GO FUNCTION.    * 02730001
027400*---------------------------------------------------------------* 02740001
027500         10  INTER-APPL-COMM-AREA       PIC X(200).               02750001
027600     COPY SUWS100.                                                02760001
027700     COPY SUWS101.                                                02770001
027800                                                                  02780001
027900*---------------------------------------------------------------* 02790001
028000*  THIS IS THE APPLICATION-SPECIFIC COMMAREA.                   * 02800001
028100*---------------------------------------------------------------* 02810001
028200         10  ASC-SPECIFIC-COMMAREA.                               02820001
028210             15  ASC-FUNCTION                 PIC  X(01).         02821025
028220             15  ASC-OPER-UNT-ID              PIC  9(04).         02822025
028230             15  ASC-ORD-SEQ                  PIC  X(05).         02823025
028310             15  ASC-COUNT                    PIC S9(09) COMP.    02831014
028320             15  ASC-BLK-SUB                  PIC S9(04) COMP     02832014
028330                                                         SYNC.    02833014
028340             15  ASC-ITEM-SUB                 PIC S9(04) COMP     02834014
028350                                                         SYNC.    02835014
028351             15  ASC-SEL-QUEUE-NAME.                              02835133
028352                 20  ASC-SEL-TERM-ID          PIC  X(04).         02835233
028353                 20  ASC-SEL-TASK-NUMBER      PIC S9(05) COMP-3.  02835333
028354                 20  ASC-SEL-SEQ              PIC  9(01).         02835433
028360             15  ASC-SEL-QUEUE-NAME-IN.                           02836094
028361                 20  ASC-SEL-TERM-ID-IN       PIC  X(04).         02836194
028362                 20  ASC-SEL-TASK-NUMBER-IN   PIC S9(05) COMP-3.  02836294
028363                 20  ASC-SEL-SEQ-IN           PIC  9(01).         02836394
028364             15  ASC-NUMBER-OF-ITEMS-READ     PIC S9(09) COMP-3.  02836494
028370             15  ASC-NUMBER-OF-SELECTED-ITEMS PIC S9(09) COMP-3.  02837014
028380             15  ASC-ITEMS-DISPLAYED          PIC S9(03) COMP-3.  02838014
028390             15  ASC-ITEM-AT-TOP-OF-PANEL     PIC S9(09) COMP-3.  02839014
028391             15  ASC-ITEM-AT-BOT-OF-PANEL     PIC S9(09) COMP-3.  02839114
028392             15  ASC-HIGHEST-BLOCK-WRITTEN    PIC S9(04) COMP     02839214
028393                                                         SYNC.    02839314
028394             15  ASC-START-OF-SELECTED-RANGE  PIC S9(09) COMP-3.  02839414
028395             15  ASC-END-OF-SELECTED-RANGE    PIC S9(09) COMP-3.  02839514
028396             15  ASC-XCNTL-TO-RESEND-SW       PIC  X(01).         02839614
028397                 88  ASC-XCNTL-TO-RESEND           VALUE 'Y'.     02839714
028398                 88  ASC-XCNTL-TO-RESEND-NO        VALUE 'N'.     02839814
028399             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         02839914
028400                 88  ASC-ITEMS-LEFT-ON-DB          VALUE 'Y'.     02840014
028401                 88  ASC-NO-ITEMS-LEFT-ON-DB       VALUE 'N'.     02840114
028402             15  ASC-TEMP-QUEUE-UPDATE-SW     PIC  X(01).         02840214
028403                 88  ASC-UPDATE-TSQ                VALUE 'Y'.     02840314
028404                 88  ASC-NO-TSQ-UPDATE             VALUE ' '.     02840414
028405             15  ASC-LIST-QUEUE-NAME.                             02840514
028406                 20  ASC-LIST-TERM-ID         PIC  X(04).         02840614
028407                 20  ASC-LIST-TASK-NUMBER     PIC S9(05) COMP-3.  02840714
028408                 20  ASC-LIST-SEQ             PIC  9(01).         02840814
028409                                                                  02840914
028410             15  ASC-START-ITEM-REQUEST.                          02841014
028411                 20  ASC-START-ITEM-REQUEST-N PIC  9(05).         02841114
028413             15  ASC-SEL-SUB                  PIC S9(4) COMP.     02841314
028414             15  ASC-SEL-ITEM                 PIC S9(4) COMP.     02841414
028415             15  ASC-USE-SELECTION-QUEUE-IND  PIC  X(1).          02841592
028416                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02841692
028417             15  ASC-NUMBER-OF-TS-ITEMS       PIC S9(09) COMP-3.  02841792
028418             15  ASC-STORE-SW                 PIC  X(01).         02841829
028419                 88  ASC-LIST-BY-STORE               VALUE 'S'.   02841929
028420                 88  ASC-LIST-BY-CART                VALUE 'D'.   02842029
028430             15  ASC-OPER-UNIT                PIC  9(04).         02843004
028500             15  ASC-PO                       PIC  X(09).         02850004
028600             15  ASC-RECEIVER                 PIC  9(04).         02860056
028700             15  ASC-PACK-TYPE                PIC  X(18).         02870070
028800             15  ASC-LINE-NO                  PIC  9(04).         02880056
028810             15  ASC-LINE-NO-X REDEFINES                          02881099
028820                 ASC-LINE-NO                  PIC  X(04).         02882099
028900             15  ASC-PACK-ID                  PIC  9(04).         02890056
028910             15  ASC-CART-ID                  PIC  X(22).         02891099
028911             15  ASC-CART-ID-N REDEFINES ASC-CART-ID.             02891199
028912                 20  ASC-CART-ID-P            PIC  9(18).         02891299
028913                 20  FILLER                   PIC  9(04).         02891399
028914             15  ASC-CRE-SRC                  PIC  X(03).         02891499
028915             15  ASC-SHIPT-UNT-ID.                                02891599
028916                 20  ASC-SHIPT-UNT-ID-P       PIC  9(18).         02891699
028917             15  ASC-TOT-EXP-CRTNS            PIC S9(05) COMP.    02891799
028918             15  ASC-TOT-ACTL-CRTNS           PIC S9(05) COMP.    02891899
028919             15  ASC-TOT-EXP-SCAN             PIC S9(05) COMP.    02891999
028920             15  ASC-TOT-ACTL-SCN             PIC S9(05) COMP.    02892099
028930             15  ASC-TOT-UNITS                PIC 9(07).          02893099
      *CLP 01/25/14                                                     02894099
                   15  ASC-HIGHLIGHT-CARTON-SW      PIC X(01).          03314099
                       88  ASC-HIGHLIGHT-CARTON     VALUE 'Y'.          03315099
                       88  ASC-NOT-HIGHLIGHT-CARTON VALUE 'N'.          03316099
034000                                                                  03400064
034100*-----------------------------------------------------------------03410001
034200             15  ASC-BLOCK-ENTRIES OCCURS 2 TIMES.                03420001
034300                 20  ASC-BLOCK-MODIFIED-SW           PIC  X(01).  03430001
034400                     88  ASC-BLOCK-NOT-MODIFIED      VALUE 'N'.   03440001
034500                     88  ASC-BLOCK-MODIFIED          VALUE 'Y'.   03450001
034600                                                                  03460001
034700                 20  ASC-ITEM-ARRAY.                              03470001
034800                     25  ASC-ITEM-ENTRIES OCCURS 11 TIMES.        03480001
034900                         30  ASC-LIST-ITEM-NUMBER                 03490001
035000                                                     PIC S9(09)   03500001
035100                                                     COMP-3.      03510001
035200                         30  ASC-TEMP-SELECTED-SW    PIC  X(01).  03520001
035300                             88  ASC-VALID-SELECT    VALUE ' '    03530001
035400                                                           'S'    03540001
035500                                                           'B'    03550001
035600                                                           'E'.   03560001
035700                             88  ASC-TEMP-NO-SELECT  VALUE ' '.   03570001
035800                             88  ASC-TEMP-SELECT     VALUE 'S'.   03580001
035900                             88  ASC-TEMP-BEGIN      VALUE 'B'.   03590001
036000                             88  ASC-TEMP-END        VALUE 'E'.   03600001
036100                         30  ASC-SELECTED-SW         PIC  X(01).  03610001
036200                             88  ASC-NO-SELECT       VALUE ' '.   03620001
036300                             88  ASC-SELECT          VALUE 'S'.   03630001
036400                             88  ASC-BEGIN           VALUE 'B'.   03640001
036500                             88  ASC-END             VALUE 'E'.   03650001
036600                         30  ASC-ACTION              PIC  X(03).  03660001
036700                         30  ASC-AUDIT-NO            PIC  X(09).  03670004
      *CLP 01/25/14                                                     03670199
036700                         30  ASC-AUDIT-TY            PIC  X(09).  03671099
036800                         30  ASC-FAIL-RSN            PIC  X(04).  03680004
036900                         30  ASC-DIR-TYPE            PIC  X(01).  03690004
037000                         30  ASC-DIRV-RSN-CODE       PIC  X(03).  03700031
037100                         30  ASC-LOC-SENT            PIC  X(04).  03710004
037200                         30  ASC-CREATE-DATE         PIC  X(05).  03720045
037210                         30  ASC-CREATE-TIME         PIC  X(08).  03721045
037300                         30  ASC-CASI                PIC  X(01).  03730004
037400                         30  ASC-USER-ID             PIC  X(08).  03740004
037500                         30  ASC-USER-NAME           PIC  X(15).  03750099
037700                                                                  03770001
037800*---------------------------------------------------------------* 03780001
037900*    ABEND PROCESSING COPYBOOK.                                 * 03790001
038000*---------------------------------------------------------------* 03800001
038100     COPY DPWS013.                                                03810001
038200                                                                  03820001
038211*---------------------------------------------------------------* 03821141
038220*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE DOMAIN USER TABLE  03822041
038221*---------------------------------------------------------------* 03822141
038240     EXEC SQL                                                     03824041
038250        INCLUDE XLT00024                                          03825041
038260     END-EXEC.                                                    03826041
038270                                                                  03827041
038300*---------------------------------------------------------------* 03830003
038400* RC-RECEIVER - LRECL=206                                         03840003
038500*---------------------------------------------------------------* 03850003
038600     EXEC SQL                                                     03860003
038700          INCLUDE TRECEIV                                         03870003
038800     END-EXEC.                                                    03880003
038900                                                                  03890003
      *CLP 01/25/14                                                     03890199
071900*----------------------------------------------------------------*03890299
029000*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE SHIPPING UNIT      03890399
029100*  AUDIT TABLE (TSUNAUD)                                          03890499
072200*----------------------------------------------------------------*03890699
072300     EXEC SQL                                                     03890799
072400          INCLUDE TSUNAUD                                         03890899
072500     END-EXEC.                                                    03890999
                                                                        03891099
071900*----------------------------------------------------------------*03900099
072000*    DB2 DCLGEN FOR THE VENDOR PO AUDIT REQUEST TABLE             03910099
072100*    (SUT_PO_AUD_REQ)                                             03920099
072200*----------------------------------------------------------------*03930099
072300     EXEC SQL                                                     03940099
072400          INCLUDE SUT00015                                        03950099
072500     END-EXEC.                                                    03960099
039790*---------------------------------------------------------------* 03979003
039791* SUT_CART_DIRV_TRKG                                              03979103
039792* SU - CARTON DIRECTIVE TRACKING - LRECL=165                      03979203
039793*---------------------------------------------------------------* 03979303
039794     EXEC SQL                                                     03979403
039795          INCLUDE SUT00102                                        03979503
039796     END-EXEC.                                                    03979603
039797                                                                  03979703
039798*---------------------------------------------------------------* 03979803
039799* WST_INTGRTN_TYP                                                 03979903
039800* WAREHOUSE SYSTEMS - INTEGRATION TYPE - LRECL=78                 03980003
039801*---------------------------------------------------------------* 03980103
039802     EXEC SQL                                                     03980203
039803          INCLUDE SUT00008                                        03980303
039804     END-EXEC.                                                    03980403
039805                                                                  03980503
039806*---------------------------------------------------------------* 03980603
039807* WST_ATTR_DEFN                                                   03980703
039808* WAREHOUSE SYSTEMS - ATTRIBUTE DEFINITION - LRECL=78             03980803
039809*---------------------------------------------------------------* 03980903
039810     EXEC SQL                                                     03981003
039811          INCLUDE SUT00009                                        03981103
039812     END-EXEC.                                                    03981203
039813                                                                  03981303
039814*---------------------------------------------------------------* 03981461
039815* SUT_OTBND_CART                                                  03981561
039816* SU-SHIPMENT UNIT - LRECL=82                                     03981662
039817*---------------------------------------------------------------* 03981761
039818     EXEC SQL                                                     03981861
039819          INCLUDE SUT00024                                        03981961
039820     END-EXEC.                                                    03982061
039821                                                                  03982161
039822*---------------------------------------------------------------* 03982203
039823* WST_ATTR_ELEM                                                   03982303
039824* WAREHOUSE SYSTEMS - ATTRIBUTE ELEMENTS - LRECL=97               03982403
039825*---------------------------------------------------------------* 03982503
039826     EXEC SQL                                                     03982603
039827          INCLUDE SUT00010                                        03982703
039828     END-EXEC.                                                    03982803
039829                                                                  03982903
039830*---------------------------------------------------------------* 03983099
039831*    WST_INTGRTN_TYP - WAREHOUSE SYSTEMS - INTEGRATION TYPE     * 03983199
039832*                      LRECL=78                                 * 03983299
039833*---------------------------------------------------------------* 03983399
039834     EXEC SQL                                                     03983499
039835          INCLUDE WST00008                                        03983599
039836     END-EXEC.                                                    03983699
039837                                                                  03983799
039838*---------------------------------------------------------------* 03983899
039839*    WST_ATTR_DEFN   - WAREHOUSE SYSTEMS - ATTRIBUTE DEFINITION * 03983999
039840*                      LRECL=78                                 * 03984099
039841*---------------------------------------------------------------* 03984199
039842     EXEC SQL                                                     03984299
039843          INCLUDE WST00009                                        03984399
039844     END-EXEC.                                                    03984499
039846                                                                  03984699
039847*---------------------------------------------------------------* 03984799
039848*    WST_ATTR_ELEM   - WAREHOUSE SYSTEMS - ATTRIBUTE ELEMENTS   * 03984899
039849*                      LRECL=97                                 * 03984999
039850*---------------------------------------------------------------* 03985099
039851     EXEC SQL                                                     03985199
039852          INCLUDE WST00010                                        03985299
039853     END-EXEC.                                                    03985399
039855                                                                  03985599
039856*---------------------------------------------------------------* 03985603
039857*    CART CURSOR WITHOUT CART ID OR TYPE CODE                     03985703
039858*---------------------------------------------------------------* 03985803
039860     EXEC SQL                                                     03986003
039900        DECLARE CART-CSR CURSOR FOR                               03990001
040000          SELECT AUD_CNTL_NBR                                     04000005
040100                ,AUD_FALR_RSN_NM                                  04010005
040200                ,CNVYR_PRC_ACTN_NM                                04020005
040300                ,DIRV_RSN_CDE                                     04030005
040310                ,CART_STAT_CDE                                    04031080
040320                ,STR_NBR                                          04032080
040400                ,LGCL_LOC_NM                                      04040005
040410                ,CRE_TMST                                         04041005
040420                ,CASI_CDE                                         04042005
040430                ,CRE_BY_USR_ID                                    04043005
040440            FROM SUT_CART_DIRV_TRKG A                             04044005
040441           WHERE A.OPER_UNT_ID  = :DK-OPER-UNT-ID                 04044106
040450             AND (                                                04045006
040451                 BRCDE_NBR      = :DK-CART-ID                     04045113
040452                   OR                                             04045207
040460                 SHIPT_UNT_ID   = :DK-CART-ID-PACKED              04046013
040470                                                      )           04047006
040500        ORDER BY CRE_TMST                                         04050005
040800     END-EXEC.                                                    04080001
040900                                                                  04090001
043210*---------------------------------------------------------------* 04321003
043211*    DB2 AREA FOR COMMUNICATIONS                                * 04321103
043212*---------------------------------------------------------------* 04321203
043213     EXEC SQL                                                     04321303
043214          INCLUDE SQLCA                                           04321403
043215     END-EXEC.                                                    04321503
043216                                                                  04321603
043224***************************************************************** 04322401
043225 LINKAGE SECTION.                                                 04322501
043226                                                                  04322601
043227 01  DFHCOMMAREA.                                                 04322701
043230     05  FILLER                         OCCURS  1 TO 4072 TIMES   04323001
043240                                        DEPENDING ON EIBCALEN.    04324001
043250         10  FILLER                     PIC X.                    04325001
043260                                                                  04326001
043270                                                                  04327001
043280 PROCEDURE DIVISION.                                              04328001
043290******************************************************************04329001
043300**  THIS MODULE IS THE HIGHEST PROCESSING LEVEL IN THE PROGRAM. **04330001
043400**  FIRST, CALL THE CICS ARCHITECTURE API, PERFORM THE PROGRAM  **04340001
043500**  PROCESSING AND THEN CALL THE CICS ARCHITECTURE API TO EXIT. **04350001
043600******************************************************************04360001
043700 0000-MAIN-MODULE.                                                04370001
043800     INITIALIZE DP030-CICS-API-FIELDS.                            04380001
043900     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       04390001
044000     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          04400001
044100     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         04410001
044200     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       04420001
044300     MOVE LENGTH OF SUK773I        TO DP030-MAP-LENGTH (1).       04430001
044400     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     04440001
044500     PERFORM 0001-CALL-CICS-ARCH-API.                             04450001
044600*                                                                 04460001
044700     PERFORM 1000-CONTROL-PROCESSING                              04470001
044800*                                                                 04480001
044900     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     04490001
045000     PERFORM 0001-CALL-CICS-ARCH-API.                             04500001
045100                                                                  04510001
045200******************************************************************04520001
045300**  THIS PARAGRAPH CALLS THE CICS ARCHITECTURE API SUBROUTINE   **04530001
045400**  AND WILL ABEND IF ANY ERRORS OCCURRED IN THAT CALL.         **04540001
045500******************************************************************04550001
045600 0001-CALL-CICS-ARCH-API.                                         04560001
045700*    CALL 'DPKCS030' USING DFHEIBLK                               04570099
045700     CALL DP930-CICS-ARCH-API USING DFHEIBLK                      04571099
045800                           DFHCOMMAREA                            04580001
045900                           DP030-CICS-API-FIELDS                  04590001
046000                           DP020-STANDARD-COMMAREA                04600001
046100                           SUK773I.                               04610001
046200*                                                                 04620001
046300     IF  DP030-RC-CALL-SUCCESSFUL                                 04630001
046400         CONTINUE                                                 04640001
046500     ELSE                                                         04650001
046600         SET DP013-NO-ROLLBACK                                    04660001
046700             DP013-XCTL-DISPLAY-RESTART                           04670001
046800             DP013-CICS-ABEND      TO TRUE                        04680001
046900         MOVE '0001-CALL-CICS-ARCH-API'                           04690001
047000                                   TO DP013-PARAGRAPH             04700001
047100*        MOVE 'CALL TO DPKCS030 NOT SUCCESSFUL, RETURN-CODE ON NEX04710099
047200*             'T LINE'             TO DP013-MESSAGE-TEXT (2)      04720099
047100         MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O04721099
047200-             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      04722099
047300         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      04730001
047400         PERFORM DP013-0000-PROCESS-ABEND                         04740001
047500     END-IF.                                                      04750001
047600                                                                  04760001
047700*----------------------------------------------------------------*04770001
047800* PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT      *04780001
047900* COURSE OF ACTION IS FOR THIS TRANSACTION.                      *04790001
048000*                                                                *04800001
048100* NOTE:  PV-TOP-ITEM IS THE ITEM THAT IS REQUESTED TO BE AT THE  *04810001
048200*  TOP OF THE PANEL.  MOVING ASC-ITEM-AT-TOP-OF-PANEL TO THIS    *04820001
048300*  MEANS THAT POSITION WITHIN THE LIST WILL NOT CHANGE -- THIS   *04830001
048400*  IS THE DEFAULT WHICH WILL BE OVERRIDDEN BY SCROLLING ACTIONS. *04840001
048500*----------------------------------------------------------------*04850001
048600 1000-CONTROL-PROCESSING.                                         04860001
048700     EVALUATE TRUE                                                04870001
048800         WHEN DP020-NEXT-ACT-INITIAL                              04880001
048900             INITIALIZE ASC-SPECIFIC-COMMAREA                     04890001
049000             MOVE EIBTRMID    TO ASC-LIST-TERM-ID                 04900001
049200             MOVE DP020-SRC-TASK-NUMBER TO ASC-LIST-TASK-NUMBER   04920001
049400             MOVE PC-LIST-QUEUE-SEQ TO ASC-LIST-SEQ               04940001
049500*            MOVE PC-SEL-QUEUE-SEQ  TO ASC-SEL-SEQ                04950026
049600             PERFORM 1100-PROCESS-INTER-APPL-COMM                 04960001
049700             MOVE ASC-AUDIT-NO  (1 1)  TO  DK-AUDIT-NO            04970009
049900             PERFORM 4000-BUILD-INITIAL-PANEL                     04990001
050000                                                                  05000001
050100         WHEN DP020-NEXT-ACT-READ-MAP                             05010001
050200             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         05020001
050300             PERFORM 2000-PROCESS-PANEL                           05030001
050430                                                                  05043001
050500         WHEN DP020-NEXT-ACT-RETURN                               05050001
050600             MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM         05060001
050700             MOVE ZERO  TO ASC-ITEM-AT-TOP-OF-PANEL               05070001
050800             MOVE SPACES               TO  DK-AUDIT-NO            05080009
050900             MOVE SPACES               TO  DK-TYPE-CODE           05090001
051322             PERFORM 6000-REFRESH-PANEL-FROM-TEMP                 05132207
051323             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05132307
051325                                                                  05132501
051326         WHEN OTHER                                               05132601
051327             SET DP013-LOGIC-ABEND TO TRUE                        05132701
051328             SET DP013-NO-ROLLBACK TO TRUE                        05132801
051329             MOVE '1000-CONTROL-PROCESSING' TO DP013-PARAGRAPH    05132901
051330             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    05133001
051340                                   TO DP013-MESSAGE-TEXT(1)       05134001
051350             PERFORM DP013-0000-PROCESS-ABEND                     05135001
051360     END-EVALUATE.                                                05136001
051370                                                                  05137001
051380*----------------------------------------------------------------*05138001
051390* DETERMINE IF DATA WAS PASSED THROUGH INTER-APPL COMMAREA OR    *05139001
051400* IF THERE IS DATA TO BE USED IN THE NAV-KEY FIELD.              *05140001
051500*----------------------------------------------------------------*05150001
051600 1100-PROCESS-INTER-APPL-COMM.                                    05160001
051700                                                                  05170001
051810     SET PS-COMMAREA-VALID         TO TRUE.                       05181099
051900     MOVE SPACE                    TO ASC-START-ITEM-REQUEST.     05190001
052000                                                                  05200001
052100     IF DP020-INT-APPL-FORMAT-IND = PC-CRIT-SPEC-FORMAT           05210099
052200        SET ASC-LIST-BY-CART          TO TRUE                     05220099
052300        MOVE PC-CART                  TO ASC-ORD-SEQ              05230099
052400        MOVE SU100-FUNCTION           TO ASC-FUNCTION             05240099
052500        MOVE SU100-OPER-UNIT          TO ASC-OPER-UNIT            05250099
052600        MOVE SU100-CARTON-ID          TO ASC-CART-ID              05260099
052900     ELSE                                                         05290001
052910         IF SU101-NUMBER-OF-SELECTED-ITEMS > 0                    05291099
052920             SET ASC-USE-SELECTION-QUEUE TO TRUE                  05292099
052930             MOVE SU101-NUMBER-OF-SELECTED-ITEMS                  05293099
052940                                   TO ASC-NUMBER-OF-SELECTED-ITEMS05294099
052950             MOVE SU101-NUMBER-OF-TS-ITEMS                        05295099
052960                                   TO ASC-NUMBER-OF-TS-ITEMS      05296099
052970             MOVE SU101-SEL-QUEUE-NAME                            05297099
052980                                   TO ASC-SEL-QUEUE-NAME          05298099
053000             MOVE SU100-FUNCTION           TO ASC-FUNCTION        05300099
053100             MOVE SU100-OPER-UNIT          TO ASC-OPER-UNIT       05310099
053120             MOVE SU100-PO-NUMBER          TO ASC-PO              05312099
053197             PERFORM 1120-PREPARE-LIST-ENTRY                      05319799
053200         END-IF                                                   05320099
053201     END-IF.                                                      05320199
053210                                                                  05321090
053300                                                                  05330090
053310*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05331090
053320 1120-PREPARE-LIST-ENTRY.                                         05332090
053330                                                                  05333090
053340     MOVE SU102-MAX-ITEMS          TO ASC-SEL-SUB.                05334094
053350     MOVE ZERO                     TO ASC-SEL-ITEM.               05335090
053360     PERFORM 1130-GET-NEXT-RECORD.                                05336090
053370                                                                  05337090
053380*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05338090
053390*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*05339090
053391*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*05339190
053392 1130-GET-NEXT-RECORD.                                            05339290
053394     ADD +1                       TO ASC-SEL-SUB.                 05339490
053396     IF  ASC-SEL-SUB > SU102-MAX-ITEMS                            05339694
053397         ADD +1                   TO ASC-SEL-ITEM                 05339790
053398         MOVE +1                  TO ASC-SEL-SUB                  05339890
053399     END-IF.                                                      05339990
053400                                                                  05340090
053401     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                05340190
053402         PERFORM 9100-READ-SEL-QUEUE                              05340299
053403         IF  SU102-ITEM (ASC-SEL-SUB) > ZERO                      05340399
053404             PERFORM 1160-MOVE-TO-ASC                             05340499
053405             SET SU102-INQ (ASC-SEL-SUB) TO TRUE                  05340599
053406             PERFORM 9200-REWRITE-SEL-QUEUE                       05340699
053407         ELSE                                                     05340799
053408             SUBTRACT +1 FROM ASC-SEL-SUB                         05340899
053409             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            05340999
053410             SET DP020-MSG-INFORMATIONAL                          05341099
053411                 PS-LIST-END       TO TRUE                        05341199
053412         END-IF                                                   05341299
053413     ELSE                                                         05341399
053414         SUBTRACT +1 FROM ASC-SEL-ITEM                            05341499
053415         MOVE SU102-MAX-ITEMS      TO ASC-SEL-SUB                 05341599
053417         MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER                05341799
053418         SET DP020-MSG-INFORMATIONAL                              05341899
053419             PS-LIST-END       TO TRUE                            05341999
053420     END-IF.                                                      05342099
053429                                                                  05342999
053430***************************************************************** 05343099
053431*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         05343199
053432*  PROCESSED.                                                     05343299
053433***************************************************************** 05343399
053434 1140-GET-PREV-RECORD.                                            05343499
053435     SUBTRACT +1 FROM ASC-SEL-SUB.                                05343599
053436                                                                  05343699
053437     IF  ASC-SEL-SUB < +1                                         05343799
053438         SUBTRACT +1 FROM ASC-SEL-ITEM                            05343899
053439         MOVE SU102-MAX-ITEMS      TO ASC-SEL-SUB                 05343999
053440     END-IF.                                                      05344099
053441     IF  ASC-SEL-ITEM > ZERO                                      05344199
053442         PERFORM 9100-READ-SEL-QUEUE                              05344299
053443         IF  SU102-ITEM (ASC-SEL-SUB) > ZERO                      05344399
053444             PERFORM 1160-MOVE-TO-ASC                             05344499
053445         END-IF                                                   05344599
053446                                                                  05344699
053447         SET SU102-INQ (ASC-SEL-SUB) TO TRUE                      05344799
053448         PERFORM 9200-REWRITE-SEL-QUEUE                           05344899
053449     ELSE                                                         05344999
053450         MOVE +1                   TO ASC-SEL-ITEM                05345099
053451                                      ASC-SEL-SUB                 05345199
053452         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            05345299
053453         SET DP020-MSG-INFORMATIONAL                              05345399
053454             PS-LIST-END             TO TRUE                      05345499
053455     END-IF.                                                      05345599
053456                                                                  05345699
053457 1160-MOVE-TO-ASC.                                                05345799
053458     MOVE SU102-PO-NUMBER    (ASC-SEL-SUB)  TO ASC-PO.            05345899
053459     MOVE SU102-RCVR         (ASC-SEL-SUB)  TO ASC-RECEIVER.      05345999
053460     MOVE SU102-LINE-PACK    (ASC-SEL-SUB)  TO ASC-PACK-TYPE.     05346099
053461     MOVE SU102-CARTON-ID    (ASC-SEL-SUB)  TO ASC-CART-ID.       05346199
053519                                                                  05351999
053557*----------------------------------------------------------------*05355799
053560* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *05356099
053600* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *05360001
053700* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *05370001
053800* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *05380001
053900* FUNCTION KEYS CAN GET THIS FAR.                                *05390001
054000*----------------------------------------------------------------*05400001
054100 2000-PROCESS-PANEL.                                              05410001
054200     EVALUATE TRUE                                                05420001
054300         WHEN DP020-SRC-AID = DP016-CLEAR                         05430001
054400             MOVE ZERO TO ASC-ITEM-AT-TOP-OF-PANEL                05440001
054500             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05450001
054600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05460001
054700                                                                  05470001
054710*F20 NEXT SEL                                                     05471099
054720         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             05472099
054730             IF DP020-INT-APPL-FORMAT-IND = '2'                   05473099
054740               IF  ASC-USE-SELECTION-QUEUE                        05474099
054750                   PERFORM 1130-GET-NEXT-RECORD                   05475099
054760                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             05476099
054770                   IF PS-LIST-END                                 05477099
054780                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       05478099
054790                       SET PS-NO-LIST-END TO TRUE                 05479099
054791                   ELSE                                           05479199
054792                       PERFORM 4000-BUILD-INITIAL-PANEL           05479299
054793                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       05479399
054794                       PERFORM 3200-RESET-ATTRIBUTES              05479499
054795                   END-IF                                         05479599
054796               ELSE                                               05479699
054797*                --- BOTTOM OF LIST ---                           05479799
054798                   MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER       05479899
054799                   SET DP020-MSG-INFORMATIONAL TO TRUE            05479999
054800               END-IF                                             05480099
054801           ELSE                                                   05480199
054802               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           05480299
054803               SET DP020-MSG-FATAL TO TRUE                        05480399
054804           END-IF                                                 05480499
054805                                                                  05480599
054806*F19-PREV SEL                                                     05480699
054807         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             05480799
054808             IF DP020-INT-APPL-FORMAT-IND = '2'                   05480899
054809                IF  ASC-USE-SELECTION-QUEUE                       05480999
054810                   PERFORM 1140-GET-PREV-RECORD                   05481099
054811                   PERFORM 3000-EDIT-DATA-IN-COMMAREA             05481199
054812                   IF PS-LIST-END                                 05481299
054813                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       05481399
054814                       SET PS-NO-LIST-END TO TRUE                 05481499
054815                   ELSE                                           05481599
054816                       PERFORM 4000-BUILD-INITIAL-PANEL           05481699
054817                       PERFORM 4400-MOVE-COMMAREA-TO-SCREEN       05481799
054818                       PERFORM 3200-RESET-ATTRIBUTES              05481899
054819                   END-IF                                         05481999
054820               ELSE                                               05482099
054821                   MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER       05482199
054822                   SET DP020-MSG-INFORMATIONAL TO TRUE            05482299
054823               END-IF                                             05482399
054824           ELSE                                                   05482499
054825               MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER           05482599
054826               SET DP020-MSG-FATAL TO TRUE                        05482699
054827           END-IF                                                 05482799
054828                                                                  05482899
054830         WHEN DP020-FK-REFRESH (DP020-SRC-AID)                    05483001
054900             PERFORM 2050-DELETE-LIST-QUEUE                       05490001
055000             SET SU100-FUNCTION-NONE  TO TRUE                     05500007
056200             PERFORM 4000-BUILD-INITIAL-PANEL                     05620001
056300                                                                  05630001
056400         WHEN DP020-FK-DESELECT (DP020-SRC-AID)                   05640001
056500             PERFORM 2140-DESELECT-ALL-ITEMS                      05650001
056600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05660001
056700                                                                  05670001
056800         WHEN DP020-FK-SELECT-ALL(DP020-SRC-AID)                  05680001
056900             PERFORM 2150-SELECT-ALL-ITEMS                        05690001
057000             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05700001
057100         WHEN OTHER                                               05710001
057200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05720001
057300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05730001
057400             IF  PS-NO-ERROR                                      05740001
057500                 SET DP030-CONTINUE-GO TO TRUE                    05750001
057600                 PERFORM 2100-CHECK-FUNCTION-KEY                  05760001
057700             ELSE                                                 05770001
057800                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             05780001
057900                 SET DP030-OVERRIDE-GO TO TRUE                    05790001
058000             END-IF                                               05800001
058100     END-EVALUATE.                                                05810001
058200                                                                  05820001
058300*----------------------------------------------------------------*05830001
058400*  DELETE THE LIST ITEMS TEMP STORAGE QUEUE.                     *05840001
058500*----------------------------------------------------------------*05850001
058600 2050-DELETE-LIST-QUEUE.                                          05860001
058700                                                                  05870001
058800     EXEC CICS                                                    05880001
058900         DELETEQ TS                                               05890001
059000             QUEUE (ASC-LIST-QUEUE-NAME)                          05900001
059100             RESP  (PV-CICS-RESP)                                 05910001
059200     END-EXEC.                                                    05920001
059300                                                                  05930001
059400     IF (PV-CICS-RESP = DFHRESP(NORMAL)) OR                       05940001
059500        (PV-CICS-RESP = DFHRESP(QIDERR))                          05950001
059600         CONTINUE                                                 05960001
059700     ELSE                                                         05970001
059800         SET DP013-CICS-ABEND      TO TRUE                        05980001
059900         SET DP013-NO-ROLLBACK     TO TRUE                        05990001
060000                                                                  06000001
060100         MOVE '2050-DELETE-LIST-QUEUE' TO DP013-PARAGRAPH         06010001
060200         MOVE 'ERROR TRYING TO DELETE LIST TEMP STORAGE QUEUE'    06020001
060300                                   TO DP013-MESSAGE-TEXT (1)      06030001
060400         PERFORM DP013-0000-PROCESS-ABEND                         06040001
060500     END-IF.                                                      06050001
060600                                                                  06060001
060700     MOVE +0  TO ASC-HIGHEST-BLOCK-WRITTEN.                       06070001
060800                                                                  06080001
060900*----------------------------------------------------------------*06090001
061000* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED FIRST.*06100001
061100* NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED FROM THE  *06110001
061200* CICS ARCHITECTURE API.                                         *06120001
061300*----------------------------------------------------------------*06130001
061400 2100-CHECK-FUNCTION-KEY.                                         06140001
061500                                                                  06150001
061600     EVALUATE TRUE                                                06160001
061700                                                                  06170001
061800* F18 - (DIRCDLST) (LOCAL-FUNC-02)                                06180042
061900         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              06190042
062000             MOVE SU100-OPER-UNIT TO DK-OPER-UNT-ID               06200007
062010             MOVE SU100-CARTON-ID TO DK-CART-ID                   06201022
062300             PERFORM 2110-PREPARE-INTER-APPL-COMM                 06230042
062400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06240042
063200                                                                  06320001
063310* F22 - (SULDRLNE) (LOCAL-FUNC-01)                                06331099
063400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06340099
063404             MOVE ASC-OPER-UNIT      TO DK-OPER-UNT-ID            06340499
063405             IF ASC-OPER-UNIT   = DK-OPER-UNT-ID                  06340599
063406                 MOVE +1 TO ASC-NUMBER-OF-SELECTED-ITEMS          06340699
063407* USING LIST LOGIC TO POPULATE SU102 EVEN THO ONLY ONE MAY BE SEL 06340799
063408                 IF ASC-NUMBER-OF-SELECTED-ITEMS > 0              06340899
063409                     SET ASC-USE-SELECTION-QUEUE TO TRUE          06340999
063410                     MOVE ASC-NUMBER-OF-SELECTED-ITEMS            06341099
063411                               TO SU101-NUMBER-OF-SELECTED-ITEMS  06341199
063412                     MOVE ASC-NUMBER-OF-TS-ITEMS                  06341299
063413                               TO SU101-NUMBER-OF-TS-ITEMS        06341399
063417                     MOVE ASC-SEL-QUEUE-NAME                      06341799
063418                               TO SU101-SEL-QUEUE-NAME            06341899
063419                     MOVE ASC-OPER-UNIT       TO SU101-OPER-UNIT  06341999
063420*                    MOVE ASC-OPER-UNIT-NAME TO SU101-OPER-NAME   06342099
063430*                    MOVE ASC-SORT-SEQ-SW    TO SU101-SORT-SEQ    06343099
063440*                    MOVE ASC-LOCK-MODE-SW   TO SU101-LOCK-MODE   06344099
063450*                    MOVE ASC-CURSOR-SW      TO SU101-CURSOR-SW   06345099
063460*                    MOVE ASC-END-DATE    TO SU101-DATE-RANGE-END 06346099
063470                     MOVE ASC-FUNCTION       TO SU101-FUNCTION    06347099
063480                     PERFORM 5000-PREPARE-SEL-QUEUE               06348099
063490                 ELSE                                             06349099
063500                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         06350099
063600                     SET DP030-OVERRIDE-GO TO TRUE                06360099
063700                     MOVE PC-TSYMSG-00057  TO DP020-MSG-NUMBER    06370099
063800                     SET DP020-MSG-FATAL   TO TRUE                06380099
063810                 END-IF                                           06381099
063820             ELSE                                                 06382099
063830                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06383099
063840                 SET DP030-OVERRIDE-GO TO TRUE                    06384099
063850                 MOVE PC-TSYMSG-02571  TO DP020-MSG-NUMBER        06385099
063860                 SET PS-ERROR                                     06386099
063870                     DP020-MSG-FATAL   TO TRUE                    06387099
063880             END-IF                                               06388099
063900                                                                  06390043
065993* F6 - FIRST PAGE                                                 06599301
065994         WHEN DP020-FK-FIRST-PAGE(DP020-SRC-AID)                  06599401
065995             MOVE +1               TO PV-TOP-ITEM                 06599501
065996             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06599601
065997                                                                  06599701
065998* F7 - PREVIOUS PAGE                                              06599801
065999         WHEN DP020-FK-PREV-PAGE(DP020-SRC-AID)                   06599901
066000             PERFORM 2110-BROWSE-BACKWARD                         06600001
066100             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06610001
066200                                                                  06620001
066300* F8 - NEXT PAGE                                                  06630001
066400         WHEN DP020-FK-NEXT-PAGE(DP020-SRC-AID)                   06640001
066500             PERFORM 2120-BROWSE-FORWARD                          06650001
066600             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 06660001
066700                                                                  06670001
066800* ENTER KEY                                                       06680001
066900         WHEN DP020-SRC-AID = DP016-ENTER                         06690001
067000             PERFORM 2130-CHECK-FOR-JUMP-BROWSE                   06700001
067100             IF  PS-ERROR                                         06710001
067200                 CONTINUE                                         06720001
067300             ELSE                                                 06730001
067400                 PERFORM 4400-MOVE-COMMAREA-TO-SCREEN             06740001
067500             END-IF                                               06750001
067600                                                                  06760001
067700         WHEN OTHER                                               06770001
067800             SET DP013-NO-ROLLBACK                                06780001
067900                 DP013-XCTL-DISPLAY-RESTART                       06790001
068000                 DP013-CICS-ABEND  TO TRUE                        06800001
068100             MOVE '2100-CHECK-FUNCTION-KEY' TO DP013-PARAGRAPH    06810001
068200             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      06820001
068300                                   TO DP013-MESSAGE-TEXT (1)      06830001
068400             PERFORM DP013-0000-PROCESS-ABEND                     06840001
068500     END-EVALUATE.                                                06850001
068600                                                                  06860001
068700******************************************************************06870001
068800** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **06880001
068900** INTER-APPLICATION COMMAREA.                                  **06890001
069000******************************************************************06900001
069100 2110-PREPARE-INTER-APPL-COMM.                                    06910001
069200                                                                  06920001
069210     INITIALIZE SU100-INTER-APPL-COMMAREA.                        06921007
069220                                                                  06922001
069230     MOVE ASC-FUNCTION             TO SU100-FUNCTION.             06923007
069240     MOVE SU100-OPER-UNIT          TO DK-OPER-UNT-ID.             06924007
069250     MOVE DK-OPER-UNT-ID           TO SU101-OPER-UNIT.            06925026
069280     MOVE ASC-OPER-UNIT            TO SU101-OPER-UNIT.            06928026
069300                                                                  06930001
069310*----------------------------------------------------------------*06931001
069320*    IF THE USER HITS THE PAGE BACKWARD KEY, COMPUTE THE TOP     *06932001
069330*    ITEM NUMBER FOR THE NEW PAGE.  IF IT IS ABOVE THE TOP,      *06933001
069340*    SET THE TOP ITEM NUMBER TO +1 AND DISPLAY THE TOP OF LIST   *06934001
069350*    MESSAGE.                                                    *06935001
069360*----------------------------------------------------------------*06936001
069370 2110-BROWSE-BACKWARD.                                            06937001
069380     SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-AT-TOP-OF-PANEL    06938001
069390         GIVING PV-TOP-ITEM.                                      06939001
069400*                                                                 06940001
069500     IF  ((PV-TOP-ITEM < +1)                                      06950001
069600       OR (PV-TOP-ITEM = +1))                                     06960001
069700         MOVE +1                   TO PV-TOP-ITEM                 06970001
069800*        -- TOP OF LIST --                                        06980001
069900         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            06990001
070000         SET DP020-MSG-INFORMATIONAL TO TRUE                      07000001
070100     END-IF.                                                      07010001
070200                                                                  07020001
070300*----------------------------------------------------------------*07030001
070400*    IF THE USER HITS THE PAGE FORWARD KEY, COMPUTE THE TOP      *07040001
070500*    ITEM NUMBER FOR THE NEW PAGE.  IF THE USER ATTEMPTS TO GO   *07050001
070600*    PAST THE END, ISSUE THE BOTTOM OF LIST MESSAGE.             *07060001
070700*----------------------------------------------------------------*07070001
070800 2120-BROWSE-FORWARD.                                             07080001
070900     ADD PC-ITEMS-PER-PANEL ASC-ITEM-AT-TOP-OF-PANEL              07090001
071000         GIVING PV-TOP-ITEM.                                      07100001
071100     IF  PV-TOP-ITEM > ASC-NUMBER-OF-ITEMS-READ                   07110001
071200         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             07120001
071300*        -- BOTTOM OF LIST --                                     07130001
071400         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            07140001
071500         SET DP020-MSG-INFORMATIONAL TO TRUE                      07150001
071600     ELSE                                                         07160001
071700         COMPUTE PV-BOTTOM-ITEM =                                 07170001
071800             PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1                 07180001
071900         IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ            07190001
072000*            -- BOTTOM OF LIST --                                 07200001
072100             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            07210001
072200             SET DP020-MSG-INFORMATIONAL TO TRUE                  07220001
072300         END-IF                                                   07230001
072400     END-IF.                                                      07240001
072500                                                                  07250001
072600*----------------------------------------------------------------*07260001
072700*    THE USER CAN CHANGE THE CURRENT BEGINNING LIST NUMBER SO    *07270001
072800*    THAT THE TRANSACTION WILL JUMP TO THAT POINT IN THE LIST.   *07280001
072900*    THIS IS A FASTER WAY TO GET TO A CERTAIN POINT IN THE LIST  *07290001
073000*    RATHER THAN HITTING NEXT-PAGE TO GET TO THAT POINT.         *07300001
073100*    THE NEW LIST NUMBER ENTERED IS EDITED TO MAKE SURE THAT     *07310001
073200*    IT IS NUMERIC AND FALLS BETWEEN A SPECIFIED RANGE.          *07320001
073300*----------------------------------------------------------------*07330001
073400 2130-CHECK-FOR-JUMP-BROWSE.                                      07340001
073500     SET PS-NO-ERROR               TO TRUE.                       07350001
073600     IF (ASC-START-ITEM-REQUEST = SPACE)                          07360001
073700         MOVE ASC-ITEM-AT-TOP-OF-PANEL TO PV-TOP-ITEM             07370001
073800     ELSE                                                         07380001
073900         MOVE ASC-START-ITEM-REQUEST TO DP010I-UNEDITED-FIELD     07390001
074000         MOVE PC-MSG-NUMBER-LENGTH TO DP010I-MAXIMUM-DIGITS       07400001
074100         MOVE +0                   TO DP010I-MAXIMUM-DECIMALS     07410001
074200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  07420001
263968         CALL DP010I-NUMERIC-EDIT-ROUTINE                         07431099
263968              USING DP010I-NUMERIC-EDIT-AREA                      07432099
074400                                                                  07440001
074500         IF  NOT DP010I-ERROR-DETECTED                            07450001
074600             MOVE DP010I-NUMERIC-FIELD TO ASC-START-ITEM-REQUEST-N07460001
074700             IF  ASC-START-ITEM-REQUEST-N > ZERO                  07470001
074800                 IF  ASC-START-ITEM-REQUEST-N >                   07480001
074900                                          ASC-NUMBER-OF-ITEMS-READ07490001
075000                     MOVE SPACE TO ASC-START-ITEM-REQUEST         07500001
075100                     COMPUTE PV-TOP-ITEM =                        07510001
075200                             ASC-NUMBER-OF-ITEMS-READ             07520001
075300                             - PC-ITEMS-PER-PANEL + 1             07530001
075400                     IF  PV-TOP-ITEM < +1                         07540001
075500                         MOVE +1   TO PV-TOP-ITEM                 07550001
075600                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07560001
075700                         SET DP020-MSG-INFORMATIONAL TO TRUE      07570001
075800                     END-IF                                       07580001
075900                 ELSE                                             07590001
076000                     MOVE ASC-START-ITEM-REQUEST-N                07600001
076100                                   TO PV-TOP-ITEM                 07610001
076200                     MOVE SPACE    TO ASC-START-ITEM-REQUEST      07620001
076300                     COMPUTE PV-BOTTOM-ITEM =                     07630001
076400                         PV-TOP-ITEM + PC-ITEMS-PER-PANEL - 1     07640001
076500                     IF  PV-BOTTOM-ITEM > ASC-NUMBER-OF-ITEMS-READ07650001
076600*                        -- BOTTOM OF LIST --                     07660001
076700                         MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER 07670001
076800                         SET DP020-MSG-INFORMATIONAL TO TRUE      07680001
076900                     END-IF                                       07690001
077000                 END-IF                                           07700001
077100             ELSE                                                 07710001
077200*                --- VALUE OUT OF RANGE ----                      07720001
077300                 MOVE PC-TSYMSG-00101 TO DP020-MSG-NUMBER         07730001
077400                 MOVE -1              TO ASTRTITL                 07740001
077500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07750001
077600                 MOVE DP015-REVERSE   TO ASTRTITH                 07760001
077700                 MOVE DP015-RED       TO ASTRTITC                 07770001
077800                 MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA           07780001
077900                 SET DP020-MSG-FATAL  TO TRUE                     07790001
078000                 SET PS-ERROR         TO TRUE                     07800001
078100             END-IF                                               07810001
078200         ELSE                                                     07820001
078300             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            07830001
078400             MOVE -1               TO ASTRTITL                    07840001
078500             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  07850001
078600             MOVE DP015-REVERSE    TO ASTRTITH                    07860001
078700             MOVE DP015-RED        TO ASTRTITC                    07870001
078800             MOVE DP015-UNP-NUM-BRT-MDT TO ASTRTITA               07880001
078900             SET DP020-MSG-FATAL   TO TRUE                        07890001
079000             SET PS-ERROR          TO TRUE                        07900001
079100         END-IF                                                   07910001
079200     END-IF.                                                      07920001
079300                                                                  07930001
079400*----------------------------------------------------------------*07940001
079500*    IF THE USER HITS THE DESELECT KEY, CLEAR THE SELECTION      *07950001
079600*    SWITCH FOR ALL ITEMS THAT WERE PREVIOUSLY SELECTED.         *07960001
079700*----------------------------------------------------------------*07970001
079800 2140-DESELECT-ALL-ITEMS.                                         07980001
079900     MOVE +1                       TO ASC-BLK-SUB.                07990001
080000                                                                  08000001
080100     PERFORM 2141-CLEAR-SELECTED-INDS                             08010001
080200         VARYING ASC-ITEM-SUB                                     08020001
080300         FROM 1 BY 1                                              08030001
080400         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 08040001
080500                                                                  08050001
080600     ADD +1                        TO ASC-BLK-SUB.                08060001
080700                                                                  08070001
080800     PERFORM 2141-CLEAR-SELECTED-INDS                             08080001
080900         VARYING ASC-ITEM-SUB                                     08090001
081000         FROM 1 BY 1                                              08100001
081100         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 08110001
081200                                                                  08120001
081300     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               08130001
081400                                   TO PV-LIST-ITEM-NUMBER.        08140001
081500                                                                  08150001
081600     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            08160001
081700         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    08170001
081800                                                                  08180001
081900     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            08190001
082000         MOVE +1                   TO ASC-BLK-SUB                 08200001
082100                                                                  08210001
082200         PERFORM 5100-WRITE-TEMP-STORAGE                          08220001
082300         MOVE +2                   TO ASC-BLK-SUB                 08230001
082400         PERFORM 5100-WRITE-TEMP-STORAGE                          08240001
082500         MOVE +1                   TO ASC-BLK-SUB                 08250001
082600         MOVE +1                   TO PV-BLOCK-NUMBER             08260001
082700     END-IF.                                                      08270001
082800                                                                  08280001
082900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     08290001
083000        (ASC-HIGHEST-BLOCK-WRITTEN > PC-MAX-BLOCKS-IN-ARRAY)      08300001
083100         MOVE +1                   TO ASC-BLK-SUB                 08310001
083200                                                                  08320001
083300         PERFORM 5100-WRITE-TEMP-STORAGE                          08330001
083400         MOVE +2  TO ASC-BLK-SUB                                  08340001
083500         PERFORM 5100-WRITE-TEMP-STORAGE                          08350001
083600         MOVE +1  TO ASC-BLK-SUB                                  08360001
083700         MOVE +1  TO PV-BLOCK-NUMBER                              08370001
083800                                                                  08380001
083900         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         08390001
084000             PV-FIRST-BLOCK-IN-ARRAY - 1                          08400001
084100                                                                  08410001
084200         PERFORM                                                  08420001
084300             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       08430001
084400                                                                  08440001
084500             PERFORM 4410-READ-TEMP-STORAGE                       08450001
084600                                                                  08460001
084700             PERFORM 2141-CLEAR-SELECTED-INDS                     08470001
084800                 VARYING ASC-ITEM-SUB FROM 1 BY 1                 08480001
084900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08490001
085000                                                                  08500001
085100             PERFORM 5100-WRITE-TEMP-STORAGE                      08510001
085200                                                                  08520001
085300             ADD +1                TO PV-BLOCK-NUMBER             08530001
085400                                                                  08540001
085500         END-PERFORM                                              08550001
085600                                                                  08560001
085700         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         08570001
085800             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     08580001
085900                                                                  08590001
086000         PERFORM                                                  08600001
086100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       08610001
086200                   ASC-HIGHEST-BLOCK-WRITTEN                      08620001
086300                                                                  08630001
086400             MOVE PV-NEXT-BLOCK-IN-ARRAY                          08640001
086500                                   TO PV-BLOCK-NUMBER             08650001
086600                                                                  08660001
086700             PERFORM 4410-READ-TEMP-STORAGE                       08670001
086800                                                                  08680001
086900             PERFORM 2141-CLEAR-SELECTED-INDS                     08690001
087000                 VARYING ASC-ITEM-SUB                             08700001
087100                 FROM 1 BY 1                                      08710001
087200                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          08720001
087300                                                                  08730001
087400             PERFORM 5100-WRITE-TEMP-STORAGE                      08740001
087500                                                                  08750001
087600             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      08760001
087700                                                                  08770001
087800         END-PERFORM                                              08780001
087900                                                                  08790001
088000         MOVE PV-FIRST-BLOCK-IN-ARRAY                             08800001
088100                                   TO PV-BLOCK-NUMBER             08810001
088200                                                                  08820001
088300         PERFORM 4410-READ-TEMP-STORAGE                           08830001
088400     END-IF.                                                      08840001
088500                                                                  08850001
088600                                                                  08860001
088700     MOVE +0                     TO ASC-NUMBER-OF-SELECTED-ITEMS. 08870001
088800     MOVE +0                     TO ASC-START-OF-SELECTED-RANGE.  08880007
088900     MOVE +0                     TO ASC-END-OF-SELECTED-RANGE.    08890007
089000                                                                  08900001
089100     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        08910001
089200                                                                  08920001
089300*----------------------------------------------------------------*08930001
089400*    MARK EACH ITEM AS BEING NOT SELECTED.                       *08940001
089500*----------------------------------------------------------------*08950001
089600 2141-CLEAR-SELECTED-INDS.                                        08960001
089700     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           08970001
089800             NOT EQUAL ZERO                                       08980001
089900         IF  NOT ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          08990001
090000             SET ASC-NO-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          09000001
090100                 ASC-TEMP-NO-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)    09010001
090200                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB) TO TRUE          09020001
090300         END-IF                                                   09030001
090400     END-IF.                                                      09040001
090500                                                                  09050001
090600*----------------------------------------------------------------*09060001
090700*  IF THE USER HITS THE SELECT-ALL KEY, SET THE SELECTION SWITCH *09070001
090800*  FOR ALL ITEMS.                                                *09080001
090900*----------------------------------------------------------------*09090001
091000 2150-SELECT-ALL-ITEMS.                                           09100001
091100     MOVE +1                       TO ASC-BLK-SUB.                09110001
091200                                                                  09120001
091300     PERFORM 2151-SET-SELECTED-INDS                               09130001
091400         VARYING ASC-ITEM-SUB                                     09140001
091500         FROM 1 BY 1                                              09150001
091600         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09160001
091700                                                                  09170001
091800     ADD +1                        TO ASC-BLK-SUB.                09180001
091900                                                                  09190001
092000     PERFORM 2151-SET-SELECTED-INDS                               09200001
092100         VARYING ASC-ITEM-SUB                                     09210001
092200         FROM 1 BY 1                                              09220001
092300         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 09230001
092400                                                                  09240001
092500     MOVE ASC-LIST-ITEM-NUMBER(1 1)  TO PV-LIST-ITEM-NUMBER.      09250001
092600                                                                  09260001
092700     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            09270001
092800         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    09280001
092900                                                                  09290001
093000     IF  PV-FIRST-BLOCK-IN-ARRAY  = +1                            09300001
093100         MOVE +1                   TO ASC-BLK-SUB                 09310001
093200                                                                  09320001
093300         PERFORM 5100-WRITE-TEMP-STORAGE                          09330001
093400         MOVE +2                   TO ASC-BLK-SUB                 09340001
093500         PERFORM 5100-WRITE-TEMP-STORAGE                          09350001
093600         MOVE +1                   TO ASC-BLK-SUB                 09360001
093700         MOVE +1                   TO PV-BLOCK-NUMBER             09370001
093800     END-IF.                                                      09380001
093900     IF (PV-FIRST-BLOCK-IN-ARRAY NOT = +1) OR                     09390001
094000        (ASC-HIGHEST-BLOCK-WRITTEN >   PC-MAX-BLOCKS-IN-ARRAY)    09400001
094100         MOVE +1                   TO ASC-BLK-SUB                 09410001
094200                                                                  09420001
094300         PERFORM 5100-WRITE-TEMP-STORAGE                          09430001
094400                                                                  09440001
094500         MOVE +1                   TO PV-BLOCK-NUMBER             09450001
094600                                                                  09460001
094700         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         09470001
094800             PV-FIRST-BLOCK-IN-ARRAY - 1                          09480001
094900                                                                  09490001
095000         PERFORM                                                  09500001
095100             UNTIL PV-BLOCK-NUMBER > PV-PREV-BLOCK-IN-ARRAY       09510001
095200                                                                  09520001
095300             PERFORM 4410-READ-TEMP-STORAGE                       09530001
095400                                                                  09540001
095500             PERFORM 2151-SET-SELECTED-INDS                       09550001
095600                 VARYING ASC-ITEM-SUB                             09560001
095700                 FROM 1 BY 1                                      09570001
095800                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09580001
095900                                                                  09590001
096000             PERFORM 5100-WRITE-TEMP-STORAGE                      09600001
096100                                                                  09610001
096200             ADD +1                TO PV-BLOCK-NUMBER             09620001
096300                                                                  09630001
096400         END-PERFORM                                              09640001
096500                                                                  09650001
096600         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         09660001
096700             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     09670001
096800                                                                  09680001
096900         PERFORM                                                  09690001
097000             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       09700001
097100                   ASC-HIGHEST-BLOCK-WRITTEN                      09710001
097200                                                                  09720001
097300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          09730001
097400                                   TO PV-BLOCK-NUMBER             09740001
097500                                                                  09750001
097600             PERFORM 4410-READ-TEMP-STORAGE                       09760001
097700                                                                  09770001
097800             PERFORM 2151-SET-SELECTED-INDS                       09780001
097900                 VARYING ASC-ITEM-SUB                             09790001
098000                 FROM 1 BY 1                                      09800001
098100                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          09810001
098200                                                                  09820001
098300             PERFORM 5100-WRITE-TEMP-STORAGE                      09830001
098400                                                                  09840001
098500             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      09850001
098600                                                                  09860001
098700         END-PERFORM                                              09870001
098800                                                                  09880001
098900         MOVE PV-FIRST-BLOCK-IN-ARRAY  TO PV-BLOCK-NUMBER         09890001
099000                                                                  09900001
099100         PERFORM 4410-READ-TEMP-STORAGE                           09910001
099200     END-IF.                                                      09920001
099300                                                                  09930001
099400     MOVE ASC-NUMBER-OF-ITEMS-READ TO                             09940001
099500                       ASC-NUMBER-OF-SELECTED-ITEMS.              09950001
099600                                                                  09960001
099700     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN.                        09970001
099800                                                                  09980001
099900*----------------------------------------------------------------*09990001
100000*    MARK EACH ITEM AS BEING SELECTED.                           *10000001
100100*----------------------------------------------------------------*10010001
100200 2151-SET-SELECTED-INDS.                                          10020001
100300     IF  ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB ASC-ITEM-SUB)           10030001
100400             NOT EQUAL ZERO                                       10040001
100500         IF  NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             10050001
100600             SET ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)             10060001
100700                 ASC-TEMP-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)        10070001
100800                 ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                  10080001
100900                               TO  TRUE                           10090001
101000         END-IF                                                   10100001
101100     END-IF.                                                      10110001
101200                                                                  10120001
101300******************************************************************10130001
101400** MOVE ALL OF THE FIELDS THAT WERE ENTERED / CHANGED ON THE    **10140001
101500** SCREEN INTO THE COMMAREA.  ALL EDITTING IS DONE IN THE COMM. **10150001
101600******************************************************************10160001
101700 2200-MOVE-SCREEN-TO-COMMAREA.                                    10170001
101800                                                                  10180001
101900     MOVE PV-TOP-ITEM              TO PV-ITEM-IN-USE.             10190001
102000     MOVE +1                       TO PV-SUB.                     10200001
102100*                                                                 10210001
102200     PERFORM 3100-SET-SUBSCRIPTS.                                 10220001
102300                                                                  10230001
102400     IF  ASTRTITL > ZERO                                          10240001
102500         MOVE ASTRTITI         TO ASC-START-ITEM-REQUEST          10250001
102600     ELSE                                                         10260001
102700         IF  ASTRTITF = DP015-ERASE-EOF                           10270001
102800             INITIALIZE ASC-START-ITEM-REQUEST                    10280001
102900         END-IF                                                   10290001
103000     END-IF.                                                      10300001
103100                                                                  10310001
103200     PERFORM 2210-MOVE-LINES-TO-COMMAREA                          10320001
103300         VARYING PV-SUB FROM 1 BY 1                               10330001
103400         UNTIL PV-SUB > ASC-ITEMS-DISPLAYED.                      10340001
103500                                                                  10350001
103600******************************************************************10360001
103700** MOVE THE ENTERABLE FIELDS OF EACH LIST LINE INTO THE COMMAREA**10370001
103800******************************************************************10380001
103900 2210-MOVE-LINES-TO-COMMAREA.                                     10390001
105100                                                                  10510001
105200     ADD +1                        TO ASC-ITEM-SUB.               10520001
105300     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        10530001
105400         ADD +1                    TO ASC-BLK-SUB                 10540001
105500         MOVE +1                   TO ASC-ITEM-SUB                10550001
105600     END-IF.                                                      10560001
105700                                                                  10570001
105800******************************************************************10580001
105900** EDIT ALL OF THE DATA ON THE SCREEN AS IT RESIDES IN THE      **10590001
106000** COMMAREA (EDITTING IS NOT DONE AGAINST THE SCREEN DIRECTLY). **10600001
106100******************************************************************10610001
106200 3000-EDIT-DATA-IN-COMMAREA.                                      10620001
106300     PERFORM 3200-RESET-ATTRIBUTES.                               10630001
106400     SET PS-NO-ERROR               TO TRUE.                       10640001
106500     MOVE ASC-ITEMS-DISPLAYED      TO PV-SUB.                     10650001
106600                                                                  10660001
106700* CALCULATE THE POSITION OF THE LAST ITEM DISPLAYED.              10670001
106800* EDITTING IS DONE FROM THE BOTTOM UP.                            10680001
106900**                                                                10690001
107000     COMPUTE PV-ITEM-IN-USE = PV-TOP-ITEM +                       10700001
107100         ASC-ITEMS-DISPLAYED - 1.                                 10710001
107200     PERFORM 3100-SET-SUBSCRIPTS.                                 10720001
107300                                                                  10730001
107400      IF  PS-NO-ERROR                                             10740001
107500          PERFORM 3005-EDIT-COMMAREA-BLOCKS                       10750001
107600      END-IF.                                                     10760001
107700                                                                  10770001
107800     IF  PS-NO-ERROR                                              10780001
107900         PERFORM 3400-CHECK-RANGE-SEQUENCE                        10790001
108000     END-IF.                                                      10800001
108100                                                                  10810001
108200     IF  ((PS-NO-ERROR)                                           10820001
108300       AND (ASC-START-OF-SELECTED-RANGE > ZERO)                   10830001
108400       AND (ASC-END-OF-SELECTED-RANGE > ZERO))                    10840001
108500             PERFORM 3500-MARK-RANGE-AS-SELECTED                  10850001
108600     END-IF.                                                      10860001
108700                                                                  10870001
108800*----------------------------------------------------------------*10880001
108900* 3005-EDIT-COMMAREA-BLOCKS                                      *10890001
109000*----------------------------------------------------------------*10900001
109100 3005-EDIT-COMMAREA-BLOCKS.                                       10910001
109200     MOVE +1                       TO PV-BLOCK-NUMBER.            10920001
109300     MOVE +1                       TO ASC-BLK-SUB.                10930001
109400     MOVE PC-ITEMS-PER-PANEL       TO ASC-ITEM-SUB.               10940001
109500                                                                  10950001
109600     COMPUTE PV-BLOCK-NUMBER  =                                   10960001
109700             1 + ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) /            10970001
109800             PC-ITEMS-PER-PANEL.                                  10980001
109900                                                                  10990001
110000     MOVE  PV-BLOCK-NUMBER         TO PV-ORIGINAL-BLOCK.          11000001
110100                                                                  11010001
110200     PERFORM                                                      11020001
110300        UNTIL PV-BLOCK-NUMBER > ASC-HIGHEST-BLOCK-WRITTEN         11030001
110400           OR PS-ERROR                                            11040001
110500           OR PS-BLOCK-ERROR                                      11050001
110600                                                                  11060001
110700              COMPUTE PV-ITEMS-HOLD  =                            11070001
110800                      ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +       11080001
110900                      PC-ITEMS-PER-PANEL - 1                      11090001
111000                                                                  11100001
111100               IF  PV-ITEMS-HOLD  >  ASC-NUMBER-OF-ITEMS-READ     11110001
111200                   SUBTRACT  ASC-NUMBER-OF-ITEMS-READ             11120001
111300                       FROM  PV-ITEMS-HOLD                        11130001
111400                     GIVING  PV-ITEMS-DIFF                        11140001
111500                   SUBTRACT  PV-ITEMS-DIFF                        11150001
111600                       FROM  PC-ITEMS-PER-PANEL                   11160001
111700                     GIVING  PV-ITEMS-HOLD                        11170001
111800                       MOVE  PV-ITEMS-HOLD TO PV-SUB              11180001
111900                                              ASC-ITEM-SUB        11190001
112000                                              ASC-ITEMS-DISPLAYED 11200001
112100               ELSE                                               11210001
112200                   MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB            11220001
112300                   MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB      11230001
112400               END-IF                                             11240001
112500                                                                  11250001
112600               PERFORM 3300-EDIT-SELECTIONS                       11260001
112700                       VARYING PV-SUB                             11270001
112800                          FROM PV-SUB BY -1                       11280001
112900                          UNTIL PV-SUB < +1                       11290001
113000                                                                  11300001
113100               MOVE +1               TO ASC-BLK-SUB               11310001
113200                                                                  11320001
113300               PERFORM 5105-REWRITE-ASC-LISTQ                     11330001
113400                                                                  11340001
113500               MOVE +1                TO ASC-BLK-SUB              11350001
113600                                                                  11360001
113700               IF  PS-BLOCK-ERROR                                 11370001
113800                   SET  PS-ERROR     TO TRUE                      11380001
113900                   MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)      11390001
114000                                     TO PV-TOP-ITEM               11400001
114100               ELSE                                               11410001
114200                   ADD  +1           TO PV-BLOCK-NUMBER           11420001
114300                   IF  PV-BLOCK-NUMBER >                          11430001
114400                       ASC-HIGHEST-BLOCK-WRITTEN                  11440001
114500                       MOVE +2       TO ASC-BLK-SUB               11450001
114600                       PERFORM 4410-READ-TEMP-STORAGE             11460001
114700                       MOVE +1       TO ASC-BLK-SUB               11470001
114800                   ELSE                                           11480001
114900                       PERFORM 4410-READ-TEMP-STORAGE             11490001
115000                       ADD  +1        TO PV-BLOCK-NUMBER          11500001
115100                       MOVE +2        TO ASC-BLK-SUB              11510001
115200                       PERFORM 4410-READ-TEMP-STORAGE             11520001
115300                       SUBTRACT +1  FROM PV-BLOCK-NUMBER          11530001
115400                       MOVE +1        TO ASC-BLK-SUB              11540001
115500               END-IF                                             11550001
115600           END-IF                                                 11560001
115700     END-PERFORM.                                                 11570001
115800                                                                  11580001
115900     IF  (PV-ORIGINAL-BLOCK  = +1   AND                           11590001
116000          ASC-LIST-ITEM-NUMBER (1 1) = 1)  OR                     11600001
116100         PS-ERROR                   OR                            11610001
116200         PS-BLOCK-ERROR                                           11620001
116300             CONTINUE                                             11630001
116400     ELSE                                                         11640001
116500         MOVE +1                 TO PV-BLOCK-NUMBER               11650001
116600         MOVE +1                 TO ASC-BLK-SUB                   11660001
116700         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  11670001
116800         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEMS-DISPLAYED           11680001
116900         PERFORM 4410-READ-TEMP-STORAGE                           11690001
117000                                                                  11700001
117100         PERFORM                                                  11710001
117200            UNTIL PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK             11720001
117300               OR PS-ERROR                                        11730001
117400               OR PS-BLOCK-ERROR                                  11740001
117500                                                                  11750001
117600                  COMPUTE PV-ITEMS-HOLD  =                        11760001
117700                          ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1) +   11770001
117800                          PC-ITEMS-PER-PANEL - 1                  11780001
117900                                                                  11790001
118000                  IF  PV-ITEMS-HOLD > ASC-NUMBER-OF-ITEMS-READ    11800001
118100                      SUBTRACT  ASC-NUMBER-OF-ITEMS-READ          11810001
118200                          FROM  PV-ITEMS-HOLD                     11820001
118300                        GIVING  PV-ITEMS-DIFF                     11830001
118400                      SUBTRACT  PV-ITEMS-DIFF                     11840001
118500                          FROM  PC-ITEMS-PER-PANEL                11850001
118600                        GIVING  PV-ITEMS-HOLD                     11860001
118700                          MOVE  PV-ITEMS-HOLD TO PV-SUB           11870001
118800                                                 ASC-ITEM-SUB     11880001
118900                                              ASC-ITEMS-DISPLAYED 11890001
119000                  ELSE                                            11900001
119100                      MOVE ASC-ITEMS-DISPLAYED  TO PV-SUB         11910001
119200                      MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB   11920001
119300                  END-IF                                          11930001
119400                                                                  11940001
119500                  PERFORM 3300-EDIT-SELECTIONS                    11950001
119600                          VARYING PV-SUB                          11960001
119700                             FROM PV-SUB BY -1                    11970001
119800                            UNTIL PV-SUB < +1                     11980001
119900                                                                  11990001
120000                  MOVE +1               TO ASC-BLK-SUB            12000001
120100                                                                  12010001
120200                  PERFORM 5105-REWRITE-ASC-LISTQ                  12020001
120300                                                                  12030001
120400                  MOVE +1                TO ASC-BLK-SUB           12040001
120500                                                                  12050001
120600                  IF  PS-BLOCK-ERROR                              12060001
120700                      SET  PS-ERROR     TO TRUE                   12070001
120800                      MOVE ASC-LIST-ITEM-NUMBER (ASC-BLK-SUB 1)   12080001
120900                                        TO PV-TOP-ITEM            12090001
121000                  ELSE                                            12100001
121100                      ADD  +1            TO PV-BLOCK-NUMBER       12110001
121200                      IF  PV-BLOCK-NUMBER = PV-ORIGINAL-BLOCK     12120001
121300                          MOVE +2        TO ASC-BLK-SUB           12130001
121400                          PERFORM 4410-READ-TEMP-STORAGE          12140001
121500                          MOVE +1        TO ASC-BLK-SUB           12150001
121600                      ELSE                                        12160001
121700                          PERFORM 4410-READ-TEMP-STORAGE          12170001
121800                          ADD  +1        TO PV-BLOCK-NUMBER       12180001
121900                          MOVE +2        TO ASC-BLK-SUB           12190001
122000                          PERFORM 4410-READ-TEMP-STORAGE          12200001
122100                          SUBTRACT +1  FROM PV-BLOCK-NUMBER       12210001
122200                          MOVE +1        TO ASC-BLK-SUB           12220001
122300                      END-IF                                      12230001
122400                  END-IF                                          12240001
122500     END-PERFORM.                                                 12250001
122600     MOVE +0 TO PV-ITEMS-HOLD.                                    12260001
122700                                                                  12270001
122800*----------------------------------------------------------------*12280001
122900*    DETERMINE THE VALUE OF THE ITEM SUBSCRIPT BASED ON THE ITEM *12290001
123000*    CURRENTLY IN USE AND THE FIRST ITEM IN THE ARRAY.  THIS WILL*12300001
123100*    POSITION US IN THE 1ST BLOCK OF THE ARRAY.                  *12310001
123200*                                                                *12320001
123300*    IF THE ITEM SUBSCRIPT EXCEEDS THE MAXIMUM NUMBER OF ITEMS   *12330001
123400*    IN A BLOCK, RECALCULATE THE SUBSCRIPT BY SUBTRACTING OUT    *12340001
123500*    THE MAXIMUM NUMBER OF ITEMS.  THIS WILL CORRECTLY POSITION  *12350001
123600*    US IN THE 2ND BLOCK OF THE ARRAY.                           *12360001
123700*----------------------------------------------------------------*12370001
123800 3100-SET-SUBSCRIPTS.                                             12380001
123900     COMPUTE ASC-ITEM-SUB =                                       12390001
124000         (PV-ITEM-IN-USE - ASC-LIST-ITEM-NUMBER(1 1)) + 1.        12400001
124100                                                                  12410001
124200     IF ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                         12420001
124300         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            12430001
124400         MOVE PC-MAX-BLOCKS-IN-ARRAY TO ASC-BLK-SUB               12440001
124500     ELSE                                                         12450001
124600         MOVE +1                     TO ASC-BLK-SUB               12460001
124700     END-IF.                                                      12470001
124800                                                                  12480001
124900******************************************************************12490001
125000** RESET THE ATTRIBUTES OF ALL ENTERABLE FIELDS ON THE MAP.     **12500001
125100******************************************************************12510001
125200 3200-RESET-ATTRIBUTES.                                           12520001
125300     MOVE DP015-UNP-ALP-NOR-OFF    TO ASTRTITA.                   12530001
125400     MOVE DP015-GREEN              TO ASTRTITC.                   12540001
125500     MOVE DP015-UNDERLINE          TO ASTRTITH.                   12550001
125600                                                                  12560001
126600                                                                  12660001
126700******************************************************************12670001
126800** EDIT THE SELECTIONS MADE.  NOTE THAT THE 'SELECTED-SW' IS    **12680001
126900** WHAT WAS PREVIOUSLY CHECKED AND CORRECT 'TEMP-SELECTED-SW'   **12690001
127000** IS WHAT HAS JUST BEEN ENTERED AND HAS NOT BEEN EDITTED OR    **12700001
127100** WAS ENTERED EARLIER, BUT DID NOT PASS THE EDITS.             **12710001
127200******************************************************************12720001
127300 3300-EDIT-SELECTIONS.                                            12730001
127400     EVALUATE TRUE                                                12740001
127500         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12750001
127600             = ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)         12760001
127700                 CONTINUE                                         12770001
127800         WHEN ASC-TEMP-SELECT  (ASC-BLK-SUB ASC-ITEM-SUB)         12780001
127900             IF  NOT ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)        12790001
128000                 ADD +1         TO ASC-NUMBER-OF-SELECTED-ITEMS   12800001
128100                 MOVE ASC-TEMP-SELECTED-SW                        12810001
128200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12820001
128300                                TO ASC-SELECTED-SW                12830001
128400                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12840001
128500             END-IF                                               12850001
128600         WHEN ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)     12860001
128700                 = SPACE                                          12870001
128800             EVALUATE TRUE                                        12880001
128900                 WHEN ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)       12890001
129000                     SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS12900001
129100                     MOVE SPACE TO ASC-SELECTED-SW                12910001
129200                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12920001
129300                 WHEN ASC-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)        12930001
129400                     MOVE ZERO  TO ASC-START-OF-SELECTED-RANGE    12940001
129500                     MOVE SPACE TO ASC-SELECTED-SW                12950001
129600                                      (ASC-BLK-SUB ASC-ITEM-SUB)  12960001
129700                 WHEN ASC-END (ASC-BLK-SUB ASC-ITEM-SUB)          12970001
129800                     MOVE ZERO  TO ASC-END-OF-SELECTED-RANGE      12980001
129900                     MOVE SPACE TO ASC-SELECTED-SW                12990001
130000                                      (ASC-BLK-SUB ASC-ITEM-SUB)  13000001
130100             END-EVALUATE                                         13010001
130200         WHEN ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)           13020001
130300             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13030001
130400                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    13040001
130500             END-IF                                               13050001
130600             PERFORM 3310-EDIT-RANGE                              13060001
130700         WHEN ASC-TEMP-END (ASC-BLK-SUB ASC-ITEM-SUB)             13070001
130800             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13080001
130900                 SUBTRACT +1 FROM ASC-NUMBER-OF-SELECTED-ITEMS    13090001
131000             END-IF                                               13100001
131100             PERFORM 3310-EDIT-RANGE                              13110001
131200         WHEN OTHER                                               13120001
131300             MOVE PC-TSYMSG-00005   TO DP020-MSG-NUMBER           13130001
131400             SET DP020-MSG-FATAL    TO TRUE                       13140001
131500             MOVE -1                TO ASTRTITL                   13150001
131600             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  13160001
131900             SET PS-ERROR TO TRUE                                 13190001
132000             IF  ASC-SELECT (ASC-BLK-SUB ASC-ITEM-SUB)            13200001
132100                 SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS     13210001
132200                 MOVE SPACE         TO ASC-SELECTED-SW            13220001
132300                                        (ASC-BLK-SUB ASC-ITEM-SUB)13230001
132400             END-IF                                               13240001
132500     END-EVALUATE.                                                13250001
132600                                                                  13260001
132700     SUBTRACT +1             FROM PV-ITEM-IN-USE.                 13270001
132800     SUBTRACT +1 FROM ASC-ITEM-SUB.                               13280001
132900     IF  ASC-ITEM-SUB < 1                                         13290001
133000         SUBTRACT +1 FROM ASC-BLK-SUB                             13300001
133100         MOVE PC-ITEMS-PER-PANEL   TO ASC-ITEM-SUB                13310001
133200     END-IF.                                                      13320001
133300                                                                  13330001
133400******************************************************************13340001
133500** IF A BEGINNING AND END OF RANGE WAS ENTERED TO SELECT A      **13350001
133600** RANGE OF LINES, MAKE SURE THERE IS ONLY 1 BEGINNING AND 1    **13360001
133700** ENDING AND MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN)**13370001
133800** THE ENDING.                                                  **13380001
133900******************************************************************13390001
134000 3310-EDIT-RANGE.                                                 13400001
134100     IF  ASC-TEMP-BEGIN (ASC-BLK-SUB ASC-ITEM-SUB)                13410001
134200         IF  ASC-START-OF-SELECTED-RANGE = ZERO                   13420001
134300             MOVE ASC-TEMP-SELECTED-SW  (ASC-BLK-SUB ASC-ITEM-SUB)13430001
134400                                   TO ASC-SELECTED-SW             13440001
134500                                        (ASC-BLK-SUB ASC-ITEM-SUB)13450001
134600             MOVE PV-ITEM-IN-USE   TO ASC-START-OF-SELECTED-RANGE 13460001
134700         ELSE                                                     13470001
134800             IF  ASC-START-OF-SELECTED-RANGE = PV-ITEM-IN-USE     13480001
134900                 CONTINUE                                         13490001
135000             ELSE                                                 13500001
135100*                -- ONLY ONE BEGINNING-OF-RANGE-ALLOWED --        13510001
135200                 MOVE PC-TSYMSG-00054                             13520001
135300                                   TO DP020-MSG-NUMBER            13530001
135400                 SET DP020-MSG-FATAL                              13540001
135500                                   TO TRUE                        13550001
135600                 MOVE -1           TO ASTRTITL                    13560001
135700                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              13570001
135800*                MOVE DP015-RED    TO MR-SELECTC (PV-SUB)         13580009
135900*                MOVE DP015-UNDERLINE TO MR-SELECTH (PV-SUB)      13590009
136000                 SET PS-ERROR      TO TRUE                        13600001
136100             END-IF                                               13610001
136200         END-IF                                                   13620001
136300     ELSE                                                         13630001
136400         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     13640001
136500             MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 13650001
136600                                   TO ASC-SELECTED-SW             13660001
136700                                     (ASC-BLK-SUB ASC-ITEM-SUB)   13670001
136800             MOVE PV-ITEM-IN-USE   TO ASC-END-OF-SELECTED-RANGE   13680001
136900         ELSE                                                     13690001
137000             IF  ASC-END-OF-SELECTED-RANGE = PV-ITEM-IN-USE       13700001
137100                 CONTINUE                                         13710001
137200             ELSE                                                 13720001
137300*                -- ONLY ONE END-OF-RANGE ALLOWED --              13730001
137400                 MOVE PC-TSYMSG-00055                             13740001
137500                                   TO DP020-MSG-NUMBER            13750001
137600                 SET DP020-MSG-FATAL                              13760001
137700                                   TO TRUE                        13770001
137800                 MOVE -1           TO ASTRTITL                    13780001
137900                 SET DP030-SET-CURSOR-APPL-1                      13790001
138000                                   TO TRUE                        13800001
138100                 SET PS-ERROR      TO TRUE                        13810001
138200             END-IF                                               13820001
138300         END-IF                                                   13830001
138400     END-IF.                                                      13840001
138500*                                                                 13850001
138600******************************************************************13860001
138700** IF BOTH A BEGINNING AND END OF RANGE HAVE BEEN SPECIFIED,    **13870001
138800** MAKE SURE THAT THE BEGINNING IS BEFORE (LESS THAN) THE END.  **13880001
138900******************************************************************13890001
139000 3400-CHECK-RANGE-SEQUENCE.                                       13900001
139100     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       13910001
139200       AND  ASC-END-OF-SELECTED-RANGE > ZERO                      13920001
139300       AND  ASC-START-OF-SELECTED-RANGE >                         13930001
139400                                         ASC-END-OF-SELECTED-RANGE13940001
139500*        -- END-OF-RANGE BEFORE BEGINNING-OF-RANGE                13950001
139600         MOVE PC-TSYMSG-00052 TO DP020-MSG-NUMBER                 13960001
139700         SET DP020-MSG-FATAL TO TRUE                              13970001
139800         SET PS-ERROR TO TRUE                                     13980001
139900         PERFORM 3410-POSITION-AT-ERROR                           13990001
140000     END-IF.                                                      14000001
140100                                                                  14010001
140200******************************************************************14020001
140300** BECAUSE RANGES CAN SPAN ACROSS MULTIPLE PAGES, A SEPARATE    **14030001
140400** PARAGRAPH (THIS ONE) IS NEEDED TO DETERMINE WHERE THE CURSOR **14040001
140500** SHOULD BE POSITIONED ON A RANGE ERROR.                       **14050001
140600******************************************************************14060001
140700 3410-POSITION-AT-ERROR.                                          14070001
140800     SET DP030-SET-CURSOR-APPL-1   TO TRUE.                       14080001
140900     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 14090001
141000                    - PV-TOP-ITEM + 1.                            14100001
141100*    IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      14110009
141200*        CONTINUE                                                 14120009
141300*    ELSE                                                         14130009
141400*        MOVE -1                   TO MR-SELECTL (PV-SUB)         14140009
141500*        MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         14150009
141600*        MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         14160009
141700*    END-IF.                                                      14170009
141800                                                                  14180001
141900     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   14190001
142000                    - PV-TOP-ITEM + 1.                            14200001
142100*    IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      14210009
142200*        CONTINUE                                                 14220009
142300*    ELSE                                                         14230009
142400*        MOVE -1                   TO MR-SELECTL (PV-SUB)         14240009
142500*        MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         14250009
142600*        MOVE DP015-RED            TO MR-SELECTC (PV-SUB)         14260009
142700*    END-IF.                                                      14270009
142800                                                                  14280001
142900*----------------------------------------------------------------*14290001
143000*    WHENEVER THE USER SELECTS AN ITEM AS THE BEGINNING RANGE    *14300001
143100*    AND ONE AS THE ENDING RANGE, MARK THESE ITEMS AS WELL AS    *14310001
143200*    THOSE THAT FALL IN THE RANGE AS BEING SELECTED.             *14320001
143300*----------------------------------------------------------------*14330001
143400 3500-MARK-RANGE-AS-SELECTED.                                     14340001
143500     MOVE +1                       TO  ASC-BLK-SUB.               14350001
143600     PERFORM 3510-MARK-SELECTED-INDS                              14360001
143700         VARYING ASC-ITEM-SUB                                     14370001
143800         FROM 1 BY 1                                              14380001
143900         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14390001
144000                                                                  14400001
144100     ADD +1                        TO ASC-BLK-SUB.                14410001
144200     PERFORM 3510-MARK-SELECTED-INDS                              14420001
144300         VARYING ASC-ITEM-SUB                                     14430001
144400         FROM 1 BY 1                                              14440001
144500         UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL.                 14450001
144600                                                                  14460001
144700     MOVE ASC-LIST-ITEM-NUMBER(1 1)                               14470001
144800                                   TO  PV-LIST-ITEM-NUMBER.       14480001
144900     COMPUTE PV-FIRST-BLOCK-IN-ARRAY =                            14490001
145000         1 + ((PV-LIST-ITEM-NUMBER - 1) /                         14500001
145100               PC-ITEMS-PER-PANEL).                               14510001
145200                                                                  14520001
145300     MOVE ASC-START-OF-SELECTED-RANGE                             14530001
145400                                   TO PV-START-OF-SELECTED-RANGE. 14540001
145500     COMPUTE PV-FIRST-BLOCK-IN-RANGE =                            14550001
145600         1 + ((PV-START-OF-SELECTED-RANGE - 1) /                  14560001
145700               PC-ITEMS-PER-PANEL).                               14570001
145800                                                                  14580001
145900     MOVE ASC-END-OF-SELECTED-RANGE                               14590001
146000                                   TO  PV-END-OF-SELECTED-RANGE.  14600001
146100     COMPUTE PV-LAST-BLOCK-IN-RANGE =                             14610001
146200         1 + ((PV-END-OF-SELECTED-RANGE - 1) /                    14620001
146300               PC-ITEMS-PER-PANEL).                               14630001
146400     COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                             14640001
146500         PV-FIRST-BLOCK-IN-ARRAY + 1.                             14650001
146600                                                                  14660001
146700     IF (PV-FIRST-BLOCK-IN-RANGE < PV-FIRST-BLOCK-IN-ARRAY) OR    14670001
146800        (PV-LAST-BLOCK-IN-RANGE  > PV-NEXT-BLOCK-IN-ARRAY)        14680001
146900         MOVE +1                   TO ASC-BLK-SUB                 14690001
147000         PERFORM 5100-WRITE-TEMP-STORAGE                          14700001
147100         COMPUTE PV-PREV-BLOCK-IN-ARRAY =                         14710001
147200             PV-FIRST-BLOCK-IN-ARRAY - 1                          14720001
147300                                                                  14730001
147400         PERFORM                                                  14740001
147500             UNTIL PV-FIRST-BLOCK-IN-RANGE >                      14750001
147600                   PV-PREV-BLOCK-IN-ARRAY                         14760001
147700             MOVE PV-FIRST-BLOCK-IN-RANGE                         14770001
147800                                   TO PV-BLOCK-NUMBER             14780001
147900             PERFORM 4410-READ-TEMP-STORAGE                       14790001
148000             PERFORM 3510-MARK-SELECTED-INDS                      14800001
148100                 VARYING ASC-ITEM-SUB                             14810001
148200                 FROM 1 BY 1                                      14820001
148300                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14830001
148400             PERFORM 5100-WRITE-TEMP-STORAGE                      14840001
148500             ADD +1                TO PV-FIRST-BLOCK-IN-RANGE     14850001
148600         END-PERFORM                                              14860001
148700                                                                  14870001
148800         COMPUTE PV-NEXT-BLOCK-IN-ARRAY =                         14880001
148900             PV-FIRST-BLOCK-IN-ARRAY + PC-MAX-BLOCKS-IN-ARRAY     14890001
149000         PERFORM                                                  14900001
149100             UNTIL PV-NEXT-BLOCK-IN-ARRAY >                       14910001
149200                   PV-LAST-BLOCK-IN-RANGE                         14920001
149300             MOVE PV-NEXT-BLOCK-IN-ARRAY                          14930001
149400                                   TO PV-BLOCK-NUMBER             14940001
149500             PERFORM 4410-READ-TEMP-STORAGE                       14950001
149600             PERFORM 3510-MARK-SELECTED-INDS                      14960001
149700                 VARYING ASC-ITEM-SUB                             14970001
149800                 FROM 1 BY 1                                      14980001
149900                 UNTIL ASC-ITEM-SUB > PC-ITEMS-PER-PANEL          14990001
150000             PERFORM 5100-WRITE-TEMP-STORAGE                      15000001
150100             ADD +1                TO PV-NEXT-BLOCK-IN-ARRAY      15010001
150200         END-PERFORM                                              15020001
150300                                                                  15030001
150400         MOVE PV-FIRST-BLOCK-IN-ARRAY                             15040001
150500                                   TO PV-BLOCK-NUMBER             15050001
150600         PERFORM 4410-READ-TEMP-STORAGE                           15060001
150700     END-IF.                                                      15070001
150800                                                                  15080001
150900     MOVE +0                       TO ASC-START-OF-SELECTED-RANGE 15090001
151000                                      ASC-END-OF-SELECTED-RANGE.  15100001
151100                                                                  15110001
151200*----------------------------------------------------------------*15120001
151300* SET THE SELECTION INDICATOR TO 'S' WITHIN THE RANGE.           *15130001
151400*----------------------------------------------------------------*15140001
151500 3510-MARK-SELECTED-INDS.                                         15150001
151600     IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         15160001
151700                                ASC-ITEM-SUB) >                   15170001
151800         ASC-START-OF-SELECTED-RANGE)                             15180001
151900     OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                         15190001
152000                                ASC-ITEM-SUB) =                   15200001
152100         ASC-START-OF-SELECTED-RANGE)                             15210001
152200                                                                  15220001
152300         IF (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     15230001
152400                                    ASC-ITEM-SUB) <               15240001
152500             ASC-END-OF-SELECTED-RANGE)                           15250001
152600         OR (ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB                     15260001
152700                                    ASC-ITEM-SUB) =               15270001
152800             ASC-END-OF-SELECTED-RANGE)                           15280001
152900                                                                  15290001
153000             IF NOT ASC-SELECT(ASC-BLK-SUB ASC-ITEM-SUB)          15300001
153100                 SET ASC-SELECT     (ASC-BLK-SUB  ASC-ITEM-SUB)   15310001
153200                     ASC-TEMP-SELECT(ASC-BLK-SUB  ASC-ITEM-SUB)   15320001
153300                               TO TRUE                            15330001
153400                 SET ASC-BLOCK-MODIFIED(ASC-BLK-SUB)              15340001
153500                               TO TRUE                            15350001
153600                 ADD +1        TO ASC-NUMBER-OF-SELECTED-ITEMS    15360001
153700             END-IF                                               15370001
153800         END-IF                                                   15380001
153900     END-IF.                                                      15390001
154000                                                                  15400001
154100*----------------------------------------------------------------*15410001
154200*    INITIALIZE BOTH BLOCKS IN THE ARRAY.                        *15420001
154300*    INITIALIZE ALL COUNTERS AND FLAGS.                          *15430001
154400*    READ THE DATA BASE FOR THE 1ST TIME AND FILL UP THE ARRAY.  *15440001
154500*    DISPLAY THE PANEL TO USER.                                  *15450001
154600*----------------------------------------------------------------*15460001
154700 4000-BUILD-INITIAL-PANEL.                                        15470001
154800     INITIALIZE                  ASC-BLOCK-ENTRIES (1)            15480001
154900                                 ASC-BLOCK-ENTRIES (2).           15490001
155000     MOVE +1                   TO ASC-BLK-SUB.                    15500001
155100     SET ASC-ITEMS-LEFT-ON-DB  TO TRUE.                           15510001
155200                                                                  15520001
155300     MOVE +0                 TO ASC-ITEM-SUB                      15530001
155400                                ASC-NUMBER-OF-ITEMS-READ          15540001
155500                                ASC-NUMBER-OF-SELECTED-ITEMS      15550001
155600                                ASC-HIGHEST-BLOCK-WRITTEN         15560001
155700                                ASC-START-OF-SELECTED-RANGE       15570001
155800                                ASC-END-OF-SELECTED-RANGE         15580001
155900                                ASC-ITEM-AT-TOP-OF-PANEL.         15590001
156000                                                                  15600001
156010                                                                  15601007
156020     PERFORM 4001-POPULATE-HEADER.                                15602007
156100                                                                  15610001
156300     PERFORM 4100-PREPARE-CURSOR                                  15630005
156400     PERFORM 4010-OPEN-CURSOR                                     15640005
156500     PERFORM 4300-READ-ITEMS-FROM-DB                              15650005
156600     PERFORM 4020-CLOSE-CURSOR                                    15660005
157300                                                                  15730001
157400     MOVE +1                   TO  PV-TOP-ITEM.                   15740001
157500     IF  ASC-NUMBER-OF-ITEMS-READ = ZERO                          15750001
157600         SET DP020-NEXT-ACT-APPL-ERROR TO TRUE                    15760001
157700         SET DP020-MSG-FATAL   TO  TRUE                           15770001
157800         MOVE PC-TSYMSG-00050  TO  DP020-MSG-NUMBER               15780001
157900     ELSE                                                         15790001
158000*        MOVE -1               TO MR-SELECTL (1)                  15800009
158100         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      15810001
158200         PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                     15820001
158300     END-IF.                                                      15830001
158400                                                                  15840001
158410*----------------------------------------------------------------*15841007
158430*  PERFORM QUERRIES NECCESSARY TO POPLATE DATA AT TOP OF SCREEN  *15843013
158460*----------------------------------------------------------------*15846007
158470 4001-POPULATE-HEADER.                                            15847007
158471**   MOVE SU100-OPER-UNIT TO ASC-OPER-UNIT.                       15847199
158472**   MOVE SU100-CARTON-ID TO ASC-CART-ID.                         15847299
158480     PERFORM 4005-GET-CARTON-INFO.                                15848012
158481     MOVE SUT00102-PO-NBR       TO ASC-PO.                        15848199
158482     MOVE SUT00102-RCVR-SEQ-NBR TO ASC-RECEIVER.                  15848299
158483     MOVE ASC-PO(02:08)         TO APORCVRO(01:08).               15848399
158484     MOVE '-'                   TO APORCVRO(09:01).               15848499
158485     MOVE ASC-RECEIVER(02:03)   TO APORCVRO(10:03).               15848599
158486     MOVE SUT00102-PO-LNE-NBR   TO ASC-LINE-NO                    15848699
158487     MOVE SUT00102-PREPK-ID     TO ASC-PACK-ID                    15848799
158489                                                                  15848970
158490     PERFORM 4030-GET-RCVR-PACK-TYPE.                             15849070
158493     MOVE ASC-LINE-NO           TO ALINENOO.                      15849356
158494     MOVE ASC-PACK-ID           TO APACKIDO.                      15849456
158495                                                                  15849581
158496     MOVE -1                    TO ASTRTITL                       15849681
158497                                                                  15849764
158498     MOVE SUT00102-SHIPT-UNT-ID TO ASC-SHIPT-UNT-ID.              15849864
158499     MOVE ASC-SHIPT-UNT-ID      TO DK-SHIPT-UNT-ID-PACKED.        15849964
158500     IF SUT00102-SHIPT-UNT-ID > 0                                 15850099
158501         PERFORM 4006-GET-CART-SOURCE-CODE                        15850158
158502         MOVE SUT00024-CART-SRC-CDE TO ACRESRCO                   15850276
158503                                       ASC-CRE-SRC                15850376
158504     ELSE                                                         15850465
158505         MOVE 'P2L'                 TO ACRESRCO                   15850576
158506                                       ASC-CRE-SRC                15850676
158507     END-IF.                                                      15850765
158510                                                                  15851056
158542*----------------------------------------------------------------*15854259
158543*   SELECT CARTON ID FROM SUT_CART_DIRV_TRKG                      15854359
158544*----------------------------------------------------------------*15854459
158545 4005-GET-CARTON-INFO.                                            15854559
158546                                                                  15854659
158547     MOVE ASC-OPER-UNIT   TO AOPUNITO                             15854799
158549                             DK-OPER-UNT-ID.                      15854959
158550     MOVE ASC-CART-ID     TO ACARTIDO                             15855099
158552                             DK-CART-ID.                          15855199
158554     MOVE ASC-CART-ID     TO DK-CART-ID.                          15856059
158555     MOVE ASC-CART-ID-P   TO DK-CART-ID-PACKED.                   15856159
158556                                                                  15856259
158557     EXEC SQL                                                     15856359
158558           SELECT DISTINCT PO_NBR                                 15856459
158559                 ,PO_LNE_NBR                                      15856559
158560                 ,PREPK_ID                                        15856659
158561                 ,RCVR_SEQ_NBR                                    15856759
158562                 ,SHIPT_UNT_ID                                    15856864
      *CLP 01/25/14                                                     15856999
                       ,AUD_CNTL_NBR                                    15857099
158564             INTO :SUT00102-PO-NBR                                15857159
158565                 ,:SUT00102-PO-LNE-NBR                            15857259
158566                 ,:SUT00102-PREPK-ID                              15857359
158567                 ,:SUT00102-RCVR-SEQ-NBR                          15857459
158568                , :SUT00102-SHIPT-UNT-ID                          15857564
158568                , :SUT00102-AUD-CNTL-NBR                          15857699
158569             FROM SUT_CART_DIRV_TRKG A                            15857799
158570            WHERE A.OPER_UNT_ID  = :DK-OPER-UNT-ID                15857899
158571              AND (                                               15857999
158572                  BRCDE_NBR      = :DK-CART-ID                    15858099
158573                    OR                                            15858199
158574                  SHIPT_UNT_ID   = :DK-CART-ID-PACKED             15858299
158575                                                       )          15858399
158576              AND CRE_TMST  =                                     15858499
158577                    (  SELECT MAX(CRE_TMST)                       15858599
158578                       FROM SUT_CART_DIRV_TRKG                    15858699
158579                      WHERE (                                     15858799
158580                            BRCDE_NBR      = :DK-CART-ID          15858899
158581                              OR                                  15858999
158582                            SHIPT_UNT_ID   = :DK-CART-ID-PACKED)) 15859099
158584           WITH UR                                                15859199
158585     END-EXEC                                                     15859299
158586                                                                  15859399
158587     EVALUATE TRUE                                                15859499
158588         WHEN SQLCODE = ZERO                                      15859599
158589             CONTINUE                                             15859699
158590         WHEN SQLWARN0 NOT = SPACES                               15859799
158591         WHEN SQLCODE < ZERO                                      15859899
158592         WHEN SQLCODE > ZERO                                      15859999
158593             MOVE '4005-GET-CARTON-INFO' TO DP013-PARAGRAPH       15860099
158594             MOVE 'SELECT FOR CARTON ID '                         15860199
158595                               TO DP013-MESSAGE-TEXT (1)          15860299
158596             MOVE SQLCA        TO DP013-SQLCA                     15860399
158597             MOVE 'SUT_CART_DIRV_TRKG'                            15860499
158598                               TO DP013-DB2-TABLE-NAME (1)        15860599
158599             SET DP013-DB2-ABEND                                  15860699
158600                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15860799
158601             PERFORM DP013-0000-PROCESS-ABEND                     15860899
158602     END-EVALUATE.                                                15860999
158603                                                                  15861099
      *CLP 01/25/14 START                                               15861199
           PERFORM 4307-CHECK-FOR-CARTON-HLITE.                         15861299
           IF ASC-HIGHLIGHT-CARTON                                      15861399
205800         MOVE DP015-YELLOW           TO ACARTIDC                  15861499
           ELSE                                                         15861599
205800         MOVE DP015-BLUE             TO ACARTIDC                  15861699
           END-IF.                                                      15861799
      *CLP 01/25/14 END                                                 15861899
158553                                                                  15861999
158604*----------------------------------------------------------------*15862099
158605*   SELECT CART_SRC_CDE FROM SUT_OTBND_CART                       15862199
158606*----------------------------------------------------------------*15862299
158607 4006-GET-CART-SOURCE-CODE.                                       15862399
158608     EXEC SQL                                                     15862499
158609           SELECT CART_SRC_CDE                                    15862599
158610             INTO :SUT00024-CART-SRC-CDE                          15862699
158611             FROM SUT_OTBND_CART     A                            15862799
158612            WHERE SHIPT_UNT_ID   = :SUT00102-SHIPT-UNT-ID         15862899
158613           WITH UR                                                15862999
158614                                                                  15863099
158615     END-EXEC                                                     15863199
158616                                                                  15863299
158617     EVALUATE TRUE                                                15863399
158618         WHEN SQLCODE = ZERO                                      15863499
158619             CONTINUE                                             15863599
158620         WHEN SQLCODE = +100                                      15863699
158621             MOVE SPACE TO SUT00024-CART-SRC-CDE                  15863799
158622         WHEN SQLWARN0 NOT = SPACES                               15863899
158623         WHEN SQLCODE < ZERO                                      15863999
158624         WHEN SQLCODE > ZERO                                      15864099
158625             MOVE '4006-GET-CART-SOURCE-CODE'                     15864199
158626                                         TO DP013-PARAGRAPH       15864299
158627             MOVE 'SELECT FROM SUT_OTBND_CART'                    15864399
158628                               TO DP013-MESSAGE-TEXT (1)          15864499
158629             MOVE SQLCA        TO DP013-SQLCA                     15864599
158630             MOVE 'SUT_OTBND_CART    '                            15864699
158631                               TO DP013-DB2-TABLE-NAME (1)        15864799
158632             SET DP013-DB2-ABEND                                  15864899
158633                 DP013-XCTL-DISPLAY-RESTART TO TRUE               15864999
158634             PERFORM DP013-0000-PROCESS-ABEND                     15865099
158635     END-EVALUATE.                                                15865199
158636                                                                  15865299
158637*----------------------------------------------------------------*15865399
158640* OPEN THE CURSOR.                                               *15866001
158700*   IN THIS PARTICULAR APPLICATION ONE OF 3 DIFFERENT CURSORS    *15870001
158800*   WILL BE OPENED DEPENDING ON THE CRITERIA SPECIFIED BY THE    *15880001
158900*   ASSOCIATE.                                                   *15890001
159000*----------------------------------------------------------------*15900001
159100 4010-OPEN-CURSOR.                                                15910001
159200     PERFORM                                                      15920001
159300         WITH TEST AFTER                                          15930001
159400         VARYING PV-RETRY-COUNTER                                 15940001
159500         FROM 1 BY 1                                              15950001
159600         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               15960001
159700                   OR (SQLCODE = ZERO))                           15970001
159800                                                                  15980001
160100             MOVE 'CURSOR:  CART-CSR'                             16010006
160200                                   TO DP013-MESSAGE-TEXT (2)      16020006
160300             EXEC SQL                                             16030006
160400                 OPEN CART-CSR                                    16040006
160500             END-EXEC                                             16050006
160600                                                                  16060001
162200                                                                  16220001
162300         EVALUATE TRUE                                            16230001
162400             WHEN SQLCODE = ZERO                                  16240001
162500             WHEN SQLCODE = -904                                  16250001
162600             WHEN SQLCODE = -913                                  16260001
162700                 CONTINUE                                         16270001
162800             WHEN SQLWARN0 NOT = SPACES                           16280001
162900             WHEN SQLCODE < ZERO                                  16290001
163000             WHEN SQLCODE > ZERO                                  16300001
163110                 MOVE '4010-OPEN-CURSOR' TO DP013-PARAGRAPH       16311006
163200                 MOVE 'UNABLE TO OPEN A CURSOR -'                 16320001
163300                                   TO DP013-MESSAGE-TEXT (1)      16330001
163400                 MOVE SQLCA        TO DP013-SQLCA                 16340001
163500                 MOVE 'SUT_CART_DIRV_TRKG'                        16350006
163510                                   TO DP013-DB2-TABLE-NAME (1)    16351006
163600                 SET DP013-DB2-ABEND                              16360001
163700                     DP013-XCTL-DISPLAY-RESTART TO TRUE           16370001
163800                 PERFORM DP013-0000-PROCESS-ABEND                 16380001
163900         END-EVALUATE                                             16390001
164000     END-PERFORM.                                                 16400001
164100                                                                  16410001
164200     IF  PV-RETRY-COUNTER > PC-MAX-RETRIES                        16420001
164300         MOVE '4010-OPEN-CURSOR'   TO DP013-PARAGRAPH             16430001
164400         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO OPEN CSR'   16440001
164500                                   TO DP013-MESSAGE-TEXT (1)      16450001
164600         MOVE SQLCA                TO DP013-SQLCA                 16460001
164700         MOVE 'SUT_CART_DIRV_TRKG' TO DP013-DB2-TABLE-NAME (1)    16470011
164800         SET DP013-DB2-ABEND                                      16480001
164900             DP013-XCTL-DISPLAY-RESTART TO TRUE                   16490001
165000         PERFORM DP013-0000-PROCESS-ABEND                         16500001
165100     END-IF.                                                      16510001
165200                                                                  16520001
171900*----------------------------------------------------------------*17190001
172000* CLOSE THE CURSOR                                               *17200001
172100*----------------------------------------------------------------*17210001
172200 4020-CLOSE-CURSOR.                                               17220001
172400                                                                  17240006
172500     EXEC SQL                                                     17250006
172600          CLOSE CART-CSR                                          17260006
172700     END-EXEC                                                     17270006
172800                                                                  17280001
173900                                                                  17390001
174000     EVALUATE TRUE                                                17400001
174100         WHEN SQLCODE = ZERO                                      17410001
174200             CONTINUE                                             17420001
174300         WHEN SQLWARN0 NOT = SPACES                               17430001
174400         WHEN SQLCODE < ZERO                                      17440001
174500         WHEN SQLCODE > ZERO                                      17450001
174600             MOVE '4020-CLOSE-CURSOR' TO DP013-PARAGRAPH          17460001
174700             MOVE 'UNABLE TO CLOSE CURSOR '                       17470001
174800                               TO DP013-MESSAGE-TEXT (1)          17480001
174900             MOVE SQLCA        TO DP013-SQLCA                     17490001
174910             MOVE 'SUT_CART_DIRV_TRKG'                            17491006
174920                               TO DP013-DB2-TABLE-NAME (1)        17492006
175100             SET DP013-DB2-ABEND                                  17510001
175200                 DP013-XCTL-DISPLAY-RESTART TO TRUE               17520001
175300             PERFORM DP013-0000-PROCESS-ABEND                     17530001
175400     END-EVALUATE.                                                17540001
177000******************************************************************17700070
177100** LOOK UP RCVR PACK TYPE WITH PO NUMBER AND RECEIVER NUMBER    **17710070
177200******************************************************************17720070
177300 4030-GET-RCVR-PACK-TYPE.                                         17730070
177310     MOVE  ASC-PO          TO  DK-PO-NUMBER.                      17731070
177320     MOVE  ASC-RECEIVER    TO  DK-RCVR-NUMBER.                    17732070
177330                                                                  17733070
177340        EXEC SQL                                                  17734070
177350            SELECT  PACK_BY_ST_IND                                17735070
177351                   ,PKGNG_CDE                                     17735170
177352              INTO :RECEIV-PACK-BY-ST-IND                         17735270
177353                  ,:RECEIV-PKGNG-CDE                              17735370
177354              FROM  TRECEIV                                       17735470
177355             WHERE  ORD_NBR      = :DK-PO-NUMBER                  17735570
177356               AND  REC_SEQ_NBR  = :DK-RCVR-NUMBER                17735670
177357            WITH UR                                               17735777
177358        END-EXEC                                                  17735870
177359                                                                  17735970
177360        EVALUATE TRUE                                             17736070
177361            WHEN SQLCODE = +0                                     17736170
177362                MOVE RECEIV-PACK-BY-ST-IND TO PS-PKGNG-CD         17736270
177363                IF RECEIV-PACK-BY-ST-IND = 'Y'                    17736370
177364                    MOVE PC-PBS            TO ASC-PACK-TYPE       17736472
177365                    MOVE ' '               TO PS-PKGNG-CD         17736570
177366                    MOVE 'PBS '            TO ASC-LINE-NO-X       17736699
177367                ELSE                                              17736799
177368                 EVALUATE RECEIV-PKGNG-CDE                        17736899
177369                    WHEN 'M'                                      17736999
177370                        MOVE PC-MULTIPLE-SKU-PPK TO ASC-PACK-TYPE 17737099
177372                    WHEN 'S'                                      17737270
177373                        MOVE PC-SINGLE-SKU-PPK   TO ASC-PACK-TYPE 17737370
177374                    WHEN 'I'                                      17737470
177375                        MOVE PC-INNER-PPK        TO ASC-PACK-TYPE 17737570
177376                    WHEN 'B'                                      17737670
177377                        MOVE PC-BULK-PPK         TO ASC-PACK-TYPE 17737770
177378                    WHEN 'C'                                      17737870
177379                        MOVE PC-CASEPACK         TO ASC-PACK-TYPE 17737970
177380                 END-EVALUATE                                     17738070
177381                END-IF                                            17738170
177383                MOVE ASC-PACK-TYPE        TO ARCVRTYO             17738370
177385                                                                  17738570
177386            WHEN SQLCODE = +100                                   17738670
177406            WHEN SQLWARN0 NOT = SPACES                            17740670
177407            WHEN SQLCODE < +0                                     17740770
177408            WHEN SQLCODE > +0                                     17740870
177409                MOVE '4030-GET-RCVR-PACK-TYPE'                    17740970
177410                                          TO DP013-PARAGRAPH      17741070
177411                MOVE 'TRECEIV'  TO DP013-DB2-TABLE-NAME (1)       17741170
177412                SET DP013-DB2-ABEND                               17741270
177413                    DP013-XCTL-DISPLAY-RESTART TO TRUE            17741370
177414                PERFORM DP013-0000-PROCESS-ABEND                  17741470
177415        END-EVALUATE.                                             17741570
177416                                                                  17741670
177417*----------------------------------------------------------------*17741770
177418*    SET UP THE HOST VARIABLES.                                  *17741870
177419*----------------------------------------------------------------*17741970
177420 4100-PREPARE-CURSOR.                                             17742070
177421                                                                  17742170
177422     MOVE ASC-OPER-UNIT   TO DK-OPER-UNT-ID.                      17742206
177430     MOVE ASC-CART-ID     TO DK-CART-ID.                          17743011
177500     MOVE ASC-CART-ID-P   TO DK-CART-ID-PACKED.                   17750011
178300                                                                  17830001
178696*----------------------------------------------------------------*17869601
178697*    READ THE ITEMS FROM THE DATA BASE AND MOVE THEM INTO THE    *17869701
178698*    BLOCKS IN THE ARRAY.  WHENEVER BOTH BLOCKS BECOME FULL,     *17869801
178699*    WRITE OUT THE 1ST BLOCK TO TEMPORARY STORAGE, MOVE THE 2ND  *17869901
178700*    BLOCK IN THE ARRAY TO THE 1ST BLOCK, AND INITIALIZE THE     *17870001
178800*    2ND BLOCK MAKING IT AVAILABLE TO BE USED.                   *17880001
178900*                                                                *17890001
179000*    DUE TO THE SIZE OF THE TABLE, AND THE ORDER IN WHICH THE    *17900001
179100*    ROWS ARE SORTED, THE ENTIRE TABLE IS READ INTO THE PROGRAM  *17910001
179200*    UPON INITIALIZATION.                                        *17920001
179300*----------------------------------------------------------------*17930001
179400 4300-READ-ITEMS-FROM-DB.                                         17940001
179500     PERFORM                                                      17950001
179600         VARYING PV-READ-COUNT                                    17960001
179700         FROM 1 BY 1                                              17970001
179800         UNTIL ((PV-READ-COUNT > PC-MAX-ITEMS)                    17980001
179900            OR (ASC-NO-ITEMS-LEFT-ON-DB))                         17990001
180000                                                                  18000001
180400        PERFORM 4310-FETCH                                        18040006
180600                                                                  18060001
180700         IF  ASC-ITEMS-LEFT-ON-DB                                 18070001
180800             IF  ASC-ITEM-SUB < PC-ITEMS-PER-PANEL                18080001
180900                 ADD +1            TO ASC-ITEM-SUB                18090001
181000             ELSE                                                 18100001
181100                 ADD +1            TO ASC-BLK-SUB                 18110001
181200                 MOVE +1           TO ASC-ITEM-SUB                18120001
181300                                                                  18130001
181400                 IF  ASC-BLK-SUB > PC-MAX-BLOCKS-IN-ARRAY         18140001
181500                     MOVE +1       TO ASC-BLK-SUB                 18150001
181600                     SET ASC-BLOCK-MODIFIED (1) TO TRUE           18160001
181700                     PERFORM 5100-WRITE-TEMP-STORAGE              18170001
181800                     MOVE ASC-BLOCK-ENTRIES                       18180001
181900                               (PC-MAX-BLOCKS-IN-ARRAY)           18190001
182000                                TO ASC-BLOCK-ENTRIES(ASC-BLK-SUB) 18200001
182100                     ADD +1        TO ASC-BLK-SUB                 18210001
182200                     INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)   18220001
182300                     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB)      18230001
182400                                   TO TRUE                        18240001
182500                 END-IF                                           18250001
182600             END-IF                                               18260001
182700             ADD +1                TO ASC-NUMBER-OF-ITEMS-READ    18270001
182800             MOVE ASC-NUMBER-OF-ITEMS-READ                        18280001
182900                                   TO ASC-LIST-ITEM-NUMBER        18290001
183000                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18300001
183100             EVALUATE TRUE                                        18310001
183200                 WHEN SU100-FUNCTION-NONE                         18320007
183300                     MOVE SPACES TO ASC-ACTION                    18330001
183310                                      (ASC-BLK-SUB ASC-ITEM-SUB)  18331001
183328             END-EVALUATE                                         18332801
183338                                                                  18333812
183339             MOVE SUT00102-AUD-CNTL-NBR      TO ASC-AUDIT-NO      18334112
183340                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18334201
      *CLP 01/25/14                                                     18334399
                                                   SUT00015-AUD-CNTL-NBR18334499
                   PERFORM 4305-FIND-AUDIT-TYPE                         18334699
183341             MOVE SUT00102-AUD-FALR-RSN-NM   TO ASC-FAIL-RSN      18335312
183342                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18335412
183343             MOVE SUT00102-CNVYR-PRC-ACTN-NM TO DK-DIR-TYPE-NM    18335599
183344             MOVE DK-DIR-TYPE-NM-1           TO ASC-DIR-TYPE      18335699
183345*            MOVE SUT00102-CART-STAT-CDE     TO ASC-DIR-TYPE      18335799
183350                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18335834
183351                                                                  18335999
183352*            MOVE SUT00102-STR-NBR           TO DK-LOC-SENT       18336099
183353             MOVE SUT00102-LGCL-LOC-NM       TO DK-LGCL-LOC-NM    18336199
183354             PERFORM 4309-GET-LOC-SENT-DESC                       18336299
183355             MOVE DK-LOC-SENT-DESC           TO ASC-LOC-SENT      18336399
183356                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18336499
183357                                                                  18337099
183380             MOVE SUT00102-DIRV-RSN-CDE      TO  ASC-DIRV-RSN-CODE18338027
183390                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18339001
183400             MOVE SUT00102-CRE-TMST          TO  WS-TIMESTAMP     18340012
183401             MOVE ':'                        TO  WS-COLON1        18340132
183402                                                 WS-COLON2        18340232
183410             MOVE WS-DATE                    TO  ASC-CREATE-DATE  18341032
183500                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18350032
183600             MOVE WS-TIME                    TO  ASC-CREATE-TIME  18360032
183610                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18361032
183611             MOVE SUT00102-CASI-CDE          TO  ASC-CASI         18361112
183612                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18361212
183613             MOVE SUT00102-CRE-BY-USR-ID     TO  ASC-USER-ID      18361333
183614                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18361412
183616             PERFORM 7000-USER-NAME                               18361683
183617             IF XL067-KOHLS-NOT-FOUND                             18361783
183618                MOVE SPACES                TO PV-NAME             18361883
183619             ELSE                                                 18361983
183620                MOVE XL067-COMBINED-NAME-1 TO PV-NAME             18362089
183621             END-IF                                               18362183
183622             MOVE PV-NAME-15               TO  ASC-USER-NAME      18362299
183623                                       (ASC-BLK-SUB ASC-ITEM-SUB) 18362355
183630         END-IF                                                   18363030
183699     END-PERFORM.                                                 18369901
183700                                                                  18370001
183800     IF  ASC-NUMBER-OF-ITEMS-READ > ZERO                          18380001
183900         MOVE +1               TO ASC-BLK-SUB                     18390001
184000         PERFORM 5100-WRITE-TEMP-STORAGE                          18400001
184100         ADD +1                TO ASC-BLK-SUB                     18410001
184200         PERFORM 5100-WRITE-TEMP-STORAGE                          18420001
184300                                                                  18430001
184400         MOVE 1                TO ASC-BLK-SUB                     18440001
184500                                  PV-BLOCK-NUMBER                 18450001
184600*        PERFORM 4410-READ-TEMP-STORAGE                           18460099
184700         IF  ASC-HIGHEST-BLOCK-WRITTEN GREATER THAN 1             18470001
184800             MOVE 2            TO ASC-BLK-SUB                     18480001
184900                                  PV-BLOCK-NUMBER                 18490001
185000             PERFORM 4410-READ-TEMP-STORAGE                       18500001
185100         END-IF                                                   18510001
185200     END-IF.                                                      18520001
185300                                                                  18530001
      *CLP 01/25/14                                                     18530199
185400*----------------------------------------------------------------*18530299
185410*   DETERMINE IF AUDIT TYPE IS QC AUDIT, MANUAL AUDIT OR          18530399
185410*   RFID AUDIT                                                    18530499
185411*----------------------------------------------------------------*18530599
         4305-FIND-AUDIT-TYPE.                                          18531099
           INITIALIZE  PS-AUDIT-TYPE-SW.                                18531399
                                                                        18532099
183339     MOVE SUT00102-AUD-CNTL-NBR TO SUT00015-AUD-CNTL-NBR.         18532199
                                                                        18532299
           EXEC SQL                                                     18533099
               SELECT PKGNG_TYP_CDE                                     18534099
                     ,PO_PREPK_ID                                       18534199
                     ,AUD_CNTL_NBR                                      18534299
                     ,RWRK_AUD_CNTL_NBR                                 18534399
                     ,AUD_STAT_CDE                                      18534499
                     ,PO_NBR                                            18534699
                     ,RCVR_SEQ_NBR                                      18534799
                     ,OPER_UNT_ID                                       18534899
                INTO :SUT00015-PKGNG-TYP-CDE                            18535099
                    ,:SUT00015-PO-PREPK-ID                              18535199
                    ,:SUT00015-AUD-CNTL-NBR                             18535299
                    ,:SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND           18535399
                    ,:SUT00015-AUD-STAT-CDE                             18535499
                    ,:SUT00015-PO-NBR                                   18535599
                    ,:SUT00015-RCVR-SEQ-NBR                             18535699
                    ,:SUT00015-OPER-UNT-ID                              18535799
                FROM SUT_PO_AUD_REQ                                     18536099
                WHERE AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR             18537099
           END-EXEC.                                                    18538099
                                                                        18539099
           EVALUATE TRUE                                                18539199
               WHEN SQLCODE = ZERO                                      18539299
                   CONTINUE                                             18539399
               WHEN SQLCODE = +100                                      18539499
      ***         POSSIBLE MANUAL AUDIT - LOOK AT TSUNAUD NEXT          18539599
                   SET PS-MANUAL-AUDIT TO TRUE                          18539699
185481         WHEN SQLWARN0 NOT = SPACES                               18539899
185482         WHEN SQLCODE < ZERO                                      18539999
185483         WHEN SQLCODE > ZERO                                      18540099
185484             MOVE '4305-FIND-AUDIT-TYPE  '                        18540199
185485                                         TO DP013-PARAGRAPH       18540299
185486             MOVE 'SELECT FROM SUT_PO_AUD_REQ '                   18540399
185487                               TO DP013-MESSAGE-TEXT (1)          18540499
185488             MOVE SQLCA        TO DP013-SQLCA                     18540599
185489             MOVE 'SUT_PO_AUD_REQ  '                              18540699
185490                               TO DP013-DB2-TABLE-NAME (1)        18540799
185491             SET DP013-DB2-ABEND                                  18540899
185492                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18540999
185493             PERFORM DP013-0000-PROCESS-ABEND                     18541099
185494     END-EVALUATE.                                                18541199
                                                                        18541299
           IF NOT PS-MANUAL-AUDIT                                       18541399
               INITIALIZE ASC-COUNT                                     18541499
               IF SUT00015-PKGNG-TYP-CDE = 'RF' AND                     18541599
                  SUT00015-PO-PREPK-ID       < 0                        18541699
      *           ITS A RFID AUDIT                                      18541799
                  PERFORM 4308-QC-RFID-COMB-COUNT                       18541899
               END-IF                                                   18541999
               IF (SUT00015-AUD-CNTL-NBR      > 0 AND                   18542099
                  (SUT00015-RWRK-AUD-CNTL-NBR > 0 OR ASC-COUNT > 0))    18542199
      *            ITS A QC AND RFID AUDIT                              18542299
                   SET PS-QC-AUDIT     TO TRUE                          18542399
               ELSE                                                     18542599
                   SET PS-QC-AUDIT     TO TRUE                          18542699
               END-IF                                                   18542799
               IF SUT00015-PO-PREPK-ID       < 0                        18542899
      *           ITS A RFID AUDIT                                      18542999
                  SET PS-RFID-AUDIT   TO TRUE                           18543099
               ELSE                                                     18543199
                  SET PS-QC-AUDIT    TO TRUE                            18543299
               END-IF                                                   18543399
           ELSE                                                         18543499
               PERFORM 4308A-CHECK-MANUAL                               18543599
           END-IF.                                                      18543699
                                                                        18544599
128800     EVALUATE TRUE                                                18544699
128900        WHEN PS-MANUAL-AUDIT                                      18544799
                  MOVE PC-MAN-AUDT  TO ASC-AUDIT-TY                     18544899
183342                             (ASC-BLK-SUB ASC-ITEM-SUB)           18544999
128900        WHEN PS-QC-AUDIT                                          18545099
                  MOVE PC-QC-AUDIT  TO ASC-AUDIT-TY                     18545199
183342                             (ASC-BLK-SUB ASC-ITEM-SUB)           18545299
128900        WHEN PS-RFID-AUDIT                                        18545399
                  MOVE PC-RFID-AUDT TO ASC-AUDIT-TY                     18545499
183342                             (ASC-BLK-SUB ASC-ITEM-SUB)           18545599
              WHEN OTHER                                                18545699
                  MOVE SPACE        TO ASC-AUDIT-TY                     18545799
183342                             (ASC-BLK-SUB ASC-ITEM-SUB)           18545899
           END-EVALUATE.                                                18545999
                                                                        18546099
                                                                        18546299
      *CLP 01/25/14 START                                               18546399
185400*----------------------------------------------------------------*18546499
185410*   IF ITS A PART OF COMBO AND BOTH AUDITS FAIL, NEED TO          18546599
185410*   HIGHLIGHT THE CARTON #                                        18546699
185411*----------------------------------------------------------------*18546799
       4307-CHECK-FOR-CARTON-HLITE.                                     18546899
           INITIALIZE  PS-AUDIT-COMBO-SW.                               18546999
                                                                        18547099
183339     MOVE SUT00102-AUD-CNTL-NBR TO SUT00015-AUD-CNTL-NBR.         18547199
                                                                        18547299
           EXEC SQL                                                     18547399
               SELECT PKGNG_TYP_CDE                                     18547499
                     ,PO_PREPK_ID                                       18547599
                     ,AUD_CNTL_NBR                                      18547699
                     ,RWRK_AUD_CNTL_NBR                                 18547799
                     ,AUD_STAT_CDE                                      18547899
                     ,PO_NBR                                            18547999
                     ,RCVR_SEQ_NBR                                      18548099
                     ,OPER_UNT_ID                                       18548199
                INTO :SUT00015-PKGNG-TYP-CDE                            18548299
                    ,:SUT00015-PO-PREPK-ID                              18548399
                    ,:SUT00015-AUD-CNTL-NBR                             18548499
                    ,:SUT00015-RWRK-AUD-CNTL-NBR :PV-NULL-IND           18548599
                    ,:SUT00015-AUD-STAT-CDE                             18548699
                    ,:SUT00015-PO-NBR                                   18548799
                    ,:SUT00015-RCVR-SEQ-NBR                             18548899
                    ,:SUT00015-OPER-UNT-ID                              18548999
                FROM SUT_PO_AUD_REQ                                     18549099
                WHERE AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR             18549199
           END-EXEC.                                                    18549299
                                                                        18549399
           EVALUATE TRUE                                                18549499
               WHEN SQLCODE = ZERO                                      18549599
                   CONTINUE                                             18549699
               WHEN SQLCODE = +100                                      18549799
                   CONTINUE                                             18549899
185481         WHEN SQLWARN0 NOT = SPACES                               18550099
185482         WHEN SQLCODE < ZERO                                      18550199
185483         WHEN SQLCODE > ZERO                                      18550299
185484             MOVE 'CHECK-FOR-CARTON-HLITE'                        18550399
185485                                         TO DP013-PARAGRAPH       18550499
185486             MOVE '1ST SELECT FROM SUT_PO_AUD_REQ '               18550599
185487                               TO DP013-MESSAGE-TEXT (1)          18550699
185488             MOVE SQLCA        TO DP013-SQLCA                     18550799
185489             MOVE 'SUT_PO_AUD_REQ  '                              18550899
185490                               TO DP013-DB2-TABLE-NAME (1)        18550999
185491             SET DP013-DB2-ABEND                                  18551099
185492                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18551199
185493             PERFORM DP013-0000-PROCESS-ABEND                     18551299
185494     END-EVALUATE.                                                18551399
                                                                        18551499
                                                                        18553899
           IF SUT00015-PKGNG-TYP-CDE = PC-RF                            18553999
               MOVE SUT00015-AUD-STAT-CDE TO PV-AUD-STAT-CDE            18554099
      *        ITS RFID - CHECK IF QC AS WELL                           18554199
                                                                        18554299
               EXEC SQL                                                 18554399
                 SELECT AUD_STAT_CDE                                    18554499
                  INTO :SUT00015-AUD-STAT-CDE                           18554599
                  FROM SUT_PO_AUD_REQ                                   18554699
                  WHERE RWRK_AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR      18554799
               END-EXEC                                                 18554899
                                                                        18554999
               EVALUATE TRUE                                            18555099
                 WHEN SQLCODE = ZERO                                    18555199
                    SET PS-COMBO-AUDIT TO TRUE                          18555299
      *             ITS COMBO - CHECK IF FAILED                         18555399
                 WHEN SQLCODE = +100                                    18555499
                 WHEN SQLCODE = -811                                    18555599
                     CONTINUE                                           18555699
                 WHEN SQLWARN0 NOT = SPACES                             18555799
                 WHEN SQLCODE < +0                                      18555899
                 WHEN SQLCODE > ZERO                                    18555999
184100             MOVE '4307-CHECK-FOR-CARTON-HLITE'                   18556099
184200                                         TO DP013-PARAGRAPH       18556199
184300             MOVE '2ND SELECT FROM SUT_PO_AUD_REQ'                18556299
184400                               TO DP013-MESSAGE-TEXT (1)          18556399
184500             MOVE SQLCA        TO DP013-SQLCA                     18556499
184600             MOVE 'SUT_PO_AUD_REQ    '                            18556599
184700                               TO DP013-DB2-TABLE-NAME (1)        18556699
184800             SET DP013-DB2-ABEND                                  18556799
184900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18556899
185000             PERFORM DP013-0000-PROCESS-ABEND                     18556999
           ELSE                                                         18557099
      *        CHECK IF QC FAILED                                       18557199
               MOVE SUT00015-AUD-STAT-CDE TO PV-AUD-STAT-CDE            18557299
      *        NOW GO CHECK IF THERE IS A RF THAT FAILED FOR SAME PO    18557399
174600         EXEC SQL                                                 18557499
174700            SELECT  A.AUD_STAT_CDE                                18557599
174800                INTO :SUT00015-AUD-STAT-CDE                       18557699
174900                FROM  SUT_PO_AUD_REQ A                            18557799
175100            WHERE A.PO_NBR        = :SUT00015-PO-NBR              18557899
175200              AND A.RCVR_SEQ_NBR  = :SUT00015-RCVR-SEQ-NBR        18557999
250300              AND A.OPER_UNT_ID   = :SUT00015-OPER-UNT-ID         18558099
175200              AND A.PO_PREPK_ID   < 0                             18558199
175400         END-EXEC                                                 18558299
                                                                        18558399
               EVALUATE TRUE                                            18558499
                 WHEN SQLCODE = ZERO                                    18558599
                    SET PS-COMBO-AUDIT TO TRUE                          18558699
                 WHEN SQLCODE = +100                                    18558799
                 WHEN SQLCODE = -811                                    18558899
                     CONTINUE                                           18558999
                 WHEN SQLWARN0 NOT = SPACES                             18559099
                 WHEN SQLCODE < +0                                      18559199
                 WHEN SQLCODE > ZERO                                    18559299
184100             MOVE '4307-CHECK-FOR-CARTON-HLITE'                   18559399
184200                                         TO DP013-PARAGRAPH       18559499
184300             MOVE '3RD SELECT FROM SUT_PO_AUD_REQ'                18559599
184400                               TO DP013-MESSAGE-TEXT (1)          18559699
184500             MOVE SQLCA        TO DP013-SQLCA                     18559799
184600             MOVE 'SUT_PO_AUD_REQ    '                            18559899
184700                               TO DP013-DB2-TABLE-NAME (1)        18559999
184800             SET DP013-DB2-ABEND                                  18560099
184900                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18560199
185000             PERFORM DP013-0000-PROCESS-ABEND                     18560299
                                                                        18560399
           END-EVALUATE.                                                18560499
                                                                        18560599
           SET ASC-NOT-HIGHLIGHT-CARTON TO TRUE.                        18560699
           IF PS-COMBO-AUDIT                                            18560799
              IF PV-AUD-STAT-CDE       = PC-F AND                       18560899
                 SUT00015-AUD-STAT-CDE = PC-F                           18560999
      *          NEED TO HIGHLIGHT THE CARTON                           18561099
                 SET ASC-HIGHLIGHT-CARTON TO TRUE                       18561199
              END-IF                                                    18561299
           END-IF.                                                      18561399
                                                                        18561499
       4308-QC-RFID-COMB-COUNT.                                         18561599
                                                                        18561699
           EXEC SQL                                                     18561799
               SELECT COUNT(*)                                          18561899
                INTO :ASC-COUNT :PV-NULL-IND                            18561999
                FROM SUT_PO_AUD_REQ                                     18562099
                WHERE RWRK_AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR        18562199
           END-EXEC.                                                    18562299
                                                                        18562399
           EVALUATE TRUE                                                18562499
               WHEN SQLCODE = ZERO                                      18562599
               WHEN SQLCODE = +100                                      18562699
               WHEN SQLCODE = -811                                      18562799
                   CONTINUE                                             18562899
               WHEN SQLWARN0 NOT = SPACES                               18562999
               WHEN SQLCODE < +0                                        18563099
               WHEN SQLCODE > ZERO                                      18563199
185484             MOVE '4308-QC-RFID-COMB-COUNT'                       18563299
185485                                         TO DP013-PARAGRAPH       18563399
185486             MOVE 'COUNT FROM SUT_PO_AUD_REQ '                    18563499
185487                               TO DP013-MESSAGE-TEXT (1)          18563599
185488             MOVE SQLCA        TO DP013-SQLCA                     18563699
185489             MOVE 'SUT_PO_AUD_REQ  '                              18563799
185490                               TO DP013-DB2-TABLE-NAME (1)        18563899
185491             SET DP013-DB2-ABEND                                  18563999
185492                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18564099
185493             PERFORM DP013-0000-PROCESS-ABEND                     18564199
           END-EVALUATE.                                                18564299
185400*----------------------------------------------------------------*18564399
185410*   IF FOUND ON THE TSUNAUD TABLE ITS CONSIDERED TO BE MANUAL     18564499
185410*   AUDIT                                                         18564599
185411*----------------------------------------------------------------*18564699
       4308A-CHECK-MANUAL.                                              18564799
           INITIALIZE PS-AUDIT-TYPE-SW.                                 18564899
                                                                        18564999
           EXEC SQL                                                     18565099
               SELECT 1                                                 18565199
                INTO :ASC-COUNT :PV-NULL-IND                            18565299
                FROM TSUNAUD                                            18565399
                WHERE AUD_CNTL_NBR = :SUT00015-AUD-CNTL-NBR             18565499
           END-EXEC.                                                    18565599
                                                                        18565699
           EVALUATE TRUE                                                18565799
               WHEN SQLCODE = ZERO                                      18565899
                   SET PS-MANUAL-AUDIT TO TRUE                          18565999
               WHEN SQLCODE = +100                                      18566099
                   CONTINUE                                             18566199
185481         WHEN SQLWARN0 NOT = SPACES                               18566299
185482         WHEN SQLCODE < ZERO                                      18566399
185483         WHEN SQLCODE > ZERO                                      18566499
185484             MOVE '4308A-CHECK-MANUAL    '                        18566599
185485                                         TO DP013-PARAGRAPH       18566699
185486             MOVE 'SELECT FROM TSUNAUD        '                   18566799
185487                               TO DP013-MESSAGE-TEXT (1)          18566899
185488             MOVE SQLCA        TO DP013-SQLCA                     18566999
185489             MOVE 'TSUNAUD         '                              18567099
185490                               TO DP013-DB2-TABLE-NAME (1)        18567199
185491             SET DP013-DB2-ABEND                                  18567299
185492                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18567399
185493             PERFORM DP013-0000-PROCESS-ABEND                     18567499
185494     END-EVALUATE.                                                18567599
                                                                        18567699
      *CLP 01/25/14 END                                                 18567799
185400*----------------------------------------------------------------*18567899
185410*   SELECT CART_SRC_CDE FROM SUT_OTBND_CART                       18567999
185411*----------------------------------------------------------------*18568099
185412 4309-GET-LOC-SENT-DESC.                                          18568199
185413     EXEC SQL                                                     18568299
185417          SELECT J.ATTR_ELEM_TXT                                  18568399
185419           INTO :DK-LOC-SENT-DESC                                 18568499
185420           FROM WST_INTGRTN_TYP A                                 18568599
185421              , WST_ATTR_DEFN   B                                 18568699
185422              , WST_ATTR_ELEM   C                                 18568799
185423              , WST_ATTR_ELEM           D                         18568899
185424              , WST_ATTR_ELEM           E                         18568999
185425              , WST_ATTR_ELEM           F                         18569099
185426              , WST_ATTR_ELEM           G                         18569199
185427              , WST_ATTR_ELEM           H                         18569299
185428              , WST_ATTR_ELEM           I                         18569399
185429              , WST_ATTR_ELEM           J                         18569499
185430              , WST_ATTR_ELEM           K                         18569599
185431          WHERE A.INTGRTN_TYP_CDE    =  'ACAULGDST'               18569699
185432            AND A.INTGRTN_TYP_CDE    =  B.INTGRTN_TYP_CDE         18569799
185433            AND A.INTGRTN_TYP_CDE    =  C.INTGRTN_TYP_CDE         18569899
185434            AND A.INTGRTN_TYP_CDE    =  D.INTGRTN_TYP_CDE         18569999
185435            AND A.INTGRTN_TYP_CDE    =  E.INTGRTN_TYP_CDE         18570099
185436            AND A.INTGRTN_TYP_CDE    =  F.INTGRTN_TYP_CDE         18570199
185437            AND A.INTGRTN_TYP_CDE    =  G.INTGRTN_TYP_CDE         18570299
185438            AND A.INTGRTN_TYP_CDE    =  H.INTGRTN_TYP_CDE         18570399
185439            AND A.INTGRTN_TYP_CDE    =  I.INTGRTN_TYP_CDE         18570499
185440            AND A.INTGRTN_TYP_CDE    =  J.INTGRTN_TYP_CDE         18570599
185441            AND A.INTGRTN_TYP_CDE    =  K.INTGRTN_TYP_CDE         18570699
185442            AND B.ATTR_DEFN_SEQ_NBR  =  1                         18570799
185443            AND C.ATTR_DEFN_SEQ_NBR  =  1                         18570899
185444            AND D.ATTR_DEFN_SEQ_NBR  =  2                         18570999
185445            AND E.ATTR_DEFN_SEQ_NBR  =  3                         18571099
185446            AND F.ATTR_DEFN_SEQ_NBR  =  4                         18571199
185447            AND G.ATTR_DEFN_SEQ_NBR  =  5                         18571299
185448            AND H.ATTR_DEFN_SEQ_NBR  =  6                         18571399
185449            AND I.ATTR_DEFN_SEQ_NBR  =  7                         18571499
185450            AND J.ATTR_DEFN_SEQ_NBR  =  8                         18571599
185451            AND K.ATTR_DEFN_SEQ_NBR  =  9                         18571699
185452            AND C.ATTR_ELEM_SEQ_NBR  =  D.ATTR_ELEM_SEQ_NBR       18571799
185453            AND C.ATTR_ELEM_SEQ_NBR  =  E.ATTR_ELEM_SEQ_NBR       18571899
185454            AND C.ATTR_ELEM_SEQ_NBR  =  F.ATTR_ELEM_SEQ_NBR       18571999
185455            AND C.ATTR_ELEM_SEQ_NBR  =  G.ATTR_ELEM_SEQ_NBR       18572099
185456            AND C.ATTR_ELEM_SEQ_NBR  =  H.ATTR_ELEM_SEQ_NBR       18572199
185457            AND C.ATTR_ELEM_SEQ_NBR  =  I.ATTR_ELEM_SEQ_NBR       18572299
185458            AND C.ATTR_ELEM_SEQ_NBR  =  J.ATTR_ELEM_SEQ_NBR       18572399
185459            AND C.ATTR_ELEM_SEQ_NBR  =  K.ATTR_ELEM_SEQ_NBR       18572499
185460            AND F.ATTR_ELEM_TXT      =  'Y'                       18572599
185461            AND G.ATTR_ELEM_TMST    <=  CURRENT TIMESTAMP         18572699
185462            AND H.ATTR_ELEM_TMST    >=  CURRENT TIMESTAMP         18572799
185463            AND C.ATTR_ELEM_NBR      =  :DK-OPER-UNT-ID           18572899
185464            AND E.ATTR_ELEM_TXT      =  :DK-LGCL-LOC-NM           18572999
185466         WITH UR                                                  18573099
185467            FETCH FIRST ROW ONLY                                  18573199
185468                                                                  18573299
185469     END-EXEC                                                     18573399
185470                                                                  18573499
185471     EVALUATE TRUE                                                18573599
185472         WHEN SQLCODE = ZERO                                      18573699
185473             CONTINUE                                             18573799
185474         WHEN SQLCODE = +100                                      18573899
185475             IF DK-LGCL-LOC-NM = 'ALL'                            18573999
185476                 MOVE 'ALL                             '          18574099
185477                   TO DK-LOC-SENT-DESC                            18574199
185478             ELSE                                                 18574299
185479                 MOVE SPACES TO DK-LOC-SENT-DESC                  18574399
185480             END-IF                                               18574499
185481         WHEN SQLWARN0 NOT = SPACES                               18574599
185482         WHEN SQLCODE < ZERO                                      18574699
185483         WHEN SQLCODE > ZERO                                      18574799
185484             MOVE '4309-GET-LOC-SENT-DESC'                        18574899
185485                                         TO DP013-PARAGRAPH       18574999
185486             MOVE 'SELECT FROM WST_INTGRTN_TYP'                   18575099
185487                               TO DP013-MESSAGE-TEXT (1)          18575199
185488             MOVE SQLCA        TO DP013-SQLCA                     18575299
185489             MOVE 'WST_ATTR_DEFN   '                              18575399
185490                               TO DP013-DB2-TABLE-NAME (1)        18575499
185491             SET DP013-DB2-ABEND                                  18575599
185492                 DP013-XCTL-DISPLAY-RESTART TO TRUE               18575699
185493             PERFORM DP013-0000-PROCESS-ABEND                     18575799
185494     END-EVALUATE.                                                18575899
185495                                                                  18575999
185496*----------------------------------------------------------------*18576001
185500*    FETCH THE CURSOR                                             18576101
185600*----------------------------------------------------------------*18577001
185700 4310-FETCH.                                                      18580001
186000       EXEC SQL                                                   18600006
186100            FETCH CART-CSR                                        18610006
186200            INTO  :SUT00102-AUD-CNTL-NBR                          18620009
186300                , :SUT00102-AUD-FALR-RSN-NM                       18630009
186400                , :SUT00102-CNVYR-PRC-ACTN-NM                     18640009
186500                , :SUT00102-DIRV-RSN-CDE                          18650009
186501                , :SUT00102-CART-STAT-CDE                         18650180
186502                , :SUT00102-STR-NBR                               18650280
186510                , :SUT00102-LGCL-LOC-NM                           18651009
186520                , :SUT00102-CRE-TMST                              18652009
186530                , :SUT00102-CASI-CDE                              18653009
186531                , :SUT00102-CRE-BY-USR-ID                         18653109
186540       END-EXEC                                                   18654006
186550                                                                  18655001
187484                                                                  18748401
187485     EVALUATE TRUE                                                18748501
187486         WHEN SQLCODE = ZERO                                      18748601
187488         WHEN SQLCODE = +100                                      18748801
187489              CONTINUE                                            18748901
187490         WHEN SQLWARN0 NOT = SPACE                                18749001
187500         WHEN SQLCODE NOT = ZERO                                  18750001
187600              MOVE '4310-FETCH-CURSOR' TO DP013-PARAGRAPH         18760001
187700              MOVE 'COULD NOT FETCH CURSOR'                       18770001
187800                               TO DP013-MESSAGE-TEXT (1)          18780001
187900              MOVE SQLCA       TO DP013-SQLCA                     18790001
188000              SET DP013-DB2-ABEND TO TRUE                         18800001
188100              PERFORM DP013-0000-PROCESS-ABEND                    18810001
188200     END-EVALUATE.                                                18820001
188300                                                                  18830001
188400     IF  SQLCODE EQUAL +100                                       18840001
188500         SET ASC-NO-ITEMS-LEFT-ON-DB TO TRUE                      18850001
188600     END-IF.                                                      18860001
188700                                                                  18870001
189380 4400-MOVE-COMMAREA-TO-SCREEN.                                    18938001
189390     IF  (((PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (1 1))             18939001
189400         AND (PV-TOP-ITEM > ASC-LIST-ITEM-NUMBER (2 1)))          18940001
189500         OR  (PV-TOP-ITEM < ASC-LIST-ITEM-NUMBER (1 1)))          18950001
189600             MOVE +1    TO ASC-BLK-SUB                            18960001
189700             PERFORM 5100-WRITE-TEMP-STORAGE                      18970001
189800             ADD +1     TO ASC-BLK-SUB                            18980001
189900             PERFORM 5100-WRITE-TEMP-STORAGE                      18990001
190000             DIVIDE PV-TOP-ITEM BY PC-ITEMS-PER-PANEL             19000001
190100                 GIVING PV-BLOCK-NUMBER                           19010001
190200                 REMAINDER PV-REMAINDER                           19020001
190300             IF  PV-REMAINDER > ZERO                              19030001
190400                 ADD +1 TO PV-BLOCK-NUMBER                        19040001
190500             END-IF                                               19050001
190600             MOVE +1    TO ASC-BLK-SUB                            19060001
190700             PERFORM 4410-READ-TEMP-STORAGE                       19070001
190800             ADD +1     TO ASC-BLK-SUB                            19080001
190900                           PV-BLOCK-NUMBER                        19090001
191000             PERFORM 4410-READ-TEMP-STORAGE                       19100001
191100     END-IF.                                                      19110001
191200     MOVE +1            TO ASC-BLK-SUB.                           19120001
191300     COMPUTE ASC-ITEM-SUB =                                       19130001
191400         ((PV-TOP-ITEM - ASC-LIST-ITEM-NUMBER (1 1))              19140001
191500         + PC-ITEMS-PER-PANEL).                                   19150001
191600*                                                                 19160001
191700     IF  ASC-ITEM-SUB > PC-ITEMS-PER-PANEL                        19170001
191800         ADD +1         TO ASC-BLK-SUB                            19180001
191900         SUBTRACT PC-ITEMS-PER-PANEL FROM ASC-ITEM-SUB            19190001
192000     END-IF.                                                      19200001
192100*                                                                 19210001
192200     COMPUTE ASC-ITEM-AT-BOT-OF-PANEL =                           19220001
192300         ((PV-TOP-ITEM + PC-ITEMS-PER-PANEL) - 1).                19230001
192400     PERFORM 4430-CHECK-FOR-BEGIN-AND-END.                        19240001
192500     PERFORM 4420-FORMAT-LIST-LINES                               19250001
192600         VARYING PV-SUB                                           19260001
192700         FROM PC-ITEMS-PER-PANEL BY -1                            19270001
192800         UNTIL PV-SUB < +1.                                       19280001
192900*                                                                 19290001
193000     COMPUTE ASC-ITEMS-DISPLAYED =                                19300001
193100         ((ASC-ITEM-AT-BOT-OF-PANEL - PV-TOP-ITEM) + 1).          19310001
193200     MOVE PV-TOP-ITEM              TO ASC-ITEM-AT-TOP-OF-PANEL    19320001
193300                                      ASTRTITO.                   19330001
193400     MOVE ASC-ITEM-AT-BOT-OF-PANEL TO AENDITO.                    19340001
193500     MOVE ASC-NUMBER-OF-ITEMS-READ TO ATOTITO.                    19350001
193600*    MOVE ASC-NUMBER-OF-SELECTED-ITEMS                            19360063
193700*                                  TO ASELITO.                    19370063
193800     MOVE ASC-OPER-UNIT            TO AOPUNITO.                   19380024
194001     MOVE ASC-PO(02:08)            TO APORCVRO(01:08).            19400199
194002     MOVE '-'                      TO APORCVRO(09:01).            19400299
194003     MOVE ASC-RECEIVER(02:03)      TO APORCVRO(10:03).            19400399
194010     MOVE ASC-CRE-SRC              TO ACRESRCO.                   19401076
194011     MOVE ASC-PACK-TYPE            TO ARCVRTYO.                   19401176
194020     MOVE ASC-LINE-NO              TO ALINENOO.                   19402075
194030     MOVE ASC-PACK-ID              TO APACKIDO.                   19403075
194040     MOVE ASC-CART-ID              TO ACARTIDO.                   19404075
           IF ASC-HIGHLIGHT-CARTON                                      19405299
205800         MOVE DP015-YELLOW         TO ACARTIDC                    19405399
           END-IF                                                       19405499
194100                                                                  19410075
194200     IF  DP020-MSG-NUMBER-X = SPACE                               19420001
194300         IF  ASC-ITEM-AT-BOT-OF-PANEL < ASC-NUMBER-OF-ITEMS-READ  19430001
194400*            --- MORE ITEMS TO DISPLAY ----                       19440001
194500             MOVE PC-TSYMSG-00279  TO DP020-MSG-NUMBER            19450001
194600             SET DP020-MSG-INFORMATIONAL TO TRUE                  19460001
194700         END-IF                                                   19470001
194800     END-IF.                                                      19480001
194900                                                                  19490001
195000*----------------------------------------------------------------*19500001
195100*    READ A BLOCK FROM TEMPORARY STORAGE INTO THE ARRAY.         *19510001
195200*----------------------------------------------------------------*19520001
195300 4410-READ-TEMP-STORAGE.                                          19530001
195400     EXEC CICS                                                    19540001
195500         READQ TS                                                 19550001
195600             QUEUE (ASC-LIST-QUEUE-NAME)                          19560001
195700             INTO  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               19570001
195800             ITEM  (PV-BLOCK-NUMBER)                              19580001
195900             RESP  (PV-CICS-RESP)                                 19590001
196000     END-EXEC.                                                    19600001
196100                                                                  19610001
196200     IF  ((PV-CICS-RESP = DFHRESP (NORMAL))                       19620001
196300       OR (PV-CICS-RESP = DFHRESP (ITEMERR)))                     19630001
196400         CONTINUE                                                 19640001
196500     ELSE                                                         19650001
196600         SET DP013-CICS-ABEND     TO TRUE                         19660001
196700         SET DP013-NO-ROLLBACK    TO TRUE                         19670001
196800         MOVE '4410-READ-TEMP-STORAGE' TO DP013-PARAGRAPH         19680001
196900         MOVE 'ERROR TRYING TO READ FROM TEMP STORAGE QUEUE'      19690001
197000                                  TO DP013-MESSAGE-TEXT(1)        19700001
197100         PERFORM DP013-0000-PROCESS-ABEND                         19710001
197200     END-IF.                                                      19720001
197300                                                                  19730001
197400     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             19740001
197500*                                                                 19750001
197600     IF  PV-CICS-RESP = DFHRESP (ITEMERR)                         19760001
197700         INITIALIZE ASC-BLOCK-ENTRIES (ASC-BLK-SUB)               19770001
197800     END-IF.                                                      19780001
197900                                                                  19790001
198000*----------------------------------------------------------------*19800001
198100*    PROCESS THE ITEMS IN THE ARRAY AND MOVE THEM TO THE MAP.    *19810001
198200*----------------------------------------------------------------*19820001
198300 4420-FORMAT-LIST-LINES.                                          19830001
198400     IF  ASC-ITEM-AT-BOT-OF-PANEL > ASC-NUMBER-OF-ITEMS-READ      19840001
198500         SUBTRACT +1 FROM ASC-ITEM-AT-BOT-OF-PANEL                19850001
198600*        MOVE DP015-ASK-DRK-OFF  TO MR-SELECTA (PV-SUB)           19860009
198700*        MOVE DP015-HL-OFF       TO MR-SELECTH (PV-SUB)           19870009
198800*        MOVE SPACES             TO MR-SELECTI      (PV-SUB)      19880099
198900*        MOVE SPACES             TO MR-ACTION       (PV-SUB)      19890009
199000         MOVE SPACES             TO MR-FAIL-RSN     (PV-SUB)      19900009
199100                                    MR-TYPE         (PV-SUB)      19910009
199200                                    MR-TIME         (PV-SUB)      19920054
199300                                    MR-AUDIT-NO-ID  (PV-SUB)      19930028
      *CLP 01/25/14                                                     19930199
199300                                    MR-AUDIT-TYP    (PV-SUB)      19931099
199400                                    MR-LOC-SENT     (PV-SUB)      19940009
199410                                    MR-DATE         (PV-SUB)      19941009
199411                                    MR-TIME         (PV-SUB)      19941109
199420                                    MR-CASI         (PV-SUB)      19942009
199430                                    MR-NAME         (PV-SUB)      19943009
199500                                    MR-DIR-CODE     (PV-SUB)      19950054
199510                                    MR-USER         (PV-SUB)      19951009
199520     ELSE                                                         19952001
199530*        IF  ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      19953009
199540*                                                  > SPACE        19954009
199550*            MOVE ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB) 19955009
199560*                                         TO MR-SELECTI (PV-SUB)  19956009
199570*        ELSE                                                     19957009
199580*            MOVE ASC-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)      19958009
199590*                                          TO MR-SELECTI (PV-SUB) 19959009
199600*        END-IF                                                   19960009
199700                                                                  19970001
199800         IF  DP030-SET-CURSOR-TRAILER                             19980001
199900             IF  ((ASC-TEMP-SELECTED-SW (ASC-BLK-SUB ASC-ITEM-SUB)19990001
200000                 > SPACE)                                         20000001
200100               OR (PV-SUB = 1))                                   20010001
200200                SET DP030-SET-CURSOR-APPL-1 TO TRUE               20020001
200300*               MOVE -1          TO MR-SELECTL (PV-SUB)           20030009
200400             END-IF                                               20040001
200500         END-IF                                                   20050001
200600*>>>>>>>>                                                         20060001
200700*        MOVE ASC-ACTION (ASC-BLK-SUB ASC-ITEM-SUB)               20070009
200800*                                           TO MR-ACTION (PV-SUB) 20080009
200810                                                                  20081009
200900         MOVE ASC-AUDIT-NO (ASC-BLK-SUB ASC-ITEM-SUB)             20090028
201000                                        TO MR-AUDIT-NO-ID (PV-SUB)20100028
      *CLP 01/25/14                                                     20101099
200900         MOVE ASC-AUDIT-TY (ASC-BLK-SUB ASC-ITEM-SUB)             20110099
201000                                        TO MR-AUDIT-TYP (PV-SUB)  20120099
201210         MOVE ASC-FAIL-RSN  (ASC-BLK-SUB ASC-ITEM-SUB)            20121010
201220                                        TO MR-FAIL-RSN (PV-SUB)   20122010
201300         MOVE ASC-DIR-TYPE (ASC-BLK-SUB ASC-ITEM-SUB)             20130034
201400                                          TO MR-TYPE (PV-SUB)     20140009
201500         MOVE ASC-DIRV-RSN-CODE (ASC-BLK-SUB ASC-ITEM-SUB)        20150035
201600                                      TO MR-DIR-CODE (PV-SUB)     20160009
201610         IF ASC-LOC-SENT (ASC-BLK-SUB ASC-ITEM-SUB)               20161099
201620                                     = 'ALL '                     20162099
201630             MOVE 'BRCD'                TO MR-LOC-SENT (PV-SUB)   20163099
201640         ELSE                                                     20164099
201650             MOVE ASC-LOC-SENT (ASC-BLK-SUB ASC-ITEM-SUB)         20165099
201670                                        TO MR-LOC-SENT (PV-SUB)   20167099
201680         END-IF                                                   20168099
201810         MOVE ASC-CREATE-DATE (ASC-BLK-SUB ASC-ITEM-SUB)          20181028
201820                                        TO MR-DATE     (PV-SUB)   20182009
201900         MOVE ASC-CREATE-TIME (ASC-BLK-SUB ASC-ITEM-SUB)          20190028
201901                                        TO MR-TIME     (PV-SUB)   20190109
201910         MOVE ASC-CASI       (ASC-BLK-SUB ASC-ITEM-SUB)           20191009
201920                                        TO MR-CASI     (PV-SUB)   20192009
201930         MOVE ASC-USER-ID   (ASC-BLK-SUB ASC-ITEM-SUB)            20193033
202000                                        TO MR-USER (PV-SUB)       20200009
202010         MOVE ASC-USER-NAME    (ASC-BLK-SUB ASC-ITEM-SUB)         20201034
202020                                        TO MR-NAME (PV-SUB)       20202009
202021                                                                  20202158
202030     END-IF.                                                      20203001
202040     SUBTRACT +1 FROM ASC-ITEM-SUB                                20204001
202050     IF  ASC-ITEM-SUB < + 1                                       20205001
202060         MOVE PC-ITEMS-PER-PANEL TO ASC-ITEM-SUB                  20206001
202070         MOVE +1                 TO ASC-BLK-SUB                   20207001
202080     END-IF.                                                      20208001
202090                                                                  20209001
202100******************************************************************20210001
202200** IF A BEGINNING OF RANGE WAS SPECIFIED, MAKE SURE AN END OF   **20220001
202300** RANGE WAS SPECIFIED AND VICE-VERSA.  IF ONE IS MISSING,      **20230001
202400** ISSUE A WARNING.                                             **20240001
202500******************************************************************20250001
202600 4430-CHECK-FOR-BEGIN-AND-END.                                    20260001
202700     IF  ASC-START-OF-SELECTED-RANGE > ZERO                       20270001
202800         IF  ASC-END-OF-SELECTED-RANGE = ZERO                     20280001
202900*            -- NO END-OF-RANGE SPECFIED ---                      20290001
203000             MOVE PC-TSYMSG-00051  TO DP020-MSG-NUMBER            20300001
203100             SET DP020-MSG-WARNING TO TRUE                        20310001
203200             PERFORM 4431-POSITION-AT-WARNING                     20320001
203300         END-IF                                                   20330001
203400     ELSE                                                         20340001
203500         IF  ASC-END-OF-SELECTED-RANGE > ZERO                     20350001
203600*            -- NO BEGINNING-OF-RANGE SPECFIED ---                20360001
203700             MOVE PC-TSYMSG-00053  TO DP020-MSG-NUMBER            20370001
203800             SET DP020-MSG-WARNING TO TRUE                        20380001
203900             PERFORM 4431-POSITION-AT-WARNING                     20390001
204000         END-IF                                                   20400001
204100     END-IF.                                                      20410001
204200                                                                  20420001
204300******************************************************************20430001
204400** ONCE IT HAS BEEN DETERMINED THAT A WARNING IS TO BE ISSUED,  **20440001
204500** DETERMINE IF EITHER THE BEGINNING OF RANGE OR END OF RANGE   **20450001
204600** IS ON THE CURRENT SCREEN.  IF IT IS, HIGHLIGHT IT AND        **20460001
204700** POSITION THE CURSOR THERE.                                   **20470001
204800******************************************************************20480001
204900 4431-POSITION-AT-WARNING.                                        20490001
205000     COMPUTE PV-SUB = ASC-START-OF-SELECTED-RANGE                 20500001
205100                    - PV-TOP-ITEM + 1.                            20510001
205200     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20520001
205300         CONTINUE                                                 20530001
205400     ELSE                                                         20540001
205500         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      20550001
205600*        MOVE -1                     TO MR-SELECTL (PV-SUB)       20560009
205700*        MOVE DP015-REVERSE          TO MR-SELECTH (PV-SUB)       20570009
205800*        MOVE DP015-YELLOW           TO MR-SELECTC (PV-SUB)       20580009
205900     END-IF.                                                      20590001
206000                                                                  20600001
206100     COMPUTE PV-SUB = ASC-END-OF-SELECTED-RANGE                   20610001
206200                    - PV-TOP-ITEM + 1.                            20620001
206300     IF  PV-SUB < +1 OR > PC-ITEMS-PER-PANEL                      20630001
206400         CONTINUE                                                 20640001
206500     ELSE                                                         20650001
206600         SET DP030-SET-CURSOR-APPL-1                              20660001
206700                                   TO TRUE                        20670001
206800*        MOVE -1                   TO MR-SELECTL (PV-SUB)         20680009
206900*        MOVE DP015-REVERSE        TO MR-SELECTH (PV-SUB)         20690009
207000*        MOVE DP015-YELLOW         TO MR-SELECTC (PV-SUB)         20700009
207100     END-IF.                                                      20710001
207200                                                                  20720001
207300*----------------------------------------------------------------*20730001
207400* PREPARE THE SELECTED ITEMS TEMP STORAGE QUEUE.  MOVE ALL SEL-  *20740001
207500* ECTED ITEMS FROM THE LIST TEMP STORAGE QUEUE TO THE LAYOUT     *20750001
207600* FOR THE SELECTED ITEMS QUEUE.                                  *20760001
207700*                                                                *20770001
207800* FIRST, DELETE THE SELECTION QUEUE, NEXT LOAD THE SELECTION     *20780001
207900* QUEUE RECORD.  FINALLY, WRITE THE SELECTION QUEUE ITEM WHEN    *20790001
208000* THE ARRAY IS FULL.                                             *20800001
208100*----------------------------------------------------------------*20810001
208200 5000-PREPARE-SEL-QUEUE.                                          20820001
208300     MOVE +1                   TO  ASC-BLK-SUB.                   20830001
208400     PERFORM 5100-WRITE-TEMP-STORAGE.                             20840001
208500     ADD +1                    TO  ASC-BLK-SUB.                   20850001
208600     PERFORM 5100-WRITE-TEMP-STORAGE.                             20860001
208700                                                                  20870001
208800     MOVE ASC-SEL-QUEUE-NAME   TO  SU101-SEL-QUEUE-NAME.          20880006
208900     PERFORM 6010-DELETE-SEL-QUEUE.                               20890001
209000                                                                  20900001
209100     SET ASC-UPDATE-TSQ        TO  TRUE.                          20910001
209200                                                                  20920001
209300     SET SU102-IDX             TO  1.                             20930007
209400     MOVE ZERO                 TO SU101-NUMBER-OF-TS-ITEMS.       20940006
209500     INITIALIZE SU102-SELECTED-ITEM-ARRAY.                        20950007
209600                                                                  20960001
209700     PERFORM 5200-FILL-SEL-QUEUE-RECORD                           20970001
209800             VARYING PV-ITEM                                      20980001
209900             FROM 1 BY 1                                          20990001
210000             UNTIL PV-ITEM GREATER ASC-HIGHEST-BLOCK-WRITTEN.     21000001
210100                                                                  21010001
210200     IF  SU102-IDX > 1                                            21020007
210300         PERFORM 5205-WRITE-SEL-QUEUE                             21030001
210400         ADD +1                TO SU101-NUMBER-OF-TS-ITEMS        21040006
210500     END-IF.                                                      21050001
210600                                                                  21060001
210700*----------------------------------------------------------------*21070001
210800*    WRITE A NEW BLOCK FROM THE ARRAY TO TEMPORARY STORAGE.      *21080001
210900*    REWRITE AN EXISITING BLOCK ONLY IF IT HAS BEEN MODIFIED.    *21090001
211000*----------------------------------------------------------------*21100001
211100 5100-WRITE-TEMP-STORAGE.                                         21110001
211200     MOVE ASC-LIST-ITEM-NUMBER(ASC-BLK-SUB 1)                     21120001
211300                                   TO PV-LIST-ITEM-NUMBER.        21130001
211400     COMPUTE PV-BLOCK-NUMBER =                                    21140001
211500         1 + ((PV-LIST-ITEM-NUMBER - 1) / PC-ITEMS-PER-PANEL).    21150001
211600                                                                  21160001
211700     IF (PV-BLOCK-NUMBER < ASC-HIGHEST-BLOCK-WRITTEN)             21170001
211800     OR (PV-BLOCK-NUMBER = ASC-HIGHEST-BLOCK-WRITTEN)             21180001
211900         IF  ASC-BLOCK-MODIFIED(ASC-BLK-SUB)                      21190001
212000             PERFORM 5105-REWRITE-ASC-LISTQ                       21200001
212100         END-IF                                                   21210001
212200     ELSE                                                         21220001
212300         COMPUTE PV-HIGHEST-BLOCK-WRITTEN =                       21230001
212400         ASC-HIGHEST-BLOCK-WRITTEN + 1                            21240001
212500         PERFORM 5110-WRITE-ASC-LISTQ                             21250001
212600         ADD +1                    TO ASC-HIGHEST-BLOCK-WRITTEN   21260001
212700     END-IF.                                                      21270001
212800                                                                  21280001
212900     SET ASC-BLOCK-NOT-MODIFIED(ASC-BLK-SUB) TO TRUE.             21290001
213000                                                                  21300001
213100******************************************************************21310001
213200** REWRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-    **21320001
213300** SPECIFIC COMMAREA.                                           **21330001
213400******************************************************************21340001
213500 5105-REWRITE-ASC-LISTQ.                                          21350001
213600     EXEC CICS                                                    21360001
213700         WRITEQ TS                                                21370001
213800             QUEUE (ASC-LIST-QUEUE-NAME)                          21380001
213900             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21390001
214000             ITEM  (PV-BLOCK-NUMBER)                              21400001
214100             REWRITE                                              21410001
214200             RESP  (PV-CICS-RESP)                                 21420001
214300     END-EXEC.                                                    21430001
214400                                                                  21440001
214500     IF  PV-CICS-RESP = DFHRESP(NORMAL)                           21450001
214600         CONTINUE                                                 21460001
214700     ELSE                                                         21470001
214800         SET DP013-CICS-ABEND            TO TRUE                  21480001
214900         SET DP013-NO-ROLLBACK           TO TRUE                  21490001
215000         MOVE '5105-REWRITE-ASC-LISTQ'   TO DP013-PARAGRAPH       21500001
215100         MOVE 'ATTEMPTING TO REWRITE LIST TEMP STORAGE QUEUE'     21510001
215200                                         TO DP013-MESSAGE-TEXT(1) 21520001
215300         PERFORM DP013-0000-PROCESS-ABEND                         21530001
215400     END-IF.                                                      21540001
215500                                                                  21550001
215600******************************************************************21560001
215700** WRITE THE LIST TEMP STORAGE QUEUE FROM THE APPLICATION-      **21570001
215800** SPECIFIC COMMAREA.                                           **21580001
215900******************************************************************21590001
216000 5110-WRITE-ASC-LISTQ.                                            21600001
216100     EXEC CICS                                                    21610001
216200         WRITEQ TS                                                21620001
216300             QUEUE (ASC-LIST-QUEUE-NAME)                          21630001
216400             FROM  (ASC-BLOCK-ENTRIES(ASC-BLK-SUB))               21640001
216500             ITEM  (PV-BLOCK-NUMBER)                              21650001
216600             RESP  (PV-CICS-RESP)                                 21660001
216700     END-EXEC.                                                    21670001
216800     IF  PV-CICS-RESP NOT = DFHRESP (NORMAL)                      21680001
216900         SET DP013-CICS-ABEND      TO TRUE                        21690001
217000         SET DP013-NO-ROLLBACK     TO TRUE                        21700001
217100         MOVE '5110-WRITE-ASC-LISTQ'                              21710001
217200                                   TO DP013-PARAGRAPH             21720001
217300         MOVE 'ATTEMPTING TO DELETE TEMP STORAGE QUEUE'           21730001
217400                                   TO DP013-MESSAGE-TEXT(1)       21740001
217500         PERFORM DP013-0000-PROCESS-ABEND                         21750001
217600     END-IF.                                                      21760001
217700                                                                  21770001
217800*----------------------------------------------------------------*21780001
217900* READ A LIST QUEUE RECORD AND MOVE THE KEYS OF SELECTED OBJECTS *21790001
218000* TO THE SELECTED ITEMS TEMP STORAGE QUEUE RECORD.               *21800001
218100*----------------------------------------------------------------*21810001
218200 5200-FILL-SEL-QUEUE-RECORD.                                      21820001
218300     PERFORM 6112-READ-LIST-QUEUE.                                21830001
218400                                                                  21840001
218500     IF  PV-CICS-RESP EQUAL DFHRESP(NORMAL)                       21850001
218600         PERFORM VARYING LQW-IDX                                  21860001
218700         FROM 1 BY 1                                              21870001
218800         UNTIL LQW-IDX GREATER THAN PC-ITEMS-PER-PANEL            21880001
218900           OR  LQW-LIST-ITEM-NUMBER(LQW-IDX) = ZERO               21890001
219000                                                                  21900001
219010           MOVE 'S'    TO LQW-SELECTED-SW   (LQW-IDX)             21901099
219100           IF LQW-SELECT (LQW-IDX)                                21910099
219200                 MOVE LQW-LIST-ITEM-NUMBER(LQW-IDX) TO            21920001
219300                          SU102-ITEM (SU102-IDX)                  21930036
219400*                MOVE LQW-ACTION (LQW-IDX)       TO               21940099
219500*                         SU102-ACTION-SW (SU102-IDX)             21950099
219501                 MOVE PC-INQ                                      21950199
219502                                  TO SU102-ACTION-SW   (SU102-IDX)21950299
219503                 MOVE ASC-PO                     TO               21950399
219504                          SU102-PO-NUMBER (SU102-IDX)             21950499
219505                 MOVE ASC-LINE-NO-X              TO               21950599
219506                          SU102-LINE-PACK (SU102-IDX)             21950699
219507                 MOVE ASC-RECEIVER               TO               21950799
219508                          SU102-RCVR      (SU102-IDX)             21950899
219510                 MOVE SU100-OPER-UNIT            TO               21951036
219520                          SUT00102-OPER-UNT-ID                    21952037
219620                 MOVE LQW-AUDIT-NUMBER (LQW-IDX) TO               21962019
219700                          SUT00102-AUD-CNTL-NBR                   21970037
219800*                MOVE LQW-CREATE-DATE  (LQW-IDX) TO               21980019
219900*                MOVE LQW-CREATE-TIME  (LQW-IDX) TO               21990019
220920*                         SUT00102-CRE-TMST                       22092037
220930                 MOVE LQW-DIR-CODE (LQW-IDX) TO                   22093026
220940                          SUT00102-DIRV-RSN-CDE                   22094037
220941                 MOVE LQW-LOC-SENT     (LQW-IDX) TO               22094119
220950                          SUT00102-STR-NBR                        22095080
220961                 MOVE LQW-DIR-TYPE     (LQW-IDX) TO               22096119
220962                          SUT00102-CART-STAT-CDE                  22096280
220963                          SUT00102-CNVYR-PRC-ACTN-NM              22096380
220981                 MOVE LQW-CASI         (LQW-IDX) TO               22098119
220998                          SUT00102-CASI-CDE                       22099837
221000                 MOVE LQW-FAIL-RSN-CODE(LQW-IDX) TO               22100019
221001                          SUT00102-AUD-FALR-RSN-NM                22100137
221005                 MOVE LQW-USER-ID      (LQW-IDX) TO               22100519
221006                          SUT00102-CRE-BY-USR-ID                  22100637
221007                 MOVE LQW-USER-NAME    (LQW-IDX) TO               22100738
221008                          PV-NAME-15                              22100899
221020                                                                  22102001
221100                 SET SU102-IDX UP BY 1                            22110007
221200                 IF  SU102-IDX > SU102-MAX-ITEMS                  22120007
221300                     PERFORM 5205-WRITE-SEL-QUEUE                 22130001
221400                     ADD +1        TO SU101-NUMBER-OF-TS-ITEMS    22140006
221500                     INITIALIZE SU102-SELECTED-ITEM-ARRAY         22150007
221600                     SET SU102-IDX TO  1                          22160007
221700                 END-IF                                           22170099
221800           END-IF                                                 22180001
221900         END-PERFORM                                              22190001
222000     END-IF.                                                      22200001
222100                                                                  22210001
222200*----------------------------------------------------------------*22220001
222300*    WRITE THE SELECTED ITEMS TEMP STORAGE QUEUE.                *22230001
222400*----------------------------------------------------------------*22240001
222500 5205-WRITE-SEL-QUEUE.                                            22250001
222600     MOVE ASC-NUMBER-OF-SELECTED-ITEMS TO SU102-SELECTED-ITEMS.   22260007
222700                                                                  22270001
222800     EXEC CICS                                                    22280001
222900          WRITEQ TS                                               22290001
223000              QUEUE (ASC-SEL-QUEUE-NAME)                          22300001
223100              FROM  (SU102-SELECT-RECORD)                         22310007
223200              ITEM  (PV-SEL-QUEUE-ITEM)                           22320001
223300              RESP  (PV-CICS-RESP)                                22330001
223400     END-EXEC.                                                    22340001
223500                                                                  22350001
223600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          22360001
223700         CONTINUE                                                 22370001
223800     ELSE                                                         22380001
223900         SET DP013-CICS-ABEND      TO TRUE                        22390001
224000         SET DP013-NO-ROLLBACK     TO TRUE                        22400001
224100         MOVE '5205-WRITE-SEL-QUEUE'                              22410001
224200                                   TO DP013-PARAGRAPH             22420001
224300         MOVE 'ATTEMPTING TO WRITE SELECTED ITEMS QUEUE'          22430001
224400                                   TO DP013-MESSAGE-TEXT(1)       22440001
224500         PERFORM DP013-0000-PROCESS-ABEND                         22450001
224600     END-IF.                                                      22460001
224700                                                                  22470001
224800******************************************************************22480001
224900** WHEN RETURNING TO THIS TRANSACTION FROM ANOTHER TRANSACTION, **22490001
225000** SETUP THE ARRAY AS IT WAS WHEN WE HAD LEFT PREVIOUSLY.  EDIT **22500001
225100** THE SELECTIONS MADE AT THAT TIME AND DISPLAY THE PANEL TO    **22510001
225200** THE USER.                                                    **22520001
225300******************************************************************22530001
225400 6000-REFRESH-PANEL-FROM-TEMP.                                    22540001
225500     IF  ASC-UPDATE-TSQ                                           22550001
225600         SET ASC-NO-TSQ-UPDATE TO TRUE                            22560001
225700         MOVE ZERO                 TO PV-SAVE-ITEM                22570001
225800                                      PV-SEL-QUEUE-ITEM           22580001
225900         MOVE ASC-NUMBER-OF-SELECTED-ITEMS                        22590001
226000                                   TO PV-HOLD-SELECTED-ITEMS      22600001
226100         MOVE +1                   TO PV-ITEMS-PROCESSED          22610001
226200         PERFORM 6100-UPDATE-TSQ                                  22620001
226300             UNTIL PV-ITEMS-PROCESSED >                           22630001
226400                                     PV-HOLD-SELECTED-ITEMS       22640001
226500         INITIALIZE ASC-BLOCK-ENTRIES (1)                         22650001
226600                    ASC-BLOCK-ENTRIES (2)                         22660001
226700     END-IF.                                                      22670001
226800                                                                  22680001
226900*----------------------------------------------------------------*22690001
227000*    DELETE THE SELECTED ITEMS TEMP STORAGE QUEUE.               *22700001
227100*----------------------------------------------------------------*22710001
227200 6010-DELETE-SEL-QUEUE.                                           22720001
227300                                                                  22730001
227400     EXEC CICS                                                    22740001
227500         DELETEQ TS                                               22750001
227600             QUEUE (ASC-SEL-QUEUE-NAME)                           22760001
227700             RESP  (PV-CICS-RESP)                                 22770001
227800     END-EXEC.                                                    22780001
227900*                                                                 22790001
228000     IF ((PV-CICS-RESP = DFHRESP(NORMAL)) OR                      22800001
228100        (PV-CICS-RESP = DFHRESP(QIDERR)))                         22810001
228200         CONTINUE                                                 22820001
228300     ELSE                                                         22830001
228400         SET DP013-CICS-ABEND TO TRUE                             22840001
228500         SET DP013-NO-ROLLBACK TO TRUE                            22850001
228600         MOVE '6010-DELETE-SEL-QUEUE' TO DP013-PARAGRAPH          22860001
228700         MOVE 'ERROR TRYING TO DELETE SELECTION TS QUEUE'         22870001
228800                                        TO DP013-MESSAGE-TEXT (1) 22880001
228900         PERFORM DP013-0000-PROCESS-ABEND                         22890001
229000     END-IF.                                                      22900001
229100                                                                  22910001
229200*----------------------------------------------------------------*22920001
229300*    INCREMENT THE TSQ ITEM NUMBER AND READ THE LIST QUEUE.      *22930001
229400*    LOOP THROUGH THE LIST QUEUE TO OBTAIN THE LINE ITEM NUMBER  *22940001
229500*    TO BE USED TO UPDATE (DESELECT) THE CORRECT LINE ITEM IN    *22950001
229600*    THE TEMP QUEUE.                                             *22960001
229700*----------------------------------------------------------------*22970001
229800 6100-UPDATE-TSQ.                                                 22980001
229900                                                                  22990001
230000     ADD 1    TO  PV-SEL-QUEUE-ITEM.                              23000001
230100     PERFORM 6105-READ-SEL-QUEUE.                                 23010001
230200     PERFORM                                                      23020001
230300         VARYING SU102-IDX FROM 1 BY 1                            23030007
230400         UNTIL ((PV-ITEMS-PROCESSED > PV-HOLD-SELECTED-ITEMS)     23040001
230500         OR (SU102-IDX GREATER THAN SU102-MAX-ITEMS))             23050007
230600         IF  SU102-ACTION-SW (SU102-IDX) > SPACE                  23060007
230700             PERFORM 6110-PROCESS-ITEMS                           23070001
230800         END-IF                                                   23080001
230900         ADD +1                TO PV-ITEMS-PROCESSED              23090001
231000     END-PERFORM.                                                 23100001
231100     PERFORM 6111-WRITE-LIST-QUEUE.                               23110001
231200                                                                  23120001
231300*----------------------------------------------------------------*23130001
231400*    READ THE LIST QUEUE RECORD.                                 *23140001
231500*----------------------------------------------------------------*23150001
231600 6105-READ-SEL-QUEUE.                                             23160001
231700                                                                  23170001
231800     EXEC CICS                                                    23180001
231900          READQ TS                                                23190001
232000              QUEUE (ASC-SEL-QUEUE-NAME)                          23200001
232100              INTO  (SU102-SELECT-RECORD)                         23210007
232200              ITEM  (PV-SEL-QUEUE-ITEM)                           23220001
232300              RESP  (PV-CICS-RESP)                                23230001
232400     END-EXEC.                                                    23240001
232500*                                                                 23250001
232600     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          23260001
232700         CONTINUE                                                 23270001
232800     ELSE                                                         23280001
232900         SET DP013-CICS-ABEND      TO  TRUE                       23290001
233000         SET DP013-NO-ROLLBACK     TO  TRUE                       23300001
233100         MOVE '6105-READ-SEL-QUEUE'                               23310001
233200                                   TO  DP013-PARAGRAPH            23320001
233300         MOVE 'ATTEMPTING TO READ SELECTED ITEMS QUEUE'           23330001
233400                                   TO  DP013-MESSAGE-TEXT(1)      23340001
233500         PERFORM DP013-0000-PROCESS-ABEND                         23350001
233600     END-IF.                                                      23360001
233700                                                                  23370001
233800*----------------------------------------------------------------*23380001
233900*    CALCULATE THE TEMP QUEUE ITEM THAT MUST BE READ AND READ IT.*23390001
234000*    REWRITE THE CURRENT TEMP QUEUE ITEM IF NECESSARY.  CALCULATE*23400001
234100*    THE LINE ITEM OCCURENCE AND UPDATE (DESELECT) IT.           *23410001
234200*----------------------------------------------------------------*23420001
234300 6110-PROCESS-ITEMS.                                              23430001
234400                                                                  23440001
234500     COMPUTE PV-ITEM = 1 + ((SU102-ITEM (SU102-IDX) - 1)          23450007
234600                     / PC-ITEMS-PER-PANEL).                       23460001
234700                                                                  23470001
234800     IF  PV-ITEM NOT EQUAL PV-SAVE-ITEM                           23480001
234900         IF  PV-SAVE-ITEM NOT EQUAL ZERO                          23490001
235000             PERFORM 6111-WRITE-LIST-QUEUE                        23500001
235100         END-IF                                                   23510001
235200         MOVE PV-ITEM          TO PV-SAVE-ITEM                    23520001
235300                                                                  23530001
235400         PERFORM 6112-READ-LIST-QUEUE                             23540001
235500         IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)               23550001
235600             CONTINUE                                             23560001
235700         END-IF                                                   23570001
235800     END-IF.                                                      23580001
235900                                                                  23590001
236000     COMPUTE PV-SUB = (SU102-ITEM (SU102-IDX)                     23600007
236100                    - LQW-LIST-ITEM-NUMBER (1)) + 1.              23610001
236200     SET LQW-DESELECT (PV-SUB) TO    TRUE                         23620001
236300     MOVE LQW-SELECTED-SW (PV-SUB)                                23630001
236400                               TO LQW-TEMP-SELECTED-SW (PV-SUB).  23640001
236500     EVALUATE TRUE                                                23650001
236600         WHEN SU102-INQ (SU102-IDX)                               23660007
236700              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             23670001
236800                                                                  23680001
238900                                                                  23890001
239000         WHEN OTHER                                               23900001
239100              MOVE PC-INQ      TO LQW-ACTION (PV-SUB)             23910001
239200                                                                  23920001
239300     END-EVALUATE.                                                23930001
239400                                                                  23940001
239500     SUBTRACT 1 FROM ASC-NUMBER-OF-SELECTED-ITEMS.                23950001
239600                                                                  23960001
239700*----------------------------------------------------------------*23970001
239800*    WRITE THE TS QUEUE RECORD JUST UPDATED IN C600.             *23980001
239900*----------------------------------------------------------------*23990001
240000 6111-WRITE-LIST-QUEUE.                                           24000001
240100                                                                  24010001
240200     EXEC CICS                                                    24020001
240300         WRITEQ TS                                                24030001
240400             QUEUE (ASC-LIST-QUEUE-NAME)                          24040001
240500             FROM  (LQW-LIST-QUEUE-WORK-AREA)                     24050001
240600             ITEM  (PV-SAVE-ITEM)                                 24060001
240700             REWRITE                                              24070001
240800             RESP  (PV-CICS-RESP)                                 24080001
240900     END-EXEC.                                                    24090001
241000*                                                                 24100001
241100     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24110001
241200         CONTINUE                                                 24120001
241300     ELSE                                                         24130001
241400         SET DP013-CICS-ABEND  TO  TRUE                           24140001
241500         SET DP013-NO-ROLLBACK TO  TRUE                           24150001
241600         MOVE '6111-WRITE-LIST-QUEUE' TO  DP013-PARAGRAPH         24160001
241700         MOVE 'ATTEMPTING TO REWRITE LIST QUEUE'                  24170001
241800                               TO  DP013-MESSAGE-TEXT(1)          24180001
241900         PERFORM DP013-0000-PROCESS-ABEND                         24190001
242000     END-IF.                                                      24200001
242100                                                                  24210001
242200*----------------------------------------------------------------*24220001
242300*    READ THE TEMPORARY STORAGE QUEUE INTO A TEMPORARY WORK AREA.*24230001
242400*----------------------------------------------------------------*24240001
242500 6112-READ-LIST-QUEUE.                                            24250001
242600     EXEC CICS                                                    24260001
242700         READQ TS                                                 24270001
242800             QUEUE (ASC-LIST-QUEUE-NAME)                          24280001
242900             INTO  (LQW-LIST-QUEUE-WORK-AREA)                     24290001
243000             ITEM  (PV-ITEM)                                      24300001
243100             RESP  (PV-CICS-RESP)                                 24310001
243200     END-EXEC.                                                    24320001
243300*                                                                 24330001
243400     IF  PV-CICS-RESP = DFHRESP (NORMAL)                          24340001
243500         CONTINUE                                                 24350001
243600     ELSE                                                         24360001
243700         SET DP013-CICS-ABEND        TO TRUE                      24370001
243800         SET DP013-NO-ROLLBACK       TO TRUE                      24380001
243900         MOVE '6112-READ-LIST-QUEUE' TO DP013-PARAGRAPH           24390001
244000         MOVE 'ATTEMPTING TO READQ LIST QUEUE'                    24400001
244100                                     TO DP013-MESSAGE-TEXT(1)     24410001
244200         PERFORM DP013-0000-PROCESS-ABEND                         24420001
244300     END-IF.                                                      24430001
244400                                                                  24440001
244401*----------------------------------------------------------------*24440183
244402*    LOOK UP USER ID'S NAME                                      *24440283
244403*----------------------------------------------------------------*24440383
244410 7000-USER-NAME.                                                  24441083
244420                                                                  24442083
244430     INITIALIZE XL067-USER-COMMAREA.                              24443083
244440                                                                  24444083
244450     SET XL067-BY-USER-ID            TO TRUE.                     24445083
244460     SET XL067-SELECT-BOTH-USERS     TO TRUE.                     24446087
244470                                                                  24447083
244480     MOVE SUT00102-CRE-BY-USR-ID     TO XL067-KEY-USER-ID.        24448083
244490                                                                  24449083
244491     CALL XL067-USER-PGM USING DFHEIBLK                           24449183
244492                               XL067-COMMAREA                     24449283
244493                               XL067-USER-COMMAREA.               24449383
244494     EVALUATE TRUE                                                24449483
244495         WHEN XL067-SUCCESSFUL                                    24449583
244496             CONTINUE                                             24449683
244497         WHEN OTHER                                               24449783
244498              DISPLAY '***********************************'       24449883
244499              DISPLAY '****     SUKCS573  ABEND       ****'       24449983
244500              DISPLAY '***********************************'       24450083
244501              DISPLAY '**  PARAGRAPH 7000-USER-NAME     **'       24450183
244502              DISPLAY '**  UNSUCCESSFUL CALL TO XLKUT067**'       24450283
244503              DISPLAY '**  SEE PROD COPYBOOK XLWS067    **'       24450383
244504              DISPLAY '**  XL067-RETURN-CODE:'  XL067-RETURN-CODE 24450483
244505              DISPLAY '***********************************'       24450583
244506              MOVE '7000-USER-NAME' TO DP013-PARAGRAPH            24450683
244507              MOVE 'SELECT INFO PROBLEM '                         24450783
244508                                    TO DP013-MESSAGE-TEXT (1)     24450883
244509              MOVE SQLCA            TO DP013-SQLCA                24450983
244510              MOVE 'XLT_USR '       TO DP013-DB2-TABLE-NAME (1)   24451083
244512              SET DP013-DB2-ABEND   TO TRUE                       24451283
244513              PERFORM DP013-0000-PROCESS-ABEND                    24451383
244514     END-EVALUATE.                                                24451485
244515*----------------------------------------------------------------*24451599
244516* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *24451699
244517*----------------------------------------------------------------*24451799
244518 9100-READ-SEL-QUEUE.                                             24451899
244519     EXEC CICS                                                    24451999
244520         READQ TS                                                 24452099
244521             QUEUE (ASC-SEL-QUEUE-NAME)                           24452199
244522             INTO  (SU102-SELECT-RECORD)                          24452299
244523             ITEM  (ASC-SEL-ITEM)                                 24452399
244524             RESP  (PV-CICS-RESPONSE)                             24452499
244525     END-EXEC.                                                    24452599
244526                                                                  24452699
244527     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       24452799
244528         CONTINUE                                                 24452899
244529     ELSE                                                         24452999
244530         SET DP013-LOGIC-ABEND                                    24453099
244531             DP013-NO-ROLLBACK     TO TRUE                        24453199
244532         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            24453299
244533         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   24453399
244534                                   TO DP013-MESSAGE-TEXT (1)      24453499
244535         PERFORM DP013-0000-PROCESS-ABEND                         24453599
244536     END-IF.                                                      24453699
244537                                                                  24453799
244538                                                                  24453899
244539*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%*24453997
244540 9200-REWRITE-SEL-QUEUE.                                          24454096
244541                                                                  24454195
244542     EXEC CICS                                                    24454295
244543          WRITEQ TS                                               24454395
244544              QUEUE  (ASC-SEL-QUEUE-NAME)                         24454499
244545              FROM   (SU102-SELECT-RECORD)                        24454598
244546              ITEM   (ASC-SEL-ITEM)                               24454695
244547              RESP   (PV-CICS-RESP)                               24454795
244548               REWRITE                                            24454895
244549     END-EXEC.                                                    24454995
244550                                                                  24455095
244551     IF  PV-CICS-RESP NOT EQUAL DFHRESP(NORMAL)                   24455195
244552         SET DP013-CICS-ABEND                                     24455295
244553             DP013-NO-ROLLBACK     TO TRUE                        24455395
244554         MOVE '9200-REWRITE-SEL-QUEUE'                            24455495
244555                                   TO DP013-PARAGRAPH             24455595
244556         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   24455695
244557                                   TO DP013-MESSAGE-TEXT (1)      24455795
244558         PERFORM DP013-0000-PROCESS-ABEND                         24455895
244559     END-IF.                                                      24455995
244560                                                                  24456095
244561                                                                  24456195
244570*----------------------------------------------------------------*24457001
244600*    ABEND PROCESSOR MODULE                                      *24460001
244700*----------------------------------------------------------------*24470001
244800     COPY DPPD013.                                                24480001
