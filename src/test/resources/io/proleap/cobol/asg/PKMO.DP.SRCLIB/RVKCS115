000100******************************************************************00010027
000200 IDENTIFICATION DIVISION.                                         00020027
000300******************************************************************00030027
000400                                                                  00040027
000500 PROGRAM-ID.                RVKCS115.                             00050027
000600 AUTHOR.                    MICHAEL WALTERS.                      00060027
000700 INSTALLATION.              KOHLS DEPARTMENT STORES.              00070027
000800 DATE-WRITTEN.              12-15-93.                             00080027
000900 DATE-COMPILED.                                                   00090027
001000                                                                  00100027
001100******************************************************************00110027
001200*  CICS PROGRAM - RVKCS115 - E115                                *00120027
001300*                                                                *00130027
001400*       RETURN-TO-VENDOR SYSTEM - INVENTORY REPORT REQUEST       *00140027
001500*                                                                *00150027
001600*  TO TEST THIS PROGRAM SEE PARAGRAPH 5000- UNCOMMENT THE LINES  *00160027
001700*     FOR THE TEST JOBCARDS AND COMMENT OUT THE PRODUCTION JOB   *00170027
001800*     CARDS.  WHEN READY TO GO BACK TO PRODUCTION, COMMENT OUT   *00180027
001900*     THE TEST JOBCARDS AND UNCOMMENT THE PRODUCTION JOBCARDS.   *00190027
002000*                                                                *00200027
002100*       THIS PROGRAM WILL BEGIN BATCH JOB RVK900C TO CREATE A    *00210027
002200*  RETURN-TO-VENDORY INVENTORY REPORT BASED UPON CRITERIA        *00220027
002300*  SPECIFIED BY THE USER.                                        *00230027
002400*                                                                *00240027
002500*       THE FOLLOWING PF KEYS FUNCTIONS ARE AVAILABLE:           *00250027
002600*                                                                *00260027
002700*         F18 ==> PRINT                                          *00270027
002800*                                                                *00280027
002900******************************************************************00290027
003000*  CHANGE LOG.                                                    00300027
003100*  DATE         CHANGED BY      DESC                              00310027
003200*  -----------  --------------  ----------------------------------00320027
003300* 10/30/2011   C. STRODTHOFF - GENCO / RTV UPGRADE. CHANGE        00330027
003400*                              OPER-UNT-ID TO RTV-LOC AND ADD TO  00340027
003500*                              REPORT. GET DB2 CURRENT DATE FROM  00350027
003600*                              TKRPRPM. PRJ ID 3219 - WR40134.    00360027
003700***************************************************************** 00370027
263627* CHANGED 11/04/2021    BY JIM HUNTER      WR: CHG0263627         00372029
263627* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00373029
263627* MAKING THE CALL DYNAMIC VS STATIC.                              00374029
003700***************************************************************** 00376029
CICS  *  CHANGED 11/07/2022    BY JIM HUNTER      WR: CHG0277924        00377031
CICS  *                                                                 00378030
CICS  *  ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL       00379030
CICS  *  DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.      00379130
CICS  ***************************************************************** 00379230
003800                                                                  00380027
003900******************************************************************00390027
004000 ENVIRONMENT DIVISION.                                            00400027
004100******************************************************************00410027
004200                                                                  00420027
004300******************************************************************00430027
004400 DATA DIVISION.                                                   00440027
004500******************************************************************00450027
004600                                                                  00460027
004700 WORKING-STORAGE SECTION.                                         00470027
004800                                                                  00480027
004900******************************************************************00490027
005000*  WORK AREA FOR FISCAL CALENDAR ROUTINE.                         00500027
005100*                                                                 00510027
005200     COPY DPWS500.                                                00520027
005300                                                                  00530027
005400******************************************************************00540027
005500*  SENDING/RECEIVING AREA FOR THE NUMERIC EDIT ROUTINE (DPKUT100) 00550027
005600*                                                                 00560027
005700                                                                  00570027
005800     COPY DPWS010I.                                               00580027
005900                                                                  00590027
006000******************************************************************00600027
006100*  PARAMETER LIST FOR CALLING THE MBS LOOKUP SUBROUTINE           00610027
006200*                                                                 00620027
006300     COPY DPWS003.                                                00630027
006400                                                                  00640027
006500******************************************************************00650027
006600*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA                00660027
006700     COPY DPWS013.                                                00670027
006800*                                                                 00680027
006900******************************************************************00690027
007000*  CICS ATTRIBUTES COPYBOOK                                       00700027
007100     COPY DPWS015.                                                00710027
007200*                                                                 00720027
007300******************************************************************00730027
007400*  FUNCTION KEYS COPYBOOK                                         00740027
007500     COPY DPWS016.                                                00750027
007600*                                                                 00760027
007700******************************************************************00770027
007800*  SENDING/RECEIVING AREA FOR THE                                *00780027
007900*  PRINTER VALIDATION ROUTING (DPKCS060)                         *00790027
008000******************************************************************00800027
008100     COPY DPWS072.                                                00810027
008200*                                                                 00820027
008300******************************************************************00830027
008400*  STANDARD ATTENTION IDENTIFIER LIST                             00840027
008500*                                                                 00850027
008600                                                                  00860027
008700     COPY DFHAID.                                                 00870027
008800                                                                  00880027
008900*                                                                 00890027
009000*  STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST          00900027
009100*                                                                 00910027
009200                                                                  00920027
009300     COPY DFHBMSCA.                                               00930027
009400                                                                  00940027
009500*                                                                 00950027
009600*  DSECT FOR THE RVKM115 MAPSET                                   00960027
009700*                                                                 00970027
009800                                                                  00980027
009900     COPY RVKM115.                                                00990027
010000                                                                  01000027
010100                                                                  01010027
010200 01  DK-DB2-KEYS.                                                 01020027
010300*    05  DK-OPER-UNT-ID                 PIC S9(04)  COMP VALUE +0.01030027
010400     05  DK-RTV-LOC-NBR                 PIC S9(04)  COMP VALUE +0.01040027
010500     05  DK-BUYER-NBR                   PIC X(03)   VALUE SPACES. 01050027
010600     05  DK-DEPT-NBR                    PIC X(03)   VALUE SPACES. 01060027
010700     05  DK-VND-NBR                     PIC X(09)   VALUE SPACES. 01070027
010800                                                                  01080027
010900 01  PS-PROGRAM-SWITCHES.                                         01090027
011000     05  PS-EDIT-ERROR-IND       PIC X(1)     VALUE 'N'.          01100027
011100         88  PS-NO-EDIT-ERROR                 VALUE 'N'.          01110027
011200         88  PS-EDIT-ERROR                    VALUE 'Y'.          01120027
011300     05  PS-TD-ERROR-IND         PIC X(1)     VALUE 'N'.          01130027
011400         88  PS-NO-TD-ERROR                   VALUE 'N'.          01140027
011500         88  PS-TD-ERROR                      VALUE 'Y'.          01150027
011600     05  PS-VALID-OPER-IND       PIC X(1)     VALUE 'N'.          01160027
011700         88  PS-INVALID-OPER                  VALUE 'N'.          01170027
011800         88  PS-VALID-OPER                    VALUE 'Y'.          01180027
011900     05  PS-VALID-DATES-IND      PIC X(1)     VALUE 'N'.          01190027
012000         88  PS-INVALID-DATES                 VALUE 'N'.          01200027
012100         88  PS-VALID-DATES                   VALUE 'Y'.          01210027
012200     05  PS-VALID-VENDOR-IND     PIC X(1)     VALUE 'N'.          01220027
012300         88  PS-INVALID-VENDOR                VALUE 'N'.          01230027
012400         88  PS-VALID-VENDOR                  VALUE 'Y'.          01240027
012500     05  PS-VALID-BUYER-IND      PIC X(1)     VALUE 'N'.          01250027
012600         88  PS-INVALID-BUYER                 VALUE 'N'.          01260027
012700         88  PS-VALID-BUYER                   VALUE 'Y'.          01270027
012800     05  PS-VALID-DEPT-IND       PIC X(1)     VALUE 'N'.          01280027
012900         88  PS-INVALID-DEPT                  VALUE 'N'.          01290027
013000         88  PS-VALID-DEPT                    VALUE 'Y'.          01300027
013100     05  PS-TKRPRPM-IND          PIC X(1)     VALUE 'N'.          01310027
013200         88  PS-TKRPRPM-NOT-FOUND             VALUE 'N'.          01320027
013300         88  PS-TKRPRPM-FOUND                 VALUE 'Y'.          01330027
013400                                                                  01340027
013500 01  PC-PROGRAM-CONSTANTS.                                        01350027
013600     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'RVKCS115'.   01360027
013700     05  PC-CURRENT-MAPSET-NAME  PIC X(08)    VALUE 'RVKM115'.    01370027
013800     05  PC-CURRENT-MAP-NAME     PIC X(08)    VALUE 'RV115A'.     01380027
014000     05  PC-DPKCS060             PIC X(08)    VALUE 'DPKCS060'.   01400027
014100     05  PC-DPKUT038             PIC X(08)    VALUE 'DPKUT038'.   01410027
014200     05  PC-MAX-RETRIES          PIC S9(4)    VALUE +2.           01420027
014300     05  PC-SYSTEM-CODE          PIC X(02)    VALUE 'RV'.         01430027
014400     05  PC-KOHLS-OPERATING-COMPANY                               01440027
014500                                 PIC X(2)     VALUE '03'.         01450027
014600     05  PC-EOF-KEYED-COMP       PIC S9(4)    VALUE +128          01460027
014700                                 COMP SYNC.                       01470027
014800     05  FILLER                  REDEFINES PC-EOF-KEYED-COMP.     01480027
014900         10  FILLER              PIC X(1).                        01490027
015000         10  PC-EOF-KEYED        PIC X(1).                        01500027
015100     05  PC-RSPLVL-CDE           PIC X(03)    VALUE 'BYR'.        01510027
015200     05  PC-MDSELV-CDE           PIC X(03)    VALUE 'DPT'.        01520027
015300                                                                  01530027
015400 01  PC-TSYMSG-AREA.                                              01540027
015500*  INVALID ENTRY 00005                                            01550027
015600     05  PC-TSYMSG-00005      PIC 9(5) VALUE 00005.               01560027
015700*  REQUIRED ENTRY 00007                                           01570027
015800     05  PC-TSYMSG-00007      PIC 9(5) VALUE 00007.               01580027
015900*  MUST BE NUMBERIC                                               01590027
016000     05  PC-TSYMSG-00008      PIC 9(5) VALUE 00008.               01600027
016100*  INVALID DATE                                                   01610027
016200     05  PC-TSYMSG-00009      PIC 9(5) VALUE 00009.               01620027
016300*  DEPT DOES NOT EXIST                                            01630027
016400     05  PC-TSYMSG-00032      PIC 9(5) VALUE 00032.               01640027
016500*  PRINT REQUEST SUBMITTED                                        01650027
016600     05  PC-TSYMSG-00098      PIC 9(5) VALUE 00098.               01660027
016700*  INVALID START/STOP DATE COMBINIATION                           01670027
016800     05  PC-TSYMSG-00107      PIC 9(5) VALUE 00107.               01680027
016900*  BUYER NUMBER DOES NOT EXIST                                    01690027
017000     05  PC-TSYMSG-00305      PIC 9(5) VALUE 00305.               01700027
017100*  VENDOR NOT FOUND                                               01710027
017200     05  PC-TSYMSG-00608      PIC 9(5) VALUE 00608.               01720027
017300*  INVALID VENDOR/DEPARTMENT COMBINATION                          01730027
017400     05  PC-TSYMSG-00995      PIC 9(5) VALUE 00995.               01740027
017500*  INVALID COMBINATION OF STATUS CODES                            01750027
017600     05  PC-TSYMSG-00807      PIC 9(5) VALUE 00807.               01760027
017700*  INVALID DEPARTMENT/BUYER COMBINATION                           01770027
017800     05  PC-TSYMSG-00779      PIC 9(5) VALUE 00779.               01780027
017900*  INVALID PRINTER ID                                             01790027
018000     05  PC-TSYMSG-00746      PIC 9(5) VALUE 00746.               01800027
018100                                                                  01810027
018200 01  PV-PROGRAM-VARIABLES.                                        01820027
018300     05  PV-SQL-SUB              PIC S9(04)   COMP VALUE +0.      01830027
018400     05  PV-COMMAREA-LENGTH      PIC S9(4)    VALUE +0            01840027
018500                                 COMP SYNC.                       01850027
018600     05  PV-CICS-RESPONSE        PIC S9(9)    VALUE ZERO          01860027
018700                                 COMP SYNC.                       01870027
018800     05  PV-CURRENT-YEAR         PIC S9(9)    VALUE ZERO          01880027
018900                                 COMP SYNC.                       01890027
019000                                                                  01900027
019100     05  PV-CURRENT-DATE.                                         01910027
019200         10  PV-CURRENT-DATE-YY    PIC  X(02)  VALUE SPACES.      01920027
019300         10  PV-CURRENT-DATE-MM    PIC  X(02)  VALUE SPACES.      01930027
019400         10  PV-CURRENT-DATE-DD    PIC  X(02)  VALUE SPACES.      01940027
019500                                                                  01950027
019600     05  PV-CURRENT-DB2-DATE       PIC  X(10)  VALUE SPACES.      01960027
019700     05  PV-CURRENT-DATE-R REDEFINES PV-CURRENT-DB2-DATE.         01970027
019800         10  PV-CURRENT-DB2-DTE-CC PIC  X(02).                    01980027
019900         10  PV-CURRENT-DB2-DTE-YY PIC  X(02).                    01990027
020000         10  FILLER                PIC  X(01).                    02000027
020100         10  PV-CURRENT-DB2-DTE-MM PIC  X(02).                    02010027
020200         10  FILLER                PIC  X(01).                    02020027
020300         10  PV-CURRENT-DB2-DTE-DD PIC  X(02).                    02030027
020400                                                                  02040027
020500     05  PV-LESS2WK-DATE           PIC  X(10)  VALUE SPACES.      02050027
020600     05  PV-LESS2WK-DATE-R REDEFINES PV-LESS2WK-DATE.             02060027
020700         10  PV-LESS2WK-DATE-CC    PIC  X(02).                    02070027
020800         10  PV-LESS2WK-DATE-YY    PIC  X(02).                    02080027
020900         10  FILLER                PIC  X(01).                    02090027
021000         10  PV-LESS2WK-DATE-MM    PIC  X(02).                    02100027
021100         10  FILLER                PIC  X(01).                    02110027
021200         10  PV-LESS2WK-DATE-DD    PIC  X(02).                    02120027
021300                                                                  02130027
021400*    05  PV-LOCATION               PIC  9(04)  VALUE ZEROS.       02140027
021500                                                                  02150027
021600     05  PV-ABS-TIME               PIC S9(15)   COMP-3.           02160027
021700                                                                  02170027
021800     05  PV-DATE.                                                 02180027
021900         10  PV-DATE-MM            PIC  X(02)  VALUE SPACES.      02190027
022000         10  FILLER                PIC  X(01)  VALUE SPACES.      02200027
022100         10  PV-DATE-DD            PIC  X(02)  VALUE SPACES.      02210027
022200         10  FILLER                PIC  X(01)  VALUE SPACES.      02220027
022300         10  PV-DATE-YY            PIC  X(02)  VALUE SPACES.      02230027
022400     05  PV-TIME                   PIC X(08)    VALUE SPACES.     02240027
022500                                                                  02250027
022600     05  PV-WORK-LIST-TYPE               PIC  X(01).              02260027
022700         88  PV-TYPE-VALID              VALUE 'M', 'R', 'D', '*', 02270027
022800                                              'C'.                02280027
022900         88  PV-TYPE-MARKOUT            VALUE 'M'.                02290027
023000         88  PV-TYPE-RTV                VALUE 'R'.                02300027
023100         88  PV-TYPE-D-AND-D            VALUE 'D'.                02310027
023200         88  PV-TYPE-CALLBACK           VALUE 'C'.                02320027
023300         88  PV-TYPE-ALL                VALUE '*'.                02330027
023400                                                                  02340027
023500     05  PV-WORK-LIST-STATUS             PIC  X(01).              02350027
023600         88  PV-STATUS-VALID            VALUE 'O', 'C', 'S', '*', 02360027
023700                                              'P', 'A', 'D', 'N'. 02370027
023800         88  PV-STATUS-MARKOUT-VALID    VALUE 'O', 'P', 'A', '*', 02380027
023900                                              'N', 'S'.           02390027
024000         88  PV-STATUS-RTV-VALID        VALUE 'O', 'C', 'S', '*', 02400027
024100                                              'N' 'A'.            02410027
024200         88  PV-STATUS-D-AND-D-VALID    VALUE 'D', '*', 'S', 'A'. 02420027
024300         88  PV-STATUS-CALLBACK-VALID   VALUE 'N', 'O', 'C', '*', 02430027
024400                                              'A', 'S'.           02440027
024500         88  PV-STATUS-NEW              VALUE 'N'.                02450027
024600         88  PV-STATUS-OPEN             VALUE 'O'.                02460027
024700         88  PV-STATUS-CLOSED           VALUE 'C'.                02470027
024800         88  PV-STATUS-SHIPPED          VALUE 'S'.                02480027
024900         88  PV-STATUS-PENDING          VALUE 'P'.                02490027
025000         88  PV-STATUS-APPROVED         VALUE 'A'.                02500027
025100         88  PV-STATUS-DISPOSED         VALUE 'D'.                02510027
025200         88  PV-STATUS-ALL              VALUE '*'.                02520027
025300                                                                  02530027
025400***************************************************************** 02540027
025500** THESE ARE THE JCL LINES SENT TO THE TRANSIENT DATA QUEUE OF ** 02550027
025600** THE INTERNAL READER (CREATE PRODUCTION JOB RVK900)          ** 02560027
025700***************************************************************** 02570027
025800                                                                  02580027
025900 01  JL-JCL-JOBCARD-AREA.                                         02590027
026000     05  JL-JCL-JOBCARD-PROD-1.                                   02600027
026100         10  FILLER              PIC X(02)    VALUE               02610027
026200             '//'.                                                02620027
026300         10  JL-PROD-JOB-NAME    PIC X(08)    VALUE 'RVK900C '.   02630027
026400         10  FILLER              PIC X(13)    VALUE               02640027
026500             '   JOB KOHLS,'.                                     02650027
026600         10  FILLER              PIC X(1)     VALUE QUOTE.        02660027
026700         10  FILLER              PIC X(15)    VALUE               02670027
026800             'RTV-INVRPT/USER'.                                   02680027
026900         10  FILLER              PIC X(1)     VALUE QUOTE.        02690027
027000         10  FILLER              PIC X(1)     VALUE ','.          02700027
027100         10  FILLER              PIC X(06)    VALUE SPACES.       02710027
027200     05  JL-JCL-JOBCARD-PROD-2.                                   02720027
027300         10  FILLER              PIC X(02)    VALUE               02730027
027400             '//'.                                                02740027
027500         10  FILLER              PIC X(13)    VALUE SPACES.       02750027
027600         10  FILLER              PIC X(28)    VALUE               02760027
027700             'MSGCLASS=P,CLASS=Q,REGION=3M'.                      02770027
027800         10  FILLER              PIC X(32)    VALUE SPACES.       02780027
027900                                                                  02790027
028000     05  JL-JCL-JOBCARD-TEST-1.                                   02800027
028100         10  FILLER              PIC X(02)    VALUE               02810027
028200             '//'.                                                02820027
028300         10  JL-TEST-JOB-NAME    PIC X(07)    VALUE SPACES.       02830027
028400         10  FILLER              PIC X(01)    VALUE               02840027
028500             'Q'.                                                 02850027
028600         10  FILLER              PIC X(13)    VALUE               02860027
028700             '   JOB KOHLS,'.                                     02870027
028800         10  FILLER              PIC X(1)     VALUE QUOTE.        02880027
028900         10  FILLER              PIC X(15)    VALUE               02890027
029000             'RTV-INVRPT/USER'.                                   02900027
029100         10  FILLER              PIC X(1)     VALUE QUOTE.        02910027
029200         10  FILLER              PIC X(1)     VALUE ','.          02920027
029300         10  FILLER              PIC X(06)    VALUE SPACES.       02930027
029400     05  JL-JCL-JOBCARD-TEST-2.                                   02940027
029500         10  FILLER              PIC X(02)    VALUE               02950027
029600             '//'.                                                02960027
029700         10  FILLER              PIC X(13)    VALUE SPACES.       02970027
029800         10  FILLER              PIC X(26)    VALUE               02980027
029900             'MSGCLASS=X,CLASS=A,NOTIFY='.                        02990027
030000         10  JL-TEST-NOTIFY-NAME PIC X(08)    VALUE 'TKMAXO7'.    03000027
030100         10  FILLER              PIC X(32)    VALUE SPACES.       03010027
030200                                                                  03020027
030300***************************************************************** 03030027
030400** THIS IS THE JCL USED TO CREATE THE RTV INVENTORY REPORT     ** 03040027
030500***************************************************************** 03050027
030600 01  JL-JCL-LINE-AREA.                                            03060027
030700     05  JL-JCL-LINE-1.                                           03070027
030800         10  FILLER              PIC X(03)    VALUE '//*'.        03080027
030900         10  FILLER              PIC X(77)    VALUE SPACES.       03090027
031000     05  JL-JCL-LINE-2.                                           03100027
031100         10  FILLER              PIC X(50)    VALUE               03110027
031200             '//*------------------- JOB SUBMISSION INFORMATION '.03120027
031300         10  FILLER              PIC X(30)    VALUE ALL '-'.      03130027
031400     05  JL-JCL-LINE-3.                                           03140027
031500         10  FILLER              PIC X(30)    VALUE               03150027
031600             '//*   ASSOCIATE USER ID......:'.                    03160027
031700         10  JJ-USER-ID          PIC X(08)    VALUE SPACES.       03170027
031800         10  FILLER              PIC X(42)    VALUE SPACES.       03180027
031900     05  JL-JCL-LINE-4.                                           03190027
032000         10  FILLER              PIC X(30)    VALUE               03200027
032100             '//*   JOB SUBMITTED FROM.....:'.                    03210027
032200         10  JJ-SUB-OPER-UNT-ID  PIC X(04)    VALUE SPACES.       03220027
032300         10  FILLER              PIC X(46)    VALUE SPACES.       03230027
032400     05  JL-JCL-LINE-5.                                           03240027
032500         10  FILLER              PIC X(50)    VALUE               03250027
032600             '//*------------ INVENTORY REPORT SELECTED CRITERIA'.03260027
032700         10  FILLER              PIC X(30)    VALUE ALL '-'.      03270027
032800     05  JL-JCL-LINE-6.                                           03280027
032900         10  FILLER              PIC X(30)    VALUE               03290027
033000*            '//*   OPERATING UNIT ID......:'.                    03300027
033100             '//*   RTV LOCATION...........:'.                    03310027
033200         10  JJ-OPER-UNT-ID-C    PIC X(04)    VALUE SPACES.       03320027
033300         10  FILLER              PIC X(46)    VALUE SPACES.       03330027
033400     05  JL-JCL-LINE-7.                                           03340027
033500         10  FILLER              PIC X(30)    VALUE               03350027
033600             '//*   STARTING DATE..........:'.                    03360027
033700         10  JJ-START-DATE-C     PIC X(10)    VALUE SPACES.       03370027
033800         10  FILLER              PIC X(40)    VALUE SPACES.       03380027
033900     05  JL-JCL-LINE-8.                                           03390027
034000         10  FILLER              PIC X(30)    VALUE               03400027
034100             '//*   ENDING DATE............:'.                    03410027
034200         10  JJ-END-DATE-C       PIC X(10)    VALUE SPACES.       03420027
034300         10  FILLER              PIC X(40)    VALUE SPACES.       03430027
034400     05  JL-JCL-LINE-9.                                           03440027
034500         10  FILLER              PIC X(30)    VALUE               03450027
034600             '//*   PRINTER DESTINATION....:'.                    03460027
034700         10  JJ-PRINT-DEST-C     PIC X(06)    VALUE SPACES.       03470027
034800         10  FILLER              PIC X(44)    VALUE SPACES.       03480027
034900     05  JL-JCL-LINE-10.                                          03490027
035000         10  FILLER              PIC X(30)    VALUE               03500027
035100             '//*   REPORT COPIES..........:'.                    03510027
035200         10  JJ-RPT-COPIES-C     PIC X(01)    VALUE SPACES.       03520027
035300         10  FILLER              PIC X(49)    VALUE SPACES.       03530027
035400     05  JL-JCL-LINE-11.                                          03540027
035500         10  FILLER              PIC X(30)    VALUE               03550027
035600             '//*   REPORT TYPE............:'.                    03560027
035700         10  JJ-REPORT-TYPE-C    PIC X(01)    VALUE SPACES.       03570027
035800         10  FILLER              PIC X(49)    VALUE SPACES.       03580027
035900     05  JL-JCL-LINE-12.                                          03590027
036000         10  FILLER              PIC X(30)    VALUE               03600027
036100             '//*   LISTING TYPE...........:'.                    03610027
036200         10  JJ-LIST-TYPE-C      PIC X(01)    VALUE SPACES.       03620027
036300         10  FILLER              PIC X(49)    VALUE SPACES.       03630027
036400     05  JL-JCL-LINE-13.                                          03640027
036500         10  FILLER              PIC X(30)    VALUE               03650027
036600             '//*   LISTING STATUS.........:'.                    03660027
036700         10  JJ-LIST-STAT-C      PIC X(01)    VALUE SPACES.       03670027
036800         10  FILLER              PIC X(49)    VALUE SPACES.       03680027
036900     05  JL-JCL-LINE-14.                                          03690027
037000         10  FILLER              PIC X(30)    VALUE               03700027
037100             '//*   STORAGE LOCATION.......:'.                    03710027
037200         10  JJ-LOC-C            PIC X(13)    VALUE SPACES.       03720027
037300         10  FILLER              PIC X(37)    VALUE SPACES.       03730027
037400     05  JL-JCL-LINE-15.                                          03740027
037500         10  FILLER              PIC X(30)    VALUE               03750027
037600             '//*   BUYER NUMBER...........:'.                    03760027
037700         10  JJ-BUYER-NBR-C      PIC X(03)    VALUE SPACES.       03770027
037800         10  FILLER              PIC X(47)    VALUE SPACES.       03780027
037900     05  JL-JCL-LINE-16.                                          03790027
038000         10  FILLER              PIC X(30)    VALUE               03800027
038100             '//*   DEPARTMENT NUMBER......:'.                    03810027
038200         10  JJ-DPT-NBR-C        PIC X(03)    VALUE SPACES.       03820027
038300         10  FILLER              PIC X(47)    VALUE SPACES.       03830027
038400     05  JL-JCL-LINE-17.                                          03840027
038500         10  FILLER              PIC X(30)    VALUE               03850027
038600             '//*   VENDOR NUMBER..........:'.                    03860027
038700         10  JJ-VND-NBR-C        PIC X(09)    VALUE SPACES.       03870027
038800         10  FILLER              PIC X(41)    VALUE SPACES.       03880027
038900     05  JL-JCL-LINE-18.                                          03890027
039000         10  FILLER              PIC X(03)    VALUE               03900027
039100             '//*'.                                               03910027
039200         10  FILLER              PIC X(77)    VALUE ALL '-'.      03920027
039300     05  JL-JCL-LINE-19.                                          03930027
039400         10  FILLER              PIC  X(34)  VALUE                03940027
039500             '//JOBOUT01 OUTPUT FORMS=STD,FCB=8S'.                03950027
039600         10  FILLER              PIC  X(16)  VALUE                03960027
039700             ',CLASS=A,COPIES='.                                  03970027
039800         10  JJ-COPY             PIC  X(01)  VALUE SPACES.        03980027
039900         10  FILLER              PIC  X(06)  VALUE                03990027
040000             ',DEST='.                                            04000027
040100         10  JJ-DEST             PIC  X(06)  VALUE SPACES.        04010027
040200         10  FILLER              PIC  X(17)  VALUE SPACE.         04020027
040300     05  JL-JCL-LINE-20.                                          04030027
040400         10  FILLER              PIC X(39)    VALUE               04040027
040500             '//JOBLIB   DD DSN=PKMO.LOADLIB,DISP=SHR'.           04050027
040600         10  FILLER              PIC X(41)    VALUE SPACES.       04060027
040700     05  JL-JCL-LINE-21.                                          04070027
040800         10  FILLER              PIC X(23)    VALUE               04080027
040900             '//PS020    EXEC RVK9001'.                           04090027
041000         10  FILLER              PIC X(57)    VALUE SPACES.       04100027
041100     05  JL-JCL-LINE-22.                                          04110027
041200         10  FILLER              PIC X(18)    VALUE               04120027
041300             '//S010.SYSUT1 DD *'.                                04130027
041400         10  FILLER              PIC X(62)    VALUE SPACES.       04140027
041500     05  JL-JCL-LINE-23.                                          04150027
041600         10  JJ-OPER-UNT-ID      PIC X(04)    VALUE SPACES.       04160027
041700         10  JJ-LIST-TYPE        PIC X(01)    VALUE SPACES.       04170027
041800         10  JJ-LIST-STAT        PIC X(01)    VALUE SPACES.       04180027
041900         10  JJ-LOC              PIC X(13)    VALUE SPACES.       04190027
042000         10  JJ-BUYER-NBR        PIC X(03)    VALUE SPACES.       04200027
042100         10  JJ-DPT-NBR          PIC X(03)    VALUE SPACES.       04210027
042200         10  JJ-VND-NBR          PIC X(09)    VALUE SPACES.       04220027
042300         10  JJ-START-DATE       PIC X(10)    VALUE SPACES.       04230027
042400         10  JJ-END-DATE         PIC X(10)    VALUE SPACES.       04240027
042500         10  JJ-REPORT-TYPE      PIC X(01)    VALUE SPACES.       04250027
042600         10  FILLER              PIC X(25)    VALUE SPACES.       04260027
042700     05  JL-JCL-LINE-24.                                          04270027
042800         10  FILLER              PIC X(02)    VALUE '/*'.         04280027
042900         10  FILLER              PIC X(78)    VALUE SPACES.       04290027
043000     05  JL-JCL-LINE-25.                                          04300027
043100         10  FILLER              PIC X(02)    VALUE '//'.         04310027
043200         10  FILLER              PIC X(31)    VALUE ALL '*'.      04320027
043300         10  FILLER              PIC X(16)    VALUE               04330027
043400             ' - END OF JOB - '.                                  04340027
043500         10  FILLER              PIC X(31)    VALUE ALL '*'.      04350027
043600     05  JL-JCL-LINE-EOF.                                         04360027
043700         10  FILLER              PIC X(5)     VALUE '/*EOF'.      04370027
043800         10  FILLER              PIC X(75)    VALUE SPACE.        04380027
043900                                                                  04390027
044000 01  JL-JCL-LINE-TABLE REDEFINES  JL-JCL-LINE-AREA.               04400027
044100     05  JL-JCL-LINE             OCCURS 26 TIMES                  04410027
044200                                 INDEXED BY JL-JCL-IDX            04420027
044300                                 PIC X(80).                       04430027
044400 01  JL-JCL-LINE-COUNT           PIC S9(4)    VALUE +26           04440027
044500                                              COMP SYNC.          04450027
044600                                                                  04460027
044700 01  TD-TRANSIENT-DATA-AREA.                                      04470027
044800     05  TD-QUEUE-NAME           PIC X(4)     VALUE 'IRTD'.       04480027
044900     05  TD-QUEUE-NAME-LENGTH    PIC S9(4)    VALUE +4            04490027
045000                                 COMP SYNC.                       04500027
045100     05  TD-JCL-LINE             PIC X(80)    VALUE SPACES.       04510027
045200     05  TD-JCL-LINE-LENGTH      PIC S9(4)    VALUE +80           04520027
045300                                 COMP SYNC.                       04530027
045400                                                                  04540027
045500 01  AM-ABEND-MESSAGES.                                           04550027
045600     05  AM-ABEND-MESSAGE-7.                                      04560027
045700         10  FILLER                     PIC X(52)    VALUE        04570027
045800     'ERROR WRITING TRANSIENT DATA QUEUE -  RETURN CODE = '.      04580027
045900         10  AM-CICS-CODE-7             PIC S9(8)    VALUE 0.     04590027
046000         10  FILLER                     PIC X(16)    VALUE SPACE. 04600027
046100     05  AM-ABEND-MESSAGE-8.                                      04610027
046200         10  FILLER                     PIC X(55)    VALUE        04620027
046300     'ERROR EN-QUEUEING TRANSIENT DATA QUEUE - RETURN CODE = '.   04630027
046400         10  AM-CICS-CODE-8             PIC S9(8)    VALUE 0.     04640027
046500         10  FILLER                     PIC X(13)    VALUE SPACE. 04650027
046600     05  AM-ABEND-MESSAGE-9.                                      04660027
046700         10  FILLER                     PIC X(54)    VALUE        04670027
046800     'ERROR D-QUEUEING TRANSIENT DATA QUEUE - RETURN CODE = '.    04680027
046900         10  AM-CICS-CODE-9             PIC S9(8)    VALUE 0.     04690027
047000         10  FILLER                     PIC X(14)    VALUE SPACE. 04700027
047100                                                                  04710027
047200 01  ST-SYSTEM-TIME-AREA.                                         04720027
047300     05  ST-ABSTIME              PIC S9(18)   VALUE ZERO          04730027
047400                                 COMP SYNC.                       04740027
047500     05  ST-TIME-EDIT.                                            04750027
047600         10  ST-TIME-HHMM        PIC X(5)     VALUE SPACES.       04760027
047700         10  FILLER              PIC X(3)     VALUE SPACES.       04770027
047800                                                                  04780027
047900******************************************************************04790027
048000*    STANDARD COMMAREA DEFINITION                                 04800027
048100******************************************************************04810027
048200     COPY DPWS030.                                                04820027
CICS       COPY DPWS930.                                                04821030
048300     COPY DPWS020.                                                04830027
048400     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                04840027
048500                                                                  04850027
048600*----------------------------------------------------------------*04860027
048700* INTER-APPLICATION COMMAREA.                                    *04870027
048800*----------------------------------------------------------------*04880027
048900                                                                  04890027
049000         10  INTER-APPL-COMM-AREA       PIC X(200).               04900027
049100     COPY PCWS000.                                                04910027
049200*-------------------------------------------------------------*   04920027
049300*    APPLICATION SPECIFIC COMMAREA                            *   04930027
049400*-------------------------------------------------------------*   04940027
049500         10  ASC-PGM-SPECIFIC-COMMAREA.                           04950027
049600             15  ASC-OPER-UNT-ID           PIC X(04).             04960027
049700             15  ASC-OPER-UNT-ID-N REDEFINES ASC-OPER-UNT-ID      04970027
049800                                           PIC 9(04).             04980027
049900             15  ASC-OPER-UNT-ID-DESC      PIC X(25).             04990027
050000             15  ASC-STRT-MONTH            PIC X(02).             05000027
050100             15  ASC-STRT-MONTH-N  REDEFINES ASC-STRT-MONTH       05010027
050200                                           PIC 9(02).             05020027
050300             15  ASC-STRT-DAY              PIC X(02).             05030027
050400             15  ASC-STRT-DAY-N    REDEFINES ASC-STRT-DAY         05040027
050500                                           PIC 9(02).             05050027
050600             15  ASC-STRT-YEAR             PIC X(02).             05060027
050700             15  ASC-STRT-YEAR-N   REDEFINES ASC-STRT-YEAR        05070027
050800                                           PIC 9(02).             05080027
050900             15  ASC-END-MONTH             PIC X(02).             05090027
051000             15  ASC-END-MONTH-N   REDEFINES ASC-END-MONTH        05100027
051100                                           PIC 9(02).             05110027
051200             15  ASC-END-DAY               PIC X(02).             05120027
051300             15  ASC-END-DAY-N     REDEFINES ASC-END-DAY          05130027
051400                                           PIC 9(02).             05140027
051500             15  ASC-END-YEAR              PIC X(02).             05150027
051600             15  ASC-END-YEAR-N    REDEFINES ASC-END-YEAR         05160027
051700                                           PIC 9(02).             05170027
051800             15  ASC-PRINT-DEST            PIC X(06).             05180027
051900             15  ASC-RPT-COPY              PIC X(01).             05190027
052000             15  ASC-RPT-COPY-N    REDEFINES ASC-RPT-COPY         05200027
052100                                           PIC 9(01).             05210027
052200             15  ASC-REPORT-TYPE           PIC X(01).             05220027
052300                 88  ASC-VALID-REPORT-TYPE VALUE                  05230027
052400                                           'D', 'S', 'B', 'T'.    05240027
052500                 88  ASC-DETAIL-REPORT     VALUE 'D'.             05250027
052600                 88  ASC-SUMMARY-REPORT    VALUE 'S'.             05260027
052700                 88  ASC-BOTH-REPORTS      VALUE 'B'.             05270027
052800                 88  ASC-TOTAL-PAGE-ONLY   VALUE 'T'.             05280027
052900             15  ASC-REPORT-TYPE-DESC      PIC X(25).             05290027
053000             15  ASC-LIST-TYPE             PIC X(01).             05300027
053100                 88  ASC-LIST-TYPE-ALL     VALUE '*'.             05310027
053200             15  ASC-LIST-TYPE-DESC        PIC X(25).             05320027
053300             15  ASC-LIST-STATUS           PIC X(01).             05330027
053400                 88  ASC-LIST-STATUS-ALL   VALUE '*'.             05340027
053500             15  ASC-LIST-STATUS-DESC      PIC X(25).             05350027
053600             15  ASC-LOCATION              PIC X(13).             05360027
053700                 88  ASC-LOCATION-ALL      VALUE '*************'. 05370027
053800             15  ASC-BUYER-NBR             PIC X(03).             05380027
053900                 88  ASC-BUYER-NBR-ALL     VALUE '***'.           05390027
054000             15  ASC-BUYER-NBR-N   REDEFINES ASC-BUYER-NBR        05400027
054100                                           PIC 9(03).             05410027
054200             15  ASC-BUYER-NBR-DESC        PIC X(25).             05420027
054300             15  ASC-DEPT-NBR              PIC X(03).             05430027
054400                 88  ASC-DEPT-NBR-ALL      VALUE '***'.           05440027
054500             15  ASC-DEPT-NBR-N    REDEFINES ASC-DEPT-NBR         05450027
054600                                           PIC 9(03).             05460027
054700             15  ASC-DEPT-NBR-DESC         PIC X(25).             05470027
054800             15  ASC-VND-NBR               PIC X(09).             05480027
054900                 88  ASC-VND-NBR-ALL       VALUE '*********'.     05490027
055000             15  ASC-VND-NBR-N     REDEFINES ASC-VND-NBR          05500027
055100                                           PIC 9(09).             05510027
055200             15  ASC-VND-NBR-DESC          PIC X(25).             05520027
055300             15  ASC-HOLD-INTER-APPL       PIC X(200).            05530027
055400                                                                  05540027
055500******************************************************************05550027
055600*                                                                 05560027
055700*  SQL AND COBOL DECLARATIONS FOR THE RESPONSIBILITY AREA TABLE   05570027
055800*                                                                 05580027
055900                                                                  05590027
056000     EXEC SQL                                                     05600027
056100         INCLUDE TRSPBAR                                          05610027
056200     END-EXEC.                                                    05620027
056300                                                                  05630027
056400*                                                                 05640027
056500*  SQL AND COBOL DECLARATIONS FOR THE MERCHANDISE AREA TABLE      05650027
056600*                                                                 05660027
056700                                                                  05670027
056800     EXEC SQL                                                     05680027
056900         INCLUDE TMDSEAR                                          05690027
057000     END-EXEC.                                                    05700027
057100                                                                  05710027
057200*                                                                 05720027
057300*  SQL AND COBOL DECLARATIONS FOR THE APPL SYSTEM AVAILABILITY    05730027
057400*                                                                 05740027
057500                                                                  05750027
057600     EXEC SQL                                                     05760027
057700         INCLUDE TAPLAVL                                          05770027
057800     END-EXEC.                                                    05780027
057900*                                                                 05790027
058000*  SQL AND COBOL DECLARATIONS FOR THE LOCATION TABLE (XLT_LOC)    05800027
058100*                                                                 05810027
058200                                                                  05820027
058300     EXEC SQL                                                     05830027
058400         INCLUDE XLT00010                                         05840027
058500     END-EXEC.                                                    05850027
058600*                                                                 05860027
058700*  SQL AND COBOL DECLARATIONS FOR THE DC LOCATION ASSIGNMENT      05870027
058800*       TABLE (XLT_DC_LOC_ASGMT)                                  05880027
058900*                                                                 05890027
059000                                                                  05900027
059100     EXEC SQL                                                     05910027
059200         INCLUDE XLT00014                                         05920027
059300     END-EXEC.                                                    05930027
059400*                                                                 05940027
059500*  SQL AND COBOL DECLARATIONS FOR THE EXTERNAL ENTERPRISE         05950027
059600*  NAME TABLE                                                     05960027
059700*                                                                 05970027
059800                                                                  05980027
059900     EXEC SQL                                                     05990027
060000         INCLUDE TENTNME                                          06000027
060100     END-EXEC.                                                    06010027
060200*                                                                 06020027
060300*  SQL AND COBOL DECLARATIONS FOR THE EXTERNAL ENTERPRISE TABLE   06030027
060400*                                                                 06040027
060500                                                                  06050027
060600     EXEC SQL                                                     06060027
060700         INCLUDE TEXTENT                                          06070027
060800     END-EXEC.                                                    06080027
060900*                                                                 06090027
061000*  SQL AND COBOL DECLARATIONS FOR THE VENDOR DEPARTMENT TABLE     06100027
061100*                                                                 06110027
061200                                                                  06120027
061300     EXEC SQL                                                     06130027
061400         INCLUDE TVNDDPT                                          06140027
061500     END-EXEC.                                                    06150027
061600*                                                                 06160027
061700*  SQL AND COBOL DECLARATIONS FOR THE KOHLS/RETEK PARMS (TKRPRPM) 06170027
061800*                                                                 06180027
061900     EXEC SQL                                                     06190027
062000          INCLUDE TKRPRPM                                         06200027
062100     END-EXEC.                                                    06210027
062200*                                                                 06220027
062300*  STANDARD LAYOUT FOR THE SQL COMMUNICATIONS AREA                06230027
062400*                                                                 06240027
062500                                                                  06250027
062600     EXEC SQL                                                     06260027
062700         INCLUDE SQLCA                                            06270027
062800     END-EXEC.                                                    06280027
062900                                                                  06290027
063000******************************************************************06300027
063100 LINKAGE SECTION.                                                 06310027
063200******************************************************************06320027
063300 01  DFHCOMMAREA.                                                 06330027
063400     05  FILLER                       OCCURS 1 TO 4072 TIMES      06340027
063500                                      DEPENDING ON EIBCALEN.      06350027
063600         10  FILLER                   PIC X.                      06360027
063700******************************************************************06370027
063800 PROCEDURE DIVISION.                                              06380027
063900******************************************************************06390027
064000                                                                  06400027
064100 0000-MAIN-MODULE.                                                06410027
064200     INITIALIZE DP030-CICS-API-FIELDS.                            06420027
064300     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       06430027
064400     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          06440027
064500     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         06450027
064600     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       06460027
064700     MOVE LENGTH OF RV115AI        TO DP030-MAP-LENGTH (1).       06470027
064800     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     06480027
064900     PERFORM 0001-CALL-CICS-ARCH-API.                             06490027
065000*                                                                 06500027
065100     PERFORM 1000-CONTROL-PROCESSING                              06510027
065200*                                                                 06520027
065300     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     06530027
065400     PERFORM 0001-CALL-CICS-ARCH-API.                             06540027
065500                                                                  06550027
065600 0001-CALL-CICS-ARCH-API.                                         06560027
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      06570030
065800                                    DFHCOMMAREA                   06580030
065900                                    DP030-CICS-API-FIELDS         06590030
066000                                    DP020-STANDARD-COMMAREA       06600030
066100                                    RV115AI.                      06610030
066200*                                                                 06620027
066300     IF  DP030-RC-CALL-SUCCESSFUL                                 06630027
066400         CONTINUE                                                 06640027
066500     ELSE                                                         06650027
066600         SET DP013-NO-ROLLBACK                                    06660027
066700             DP013-XCTL-DISPLAY-RESTART                           06670027
066800             DP013-CICS-ABEND      TO TRUE                        06680027
066900         MOVE 'BEFORE 0000-MAIN-MODULE'                           06690027
067000                                   TO DP013-PARAGRAPH             06700027
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O06701030
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      06702030
067300         MOVE DP030-RETURN-CODE                                   06730027
067400                                   TO DP013-MESSAGE-TEXT (3)      06740027
067500         PERFORM DP013-0000-PROCESS-ABEND                         06750027
067600     END-IF.                                                      06760027
067700 EJECT                                                            06770027
067800*----------------------------------------------------------------*06780027
067900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *06790027
068000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *06800027
068100*----------------------------------------------------------------*06810027
068200                                                                  06820027
068300 1000-CONTROL-PROCESSING.                                         06830027
068400                                                                  06840027
068500     SET DP030-SET-CURSOR-APPL-1        TO TRUE                   06850027
068600                                                                  06860027
068700     EVALUATE TRUE                                                06870027
068800         WHEN DP020-NEXT-ACT-INITIAL                              06880027
068900             MOVE INTER-APPL-COMM-AREA  TO ASC-HOLD-INTER-APPL    06890027
069000         WHEN OTHER                                               06900027
069100             MOVE ASC-HOLD-INTER-APPL   TO INTER-APPL-COMM-AREA   06910027
069200     END-EVALUATE.                                                06920027
069300                                                                  06930027
069400     EVALUATE TRUE                                                06940027
069500         WHEN DP020-NEXT-ACT-INITIAL                              06950027
069600             INITIALIZE ASC-PGM-SPECIFIC-COMMAREA                 06960027
069700*            MOVE DP020-LOCATION-NBR TO PV-LOCATION               06970027
069800*            MOVE PV-LOCATION    TO ASC-OPER-UNT-ID               06980027
069900             MOVE SPACES         TO ASC-OPER-UNT-ID               06990027
070000             PERFORM 4100-RESET-ATTRIBUTES                        07000027
070100             PERFORM 4000-BUILD-INITIAL-PANEL                     07010027
070200                                                                  07020027
070300         WHEN DP020-NEXT-ACT-READ-MAP                             07030027
070400             PERFORM 2000-FKEY-PROCESSING                         07040027
070500                                                                  07050027
070600         WHEN DP020-NEXT-ACT-RETURN                               07060027
070700             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07070027
070800             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07080027
070900             MOVE -1      TO ALTYPEL                              07090027
071000                                                                  07100027
071100         WHEN OTHER                                               07110027
071200             SET DP013-LOGIC-ABEND                                07120027
071300                 DP013-NO-ROLLBACK TO TRUE                        07130027
071400             MOVE '1000-CONTROL-PROCESSING'                       07140027
071500                                   TO  DP013-PARAGRAPH            07150027
071600             MOVE 'INVALID NEXT ACTIVITY RETURNED TO APPL PGM:'   07160027
071700                                   TO  DP013-MESSAGE-TEXT(1)      07170027
071800             MOVE DP020-NEXT-APPL-ACTIVITY                        07180027
071900                                   TO DP013-MESSAGE-TEXT(2)       07190027
072000             PERFORM DP013-0000-PROCESS-ABEND                     07200027
072100     END-EVALUATE.                                                07210027
072200                                                                  07220027
072300*----------------------------------------------------------------*07230027
072400* FURTHER DETERMINE PROCESSING PATH BASED ON FUNCTION KEY ACTIONS*07240027
072500* SPECIFIC FUNCTION KEYS LISTED HERE ARE ACTED UPON REGARDLESS OF*07250027
072600* EDITS.                                                         *07260027
072700*----------------------------------------------------------------*07270027
072800                                                                  07280027
072900 2000-FKEY-PROCESSING.                                            07290027
073000                                                                  07300027
073100     EVALUATE TRUE                                                07310027
073200                                                                  07320027
073300         WHEN DP020-SRC-AID = DP016-CLEAR                         07330027
073400             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07340027
073500             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07350027
073600                                                                  07360027
073700         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     07370027
073800             PERFORM 4000-BUILD-INITIAL-PANEL                     07380027
073900             PERFORM 4100-RESET-ATTRIBUTES                        07390027
074000                                                                  07400027
074100         WHEN OTHER                                               07410027
074200             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 07420027
074300             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   07430027
074400             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 07440027
074500             IF  PS-NO-EDIT-ERROR                                 07450027
074600                 MOVE -1      TO ALTYPEL                          07460027
074700                 PERFORM 2100-CHECK-FUNCTION-KEY                  07470027
074800             END-IF                                               07480027
074900     END-EVALUATE.                                                07490027
075000******************************************************************07500027
075100** ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED     **07510027
075200** FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED **07520027
075300** FROM THE CICS ARCHITECTURE API.                              **07530027
075400******************************************************************07540027
075500 2100-CHECK-FUNCTION-KEY.                                         07550027
075600     EVALUATE TRUE                                                07560027
075700         WHEN DP020-SRC-AID = DP016-ENTER                         07570027
075800             CONTINUE                                             07580027
075900         WHEN DP020-FK-LOCAL-FUNC-01(DP020-SRC-AID)               07590027
076000             PERFORM 5000-CREATE-PRINT-JOB                        07600027
076100         WHEN OTHER                                               07610027
076200             SET DP013-NO-ROLLBACK                                07620027
076300                 DP013-XCTL-DISPLAY-RESTART                       07630027
076400                 DP013-CICS-ABEND  TO TRUE                        07640027
076500             MOVE '2100-CHECK-FUNCTION-KEY'                       07650027
076600                                   TO DP013-PARAGRAPH             07660027
076700             MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'      07670027
076800                                   TO DP013-MESSAGE-TEXT (1)      07680027
076900             PERFORM DP013-0000-PROCESS-ABEND                     07690027
077000     END-EVALUATE.                                                07700027
077100 EJECT                                                            07710027
077200*----------------------------------------------------------------*07720027
077300* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS IN*07730027
077400* THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN THE  *07740027
077500* APPLICATION-SPECIFIC COMMAREA, NOT ON THE SCREEN.              *07750027
077600*----------------------------------------------------------------*07760027
077700                                                                  07770027
077800 2200-MOVE-SCREEN-TO-COMMAREA.                                    07780027
077900                                                                  07790027
078000* OPERATING UNIT ID                                               07800027
078100                                                                  07810027
078200     IF  AOPUIDL > ZERO                                           07820027
078300         MOVE AOPUIDI              TO ASC-OPER-UNT-ID             07830027
078400     ELSE                                                         07840027
078500         IF  AOPUIDF = DP015-ERASE-EOF                            07850027
078600             MOVE SPACE            TO ASC-OPER-UNT-ID             07860027
078700         END-IF                                                   07870027
078800     END-IF.                                                      07880027
078900                                                                  07890027
079000     MOVE AOPDESCI                 TO ASC-OPER-UNT-ID-DESC.       07900027
079100                                                                  07910027
079200* START DATE                                                      07920027
079300     IF  ASMONTHL > ZERO                                          07930027
079400         MOVE ASMONTHI             TO ASC-STRT-MONTH              07940027
079500     ELSE                                                         07950027
079600         IF  ASMONTHF = DP015-ERASE-EOF                           07960027
079700             MOVE SPACE            TO ASC-STRT-MONTH              07970027
079800         END-IF                                                   07980027
079900     END-IF.                                                      07990027
080000                                                                  08000027
080100     IF  ASDAYL > ZERO                                            08010027
080200         MOVE ASDAYI               TO ASC-STRT-DAY                08020027
080300     ELSE                                                         08030027
080400         IF  ASDAYF = DP015-ERASE-EOF                             08040027
080500             MOVE SPACE            TO ASC-STRT-DAY                08050027
080600         END-IF                                                   08060027
080700     END-IF.                                                      08070027
080800                                                                  08080027
080900     IF  ASYEARL > ZERO                                           08090027
081000         MOVE ASYEARI              TO ASC-STRT-YEAR               08100027
081100     ELSE                                                         08110027
081200         IF  ASYEARF = DP015-ERASE-EOF                            08120027
081300             MOVE SPACE            TO ASC-STRT-YEAR               08130027
081400         END-IF                                                   08140027
081500     END-IF.                                                      08150027
081600                                                                  08160027
081700* END DATE                                                        08170027
081800     IF  AEMONTHL > ZERO                                          08180027
081900         MOVE AEMONTHI             TO ASC-END-MONTH               08190027
082000     ELSE                                                         08200027
082100         IF  AEMONTHF = DP015-ERASE-EOF                           08210027
082200             MOVE SPACE            TO ASC-END-MONTH               08220027
082300         END-IF                                                   08230027
082400     END-IF.                                                      08240027
082500                                                                  08250027
082600     IF  AEDAYL > ZERO                                            08260027
082700         MOVE AEDAYI               TO ASC-END-DAY                 08270027
082800     ELSE                                                         08280027
082900         IF  AEDAYF = DP015-ERASE-EOF                             08290027
083000             MOVE SPACE            TO ASC-END-DAY                 08300027
083100         END-IF                                                   08310027
083200     END-IF.                                                      08320027
083300                                                                  08330027
083400     IF  AEYEARL > ZERO                                           08340027
083500         MOVE AEYEARI              TO ASC-END-YEAR                08350027
083600     ELSE                                                         08360027
083700         IF  AEYEARF = DP015-ERASE-EOF                            08370027
083800             MOVE SPACE            TO ASC-END-YEAR                08380027
083900         END-IF                                                   08390027
084000     END-IF.                                                      08400027
084100                                                                  08410027
084200* PRINT DESTINATION                                               08420027
084300     IF  ADESTL > ZERO                                            08430027
084400         MOVE ADESTI               TO ASC-PRINT-DEST              08440027
084500     ELSE                                                         08450027
084600         IF  ADESTF = DP015-ERASE-EOF                             08460027
084700             MOVE SPACE            TO ASC-PRINT-DEST              08470027
084800         END-IF                                                   08480027
084900     END-IF.                                                      08490027
085000                                                                  08500027
085100* REPORT COPIES                                                   08510027
085200     IF  ARPTCPYL > ZERO                                          08520027
085300         MOVE ARPTCPYI             TO ASC-RPT-COPY                08530027
085400     ELSE                                                         08540027
085500         IF  ARPTCPYF = DP015-ERASE-EOF                           08550027
085600             MOVE SPACE            TO ASC-RPT-COPY                08560027
085700         END-IF                                                   08570027
085800     END-IF.                                                      08580027
085900                                                                  08590027
086000* REPORT TYPE                                                     08600027
086100     IF  ARPTTYPL > ZERO                                          08610027
086200         MOVE ARPTTYPI             TO ASC-REPORT-TYPE             08620027
086300     ELSE                                                         08630027
086400         IF  ARPTTYPF = DP015-ERASE-EOF                           08640027
086500             MOVE SPACE            TO ASC-REPORT-TYPE             08650027
086600         END-IF                                                   08660027
086700     END-IF.                                                      08670027
086800                                                                  08680027
086900     MOVE ARTDESCI                 TO ASC-REPORT-TYPE-DESC.       08690027
087000                                                                  08700027
087100* LISTING TYPE                                                    08710027
087200     IF  ALTYPEL > ZERO                                           08720027
087300         MOVE ALTYPEI              TO ASC-LIST-TYPE               08730027
087400     ELSE                                                         08740027
087500         IF  ALTYPEF = DP015-ERASE-EOF                            08750027
087600             MOVE SPACE            TO ASC-LIST-TYPE               08760027
087700         END-IF                                                   08770027
087800     END-IF.                                                      08780027
087900                                                                  08790027
088000     MOVE ALTDESCI                 TO ASC-LIST-TYPE-DESC.         08800027
088100                                                                  08810027
088200* LISTING STATUS                                                  08820027
088300     IF  ALSTATL > ZERO                                           08830027
088400         MOVE ALSTATI              TO ASC-LIST-STATUS             08840027
088500     ELSE                                                         08850027
088600         IF  ALSTATF = DP015-ERASE-EOF                            08860027
088700             MOVE SPACE            TO ASC-LIST-STATUS             08870027
088800         END-IF                                                   08880027
088900     END-IF.                                                      08890027
089000                                                                  08900027
089100     MOVE ALSDESCI                 TO ASC-LIST-STATUS-DESC.       08910027
089200                                                                  08920027
089300* LISTING LOCATION                                                08930027
089400     IF  ALOCL > ZERO                                             08940027
089500         MOVE ALOCI                TO ASC-LOCATION                08950027
089600     ELSE                                                         08960027
089700         IF  ALOCF = DP015-ERASE-EOF                              08970027
089800             MOVE SPACE            TO ASC-LOCATION                08980027
089900         END-IF                                                   08990027
090000     END-IF.                                                      09000027
090100                                                                  09010027
090200* LISTING BUYER NUMBER                                            09020027
090300     IF  ABUYERL > ZERO                                           09030027
090400         MOVE ABUYERI              TO ASC-BUYER-NBR               09040027
090500     ELSE                                                         09050027
090600         IF  ABUYERF = DP015-ERASE-EOF                            09060027
090700             MOVE SPACE            TO ASC-BUYER-NBR               09070027
090800         END-IF                                                   09080027
090900     END-IF.                                                      09090027
091000                                                                  09100027
091100     MOVE ABYRDESI                 TO ASC-BUYER-NBR-DESC.         09110027
091200                                                                  09120027
091300* LISTING DEPARTMENT NUMBER                                       09130027
091400     IF  ADEPTL > ZERO                                            09140027
091500         MOVE ADEPTI               TO ASC-DEPT-NBR                09150027
091600     ELSE                                                         09160027
091700         IF  ADEPTF = DP015-ERASE-EOF                             09170027
091800             MOVE SPACE            TO ASC-DEPT-NBR                09180027
091900         END-IF                                                   09190027
092000     END-IF.                                                      09200027
092100                                                                  09210027
092200     MOVE ADPTDESI                 TO ASC-DEPT-NBR-DESC.          09220027
092300                                                                  09230027
092400* LISTING VENDOR DUNS NUMBER                                      09240027
092500     IF  AVENDORL > ZERO                                          09250027
092600         MOVE AVENDORI             TO ASC-VND-NBR                 09260027
092700     ELSE                                                         09270027
092800         IF  AVENDORF = DP015-ERASE-EOF                           09280027
092900             MOVE SPACE            TO ASC-VND-NBR                 09290027
093000         END-IF                                                   09300027
093100     END-IF.                                                      09310027
093200                                                                  09320027
093300     MOVE AVNDDESI                 TO ASC-VND-NBR-DESC.           09330027
093400*----------------------------------------------------------------*09340027
093500* ENSURE THE DATA IS CORRECT.  NOTE THAT IN A CRITERIA SPECIFI-  *09350027
093600* CATION SCREEN ONLY MINIMAL EDITS ARE DONE.  EDITS RELATED TO   *09360027
093700* A SPECIFIC SCREEN THAT THE USER IS GOING TO (LOCAL-GO) ARE DONE*09370027
093800* IN THE DESTINATION PROGRAM, NOT HERE.                          *09380027
093900*----------------------------------------------------------------*09390027
094000                                                                  09400027
094100 3000-EDIT-DATA-IN-COMMAREA.                                      09410027
094200                                                                  09420027
094300     PERFORM 4100-RESET-ATTRIBUTES.                               09430027
094400                                                                  09440027
094500     PERFORM 4010-GET-DATE-TIME.                                  09450027
094600                                                                  09460027
094700     MOVE PV-DATE-MM               TO PV-CURRENT-DATE-MM          09470027
094800     MOVE PV-DATE-DD               TO PV-CURRENT-DATE-DD          09480027
094900     MOVE PV-DATE-YY               TO PV-CURRENT-DATE-YY          09490027
095000                                                                  09500027
095100                                                                  09510027
095200******************************************************************09520027
095300*   VENDOR NUMBER VALIDATION                                     *09530027
095400******************************************************************09540027
095500                                                                  09550027
095600     IF ASC-VND-NBR = '*********'                                 09560027
095700         MOVE 'ALL'                    TO ASC-VND-NBR-DESC        09570027
095800         SET PS-VALID-VENDOR           TO TRUE                    09580027
095900     ELSE                                                         09590027
096000         IF  ASC-VND-NBR      > SPACE                             09600027
096100             MOVE ASC-VND-NBR          TO DP010I-UNEDITED-FIELD   09610027
096200             MOVE LENGTH OF ASC-VND-NBR                           09620027
096300                                       TO DP010I-MAXIMUM-DIGITS   09630027
096400             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 09640027
096500             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              09650027
263627             CALL DP010I-NUMERIC-EDIT-ROUTINE                     09661029
263627                  USING DP010I-NUMERIC-EDIT-AREA                  09662029
096700             IF  DP010I-ERROR-DETECTED                            09670027
096800                 SET PS-EDIT-ERROR                                09680027
096900                     PS-INVALID-VENDOR                            09690027
097000                     DP020-MSG-FATAL   TO TRUE                    09700027
097100                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        09710027
097200                 MOVE DP015-UNP-ALP-BRT-OFF                       09720027
097300                                       TO AVENDORA                09730027
097400                 MOVE DP015-RED        TO AVENDORC                09740027
097500                 MOVE DP015-REVERSE    TO AVENDORH                09750027
097600                 MOVE -1               TO AVENDORL                09760027
097700             ELSE                                                 09770027
097800                 MOVE DP010I-NUMERIC-FIELD                        09780027
097900                                       TO ASC-VND-NBR-N           09790027
098000                 MOVE ASC-VND-NBR-N    TO DK-VND-NBR              09800027
098100                 PERFORM 3300-VALIDATE-VENDOR                     09810027
098200             END-IF                                               09820027
098300         ELSE                                                     09830027
098400             SET PS-EDIT-ERROR                                    09840027
098500                 PS-INVALID-VENDOR                                09850027
098600                 DP020-MSG-FATAL   TO TRUE                        09860027
098700             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            09870027
098800             MOVE DP015-UNP-ALP-BRT-OFF                           09880027
098900                                   TO AVENDORA                    09890027
099000             MOVE DP015-RED        TO AVENDORC                    09900027
099100             MOVE DP015-REVERSE    TO AVENDORH                    09910027
099200             MOVE -1               TO AVENDORL                    09920027
099300         END-IF                                                   09930027
099400     END-IF.                                                      09940027
099500                                                                  09950027
099600                                                                  09960027
099700******************************************************************09970027
099800*  DEPARTMENT NUMBER VALIDATION                                  *09980027
099900******************************************************************09990027
100000     IF ASC-DEPT-NBR-ALL                                          10000027
100100         MOVE 'ALL'                    TO ASC-DEPT-NBR-DESC       10010027
100200         SET PS-VALID-DEPT             TO TRUE                    10020027
100300     ELSE                                                         10030027
100400         IF  ASC-DEPT-NBR     > SPACE                             10040027
100500             MOVE ASC-DEPT-NBR         TO DP010I-UNEDITED-FIELD   10050027
100600             MOVE LENGTH OF ASC-DEPT-NBR                          10060027
100700                                       TO DP010I-MAXIMUM-DIGITS   10070027
100800             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 10080027
100900             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              10090027
263627             CALL DP010I-NUMERIC-EDIT-ROUTINE                     10101029
263627                  USING DP010I-NUMERIC-EDIT-AREA                  10102029
101100             IF  DP010I-ERROR-DETECTED                            10110027
101200                 SET PS-EDIT-ERROR                                10120027
101300                     PS-INVALID-DEPT                              10130027
101400                     DP020-MSG-FATAL   TO TRUE                    10140027
101500                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        10150027
101600                 MOVE DP015-UNP-ALP-BRT-OFF                       10160027
101700                                       TO ADEPTA                  10170027
101800                 MOVE DP015-RED        TO ADEPTC                  10180027
101900                 MOVE DP015-REVERSE    TO ADEPTH                  10190027
102000                 MOVE -1               TO ADEPTL                  10200027
102100             ELSE                                                 10210027
102200                 MOVE DP010I-NUMERIC-FIELD                        10220027
102300                                       TO ASC-DEPT-NBR-N          10230027
102400                 MOVE ASC-DEPT-NBR-N   TO DK-DEPT-NBR             10240027
102500                 PERFORM 3110-VALIDATE-DEPARTMENT                 10250027
102600             END-IF                                               10260027
102700         ELSE                                                     10270027
102800             SET PS-EDIT-ERROR                                    10280027
102900                 PS-INVALID-DEPT                                  10290027
103000                 DP020-MSG-FATAL       TO TRUE                    10300027
103100             MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER        10310027
103200             MOVE DP015-UNP-ALP-BRT-OFF                           10320027
103300                                       TO ADEPTA                  10330027
103400             MOVE DP015-RED            TO ADEPTC                  10340027
103500             MOVE DP015-REVERSE        TO ADEPTH                  10350027
103600             MOVE -1                   TO ADEPTL                  10360027
103700         END-IF                                                   10370027
103800     END-IF.                                                      10380027
103900                                                                  10390027
104000******************************************************************10400027
104100*  BUYER NUMBER VALIDATION                                       *10410027
104200******************************************************************10420027
104300     IF ASC-BUYER-NBR-ALL                                         10430027
104400         MOVE 'ALL'                    TO ASC-BUYER-NBR-DESC      10440027
104500         SET PS-VALID-BUYER            TO TRUE                    10450027
104600     ELSE                                                         10460027
104700         IF  ASC-BUYER-NBR    > SPACE                             10470027
104800             MOVE ASC-BUYER-NBR        TO DP010I-UNEDITED-FIELD   10480027
104900             MOVE LENGTH OF ASC-BUYER-NBR                         10490027
105000                                       TO DP010I-MAXIMUM-DIGITS   10500027
105100             MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS 10510027
105200             SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE              10520027
263627             CALL DP010I-NUMERIC-EDIT-ROUTINE                     10531029
263627                  USING DP010I-NUMERIC-EDIT-AREA                  10532029
105400             IF  DP010I-ERROR-DETECTED                            10540027
105500                 SET PS-EDIT-ERROR                                10550027
105600                     PS-INVALID-BUYER                             10560027
105700                     DP020-MSG-FATAL   TO TRUE                    10570027
105800                 MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER        10580027
105900                 MOVE DP015-UNP-ALP-BRT-OFF                       10590027
106000                                       TO ABUYERA                 10600027
106100                 MOVE DP015-RED        TO ABUYERC                 10610027
106200                 MOVE DP015-REVERSE    TO ABUYERH                 10620027
106300                 MOVE -1               TO ABUYERL                 10630027
106400             ELSE                                                 10640027
106500                 MOVE DP010I-NUMERIC-FIELD                        10650027
106600                                       TO ASC-BUYER-NBR-N         10660027
106700                 MOVE ASC-BUYER-NBR-N  TO DK-BUYER-NBR            10670027
106800                 PERFORM 3120-VALIDATE-BUYER                      10680027
106900             END-IF                                               10690027
107000         ELSE                                                     10700027
107100             SET PS-EDIT-ERROR                                    10710027
107200                 PS-INVALID-BUYER                                 10720027
107300                 DP020-MSG-FATAL   TO TRUE                        10730027
107400             MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER            10740027
107500             MOVE DP015-UNP-ALP-BRT-OFF                           10750027
107600                                   TO ABUYERA                     10760027
107700             MOVE DP015-RED        TO ABUYERC                     10770027
107800             MOVE DP015-REVERSE    TO ABUYERH                     10780027
107900             MOVE -1               TO ABUYERL                     10790027
108000         END-IF                                                   10800027
108100     END-IF.                                                      10810027
108200                                                                  10820027
108300                                                                  10830027
108400******************************************************************10840027
108500*  VENDOR/DEPARTMENT CROSS VALIDATION                            *10850027
108600******************************************************************10860027
108700*  IF INITIAL CHECKS OF VENDOR AND DEPTARTMENT SHOW THEY ARE VALID10870027
108800*  AND BOTH ARE FIELDS HAVE ACTUAL VALUES IN THEM, PERFORM CROSS  10880027
108900*  VALIDATION TO MAKE SURE THE VALUES ARE A VALID COMBINATION.    10890027
109000                                                                  10900027
109100     IF  (PS-VALID-VENDOR AND PS-VALID-DEPT)                      10910027
109200     AND (NOT ASC-DEPT-NBR-ALL AND NOT ASC-VND-NBR-ALL)           10920027
109300         PERFORM 3310-VND-DEPT-CROSS-VALIDATION                   10930027
109400     END-IF.                                                      10940027
109500                                                                  10950027
109600                                                                  10960027
109700******************************************************************10970027
109800*   BUYER/DEPARTMENT CROSS VALIDATION                            *10980027
109900******************************************************************10990027
110000*  IF INITIAL CHECKS OF BUYER AND DEPTARTMENT SHOW THEY ARE VALID 11000027
110100*  AND BOTH ARE FIELDS HAVE ACTUAL VALUES IN THEM, PERFORM CROSS  11010027
110200*  VALIDATION TO MAKE SURE THE VALUES ARE A VALID COMBINATION.    11020027
110300                                                                  11030027
110400     IF  (PS-VALID-DEPT AND PS-VALID-BUYER)                       11040027
110500     AND (NOT ASC-BUYER-NBR-ALL AND NOT ASC-DEPT-NBR-ALL)         11050027
110600         PERFORM 3100-BYR-DPT-CROSS-VALIDATION                    11060027
110700     END-IF.                                                      11070027
110800                                                                  11080027
110900******************************************************************11090027
111000*  STORAGE LOCATION VALIDATION                                   *11100027
111100******************************************************************11110027
111200     IF ASC-LOCATION > SPACES                                     11120027
111300         CONTINUE                                                 11130027
111400     ELSE                                                         11140027
111500         SET PS-EDIT-ERROR                                        11150027
111600             DP020-MSG-FATAL       TO TRUE                        11160027
111700         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            11170027
111800         MOVE DP015-UNP-ALP-BRT-OFF                               11180027
111900                                   TO ALOCA                       11190027
112000         MOVE DP015-RED            TO ALOCC                       11200027
112100         MOVE DP015-REVERSE        TO ALOCH                       11210027
112200         MOVE -1                   TO ALOCL                       11220027
112300     END-IF.                                                      11230027
112400                                                                  11240027
112500******************************************************************11250027
112600*  LISTING TYPE/STATUS VALIDATION                                *11260027
112700******************************************************************11270027
112800     MOVE ASC-LIST-TYPE            TO PV-WORK-LIST-TYPE.          11280027
112900                                                                  11290027
113000     MOVE ASC-LIST-STATUS          TO PV-WORK-LIST-STATUS.        11300027
113100                                                                  11310027
113200     IF PV-TYPE-VALID                                             11320027
113300         CONTINUE                                                 11330027
113400     ELSE                                                         11340027
113500         MOVE 'INVALID VALUE'      TO ASC-LIST-TYPE-DESC          11350027
113600         SET PS-EDIT-ERROR                                        11360027
113700             DP020-MSG-FATAL       TO TRUE                        11370027
113800         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            11380027
113900         MOVE DP015-UNP-ALP-BRT-OFF                               11390027
114000                                   TO ALTYPEA                     11400027
114100         MOVE DP015-RED            TO ALTYPEC                     11410027
114200         MOVE DP015-REVERSE        TO ALTYPEH                     11420027
114300         MOVE -1                   TO ALTYPEL                     11430027
114400     END-IF.                                                      11440027
114500                                                                  11450027
114600     IF PV-STATUS-VALID                                           11460027
114700         CONTINUE                                                 11470027
114800     ELSE                                                         11480027
114900         MOVE 'INVALID VALUE'      TO ASC-LIST-STATUS-DESC        11490027
115000         SET PS-EDIT-ERROR                                        11500027
115100             DP020-MSG-FATAL       TO TRUE                        11510027
115200         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            11520027
115300         MOVE DP015-UNP-ALP-BRT-OFF                               11530027
115400                                   TO ALSTATA                     11540027
115500         MOVE DP015-RED            TO ALSTATC                     11550027
115600         MOVE DP015-REVERSE        TO ALSTATH                     11560027
115700         MOVE -1                   TO ALSTATL                     11570027
115800     END-IF.                                                      11580027
115900                                                                  11590027
116000     IF PV-STATUS-VALID AND PV-TYPE-VALID                         11600027
116100         EVALUATE TRUE ALSO FALSE                                 11610027
116200             WHEN PV-TYPE-MARKOUT ALSO PV-STATUS-MARKOUT-VALID    11620027
116300             WHEN PV-TYPE-RTV     ALSO PV-STATUS-RTV-VALID        11630027
116400             WHEN PV-TYPE-D-AND-D ALSO PV-STATUS-D-AND-D-VALID    11640027
116500             WHEN PV-TYPE-CALLBACK ALSO PV-STATUS-CALLBACK-VALID  11650027
116600                 MOVE 'INVALID TYPE/STAT COMBO '                  11660027
116700                                       TO ASC-LIST-TYPE-DESC      11670027
116800                                          ASC-LIST-STATUS-DESC    11680027
116900                 SET PS-EDIT-ERROR                                11690027
117000                     DP020-MSG-FATAL   TO TRUE                    11700027
117100                 MOVE PC-TSYMSG-00807  TO DP020-MSG-NUMBER        11710027
117200                 MOVE DP015-UNP-ALP-BRT-OFF                       11720027
117300                                       TO ALTYPEA                 11730027
117400                                          ALSTATA                 11740027
117500                 MOVE DP015-RED        TO ALTYPEC                 11750027
117600                                          ALSTATC                 11760027
117700                 MOVE DP015-REVERSE    TO ALTYPEH                 11770027
117800                                          ALSTATH                 11780027
117900                 MOVE -1               TO ALTYPEL                 11790027
118000             WHEN OTHER                                           11800027
118100                 EVALUATE TRUE                                    11810027
118200                     WHEN PV-TYPE-ALL                             11820027
118300                         MOVE 'ALL '   TO ASC-LIST-TYPE-DESC      11830027
118400                     WHEN PV-TYPE-RTV                             11840027
118500                         MOVE 'RTV'    TO ASC-LIST-TYPE-DESC      11850027
118600                     WHEN PV-TYPE-MARKOUT                         11860027
118700                         MOVE 'MARKOUTS'                          11870027
118800                                       TO ASC-LIST-TYPE-DESC      11880027
118900                     WHEN PV-TYPE-D-AND-D                         11890027
119000                         MOVE 'DEBIT & DISPOSE'                   11900027
119100                                       TO ASC-LIST-TYPE-DESC      11910027
119200                     WHEN PV-TYPE-CALLBACK                        11920027
119300                         MOVE 'CALLBACK'                          11930027
119400                                       TO ASC-LIST-TYPE-DESC      11940027
119500                 END-EVALUATE                                     11950027
119600                 EVALUATE TRUE                                    11960027
119700                     WHEN PV-STATUS-ALL                           11970027
119800                         MOVE 'ALL '   TO ASC-LIST-STATUS-DESC    11980027
119900                     WHEN PV-STATUS-NEW                           11990027
120000                         MOVE 'NEW '   TO ASC-LIST-STATUS-DESC    12000027
120100                     WHEN PV-STATUS-OPEN                          12010027
120200                         MOVE 'OPEN'   TO ASC-LIST-STATUS-DESC    12020027
120300                     WHEN PV-STATUS-CLOSED                        12030027
120400                         MOVE 'CLOSED' TO ASC-LIST-STATUS-DESC    12040027
120500                     WHEN PV-STATUS-SHIPPED                       12050027
120600                         MOVE 'SHIPPED'                           12060027
120700                                       TO ASC-LIST-STATUS-DESC    12070027
120800                     WHEN PV-STATUS-PENDING                       12080027
120900                         MOVE 'PENDING'                           12090027
121000                                       TO ASC-LIST-STATUS-DESC    12100027
121100                     WHEN PV-STATUS-APPROVED                      12110027
121200                         MOVE 'APPROVED'                          12120027
121300                                       TO ASC-LIST-STATUS-DESC    12130027
121400                     WHEN PV-STATUS-DISPOSED                      12140027
121500                         MOVE 'DISPOSED '                         12150027
121600                                       TO ASC-LIST-STATUS-DESC    12160027
121700                 END-EVALUATE                                     12170027
121800         END-EVALUATE                                             12180027
121900     END-IF.                                                      12190027
122000                                                                  12200027
122100                                                                  12210027
122200******************************************************************12220027
122300*  REPORT TYPE VALIDATION                                        *12230027
122400******************************************************************12240027
122500                                                                  12250027
122600     EVALUATE TRUE                                                12260027
122700     WHEN ASC-BOTH-REPORTS                                        12270027
122800         MOVE 'BOTH SUMMARY & DETAIL RPT '                        12280027
122900                                   TO ASC-REPORT-TYPE-DESC        12290027
123000     WHEN ASC-SUMMARY-REPORT                                      12300027
123100         MOVE 'SUMMARY REPORT ONLY       '                        12310027
123200                                   TO ASC-REPORT-TYPE-DESC        12320027
123300     WHEN ASC-DETAIL-REPORT                                       12330027
123400         MOVE 'DETAIL REPORT ONLY        '                        12340027
123500                                   TO ASC-REPORT-TYPE-DESC        12350027
123600     WHEN ASC-TOTAL-PAGE-ONLY                                     12360027
123700         MOVE 'TOTAL PAGE ONLY           '                        12370027
123800                                   TO ASC-REPORT-TYPE-DESC        12380027
123900     WHEN OTHER                                                   12390027
124000         MOVE 'VALID VALUES: D, S, B & T '                        12400027
124100                                   TO ASC-REPORT-TYPE-DESC        12410027
124200         SET PS-EDIT-ERROR                                        12420027
124300             DP020-MSG-FATAL       TO TRUE                        12430027
124400         MOVE PC-TSYMSG-00005      TO DP020-MSG-NUMBER            12440027
124500         MOVE DP015-UNP-ALP-BRT-OFF                               12450027
124600                                   TO ARPTTYPA                    12460027
124700         MOVE DP015-RED            TO ARPTTYPC                    12470027
124800         MOVE DP015-REVERSE        TO ARPTTYPH                    12480027
124900         MOVE -1                   TO ARPTTYPL                    12490027
125000     END-EVALUATE.                                                12500027
125100                                                                  12510027
125200                                                                  12520027
125300                                                                  12530027
125400******************************************************************12540027
125500*   REPORT DEST/NUMBER OF COPIES VALIDATION                      *12550027
125600******************************************************************12560027
125700     IF ASC-PRINT-DEST > SPACES                                   12570027
125800        MOVE '01'                  TO DP072-RPT-PGM-TYP-ID        12580027
125900*       MOVE ASC-OPER-UNT-ID       TO DP072-ORIGIN-OPER-UNT-ID    12590027
126000        MOVE DP020-LOCATION-NBR    TO DP072-ORIGIN-OPER-UNT-ID    12600027
126100                                      DP072-OPER-UNT-ID           12610027
126200        MOVE '0001'                TO DP072-ORIGIN-FCLTY-ID       12620027
126300                                      DP072-FCLTY-ID              12630027
126400        MOVE ASC-PRINT-DEST        TO DP072-PRINTER-ID            12640027
126500        MOVE 'RVKCS112'            TO DP072-RPT-PGM-NME           12650027
126600        SET DP072-VALIDATE         TO TRUE                        12660027
126700                                                                  12670027
126800        EXEC CICS                                                 12680027
126900             LINK PROGRAM  (PC-DPKCS060)                          12690027
127000                  COMMAREA (DP072-COMM-AREA)                      12700027
127100                  RESP     (PV-CICS-RESPONSE)                     12710027
127200        END-EXEC                                                  12720027
127300                                                                  12730027
127400        EVALUATE TRUE                                             12740027
127500            WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)              12750027
127600                 CONTINUE                                         12760027
127700            WHEN OTHER                                            12770027
127800               MOVE '3000-EDIT-DATA-IN-COMMAREA'                  12780027
127900                                     TO DP013-PARAGRAPH           12790027
128000               MOVE PV-CICS-RESPONSE TO DP013-MESSAGE-TEXT(1)     12800027
128100               MOVE SQLCA            TO DP013-SQLCA               12810027
128200               SET DP013-LINK-RETURN                              12820027
128300                   DP013-CICS-ABEND                               12830027
128400                   DP013-NO-ROLLBACK TO TRUE                      12840027
128500                   PERFORM DP013-0000-PROCESS-ABEND               12850027
128600        END-EVALUATE                                              12860027
128700        IF  DP072-PRTR-PRTR-TRK-STAT-CDE  EQUAL 'A'               12870027
128800            CONTINUE                                              12880027
128900        ELSE                                                      12890027
129000            SET PS-EDIT-ERROR                                     12900027
129100                DP020-MSG-FATAL         TO TRUE                   12910027
129200            MOVE PC-TSYMSG-00746        TO DP020-MSG-NUMBER       12920027
129300            MOVE DP015-UNP-ALP-BRT-OFF  TO ADESTA                 12930027
129400            MOVE DP015-RED              TO ADESTC                 12940027
129500            MOVE DP015-REVERSE          TO ADESTH                 12950027
129600            MOVE -1                     TO ADESTL                 12960027
129700            SET DP030-SET-CURSOR-APPL-1 TO TRUE                   12970027
129800        END-IF                                                    12980027
129900     ELSE                                                         12990027
130000         SET PS-EDIT-ERROR                                        13000027
130100             DP020-MSG-FATAL       TO TRUE                        13010027
130200         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            13020027
130300         MOVE DP015-UNP-ALP-BRT-OFF                               13030027
130400                                   TO ADESTA                      13040027
130500         MOVE DP015-RED            TO ADESTC                      13050027
130600         MOVE DP015-REVERSE        TO ADESTH                      13060027
130700         MOVE -1                   TO ADESTL                      13070027
130800     END-IF.                                                      13080027
130900                                                                  13090027
131000     IF ASC-RPT-COPY   > SPACES                                   13100027
131100         MOVE ASC-RPT-COPY         TO DP010I-UNEDITED-FIELD       13110027
131200         MOVE  LENGTH  OF  ASC-RPT-COPY                           13120027
131300                                   TO DP010I-MAXIMUM-DIGITS       13130027
131400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     13140027
131500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13150027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13161029
263627              USING DP010I-NUMERIC-EDIT-AREA                      13162029
131700         IF  DP010I-ERROR-DETECTED                                13170027
131800             SET PS-EDIT-ERROR                                    13180027
131900                 DP020-MSG-FATAL   TO TRUE                        13190027
132000             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13200027
132100             MOVE DP015-UNP-ALP-BRT-OFF                           13210027
132200                                   TO ARPTCPYA                    13220027
132300             MOVE DP015-RED        TO ARPTCPYC                    13230027
132400             MOVE DP015-REVERSE    TO ARPTCPYH                    13240027
132500             MOVE -1               TO ARPTCPYL                    13250027
132600         ELSE                                                     13260027
132700             MOVE DP010I-NUMERIC-FIELD                            13270027
132800                                   TO ASC-RPT-COPY-N              13280027
132900         END-IF                                                   13290027
133000     ELSE                                                         13300027
133100         SET PS-EDIT-ERROR                                        13310027
133200             DP020-MSG-FATAL       TO TRUE                        13320027
133300         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            13330027
133400         MOVE DP015-UNP-ALP-BRT-OFF                               13340027
133500                                   TO ARPTCPYA                    13350027
133600         MOVE DP015-RED            TO ARPTCPYC                    13360027
133700         MOVE DP015-REVERSE        TO ARPTCPYH                    13370027
133800         MOVE -1                   TO ARPTCPYL                    13380027
133900     END-IF.                                                      13390027
134000                                                                  13400027
134100                                                                  13410027
134200******************************************************************13420027
134300*   START/END DATE VALIDATION                                    *13430027
134400******************************************************************13440027
134500                                                                  13450027
134600     SET PS-VALID-DATES            TO TRUE.                       13460027
134700                                                                  13470027
134800     IF ASC-END-YEAR   > SPACES                                   13480027
134900         MOVE ASC-END-YEAR         TO DP010I-UNEDITED-FIELD       13490027
135000         MOVE  LENGTH  OF  ASC-END-YEAR                           13500027
135100                                   TO DP010I-MAXIMUM-DIGITS       13510027
135200         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     13520027
135300         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13530027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13541029
263627              USING DP010I-NUMERIC-EDIT-AREA                      13542029
135500         IF  DP010I-ERROR-DETECTED                                13550027
135600             SET PS-EDIT-ERROR                                    13560027
135700                 PS-INVALID-DATES                                 13570027
135800                 DP020-MSG-FATAL   TO TRUE                        13580027
135900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13590027
136000             MOVE DP015-UNP-ALP-BRT-OFF                           13600027
136100                                   TO AEYEARA                     13610027
136200             MOVE DP015-RED        TO AEYEARC                     13620027
136300             MOVE DP015-REVERSE    TO AEYEARH                     13630027
136400             MOVE -1               TO AEYEARL                     13640027
136500         ELSE                                                     13650027
136600             MOVE DP010I-NUMERIC-FIELD                            13660027
136700                                   TO ASC-END-YEAR-N              13670027
136800         END-IF                                                   13680027
136900     ELSE                                                         13690027
137000         SET PS-EDIT-ERROR                                        13700027
137100             PS-INVALID-DATES                                     13710027
137200             DP020-MSG-FATAL       TO TRUE                        13720027
137300         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            13730027
137400         MOVE DP015-UNP-ALP-BRT-OFF                               13740027
137500                                   TO AEYEARA                     13750027
137600         MOVE DP015-RED            TO AEYEARC                     13760027
137700         MOVE DP015-REVERSE        TO AEYEARH                     13770027
137800         MOVE -1                   TO AEYEARL                     13780027
137900     END-IF.                                                      13790027
138000                                                                  13800027
138100     IF ASC-END-DAY    > SPACES                                   13810027
138200         MOVE ASC-END-DAY          TO DP010I-UNEDITED-FIELD       13820027
138300         MOVE  LENGTH  OF  ASC-END-DAY                            13830027
138400                                   TO DP010I-MAXIMUM-DIGITS       13840027
138500         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     13850027
138600         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  13860027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         13871029
263627              USING DP010I-NUMERIC-EDIT-AREA                      13872029
138800         IF  DP010I-ERROR-DETECTED                                13880027
138900             SET PS-EDIT-ERROR                                    13890027
139000                 PS-INVALID-DATES                                 13900027
139100                 DP020-MSG-FATAL   TO TRUE                        13910027
139200             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            13920027
139300             MOVE DP015-UNP-ALP-BRT-OFF                           13930027
139400                                   TO AEDAYA                      13940027
139500             MOVE DP015-RED        TO AEDAYC                      13950027
139600             MOVE DP015-REVERSE    TO AEDAYH                      13960027
139700             MOVE -1               TO AEDAYL                      13970027
139800         ELSE                                                     13980027
139900             MOVE DP010I-NUMERIC-FIELD                            13990027
140000                                   TO ASC-END-DAY-N               14000027
140100         END-IF                                                   14010027
140200     ELSE                                                         14020027
140300         SET PS-EDIT-ERROR                                        14030027
140400             PS-INVALID-DATES                                     14040027
140500             DP020-MSG-FATAL       TO TRUE                        14050027
140600         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            14060027
140700         MOVE DP015-UNP-ALP-BRT-OFF                               14070027
140800                                   TO AEDAYA                      14080027
140900         MOVE DP015-RED            TO AEDAYC                      14090027
141000         MOVE DP015-REVERSE        TO AEDAYH                      14100027
141100         MOVE -1                   TO AEDAYL                      14110027
141200     END-IF.                                                      14120027
141300                                                                  14130027
141400     IF ASC-END-MONTH  > SPACES                                   14140027
141500         MOVE ASC-END-MONTH        TO DP010I-UNEDITED-FIELD       14150027
141600         MOVE  LENGTH  OF  ASC-END-MONTH                          14160027
141700                                   TO DP010I-MAXIMUM-DIGITS       14170027
141800         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     14180027
141900         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14190027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14201029
263627              USING DP010I-NUMERIC-EDIT-AREA                      14202029
142100         IF  DP010I-ERROR-DETECTED                                14210027
142200             SET PS-EDIT-ERROR                                    14220027
142300                 PS-INVALID-DATES                                 14230027
142400                 DP020-MSG-FATAL   TO TRUE                        14240027
142500             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14250027
142600             MOVE DP015-UNP-ALP-BRT-OFF                           14260027
142700                                   TO AEMONTHA                    14270027
142800             MOVE DP015-RED        TO AEMONTHC                    14280027
142900             MOVE DP015-REVERSE    TO AEMONTHH                    14290027
143000             MOVE -1               TO AEMONTHL                    14300027
143100         ELSE                                                     14310027
143200             MOVE DP010I-NUMERIC-FIELD                            14320027
143300                                   TO ASC-END-MONTH-N             14330027
143400         END-IF                                                   14340027
143500     ELSE                                                         14350027
143600         SET PS-EDIT-ERROR                                        14360027
143700             PS-INVALID-DATES                                     14370027
143800             DP020-MSG-FATAL       TO TRUE                        14380027
143900         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            14390027
144000         MOVE DP015-UNP-ALP-BRT-OFF                               14400027
144100                                   TO AEMONTHA                    14410027
144200         MOVE DP015-RED            TO AEMONTHC                    14420027
144300         MOVE DP015-REVERSE        TO AEMONTHH                    14430027
144400         MOVE -1                   TO AEMONTHL                    14440027
144500     END-IF.                                                      14450027
144600                                                                  14460027
144700     IF ASC-STRT-YEAR  > SPACES                                   14470027
144800         MOVE ASC-STRT-YEAR        TO DP010I-UNEDITED-FIELD       14480027
144900         MOVE  LENGTH  OF  ASC-STRT-YEAR                          14490027
145000                                   TO DP010I-MAXIMUM-DIGITS       14500027
145100         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     14510027
145200         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14520027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14531029
263627              USING DP010I-NUMERIC-EDIT-AREA                      14532029
145400         IF  DP010I-ERROR-DETECTED                                14540027
145500             SET PS-EDIT-ERROR                                    14550027
145600                 PS-INVALID-DATES                                 14560027
145700                 DP020-MSG-FATAL   TO TRUE                        14570027
145800             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14580027
145900             MOVE DP015-UNP-ALP-BRT-OFF                           14590027
146000                                   TO ASYEARA                     14600027
146100             MOVE DP015-RED        TO ASYEARC                     14610027
146200             MOVE DP015-REVERSE    TO ASYEARH                     14620027
146300             MOVE -1               TO ASYEARL                     14630027
146400         ELSE                                                     14640027
146500             MOVE DP010I-NUMERIC-FIELD                            14650027
146600                                   TO ASC-STRT-YEAR-N             14660027
146700         END-IF                                                   14670027
146800     ELSE                                                         14680027
146900         SET PS-EDIT-ERROR                                        14690027
147000             PS-INVALID-DATES                                     14700027
147100             DP020-MSG-FATAL       TO TRUE                        14710027
147200         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            14720027
147300         MOVE DP015-UNP-ALP-BRT-OFF                               14730027
147400                                   TO ASYEARA                     14740027
147500         MOVE DP015-RED            TO ASYEARC                     14750027
147600         MOVE DP015-REVERSE        TO ASYEARH                     14760027
147700         MOVE -1                   TO ASYEARL                     14770027
147800     END-IF.                                                      14780027
147900                                                                  14790027
148000     IF ASC-STRT-DAY   > SPACES                                   14800027
148100         MOVE ASC-STRT-DAY         TO DP010I-UNEDITED-FIELD       14810027
148200         MOVE  LENGTH  OF  ASC-STRT-DAY                           14820027
148300                                   TO DP010I-MAXIMUM-DIGITS       14830027
148400         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     14840027
148500         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  14850027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         14861029
263627              USING DP010I-NUMERIC-EDIT-AREA                      14862029
148700         IF  DP010I-ERROR-DETECTED                                14870027
148800             SET PS-EDIT-ERROR                                    14880027
148900                 PS-INVALID-DATES                                 14890027
149000                 DP020-MSG-FATAL   TO TRUE                        14900027
149100             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            14910027
149200             MOVE DP015-UNP-ALP-BRT-OFF                           14920027
149300                                   TO ASDAYA                      14930027
149400             MOVE DP015-RED        TO ASDAYC                      14940027
149500             MOVE DP015-REVERSE    TO ASDAYH                      14950027
149600             MOVE -1               TO ASDAYL                      14960027
149700         ELSE                                                     14970027
149800             MOVE DP010I-NUMERIC-FIELD                            14980027
149900                                   TO ASC-STRT-DAY-N              14990027
150000         END-IF                                                   15000027
150100     ELSE                                                         15010027
150200         SET PS-EDIT-ERROR                                        15020027
150300             PS-INVALID-DATES                                     15030027
150400             DP020-MSG-FATAL       TO TRUE                        15040027
150500         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            15050027
150600         MOVE DP015-UNP-ALP-BRT-OFF                               15060027
150700                                   TO ASDAYA                      15070027
150800         MOVE DP015-RED            TO ASDAYC                      15080027
150900         MOVE DP015-REVERSE        TO ASDAYH                      15090027
151000         MOVE -1                   TO ASDAYL                      15100027
151100     END-IF.                                                      15110027
151200                                                                  15120027
151300     IF ASC-STRT-MONTH > SPACES                                   15130027
151400         MOVE ASC-STRT-MONTH       TO DP010I-UNEDITED-FIELD       15140027
151500         MOVE  LENGTH  OF  ASC-STRT-MONTH                         15150027
151600                                   TO DP010I-MAXIMUM-DIGITS       15160027
151700         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     15170027
151800         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15180027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15191029
263627              USING DP010I-NUMERIC-EDIT-AREA                      15192029
152000         IF  DP010I-ERROR-DETECTED                                15200027
152100             SET PS-EDIT-ERROR                                    15210027
152200                 PS-INVALID-DATES                                 15220027
152300                 DP020-MSG-FATAL   TO TRUE                        15230027
152400             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15240027
152500             MOVE DP015-UNP-ALP-BRT-OFF                           15250027
152600                                   TO ASMONTHA                    15260027
152700             MOVE DP015-RED        TO ASMONTHC                    15270027
152800             MOVE DP015-REVERSE    TO ASMONTHH                    15280027
152900             MOVE -1               TO ASMONTHL                    15290027
153000         ELSE                                                     15300027
153100             MOVE DP010I-NUMERIC-FIELD                            15310027
153200                                   TO ASC-STRT-MONTH-N            15320027
153300         END-IF                                                   15330027
153400     ELSE                                                         15340027
153500         SET PS-EDIT-ERROR                                        15350027
153600             PS-INVALID-DATES                                     15360027
153700             DP020-MSG-FATAL       TO TRUE                        15370027
153800         MOVE PC-TSYMSG-00007      TO DP020-MSG-NUMBER            15380027
153900         MOVE DP015-UNP-ALP-BRT-OFF                               15390027
154000                                   TO ASMONTHA                    15400027
154100         MOVE DP015-RED            TO ASMONTHC                    15410027
154200         MOVE DP015-REVERSE        TO ASMONTHH                    15420027
154300         MOVE -1                   TO ASMONTHL                    15430027
154400     END-IF.                                                      15440027
154500                                                                  15450027
154600                                                                  15460027
154700     IF PS-VALID-DATES                                            15470027
154800         PERFORM 3200-VALIDATE-DATES.                             15480027
154900                                                                  15490027
155000                                                                  15500027
155100******************************************************************15510027
155200*   OPERATING UNIT ID VALIDATION                                 *15520027
155300******************************************************************15530027
155400                                                                  15540027
155500     SET PS-VALID-OPER TO TRUE.                                   15550027
155600                                                                  15560027
155700     IF  ASC-OPER-UNT-ID  > SPACE                                 15570027
155800         MOVE ASC-OPER-UNT-ID      TO DP010I-UNEDITED-FIELD       15580027
155900         MOVE LENGTH OF ASC-OPER-UNT-ID  TO DP010I-MAXIMUM-DIGITS 15590027
156000         MOVE ZERO                 TO DP010I-MAXIMUM-DECIMALS     15600027
156100         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  15610027
263627         CALL DP010I-NUMERIC-EDIT-ROUTINE                         15621029
263627              USING DP010I-NUMERIC-EDIT-AREA                      15622029
156300         IF  DP010I-ERROR-DETECTED                                15630027
156400             SET PS-EDIT-ERROR                                    15640027
156500                 PS-INVALID-OPER                                  15650027
156600                 DP020-MSG-FATAL   TO TRUE                        15660027
156700             MOVE SPACES           TO AOPDESCI                    15670027
156800                                      ASC-OPER-UNT-ID-DESC        15680027
156900             MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER            15690027
157000             MOVE DP015-UNP-ALP-BRT-OFF                           15700027
157100                                   TO AOPUIDA                     15710027
157200             MOVE DP015-RED        TO AOPUIDC                     15720027
157300             MOVE DP015-REVERSE    TO AOPUIDH                     15730027
157400             MOVE -1               TO AOPUIDL                     15740027
157500         ELSE                                                     15750027
157600             MOVE DP010I-NUMERIC-FIELD                            15760027
157700                                   TO ASC-OPER-UNT-ID-N           15770027
157800*            MOVE ASC-OPER-UNT-ID-N TO DK-OPER-UNT-ID             15780027
157900             MOVE ASC-OPER-UNT-ID-N TO DK-RTV-LOC-NBR             15790027
158000             PERFORM 3400-VALIDATE-OPER-UNT-ID                    15800027
158100             IF  PS-INVALID-OPER                                  15810027
158200                 SET PS-EDIT-ERROR                                15820027
158300                     DP020-MSG-FATAL   TO TRUE                    15830027
158400                 MOVE PC-TSYMSG-00005  TO DP020-MSG-NUMBER        15840027
158500                 MOVE DP015-UNP-ALP-BRT-OFF                       15850027
158600                                       TO AOPUIDA                 15860027
158700                 MOVE DP015-RED        TO AOPUIDC                 15870027
158800                 MOVE DP015-REVERSE    TO AOPUIDH                 15880027
158900                 MOVE -1               TO AOPUIDL                 15890027
159000             END-IF                                               15900027
159100         END-IF                                                   15910027
159200     ELSE                                                         15920027
159300         SET PS-EDIT-ERROR                                        15930027
159400             DP020-MSG-FATAL   TO TRUE                            15940027
159500         MOVE PC-TSYMSG-00007  TO DP020-MSG-NUMBER                15950027
159600         MOVE SPACES           TO AOPDESCI                        15960027
159700                                  ASC-OPER-UNT-ID-DESC            15970027
159800         MOVE DP015-UNP-ALP-BRT-OFF                               15980027
159900                               TO AOPUIDA                         15990027
160000         MOVE DP015-RED        TO AOPUIDC                         16000027
160100         MOVE DP015-REVERSE    TO AOPUIDH                         16010027
160200         MOVE -1               TO AOPUIDL                         16020027
160300     END-IF.                                                      16030027
160400                                                                  16040027
160500                                                                  16050027
160600     IF  PS-NO-EDIT-ERROR                                         16060027
160700         MOVE -1                      TO ALTYPEL                  16070027
160800     END-IF.                                                      16080027
160900                                                                  16090027
161000     EJECT                                                        16100027
161100*----------------------------------------------------------------*16110027
161200*  VALIDATE THAT THE TWO VALUES ENTERED ARE A VALID COMBINATION  *16120027
161300*----------------------------------------------------------------*16130027
161400 3100-BYR-DPT-CROSS-VALIDATION.                                   16140027
161500                                                                  16150027
161600     INITIALIZE DP003-MBS-SUBROUTINE-FIELDS.                      16160027
161700     SET DP003-BYR-LOOKUP-NAME                                    16170027
161800         DP003-BYR-NAME-LAST-FIRST     TO TRUE.                   16180027
161900     MOVE ASC-DEPT-NBR                 TO DP003-DPT-INPUT.        16190027
162000     MOVE PC-SYSTEM-CODE               TO DP003-SYSTEM-CODE.      16200027
162100     MOVE PC-KOHLS-OPERATING-COMPANY   TO DP003-OP-CO-NMBR.       16210027
162200     MOVE PV-CURRENT-DATE              TO DP003-CURRENT-DATE      16220027
162300                                          DP003-EFF-DATE.         16230027
162400     MOVE LENGTH OF DP003-MBS-SUBROUTINE-FIELDS                   16240027
162500                                       TO PV-COMMAREA-LENGTH.     16250027
162600                                                                  16260027
162700     EXEC CICS                                                    16270027
162800          LINK                                                    16280027
162900              PROGRAM   (PC-DPKUT038)                             16290027
163000              COMMAREA  (DP003-MBS-SUBROUTINE-FIELDS)             16300027
163100              LENGTH    (PV-COMMAREA-LENGTH)                      16310027
163200              RESP      (PV-CICS-RESPONSE)                        16320027
163300     END-EXEC.                                                    16330027
163400                                                                  16340027
163500     EVALUATE TRUE                                                16350027
163600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 16360027
163700             CONTINUE                                             16370027
163800         WHEN OTHER                                               16380027
163900             SET DP013-CICS-ABEND     TO TRUE                     16390027
164000             SET DP013-NO-ROLLBACK    TO TRUE                     16400027
164100             MOVE '3100-BYR-DPT-CROSS-VALIDATE(A)'                16410027
164200                                      TO DP013-PARAGRAPH          16420027
164300             MOVE 'CANNOT LINK TO DPKUT038'                       16430027
164400                                      TO DP013-MESSAGE-TEXT (1)   16440027
164500             MOVE PV-CICS-RESPONSE    TO AM-CICS-CODE-7           16450027
164600             PERFORM DP013-0000-PROCESS-ABEND                     16460027
164700     END-EVALUATE.                                                16470027
164800                                                                  16480027
164900     EVALUATE TRUE                                                16490027
165000         WHEN DP003-SUCCESSFUL                                    16500027
165100              IF DP003-BYR-NMBR = ASC-BUYER-NBR                   16510027
165200                  CONTINUE                                        16520027
165300              ELSE                                                16530027
165400                  SET PS-EDIT-ERROR                               16540027
165500                      DP020-MSG-FATAL        TO TRUE              16550027
165600                  MOVE PC-TSYMSG-00779       TO DP020-MSG-NUMBER  16560027
165700                  MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA           16570027
165800                                                ADEPTA            16580027
165900                  MOVE DP015-RED             TO ABUYERC           16590027
166000                                                ADEPTC            16600027
166100                  MOVE DP015-REVERSE         TO ABUYERH           16610027
166200                                                ADEPTH            16620027
166300                  MOVE -1                    TO ABUYERL           16630027
166400                                                ADEPTL            16640027
166500                  MOVE 'INVALID COMBINATION   '                   16650027
166600                                             TO ASC-BUYER-NBR-DESC16660027
166700                                                ASC-DEPT-NBR-DESC 16670027
166800              END-IF                                              16680027
166900                                                                  16690027
167000         WHEN DP003-BYR-NAME-NOT-FOUND                            16700027
167100             SET PS-EDIT-ERROR                                    16710027
167200                 DP020-MSG-FATAL        TO TRUE                   16720027
167300             MOVE PC-TSYMSG-00779       TO DP020-MSG-NUMBER       16730027
167400             MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA                16740027
167500             MOVE DP015-RED             TO ABUYERC                16750027
167600             MOVE DP015-REVERSE         TO ABUYERH                16760027
167700             MOVE -1                    TO ABUYERL                16770027
167800             MOVE 'INVALID DPT/BYR COMBO '                        16780027
167900                                        TO ASC-BUYER-NBR-DESC     16790027
168000         WHEN DP003-BYR-NAME-DB2-ERROR                            16800027
168100         WHEN DP003-BYR-NAME-MAX-RETRIES                          16810027
168200             MOVE '3100-BYR-DPT-CROSS-VALIDATE(B)'                16820027
168300                                    TO DP013-PARAGRAPH            16830027
168400             MOVE PV-CICS-RESPONSE  TO AM-CICS-CODE-7             16840027
168500             MOVE DP003-RETURN-MSG  TO DP013-MESSAGE-TEXT (1)     16850027
168600             MOVE DP003-DPT-INPUT   TO DP013-MESSAGE-TEXT (2)     16860027
168700             MOVE DP003-SQLCA       TO DP013-SQLCA                16870027
168800             MOVE 'TMDSEAR'         TO DP013-DB2-TABLE-NAME (1)   16880027
168900             MOVE 'TAPLAVL'         TO DP013-DB2-TABLE-NAME (2)   16890027
169000             MOVE 'TRSPBAR'         TO DP013-DB2-TABLE-NAME (3)   16900027
169100             SET DP013-DB2-ABEND    TO TRUE                       16910027
169200             SET DP013-NO-ROLLBACK  TO TRUE                       16920027
169300             PERFORM DP013-0000-PROCESS-ABEND                     16930027
169400         WHEN OTHER                                               16940027
169500             MOVE '3100-BYR-DPT-CROSS-VALIDATE(C)'                16950027
169600                                    TO DP013-PARAGRAPH            16960027
169700             MOVE DP003-RETURN-MSG  TO DP013-MESSAGE-TEXT (1)     16970027
169800             MOVE PV-CURRENT-DATE  TO DP013-MESSAGE-TEXT (2)      16980027
169900             MOVE DP003-SQLCA      TO DP013-SQLCA                 16990027
170000             SET DP013-OTHER-ABEND TO TRUE                        17000027
170100             SET DP013-NO-ROLLBACK TO TRUE                        17010027
170200             PERFORM DP013-0000-PROCESS-ABEND                     17020027
170300       END-EVALUATE.                                              17030027
170400                                                                  17040027
170500*                                                                 17050027
170600*----------------------------------------------------------------*17060027
170700*  VALIDATE THE DEPARTMENT NUMBER.                               *17070027
170800*----------------------------------------------------------------*17080027
170900 3110-VALIDATE-DEPARTMENT.                                        17090027
171000                                                                  17100027
171100     INITIALIZE DP003-MBS-SUBROUTINE-FIELDS.                      17110027
171200     SET DP003-DPT-LOOKUP              TO TRUE.                   17120027
171300     MOVE ASC-DEPT-NBR                 TO DP003-DPT-INPUT.        17130027
171400     MOVE PC-SYSTEM-CODE               TO DP003-SYSTEM-CODE.      17140027
171500     MOVE PC-KOHLS-OPERATING-COMPANY   TO DP003-OP-CO-NMBR.       17150027
171600     MOVE PV-CURRENT-DATE              TO DP003-CURRENT-DATE      17160027
171700                                          DP003-EFF-DATE.         17170027
171800     MOVE LENGTH OF DP003-MBS-SUBROUTINE-FIELDS                   17180027
171900                                       TO PV-COMMAREA-LENGTH.     17190027
172000                                                                  17200027
172100     EXEC CICS                                                    17210027
172200          LINK                                                    17220027
172300              PROGRAM   (PC-DPKUT038)                             17230027
172400              COMMAREA  (DP003-MBS-SUBROUTINE-FIELDS)             17240027
172500              LENGTH    (PV-COMMAREA-LENGTH)                      17250027
172600              RESP      (PV-CICS-RESPONSE)                        17260027
172700     END-EXEC.                                                    17270027
172800                                                                  17280027
172900     EVALUATE TRUE                                                17290027
173000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 17300027
173100             CONTINUE                                             17310027
173200         WHEN OTHER                                               17320027
173300             SET DP013-CICS-ABEND     TO TRUE                     17330027
173400             SET DP013-NO-ROLLBACK    TO TRUE                     17340027
173500             MOVE '3110-VALIDATE-DEPARTMENT(A)'                   17350027
173600                                      TO DP013-PARAGRAPH          17360027
173700             MOVE 'CANNOT LINK TO DPKUT038'                       17370027
173800                                      TO DP013-MESSAGE-TEXT (1)   17380027
173900             MOVE PV-CICS-RESPONSE    TO AM-CICS-CODE-7           17390027
174000             PERFORM DP013-0000-PROCESS-ABEND                     17400027
174100     END-EVALUATE.                                                17410027
174200                                                                  17420027
174300     EVALUATE TRUE                                                17430027
174400         WHEN DP003-SUCCESSFUL                                    17440027
174500              MOVE DP003-DPT-DESCRIPTION                          17450027
174600                                         TO ASC-DEPT-NBR-DESC     17460027
174700              SET PS-VALID-DEPT          TO TRUE                  17470027
174800         WHEN DP003-DPT-NOT-FOUND                                 17480027
174900              SET PS-EDIT-ERROR                                   17490027
175000                  DP020-MSG-FATAL        TO TRUE                  17500027
175100              MOVE PC-TSYMSG-00032       TO DP020-MSG-NUMBER      17510027
175200              MOVE DP015-UNP-ALP-BRT-OFF TO ADEPTA                17520027
175300              MOVE DP015-RED             TO ADEPTC                17530027
175400              MOVE DP015-REVERSE         TO ADEPTH                17540027
175500              MOVE -1                    TO ADEPTL                17550027
175600              MOVE 'DEPARTMENT NOT FOUND'                         17560027
175700                                         TO ASC-DEPT-NBR-DESC     17570027
175800              SET PS-INVALID-DEPT        TO TRUE                  17580027
175900         WHEN DP003-DPT-DB2-ERROR                                 17590027
176000         WHEN DP003-DPT-MAX-RETRIES                               17600027
176100             MOVE '3110-VALIDATE-DEPARTMENT(B)'                   17610027
176200                                    TO DP013-PARAGRAPH            17620027
176300             MOVE PV-CICS-RESPONSE  TO AM-CICS-CODE-7             17630027
176400             MOVE DP003-RETURN-MSG  TO DP013-MESSAGE-TEXT (1)     17640027
176500             MOVE DP003-DPT-INPUT   TO DP013-MESSAGE-TEXT (2)     17650027
176600             MOVE DP003-SQLCA       TO DP013-SQLCA                17660027
176700             MOVE 'TMDSEAR'         TO DP013-DB2-TABLE-NAME (1)   17670027
176800             MOVE 'TAPLAVL'         TO DP013-DB2-TABLE-NAME (2)   17680027
176900             MOVE 'TRSPBAR'         TO DP013-DB2-TABLE-NAME (3)   17690027
177000             SET DP013-DB2-ABEND    TO TRUE                       17700027
177100             SET DP013-NO-ROLLBACK  TO TRUE                       17710027
177200             PERFORM DP013-0000-PROCESS-ABEND                     17720027
177300         WHEN OTHER                                               17730027
177400             MOVE '3110-VALIDATE-DEPARTMENT(C)'                   17740027
177500                                    TO DP013-PARAGRAPH            17750027
177600             MOVE DP003-RETURN-MSG  TO DP013-MESSAGE-TEXT (1)     17760027
177700             MOVE DP003-DPT-INPUT  TO DP013-MESSAGE-TEXT (2)      17770027
177800             MOVE DP003-SQLCA      TO DP013-SQLCA                 17780027
177900             MOVE 'TMDSEAR'        TO DP013-DB2-TABLE-NAME (1)    17790027
178000             MOVE 'TAPLAVL'        TO DP013-DB2-TABLE-NAME (2)    17800027
178100             MOVE 'TRSPBAR'        TO DP013-DB2-TABLE-NAME (3)    17810027
178200             SET DP013-OTHER-ABEND TO TRUE                        17820027
178300             SET DP013-NO-ROLLBACK TO TRUE                        17830027
178400             PERFORM DP013-0000-PROCESS-ABEND                     17840027
178500       END-EVALUATE.                                              17850027
178600*                                                                 17860027
178700*                                                                 17870027
178800*----------------------------------------------------------------*17880027
178900*  VALIDATE THE BUYER NUMBER.                                    *17890027
179000*  BECAUSE WE ONLY HAVE THE BUYER NUMBER, WE CANNOT USE DPKUT039 *17900027
179100*  VALIDATION MUST COME FROM A SELECT DIRECTLY AGAINST DB2       *17910027
179200*----------------------------------------------------------------*17920027
179300 3120-VALIDATE-BUYER.                                             17930027
179400                                                                  17940027
179500                                                                  17950027
179600     EXEC SQL                                                     17960027
179700        SELECT DISTINCT                                           17970027
179800               WORKER_FIR_NAME                                    17980027
179900             , WORKER_LAST_NAME                                   17990027
180000        INTO                                                      18000027
180100               :RSPBAR-WORKER-FIR-NAME                            18010027
180200             , :RSPBAR-WORKER-LAST-NAME                           18020027
180300        FROM                                                      18030027
180400             TRSPBAR  C                                           18040027
180500           , TAPLAVL  B                                           18050027
180600           , TMDSEAR  A                                           18060027
180700        WHERE                                                     18070027
180800              C.RSPLVL_CDE = :PC-RSPLVL-CDE                       18080027
180900          AND C.OPERCO_NBR = :PC-KOHLS-OPERATING-COMPANY          18090027
181000          AND B.APLSYS_CDE = :PC-SYSTEM-CODE                      18100027
181100          AND A.MDSELV_CDE = :PC-MDSELV-CDE                       18110027
181200          AND A.BYR_NBR    = :DK-BUYER-NBR                        18120027
181300                                                                  18130027
181400          AND C.MDSEAR_DKEY = B.MDSEAR_DKEY                       18140027
181500          AND C.MDSEAR_DKEY = A.MDSEAR_DKEY                       18150027
181600                                                                  18160027
181700          AND CURRENT DATE                                        18170027
181800                       BETWEEN CHAR(C.WORKER_STRT_DTE,ISO)        18180027
181900                           AND CHAR(C.WORKER_END_DTE,ISO)         18190027
182000                                                                  18200027
182100          AND CURRENT DATE                                        18210027
182200                       BETWEEN CHAR(B.MDSEAR_STRT_DTE,ISO)        18220027
182300                           AND CHAR(B.MDSEAR_END_DTE,ISO)         18230027
182400                                                                  18240027
182500          AND CURRENT DATE                                        18250027
182600                       BETWEEN CHAR(STRT_DTE,ISO)                 18260027
182700                           AND CHAR(END_DTE,ISO)                  18270027
182800     END-EXEC.                                                    18280027
182900                                                                  18290027
183000     EVALUATE TRUE                                                18300027
183100         WHEN SQLCODE = +100                                      18310027
183200             SET PS-EDIT-ERROR                                    18320027
183300                 PS-INVALID-BUYER                                 18330027
183400                 DP020-MSG-FATAL        TO TRUE                   18340027
183500             MOVE PC-TSYMSG-00305       TO DP020-MSG-NUMBER       18350027
183600             MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA                18360027
183700             MOVE DP015-RED             TO ABUYERC                18370027
183800             MOVE DP015-REVERSE         TO ABUYERH                18380027
183900             MOVE -1                    TO ABUYERL                18390027
184000             MOVE 'BUYER NUMBER NOT FOUND'                        18400027
184100                                        TO ASC-BUYER-NBR-DESC     18410027
184200         WHEN SQLCODE = -811                                      18420027
184300             SET PS-EDIT-ERROR                                    18430027
184400                 DP020-MSG-FATAL        TO TRUE                   18440027
184500             MOVE PC-TSYMSG-00305       TO DP020-MSG-NUMBER       18450027
184600             MOVE DP015-UNP-ALP-BRT-OFF TO ABUYERA                18460027
184700             MOVE DP015-RED             TO ABUYERC                18470027
184800             MOVE DP015-REVERSE         TO ABUYERH                18480027
184900             MOVE -1                    TO ABUYERL                18490027
185000             MOVE 'DUP BUYER '                                    18500027
185100                                        TO ASC-BUYER-NBR-DESC     18510027
185200             SET PS-VALID-BUYER         TO TRUE                   18520027
185300         WHEN SQLCODE = +0                                        18530027
185400             STRING RSPBAR-WORKER-FIR-NAME  DELIMITED BY '  '     18540027
185500                    ', '                    DELIMITED BY SIZE     18550027
185600                    RSPBAR-WORKER-LAST-NAME DELIMITED BY SIZE     18560027
185700             INTO   ASC-BUYER-NBR-DESC                            18570027
185800             SET PS-VALID-BUYER         TO TRUE                   18580027
185900         WHEN SQLCODE < +0                                        18590027
186000         WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))         18600027
186100         WHEN SQLWARN0 NOT = SPACES                               18610027
186200              MOVE '3120-VALIDATE-BUYER'                          18620027
186300                               TO DP013-PARAGRAPH                 18630027
186400              MOVE 'SELECT BUYER NUMBER'                          18640027
186500                               TO DP013-MESSAGE-TEXT (1)          18650027
186600              STRING 'BUYER NUMBER USED ' DELIMITED BY SIZE       18660027
186700                      DK-BUYER-NBR        DELIMITED BY SIZE       18670027
186800                             INTO DP013-MESSAGE-TEXT (2)          18680027
186900              MOVE SQLCA       TO DP013-SQLCA                     18690027
187000              MOVE 'TRSPBAR '  TO DP013-DB2-TABLE-NAME (1)        18700027
187100              MOVE 'TAPLAVL '  TO DP013-DB2-TABLE-NAME (2)        18710027
187200              MOVE 'TMDSEAR '  TO DP013-DB2-TABLE-NAME (3)        18720027
187300              SET DP013-DB2-ABEND                                 18730027
187400                  DP013-XCTL-DISPLAY-RESTART                      18740027
187500                               TO TRUE                            18750027
187600              PERFORM DP013-0000-PROCESS-ABEND                    18760027
187700     END-EVALUATE.                                                18770027
187800                                                                  18780027
187900*                                                                 18790027
188000*                                                                 18800027
188100******************************************************************18810027
188200* 3200-VALIDATE-DATES - USES CALLED MODULE DPKUT500 TO VALIDATE   18820027
188300*     THE BEGIN AND END DATES.                                    18830027
188400******************************************************************18840027
188500 3200-VALIDATE-DATES.                                             18850027
188600                                                                  18860027
188700** VALIDATE THE END DATE TO ENSURE THAT IT IS IN A VALID DATE     18870027
188800** FORMAT.                                                        18880027
188900     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              18890027
189000                                                                  18900027
189100     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      18910027
189200                                                                  18920027
189300     SET DPG52-LK-DTE-GREG          TO TRUE.                      18930027
189400     MOVE ASC-END-MONTH             TO DPG52-GREG-DATE-MO-X.      18940027
189500     MOVE ASC-END-DAY               TO DPG52-GREG-DATE-DY-X.      18950027
189600     MOVE ASC-END-YEAR              TO DPG52-GREG-DATE-YR-X.      18960027
189700                                                                  18970027
189800     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    18980027
189900                                             DPG54 DPG55 DPG56.   18990027
190000                                                                  19000027
190100     IF  DPG54-NO-ERROR                                           19010027
190200         MOVE DPG55-DB2-ISO-DATE-FMT                              19020027
190300                                    TO JJ-END-DATE-C              19030027
190400                                       JJ-END-DATE                19040027
190500     ELSE                                                         19050027
190600         SET PS-EDIT-ERROR                                        19060027
190700             DP020-MSG-FATAL        TO TRUE                       19070027
190800         MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER           19080027
190900         MOVE DP015-UNP-ALP-BRT-OFF TO AEMONTHA                   19090027
191000                                       AEDAYA                     19100027
191100                                       AEYEARA                    19110027
191200         MOVE DP015-RED             TO AEMONTHC                   19120027
191300                                       AEDAYC                     19130027
191400                                       AEYEARC                    19140027
191500         MOVE DP015-REVERSE         TO AEMONTHH                   19150027
191600                                       AEDAYH                     19160027
191700                                       AEYEARH                    19170027
191800         MOVE -1                    TO AEMONTHL                   19180027
191900     END-IF.                                                      19190027
192000                                                                  19200027
192100** VALIDATE THE START DATE TO ENSURE THAT IT IS IN A VALID DATE   19210027
192200** FORMAT AND THAT IT IS LESS THAN THE END DATE.                  19220027
192300     INITIALIZE DPG51 DPG52 DPG53 DPG54 DPG55 DPG56.              19230027
192400                                                                  19240027
192500     SET DPG51-ACTUAL-CALENDAR-ONLY TO TRUE.                      19250027
192600                                                                  19260027
192700     SET DPG52-LK-DTE-GREG          TO TRUE.                      19270027
192800     MOVE ASC-STRT-MONTH            TO DPG52-GREG-DATE-MO-X.      19280027
192900     MOVE ASC-STRT-DAY              TO DPG52-GREG-DATE-DY-X.      19290027
193000     MOVE ASC-STRT-YEAR             TO DPG52-GREG-DATE-YR-X.      19300027
193100                                                                  19310027
193200     MOVE JJ-END-DATE-C             TO DPG53-DB2-ISO-DATE-FMT.    19320027
193300     SET DPG53-LK-CMPR-DTE-ISO-FMT  TO TRUE.                      19330027
193400                                                                  19340027
193500     CALL DP500-KOHLS-CALENDAR-ROUTINE USING DPG51 DPG52 DPG53    19350027
193600                                             DPG54 DPG55 DPG56.   19360027
193700                                                                  19370027
193800     EVALUATE TRUE                                                19380027
193900         WHEN DPG54-DATE-INVALID                                  19390027
194000             SET PS-EDIT-ERROR                                    19400027
194100                 DP020-MSG-FATAL        TO TRUE                   19410027
194200             MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER       19420027
194300             MOVE DP015-UNP-ALP-BRT-OFF TO ASMONTHA               19430027
194400                                           ASDAYA                 19440027
194500                                           ASYEARA                19450027
194600             MOVE DP015-RED             TO ASMONTHC               19460027
194700                                           ASDAYC                 19470027
194800                                           ASYEARC                19480027
194900             MOVE DP015-REVERSE         TO ASMONTHH               19490027
195000                                           ASDAYH                 19500027
195100                                           ASYEARH                19510027
195200             MOVE -1                    TO ASMONTHL               19520027
195300                                                                  19530027
195400         WHEN DPG54-CMPR-DATE-INVALID                             19540027
195500             SET PS-EDIT-ERROR                                    19550027
195600                 DP020-MSG-FATAL        TO TRUE                   19560027
195700             MOVE PC-TSYMSG-00009       TO DP020-MSG-NUMBER       19570027
195800             MOVE DP015-UNP-ALP-BRT-OFF TO AEMONTHA               19580027
195900                                           AEDAYA                 19590027
196000                                           AEYEARA                19600027
196100             MOVE DP015-RED             TO AEMONTHC               19610027
196200                                           AEDAYC                 19620027
196300                                           AEYEARC                19630027
196400             MOVE DP015-REVERSE         TO AEMONTHH               19640027
196500                                           AEDAYH                 19650027
196600                                           AEYEARH                19660027
196700             MOVE -1                    TO AEMONTHL               19670027
196800                                                                  19680027
196900         WHEN DPG55-DAYS-DIFFERENCE >= ZERO                       19690027
197000             SET PS-EDIT-ERROR                                    19700027
197100                 DP020-MSG-FATAL        TO TRUE                   19710027
197200             MOVE PC-TSYMSG-00107       TO DP020-MSG-NUMBER       19720027
197300             MOVE DP015-UNP-ALP-BRT-OFF TO ASMONTHA               19730027
197400                                           ASDAYA                 19740027
197500                                           ASYEARA                19750027
197600                                           AEMONTHA               19760027
197700                                           AEDAYA                 19770027
197800                                           AEYEARA                19780027
197900             MOVE DP015-RED             TO ASMONTHC               19790027
198000                                           ASDAYC                 19800027
198100                                           ASYEARC                19810027
198200                                           AEMONTHC               19820027
198300                                           AEDAYC                 19830027
198400                                           AEYEARC                19840027
198500             MOVE DP015-REVERSE         TO ASMONTHH               19850027
198600                                           ASDAYH                 19860027
198700                                           ASYEARH                19870027
198800             MOVE DP015-REVERSE         TO AEMONTHH               19880027
198900                                           AEDAYH                 19890027
199000                                           AEYEARH                19900027
199100             MOVE -1                    TO ASMONTHL               19910027
199200                                                                  19920027
199300         WHEN DPG54-NO-ERROR                                      19930027
199400              MOVE DPG55-DB2-ISO-DATE-FMT                         19940027
199500                               TO JJ-START-DATE-C                 19950027
199600                                  JJ-START-DATE                   19960027
199700                                                                  19970027
199800         WHEN OTHER                                               19980027
199900              MOVE '3200-VALIDATE-DATES'                          19990027
200000                               TO DP013-PARAGRAPH                 20000027
200100              MOVE DPG54-ERROR-MESSAGE                            20010027
200200                               TO DP013-MESSAGE-TEXT (1)          20020027
200300              SET DP013-OTHER-ABEND                               20030027
200400                  DP013-XCTL-DISPLAY-RESTART                      20040027
200500                               TO TRUE                            20050027
200600              PERFORM DP013-0000-PROCESS-ABEND                    20060027
200700                                                                  20070027
200800     END-EVALUATE.                                                20080027
200900*                                                                 20090027
201000*                                                                 20100027
201100*----------------------------------------------------------------*20110027
201200*  VALIDATE THE VENDOR DUNS NUMBER TO MAKE SURE IT IS A VALID    *20120027
201300*  VENDOR NUMBER.                                                *20130027
201400*----------------------------------------------------------------*20140027
201500 3300-VALIDATE-VENDOR.                                            20150027
201600                                                                  20160027
201700     EXEC SQL                                                     20170027
201800         SELECT                                                   20180027
201900                ENT_NAME_DESC                                     20190027
202000         INTO                                                     20200027
202100               :ENTNME-ENT-NAME-DESC                              20210027
202200         FROM                                                     20220027
202300             TEXTENT A                                            20230027
202400           , TENTNME B                                            20240027
202500         WHERE                                                    20250027
202600               A.DUN_NBR = :DK-VND-NBR                            20260027
202700           AND A.ENT_ID = B.ENT_ID                                20270027
202800           AND B.TYPE_CDE = '01'                                  20280027
202900     END-EXEC.                                                    20290027
203000                                                                  20300027
203100     EVALUATE TRUE                                                20310027
203200         WHEN SQLCODE = +0                                        20320027
203300             MOVE ENTNME-ENT-NAME-DESC  TO ASC-VND-NBR-DESC       20330027
203400             SET PS-VALID-VENDOR        TO TRUE                   20340027
203500         WHEN SQLCODE = +100                                      20350027
203600             SET PS-EDIT-ERROR                                    20360027
203700                 PS-INVALID-VENDOR                                20370027
203800                 DP020-MSG-FATAL        TO TRUE                   20380027
203900             MOVE PC-TSYMSG-00608       TO DP020-MSG-NUMBER       20390027
204000             MOVE DP015-UNP-ALP-BRT-OFF TO AVENDORA               20400027
204100             MOVE DP015-RED             TO AVENDORC               20410027
204200             MOVE DP015-REVERSE         TO AVENDORH               20420027
204300             MOVE -1                    TO AVENDORL               20430027
204400             MOVE 'VENDOR NUMBER NOT FOUND'                       20440027
204500                                        TO ASC-VND-NBR-DESC       20450027
204600         WHEN SQLCODE = +0                                        20460027
204700             MOVE ENTNME-ENT-NAME-DESC  TO ASC-VND-NBR-DESC       20470027
204800             SET PS-VALID-VENDOR        TO TRUE                   20480027
204900         WHEN SQLCODE < +0                                        20490027
205000         WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))         20500027
205100         WHEN SQLWARN0 NOT = SPACES                               20510027
205200              MOVE '3300-VALIDATE-VENDOR'                         20520027
205300                               TO DP013-PARAGRAPH                 20530027
205400              MOVE 'SELECT VENDOR NUMBER'                         20540027
205500                               TO DP013-MESSAGE-TEXT (1)          20550027
205600              STRING 'VENDOR NUMBER USED ' DELIMITED BY SIZE      20560027
205700                      DK-VND-NBR           DELIMITED BY SIZE      20570027
205800                             INTO DP013-MESSAGE-TEXT (2)          20580027
205900              MOVE SQLCA       TO DP013-SQLCA                     20590027
206000              MOVE 'TEXTENT '  TO DP013-DB2-TABLE-NAME (1)        20600027
206100              MOVE 'TENTNME '  TO DP013-DB2-TABLE-NAME (2)        20610027
206200              SET DP013-DB2-ABEND                                 20620027
206300                  DP013-XCTL-DISPLAY-RESTART                      20630027
206400                               TO TRUE                            20640027
206500              PERFORM DP013-0000-PROCESS-ABEND                    20650027
206600     END-EVALUATE.                                                20660027
206700                                                                  20670027
206800*                                                                 20680027
206900*                                                                 20690027
207000*----------------------------------------------------------------*20700027
207100*  VALIDATE THAT THE VENDOR NUMBER AND DEPARTMENT NUMBER ARE A   *20710027
207200*  VALID COMBINATION.                                            *20720027
207300*----------------------------------------------------------------*20730027
207400 3310-VND-DEPT-CROSS-VALIDATION.                                  20740027
207500                                                                  20750027
207600     EXEC SQL                                                     20760027
207700         SELECT                                                   20770027
207800              A.DUN_NBR                                           20780027
207900            , B.DEPT_NBR                                          20790027
208000         INTO                                                     20800027
208100               :EXTENT-DUN-NBR                                    20810027
208200            ,  :VNDDPT-DEPT-NBR                                   20820027
208300         FROM                                                     20830027
208400             TEXTENT A                                            20840027
208500           , TVNDDPT B                                            20850027
208600         WHERE                                                    20860027
208700               A.DUN_NBR = :DK-VND-NBR                            20870027
208800           AND B.DEPT_NBR = :DK-DEPT-NBR                          20880027
208900           AND A.ENT_ID = B.ENT_ID                                20890027
209000     END-EXEC.                                                    20900027
209100                                                                  20910027
209200     EVALUATE TRUE                                                20920027
209300         WHEN SQLCODE = +100                                      20930027
209400             SET PS-EDIT-ERROR                                    20940027
209500                 DP020-MSG-FATAL        TO TRUE                   20950027
209600             MOVE PC-TSYMSG-00995       TO DP020-MSG-NUMBER       20960027
209700             MOVE DP015-UNP-ALP-BRT-OFF TO AVENDORA               20970027
209800                                           ADEPTA                 20980027
209900             MOVE DP015-RED             TO AVENDORC               20990027
210000                                           ADEPTC                 21000027
210100             MOVE DP015-REVERSE         TO AVENDORH               21010027
210200                                           ADEPTH                 21020027
210300             MOVE -1                    TO AVENDORL               21030027
210400                                           ADEPTL                 21040027
210500             MOVE 'INVALID VND/DEPT COMBO '                       21050027
210600                                        TO ASC-VND-NBR-DESC       21060027
210700                                           ASC-DEPT-NBR-DESC      21070027
210800         WHEN SQLCODE = -811                                      21080027
210900         WHEN SQLCODE = +0                                        21090027
211000             CONTINUE                                             21100027
211100         WHEN SQLCODE < +0                                        21110027
211200         WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))         21120027
211300         WHEN SQLWARN0 NOT = SPACES                               21130027
211400              MOVE '3310-VND-DPT-CROSS-VALIDATION'                21140027
211500                               TO DP013-PARAGRAPH                 21150027
211600              MOVE 'SELECT DEPT/VENDOR NUMBER'                    21160027
211700                               TO DP013-MESSAGE-TEXT (1)          21170027
211800              STRING 'BUYER NUMBER USED ' DELIMITED BY SIZE       21180027
211900                      DK-BUYER-NBR        DELIMITED BY SIZE       21190027
212000                             INTO DP013-MESSAGE-TEXT (2)          21200027
212100              STRING 'VENDOR NUMBER USED ' DELIMITED BY SIZE      21210027
212200                      DK-VND-NBR           DELIMITED BY SIZE      21220027
212300                             INTO DP013-MESSAGE-TEXT (3)          21230027
212400              MOVE SQLCA       TO DP013-SQLCA                     21240027
212500              MOVE 'TEXTENT '  TO DP013-DB2-TABLE-NAME (1)        21250027
212600              MOVE 'TVNDDPT '  TO DP013-DB2-TABLE-NAME (2)        21260027
212700              SET DP013-DB2-ABEND                                 21270027
212800                  DP013-XCTL-DISPLAY-RESTART                      21280027
212900                               TO TRUE                            21290027
213000              PERFORM DP013-0000-PROCESS-ABEND                    21300027
213100     END-EVALUATE.                                                21310027
213200                                                                  21320027
213300*                                                                 21330027
213400*                                                                 21340027
213500*----------------------------------------------------------------*21350027
213600*  SQL CALL TO OPERATING UNIT ID HAS BEEN CHANGED TO RTV LOC NBR.*21360027
213700*  VALIDATE THE RTV LOC NBR TO MAKE SURE THAT IT IS A VALID      *21370027
213800*  DISTRIBUTION CENTER.                                          *21380027
213900*----------------------------------------------------------------*21390027
214000 3400-VALIDATE-OPER-UNT-ID.                                       21400027
214100                                                                  21410027
214200     INITIALIZE DCLXLT00010                                       21420027
214300                DCLXLT00014.                                      21430027
214400                                                                  21440027
214500     PERFORM                                                      21450027
214600         WITH TEST AFTER                                          21460027
214700         VARYING PV-SQL-SUB                                       21470027
214800         FROM 1 BY 1                                              21480027
214900         UNTIL  (PV-SQL-SUB > PC-MAX-RETRIES                      21490027
215000            OR   SQLCODE = +0                                     21500027
215100            OR   SQLCODE = +100)                                  21510027
215200                                                                  21520027
215300         EXEC SQL                                                 21530027
215400             SELECT B.LOC_NBR                                     21540027
215500                  , B.LOC_NM                                      21550027
215600                  , A.DC_NBR                                      21560027
215700              INTO :XLT00010-LOC-NBR                              21570027
215800                 , :XLT00010-LOC-NM                               21580027
215900                 , :XLT00014-DC-NBR                               21590027
216000              FROM  XLT_DC_LOC_ASGMT A                            21600027
216100                  , XLT_LOC          B                            21610027
216200              WHERE A.LOC_NBR = :DK-RTV-LOC-NBR                   21620027
216300                AND A.LOC_NBR = B.LOC_NBR                         21630027
216400                AND B.LOC_TYP_CDE = 'RV'                          21640027
216500                AND (CHAR(CURRENT_DATE, ISO)                      21650027
216600                      BETWEEN                                     21660027
216700                      CHAR(B.OPN_DTE,ISO)                         21670027
216800                          AND                                     21680027
216900                      CHAR(B.CLO_DTE,ISO))                        21690027
217000         END-EXEC                                                 21700027
217100                                                                  21710027
217200         EVALUATE TRUE                                            21720027
217300             WHEN SQLCODE = -904                                  21730027
217400             WHEN SQLCODE = -913                                  21740027
217500                 CONTINUE                                         21750027
217600             WHEN SQLCODE = +100                                  21760027
217700                 SET PS-INVALID-OPER        TO TRUE               21770027
217800*                MOVE 'INVALID OPER UNT ID' TO AOPDESCI           21780027
217900                 MOVE 'INVALID RTV LOCATION' TO AOPDESCI          21790027
218000                                       ASC-OPER-UNT-ID-DESC       21800027
218100             WHEN SQLCODE = +0                                    21810027
218200                 MOVE XLT00010-LOC-NM       TO AOPDESCI           21820027
218300                                       ASC-OPER-UNT-ID-DESC       21830027
218400             WHEN SQLCODE < +0                                    21840027
218500             WHEN ((SQLCODE > ZERO) AND (SQLCODE NOT = +100))     21850027
218600             WHEN SQLWARN0 NOT = SPACES                           21860027
218700                  MOVE '3400-VALIDATE-OPER-UNT-ID'                21870027
218800                                   TO DP013-PARAGRAPH             21880027
218900*                 MOVE 'SELECT OPERATING UNIT ID'                 21890027
219000                  MOVE 'SELECT RTV LOCATION '                     21900027
219100                                   TO DP013-MESSAGE-TEXT (1)      21910027
219200                  MOVE SQLCA       TO DP013-SQLCA                 21920027
219300                  MOVE 'XLT_LOC '  TO DP013-DB2-TABLE-NAME (1)    21930027
219400                  MOVE 'XLT_DC_LOC_ASGMT'                         21940027
219500                                   TO DP013-DB2-TABLE-NAME (2)    21950027
219600                  SET DP013-DB2-ABEND                             21960027
219700                      DP013-XCTL-DISPLAY-RESTART                  21970027
219800                                   TO TRUE                        21980027
219900                  PERFORM DP013-0000-PROCESS-ABEND                21990027
220000         END-EVALUATE                                             22000027
220100     END-PERFORM.                                                 22010027
220200                                                                  22020027
220300     IF  PV-SQL-SUB GREATER THAN PC-MAX-RETRIES                   22030027
220400         MOVE '3400-VALIDATE-OPER-UNT-ID'                         22040027
220500                               TO  DP013-PARAGRAPH                22050027
220600         MOVE 'MAX RETRIES EXCEEDED FOR SELECT'                   22060027
220700                               TO  DP013-MESSAGE-TEXT (1)         22070027
220800*        MOVE 'OF AN OPERATING UNIT ID        '                   22080027
220900         MOVE 'OF AN RTV LOCATION             '                   22090027
221000                               TO  DP013-MESSAGE-TEXT (2)         22100027
221100         MOVE SQLCA            TO  DP013-SQLCA                    22110027
221200         MOVE 'XLT_LOC '       TO DP013-DB2-TABLE-NAME (1)        22120027
221300         MOVE 'XLT_DC_LOC_ASGMT' TO DP013-DB2-TABLE-NAME (2)      22130027
221400         SET DP013-DB2-ABEND                                      22140027
221500             DP013-XCTL-DISPLAY-RESTART                           22150027
221600                               TO  TRUE                           22160027
221700         PERFORM DP013-0000-PROCESS-ABEND                         22170027
221800     END-IF.                                                      22180027
221900     EJECT                                                        22190027
222000                                                                  22200027
222100*----------------------------------------------------------------*22210027
222200*  POSITION THE CURSOR AT THE APPROPRIATE FIELD.                 *22220027
222300*  IF THERE IS ANY DATA TO MOVE TO THE SCREEN ON INITIAL, MOVE   *22230027
222400*  IT HERE.                                                      *22240027
222500*----------------------------------------------------------------*22250027
222600 4000-BUILD-INITIAL-PANEL.                                        22260027
222700                                                                  22270027
222800*    MOVE -1                       TO ASMONTHL.                   22280027
222900     MOVE -1                       TO AOPUIDL.                    22290027
223000                                                                  22300027
223100     MOVE ASC-OPER-UNT-ID-N        TO AOPUIDO                     22310027
223200                                      DK-RTV-LOC-NBR.             22320027
223300*                                     DK-OPER-UNT-ID.             22330027
223400                                                                  22340027
223500*    PERFORM 3400-VALIDATE-OPER-UNT-ID.                           22350027
223600                                                                  22360027
223700     PERFORM 4010-GET-DATE-TIME.                                  22370027
223800                                                                  22380027
223900*    READ TKRPRPM FOR DB2 CURRENT DATE. USE TKRPRPM DATE IF FOUND.22390027
224000     PERFORM 4025-SELECT-TKRPRPM-DATE.                            22400027
224100                                                                  22410027
224200*    IF TKRPRPM RETURNS CURRENT DATE, POPULATE START AND END DATES22420027
224300*    WITH AN AUTOMATIC DATE RANGE.                                22430027
224400     IF PS-TKRPRPM-FOUND                                          22440027
224500         MOVE PV-LESS2WK-DATE-MM   TO ASC-STRT-MONTH              22450027
224600                                      ASMONTHI                    22460027
224700         MOVE PV-CURRENT-DB2-DTE-MM                               22470027
224800                                   TO ASC-END-MONTH               22480027
224900                                      PV-CURRENT-DATE-MM          22490027
225000                                      AEMONTHI                    22500027
225100         MOVE PV-LESS2WK-DATE-DD   TO ASC-STRT-DAY                22510027
225200                                      ASDAYI                      22520027
225300         MOVE PV-CURRENT-DB2-DTE-DD                               22530027
225400                                   TO ASC-END-DAY                 22540027
225500                                      PV-CURRENT-DATE-DD          22550027
225600                                      AEDAYI                      22560027
225700         MOVE PV-LESS2WK-DATE-YY   TO ASC-STRT-YEAR               22570027
225800                                      ASYEARI                     22580027
225900         MOVE PV-CURRENT-DB2-DTE-YY                               22590027
226000                                   TO ASC-END-YEAR                22600027
226100                                      PV-CURRENT-DATE-YY          22610027
226200                                      AEYEARI                     22620027
226300     ELSE                                                         22630027
226400     IF PS-TKRPRPM-NOT-FOUND                                      22640027
226500         MOVE PV-DATE-MM           TO ASC-END-MONTH               22650027
226600                                      PV-CURRENT-DATE-MM          22660027
226700                                      AEMONTHI                    22670027
226800         MOVE PV-DATE-DD           TO ASC-END-DAY                 22680027
226900                                      PV-CURRENT-DATE-DD          22690027
227000                                      AEDAYI                      22700027
227100         MOVE PV-DATE-YY           TO ASC-END-YEAR                22710027
227200                                      PV-CURRENT-DATE-YY          22720027
227300                                      AEYEARI                     22730027
227400                                      ASC-STRT-YEAR               22740027
227500                                      ASYEARI                     22750027
227600     END-IF                                                       22760027
227700     END-IF.                                                      22770027
227800                                                                  22780027
227900*    MOVE PV-DATE-MM               TO ASC-END-MONTH               22790027
228000*                                     PV-CURRENT-DATE-MM          22800027
228100*                                     AEMONTHI.                   22810027
228200*    MOVE PV-DATE-DD               TO ASC-END-DAY                 22820027
228300*                                     PV-CURRENT-DATE-DD          22830027
228400*                                     AEDAYI.                     22840027
228500*    MOVE PV-DATE-YY               TO ASC-END-YEAR                22850027
228600*                                     PV-CURRENT-DATE-YY          22860027
228700*                                     AEYEARI                     22870027
228800*                                     ASC-STRT-YEAR               22880027
228900*                                     ASYEARI.                    22890027
229000                                                                  22900027
229100     MOVE +1                       TO ASC-RPT-COPY                22910027
229200                                      ARPTCPYI.                   22920027
229300                                                                  22930027
229400     MOVE 'S'                      TO ASC-REPORT-TYPE             22940027
229500                                      ARPTTYPI.                   22950027
229600     MOVE 'SUMMARY REPORT ONLY       '                            22960027
229700                                   TO ASC-REPORT-TYPE-DESC        22970027
229800                                      ARTDESCI.                   22980027
229900                                                                  22990027
230000     MOVE '*************'          TO ALTYPEI                     23000027
230100                                      ASC-LIST-TYPE               23010027
230200                                      ALSTATI                     23020027
230300                                      ASC-LIST-STATUS             23030027
230400                                      ALOCI                       23040027
230500                                      ASC-LOCATION                23050027
230600                                      ABUYERI                     23060027
230700                                      ASC-BUYER-NBR               23070027
230800                                      ADEPTI                      23080027
230900                                      ASC-DEPT-NBR                23090027
231000                                      AVENDORI                    23100027
231100                                      ASC-VND-NBR.                23110027
231200                                                                  23120027
231300     MOVE 'ALL'                    TO ALTDESCI                    23130027
231400                                      ASC-LIST-TYPE-DESC          23140027
231500                                      ALSDESCI                    23150027
231600                                      ASC-LIST-STATUS-DESC        23160027
231700                                      ABYRDESI                    23170027
231800                                      ASC-BUYER-NBR-DESC          23180027
231900                                      ADPTDESI                    23190027
232000                                      ASC-DEPT-NBR-DESC           23200027
232100                                      AVNDDESI                    23210027
232200                                      ASC-VND-NBR-DESC.           23220027
232300                                                                  23230027
232400*                                                                 23240027
232500*----------------------------------------------------------------*23250027
232600*    GET THE CURRENT DATE AND TIME.                              *23260027
232700*----------------------------------------------------------------*23270027
232800 4010-GET-DATE-TIME.                                              23280027
232900                                                                  23290027
233000     EXEC CICS                                                    23300027
233100               ASKTIME                                            23310027
233200               ABSTIME(PV-ABS-TIME)                               23320027
233300     END-EXEC.                                                    23330027
233400                                                                  23340027
233500     EXEC CICS FORMATTIME                                         23350027
233600                 ABSTIME(PV-ABS-TIME)                             23360027
233700                 MMDDYY(PV-DATE)                                  23370027
233800                 DATESEP                                          23380027
233900                 TIME(PV-TIME)                                    23390027
234000                 TIMESEP                                          23400027
234100     END-EXEC.                                                    23410027
234200                                                                  23420027
234300*----------------------------------------------------------------*23430027
234400*    GET THE CURRENT DATES FROM DB2.                             *23440027
234500*----------------------------------------------------------------*23450027
234600 4025-SELECT-TKRPRPM-DATE.                                        23460027
234700                                                                  23470027
234800     SET PS-TKRPRPM-FOUND TO TRUE.                                23480027
234900                                                                  23490027
235000     EXEC SQL                                                     23500027
235100         SELECT CURRENT DATE                                      23510027
235200              , CURRENT DATE - FUNC_QTY DAYS                      23520027
235300           INTO :PV-CURRENT-DB2-DATE                              23530027
235400              , :PV-LESS2WK-DATE                                  23540027
235500           FROM TKRPRPM                                           23550027
235600          WHERE LOC_ID           = 90                             23560027
235700            AND INTFC_SYS_CDE    = 'KHL'                          23570027
235800            AND SYS_PRC_FUNC_CDE = 'CSDAYS'                       23580028
235900     END-EXEC.                                                    23590027
236000                                                                  23600027
236100     EVALUATE TRUE                                                23610027
236200         WHEN SQLCODE NOT = +0                                    23620027
236300              SET PS-TKRPRPM-NOT-FOUND TO TRUE                    23630027
236400     END-EVALUATE.                                                23640027
236500                                                                  23650027
236600******************************************************************23660027
236700** MOVE THE DEFAULT ATTRIBUTES TO ALL OF THE OPEN FIELDS ON THE **23670027
236800** MAP.                                                         **23680027
236900******************************************************************23690027
237000 4100-RESET-ATTRIBUTES.                                           23700027
237100                                                                  23710027
237200     MOVE DP015-UNP-ALP-NOR-OFF    TO AOPUIDA                     23720027
237300                                      ASMONTHA                    23730027
237400                                      ASDAYA                      23740027
237500                                      ASYEARA                     23750027
237600                                      AEMONTHA                    23760027
237700                                      AEDAYA                      23770027
237800                                      AEYEARA                     23780027
237900                                      ADESTA                      23790027
238000                                      ARPTCPYA                    23800027
238100                                      ALTYPEA                     23810027
238200                                      ALSTATA                     23820027
238300                                      ALOCA                       23830027
238400                                      ABUYERA                     23840027
238500                                      ADEPTA                      23850027
238600                                      AVENDORA.                   23860027
238700                                                                  23870027
238800     MOVE DP015-GREEN              TO AOPUIDC                     23880027
238900                                      ASMONTHC                    23890027
239000                                      ASDAYC                      23900027
239100                                      ASYEARC                     23910027
239200                                      AEMONTHC                    23920027
239300                                      AEDAYC                      23930027
239400                                      AEYEARC                     23940027
239500                                      ADESTC                      23950027
239600                                      ARPTCPYC                    23960027
239700                                      ALTYPEC                     23970027
239800                                      ALSTATC                     23980027
239900                                      ALOCC                       23990027
240000                                      ABUYERC                     24000027
240100                                      ADEPTC                      24010027
240200                                      AVENDORC.                   24020027
240300                                                                  24030027
240400     MOVE DP015-UNDERLINE          TO AOPUIDH                     24040027
240500                                      ASMONTHH                    24050027
240600                                      ASDAYH                      24060027
240700                                      ASYEARH                     24070027
240800                                      AEMONTHH                    24080027
240900                                      AEDAYH                      24090027
241000                                      AEYEARH                     24100027
241100                                      ADESTH                      24110027
241200                                      ARPTCPYH                    24120027
241300                                      ALTYPEH                     24130027
241400                                      ALSTATH                     24140027
241500                                      ALOCH                       24150027
241600                                      ABUYERH                     24160027
241700                                      ADEPTH                      24170027
241800                                      AVENDORH.                   24180027
241900*                                                                 24190027
242000*                                                                 24200027
242100*----------------------------------------------------------------*24210027
242200*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *24220027
242300*----------------------------------------------------------------*24230027
242400 4400-MOVE-COMMAREA-TO-SCREEN.                                    24240027
242500                                                                  24250027
242600     IF  ASC-OPER-UNT-ID NOT NUMERIC                              24260027
242700         IF  ASC-OPER-UNT-ID = SPACES                             24270027
242800             MOVE ZEROES           TO AOPUIDO                     24280027
242900         ELSE                                                     24290027
243000             MOVE ASC-OPER-UNT-ID  TO AOPUIDO                     24300027
243100         END-IF                                                   24310027
243200     ELSE                                                         24320027
243300         MOVE ASC-OPER-UNT-ID      TO AOPUIDO                     24330027
243400     END-IF.                                                      24340027
243500                                                                  24350027
243600     MOVE ASC-OPER-UNT-ID-DESC     TO AOPDESCO.                   24360027
243700                                                                  24370027
243800     IF  ASC-STRT-MONTH NOT NUMERIC                               24380027
243900         IF  ASC-STRT-MONTH = SPACES                              24390027
244000             MOVE ZEROES           TO ASMONTHO                    24400027
244100         ELSE                                                     24410027
244200             MOVE ASC-STRT-MONTH-N TO ASMONTHO                    24420027
244300         END-IF                                                   24430027
244400     ELSE                                                         24440027
244500         MOVE ASC-STRT-MONTH       TO ASMONTHO                    24450027
244600     END-IF.                                                      24460027
244700                                                                  24470027
244800     IF  ASC-STRT-DAY    NOT NUMERIC                              24480027
244900         IF  ASC-STRT-DAY    = SPACES                             24490027
245000             MOVE ZEROES           TO ASDAYO                      24500027
245100         ELSE                                                     24510027
245200             MOVE ASC-STRT-DAY-N   TO ASDAYO                      24520027
245300         END-IF                                                   24530027
245400     ELSE                                                         24540027
245500         MOVE ASC-STRT-DAY         TO ASDAYO                      24550027
245600     END-IF.                                                      24560027
245700                                                                  24570027
245800     IF  ASC-STRT-YEAR   NOT NUMERIC                              24580027
245900         IF  ASC-STRT-YEAR   = SPACES                             24590027
246000             MOVE ZEROES           TO ASYEARO                     24600027
246100         ELSE                                                     24610027
246200             MOVE ASC-STRT-YEAR-N  TO ASYEARO                     24620027
246300         END-IF                                                   24630027
246400     ELSE                                                         24640027
246500         MOVE ASC-STRT-YEAR        TO ASYEARO                     24650027
246600     END-IF.                                                      24660027
246700                                                                  24670027
246800     IF  ASC-END-MONTH   NOT NUMERIC                              24680027
246900         IF  ASC-END-MONTH   = SPACES                             24690027
247000             MOVE ZEROES           TO AEMONTHO                    24700027
247100         ELSE                                                     24710027
247200             MOVE ASC-END-MONTH-N  TO AEMONTHO                    24720027
247300         END-IF                                                   24730027
247400     ELSE                                                         24740027
247500         MOVE ASC-END-MONTH        TO AEMONTHO                    24750027
247600     END-IF.                                                      24760027
247700                                                                  24770027
247800     IF  ASC-END-DAY     NOT NUMERIC                              24780027
247900         IF  ASC-END-DAY     = SPACES                             24790027
248000             MOVE ZEROES           TO AEDAYO                      24800027
248100         ELSE                                                     24810027
248200             MOVE ASC-END-DAY-N    TO AEDAYO                      24820027
248300         END-IF                                                   24830027
248400     ELSE                                                         24840027
248500         MOVE ASC-END-DAY          TO AEDAYO                      24850027
248600     END-IF.                                                      24860027
248700                                                                  24870027
248800     IF  ASC-END-YEAR    NOT NUMERIC                              24880027
248900         IF  ASC-END-YEAR    = SPACES                             24890027
249000             MOVE ZEROES           TO AEYEARO                     24900027
249100         ELSE                                                     24910027
249200             MOVE ASC-END-YEAR-N   TO AEYEARO                     24920027
249300         END-IF                                                   24930027
249400     ELSE                                                         24940027
249500         MOVE ASC-END-YEAR         TO AEYEARO                     24950027
249600     END-IF.                                                      24960027
249700                                                                  24970027
249800     IF  ASC-RPT-COPY    NOT NUMERIC                              24980027
249900         IF  ASC-RPT-COPY    = SPACES                             24990027
250000             MOVE ZEROES           TO ARPTCPYO                    25000027
250100         ELSE                                                     25010027
250200             MOVE ASC-RPT-COPY     TO ARPTCPYO                    25020027
250300         END-IF                                                   25030027
250400     ELSE                                                         25040027
250500         MOVE ASC-RPT-COPY         TO ARPTCPYO                    25050027
250600     END-IF.                                                      25060027
250700                                                                  25070027
250800     MOVE ASC-PRINT-DEST           TO ADESTO.                     25080027
250900                                                                  25090027
251000     MOVE ASC-REPORT-TYPE          TO ARPTTYPO.                   25100027
251100                                                                  25110027
251200     MOVE ASC-REPORT-TYPE-DESC     TO ARTDESCO.                   25120027
251300                                                                  25130027
251400     MOVE ASC-LIST-TYPE            TO ALTYPEO.                    25140027
251500                                                                  25150027
251600     MOVE ASC-LIST-TYPE-DESC       TO ALTDESCO.                   25160027
251700                                                                  25170027
251800     MOVE ASC-LIST-STATUS          TO ALSTATO.                    25180027
251900                                                                  25190027
252000     MOVE ASC-LIST-STATUS-DESC     TO ALSDESCO.                   25200027
252100                                                                  25210027
252200     MOVE ASC-LOCATION             TO ALOCO.                      25220027
252300                                                                  25230027
252400     IF  ASC-BUYER-NBR   NOT NUMERIC                              25240027
252500         IF  ASC-BUYER-NBR   = SPACES                             25250027
252600             MOVE ZEROES           TO ABUYERO                     25260027
252700         ELSE                                                     25270027
252800             MOVE ASC-BUYER-NBR-N  TO ABUYERO                     25280027
252900         END-IF                                                   25290027
253000     ELSE                                                         25300027
253100         MOVE ASC-BUYER-NBR        TO ABUYERO                     25310027
253200     END-IF.                                                      25320027
253300                                                                  25330027
253400     MOVE ASC-BUYER-NBR-DESC       TO ABYRDESO.                   25340027
253500                                                                  25350027
253600     IF  ASC-DEPT-NBR    NOT NUMERIC                              25360027
253700         IF  ASC-DEPT-NBR    = SPACES                             25370027
253800             MOVE ZEROES           TO ADEPTO                      25380027
253900         ELSE                                                     25390027
254000             MOVE ASC-DEPT-NBR-N   TO ADEPTO                      25400027
254100         END-IF                                                   25410027
254200     ELSE                                                         25420027
254300         MOVE ASC-DEPT-NBR         TO ADEPTO                      25430027
254400     END-IF.                                                      25440027
254500                                                                  25450027
254600     MOVE ASC-DEPT-NBR-DESC        TO ADPTDESO.                   25460027
254700                                                                  25470027
254800     IF  ASC-VND-NBR     NOT NUMERIC                              25480027
254900         IF  ASC-VND-NBR     = SPACES                             25490027
255000             MOVE ZEROES           TO AVENDORO                    25500027
255100         ELSE                                                     25510027
255200             MOVE ASC-VND-NBR-N    TO AVENDORO                    25520027
255300         END-IF                                                   25530027
255400     ELSE                                                         25540027
255500         MOVE ASC-VND-NBR          TO AVENDORO                    25550027
255600     END-IF.                                                      25560027
255700                                                                  25570027
255800     MOVE ASC-VND-NBR-DESC         TO AVNDDESO.                   25580027
255900 EJECT                                                            25590027
256000                                                                  25600027
256100***************************************************************** 25610027
256200** THIS PARAGRAPH FORMATS A RTV INVENTORY REPORT JOB           ** 25620027
256300** AND WRITES IT TO THE INTERNAL READER.                       ** 25630027
256400***************************************************************** 25640027
256500 5000-CREATE-PRINT-JOB.                                           25650027
256600                                                                  25660027
256700     PERFORM 5010-MOVE-CONTROL-CARD.                              25670027
256800                                                                  25680027
256900     SET  PS-NO-TD-ERROR           TO TRUE.                       25690027
257000                                                                  25700027
257100     PERFORM 9500-ENQUEUE-INTERNAL-READER.                        25710027
257200****************************************************************  25720027
257300*    USE LINES BELOW FOR TESTING                                  25730027
257400*              COMMENT OUT BEFORE MOVING BACK TO PRODUCTION       25740027
257500****************************************************************  25750027
257600***  TEST JOBCARD - CHANGE USERID IN ...JOBCARD-TEST-1            25760027
257700*    MOVE JL-JCL-JOBCARD-TEST-1    TO TD-JCL-LINE.                25770027
257800*    PERFORM 8100-WRITE-TD-LINE.                                  25780027
257900***                                                               25790027
258000*    MOVE JL-JCL-JOBCARD-TEST-2    TO TD-JCL-LINE.                25800027
258100*    PERFORM 8100-WRITE-TD-LINE.                                  25810027
258200***  TEST JOBCARD - CHANGE USERID IN ...JOBCARD-TEST-1            25820027
258300****************************************************************  25830027
258400*                                                                 25840027
258500****************************************************************  25850027
258600*      THE PRODUCTION JOBCARD IS BELOW , COMMENT OUT FOR TESTING  25860027
258700*           UNCOMMENT AFTER TESTING, BEFORE MOVING TO PRODUCTION  25870027
258800****************************************************************  25880027
258900***  PROD JOBCARD                                                 25890027
259000     MOVE JL-JCL-JOBCARD-PROD-1    TO TD-JCL-LINE.                25900027
259100     PERFORM 8100-WRITE-TD-LINE.                                  25910027
259200                                                                  25920027
259300     MOVE JL-JCL-JOBCARD-PROD-2    TO TD-JCL-LINE.                25930027
259400     PERFORM 8100-WRITE-TD-LINE.                                  25940027
259500***  PROD JOBCARD                                                 25950027
259600****************************************************************  25960027
259700                                                                  25970027
259800     PERFORM                                                      25980027
259900         VARYING JL-JCL-IDX                                       25990027
260000         FROM 1 BY 1                                              26000027
260100         UNTIL JL-JCL-IDX > JL-JCL-LINE-COUNT                     26010027
260200         OR PS-TD-ERROR                                           26020027
260300             MOVE JL-JCL-LINE (JL-JCL-IDX)                        26030027
260400                                    TO TD-JCL-LINE                26040027
260500             PERFORM 8100-WRITE-TD-LINE                           26050027
260600     END-PERFORM.                                                 26060027
260700*                                                                 26070027
260800     PERFORM 9600-DEQUEUE-INTERNAL-READER.                        26080027
260900                                                                  26090027
261000***************************************************************** 26100027
261100** THIS PARAGRAPH WILL MOVE THE INFORMATION ENTERED ON THE     ** 26110027
261200** SCREEN TO THE JCL THAT WILL RUN IN BATCH MODE.              ** 26120027
261300**                                                             ** 26130027
261400** NOTE:  THE STARTING AND ENDING DATES ARE BEING POPULATED    ** 26140027
261500**        IN PARAGRAPH 3200-VALIDATE-DATES.  THE VARIABLES ARE ** 26150027
261600**        "JJ-START-DATE", "JJ-START-DATE-C", "JJ-END-DATE",   ** 26160027
261700**        AND "JJ-END-DATE-C".                                 ** 26170027
261800**                                                             ** 26180027
261900***************************************************************** 26190027
262000 5010-MOVE-CONTROL-CARD.                                          26200027
262100                                                                  26210027
262200     MOVE DP020-USERID  TO JL-TEST-JOB-NAME                       26220027
262300                           JL-TEST-NOTIFY-NAME                    26230027
262400                           JJ-USER-ID.                            26240027
262500     MOVE DP020-LOCATION-NBR     TO JJ-SUB-OPER-UNT-ID.           26250027
262600                                                                  26260027
262700     MOVE ASC-OPER-UNT-ID        TO JJ-OPER-UNT-ID                26270027
262800                                    JJ-OPER-UNT-ID-C.             26280027
262900                                                                  26290027
263000     MOVE ASC-PRINT-DEST         TO JJ-DEST                       26300027
263100                                    JJ-PRINT-DEST-C.              26310027
263200                                                                  26320027
263300     MOVE ASC-RPT-COPY           TO JJ-COPY                       26330027
263400                                    JJ-RPT-COPIES-C.              26340027
263500                                                                  26350027
263600     MOVE ASC-REPORT-TYPE        TO JJ-REPORT-TYPE                26360027
263700                                    JJ-REPORT-TYPE-C.             26370027
263800                                                                  26380027
263900     MOVE ASC-LIST-TYPE          TO JJ-LIST-TYPE                  26390027
264000                                    JJ-LIST-TYPE-C.               26400027
264100                                                                  26410027
264200     MOVE ASC-LIST-STATUS        TO JJ-LIST-STAT                  26420027
264300                                    JJ-LIST-STAT-C.               26430027
264400                                                                  26440027
264500     MOVE ASC-LOCATION           TO JJ-LOC                        26450027
264600                                    JJ-LOC-C.                     26460027
264700                                                                  26470027
264800     MOVE ASC-BUYER-NBR          TO JJ-BUYER-NBR                  26480027
264900                                    JJ-BUYER-NBR-C.               26490027
265000                                                                  26500027
265100     MOVE ASC-DEPT-NBR           TO JJ-DPT-NBR                    26510027
265200                                    JJ-DPT-NBR-C.                 26520027
265300                                                                  26530027
265400     MOVE ASC-VND-NBR            TO JJ-VND-NBR                    26540027
265500                                    JJ-VND-NBR-C.                 26550027
265600                                                                  26560027
265700 8100-WRITE-TD-LINE.                                              26570027
265800*-----------------------------------------------------------------26580027
265900*  WRITE A JCL LINE TO THE TRANSIENT DATA QUEUE FOR THE INTERNAL *26590027
266000*  READER.  ON ANY ERROR, DEQUEUE THE INTERNAL READER AND RETURN *26600027
266100*  THE ERROR TO THE CALLING PROGRAM.                             *26610027
266200*-----------------------------------------------------------------26620027
266300                                                                  26630027
266400     EXEC CICS                                                    26640027
266500         WRITEQ TD                                                26650027
266600             QUEUE(TD-QUEUE-NAME)                                 26660027
266700             FROM(TD-JCL-LINE)                                    26670027
266800             LENGTH(TD-JCL-LINE-LENGTH)                           26680027
266900             RESP(PV-CICS-RESPONSE)                               26690027
267000     END-EXEC.                                                    26700027
267100                                                                  26710027
267200     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    26720027
267300         SET DP013-LOGIC-ABEND    TO TRUE                         26730027
267400         SET DP013-NO-ROLLBACK    TO TRUE                         26740027
267500         MOVE '8100-WRITE-TD-LINE'                                26750027
267600                                  TO DP013-PARAGRAPH              26760027
267700         MOVE PV-CICS-RESPONSE    TO AM-CICS-CODE-7               26770027
267800         MOVE AM-ABEND-MESSAGE-7  TO DP013-MESSAGE-TEXT(1)        26780027
267900         PERFORM DP013-0000-PROCESS-ABEND                         26790027
268000     END-IF.                                                      26800027
268100*8100-EXIT.                                                       26810027
268200                                                                  26820027
268300 9500-ENQUEUE-INTERNAL-READER.                                    26830027
268400*-----------------------------------------------------------------26840027
268500*  ENQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *26850027
268600*  THIS WILL PREVENT INTERLEAVING OF JCL SUBMITTED CONCURRENTLY  *26860027
268700*  BY MULTIPLE USERS.  IF THE QUEUE IS BUSY, THIS PROGRAM WILL   *26870027
268800*  WAIT TO ENQUEUE IT, BY NOT SPECIFICALLY HANDLING THE QBUSY    *26880027
268900*  CONDITION.  IF ANY OTHER ERRORS OCCUR, RETURN AN ERROR CODE   *26890027
269000*  AND MESSAGE TO THE CALLING PROGRAM.                           *26900027
269100*-----------------------------------------------------------------26910027
269200     EXEC CICS                                                    26920027
269300         ENQ                                                      26930027
269400             RESOURCE(TD-QUEUE-NAME)                              26940027
269500             LENGTH(TD-QUEUE-NAME-LENGTH)                         26950027
269600             RESP(PV-CICS-RESPONSE)                               26960027
269700             NOSUSPEND                                            26970027
269800     END-EXEC.                                                    26980027
269900                                                                  26990027
270000     IF PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                    27000027
270100         SET DP013-LOGIC-ABEND    TO TRUE                         27010027
270200         SET DP013-NO-ROLLBACK    TO TRUE                         27020027
270300         MOVE '9500-ENQUEUE-INTERNAL-READER'                      27030027
270400                                  TO DP013-PARAGRAPH              27040027
270500         MOVE PV-CICS-RESPONSE    TO AM-CICS-CODE-8               27050027
270600         MOVE AM-ABEND-MESSAGE-8  TO DP013-MESSAGE-TEXT(1)        27060027
270700         PERFORM DP013-0000-PROCESS-ABEND                         27070027
270800     END-IF.                                                      27080027
270900                                                                  27090027
271000*9500-EXIT.                                                       27100027
271100                                                                  27110027
271200*-----------------------------------------------------------------27120027
271300*  DEQUEUE THE TRANSIENT DATA QUEUE FOR THE INTERNAL READER.     *27130027
271400*  THIS SHOULD BE DONE FOLLOWING A JOB SUBMISSION.               *27140027
271500*  THIS WILL FREE UP THE INTERNAL READER FOR OTHER USERS.        *27150027
271600*-----------------------------------------------------------------27160027
271700                                                                  27170027
271800 9600-DEQUEUE-INTERNAL-READER.                                    27180027
271900                                                                  27190027
272000     EXEC CICS                                                    27200027
272100         DEQ                                                      27210027
272200             RESOURCE(TD-QUEUE-NAME)                              27220027
272300             LENGTH(TD-QUEUE-NAME-LENGTH)                         27230027
272400             RESP(PV-CICS-RESPONSE)                               27240027
272500     END-EXEC.                                                    27250027
272600                                                                  27260027
272700     IF PV-CICS-RESPONSE = DFHRESP(NORMAL)                        27270027
272800         MOVE PC-TSYMSG-00098     TO DP020-MSG-NUMBER             27280027
272900     ELSE                                                         27290027
273000         SET DP013-LOGIC-ABEND    TO TRUE                         27300027
273100         SET DP013-NO-ROLLBACK    TO TRUE                         27310027
273200         MOVE '9600-DEQUEUE-INTERNAL-READER'                      27320027
273300                                  TO DP013-PARAGRAPH              27330027
273400         MOVE PV-CICS-RESPONSE    TO AM-CICS-CODE-9               27340027
273500         MOVE AM-ABEND-MESSAGE-9  TO DP013-MESSAGE-TEXT(1)        27350027
273600         PERFORM DP013-0000-PROCESS-ABEND                         27360027
273700     END-IF.                                                      27370027
273800*9600-EXIT.                                                       27380027
273900*----------------------------------------------------------------*27390027
274000*    ABEND PROCESSOR MODULE                                      *27400027
274100*----------------------------------------------------------------*27410027
274200                                                                  27420027
274300     COPY DPPD013.                                                27430027
