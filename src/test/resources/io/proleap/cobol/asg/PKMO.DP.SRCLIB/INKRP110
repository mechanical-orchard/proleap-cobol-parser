       ID  DIVISION.                                                            
       PROGRAM-ID.         INKRP110                                             
       AUTHOR.             AMY LAWSON.                                          
       INSTALLATION.       KOHLS DEPARTMENT STORES.                             
       DATE-WRITTEN.       9/00.                                                
       DATE-COMPILED.                                                           
                                                                                
      ******************************************************************        
      *       UNIT VARIANCE REPORT                                     *        
      *                                                                *        
      ******************** HISTORY OF CHANGES **************************        
      *                                                                *        
      * WR/PROJ  DATE        DESCRIPTION OF CHANGES                    *        
      * -------  ----------  ----------------------------------------  *        
      * 22000    03-13-2001  CHANGE TO PRODUCE A CLEARANCE ITEMS       *        
      *                      VERSION OF THE SAME REPORT                *        
W26600* W26600  07-26-2004 J.M. DRAWS MERCH LEDGER STORE EXPANSION     *        
W26006* W26006  02-24-2005 ES REMOVE REFERENCES TO OBSOLETE STORE TABLE*        
W33304* W33304  08-12-2008 HILO PROJECT                                *        
W33304* -ADDED NEW HEADER LINE WITH CYCLE AND INV STATUS INFO.         *        
W33304* -INCREASE INPUT LRECL.                                         *        
W33304* -ADD BREAK LOGIC AND TOTALING LOGIC AT THE FINANCIAL INVENTORY *        
W33304*  STATUS AND CYLCE LEVELS.                                      *        
W33304* -ADD SQL TO GET INVENTORY (CYCLE) NAME AND INVENTORY STATUS    *        
W33304*  DESCRIPTION.                                                  *        
W33304* -REMOVE NEVER USED VARIABLES IN WORKING STORAGE.               *        
      ******************************************************************        
       ENVIRONMENT DIVISION.                                                    
       CONFIGURATION SECTION.                                                   
       INPUT-OUTPUT SECTION.                                                    
       FILE-CONTROL.                                                            
           SELECT INPUT-AUDIT-FILE                                              
               ASSIGN TO INP01.                                                 
                                                                                
           SELECT VARIANCE-AUDIT-REPORT                                         
               ASSIGN TO RPT01.                                                 
                                                                                
       DATA DIVISION.                                                           
       FILE SECTION.                                                            
                                                                                
       FD  INPUT-AUDIT-FILE                                                     
           RECORDING MODE IS F                                                  
           LABEL RECORDS ARE OMITTED                                            
           BLOCK CONTAINS 0 RECORDS                                             
W33304     RECORD CONTAINS 100 CHARACTERS                                       
           DATA RECORD IS INPUT-AUDIT-REC.                                      
W33304 01  INPUT-AUDIT-REC PIC X(100).                                          
                                                                                
       FD  VARIANCE-AUDIT-REPORT                                                
           LABEL RECORDS ARE OMITTED                                            
           RECORD CONTAINS 133 CHARACTERS                                       
           RECORDING  MODE IS F                                                 
           DATA RECORD IS REPORT-LINE.                                          
       01  REPORT-LINE.                                                         
           05  REPORT-LINE-CC    PIC X(001).                                    
           05  REPORT-LINE-DATA  PIC X(132).                                    
           05  FILLER REDEFINES  REPORT-LINE-DATA.                              
               10  FILLER        PIC X(131).                                    
               10  REPORT-HEADER-FONT-INDICATOR                                 
                                 PIC X(001).                                    
                                                                                
       WORKING-STORAGE SECTION.                                                 
                                                                                
       01  ABEND-CODE                  PIC S9(04)  VALUE ZERO COMP SYNC.        
                                                                                
       01  PC-PRINT-CONTROL.                                                    
           05  PC-PAGE-COUNT           PIC S9(05)  VALUE ZERO.                  
           05  PC-LINE-COUNT           PIC S9(03)  VALUE ZERO COMP-3.           
           05  PC-LINE-MAX             PIC S9(03)  VALUE +58  COMP-3.           
                                                                                
       01  PV-PROGRAM-VARIABLES.                                                
           05  PV-PARA                 PIC X(30)    VALUE SPACES.               
           05  PV-DB2-OPER-ATTEMPTED   PIC X(30)    VALUE SPACES.               
W26600*    05  PV-STR-NBR              PIC X(03)    VALUE SPACES.               
W26600     05  PV-STR-NBR              PIC S9(04) COMP VALUE +0.                
           05  PV-SYSTEM-DATE.                                                  
               10  PV-SYS-YY           PIC 9(2)    VALUE ZEROES.                
               10  PV-SYS-MM           PIC 9(2)    VALUE ZEROES.                
               10  PV-SYS-DD           PIC 9(2)    VALUE ZEROES.                
           05  PV-DB2-DATE.                                                     
               10  PV-DB2-CC           PIC 9(2)    VALUE ZEROES.                
               10  PV-DB2-YY           PIC 9(2)    VALUE ZEROES.                
               10  FILLER              PIC X(1)    VALUE '-'.                   
               10  PV-DB2-MM           PIC 9(2)    VALUE ZEROES.                
               10  FILLER              PIC X(1)    VALUE '-'.                   
               10  PV-DB2-DD           PIC 9(2)    VALUE ZEROES.                
W33304     05  PV-HOLD-INV-ID          PIC S9(09)  COMP VALUE +0.               
W33304     05  PV-HOLD-FINCL-INV-STAT  PIC X(02)   VALUE SPACE.                 
W33304     05  PV-HOLD-INV-NAME-TEXT   PIC X(20)   VALUE SPACE.                 
W33304     05  PV-HOLD-INV-STAT-DESC   PIC X(40)   VALUE SPACE.                 
W33304     05  PV-TEMP-NBR-10-COMP     PIC S9(10) COMP VALUE ZERO.              
W33304     05  PV-TEMP-NBR-10-NUM      PIC 9(10)   VALUE ZERO.                  
W33304     05  FILLER REDEFINES  PV-TEMP-NBR-10-NUM.                            
W33304         10  FILLER        PIC 9(05).                                     
W33304         10  PV-REPORT-INV-ID                                             
W33304                           PIC 9(05).                                     
                                                                                
           05  PV-COMPUTED-FIELDS.                                              
               10  PV-ABSOLUTE-UNTS              PIC  9(15)    VALUE  0         
                                                 COMP-3.                        
W33304*****THESE ARE GRAND TOTALS*************************************          
               10  PV-TOT-UNT-CTOFF              PIC S9(15)    VALUE +0         
                                                 COMP-3.                        
               10  PV-TOT-UNTS-DECR              PIC S9(15)    VALUE +0         
                                                 COMP-3.                        
               10  PV-TOT-UNTS-INCR              PIC S9(15)    VALUE +0         
                                                 COMP-3.                        
               10  PV-TOT-ABSOLUTE-UNTS          PIC  9(15)    VALUE  0         
                                                 COMP-3.                        
W33304*****THESE ARE FINANCIAL INVENTORY STATUS TOTALS****************          
W33304         10  PV-STATCD-TOT-UNT-CTOFF       PIC S9(15)    VALUE +0         
W33304                                          COMP-3.                         
W33304         10  PV-STATCD-TOT-UNTS-DECR       PIC S9(15)    VALUE +0         
W33304                                           COMP-3.                        
W33304         10  PV-STATCD-TOT-UNTS-INCR       PIC S9(15)    VALUE +0         
W33304                                           COMP-3.                        
W33304         10  PV-STATCD-TOT-ABSOLUTE-UNTS   PIC  9(15)    VALUE  0         
W33304                                           COMP-3.                        
W33304*****THESE ARE INVENTORY ID TOTALS (CYCLE) ********************           
W33304         10  PV-INVID-TOT-UNT-CTOFF        PIC S9(15)    VALUE +0         
W33304                                           COMP-3.                        
W33304         10  PV-INVID-TOT-UNTS-DECR        PIC S9(15)    VALUE +0         
W33304                                           COMP-3.                        
W33304         10  PV-INVID-TOT-UNTS-INCR        PIC S9(15)    VALUE +0         
W33304                                           COMP-3.                        
W33304         10  PV-INVID-TOT-ABSOLUTE-UNTS    PIC  9(15)    VALUE  0         
W33304                                           COMP-3.                        
       01  PROGRAM-REDEFINES.                                                   
           05  PV-UNT-CTOFF-REDEF          PIC +9(09) VALUE ZERO.               
           05  FILLER REDEFINES PV-UNT-CTOFF-REDEF.                             
               10  FILLER                      PIC X(01).                       
               10  PV-UNT-CTOFF-NUM            PIC 9(09).                       
                                                                                
           05  PV-UNTS-DECR-REDEF          PIC +9(09) VALUE ZERO.               
           05  FILLER REDEFINES PV-UNTS-DECR-REDEF.                             
               10  FILLER                      PIC X(01).                       
               10  PV-UNTS-DECR-NUM            PIC 9(09).                       
                                                                                
           05  PV-UNTS-INCR-REDEF          PIC +9(09) VALUE ZERO.               
           05  FILLER REDEFINES PV-UNTS-INCR-REDEF.                             
               10  FILLER                      PIC X(01).                       
               10  PV-UNTS-INCR-NUM            PIC 9(09).                       
                                                                                
                                                                                
       01  SWITCHES.                                                            
           05  END-OF-INPUT-IND        PIC X       VALUE 'Y'.                   
               88  END-OF-VAR-INPUT                VALUE 'N'.                   
               88  NOT-END-OF-VAR-INPUT            VALUE 'Y'.                   
                                                                                
W26600*-----------------------------------------------------------------        
W26600*     TB-STORE-TABLE COMMENTED OUT / IT IS NOT REFERENCED  (JMD)          
W26600*-----------------------------------------------------------------        
W26600*01  TB-STORE-TABLE.                                                      
W26600*    05 TB-STORE-TAB OCCURS 1000 TIMES.                                   
W26600*       10  TB-STORE-NBR         PIC 9(03).                               
                                                                                
       01  CPU-DATE.                                                            
           05  CPU-YEAR                    PIC X(02)     VALUE SPACES.          
           05  CPU-MONTH                   PIC X(02)     VALUE SPACES.          
           05  CPU-DAY                     PIC X(02)     VALUE SPACES.          
                                                                                
       01  CPU-TIME.                                                            
           05  CPU-HOUR                    PIC X(02)     VALUE SPACES.          
           05  CPU-MINUTE                  PIC X(02)     VALUE SPACES.          
           05  FILLER                      PIC X(02)     VALUE SPACES.          
22000  01  H1-HEADING              PIC X(132)  VALUE SPACES.                    
                                                                                
22000  01  H1-HEADING-NON-CLEARANCE.                                            
22000      05  FILLER              PIC X(47)   VALUE SPACES.                    
22000      05  FILLER              PIC X(85)   VALUE                            
22000          'NON-CLEARANCE VARIANCE AUDIT REPORT '.                          
22000                                                                           
22000  01  H1-HEADING-CLEARANCE.                                                
22000      05  FILLER              PIC X(49)   VALUE SPACES.                    
22000      05  FILLER              PIC X(83)   VALUE                            
22000          'CLEARANCE VARIANCE AUDIT REPORT '.                              
22000                                                                           
W33304 01  H2-HEADING.                                                          
W33304     05  FILLER              PIC X(06)   VALUE ' CYCLE'.                  
W33304     05  FILLER              PIC X(01)   VALUE SPACE.                     
W33304     05  H2-INV-ID           PIC 9(05)   VALUE ZERO.                      
W33304     05  FILLER              PIC X(01)   VALUE SPACE.                     
W33304     05  H2-FINCL-INV-STAT   PIC X(02)   VALUE SPACE.                     
W33304     05  FILLER              PIC X(30)   VALUE SPACE.                     
W33304     05  H2-INV-NAME-TEXT    PIC X(20)   VALUE SPACE.                     
W33304     05  FILLER              PIC X(01)   VALUE SPACE.                     
W33304     05  FILLER              PIC X(01)   VALUE '-'.                       
W33304     05  FILLER              PIC X(01)   VALUE SPACE.                     
W33304     05  H2-INV-STAT-DESC    PIC X(40)   VALUE SPACE.                     
W33304     05  FILLER              PIC X(24)   VALUE SPACE.                     
22000                                                                           
W33304 01  H3-HEADING.                                                          
           05  FILLER              PIC X(01)   VALUE   '-'.                     
           05  FILLER              PIC X(47)   VALUE                            
      **        ----5----0----5----0----5----0----5----0----5----0----5         
               'STORE                      CUTOFF      NEGATIVE'.               
           05  FILLER              PIC X(09)   VALUE  SPACES.                   
           05  FILLER              PIC X(24)   VALUE                            
               'POSITIVE        ABSOLUTE'.                                      
           05  FILLER              PIC X(13)   VALUE  SPACES.                   
                                                                                
W33304 01  H4-HEADING.                                                          
           05  FILLER              PIC X(28)   VALUE   ' '.                     
           05  FILLER              PIC X(53)   VALUE                            
      **        ----5----0----5----0----5----0----5----0----5----0----5         
               'ON-HAND   ADJUSTMENT       ADJUSTMENT     UNIT ADJUST'.         
           EJECT                                                                
       01  D1-DETAIL-LINE.                                                      
           05  D1-CC                    PIC X(01).                              
               88  D1-SINGLE-SPACE                       VALUE ' '.             
               88  D1-DOUBLE-SPACE                       VALUE '0'.             
           05  D1-DETAIL-DATA.                                                  
W26600*        10  D1-STORE-NBR         PIC X(05)        VALUE SPACES.          
W26600         10  D1-STORE-NBR-9       PIC 9(04)        VALUE ZEROES.          
W26600         10  FILLER               PIC X(01)        VALUE SPACES.          
               10  D1-STORE-NAME        PIC X(13)        VALUE SPACES.          
               10  FILLER               PIC X(02)        VALUE SPACES.          
               10  D1-UNT-CTOFF         PIC ZZ,ZZZ,ZZZ,ZZ9-.                    
               10  FILLER               PIC X(02)        VALUE SPACES.          
               10  D1-UNTS-DECR         PIC ZZ,ZZZ,ZZ9-.                        
               10  FILLER               PIC X(02)        VALUE SPACES.          
               10  D1-UNTS-INCR         PIC ZZ,ZZZ,ZZZ,ZZ9.                     
               10  FILLER               PIC X(02)        VALUE SPACES.          
               10  D1-ABSOLUTE-UNTS     PIC ZZ,ZZZ,ZZZ,ZZ9.                     
                                                                                
W33304******STATUS CODE TOTAL LINE**************                                
W33304 01  SC-TOTAL-LINE.                                                       
W33304     05  SC-CC                    PIC X(01).                              
W33304         88  SC-SINGLE-SPACE                       VALUE ' '.             
W33304         88  SC-DOUBLE-SPACE                       VALUE '0'.             
W33304     05  SC-DETAIL-DATA.                                                  
W33304         10  FILLER               PIC X(06)        VALUE SPACES.          
W33304         10  FILLER               PIC X(05) VALUE 'TOTAL'.                
W33304         10  FILLER               PIC X(09)        VALUE SPACES.          
W33304         10  SC-UNT-CTOFF         PIC ZZ,ZZZ,ZZZ,ZZ9-.                    
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  SC-UNTS-DECR         PIC ZZ,ZZZ,ZZ9-.                        
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  SC-UNTS-INCR         PIC ZZ,ZZZ,ZZZ,ZZ9.                     
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  SC-ABSOLUTE-UNTS     PIC ZZ,ZZZ,ZZZ,ZZ9.                     
                                                                                
W33304******INVENTORY ID (CYCLE) TOTAL LINE*****                                
W33304 01  II-TOTAL-LINE.                                                       
W33304     05  II-CC                    PIC X(01).                              
W33304         88  II-SINGLE-SPACE                       VALUE ' '.             
W33304         88  II-DOUBLE-SPACE                       VALUE '0'.             
W33304     05  II-DETAIL-DATA.                                                  
W33304         10  FILLER               PIC X(11) VALUE 'CYCLE TOTAL'.          
W33304         10  FILLER               PIC X(09)        VALUE SPACES.          
W33304         10  II-UNT-CTOFF         PIC ZZ,ZZZ,ZZZ,ZZ9-.                    
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  II-UNTS-DECR         PIC ZZ,ZZZ,ZZ9-.                        
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  II-UNTS-INCR         PIC ZZ,ZZZ,ZZZ,ZZ9.                     
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  II-ABSOLUTE-UNTS     PIC ZZ,ZZZ,ZZZ,ZZ9.                     
                                                                                
W33304******GRAND TOTAL LINE*****                                               
W33304 01  GT-TOTAL-LINE.                                                       
W33304     05  GT-CC                    PIC X(01).                              
W33304         88  GT-SINGLE-SPACE                       VALUE ' '.             
W33304         88  GT-DOUBLE-SPACE                       VALUE '0'.             
W33304     05  GT-DETAIL-DATA.                                                  
W33304         10  FILLER               PIC X(11) VALUE 'GRAND TOTAL'.          
W33304         10  FILLER               PIC X(09)        VALUE SPACES.          
W33304         10  GT-UNT-CTOFF         PIC ZZ,ZZZ,ZZZ,ZZ9-.                    
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  GT-UNTS-DECR         PIC ZZ,ZZZ,ZZ9-.                        
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  GT-UNTS-INCR         PIC ZZ,ZZZ,ZZZ,ZZ9.                     
W33304         10  FILLER               PIC X(02)        VALUE SPACES.          
W33304         10  GT-ABSOLUTE-UNTS     PIC ZZ,ZZZ,ZZZ,ZZ9.                     
      *****************************************************************         
      *  INPUT AUDIT FILE                                                       
      *****************************************************************         
           COPY INRD136.                                                        
                                                                                
      *****************************************************************         
      * COPY FOR STANDARD HEADING                                               
      *****************************************************************         
           COPY DPWS133O.                                                       
                                                                                
      *****************************************************************         
      *  SQL ABEND ROUTINE WORKING STORAGE                                      
      *****************************************************************         
                                                                                
           COPY DPWS004.                                                        
                                                                                
           EXEC SQL                                                             
W26600         INCLUDE XMT00001                                                 
           END-EXEC.                                                            
                                                                                
W33304     EXEC SQL                                                             
W33304         INCLUDE TINCNTL                                                  
W33304     END-EXEC.                                                            
                                                                                
W33304     EXEC SQL                                                             
W33304         INCLUDE INT00001                                                 
W33304     END-EXEC.                                                            
                                                                                
           EXEC SQL                                                             
               INCLUDE SQLCA                                                    
           END-EXEC.                                                            
                                                                                
           COPY SQLCA2.                                                         
           EJECT                                                                
                                                                                
                                                                                
       LINKAGE SECTION.                                                         
                                                                                
       PROCEDURE DIVISION.                                                      
                                                                                
       A100-MAIN-MODULE.                                                        
                                                                                
           PERFORM B100-HOUSEKEEPING.                                           
                                                                                
           PERFORM 7000-READ-VARIANCE-INPUT.                                    
           IF IN136-STAT-CDE = ('25' OR '30')                                   
               MOVE 2                    TO DP133O-REPORT-NUMBER                
               MOVE H1-HEADING-CLEARANCE TO H1-HEADING                          
           ELSE                                                                 
               MOVE 1                    TO DP133O-REPORT-NUMBER                
               MOVE H1-HEADING-NON-CLEARANCE TO H1-HEADING                      
           END-IF.                                                              
W33304     IF END-OF-VAR-INPUT                                                  
W33304         CONTINUE                                                         
W33304     ELSE                                                                 
W33304         PERFORM Z200-GET-INV-CYCLE-NAME                                  
W33304         PERFORM Z300-GET-INV-STAT-CDE-DESC                               
W33304         MOVE IN136-FINCL-INV-STAT-CDE TO PV-HOLD-FINCL-INV-STAT          
W33304         MOVE IN136-INV-ID             TO PV-HOLD-INV-ID                  
W33304         MOVE PV-HOLD-INV-ID           TO PV-TEMP-NBR-10-COMP             
W33304         MOVE PV-TEMP-NBR-10-COMP      TO PV-TEMP-NBR-10-NUM              
W33304         MOVE PV-REPORT-INV-ID         TO H2-INV-ID                       
W33304         MOVE PV-HOLD-FINCL-INV-STAT   TO H2-FINCL-INV-STAT               
W33304         MOVE INCNTL-INV-NM-TEXT (1:INCNTL-INV-NM-LEN)                    
W33304                                           TO H2-INV-NAME-TEXT            
W33304         MOVE INT00001-INV-STAT-CDE-DESC TO H2-INV-STAT-DESC              
W33304     END-IF.                                                              
           PERFORM B200-PRINT-REPORT                                            
               UNTIL END-OF-VAR-INPUT.                                          
                                                                                
           PERFORM B600-EOJ.                                                    
                                                                                
           STOP RUN.                                                            
           EJECT                                                                
       B100-HOUSEKEEPING.                                                       
           OPEN INPUT  INPUT-AUDIT-FILE                                         
                OUTPUT VARIANCE-AUDIT-REPORT.                                   
                                                                                
           ACCEPT CPU-DATE FROM DATE.                                           
           MOVE CPU-YEAR   TO DP133O-RUN-YEAR.                                  
           MOVE CPU-MONTH  TO DP133O-RUN-MONTH.                                 
           MOVE CPU-DAY    TO DP133O-RUN-DAY.                                   
                                                                                
           ACCEPT CPU-TIME FROM TIME.                                           
           MOVE CPU-HOUR   TO DP133O-RUN-HOUR.                                  
           MOVE CPU-MINUTE TO DP133O-RUN-MINUTE.                                
           MOVE 'INKRP110' TO DP133O-PROGRAM-NAME.                              
                                                                                
           MOVE +0         TO PC-PAGE-COUNT.                                    
                                                                                
           PERFORM B125-INITIALIZE.                                             
                                                                                
       B125-INITIALIZE.                                                         
           ACCEPT PV-SYSTEM-DATE   FROM  DATE.                                  
           MOVE PV-SYS-MM          TO  PV-DB2-MM.                               
           MOVE PV-SYS-DD          TO  PV-DB2-DD.                               
           MOVE PV-SYS-YY          TO  PV-DB2-YY.                               
                                                                                
           IF PV-DB2-YY > 80                                                    
               MOVE 19 TO PV-DB2-CC                                             
           ELSE                                                                 
               MOVE 20 TO PV-DB2-CC.                                            
                                                                                
       B200-PRINT-REPORT.                                                       
W33304*  CHECK FOR CYCLE BREAK                                                  
W33304     IF IN136-INV-ID NOT EQUAL PV-HOLD-INV-ID                             
W33304         PERFORM 3000-PRINT-STATUS-BREAK                                  
W33304         PERFORM 4000-PRINT-CYCLE-BREAK                                   
W33304*  FORCE A PAGE BREAK                                                     
W33304         PERFORM Z800-PRINT-HEADINGS                                      
W33304     ELSE                                                                 
W33304*  CHECK FOR STATUS BREAK                                                 
W33304         IF IN136-FINCL-INV-STAT-CDE NOT EQUAL                            
W33304                                PV-HOLD-FINCL-INV-STAT                    
W33304             PERFORM 3000-PRINT-STATUS-BREAK                              
W33304             PERFORM Z800-PRINT-HEADINGS                                  
W33304         END-IF                                                           
W33304     END-IF.                                                              
           MOVE SPACES                    TO D1-DETAIL-DATA.                    
                                                                                
W26600*    MOVE IN136-STR-NBR             TO D1-STORE-NBR.                      
W26600     MOVE IN136-STR-NBR-9           TO D1-STORE-NBR-9.                    
                                                                                
           PERFORM Z100-GET-STORE-NAME.                                         
W26600     MOVE XMT00001-LOC-10-ABBR-NM   TO D1-STORE-NAME.                     
                                                                                
           MOVE IN136-UNT-CTOFF TO D1-UNT-CTOFF.                                
           MOVE IN136-UNT-CTOFF TO PV-UNT-CTOFF-REDEF.                          
W33304     ADD PV-UNT-CTOFF-NUM TO PV-STATCD-TOT-UNT-CTOFF                      
W33304                             PV-INVID-TOT-UNT-CTOFF                       
                                   PV-TOT-UNT-CTOFF.                            
                                                                                
           MOVE IN136-UNTS-DECR TO D1-UNTS-DECR.                                
           MOVE IN136-UNTS-DECR TO PV-UNTS-DECR-REDEF.                          
           ADD PV-UNTS-DECR-NUM TO PV-ABSOLUTE-UNTS.                            
W33304     ADD PV-UNTS-DECR-NUM TO PV-STATCD-TOT-UNTS-DECR                      
W33304                             PV-INVID-TOT-UNTS-DECR                       
                                   PV-TOT-UNTS-DECR                             
W33304                             PV-STATCD-TOT-ABSOLUTE-UNTS                  
W33304                             PV-INVID-TOT-ABSOLUTE-UNTS                   
                                   PV-TOT-ABSOLUTE-UNTS.                        
                                                                                
           MOVE IN136-UNTS-INCR TO D1-UNTS-INCR.                                
           MOVE IN136-UNTS-INCR TO PV-UNTS-INCR-REDEF.                          
           ADD PV-UNTS-INCR-NUM TO PV-ABSOLUTE-UNTS                             
W33304                             PV-STATCD-TOT-UNTS-INCR                      
W33304                             PV-INVID-TOT-UNTS-INCR                       
                                   PV-TOT-UNTS-INCR                             
W33304                             PV-STATCD-TOT-ABSOLUTE-UNTS                  
W33304                             PV-INVID-TOT-ABSOLUTE-UNTS                   
                                   PV-TOT-ABSOLUTE-UNTS.                        
                                                                                
           MOVE PV-ABSOLUTE-UNTS TO D1-ABSOLUTE-UNTS.                           
                                                                                
22000      PERFORM Z600-WRITE-DETAIL-LINE.                                      
                                                                                
           SET  D1-SINGLE-SPACE          TO TRUE.                               
                                                                                
           MOVE 0 TO PV-ABSOLUTE-UNTS.                                          
           MOVE IN136-FINCL-INV-STAT-CDE TO PV-HOLD-FINCL-INV-STAT.             
           MOVE IN136-INV-ID             TO PV-HOLD-INV-ID.                     
           PERFORM 7000-READ-VARIANCE-INPUT.                                    
                                                                                
       B600-EOJ.                                                                
W33304     PERFORM 3000-PRINT-STATUS-BREAK.                                     
W33304     PERFORM 4000-PRINT-CYCLE-BREAK.                                      
W33304     PERFORM 5000-PRINT-GRAND-TOTAL.                                      
                                                                                
           CLOSE INPUT-AUDIT-FILE                                               
                 VARIANCE-AUDIT-REPORT.                                         
                                                                                
       3000-PRINT-STATUS-BREAK.                                                 
W33304     IF PC-LINE-COUNT > PC-LINE-MAX                                       
W33304         OR PC-LINE-COUNT = 0                                             
W33304         PERFORM Z800-PRINT-HEADINGS                                      
W33304     END-IF.                                                              
W33304     SET SC-SINGLE-SPACE TO TRUE.                                         
W33304     MOVE PV-STATCD-TOT-UNT-CTOFF     TO SC-UNT-CTOFF.                    
W33304     MOVE PV-STATCD-TOT-UNTS-DECR     TO SC-UNTS-DECR.                    
W33304     MOVE PV-STATCD-TOT-UNTS-INCR     TO SC-UNTS-INCR.                    
W33304     MOVE PV-STATCD-TOT-ABSOLUTE-UNTS TO SC-ABSOLUTE-UNTS.                
W33304     MOVE SC-TOTAL-LINE TO REPORT-LINE.                                   
W33304     PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     MOVE ZERO                    TO PV-STATCD-TOT-UNT-CTOFF              
W33304                                     PV-STATCD-TOT-UNTS-DECR              
W33304                                     PV-STATCD-TOT-UNTS-INCR              
W33304                                     PV-STATCD-TOT-ABSOLUTE-UNTS.         
W33304     IF END-OF-VAR-INPUT                                                  
               CONTINUE                                                         
           ELSE                                                                 
W33304         PERFORM Z300-GET-INV-STAT-CDE-DESC                               
W33304         MOVE IN136-FINCL-INV-STAT-CDE TO PV-HOLD-FINCL-INV-STAT          
W33304         MOVE PV-HOLD-FINCL-INV-STAT   TO H2-FINCL-INV-STAT               
W33304         MOVE INT00001-INV-STAT-CDE-DESC TO H2-INV-STAT-DESC              
           END-IF.                                                              
                                                                                
W33304 4000-PRINT-CYCLE-BREAK.                                                  
W33304     IF PC-LINE-COUNT > PC-LINE-MAX                                       
W33304         OR PC-LINE-COUNT = 0                                             
W33304         PERFORM Z800-PRINT-HEADINGS                                      
W33304     END-IF.                                                              
W33304     SET II-DOUBLE-SPACE TO TRUE.                                         
W33304     MOVE PV-INVID-TOT-UNT-CTOFF     TO II-UNT-CTOFF.                     
W33304     MOVE PV-INVID-TOT-UNTS-DECR     TO II-UNTS-DECR.                     
W33304     MOVE PV-INVID-TOT-UNTS-INCR     TO II-UNTS-INCR.                     
W33304     MOVE PV-INVID-TOT-ABSOLUTE-UNTS TO II-ABSOLUTE-UNTS.                 
W33304     MOVE II-TOTAL-LINE TO REPORT-LINE.                                   
W33304     PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     MOVE ZERO               TO PV-INVID-TOT-UNT-CTOFF                    
W33304                                PV-INVID-TOT-UNTS-DECR                    
W33304                                PV-INVID-TOT-UNTS-INCR                    
W33304                                PV-INVID-TOT-ABSOLUTE-UNTS.               
W33304     IF END-OF-VAR-INPUT                                                  
               CONTINUE                                                         
           ELSE                                                                 
W33304         PERFORM Z200-GET-INV-CYCLE-NAME                                  
W33304         MOVE IN136-FINCL-INV-STAT-CDE TO PV-HOLD-FINCL-INV-STAT          
W33304         MOVE IN136-INV-ID    TO PV-HOLD-INV-ID                           
W33304         MOVE PV-HOLD-INV-ID  TO PV-TEMP-NBR-10-COMP                      
W33304         MOVE PV-TEMP-NBR-10-COMP TO PV-TEMP-NBR-10-NUM                   
W33304         MOVE PV-REPORT-INV-ID TO H2-INV-ID                               
W33304         MOVE INCNTL-INV-NM-TEXT (1:INCNTL-INV-NM-LEN)                    
W33304                                       TO H2-INV-NAME-TEXT                
W33304     END-IF.                                                              
                                                                                
W33304 5000-PRINT-GRAND-TOTAL.                                                  
W33304     IF PC-LINE-COUNT > PC-LINE-MAX                                       
W33304         OR PC-LINE-COUNT = 0                                             
W33304         PERFORM Z800-PRINT-HEADINGS                                      
W33304     END-IF.                                                              
W33304     SET GT-DOUBLE-SPACE TO TRUE.                                         
W33304     MOVE PV-TOT-UNT-CTOFF     TO GT-UNT-CTOFF.                           
W33304     MOVE PV-TOT-UNTS-DECR     TO GT-UNTS-DECR.                           
W33304     MOVE PV-TOT-UNTS-INCR     TO GT-UNTS-INCR.                           
W33304     MOVE PV-TOT-ABSOLUTE-UNTS TO GT-ABSOLUTE-UNTS.                       
W33304     MOVE GT-TOTAL-LINE TO REPORT-LINE.                                   
W33304     PERFORM Z700-WRITE-REPORT-LINE.                                      
                                                                                
      ******************************************************************        
      *    READ VARIANCE INPUT                                                  
      ******************************************************************        
       7000-READ-VARIANCE-INPUT.                                                
           READ INPUT-AUDIT-FILE                                                
               INTO IN136-AUDIT-RECORD                                          
               AT END SET END-OF-VAR-INPUT TO TRUE.                             
W26600     MOVE IN136-STR-NBR-9 TO PV-STR-NBR.                                  
                                                                                
      ******************************************************************        
      *    GET STORE NAME                                                       
      ******************************************************************        
       Z100-GET-STORE-NAME.                                                     
22000      MOVE '*Z100-GET-STORE-NAME             *' TO PV-PARA                 
                                                                                
           EXEC SQL                                                             
W26600          SELECT LOC_10_ABBR_NM                                           
W26600            INTO :XMT00001-LOC-10-ABBR-NM                                 
W26600            FROM XMT_LOC                                                  
W26600           WHERE LOC_NBR = :PV-STR-NBR                                    
           END-EXEC.                                                            
                                                                                
           EVALUATE TRUE                                                        
               WHEN SQLCODE = +0                                                
                   CONTINUE                                                     
               WHEN OTHER                                                       
                   DISPLAY '*****'                                              
                   DISPLAY 'STORE ' IN136-STR-NBR ' NOT FOUND'                  
                   DISPLAY '*****'                                              
W26600             MOVE 'READING XMT00001 TABLE'                                
                                 TO  PV-DB2-OPER-ATTEMPTED                      
                   PERFORM Z900-SQL-ABEND                                       
           END-EVALUATE.                                                        
                                                                                
W33304******************************************************************        
W33304*    GET INV CYCLE NAME                                                   
W33304******************************************************************        
W33304 Z200-GET-INV-CYCLE-NAME.                                                 
W33304     MOVE '*Z200-GET-INV-CYCLE-NAME         *' TO PV-PARA                 
                                                                                
W33304     EXEC SQL                                                             
W33304          SELECT INV_NM                                                   
W33304            INTO :INCNTL-INV-NM                                           
W33304            FROM TINCNTL                                                  
W33304           WHERE INV_ID = :IN136-INV-ID                                   
W33304     END-EXEC.                                                            
                                                                                
W33304     EVALUATE TRUE                                                        
W33304         WHEN SQLCODE = +0                                                
W33304             CONTINUE                                                     
W33304         WHEN OTHER                                                       
W33304             MOVE IN136-INV-ID    TO PV-TEMP-NBR-10-COMP                  
W33304             MOVE PV-TEMP-NBR-10-COMP TO PV-TEMP-NBR-10-NUM               
W33304             DISPLAY '*****'                                              
W33304             DISPLAY 'INV ID ' PV-TEMP-NBR-10-NUM ' NOT FOUND'            
W33304             DISPLAY '*****'                                              
W33304             MOVE 'READING TINCNTL TABLE'                                 
W33304                           TO  PV-DB2-OPER-ATTEMPTED                      
W33304             PERFORM Z900-SQL-ABEND                                       
W33304     END-EVALUATE.                                                        
                                                                                
W33304******************************************************************        
W33304*    GET INVENTORY STATUS CODE DESCRIPTION                                
W33304******************************************************************        
W33304 Z300-GET-INV-STAT-CDE-DESC.                                              
W33304     MOVE '*Z300-GET-INV-STAT-CDE-DESC      *' TO PV-PARA                 
                                                                                
W33304     EXEC SQL                                                             
W33304          SELECT INV_STAT_CDE_DESC                                        
W33304            INTO :INT00001-INV-STAT-CDE-DESC                              
W33304            FROM INT_INV_STAT_CDE                                         
W33304           WHERE INV_STAT_CDE = :IN136-FINCL-INV-STAT-CDE                 
W33304     END-EXEC.                                                            
                                                                                
W33304     EVALUATE TRUE                                                        
W33304         WHEN SQLCODE = +0                                                
W33304           CONTINUE                                                       
W33304         WHEN OTHER                                                       
W33304           DISPLAY '*****'                                                
W33304           DISPLAY 'STAT CDE ' IN136-FINCL-INV-STAT-CDE ' NOT FND'        
W33304           DISPLAY '*****'                                                
W33304           MOVE 'READING INT_INV_STAT_CDE TABLE'                          
W33304                           TO  PV-DB2-OPER-ATTEMPTED                      
W33304           PERFORM Z900-SQL-ABEND                                         
W33304     END-EVALUATE.                                                        
                                                                                
22000  Z600-WRITE-DETAIL-LINE.                                                  
22000      IF PC-LINE-COUNT > PC-LINE-MAX                                       
22000          OR PC-LINE-COUNT = 0                                             
22000          PERFORM Z800-PRINT-HEADINGS                                      
22000      END-IF.                                                              
22000                                                                           
22000      MOVE D1-DETAIL-LINE TO REPORT-LINE.                                  
22000      PERFORM Z700-WRITE-REPORT-LINE.                                      
22000                                                                           
       Z700-WRITE-REPORT-LINE.                                                  
           EVALUATE TRUE                                                        
22000          WHEN REPORT-LINE-CC = ' '                                        
                   ADD +1  TO  PC-LINE-COUNT                                    
22000          WHEN REPORT-LINE-CC = '0'                                        
                   ADD +2  TO  PC-LINE-COUNT                                    
22000          WHEN REPORT-LINE-CC = '-'                                        
                   ADD +3  TO  PC-LINE-COUNT                                    
22000          WHEN REPORT-LINE-CC = '1'                                        
22000              MOVE +1 TO  PC-LINE-COUNT                                    
           END-EVALUATE.                                                        
                                                                                
           WRITE REPORT-LINE.                                                   
                                                                                
       Z800-PRINT-HEADINGS.                                                     
           ADD 1              TO PC-PAGE-COUNT.                                 
                                                                                
           MOVE PC-PAGE-COUNT TO DP133O-PAGE-NUMBER.                            
           MOVE DP133O-STANDRD-HEADER-133-COLS TO REPORT-LINE.                  
           MOVE '1'           TO REPORT-LINE-CC                                 
           MOVE ' '           TO REPORT-HEADER-FONT-INDICATOR                   
                                                                                
           PERFORM Z700-WRITE-REPORT-LINE.                                      
                                                                                
           MOVE H1-HEADING TO REPORT-LINE.                                      
           PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     MOVE H2-HEADING TO REPORT-LINE.                                      
W33304     PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     MOVE H3-HEADING TO REPORT-LINE.                                      
           PERFORM Z700-WRITE-REPORT-LINE.                                      
W33304     MOVE H4-HEADING TO REPORT-LINE.                                      
           PERFORM Z700-WRITE-REPORT-LINE.                                      
                                                                                
           SET  D1-DOUBLE-SPACE          TO TRUE.                               
                                                                                
      ******************************************************************        
      *  STANDARD DB2 ERROR ABEND ROUTINE                                       
      *  THIS ROUTINE FORCES AN ABEND DUE TO A DB2 PROBLEM.                     
      ******************************************************************        
       Z900-SQL-ABEND.                                                          
                                                                                
           MOVE +4013                 TO ABEND-CODE.                            
           DISPLAY '**  ABEND     **'.                                          
           DISPLAY '**  PROGRAM   **  =  INKRP110'.                             
           DISPLAY '**  PARAGRAPH **  = ' PV-PARA.                              
           DISPLAY '**  OPERATION **  = ' PV-DB2-OPER-ATTEMPTED.                
                                                                                
      *    THE FOLLOWING COPYBOOK UTILIZES THE DB2 ABEND MODULE                 
      *    DSNTIAR TO CONVERT SQLCA INTO UNDERSTANDABLE VERBAGE.                
                                                                                
           COPY DPPD004.                                                        
                                                                                
           CALL 'ILBOABN0'  USING ABEND-CODE.                                   
