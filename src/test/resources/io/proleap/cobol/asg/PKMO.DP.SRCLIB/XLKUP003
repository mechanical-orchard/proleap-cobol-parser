000100                                                                  00010000
000200******************************************************************00020000
000300*  I M P O R T A N T --- WHEN COMPILING THIS PROGRAM THE MQ SERIES00030000
000400*  SWITCH ON THE 2ND COMPILE SCREEN NEEDS TO BE SET TO 'Y'.       00040000
000500*  THIS PROGRAM USES MQSERIES.                                    00050000
000600*                                                                 00060000
000700*  THIS PROGRAM COMPILES WITH A RET CODE OF 4. THE LOOP WARNING   00070000
000800*  IS RELATED TO THE CODE FOR THE STARTED TASK PROCESSING.        00080000
000900*                                                                 00090000
001000******************************************************************00100000
001100******************************************************************00110000
001200* CHANGE DESCRIPTION                                              00120000
001300******************************************************************00130000
001400* DATE  05/04/2010                                                00140000
001500*  CHANGE MADE: ADDED A NEW IR INDICATOR(WHSE_RPLNT_IND) IN       00150000
001600*  XLT_SKU TABLE AS PART OF THE IMPORT REPLENISHMENT PROJECT.     00160000
001700*  CHANGES MADE ACCORDINGLY TO THE INSERT AND UPDATE CALLS        00170000
001800*  FOR XLT_SKU TABLE.                                             00180000
001900*  MADE BY: PRASANTHI BADUKONDA     TKID:TKMAW45                  00190000
002000*  CHANGES ARE TAGGED AS PB 05/04/2010                            00200000
002001******************************************************************00200143
002010* DATE  07/10/2015                                                00201003
002020*  CHANGE MADE: ADDED A NEW TABLE XLT_BRND TO HOLD THE BRAND ID   00202003
002030*  DESC AND BRAND TYPE. THE BRAND ID WILL NOW BE INCLUDED ON THE  00203003
002040*  XLT_VND_STYL TABLE.                                            00204003
002060*  MADE BY: CHERI PARMLEY           TKID:TKMAF76                  00206003
002100******************************************************************00210000
002110******************************************************************00211041
002120* DATE  04/07/2016                                                00212041
002130*  CHANGE MADE: ADDED THIS LINE TO PARA 2370- AND 2380-           00213041
002140*   MOVE IM008-STYL-ATTR-LBL TO XLT00043-BRND-ID NEEDED TO FILL   00214041
002150*   IN BEFORE THE BRAND UPDATE.                                   00215041
002160*  MADE BY: CHERI PARMLEY           TKID:TKMAF76                  00216041
002170******************************************************************00217041
002180******************************************************************00218055
002190* DATE  10/29/2020                                                00219063
002191*  CHANGE MADE: ADDED TMDARVS SELECT IN 2100-INSERT-VNDSTYL-ADD   00219150
002192*  AND 2359-BRAND-UPDATES PARAGRAPH.                              00219250
002195*  PROBLEM:BRAND ID VALUE GOT TRUNCATED FROM VSM QUEUE IF BRANDID 00219550
002196*  IS GREATER THAN 9999 DUE TO THE BRAND ID FIELD LENGTH ISSUE    00219650
002197*  IN IMRD008 COPYBOOK.                                           00219750
002198*  EXAMPLE: BRAND ID 10005 TRUNCATED TO 0005 AND UPDATED          00219850
002199*  INCORRECTLY IN XL DOMAIN SYSTEM.                               00219950
002200*  FIX:TO FIX THE TRUNCATION ISSUE, TAKEN BRAND ID VALUE FROM     00220050
002201*  TMDARVS MERCHANDISE DB2 TABLE INSTEAD OF TAKING THE VALUE      00220150
002202*  FROM VSM QUEUE AND UPDATED IN XL DOMAIN DB2 TABLES.            00220250
002203*                                                                 00220350
002204*  MADE BY: SARVESWARAN KANNAN      TKID:TKMAY51                  00220459
002205******************************************************************00220550
002210                                                                  00221050
002300 IDENTIFICATION DIVISION.                                         00230000
002400 PROGRAM-ID.             XLKUP003.                                00240000
002500 AUTHOR.                 AL PETERS.                               00250000
002600 INSTALLATION.           KOHLS DEPARTMENT STORES.                 00260000
002700 DATE-WRITTEN.           JULY 2002.                               00270000
002800 DATE-COMPILED.                                                   00280000
002900                                                                  00290000
003000******************************************************************00300000
003100*      I T E M   M E S S A G E   Q U E U E   D O W N L O AD       00310000
003200*                                                                 00320000
003300* THIS PROGRAM WILL READ THE LOGISTICS ITEM HUB, RETRIEVE ANY     00330000
003400* MESSAGES AND PROCESS THEM TO UPDATE THE LOGISTICS ITEM DOMAIN   00340000
003500* TABLES.                                                         00350000
003600*                                                                 00360000
003700* !!!   I M P O R T A N T  !!!                                    00370000
003800* ----------------------------                                    00380000
003900* THE COPYBOOK IMRD008 CONTAINS THE REC TYPS FOUND IN THE MSGS.   00390000
004000* CURRENTLY THE REC TYPE IS 450 BYTES.                            00400000
004100*                                                                 00410000
004200* TRIGGERED TASK:                                                 00420000
004300* -------------                                                   00430000
004400* THIS PROGRAM RUNS AS A STARTED TASK.  THE TASK STARTS WHEN      00440000
004500* CICS IS BROUGHT UP IN THE MORNING.  IT WILL RUN CONTINUOUSLY    00450000
004600* UNTIL IT ENCOUNTERS THE "END RUN OF PROGRAM" MESSAGE THAT       00460000
004700* WILL BE SENT TO THE ITEM QUEUE FROM A SEPARATE PROGRAM USING    00470000
004800* AN MQPUT1 CALL.                                                 00480000
004900*                                                                 00490000
005000* ASSUMPTIONS ABOUT THE MESSAGES COMING FROM LOGISTICS ITEM HUB   00500000
005100* --------------------------------------------------------        00510000
005200* 1) THE MESSAGES WILL BE IN THE IMRD008 FORMAT.                  00520000
005300*                                                                 00530000
005400*    THE IM008_ITEM_KEY_DATA IS SUPPLIED ON ALL MESSAGES.         00540000
005500*                                                                 00550000
005600*                                                                 00560000
005700* 2) MQ MESSAGES WILL NOT EXCEED (450 BYTES) IN LENGTH.           00570000
005800*                                                                 00580000
005900* 3) ANY MESSAGES THAT ARE INCOMPLETE OR MISFORMED WILL BE        00590000
006000*    PUT TO AN ERROR QUEUE.                                       00600000
006100*                                                                 00610000
006200* 4) A BUSINESS EVENT-ID OF 999 WILL SHUT DOWN THE ITEM PROCESS.  00620000
006300                                                                  00630000
006400* GENERAL PROCESSING:                                             00640000
006500* -------------------                                             00650000
006600* 1) INITIALIZE VARIABLES, SET SWITCHES, OPEN ITEM QUEUE.         00660000
006700*                                                                 00670000
006800* 2) WHEN A MESSAGE APPEARS, IF AN ERROR IS FOUND, THE            00680000
006900*    ENTIRE MESSAGE WILL BE PUT TO THE ERROR QUEUE.               00690000
007000*                                                                 00700000
007100* 3) WHEN A MESSAGE HAS BEEN PROCESSED, THE ITEM WILL BE          00710000
007200*    LOADED TO THE LOGISTICS ITEM DOMAIN TABLES.                  00720000
007300*                                                                 00730000
007400*    XLT_VND_STYL  (VENDOR STYLE TABLE) THAT WILL BE INSERTED     00740000
007500*                   AND OR UPDATED.                               00750000
007600*                                                                 00760000
007610*    XLT_BRND  (BRAND TABLE) WILL BE INSERTED OR UPDATED IF       00761034
007611*              STYLE HAS A BRAND THATS NOT ALREADY ON TABLE       00761134
007620*                                                                 00762034
007700*    XLT_SKU   (SKU TABLE) THAT WILL BE INSERTED AND OR UPDATED.  00770000
007800*                                                                 00780000
007900*    XLT_UPC   (UPC TABLE) THAT WILL BE INSERTED AND OR UPDATED.  00790000
008000*                                                                 00800067
008100* 4) EVERYTHING WILL GET INITIALIZED AND RESET - READY FOR THE    00810000
008200*    NEXT MESSAGE WHEN IT IS ENCOUNTERED.                         00820000
008300*                                                                 00830000
008400* ERROR PROCESSING:                                               00840000
008500* -----------------                                               00850000
008600* THIS PRGM IS CODED TO TRAP 24 TYPES OF ERRORS WHICH INCLUDE:    00860027
008700*                                                                 00870000
008800* 1) VALUE 1 - SKU ROW NOT FOUND                                  00880034
008900* 2) VALUE 2 - STYLE ID NOT FOUND                                 00890000
009000* 3) VALUE 3 - DUP INSERT ON STYLE                                00900000
009100* 4) VALUE 4 - DUP INSERT ON SKU                                  00910000
009200* 5) VALUE 5 - SIZE DESC CODE MISMATCH                            00920000
009300* 6) VALUE 6 - DUP UPDATE STYLE                                   00930000
009400* 7) VALUE 7 - DUP INSERT ON UPC                                  00940000
009500* 8) VALUE 8 - UPC ROW NOT FOUND                                  00950000
009600* 9) VALUE 9 - DUP UPDATE UPC                                     00960000
009700* 10)VALUE 10- SKU ROW PROBLEM                                    00970000
009800* 11)VALUE 11- SKU INTR UPC ID NOT FOUND                          00980000
009900* 12)VALUE 12- PK INSERT NOT SUCCESS                              00990000
010000* 13)VALUE 13- PK DELETE NOT SUCCESS                              01000000
010100* 14)VALUE 14- PK UPDATE NOT SUCCESS                              01010000
010200* 15)VALUE 15- PK CPT INSERT NOT SUCCESS                          01020000
010300* 16)VALUE 16- PK CPT DELETE NOT SUCCESS                          01030000
010400* 17)VALUE 17- PK CPT UPDATE NOT SUCCESS                          01040000
010500* 18)VALUE 18- PK UPC INSERT NOT SUCCESS                          01050000
010600* 19)VALUE 19- PK UPC DELETE NOT SUCCESS                          01060000
010700* 20)VALUE 20- PK UPC UPDATE NOT SUCCESS                          01070000
010800* 21)VALUE 21- POPRPK INSERT NOT SUCCESS                          01080000
010900* 22)VALUE 22- POPRPK DELETE NOT SUCCESS                          01090000
011000* 23)VALUE 23- POPRPK UPDATE NOT SUCCESS                          01100000
011010* 24)VALUE 24- BRAND ROW NOT FOUND                                01101007
011100*                                                                 01110000
011200* UNITS OF WORK AND COMMITS:                                      01120000
011300* --------------------------                                      01130000
011400* A UNIT OF WORK FOR A DB2 COMMIT WILL BE COMPLETE WHEN A         01140000
011500* MESSAGE FOR A ITEM HAS BEEN READ FROM THE QUEUE,                01150000
011600* AND INSERTED OR DELETED TO XLT_VND_STYL, XLT_SKU OR UPC TABLES. 01160000
011700* THE DB2 COMMIT IS PERFORMED.                                    01170000
011800* THEN AN MQ COMMIT WILL BE PERFORMED TO PERMANENTLY 'REMOVE' THE 01180000
011900* MESSAGES FROM THE ITEM QUEUE.                                   01190000
012000* MQ COMMITS ARE ALSO PERFORMED AFTER AN ERROR MESSAGE HAS BEEN   01200000
012100* WRITTEN TO THE ERROR QUEUE.                                     01210000
012200*                                                                 01220000
012300*                                                                 01230000
012400******************************************************************01240000
012500 ENVIRONMENT DIVISION.                                            01250000
012600******************************************************************01260000
012700                                                                  01270000
012800 CONFIGURATION SECTION.                                           01280000
012900                                                                  01290000
013000 SOURCE-COMPUTER.        IBM-3090.                                01300000
013100 OBJECT-COMPUTER.        IBM-3090.                                01310000
013200                                                                  01320000
013300 INPUT-OUTPUT SECTION.                                            01330000
013400                                                                  01340000
013500 FILE-CONTROL.                                                    01350000
013600                                                                  01360000
013700* ------------------------------------------------------------- * 01370000
013800*  CONTROL CARD 1 = QUEUE MANAGER NAME                            01380000
013900*  READ CONTROL CARD TO GET QUEUE MANAGER NAME                    01390000
014000* ------------------------------------------------------------- * 01400000
014100     SELECT CONTROL-CARD-1                                        01410000
014200         FILE STATUS IS CONTROL-CARD-1-STATUS                     01420000
014300            ASSIGN TO UT-S-INP01.                                 01430000
014400                                                                  01440000
014500* ------------------------------------------------------------- * 01450000
014600*  CONTROL CARD 2 = TRANSACTION QUEUE NAME                        01460000
014700*  READ CONTROL CARD TO GET TRANSACTION QUEUE NAME FOR ITEM       01470000
014800*  ORDER PUTS.                                                    01480000
014900* ------------------------------------------------------------- * 01490000
015000     SELECT CONTROL-CARD-2                                        01500000
015100         FILE STATUS IS CONTROL-CARD-2-STATUS                     01510000
015200            ASSIGN TO UT-S-INP02.                                 01520000
015300                                                                  01530000
015400* ------------------------------------------------------------- * 01540000
015500*  CONTROL CARD 3 = ITEM ERROR QUEUE                              01550000
015600*  READ CONTROL CARD TO GET ERROR QUEUE NAME FOR PUTS             01560000
015700* ------------------------------------------------------------- * 01570000
015800     SELECT CONTROL-CARD-3                                        01580000
015900         FILE STATUS IS CONTROL-CARD-3-STATUS                     01590000
016000            ASSIGN TO UT-S-INP03.                                 01600000
016100                                                                  01610000
016200* ------------------------------------------------------------- * 01620000
016300*  OUTPUT FILE = ITEM MESSAGE QUEUE                               01630000
016400*  FOR EACH MESSAGE THAT WAS PROCESSED, SUCCESSFULL OR NOT        01640000
016500* ------------------------------------------------------------- * 01650000
016600     SELECT MSG-DATA-COLLECT-FILE                                 01660000
016700            ASSIGN TO OUT01.                                      01670000
016800                                                                  01680000
016900******************************************************************01690000
017000 DATA DIVISION.                                                   01700000
017100******************************************************************01710000
017200                                                                  01720000
017300 FILE SECTION.                                                    01730000
017400                                                                  01740000
017500 FD  CONTROL-CARD-1                                               01750000
017600     RECORDING MODE F                                             01760000
017700     BLOCK CONTAINS 0 RECORDS                                     01770000
017800     LABEL RECORDS ARE OMITTED.                                   01780000
017900 01  CONTROL-CARD-1-LINE              PIC  X(80).                 01790000
018000                                                                  01800000
018100 FD  CONTROL-CARD-2                                               01810000
018200     RECORDING MODE F                                             01820000
018300     BLOCK CONTAINS 0 RECORDS                                     01830000
018400     LABEL RECORDS ARE OMITTED.                                   01840000
018500 01  CONTROL-CARD-2-LINE              PIC  X(80).                 01850000
018600                                                                  01860000
018700 FD  CONTROL-CARD-3                                               01870000
018800     RECORDING MODE F                                             01880000
018900     BLOCK CONTAINS 0 RECORDS                                     01890000
019000     LABEL RECORDS ARE OMITTED.                                   01900000
019100 01  CONTROL-CARD-3-LINE              PIC  X(80).                 01910000
019200                                                                  01920000
019300 FD  MSG-DATA-COLLECT-FILE                                        01930000
019400     RECORDING MODE F                                             01940000
019500     BLOCK CONTAINS 0 RECORDS                                     01950000
019600     LABEL RECORDS ARE OMITTED.                                   01960000
019700 01  MSG-DATA-COLLECT-LINE         PIC X(450).                    01970000
019800                                                                  01980000
019900******************************************************************01990000
020000 WORKING-STORAGE SECTION.                                         02000000
020100******************************************************************02010000
020200                                                                  02020000
020300******************************************************************02030000
020400*  LV-LINKAGE-VARIABLES.                                          02040000
020500******************************************************************02050000
020600                                                                  02060000
020700 01  LV-LINKAGE-VARIABLES.                                        02070000
020800     05  LV-IMRD075-RECORD         PIC X(137).                    02080000
020900     05  LV-RETURN-CODE            PIC X(04).                     02090000
021000                                                                  02100000
021100******************************************************************02110000
021200*  COMMUNICATIONS AREA FOR DB2                                    02120000
021300******************************************************************02130000
021400     EXEC SQL                                                     02140000
021500          INCLUDE SQLCA                                           02150000
021600     END-EXEC.                                                    02160000
021700                                                                  02170000
021800******************************************************************02180000
021900*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN ITEM DATA             02190000
022000*      (XLT_VND_STYL)         FOR VENDOR STYLE                    02200000
022100******************************************************************02210000
022200     EXEC SQL                                                     02220000
022300          INCLUDE XLT00004                                        02230000
022400     END-EXEC.                                                    02240000
022500                                                                  02250000
022510******************************************************************02251008
022520*  DB2 TABLE DECLARATION - LOGISTICS DOMAIN BRAND DATA            02252008
022530*      (XLT_BRND)             FOR BRAND ID                        02253008
022540******************************************************************02254008
022550     EXEC SQL                                                     02255008
022560          INCLUDE XLT00043                                        02256008
022570     END-EXEC.                                                    02257008
022580                                                                  02258008
022600******************************************************************02260000
022700*  DB2 TABLE DECLARATION -  LOGISTICS DOMAIN ITEM DATA            02270000
022800*      (XLT_SKU)               FOR SKU                            02280000
022900******************************************************************02290000
023000     EXEC SQL                                                     02300000
023100          INCLUDE XLT00003                                        02310000
023200     END-EXEC.                                                    02320000
023300                                                                  02330000
023400******************************************************************02340000
023500*  DB2 TABLE DECLARATION -  LOGISTICS DOMAIN ITEM DATA            02350000
023600*      (XLT_UPC)               FOR UPC                            02360000
023700******************************************************************02370000
023800     EXEC SQL                                                     02380000
023900          INCLUDE XLT00006                                        02390000
024000     END-EXEC.                                                    02400000
024100                                                                  02410000
024200******************************************************************02420000
024300*  DB2 TABLE DECLARATION -  CROSSREFERANCE DATA                   02430000
024400*      (TSKXREF)               FOR SKU                            02440000
024500******************************************************************02450000
024600     EXEC SQL                                                     02460000
024700          INCLUDE TSKXREF                                         02470000
024800     END-EXEC.                                                    02480000
024900                                                                  02490000
025000******************************************************************02500000
025100*  DB2 TABLE DECLARATION -  UPC TABLE                             02510000
025200*      (TUPC) - THIS IS TEMPORARY.                                02520000
025300******************************************************************02530000
025400     EXEC SQL                                                     02540000
025500          INCLUDE TUPC                                            02550000
025600     END-EXEC.                                                    02560000
025610                                                                  02561048
025611**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 02561163
025620******************************************************************02562048
025630*  DB2 TABLE DECLARATION - MERCHANDISE AREA VENDOR STYLE          02563049
025640*      (TMDARVS)                                                  02564049
025650******************************************************************02565048
025660     EXEC SQL                                                     02566048
025670          INCLUDE TMDARVS                                         02567048
025680     END-EXEC.                                                    02568048
025700**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 02570063
025710                                                                  02571050
025800******************************************************************02580000
025900* INPUT LAYOUT - LEGACY ITEM MAINTENANCE                          02590000
026000******************************************************************02600000
026100     COPY IMRD008.                                                02610000
026200                                                                  02620000
026300******************************************************************02630000
026400* INPUT LAYOUT - LEGACY PACK ITEM MAINTENANCE                     02640000
026500******************************************************************02650000
026600     COPY IMRD075.                                                02660000
026700                                                                  02670000
026800******************************************************************02680000
026900* I/O LAYOUT - ITEM MESSAGE ERROR RECORD.                         02690000
027000******************************************************************02700000
027100     COPY XLRD005.                                                02710000
027200                                                                  02720000
027300******************************************************************02730000
027400*  WORK AREA FOR SQL ERROR ROUTINE 'DSNTIAR'.                     02740000
027500******************************************************************02750000
027600     COPY DPWS004.                                                02760000
027700                                                                  02770000
027800 01  ABEND-CODE                      PIC S9(04)    VALUE +0       02780000
027900                                                   COMP SYNC.     02790000
028000 01  PA-PROGRAM-ACCUMULATORS.                                     02800000
028100     05  PA-TOTALS.                                               02810000
028200         10 PA-END-OF-RUN-MESSAGES    PIC S9(06) VALUE +0 COMP-3. 02820000
028300         10 PA-999-STOP-PROC-MESSAGES PIC S9(06) VALUE +0 COMP-3. 02830000
028400         10 PA-TOTAL-VNDSTYL-INSERTS  PIC S9(09) VALUE +0 COMP-3. 02840000
028500         10 PA-TOTAL-VNDSTYL-DELETES  PIC S9(09) VALUE +0 COMP-3. 02850000
028600         10 PA-TOTAL-VNDSTYL-UPDATES  PIC S9(09) VALUE +0 COMP-3. 02860000
028601*CLP 07/10/2015 START                                             02860102
028610         10 PA-TOTAL-BRAND-INSERTS    PIC S9(09) VALUE +0 COMP-3. 02861002
028630         10 PA-TOTAL-BRAND-UPDATES    PIC S9(09) VALUE +0 COMP-3. 02863002
028640*CLP 07/10/2015 END                                               02864002
028700         10 PA-TOTAL-SKU-UPDATES      PIC S9(09) VALUE +0 COMP-3. 02870000
028800         10 PA-TOTAL-SKU-INSERTS      PIC S9(09) VALUE +0 COMP-3. 02880000
028900         10 PA-TOTAL-SKU-DELETES      PIC S9(09) VALUE +0 COMP-3. 02890000
029000         10 PA-TOTAL-UPC-UPDATES      PIC S9(09) VALUE +0 COMP-3. 02900000
029100         10 PA-TOTAL-UPC-INSERTS      PIC S9(09) VALUE +0 COMP-3. 02910000
029200         10 PA-TOTAL-UPC-DELETES      PIC S9(09) VALUE +0 COMP-3. 02920000
029300         10 PA-TOTAL-XLTPAK-MAINT     PIC S9(09) VALUE +0 COMP-3. 02930000
029400         10 PA-TOTAL-XLTSKU-MAINT     PIC S9(09) VALUE +0 COMP-3. 02940000
029500         10 PA-TOTAL-XLTUPC-MAINT     PIC S9(09) VALUE +0 COMP-3. 02950000
029600         10 PA-TOTAL-TPOPRPK-UPD      PIC S9(09) VALUE +0 COMP-3. 02960000
029700         10 PA-TOTAL-GETS             PIC S9(09) VALUE +0 COMP-3. 02970000
029800         10 PA-TOTAL-BACKUP-RECS      PIC S9(09) VALUE +0 COMP-3. 02980000
029900         10 PA-TOTAL-ERRORQ-RECS      PIC S9(09) VALUE +0 COMP-3. 02990000
030000         10 PA-TOTAL-DB2-COMMITS      PIC S9(09) VALUE +0 COMP-3. 03000000
030100         10 PA-TOTAL-MQ-COMMITS       PIC S9(09) VALUE +0 COMP-3. 03010000
030200         10 PA-ENDS-IN-MSG            PIC S9(09) VALUE +0 COMP-3. 03020000
030300         10 PA-CHARS-IN-MSG           PIC  9(09) VALUE  0.        03030000
030400         10 PA-BYTES-BEYOND-END       PIC  9(09) VALUE  0.        03040000
030500                                                                  03050000
030600 01  PS-PROGRAM-SWITCHES.                                         03060000
030700     05  PS-GOOD-MSG-SW                PIC  X(01)    VALUE 'N'.   03070000
030800         88  PS-GOOD-MSG-YES                         VALUE 'Y'.   03080000
030900         88  PS-GOOD-MSG-NO                          VALUE 'N'.   03090000
031000     05  PS-CONTROL-CARD-1-END-SW      PIC  X(01)    VALUE 'N'.   03100000
031100         88  PS-CONTROL-CARD-1-END-YES               VALUE 'Y'.   03110000
031200         88  PS-CONTROL-CARD-1-END-NO                VALUE 'N'.   03120000
031300     05  PS-CONTROL-CARD-2-END-SW      PIC  X(01)    VALUE 'N'.   03130000
031400         88  PS-CONTROL-CARD-2-END-YES               VALUE 'Y'.   03140000
031500         88  PS-CONTROL-CARD-2-END-NO                VALUE 'N'.   03150000
031600     05  PS-CONTROL-CARD-3-END-SW      PIC  X(01)    VALUE 'N'.   03160000
031700         88  PS-CONTROL-CARD-3-END-YES               VALUE 'Y'.   03170000
031800         88  PS-CONTROL-CARD-3-END-NO                VALUE 'N'.   03180000
031900     05  PS-TIME-TO-END-PROGRAM-SW     PIC  X(01)    VALUE 'N'.   03190000
032000         88  PS-TIME-TO-END-PROGRAM-YES              VALUE 'Y'.   03200000
032100         88  PS-TIME-TO-END-PROGRAM-NO               VALUE 'N'.   03210000
032200     05  PS-END-OF-MSG-SW              PIC  X(01)    VALUE 'N'.   03220000
032300         88  PS-END-OF-MSG-YES                       VALUE 'Y'.   03230000
032400         88  PS-END-OF-MSG-NO                        VALUE 'N'.   03240000
032500     05  PS-END-OF-FILE-SW             PIC  X(01)    VALUE 'N'.   03250000
032600         88  PS-END-OF-FILE-YES                      VALUE 'Y'.   03260000
032700         88  PS-END-OF-FILE-NO                       VALUE 'N'.   03270000
032800     05  PS-ERROR-SW                   PIC  X(01)    VALUE 'N'.   03280000
032900         88  PS-ERROR-YES                            VALUE 'Y'.   03290000
033000         88  PS-ERROR-NO                             VALUE 'N'.   03300000
033100     05  PS-ERROR-QUEUE-IS-OPEN-SW     PIC  X(01)    VALUE 'N'.   03310000
033200         88  PS-ERROR-QUEUE-IS-OPEN-YES              VALUE 'Y'.   03320000
033300         88  PS-ERROR-QUEUE-IS-OPEN-NO               VALUE 'N'.   03330000
033400     05  PS-UPDATE-SKU-SW              PIC  X(01)    VALUE 'N'.   03340000
033500         88  PS-UPDSKU-YES                           VALUE 'Y'.   03350000
033600         88  PS-UPDSKU-NO                            VALUE 'N'.   03360000
033700     05  PS-UPDATE-UPC-SW              PIC  X(01)    VALUE 'N'.   03370000
033800         88  PS-UPDUPC-YES                           VALUE 'Y'.   03380000
033900         88  PS-UPDUPC-NO                            VALUE 'N'.   03390000
034000     05  PS-EMAIL-SW                   PIC  X(01)    VALUE 'N'.   03400000
034100         88  PS-EMAIL-YES                            VALUE 'Y'.   03410000
034200         88  PS-EMAIL-NO                             VALUE 'N'.   03420000
034300     05  PS-UPDATE-SW                  PIC  X(01)    VALUE 'N'.   03430000
034400         88  PS-UPDATE                               VALUE 'Y'.   03440000
034500         88  PS-NO-UPDATE                            VALUE 'N'.   03450000
034600     05  PS-SKU-STAT-SW                PIC  X(01)    VALUE 'N'.   03460000
034700         88  PS-YES-SKU-STAT-CHG                     VALUE 'Y'.   03470000
034800         88  PS-NO-SKU-STAT-CHG                      VALUE 'N'.   03480000
034900*CLP 07/20/2015 START                                             03490007
034910     05  PS-BRAND-EXISTS-SW            PIC  X(01)    VALUE 'N'.   03491007
034920         88  PS-BRAND-EXISTS-YES                     VALUE 'Y'.   03492007
034930         88  PS-BRAND-EXISTS-NO                      VALUE 'N'.   03493007
034931     05  PS-UPDATE-BRAND-SW            PIC  X(01)    VALUE 'N'.   03493130
034932         88  PS-UPDATE-BRAND-YES                     VALUE 'Y'.   03493230
034933         88  PS-UPDATE-BRAND-NO                      VALUE 'N'.   03493330
034934     05  PS-P2359-DB2-UPDATE-SW        PIC  X(01)    VALUE 'N'.   03493445
034935         88  PS-P2359-DB2-UPDATE-YES                 VALUE 'Y'.   03493545
034936         88  PS-P2359-DB2-UPDATE-NO                  VALUE 'N'.   03493645
034937*CLP 07/20/2015 END                                               03493745
034940***************************************************************** 03494007
035000* FILE OPEN STATUS'S ON THE CONTROL CARDS USED FOR GETTING        03500000
035100* MQ-SERIES QUEUE MANAGER AND QUEUE NAME.                         03510000
035200***************************************************************** 03520000
035300 01  CONTROL-CARD-1-STATUS            PIC X(02)   VALUE '00'.     03530000
035400     88  CONTROL-CARD-1-SUCCESS                   VALUE '00'.     03540000
035500     88  CONTROL-CARD-1-ERROR                     VALUE '42'.     03550040
035600 01  CONTROL-CARD-2-STATUS            PIC X(02)   VALUE '00'.     03560000
035700     88  CONTROL-CARD-2-SUCCESS                   VALUE '00'.     03570000
035800     88  CONTROL-CARD-2-ERROR                     VALUE '42'.     03580000
035900 01  CONTROL-CARD-3-STATUS            PIC X(02)   VALUE '00'.     03590000
036000     88  CONTROL-CARD-3-SUCCESS                   VALUE '00'.     03600000
036100     88  CONTROL-CARD-3-ERROR                     VALUE '42'.     03610000
036200                                                                  03620000
036300 01  PC-PROGRAM-CONSTANTS.                                        03630000
036400     05  PC-005                     PIC X(03)  VALUE '005'.       03640000
036500     05  PC-010                     PIC X(03)  VALUE '010'.       03650000
036600     05  PC-015                     PIC X(03)  VALUE '015'.       03660000
036700     05  PC-020                     PIC X(03)  VALUE '020'.       03670000
036800     05  PC-025                     PIC X(03)  VALUE '025'.       03680000
036900     05  PC-030                     PIC X(03)  VALUE '030'.       03690000
037000     05  PC-031                     PIC X(03)  VALUE '031'.       03700000
037100     05  PC-040                     PIC X(03)  VALUE '040'.       03710000
037200     05  PC-045                     PIC X(03)  VALUE '045'.       03720000
037300     05  PC-050                     PIC X(03)  VALUE '050'.       03730000
037400     05  PC-055                     PIC X(03)  VALUE '055'.       03740000
037500     05  PC-060                     PIC X(03)  VALUE '060'.       03750000
037600     05  PC-MAX-RETRIES             PIC S9(03) VALUE +5 COMP-3.   03760000
037700     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'XLKUP003'.  03770000
037800     05  PC-ITEM                    PIC X(04)  VALUE 'ITEM'.      03780000
037900     05  PC-MQC                     PIC X(03)  VALUE 'MQC'.       03790000
038000     05  PC-HDR                     PIC X(03)  VALUE 'HDR'.       03800000
038100     05  PC-DTL                     PIC X(03)  VALUE 'DTL'.       03810000
038200     05  PC-01                      PIC 9(02)  VALUE 01.          03820000
038300     05  PC-001                     PIC 9(03)  VALUE 001.         03830000
038400     05  PC-GFT                     PIC X(03)  VALUE 'GFT'.       03840000
038500     05  PC-END                     PIC X(03)  VALUE 'END'.       03850000
038600     05  PC-MQPUT-RETRY-COUNTER     PIC 9(3)   VALUE ZERO.        03860000
038700     05  PC-N                       PIC X(01)  VALUE 'N'.         03870000
038800     05  PC-READY                   PIC X(06)  VALUE 'READY '.    03880000
038900     05  PC-CMPLTD                  PIC X(06)  VALUE 'CMPLTD'.    03890000
039000     05  PC-DEFAULT-TMST            PIC X(26)  VALUE              03900000
039100                                    '0001-01-01-00.00.00.000000'. 03910000
039200     05  PC-END-RUN-MSG             PIC X(18)  VALUE              03920000
039300                                            'END RUN OF PROGRAM'. 03930000
039400                                                                  03940000
039500     05  PC-CALLED-PROGRAM            PIC X(08).                  03950000
039600         88  PC-CALL-XLKUP019-PGM              VALUE 'XLKUP019'.  03960000
039700         88  PC-CALL-XLKUP020-PGM              VALUE 'XLKUP020'.  03970000
039800         88  PC-CALL-XLKUP021-PGM              VALUE 'XLKUP021'.  03980000
039900         88  PC-CALL-XLKUP022-PGM              VALUE 'XLKUP022'.  03990000
040000                                                                  04000000
040100 01  DK-DB2-KEYS.                                                 04010000
040200     05  DK-ITEM-KEY-RMS-STYL-ID      PIC S9(8)V VALUE ZEROS      04020000
040300                                               COMP-3.            04030000
040400     05  DK-SKU                       PIC S9(8)V VALUE ZEROS      04040000
040500                                               COMP-3.            04050000
040600     05  DK-ITEM-KEY-INTR-UPC-ID      PIC S9(9)  COMP.            04060000
040700     05  DK-ITEM-KEY-UPC-ID           PIC S9(9)  COMP.            04070000
040800     05  DK-SKU-RECL-REN-UPC-ID-REN   PIC S9(9) COMP.             04080000
040900     05  DK-SKU-RECL-REN-UPC-NBR-NEW  PIC S9(15)V COMP-3.         04090000
041000     05  DK-ITEM-KEY-UPC-NBR          PIC S9(15)V COMP-3.         04100000
041100     05  DK-UPC-MOVE-INTR-UPC-ID-NEW  PIC S9(9) COMP.             04110000
041101*CLP 07/10/2015 START                                             04110102
041110     05  DK-BRND-KEY-ID               PIC S9(4)  COMP.            04111002
041120*CLP 07/10/2015 END                                               04112002
041200                                                                  04120000
041300 01  PV-PROGRAM-VARIABLES.                                        04130000
041400     05  PV-CURRENT-PRC-CNTL-TMST   PIC X(26)  VALUE SPACES.      04140000
041500     05  PV-RETRY-COUNTER           PIC S9(04) VALUE +0 COMP SYNC.04150000
041600     05  PV-ITEM-COUNTER            PIC S9(04) VALUE +0 COMP SYNC.04160000
041700     05  PV-PARAGRAPH               PIC X(48)  VALUE SPACES.      04170000
041800     05  PV-REC-SEQ-NBR             PIC S9(09) VALUE +0 COMP.     04180000
041900     05  PV-VERSION-CNTL-NBR        PIC S9(02)V9(02) COMP-3.      04190000
042000     05  PV-MSG-LENGTH              PIC S9(9)  BINARY.            04200000
042100     05  PV-DATA-LENGTH             PIC S9(9) BINARY.             04210000
042200     05  PV-HOLD-COMPLETION-CODE    PIC S9(9)  BINARY.            04220000
042300     05  PV-HOLD-REASON             PIC S9(9)  BINARY.            04230000
042400     05  PV-HOLD-CORRELID           PIC  X(24) VALUE SPACES.      04240000
042500     05  PV-REC-TYP-LENGTH          PIC 9(09)  VALUE 3.           04250000
042600     05  PV-LAST-CNTL-SEQ-NBR       PIC S9(09) VALUE +0 COMP.     04260000
042700     05  PV-MSG-SIZE                PIC 9(09)  VALUE ZEROES.      04270000
042800     05  PV-HDR-LENGTH              PIC 9(09)  VALUE ZEROES.      04280000
042900     05  77-DTL-LENGTH              PIC 9(09)  VALUE ZEROES.      04290000
043000     05  PV-GFT-LENGTH              PIC 9(09)  VALUE ZEROES.      04300000
043100                                                                  04310000
043200     05  PV-EDIT-INTR-UPC-ID        PIC S9(18) COMP.              04320000
043300     05  PV-INTR-UPC-ID-R REDEFINES PV-EDIT-INTR-UPC-ID.          04330000
043400         10  FILLER                 PIC X(04).                    04340000
043500         10  PV-INTR-UPC-ID-COMP    PIC S9(09) COMP.              04350000
043600     05  PV-INTR-UPC-ID             PIC S9(09) COMP.              04360000
043700                                                                  04370000
043800     05  PV-EDIT-INTR-UPC-ID-NEW    PIC S9(18) COMP.              04380000
043900     05  PV-INTR-UPC-ID-NEW-R REDEFINES PV-EDIT-INTR-UPC-ID-NEW.  04390000
044000         10  FILLER                     PIC X(04).                04400000
044100         10  PV-INTR-UPC-ID-NEW-COMP    PIC S9(09) COMP.          04410000
044200     05  PV-INTR-UPC-ID-NEW             PIC S9(09) COMP.          04420000
044300                                                                  04430000
044400     05  PV-EDIT-UPC-ID             PIC S9(18) COMP.              04440000
044500     05  PV-UPC-ID-R REDEFINES PV-EDIT-UPC-ID.                    04450000
044600         10  FILLER                 PIC X(04).                    04460000
044700         10  PV-UPC-ID-COMP         PIC S9(09) COMP.              04470000
044800     05  PV-UPC-ID                  PIC S9(09) COMP.              04480000
044900                                                                  04490000
045000     05  PV-EDIT-REN-UPC-ID         PIC S9(18) COMP.              04500000
045100     05  PV-REN-UPC-ID-R REDEFINES PV-EDIT-REN-UPC-ID.            04510000
045200         10  FILLER                 PIC X(04).                    04520000
045300         10  PV-REN-UPC-ID-COMP     PIC S9(09) COMP.              04530000
045400     05  PV-REN-UPC-ID              PIC S9(09) COMP.              04540000
045500     05  PV-DISP-UPC-NBR            PIC 9(15).                    04550000
045510     05  PV-RMS-STYL-ID             PIC 9(9).                     04551054
045520     05  PV-BRAND-ID                PIC 9(5).                     04552053
045600                                                                  04560000
045700 01  PV-CURRENT-TMST                PIC X(26)  VALUE SPACES.      04570000
045800 01  FILLER REDEFINES                                             04580000
045900     PV-CURRENT-TMST.                                             04590000
046000     05  PV-TMST-CCYY-MM-DD         PIC X(10).                    04600000
046100     05  FILLER                     PIC X(01).                    04610000
046200     05  PV-TMST-HH-MM-SS           PIC 9(08).                    04620000
046300     05  FILLER                     PIC X(01).                    04630000
046400     05  PV-TMST-LAST6              PIC 9(06).                    04640000
046500                                                                  04650000
046600*PV-MSG IS WHAT GETS BROKEN DOWN INTO DTLS/GFTS/END               04660000
046700 01  PV-MSG.                                                      04670000
046800     05  PV-MSG-END                 PIC X(18).                    04680000
046900         88 PV-END-RUN-MSG          VALUE 'END RUN OF PROGRAM'.   04690000
047000     05  FILLER                     PIC X(432).                   04700000
047100                                                                  04710000
047200 01  PV-DTL.                                                      04720000
047300     05  PV-DTL-EVENT               PIC 9(03)   VALUE ZERO.       04730000
047400     05  FILLER                     PIC X(447)  VALUE SPACE.      04740000
047500                                                                  04750000
047600 01  PV-HOLD-FIELDS.                                              04760000
047700     05  PV-HOLD-HDR                PIC X(568)  VALUE SPACE.      04770000
047800     05  PV-HOLD-ITEM.                                            04780000
047900         10  PV-HOLD-DTL            PIC X(245)  VALUE SPACE.      04790000
048000         10  PV-HOLD-GFT            PIC X(303)  VALUE SPACE.      04800000
048100                                                                  04810000
048200 01  PV-ABEND-VARIABLES.                                          04820000
048300     05  PV-ABEND-CODE              PIC S9(04) VALUE +0 COMP SYNC.04830000
048400     88  ABEND-4001-WRITE-ERROR                      VALUE +4001. 04840000
048500     88  ABEND-4002-READ-ERROR                       VALUE +4002. 04850000
048600     88  ABEND-4003-CTRL-CARD-ERROR                  VALUE +4003. 04860000
048700     88  ABEND-4004-TABLE-ERROR                      VALUE +4004. 04870000
048800     88  ABEND-4005-OPEN-ERROR                       VALUE +4005. 04880000
048900     88  ABEND-4006-CLOSE-ERROR                      VALUE +4006. 04890000
049000     88  ABEND-4007-SEQUENCE-ERROR                   VALUE +4007. 04900000
049100     88  ABEND-4008-DATA-ERROR                       VALUE +4008. 04910000
049200     88  ABEND-4009-KEY-DATA-ERROR                   VALUE +4009. 04920000
049300     88  ABEND-4013-DB2-ERROR                        VALUE +4013. 04930000
049400     88  ABEND-4019-CAL-SUB-ERROR                    VALUE +4019. 04940000
049500     88  ABEND-4020-MQ-ERROR                         VALUE +4020. 04950000
049600     88  ABEND-4444-FORCED-ABEND                     VALUE +4444. 04960000
049700                                                                  04970000
049800 01  PE-MQ-ABEND-VARIABLES.                                       04980000
049900     10  PE-MQ-QMANAGER             PIC X(05) VALUE SPACES.       04990000
050000     10  PE-MQ-QNAME                PIC X(30) VALUE SPACES.       05000000
050100     10  PE-MQ-COMPLETION-CODE      PIC 9(04) VALUE ZEROS.        05010000
050200     10  PE-MQ-REASON-CODE          PIC 9(04) VALUE ZEROS.        05020000
050300                                                                  05030000
050400****************************************************************  05040000
050500**     M Q   S E R I E S    W O R K I N G   S T O R A G E     *   05050000
050600**                                                                05060000
050700**                  M  Q    C O P Y B O O K S                     05070000
050800*                                                                 05080000
050900*                                                                 05090000
051000*                                                                 05100000
051100****************************************************************  05110000
051200 01  MQM-OBJECT-DESCRIPTOR.                                       05120000
051300     COPY CMQODV.                                                 05130000
051400                                                                  05140000
051500 01  MQM-MESSAGE-DESCRIPTOR.                                      05150000
051600     COPY CMQMDV.                                                 05160000
051700                                                                  05170000
051800 01  MQM-GET-MESSAGE-OPTIONS.                                     05180000
051900     COPY CMQGMOV.                                                05190000
052000                                                                  05200000
052100 01  MQM-PUT-MESSAGE-OPTIONS.                                     05210000
052200     COPY CMQPMOV.                                                05220000
052300                                                                  05230000
052400 01  MQM-CONSTANTS.                                               05240000
052500     COPY CMQV.                                                   05250000
052600                                                                  05260000
052700****************************************************************  05270000
052800** CONTROL CARDS FOR QUEUE MANAGER AND QUEUE NAMES                05280000
052900*                                                                 05290000
053000*                                                                 05300000
053100*                                                                 05310000
053200****************************************************************  05320000
053300* ------------------------------------------------------------- * 05330000
053400*  CONTROL CARD 1 = QUEUE MANAGER NAME                            05340000
053500*  READ CONTROL CARD TO GET QUEUE MANAGER NAME                    05350000
053600* ------------------------------------------------------------- * 05360000
053700 01  CC-CONTROL-CARD-1.                                           05370000
053800     05  CC-QMGR-NAME                 PIC X(48).                  05380000
053900     05  FILLER                       PIC X(32).                  05390000
054000                                                                  05400000
054100* ------------------------------------------------------------- * 05410000
054200*  CONTROL CARD 2 = TRANSACTION QUEUE NAME                        05420000
054300*  READ CONTROL CARD TO GET THE TRANSACTION QUEUE NAME            05430000
054400* ------------------------------------------------------------- * 05440000
054500 01  CC-CONTROL-CARD-2.                                           05450000
054600     05  CC-ITEM-QUEUE-NAME           PIC X(48).                  05460000
054700     05  FILLER                       PIC X(32).                  05470000
054800                                                                  05480000
054900* ------------------------------------------------------------- * 05490000
055000*  CONTROL CARD 3 = ITEM ERROR NAME                               05500000
055100*  READ CONTROL CARD TO GET THE TRANSACTION QUEUE NAME            05510000
055200* ------------------------------------------------------------- * 05520000
055300 01  CC-CONTROL-CARD-3.                                           05530000
055400     05  CC-ERROR-QUEUE-NAME          PIC X(48).                  05540000
055500     05  FILLER                       PIC X(32).                  05550000
055600                                                                  05560000
055700****************************************************************  05570000
055800** MQ SERIES CONSTANTS FOR CALLING MODULES SUCH AS PUT AND    **  05580000
055900*  OPEN, CONNECT, DISCONNECT.                                     05590000
056000*                                                                 05600000
056100*                                                                 05610000
056200****************************************************************  05620000
056300 01  MQ-WORKING-STORAGE.                                          05630000
056400     05  PC-MQCONN                PIC X(08)   VALUE 'CSQBCONN'.   05640000
056500     05  PC-MQOPEN                PIC X(08)   VALUE 'CSQBOPEN'.   05650000
056600     05  PC-MQINQ                 PIC X(08)   VALUE 'CSQBINQ'.    05660000
056700     05  PC-MQPUT                 PIC X(8)    VALUE 'CSQBPUT'.    05670000
056800     05  PC-MQGET                 PIC X(08)   VALUE 'CSQBGET'.    05680000
056900     05  PC-MQCMIT                PIC X(8)    VALUE 'CSQBCOMM'.   05690000
057000     05  PC-MQBACK                PIC X(8)    VALUE 'CSQBBACK'.   05700000
057100     05  PC-MQCLOSE               PIC X(08)   VALUE 'CSQBCLOS'.   05710000
057200     05  PC-MQDISC                PIC X(08)   VALUE 'CSQBDISC'.   05720000
057300     05  PC-QMGR-NAME                 PIC X(4)  VALUE SPACES.     05730000
057400         88  PC-PROD-QMGR-NAME                  VALUE 'QKSP'.     05740000
057500         88  PC-ACCEPT-QMGR-NAME                VALUE 'QKSQ'.     05750000
057600         88  PC-TEST-QMGR-NAME                  VALUE 'QKST'.     05760000
057700     05  PC-RESPONSE-QNAME            PIC X(30) VALUE SPACES.     05770000
057800     05  PC-WAIT-15-SECS              PIC S9(9) VALUE 15000.      05780000
057900     05  PC-WAIT-6-SECS               PIC S9(9) VALUE 6000.       05790000
058000     05  PC-DELAY-INTERVAL.                                       05800000
058100         10  FILLER                   PIC X(2)  VALUE SPACES.     05810000
058200         10  PC-DELAY-TIME            PIC 9(8)  VALUE 1500.       05820000
058300                                                                  05830000
058400****************************************************************  05840000
058500** QUEUE MANAGER HANDLE                                           05850000
058600*  QUEUE HANDLES                                                  05860000
058700*                                                                 05870000
058800*                                                                 05880000
058900****************************************************************  05890000
059000 01 PV-MQ-PROGRAM-HANDLES.                                        05900000
059100     05  PV-QMGR-NAME                 PIC X(48).                  05910000
059200     05  PV-HCONN                     PIC S9(9) BINARY VALUE 0.   05920000
059300     05  PV-GQ-HANDLE                 PIC S9(9) BINARY VALUE 0.   05930000
059400     05  PV-PQ-HANDLE                 PIC S9(9) BINARY VALUE 0.   05940000
059500                                                                  05950000
059600****************************************************************  05960000
059700**                                                                05970000
059800*                                                                 05980000
059900* ERROR PROCESSING VARIABLES                                      05990000
060000* CODES FROM CALLS ARE STORED HERE                                06000000
060100****************************************************************  06010000
060200 01 PV-MQ-PROGRAM-VARIABLES.                                      06020000
060300     05  PV-COMPLETION-CODE           PIC S9(9) BINARY.           06030000
060400     05  PV-REASON                    PIC S9(9) BINARY.           06040000
060500     05  PV-CON-REASON                PIC S9(9) BINARY.           06050000
060600     05  PV-ERROR-MESSAGE             PIC X(48) VALUE SPACES.     06060000
060700     05  PV-OPEN-OPTIONS              PIC S9(9) BINARY.           06070000
060800     05  PV-MSGBUFFER                 PIC X(450) VALUE SPACES.    06080000
060900     05  PV-ERRMSGBUF                 PIC X(500) VALUE SPACES.    06090000
061000     05  PV-MQCHECK                   PIC X(8)  VALUE 'MQR2C'.    06100000
061100     05  PV-MQ-REASON-TEXT            PIC X(30) VALUE SPACES.     06110000
061200                                                                  06120000
061300****************************************************************  06130000
061400**                     E N D   O F   M Q                          06140000
061500*                                                                 06150000
061600*                                                                 06160000
061700****************************************************************  06170000
061800****************************************************************  06180000
061900 PROCEDURE DIVISION.                                              06190000
062000******************************************************************06200000
062100 0000-PROGRAM-MAINLINE.                                           06210000
062200     DISPLAY '************ START OF XLKUP003 ***************'     06220000
062300                                                                  06230000
062400*INIT VARIBLES, SET SWITHCES.                                     06240000
062500     PERFORM 1000-INITIALIZE.                                     06250000
062600     PERFORM 1100-SET-CURRENT-TMST.                               06260000
062700                                                                  06270000
062800*READ CONTROL CARDS(FOR QUEUE MANAGER/QUEUE NAMES).               06280000
062900     PERFORM 1200-READ-CC-CARDS.                                  06290000
063000                                                                  06300000
063100*OPEN OUTPUT MESSAGE SEQUENTIAL FILE.                             06310000
063200     OPEN OUTPUT MSG-DATA-COLLECT-FILE.                           06320000
063300     INITIALIZE MSG-DATA-COLLECT-LINE.                            06330000
063400                                                                  06340000
063500*CONNECT TO QUEUE MANAGER.                                        06350000
063600     PERFORM 3100-MQ-CONNECT-TO-QMGR.                             06360000
063700                                                                  06370000
063800*OPEN THE QUEUE FOR GETS.                                         06380000
063900     PERFORM 3200-MQ-QUEUE-OPEN.                                  06390000
064000                                                                  06400000
064100*GET FIRST MSG FROM QUEUE.                                        06410000
064200     PERFORM 3300-MQ-GET-MSG.                                     06420000
064300                                                                  06430000
064400*PROCESS THE ITEM MESSAGES.                                       06440000
064500     PERFORM 2000-PROCESS-MSGS                                    06450000
064600         UNTIL PS-TIME-TO-END-PROGRAM-YES.                        06460000
064700                                                                  06470000
064800******************************************************************06480000
064900* INITIALIZE VARIABLES.                                           06490000
065000* SET SWITCHES.                                                   06500000
065100******************************************************************06510000
065200 1000-INITIALIZE.                                                 06520000
065300                                                                  06530000
065400     INITIALIZE   PA-TOTAL-VNDSTYL-INSERTS                        06540000
065500                  PA-TOTAL-VNDSTYL-DELETES                        06550000
065600                  PA-TOTAL-VNDSTYL-UPDATES                        06560000
065601*CLP 07/10/2015 START                                             06560103
065610                  PA-TOTAL-BRAND-INSERTS                          06561003
065630                  PA-TOTAL-BRAND-UPDATES                          06563003
065640*CLP 07/10/2015 END                                               06564003
065700                  PA-TOTAL-SKU-INSERTS                            06570000
065800                  PA-TOTAL-SKU-DELETES                            06580000
065900                  PA-TOTAL-SKU-UPDATES                            06590000
066000                  PA-TOTAL-UPC-INSERTS                            06600000
066100                  PA-TOTAL-UPC-DELETES                            06610000
066200                  PA-TOTAL-UPC-UPDATES                            06620000
066300                  PA-TOTAL-XLTPAK-MAINT                           06630000
066400                  PA-TOTAL-XLTSKU-MAINT                           06640000
066500                  PA-TOTAL-XLTUPC-MAINT                           06650000
066600                  PA-TOTAL-TPOPRPK-UPD                            06660000
066700                  PA-TOTAL-GETS                                   06670000
066800                  PA-TOTAL-DB2-COMMITS                            06680000
066900                  PA-TOTAL-MQ-COMMITS                             06690000
067000                  PA-TOTAL-BACKUP-RECS                            06700000
067100                  PV-HOLD-FIELDS                                  06710000
067200                  PV-MSG-LENGTH                                   06720000
067300                  PV-DATA-LENGTH                                  06730000
067400                  DCLXLT00004                                     06740000
067500                  DCLXLT00003                                     06750000
067600                  DCLXLT00006                                     06760003
067601*CLP 07/10/2015 START                                             06760103
067610                  DCLXLT00043                                     06761050
067620*CLP 07/10/2015 END                                               06762003
067700**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 06770063
067701                  DCLTMDARVS.                                     06770150
067710**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 END                   06771063
067800*INIT SWITCHES USED FOR EDITING EACH MSG, CONTINUING RUN OF       06780000
067900*PROGRAM AND OPENING OF THE ERROR QUEUE. ERROR QUEUE IS           06790000
068000*ONLY OPENED IF ERROR IS ENCOUNTERED, AND THEN REMAINS OPEN.      06800000
068100     SET PS-TIME-TO-END-PROGRAM-NO                                06810000
068200         PS-ERROR-QUEUE-IS-OPEN-NO  TO TRUE.                      06820000
068300                                                                  06830000
068400******************************************************************06840000
068500* SET THE CURRENT TIMESTAMP.                                      06850000
068600******************************************************************06860000
068700 1100-SET-CURRENT-TMST.                                           06870000
068800                                                                  06880000
068900     EXEC SQL                                                     06890000
069000         SET :PV-CURRENT-TMST = CURRENT TIMESTAMP                 06900000
069100     END-EXEC                                                     06910000
069200                                                                  06920000
069300     EVALUATE TRUE                                                06930000
069400        WHEN SQLCODE = ZERO                                       06940000
069500            CONTINUE                                              06950000
069600                                                                  06960000
069700        WHEN SQLWARN0 NOT = SPACES                                06970000
069800        WHEN SQLCODE  NOT = ZERO                                  06980000
069900            DISPLAY '**************************************'      06990000
070000            DISPLAY '** ABEND                            **'      07000000
070100            DISPLAY '** PROGRAM = XLKUP003               **'      07010000
070200            DISPLAY '** PARAGRAPH = 1100-SET-CURRENT-TMST**'      07020000
070300            DISPLAY '** SET CURRENT TIMESTAMP            **'      07030000
070400            DISPLAY '** SQLCODE = ' SQLCODE                       07040000
070500            DISPLAY '**************************************'      07050000
070600            PERFORM 9100-SQL-ABEND                                07060000
070700     END-EVALUATE.                                                07070000
070800                                                                  07080000
070900****************************************************************  07090000
071000* READ CONTROL CARDS FOR QMGR NAME AND QUEUE NQME.                07100000
071100* EACH CONTROL CARD MUST CONTAIN A NAME THAT IS NOT SPACES.       07110000
071200****************************************************************  07120000
071300 1200-READ-CC-CARDS.                                              07130000
071400                                                                  07140000
071500*OPEN CC CARD 1 TO OBTAIN QUEUE MANAGER NAME                      07150000
071600      OPEN INPUT CONTROL-CARD-1.                                  07160000
071700      IF CONTROL-CARD-1-ERROR THEN                                07170000
071800         PERFORM 9200-MQ-ABEND                                    07180000
071900      END-IF.                                                     07190000
072000      READ CONTROL-CARD-1 INTO CC-CONTROL-CARD-1                  07200000
072100        AT END                                                    07210000
072200           SET PS-CONTROL-CARD-1-END-YES TO TRUE                  07220000
072300      END-READ.                                                   07230000
072400      IF PS-CONTROL-CARD-1-END-YES THEN                           07240000
072500          DISPLAY PC-CURRENT-PROGRAM-NAME                         07250000
072600              'CONTROL CARD MISSING - FOR QMGR NAME'              07260000
072700          MOVE 'QMGR NAME IS MISSING IN CARD?'                    07270000
072800                TO PV-ERROR-MESSAGE                               07280000
072900          PERFORM 9200-MQ-ABEND                                   07290000
073000      ELSE                                                        07300000
073100          IF CC-QMGR-NAME EQUAL SPACES THEN                       07310000
073200             DISPLAY PC-CURRENT-PROGRAM-NAME                      07320000
073300               'CONTROL CARD MISSING - FOR QMGR NAME'             07330000
073400             MOVE 'QMGR NAME IS SPACES!'                          07340000
073500                  TO PV-ERROR-MESSAGE                             07350000
073600             PERFORM 9200-MQ-ABEND                                07360000
073700          ELSE                                                    07370000
073800             DISPLAY PC-CURRENT-PROGRAM-NAME                      07380000
073900                  ' - CONTROL CARD 1 : '                          07390000
074000                  CC-CONTROL-CARD-1                               07400000
074100          END-IF                                                  07410000
074200      END-IF.                                                     07420000
074300      CLOSE CONTROL-CARD-1.                                       07430000
074400                                                                  07440000
074500*OPEN CC CARD 2 TO OBTAIN QUEUE NAME FOR GETS AND PUTS            07450000
074600      OPEN INPUT CONTROL-CARD-2.                                  07460000
074700      IF CONTROL-CARD-2-ERROR THEN                                07470000
074800         PERFORM 9200-MQ-ABEND                                    07480000
074900      END-IF.                                                     07490000
075000      READ CONTROL-CARD-2 INTO CC-CONTROL-CARD-2                  07500000
075100        AT END                                                    07510000
075200           SET PS-CONTROL-CARD-2-END-YES TO TRUE                  07520000
075300      END-READ.                                                   07530000
075400      IF PS-CONTROL-CARD-2-END-YES THEN                           07540000
075500          DISPLAY PC-CURRENT-PROGRAM-NAME                         07550000
075600              'CONTROL CARD MISSING - FOR QUEUE NAME'             07560000
075700          MOVE 'QUEUE NAME IS MISSING IN CARD?'                   07570000
075800                TO PV-ERROR-MESSAGE                               07580000
075900          PERFORM 9200-MQ-ABEND                                   07590000
076000      ELSE                                                        07600000
076100          IF CC-ITEM-QUEUE-NAME EQUAL SPACES THEN                 07610000
076200             DISPLAY PC-CURRENT-PROGRAM-NAME                      07620000
076300               'CONTROL CARD MISSING - FOR QUEUE NAME'            07630000
076400             MOVE 'QUEUE NAME IS SPACES!'                         07640000
076500                  TO PV-ERROR-MESSAGE                             07650000
076600             PERFORM 9200-MQ-ABEND                                07660000
076700          ELSE                                                    07670000
076800             DISPLAY PC-CURRENT-PROGRAM-NAME                      07680000
076900                  ' - CONTROL CARD 2 : '                          07690000
077000                  CC-CONTROL-CARD-2                               07700000
077100          END-IF                                                  07710000
077200      END-IF.                                                     07720000
077300      CLOSE CONTROL-CARD-2.                                       07730000
077400                                                                  07740000
077500*OPEN CC CARD 3 TO OBTAIN ERROR QUEUE NAME FOR PUTS               07750000
077600      OPEN INPUT CONTROL-CARD-3.                                  07760000
077700      IF CONTROL-CARD-3-ERROR THEN                                07770000
077800         PERFORM 9200-MQ-ABEND                                    07780000
077900      END-IF.                                                     07790000
078000      READ CONTROL-CARD-3 INTO CC-CONTROL-CARD-3                  07800000
078100        AT END                                                    07810000
078200           SET PS-CONTROL-CARD-3-END-YES TO TRUE                  07820000
078300      END-READ.                                                   07830000
078400      IF PS-CONTROL-CARD-3-END-YES THEN                           07840000
078500          DISPLAY PC-CURRENT-PROGRAM-NAME                         07850000
078600              'CONTROL CARD MISSING - FOR ERROR QUEUE NAME'       07860000
078700          MOVE 'QUEUE NAME IS MISSING IN CARD?'                   07870000
078800                TO PV-ERROR-MESSAGE                               07880000
078900          PERFORM 9200-MQ-ABEND                                   07890000
079000      ELSE                                                        07900000
079100          IF CC-ERROR-QUEUE-NAME EQUAL SPACES THEN                07910000
079200             DISPLAY PC-CURRENT-PROGRAM-NAME                      07920000
079300               'CONTROL CARD MISSING - FOR ERROR QUEUE NAME'      07930000
079400             MOVE 'QUEUE NAME IS SPACES!'                         07940000
079500                  TO PV-ERROR-MESSAGE                             07950000
079600             PERFORM 9200-MQ-ABEND                                07960000
079700          ELSE                                                    07970000
079800             DISPLAY PC-CURRENT-PROGRAM-NAME                      07980000
079900                  ' - CONTROL CARD 3 : '                          07990000
080000                  CC-CONTROL-CARD-3                               08000000
080100          END-IF                                                  08010000
080200      END-IF.                                                     08020000
080300      CLOSE CONTROL-CARD-3.                                       08030000
080400                                                                  08040000
080500****************************************************************  08050000
080600* INIT SOME FIELDS BEFORE THE NEXT ITEM IS PROCESSED.             08060000
080700* RESET SOME SWITCHES.                                            08070000
080800****************************************************************  08080000
080900 1300-REINITIALIZE.                                               08090000
081000                                                                  08100000
081100     INITIALIZE DCLXLT00003                                       08110000
081200                DCLXLT00004                                       08120000
081300                DCLXLT00006                                       08130000
081301*CLP 07/10/2015 START                                             08130103
081310                DCLXLT00043                                       08131003
081320*CLP 07/10/2015 END                                               08132003
081330**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 08133063
081340                DCLTMDARVS                                        08134050
081350**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 END                   08135063
081400                DCLTSKXREF                                        08140000
081500                PV-MSG                                            08150000
081600                PV-MSGBUFFER                                      08160000
081700                PV-ERRMSGBUF                                      08170000
081800                PV-REC-SEQ-NBR.                                   08180000
081900                                                                  08190000
082000******************************************************************08200000
082100* BREAKDOWN AND EDIT A MSG.                                       08210000
082200* EDIT DB2 TABLES -OR- PUT A MSG IN ERROR TO ERROR QUEUE.         08220000
082300* GET THE NEXT MSG.                                               08230000
082400******************************************************************08240000
082500 2000-PROCESS-MSGS.                                               08250000
082600                                                                  08260000
082700     PERFORM 4000-FORMAT-KEYS.                                    08270000
082800                                                                  08280000
082900*BREAKDOWN / CHECK BUSINESS EVENT IN MESSAGE AND PROCESS.         08290000
083000                                                                  08300000
083100     EVALUATE TRUE                                                08310000
083200        WHEN IM008-BUS-EVENT-STYLE-ADD                            08320000
083300            PERFORM 2100-INSERT-VNDSTYL-ADD                       08330000
083400                                                                  08340000
083500        WHEN IM008-BUS-EVENT-STYLE-RECLASS                        08350000
083600            PERFORM 2105-SEL-STYL-RECLASS                         08360000
083700                                                                  08370000
083800        WHEN IM008-BUS-EVENT-STYLE-ATTR-CHG                       08380000
083900            PERFORM 2115-SEL-STYL-ATTRCHG                         08390000
084000                                                                  08400000
084100        WHEN IM008-BUS-EVENT-SUPPLIER-CHG                         08410000
084200            PERFORM 2125-UPD-SUPPLIER-CHG                         08420000
084300                                                                  08430000
084400        WHEN IM008-BUS-EVENT-VPN-CHG                              08440000
084500            PERFORM 2130-UPD-VPN-CHG                              08450000
084600                                                                  08460000
084700        WHEN IM008-BUS-EVENT-STYLE-DELETE                         08470000
084800            PERFORM 2135-DEL-STYLE                                08480000
084900                                                                  08490000
085000        WHEN IM008-BUS-EVENT-SKU-ADD                              08500000
085100            PERFORM 4001-FILLIN-UPC-FIELDS                        08510000
085200            PERFORM 2145-SKU-ADD                                  08520000
085300                                                                  08530000
085400        WHEN IM008-BUS-EVENT-SKU-CLR-SZ-CHG                       08540000
085500            PERFORM 2180-SKU-CLRSZ-CHG                            08550000
085600                                                                  08560000
085700        WHEN IM008-BUS-EVENT-SKU-ATTR-CHG                         08570000
085800            PERFORM 2195-SKU-ATTR-CHG                             08580000
085900                                                                  08590000
086000        WHEN IM008-BUS-EVENT-SKU-PKG-CHG                          08600000
086100            PERFORM 2210-SKU-PKG-CHG                              08610000
086200                                                                  08620000
086300        WHEN IM008-BUS-EVENT-STYLE-SKU-DEL                        08630000
086400            PERFORM 2225-SKU-DELETE                               08640000
086500                                                                  08650000
086600        WHEN IM008-BUS-EVENT-UPC-ADD                              08660000
086700            PERFORM 4001-FILLIN-UPC-FIELDS                        08670000
086800            PERFORM 2250-UPC-ADD                                  08680000
086900                                                                  08690000
087000        WHEN IM008-BUS-EVENT-UPC-DELETE                           08700000
087100            PERFORM 2260-UPC-DELETE                               08710000
087200                                                                  08720000
087300        WHEN IM008-BUS-EVENT-UPC-MOVE                             08730000
087400            PERFORM 2270-UPC-MOVE                                 08740000
087500                                                                  08750000
087600        WHEN IM008-BUS-EVENT-UPC-ATTR-CHG                         08760000
087700            PERFORM 2280-UPC-ATTR-CHG                             08770000
087800                                                                  08780000
087900        WHEN IM075-PACK-BUS-EVENT                                 08790000
088000            SET PC-CALL-XLKUP019-PGM TO TRUE                      08800000
088100            PERFORM 2300-CALL-PROGRAM                             08810000
088200                                                                  08820000
088300        WHEN IM075-PACKSKU-BUS-EVENT                              08830000
088400            SET PC-CALL-XLKUP020-PGM TO TRUE                      08840000
088500            PERFORM 2300-CALL-PROGRAM                             08850000
088600                                                                  08860000
088700        WHEN IM075-UPC-EAN-BUS-EVENT                              08870000
088800            SET PC-CALL-XLKUP021-PGM TO TRUE                      08880000
088900            PERFORM 2300-CALL-PROGRAM                             08890000
089000            IF LV-RETURN-CODE EQUAL ZEROS AND                     08900000
089100              (IM075-ACTION-UPDATE OR IM075-ACTION-INSERT)        08910000
089200                SET PC-CALL-XLKUP022-PGM TO TRUE                  08920000
089300                PERFORM 2300-CALL-PROGRAM                         08930000
089400            ELSE                                                  08940000
089500                CONTINUE                                          08950000
089600            END-IF                                                08960000
089700                                                                  08970000
089800        WHEN IM008-BUS-EVENT-RTL-STATUS-CHG                       08980000
089900            PERFORM 2350-UPDATE-SKU-STATUS                        08990000
090031                                                                  09003104
090040        WHEN OTHER                                                09004004
090100            SET PS-ERROR-YES TO TRUE                              09010000
090110            DISPLAY 'WHEN OTHER'                                  09011013
090200                                                                  09020000
090300     END-EVALUATE.                                                09030000
090400                                                                  09040000
090500*IF NO ERRORS, JUST CONTINUE,                                     09050000
090600*ELSE REINIT AND RESET SWITCHES AND GO AFTER THE NEXT MSG         09060000
090700*(NEW ITEM) ON THE QUEUE.                                         09070000
090800     IF PS-ERROR-YES                                              09080000
090900        PERFORM 7100-ERROR-ROUTINE                                09090000
091000        PERFORM 3800-PUT-MSG-TO-ERROR-Q                           09100000
091100        PERFORM 3600-MQ-COMMIT                                    09110000
091200     END-IF.                                                      09120000
091300                                                                  09130000
091400*THIS MOVES THE LEGACY ITEM MAINT RECORD TO A BACKUP              09140000
091500     PERFORM 7900-BACKUP-ITEM-QUEUE-MSG.                          09150000
091600     PERFORM 1300-REINITIALIZE.                                   09160000
091700                                                                  09170000
091800*GET NEXT MESSAGE FROM QUEUE.                                     09180000
091900     SET PS-ERROR-NO TO TRUE.                                     09190000
092000     PERFORM 3300-MQ-GET-MSG.                                     09200000
092100                                                                  09210000
092200******************************************************************09220000
092300* INSERT, UPDATE OR DELETE TABLES.                                09230000
092400* DB2 COMMIT.                                                     09240000
092500* MQ COMMIT.                                                      09250000
092600******************************************************************09260000
092700 2100-INSERT-VNDSTYL-ADD.                                         09270000
092800******************************************************************09280000
092810                                                                  09281048
092904**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 09290463
092905* TAKE THE UPDATED BRAND ID FROM TMDARVS MERCHANDISE TABLE       *09290550
092906* FOR THE RECEIVED STYLE ID FROM VSM QUEUE.                      *09290650
092907                                                                  09290750
092911                                                                  09291152
092912     EXEC SQL                                                     09291252
092913           SELECT                                                 09291352
092914                 LBL_SEQ_NBR                                      09291452
092915           INTO                                                   09291552
092916                 :MDARVS-LBL-SEQ-NBR                              09291652
092917           FROM  TMDARVS                                          09291752
092918           WHERE RMS_STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID           09291852
092919           AND   ACTV_IND = 'Y'                                   09291952
092920           WITH UR                                                09292064
092921     END-EXEC                                                     09292152
092922                                                                  09292252
092923     EVALUATE TRUE                                                09292352
092924           WHEN SQLCODE = +0                                      09292452
092925             MOVE MDARVS-LBL-SEQ-NBR   TO DK-BRND-KEY-ID          09292552
092926                                          XLT00043-BRND-ID        09292652
092927           WHEN SQLCODE = +100                                    09292763
092928             MOVE IM008-STYLE-ADD-LBL  TO DK-BRND-KEY-ID          09292864
092929                                          XLT00043-BRND-ID        09292964
092930           WHEN SQLWARN0 NOT = SPACES                             09293064
092931           WHEN SQLCODE  NOT = ZERO                               09293164
092932             MOVE DK-ITEM-KEY-RMS-STYL-ID TO PV-RMS-STYL-ID       09293264
092933             MOVE MDARVS-LBL-SEQ-NBR      TO PV-BRAND-ID          09293364
092939             DISPLAY '******************************************' 09293952
092940             DISPLAY '*ABEND                                   *' 09294052
092941             DISPLAY '*PROGRAM   = XLKUP003                    *' 09294152
092942             DISPLAY '*DB2 OPER  = SELECT ON TMDARVS           *' 09294252
092943             DISPLAY '*PARAGRAPH = 2100-INSERT-VNDSTYL-ADD     *' 09294352
092944             DISPLAY '*SQLCODE = ' SQLCODE                        09294452
092945             DISPLAY '*STYL ID = ' PV-RMS-STYL-ID                 09294556
092946             DISPLAY '*BRND ID = ' PV-BRAND-ID                    09294656
092947             DISPLAY '******************************************' 09294756
092948             PERFORM 9100-SQL-ABEND                               09294856
092949     END-EVALUATE.                                                09294956
092950**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 END                   09295063
092951*CLP 07/10/2015 START                                             09295156
092952*    ATTEMPT TO UPDATE TO THE BRAND TABLE FIRST                   09295256
092953*    WANT TO CHECK IF DIFFERENT FIRST FOR UPDATE                  09295356
092954*    MOVE IM008-STYLE-ADD-LBL-DESC     TO XLT00043-BRND-DESC.     09295456
092955*    MOVE IM008-STYLE-ADD-LBL-TYP-CDE  TO XLT00043-BRND-TYP-CDE.  09295556
092956                                                                  09295656
092957     EXEC SQL                                                     09295756
092958           SELECT                                                 09295856
092959                 BRND_DESC                                        09295956
092960                ,BRND_TYP_CDE                                     09296056
092961           INTO                                                   09296156
092962                :XLT00043-BRND-DESC                               09296256
092963               ,:XLT00043-BRND-TYP-CDE                            09296356
092964           FROM XLT_BRND                                          09296456
092965           WHERE BRND_ID  =  :XLT00043-BRND-ID                    09296556
092966     END-EXEC                                                     09296656
092967                                                                  09296756
092968     EVALUATE TRUE                                                09296856
092969           WHEN SQLCODE = +0                                      09296956
092970               PERFORM 2101-UPDATE-BRAND                          09297056
092971            WHEN SQLCODE = +100                                   09297156
092972               MOVE IM008-STYLE-ADD-LBL-DESC                      09297256
092973                                    TO XLT00043-BRND-DESC         09297356
092974               MOVE IM008-STYLE-ADD-LBL-TYP-CDE                   09297456
092975                                    TO XLT00043-BRND-TYP-CDE      09297556
092976               PERFORM 2150-INSERT-BRND                           09297656
092977           WHEN SQLWARN0 NOT = SPACES                             09297756
092978           WHEN SQLCODE  NOT = ZERO                               09297856
092979             DISPLAY '******************************************' 09297956
092980             DISPLAY '*ABEND                                   *' 09298056
092981             DISPLAY '*PROGRAM   = XLKUP003                    *' 09298156
092982             DISPLAY '*DB2 OPER  = SELECT ON XLT_BRND          *' 09298256
092983             DISPLAY '*PARAGRAPH = 2100-INSERT-VNDSTYL-ADD     *' 09298356
092984             DISPLAY '*SQLCODE = ' SQLCODE                        09298456
092985             DISPLAY '******************************************' 09298556
092986             PERFORM 9100-SQL-ABEND                               09298656
092987     END-EVALUATE.                                                09298756
092988                                                                  09298856
092989*INIT/LOAD VENDOR STYLE RECORD.                                   09298956
092990                                                                  09299056
092991     INITIALIZE DCLXLT00004.                                      09299156
092992     MOVE DK-ITEM-KEY-RMS-STYL-ID    TO XLT00004-STYL-ID.         09299256
092993     MOVE IM008-ITEM-KEY-DEPT        TO XLT00004-DEPT-NBR.        09299356
092994     MOVE IM008-ITEM-KEY-CLASS       TO XLT00004-MAJ-CL-NBR.      09299456
092995     MOVE IM008-ITEM-KEY-SUBCL       TO XLT00004-SUB-CL-NBR.      09299556
092996     MOVE IM008-ITEM-KEY-VS-ID       TO XLT00004-VS-ID.           09299656
092997     MOVE IM008-ITEM-KEY-VS-NBR      TO XLT00004-VS-NBR.          09299756
092998     MOVE IM008-ITEM-KEY-ENT-ID      TO XLT00004-ENT-ID.          09299856
092999     MOVE IM008-STYLE-ADD-STKR-NBR   TO XLT00004-STKR-NBR.        09299956
093000     MOVE IM008-STYLE-ADD-TKT-TYP-DESC                            09300056
093001                                     TO XLT00004-TKT-TYP-DESC.    09300156
093002     MOVE IM008-STYLE-ADD-HNG-FOLD-DESC                           09300256
093003                                     TO XLT00004-HNG-FOLD-DESC.   09300356
093004     MOVE IM008-STYLE-ADD-VS-DESC    TO XLT00004-VS-DESC.         09300456
093005*CLP 07/10/2015 START                                             09300556
093006     MOVE XLT00043-BRND-ID            TO XLT00004-BRND-ID.        09300655
093007*CLP 07/10/2015 END                                               09300752
093008                                                                  09300852
093009*INSERT VENDOR STYLE RECORD.                                      09300952
093010                                                                  09301052
093011       EXEC SQL                                                   09301152
093012           INSERT INTO XLT_VND_STYL                               09301252
093013               (STYL_ID,                                          09301352
093014                DEPT_NBR,                                         09301452
093015                MAJ_CL_NBR,                                       09301552
093016                SUB_CL_NBR,                                       09301652
093017                VS_ID,                                            09301752
093018                VS_NBR,                                           09301852
093019                ENT_ID,                                           09301952
093020                STKR_NBR,                                         09302052
093021                TKT_TYP_DESC,                                     09302152
093022                HNG_FOLD_DESC,                                    09302252
093023                LAST_UPD_TMST,                                    09302352
093024                VS_DESC,                                          09302452
093025                BRND_ID)                                          09302552
093026           VALUES                                                 09302652
093027               (:XLT00004-STYL-ID,                                09302752
093028                :XLT00004-DEPT-NBR,                               09302852
093029                :XLT00004-MAJ-CL-NBR,                             09302952
093030                :XLT00004-SUB-CL-NBR,                             09303052
093031                :XLT00004-VS-ID,                                  09303152
093032                :XLT00004-VS-NBR,                                 09303252
093033                :XLT00004-ENT-ID,                                 09303352
093034                :XLT00004-STKR-NBR,                               09303452
093035                :XLT00004-TKT-TYP-DESC,                           09303552
093036                :XLT00004-HNG-FOLD-DESC,                          09303652
093037                CURRENT TIMESTAMP,                                09303752
093038                :XLT00004-VS-DESC,                                09303852
093039                :XLT00004-BRND-ID)                                09303952
093040       END-EXEC                                                   09304052
093041                                                                  09304152
093042       EVALUATE TRUE                                              09304252
093043           WHEN SQLCODE = +0                                      09304352
093044               ADD +1 TO PA-TOTAL-VNDSTYL-INSERTS                 09304452
093045               PERFORM 6000-DB2-COMMIT                            09304552
093046               PERFORM 3600-MQ-COMMIT                             09304652
093047                                                                  09304752
093048           WHEN SQLCODE = -803                                    09304852
093049               SET XL005-DUP-INSERT-STYLE TO TRUE                 09304952
093050               MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD        09305052
093051               SET PS-ERROR-YES TO TRUE                           09305152
093052                                                                  09305252
093053           WHEN SQLCODE = -904                                    09305352
093054           WHEN SQLCODE = -911                                    09305452
093055           WHEN SQLCODE = -913                                    09305552
093056               CONTINUE                                           09305652
093057                                                                  09305752
093058           WHEN OTHER                                             09305852
093059             MOVE XLT00004-STYL-ID        TO PV-RMS-STYL-ID       09305956
093060             MOVE XLT00004-BRND-ID        TO PV-BRAND-ID          09306056
093061             DISPLAY '******************************************' 09306152
093062             DISPLAY '*ABEND                                   *' 09306252
093063             DISPLAY '*PROGRAM   = XLKUP003                    *' 09306352
093064             DISPLAY '*PARAGRAPH = 2100-INSERT-VNDSTYL-ADD     *' 09306452
093065             DISPLAY '*DB2 OPER  = INSERT TO XLT_VND_STYL      *' 09306552
093066             DISPLAY '*PARAGRAPH = 2100-INSERT-VNDSTYL-ADD     *' 09306652
093067             DISPLAY '*STYL ID = ' PV-RMS-STYL-ID                 09306756
093068             DISPLAY '*BRND ID = ' PV-BRAND-ID                    09306856
093069             DISPLAY '******************************************' 09306952
093074             PERFORM 9100-SQL-ABEND                               09307452
093075       END-EVALUATE.                                              09307552
093080                                                                  09308052
093092**************************************************************    09309248
093093* ONLY UPDATE IF EITHER THE DESC OR TYPE HAS CHANGED         *    09309348
093094**************************************************************    09309448
093095 2101-UPDATE-BRAND.                                               09309548
093096     SET PS-UPDATE-BRAND-NO TO TRUE.                              09309648
093097                                                                  09309748
093098     IF IM008-STYLE-ADD-LBL-DESC    NOT = XLT00043-BRND-DESC      09309848
093099        MOVE IM008-STYLE-ADD-LBL-DESC TO XLT00043-BRND-DESC       09309948
093100        SET PS-UPDATE-BRAND-YES TO TRUE                           09310048
093101     END-IF.                                                      09310148
093102                                                                  09310248
093103     IF IM008-STYLE-ADD-LBL-TYP-CDE NOT = XLT00043-BRND-TYP-CDE   09310348
093104        MOVE IM008-STYLE-ADD-LBL-TYP-CDE TO XLT00043-BRND-TYP-CDE 09310448
093105        SET PS-UPDATE-BRAND-YES TO TRUE                           09310548
093106     END-IF.                                                      09310648
093107                                                                  09310748
093108     IF PS-UPDATE-BRAND-YES                                       09310848
093109        EXEC SQL                                                  09310948
093110           UPDATE XLT_BRND                                        09311048
093111               SET                                                09311148
093112                   BRND_DESC     = :XLT00043-BRND-DESC            09311248
093113                  ,BRND_TYP_CDE  = :XLT00043-BRND-TYP-CDE         09311348
093114                  ,LAST_UPD_TMST = CURRENT TIMESTAMP              09311448
093115               WHERE BRND_ID = :DK-BRND-KEY-ID                    09311548
093116        END-EXEC                                                  09311648
093117                                                                  09311748
093118        EVALUATE TRUE                                             09311848
093119           WHEN SQLCODE = +0                                      09311948
093120               ADD +1 TO PA-TOTAL-BRAND-UPDATES                   09312048
093121           WHEN SQLCODE = +100                                    09312148
093122*              SHOULD NEVER GET +100                              09312248
093123               PERFORM 2150-INSERT-BRND                           09312348
093124           WHEN SQLWARN0 NOT = SPACES                             09312448
093125           WHEN SQLCODE  NOT = ZERO                               09312548
093126             DISPLAY '******************************************' 09312648
093127             DISPLAY '*ABEND                                   *' 09312748
093128             DISPLAY '*PROGRAM   = XLKUP003                    *' 09312848
093129             DISPLAY '*DB2 OPER  = SELECT ON XLT_BRND          *' 09312948
093130             DISPLAY '*PARAGRAPH = 2101-UPDATE-BRAND           *' 09313048
093131             DISPLAY '*SQLCODE = ' SQLCODE                        09313148
093132             DISPLAY '******************************************' 09313248
093133             PERFORM 9100-SQL-ABEND                               09313348
093134        END-EVALUATE                                              09313448
093135     END-IF.                                                      09313548
093136                                                                  09313648
093140*CLP 07/10/2015 END                                               09314048
093200                                                                  09320002
100700******************************************************************10070000
100800 2105-SEL-STYL-RECLASS.                                           10080000
100900******************************************************************10090000
101000                                                                  10100000
101100*SELECT  VENDOR STYLE RECORD.                                     10110000
101200                                                                  10120000
101300       EXEC SQL                                                   10130000
101400           SELECT                                                 10140000
101500                 DEPT_NBR,                                        10150000
101600                 MAJ_CL_NBR,                                      10160000
101700                 SUB_CL_NBR                                       10170000
101800           INTO                                                   10180000
101900                :XLT00004-DEPT-NBR,                               10190000
102000                :XLT00004-MAJ-CL-NBR,                             10200000
102100                :XLT00004-SUB-CL-NBR                              10210000
102200           FROM XLT_VND_STYL                                      10220000
102300           WHERE STYL_ID  =  :DK-ITEM-KEY-RMS-STYL-ID             10230000
102400       END-EXEC                                                   10240000
102500                                                                  10250000
102600       EVALUATE TRUE                                              10260000
102700           WHEN SQLCODE = +0                                      10270000
102800               PERFORM 2110-UPD-STYL-RECLASS                      10280000
102900                                                                  10290000
103000           WHEN SQLCODE = +100                                    10300000
103100               SET XL005-STYLE-ROW-NOT-FOUND TO TRUE              10310000
103200               MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD        10320000
103300               SET PS-ERROR-YES TO TRUE                           10330000
103400                                                                  10340000
103500           WHEN SQLWARN0 NOT = SPACES                             10350000
103600           WHEN SQLCODE  NOT = ZERO                               10360000
103700             DISPLAY '******************************************' 10370000
103800             DISPLAY '*ABEND                                   *' 10380000
103900             DISPLAY '*PROGRAM   = XLKUP003                    *' 10390000
104000             DISPLAY '*DB2 OPER  = SELECT ON XLT_VND_STYL      *' 10400000
104100             DISPLAY '*PARAGRAPH = 2105-SEL-STYL-RECLASS       *' 10410000
104200             DISPLAY '*SQLCODE = ' SQLCODE                        10420000
104300             DISPLAY '******************************************' 10430000
104400             PERFORM 9100-SQL-ABEND                               10440000
104500       END-EVALUATE.                                              10450000
104600                                                                  10460000
104700******************************************************************10470000
104800 2110-UPD-STYL-RECLASS.                                           10480000
104900******************************************************************10490000
105000                                                                  10500000
105100*UPDATE  VENDOR STYLE RECORD.                                     10510000
105200                                                                  10520000
105300     IF IM008-STYLE-RECL-DEPT-CHG                                 10530000
105400         MOVE IM008-STYLE-RECL-DEPT-NEW  TO XLT00004-DEPT-NBR     10540000
105500     END-IF.                                                      10550000
105600                                                                  10560000
105700     IF IM008-STYLE-RECL-CLASS-CHG                                10570000
105800         MOVE IM008-STYLE-RECL-CLASS-NEW TO XLT00004-MAJ-CL-NBR   10580000
105900     END-IF.                                                      10590000
106000                                                                  10600000
106100     IF IM008-STYLE-RECL-SUBCL-CHG                                10610000
106200         MOVE IM008-STYLE-RECL-SUBCL-NEW TO XLT00004-SUB-CL-NBR   10620000
106300     END-IF.                                                      10630000
106400                                                                  10640000
106500                                                                  10650000
106600     EXEC SQL                                                     10660000
106700        UPDATE XLT_VND_STYL                                       10670000
106800            SET                                                   10680000
106900                DEPT_NBR      = :XLT00004-DEPT-NBR                10690000
107000               ,MAJ_CL_NBR    = :XLT00004-MAJ-CL-NBR              10700000
107100               ,SUB_CL_NBR    = :XLT00004-SUB-CL-NBR              10710000
107200               ,LAST_UPD_TMST = CURRENT TIMESTAMP                 10720000
107300            WHERE STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID              10730000
107400     END-EXEC.                                                    10740000
107500                                                                  10750000
107600     EVALUATE TRUE                                                10760000
107700        WHEN SQLCODE = +0                                         10770000
107800            ADD +1 TO PA-TOTAL-VNDSTYL-UPDATES                    10780000
108000            PERFORM 6000-DB2-COMMIT                               10800000
108200            PERFORM 3600-MQ-COMMIT                                10820000
108300        WHEN SQLCODE = +100                                       10830000
108400            SET XL005-STYLE-ROW-NOT-FOUND TO TRUE                 10840000
108500            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           10850000
108600            SET PS-ERROR-YES TO TRUE                              10860000
108700     END-EVALUATE.                                                10870000
108800                                                                  10880000
108900******************************************************************10890000
109000 2115-SEL-STYL-ATTRCHG.                                           10900000
109100******************************************************************10910000
109200                                                                  10920008
109300*SELECT  VENDOR STYLE RECORD.                                     10930000
109400                                                                  10940000
109500       EXEC SQL                                                   10950000
109600           SELECT                                                 10960000
109700                 STKR_NBR,                                        10970000
109800                 TKT_TYP_DESC,                                    10980000
109900                 HNG_FOLD_DESC,                                   10990000
110000                 VS_DESC,                                         11000005
110020                 BRND_ID                                          11002005
110100           INTO                                                   11010000
110200                :XLT00004-STKR-NBR,                               11020000
110300                :XLT00004-TKT-TYP-DESC,                           11030000
110400                :XLT00004-HNG-FOLD-DESC,                          11040000
110500                :XLT00004-VS-DESC,                                11050010
110510                :XLT00004-BRND-ID                                 11051005
110600           FROM XLT_VND_STYL                                      11060000
110700           WHERE STYL_ID  =  :DK-ITEM-KEY-RMS-STYL-ID             11070000
110800       END-EXEC                                                   11080000
110900                                                                  11090000
111000       EVALUATE TRUE                                              11100000
111100           WHEN SQLCODE = +0                                      11110000
111200               PERFORM 2120-UPD-STYL-ATTRCHG                      11120000
111300                                                                  11130000
111400            WHEN SQLCODE = +100                                   11140000
111500                SET XL005-STYLE-ROW-NOT-FOUND TO TRUE             11150000
111600                MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD       11160000
111700                SET PS-ERROR-YES TO TRUE                          11170000
111800                                                                  11180000
111900           WHEN SQLWARN0 NOT = SPACES                             11190000
112000           WHEN SQLCODE  NOT = ZERO                               11200000
112100             DISPLAY '******************************************' 11210000
112200             DISPLAY '*ABEND                                   *' 11220000
112300             DISPLAY '*PROGRAM   = XLKUP003                    *' 11230000
112400             DISPLAY '*DB2 OPER  = SELECT ON XLT_VND_STYL      *' 11240000
112500             DISPLAY '*PARAGRAPH = 2115-SEL-STYL-ATTRCHG       *' 11250000
112600             DISPLAY '*SQLCODE = ' SQLCODE                        11260000
112700             DISPLAY '******************************************' 11270000
112800             PERFORM 9100-SQL-ABEND                               11280000
112900       END-EVALUATE.                                              11290000
113000                                                                  11300000
113100******************************************************************11310000
113200 2120-UPD-STYL-ATTRCHG.                                           11320000
113300******************************************************************11330000
113400                                                                  11340000
113500*UPDATE  VENDOR STYLE RECORD.                                     11350000
113600                                                                  11360000
113700     IF IM008-STYL-ATTR-STKR-NBR-CHG                              11370000
113800        MOVE IM008-STYL-ATTR-STKR-NBR  TO XLT00004-STKR-NBR       11380000
113900     END-IF.                                                      11390000
113910                                                                  11391038
114000     IF IM008-STYL-ATTR-TKT-DSC-CHG                               11400000
114100        MOVE IM008-STYL-ATTR-TKT-TYP-DESC                         11410000
114200                                 TO XLT00004-TKT-TYP-DESC         11420000
114300     END-IF.                                                      11430000
114310                                                                  11431038
114400     IF IM008-STYL-ATTR-HNG-DSC-CHG                               11440000
114500        MOVE IM008-STYL-ATTR-HNG-FOLD-DESC                        11450000
114600                                 TO XLT00004-HNG-FOLD-DESC        11460000
114700     END-IF.                                                      11470000
114710                                                                  11471038
114800     IF IM008-STYL-ATTR-VS-DESC-CHG                               11480000
114900        MOVE IM008-STYL-ATTR-VS-DESC                              11490000
115000                                 TO XLT00004-VS-DESC              11500000
115100     END-IF.                                                      11510000
115200                                                                  11520000
115210*CLP 07/10/2015 START                                             11521016
115211*    BRAND ID, BRAND DESC OR BRAND TYPE CHANGE                    11521116
115221     IF IM008-STYL-ATTR-LBL-CHG OR                                11522117
115222        IM008-STYL-ATTR-LBL-DESC-CHG OR                           11522217
115223        IM008-STYL-ATTR-LBL-TYP-CHG                               11522317
115225        PERFORM 2359-BRAND-UPDATES                                11522517
115226                                                                  11522617
115227     ELSE                                                         11522717
115300                                                                  11530000
115310*       DISPLAY 'UPDATE STYLE NON BRAND INFO'                     11531038
115320                                                                  11532016
115400        EXEC SQL                                                  11540016
115500           UPDATE XLT_VND_STYL                                    11550016
115600               SET                                                11560016
115700                   STKR_NBR         = :XLT00004-STKR-NBR,         11570016
115800                   TKT_TYP_DESC     = :XLT00004-TKT-TYP-DESC,     11580016
115900                   HNG_FOLD_DESC    = :XLT00004-HNG-FOLD-DESC,    11590016
116000                   LAST_UPD_TMST    = CURRENT TIMESTAMP,          11600016
116100                   VS_DESC          = :XLT00004-VS-DESC           11610016
116200                                                                  11620000
116300               WHERE STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID           11630016
116400        END-EXEC                                                  11640016
116500                                                                  11650000
116600        EVALUATE TRUE                                             11660016
116700           WHEN SQLCODE = +0                                      11670016
116800               ADD +1 TO PA-TOTAL-VNDSTYL-UPDATES                 11680016
117000               PERFORM 6000-DB2-COMMIT                            11700016
117200               PERFORM 3600-MQ-COMMIT                             11720016
117300           WHEN SQLCODE = +100                                    11730016
117400               SET XL005-STYLE-ROW-NOT-FOUND TO TRUE              11740016
117500               MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD        11750016
117600               SET PS-ERROR-YES TO TRUE                           11760016
117700                                                                  11770000
117800           WHEN SQLWARN0 NOT = SPACES                             11780016
117900           WHEN SQLCODE  NOT = ZERO                               11790016
118000              DISPLAY '******************************************'11800016
118100              DISPLAY '*ABEND                                   *'11810016
118200              DISPLAY '*PROGRAM   = XLKUP003                    *'11820016
118300              DISPLAY '*DB2 OPER  = UPDATE ON XLT_VND_STYL      *'11830016
118400              DISPLAY '*PARAGRAPH = 2120-UPD-STYL-RECLASS       *'11840016
118500              DISPLAY '*SQLCODE = ' SQLCODE                       11850016
118600              DISPLAY '******************************************'11860016
118700              PERFORM 9100-SQL-ABEND                              11870016
118800        END-EVALUATE                                              11880016
118900     END-IF.                                                      11890016
118910                                                                  11891016
119000******************************************************************11900000
119100 2125-UPD-SUPPLIER-CHG.                                           11910000
119200******************************************************************11920000
119300                                                                  11930000
119400*UPDATE  VENDOR STYLE RECORD.                                     11940000
119500                                                                  11950000
119600     MOVE IM008-SUPPLR-CHG-ENT-ID-NEW TO XLT00004-ENT-ID.         11960000
119700                                                                  11970000
119800     EXEC SQL                                                     11980000
119900        UPDATE XLT_VND_STYL                                       11990000
120000            SET                                                   12000000
120100                ENT_ID           = :XLT00004-ENT-ID,              12010000
120200                LAST_UPD_TMST    = CURRENT TIMESTAMP              12020000
120300                                                                  12030000
120400            WHERE STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID              12040000
120500     END-EXEC.                                                    12050000
120600                                                                  12060000
120700     EVALUATE TRUE                                                12070000
120800        WHEN SQLCODE = +0                                         12080000
120900            ADD +1 TO PA-TOTAL-VNDSTYL-UPDATES                    12090000
121100            PERFORM 6000-DB2-COMMIT                               12110000
121300            PERFORM 3600-MQ-COMMIT                                12130000
121400        WHEN SQLCODE = +100                                       12140000
121500            SET XL005-STYLE-ROW-NOT-FOUND TO TRUE                 12150000
121600            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           12160000
121700            SET PS-ERROR-YES TO TRUE                              12170000
121800                                                                  12180000
121900        WHEN SQLWARN0 NOT = SPACES                                12190000
122000        WHEN SQLCODE  NOT = ZERO                                  12200000
122100            DISPLAY '******************************************'  12210000
122200            DISPLAY '*ABEND                                   *'  12220000
122300            DISPLAY '*PROGRAM   = XLKUP003                    *'  12230000
122400            DISPLAY '*DB2 OPER  = UPDATE ON XLT_VND_STYL      *'  12240000
122500            DISPLAY '*PARAGRAPH = 2125-UPD-SUPPLIER-CHG       *'  12250000
122600            DISPLAY '*SQLCODE = ' SQLCODE                         12260000
122700            DISPLAY '******************************************'  12270000
122800            PERFORM 9100-SQL-ABEND                                12280000
122900     END-EVALUATE.                                                12290000
123000******************************************************************12300000
123100 2130-UPD-VPN-CHG.                                                12310000
123200******************************************************************12320000
123300                                                                  12330000
123400*UPDATE  VENDOR STYLE RECORD.                                     12340000
123500                                                                  12350000
123600     MOVE IM008-VPN-CHG-VS-NBR-NEW    TO XLT00004-VS-NBR.         12360000
123700                                                                  12370000
123800     EXEC SQL                                                     12380000
123900        UPDATE XLT_VND_STYL                                       12390000
124000            SET                                                   12400000
124100                VS_NBR           = :XLT00004-VS-NBR,              12410000
124200                LAST_UPD_TMST    = CURRENT TIMESTAMP              12420000
124300                                                                  12430000
124400            WHERE STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID              12440000
124500     END-EXEC.                                                    12450000
124600                                                                  12460000
124700     EVALUATE TRUE                                                12470000
124800        WHEN SQLCODE = +0                                         12480000
124900            ADD +1 TO PA-TOTAL-VNDSTYL-UPDATES                    12490000
125100            PERFORM 6000-DB2-COMMIT                               12510000
125300            PERFORM 3600-MQ-COMMIT                                12530000
125400        WHEN SQLCODE = +100                                       12540000
125500            SET XL005-STYLE-ROW-NOT-FOUND TO TRUE                 12550000
125600            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           12560000
125700            SET PS-ERROR-YES TO TRUE                              12570000
125800                                                                  12580000
125900        WHEN SQLWARN0 NOT = SPACES                                12590000
126000        WHEN SQLCODE  NOT = ZERO                                  12600000
126100            DISPLAY '******************************************'  12610000
126200            DISPLAY '*ABEND                                   *'  12620000
126300            DISPLAY '*PROGRAM   = XLKUP003                    *'  12630000
126400            DISPLAY '*DB2 OPER  = UPDATE ON XLT_VND_STYL      *'  12640000
126500            DISPLAY '*PARAGRAPH = 2130-UPD-VPN-CHG            *'  12650000
126600            DISPLAY '*SQLCODE = ' SQLCODE                         12660000
126700            DISPLAY '******************************************'  12670000
126800            PERFORM 9100-SQL-ABEND                                12680000
126900     END-EVALUATE.                                                12690000
127000******************************************************************12700000
127100 2135-DEL-STYLE.                                                  12710000
127200******************************************************************12720000
127300                                                                  12730000
127400*DELETE  VENDOR STYLE RECORD.                                     12740000
127500                                                                  12750000
127600     EXEC SQL                                                     12760000
127700        DELETE FROM XLT_VND_STYL                                  12770000
127800            WHERE STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID              12780000
127900     END-EXEC.                                                    12790000
128000                                                                  12800000
128100     EVALUATE TRUE                                                12810000
128200        WHEN SQLCODE = +0                                         12820000
128300            ADD +1 TO PA-TOTAL-VNDSTYL-DELETES                    12830000
128500            PERFORM 6000-DB2-COMMIT                               12850000
128700            PERFORM 3600-MQ-COMMIT                                12870000
128800        WHEN SQLCODE = +100                                       12880000
128900            SET XL005-STYLE-ROW-NOT-FOUND TO TRUE                 12890000
129000            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           12900000
129100            SET PS-ERROR-YES TO TRUE                              12910000
129200                                                                  12920000
129300        WHEN SQLWARN0 NOT = SPACES                                12930000
129400        WHEN SQLCODE  NOT = ZERO                                  12940000
129500            DISPLAY '******************************************'  12950000
129600            DISPLAY '*ABEND                                   *'  12960000
129700            DISPLAY '*PROGRAM   = XLKUP003                    *'  12970000
129800            DISPLAY '*DB2 OPER  = DELETE ON XLT_VND_STYL      *'  12980000
129900            DISPLAY '*PARAGRAPH = 2135-DEL-STYLE              *'  12990000
130000            DISPLAY '*SQLCODE = ' SQLCODE                         13000000
130100            DISPLAY '******************************************'  13010000
130200            PERFORM 9100-SQL-ABEND                                13020000
130300     END-EVALUATE.                                                13030000
130400                                                                  13040000
130500******************************************************************13050000
130600*SELECT  VENDOR STYLE RECORD TO VALIDATE STYLE ID.                13060000
130700******************************************************************13070000
130800                                                                  13080000
130900 2145-SKU-ADD.                                                    13090000
131000                                                                  13100000
131100       EXEC SQL                                                   13110000
131200           SELECT                                                 13120000
131300                 STYL_ID                                          13130000
131400           INTO                                                   13140000
131500                :XLT00004-STYL-ID                                 13150000
131600           FROM XLT_VND_STYL                                      13160000
131700           WHERE STYL_ID  =  :DK-ITEM-KEY-RMS-STYL-ID             13170000
131800       END-EXEC                                                   13180000
131900                                                                  13190000
132000       EVALUATE TRUE                                              13200000
132100           WHEN SQLCODE = +0                                      13210000
132200               PERFORM 2147-CREATE-SKU                            13220000
132300               PERFORM 2148-INSERT-UPC-ADD                        13230000
132400           WHEN SQLWARN0 NOT = SPACES                             13240000
132500           WHEN SQLCODE  NOT = ZERO                               13250000
132600             SET XL005-STYLE-ROW-NOT-FOUND TO TRUE                13260000
132700             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          13270000
132800             SET PS-ERROR-YES TO TRUE                             13280000
132900       END-EVALUATE.                                              13290000
133000                                                                  13300000
133100******************************************************************13310000
133200 2147-CREATE-SKU.                                                 13320000
133300******************************************************************13330000
133400*INIT/LOAD SKU RECORD.                                            13340000
133500                                                                  13350000
133600     INITIALIZE DCLXLT00003.                                      13360000
133700     MOVE DK-ITEM-KEY-INTR-UPC-ID    TO XLT00003-INTR-UPC-ID.     13370000
133800     MOVE DK-ITEM-KEY-RMS-STYL-ID    TO XLT00003-STYL-ID.         13380000
133900     MOVE IM008-SKU-ADD-ITEM-NMBR    TO XLT00003-ITM-NBR.         13390000
134000     MOVE DK-SKU                     TO XLT00003-SKU-NBR.         13400000
134100     MOVE IM008-SKU-ADD-UPC-STAT-CDE TO XLT00003-SKU-STAT-CDE.    13410000
134200     MOVE IM008-SKU-ADD-SKU-STAT-DESC                             13420000
134300                                     TO XLT00003-SKU-STAT-DESC.   13430000
134400     MOVE IM008-SKU-ADD-INNR-PK-QTY  TO XLT00003-INNR-PK-QTY.     13440000
134500     MOVE IM008-SKU-ADD-OUTR-PK-QTY  TO XLT00003-OUTR-PK-QTY.     13450000
134600     MOVE IM008-SKU-ADD-SKU-DESC     TO XLT00003-SKU-DESC.        13460000
134700     MOVE IM008-SKU-ADD-KOHLS-SIZE-CDE                            13470000
134800                                     TO XLT00003-KOHLS-SIZE-CDE.  13480000
134900     MOVE IM008-SKU-ADD-SIZE-DESC    TO XLT00003-SIZE-DESC.       13490000
135000     MOVE IM008-SKU-ADD-NRF-CLOR-CDE TO XLT00003-NRF-CLOR-CDE.    13500000
135100     MOVE IM008-SKU-ADD-SHRT-CLOR-DESC                            13510000
135200                                     TO XLT00003-SHRT-CLOR-DESC.  13520000
135300     MOVE IM008-SKU-ADD-CSTM-CLOR-DESC                            13530000
135400                                     TO XLT00003-CSTM-CLOR-DESC.  13540000
135500     MOVE IM008-SKU-ADD-REGN-PRIC-IND                             13550000
135600                                     TO XLT00003-REGN-PRIC-IND.   13560000
135700     MOVE IM008-SKU-ADD-KY-ITM-IND   TO XLT00003-KY-ITM-IND.      13570000
135800     MOVE IM008-SKU-ADD-GP-CDE       TO XLT00003-GP-CDE.          13580000
135900** TO INCLUDE THE NEW WAREHOUSE INDICATOR TO THE INSERT SQL **    13590000
136000** PB 05/04/2010 BEG                                              13600000
136100     MOVE IM008-SKU-ADD-WHSE-RPLNT-IND TO XLT00003-WHSE-RPLNT-IND.13610000
136200** PB 05/04/2010 END                                              13620000
136300                                                                  13630000
136400*INSERT SKU RECORD.                                               13640000
136500                                                                  13650000
136600** TO INCLUDE THE NEW WAREHOUSE INDICATOR TO THE XLT_SKU TABLE ** 13660000
136700** PB 05/04/2010                                                  13670000
136800       EXEC SQL                                                   13680000
136900           INSERT INTO XLT_SKU                                    13690000
137000               (INTR_UPC_ID,                                      13700000
137100                STYL_ID,                                          13710000
137200                ITM_NBR,                                          13720000
137300                SKU_NBR,                                          13730000
137400                SKU_STAT_CDE,                                     13740000
137500                SKU_STAT_DESC,                                    13750000
137600                INNR_PK_QTY,                                      13760000
137700                OUTR_PK_QTY,                                      13770000
137800                SKU_DESC,                                         13780000
137900                KOHLS_SIZE_CDE,                                   13790000
138000                SIZE_DESC,                                        13800000
138100                NRF_CLOR_CDE,                                     13810000
138200                SHRT_CLOR_DESC,                                   13820000
138300                CSTM_CLOR_DESC,                                   13830000
138400                REGN_PRIC_IND,                                    13840000
138500                KY_ITM_IND,                                       13850000
138600                GP_CDE,                                           13860000
138700                LAST_UPD_TMST,                                    13870000
138800                WHSE_RPLNT_IND)                                   13880000
138900           VALUES                                                 13890000
139000               (:XLT00003-INTR-UPC-ID,                            13900000
139100                :XLT00003-STYL-ID,                                13910000
139200                :XLT00003-ITM-NBR,                                13920000
139300                :XLT00003-SKU-NBR,                                13930000
139400                :XLT00003-SKU-STAT-CDE,                           13940000
139500                :XLT00003-SKU-STAT-DESC,                          13950000
139600                :XLT00003-INNR-PK-QTY,                            13960000
139700                :XLT00003-OUTR-PK-QTY,                            13970000
139800                :XLT00003-SKU-DESC,                               13980000
139900                :XLT00003-KOHLS-SIZE-CDE,                         13990000
140000                :XLT00003-SIZE-DESC,                              14000000
140100                :XLT00003-NRF-CLOR-CDE,                           14010000
140200                :XLT00003-SHRT-CLOR-DESC,                         14020000
140300                :XLT00003-CSTM-CLOR-DESC,                         14030000
140400                :XLT00003-REGN-PRIC-IND,                          14040000
140500                :XLT00003-KY-ITM-IND,                             14050000
140600                :XLT00003-GP-CDE,                                 14060000
140700                CURRENT TIMESTAMP,                                14070000
140800                :XLT00003-WHSE-RPLNT-IND)                         14080000
140900       END-EXEC                                                   14090000
141000                                                                  14100000
141100       EVALUATE TRUE                                              14110000
141200           WHEN SQLCODE = +0                                      14120000
141300               ADD +1 TO PA-TOTAL-SKU-INSERTS                     14130000
141500               PERFORM 6000-DB2-COMMIT                            14150000
141700               PERFORM 3600-MQ-COMMIT                             14170000
141800           WHEN SQLCODE = -803                                    14180000
141900               SET XL005-DUP-INSERT-SKU TO TRUE                   14190000
142000               MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD        14200000
142100               SET PS-ERROR-YES TO TRUE                           14210000
142200                                                                  14220000
142210               DISPLAY ' '                                        14221070
142211               DISPLAY ' DUPLICATE SKU ON INSERT:'                14221170
142220                       ' MSG-TYPE: '    IM008-BUSINESS-EVENT-ID   14222070
142230                       ' TMST: '        IM008-CRE-TMST            14223070
142240               DISPLAY ' SKU: '         IM008-ITEM-KEY-SKU        14224070
142250                      ' INTR_UPC_ID: ' IM008-ITEM-KEY-INTR-UPC-ID 14225069
142260                                                                  14226069
142300           WHEN SQLWARN0 NOT = SPACES                             14230000
142400           WHEN SQLCODE  NOT = ZERO                               14240000
142500             DISPLAY '******************************************' 14250000
142600             DISPLAY '*ABEND                                   *' 14260000
142700             DISPLAY '*PROGRAM   = XLKUP003                    *' 14270000
142800             DISPLAY '*PARAGRAPH = 2147-CREATE-SKU             *' 14280000
142900             DISPLAY '*DB2 OPER  = INSERT TO XLT_SKU           *' 14290000
143000             DISPLAY '*SQLCODE = ' SQLCODE                        14300000
143100             DISPLAY '******************************************' 14310000
143200             PERFORM 9100-SQL-ABEND                               14320000
143300       END-EVALUATE.                                              14330000
143400                                                                  14340000
143500******************************************************************14350000
143600 2148-INSERT-UPC-ADD.                                             14360000
143700******************************************************************14370000
143800     INITIALIZE DCLXLT00006.                                      14380000
143900     MOVE DK-ITEM-KEY-UPC-ID          TO XLT00006-UPC-ID.         14390000
144000     MOVE DK-ITEM-KEY-INTR-UPC-ID     TO XLT00006-INTR-UPC-ID.    14400000
144100     MOVE IM008-SKU-ADD-EDI-ORD-IND   TO XLT00006-EDI-ORD-IND.    14410000
144200     MOVE IM008-ITEM-KEY-UPC-NBR      TO XLT00006-UPC-NBR.        14420000
144300     MOVE 'I'                         TO XLT00006-UPC-TYP-CDE.    14430000
144400*    MOVE SPACE                       TO XLT00006-CERTD-IND.      14440000
144500*    MOVE PV-TMST-CCYY-MM-DD          TO XLT00006-CERTD-DTE.      14450000
144600     PERFORM 2251-SELECT-TUPC                                     14460000
144700     MOVE UPC-CERTD-IND               TO XLT00006-CERTD-IND.      14470000
144800     MOVE UPC-CERTD-DTE               TO XLT00006-CERTD-DTE.      14480000
144900*                                                                 14490000
145000*DEFAULT THE PREPACK INDICATOR TO 'N' FOR THE INTERNAL UPC THAT   14500000
145100*IS CREATED AS PART OF THE SKU ADD EVENT.  THIS INDICATOR FIELD   14510000
145200*IS NOT BEING POPULATED ON THE MESSAGE BECAUSE IT IS NOT AN       14520000
145300*ATTRIBUTE OF THE SKU.  WE NEED TO DEFAULT IT IN THIS CASE.       14530000
145400     MOVE 'N'                         TO XLT00006-PREPK-IND.      14540000
145500*                                                                 14550000
145600*INSERT UPC RECORD                                                14560000
145700     EXEC SQL                                                     14570000
145800         INSERT INTO XLT_UPC                                      14580000
145900             (UPC_ID                                              14590000
146000             ,INTR_UPC_ID                                         14600000
146100             ,UPC_TYP_CDE                                         14610000
146200             ,EDI_ORD_IND                                         14620000
146300             ,CERTD_IND                                           14630000
146400             ,CERTD_DTE                                           14640000
146500             ,UPC_NBR                                             14650000
146600             ,LAST_UPD_TMST                                       14660000
146700             ,PREPK_IND)                                          14670000
146800         VALUES                                                   14680000
146900             (:XLT00006-UPC-ID,                                   14690000
147000              :XLT00006-INTR-UPC-ID,                              14700000
147100              :XLT00006-UPC-TYP-CDE,                              14710000
147200              :XLT00006-EDI-ORD-IND,                              14720000
147300              :XLT00006-CERTD-IND,                                14730000
147400              :XLT00006-CERTD-DTE,                                14740000
147500              :XLT00006-UPC-NBR,                                  14750000
147600              CURRENT TIMESTAMP,                                  14760000
147700              :XLT00006-PREPK-IND)                                14770000
147800     END-EXEC                                                     14780000
147900                                                                  14790000
148000     EVALUATE TRUE                                                14800000
148100         WHEN SQLCODE = +0                                        14810000
148200             ADD +1 TO PA-TOTAL-UPC-INSERTS                       14820000
148400             PERFORM 6000-DB2-COMMIT                              14840000
148600             PERFORM 3600-MQ-COMMIT                               14860000
148700         WHEN SQLCODE = -803                                      14870000
148800             SET XL005-DUP-INSERT-UPC TO TRUE                     14880000
148900             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          14890000
149000             SET PS-ERROR-YES TO TRUE                             14900000
149020         WHEN SQLCODE = -530                                      14902066
149030             SET XL005-SKU-INTR-UPC-NOT-FOUND TO TRUE             14903066
149040             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          14904066
149050             SET PS-ERROR-YES TO TRUE                             14905066
149060                                                                  14906069
149070             DISPLAY ' '                                          14907070
149071             DISPLAY ' INTR_UPC_ID NOT FOUND ON UPC INSERT:'      14907170
149080                     ' MSG-TYPE: '    IM008-BUSINESS-EVENT-ID     14908069
149090                     ' TMST: '        IM008-CRE-TMST              14909069
149091             DISPLAY ' SKU: '         IM008-ITEM-KEY-SKU          14909170
149092                     ' INTR_UPC_ID: ' IM008-ITEM-KEY-INTR-UPC-ID  14909269
149093                     ' UPC: '         IM008-ITEM-KEY-UPC-NBR      14909369
149094                                                                  14909469
149100         WHEN SQLCODE = -904                                      14910000
149200         WHEN SQLCODE = -911                                      14920000
149300         WHEN SQLCODE = -913                                      14930000
149400             CONTINUE                                             14940000
149500         WHEN OTHER                                               14950000
149600             DISPLAY '******************************************' 14960000
149700             DISPLAY '*ABEND                                   *' 14970000
149800             DISPLAY '*PROGRAM   = XLKUP003                    *' 14980000
149900             DISPLAY '*PARAGRAPH = 2148-INSERT-UPC-ADD         *' 14990000
150000             DISPLAY '*DB2 OPER  = INSERT TO XLT_UPC           *' 15000065
150100             DISPLAY '******************************************' 15010000
150200             DISPLAY 'CERTD DTE = ' XLT00006-CERTD-DTE            15020000
150300             DISPLAY 'UPC NBR = ' XLT00006-UPC-NBR                15030000
150400             DISPLAY 'INTR UPC ID = ' XLT00006-INTR-UPC-ID        15040000
150500             PERFORM 9100-SQL-ABEND                               15050000
150600       END-EVALUATE.                                              15060000
150700                                                                  15070000
150701*CLP 07/10/2015 START                                             15070102
150710******************************************************************15071002
150720 2150-INSERT-BRND.                                                15072008
150730******************************************************************15073002
150732                                                                  15073203
150734     EXEC SQL                                                     15073403
150735         INSERT INTO XLT_BRND                                     15073503
150736             (BRND_ID                                             15073603
150737             ,BRND_DESC                                           15073703
150738             ,BRND_TYP_CDE                                        15073803
150741             ,LAST_UPD_TMST)                                      15074103
150743         VALUES                                                   15074303
150744             (:XLT00043-BRND-ID,                                  15074403
150745              :XLT00043-BRND-DESC,                                15074503
150746              :XLT00043-BRND-TYP-CDE,                             15074603
150751              CURRENT TIMESTAMP)                                  15075103
150753     END-EXEC                                                     15075303
150754                                                                  15075403
150755     EVALUATE TRUE                                                15075503
150756         WHEN SQLCODE = +0                                        15075603
150757             ADD +1 TO PA-TOTAL-BRAND-INSERTS                     15075703
150766         WHEN SQLCODE = -904                                      15076603
150767         WHEN SQLCODE = -911                                      15076703
150768         WHEN SQLCODE = -913                                      15076803
150769             CONTINUE                                             15076903
150770         WHEN OTHER                                               15077003
150771             DISPLAY '******************************************' 15077103
150772             DISPLAY '*ABEND                                   *' 15077203
150773             DISPLAY '*PROGRAM   = XLKUP003                    *' 15077303
150774             DISPLAY '*PARAGRAPH = 2150-INSERT-BRND            *' 15077408
150775             DISPLAY '*DB2 OPER  = INSERT TO XLT_BRND          *' 15077503
150776             DISPLAY '******************************************' 15077603
150777             DISPLAY 'BRND ID   = ' XLT00043-BRND-ID              15077703
150778             DISPLAY 'BRND DESC = ' XLT00043-BRND-DESC            15077803
150779             DISPLAY 'BRND TYP CDE = ' XLT00043-BRND-TYP-CDE      15077903
150780             PERFORM 9100-SQL-ABEND                               15078003
150781       END-EVALUATE.                                              15078103
150782                                                                  15078202
150790*CLP 07/10/2015 END                                               15079002
150800******************************************************************15080000
150900 2180-SKU-CLRSZ-CHG.                                              15090000
151000******************************************************************15100000
151100                                                                  15110000
151200*SELECT SKU RECORD                                                15120000
151300                                                                  15130000
151400     SET PS-UPDSKU-NO TO TRUE.                                    15140000
151500                                                                  15150000
151600       EXEC SQL                                                   15160000
151700           SELECT                                                 15170000
151800                 KOHLS_SIZE_CDE,                                  15180000
151900                 SIZE_DESC,                                       15190000
152000                 NRF_CLOR_CDE,                                    15200000
152100                 SHRT_CLOR_DESC,                                  15210000
152200                 CSTM_CLOR_DESC                                   15220000
152300           INTO                                                   15230000
152400                :XLT00003-KOHLS-SIZE-CDE,                         15240000
152500                :XLT00003-SIZE-DESC,                              15250000
152600                :XLT00003-NRF-CLOR-CDE,                           15260000
152700                :XLT00003-SHRT-CLOR-DESC,                         15270000
152800                :XLT00003-CSTM-CLOR-DESC                          15280000
152900           FROM XLT_SKU                                           15290000
153000           WHERE INTR_UPC_ID  = :DK-ITEM-KEY-INTR-UPC-ID          15300000
153100       END-EXEC                                                   15310000
153200                                                                  15320000
153300       EVALUATE TRUE                                              15330000
153400           WHEN SQLCODE = +0                                      15340000
153500               PERFORM 2185-VALIDATE-CLR-CHGS                     15350000
153600               PERFORM 2190-UPDATE-SKU-CLRSZ                      15360000
153700           WHEN SQLWARN0 NOT = SPACES                             15370000
153800           WHEN SQLCODE  NOT = ZERO                               15380000
153900             SET XL005-SKU-ROW-NOT-FOUND TO TRUE                  15390000
154000             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          15400000
154100             SET PS-ERROR-YES TO TRUE                             15410000
154200       END-EVALUATE.                                              15420000
154300                                                                  15430000
154400******************************************************************15440000
154500**  HERE IS AN EXPLANATION OF HOW THIS PARAGRAPH WORKS            15450000
154600**    * SKU 055-10-001 IS SITTING OUT IN VSM (AND ON YOUR TABLE)  15460000
154700**      WITH A SIZE CODE OF 2 AND A SIZE DESCRIPTION OF MED.      15470000
154800**                                                                15480000
154900**    * THE USER CHANGES THE DESRIPTION OF SIZE CODE 2 TO MEDIUM. 15490000
155000**      (YOU DON'T RECEIVE THIS MESSAGE YET BECAUSE WE DON'T      15500000
155100**       BRIDGE IT REAL-TIME).                                    15510000
155200**                                                                15520000
155300**    * THE USER CHANGES THE SIZE CODE ON SKU 055-10-001 TO 1     15530000
155400**      IN VSM.  (YOU PROCESS THE RESULTING MESSAGE IMEDIATELY    15540000
155500**      BECAUSE IT'S BRIDGED REALTIME.)                           15550000
155600**                                                                15560000
155700**    * NOW YOUR TABLE HAS SKU 055-10-001 WITH A SIZE CODE OF 1   15570000
155800**      AND A SIZE DESCRIPTION OF SMALL.                          15580000
155900**                                                                15590000
156000**    * YOU FINALLY RECEIVE THE MESSAGE RESULTING FROM STEP 2.    15600000
156100**      BUT AFTER DOING THE CODE CHECK YOU FIND OUT THEY ARE      15610000
156200**      DIFFERENT.  WE DO NOT WANT TO APPLY THE DESCRIPTION       15620000
156300**      CHANGE.                                                   15630000
156400**                                                                15640000
156500**    * THIS IS HANDLED WITH A SWITCH CALLED:  PS-UPDATE-SKU-SW   15650000
156600**                                                                15660000
156700******************************************************************15670000
156800 2185-VALIDATE-CLR-CHGS.                                          15680000
156900******************************************************************15690000
157000                                                                  15700000
157100     IF IM008-SKU-CLR-CSTM-CLOR-CHG                               15710000
157200         MOVE IM008-SKU-CLR-CSTM-CLOR-DESC-N                      15720000
157300                            TO XLT00003-CSTM-CLOR-DESC            15730000
157400         SET PS-UPDSKU-YES  TO TRUE.                              15740000
157500     IF IM008-SKU-CLR-NRF-CLOR-CDE-CHG                            15750000
157600         MOVE IM008-SKU-CLR-NRF-CLOR-CDE-N                        15760000
157700                            TO XLT00003-NRF-CLOR-CDE              15770000
157800         MOVE IM008-SKU-CLR-SHRT-CLOR-DESC-N                      15780000
157900                            TO XLT00003-SHRT-CLOR-DESC            15790000
158000         SET PS-UPDSKU-YES  TO TRUE.                              15800000
158100     IF IM008-SKU-CLR-KOHLS-SIZE-CHG                              15810000
158200         MOVE IM008-SKU-CLR-KOHLS-SIZE-CDE-N                      15820000
158300                            TO XLT00003-KOHLS-SIZE-CDE            15830000
158400         MOVE IM008-SKU-CLR-SIZE-DESC-NEW                         15840000
158500                            TO XLT00003-SIZE-DESC                 15850000
158600         SET PS-UPDSKU-YES  TO TRUE.                              15860000
158700     IF IM008-SKU-CLR-SIZE-DESC-CHG                               15870000
158800         IF IM008-SKU-CLR-KOHLS-SIZE-CDE-N =                      15880000
158900                               XLT00003-KOHLS-SIZE-CDE            15890000
159000             MOVE IM008-SKU-CLR-SIZE-DESC-NEW                     15900000
159100                            TO XLT00003-SIZE-DESC                 15910000
159200             SET PS-UPDSKU-YES TO TRUE                            15920000
159300         ELSE                                                     15930000
159400             CONTINUE                                             15940000
159500         END-IF                                                   15950000
159600     END-IF.                                                      15960000
159700******************************************************************15970000
159800 2190-UPDATE-SKU-CLRSZ.                                           15980000
159900******************************************************************15990000
160000                                                                  16000000
160100*UPDATE  SKU RECORD.                                              16010000
160200                                                                  16020000
160300     EXEC SQL                                                     16030000
160400        UPDATE XLT_SKU                                            16040000
160500            SET                                                   16050000
160600                KOHLS_SIZE_CDE   = :XLT00003-KOHLS-SIZE-CDE,      16060000
160700                SIZE_DESC        = :XLT00003-SIZE-DESC,           16070000
160800                NRF_CLOR_CDE     = :XLT00003-NRF-CLOR-CDE,        16080000
160900                SHRT_CLOR_DESC   = :XLT00003-SHRT-CLOR-DESC,      16090000
161000                CSTM_CLOR_DESC   = :XLT00003-CSTM-CLOR-DESC,      16100000
161100                LAST_UPD_TMST    = CURRENT TIMESTAMP              16110000
161200                                                                  16120000
161300            WHERE INTR_UPC_ID = :DK-ITEM-KEY-INTR-UPC-ID          16130000
161400     END-EXEC                                                     16140000
161500                                                                  16150000
161600     EVALUATE TRUE                                                16160000
161700        WHEN SQLCODE = +0                                         16170000
161800            ADD +1 TO PA-TOTAL-SKU-UPDATES                        16180000
162000            PERFORM 6000-DB2-COMMIT                               16200000
162200            PERFORM 3600-MQ-COMMIT                                16220000
162300        WHEN SQLCODE = +100                                       16230000
162400            SET XL005-SKU-ROW-NOT-FOUND TO TRUE                   16240000
162500            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           16250000
162600            SET PS-ERROR-YES TO TRUE                              16260000
162700                                                                  16270000
162800        WHEN SQLWARN0 NOT = SPACES                                16280000
162900        WHEN SQLCODE  NOT = ZERO                                  16290000
163000            DISPLAY '******************************************'  16300000
163100            DISPLAY '*ABEND                                   *'  16310000
163200            DISPLAY '*PROGRAM   = XLKUP003                    *'  16320000
163300            DISPLAY '*DB2 OPER  = UPDATE ON XLT_SKU           *'  16330000
163400            DISPLAY '*PARAGRAPH = 2190-UPDATE-SKU-CLRSZ       *'  16340000
163500            DISPLAY '*SQLCODE = ' SQLCODE                         16350000
163600            DISPLAY '******************************************'  16360000
163700            PERFORM 9100-SQL-ABEND                                16370000
163800     END-EVALUATE.                                                16380000
163900******************************************************************16390000
164000 2195-SKU-ATTR-CHG.                                               16400000
164100******************************************************************16410000
164200                                                                  16420000
164300       SET PS-UPDSKU-NO TO TRUE.                                  16430000
164400       SET PS-UPDUPC-NO TO TRUE.                                  16440000
164500                                                                  16450000
164600*SELECT SKU RECORD                                                16460000
164700                                                                  16470000
164800       EXEC SQL                                                   16480000
164900           SELECT                                                 16490000
165000                 KY_ITM_IND,                                      16500000
165100                 GP_CDE,                                          16510000
165200                 REGN_PRIC_IND,                                   16520000
165300                 SKU_DESC,                                        16530000
165400                 WHSE_RPLNT_IND                                   16540000
165500           INTO                                                   16550000
165600                :XLT00003-KY-ITM-IND,                             16560000
165700                :XLT00003-GP-CDE,                                 16570000
165800                :XLT00003-REGN-PRIC-IND,                          16580000
165900                :XLT00003-SKU-DESC,                               16590000
166000                :XLT00003-WHSE-RPLNT-IND                          16600000
166100           FROM XLT_SKU                                           16610000
166200           WHERE INTR_UPC_ID  = :DK-ITEM-KEY-INTR-UPC-ID          16620000
166300       END-EXEC                                                   16630000
166400                                                                  16640000
166500       EVALUATE TRUE                                              16650000
166600           WHEN SQLCODE = +0                                      16660000
166700               PERFORM 2200-CHK-ATTR-CHGS                         16670000
166800               PERFORM 2205-UPDATE-SKU-ATTR-CHGS                  16680000
166900               PERFORM 2230-CHK-UPC-ORD-CHG                       16690000
167000               IF PS-UPDUPC-YES                                   16700000
167100                  PERFORM 2240-UPDATE-UPC-ORD-CHG                 16710000
167200                  SET PS-UPDUPC-NO TO TRUE                        16720000
167300               END-IF                                             16730000
167400           WHEN SQLWARN0 NOT = SPACES                             16740000
167500           WHEN SQLCODE  NOT = ZERO                               16750000
167600             SET XL005-SKU-ROW-NOT-FOUND TO TRUE                  16760000
167700             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          16770000
167800             SET PS-ERROR-YES TO TRUE                             16780000
167900       END-EVALUATE.                                              16790000
168000******************************************************************16800000
168100 2200-CHK-ATTR-CHGS.                                              16810000
168200******************************************************************16820000
168300                                                                  16830000
168400     IF IM008-SKU-ATTR-REG-PRC-IND-CHG                            16840000
168500         MOVE IM008-SKU-ATTR-REGN-PRIC-IND-N                      16850000
168600                                TO XLT00003-REGN-PRIC-IND         16860000
168700         SET PS-UPDSKU-YES TO TRUE                                16870000
168800     END-IF.                                                      16880000
168900     IF IM008-SKU-ATTR-GP-CDE-CHG                                 16890000
169000         MOVE IM008-SKU-ATTR-GP-CDE-NEW                           16900000
169100                                TO XLT00003-GP-CDE                16910000
169200         SET PS-UPDSKU-YES TO TRUE                                16920000
169300     END-IF.                                                      16930000
169400                                                                  16940000
169500     IF IM008-SKU-ATTR-KY-ITM-CHG                                 16950000
169600         MOVE IM008-SKU-ATTR-KY-ITM-IND-NEW                       16960000
169700                                TO XLT00003-KY-ITM-IND            16970000
169800         SET PS-UPDSKU-YES TO TRUE                                16980000
169900     END-IF.                                                      16990000
170000                                                                  17000000
170100     IF IM008-SKU-ATTR-SKU-DESC-CHG                               17010000
170200         MOVE IM008-SKU-ATTR-SKU-DESC-NEW                         17020000
170300                                TO XLT00003-SKU-DESC              17030000
170400         SET PS-UPDSKU-YES TO TRUE                                17040000
170500     END-IF.                                                      17050000
170600** TO DETERMINE IF WAREHOUSE INDICATOR CHANGE IS OCCURED ON A SKU 17060000
170700** IN ITEM DOMAIN **                                              17070000
170800** PB 05/04/2010 BEG                                              17080000
170900                                                                  17090000
171000     IF IM008-SKU-ATTR-WHSERPL-IND-CHG                            17100000
171100          MOVE IM008-SKU-ATTR-WHSERPL-IND-NEW                     17110000
171200                                 TO XLT00003-WHSE-RPLNT-IND       17120000
171300          SET PS-UPDSKU-YES TO TRUE                               17130000
171400     END-IF.                                                      17140000
171500** PB 05/04/2010 END                                              17150000
171600******************************************************************17160000
171700 2205-UPDATE-SKU-ATTR-CHGS.                                       17170000
171800******************************************************************17180000
171900                                                                  17190000
172000*UPDATE  SKU RECORD.                                              17200000
172100                                                                  17210000
172200** TO UPDATE THE XLT_SKU TABLE WITH THE NEW WAREHOUSE             17220000
172300** REPLENISHMENT INDICATOR **                                     17230000
172400** PB 05/04/2010                                                  17240000
172500     EXEC SQL                                                     17250000
172600        UPDATE XLT_SKU                                            17260000
172700            SET                                                   17270000
172800                KY_ITM_IND       = :XLT00003-KY-ITM-IND,          17280000
172900                GP_CDE           = :XLT00003-GP-CDE,              17290000
173000                REGN_PRIC_IND    = :XLT00003-REGN-PRIC-IND,       17300000
173100                SKU_DESC         = :XLT00003-SKU-DESC,            17310000
173200                WHSE_RPLNT_IND   = :XLT00003-WHSE-RPLNT-IND,      17320000
173300                LAST_UPD_TMST    = CURRENT TIMESTAMP              17330000
173400                                                                  17340000
173500            WHERE INTR_UPC_ID = :DK-ITEM-KEY-INTR-UPC-ID          17350000
173600     END-EXEC.                                                    17360000
173700                                                                  17370000
173800     EVALUATE TRUE                                                17380000
173900        WHEN SQLCODE = +0                                         17390000
174000            ADD +1 TO PA-TOTAL-SKU-UPDATES                        17400000
174200            PERFORM 6000-DB2-COMMIT                               17420000
174400            PERFORM 3600-MQ-COMMIT                                17440000
174500        WHEN SQLCODE = +100                                       17450000
174600            SET XL005-SKU-ROW-NOT-FOUND TO TRUE                   17460000
174700            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           17470000
174800            SET PS-ERROR-YES TO TRUE                              17480000
174900                                                                  17490000
175000        WHEN SQLWARN0 NOT = SPACES                                17500000
175100        WHEN SQLCODE  NOT = ZERO                                  17510000
175200            DISPLAY '******************************************'  17520000
175300            DISPLAY '*ABEND                                   *'  17530000
175400            DISPLAY '*PROGRAM   = XLKUP003                    *'  17540000
175500            DISPLAY '*DB2 OPER  = UPDATE ON XLT_SKU           *'  17550000
175600            DISPLAY '*PARAGRAPH = 2205-UPDATE-SKU-ATTR-CHGS   *'  17560000
175700            DISPLAY '*SQLCODE = ' SQLCODE                         17570000
175800            DISPLAY '******************************************'  17580000
175900            PERFORM 9100-SQL-ABEND                                17590000
176000     END-EVALUATE.                                                17600000
176100******************************************************************17610000
176200 2210-SKU-PKG-CHG.                                                17620000
176300******************************************************************17630000
176400                                                                  17640000
176500*SELECT SKU RECORD                                                17650000
176600                                                                  17660000
176700       SET PS-UPDSKU-NO TO TRUE.                                  17670000
176800                                                                  17680000
176900       EXEC SQL                                                   17690000
177000           SELECT                                                 17700000
177100                 INNR_PK_QTY,                                     17710000
177200                 OUTR_PK_QTY                                      17720000
177300           INTO                                                   17730000
177400                :XLT00003-INNR-PK-QTY,                            17740000
177500                :XLT00003-OUTR-PK-QTY                             17750000
177600           FROM XLT_SKU                                           17760000
177700           WHERE INTR_UPC_ID  = :DK-ITEM-KEY-INTR-UPC-ID          17770000
177800       END-EXEC                                                   17780000
177900                                                                  17790000
178000       EVALUATE TRUE                                              17800000
178100           WHEN SQLCODE = +0                                      17810000
178200               PERFORM 2215-CHK-PKG-CHGS                          17820000
178300               PERFORM 2220-UPDATE-SKU-PKG-CHGS                   17830000
178400           WHEN SQLWARN0 NOT = SPACES                             17840000
178500           WHEN SQLCODE  NOT = ZERO                               17850000
178600             SET XL005-SKU-ROW-NOT-FOUND TO TRUE                  17860000
178700             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          17870000
178800             SET PS-ERROR-YES TO TRUE                             17880000
178900       END-EVALUATE.                                              17890000
179000******************************************************************17900000
179100 2215-CHK-PKG-CHGS.                                               17910000
179200******************************************************************17920000
179300     IF IM008-SKU-PKG-INNR-PK-CHG                                 17930000
179400         MOVE IM008-SKU-PKG-INNR-PK-QTY-N                         17940000
179500                              TO XLT00003-INNR-PK-QTY             17950000
179600         SET PS-UPDSKU-YES TO TRUE                                17960000
179700     END-IF.                                                      17970000
179800                                                                  17980000
179900     IF IM008-SKU-PKG-OUTR-PK-CHG                                 17990000
180000         MOVE IM008-SKU-PKG-OUTR-PK-QTY-N                         18000000
180100                              TO XLT00003-OUTR-PK-QTY             18010000
180200         SET PS-UPDSKU-YES TO TRUE                                18020000
180300     END-IF.                                                      18030000
180400******************************************************************18040000
180500 2220-UPDATE-SKU-PKG-CHGS.                                        18050000
180600******************************************************************18060000
180700                                                                  18070000
180800*UPDATE  SKU RECORD.                                              18080000
180900                                                                  18090000
181000     EXEC SQL                                                     18100000
181100        UPDATE XLT_SKU                                            18110000
181200            SET                                                   18120000
181300                INNR_PK_QTY      = :XLT00003-INNR-PK-QTY,         18130000
181400                OUTR_PK_QTY      = :XLT00003-OUTR-PK-QTY,         18140000
181500                LAST_UPD_TMST    = CURRENT TIMESTAMP              18150000
181600                                                                  18160000
181700            WHERE INTR_UPC_ID = :DK-ITEM-KEY-INTR-UPC-ID          18170000
181800     END-EXEC.                                                    18180000
181900                                                                  18190000
182000     EVALUATE TRUE                                                18200000
182100        WHEN SQLCODE = +0                                         18210000
182200            ADD +1 TO PA-TOTAL-SKU-UPDATES                        18220000
182400            PERFORM 6000-DB2-COMMIT                               18240000
182600            PERFORM 3600-MQ-COMMIT                                18260000
182700        WHEN SQLCODE = +100                                       18270000
182800            SET XL005-SKU-ROW-NOT-FOUND TO TRUE                   18280000
182900            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           18290000
183000            SET PS-ERROR-YES TO TRUE                              18300000
183100                                                                  18310000
183200        WHEN SQLWARN0 NOT = SPACES                                18320000
183300        WHEN SQLCODE  NOT = ZERO                                  18330000
183400            DISPLAY '******************************************'  18340000
183500            DISPLAY '*ABEND                                   *'  18350000
183600            DISPLAY '*PROGRAM   = XLKUP003                    *'  18360000
183700            DISPLAY '*DB2 OPER  = UPDATE ON XLT_SKU           *'  18370000
183800            DISPLAY '*PARAGRAPH = 2220-UPDATE-SKU-PKG-CHGS    *'  18380000
183900            DISPLAY '*SQLCODE = ' SQLCODE                         18390000
184000            DISPLAY '******************************************'  18400000
184100            PERFORM 9100-SQL-ABEND                                18410000
184200     END-EVALUATE.                                                18420000
184300                                                                  18430000
184400******************************************************************18440000
184500 2225-SKU-DELETE.                                                 18450000
184600******************************************************************18460000
184700                                                                  18470000
184800     MOVE IM008-ITEM-KEY-INTR-UPC-ID                              18480000
184900                              TO PV-EDIT-INTR-UPC-ID.             18490000
185000     MOVE PV-INTR-UPC-ID-COMP                                     18500000
185100                              TO DK-ITEM-KEY-INTR-UPC-ID.         18510000
185200                                                                  18520000
185300     PERFORM 2226-INTR-UPC-DELETE.                                18530000
185400*DELETE  SKU RECORD.                                              18540000
185500                                                                  18550000
185600     EXEC SQL                                                     18560000
185700        DELETE FROM XLT_SKU                                       18570000
185800            WHERE INTR_UPC_ID = :DK-ITEM-KEY-INTR-UPC-ID          18580000
185900     END-EXEC.                                                    18590000
186000                                                                  18600000
186100     EVALUATE TRUE                                                18610000
186200        WHEN SQLCODE = +0                                         18620000
186300            ADD +1 TO PA-TOTAL-SKU-DELETES                        18630000
186500            PERFORM 6000-DB2-COMMIT                               18650000
186700            PERFORM 3600-MQ-COMMIT                                18670000
186800        WHEN SQLCODE = +100                                       18680000
186900            SET XL005-SKU-ROW-NOT-FOUND TO TRUE                   18690000
187000            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           18700000
187100            SET PS-ERROR-YES TO TRUE                              18710000
187200                                                                  18720000
187300        WHEN SQLWARN0 NOT = SPACES                                18730000
187400        WHEN SQLCODE  NOT = ZERO                                  18740000
187500            DISPLAY '******************************************'  18750000
187600            DISPLAY '*ABEND                                   *'  18760000
187700            DISPLAY '*PROGRAM   = XLKUP003                    *'  18770000
187800            DISPLAY '*DB2 OPER  = DELETE ON XLT_SKU           *'  18780000
187900            DISPLAY '*PARAGRAPH = 2225-SKU-DELETE             *'  18790000
188000            DISPLAY '*SQLCODE = ' SQLCODE                         18800000
188100            DISPLAY '******************************************'  18810000
188200            PERFORM 9100-SQL-ABEND                                18820000
188300     END-EVALUATE.                                                18830000
188400                                                                  18840000
188500******************************************************************18850000
188600 2226-INTR-UPC-DELETE.                                            18860000
188700******************************************************************18870000
188800                                                                  18880000
188900*DELETE  UPC RECORD.                                              18890000
189000                                                                  18900000
189100     EXEC SQL                                                     18910000
189200        DELETE FROM XLT_UPC                                       18920000
189300            WHERE INTR_UPC_ID = :DK-ITEM-KEY-INTR-UPC-ID          18930000
189400     END-EXEC.                                                    18940000
189500                                                                  18950000
189600     EVALUATE TRUE                                                18960000
189700        WHEN SQLCODE = +0                                         18970000
189800            ADD +1 TO PA-TOTAL-UPC-DELETES                        18980000
190000            PERFORM 6000-DB2-COMMIT                               19000000
190200            PERFORM 3600-MQ-COMMIT                                19020000
190300        WHEN SQLCODE = +100                                       19030000
190400            SET XL005-UPC-ROW-NOT-FOUND TO TRUE                   19040000
190500            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           19050000
190600            SET PS-ERROR-YES TO TRUE                              19060000
190700                                                                  19070000
190800        WHEN SQLWARN0 NOT = SPACES                                19080000
190900        WHEN SQLCODE  NOT = ZERO                                  19090000
191000            DISPLAY '******************************************'  19100000
191100            DISPLAY '*ABEND                                   *'  19110000
191200            DISPLAY '*PROGRAM   = XLKUP003                    *'  19120000
191300            DISPLAY '*DB2 OPER  = DELETE ON XLT_UPC           *'  19130000
191400            DISPLAY '*PARAGRAPH = 2226-UPC-DELETE             *'  19140000
191500            DISPLAY '*SQLCODE = ' SQLCODE                         19150000
191600            DISPLAY '******************************************'  19160000
191700            PERFORM 9100-SQL-ABEND                                19170000
191800     END-EVALUATE.                                                19180000
191900******************************************************************19190000
192000 2230-CHK-UPC-ORD-CHG.                                            19200000
192100     IF IM008-SKU-ATTR-EDI-ORD-CHG                                19210000
192200         MOVE IM008-SKU-ATTR-EDI-ORD-IND-NEW                      19220000
192300                                TO XLT00006-EDI-ORD-IND           19230000
192400         SET PS-UPDUPC-YES TO TRUE                                19240000
192500     END-IF.                                                      19250000
192600******************************************************************19260000
192700 2240-UPDATE-UPC-ORD-CHG.                                         19270000
192800******************************************************************19280000
192900                                                                  19290000
193000     MOVE IM008-ITEM-KEY-UPC-NBR TO DK-ITEM-KEY-UPC-NBR.          19300000
193100*UPDATE  UPC RECORD.                                              19310000
193200                                                                  19320000
193300     EXEC SQL                                                     19330000
193400        UPDATE XLT_UPC                                            19340000
193500            SET                                                   19350000
193600                EDI_ORD_IND   = :XLT00006-EDI-ORD-IND,            19360000
193700                LAST_UPD_TMST = CURRENT TIMESTAMP                 19370000
193800                                                                  19380000
193900            WHERE UPC_NBR     = :DK-ITEM-KEY-UPC-NBR              19390000
194000     END-EXEC                                                     19400000
194100                                                                  19410000
194200     EVALUATE TRUE                                                19420000
194300        WHEN SQLCODE = +0                                         19430000
194400            ADD +1 TO PA-TOTAL-UPC-UPDATES                        19440000
194600            PERFORM 6000-DB2-COMMIT                               19460000
194800            PERFORM 3600-MQ-COMMIT                                19480000
194900        WHEN SQLCODE = +100                                       19490000
195000*           SET XL005-UPC-ROW-NOT-FOUND TO TRUE                   19500000
195100*           MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           19510000
195200*           SET PS-ERROR-YES TO TRUE                              19520000
195300            CONTINUE                                              19530000
195400        WHEN SQLWARN0 NOT = SPACES                                19540000
195500        WHEN SQLCODE  NOT = ZERO                                  19550000
195600            DISPLAY '******************************************'  19560000
195700            DISPLAY '*ABEND                                   *'  19570000
195800            DISPLAY '*PROGRAM   = XLKUP003                    *'  19580000
195900            DISPLAY '*DB2 OPER  = UPDATE ON XLT_UPC           *'  19590000
196000            DISPLAY '*PARAGRAPH = 2240-UPDATE-UPC-ORD-CHG     *'  19600000
196100            DISPLAY '*SQLCODE = ' SQLCODE                         19610000
196200            DISPLAY '******************************************'  19620000
196300            PERFORM 9100-SQL-ABEND                                19630000
196400     END-EVALUATE.                                                19640000
196500******************************************************************19650000
196600 2250-UPC-ADD.                                                    19660000
196700******************************************************************19670000
196800                                                                  19680000
196900     INITIALIZE DCLXLT00006.                                      19690000
197000     MOVE DK-ITEM-KEY-UPC-ID            TO XLT00006-UPC-ID.       19700000
197100     MOVE DK-ITEM-KEY-INTR-UPC-ID       TO XLT00006-INTR-UPC-ID.  19710000
197200     MOVE IM008-UPC-ADD-EDI-ORD-IND     TO XLT00006-EDI-ORD-IND.  19720000
197300     MOVE IM008-ITEM-KEY-UPC-NBR        TO XLT00006-UPC-NBR.      19730000
197400     MOVE 'V'                           TO XLT00006-UPC-TYP-CDE.  19740000
197500*    MOVE SPACE                         TO XLT00006-CERTD-IND.    19750000
197600*    MOVE PV-TMST-CCYY-MM-DD            TO XLT00006-CERTD-DTE.    19760000
197700     PERFORM 2251-SELECT-TUPC                                     19770000
197800     MOVE UPC-CERTD-IND                 TO XLT00006-CERTD-IND.    19780000
197900     MOVE UPC-CERTD-DTE                 TO XLT00006-CERTD-DTE.    19790000
198000     MOVE IM008-UPC-ADD-PREPK-IND       TO XLT00006-PREPK-IND.    19800000
198100                                                                  19810000
198200* INSERT UPC RECORD                                               19820000
198300                                                                  19830000
198400     EXEC SQL                                                     19840000
198500         INSERT INTO XLT_UPC                                      19850000
198600            (UPC_ID                                               19860000
198700            ,INTR_UPC_ID                                          19870000
198800            ,UPC_TYP_CDE                                          19880000
198900            ,EDI_ORD_IND                                          19890000
199000            ,CERTD_IND                                            19900000
199100            ,CERTD_DTE                                            19910000
199200            ,UPC_NBR                                              19920000
199300            ,LAST_UPD_TMST                                        19930000
199400            ,PREPK_IND)                                           19940000
199500         VALUES                                                   19950000
199600            (:XLT00006-UPC-ID,                                    19960000
199700             :XLT00006-INTR-UPC-ID,                               19970000
199800             :XLT00006-UPC-TYP-CDE,                               19980000
199900             :XLT00006-EDI-ORD-IND,                               19990000
200000             :XLT00006-CERTD-IND,                                 20000000
200100             :XLT00006-CERTD-DTE,                                 20010000
200200             :XLT00006-UPC-NBR,                                   20020000
200300             CURRENT TIMESTAMP,                                   20030000
200400             :XLT00006-PREPK-IND)                                 20040000
200500     END-EXEC                                                     20050000
200600                                                                  20060000
200700     EVALUATE TRUE                                                20070000
200800         WHEN SQLCODE = +0                                        20080000
200900             ADD +1 TO PA-TOTAL-UPC-INSERTS                       20090000
201100             PERFORM 6000-DB2-COMMIT                              20110000
201300             PERFORM 3600-MQ-COMMIT                               20130000
201400         WHEN SQLCODE = -530                                      20140000
201500* THIS IS ACTUALLY NOT FINDING A FOREIGN KEY                      20150000
201600* WHICH IS INTR-UPC-ID NOT ON XLT_SKU TABLE.                      20160000
201700             SET XL005-SKU-INTR-UPC-NOT-FOUND TO TRUE             20170000
201800             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          20180000
201900             SET PS-ERROR-YES TO TRUE                             20190000
202000         WHEN SQLCODE = -803                                      20200000
202100             SET XL005-DUP-INSERT-UPC TO TRUE                     20210000
202200             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          20220000
202300             SET PS-ERROR-YES TO TRUE                             20230000
202400         WHEN SQLWARN0 NOT = SPACES                               20240000
202500         WHEN SQLCODE  NOT = ZERO                                 20250000
202600             DISPLAY '**************************************'     20260000
202700             DISPLAY '** ABEND                             *'     20270000
202800             DISPLAY '** PROGRAM = XLKUP003                *'     20280000
202900             DISPLAY '** PARAGRAPH = 2250-UPC-ADD          *'     20290000
203000             DISPLAY '** SET DB2   = INSERT TO XLT_UPC     *'     20300000
203100             DISPLAY '*SQLCODE = ' SQLCODE                        20310000
203200             DISPLAY '**************************************'     20320000
203300             PERFORM 9100-SQL-ABEND                               20330000
203400     END-EVALUATE.                                                20340000
203500                                                                  20350000
203600 2251-SELECT-TUPC.                                                20360000
203700******************************************************************20370000
203800*  THIS CODE IS TEMPORARY UNTIL WE RECEIVE THE CERTIFICATION      20380000
203900*  INDICATOR ON THE MESSAGES.                                     20390000
204000******************************************************************20400000
204100                                                                  20410000
204200     EXEC SQL                                                     20420000
204300         SELECT                                                   20430000
204400             CERTD_IND                                            20440000
204500            ,CERTD_DTE                                            20450000
204600         INTO                                                     20460000
204700             :UPC-CERTD-IND                                       20470000
204800            ,:UPC-CERTD-DTE                                       20480000
204900         FROM  TUPC                                               20490000
205000         WHERE UPC_NBR = :XLT00006-UPC-NBR                        20500000
205100           AND (EFF_BEG_DTE <= CURRENT DATE                       20510000
205200           AND (EFF_END_DTE IS NULL                               20520000
205300            OR  EFF_END_DTE > CURRENT DATE))                      20530000
205400         WITH UR                                                  20540001
205500     END-EXEC                                                     20550000
205600                                                                  20560000
205700     EVALUATE TRUE                                                20570000
205800         WHEN SQLCODE = +0                                        20580000
205900             CONTINUE                                             20590000
206000         WHEN SQLCODE = +100                                      20600000
206100             MOVE SPACES TO UPC-CERTD-IND                         20610000
206200             MOVE PV-TMST-CCYY-MM-DD   TO UPC-CERTD-DTE           20620000
206300         WHEN SQLWARN0 NOT = SPACES                               20630000
206400         WHEN SQLCODE  NOT = ZERO                                 20640000
206500             DISPLAY '**************************************'     20650000
206600             DISPLAY '** ABEND                             *'     20660000
206700             DISPLAY '** PROGRAM = XLKUP003                *'     20670000
206800             DISPLAY '** PARAGRAPH = 2251-SELECT-TUPC      *'     20680000
206900             DISPLAY '** SET DB2   = SELECT TO TUPC        *'     20690000
207000             DISPLAY '** SQLCODE = ' SQLCODE                      20700000
207100             MOVE XLT00006-UPC-NBR TO PV-DISP-UPC-NBR             20710000
207200             DISPLAY '** UPC-NBR = ' PV-DISP-UPC-NBR              20720000
207300             DISPLAY '**************************************'     20730000
207400             PERFORM 9100-SQL-ABEND                               20740000
207500     END-EVALUATE.                                                20750000
207600                                                                  20760000
207700******************************************************************20770000
207800 2260-UPC-DELETE.                                                 20780000
207900******************************************************************20790000
208000                                                                  20800000
208100     MOVE IM008-ITEM-KEY-UPC-NBR TO DK-ITEM-KEY-UPC-NBR.          20810000
208200                                                                  20820000
208300     EXEC SQL                                                     20830000
208400         DELETE FROM XLT_UPC                                      20840000
208500             WHERE UPC_NBR = :DK-ITEM-KEY-UPC-NBR                 20850000
208600     END-EXEC                                                     20860000
208700                                                                  20870000
208800     EVALUATE TRUE                                                20880000
208900         WHEN SQLCODE = +0                                        20890000
209000             ADD +1 TO PA-TOTAL-UPC-DELETES                       20900000
209200             PERFORM 6000-DB2-COMMIT                              20920000
209400             PERFORM 3600-MQ-COMMIT                               20940000
209500         WHEN SQLCODE = +100                                      20950000
209600*            SET XL005-UPC-ROW-NOT-FOUND TO TRUE                  20960000
209700*            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          20970000
209800*            SET PS-ERROR-YES TO TRUE                             20980000
209900             CONTINUE                                             20990000
210000         WHEN SQLWARN0 NOT = SPACES                               21000000
210100         WHEN SQLCODE  NOT = ZERO                                 21010000
210200             DISPLAY '**************************************'     21020000
210300             DISPLAY '** ABEND                             *'     21030000
210400             DISPLAY '** PROGRAM = XLKUP003                *'     21040000
210500             DISPLAY '** PARAGRAPH = 2260-UPC-DELETE       *'     21050000
210600             DISPLAY '** SET DB2   = DELETE ON XLT_UPC     *'     21060000
210700             DISPLAY '** SQLCODE = ' SQLCODE                      21070000
210800             DISPLAY '**************************************'     21080000
210900             PERFORM 9100-SQL-ABEND                               21090000
211000     END-EVALUATE.                                                21100000
211100                                                                  21110000
211200******************************************************************21120000
211300 2270-UPC-MOVE.                                                   21130000
211400******************************************************************21140000
211500                                                                  21150000
211600     MOVE IM008-ITEM-KEY-UPC-NBR TO DK-ITEM-KEY-UPC-NBR.          21160000
211700                                                                  21170000
211800     MOVE IM008-UPC-MOVE-INTR-UPC-ID-NEW                          21180000
211900                              TO PV-EDIT-INTR-UPC-ID-NEW.         21190000
212000     MOVE PV-INTR-UPC-ID-NEW-COMP                                 21200000
212100                              TO DK-UPC-MOVE-INTR-UPC-ID-NEW.     21210000
212200                                                                  21220000
212300     MOVE DK-UPC-MOVE-INTR-UPC-ID-NEW                             21230000
212400                           TO XLT00006-INTR-UPC-ID.               21240000
212500     MOVE SPACE            TO XLT00006-CERTD-IND.                 21250000
212600                                                                  21260000
212700     EXEC SQL                                                     21270000
212800         UPDATE XLT_UPC                                           21280000
212900             SET                                                  21290000
213000                 INTR_UPC_ID = :XLT00006-INTR-UPC-ID,             21300000
213100                 CERTD_IND   = :XLT00006-CERTD-IND,               21310000
213200                 LAST_UPD_TMST = CURRENT TIMESTAMP                21320000
213300         WHERE UPC_NBR       = :DK-ITEM-KEY-UPC-NBR               21330000
213400     END-EXEC                                                     21340000
213500                                                                  21350000
213600     EVALUATE TRUE                                                21360000
213700         WHEN SQLCODE = +0                                        21370000
213800             ADD +1 TO PA-TOTAL-UPC-UPDATES                       21380000
214000             PERFORM 6000-DB2-COMMIT                              21400000
214200             PERFORM 3600-MQ-COMMIT                               21420000
214300         WHEN SQLCODE = +100                                      21430000
214400             SET XL005-DUP-UPDATE-UPC TO TRUE                     21440000
214500             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          21450000
214600             SET PS-ERROR-YES TO TRUE                             21460000
214700         WHEN SQLWARN0 NOT = SPACES                               21470000
214800         WHEN SQLCODE  NOT = ZERO                                 21480000
214900             DISPLAY '**************************************'     21490000
215000             DISPLAY '** ABEND                             *'     21500000
215100             DISPLAY '** PROGRAM = XLKUP003                *'     21510000
215200             DISPLAY '** PARAGRAPH = 2270-UPC-MOVE         *'     21520000
215300             DISPLAY '** SET DB2   = UPDATE ON XLT_UPC     *'     21530000
215400             DISPLAY '** SQLCODE = ' SQLCODE                      21540000
215500             DISPLAY '** INTR UPC= ' DK-ITEM-KEY-UPC-NBR          21550000
215600             DISPLAY '** SKU     = ' DK-SKU                       21560000
215700             DISPLAY '**************************************'     21570000
215800             PERFORM 9100-SQL-ABEND                               21580000
215900     END-EVALUATE.                                                21590000
216000                                                                  21600000
216100                                                                  21610000
216200******************************************************************21620000
216300 2280-UPC-ATTR-CHG.                                               21630000
216400******************************************************************21640000
216500                                                                  21650000
216600     MOVE IM008-ITEM-KEY-UPC-NBR TO DK-ITEM-KEY-UPC-NBR.          21660000
216700                                                                  21670000
216800     MOVE IM008-UPC-ATTR-EDI-ORD-IND-N                            21680000
216900                            TO XLT00006-EDI-ORD-IND.              21690000
217000                                                                  21700000
217100     EXEC SQL                                                     21710000
217200         UPDATE XLT_UPC                                           21720000
217300             SET                                                  21730000
217400                 EDI_ORD_IND   = :XLT00006-EDI-ORD-IND,           21740000
217500                 LAST_UPD_TMST = CURRENT TIMESTAMP                21750000
217600         WHERE UPC_NBR         = :DK-ITEM-KEY-UPC-NBR             21760000
217700     END-EXEC                                                     21770000
217800                                                                  21780000
217900     EVALUATE TRUE                                                21790000
218000         WHEN SQLCODE = +0                                        21800000
218100             ADD +1 TO PA-TOTAL-UPC-UPDATES                       21810000
218300             PERFORM 6000-DB2-COMMIT                              21830000
218500             PERFORM 3600-MQ-COMMIT                               21850000
218600         WHEN SQLCODE = +100                                      21860000
218700             SET XL005-UPC-ROW-NOT-FOUND TO TRUE                  21870000
218800             MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD          21880000
218900             SET PS-ERROR-YES TO TRUE                             21890000
219000         WHEN SQLWARN0 NOT = SPACES                               21900000
219100         WHEN SQLCODE  NOT = ZERO                                 21910000
219200             DISPLAY '**************************************'     21920000
219300             DISPLAY '** ABEND                             *'     21930000
219400             DISPLAY '** PROGRAM = XLKUP003                *'     21940000
219500             DISPLAY '** PARAGRAPH = 2280-UPC-ATTR-CHG     *'     21950000
219600             DISPLAY '** SET DB2   = UPDATE ON XLT_UPC     *'     21960000
219700             DISPLAY '** SQLCODE = ' SQLCODE                      21970000
219800             DISPLAY '**************************************'     21980000
219900             PERFORM 9100-SQL-ABEND                               21990000
220000     END-EVALUATE.                                                22000000
220100                                                                  22010000
220200******************************************************************22020000
220300* CALL PROGRAM FOR LEGACY PACK ITEM MAINT                        *22030000
220400******************************************************************22040000
220500 2300-CALL-PROGRAM.                                               22050000
220600     MOVE IMRD075-RECORD      TO LV-IMRD075-RECORD.               22060000
220700     MOVE SPACE               TO LV-RETURN-CODE.                  22070000
220800                                                                  22080000
220900     CALL PC-CALLED-PROGRAM USING LV-IMRD075-RECORD               22090000
221000                                  LV-RETURN-CODE.                 22100000
221100                                                                  22110000
221200     EVALUATE TRUE                                                22120000
221300         WHEN LV-RETURN-CODE EQUAL ZEROS                          22130000
221400             PERFORM 2450-RMS-PACK-COUNT                          22140000
221500             PERFORM 6000-DB2-COMMIT                              22150000
221600             PERFORM 3600-MQ-COMMIT                               22160000
221700                                                                  22170000
221800         WHEN LV-RETURN-CODE NOT EQUAL ZEROS                      22180000
221900             MOVE LV-RETURN-CODE    TO XL005-ERROR-REC-TYP        22190000
222000             MOVE LV-IMRD075-RECORD TO XL005-IMRD008-RECORD       22200000
222100             SET PS-ERROR-YES       TO TRUE                       22210000
222200     END-EVALUATE.                                                22220000
222300******************************************************************22230000
222400 2350-UPDATE-SKU-STATUS.                                          22240000
222500******************************************************************22250000
222600                                                                  22260000
222700     IF IM008-RTL-CHG-UPC-STAT-CDE =                              22270000
222800        IM008-RTL-CHG-UPC-STAT-CDE-N                              22280000
222900        SET PS-NO-SKU-STAT-CHG TO TRUE                            22290000
223000     ELSE                                                         22300000
223100        SET PS-YES-SKU-STAT-CHG TO TRUE                           22310000
223200        MOVE IM008-RTL-CHG-UPC-STAT-CDE-N TO                      22320000
223300           XLT00003-SKU-STAT-CDE                                  22330000
223400     END-IF.                                                      22340000
223500                                                                  22350000
223600                                                                  22360000
223700*UPDATE SKU RECORD.                                               22370000
223800                                                                  22380000
223900     IF PS-YES-SKU-STAT-CHG                                       22390000
224000                                                                  22400000
224100        EXEC SQL                                                  22410000
224200           UPDATE XLT_SKU                                         22420000
224300               SET                                                22430000
224400                 SKU_STAT_CDE  = :XLT00003-SKU-STAT-CDE,          22440000
224500                 LAST_UPD_TMST = CURRENT TIMESTAMP                22450000
224600                                                                  22460000
224700               WHERE INTR_UPC_ID = :DK-ITEM-KEY-INTR-UPC-ID       22470000
224800                 AND SKU_NBR     = :DK-SKU                        22480000
224900        END-EXEC                                                  22490000
225000     END-IF                                                       22500000
225100                                                                  22510000
225200     EVALUATE TRUE                                                22520000
225300        WHEN SQLCODE = +0                                         22530000
225400            ADD +1 TO PA-TOTAL-SKU-UPDATES                        22540000
225600            PERFORM 6000-DB2-COMMIT                               22560000
225800            PERFORM 3600-MQ-COMMIT                                22580000
225900        WHEN SQLCODE = +100                                       22590000
226000            SET XL005-SKU-ROW-NOT-FOUND TO TRUE                   22600000
226100            MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD           22610000
226200            SET PS-ERROR-YES TO TRUE                              22620000
226300                                                                  22630000
226400        WHEN SQLWARN0 NOT = SPACES                                22640000
226500        WHEN SQLCODE  NOT = ZERO                                  22650000
226600            DISPLAY '******************************************'  22660000
226700            DISPLAY '*ABEND                                   *'  22670000
226800            DISPLAY '*PROGRAM   = XLKUP003                    *'  22680000
226900            DISPLAY '*DB2 OPER  = UPDATE ON XLT_SKU           *'  22690000
227000            DISPLAY '*PARAGRAPH = 2350-UPDATE-SKU-STATUS      *'  22700000
227100            DISPLAY '*SQLCODE = ' SQLCODE                         22710000
227110            DISPLAY '*SKU = ' DK-SKU                              22711035
227120            DISPLAY '*DK-ITEM-KEY-INTR-UPC-ID = '                 22712035
227130                      DK-ITEM-KEY-INTR-UPC-ID                     22713035
227200            DISPLAY '******************************************'  22720000
227300            PERFORM 9100-SQL-ABEND                                22730000
227400     END-EVALUATE.                                                22740000
227410                                                                  22741004
227412******************************************************************22741216
227413 2359-BRAND-UPDATES.                                              22741316
227414******************************************************************22741416
227416                                                                  22741616
227417     SET PS-P2359-DB2-UPDATE-NO TO TRUE.                          22741745
227419**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 22741963
227420* TAKE THE UPDATED BRAND ID FROM TMDARVS MERCHANDISE TABLE       *22742050
227421* FOR THE RECEIVED STYLE ID FROM VSM QUEUE.                      *22742150
227423                                                                  22742350
227424     EXEC SQL                                                     22742450
227425           SELECT                                                 22742550
227426                 LBL_SEQ_NBR                                      22742650
227427           INTO                                                   22742750
227428                 :MDARVS-LBL-SEQ-NBR                              22742850
227429           FROM  TMDARVS                                          22742950
227430           WHERE RMS_STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID           22743051
227431           AND   ACTV_IND = 'Y'                                   22743150
227432           WITH UR                                                22743264
227433     END-EXEC                                                     22743350
227434                                                                  22743450
227435     EVALUATE TRUE                                                22743550
227436           WHEN SQLCODE = +0                                      22743650
227437             MOVE MDARVS-LBL-SEQ-NBR   TO DK-BRND-KEY-ID          22743750
227438                                          XLT00043-BRND-ID        22743850
227439           WHEN SQLCODE = +100                                    22743950
227440             MOVE IM008-STYL-ATTR-LBL  TO DK-BRND-KEY-ID          22744050
227441                                          XLT00043-BRND-ID        22744150
227442           WHEN SQLWARN0 NOT = SPACES                             22744250
227443           WHEN SQLCODE  NOT = ZERO                               22744350
227444             DISPLAY '******************************************' 22744450
227445             DISPLAY '*ABEND                                   *' 22744550
227446             DISPLAY '*PROGRAM   = XLKUP003                    *' 22744650
227447             DISPLAY '*DB2 OPER  = SELECT ON TMDARVS           *' 22744750
227448             DISPLAY '*PARAGRAPH = 2359-BRAND-UPDATES          *' 22744850
227449             DISPLAY '*SQLCODE = ' SQLCODE                        22744950
227450             DISPLAY '******************************************' 22745050
227451             PERFORM 9100-SQL-ABEND                               22745150
227452     END-EVALUATE.                                                22745250
227453**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 END                   22745363
227454     EVALUATE TRUE                                                22745416
227455                                                                  22745550
227456     WHEN IM008-STYL-ATTR-LBL-CHG                                 22745616
227457         PERFORM 2360-UPDATE-BRAND-ID                             22745716
227458     END-EVALUATE.                                                22745818
227459                                                                  22745916
227460     EVALUATE TRUE                                                22746018
227461     WHEN IM008-STYL-ATTR-LBL-DESC-CHG                            22746116
227462         PERFORM 2370-UPDATE-BRAND-DESC                           22746216
227463     END-EVALUATE.                                                22746318
227464                                                                  22746416
227465     EVALUATE TRUE                                                22746518
227466     WHEN IM008-STYL-ATTR-LBL-TYP-CHG                             22746616
227467         PERFORM 2380-UPDATE-BRAND-TYP-CDE                        22746716
227468     END-EVALUATE.                                                22746816
227469                                                                  22746945
227470     IF  PS-P2359-DB2-UPDATE-YES                                  22747046
227471         PERFORM 6000-DB2-COMMIT                                  22747145
227472         PERFORM 3600-MQ-COMMIT                                   22747245
227473     END-IF.                                                      22747345
227474                                                                  22747416
227475******************************************************************22747504
227476 2360-UPDATE-BRAND-ID.                                            22747604
227477******************************************************************22747704
227478                                                                  22747804
227479     SET PS-BRAND-EXISTS-NO      TO TRUE.                         22747907
227483                                                                  22748304
227484       EXEC SQL                                                   22748404
227490           SELECT                                                 22749004
227491                 BRND_ID                                          22749104
227492                ,BRND_DESC                                        22749207
227493                ,BRND_TYP_CDE                                     22749307
227495           INTO                                                   22749504
227496                :XLT00043-BRND-ID                                 22749604
227497               ,:XLT00043-BRND-DESC                               22749707
227498               ,:XLT00043-BRND-TYP-CDE                            22749807
227500           FROM XLT_BRND                                          22750004
227501           WHERE BRND_ID  =  :DK-BRND-KEY-ID                      22750108
227502       END-EXEC                                                   22750204
227503                                                                  22750304
227504       EVALUATE TRUE                                              22750404
227505           WHEN SQLCODE = +0                                      22750504
227506               SET PS-BRAND-EXISTS-YES TO TRUE                    22750607
227508                                                                  22750804
227513           WHEN SQLCODE = +100                                    22751343
227514              SET PS-BRAND-EXISTS-NO TO TRUE                      22751442
227515*               BRAND DOES NOT EXIST - CHECK FOR ALL 3 TO         22751507
227516*               INSERT                                            22751607
227517           WHEN SQLWARN0 NOT = SPACES                             22751704
227518           WHEN SQLCODE  NOT = ZERO                               22751804
227519             DISPLAY '******************************************' 22751904
227520             DISPLAY '*ABEND                                   *' 22752004
227521             DISPLAY '*PROGRAM   = XLKUP003                    *' 22752104
227522             DISPLAY '*DB2 OPER  = SELECT ON XLT_BRND          *' 22752207
227523             DISPLAY '*PARAGRAPH = 2360-UPDATE-BRAND-ID        *' 22752307
227524             DISPLAY '*SQLCODE = ' SQLCODE                        22752404
227525             DISPLAY '******************************************' 22752504
227526             PERFORM 9100-SQL-ABEND                               22752604
227527       END-EVALUATE.                                              22752704
227528                                                                  22752847
227529       IF PS-BRAND-EXISTS-NO                                      22752930
227531***       INSERT IT BUT ONLY IF ALL 3 COLUMNS ARE PRESENT         22753130
227532          IF IM008-STYL-ATTR-LBL > 0            AND               22753231
227533             IM008-STYL-ATTR-LBL-DESC > SPACES  AND               22753331
227534             IM008-STYL-ATTR-LBL-TYP-CDE > SPACE                  22753431
227535***          DISPLAY 'ALL 3 VALUES ARE PRESENT'                   22753538
227536**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 22753664
227537** RPK       MOVE IM008-STYL-ATTR-LBL      TO XLT00043-BRND-ID    22753756
227538** COMMENTED THE ABOVE OUT DUE TO XLT00043-BRND-ID BEING          22753856
227539** POPULATED IN SELECT OF TMDARVS IN 2359 PARAGRAPH               22753956
227540**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 END                   22754063
227541             MOVE IM008-STYL-ATTR-LBL-DESC TO XLT00043-BRND-DESC  22754156
227542             MOVE IM008-STYL-ATTR-LBL-TYP-CDE TO                  22754256
227543                                         XLT00043-BRND-TYP-CDE    22754356
227544             PERFORM 2150-INSERT-BRND                             22754456
227545             SET PS-P2359-DB2-UPDATE-YES TO TRUE                  22754556
227546          END-IF                                                  22754656
227547       END-IF.                                                    22754756
227548                                                                  22754856
227549*    IF BRAND CHANGE AND BRAND ID NOT = CURRENT BRAND ID ON STY   22754956
227550*    UPDATE BRAND ID                                              22755056
227551                                                                  22755130
227552     IF IM008-STYL-ATTR-LBL-CHG AND                               22755230
227553        IM008-STYL-ATTR-LBL NOT = XLT00004-BRND-ID                22755330
227554**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 START                 22755463
227555** RPK  MOVE IM008-STYL-ATTR-LBL TO XLT00004-BRND-ID              22755556
227556        MOVE XLT00043-BRND-ID    TO XLT00004-BRND-ID              22755656
227557**** BRAND ID TAKEN FROM TMDARVS 10/29/2020 END                   22755763
227566                                                                  22756607
227567        EXEC SQL                                                  22756707
227568           UPDATE XLT_VND_STYL                                    22756807
227569               SET                                                22756907
227570                   BRND_ID          = :XLT00004-BRND-ID           22757007
227573                  ,LAST_UPD_TMST    = CURRENT TIMESTAMP           22757307
227576               WHERE STYL_ID = :DK-ITEM-KEY-RMS-STYL-ID           22757607
227577        END-EXEC                                                  22757707
227578                                                                  22757807
227579        EVALUATE TRUE                                             22757907
227580           WHEN SQLCODE = +0                                      22758007
227582               ADD +1 TO PA-TOTAL-VNDSTYL-UPDATES                 22758207
227583               SET PS-P2359-DB2-UPDATE-YES TO TRUE                22758345
227586           WHEN SQLCODE = +100                                    22758607
227587               SET XL005-STYLE-ROW-NOT-FOUND TO TRUE              22758707
227588               MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD        22758807
227589               SET PS-ERROR-YES TO TRUE                           22758907
227591                                                                  22759107
227592           WHEN SQLWARN0 NOT = SPACES                             22759207
227593           WHEN SQLCODE  NOT = ZERO                               22759307
227594              MOVE DK-ITEM-KEY-RMS-STYL-ID TO                     22759456
227595                   PV-RMS-STYL-ID                                 22759556
227596              DISPLAY '******************************************'22759607
227597              DISPLAY '*ABEND                                   *'22759707
227598              DISPLAY '*PROGRAM   = XLKUP003                    *'22759807
227599              DISPLAY '*DB2 OPER  = UPDATE ON XLT_VND_STYL      *'22759907
227600              DISPLAY '*PARAGRAPH = 2360-UPDATE-BRAND-ID        *'22760007
227601              DISPLAY '*SQLCODE = ' SQLCODE                       22760107
227602              DISPLAY '*STYL ID = ' PV-RMS-STYL-ID                22760256
227603              DISPLAY '******************************************'22760356
227604              PERFORM 9100-SQL-ABEND                              22760456
227605       END-EVALUATE                                               22760556
227606     END-IF.                                                      22760656
227607                                                                  22760756
227608******************************************************************22760856
227609 2370-UPDATE-BRAND-DESC.                                          22760956
227610******************************************************************22761056
227611                                                                  22761156
227612*CLP 04/07/2016                                                   22761256
227613     IF IM008-STYL-ATTR-LBL-DESC-CHG AND                          22761307
227614        IM008-STYL-ATTR-LBL-DESC NOT = XLT00043-BRND-DESC         22761407
227615        MOVE IM008-STYL-ATTR-LBL-DESC TO XLT00043-BRND-DESC       22761507
227616                                                                  22761607
227617        EXEC SQL                                                  22761707
227618           UPDATE XLT_BRND                                        22761807
227619               SET                                                22761907
227620                   BRND_DESC        = :XLT00043-BRND-DESC         22762007
227621                  ,LAST_UPD_TMST    = CURRENT TIMESTAMP           22762107
227622               WHERE BRND_ID = :XLT00043-BRND-ID                  22762207
227623        END-EXEC                                                  22762307
227624                                                                  22762407
227625        EVALUATE TRUE                                             22762507
227626           WHEN SQLCODE = +0                                      22762607
227627               ADD +1 TO PA-TOTAL-BRAND-UPDATES                   22762707
227628               SET PS-P2359-DB2-UPDATE-YES TO TRUE                22762845
227631           WHEN SQLCODE = +100                                    22763107
227632               SET XL005-BRAND-ROW-NOT-FOUND TO TRUE              22763207
227633               MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD        22763307
227634               SET PS-ERROR-YES TO TRUE                           22763407
227635                                                                  22763507
227636           WHEN SQLWARN0 NOT = SPACES                             22763607
227637           WHEN SQLCODE  NOT = ZERO                               22763707
227638              DISPLAY '******************************************'22763807
227639              DISPLAY '*ABEND                                   *'22763907
227640              DISPLAY '*PROGRAM   = XLKUP003                    *'22764007
227641              DISPLAY '*DB2 OPER  = UPDATE ON XLT_BRND          *'22764107
227642              DISPLAY '*PARAGRAPH = 2370-UPDATE-BRAND-DESC      *'22764207
227643              DISPLAY '*SQLCODE = ' SQLCODE                       22764307
227644              DISPLAY '******************************************'22764407
227645              PERFORM 9100-SQL-ABEND                              22764507
227646       END-EVALUATE                                               22764607
227647     END-IF.                                                      22764707
227648******************************************************************22764807
227649 2380-UPDATE-BRAND-TYP-CDE.                                       22764908
227650******************************************************************22765038
227651                                                                  22765107
227652*CLP 04/07/2016                                                   22765241
227656                                                                  22765641
227657     IF IM008-STYL-ATTR-LBL-TYP-CHG AND                           22765707
227658        IM008-STYL-ATTR-LBL-TYP-CDE NOT = XLT00043-BRND-TYP-CDE   22765807
227659        MOVE IM008-STYL-ATTR-LBL-TYP-CDE TO XLT00043-BRND-TYP-CDE 22765907
227660                                                                  22766007
227661        EXEC SQL                                                  22766107
227662           UPDATE XLT_BRND                                        22766207
227663               SET                                                22766307
227664                   BRND_TYP_CDE     = :XLT00043-BRND-TYP-CDE      22766407
227665                  ,LAST_UPD_TMST    = CURRENT TIMESTAMP           22766507
227666               WHERE BRND_ID = :XLT00043-BRND-ID                  22766607
227667        END-EXEC                                                  22766707
227668                                                                  22766807
227669        EVALUATE TRUE                                             22766907
227670           WHEN SQLCODE = +0                                      22767007
227671               ADD +1 TO PA-TOTAL-BRAND-UPDATES                   22767107
227672               SET PS-P2359-DB2-UPDATE-YES TO TRUE                22767245
227675           WHEN SQLCODE = +100                                    22767507
227676               SET XL005-BRAND-ROW-NOT-FOUND TO TRUE              22767607
227677               MOVE IMRD008-RECORD TO XL005-IMRD008-RECORD        22767707
227678               SET PS-ERROR-YES TO TRUE                           22767807
227679                                                                  22767907
227680           WHEN SQLWARN0 NOT = SPACES                             22768007
227681           WHEN SQLCODE  NOT = ZERO                               22768107
227682              DISPLAY '******************************************'22768207
227683              DISPLAY '*ABEND                                   *'22768307
227684              DISPLAY '*PROGRAM   = XLKUP003                    *'22768407
227685              DISPLAY '*DB2 OPER  = UPDATE ON XLT_BRND          *'22768507
227686              DISPLAY '*PARAGRAPH = 2380-UPDATE-BRAND-TYP-CDE   *'22768607
227687              DISPLAY '*SQLCODE = ' SQLCODE                       22768707
227688              DISPLAY '******************************************'22768807
227689              PERFORM 9100-SQL-ABEND                              22768907
227690       END-EVALUATE                                               22769007
227691     END-IF.                                                      22769107
227692*CLP 07/10/2015 END                                               22769216
227693                                                                  22769307
227694* CREATE THE PROCESS CONTROL TMST BY GETTING THE DB2 CURRENT TMST*22769400
227700******************************************************************22770000
227800 2400-GEN-PRC-CNTL-TMST.                                          22780000
227810******************************************************************22781038
227900                                                                  22790000
228000          INITIALIZE PV-CURRENT-PRC-CNTL-TMST.                    22800000
228100                                                                  22810000
228200          EXEC SQL                                                22820000
228300              SET :PV-CURRENT-PRC-CNTL-TMST = CURRENT TIMESTAMP   22830000
228400          END-EXEC                                                22840000
228500                                                                  22850000
228600         EVALUATE TRUE                                            22860000
228700             WHEN SQLCODE = ZERO                                  22870000
228800                 CONTINUE                                         22880000
228900                                                                  22890000
229000             WHEN SQLWARN0 NOT = SPACES                           22900000
229100             WHEN SQLCODE  NOT = ZERO                             22910000
229200                 DISPLAY '**************************************' 22920000
229300                 DISPLAY '** ABEND                             *' 22930000
229400                 DISPLAY '** PROGRAM = XLKUP003                *' 22940000
229500                 DISPLAY '** PARAGRAPH = 2400-GEN-PRC-CNTL-TMST*' 22950000
229600                 DISPLAY '** SET DB2 CURRENT TIMESTAMP         *' 22960000
229700                 DISPLAY '** SQLCODE = ' SQLCODE                  22970000
229800                 DISPLAY '**************************************' 22980000
229900                 PERFORM 9100-SQL-ABEND                           22990000
230000         END-EVALUATE.                                            23000000
230100                                                                  23010000
230200******************************************************************23020000
230300 2450-RMS-PACK-COUNT.                                             23030000
230400     IF PC-CALLED-PROGRAM = 'XLKUP019'                            23040000
230500         ADD +1    TO PA-TOTAL-XLTPAK-MAINT                       23050000
230600     END-IF                                                       23060000
230700     IF PC-CALLED-PROGRAM = 'XLKUP020'                            23070000
230800         ADD +1    TO PA-TOTAL-XLTSKU-MAINT                       23080000
230900     END-IF                                                       23090000
231000     IF PC-CALLED-PROGRAM = 'XLKUP021'                            23100000
231100         ADD +1    TO PA-TOTAL-XLTUPC-MAINT                       23110000
231200     END-IF                                                       23120000
231300     IF PC-CALLED-PROGRAM = 'XLKUP022'                            23130000
231400         ADD +1    TO PA-TOTAL-TPOPRPK-UPD                        23140000
231500     END-IF.                                                      23150000
231600                                                                  23160000
231700******************************************************************23170000
231800                                                                  23180000
231900****************************************************************  23190000
232000*                                                                 23200000
232100*                                                                 23210000
232200**   B E G I N     M Q    S E R I E S     P A R A G R A P H S **  23220000
232300*                                                                 23230000
232400*                                                                 23240000
232500****************************************************************  23250000
232600                                                                  23260000
232700****************************************************************  23270000
232800** CONNECT TO THE QUEUE MANAGER                                   23280000
232900**                                                                23290000
233000** GET THE HANDLE TO THE QUEUE MANAGER - PV-HCONN                 23300000
233100****************************************************************  23310000
233200 3100-MQ-CONNECT-TO-QMGR.                                         23320000
233300                                                                  23330000
233400     MOVE '3100-MQ-CONNECT-TO-QMGR' TO PV-PARAGRAPH.              23340000
233500*                                                                 23350000
233600* CONNECT TO THE QUEUE                                            23360000
233700* CONTROL CARD 1 - QMGR NAME                                      23370000
233800*                                                                 23380000
233900                                                                  23390000
234000     MOVE CC-QMGR-NAME             TO PV-QMGR-NAME.               23400000
234100                                                                  23410000
234200     CALL PC-MQCONN USING PV-QMGR-NAME                            23420000
234300                          PV-HCONN                                23430000
234400                          PV-COMPLETION-CODE                      23440000
234500                          PV-REASON.                              23450000
234600                                                                  23460000
234700*IF CONNECTION FAILED THEN DISPLAY ERROR MESSAGE AND EXIT         23470000
234800     MOVE PV-REASON TO PV-CON-REASON.                             23480000
234900     IF PV-COMPLETION-CODE = MQCC-OK THEN                         23490000
235000         CONTINUE                                                 23500000
235100     ELSE                                                         23510000
235200         CALL PV-MQCHECK USING PV-REASON                          23520000
235300                               PV-MQ-REASON-TEXT                  23530000
235400         MOVE PV-QMGR-NAME         TO PE-MQ-QMANAGER              23540000
235500         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       23550000
235600         MOVE PV-REASON            TO PE-MQ-REASON-CODE           23560000
235700         MOVE 'CONNECT TO QMGR'    TO PV-ERROR-MESSAGE            23570000
235800         PERFORM 9200-MQ-ABEND                                    23580000
235900     END-IF.                                                      23590000
236000                                                                  23600000
236100****************************************************************  23610000
236200** OPEN THE ITEM QUEUE FOR GETS.                                  23620000
236300****************************************************************  23630000
236400 3200-MQ-QUEUE-OPEN.                                              23640000
236500                                                                  23650000
236600     MOVE '3200-MQ-QUEUE-OPEN'     TO PV-PARAGRAPH.               23660000
236700*                                                                 23670000
236800* CONTROL CARD 2 - ITEM QUEUE NAME                                23680000
236900*                                                                 23690000
237000     MOVE CC-ITEM-QUEUE-NAME       TO MQOD-OBJECTNAME             23700000
237100     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        23710000
237200                                                                  23720000
237300     COMPUTE PV-OPEN-OPTIONS       = MQOO-INPUT-SHARED            23730000
237400                                   + MQOO-OUTPUT                  23740000
237500                                   + MQOO-SET-IDENTITY-CONTEXT    23750000
237600                                   + MQOO-FAIL-IF-QUIESCING.      23760000
237700                                                                  23770000
237800     CALL PC-MQOPEN USING PV-HCONN                                23780000
237900                          MQM-OBJECT-DESCRIPTOR                   23790000
238000                          PV-OPEN-OPTIONS                         23800000
238100                          PV-GQ-HANDLE                            23810000
238200                          PV-COMPLETION-CODE                      23820000
238300                          PV-REASON.                              23830000
238400                                                                  23840000
238500     IF PV-COMPLETION-CODE = MQCC-OK THEN                         23850000
238600         CONTINUE                                                 23860000
238700     ELSE                                                         23870000
238800         CALL PV-MQCHECK USING PV-REASON                          23880000
238900                               PV-MQ-REASON-TEXT                  23890000
239000         MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER           23900000
239100         MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME              23910000
239200         MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE    23920000
239300         MOVE PV-REASON               TO PE-MQ-REASON-CODE        23930000
239400         MOVE 'OPEN ITEM QUEUE'       TO PV-ERROR-MESSAGE         23940000
239500         PERFORM 9200-MQ-ABEND                                    23950000
239600     END-IF.                                                      23960000
239700                                                                  23970000
239800****************************************************************  23980000
239900** OPEN THE ITEM QUEUE FOR PUTS.                                  23990000
240000****************************************************************  24000000
240100 3205-MQ-ERROR-QUEUE-OPEN.                                        24010000
240200                                                                  24020000
240300     MOVE '3205-MQ-ERROR-QUEUE-OPEN' TO PV-PARAGRAPH.             24030000
240400*                                                                 24040000
240500* CONTROL CARD 3 - ERROR QUEUE NAME                               24050000
240600*                                                                 24060000
240700                                                                  24070000
240800     MOVE CC-ERROR-QUEUE-NAME      TO MQOD-OBJECTNAME.            24080000
240900     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        24090000
241000                                                                  24100000
241100     COMPUTE PV-OPEN-OPTIONS       = MQOO-OUTPUT                  24110000
241200                                   + MQOO-SET-IDENTITY-CONTEXT    24120000
241300                                   + MQOO-FAIL-IF-QUIESCING.      24130000
241400                                                                  24140000
241500     CALL PC-MQOPEN USING PV-HCONN                                24150000
241600                          MQM-OBJECT-DESCRIPTOR                   24160000
241700                          PV-OPEN-OPTIONS                         24170000
241800                          PV-PQ-HANDLE                            24180000
241900                          PV-COMPLETION-CODE                      24190000
242000                          PV-REASON.                              24200000
242100                                                                  24210000
242200     IF PV-COMPLETION-CODE = MQCC-OK THEN                         24220000
242300         SET PS-ERROR-QUEUE-IS-OPEN-YES TO TRUE                   24230000
242400     ELSE                                                         24240000
242500         CALL PV-MQCHECK USING PV-REASON                          24250000
242600                               PV-MQ-REASON-TEXT                  24260000
242700         MOVE PV-QMGR-NAME         TO PE-MQ-QMANAGER              24270000
242800         MOVE CC-ERROR-QUEUE-NAME  TO PE-MQ-QNAME                 24280000
242900         MOVE PV-COMPLETION-CODE   TO PE-MQ-COMPLETION-CODE       24290000
243000         MOVE PV-REASON            TO PE-MQ-REASON-CODE           24300000
243100         MOVE 'OPEN ERROR QUEUE'   TO PV-ERROR-MESSAGE            24310000
243200         PERFORM 9200-MQ-ABEND                                    24320000
243300     END-IF.                                                      24330000
243400                                                                  24340000
243500****************************************************************  24350000
243600** GET THE FIRST MESSAGE (ITEM) FROM THE QUEUE.                   24360000
243700** THE QUEUE IS SET UP SO MSGS ARE RETRIEVED IN FIFO ORDER.       24370000
243800****************************************************************  24380000
243900 3300-MQ-GET-MSG.                                                 24390000
244000                                                                  24400000
244100     INITIALIZE PV-MSGBUFFER                                      24410000
244200                PV-ERRMSGBUF                                      24420000
244300                PV-DTL                                            24430000
244400                PV-MSG.                                           24440000
244500                                                                  24450000
244600*MSG ID IS NOT POPULATED IN THIS PGM.                             24460000
244700     MOVE MQMI-NONE TO MQMD-MSGID.                                24470000
244800                                                                  24480000
244900*MSGS ARE UNQUALIFIED IN THIS PGM.                                24490000
245000     MOVE MQCI-NONE         TO MQMD-CORRELID.                     24500000
245100                                                                  24510000
245200*FORMAT TRANSLATES THE DATA ACROSS PLATFORMS, 4K IS THE           24520000
245300*MAX LENGTH FOR MSGS IN THE PGM.                                  24530000
245400     MOVE MQFMT-STRING         TO MQMD-FORMAT.                    24540000
245500     MOVE +450                 TO PV-MSG-LENGTH.                  24550000
245600                                                                  24560000
245700*THE UNLIMITED WAIT INTERVAL MEANS THAT PROCESSING WILL JUST      24570000
245800* 'WAIT' UNTIL A MESSAGE APPEARAS ON THE Q.                       24580000
245900     MOVE MQWI-UNLIMITED       TO MQGMO-WAITINTERVAL.             24590000
246000                                                                  24600000
246100     COMPUTE MQGMO-OPTIONS  =  MQGMO-SYNCPOINT +                  24610000
246200                               MQGMO-CONVERT   +                  24620000
246300                               MQGMO-ACCEPT-TRUNCATED-MSG +       24630000
246400                               MQGMO-WAIT.                        24640000
246500                                                                  24650000
246600     CALL PC-MQGET USING PV-HCONN                                 24660000
246700                         PV-GQ-HANDLE                             24670000
246800                         MQM-MESSAGE-DESCRIPTOR                   24680000
246900                         MQM-GET-MESSAGE-OPTIONS                  24690000
247000                         PV-MSG-LENGTH                            24700000
247100                         PV-MSGBUFFER                             24710000
247200                         PV-DATA-LENGTH                           24720000
247300                         PV-COMPLETION-CODE                       24730000
247400                         PV-REASON.                               24740000
247500                                                                  24750000
247600*IF GET FAILED THEN DISPLAY ERROR MESSAGE                         24760000
247700*AND BREAK OUT OF LOOP                                            24770000
247800     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        24780000
247900         IF ((PV-REASON NOT = MQRC-NO-MSG-AVAILABLE)              24790000
248000          AND (PV-REASON NOT = MQRC-TRUNCATED-MSG-ACCEPTED))      24800000
248100             CALL PV-MQCHECK USING PV-REASON                      24810000
248200                                   PV-MQ-REASON-TEXT              24820000
248300           MOVE 'MQGET ERROR'          TO PV-ERROR-MESSAGE        24830000
248400           MOVE '3300-MQ-GET-UNQUALIFIED' TO PV-PARAGRAPH         24840000
248500           MOVE PV-COMPLETION-CODE     TO PV-HOLD-COMPLETION-CODE 24850000
248600           MOVE PV-REASON              TO PV-HOLD-REASON          24860000
248700           PERFORM 3700-BACK-OUT-MQ                               24870000
248800           MOVE PV-HOLD-COMPLETION-CODE  TO PV-COMPLETION-CODE    24880000
248900                                            PE-MQ-COMPLETION-CODE 24890000
249000           MOVE PV-HOLD-REASON           TO PV-REASON             24900000
249100                                            PE-MQ-REASON-CODE     24910000
249200           PERFORM 9200-MQ-ABEND                                  24920000
249300         END-IF                                                   24930000
249400*THIS MEANS A MSG WAS TRUNCATED                                   24940000
249500         IF PV-COMPLETION-CODE = +1                               24950000
249600          AND PV-REASON = +2079                                   24960000
249700            PERFORM 4750-MSG-TOO-BIG-ERROR                        24970000
249800            ADD +1                       TO PA-TOTAL-GETS         24980000
249900         END-IF                                                   24990000
250000     ELSE                                                         25000000
250100        SET PS-GOOD-MSG-YES              TO TRUE                  25010000
250200        ADD +1                           TO PA-TOTAL-GETS         25020000
250300*PV-MSG IS USED TO PARSE THE DATA, ITS AN ELEMENT THAT JUST       25030000
250400*HOLDS THE ENTIRE ITEM UNTIL                                      25040000
250500*IT IS EITHER LOADED TO THE DB2 TABLE OR PUT TO THE ERROR QUEUE.  25050000
250600        MOVE PV-MSGBUFFER                TO PV-MSG                25060000
250700        MOVE PV-MSGBUFFER                TO PV-DTL                25070000
250800                                                                  25080000
250900*THIS GETS THE LEGACY ITEM PACK MAINTENANCE RECORD                25090000
251000*   OR THE LEGACY ITEM MAINTENANCE RECORD                         25100000
251100                                                                  25110000
251200        INITIALIZE IMRD075-RECORD                                 25120000
251300        INITIALIZE IMRD008-RECORD                                 25130000
251400        IF PV-DTL-EVENT = 200 OR 205 OR 210                       25140000
251500            MOVE PV-MSGBUFFER TO IMRD075-RECORD                   25150000
251600        ELSE                                                      25160000
251700            MOVE PV-MSGBUFFER TO IMRD008-RECORD                   25170000
251800        END-IF                                                    25180000
251900                                                                  25190000
252000                                                                  25200000
252100*THE "END OF PROGRAM" MSG WILL SHUT DOWN THIS STARTED TASK.       25210000
252200     IF PV-END-RUN-MSG                                            25220000
252300        SET PS-TIME-TO-END-PROGRAM-YES TO TRUE                    25230000
252400        ADD +1 TO PA-END-OF-RUN-MESSAGES                          25240000
252500        SUBTRACT 1 FROM PA-TOTAL-GETS                             25250000
252600        PERFORM 5000-END-RUN-ROUTINE                              25260000
252700     END-IF.                                                      25270000
252800                                                                  25280000
252900*THE BUSINESS EVENT "999" WILL END PROCESS                        25290000
253000*AND SHUT DOWN THIS STARTED TASK.                                 25300000
253100                                                                  25310000
253200     IF IM008-BUSINESS-EVENT-ID = 999                             25320000
253300         SET PS-TIME-TO-END-PROGRAM-YES TO TRUE                   25330000
253400         ADD +1 TO PA-999-STOP-PROC-MESSAGES                      25340000
253500         SUBTRACT 1 FROM PA-TOTAL-GETS                            25350000
253600         PERFORM 5000-END-RUN-ROUTINE                             25360000
253700     END-IF.                                                      25370000
253800****************************************************************  25380000
253900** CLOSES THE TRANS QUEUE.                                        25390000
254000****************************************************************  25400000
254100 3400-MQ-QUEUE-CLOSE.                                             25410000
254200                                                                  25420000
254300     MOVE '3400-MQ-QUEUE-CLOSE'    TO PV-PARAGRAPH.               25430000
254400                                                                  25440000
254500     MOVE CC-ITEM-QUEUE-NAME       TO MQOD-OBJECTNAME.            25450000
254600     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        25460000
254700     CALL PC-MQCLOSE USING PV-HCONN                               25470000
254800                           PV-GQ-HANDLE                           25480000
254900                           MQCO-NONE                              25490000
255000                           PV-COMPLETION-CODE                     25500000
255100                           PV-REASON.                             25510000
255200                                                                  25520000
255300     IF PV-COMPLETION-CODE = MQCC-OK THEN                         25530000
255400         CONTINUE                                                 25540000
255500     ELSE                                                         25550000
255600         CALL PV-MQCHECK USING PV-REASON                          25560000
255700                               PV-MQ-REASON-TEXT                  25570000
255800         MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER           25580000
255900         MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME              25590000
256000         MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE    25600000
256100         MOVE PV-REASON               TO PE-MQ-REASON-CODE        25610000
256200         MOVE 'PE-MQ-CLOSE'           TO PV-ERROR-MESSAGE         25620000
256300         PERFORM 9200-MQ-ABEND                                    25630000
256400     END-IF.                                                      25640000
256500                                                                  25650000
256600****************************************************************  25660000
256700** CLOSES THE ERROR QUEUE.                                        25670000
256800****************************************************************  25680000
256900 3405-MQ-ERROR-QUEUE-CLOSE.                                       25690000
257000                                                                  25700000
257100     MOVE '3405-MQ-ERROR-QUEUE-CLOSE'  TO PV-PARAGRAPH.           25710000
257200                                                                  25720000
257300     MOVE CC-ERROR-QUEUE-NAME      TO MQOD-OBJECTNAME.            25730000
257400     MOVE PV-QMGR-NAME             TO MQOD-OBJECTQMGRNAME.        25740000
257500                                                                  25750000
257600     CALL PC-MQCLOSE USING PV-HCONN                               25760000
257700                           PV-PQ-HANDLE                           25770000
257800                           MQCO-NONE                              25780000
257900                           PV-COMPLETION-CODE                     25790000
258000                           PV-REASON.                             25800000
258100                                                                  25810000
258200     IF PV-COMPLETION-CODE = MQCC-OK THEN                         25820000
258300         SET PS-ERROR-QUEUE-IS-OPEN-NO TO TRUE                    25830000
258400     ELSE                                                         25840000
258500         CALL PV-MQCHECK USING PV-REASON                          25850000
258600                               PV-MQ-REASON-TEXT                  25860000
258700         MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER           25870000
258800         MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME              25880000
258900         MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE    25890000
259000         MOVE PV-REASON               TO PE-MQ-REASON-CODE        25900000
259100         MOVE 'PE-ERROR-Q-CLOSE'      TO PV-ERROR-MESSAGE         25910000
259200         PERFORM 9200-MQ-ABEND                                    25920000
259300     END-IF.                                                      25930000
259400                                                                  25940000
259500****************************************************************  25950000
259600** DISCONNECT FROM THE QUEUE MANAGER                              25960000
259700****************************************************************  25970000
259800 3500-DISCONNECT-QMGR.                                            25980000
259900                                                                  25990000
260000     MOVE '3500-DISCONNECT-QMGR'    TO PV-PARAGRAPH.              26000000
260100     CALL PC-MQDISC USING PV-HCONN                                26010000
260200                          PV-COMPLETION-CODE                      26020000
260300                          PV-REASON                               26030000
260400                                                                  26040000
260500     IF PV-COMPLETION-CODE = MQCC-OK THEN                         26050000
260600        CONTINUE                                                  26060000
260700     ELSE                                                         26070000
260800         CALL PV-MQCHECK USING PV-REASON                          26080000
260900                               PV-MQ-REASON-TEXT                  26090000
261000        MOVE PV-QMGR-NAME            TO PE-MQ-QMANAGER            26100000
261100        MOVE CC-ITEM-QUEUE-NAME      TO PE-MQ-QNAME               26110000
261200        MOVE PV-COMPLETION-CODE      TO PE-MQ-COMPLETION-CODE     26120000
261300        MOVE PV-REASON               TO PE-MQ-REASON-CODE         26130000
261400        MOVE '3500-DISCONNECT-QMGR'  TO PV-ERROR-MESSAGE          26140000
261500        PERFORM 9200-MQ-ABEND                                     26150000
261600     END-IF.                                                      26160000
261700                                                                  26170000
261800******************************************************************26180000
261900*  COMMIT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT        26190000
262000******************************************************************26200000
262100 3600-MQ-COMMIT.                                                  26210000
262200                                                                  26220000
262300     CALL PC-MQCMIT USING PV-HCONN                                26230000
262400                          PV-COMPLETION-CODE                      26240000
262500                          PV-REASON.                              26250000
262600                                                                  26260000
262700     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        26270000
262800         CALL PV-MQCHECK USING PV-REASON                          26280000
262900                               PV-MQ-REASON-TEXT                  26290000
263000        MOVE '3600-COMMIT-MQ'   TO PV-PARAGRAPH                   26300000
263100        MOVE 'MQCMIT ERROR'     TO PV-ERROR-MESSAGE               26310000
263200        MOVE PV-COMPLETION-CODE TO PV-HOLD-COMPLETION-CODE        26320000
263300        MOVE PV-REASON          TO PV-HOLD-REASON                 26330000
263400        PERFORM 3700-BACK-OUT-MQ                                  26340000
263500        MOVE PV-HOLD-COMPLETION-CODE TO PV-COMPLETION-CODE        26350000
263600                                        PE-MQ-COMPLETION-CODE     26360000
263700        MOVE PV-HOLD-REASON          TO PV-REASON                 26370000
263800                                        PE-MQ-REASON-CODE         26380000
263900        PERFORM 9200-MQ-ABEND                                     26390000
264000     ELSE                                                         26400000
264100        ADD +1 TO PA-TOTAL-MQ-COMMITS                             26410000
264200     END-IF.                                                      26420000
264300                                                                  26430000
264400******************************************************************26440000
264500* BACK OUT MQ PROCESSING SINCE THE POINT OF THE LAST COMMIT       26450000
264600******************************************************************26460000
264700 3700-BACK-OUT-MQ.                                                26470000
264800                                                                  26480000
264900     CALL PC-MQBACK USING PV-HCONN                                26490000
265000                          PV-COMPLETION-CODE                      26500000
265100                          PV-REASON.                              26510000
265200                                                                  26520000
265300     IF (PV-COMPLETION-CODE NOT = MQCC-OK) THEN                   26530000
265400         CALL PV-MQCHECK USING PV-REASON                          26540000
265500                               PV-MQ-REASON-TEXT                  26550000
265600        MOVE '3700-BACK-OUT-MQ'  TO PV-PARAGRAPH                  26560000
265700        MOVE 'MQBACK ERROR'      TO PV-ERROR-MESSAGE              26570000
265800        PERFORM 9200-MQ-ABEND                                     26580000
265900     END-IF.                                                      26590000
266000                                                                  26600000
266100****************************************************************  26610000
266200* PUT MESSAGE IN ERROR TO THE ITEM ERROR QUEUE                    26620000
266300****************************************************************  26630000
266400 3800-PUT-MSG-TO-ERROR-Q.                                         26640000
266500                                                                  26650000
266600*UPDATE THE ERROR MESSAGE COUNTER.                                26660000
266700     ADD +1 TO PA-TOTAL-ERRORQ-RECS.                              26670000
266800                                                                  26680000
266900*MSGID IS NOT POPULATED AT ALL IN THIS PGM.                       26690000
267000     MOVE MQMI-NONE        TO MQMD-MSGID.                         26700000
267100                                                                  26710000
267200*KEEP ORIGINAL CORRELID.                                          26720000
267300     MOVE PV-HOLD-CORRELID TO MQMD-CORRELID.                      26730000
267400                                                                  26740000
267500*PUT MSG BACK WITH CURRENT-TMST AND ERROR TYPE.                   26750000
267600     MOVE XL005-ITEM-ERROR-REC TO PV-ERRMSGBUF.                   26760000
267700                                                                  26770000
267800*THE ENTIRE MSG LENGTH IS +500.                                   26780000
267900     MOVE +500 TO PV-MSG-LENGTH.                                  26790000
268000                                                                  26800000
268100*SET OPTIONS.                                                     26810000
268200     MOVE MQFMT-STRING     TO MQMD-FORMAT.                        26820000
268300     MOVE MQPER-PERSISTENT TO MQMD-PERSISTENCE.                   26830000
268400     COMPUTE MQPMO-OPTIONS  =  MQPMO-SYNCPOINT +                  26840000
268500                               MQPMO-SET-IDENTITY-CONTEXT.        26850000
268600                                                                  26860000
268700*PUT MSG.                                                         26870000
268800     CALL PC-MQPUT USING PV-HCONN                                 26880000
268900                         PV-PQ-HANDLE                             26890000
269000                         MQM-MESSAGE-DESCRIPTOR                   26900000
269100                         MQM-PUT-MESSAGE-OPTIONS                  26910000
269200                         PV-MSG-LENGTH                            26920000
269300                         PV-ERRMSGBUF                             26930000
269400                         PV-COMPLETION-CODE                       26940000
269500                         PV-REASON.                               26950000
269600                                                                  26960000
269700*IF PUT FAILED THEN DISPLAY ERROR MESSAGE                         26970000
269800*AND BREAK OUT OF LOOP                                            26980000
269900     IF (PV-COMPLETION-CODE NOT = MQCC-OK)                        26990000
270000         CALL PV-MQCHECK USING PV-REASON                          27000000
270100                               PV-MQ-REASON-TEXT                  27010000
270200         DISPLAY 'MQ MESSAGE = ', PV-ERRMSGBUF                    27020000
270300         MOVE '3800-PUT-MSG-TO-ERROR-Q' TO PV-PARAGRAPH           27030000
270400         MOVE 'MQPUT FAILED'          TO PV-ERROR-MESSAGE         27040000
270500         MOVE PV-COMPLETION-CODE      TO PV-HOLD-COMPLETION-CODE  27050000
270600         MOVE PV-REASON               TO PV-HOLD-REASON           27060000
270700         PERFORM 3700-BACK-OUT-MQ                                 27070000
270800         MOVE PV-HOLD-COMPLETION-CODE TO PV-COMPLETION-CODE       27080000
270900                                         PE-MQ-COMPLETION-CODE    27090000
271000         MOVE PV-HOLD-REASON          TO PV-REASON                27100000
271100                                         PE-MQ-REASON-CODE        27110000
271200         PERFORM 9200-MQ-ABEND                                    27120000
271300     END-IF.                                                      27130000
271400                                                                  27140000
271500******************************************************************27150000
271600* FORMAT DB2 KEYS                                                 27160000
271700******************************************************************27170000
271800 4000-FORMAT-KEYS.                                                27180000
271900     MOVE IM008-ITEM-KEY-RMS-STYL-ID                              27190000
272000                              TO DK-ITEM-KEY-RMS-STYL-ID.         27200000
272100                                                                  27210000
272200     MOVE IM008-ITEM-KEY-SKU  TO DK-SKU.                          27220000
272300     MOVE IM008-ITEM-KEY-INTR-UPC-ID                              27230000
272400                              TO PV-EDIT-INTR-UPC-ID.             27240000
272500     MOVE PV-INTR-UPC-ID-COMP                                     27250000
272600                              TO DK-ITEM-KEY-INTR-UPC-ID.         27260000
272700******************************************************************27270000
272800 4001-FILLIN-UPC-FIELDS.                                          27280000
272900     MOVE IM008-ITEM-KEY-INTR-UPC-ID                              27290000
273000                              TO PV-EDIT-INTR-UPC-ID.             27300000
273100     MOVE PV-INTR-UPC-ID-COMP                                     27310000
273200                              TO DK-ITEM-KEY-INTR-UPC-ID.         27320000
273300     MOVE IM008-ITEM-KEY-UPC-NBR                                  27330000
273400                              TO DK-ITEM-KEY-UPC-NBR.             27340000
273500     MOVE IM008-ITEM-KEY-UPC-ID                                   27350000
273600                              TO PV-EDIT-UPC-ID.                  27360000
273700     MOVE PV-UPC-ID-COMP                                          27370000
273800                              TO DK-ITEM-KEY-UPC-ID.              27380000
273900******************************************************************27390000
274000* THERE IS A MSG IN THE QUEUE LARGER THAN THE CURRENT PV-MSGBUFFER27400000
274100******************************************************************27410000
274200 4750-MSG-TOO-BIG-ERROR.                                          27420000
274300                                                                  27430000
274400     SET PS-ERROR-YES                                             27440000
274500         PS-END-OF-MSG-YES TO TRUE.                               27450000
274600*        WF030-MSG-TOO-BIG-ERROR TO TRUE.                         27460000
274700                                                                  27470000
274800******************************************************************27480000
274900****************************************************************  27490000
275000* !!! I M P O R T A N T !!!                                       27500000
275100*                                                                 27510000
275200* THE 'STOP RUN' NEEDS TO BE HERE INSTEAD OF IN THE MAIN LINE OF  27520000
275300* THE PROGRAM BECAUSE THIS IS CODED AS A STARTED TASK, AND THIS   27530000
275400* PROGRAM WILL RUN CONTINUOUSLY UNTIL IT RECEIVES THE 'END RUN    27540000
275500* OF PROGRAM' MESSAGE. IF THE STOP RUN IS MOVED TO THE MAIN LINE  27550000
275600* THE RESULT WILL BE AN MQ HCONN_ERROR !!!!!                      27560000
275700*                                                                 27570000
275800* END RUN OF PROGRAM ROUTINE:                                     27580000
275900* CLOSE QUEUE(S)                                                  27590000
276000* DISCONNECT FROM QMGR                                            27600000
276100* DISPLAY SUMMARY STATISTICS                                      27610000
276200****************************************************************  27620000
276300 5000-END-RUN-ROUTINE.                                            27630000
276400                                                                  27640000
276500*CLOSE THE TRANS QUEUE.                                           27650000
276600     PERFORM 3400-MQ-QUEUE-CLOSE.                                 27660000
276700                                                                  27670000
276800*CLOSE THE ERROR QUEUE IF OPEN.                                   27680000
276900     IF PS-ERROR-QUEUE-IS-OPEN-YES                                27690000
277000        PERFORM 3405-MQ-ERROR-QUEUE-CLOSE                         27700000
277100     END-IF.                                                      27710000
277200                                                                  27720000
277300*DISCONNECT FROM THE QMGR.                                        27730000
277400     PERFORM 3500-DISCONNECT-QMGR.                                27740000
277500                                                                  27750000
277600*END OF JOB ROUTINE.                                              27760000
277700     PERFORM 8000-EOJ-ROUTINE.                                    27770000
277800                                                                  27780000
277900*END PROGRAM.                                                     27790000
278000     DISPLAY '************  END OF XLKUP003  ***************'     27800000
278100     STOP RUN.                                                    27810000
278200                                                                  27820000
278300******************************************************************27830000
278400* COMMITTED RECORDS WILL REMAIN IN DB2 TABLES AFTER AN ABEND.     27840000
278500******************************************************************27850000
278600 6000-DB2-COMMIT.                                                 27860000
278700                                                                  27870000
278800     EXEC SQL                                                     27880000
278900         COMMIT                                                   27890000
279000     END-EXEC.                                                    27900000
279100                                                                  27910000
279200     EVALUATE TRUE                                                27920000
279300         WHEN SQLCODE = +0                                        27930000
279400              ADD +1  TO PA-TOTAL-DB2-COMMITS                     27940000
279500         WHEN SQLWARN0 NOT = SPACES                               27950000
279600         WHEN SQLCODE  NOT = ZERO                                 27960000
279700         DISPLAY '****************************'                   27970000
279800         DISPLAY '** ABEND                  **'                   27980000
279900         DISPLAY '** PROGRAM = XLKUP003     **'                   27990000
280000         DISPLAY '** PARAGRAPH = 6000-COMMIT**'                   28000000
280100         DISPLAY '** UNSUCCESSFUL COMMIT    **'                   28010000
280200         DISPLAY '****************************'                   28020000
280300         PERFORM 9100-SQL-ABEND                                   28030000
280400     END-EVALUATE.                                                28040000
280500                                                                  28050000
280600****************************************************************  28060000
280700* OPEN THE ERROR QUEUE IF IT HAS NOT BEEN ALREADY. SET UP THE     28070000
280800* CURRENT TMST AND ERROR REASON CODE TO BE PUT INTO THE           28080000
280900* MQMD-APPLIDENTITYDATA.                                          28090000
281000****************************************************************  28100000
281100 7100-ERROR-ROUTINE.                                              28110000
281200                                                                  28120000
281300*OPEN ERROR QUEUE                                                 28130000
281400     IF PS-ERROR-QUEUE-IS-OPEN-NO                                 28140000
281500        PERFORM 3205-MQ-ERROR-QUEUE-OPEN                          28150000
281600     END-IF.                                                      28160000
281700                                                                  28170000
281800*SET CURRENT TMST FOR PUT                                         28180000
281900*    PERFORM 1100-SET-CURRENT-TMST.                               28190000
282000*    MOVE PV-CURRENT-TMST TO WF030-ORIG-PUT-TMST.                 28200000
282100                                                                  28210000
282200****************************************************************  28220000
282300 7900-BACKUP-ITEM-QUEUE-MSG.                                      28230000
282400     INITIALIZE MSG-DATA-COLLECT-LINE.                            28240000
282500     MOVE PV-MSGBUFFER  TO MSG-DATA-COLLECT-LINE.                 28250000
282600     WRITE MSG-DATA-COLLECT-LINE.                                 28260000
282700     ADD +1 TO PA-TOTAL-BACKUP-RECS.                              28270000
282800****************************************************************  28280000
282900*                                                                 28290000
283000*                                                                 28300000
283100** E N D    O F    M Q    S E R I E S     P A R A G R A P H S **  28310000
283200*                                                                 28320000
283300*                                                                 28330000
283400****************************************************************  28340000
283500                                                                  28350000
283600******************************************************************28360000
283700* UPDATE CHECKPOINT STATUS CODE WITH 0 FOR COMPLETION.            28370000
283800* DISPLAY STATISTICS FOR THE PROGRAM                              28380000
283900******************************************************************28390000
284000 8000-EOJ-ROUTINE.                                                28400000
284100                                                                  28410000
284200         CLOSE MSG-DATA-COLLECT-FILE.                             28420000
284300                                                                  28430000
284400         DISPLAY ' ********************************************'  28440000
284500         DISPLAY '     * XLKUP003 SUMMARY STATISTICS *         '  28450000
284600         DISPLAY ' '                                              28460000
284700         DISPLAY '       ---------------------------           '  28470000
284800         DISPLAY '          ITEM DOMAIN UPDATES                '  28480000
284900         DISPLAY '       ---------------------------           '  28490000
285000         DISPLAY ' '                                              28500000
285100         DISPLAY ' TOTAL VENDOR STYLE INSERTS        :'           28510000
285200                                        PA-TOTAL-VNDSTYL-INSERTS  28520000
285300         DISPLAY ' TOTAL VENDOR STYLE UPDATES        :'           28530000
285400                                        PA-TOTAL-VNDSTYL-UPDATES  28540000
285500         DISPLAY ' TOTAL VENDOR STYLE DELETES        :'           28550000
285600                                        PA-TOTAL-VNDSTYL-DELETES  28560000
285601*CLP 07/10/2015 START                                             28560102
285610         DISPLAY ' TOTAL BRAND INSERTS               :'           28561002
285620                                        PA-TOTAL-BRAND-INSERTS    28562002
285630         DISPLAY ' TOTAL BRAND UPDATES               :'           28563002
285640                                        PA-TOTAL-BRAND-UPDATES    28564002
285650*CLP 07/10/2015 END                                               28565002
285700         DISPLAY ' TOTAL SKU INSERTS                 :'           28570000
285800                                        PA-TOTAL-SKU-INSERTS      28580000
285900         DISPLAY ' TOTAL SKU UPDATES                 :'           28590000
286000                                        PA-TOTAL-SKU-UPDATES      28600000
286100         DISPLAY ' TOTAL SKU DELETES                 :'           28610000
286200                                        PA-TOTAL-SKU-DELETES      28620000
286300         DISPLAY ' TOTAL PACK BUS EVENT              :'           28630000
286400                                        PA-TOTAL-XLTPAK-MAINT     28640000
286500         DISPLAY ' TOTAL PACKSKU BUS EVENT           :'           28650000
286600                                        PA-TOTAL-XLTSKU-MAINT     28660000
286700         DISPLAY ' TOTAL UPC EAN BUS EVENT           :'           28670000
286800                                        PA-TOTAL-XLTUPC-MAINT     28680000
286900         DISPLAY ' TOTAL POPREPACK UPDATE            :'           28690000
287000                                        PA-TOTAL-TPOPRPK-UPD      28700000
287100         DISPLAY ' END OF RUN MESSAGES               :'           28710000
287200                                        PA-END-OF-RUN-MESSAGES    28720000
287300         DISPLAY ' 999 STOP PROCESSING MESSAGES      :'           28730000
287400                                        PA-999-STOP-PROC-MESSAGES 28740000
287500         DISPLAY ' TOTAL MESSAGES READ               :'           28750000
287600                                        PA-TOTAL-GETS             28760000
287700         DISPLAY ' TOTAL MESSAGES BACKED UP          :'           28770000
287800                                        PA-TOTAL-BACKUP-RECS      28780000
287900         DISPLAY ' TOTAL MESSAGES IN ERROR           :'           28790000
288000                                        PA-TOTAL-ERRORQ-RECS      28800000
288100         DISPLAY ' TOTAL DB2 COMMITS                 :'           28810000
288200                                        PA-TOTAL-DB2-COMMITS      28820000
288300         DISPLAY ' TOTAL MQ  COMMITS                 :'           28830000
288400                                        PA-TOTAL-MQ-COMMITS       28840000
288500         DISPLAY '********************************************'.  28850000
288600                                                                  28860000
288700******************************************************************28870000
288800* 9100-SQL-ABEND - PERFORMS THE ABEND FOR THE PROGRAM IN THE      28880000
288900* EVENT THAT AN SQL ERROR OR WARNING CODE OCCURS.                 28890000
289000******************************************************************28900000
289100 9100-SQL-ABEND.                                                  28910000
289200                                                                  28920000
289300* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    28930000
289400* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         28940000
289500* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     28950000
289600* FORMAT                                                          28960000
289700     COPY DPPD004.                                                28970000
289800                                                                  28980000
289900     DISPLAY '***********************************'.               28990000
290000     DISPLAY '     ITEM DOMAIN DOWNLOAD ABEND   *'.               29000000
290100     DISPLAY '***********************************'.               29010000
290200     DISPLAY '* CURRENT STATS AT TIME OF ABEND  *'.               29020000
290300     DISPLAY '***********************************'.               29030000
290400     DISPLAY 'VNDSTYL ROWS CREATED :' PA-TOTAL-VNDSTYL-INSERTS    29040000
290500     DISPLAY 'XLT SKU ROWS CREATED :' PA-TOTAL-SKU-INSERTS        29050000
290600     DISPLAY 'NBR OF GETS         :' PA-TOTAL-GETS.               29060000
290700     DISPLAY '***********************************'.               29070000
290800     DISPLAY '*         COMMIT STATS            *'.               29080000
290900     DISPLAY '***********************************'.               29090000
291000     DISPLAY 'DB2 COMMITS         :' PA-TOTAL-DB2-COMMITS.        29100000
291100     DISPLAY '***********************************'.               29110000
291200     DISPLAY ' '.                                                 29120000
291300     MOVE +4013 TO ABEND-CODE.                                    29130000
291400     CALL 'ILBOABN0' USING ABEND-CODE.                            29140000
291500                                                                  29150000
291600****************************************************************  29160000
291700** PERFORM MQ-SERIES ABEND PROCESSING                             29170000
291800****************************************************************  29180000
291900 9200-MQ-ABEND.                                                   29190000
292000                                                                  29200000
292100     DISPLAY '**** ABEND *************************************'.  29210000
292200     DISPLAY '** MQSERIES ERROR **'.                              29220000
292300     DISPLAY '** PROGRAM:    ', PC-CURRENT-PROGRAM-NAME.          29230000
292400     DISPLAY '** ABEND CODE: ', PV-ABEND-CODE.                    29240000
292500     DISPLAY '** PARAGRAPH:  ', PV-PARAGRAPH.                     29250000
292600     DISPLAY '** MESSAGE:    ', PV-ERROR-MESSAGE.                 29260000
292700     DISPLAY '** COMP CODE:  ', PE-MQ-COMPLETION-CODE.            29270000
292800     DISPLAY '** RSN CODE:   ', PE-MQ-REASON-CODE.                29280000
292900     DISPLAY '** RSN TEXT:   ', PV-MQ-REASON-TEXT.                29290000
293000     DISPLAY '************************************************'.  29300000
293100     MOVE +4013 TO ABEND-CODE.                                    29310000
293200     CALL 'ILBOABN0' USING PV-ABEND-CODE.                         29320000
293300                                                                  29330000
293400******************************************************************29340000
293500**                      END OF PROGRAM                            29350000
293600*                                                                 29360000
293700******************************************************************29370000
