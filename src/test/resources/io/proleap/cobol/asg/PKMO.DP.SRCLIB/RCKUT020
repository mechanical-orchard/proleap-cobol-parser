000100******************************************************************00010001
000200 IDENTIFICATION DIVISION.                                         00020002
000300******************************************************************00030002
000400                                                                  00040002
000500 PROGRAM-ID.             RCKUT020.                                00050002
000600 AUTHOR.                 DAN HINTZ.                               00060002
000700 INSTALLATION.           KOHLS.                                   00070002
000800 DATE-WRITTEN            NOVEMBER 1994.                           00080002
000900 DATE-COMPILED.                                                   00090002
001000                                                                  00100002
001100******************************************************************00110002
001200*   THE PURPOSE OF THIS PROGRAM IS TO CHECK UNJOURNALIZED RECEIPT 00120002
001300*   INFORMATION FOR POSSIBLE DUPLICATES.                          00130002
001000                                                                  00130113
001200* CHANGE LOG:                                                     00131013
001200*   09/10/2021  RECOMPILE FOR NEW VERSION OF APRD042 FOR SEPHORA  00131113
001300*               JEAN KURK                         CHG0260549      00132013
001400******************************************************************00140002
001500 ENVIRONMENT DIVISION.                                            00150002
001600                                                                  00160002
001700 CONFIGURATION SECTION.                                           00170002
001800                                                                  00180002
001900 SOURCE-COMPUTER.        IBM-3090.                                00190002
002000 OBJECT-COMPUTER.        IBM-3090.                                00200002
002100                                                                  00210002
002200 INPUT-OUTPUT SECTION.                                            00220002
002300                                                                  00230002
002400 FILE-CONTROL.                                                    00240002
002500                                                                  00250002
002600     SELECT RCVR-FILE-IN-1                                        00260002
002700         ASSIGN TO INP01.                                         00270002
002800                                                                  00280002
002900     SELECT RCVR-FILE-IN-2                                        00290002
003000         ASSIGN TO INP02.                                         00300002
003100                                                                  00310002
003200     SELECT RCVR-FILE-OUT                                         00320002
003300         ASSIGN TO OUT01.                                         00330002
003400                                                                  00340002
003500******************************************************************00350002
003600 DATA DIVISION.                                                   00360002
003700******************************************************************00370002
003800                                                                  00380002
003900 FILE SECTION.                                                    00390002
004000                                                                  00400002
004100 FD  RCVR-FILE-IN-1                                               00410002
004200     RECORDING MODE IS F                                          00420002
004300     RECORD CONTAINS 120 CHARACTERS                               00430002
004400     BLOCK CONTAINS 0 RECORDS                                     00440002
004500     LABEL RECORDS ARE STANDARD.                                  00450002
004600                                                                  00460002
004700 01  RCVR-FILE-IN-REC-1                  PIC X(120).              00470002
004800                                                                  00480002
004900                                                                  00490002
005000 FD  RCVR-FILE-IN-2                                               00500002
005100     RECORDING MODE IS F                                          00510002
005200     RECORD CONTAINS 120 CHARACTERS                               00520002
005300     BLOCK CONTAINS 0 RECORDS                                     00530002
005400     LABEL RECORDS ARE STANDARD.                                  00540002
005500                                                                  00550002
005600 01  RCVR-FILE-IN-REC-2                  PIC X(120).              00560002
005700                                                                  00570002
005800                                                                  00580002
005900 FD  RCVR-FILE-OUT                                                00590002
006000     RECORDING MODE IS F                                          00600002
006100     RECORD CONTAINS 71 CHARACTERS                                00610003
006200     BLOCK CONTAINS 0 RECORDS                                     00620002
006300     LABEL RECORDS ARE STANDARD.                                  00630002
006400                                                                  00640002
006500 01  RCVR-FILE-OUT-REC                   PIC X(71).               00650003
006600                                                                  00660002
006700******************************************************************00670002
006800 WORKING-STORAGE SECTION.                                         00680002
006900******************************************************************00690002
007000                                                                  00700002
007100 01  ABEND-CODE                          PIC S9(04)  VALUE +0     00710002
007200                                                     COMP SYNC.   00720002
007300*                                                                 00730002
007400     COPY APRD042.                                                00740002
007500*                                                                 00750002
007600 01  AP042-2-EXTRACT-FILE.                                        00760002
007700     05  AP042-2-VND-NBR                 PIC X(09).               00770002
007800     05  AP042-2-ENT-NM-DESC             PIC X(30).               00780002
007900     05  AP042-2-DMM-NBR                 PIC 9(03).               00790002
008000     05  AP042-2-DEPT-NBR                PIC 9(03).               00800002
008100     05  AP042-2-CL-NBR                  PIC 9(03).               00810002
008200     05  AP042-2-PO-NBR                  PIC 9(09).               00820010
008300     05  AP042-2-STR-NBR                 PIC X(04).               00830012
008400     05  AP042-2-PO-LNE-NBR              PIC 9(03).               00840002
008500     05  FILLER                          PIC X(05).               00850010
008600     05  AP042-2-PO-VRFD-QTY             PIC S9(06) COMP-3.       00860002
008700     05  AP042-2-CALCD-VRFD-RTL-AMT      PIC S9(09)V99 COMP-3.    00870002
008800     05  AP042-2-CALCD-VRFD-COST-AMT     PIC S9(09)V99 COMP-3.    00880002
008900     05  AP042-2-REC-DTE                 PIC X(10).               00890002
009000     05  AP042-2-VRFD-DTE                PIC X(10).               00900002
009100     05  AP042-2-RCV-TYP-CDE             PIC X(01) VALUE ' '.     00910002
009200         88  AP042-2-NON-INVC                      VALUE 'N'.     00920002
009300         88  AP042-2-ORIG-RCVR                     VALUE 'R'.     00930002
009400     05  AP042-2-REC-SEQ-NBR             PIC 9(09).               00940008
009500     05  AP042-2-PO-TYP-CDE              PIC X(02).               00950008
009600     05  AP042-2-COLBY-IND               PIC X(01).               00960008
009700     05  FILLER                          PIC X(02).               00970012
009800*                                                                 00980008
009900*                                                                 00990008
010000 01  PC-PROGRAM-CONSTANTS.                                        01000008
010100     05  PC-MAX-RETRIES                  PIC S9(04)  VALUE +3     01010008
010200                                                     COMP SYNC.   01020008
010300     05  PC-CURRENT-PROGRAM-NAME         PIC  X(08)  VALUE        01030008
010400                                                     'RCKUT020'.  01040008
010500*                                                                 01050008
010600 01  PV-PROGRAM-VARIABLES.                                        01060008
010700     05  PV-PO-NBR-1.                                             01070008
010800         10  PV-PO-NBR-N-1               PIC  9(09)  VALUE ZEROS. 01080011
010900     05  PV-PO-NBR-2.                                             01090008
011000         10  PV-PO-NBR-N-2               PIC  9(09)  VALUE ZEROS. 01100011
011100     05  PV-TRECDIS-ITM-CNT              PIC S9(09)  VALUE ZERO   01110008
011200                                                     COMP SYNC.   01120008
011300     05  PV-ORD-NBR                      PIC S9(09)  VALUE ZERO   01130008
011400                                                     COMP.        01140008
011500     05  PV-REC-SEQ-NBR                  PIC S9(09)  VALUE ZERO   01150008
011600                                                     COMP.        01160008
011700     05  PV-RCVR-RECS-WRITTEN            PIC  9(07)  VALUE ZERO   01170008
011800                                                     COMP-3.      01180008
011900     05  PV-PARAGRAPH-NAME               PIC  X(30)  VALUE SPACES.01190008
012000     05  PV-DB2-OPERATION-MESSAGE-1      PIC  X(79)  VALUE SPACES.01200008
012100     05  PV-DB2-OPERATION-MESSAGE-2      PIC  X(79)  VALUE SPACES.01210008
012200     05  PV-DB2-OPERATION-MESSAGE-3      PIC  X(79)  VALUE SPACES.01220008
012300     05  PV-DB2-OPERATION-MESSAGE-4      PIC  X(79)  VALUE SPACES.01230008
012400     05  PV-DB2-TABLE-NAME-1             PIC  X(18)  VALUE SPACES.01240008
012500     05  PV-DB2-TABLE-NAME-2             PIC  X(18)  VALUE SPACES.01250008
012600     05  PV-DB2-TABLE-NAME-3             PIC  X(18)  VALUE SPACES.01260008
012700     05  PV-ERROR-MESSAGE-1              PIC  X(60)  VALUE SPACES.01270008
012800     05  PV-ERROR-MESSAGE-2              PIC  X(60)  VALUE SPACES.01280008
012900     05  PV-ERROR-MESSAGE-3              PIC  X(60)  VALUE SPACES.01290008
013000                                                                  01300008
013100     05  PV-DATE-ISO.                                             01310008
013200         10  PV-DATE-ISO-CENTURY         PIC  9(02).              01320008
013300         10  PV-DATE-ISO-YEAR            PIC  9(02).              01330008
013400         10  PV-DATE-ISO-MONTH           PIC  9(02).              01340008
013500         10  PV-DATE-ISO-DAY             PIC  9(02).              01350008
013600                                                                  01360008
013700     05  PV-DATE-OUT.                                             01370008
013800         10  PV-DATE-OUT-YEAR            PIC  9(02).              01380008
013900         10  PV-DATE-OUT-MONTH           PIC  9(02).              01390008
014000         10  PV-DATE-OUT-DAY             PIC  9(02).              01400008
014100                                                                  01410008
014200 01  PS-PROGRAM-SWITCHES.                                         01420008
014300     05  PS-END-OF-RCVRS-EXTRACT-1-SW    PIC X(01)   VALUE 'N'.   01430008
014400         88  PS-END-OF-RCVRS-EXTRACT-1               VALUE 'Y'.   01440008
014500     05  PS-END-OF-RCVRS-EXTRACT-2-SW    PIC X(01)   VALUE 'N'.   01450008
014600         88  PS-END-OF-RCVRS-EXTRACT-2               VALUE 'Y'.   01460008
014700     05  PS-ALL-DUPS-PROCESSED-SW        PIC X(01)   VALUE 'N'.   01470008
014800         88  PS-ALL-DUPS-PROCESSED                   VALUE 'Y'.   01480008
014900         88  PS-NOT-ALL-DUPS-PROCESSED               VALUE 'N'.   01490008
015000     05  PS-RECEIVER-FIRST-TIME-SW       PIC X(01)   VALUE 'N'.   01500008
015100         88  PS-RECEIVER-FIRST-TIME                  VALUE 'Y'.   01510008
015200         88  PS-RECEIVER-NOT-FIRST-TIME              VALUE 'N'.   01520008
015300*                                                                 01530008
015400*                                                                 01540008
015500******************************************************************01550008
015600***  WORK FIELDS FOR THE DUPLICATE UNJOURNALIZED RECEIVER         01560008
015700***  EXTRACT FILE.                                                01570008
015800******************************************************************01580008
015900     COPY RCRD005.                                                01590008
016000*                                                                 01600008
016100*                                                                 01610008
016200******************************************************************01620008
016300*  DB2 FORMATTED MESSAGE AREA                                     01630008
016400******************************************************************01640008
016500     COPY DPWS004.                                                01650008
016600*                                                                 01660008
016700*                                                                 01670008
016800******************************************************************01680008
016900*  COBOL DECLARATION AND DCLGEN MEMBER FOR THE RECEIVER TABLE     01690008
017000******************************************************************01700008
017100     EXEC SQL                                                     01710008
017200          INCLUDE TRECEIV                                         01720008
017300     END-EXEC.                                                    01730008
017400*                                                                 01740008
017500*                                                                 01750008
017600******************************************************************01760008
017700*  COMMUNICATIONS AREA FOR DB2                                    01770008
017800******************************************************************01780008
017900     EXEC SQL                                                     01790008
018000          INCLUDE SQLCA                                           01800008
018100     END-EXEC.                                                    01810008
018200*                                                                 01820008
018300*                                                                 01830008
018400 PROCEDURE DIVISION.                                              01840008
018500                                                                  01850008
018600******************************************************************01860008
018700*  0000-INITIAL-ROUTINE  -  MAIN LINE OF THE PROGRAM PERFORMS THE 01870008
018800*  INITIALIZATION ROUTINE AND CONTROLS THE PROCESSING OF THE PGM. 01880008
018900******************************************************************01890008
019000                                                                  01900008
019100 0000-MAINLINE.                                                   01910008
019200                                                                  01920008
019300     OPEN INPUT RCVR-FILE-IN-1                                    01930008
019400                RCVR-FILE-IN-2                                    01940008
019500         OUTPUT RCVR-FILE-OUT.                                    01950008
019600                                                                  01960008
019700     PERFORM 7000-READ-RCPT-EXTRACT-FILE-1.                       01970008
019800                                                                  01980008
019900     PERFORM 7100-READ-RCPT-EXTRACT-FILE-2.                       01990008
020000                                                                  02000008
020100     PERFORM 2000-PROCESS-RCVR-RECS                               02010008
020200         UNTIL (PS-END-OF-RCVRS-EXTRACT-1 AND                     02020008
020300                PS-END-OF-RCVRS-EXTRACT-2).                       02030008
020400                                                                  02040008
020500     CLOSE RCVR-FILE-IN-1                                         02050008
020600           RCVR-FILE-IN-2                                         02060008
020700           RCVR-FILE-OUT.                                         02070008
020800                                                                  02080008
020900     DISPLAY '** RECEIVER RECORDS WRITTEN: ' PV-RCVR-RECS-WRITTEN.02090008
021000                                                                  02100008
021100     STOP RUN.                                                    02110008
021200                                                                  02120008
021300                                                                  02130008
021400 2000-PROCESS-RCVR-RECS.                                          02140008
021500******************************************************************02150008
021600*  COMPARE THE TWO UNJOURNALIZED RECEIPT EXTRACT FILES, LOOKING   02160008
021700*  FOR RECEIVERS THAT MAY BE POSSIBLE DUPLICATES.                 02170008
021800******************************************************************02180008
021900     EVALUATE TRUE                                                02190008
022000         WHEN PV-PO-NBR-1  <  PV-PO-NBR-2                         02200008
022100             PERFORM 7000-READ-RCPT-EXTRACT-FILE-1                02210008
022200                                                                  02220008
022300         WHEN PV-PO-NBR-1  >  PV-PO-NBR-2                         02230008
022400             PERFORM 7100-READ-RCPT-EXTRACT-FILE-2                02240008
022500                                                                  02250008
022600         WHEN PV-PO-NBR-1  =  PV-PO-NBR-2                         02260008
022700             SET PS-NOT-ALL-DUPS-PROCESSED TO TRUE                02270008
022800             PERFORM 2100-CHECK-FOR-DUPLICATES                    02280008
022900                 UNTIL PS-ALL-DUPS-PROCESSED                      02290008
023000     END-EVALUATE.                                                02300008
023100*                                                                 02310008
023200*                                                                 02320008
023300 2100-CHECK-FOR-DUPLICATES.                                       02330008
023400******************************************************************02340008
023500*  CHECK FOR POSSIBLE DUPLICATE RECEIVERS FOR THIS SPECIFIC PO.   02350008
023600*  DUPLICATE RECEIVERS ARE THOSE THAT ARE FOR THE SAME VENDOR AND 02360008
023700*  HAVE THE SAME TOTAL RETAIL AMOUNT, TOTAL COST, AND TOTAL UNITS 02370008
023800*  VERIFIED.                                                      02380008
023900******************************************************************02390008
024000     IF  PV-PO-NBR-1  =  PV-PO-NBR-2                              02400008
024100         IF  AP042-REC-SEQ-NBR = AP042-2-REC-SEQ-NBR              02410008
024200             SET PS-RECEIVER-FIRST-TIME  TO TRUE                  02420008
024300             PERFORM 7100-READ-RCPT-EXTRACT-FILE-2                02430008
024400         ELSE                                                     02440008
024500             IF (AP042-CALCD-VRFD-RTL-AMT  =                      02450008
024600                 AP042-2-CALCD-VRFD-RTL-AMT)    AND               02460008
024700                (AP042-CALCD-VRFD-COST-AMT =                      02470008
024800                 AP042-2-CALCD-VRFD-COST-AMT)   AND               02480008
024900                (AP042-VND-NBR             =                      02490008
025000                 AP042-2-VND-NBR)               AND               02500008
025100                (AP042-PO-VRFD-QTY         =                      02510008
025200                 AP042-2-PO-VRFD-QTY)                             02520008
025300                 PERFORM 2200-PREPARE-DUPLICATE-EXTRACT           02530008
025400                 PERFORM 7100-READ-RCPT-EXTRACT-FILE-2            02540008
025500             ELSE                                                 02550008
025600                 PERFORM 7100-READ-RCPT-EXTRACT-FILE-2            02560008
025700             END-IF                                               02570008
025800         END-IF                                                   02580008
025900     ELSE                                                         02590008
026000         SET PS-ALL-DUPS-PROCESSED       TO TRUE                  02600008
026100     END-IF.                                                      02610008
026200*                                                                 02620008
026300*                                                                 02630008
026400 2200-PREPARE-DUPLICATE-EXTRACT.                                  02640008
026500******************************************************************02650008
026600*  MOVE THE SPECIFIED INPUT FIELDS TO THE OUTPUT EXTRACT RECORD.  02660008
026700*  RETRIEVE THE RECEIVER LOCATION FROM THE TRECEIV TABLE.         02670008
026800******************************************************************02680008
026900     IF  PS-RECEIVER-FIRST-TIME                                   02690008
027000         SET PS-RECEIVER-NOT-FIRST-TIME  TO TRUE                  02700008
027100         MOVE AP042-PO-NBR               TO PV-ORD-NBR            02710008
027200         MOVE AP042-REC-SEQ-NBR (6:4)    TO PV-REC-SEQ-NBR        02720009
027300         PERFORM 2300-FETCH-OP-UNT-FCLTY-ID                       02730008
027400         MOVE RECEIV-OPER-UNT-ID         TO RC005-OPER-UNT-ID     02740008
027500         MOVE RECEIV-FCLTY-ID            TO RC005-FCLTY-ID        02750008
027600         MOVE AP042-PO-NBR               TO RC005-PO-NBR          02760008
027700         MOVE AP042-REC-SEQ-NBR (6:4)    TO RC005-REC-SEQ-NBR     02770009
027800         MOVE AP042-REC-DTE              TO RC005-RECEIPT-DATE    02780008
027900         MOVE AP042-ENT-NM-DESC          TO RC005-VENDOR-NAME     02790008
028000         MOVE AP042-CALCD-VRFD-RTL-AMT   TO RC005-EXT-RETAIL-AMT  02800008
028100         MOVE AP042-CALCD-VRFD-COST-AMT  TO RC005-EXT-COST-AMT    02810008
028200         MOVE AP042-PO-VRFD-QTY          TO RC005-VERIFIED-QTY    02820008
028300         PERFORM 8000-WRITE-DUP-EXTRACT-FILE                      02830008
028400     END-IF.                                                      02840008
028500                                                                  02850008
028600     MOVE AP042-2-PO-NBR                 TO PV-ORD-NBR.           02860008
028700     MOVE AP042-2-REC-SEQ-NBR (6:4)      TO PV-REC-SEQ-NBR.       02870009
028800     PERFORM 2300-FETCH-OP-UNT-FCLTY-ID.                          02880008
028900                                                                  02890008
029000     MOVE RECEIV-OPER-UNT-ID             TO RC005-OPER-UNT-ID.    02900008
029100     MOVE RECEIV-FCLTY-ID                TO RC005-FCLTY-ID.       02910008
029200     MOVE AP042-2-PO-NBR                 TO RC005-PO-NBR.         02920008
029300     MOVE AP042-2-REC-SEQ-NBR (6:4)      TO RC005-REC-SEQ-NBR.    02930009
029400     MOVE AP042-2-REC-DTE                TO RC005-RECEIPT-DATE.   02940008
029500     MOVE AP042-2-ENT-NM-DESC            TO RC005-VENDOR-NAME.    02950008
029600     MOVE AP042-2-CALCD-VRFD-RTL-AMT     TO RC005-EXT-RETAIL-AMT. 02960008
029700     MOVE AP042-2-CALCD-VRFD-COST-AMT    TO RC005-EXT-COST-AMT.   02970008
029800     MOVE AP042-2-PO-VRFD-QTY            TO RC005-VERIFIED-QTY.   02980008
029900     PERFORM 8000-WRITE-DUP-EXTRACT-FILE.                         02990008
030000*                                                                 03000008
030100*                                                                 03010008
030200 2300-FETCH-OP-UNT-FCLTY-ID.                                      03020008
030300******************************************************************03030008
030400*  FETCH THE OPERATING UNIT ID AND FACILITY ID FOR A SPECIFIED   *03040008
030500*  RECEIVER.                                                     *03050008
030600******************************************************************03060008
030700     INITIALIZE DCLTRECEIV.                                       03070008
030800                                                                  03080008
030900     EXEC SQL                                                     03090008
031000          SELECT                                                  03100008
031100                 OPER_UNT_ID                                      03110008
031200               , FCLTY_ID                                         03120008
031300            INTO                                                  03130008
031400                 :RECEIV-OPER-UNT-ID                              03140008
031500               , :RECEIV-FCLTY-ID                                 03150008
031600            FROM                                                  03160008
031700                 TRECEIV                                          03170008
031800           WHERE                                                  03180008
031900                 ORD_NBR            = :PV-ORD-NBR                 03190008
032000             AND REC_SEQ_NBR        = :PV-REC-SEQ-NBR             03200008
032100             AND VER_STATUS_CDE     = 'A'                         03210008
032200     END-EXEC.                                                    03220008
032300                                                                  03230008
032400     EVALUATE TRUE                                                03240008
032500         WHEN SQLCODE = ZERO                                      03250008
032600         WHEN SQLCODE = +100                                      03260008
032700             CONTINUE                                             03270008
032800         WHEN SQLWARN0 NOT = SPACES                               03280008
032900         WHEN SQLCODE < ZERO                                      03290008
033000         WHEN SQLCODE > ZERO                                      03300008
033100             MOVE '2300-FETCH-OP-UNT-FCLTY-ID'                    03310008
033200                                 TO PV-PARAGRAPH-NAME             03320008
033300             MOVE 'ATTEMPTING TO FETCH OPER UNT AND FCLTY ID      03330008
033400-                 'FOR THE FOLLOWING RCVR:'                       03340008
033500                                 TO PV-DB2-OPERATION-MESSAGE-1    03350008
033600             STRING AP042-PO-NBR             DELIMITED BY SIZE    03360008
033700                    '-'                      DELIMITED BY SIZE    03370008
033800                    AP042-REC-SEQ-NBR (6:4)  DELIMITED BY SIZE    03380009
033900                               INTO PV-DB2-OPERATION-MESSAGE-2    03390008
034000             MOVE 'TRECEIV'      TO PV-DB2-TABLE-NAME-1           03400008
034100             PERFORM 9100-DB2-ABEND                               03410008
034200     END-EVALUATE.                                                03420008
034300*                                                                 03430008
034400*                                                                 03440008
034500 7000-READ-RCPT-EXTRACT-FILE-1.                                   03450008
034600******************************************************************03460008
034700*  READ THE FIRST UNJOURNALIZED RECEIPT EXTRACT FILE             *03470008
034800******************************************************************03480008
034900     READ RCVR-FILE-IN-1                                          03490008
035000       INTO AP042-EXTRACT-FILE                                    03500008
035100         AT END                                                   03510008
035200           SET PS-END-OF-RCVRS-EXTRACT-1 TO TRUE.                 03520008
035300                                                                  03530008
035400     IF  PS-END-OF-RCVRS-EXTRACT-1                                03540008
035500         MOVE HIGH-VALUES              TO PV-PO-NBR-1             03550008
035600     ELSE                                                         03560008
035700         MOVE AP042-PO-NBR             TO PV-PO-NBR-1             03570008
035800     END-IF.                                                      03580008
035900*                                                                 03590008
036000*                                                                 03600008
036100 7100-READ-RCPT-EXTRACT-FILE-2.                                   03610008
036200******************************************************************03620008
036300*  READ THE SECOND UNJOURNALIZED RECEIPT EXTRACT FILE            *03630008
036400******************************************************************03640008
036500     READ RCVR-FILE-IN-2                                          03650008
036600       INTO AP042-2-EXTRACT-FILE                                  03660008
036700         AT END                                                   03670008
036800           SET PS-END-OF-RCVRS-EXTRACT-2 TO TRUE.                 03680008
036900                                                                  03690008
037000     IF  PS-END-OF-RCVRS-EXTRACT-2                                03700008
037100         MOVE HIGH-VALUES              TO PV-PO-NBR-2             03710008
037200     ELSE                                                         03720008
037300         MOVE AP042-2-PO-NBR           TO PV-PO-NBR-2             03730008
037400     END-IF.                                                      03740008
037500*                                                                 03750008
037600*                                                                 03760008
037700 8000-WRITE-DUP-EXTRACT-FILE.                                     03770008
037800******************************************************************03780008
037900*  WRITE TO THE DUPLICATE UNJOURNALIZED RECEIPT FILE.            *03790008
038000******************************************************************03800008
038100     WRITE RCVR-FILE-OUT-REC                                      03810008
038200         FROM RC005-DUP-RECEIPTS-EXTRACT.                         03820008
038300                                                                  03830008
038400     ADD 1 TO PV-RCVR-RECS-WRITTEN.                               03840008
038500*                                                                 03850008
038600*                                                                 03860008
038700 9100-DB2-ABEND.                                                  03870008
038800******************************************************************03880008
038900*  PERFORMS THE ABEND FOR THE PROGRAM IN THE EVENT THAT AN SQL    03890008
039000*  ERROR OR WARNING CODE OCCURS.                                  03900008
039100******************************************************************03910008
039200     DISPLAY '9100-DB2-ABEND'.                                    03920008
039300     DISPLAY '** ABEND           **'.                             03930008
039400     DISPLAY '** PROGRAM         ** = ' PC-CURRENT-PROGRAM-NAME.  03940008
039500     DISPLAY '** PARAGRAPH       ** = ' PV-PARAGRAPH-NAME.        03950008
039600     DISPLAY '** TABLES AFFECTED ** = ' PV-DB2-TABLE-NAME-1.      03960008
039700     DISPLAY '**                 ** = ' PV-DB2-TABLE-NAME-2.      03970008
039800     DISPLAY '**                 ** = ' PV-DB2-TABLE-NAME-3.      03980008
039900     DISPLAY '** OPERATION       ** = ' PV-DB2-OPERATION-MESSAGE-103990008
040000     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-204000008
040100     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-304010008
040200     DISPLAY '**                 ** = ' PV-DB2-OPERATION-MESSAGE-404020008
040300     DISPLAY '**                 ** = '                           04030008
040400                                                                  04040008
040500******************************************************************04050008
040600* THIS COPY BOOK MEMBER CONTAINS THE PROCEDURE DIVISION STATE-    04060008
040700* MENTS THAT ARE REQUIRED TO UTILIZE THE DB2 ABEND MODULE         04070008
040800* 'DSNTIAR' AND CONVERT THE SQLCA INFORMATION INTO A READABLE     04080008
040900* FORMAT.                                                         04090008
041000******************************************************************04100008
041100     COPY DPPD004.                                                04110008
041200                                                                  04120008
041300     MOVE +4013                  TO ABEND-CODE.                   04130008
041400     CALL 'ILBOABN0' USING ABEND-CODE.                            04140008
041500*                                                                 04150008
041600*                                                                 04160008
