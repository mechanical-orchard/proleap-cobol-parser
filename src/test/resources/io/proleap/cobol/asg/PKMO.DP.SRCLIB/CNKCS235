000100*-----------------------*                                         00010004
000200 IDENTIFICATION DIVISION.                                         00020004
000300*-----------------------*                                         00030004
000400 PROGRAM-ID.    CNKCS235.                                         00040004
000500 AUTHOR.        DENISE HAHN                                       00050004
000600 INSTALLATION.  KOHLS DEPARTMENT STORES.                          00060004
000700 DATE-WRITTEN.  AUGUST, 2012                                      00070004
000800 DATE-COMPILED.                                                   00080004
000900*---------------------------------------------------------------* 00090004
001000*    Y235 - DC-PARM CODE DEFINITION (TKRPRPM) - ADD -OR- UPDATE   00100004
001100*    THIS PROGRAM WILL PROCESS THE PARM ADD, UPDATE.              00110004
001200*    WHEN THE ASSOCIATE SELECTS F13-ADD, OR F15-UPDATE, FROM      00120004
001300*    THE CRIT SPEC SCREEN (CNKCS233). OR THEY CAN GO TO F24-LIST  00130004
001400*    F24 - PARM LIST  (CNKCS237)                                  00140004
001500*---------------------------------------------------------------* 00150004
263455* CHANGED 11/02/2021    BY JIM HUNTER      WR: CHG0263455         00151099
263455* CHANGE CALL OF DPKUT100 TO CALL DP010I-NUMERIC-EDIT-ROUTINE     00152099
263455* MAKING THE CALL DYNAMIC VS STATIC.                              00153099
263455*----------------------------------------------------------------*00154099
CICS  * CHANGED 10/25/2022    BY JIM HUNTER      WR: CHG0276961         00155099
CICS  * ADD COPYBOOK DPWS930 AND MAKE THE CICS ARCHITECTURE CALL        00156099
CICS  * DYNAMIC INSTEAD OF STATIC BY CALLING DP930-CICS-ARCH-API.       00157099
CICS  *-----------------------------------------------------------------00158099
001600 ENVIRONMENT DIVISION.                                            00160004
001700 DATA DIVISION.                                                   00170087
001800                                                                  00180004
001900 WORKING-STORAGE SECTION.                                         00190004
002000                                                                  00200004
002100 01  DK-DB2-KEYS.                                                 00210004
002200     05  DK-PARM-CODE             PIC   X(06)       VALUE SPACES. 00220004
002300                                                                  00230004
002400 01  PC-PROGRAM-CONSTANTS.                                        00240004
002410     05  PC-CALENDAR-MODULE        PIC  X(08)  VALUE 'DPKUT500'.  00241034
002500     05  PC-CURRENT-PROGRAM-NAME  PIC  X(08)  VALUE  'CNKCS235'.  00250004
002600     05  PC-CURRENT-MAP-NAME      PIC  X(08)  VALUE  'CNK235  '.  00260004
002700     05  PC-CURRENT-MAPSET-NAME   PIC  X(08)  VALUE  'CNKM235 '.  00270004
002800     05  PC-APPL-MAP              PIC S9(04)  VALUE  +1           00280004
002900                                              COMP.               00290004
003000     05  PC-MAX-RETRIES           PIC S9(04)  VALUE  +3           00300004
003100                                              COMP.               00310004
003200     05  PC-INTER-APPL-CODES.                                     00320004
003300         10  PC-INTER-APPL-CRIT-SPEC-UPD  PIC  X(01)  VALUE '1'.  00330004
003400         10  PC-INTER-APPL-CRIT-SPEC-ADD  PIC  X(01)  VALUE '1'.  00340004
003500         10  PC-INTER-CODE-LIST-ADD       PIC  X(01)  VALUE '2'.  00350074
003600         10  PC-INTER-PARM-LIST-ADD       PIC  X(01)  VALUE '3'.  00360074
003610         10  PC-INTER-PARM-LIST-UPDATE    PIC  X(01)  VALUE '3'.  00361074
003700     05  PC-D                     PIC  X(01)  VALUE  'D'.         00370004
003800     05  PC-I                     PIC  X(01)  VALUE  'I'.         00380004
003900     05  PC-L                     PIC  X(01)  VALUE  'L'.         00390004
004000     05  PC-N                     PIC  X(01)  VALUE  'N'.         00400004
004100     05  PC-UPDATE                PIC  X(02)  VALUE  'UP'.        00410015
004110     05  PC-ADD                   PIC  X(02)  VALUE  'AP'.        00411037
004200     05  PC-SPACE                 PIC  X(03)  VALUE  '   '.       00420004
004300     05  PC-01                    PIC  X(02)  VALUE  '01'.        00430004
004400     05  PC-DC                    PIC  X(02)  VALUE  'DC'.        00440004
004500     05  PC-DS                    PIC  X(02)  VALUE  'DS'.        00450004
004600     05  PC-SH                    PIC  X(02)  VALUE  'SH'.        00460004
004700     05  PC-DEFAULT-BEG-TMST      PIC  X(26)                      00470039
004800                          VALUE  '0001-01-01-00.00.00.000000'.    00480039
004810     05  PC-DEFAULT-END-TMST      PIC  X(26)                      00481039
004820                          VALUE  '9999-12-31-23.59.59.999999'.    00482071
004830     05  PC-DEFAULT-FROM-DATE     PIC  X(08)                      00483070
004840                          VALUE  '00010101'.                      00484070
004850     05  PC-DEFAULT-TO-DATE       PIC  X(08)                      00485070
004860                          VALUE  '99991231'.                      00486070
004900                                                                  00490004
005000*----------------------------------------------------------------*00500004
005100*  SYSTEM MESSAGES                                                00510004
005200*----------------------------------------------------------------*00520004
005300*   00004 - PRESS F2 TO CONFIRM REQUEST                           00530085
005310*   00005 - INVALID VALUE                                         00531085
005400*   00007 - REQUIRED ENTRY                                        00540004
005500*   00008 - MUST BE NUMERIC                                       00550004
005510*   00009 - INVALID DATE                                          00551035
005600*   00034 - ADD SUCCESSFUL                                        00560004
005700*   00045 - INVALID FUNCTION                                      00570004
005800*   00059 - UPDATE(S) SUCCESSFUL                                  00580004
005900*   00069 - TOP OF LIST                                           00590004
006000*   00070 - BOTTOM OF LIST                                        00600004
006100*   00115 - DELETE SUCCESSFUL                                     00610004
006200*   00354 - DELETE PENDING - PRESS PF2 TO CONFIRM                 00620004
006300*   00527 - TYPE CODE DOES NOT EXIST                              00630004
006400*   02571 - UNABLE TO UPD - CURRENT OPER UNT AND OPER UNIT ID ENTE00640004
006500*   02612 - YOU DO NOT HAVE AUTHORITY TO UPDATE                   00650099
006600*   02698 - DATE RANGE IS INVALID                                 00660099
007600*   03707 - CODE ALREADY EXISTS                                   00760017
007610*   03708 - CODE DOES NOT EXIST                                   00761017
007620*   03709 - PARM ALREADY EXISTS                                   00762017
007630*   03710 - PARM DOES NOT EXIST                                   00763017
007640*   03724 - YOU DO NOT HAVE AUTHORITY TO ADD                      00764099
007800*   99901 - INVALID COMMAND WAS ENTERED                           00780004
007900*----------------------------------------------------------------*00790004
008000     05  PC-TSYMSG-NUMBERS.                                       00800004
008100         10  PC-TSYMSG-00004      PIC  9(05)  VALUE  00004.       00810085
008110         10  PC-TSYMSG-00005      PIC  9(05)  VALUE  00005.       00811085
008200         10  PC-TSYMSG-00007      PIC  9(05)  VALUE  00007.       00820004
008300         10  PC-TSYMSG-00008      PIC  9(05)  VALUE  00008.       00830004
008310         10  PC-TSYMSG-00009      PIC  9(05)  VALUE  00009.       00831035
008400         10  PC-TSYMSG-00034      PIC  9(05)  VALUE  00034.       00840004
008500         10  PC-TSYMSG-00045      PIC  9(05)  VALUE  00045.       00850004
008600         10  PC-TSYMSG-00059      PIC  9(05)  VALUE  00059.       00860004
008700         10  PC-TSYMSG-00069      PIC  9(05)  VALUE  00069.       00870004
008800         10  PC-TSYMSG-00070      PIC  9(05)  VALUE  00070.       00880004
008900         10  PC-TSYMSG-00115      PIC  9(05)  VALUE  00115.       00890004
009000         10  PC-TSYMSG-00354      PIC  9(05)  VALUE  00354.       00900004
009100         10  PC-TSYMSG-00527      PIC  9(05)  VALUE  00527.       00910004
009200         10  PC-TSYMSG-02571      PIC  9(05)  VALUE  02571.       00920004
009210         10  PC-TSYMSG-02612      PIC  9(05)  VALUE  02612.       00921099
009300         10  PC-TSYMSG-02698      PIC  9(05)  VALUE  02698.       00930085
010600         10  PC-TSYMSG-03707      PIC  9(05)  VALUE  03707.       01060017
010610         10  PC-TSYMSG-03708      PIC  9(05)  VALUE  03708.       01061017
010620         10  PC-TSYMSG-03709      PIC  9(05)  VALUE  03709.       01062017
010630         10  PC-TSYMSG-03710      PIC  9(05)  VALUE  03710.       01063017
010640         10  PC-TSYMSG-03724      PIC  9(05)  VALUE  03724.       01064099
010700         10  PC-TSYMSG-99901      PIC  9(05)  VALUE  99901.       01070004
010800*                                                                 01080004
010900 01  PS-PROGRAM-SWITCHES.                                         01090004
011000     05  PS-ERROR-SW              PIC  X(01)  VALUE  'N'.         01100004
011100         88  PS-ERROR                         VALUE  'Y'.         01110004
011200         88  PS-NO-ERROR                      VALUE  'N'.         01120004
011300     05  PS-COMMAREA-SW           PIC  X(01)  VALUE  'N'.         01130004
011400         88  PS-COMMAREA-VALID                VALUE  'Y'.         01140004
011500         88  PS-COMMAREA-NOT-VALID            VALUE  'N'.         01150004
011600     05  PS-LIST-END-SW           PIC  X(01)  VALUE  'N'.         01160004
011700         88  PS-LIST-END                      VALUE  'Y'.         01170004
011800         88  PS-NO-LIST-END                   VALUE  'N'.         01180004
011900     05  PS-STORE-SW              PIC  X(01)  VALUE  'N'.         01190004
012000         88  PS-STORES-EXIST                  VALUE  'Y'.         01200004
012100         88  PS-NO-STORES-EXIST               VALUE  'N'.         01210004
012200     05  PS-DIVERT-SW             PIC  X(01)  VALUE  'N'.         01220004
012300         88  PS-DUP-DIVERT-EXIST              VALUE  'Y'.         01230004
012400         88  PS-NO-DUP-DIVERT-EXIST           VALUE  'N'.         01240004
012500     05  PS-DUPLICATE-STORE-SW    PIC  X(01)  VALUE  'N'.         01250004
012600         88  PS-DUP-STORE-ASGNMT              VALUE  'Y'.         01260004
012700         88  PS-NO-DUP-STORE-ASGNMT           VALUE  'N'.         01270004
012800     05  PS-LBL-SEQ-OPER-EXISTS-SW PIC X(01)  VALUE  'N'.         01280004
012900         88  PS-LBL-SEQ-OPER-EXISTS-YES       VALUE  'Y'.         01290004
013000         88  PS-LBL-SEQ-OPER-EXISTS-NO        VALUE  'N'.         01300004
013100     05  PS-TYPE-CHANGED-SW        PIC X(01)  VALUE  'N'.         01310004
013200         88  PS-TYPE-CHANGED-YES              VALUE  'Y'.         01320004
013300         88  PS-TYPE-CHANGED-NO               VALUE  'N'.         01330004
013310     05  PS-EOF-CURSOR-SW          PIC X(01)  VALUE  'N'.         01331099
013320         88  PS-EOF-CURSOR-YES                VALUE  'Y'.         01332099
013330         88  PS-EOF-CURSOR-NO                 VALUE  'N'.         01333099
013340     05  PS-FUNCTION-ALLOWED-SW    PIC X(01)  VALUE  'N'.         01334099
013350         88  PS-FUNCTION-ALLOWED              VALUE  'Y'.         01335099
013360         88  PS-FUNCTION-NOT-ALLOWED          VALUE  'N'.         01336099
013400                                                                  01340004
013500 01  PV-PROGRAM-VARIABLES.                                        01350004
013600     05  PV-CICS-RESPONSE         PIC S9(04)  VALUE +0            01360004
013700                                              COMP SYNC.          01370004
013800     05  PV-RETRY-COUNTER         PIC S9(04)  VALUE +0            01380004
013900                                              COMP SYNC.          01390004
014000     05  PV-INPUT-SPACE-CNT       PIC S9(04)  VALUE +0            01400004
014100                                              COMP SYNC.          01410004
014200     05  PV-READ-COUNT            PIC S9(09)  VALUE +0            01420004
014300                                              COMP-3.             01430004
014400     05  PV-READ-STORES-COUNT     PIC S9(09)  VALUE +0            01440004
014500                                              COMP-3.             01450004
014600     05  PC-MAX-ITEMS             PIC S9(09)  VALUE +3            01460004
014700                                              COMP-3.             01470004
014800     05  PV-LANE-ASSGN-NUM        PIC  9(09)  VALUE ZEROES.       01480004
014900     05  PV-LABEL-SEQ             PIC S9(04) COMP.                01490004
015000     05  PV-LABEL-SEQ-COUNT       PIC S9(09)  VALUE +0            01500004
015100                                              COMP-3.             01510004
015110     05  PV-BEG-TMST.                                             01511021
015111         10  PV-BEG-YEAR          PIC  X(04).                     01511134
015112         10  PV-BEG-YEAR-R REDEFINES PV-BEG-YEAR.                 01511234
015113             20  PV-BEG-YEAR-N    PIC  9(04).                     01511334
015114         10  PV-BEG-DASH-1        PIC  X(01)  VALUE '-'.          01511449
015115         10  PV-BEG-MONTH         PIC  X(02).                     01511534
015116         10  PV-BEG-MONTH-R REDEFINES PV-BEG-MONTH.               01511634
015117             20  PV-BEG-MONTH-N   PIC  9(02).                     01511734
015118         10  PV-BEG-DASH-2        PIC  X(01)  VALUE '-'.          01511849
015120         10  PV-BEG-DAY           PIC  X(02).                     01512034
015121         10  PV-BEG-DAY-R REDEFINES PV-BEG-DAY.                   01512134
015122             20  PV-BEG-DAY-N     PIC  9(02).                     01512234
015124         10  PV-BEG-DASH-3        PIC  X(01)  VALUE '-'.          01512449
015125         10  PV-BEG-HOUR          PIC  X(02).                     01512534
015126         10  PV-BEG-HOUR-R REDEFINES PV-BEG-HOUR.                 01512634
015127             20  PV-BEG-HOUR-N    PIC  9(02).                     01512734
015129         10  PV-BEG-DASH-4        PIC  X(01)  VALUE '.'.          01512949
015130         10  PV-BEG-MIN           PIC  X(02).                     01513034
015131         10  PV-BEG-MIN-R REDEFINES PV-BEG-MIN.                   01513134
015132             20  PV-BEG-MIN-N     PIC  9(02).                     01513234
015134         10  PV-BEG-DASH-5        PIC  X(01)  VALUE '.'.          01513449
015135         10  PV-BEG-SEC           PIC  X(02).                     01513534
015136         10  PV-BEG-SEC-R REDEFINES PV-BEG-SEC.                   01513634
015137             20  PV-BEG-SEC-N     PIC  9(02).                     01513734
015139         10  PV-BEG-DASH-6        PIC  X(01)  VALUE '.'.          01513949
015140         10  PV-BEG-MSEC          PIC  X(06).                     01514034
015141         10  PV-BEG-MSEC-R REDEFINES PV-BEG-MSEC.                 01514134
015142             20  PV-BEG-MSEC-N    PIC  9(06).                     01514234
015143*                                                                 01514334
015144     05  PV-END-TMST.                                             01514434
015145         10  PV-END-YEAR          PIC  X(04).                     01514534
015146         10  PV-END-YEAR-R REDEFINES PV-END-YEAR.                 01514634
015147             20  PV-END-YEAR-N    PIC  9(04).                     01514734
015148         10  PV-END-DASH-1        PIC  X(01)  VALUE '-'.          01514849
015149         10  PV-END-MONTH         PIC  X(02).                     01514934
015150         10  PV-END-MONTH-R REDEFINES PV-END-MONTH.               01515034
015151             20  PV-END-MONTH-N   PIC  9(02).                     01515134
015152         10  PV-END-DASH-2        PIC  X(01)  VALUE '-'.          01515249
015153         10  PV-END-DAY           PIC  X(02).                     01515334
015154         10  PV-END-DAY-R REDEFINES PV-END-DAY.                   01515434
015155             20  PV-END-DAY-N     PIC  9(02).                     01515534
015156         10  PV-END-DASH-3        PIC  X(01)  VALUE '-'.          01515649
015157         10  PV-END-HOUR          PIC  X(02).                     01515734
015158         10  PV-END-HOUR-R REDEFINES PV-END-HOUR.                 01515834
015159             20  PV-END-HOUR-N    PIC  9(02).                     01515934
015160         10  PV-END-DASH-4        PIC  X(01)  VALUE '.'.          01516049
015161         10  PV-END-MIN           PIC  X(02).                     01516134
015162         10  PV-END-MIN-R REDEFINES PV-END-MIN.                   01516234
015163             20  PV-END-MIN-N     PIC  9(02).                     01516334
015164         10  PV-END-DASH-5        PIC  X(01)  VALUE '.'.          01516449
015165         10  PV-END-SEC           PIC  X(02).                     01516534
015166         10  PV-END-SEC-R REDEFINES PV-END-SEC.                   01516634
015167             20  PV-END-SEC-N     PIC  9(02).                     01516734
015168         10  PV-END-DASH-6        PIC  X(01)  VALUE '.'.          01516849
015169         10  PV-END-MSEC          PIC  X(06).                     01516934
015170         10  PV-END-MSEC-R REDEFINES PV-END-MSEC.                 01517034
015171             20  PV-END-MSEC-N    PIC  9(06).                     01517134
015200*                                                                 01520021
015210     05  PV-FROM-DATE-HOLD.                                       01521034
015220         10  PV-FROM-YY            PIC  9(04)  VALUE ZEROES.      01522034
015230         10  PV-FROM-MM            PIC  9(02)  VALUE ZEROES.      01523034
015240         10  PV-FROM-DD            PIC  9(02)  VALUE ZEROES.      01524034
015250                                                                  01525034
015260     05  PV-TO-DATE-HOLD.                                         01526034
015270         10  PV-TO-YY              PIC  9(04)  VALUE ZEROES.      01527034
015280         10  PV-TO-MM              PIC  9(02)  VALUE ZEROES.      01528034
015290         10  PV-TO-DD              PIC  9(02)  VALUE ZEROES.      01529034
015291                                                                  01529134
015300*                                                                 01530034
015600     05  PV-INP-FUNCTION              PIC  X(01).                 01560004
015610                                                                  01561026
015700     05  PV-INP-LOC-ID                PIC   9(4).                 01570026
015900     05  PV-INP-INTFC-SYS-CDE         PIC   X(3).                 01590026
015940     05  PV-INP-FUNC-PRC-STAT-CDE     PIC   X(2).                 01594026
015960     05  PV-INP-FUNC-BEG-TMST         PIC   X(26).                01596026
015980     05  PV-INP-FUNC-END-TMST         PIC   X(26).                01598026
015991     05  PV-INP-FUNC-QTY              PIC   9(8)-.                01599199
015993     05  PV-INP-FUNC-PCT              PIC   9(1)V9(4).            01599326
015995     05  PV-INP-FUNC-TXT              PIC   X(25).                01599526
015997     05  PV-INP-FUNC-WD-QTY           PIC   9(5).9(4).            01599742
015999     05  PV-INP-FUNC-DPTH-QTY         PIC   9(5).9(4).            01599942
016001     05  PV-INP-FUNC-HT-QTY           PIC   9(5).9(4).            01600142
016003     05  PV-INP-FUNC-WT-QTY           PIC   9(5).9(4).            01600343
016010                                                                  01601004
016020*----------------------------------------------------------------*01602034
016030*    CALENDAR ROUTINE                                            *01603034
016040*----------------------------------------------------------------*01604034
016050     COPY DPWS500.                                                01605034
016060                                                                  01606034
016070*----------------------------------------------------------------*01607099
016080**  SECURITY SUBROUTINE PARAMETERS                                01608099
016090*----------------------------------------------------------------*01609099
016091     COPY DPWS008.                                                01609199
016092                                                                  01609299
016093                                                                  01609399
016100*---------------------------------------------------------------* 01610004
016200* SELECTON QUEUE LAYOUT - FROM CODE LIST                        * 01620004
016300*---------------------------------------------------------------* 01630004
016400     COPY CNWS019.                                                01640004
016500                                                                  01650004
016510*---------------------------------------------------------------* 01651004
016520* SELECTON QUEUE LAYOUT - FROM PARM LIST                        * 01652004
016530*---------------------------------------------------------------* 01653004
016540     COPY CNWS021.                                                01654004
016550                                                                  01655004
016600*----------------------------------------------------------------*01660004
016700*    MAP LAYOUT                                                  *01670004
016800*----------------------------------------------------------------*01680004
016900     COPY CNKM235.                                                01690004
017000                                                                  01700004
017100*----------------------------------------------------------------*01710004
017200*    ATTRIBUTE SETTINGS COPYBOOK.                                *01720004
017300*----------------------------------------------------------------*01730004
017400     COPY DPWS015.                                                01740004
017500                                                                  01750004
017600*----------------------------------------------------------------*01760004
017700*    FUNCTION KEYS COPYBOOK                                      *01770004
017800*----------------------------------------------------------------*01780004
017900     COPY DPWS016.                                                01790004
018000                                                                  01800004
018100**--------------------------------------------------------------**01810004
018200** THE CVLLING PARAMETER LIST (DPWS010) FOR THE NUMERIC EDIT    **01820004
018300** SUB-ROUTINE (DPKUT100).                                      **01830004
018400**--------------------------------------------------------------**01840004
018500     COPY DPWS010I.                                               01850004
018600                                                                  01860004
018700**--------------------------------------------------------------**01870004
018800** THE CALLING PARAMETER LIST (DPWS030) FOR THE CICS ARCHITECTURE*01880004
018900** APPLICATION PROGRAMMING INTERFACE MODULE.                    **01890099
019000**--------------------------------------------------------------**01900004
019100     COPY DPWS030.                                                01910004
CICS       COPY DPWS930.                                                01911099
019200                                                                  01920004
019300**--------------------------------------------------------------**01930004
019400*    STANDARD COMMAREA.                                           01940004
019500**--------------------------------------------------------------**01950004
019600     COPY DPWS020.                                                01960004
019700     05  FILLER REDEFINES DP020-VARIABLE-COMMAREA.                01970004
019800                                                                  01980004
019900*---------------------------------------------------------------* 01990004
020000* INTER-APPLICATION COMMAREA.                                     02000004
020100*   CNWS014 - IS THE INPUT LAYOUT WHEN COMING FROM THE CRIT.    * 02010004
020200*             SPEC SCREEN.                                        02020004
020300*   CNWS018 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02030004
020400*             THE CODE LIST SCREEN                                02040004
020410*   CNWS020 - IS THE INPUT LAYOUT THAT WILL BE PASSED FROM        02041004
020420*             THE PARM LIST SCREEN                                02042004
020500*---------------------------------------------------------------* 02050004
020600                                                                  02060004
020700         10  INTER-APPL-COMM-AREA PIC X(200).                     02070004
020800     COPY CNWS014.                                                02080004
020900     COPY CNWS018.                                                02090004
020910     COPY CNWS020.                                                02091004
021000***************************************************************** 02100004
021100*    SPECIFIC COMMMAREA FOR CNKCS235.                             02110004
021200***************************************************************** 02120004
021300         10  ASC-SPECIFIC-COMMAREA.                               02130004
021400             15  ASC-INT-APPL-FORMAT-IND   PIC  X(01).            02140004
021410                 88  ASC-INTER-APPL-CRIT-SPEC-UPD   VALUE '1'.    02141074
021420                 88  ASC-INTER-APPL-CRIT-SPEC-ADD   VALUE '1'.    02142074
021430                 88  ASC-INTER-CODE-LIST-ADD        VALUE '2'.    02143074
021440                 88  ASC-INTER-PARM-LIST-ADD        VALUE '3'.    02144074
021450                 88  ASC-INTER-PARM-LIST-UPDATE     VALUE '3'.    02145074
021500             15  ASC-ACTION-SW          PIC X(03).                02150004
021600                 88  ASC-ADD            VALUE 'ADD'.              02160004
021700                 88  ASC-DELETE         VALUE 'DEL'.              02170004
021800                 88  ASC-UPDATE         VALUE 'UPD'.              02180004
021900             15  ASC-FUNCTION              PIC  X(02).            02190004
022000                 88  ASC-FUNCTION-NONE             VALUE ' '.     02200004
022100                 88  ASC-ADD-CODE                  VALUE 'AC'.    02210004
022200                 88  ASC-UPD-CODE                  VALUE 'UC'.    02220004
022300                 88  ASC-ADD-PARM                  VALUE 'AP'.    02230004
022400                 88  ASC-UPD-PARM                  VALUE 'UP'.    02240004
022410*                                                                 02241020
022500             15  ASC-PARM-CODE                PIC  X(06).         02250020
022600             15  ASC-PARM-DESC                PIC  X(40).         02260020
022700             15  ASC-PARM-TYPE                PIC  X(02).         02270020
022702                 88  ASC-VALID-TYPE                VALUE 'DT',    02270250
022703                                                         'PC',    02270350
022704                                                         'QT',    02270450
022705                                                         'TX'.    02270550
022706                 88  ASC-TYPE-DATE                 VALUE 'DT'.    02270650
022707                 88  ASC-TYPE-PCNT                 VALUE 'PC'.    02270750
022708                 88  ASC-TYPE-QTY                  VALUE 'QT'.    02270850
022709                 88  ASC-TYPE-TEXT                 VALUE 'TX'.    02270950
022710             15  ASC-TYPE-DESCR               PIC  X(20).         02271050
022711*                                                                 02271150
022712             15 ASC-PM-LOC-ID                 PIC   X(4).         02271250
022713                 88  ASC-ALL-DC              VALUE                02271350
022714                     'DC  ' ' DC ' 'DC' '  DC'.                   02271450
022715                 88  ASC-ALL-EFC             VALUE                02271550
022716                     'EFC ' 'EFC' ' EFC'.                         02271650
022717                 88  ASC-DC-AND-EFC          VALUE                02271750
022718                     'ALL ' 'ALL' ' ALL'.                         02271850
022719             15 ASC-PM-LOC-ID-R REDEFINES ASC-PM-LOC-ID.          02271930
022720                 20 ASC-PM-LOC-ID-N           PIC   9(4).         02272030
022721             15 ASC-PM-LOC-NAME               PIC   X(40).        02272133
022730             15 ASC-PM-INTFC-SYS-CDE          PIC   X(3).         02273006
022740             15 ASC-PM-FUNC-PRC-STAT-CDE      PIC   X(2).         02274006
022741                88  ASC-VALID-STATUS              VALUE 'AC',     02274199
022742                                                        'IN'.     02274299
022746                88  ASC-ACTIVE                    VALUE 'AC'.     02274699
022747                88  ASC-INACTIVE                  VALUE 'IN'.     02274799
022750             15 ASC-PM-FUNC-BEG-TMST          PIC   X(26).        02275006
022751             15 ASC-PM-FUNC-BEG-TMST-NULL     PIC S9(04)          02275199
022752                                                      COMP SYNC.  02275299
022760             15 ASC-PM-FUNC-END-TMST          PIC   X(26).        02276006
022761             15 ASC-PM-FUNC-END-TMST-NULL     PIC S9(04)          02276199
022762                                                      COMP SYNC.  02276299
022770             15 ASC-PM-FUNC-QTY               PIC   X(9).         02277030
022772             15 ASC-PM-FUNC-QTY-R REDEFINES ASC-PM-FUNC-QTY.      02277299
022773                 20 ASC-PM-FUNC-QTY-N         PIC  S9(9).         02277399
022774             15 ASC-PM-FUNC-QTY-NULL          PIC S9(04)          02277499
022775                                                      COMP SYNC.  02277599
022780             15 ASC-PM-FUNC-PCT               PIC   X(06).        02278043
022782             15 ASC-PM-FUNC-PCT-R REDEFINES ASC-PM-FUNC-PCT.      02278299
022783                 20 ASC-PM-FUNC-PCT-N         PIC   9(1).9(4).    02278399
022784             15 ASC-PM-FUNC-PCT-NULL          PIC S9(04)          02278499
022785                                                      COMP SYNC.  02278599
022790             15 ASC-PM-FUNC-TXT               PIC   X(25).        02279006
022791             15 ASC-PM-FUNC-TXT-NULL          PIC S9(04)          02279199
022792                                                      COMP SYNC.  02279299
022793             15 ASC-PM-FUNC-WD-QTY            PIC   X(10).        02279399
022794             15 ASC-PM-FUNC-WD-QTY-R                              02279499
022795                           REDEFINES ASC-PM-FUNC-WD-QTY.          02279599
022796                20 ASC-PM-FUNC-WD-QTY-N       PIC   9(5).9(4).    02279699
022797             15 ASC-PM-FUNC-DPTH-QTY          PIC   X(10).        02279799
022798             15 ASC-PM-FUNC-DPTH-QTY-R                            02279899
022799                             REDEFINES ASC-PM-FUNC-DPTH-QTY.      02279999
022800                20 ASC-PM-FUNC-DPTH-QTY-N     PIC   9(5).9(4).    02280099
022801             15 ASC-PM-FUNC-HT-QTY            PIC   X(10).        02280199
022802             15 ASC-PM-FUNC-HT-QTY-R REDEFINES ASC-PM-FUNC-HT-QTY.02280299
022803                20 ASC-PM-FUNC-HT-QTY-N       PIC   9(5).9(4).    02280399
022804             15 ASC-PM-FUNC-WT-QTY            PIC   X(10).        02280499
022805             15 ASC-PM-FUNC-WT-QTY-R                              02280599
022806                           REDEFINES ASC-PM-FUNC-WT-QTY.          02280699
022807                20 ASC-PM-FUNC-WT-QTY-N       PIC   9(5).9(4).    02280799
022808                                                                  02280899
023600*                                                                 02360004
023700             15  ASC-USE-SELECTION-QUEUE-IND                      02370004
023800                                           PIC  X(01).            02380004
023900                 88  ASC-USE-SELECTION-QUEUE           VALUE 'Y'. 02390004
024000             15  ASC-SEL-QUEUE-NAME        PIC  X(08).            02400004
024100             15  ASC-NUMBER-OF-TS-ITEMS    PIC S9(05)  COMP-3.    02410004
024200             15  ASC-NUMBER-OF-SELECTED-ITEMS                     02420004
024300                                           PIC S9(09)  COMP-3.    02430004
024400             15  ASC-ITEM-SUB                 PIC S9(04)  COMP    02440004
024500                                                          SYNC.   02450004
024600             15  ASC-SEL-SUB               PIC S9(04)  COMP.      02460004
024700             15  ASC-SEL-ITEM              PIC S9(04)  COMP.      02470004
024800             15  ASC-TEMP-QUEUE-UPDATE-SW  PIC  X(01).            02480004
024900                 88  ASC-UPDATE-TSQ                   VALUE 'Y'.  02490004
025000                 88  ASC-NO-TSQ-UPDATE                VALUE ' '.  02500004
025100                                                                  02510004
025200             15  ASC-TKRPRPM-INSERTED-SW  PIC  X(01).             02520004
025300                 88  ASC-TKRPRPM-INSERTED             VALUE  'Y'. 02530004
025400                 88  ASC-TKRPRPM-NOT-INSERTED         VALUE  'N'. 02540004
025500             15  ASC-TKRPRPM-UPDATED-SW   PIC  X(01).             02550004
025600                 88  ASC-TKRPRPM-UPDATED              VALUE  'Y'. 02560004
025700                 88  ASC-TKRPRPM-NOT-UPDATED          VALUE  'N'. 02570004
025800             15  ASC-ITEMS-LEFT-INDICATOR     PIC  X(01).         02580004
025900                 88  ASC-ITEMS-LEFT-ON-DB             VALUE 'Y'.  02590004
026000                 88  ASC-NO-ITEMS-LEFT-ON-DB          VALUE 'N'.  02600004
026100             15  ASC-F2-CONFIRM-SW            PIC  X(01).         02610004
026200                 88  ASC-F2-CONFIRM-YES               VALUE 'Y'.  02620004
026300                 88  ASC-F2-CONFIRM-NO                VALUE 'N'.  02630004
026400                                                                  02640004
026500*----------------------------------------------------------------*02650004
026600*    ABEND PROCESSING COPYBOOK.                                  *02660004
026700*----------------------------------------------------------------*02670004
026800     COPY DPWS013.                                                02680004
026900                                                                  02690004
026910*----------------------------------------------------------------*02691033
026920*    COMMAREA USED TO CALL XLKUT071 (LOCATION DOMAIN ACCESS)     *02692033
026930*----------------------------------------------------------------*02693033
026940                                                                  02694033
026950     COPY XLWS071.                                                02695033
026960                                                                  02696033
027000*----------------------------------------------------------------*02700004
027100*    DB2 TABLE FOR PARM CODE - TKRPRPM                            02710004
027200*----------------------------------------------------------------*02720004
027300     EXEC SQL                                                     02730004
027400          INCLUDE TKRPRPM                                         02740004
027500     END-EXEC.                                                    02750004
027600                                                                  02760004
027601*----------------------------------------------------------------*02760199
027602*    DB2 TABLE FOR PARM CODE - XLT_LOC                            02760299
027603*----------------------------------------------------------------*02760399
027604     EXEC SQL                                                     02760499
027605          INCLUDE XLT00010                                        02760599
027606     END-EXEC.                                                    02760699
027607                                                                  02760799
027608*----------------------------------------------------------------*02760899
027609*    CURSOR FOR ALL DC'S NOT CURRENTLY WITH PARM                  02760999
027610*----------------------------------------------------------------*02761099
027611     EXEC SQL                                                     02761199
027612          DECLARE DC_LOC_CSR CURSOR FOR                           02761299
027613           SELECT A.LOC_NBR                                       02761399
027614             FROM XLT_LOC A                                       02761499
027615            WHERE A.LOC_TYP_CDE  = 'DC'                           02761599
027616              AND A.OPN_DTE     <=  CURRENT DATE                  02761699
027617              AND A.CLO_DTE     >=  CURRENT DATE                  02761799
027618              AND A.E_BUS_IND   = 'N'                             02761899
027619              AND NOT A.LOC_NBR  IN                               02761999
027620                  (SELECT B.LOC_ID                                02762099
027621                     FROM TKRPRPM B                               02762199
027622                    WHERE B.SYS_PRC_FUNC_CDE  = :DK-PARM-CODE)    02762299
027623             WITH UR                                              02762399
027624     END-EXEC.                                                    02762499
027625                                                                  02762599
027626                                                                  02762699
027627*----------------------------------------------------------------*02762799
027628*    CURSOR FOR ALL EFC'S NOT CURRENTLY WITH PARM                 02762899
027629*----------------------------------------------------------------*02762999
027630     EXEC SQL                                                     02763099
027631          DECLARE EFC_LOC_CSR CURSOR FOR                          02763199
027632           SELECT A.LOC_NBR                                       02763299
027633             FROM XLT_LOC A                                       02763399
027634            WHERE A.LOC_TYP_CDE  = 'DC'                           02763499
027635              AND A.OPN_DTE     <=  CURRENT DATE                  02763599
027636              AND A.CLO_DTE     >=  CURRENT DATE                  02763699
027637              AND A.E_BUS_IND   = 'Y'                             02763799
027638              AND NOT A.LOC_NBR  IN                               02763899
027639                  (SELECT B.LOC_ID                                02763999
027640                     FROM TKRPRPM B                               02764099
027641                    WHERE B.SYS_PRC_FUNC_CDE  = :DK-PARM-CODE)    02764199
027642             WITH UR                                              02764299
027643     END-EXEC.                                                    02764399
027644                                                                  02764499
027645                                                                  02764599
027646*----------------------------------------------------------------*02764699
027647*    CURSOR FOR ALL DC'S & EFC'S NOT CURRENTLY WITH PARM          02764799
027648*----------------------------------------------------------------*02764899
027649     EXEC SQL                                                     02764999
027652          DECLARE DC_EFC_LOC_CSR CURSOR FOR                       02765299
027653          SELECT A.LOC_NBR                                        02765399
027654            FROM XLT_LOC A                                        02765499
027655           WHERE A.LOC_TYP_CDE  = 'DC'                            02765599
027656             AND A.OPN_DTE     <=  CURRENT DATE                   02765699
027657             AND A.CLO_DTE     >=  CURRENT DATE                   02765799
027659             AND NOT A.LOC_NBR  IN                                02765999
027660                 (SELECT B.LOC_ID                                 02766099
027661                    FROM TKRPRPM B                                02766199
027662                   WHERE B.SYS_PRC_FUNC_CDE  = :DK-PARM-CODE)     02766299
027663             WITH UR                                              02766399
027664     END-EXEC.                                                    02766499
027670                                                                  02767099
027700                                                                  02770004
027800*----------------------------------------------------------------*02780004
027900*    DB2 AREA FOR COMMUNICATIONS                                  02790004
028000*----------------------------------------------------------------*02800004
028100     EXEC SQL                                                     02810004
028200          INCLUDE SQLCA                                           02820004
028300     END-EXEC.                                                    02830004
028400                                                                  02840004
028500*----------------------------------------------------------------*02850004
028600 LINKAGE SECTION.                                                 02860004
028700                                                                  02870004
028800 01  DFHCOMMAREA.                                                 02880004
028900     05  FILLER                         OCCURS  1 TO 4072 TIMES   02890004
029000                                        DEPENDING ON EIBCALEN.    02900004
029100         10  FILLER                     PIC X.                    02910004
029200                                                                  02920004
029300 PROCEDURE DIVISION.                                              02930004
029400***************************************************************** 02940004
029500** THIS MODULE CONTROLS THE OVERALL PROCESSING IN THE PROGRAM. ** 02950004
029600** THE SETUP AND PERFORM OF PARAGRAPH 0001-CALL-CICS-ARCH-API  ** 02960004
029700** MUST BE THE FIRST CODE EXECUTED IN THIS PROGRAM.            ** 02970004
029800**                                                             ** 02980004
029900** THE SECOND OR 'EXIT' PERFORM OF THIS PARAGRAPH MUST BE THE  ** 02990004
030000** LAST CODE EXECUTED ON EACH ITERATION OF THIS PROGRAM.       ** 03000004
030100***************************************************************** 03010004
030200 0000-MAIN-MODULE.                                                03020004
030300     INITIALIZE DP030-CICS-API-FIELDS.                            03030004
030400     MOVE +1                       TO DP030-NUMBER-OF-MAPS.       03040004
030500     MOVE PC-CURRENT-MAPSET-NAME   TO DP030-MAPSET-NAME.          03050004
030600     MOVE PC-CURRENT-MAP-NAME      TO DP030-MAP-NAME (1).         03060004
030700     SET DP030-RECEIVE-APPL-MAP    TO TRUE.                       03070004
030800     MOVE LENGTH OF CNK235I        TO DP030-MAP-LENGTH (1).       03080004
030900     MOVE 'PROGRAM ENTRY CALL'     TO DP013-MESSAGE-TEXT (1).     03090004
031000     PERFORM 0001-CALL-CICS-ARCH-API.                             03100004
031100                                                                  03110004
031200     PERFORM 1000-CONTROL-PROCESSING                              03120004
031300                                                                  03130004
031400     MOVE 'PROGRAM EXIT CALL'      TO DP013-MESSAGE-TEXT (1).     03140004
031500     PERFORM 0001-CALL-CICS-ARCH-API.                             03150004
031600                                                                  03160004
031700 0001-CALL-CICS-ARCH-API.                                         03170004
CICS       CALL DP930-CICS-ARCH-API USING DFHEIBLK                      03180099
031900                                    DFHCOMMAREA                   03190099
032000                                    DP030-CICS-API-FIELDS         03200099
032100                                    DP020-STANDARD-COMMAREA       03210099
032200                                    CNK235I.                      03220099
032300                                                                  03230004
032400     IF  DP030-RC-CALL-SUCCESSFUL                                 03240004
032500         CONTINUE                                                 03250004
032600     ELSE                                                         03260004
032700         SET DP013-NO-ROLLBACK                                    03270004
032800             DP013-XCTL-DISPLAY-RESTART                           03280004
032900             DP013-CICS-ABEND      TO TRUE                        03290004
033000         MOVE 'BEFORE 0000-MAIN-MODULE'                           03300004
033100                                   TO DP013-PARAGRAPH             03310004
CICS           MOVE 'CALL TO CICS ARCH API NOT SUCCESSFUL, RETURN-CODE O03311099
CICS  -             'N NEXT LINE'        TO DP013-MESSAGE-TEXT (2)      03312099
033400         MOVE DP030-RETURN-CODE    TO DP013-MESSAGE-TEXT (3)      03340004
033500         PERFORM DP013-0000-PROCESS-ABEND                         03350004
033600     END-IF.                                                      03360004
033700*                                                                 03370004
033800*----------------------------------------------------------------*03380004
033900*    PROCESS THE APPROPRIATE PARAGRAPHS BASED ON WHAT THE NEXT   *03390004
034000*    COURSE OF ACTION IS FOR THIS TRANSACTION.                   *03400004
034100*----------------------------------------------------------------*03410004
034200 1000-CONTROL-PROCESSING.                                         03420004
034300                                                                  03430004
034400     EVALUATE TRUE                                                03440004
034500         WHEN DP020-NEXT-ACT-INITIAL                              03450004
034600              INITIALIZE ASC-SPECIFIC-COMMAREA                    03460004
034700              PERFORM 1100-PROCESS-INTER-APPL-COMM                03470004
034800                                                                  03480004
034900              IF  PS-COMMAREA-NOT-VALID                           03490004
035000                  SET DP020-NEXT-ACT-APPL-ERROR TO TRUE           03500004
035100              ELSE                                                03510004
035200                  PERFORM 4000-BUILD-INITIAL-PANEL                03520004
035300                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            03530067
035400                  PERFORM 3200-RESET-ATTRIBUTES                   03540004
035500              END-IF                                              03550004
035600                                                                  03560004
035700         WHEN DP020-NEXT-ACT-READ-MAP                             03570004
035800              PERFORM 2000-PROCESS-PANEL                          03580065
035900*F3-END                                                           03590004
036000         WHEN DP020-NEXT-ACT-RETURN                               03600004
036100             MOVE PC-DEFAULT-BEG-TMST TO ASC-PM-FUNC-BEG-TMST     03610099
036110             MOVE PC-DEFAULT-END-TMST TO ASC-PM-FUNC-END-TMST     03611099
036200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   03620004
036300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 03630004
036400             MOVE -1                   TO AOPERL                  03640018
036500                                                                  03650004
036600         WHEN OTHER                                               03660004
036700             SET DP013-LOGIC-ABEND TO TRUE                        03670004
036800             SET DP013-NO-ROLLBACK TO TRUE                        03680004
036900             MOVE '1000-CONTROL-PROCESSING'                       03690004
037000                                   TO DP013-PARAGRAPH             03700004
037100             MOVE 'INVALID NEXT APPLICATION ACTIVITY RECEIVED'    03710004
037200                                   TO DP013-MESSAGE-TEXT(1)       03720004
037300             MOVE DP020-NEXT-APPL-ACTIVITY                        03730004
037400                                   TO DP013-MESSAGE-TEXT(2)       03740004
037500             PERFORM DP013-0000-PROCESS-ABEND                     03750004
037600     END-EVALUATE.                                                03760004
037700*                                                                 03770004
037800******************************************************************03780004
037900** DETERMINE THE KEY OF THE OBJECT TO BE UPDATED BASED ON THE   **03790004
038000** INTER-APPLICATION FORMAT CODE.                               **03800004
038100******************************************************************03810004
038200 1100-PROCESS-INTER-APPL-COMM.                                    03820004
038300     INITIALIZE ASC-SPECIFIC-COMMAREA.                            03830004
038400     MOVE DP020-INT-APPL-FORMAT-IND                               03840004
038500                                   TO ASC-INT-APPL-FORMAT-IND.    03850004
038600                                                                  03860004
038700     SET PS-COMMAREA-VALID                                        03870004
038800         ASC-F2-CONFIRM-NO         TO TRUE.                       03880004
038810                                                                  03881004
038820*WHEN COMING FROM CRIT SPEC        (CNKCS233 - F17=ADD PARM)      03882094
038850                                                                  03885004
038860     EVALUATE TRUE                                                03886094
038870         WHEN ASC-INTER-APPL-CRIT-SPEC-ADD AND                    03887094
038880              CN014-ADD-PARM                                      03888093
038900             MOVE CN014-FUNCTION          TO ASC-FUNCTION         03890004
039000             MOVE CN014-PARM-NAME         TO ASC-PARM-CODE        03900004
039100             MOVE CN014-PARM-DESC         TO ASC-PARM-DESC        03910004
039200             MOVE CN014-PARM-TYPE         TO ASC-PARM-TYPE        03920004
039201                                                                  03920150
039202             EVALUATE TRUE                                        03920250
039203                 WHEN ASC-TYPE-DATE                               03920350
039204                      MOVE 'DATE PARAMETER'     TO ASC-TYPE-DESCR 03920450
039205                 WHEN ASC-TYPE-PCNT                               03920550
039206                      MOVE 'PERCENT PARAMETER'  TO ASC-TYPE-DESCR 03920650
039207                 WHEN ASC-TYPE-QTY                                03920750
039208                      MOVE 'QUANTITY PARAMETER' TO ASC-TYPE-DESCR 03920850
039209                 WHEN ASC-TYPE-TEXT                               03920950
039210                      MOVE 'TEXT PARAMETER'     TO ASC-TYPE-DESCR 03921050
039211             END-EVALUATE                                         03921150
039220                                                                  03922039
039248             MOVE PC-DEFAULT-BEG-TMST TO ASC-PM-FUNC-BEG-TMST     03924839
039249             MOVE PC-DEFAULT-END-TMST TO ASC-PM-FUNC-END-TMST     03924939
039250                                                                  03925039
039251             MOVE PC-DEFAULT-BEG-TMST TO PV-BEG-TMST              03925162
039254             MOVE PV-BEG-YEAR-N       TO ABYEARI                  03925462
039258             MOVE PV-BEG-MONTH-N      TO ABMNTHI                  03925862
039262             MOVE PV-BEG-DAY-N        TO ABDAYI                   03926262
039266             MOVE PV-BEG-HOUR-N       TO ABHOURI                  03926662
039270             MOVE PV-BEG-MIN-N        TO ABMINI                   03927062
039274             MOVE PV-BEG-SEC-N        TO ABSECI                   03927462
039278             MOVE PV-BEG-MSEC-N       TO ABMSECI                  03927862
039279                                                                  03927962
039280             MOVE PC-DEFAULT-END-TMST TO PV-END-TMST              03928062
039281             MOVE PV-END-YEAR-N       TO AEYEARI                  03928162
039282             MOVE PV-END-MONTH-N      TO AEMNTHI                  03928262
039283             MOVE PV-END-DAY-N        TO AEDAYI                   03928362
039284             MOVE PV-END-HOUR-N       TO AEHOURI                  03928462
039285             MOVE PV-END-MIN-N        TO AEMINI                   03928562
039286             MOVE PV-END-SEC-N        TO AESECI                   03928662
039287             MOVE PV-END-MSEC-N       TO AEMSECI                  03928762
039288                                                                  03928862
039289             MOVE ZEROES  TO  ASC-PM-LOC-ID-N                     03928947
039290                              ASC-PM-FUNC-QTY-N                   03929046
039291                              ASC-PM-FUNC-PCT-N                   03929146
039292                              ASC-PM-FUNC-WD-QTY-N                03929246
039293                              ASC-PM-FUNC-DPTH-QTY-N              03929346
039294                              ASC-PM-FUNC-HT-QTY-N                03929446
039295                              ASC-PM-FUNC-WT-QTY-N                03929546
039296                                                                  03929646
039297*WHEN COMING FROM CRIT SPEC        (CNKCS233 - F18=UPD PARM)      03929790
039298                                                                  03929890
039400         WHEN ASC-INTER-APPL-CRIT-SPEC-UPD AND                    03940094
039410              CN014-UPD-PARM                                      03941093
039420                                                                  03942093
039500             MOVE CN014-FUNCTION          TO ASC-FUNCTION         03950090
039600             MOVE CN014-PARM-NAME         TO ASC-PARM-CODE        03960090
039601             MOVE CN014-PARM-DESC         TO ASC-PARM-DESC        03960190
039602             MOVE CN014-PARM-TYPE         TO ASC-PARM-TYPE        03960290
039603             MOVE CN014-OPER-UNT-ID       TO ASC-PM-LOC-ID-N      03960390
039604                                                                  03960490
039605             EVALUATE TRUE                                        03960590
039606                 WHEN ASC-TYPE-DATE                               03960690
039607                      MOVE 'DATE PARAMETER'     TO ASC-TYPE-DESCR 03960790
039608                 WHEN ASC-TYPE-PCNT                               03960890
039609                      MOVE 'PERCENT PARAMETER'  TO ASC-TYPE-DESCR 03960990
039610                 WHEN ASC-TYPE-QTY                                03961090
039611                      MOVE 'QUANTITY PARAMETER' TO ASC-TYPE-DESCR 03961190
039612                 WHEN ASC-TYPE-TEXT                               03961290
039613                      MOVE 'TEXT PARAMETER'     TO ASC-TYPE-DESCR 03961390
039614             END-EVALUATE                                         03961490
039615                                                                  03961590
039623             PERFORM 3040-CHECK-4-ROW-ON-KRPRPM                   03962399
039630                                                                  03963090
039635             MOVE KRPRPM-FUNC-BEG-TMST TO ASC-PM-FUNC-BEG-TMST    03963590
039636             MOVE KRPRPM-FUNC-END-TMST TO ASC-PM-FUNC-END-TMST    03963690
039637                                                                  03963790
039638             MOVE KRPRPM-FUNC-BEG-TMST TO PV-BEG-TMST             03963890
039639             MOVE PV-BEG-YEAR-N        TO ABYEARI                 03963990
039640             MOVE PV-BEG-MONTH-N       TO ABMNTHI                 03964090
039641             MOVE PV-BEG-DAY-N         TO ABDAYI                  03964190
039642             MOVE PV-BEG-HOUR-N        TO ABHOURI                 03964290
039643             MOVE PV-BEG-MIN-N         TO ABMINI                  03964390
039644             MOVE PV-BEG-SEC-N         TO ABSECI                  03964490
039645             MOVE PV-BEG-MSEC-N        TO ABMSECI                 03964590
039646                                                                  03964690
039647             MOVE KRPRPM-FUNC-END-TMST TO PV-END-TMST             03964790
039648             MOVE PV-END-YEAR-N        TO AEYEARI                 03964890
039649             MOVE PV-END-MONTH-N       TO AEMNTHI                 03964990
039650             MOVE PV-END-DAY-N         TO AEDAYI                  03965090
039651             MOVE PV-END-HOUR-N        TO AEHOURI                 03965190
039652             MOVE PV-END-MIN-N         TO AEMINI                  03965290
039653             MOVE PV-END-SEC-N         TO AESECI                  03965390
039654             MOVE PV-END-MSEC-N        TO AEMSECI                 03965490
039655                                                                  03965590
039658             MOVE KRPRPM-INTFC-SYS-CDE                            03965890
039659                                     TO ASC-PM-INTFC-SYS-CDE      03965991
039661             MOVE KRPRPM-FUNC-PRC-STAT-CDE                        03966190
039662                                     TO ASC-PM-FUNC-PRC-STAT-CDE  03966291
039663                                                                  03966390
039664             MOVE KRPRPM-FUNC-QTY      TO ASC-PM-FUNC-QTY-N       03966490
039665             MOVE KRPRPM-FUNC-PCT      TO ASC-PM-FUNC-PCT-N       03966590
039666             MOVE KRPRPM-FUNC-TXT      TO ASC-PM-FUNC-TXT         03966691
039667                                                                  03966799
039678             MOVE KRPRPM-FUNC-WD-QTY   TO ASC-PM-FUNC-WD-QTY-N    03967890
039679             MOVE KRPRPM-FUNC-DPTH-QTY TO ASC-PM-FUNC-DPTH-QTY-N  03967990
039680             MOVE KRPRPM-FUNC-HT-QTY   TO ASC-PM-FUNC-HT-QTY-N    03968090
039681             MOVE KRPRPM-FUNC-WT-QTY   TO ASC-PM-FUNC-WT-QTY-N    03968190
039682                                                                  03968290
039683                                                                  03968390
039684*WHEN COMING FROM CODE LIST        (CNKCS236 - F17=ADD PARM)      03968490
039685         WHEN ASC-INTER-CODE-LIST-ADD                             03968594
039686           IF CN018-NUMBER-OF-SELECTED-ITEMS > 0                  03968699
039687             SET ASC-USE-SELECTION-QUEUE TO TRUE                  03968790
039688             MOVE CN018-NUMBER-OF-SELECTED-ITEMS                  03968890
039689                                   TO ASC-NUMBER-OF-SELECTED-ITEMS03968975
039690             MOVE CN018-NUMBER-OF-TS-ITEMS                        03969075
039691                                   TO ASC-NUMBER-OF-TS-ITEMS      03969175
039692             MOVE CN018-SEL-QUEUE-NAME                            03969275
039693                                   TO ASC-SEL-QUEUE-NAME          03969375
039694             MOVE CN018-FUNCTION         TO ASC-FUNCTION          03969475
039736             MOVE 'UPD' TO  ASC-ACTION-SW                         03973675
039737                                                                  03973799
039749             MOVE PC-DEFAULT-BEG-TMST TO ASC-PM-FUNC-BEG-TMST     03974999
039750             MOVE PC-DEFAULT-END-TMST TO ASC-PM-FUNC-END-TMST     03975099
039751                                                                  03975199
039752             MOVE PC-DEFAULT-BEG-TMST TO PV-BEG-TMST              03975299
039753             MOVE PV-BEG-YEAR-N       TO ABYEARI                  03975399
039754             MOVE PV-BEG-MONTH-N      TO ABMNTHI                  03975499
039755             MOVE PV-BEG-DAY-N        TO ABDAYI                   03975599
039756             MOVE PV-BEG-HOUR-N       TO ABHOURI                  03975699
039757             MOVE PV-BEG-MIN-N        TO ABMINI                   03975799
039758             MOVE PV-BEG-SEC-N        TO ABSECI                   03975899
039759             MOVE PV-BEG-MSEC-N       TO ABMSECI                  03975999
039760                                                                  03976099
039761             MOVE PC-DEFAULT-END-TMST TO PV-END-TMST              03976199
039762             MOVE PV-END-YEAR-N       TO AEYEARI                  03976299
039763             MOVE PV-END-MONTH-N      TO AEMNTHI                  03976399
039764             MOVE PV-END-DAY-N        TO AEDAYI                   03976499
039765             MOVE PV-END-HOUR-N       TO AEHOURI                  03976599
039766             MOVE PV-END-MIN-N        TO AEMINI                   03976699
039767             MOVE PV-END-SEC-N        TO AESECI                   03976799
039768             MOVE PV-END-MSEC-N       TO AEMSECI                  03976899
039769                                                                  03976999
039770             MOVE ZEROES  TO  ASC-PM-LOC-ID-N                     03977099
039771                              ASC-PM-FUNC-QTY-N                   03977199
039772                              ASC-PM-FUNC-PCT-N                   03977299
039773                              ASC-PM-FUNC-WD-QTY-N                03977399
039774                              ASC-PM-FUNC-DPTH-QTY-N              03977499
039775                              ASC-PM-FUNC-HT-QTY-N                03977599
039776                              ASC-PM-FUNC-WT-QTY-N                03977699
039777                                                                  03977799
039778             PERFORM 1120-PREPARE-LIST-ENTRY                      03977875
039779                                                                  03977999
039780             EVALUATE TRUE                                        03978099
039781                 WHEN ASC-TYPE-DATE                               03978199
039782                      MOVE 'DATE PARAMETER'     TO ASC-TYPE-DESCR 03978299
039783                 WHEN ASC-TYPE-PCNT                               03978399
039784                      MOVE 'PERCENT PARAMETER'  TO ASC-TYPE-DESCR 03978499
039785                 WHEN ASC-TYPE-QTY                                03978599
039786                      MOVE 'QUANTITY PARAMETER' TO ASC-TYPE-DESCR 03978699
039787                 WHEN ASC-TYPE-TEXT                               03978799
039788                      MOVE 'TEXT PARAMETER'     TO ASC-TYPE-DESCR 03978899
039789             END-EVALUATE                                         03978999
039790                                                                  03979099
039791         END-IF                                                   03979175
039792                                                                  03979204
039800*WHEN COMING FROM PARM LIST (CNKCS237 - F16=UPD PARM)             03980026
039810*WHEN COMING FROM PARM LIST (CNKCS237 - F17=ADD PARM)             03981026
039900         WHEN ASC-INTER-PARM-LIST-ADD                             03990094
039910         WHEN ASC-INTER-PARM-LIST-UPDATE                          03991094
039920             MOVE PC-DEFAULT-BEG-TMST TO ASC-PM-FUNC-BEG-TMST     03992099
039930             MOVE PC-DEFAULT-END-TMST TO ASC-PM-FUNC-END-TMST     03993099
039940                                                                  03994099
039950             MOVE PC-DEFAULT-BEG-TMST TO PV-BEG-TMST              03995099
039960             MOVE PV-BEG-YEAR-N       TO ABYEARI                  03996099
039970             MOVE PV-BEG-MONTH-N      TO ABMNTHI                  03997099
039980             MOVE PV-BEG-DAY-N        TO ABDAYI                   03998099
039990             MOVE PV-BEG-HOUR-N       TO ABHOURI                  03999099
039991             MOVE PV-BEG-MIN-N        TO ABMINI                   03999199
039992             MOVE PV-BEG-SEC-N        TO ABSECI                   03999299
039993             MOVE PV-BEG-MSEC-N       TO ABMSECI                  03999399
039994                                                                  03999499
039995             MOVE PC-DEFAULT-END-TMST TO PV-END-TMST              03999599
039996             MOVE PV-END-YEAR-N       TO AEYEARI                  03999699
039997             MOVE PV-END-MONTH-N      TO AEMNTHI                  03999799
039998             MOVE PV-END-DAY-N        TO AEDAYI                   03999899
039999             MOVE PV-END-HOUR-N       TO AEHOURI                  03999999
040000             MOVE PV-END-MIN-N        TO AEMINI                   04000099
040001             MOVE PV-END-SEC-N        TO AESECI                   04000199
040002             MOVE PV-END-MSEC-N       TO AEMSECI                  04000299
040003                                                                  04000399
040004             MOVE ZEROES  TO  ASC-PM-LOC-ID-N                     04000499
040005                              ASC-PM-FUNC-QTY-N                   04000599
040006                              ASC-PM-FUNC-PCT-N                   04000699
040007                              ASC-PM-FUNC-WD-QTY-N                04000799
040008                              ASC-PM-FUNC-DPTH-QTY-N              04000899
040009                              ASC-PM-FUNC-HT-QTY-N                04000999
040010                              ASC-PM-FUNC-WT-QTY-N                04001099
040011                                                                  04001199
040020           IF CN020-NUMBER-OF-SELECTED-ITEMS > 0                  04002072
040100             SET ASC-USE-SELECTION-QUEUE TO TRUE                  04010004
040200             MOVE CN020-NUMBER-OF-SELECTED-ITEMS                  04020072
040300                                   TO ASC-NUMBER-OF-SELECTED-ITEMS04030004
040400             MOVE CN020-NUMBER-OF-TS-ITEMS                        04040072
040500                                   TO ASC-NUMBER-OF-TS-ITEMS      04050004
040600             MOVE CN020-SEL-QUEUE-NAME                            04060072
040700                                   TO ASC-SEL-QUEUE-NAME          04070004
040800             MOVE CN020-FUNCTION         TO ASC-FUNCTION          04080072
040810             MOVE CN020-FUNC-CODE        TO ASC-PARM-CODE         04081083
040820             MOVE CN020-FUNC-DESC        TO ASC-PARM-DESC         04082083
040830             MOVE CN020-TYPE-CODE        TO ASC-PARM-TYPE         04083083
040840                                                                  04084082
040850             EVALUATE TRUE                                        04085082
040860                 WHEN ASC-TYPE-DATE                               04086082
040870                      MOVE 'DATE PARAMETER'     TO ASC-TYPE-DESCR 04087082
040880                 WHEN ASC-TYPE-PCNT                               04088082
040890                      MOVE 'PERCENT PARAMETER'  TO ASC-TYPE-DESCR 04089082
040891                 WHEN ASC-TYPE-QTY                                04089182
040892                      MOVE 'QUANTITY PARAMETER' TO ASC-TYPE-DESCR 04089282
040893                 WHEN ASC-TYPE-TEXT                               04089382
040894                      MOVE 'TEXT PARAMETER'     TO ASC-TYPE-DESCR 04089482
040895             END-EVALUATE                                         04089582
040896                                                                  04089682
040900             MOVE 'UPD' TO  ASC-ACTION-SW                         04090004
041000             PERFORM 1120A-PREPARE-LIST-ENTRY                     04100076
041300         END-IF                                                   04130004
041400     END-EVALUATE.                                                04140004
041500                                                                  04150004
041600*----------------------------------------------------------------*04160004
041700* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *04170004
041800* STORAGE QUEUE PASSED FROM THE LIST.                            *04180004
041900*----------------------------------------------------------------*04190004
042000 1120-PREPARE-LIST-ENTRY.                                         04200004
042100     MOVE CN019-MAX-ITEMS          TO ASC-SEL-SUB.                04210075
042200     MOVE ZERO                     TO ASC-SEL-ITEM.               04220004
042300     PERFORM 1130-GET-NEXT-RECORD.                                04230004
042400                                                                  04240004
042410*----------------------------------------------------------------*04241075
042420* ENTRY IS FROM A LIST.  GET THE MESSAGE NUMBER FROM THE TEMP    *04242075
042430* STORAGE QUEUE PASSED FROM THE LIST.                            *04243075
042440*----------------------------------------------------------------*04244075
042450 1120A-PREPARE-LIST-ENTRY.                                        04245076
042460     MOVE CN021-MAX-ITEMS          TO ASC-SEL-SUB.                04246075
042470     MOVE ZERO                     TO ASC-SEL-ITEM.               04247075
042480     PERFORM 1130A-GET-NEXT-RECORD.                               04248076
042490                                                                  04249075
042500*---------------------------------------------------------------- 04250004
042600*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*04260004
042700*---------------------------------------------------------------- 04270004
042800 1130-GET-NEXT-RECORD.                                            04280004
042900     ADD +1                        TO ASC-SEL-SUB.                04290004
043000                                                                  04300004
043100     SET ASC-UPDATE-TSQ TO TRUE.                                  04310004
043200                                                                  04320004
043300     IF  ASC-SEL-SUB > CN019-MAX-ITEMS                            04330004
043400         ADD +1                    TO ASC-SEL-ITEM                04340004
043500         MOVE +1                   TO ASC-SEL-SUB                 04350004
043600     END-IF.                                                      04360004
043700                                                                  04370004
043800     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                04380004
043900         PERFORM 9100-READ-SEL-QUEUE                              04390004
044000         IF  CN019-ITEM (ASC-SEL-SUB) > ZERO                      04400099
044100             MOVE CN019-FUNC-CODE(ASC-SEL-SUB) TO ASC-PARM-CODE   04410077
044300             MOVE CN019-FUNC-DESC(ASC-SEL-SUB) TO ASC-PARM-DESC   04430078
044301             MOVE CN019-FUNC-TYPE(ASC-SEL-SUB) TO ASC-PARM-TYPE   04430178
044500             PERFORM 9200-REWRITE-SEL-QUEUE                       04450004
044600         ELSE                                                     04460004
044700             SUBTRACT +1 FROM ASC-SEL-SUB                         04470004
044800             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            04480004
044900             SET DP020-MSG-INFORMATIONAL                          04490004
045000                 PS-LIST-END       TO TRUE                        04500004
045100         END-IF                                                   04510004
045200     ELSE                                                         04520004
045300         SUBTRACT +1 FROM ASC-SEL-ITEM                            04530004
045400         MOVE CN019-MAX-ITEMS      TO ASC-SEL-SUB                 04540099
045500         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            04550004
045600         SET DP020-MSG-INFORMATIONAL                              04560004
045700                 PS-LIST-END       TO TRUE                        04570004
045800     END-IF.                                                      04580004
045900                                                                  04590004
045910*---------------------------------------------------------------- 04591075
045920*    GET THE NEXT RECORD IF A LIST OF RECORDS ARE BEING PROCESSED*04592075
045930*---------------------------------------------------------------- 04593075
045940 1130A-GET-NEXT-RECORD.                                           04594076
045950     ADD +1                        TO ASC-SEL-SUB.                04595075
045960                                                                  04596075
045970     SET ASC-UPDATE-TSQ TO TRUE.                                  04597075
045980                                                                  04598075
045990     IF  ASC-SEL-SUB > CN019-MAX-ITEMS                            04599075
045991         ADD +1                    TO ASC-SEL-ITEM                04599175
045992         MOVE +1                   TO ASC-SEL-SUB                 04599275
045993     END-IF.                                                      04599375
045994                                                                  04599475
045995     IF  ASC-SEL-ITEM NOT > ASC-NUMBER-OF-TS-ITEMS                04599575
045996         PERFORM 9100A-READ-SEL-QUEUE                             04599679
045997         IF  CN021-ITEM (ASC-SEL-SUB) > ZERO                      04599779
045998             IF  ASC-UPD-PARM                                     04599887
046000                 MOVE CN021-OPER-UNIT(ASC-SEL-SUB)                04600087
046001                       TO ASC-PM-LOC-ID-N                         04600175
046002                 MOVE CN021-SYS-INTFC(ASC-SEL-SUB)                04600287
046003                       TO ASC-PM-INTFC-SYS-CDE                    04600375
046004                 MOVE CN021-STATUS   (ASC-SEL-SUB)                04600487
046005                       TO ASC-PM-FUNC-PRC-STAT-CDE                04600575
046006                 MOVE CN021-FROM-TMST(ASC-SEL-SUB)                04600687
046007                       TO ASC-PM-FUNC-BEG-TMST                    04600775
046008                 MOVE CN021-FROM-TMST-NULL(ASC-SEL-SUB)           04600899
046009                       TO ASC-PM-FUNC-BEG-TMST-NULL               04600999
046010                 MOVE CN021-TO-TMST  (ASC-SEL-SUB)                04601087
046011                       TO ASC-PM-FUNC-END-TMST                    04601175
046012                 MOVE CN021-TO-TMST-NULL  (ASC-SEL-SUB)           04601299
046013                       TO ASC-PM-FUNC-END-TMST-NULL               04601399
046014                 MOVE CN021-FUNC-QTY (ASC-SEL-SUB)                04601487
046015                       TO ASC-PM-FUNC-QTY-N                       04601575
046016                 MOVE CN021-FUNC-QTY-NULL (ASC-SEL-SUB)           04601699
046017                       TO ASC-PM-FUNC-QTY-NULL                    04601799
046018                 MOVE CN021-FUNC-PCNT(ASC-SEL-SUB)                04601887
046019                       TO ASC-PM-FUNC-PCT-N                       04601999
046020                 MOVE CN021-FUNC-PCNT-NULL(ASC-SEL-SUB)           04602099
046021                       TO ASC-PM-FUNC-PCT-NULL                    04602199
046026                 MOVE CN021-FUNC-TEXT(ASC-SEL-SUB)                04602687
046027                       TO ASC-PM-FUNC-TXT                         04602775
046028                 MOVE CN021-FUNC-TEXT-NULL(ASC-SEL-SUB)           04602899
046029                       TO ASC-PM-FUNC-TXT-NULL                    04602999
046030                 MOVE CN021-FUNC-WD  (ASC-SEL-SUB)                04603087
046031                       TO ASC-PM-FUNC-WD-QTY-N                    04603175
046032                 MOVE CN021-FUNC-DPTH(ASC-SEL-SUB)                04603287
046033                       TO ASC-PM-FUNC-DPTH-QTY-N                  04603375
046034                 MOVE CN021-FUNC-HT  (ASC-SEL-SUB)                04603487
046035                       TO ASC-PM-FUNC-HT-QTY-N                    04603575
046036                 MOVE CN021-FUNC-WT  (ASC-SEL-SUB)                04603687
046037                       TO ASC-PM-FUNC-WT-QTY-N                    04603775
046038             ELSE                                                 04603887
046039                 MOVE CN021-SYS-INTFC(ASC-SEL-SUB)                04603989
046040                       TO ASC-PM-INTFC-SYS-CDE                    04604089
046041                 MOVE CN021-STATUS   (ASC-SEL-SUB)                04604189
046042                       TO ASC-PM-FUNC-PRC-STAT-CDE                04604289
046043                 MOVE ZEROES  TO ASC-PM-LOC-ID-N                  04604387
046044                                 ASC-PM-FUNC-QTY-N                04604487
046045                                 ASC-PM-FUNC-PCT-N                04604587
046046                                 ASC-PM-FUNC-WD-QTY-N             04604688
046047                                 ASC-PM-FUNC-DPTH-QTY-N           04604788
046048                                 ASC-PM-FUNC-HT-QTY-N             04604888
046049                                 ASC-PM-FUNC-WT-QTY-N             04604988
046050                 MOVE SPACES  TO ASC-PM-FUNC-TXT                  04605089
046051                 MOVE PC-DEFAULT-BEG-TMST                         04605187
046052                              TO ASC-PM-FUNC-BEG-TMST             04605287
046053                 MOVE PC-DEFAULT-END-TMST                         04605387
046054                              TO ASC-PM-FUNC-END-TMST             04605487
046058                                                                  04605899
046063                 MOVE -1      TO ASC-PM-FUNC-QTY-NULL             04606399
046067                                 ASC-PM-FUNC-PCT-NULL             04606799
046071                                 ASC-PM-FUNC-TXT-NULL             04607199
046072             END-IF                                               04607287
046073             SET  CN021-INQ (ASC-SEL-SUB) TO TRUE                 04607387
046074             PERFORM 9200A-REWRITE-SEL-QUEUE                      04607476
046075         ELSE                                                     04607575
046076             SUBTRACT +1 FROM ASC-SEL-SUB                         04607675
046077             MOVE PC-TSYMSG-00070  TO DP020-MSG-NUMBER            04607775
046078             SET DP020-MSG-INFORMATIONAL                          04607875
046079                 PS-LIST-END       TO TRUE                        04607975
046080         END-IF                                                   04608075
046081     ELSE                                                         04608175
046082         SUBTRACT +1 FROM ASC-SEL-ITEM                            04608275
046083         MOVE CN021-MAX-ITEMS      TO ASC-SEL-SUB                 04608375
046084         MOVE PC-TSYMSG-00070      TO DP020-MSG-NUMBER            04608475
046085         SET DP020-MSG-INFORMATIONAL                              04608575
046086                 PS-LIST-END       TO TRUE                        04608675
046087     END-IF.                                                      04608775
046088                                                                  04608875
046090******************************************************************04609004
046100*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         04610004
046200*  PROCESSED.                                                     04620004
046300******************************************************************04630004
046400 1140-GET-PREV-RECORD.                                            04640004
046500     SUBTRACT +1 FROM ASC-SEL-SUB.                                04650004
046600                                                                  04660004
046700     IF  ASC-SEL-SUB < +1                                         04670004
046800         SUBTRACT +1 FROM ASC-SEL-ITEM                            04680004
046900         MOVE CN019-MAX-ITEMS      TO ASC-SEL-SUB                 04690075
047000     END-IF.                                                      04700004
047100                                                                  04710004
047200     IF  ASC-SEL-ITEM > ZERO                                      04720004
047300         PERFORM 9100-READ-SEL-QUEUE                              04730004
047400         IF  CN019-ITEM (ASC-SEL-SUB) > ZERO                      04740075
047401             MOVE CN019-FUNC-CODE(ASC-SEL-SUB) TO ASC-PARM-CODE   04740179
047402             MOVE CN019-FUNC-DESC(ASC-SEL-SUB) TO ASC-PARM-DESC   04740279
047403             MOVE CN019-FUNC-TYPE(ASC-SEL-SUB) TO ASC-PARM-TYPE   04740379
047506             SET  CN019-INQ (ASC-SEL-SUB) TO TRUE                 04750675
047800         END-IF                                                   04780004
047900                                                                  04790004
048000         SET CN019-INQ (ASC-SEL-SUB) TO TRUE                      04800075
048100         PERFORM 9200-REWRITE-SEL-QUEUE                           04810004
048200     ELSE                                                         04820004
048300         MOVE +1                   TO ASC-SEL-ITEM                04830004
048400                                      ASC-SEL-SUB                 04840004
048500         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            04850004
048600         SET DP020-MSG-INFORMATIONAL                              04860004
048700             PS-LIST-END             TO TRUE                      04870004
048800     END-IF.                                                      04880004
048900                                                                  04890004
048910******************************************************************04891075
048920*  GET THE PREVIOUS RECORD IF A LIST OF RECORDS ARE BEING         04892075
048930*  PROCESSED.                                                     04893075
048940******************************************************************04894075
048950 1140A-GET-PREV-RECORD.                                           04895076
048960     SUBTRACT +1 FROM ASC-SEL-SUB.                                04896075
048970                                                                  04897075
048980     IF  ASC-SEL-SUB < +1                                         04898075
048990         SUBTRACT +1 FROM ASC-SEL-ITEM                            04899075
048991         MOVE CN021-MAX-ITEMS      TO ASC-SEL-SUB                 04899175
048992     END-IF.                                                      04899275
048993                                                                  04899375
048994     IF  ASC-SEL-ITEM > ZERO                                      04899475
048995         PERFORM 9100A-READ-SEL-QUEUE                             04899576
048996         IF  CN021-ITEM (ASC-SEL-SUB) > ZERO                      04899675
048997             IF  ASC-UPD-PARM                                     04899787
048998                 MOVE CN021-OPER-UNIT(ASC-SEL-SUB)                04899887
048999                       TO ASC-PM-LOC-ID-N                         04899975
049000                 MOVE CN021-SYS-INTFC(ASC-SEL-SUB)                04900087
049001                       TO ASC-PM-INTFC-SYS-CDE                    04900175
049002                 MOVE CN021-STATUS   (ASC-SEL-SUB)                04900287
049003                       TO ASC-PM-FUNC-PRC-STAT-CDE                04900375
049004                 MOVE CN021-FROM-TMST(ASC-SEL-SUB)                04900487
049005                       TO ASC-PM-FUNC-BEG-TMST                    04900575
049006                 MOVE CN021-TO-TMST  (ASC-SEL-SUB)                04900687
049007                       TO ASC-PM-FUNC-END-TMST                    04900775
049008                 MOVE CN021-FUNC-QTY (ASC-SEL-SUB)                04900887
049009                       TO ASC-PM-FUNC-QTY-N                       04900975
049010                 MOVE CN021-FUNC-PCNT(ASC-SEL-SUB)                04901087
049011                       TO ASC-PM-FUNC-PCT-N                       04901175
049012                 MOVE CN021-FUNC-TEXT(ASC-SEL-SUB)                04901287
049013                       TO ASC-PM-FUNC-TXT                         04901375
049014                 MOVE CN021-FUNC-WD  (ASC-SEL-SUB)                04901487
049015                       TO ASC-PM-FUNC-WD-QTY-N                    04901575
049016                 MOVE CN021-FUNC-DPTH(ASC-SEL-SUB)                04901687
049017                       TO ASC-PM-FUNC-DPTH-QTY-N                  04901775
049018                 MOVE CN021-FUNC-HT  (ASC-SEL-SUB)                04901887
049019                       TO ASC-PM-FUNC-HT-QTY-N                    04901975
049020                 MOVE CN021-FUNC-WT  (ASC-SEL-SUB)                04902087
049021                       TO ASC-PM-FUNC-WT-QTY-N                    04902175
049022             ELSE                                                 04902287
049023                 MOVE CN021-SYS-INTFC(ASC-SEL-SUB)                04902389
049024                       TO ASC-PM-INTFC-SYS-CDE                    04902489
049025                 MOVE CN021-STATUS   (ASC-SEL-SUB)                04902589
049026                       TO ASC-PM-FUNC-PRC-STAT-CDE                04902689
049027                 MOVE ZEROES  TO ASC-PM-LOC-ID-N                  04902787
049028                                 ASC-PM-FUNC-QTY-N                04902887
049029                                 ASC-PM-FUNC-PCT-N                04902987
049030                                 ASC-PM-FUNC-WD-QTY-N             04903088
049031                                 ASC-PM-FUNC-DPTH-QTY-N           04903188
049032                                 ASC-PM-FUNC-HT-QTY-N             04903288
049033                                 ASC-PM-FUNC-WT-QTY-N             04903388
049036                 MOVE SPACES  TO ASC-PM-FUNC-TXT                  04903689
049037                 MOVE PC-DEFAULT-BEG-TMST                         04903787
049038                              TO ASC-PM-FUNC-BEG-TMST             04903887
049039                 MOVE PC-DEFAULT-END-TMST                         04903987
049040                              TO ASC-PM-FUNC-END-TMST             04904087
049041                                                                  04904199
049042                 MOVE -1      TO ASC-PM-FUNC-QTY-NULL             04904299
049043                                 ASC-PM-FUNC-PCT-NULL             04904399
049044                                 ASC-PM-FUNC-TXT-NULL             04904499
049045             END-IF                                               04904587
049046             SET  CN021-INQ (ASC-SEL-SUB) TO TRUE                 04904675
049047         END-IF                                                   04904775
049048                                                                  04904875
049049         SET CN021-INQ (ASC-SEL-SUB) TO TRUE                      04904975
049050         PERFORM 9200A-REWRITE-SEL-QUEUE                          04905076
049051     ELSE                                                         04905175
049052         MOVE +1                   TO ASC-SEL-ITEM                04905275
049053                                      ASC-SEL-SUB                 04905375
049054         MOVE PC-TSYMSG-00069      TO DP020-MSG-NUMBER            04905475
049055         SET DP020-MSG-INFORMATIONAL                              04905575
049056             PS-LIST-END             TO TRUE                      04905675
049057     END-IF.                                                      04905775
049058                                                                  04905875
049060*----------------------------------------------------------------*04906004
049100* DO ANY PROCESSING FOR KEYS FOR WHICH NO EDITTING OF THE DATA   *04910004
049200* ON THE SCREEN NEEDS TO BE DONE.  IF ONE OF THOSE KEYS IS NOT   *04920004
049300* USED, EDIT THE DATA ON THE SCREEN AND GO ON TO CHECK THE REST  *04930004
049400* OF THE FUNCTION KEYS.  NOTE THAT WITH THE API, NO INVALID      *04940004
049500* FUNCTION KEYS CAN GET THIS FAR.                                *04950004
049600*----------------------------------------------------------------*04960004
049700 2000-PROCESS-PANEL.                                              04970004
049800                                                                  04980004
049900     EVALUATE TRUE                                                04990004
050000                                                                  05000004
050100         WHEN DP020-SRC-AID = DP016-CLEAR                         05010004
050200             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05020004
050300             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05030004
050400                                                                  05040004
050500*F5 REFRESH -                                                     05050004
050600         WHEN DP020-FK-REFRESH(DP020-SRC-AID)                     05060004
050700              SET  ASC-F2-CONFIRM-NO     TO  TRUE                 05070004
050800              PERFORM 4000-BUILD-INITIAL-PANEL                    05080004
050900              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                05090004
051000              PERFORM 3200-RESET-ATTRIBUTES                       05100004
051100                                                                  05110004
051110*ENTER - AFTER INSERT SUCCESSFUL                                  05111099
051111         WHEN DP020-SRC-AID = DP016-ENTER  AND                    05111199
051112              ASC-TKRPRPM-INSERTED                                05111299
051130                  SET  ASC-F2-CONFIRM-NO                          05113099
051131                       ASC-TKRPRPM-NOT-INSERTED  TO  TRUE         05113199
051132                  MOVE SPACES                TO  ASC-PM-LOC-ID    05113299
051133                                                 ASC-PM-LOC-NAME  05113399
051140                  PERFORM 4000-BUILD-INITIAL-PANEL                05114099
051150                  PERFORM 4400-MOVE-COMMAREA-TO-SCREEN            05115099
051160                  PERFORM 3200-RESET-ATTRIBUTES                   05116099
051170                                                                  05117099
051200*F20-NEXT SEL                                                     05120004
051300         WHEN DP020-FK-NEXT-SELECTION (DP020-SRC-AID)             05130004
051400              MOVE DP020-INT-APPL-FORMAT-IND                      05140075
051500                                      TO ASC-INT-APPL-FORMAT-IND  05150004
051501              IF  ASC-USE-SELECTION-QUEUE                         05150176
051510                  EVALUATE TRUE                                   05151080
051540                      WHEN ASC-INTER-CODE-LIST-ADD                05154076
051800                          PERFORM 1130-GET-NEXT-RECORD            05180076
051810                      WHEN ASC-INTER-PARM-LIST-ADD                05181076
051820                      WHEN ASC-INTER-PARM-LIST-UPDATE             05182076
051830                          PERFORM 1130A-GET-NEXT-RECORD           05183076
051840                  END-EVALUATE                                    05184076
051850                                                                  05185076
051900                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              05190076
051910                  IF  PS-LIST-END                                 05191076
052100                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        05210076
052200                      SET PS-NO-LIST-END TO TRUE                  05220076
052300                  ELSE                                            05230076
052400                      PERFORM 4000-BUILD-INITIAL-PANEL            05240076
052500                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        05250076
052600                      PERFORM 3200-RESET-ATTRIBUTES               05260076
052700                  END-IF                                          05270076
052800              ELSE                                                05280076
052900*                --- BOTTOM OF LIST ---                           05290004
053000                     MOVE PC-TSYMSG-00070 TO DP020-MSG-NUMBER     05300075
053100                     SET DP020-MSG-INFORMATIONAL TO TRUE          05310075
053610              END-IF                                              05361075
053700                                                                  05370004
053800*F19-PREV SEL                                                     05380004
053900         WHEN DP020-FK-PREV-SELECTION (DP020-SRC-AID)             05390004
054000              MOVE DP020-INT-APPL-FORMAT-IND                      05400075
054100                                      TO ASC-INT-APPL-FORMAT-IND  05410004
054110              IF  ASC-USE-SELECTION-QUEUE                         05411076
054120                  EVALUATE TRUE                                   05412080
054130                      WHEN ASC-INTER-CODE-LIST-ADD                05413076
054140                          PERFORM 1140-GET-PREV-RECORD            05414076
054150                      WHEN ASC-INTER-PARM-LIST-ADD                05415076
054160                      WHEN ASC-INTER-PARM-LIST-UPDATE             05416076
054170                          PERFORM 1140A-GET-PREV-RECORD           05417076
054180                  END-EVALUATE                                    05418076
054190                                                                  05419076
054500                  PERFORM 3000-EDIT-DATA-IN-COMMAREA              05450076
054600                  IF  PS-LIST-END                                 05460076
054700                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        05470076
054800                      SET PS-NO-LIST-END TO TRUE                  05480076
054900                  ELSE                                            05490076
055000                      PERFORM 4000-BUILD-INITIAL-PANEL            05500076
055100                      PERFORM 4400-MOVE-COMMAREA-TO-SCREEN        05510076
055200                      PERFORM 3200-RESET-ATTRIBUTES               05520076
055300                  END-IF                                          05530076
055400              ELSE                                                05540076
055500                  MOVE PC-TSYMSG-00069 TO DP020-MSG-NUMBER        05550076
055600                  SET DP020-MSG-INFORMATIONAL TO TRUE             05560076
055700              END-IF                                              05570076
056210                                                                  05621075
056300         WHEN OTHER                                               05630004
056400             PERFORM 2200-MOVE-SCREEN-TO-COMMAREA                 05640004
056500             PERFORM 3200-RESET-ATTRIBUTES                        05650004
056600             PERFORM 3000-EDIT-DATA-IN-COMMAREA                   05660004
056700             IF PS-NO-ERROR                                       05670004
056800                 PERFORM 4500-MOVE-COMMAREA-TO-TEMP               05680004
056900                 PERFORM 2100-CHECK-FUNCTION-KEY                  05690004
057000                 IF PS-NO-ERROR                                   05700004
057100                     PERFORM 4400-MOVE-COMMAREA-TO-SCREEN         05710004
057200                     SET DP030-CONTINUE-GO TO TRUE                05720004
057300                 ELSE                                             05730004
057400                     SET DP030-OVERRIDE-GO TO TRUE                05740004
057500                 END-IF                                           05750004
057600             ELSE                                                 05760004
057700                 SET DP030-OVERRIDE-GO TO TRUE                    05770004
057800             END-IF                                               05780004
057900     END-EVALUATE.                                                05790004
058000                                                                  05800004
058100*----------------------------------------------------------------*05810004
058200* ACT ON ANY FUNCTION KEYS THAT REQUIRE EDITS TO BE PASSED       *05820004
058300* FIRST.  NOTE THAT INVALID FUNCTION KEYS WILL NOT BE RETURNED   *05830004
058400* FROM THE CICS ARCHITECTURE API.                                *05840004
058500*----------------------------------------------------------------*05850004
058600 2100-CHECK-FUNCTION-KEY.                                         05860004
058700     EVALUATE TRUE                                                05870004
058800         WHEN DP020-SRC-AID = DP016-ENTER                         05880004
058900             PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                 05890004
059000                                                                  05900004
059100*-F02 = CONFIRM UPDATE                                            05910004
059200         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID)  AND              05920004
059300              ASC-F2-CONFIRM-YES                                  05930004
059301                                                                  05930175
059302              EVALUATE TRUE                                       05930275
059310                  WHEN ASC-INTER-CODE-LIST-ADD                    05931075
059400                       IF  ASC-ACTION-SW = 'UPD'                  05940075
059500                           PERFORM 9100-READ-SEL-QUEUE            05950075
059600                           SET CN019-UPD (ASC-SEL-SUB) TO TRUE    05960079
059700                           MOVE ASC-PARM-CODE                     05970075
059800                                  TO CN019-FUNC-CODE (ASC-SEL-SUB)05980079
059900                           MOVE ASC-PARM-DESC                     05990075
060000                                  TO CN019-FUNC-DESC (ASC-SEL-SUB)06000079
060100                           MOVE ASC-PARM-TYPE                     06010075
060200                                  TO CN019-FUNC-TYPE (ASC-SEL-SUB)06020079
060300                           PERFORM 9200-REWRITE-SEL-QUEUE         06030075
060400                       END-IF                                     06040075
060500                                                                  06050004
060520                 WHEN  ASC-INTER-PARM-LIST-ADD                    06052075
060530                 WHEN  ASC-INTER-PARM-LIST-UPDATE                 06053075
060540                       IF  ASC-ACTION-SW = 'UPD'                  06054075
060550                           PERFORM 9100A-READ-SEL-QUEUE           06055076
060560                           SET CN021-UPD (ASC-SEL-SUB) TO TRUE    06056079
060570                           MOVE ASC-PM-LOC-ID-N                   06057081
060590                                 TO  CN021-OPER-UNIT (ASC-SEL-SUB)06059081
060591                           MOVE ASC-PM-INTFC-SYS-CDE              06059181
060592                                 TO  CN021-SYS-INTFC (ASC-SEL-SUB)06059281
060593                           MOVE ASC-PM-FUNC-PRC-STAT-CDE          06059381
060594                                 TO  CN021-STATUS    (ASC-SEL-SUB)06059481
060595                           MOVE ASC-PM-FUNC-BEG-TMST              06059581
060596                                 TO  CN021-FROM-TMST (ASC-SEL-SUB)06059681
060597                           MOVE ASC-PM-FUNC-END-TMST              06059781
060598                                 TO  CN021-TO-TMST   (ASC-SEL-SUB)06059881
060599                           MOVE ASC-PM-FUNC-QTY-N                 06059981
060600                                 TO  CN021-FUNC-QTY  (ASC-SEL-SUB)06060081
060601                           MOVE ASC-PM-FUNC-PCT-N                 06060181
060602                                 TO  CN021-FUNC-PCNT (ASC-SEL-SUB)06060281
060603                           MOVE ASC-PM-FUNC-TXT                   06060381
060604                                 TO  CN021-FUNC-TEXT (ASC-SEL-SUB)06060481
060605                           MOVE ASC-PM-FUNC-WD-QTY-N              06060581
060606                                 TO  CN021-FUNC-WD   (ASC-SEL-SUB)06060681
060607                           MOVE ASC-PM-FUNC-DPTH-QTY-N            06060781
060608                                 TO  CN021-FUNC-DPTH (ASC-SEL-SUB)06060881
060609                           MOVE ASC-PM-FUNC-HT-QTY-N              06060981
060610                                 TO  CN021-FUNC-HT   (ASC-SEL-SUB)06061081
060611                           MOVE ASC-PM-FUNC-WT-QTY-N              06061181
060620                                 TO  CN021-FUNC-WT   (ASC-SEL-SUB)06062081
060641                           PERFORM 9200A-REWRITE-SEL-QUEUE        06064176
060642                       END-IF                                     06064275
060643                                                                  06064375
060644              END-EVALUATE                                        06064476
060645                                                                  06064576
060646              IF  PS-NO-ERROR                                     06064676
060647                  PERFORM 5100-PROCESS-UPDATE                     06064776
060648                  IF  PS-NO-ERROR                                 06064876
060649                      PERFORM 2110-PREPARE-INTER-APPL-COMM        06064976
060650                  END-IF                                          06065076
060651              END-IF                                              06065176
060660                                                                  06066075
061200                                                                  06120004
061300*-F13 = ADD PARM - TKRPRPM                                        06130021
061400         WHEN DP020-FK-LOCAL-FUNC-01 (DP020-SRC-AID)              06140004
061500                                                                  06150038
061700            SET  PS-FUNCTION-NOT-ALLOWED  TO  TRUE                06170099
061800            MOVE 'CNAPARM '              TO DP008-FUNCTION-NAME   06180099
061900            PERFORM 2105-RACF-ACCESS                              06190099
062000            IF  PS-FUNCTION-ALLOWED                               06200099
062100                CONTINUE                                          06210099
062200            ELSE                                                  06220099
062300                SET PS-ERROR                                      06230099
062400                    DP020-MSG-FATAL         TO TRUE               06240099
062500                MOVE PC-TSYMSG-03724        TO DP020-MSG-NUMBER   06250099
062600                MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA             06260099
062700                MOVE DP015-RED              TO AOPERC             06270099
062800                MOVE DP015-REVERSE          TO AOPERH             06280099
062900                MOVE -1                     TO AOPERL             06290099
063000                SET DP030-SET-CURSOR-APPL-1 TO TRUE               06300099
063100            END-IF                                                06310099
063200                                                                  06320099
065120           IF  PS-NO-ERROR                                        06512004
065121               EVALUATE TRUE                                      06512199
065130                   WHEN ASC-ALL-DC                                06513099
065131                        PERFORM 5000-PROCESS-ADD-DC-ONLY          06513199
065133                   WHEN ASC-ALL-EFC                               06513399
065134                        PERFORM 5000-PROCESS-ADD-EFC-ONLY         06513499
065135                   WHEN ASC-DC-AND-EFC                            06513599
065136                        PERFORM 5000-PROCESS-ADD-DC-EFC           06513699
065140                   WHEN OTHER                                     06514099
065200                        PERFORM 5000-PROCESS-ADD                  06520099
065201               END-EVALUATE                                       06520199
065210                                                                  06521099
065300               IF  PS-NO-ERROR                                    06530004
065400                   PERFORM 2110-PREPARE-INTER-APPL-COMM           06540004
065500                   MOVE DP015-PRO-NOR-OFF        TO AOPERA        06550020
065600                                                    ASYSA         06560020
065700                                                    ASTATA        06570020
065710                                                    ABYEARA       06571020
065720                                                    ABMNTHA       06572020
065730                                                    ABDAYA        06573020
065740                                                    ABHOURA       06574020
065750                                                    ABMINA        06575020
065760                                                    ABSECA        06576020
065770                                                    ABMSECA       06577020
065771                                                    AEYEARA       06577120
065772                                                    AEMNTHA       06577220
065773                                                    AEDAYA        06577320
065774                                                    AEHOURA       06577420
065775                                                    AEMINA        06577520
065776                                                    AESECA        06577620
065777                                                    AEMSECA       06577720
065780                                                    AQTYA         06578020
065790                                                    APCNTA        06579020
065791                                                    ATEXTA        06579120
065792                                                    AFQTYA        06579220
065793                                                    AFDEPA        06579320
065794                                                    AFHGTA        06579420
065795                                                    AFWGTA        06579520
065850                   MOVE DP015-BLUE               TO AOPERC        06585020
065860                                                    ASYSC         06586020
065870                                                    ASTATC        06587020
065880                                                    ABYEARC       06588020
065890                                                    ABMNTHC       06589020
065891                                                    ABDAYC        06589120
065892                                                    ABHOURC       06589220
065893                                                    ABMINC        06589320
065894                                                    ABSECC        06589420
065895                                                    ABMSECC       06589520
065896                                                    AEYEARC       06589620
065897                                                    AEMNTHC       06589720
065898                                                    AEDAYC        06589820
065899                                                    AEHOURC       06589920
065900                                                    AEMINC        06590020
065901                                                    AESECC        06590120
065902                                                    AEMSECC       06590220
065903                                                    AQTYC         06590320
065904                                                    APCNTC        06590420
065905                                                    ATEXTC        06590520
065906                                                    AFQTYC        06590620
065907                                                    AFDEPC        06590720
065908                                                    AFHGTC        06590820
065909                                                    AFWGTC        06590920
066100                   MOVE DP015-HL-OFF             TO AOPERH        06610020
066110                                                    ASYSH         06611020
066120                                                    ASTATH        06612020
066130                                                    ABYEARH       06613020
066140                                                    ABMNTHH       06614020
066150                                                    ABDAYH        06615020
066160                                                    ABHOURH       06616020
066170                                                    ABMINH        06617020
066180                                                    ABSECH        06618020
066190                                                    ABMSECH       06619020
066191                                                    AEYEARH       06619120
066192                                                    AEMNTHH       06619220
066193                                                    AEDAYH        06619320
066194                                                    AEHOURH       06619420
066195                                                    AEMINH        06619520
066196                                                    AESECH        06619620
066197                                                    AEMSECH       06619720
066198                                                    AQTYH         06619820
066199                                                    APCNTH        06619920
066200                                                    ATEXTH        06620020
066201                                                    AFQTYH        06620120
066202                                                    AFDEPH        06620220
066203                                                    AFHGTH        06620320
066204                                                    AFWGTH        06620420
066400               END-IF                                             06640004
066500           END-IF                                                 06650004
066600                                                                  06660004
066700*-F15 = UPDATE PARM - TKRPRPM                                     06670021
066800         WHEN DP020-FK-LOCAL-FUNC-03 (DP020-SRC-AID)              06680027
066900              SET ASC-F2-CONFIRM-NO TO TRUE                       06690004
067000                                                                  06700099
067100              SET  PS-FUNCTION-NOT-ALLOWED  TO  TRUE              06710099
067200              MOVE 'CNUPARM '              TO DP008-FUNCTION-NAME 06720099
067300              PERFORM 2105-RACF-ACCESS                            06730099
067400              IF  PS-FUNCTION-ALLOWED                             06740099
067500                  CONTINUE                                        06750099
067600              ELSE                                                06760099
067700                  SET PS-ERROR                                    06770099
067800                      DP020-MSG-FATAL         TO TRUE             06780099
067900                  MOVE PC-TSYMSG-02612        TO DP020-MSG-NUMBER 06790099
068000                  MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA           06800099
068100                  MOVE DP015-RED              TO AOPERC           06810099
068200                  MOVE DP015-REVERSE          TO AOPERH           06820099
068300                  MOVE -1                     TO AOPERL           06830099
068400                  SET DP030-SET-CURSOR-APPL-1 TO TRUE             06840099
068500              END-IF                                              06850099
068600                                                                  06860099
070670                                                                  07067034
070700             IF  PS-NO-ERROR                                      07070004
070800                 SET ASC-F2-CONFIRM-YES      TO TRUE              07080004
070900                 SET PS-ERROR                TO TRUE              07090004
071000                 SET DP020-MSG-FATAL         TO TRUE              07100004
071100                 MOVE PC-TSYMSG-00004        TO DP020-MSG-NUMBER  07110085
071200                 MOVE DP015-PRO-NOR-OFF      TO AOPERA            07120021
071300                 MOVE DP015-BLUE             TO AOPERC            07130021
071400                 MOVE -1                     TO AOPERL            07140021
071500                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              07150004
071600            END-IF                                                07160004
071700                                                                  07170004
072200*F24  = PARM LIST - (CNKCS237)                                    07220004
072300         WHEN DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)              07230027
073400                                                                  07340004
074700              IF  PS-NO-ERROR                                     07470004
075200                   PERFORM 2110-PREPARE-INTER-APPL-COMM           07520021
075500              END-IF                                              07550004
075600              PERFORM 4400-MOVE-COMMAREA-TO-SCREEN                07560004
075700                                                                  07570004
075800         WHEN DP020-FK-CONFIRM  (DP020-SRC-AID) AND               07580004
075900              ASC-F2-CONFIRM-NO                                   07590004
076000                  MOVE PC-TSYMSG-00045 TO DP020-MSG-NUMBER        07600004
076100                  SET DP020-MSG-FATAL TO TRUE                     07610004
076200                                                                  07620004
076300         WHEN OTHER                                               07630004
076400              SET DP013-NO-ROLLBACK                               07640004
076500                  DP013-XCTL-DISPLAY-RESTART                      07650004
076600                  DP013-CICS-ABEND      TO TRUE                   07660004
076700              MOVE '2000-PROCESS-PANEL' TO DP013-PARAGRAPH        07670004
076800              MOVE 'INVALID FUNCTION KEY NOT CAPTURED BY API'     07680004
076900                                    TO DP013-MESSAGE-TEXT (1)     07690004
077000              PERFORM DP013-0000-PROCESS-ABEND                    07700004
077100                                                                  07710004
077200     END-EVALUATE.                                                07720004
077300                                                                  07730004
077301                                                                  07730199
077310*----------------------------------------------------------------*07731099
077320* CHECK TO SEE IF USER HAS RACF AUTHORIZATION FOR FUNCTION       *07732099
077330*----------------------------------------------------------------*07733099
077340 2105-RACF-ACCESS.                                                07734099
077350                                                                  07735099
077360      SET DP008-RSRC-TYPE-FUNC           TO TRUE                  07736099
077370      SET DP008-ACCESS-TYPE-USE          TO TRUE                  07737099
077380                                                                  07738099
077390      EXEC CICS                                                   07739099
077391         LINK PROGRAM (DP008-SECURITY-SUBROUTINE)                 07739199
077392              COMMAREA (DP008-SECURITY-COMMAREA)                  07739299
077393              LENGTH (DP008-SECURITY-COMMAREA-LENGTH)             07739399
077394      END-EXEC                                                    07739499
077395                                                                  07739599
077396      IF DP008-CALL-SUCCESSFUL                                    07739699
077397         IF DP008-ACCESS-ALLOWED                                  07739799
077398             SET PS-FUNCTION-ALLOWED TO TRUE                      07739899
077399         ELSE                                                     07739999
077400             SET PS-FUNCTION-NOT-ALLOWED TO TRUE                  07740099
077401         END-IF                                                   07740199
077402     ELSE                                                         07740299
077403         MOVE '2105-RACF-ACCESS'                                  07740399
077404                               TO DP013-PARAGRAPH                 07740499
077405          MOVE 'UNABLE TO ACCESS CICS'                            07740599
077406                               TO DP013-MESSAGE-TEXT (1)          07740699
077407          MOVE SQLCA                 TO DP013-SQLCA               07740799
077408          SET DP013-DB2-ABEND                                     07740899
077409              DP013-XCTL-DISPLAY-RESTART                          07740999
077410                               TO TRUE                            07741099
077411          PERFORM DP013-0000-PROCESS-ABEND                        07741199
077412      END-IF.                                                     07741299
077413                                                                  07741399
077414                                                                  07741499
077420******************************************************************07742004
077500** MOVE DATA NECESSARY TO THE DESTINATION PROGRAM(S) INTO THE   **07750004
077600** INTER-APPLICATION COMMAREA.                                  **07760004
077700******************************************************************07770004
077800 2110-PREPARE-INTER-APPL-COMM.                                    07780004
077900                                                                  07790004
078000     INITIALIZE CN014-INTER-APPL-COMMAREA.                        07800004
078100                                                                  07810004
078200     MOVE ASC-FUNCTION             TO CN014-FUNCTION.             07820004
078300     MOVE ASC-PARM-CODE            TO CN014-PARM-NAME.            07830004
078400     MOVE ASC-PARM-DESC            TO CN014-PARM-DESC.            07840004
078500     MOVE ASC-PARM-TYPE            TO CN014-PARM-TYPE.            07850004
078600                                                                  07860004
078700*----------------------------------------------------------------*07870004
078800* MOVE DATA ENTERED ON THE SCREEN INTO THEIR RESPECTIVE FIELDS   *07880004
078900* IN THE APPLICATION-SPECIFIC COMMAREA.  ALL EDITS ARE DONE IN   *07890004
079000* THE APPLICATION-SPECIFIC COMMAERA, NOT ON THE SCREEN.          *07900004
079100* THIS PARAGRAPH DOES NOT USE TEMPORARY VARIABLES.               *07910004
079200*----------------------------------------------------------------*07920004
079300 2200-MOVE-SCREEN-TO-COMMAREA.                                    07930004
079400*OPER                                                             07940021
079500         IF  AOPERL > ZERO                                        07950021
079600             MOVE AOPERI               TO ASC-PM-LOC-ID           07960021
079800         ELSE                                                     07980004
079900             IF  AOPERF = DP015-ERASE-EOF                         07990021
080000                 MOVE ZEROES           TO ASC-PM-LOC-ID           08000021
080100             END-IF                                               08010004
080200         END-IF.                                                  08020004
080300                                                                  08030004
080400*SYSTEM INTERFACE CODE                                            08040021
080500         IF  ASYSL > ZERO                                         08050021
080600             MOVE ASYSI                TO ASC-PM-INTFC-SYS-CDE    08060021
080700         ELSE                                                     08070004
080800             IF  ASYSF = DP015-ERASE-EOF                          08080021
080900                 MOVE SPACES           TO ASC-PM-INTFC-SYS-CDE    08090021
081000             END-IF                                               08100004
081100         END-IF.                                                  08110004
081200                                                                  08120004
081300*STATUS CODE                                                      08130021
081400         IF  ASTATL > ZERO                                        08140021
081500             MOVE ASTATI               TO ASC-PM-FUNC-PRC-STAT-CDE08150021
081600         ELSE                                                     08160004
081700             IF  ASTATF = DP015-ERASE-EOF                         08170021
081800                 MOVE SPACES           TO ASC-PM-FUNC-PRC-STAT-CDE08180021
081900             END-IF                                               08190004
082000         END-IF.                                                  08200004
082100                                                                  08210004
082110*BEGIN TIMESTAMP                                                  08211021
082120         IF  ABYEARL > ZERO                                       08212021
082121             MOVE ABYEARI              TO PV-BEG-YEAR             08212121
082122         ELSE                                                     08212221
082123             IF  ABYEARF = DP015-ERASE-EOF                        08212321
082124                 MOVE 0001             TO PV-BEG-YEAR             08212499
082126             END-IF                                               08212699
082127         END-IF.                                                  08212799
082128                                                                  08212899
082129         IF  ABMNTHL > ZERO                                       08212999
082130             MOVE ABMNTHI              TO PV-BEG-MONTH            08213099
082131         ELSE                                                     08213199
082132             IF  ABMNTHF = DP015-ERASE-EOF                        08213299
082133                 MOVE 01               TO PV-BEG-MONTH            08213399
082134             END-IF                                               08213499
082135         END-IF.                                                  08213599
082136                                                                  08213699
082137         IF  ABDAYL > ZERO                                        08213799
082138             MOVE ABDAYI               TO PV-BEG-DAY              08213899
082139         ELSE                                                     08213999
082140             IF  ABDAYF = DP015-ERASE-EOF                         08214099
082141                 MOVE 01               TO PV-BEG-DAY              08214199
082142             END-IF                                               08214299
082143         END-IF.                                                  08214399
082144                                                                  08214499
082145         IF  ABHOURL > ZERO                                       08214599
082146             MOVE ABHOURI              TO PV-BEG-HOUR             08214699
082147         ELSE                                                     08214799
082148             IF  ABHOURF = DP015-ERASE-EOF                        08214899
082149                 MOVE ZEROES           TO PV-BEG-HOUR             08214999
082150             END-IF                                               08215099
082151         END-IF.                                                  08215199
082152                                                                  08215299
082153         IF  ABMINL > ZERO                                        08215399
082154             MOVE ABMINI               TO PV-BEG-MIN              08215499
082155         ELSE                                                     08215599
082156             IF  ABMINF = DP015-ERASE-EOF                         08215699
082157                 MOVE ZEROES           TO PV-BEG-MIN              08215799
082158             END-IF                                               08215899
082159         END-IF.                                                  08215999
082160                                                                  08216099
082161         IF  ABSECL > ZERO                                        08216199
082162             MOVE ABSECI               TO PV-BEG-SEC              08216299
082163         ELSE                                                     08216399
082164             IF  ABSECF = DP015-ERASE-EOF                         08216499
082165                 MOVE ZEROES           TO PV-BEG-SEC              08216599
082166             END-IF                                               08216699
082167         END-IF.                                                  08216799
082168                                                                  08216899
082169         IF  ABMSECL > ZERO                                       08216999
082170             MOVE ABMSECI              TO PV-BEG-MSEC             08217099
082171         ELSE                                                     08217199
082172             IF  ABMSECF = DP015-ERASE-EOF                        08217299
082173                 MOVE ZEROES           TO PV-BEG-MSEC             08217399
082174             END-IF                                               08217499
082175         END-IF.                                                  08217599
082176                                                                  08217699
082177         MOVE  PV-BEG-TMST             TO ASC-PM-FUNC-BEG-TMST.   08217799
082178                                                                  08217899
082179*END TIMESTAMP                                                    08217999
082180         IF  AEYEARL > ZERO                                       08218099
082181             MOVE AEYEARI              TO PV-END-YEAR             08218199
082182         ELSE                                                     08218299
082183             IF  AEYEARF = DP015-ERASE-EOF                        08218399
082184                 MOVE 9999             TO PV-END-YEAR             08218499
082185             END-IF                                               08218599
082186         END-IF.                                                  08218699
082187                                                                  08218799
082188         IF  AEMNTHL > ZERO                                       08218899
082189             MOVE AEMNTHI              TO PV-END-MONTH            08218999
082190         ELSE                                                     08219099
082191             IF  AEMNTHF = DP015-ERASE-EOF                        08219199
082192                 MOVE 12               TO PV-END-MONTH            08219299
082193             END-IF                                               08219399
082194         END-IF.                                                  08219499
082195                                                                  08219599
082196         IF  AEDAYL > ZERO                                        08219699
082197             MOVE AEDAYI               TO PV-END-DAY              08219799
082198         ELSE                                                     08219899
082199             IF  AEDAYF = DP015-ERASE-EOF                         08219999
082200                 MOVE 31               TO PV-END-DAY              08220099
082201             END-IF                                               08220199
082202         END-IF.                                                  08220299
082203                                                                  08220399
082204         IF  AEHOURL > ZERO                                       08220499
082205             MOVE AEHOURI              TO PV-END-HOUR             08220599
082206         ELSE                                                     08220699
082207             IF  AEHOURF = DP015-ERASE-EOF                        08220799
082208                 MOVE 23               TO PV-END-HOUR             08220899
082209             END-IF                                               08220999
082210         END-IF.                                                  08221099
082211                                                                  08221199
082212         IF  AEMINL > ZERO                                        08221299
082213             MOVE AEMINI               TO PV-END-MIN              08221399
082214         ELSE                                                     08221499
082215             IF  AEMINF = DP015-ERASE-EOF                         08221599
082216                 MOVE 59               TO PV-END-MIN              08221699
082217             END-IF                                               08221799
082218         END-IF.                                                  08221899
082219                                                                  08221999
082220         IF  AESECL > ZERO                                        08222099
082221             MOVE AESECI               TO PV-END-SEC              08222199
082222         ELSE                                                     08222299
082223             IF  AESECF = DP015-ERASE-EOF                         08222399
082224                 MOVE 59               TO PV-END-SEC              08222499
082225             END-IF                                               08222599
082226         END-IF.                                                  08222699
082227                                                                  08222799
082228         IF  AEMSECL > ZERO                                       08222899
082229             MOVE AEMSECI              TO PV-END-MSEC             08222999
082230         ELSE                                                     08223099
082231             IF  AEMSECF = DP015-ERASE-EOF                        08223199
082232                 MOVE 999999           TO PV-END-MSEC             08223299
082233             END-IF                                               08223399
082234         END-IF.                                                  08223499
082235                                                                  08223599
082236         MOVE  PV-END-TMST             TO ASC-PM-FUNC-END-TMST.   08223699
082237                                                                  08223799
082238* FUNCTION QUANTITY                                               08223899
082239         IF  AQTYL > ZERO                                         08223999
082240             MOVE AQTYI                TO  ASC-PM-FUNC-QTY        08224099
082241         ELSE                                                     08224199
082242             IF  AQTYF = DP015-ERASE-EOF                          08224299
082243***              MOVE ZEROES           TO  ASC-PM-FUNC-QTY        08224399
082244                 INITIALIZE                ASC-PM-FUNC-QTY        08224499
082245                 MOVE -1               TO  ASC-PM-FUNC-QTY-NULL   08224599
082246             END-IF                                               08224699
082247         END-IF.                                                  08224799
082248                                                                  08224899
082249* FUNCTION PERCENT                                                08224999
082250         IF  APCNTL > ZERO                                        08225099
082251             MOVE APCNTI               TO  ASC-PM-FUNC-PCT        08225199
082252         ELSE                                                     08225299
082253             IF  APCNTF = DP015-ERASE-EOF                         08225399
082254***              MOVE ZEROES           TO  ASC-PM-FUNC-PCT        08225499
082255                 INITIALIZE                ASC-PM-FUNC-PCT        08225599
082256                 MOVE -1               TO  ASC-PM-FUNC-PCT-NULL   08225699
082257             END-IF                                               08225799
082258         END-IF.                                                  08225899
082259                                                                  08225999
082260* FUNCTION TEXT                                                   08226099
082261         IF  ATEXTL > ZERO                                        08226199
082262             MOVE ATEXTI               TO  ASC-PM-FUNC-TXT        08226299
082263         ELSE                                                     08226399
082264             IF  ATEXTF = DP015-ERASE-EOF                         08226499
082265***              MOVE SPACES           TO  ASC-PM-FUNC-TXT        08226599
082266                 INITIALIZE                ASC-PM-FUNC-TXT        08226699
082267                 MOVE -1               TO  ASC-PM-FUNC-TXT-NULL   08226799
082268             END-IF                                               08226899
082269         END-IF.                                                  08226999
082270                                                                  08227099
082271* FUNCTION WIDTH                                                  08227199
082272         IF  AFQTYL > ZERO                                        08227299
082273             MOVE AFQTYI               TO  ASC-PM-FUNC-WD-QTY     08227399
082274         ELSE                                                     08227499
082275             IF  AFQTYF = DP015-ERASE-EOF                         08227599
082276                 MOVE ZEROES           TO  ASC-PM-FUNC-WD-QTY     08227699
082277             END-IF                                               08227799
082278         END-IF.                                                  08227899
082279                                                                  08227999
082280* FUNCTION DEPTH                                                  08228099
082281         IF  AFDEPL > ZERO                                        08228199
082282             MOVE AFDEPI               TO  ASC-PM-FUNC-DPTH-QTY   08228299
082283         ELSE                                                     08228399
082284             IF  AFDEPF = DP015-ERASE-EOF                         08228499
082285                 MOVE ZEROES           TO  ASC-PM-FUNC-DPTH-QTY   08228599
082286             END-IF                                               08228699
082287         END-IF.                                                  08228799
082288                                                                  08228899
082289* FUNCTION HEIGHT                                                 08228999
082290         IF  AFHGTL > ZERO                                        08229099
082291             MOVE AFHGTI               TO  ASC-PM-FUNC-HT-QTY     08229199
082292         ELSE                                                     08229299
082293             IF  AFHGTF = DP015-ERASE-EOF                         08229399
082294                 MOVE ZEROES           TO  ASC-PM-FUNC-HT-QTY     08229499
082295             END-IF                                               08229599
082296         END-IF.                                                  08229699
082297                                                                  08229799
082298* FUNCTION WEIGHT                                                 08229899
082299         IF  AFWGTL > ZERO                                        08229999
082300             MOVE AFWGTI               TO  ASC-PM-FUNC-WT-QTY     08230099
082301         ELSE                                                     08230199
082302             IF  AFWGTF = DP015-ERASE-EOF                         08230299
082303                 MOVE ZEROES           TO  ASC-PM-FUNC-WT-QTY     08230399
082304             END-IF                                               08230499
082305         END-IF.                                                  08230599
082310                                                                  08231099
082400                                                                  08240099
083037*----------------------------------------------------------------*08303735
083038* PERFORM EDITS ON EACH FIELD ENTERED BY THE USER.  IF AN ERROR  *08303835
083039* IS FOUND, THE CURSOR IS POSITIONED AT THAT FIELD AND AN        *08303935
083040* APPROPRIATE ERROR MESSAGE IS DISPLAYED.                        *08304035
083041*----------------------------------------------------------------*08304135
083042 3000-EDIT-DATA-IN-COMMAREA.                                      08304235
083043                                                                  08304335
083044     PERFORM 3010-REQUIRED-FIELDS.                                08304438
083045                                                                  08304538
083046     IF  PS-NO-ERROR                                              08304638
083047         PERFORM 3015-NUMERIC-EDITS                               08304738
083048     END-IF.                                                      08304838
083049                                                                  08304938
083050     IF  PS-NO-ERROR                                              08305050
083051         EVALUATE TRUE                                            08305150
083052             WHEN ASC-ADD-PARM                                    08305253
083053                  EVALUATE TRUE                                   08305353
083054                      WHEN ASC-ALL-DC                             08305453
083055                           MOVE  'ALL DC  '   TO AOPNAMEO         08305553
083056                                                 ASC-PM-LOC-NAME  08305653
083058                      WHEN ASC-ALL-EFC                            08305853
083059                           MOVE  'ALL EFC '   TO AOPNAMEO         08305953
083060                                                 ASC-PM-LOC-NAME  08306053
083062                      WHEN ASC-DC-AND-EFC                         08306253
083063                           MOVE  'DC AND EFC' TO AOPNAMEO         08306353
083065                                                 ASC-PM-LOC-NAME  08306553
083066                      WHEN OTHER                                  08306660
083067                           PERFORM 3020-VALIDATE-OPER             08306760
083068                  END-EVALUATE                                    08306853
083069             WHEN OTHER                                           08306950
083070                  PERFORM 3020-VALIDATE-OPER                      08307050
083071         END-EVALUATE                                             08307150
083072     END-IF.                                                      08307238
083073                                                                  08307338
083074     IF  DP020-FK-LOCAL-FUNC-02 (DP020-SRC-AID)                   08307499
083075         CONTINUE                                                 08307599
083076     ELSE                                                         08307699
083077         IF  PS-NO-ERROR                                          08307799
083078              PERFORM 3025-VALIDATE-TMST                          08307899
083079         END-IF                                                   08307999
083080     END-IF.                                                      08308099
083081                                                                  08308199
083082     IF  PS-NO-ERROR                                              08308299
083083         IF  ASC-ALL-DC      OR                                   08308399
083084             ASC-ALL-EFC     OR                                   08308499
083085             ASC-DC-AND-EFC                                       08308599
083086             CONTINUE                                             08308699
083087         ELSE                                                     08308799
083090             IF  ASC-PM-LOC-ID  >  ZEROES                         08309099
083100                 PERFORM 3040-CHECK-4-ROW-ON-KRPRPM               08310099
083200             END-IF                                               08320099
083210         END-IF                                                   08321099
083300     END-IF.                                                      08330038
088445                                                                  08844522
088446                                                                  08844638
088447****************************************************************  08844738
088448* CHECK REQUIRED FIELDS                                        *  08844838
088449****************************************************************  08844938
088450 3010-REQUIRED-FIELDS.                                            08845038
088451                                                                  08845138
088452     IF  ASC-PM-LOC-ID  = ZEROES  OR                              08845238
088453         ASC-PM-LOC-ID  = SPACES                                  08845338
088454         SET PS-ERROR                                             08845438
088455             DP020-MSG-FATAL         TO TRUE                      08845538
088456         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08845638
088460         MOVE DP015-UNP-ALP-BRT-OFF  TO AOPERA                    08846038
088470         MOVE DP015-RED              TO AOPERC                    08847038
088480         MOVE DP015-REVERSE          TO AOPERH                    08848038
088490         MOVE -1                     TO AOPERL                    08849038
088491         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08849138
088492     ELSE                                                         08849248
088493         MOVE +1                     TO AOPERL                    08849348
088494     END-IF.                                                      08849438
088495                                                                  08849538
088496     IF  ASC-PM-INTFC-SYS-CDE = SPACES                            08849638
088497         SET PS-ERROR                                             08849738
088498             DP020-MSG-FATAL         TO TRUE                      08849838
088499         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08849938
088500         MOVE DP015-UNP-ALP-BRT-OFF  TO ASYSA                     08850038
088501         MOVE DP015-RED              TO ASYSC                     08850138
088502         MOVE DP015-REVERSE          TO ASYSH                     08850238
088503         MOVE -1                     TO ASYSL                     08850338
088504         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08850438
088505     END-IF.                                                      08850538
088506                                                                  08850638
088507     IF  ASC-PM-FUNC-PRC-STAT-CDE   =  SPACES                     08850738
088508         SET PS-ERROR                                             08850838
088509             DP020-MSG-FATAL         TO TRUE                      08850938
088510         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08851038
088511         MOVE DP015-UNP-ALP-BRT-OFF  TO ASTATA                    08851138
088512         MOVE DP015-RED              TO ASTATC                    08851238
088513         MOVE DP015-REVERSE          TO ASTATH                    08851338
088514         MOVE -1                     TO ASTATL                    08851438
088515         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08851538
088516     END-IF.                                                      08851638
088517                                                                  08851738
088518     IF  ASC-PM-FUNC-PRC-STAT-CDE   >  SPACES AND                 08851899
088519         ASC-VALID-STATUS                                         08851999
088520         CONTINUE                                                 08852099
088521     ELSE                                                         08852199
088522         SET PS-ERROR                                             08852299
088523             DP020-MSG-FATAL         TO TRUE                      08852399
088524         MOVE PC-TSYMSG-00005        TO DP020-MSG-NUMBER          08852499
088525         MOVE DP015-UNP-ALP-BRT-OFF  TO ASTATA                    08852599
088526         MOVE DP015-RED              TO ASTATC                    08852699
088527         MOVE DP015-REVERSE          TO ASTATH                    08852799
088528         MOVE -1                     TO ASTATL                    08852899
088529         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08852999
088530     END-IF.                                                      08853099
088531                                                                  08853199
088532     IF  ASC-PM-FUNC-BEG-TMST  =  SPACES                          08853238
088533         SET PS-ERROR                                             08853338
088534             DP020-MSG-FATAL         TO TRUE                      08853438
088535         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08853538
088536         MOVE DP015-UNP-ALP-BRT-MDT  TO ABYEARA                   08853669
088537                                        ABMNTHA                   08853738
088538                                        ABDAYA                    08853838
088539                                        ABHOURA                   08853938
088540                                        ABMINA                    08854038
088541                                        ABSECA                    08854138
088542                                        ABMSECA                   08854238
088543         MOVE DP015-RED              TO ABYEARC                   08854338
088544                                        ABMNTHC                   08854438
088545                                        ABDAYC                    08854538
088546                                        ABHOURC                   08854638
088547                                        ABMINC                    08854738
088548                                        ABSECC                    08854838
088549                                        ABMSECC                   08854938
088550         MOVE DP015-REVERSE          TO ABYEARH                   08855038
088551                                        ABMNTHH                   08855138
088552                                        ABDAYH                    08855238
088553                                        ABHOURH                   08855338
088554                                        ABMINH                    08855438
088555                                        ABSECH                    08855538
088556                                        ABMSECH                   08855638
088557         MOVE -1                     TO ABYEARL                   08855738
088558         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08855838
088559     END-IF.                                                      08855938
088560                                                                  08856038
088561     IF  ASC-PM-FUNC-END-TMST  =  SPACES                          08856138
088562         SET PS-ERROR                                             08856238
088563             DP020-MSG-FATAL         TO TRUE                      08856338
088564         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08856438
088565         MOVE DP015-UNP-ALP-BRT-OFF  TO AEYEARA                   08856538
088566                                        AEMNTHA                   08856638
088567                                        AEDAYA                    08856738
088568                                        AEHOURA                   08856838
088569                                        AEMINA                    08856938
088570                                        AESECA                    08857038
088571                                        AEMSECA                   08857138
088572         MOVE DP015-RED              TO AEYEARC                   08857238
088573                                        AEMNTHC                   08857338
088574                                        AEDAYC                    08857438
088575                                        AEHOURC                   08857538
088576                                        AEMINC                    08857638
088577                                        AESECC                    08857738
088578                                        AEMSECC                   08857838
088579         MOVE DP015-REVERSE          TO AEYEARH                   08857938
088580                                        AEMNTHH                   08858038
088581                                        AEDAYH                    08858138
088582                                        AEHOURH                   08858238
088583                                        AEMINH                    08858338
088584                                        AESECH                    08858438
088585                                        AEMSECH                   08858538
088586         MOVE -1                     TO AEYEARL                   08858638
088587         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08858738
088588     END-IF.                                                      08858838
088589                                                                  08858938
088590     IF (ASC-PM-FUNC-QTY  =  ZEROES  OR                           08859038
088591         ASC-PM-FUNC-QTY  =  SPACES)  AND                         08859138
088592         ASC-TYPE-QTY                                             08859238
088593         SET PS-ERROR                                             08859338
088594             DP020-MSG-FATAL         TO TRUE                      08859438
088595         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08859538
088596         MOVE DP015-UNP-ALP-BRT-OFF  TO AQTYA                     08859638
088597         MOVE DP015-RED              TO AQTYC                     08859738
088598         MOVE DP015-REVERSE          TO AQTYH                     08859838
088599         MOVE -1                     TO AQTYL                     08859938
088600         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08860038
088601     END-IF.                                                      08860138
088602                                                                  08860238
088603     IF (ASC-PM-FUNC-PCT  =  ZEROES  OR                           08860338
088604         ASC-PM-FUNC-PCT  =  SPACES)   AND                        08860438
088605         ASC-TYPE-PCNT                                            08860538
088606         SET PS-ERROR                                             08860638
088607             DP020-MSG-FATAL         TO TRUE                      08860738
088608         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08860838
088609         MOVE DP015-UNP-ALP-BRT-OFF  TO APCNTA                    08860938
088610         MOVE DP015-RED              TO APCNTC                    08861038
088611         MOVE DP015-REVERSE          TO APCNTH                    08861138
088612         MOVE -1                     TO APCNTL                    08861238
088613         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08861338
088614     END-IF.                                                      08861438
088615                                                                  08861538
088616     IF  ASC-PM-FUNC-TXT  =  SPACES  AND                          08861638
088617         ASC-TYPE-TEXT                                            08861738
088618         SET PS-ERROR                                             08861838
088619             DP020-MSG-FATAL         TO TRUE                      08861938
088620         MOVE PC-TSYMSG-00007        TO DP020-MSG-NUMBER          08862038
088621         MOVE DP015-UNP-ALP-BRT-OFF  TO ATEXTA                    08862138
088622         MOVE DP015-RED              TO ATEXTC                    08862238
088623         MOVE DP015-REVERSE          TO ATEXTH                    08862338
088624         MOVE -1                     TO ATEXTL                    08862438
088625         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08862538
088626     END-IF.                                                      08862638
088627                                                                  08862738
088628                                                                  08862838
088629*----------------------------------------------------------------*08862938
088630* VALIDATE NUMERIC FIELDS ARE NUMERIC                            *08863038
088631*----------------------------------------------------------------*08863138
088632 3015-NUMERIC-EDITS.                                              08863238
088633                                                                  08863338
088634     IF  ASC-PM-LOC-ID  >  SPACES                                 08863438
088635         EVALUATE TRUE                                            08863550
088636             WHEN ASC-ADD-PARM   AND                              08863650
088637                 (ASC-ALL-DC  OR                                  08863750
088638                  ASC-ALL-EFC OR                                  08863850
088640                  ASC-DC-AND-EFC)                                 08864050
088641                     MOVE ASC-PM-LOC-ID        TO AOPERO          08864150
088643             WHEN OTHER                                           08864350
088644                  MOVE ASC-PM-LOC-ID    TO DP010I-UNEDITED-FIELD  08864450
088645                  MOVE LENGTH OF ASC-PM-LOC-ID                    08864550
088646                                   TO DP010I-MAXIMUM-DIGITS       08864650
088647                  MOVE ZERO        TO DP010I-MAXIMUM-DECIMALS     08864750
088648                  SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE         08864850
263455                  CALL DP010I-NUMERIC-EDIT-ROUTINE                08865099
263455                       USING DP010I-NUMERIC-EDIT-AREA             08865199
088650                  IF  DP010I-ERROR-DETECTED                       08865250
088651                      SET PS-ERROR                                08865350
088652                          DP020-MSG-FATAL   TO TRUE               08865450
088653                      MOVE PC-TSYMSG-00008  TO DP020-MSG-NUMBER   08865550
088654                      MOVE DP015-UNP-ALP-BRT-OFF                  08865650
088655                                            TO AOPERA             08865750
088656                      MOVE DP015-RED            TO AOPERC         08865850
088657                      MOVE DP015-REVERSE        TO AOPERH         08865950
088658                      MOVE -1                   TO AOPERL         08866050
088659                      SET DP030-SET-CURSOR-APPL-1 TO TRUE         08866150
088660                  ELSE                                            08866250
088661                      MOVE DP010I-NUMERIC-FIELD TO ASC-PM-LOC-ID-N08866350
088663                  END-IF                                          08866450
088664         END-EVALUATE                                             08866550
088665     END-IF                                                       08866650
088666                                                                  08866750
088667     IF  ASC-PM-FUNC-QTY  >  SPACES                               08866850
088668         MOVE ASC-PM-FUNC-QTY          TO DP010I-UNEDITED-FIELD   08866950
088669         MOVE LENGTH OF ASC-PM-FUNC-QTY                           08867050
088670                                       TO DP010I-MAXIMUM-DIGITS   08867150
088671         MOVE 0                        TO DP010I-MAXIMUM-DECIMALS 08867299
088672         SET DP010I-NEGATIVE-ALLOWED TO TRUE                      08867399
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08867599
263455              USING DP010I-NUMERIC-EDIT-AREA                      08867699
088674         IF  DP010I-ERROR-DETECTED                                08867750
088675             SET PS-ERROR                                         08867850
088676                 DP020-MSG-FATAL       TO TRUE                    08867950
088677             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08868050
088678             MOVE DP015-UNP-ALP-BRT-OFF                           08868150
088679                                       TO AQTYA                   08868250
088680             MOVE DP015-RED            TO AQTYC                   08868350
088681             MOVE DP015-REVERSE        TO AQTYH                   08868450
088682             MOVE -1                   TO AQTYL                   08868550
088683             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08868650
088684         ELSE                                                     08868750
088685             MOVE DP010I-NUMERIC-FIELD TO ASC-PM-FUNC-QTY-N       08868850
088686             MOVE ASC-PM-FUNC-QTY-N    TO AQTYO                   08868959
088687         END-IF                                                   08869050
088688     END-IF                                                       08869150
088689                                                                  08869250
088690     IF  ASC-PM-FUNC-PCT  >  SPACES                               08869350
088691         MOVE ASC-PM-FUNC-PCT          TO DP010I-UNEDITED-FIELD   08869450
088692         MOVE LENGTH OF ASC-PM-FUNC-PCT                           08869550
088693                                       TO DP010I-MAXIMUM-DIGITS   08869650
088694         MOVE 4                        TO DP010I-MAXIMUM-DECIMALS 08869755
088695         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08869850
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08870099
263455              USING DP010I-NUMERIC-EDIT-AREA                      08870199
088697         IF  DP010I-ERROR-DETECTED                                08870250
088698             SET PS-ERROR                                         08870350
088699                 DP020-MSG-FATAL       TO TRUE                    08870450
088700             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08870550
088701             MOVE DP015-UNP-ALP-BRT-OFF                           08870650
088702                                       TO APCNTA                  08870750
088703             MOVE DP015-RED            TO APCNTC                  08870850
088704             MOVE DP015-REVERSE        TO APCNTH                  08870950
088705             MOVE -1                   TO APCNTL                  08871050
088706             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08871150
088707         ELSE                                                     08871250
088708             MOVE DP010I-NUMERIC-FIELD TO ASC-PM-FUNC-PCT-N       08871350
088709             MOVE ASC-PM-FUNC-PCT-N    TO APCNTO                  08871459
088710         END-IF                                                   08871550
088711     END-IF.                                                      08871650
088712                                                                  08871750
088713     IF  ASC-PM-FUNC-WD-QTY  >  SPACES                            08871850
088714         MOVE ASC-PM-FUNC-WD-QTY       TO DP010I-UNEDITED-FIELD   08871950
088715         MOVE LENGTH OF ASC-PM-FUNC-WD-QTY                        08872050
088716                                       TO DP010I-MAXIMUM-DIGITS   08872150
088717         MOVE 4                        TO DP010I-MAXIMUM-DECIMALS 08872256
088718         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08872350
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08872599
263455              USING DP010I-NUMERIC-EDIT-AREA                      08872699
088720         IF  DP010I-ERROR-DETECTED                                08872750
088721             SET PS-ERROR                                         08872850
088722                 DP020-MSG-FATAL       TO TRUE                    08872950
088723             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08873050
088724             MOVE DP015-UNP-ALP-BRT-OFF                           08873150
088725                                       TO AFQTYA                  08873250
088726             MOVE DP015-RED            TO AFQTYC                  08873350
088727             MOVE DP015-REVERSE        TO AFQTYH                  08873450
088728             MOVE -1                   TO AFQTYL                  08873550
088729             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08873650
088730         ELSE                                                     08873750
088731             MOVE DP010I-NUMERIC-FIELD TO ASC-PM-FUNC-WD-QTY-N    08873850
088732             MOVE ASC-PM-FUNC-WD-QTY-N TO AFQTYO                  08873959
088733         END-IF                                                   08874050
088734     END-IF.                                                      08874150
088735                                                                  08874250
088736     IF  ASC-PM-FUNC-DPTH-QTY  >  SPACES                          08874350
088737         MOVE ASC-PM-FUNC-DPTH-QTY     TO DP010I-UNEDITED-FIELD   08874450
088738         MOVE LENGTH OF ASC-PM-FUNC-DPTH-QTY                      08874550
088739                                       TO DP010I-MAXIMUM-DIGITS   08874650
088740         MOVE 4                        TO DP010I-MAXIMUM-DECIMALS 08874756
088741         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08874850
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08875099
263455              USING DP010I-NUMERIC-EDIT-AREA                      08875199
088743         IF  DP010I-ERROR-DETECTED                                08875250
088744             SET PS-ERROR                                         08875350
088745                 DP020-MSG-FATAL       TO TRUE                    08875450
088746             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08875550
088747             MOVE DP015-UNP-ALP-BRT-OFF                           08875650
088748                                       TO AFDEPA                  08875750
088749             MOVE DP015-RED            TO AFDEPC                  08875850
088750             MOVE DP015-REVERSE        TO AFDEPH                  08875950
088751             MOVE -1                   TO AFDEPL                  08876050
088752             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08876150
088753         ELSE                                                     08876250
088754             MOVE DP010I-NUMERIC-FIELD TO ASC-PM-FUNC-DPTH-QTY-N  08876350
088755             MOVE ASC-PM-FUNC-DPTH-QTY-N TO AFDEPO                08876459
088756         END-IF                                                   08876550
088757     END-IF.                                                      08876650
088758                                                                  08876750
088759     IF  ASC-PM-FUNC-HT-QTY    >  SPACES                          08876850
088760         MOVE ASC-PM-FUNC-HT-QTY       TO DP010I-UNEDITED-FIELD   08876950
088761         MOVE LENGTH OF ASC-PM-FUNC-HT-QTY                        08877050
088762                                       TO DP010I-MAXIMUM-DIGITS   08877150
088763         MOVE 4                        TO DP010I-MAXIMUM-DECIMALS 08877257
088764         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08877350
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08877599
263455              USING DP010I-NUMERIC-EDIT-AREA                      08877699
088766         IF  DP010I-ERROR-DETECTED                                08877750
088767             SET PS-ERROR                                         08877850
088768                 DP020-MSG-FATAL       TO TRUE                    08877950
088769             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08878050
088770             MOVE DP015-UNP-ALP-BRT-OFF                           08878150
088771                                       TO AFHGTA                  08878250
088772             MOVE DP015-RED            TO AFHGTC                  08878350
088773             MOVE DP015-REVERSE        TO AFHGTH                  08878450
088774             MOVE -1                   TO AFHGTL                  08878550
088775             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08878650
088776         ELSE                                                     08878750
088777             MOVE DP010I-NUMERIC-FIELD TO ASC-PM-FUNC-HT-QTY-N    08878850
088778             MOVE ASC-PM-FUNC-HT-QTY-N TO AFHGTO                  08878959
088779         END-IF                                                   08879050
088780     END-IF.                                                      08879150
088781                                                                  08879250
088782     IF  ASC-PM-FUNC-WT-QTY    >  SPACES                          08879350
088783         MOVE ASC-PM-FUNC-WT-QTY       TO DP010I-UNEDITED-FIELD   08879450
088784         MOVE LENGTH OF ASC-PM-FUNC-WT-QTY                        08879550
088785                                       TO DP010I-MAXIMUM-DIGITS   08879650
088786         MOVE 4                        TO DP010I-MAXIMUM-DECIMALS 08879758
088787         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08879850
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08880099
263455              USING DP010I-NUMERIC-EDIT-AREA                      08880199
088789         IF  DP010I-ERROR-DETECTED                                08880250
088790             SET PS-ERROR                                         08880350
088791                 DP020-MSG-FATAL       TO TRUE                    08880450
088792             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08880550
088793             MOVE DP015-UNP-ALP-BRT-OFF                           08880650
088794                                       TO AFWGTA                  08880750
088795             MOVE DP015-RED            TO AFWGTC                  08880850
088796             MOVE DP015-REVERSE        TO AFWGTH                  08880950
088797             MOVE -1                   TO AFWGTL                  08881050
088798             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08881150
088799         ELSE                                                     08881250
088800             MOVE DP010I-NUMERIC-FIELD TO ASC-PM-FUNC-WT-QTY-N    08881350
088801             MOVE ASC-PM-FUNC-WT-QTY-N TO AFWGTO                  08881459
088802         END-IF                                                   08881550
088803     END-IF.                                                      08881650
088804                                                                  08881750
088805     MOVE  ASC-PM-FUNC-BEG-TMST   TO PV-BEG-TMST.                 08881850
088806                                                                  08881950
088807     IF  PV-BEG-HOUR           >  SPACES                          08882050
088808         MOVE PV-BEG-HOUR              TO DP010I-UNEDITED-FIELD   08882150
088809         MOVE LENGTH OF PV-BEG-HOUR                               08882250
088810                                       TO DP010I-MAXIMUM-DIGITS   08882350
088811         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08882450
088812         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08882550
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08882799
263455              USING DP010I-NUMERIC-EDIT-AREA                      08882899
088814         IF  DP010I-ERROR-DETECTED                                08882950
088815             SET PS-ERROR                                         08883050
088816                 DP020-MSG-FATAL       TO TRUE                    08883150
088817             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08883250
088818             MOVE DP015-UNP-ALP-BRT-OFF                           08883350
088819                                       TO ABHOURA                 08883450
088820             MOVE DP015-RED            TO ABHOURC                 08883550
088821             MOVE DP015-REVERSE        TO ABHOURH                 08883650
088822             MOVE -1                   TO ABHOURL                 08883750
088823             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08883850
088824         ELSE                                                     08883950
088825             MOVE DP010I-NUMERIC-FIELD TO PV-BEG-HOUR-N           08884050
088826             MOVE PV-BEG-HOUR          TO ABHOURO                 08884150
088827         END-IF                                                   08884250
088828     END-IF.                                                      08884350
088829                                                                  08884450
088830     IF  PV-BEG-MIN            >  SPACES                          08884550
088831         MOVE PV-BEG-MIN               TO DP010I-UNEDITED-FIELD   08884650
088832         MOVE LENGTH OF PV-BEG-MIN                                08884750
088833                                       TO DP010I-MAXIMUM-DIGITS   08884850
088834         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08884950
088835         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08885050
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08885299
263455              USING DP010I-NUMERIC-EDIT-AREA                      08885399
088837         IF  DP010I-ERROR-DETECTED                                08885450
088838             SET PS-ERROR                                         08885550
088839                 DP020-MSG-FATAL       TO TRUE                    08885650
088840             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08885750
088841             MOVE DP015-UNP-ALP-BRT-OFF                           08885850
088842                                       TO ABMINA                  08885950
088843             MOVE DP015-RED            TO ABMINC                  08886050
088844             MOVE DP015-REVERSE        TO ABMINH                  08886150
088845             MOVE -1                   TO ABMINL                  08886250
088846             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08886350
088847         ELSE                                                     08886450
088848             MOVE DP010I-NUMERIC-FIELD TO PV-BEG-MIN-N            08886550
088849             MOVE PV-BEG-MIN           TO ABMINO                  08886650
088850         END-IF                                                   08886750
088851     END-IF.                                                      08886850
088852                                                                  08886950
088853     IF  PV-BEG-SEC            >  SPACES                          08887050
088854         MOVE PV-BEG-SEC               TO DP010I-UNEDITED-FIELD   08887150
088855         MOVE LENGTH OF PV-BEG-SEC                                08887250
088856                                       TO DP010I-MAXIMUM-DIGITS   08887350
088857         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08887450
088858         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08887550
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08887799
263455              USING DP010I-NUMERIC-EDIT-AREA                      08887899
088860         IF  DP010I-ERROR-DETECTED                                08887950
088861             SET PS-ERROR                                         08888050
088862                 DP020-MSG-FATAL       TO TRUE                    08888150
088863             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08888250
088864             MOVE DP015-UNP-ALP-BRT-OFF                           08888350
088865                                       TO ABSECA                  08888450
088866             MOVE DP015-RED            TO ABSECC                  08888550
088867             MOVE DP015-REVERSE        TO ABSECH                  08888650
088868             MOVE -1                   TO ABSECL                  08888750
088869             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08888850
088870         ELSE                                                     08888950
088871             MOVE DP010I-NUMERIC-FIELD TO PV-BEG-SEC-N            08889050
088872             MOVE PV-BEG-SEC           TO ABSECO                  08889150
088873         END-IF                                                   08889250
088874     END-IF.                                                      08889350
088875                                                                  08889450
088876     IF  PV-BEG-MSEC           >  SPACES                          08889550
088877         MOVE PV-BEG-MSEC              TO DP010I-UNEDITED-FIELD   08889650
088878         MOVE LENGTH OF PV-BEG-MSEC                               08889750
088879                                       TO DP010I-MAXIMUM-DIGITS   08889850
088880         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08889950
088881         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08890050
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08890299
263455              USING DP010I-NUMERIC-EDIT-AREA                      08890399
088883         IF  DP010I-ERROR-DETECTED                                08890450
088884             SET PS-ERROR                                         08890550
088885                 DP020-MSG-FATAL       TO TRUE                    08890650
088886             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08890750
088887             MOVE DP015-UNP-ALP-BRT-OFF                           08890850
088888                                       TO ABMSECA                 08890950
088889             MOVE DP015-RED            TO ABMSECC                 08891050
088890             MOVE DP015-REVERSE        TO ABMSECH                 08891150
088891             MOVE -1                   TO ABMSECL                 08891250
088892             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08891350
088893         ELSE                                                     08891450
088894             MOVE DP010I-NUMERIC-FIELD TO PV-BEG-MSEC-N           08891550
088895             MOVE PV-BEG-MSEC          TO ABMSECO                 08891650
088896         END-IF                                                   08891750
088897     END-IF.                                                      08891850
088898                                                                  08891950
088899     MOVE  ASC-PM-FUNC-END-TMST   TO PV-END-TMST.                 08892050
088900                                                                  08892150
088901     IF  PV-END-HOUR           >  SPACES                          08892250
088902         MOVE PV-END-HOUR              TO DP010I-UNEDITED-FIELD   08892350
088903         MOVE LENGTH OF PV-END-HOUR                               08892450
088904                                       TO DP010I-MAXIMUM-DIGITS   08892550
088905         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08892650
088906         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08892750
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08892999
263455              USING DP010I-NUMERIC-EDIT-AREA                      08893099
088908         IF  DP010I-ERROR-DETECTED                                08893150
088909             SET PS-ERROR                                         08893250
088910                 DP020-MSG-FATAL       TO TRUE                    08893350
088911             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08893450
088912             MOVE DP015-UNP-ALP-BRT-OFF                           08893550
088913                                       TO AEHOURA                 08893650
088914             MOVE DP015-RED            TO AEHOURC                 08893750
088915             MOVE DP015-REVERSE        TO AEHOURH                 08893850
088916             MOVE -1                   TO AEHOURL                 08893950
088917             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08894050
088918         ELSE                                                     08894150
088919             MOVE DP010I-NUMERIC-FIELD TO PV-END-HOUR-N           08894250
088920             MOVE PV-END-HOUR          TO AEHOURO                 08894350
088921         END-IF                                                   08894450
088922     END-IF.                                                      08894550
088923                                                                  08894650
088924     IF  PV-END-MIN            >  SPACES                          08894750
088925         MOVE PV-END-MIN               TO DP010I-UNEDITED-FIELD   08894850
088926         MOVE LENGTH OF PV-END-MIN                                08894950
088927                                       TO DP010I-MAXIMUM-DIGITS   08895050
088928         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08895150
088929         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08895250
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08895499
263455              USING DP010I-NUMERIC-EDIT-AREA                      08895599
088931         IF  DP010I-ERROR-DETECTED                                08895650
088932             SET PS-ERROR                                         08895750
088933                 DP020-MSG-FATAL       TO TRUE                    08895850
088934             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08895950
088935             MOVE DP015-UNP-ALP-BRT-OFF                           08896050
088936                                       TO AEMINA                  08896150
088937             MOVE DP015-RED            TO AEMINC                  08896250
088938             MOVE DP015-REVERSE        TO AEMINH                  08896350
088939             MOVE -1                   TO AEMINL                  08896450
088940             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08896550
088941         ELSE                                                     08896650
088942             MOVE DP010I-NUMERIC-FIELD TO PV-END-MIN-N            08896750
088943             MOVE PV-END-MIN           TO AEMINO                  08896850
088944         END-IF                                                   08896950
088945     END-IF.                                                      08897050
088946                                                                  08897150
088947     IF  PV-END-SEC            >  SPACES                          08897250
088948         MOVE PV-END-SEC               TO DP010I-UNEDITED-FIELD   08897350
088949         MOVE LENGTH OF PV-END-SEC                                08897450
088950                                       TO DP010I-MAXIMUM-DIGITS   08897550
088951         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08897650
088952         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08897750
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08897999
263455              USING DP010I-NUMERIC-EDIT-AREA                      08898099
088954         IF  DP010I-ERROR-DETECTED                                08898150
088955             SET PS-ERROR                                         08898250
088956                 DP020-MSG-FATAL       TO TRUE                    08898350
088957             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08898450
088958             MOVE DP015-UNP-ALP-BRT-OFF                           08898550
088959                                       TO AESECA                  08898650
088960             MOVE DP015-RED            TO AESECC                  08898750
088961             MOVE DP015-REVERSE        TO AESECH                  08898850
088962             MOVE -1                   TO AESECL                  08898950
088963             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08899050
088964         ELSE                                                     08899150
088965             MOVE DP010I-NUMERIC-FIELD TO PV-END-SEC-N            08899250
088966             MOVE PV-END-SEC           TO AESECO                  08899350
088967         END-IF                                                   08899450
088968     END-IF.                                                      08899550
088969                                                                  08899650
088970     IF  PV-END-MSEC           >  SPACES                          08899750
088971         MOVE PV-END-MSEC              TO DP010I-UNEDITED-FIELD   08899850
088972         MOVE LENGTH OF PV-END-MSEC                               08899950
088973                                       TO DP010I-MAXIMUM-DIGITS   08900050
088974         MOVE ZERO                     TO DP010I-MAXIMUM-DECIMALS 08900150
088975         SET DP010I-NEGATIVE-NOT-ALLOWED TO TRUE                  08900250
263455         CALL DP010I-NUMERIC-EDIT-ROUTINE                         08900499
263455              USING DP010I-NUMERIC-EDIT-AREA                      08900599
088977         IF  DP010I-ERROR-DETECTED                                08900650
088978             SET PS-ERROR                                         08900750
088979                 DP020-MSG-FATAL       TO TRUE                    08900850
088980             MOVE PC-TSYMSG-00008      TO DP020-MSG-NUMBER        08900950
088981             MOVE DP015-UNP-ALP-BRT-OFF                           08901050
088982                                       TO AEMSECA                 08901150
088983             MOVE DP015-RED            TO AEMSECC                 08901250
088984             MOVE DP015-REVERSE        TO AEMSECH                 08901350
088985             MOVE -1                   TO AEMSECL                 08901450
088986             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08901550
088987         ELSE                                                     08901650
088988             MOVE DP010I-NUMERIC-FIELD TO PV-END-MSEC-N           08901750
088989             MOVE PV-END-MSEC          TO AEMSECO                 08901850
088990         END-IF                                                   08902050
089000     END-IF.                                                      08910050
089266                                                                  08926638
089267                                                                  08926738
089269*----------------------------------------------------------------*08926938
089270* VALIDATE OPER IS VALID                                         *08927038
089271*----------------------------------------------------------------*08927138
089272 3020-VALIDATE-OPER.                                              08927238
089274                                                                  08927438
089275     INITIALIZE XL071-COMMAREA.                                   08927538
089276     MOVE ASC-PM-LOC-ID  TO XL071-LOCATION-NUMBER.                08927638
089277                                                                  08927738
089278     CALL XL071-LOCATION-MODULE USING                             08927838
089279                                DFHEIBLK                          08927938
089280                                XL071-COMMAREA                    08928038
089281                                XL071-COMMAREA-REC.               08928138
089282                                                                  08928238
089283     EVALUATE TRUE                                                08928338
089284         WHEN XL071-NO-ERRORS                                     08928438
089285         WHEN XL071-DC-ASGMT-NOT-FND                              08928538
089286              MOVE XL071-LOC-NM   TO ASC-PM-LOC-NAME              08928638
089287                                     AOPNAMEO                     08928738
089288                                                                  08928838
089289         WHEN XL071-LOC-NOT-FOUND                                 08928938
089290              SET PS-ERROR                                        08929038
089291                  DP020-MSG-FATAL     TO TRUE                     08929138
089292              MOVE PC-TSYMSG-00005    TO DP020-MSG-NUMBER         08929238
089293              MOVE DP015-UNP-ALP-BRT-OFF                          08929338
089294                                      TO AOPERA                   08929438
089295              MOVE DP015-RED          TO AOPERC                   08929538
089296              MOVE DP015-REVERSE      TO AOPERH                   08929638
089297              MOVE -1                 TO AOPERL                   08929738
089298              SET DP030-SET-CURSOR-APPL-1                         08929838
089299                                      TO TRUE                     08929938
089300                                                                  08930038
089301         WHEN OTHER                                               08930138
089302              MOVE '2410-VALIDATE-OPER'                           08930238
089303                              TO DP013-PARAGRAPH                  08930338
089304              STRING 'VALIDATE OPER UNIT ID '                     08930438
089305                      XL071-LOCATION-NUMBER                       08930538
089306                     ' - BAD RETURN CODE FROM XLKUT071 - '        08930638
089307                      XL071-RETURN-CODE                           08930738
089308                      DELIMITED BY SIZE                           08930838
089309                      INTO DP013-MESSAGE-TEXT (1)                 08930938
089310              STRING 'SQLCODE - '                                 08931038
089311                      XL071-SQLCODE                               08931138
089312                     ' - '                                        08931238
089313                      XL071-DB2-TABLE                             08931338
089314                      DELIMITED BY SIZE                           08931438
089315                      INTO DP013-MESSAGE-TEXT (2)                 08931538
089316              MOVE XL071-SQLCA     TO DP013-SQLCA                 08931638
089317              MOVE XL071-DB2-TABLE TO DP013-DB2-TABLE-NAME (1)    08931738
089318              MOVE XL071-SQLCODE TO SQLCODE                       08931838
089319              SET DP013-DB2-ABEND                                 08931938
089320                  DP013-XCTL-DISPLAY-RESTART TO TRUE              08932038
089321              PERFORM DP013-0000-PROCESS-ABEND                    08932138
089322                                                                  08932238
089323     END-EVALUATE.                                                08932338
089324                                                                  08932438
089325                                                                  08932538
089555*----------------------------------------------------------------*08955538
089556* VALIDATE FROM TIMESTAMP                                        *08955638
089557*----------------------------------------------------------------*08955738
089558 3025-VALIDATE-TMST.                                              08955838
089560     MOVE  ASC-PM-FUNC-BEG-TMST  TO  PV-BEG-TMST                  08956038
089561     MOVE  ASC-PM-FUNC-END-TMST  TO  PV-END-TMST                  08956138
089562                                                                  08956238
089563     MOVE  PV-BEG-MONTH     TO  PV-FROM-MM.                       08956338
089564     MOVE  PV-BEG-DAY       TO  PV-FROM-DD.                       08956438
089565     MOVE  PV-BEG-YEAR      TO  PV-FROM-YY.                       08956538
089566                                                                  08956638
089567     MOVE  PV-END-MONTH     TO  PV-TO-MM.                         08956738
089568     MOVE  PV-END-DAY       TO  PV-TO-DD.                         08956838
089569     MOVE  PV-END-YEAR      TO  PV-TO-YY.                         08956938
089570                                                                  08957038
089571     IF  PV-TO-DATE-HOLD  >=  PV-FROM-DATE-HOLD                   08957138
089572         CONTINUE                                                 08957238
089573     ELSE                                                         08957338
089574*        DATE RANGE IS INVALID                                    08957438
089575         SET PS-ERROR                                             08957538
089576         DP020-MSG-FATAL             TO TRUE                      08957638
089577         MOVE PC-TSYMSG-02698        TO DP020-MSG-NUMBER          08957738
089578         MOVE DP015-UNP-ALP-BRT-MDT  TO ABYEARA                   08957869
089579                                        ABMNTHA                   08957938
089580                                        ABDAYA                    08958038
089581                                        ABHOURA                   08958138
089582                                        ABMINA                    08958238
089583                                        ABSECA                    08958338
089584                                        ABMSECA                   08958438
089585                                        AEYEARA                   08958538
089586                                        AEMNTHA                   08958638
089587                                        AEDAYA                    08958738
089588                                        AEHOURA                   08958838
089589                                        AEMINA                    08958938
089590                                        AESECA                    08959038
089591                                        AEMSECA                   08959138
089592         MOVE DP015-RED              TO ABYEARC                   08959238
089593                                        ABMNTHC                   08959338
089594                                        ABDAYC                    08959438
089595                                        ABHOURC                   08959538
089596                                        ABMINC                    08959638
089597                                        ABSECC                    08959738
089598                                        ABMSECC                   08959838
089599                                        AEYEARC                   08959938
089600                                        AEMNTHC                   08960038
089601                                        AEDAYC                    08960138
089602                                        AEHOURC                   08960238
089603                                        AEMINC                    08960338
089604                                        AESECC                    08960438
089605                                        AEMSECC                   08960538
089606         MOVE DP015-REVERSE          TO ABYEARH                   08960638
089607                                        ABMNTHH                   08960738
089608                                        ABDAYH                    08960838
089609                                        ABHOURH                   08960938
089610                                        ABMINH                    08961038
089611                                        ABSECH                    08961138
089612                                        ABMSECH                   08961238
089613                                        AEYEARH                   08961338
089614                                        AEMNTHH                   08961438
089615                                        AEDAYH                    08961538
089616                                        AEHOURH                   08961638
089617                                        AEMINH                    08961738
089618                                        AESECH                    08961838
089619                                        AEMSECH                   08961938
089620         MOVE -1                     TO ABYEARL                   08962038
089621         SET DP030-SET-CURSOR-APPL-1 TO TRUE                      08962138
089622     END-IF.                                                      08962238
089623                                                                  08962338
089629     IF  PS-NO-ERROR                                              08962938
089630         IF  PV-FROM-DATE-HOLD  = PC-DEFAULT-FROM-DATE            08963070
089631             CONTINUE                                             08963170
089632         ELSE                                                     08963270
089633             INITIALIZE DPG51 DPG52 DPG53                         08963370
089634                        DPG54 DPG55 DPG56                         08963470
089635             SET  DPG51-ACTUAL-CALENDAR-ONLY                      08963570
089636                  DPG51-DO-NOT-INCR-DECR-DATE                     08963670
089637                                        TO TRUE                   08963770
089638*                'CCYYMMDD'                                       08963870
089639             SET  DPG52-LK-DTE-ISO                                08963970
089640                                        TO TRUE                   08964070
089641             MOVE PV-FROM-DATE-HOLD     TO DPG52-LK-DATE-INPUT    08964170
089642             CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53      08964270
089643                                           DPG54 DPG55 DPG56      08964370
089644             IF (DPG54-DATE-INVALID  OR                           08964470
089645                 DPG54-SEVERE-ERROR)                              08964570
089646                 SET PS-ERROR                                     08964670
089647                 DP020-MSG-FATAL       TO TRUE                    08964738
089648                 MOVE PC-TSYMSG-00009  TO DP020-MSG-NUMBER        08964870
089649                 MOVE DP015-UNP-ALP-BRT-MDT                       08964970
089650                                       TO ABYEARA                 08965038
089651                                          ABMNTHA                 08965138
089652                                          ABDAYA                  08965238
089653                                          ABHOURA                 08965338
089654                                          ABMINA                  08965438
089655                                          ABSECA                  08965538
089656                                          ABMSECA                 08965638
089657                 MOVE DP015-RED                                   08965770
089658                                       TO ABYEARC                 08965838
089659                                          ABMNTHC                 08965938
089660                                          ABDAYC                  08966038
089661                                          ABHOURC                 08966138
089662                                          ABMINC                  08966238
089663                                          ABSECC                  08966338
089664                                          ABMSECC                 08966438
089665                 MOVE DP015-REVERSE                               08966570
089666                                       TO ABYEARH                 08966638
089667                                          ABMNTHH                 08966738
089668                                          ABDAYH                  08966838
089669                                          ABHOURH                 08966938
089670                                          ABMINH                  08967038
089671                                          ABSECH                  08967138
089672                                          ABMSECH                 08967238
089673                 MOVE -1               TO ABYEARL                 08967370
089674                 SET DP030-SET-CURSOR-APPL-1                      08967470
089675                                       TO TRUE                    08967538
089676             END-IF                                               08967670
089677         END-IF                                                   08967770
089678     END-IF.                                                      08967870
089679                                                                  08967970
089680     IF  PS-NO-ERROR                                              08968070
089681         IF  PV-TO-DATE-HOLD  = PC-DEFAULT-TO-DATE                08968170
089682             CONTINUE                                             08968270
089683         ELSE                                                     08968370
089684                                                                  08968470
089685             INITIALIZE DPG51 DPG52 DPG53                         08968570
089686                        DPG54 DPG55 DPG56                         08968670
089687             SET  DPG51-ACTUAL-CALENDAR-ONLY                      08968770
089688                  DPG51-DO-NOT-INCR-DECR-DATE                     08968870
089689                                        TO TRUE                   08968970
089690*                'CCYYMMDD'                                       08969070
089691             SET  DPG52-LK-DTE-ISO                                08969170
089692                                        TO TRUE                   08969270
089693             MOVE PV-TO-DATE-HOLD       TO DPG52-LK-DATE-INPUT    08969370
089694             CALL PC-CALENDAR-MODULE USING DPG51 DPG52 DPG53      08969470
089695                                           DPG54 DPG55 DPG56      08969570
089696             IF (DPG54-DATE-INVALID                               08969670
089697             OR  DPG54-SEVERE-ERROR)                              08969770
089698                 SET PS-ERROR                                     08969870
089699                     DP020-MSG-FATAL       TO TRUE                08969970
089700                 MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER    08970070
089701                 MOVE DP015-UNP-ALP-BRT-OFF                       08970170
089702                                       TO AEYEARA                 08970270
089703                                          AEMNTHA                 08970370
089704                                          AEDAYA                  08970470
089705                                          AEHOURA                 08970570
089706                                          AEMINA                  08970670
089707                                          AESECA                  08970770
089708                                          AEMSECA                 08970870
089709                 MOVE DP015-RED                                   08970970
089710                                       TO AEYEARC                 08971070
089711                                          AEMNTHC                 08971170
089712                                          AEDAYC                  08971270
089713                                          AEHOURC                 08971370
089714                                          AEMINC                  08971470
089715                                          AESECC                  08971570
089716                                          AEMSECC                 08971670
089717                 MOVE DP015-REVERSE                               08971770
089718                                       TO AEYEARH                 08971870
089719                                          AEMNTHH                 08971970
089720                                          AEDAYH                  08972070
089721                                          AEHOURH                 08972170
089722                                          AEMINH                  08972270
089723                                          AESECH                  08972370
089724                                          AEMSECH                 08972470
089725                 MOVE -1               TO AEYEARL                 08972570
089726                 SET DP030-SET-CURSOR-APPL-1 TO TRUE              08972670
089727             END-IF                                               08972770
089728         END-IF                                                   08972870
089729     END-IF.                                                      08972970
089730                                                                  08973070
089731     IF  PS-NO-ERROR                                              08973170
089732         IF  PV-BEG-HOUR  <  25  AND                              08973270
089733             PV-END-HOUR  <  25                                   08973370
089734             CONTINUE                                             08973470
089735         ELSE                                                     08973570
089736             SET PS-ERROR                                         08973670
089737                 DP020-MSG-FATAL       TO TRUE                    08973770
089738             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        08973870
089739             MOVE DP015-UNP-ALP-BRT-OFF                           08973970
089740                                       TO ABHOURA                 08974070
089741                                          AEHOURA                 08974170
089742             MOVE DP015-RED                                       08974270
089743                                       TO ABHOURC                 08974370
089744                                          AEHOURC                 08974470
089745             MOVE DP015-REVERSE                                   08974570
089746                                       TO ABHOURH                 08974670
089747                                          AEHOURH                 08974770
089748             MOVE -1                   TO ABHOURL                 08974870
089749             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08974970
089750         END-IF                                                   08975070
089751     END-IF.                                                      08975170
089752                                                                  08975270
089753     IF  PS-NO-ERROR                                              08975370
089754         IF  PV-BEG-MIN   <  60  AND                              08975470
089755             PV-END-MIN   <  60                                   08975570
089756             CONTINUE                                             08975670
089757         ELSE                                                     08975770
089758             SET PS-ERROR                                         08975870
089759                 DP020-MSG-FATAL       TO TRUE                    08975970
089760             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        08976070
089761             MOVE DP015-UNP-ALP-BRT-OFF                           08976170
089762                                       TO ABMINA                  08976270
089763                                          AEMINA                  08976370
089764             MOVE DP015-RED                                       08976470
089765                                       TO ABMINC                  08976570
089766                                          AEMINC                  08976670
089767             MOVE DP015-REVERSE                                   08976770
089768                                       TO ABMINH                  08976870
089769                                          AEMINH                  08976970
089770             MOVE -1                   TO ABMINL                  08977070
089771             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08977170
089772         END-IF                                                   08977270
089773     END-IF.                                                      08977370
089774                                                                  08977470
089775     IF  PS-NO-ERROR                                              08977570
089776         IF  PV-BEG-SEC   <  60  AND                              08977670
089777             PV-END-SEC   <  60                                   08977770
089778             CONTINUE                                             08977870
089779         ELSE                                                     08977970
089780             SET PS-ERROR                                         08978070
089781                 DP020-MSG-FATAL       TO TRUE                    08978170
089782             MOVE PC-TSYMSG-00009      TO DP020-MSG-NUMBER        08978270
089783             MOVE DP015-UNP-ALP-BRT-OFF                           08978370
089784                                       TO ABSECA                  08978470
089785                                          AESECA                  08978570
089786             MOVE DP015-RED                                       08978670
089787                                       TO ABSECC                  08978770
089788                                          AESECC                  08978870
089789             MOVE DP015-REVERSE                                   08978970
089790                                       TO ABSECH                  08979070
089791                                          AESECH                  08979170
089792             MOVE -1                   TO ABSECL                  08979270
089793             SET DP030-SET-CURSOR-APPL-1 TO TRUE                  08979370
089794         END-IF                                                   08979470
089795     END-IF.                                                      08979570
089796                                                                  08979670
089797                                                                  08979770
089798                                                                  08979870
089799                                                                  08979970
089800*                                                                 08980070
089801******************************************************************08980170
089802** A ROW MUST EXIST ON TKRPRPM.                                   08980270
089803******************************************************************08980370
089804 3040-CHECK-4-ROW-ON-KRPRPM.                                      08980470
089805      MOVE ASC-PARM-CODE         TO  KRPRPM-SYS-PRC-FUNC-CDE.     08980598
089806      MOVE ASC-PM-LOC-ID         TO  KRPRPM-LOC-ID.               08980696
089808                                                                  08980870
089809        EXEC SQL                                                  08980970
089810          SELECT                                                  08981070
089811                  LOC_ID                                          08981170
089812                 ,INTFC_SYS_CDE                                   08981270
089813                 ,SYS_PRC_FUNC_CDE                                08981370
089814                 ,FUNC_PRC_STAT_CDE                               08981470
089815                 ,FUNC_BEG_TMST                                   08981599
089816                 ,FUNC_END_TMST                                   08981699
089817                 ,FUNC_QTY                                        08981799
089818                 ,FUNC_PCT                                        08981899
089819                 ,FUNC_TXT                                        08981999
089820                 ,FUNC_WD_QTY                                     08982070
089821                 ,FUNC_DPTH_QTY                                   08982170
089822                 ,FUNC_HT_QTY                                     08982270
089823                 ,FUNC_WT_QTY                                     08982370
089824            INTO                                                  08982470
089830                 :KRPRPM-LOC-ID                                   08983005
089900                ,:KRPRPM-INTFC-SYS-CDE                            08990005
090000                ,:KRPRPM-SYS-PRC-FUNC-CDE                         09000005
090010                ,:KRPRPM-FUNC-PRC-STAT-CDE                        09001005
090020                ,:KRPRPM-FUNC-BEG-TMST :ASC-PM-FUNC-BEG-TMST-NULL 09002099
090021                ,:KRPRPM-FUNC-END-TMST :ASC-PM-FUNC-END-TMST-NULL 09002199
090040                ,:KRPRPM-FUNC-QTY      :ASC-PM-FUNC-QTY-NULL      09004099
090050                ,:KRPRPM-FUNC-PCT      :ASC-PM-FUNC-PCT-NULL      09005099
090060                ,:KRPRPM-FUNC-TXT      :ASC-PM-FUNC-TXT-NULL      09006099
090070                ,:KRPRPM-FUNC-WD-QTY                              09007005
090080                ,:KRPRPM-FUNC-DPTH-QTY                            09008005
090090                ,:KRPRPM-FUNC-HT-QTY                              09009005
090091                ,:KRPRPM-FUNC-WT-QTY                              09009105
090100            FROM  TKRPRPM                                         09010004
090200           WHERE  LOC_ID           = :KRPRPM-LOC-ID               09020022
090220             AND  SYS_PRC_FUNC_CDE = :KRPRPM-SYS-PRC-FUNC-CDE     09022022
090300        END-EXEC                                                  09030004
090400                                                                  09040004
090500        EVALUATE TRUE                                             09050004
090600            WHEN SQLCODE = +0                                     09060004
090700                IF  ASC-FUNCTION = PC-ADD                         09070099
090800                    SET PS-ERROR                                  09080099
090900                        DP020-MSG-FATAL     TO TRUE               09090099
091000                    MOVE PC-TSYMSG-03709    TO DP020-MSG-NUMBER   09100099
091001                    MOVE DP015-UNP-ALP-BRT-OFF                    09100199
091002                                            TO AOPERA             09100299
091003                    MOVE DP015-RED          TO AOPERC             09100399
091004                    MOVE DP015-REVERSE      TO AOPERH             09100499
091005                    MOVE -1                 TO AOPERL             09100599
091006                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           09100699
091007                END-IF                                            09100799
091010                                                                  09101099
091100            WHEN SQLCODE = +100                                   09110004
091200                MOVE SPACES                 TO ASC-PARM-DESC      09120004
091300                MOVE SPACES                 TO ASC-PARM-TYPE      09130004
091301                IF  ASC-FUNCTION = PC-UPDATE                      09130199
091400                    SET PS-ERROR                                  09140037
091500                        DP020-MSG-FATAL     TO TRUE               09150037
091600                    MOVE PC-TSYMSG-03710    TO DP020-MSG-NUMBER   09160099
091700                    MOVE DP015-UNP-ALP-BRT-OFF                    09170037
091710                                            TO AOPERA             09171037
091800                    MOVE DP015-RED          TO AOPERC             09180037
091900                    MOVE DP015-REVERSE      TO AOPERH             09190037
092000                    MOVE -1                 TO AOPERL             09200037
092100                    SET DP030-SET-CURSOR-APPL-1 TO TRUE           09210037
092110                END-IF                                            09211037
092200                                                                  09220004
092300            WHEN SQLWARN0 NOT = SPACES                            09230004
092400            WHEN SQLCODE < +0                                     09240004
092500            WHEN SQLCODE > +0                                     09250004
092600                MOVE '3040-CHECK-4-ROW-ON-KRPRPM'                 09260022
092700                                          TO DP013-PARAGRAPH      09270004
092800                MOVE 'PROBLEM WITH RETRIEVING ROW'                09280004
092900                                    TO DP013-MESSAGE-TEXT (1)     09290004
093000                MOVE SQLCA      TO DP013-SQLCA                    09300004
093100                MOVE 'TKRPRPM'  TO DP013-DB2-TABLE-NAME (1)       09310004
093200                SET DP013-DB2-ABEND                               09320004
093300                    DP013-XCTL-DISPLAY-RESTART TO TRUE            09330004
093400                PERFORM DP013-0000-PROCESS-ABEND                  09340004
093500        END-EVALUATE.                                             09350004
093600                                                                  09360004
095500*----------------------------------------------------------------*09550004
095600* MOVE THE DEFAULT ATTRIBUTE VALUES TO THE ENTERABLE FIELDS ON   *09560004
095700* MAP.                                                           *09570004
095800*----------------------------------------------------------------*09580004
095900 3200-RESET-ATTRIBUTES.                                           09590004
096000     IF PS-NO-ERROR                                               09600004
096100         IF ASC-FUNCTION = PC-UPDATE                              09610015
096200             MOVE DP015-PRO-NOR-OFF        TO AOPERA              09620018
096300             MOVE DP015-BLUE               TO AOPERC              09630018
096400             MOVE DP015-HL-OFF             TO AOPERH              09640018
096500             SET DP030-SET-CURSOR-APPL-1   TO TRUE                09650004
096600             MOVE -1                       TO ASYSL               09660018
096700         ELSE                                                     09670004
096800             MOVE DP015-UNP-ALP-NOR-OFF    TO AOPERA              09680064
097100             MOVE DP015-GREEN              TO AOPERC              09710018
097400             MOVE DP015-UNDERLINE          TO AOPERH              09740018
097700             SET DP030-SET-CURSOR-APPL-1   TO TRUE                09770004
097800             MOVE -1                       TO AOPERL              09780018
097900         END-IF                                                   09790004
098000                                                                  09800019
098010         MOVE DP015-PRO-NOR-OFF        TO APARMA                  09801019
098011                                          APMDESCA                09801119
098012                                          ATYPEA                  09801219
098013                                          ATYDESCA                09801319
098014                                          AOPNAMEA                09801419
098020         MOVE DP015-BLUE               TO APARMC                  09802019
098021                                          APMDESCC                09802119
098022                                          ATYPEC                  09802219
098023                                          ATYDESCC                09802319
098024                                          AOPNAMEC                09802419
098030         MOVE DP015-HL-OFF             TO APARMH                  09803019
098031                                          APMDESCH                09803119
098032                                          ATYPEH                  09803219
098033                                          ATYDESCH                09803319
098034                                          AOPNAMEH                09803419
098040                                                                  09804019
098100         MOVE DP015-UNP-ALP-NOR-MDT    TO ASYSA                   09810064
098200                                          ASTATA                  09820019
098300                                          ABYEARA                 09830019
098310                                          ABMNTHA                 09831019
098320                                          ABDAYA                  09832019
098330                                          ABHOURA                 09833019
098340                                          ABMINA                  09834019
098350                                          ABSECA                  09835019
098360                                          ABMSECA                 09836019
098370                                          AEYEARA                 09837019
098380                                          AEMNTHA                 09838019
098390                                          AEDAYA                  09839019
098391                                          AEHOURA                 09839119
098392                                          AEMINA                  09839219
098393                                          AESECA                  09839319
098394                                          AEMSECA                 09839419
098395                                          AQTYA                   09839519
098396                                          APCNTA                  09839619
098397                                          ATEXTA                  09839719
098398                                          AFQTYA                  09839819
098399                                          AFDEPA                  09839919
098400                                          AFHGTA                  09840019
098401                                          AFWGTA                  09840119
098410         MOVE DP015-GREEN              TO ASYSC                   09841019
098420                                          ASTATC                  09842019
098430                                          ABYEARC                 09843019
098440                                          ABMNTHC                 09844019
098450                                          ABDAYC                  09845019
098460                                          ABHOURC                 09846019
098470                                          ABMINC                  09847019
098480                                          ABSECC                  09848019
098490                                          ABMSECC                 09849019
098491                                          AEYEARC                 09849119
098492                                          AEMNTHC                 09849219
098493                                          AEDAYC                  09849319
098494                                          AEHOURC                 09849419
098495                                          AEMINC                  09849519
098496                                          AESECC                  09849619
098497                                          AEMSECC                 09849719
098498                                          AQTYC                   09849819
098499                                          APCNTC                  09849919
098500                                          ATEXTC                  09850019
098501                                          AFQTYC                  09850119
098502                                          AFDEPC                  09850219
098503                                          AFHGTC                  09850319
098504                                          AFWGTC                  09850419
098700         MOVE DP015-UNDERLINE          TO ASYSH                   09870024
098710                                          ASTATH                  09871019
098720                                          ABYEARH                 09872019
098730                                          ABMNTHH                 09873019
098740                                          ABDAYH                  09874019
098750                                          ABHOURH                 09875019
098760                                          ABMINH                  09876019
098770                                          ABSECH                  09877019
098780                                          ABMSECH                 09878019
098790                                          AEYEARH                 09879019
098791                                          AEMNTHH                 09879119
098792                                          AEDAYH                  09879219
098793                                          AEHOURH                 09879319
098794                                          AEMINH                  09879419
098795                                          AESECH                  09879519
098796                                          AEMSECH                 09879619
098797                                          AQTYH                   09879719
098798                                          APCNTH                  09879819
098799                                          ATEXTH                  09879919
098800                                          AFQTYH                  09880019
098801                                          AFDEPH                  09880119
098802                                          AFHGTH                  09880219
098803                                          AFWGTH                  09880319
098900     END-IF.                                                      09890004
099000                                                                  09900004
099100*----------------------------------------------------------------*09910004
099200*    VALIDATE THE QUEUE WAS PASSED AND DISPLAY FOR THE FIRST     *09920004
099300*    ENTRY.                                                      *09930004
099400*----------------------------------------------------------------*09940004
099500 4000-BUILD-INITIAL-PANEL.                                        09950004
099600     IF  ASC-FUNCTION = PC-UPDATE                                 09960019
099610          MOVE DP015-PRO-NOR-OFF        TO AOPERA                 09961019
099620          MOVE DP015-BLUE               TO AOPERC                 09962019
099630          MOVE DP015-HL-OFF             TO AOPERH                 09963019
099640          SET DP030-SET-CURSOR-APPL-1   TO TRUE                   09964019
099650          MOVE -1                       TO ASYSL                  09965019
100800     ELSE                                                         10080004
101000         SET DP030-SET-CURSOR-APPL-1  TO TRUE                     10100019
101100         MOVE -1                      TO AOPERL                   10110019
102100     END-IF.                                                      10210004
102200                                                                  10220004
102300                                                                  10230004
102400*----------------------------------------------------------------*10240004
102500*    RESTORE THE DATA ON THE SCREEN FROM THE COMM AREA.          *10250004
102600*----------------------------------------------------------------*10260004
102700 4400-MOVE-COMMAREA-TO-SCREEN.                                    10270004
102810     MOVE ASC-PARM-CODE            TO APARMO.                     10281019
102900     MOVE ASC-PARM-DESC            TO APMDESCO.                   10290004
103000     MOVE ASC-PARM-TYPE            TO ATYPEO.                     10300019
103010     MOVE ASC-TYPE-DESCR           TO ATYDESCO.                   10301050
103020     MOVE ASC-PM-LOC-ID            TO AOPERO.                     10302040
103030     MOVE ASC-PM-LOC-NAME          TO AOPNAMEO.                   10303040
103040     MOVE ASC-PM-INTFC-SYS-CDE     TO ASYSO.                      10304040
103050     MOVE ASC-PM-FUNC-PRC-STAT-CDE TO ASTATO.                     10305040
103051     MOVE ASC-PM-FUNC-BEG-TMST     TO PV-BEG-TMST.                10305140
103080     MOVE PV-BEG-YEAR-N            TO ABYEARO.                    10308048
103081     MOVE PV-BEG-MONTH-N           TO ABMNTHO.                    10308148
103082     MOVE PV-BEG-DAY-N             TO ABDAYO.                     10308248
103090     MOVE PV-BEG-HOUR-N            TO ABHOURO.                    10309048
103091     MOVE PV-BEG-MIN-N             TO ABMINO.                     10309148
103092     MOVE PV-BEG-SEC-N             TO ABSECO.                     10309248
103093     MOVE PV-BEG-MSEC-N            TO ABMSECO.                    10309348
103094     MOVE ASC-PM-FUNC-END-TMST     TO PV-END-TMST.                10309440
103095     MOVE PV-END-YEAR-N            TO AEYEARO.                    10309548
103096     MOVE PV-END-MONTH-N           TO AEMNTHO.                    10309648
103097     MOVE PV-END-DAY-N             TO AEDAYO.                     10309748
103098     MOVE PV-END-HOUR-N            TO AEHOURO.                    10309848
103099     MOVE PV-END-MIN-N             TO AEMINO.                     10309948
103100     MOVE PV-END-SEC-N             TO AESECO.                     10310048
103101     MOVE PV-END-MSEC-N            TO AEMSECO.                    10310148
103109     MOVE ASC-PM-FUNC-QTY-N        TO AQTYO.                      10310945
103110     MOVE ASC-PM-FUNC-PCT-N        TO APCNTO.                     10311045
103111     MOVE ASC-PM-FUNC-TXT          TO ATEXTO.                     10311140
103112     MOVE ASC-PM-FUNC-WD-QTY-N     TO AFQTYO.                     10311245
103113     MOVE ASC-PM-FUNC-DPTH-QTY-N   TO AFDEPO.                     10311345
103114     MOVE ASC-PM-FUNC-HT-QTY-N     TO AFHGTO.                     10311445
103115     MOVE ASC-PM-FUNC-WT-QTY-N     TO AFWGTO.                     10311545
103120                                                                  10312004
103200*------------------------------------------------------------     10320004
103300*  MOVE COMMAREA TO TEMP AREA                                     10330004
103400*------------------------------------------------------------     10340004
103500 4500-MOVE-COMMAREA-TO-TEMP.                                      10350004
103810     MOVE ASC-PM-LOC-ID            TO PV-INP-LOC-ID.              10381026
103820     MOVE ASC-PM-INTFC-SYS-CDE     TO PV-INP-INTFC-SYS-CDE.       10382026
103830     MOVE ASC-PM-FUNC-PRC-STAT-CDE TO PV-INP-FUNC-PRC-STAT-CDE.   10383026
103840     MOVE ASC-PM-FUNC-BEG-TMST     TO PV-INP-FUNC-BEG-TMST.       10384026
103850     MOVE ASC-PM-FUNC-END-TMST     TO PV-INP-FUNC-END-TMST.       10385026
103860     MOVE ASC-PM-FUNC-QTY-N        TO PV-INP-FUNC-QTY.            10386099
103870     MOVE ASC-PM-FUNC-PCT-N        TO PV-INP-FUNC-PCT.            10387099
103880     MOVE ASC-PM-FUNC-TXT          TO PV-INP-FUNC-TXT.            10388026
103890     MOVE ASC-PM-FUNC-WD-QTY-N     TO PV-INP-FUNC-WD-QTY.         10389044
103891     MOVE ASC-PM-FUNC-DPTH-QTY-N   TO PV-INP-FUNC-DPTH-QTY.       10389144
103892     MOVE ASC-PM-FUNC-HT-QTY-N     TO PV-INP-FUNC-HT-QTY.         10389244
103893     MOVE ASC-PM-FUNC-WT-QTY-N     TO PV-INP-FUNC-WT-QTY.         10389344
103900                                                                  10390004
104000*----------------------------------------------------------------*10400004
104100* PROCESS TABLE INSERTS                                          *10410004
104200*----------------------------------------------------------------*10420004
104300 5000-PROCESS-ADD.                                                10430004
104310                                                                  10431028
104400     MOVE  PV-INP-LOC-ID                                          10440028
104500       TO  KRPRPM-LOC-ID                                          10450028
104510     MOVE  PV-INP-INTFC-SYS-CDE                                   10451028
104520       TO  KRPRPM-INTFC-SYS-CDE                                   10452028
104530     MOVE  ASC-PARM-CODE                                          10453029
104540       TO  KRPRPM-SYS-PRC-FUNC-CDE                                10454028
104550     MOVE  PV-INP-FUNC-PRC-STAT-CDE                               10455028
104560       TO  KRPRPM-FUNC-PRC-STAT-CDE                               10456028
104570     MOVE  PV-INP-FUNC-BEG-TMST                                   10457028
104580       TO  KRPRPM-FUNC-BEG-TMST                                   10458028
104590     MOVE  PV-INP-FUNC-END-TMST                                   10459028
104591       TO  KRPRPM-FUNC-END-TMST                                   10459128
104592                                                                  10459299
104593       IF  PV-INP-FUNC-QTY  >  0 OR                               10459399
104594           PV-INP-FUNC-QTY  <  0                                  10459499
104595           MOVE  PV-INP-FUNC-QTY                                  10459599
104596             TO  KRPRPM-FUNC-QTY                                  10459699
104597           MOVE  +0                                               10459799
104598             TO  ASC-PM-FUNC-QTY-NULL                             10459899
104599       ELSE                                                       10459999
104600           INITIALIZE  KRPRPM-FUNC-QTY                            10460099
104601           MOVE  -1  TO  ASC-PM-FUNC-QTY-NULL                     10460199
104602       END-IF                                                     10460299
104603                                                                  10460399
104604       IF  PV-INP-FUNC-PCT  >  0                                  10460499
104605           MOVE  PV-INP-FUNC-PCT                                  10460599
104606             TO  KRPRPM-FUNC-PCT                                  10460699
104607           MOVE  +0                                               10460799
104608             TO  ASC-PM-FUNC-PCT-NULL                             10460899
104609       ELSE                                                       10460999
104610           INITIALIZE  KRPRPM-FUNC-PCT                            10461099
104611           MOVE  -1  TO  ASC-PM-FUNC-PCT-NULL                     10461199
104612       END-IF                                                     10461299
104613                                                                  10461399
104614       IF  PV-INP-FUNC-TXT  >  SPACES                             10461499
104615           MOVE  PV-INP-FUNC-TXT                                  10461599
104616             TO  KRPRPM-FUNC-TXT                                  10461699
104617           MOVE  +0                                               10461799
104618             TO  ASC-PM-FUNC-TXT-NULL                             10461899
104619       ELSE                                                       10461999
104620           INITIALIZE  KRPRPM-FUNC-TXT                            10462099
104621           MOVE  -1  TO  ASC-PM-FUNC-TXT-NULL                     10462199
104622       END-IF                                                     10462299
104623                                                                  10462399
104625     MOVE  PV-INP-FUNC-WD-QTY                                     10462528
104626       TO  KRPRPM-FUNC-WD-QTY                                     10462628
104627     MOVE  PV-INP-FUNC-DPTH-QTY                                   10462728
104628       TO  KRPRPM-FUNC-DPTH-QTY                                   10462828
104629     MOVE  PV-INP-FUNC-HT-QTY                                     10462928
104630       TO  KRPRPM-FUNC-HT-QTY                                     10463028
104631     MOVE  PV-INP-FUNC-WT-QTY                                     10463128
104632       TO  KRPRPM-FUNC-WT-QTY                                     10463228
104633                                                                  10463328
104640                                                                  10464004
104700     PERFORM 6100-INSERT-TKRPRPM                                  10470004
104800                                                                  10480004
104900     IF PS-NO-ERROR                                               10490004
105000         IF ASC-TKRPRPM-INSERTED                                  10500004
105100             MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER            10510004
105200             SET DP020-MSG-INFORMATIONAL TO TRUE                  10520004
105300         END-IF                                                   10530004
105400     END-IF.                                                      10540004
105500                                                                  10550004
105501*----------------------------------------------------------------*10550199
105502* ENTRIES FOR ALL DC'S                                           *10550299
105503*----------------------------------------------------------------*10550399
105510 5000-PROCESS-ADD-DC-ONLY.                                        10551099
105511                                                                  10551199
105512     SET  PS-EOF-CURSOR-NO  TO  TRUE.                             10551299
105513     MOVE  ASC-PARM-CODE    TO  DK-PARM-CODE. .                   10551399
105520     PERFORM 6000-OPEN-CURSOR-DC.                                 10552099
105521     PERFORM 6005-FETCH-CURSOR-DC                                 10552199
105522       UNTIL PS-EOF-CURSOR-YES                                    10552299
105523          OR PS-ERROR.                                            10552399
105524     PERFORM 6010-CLOSE-CURSOR-DC.                                10552499
105525                                                                  10552599
105526                                                                  10552699
105527*----------------------------------------------------------------*10552799
105528* ENTRIES FOR ALL EFC'S ONLY                                     *10552899
105529*----------------------------------------------------------------*10552999
105530 5000-PROCESS-ADD-EFC-ONLY.                                       10553099
105531                                                                  10553199
105532     SET  PS-EOF-CURSOR-NO  TO  TRUE.                             10553299
105533     MOVE  ASC-PARM-CODE    TO  DK-PARM-CODE.                     10553399
105534     PERFORM 6000-OPEN-CURSOR-EFC.                                10553499
105535     PERFORM 6005-FETCH-CURSOR-EFC                                10553599
105536       UNTIL PS-EOF-CURSOR-YES                                    10553699
105537          OR PS-ERROR.                                            10553799
105538     PERFORM 6010-CLOSE-CURSOR-EFC.                               10553899
105540                                                                  10554099
105541                                                                  10554199
105542*----------------------------------------------------------------*10554299
105543* ENTRIES FOR ALL DC'S AND EFC'S                                 *10554399
105544*----------------------------------------------------------------*10554499
105550 5000-PROCESS-ADD-DC-EFC.                                         10555099
105560                                                                  10556099
105561     SET  PS-EOF-CURSOR-NO  TO  TRUE.                             10556199
105562     MOVE  ASC-PARM-CODE    TO  DK-PARM-CODE.                     10556299
105563     PERFORM 6000-OPEN-CURSOR-DC-EFC.                             10556399
105564     PERFORM 6005-FETCH-CURSOR-DC-EFC                             10556499
105565       UNTIL PS-EOF-CURSOR-YES                                    10556599
105566          OR PS-ERROR.                                            10556699
105567     PERFORM 6010-CLOSE-CURSOR-DC-EFC.                            10556799
105568                                                                  10556899
105570                                                                  10557099
105600*----------------------------------------------------------------*10560004
105700* PROCESS TABLE UPDATES                                          *10570004
105800*----------------------------------------------------------------*10580004
105900 5100-PROCESS-UPDATE.                                             10590004
106000     PERFORM 7100-UPDATE-TKRPRPM                                  10600004
106100                                                                  10610004
106200     IF ASC-TKRPRPM-UPDATED                                       10620004
106300        SET ASC-F2-CONFIRM-NO       TO TRUE                       10630004
106400        MOVE PC-TSYMSG-00059 TO DP020-MSG-NUMBER                  10640004
106500        SET DP020-MSG-INFORMATIONAL TO TRUE                       10650004
106600        MOVE DP015-PRO-NOR-OFF       TO AOPERA                    10660024
106700                                        ASYSA                     10670024
106800                                        ASTATA                    10680024
106810                                        ABYEARA                   10681024
106811                                        ABMNTHA                   10681124
106812                                        ABDAYA                    10681224
106813                                        ABHOURA                   10681324
106814                                        ABMINA                    10681424
106815                                        ABSECA                    10681524
106820                                        ABMSECA                   10682024
106821                                        AEYEARA                   10682124
106822                                        AEMNTHA                   10682224
106823                                        AEDAYA                    10682324
106824                                        AEHOURA                   10682424
106825                                        AEMINA                    10682524
106826                                        AESECA                    10682624
106827                                        AEMSECA                   10682724
106830                                        AQTYA                     10683024
106840                                        APCNTA                    10684024
106850                                        ATEXTA                    10685024
106860                                        AFQTYA                    10686024
106870                                        AFDEPA                    10687024
106880                                        AFHGTA                    10688024
106890                                        AFWGTA                    10689024
106900        MOVE DP015-BLUE              TO AOPERC                    10690024
106910                                        ASYSC                     10691024
106920                                        ASTATC                    10692024
106930                                        ABYEARC                   10693024
106940                                        ABMNTHC                   10694024
106950                                        ABDAYC                    10695024
106960                                        ABHOURC                   10696024
106970                                        ABMINC                    10697024
106980                                        ABSECC                    10698024
106990                                        ABMSECC                   10699024
106991                                        AEYEARC                   10699124
106992                                        AEMNTHC                   10699224
106993                                        AEDAYC                    10699324
106994                                        AEHOURC                   10699424
106995                                        AEMINC                    10699524
106996                                        AESECC                    10699624
106997                                        AEMSECC                   10699724
106998                                        AQTYC                     10699824
106999                                        APCNTC                    10699924
107000                                        ATEXTC                    10700024
107001                                        AFQTYC                    10700124
107002                                        AFDEPC                    10700224
107003                                        AFHGTC                    10700324
107004                                        AFWGTC                    10700424
107200        MOVE DP015-HL-OFF            TO AOPERH                    10720024
107210                                        ASYSH                     10721024
107220                                        ASTATH                    10722024
107230                                        ABYEARH                   10723024
107240                                        ABMNTHH                   10724024
107250                                        ABDAYH                    10725024
107260                                        ABHOURH                   10726024
107270                                        ABMINH                    10727024
107280                                        ABSECH                    10728024
107290                                        ABMSECH                   10729024
107291                                        AEYEARH                   10729124
107292                                        AEMNTHH                   10729224
107293                                        AEDAYH                    10729324
107294                                        AEHOURH                   10729424
107295                                        AEMINH                    10729524
107296                                        AESECH                    10729624
107297                                        AEMSECH                   10729724
107298                                        AQTYH                     10729824
107299                                        APCNTH                    10729924
107300                                        ATEXTH                    10730024
107301                                        AFQTYH                    10730124
107302                                        AFDEPH                    10730224
107303                                        AFHGTH                    10730324
107304                                        AFWGTH                    10730424
107500        MOVE -1                      TO AOPERL                    10750024
107600        SET DP030-SET-CURSOR-APPL-1  TO TRUE                      10760004
107700     END-IF.                                                      10770004
107800                                                                  10780004
107801                                                                  10780199
107802*----------------------------------------------------------------*10780299
107803* OPEN CURSOR - DC                                               *10780399
107804*----------------------------------------------------------------*10780499
107810 6000-OPEN-CURSOR-DC.                                             10781099
107811                                                                  10781199
107813     EXEC SQL                                                     10781399
107814          OPEN DC_LOC_CSR                                         10781499
107815     END-EXEC.                                                    10781599
107817                                                                  10781799
107818     EVALUATE TRUE                                                10781899
107819         WHEN SQLCODE = +0                                        10781999
107820              CONTINUE                                            10782099
107827         WHEN SQLWARN0 NOT = SPACES                               10782799
107828         WHEN SQLCODE < +0                                        10782899
107829         WHEN SQLCODE > +0                                        10782999
107830             MOVE '6000-OPEN-CURSOR-DC' TO DP013-PARAGRAPH        10783099
107831             MOVE 'CURSOR FOR ALL DC             '                10783199
107832                               TO DP013-MESSAGE-TEXT (1)          10783299
107833             MOVE SQLCA        TO DP013-SQLCA                     10783399
107834             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10783499
107835             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10783599
107836             SET DP013-DB2-ABEND                                  10783699
107837                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10783799
107838             PERFORM DP013-0000-PROCESS-ABEND                     10783899
107839     END-EVALUATE.                                                10783999
107840                                                                  10784099
107841                                                                  10784199
107842*----------------------------------------------------------------*10784299
107843* OPEN CURSOR - EFC                                              *10784399
107844*----------------------------------------------------------------*10784499
107845 6000-OPEN-CURSOR-EFC.                                            10784599
107846                                                                  10784699
107848     EXEC SQL                                                     10784899
107849          OPEN EFC_LOC_CSR                                        10784999
107850     END-EXEC.                                                    10785099
107851                                                                  10785199
107852     EVALUATE TRUE                                                10785299
107854         WHEN SQLCODE = +0                                        10785499
107855              CONTINUE                                            10785599
107856         WHEN SQLWARN0 NOT = SPACES                               10785699
107857         WHEN SQLCODE < +0                                        10785799
107858         WHEN SQLCODE > +0                                        10785899
107859             MOVE '6000-OPEN-CURSOR-EFC' TO DP013-PARAGRAPH       10785999
107860             MOVE 'CURSOR FOR ALL EFC            '                10786099
107861                               TO DP013-MESSAGE-TEXT (1)          10786199
107862             MOVE SQLCA        TO DP013-SQLCA                     10786299
107863             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10786399
107864             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10786499
107865             SET DP013-DB2-ABEND                                  10786599
107866                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10786699
107867             PERFORM DP013-0000-PROCESS-ABEND                     10786799
107868     END-EVALUATE.                                                10786899
107869                                                                  10786999
107870                                                                  10787099
107871*----------------------------------------------------------------*10787199
107872* OPEN CURSOR - DC & EFC                                         *10787299
107873*----------------------------------------------------------------*10787399
107874 6000-OPEN-CURSOR-DC-EFC.                                         10787499
107875                                                                  10787599
107877     EXEC SQL                                                     10787799
107878          OPEN DC_EFC_LOC_CSR                                     10787899
107879     END-EXEC.                                                    10787999
107880                                                                  10788099
107881     EVALUATE TRUE                                                10788199
107882         WHEN SQLCODE = +0                                        10788299
107883              CONTINUE                                            10788399
107884         WHEN SQLWARN0 NOT = SPACES                               10788499
107885         WHEN SQLCODE < +0                                        10788599
107886         WHEN SQLCODE > +0                                        10788699
107887             MOVE '6000-OPEN-CURSOR-DC-EFC'                       10788799
107888                                         TO DP013-PARAGRAPH       10788899
107889             MOVE 'CURSOR FOR ALL DC AND EFC     '                10788999
107890                               TO DP013-MESSAGE-TEXT (1)          10789099
107891             MOVE SQLCA        TO DP013-SQLCA                     10789199
107892             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10789299
107893             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10789399
107894             SET DP013-DB2-ABEND                                  10789499
107895                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10789599
107896             PERFORM DP013-0000-PROCESS-ABEND                     10789699
107897     END-EVALUATE.                                                10789799
107898                                                                  10789899
107899                                                                  10789999
107900*----------------------------------------------------------------*10790099
107901* FETCH CURSOR - DC                                              *10790199
107902*----------------------------------------------------------------*10790299
107903 6005-FETCH-CURSOR-DC.                                            10790399
107904                                                                  10790499
107906     EXEC SQL                                                     10790699
107907          FETCH DC_LOC_CSR                                        10790799
107908           INTO :XLT00010-LOC-NBR                                 10790899
107920     END-EXEC.                                                    10792099
107921                                                                  10792199
107922     EVALUATE TRUE                                                10792299
107923         WHEN SQLCODE = +0                                        10792399
107924              PERFORM 5020-PROCESS-CSR-ADD                        10792499
107925         WHEN SQLCODE = +100                                      10792599
107926              SET  PS-EOF-CURSOR-YES  TO  TRUE                    10792699
107927         WHEN SQLWARN0 NOT = SPACES                               10792799
107928         WHEN SQLCODE < +0                                        10792899
107929         WHEN SQLCODE > +0                                        10792999
107930             MOVE '6005-FETCH-CURSOR-DC' TO DP013-PARAGRAPH       10793099
107931             MOVE 'FETCH CURSOR FOR ALL DC        '               10793199
107932                               TO DP013-MESSAGE-TEXT (1)          10793299
107933             MOVE SQLCA        TO DP013-SQLCA                     10793399
107934             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10793499
107935             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10793599
107936             SET DP013-DB2-ABEND                                  10793699
107937                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10793799
107938             PERFORM DP013-0000-PROCESS-ABEND                     10793899
107939     END-EVALUATE.                                                10793999
107940                                                                  10794099
107941                                                                  10794199
107942*----------------------------------------------------------------*10794299
107943* FETCH CURSOR - EFC                                             *10794399
107944*----------------------------------------------------------------*10794499
107945 6005-FETCH-CURSOR-EFC.                                           10794599
107946                                                                  10794699
107947     EXEC SQL                                                     10794799
107948          FETCH EFC_LOC_CSR                                       10794899
107949           INTO :XLT00010-LOC-NBR                                 10794999
107950     END-EXEC.                                                    10795099
107951                                                                  10795199
107952     EVALUATE TRUE                                                10795299
107953         WHEN SQLCODE = +0                                        10795399
107954              PERFORM 5020-PROCESS-CSR-ADD                        10795499
107955         WHEN SQLCODE = +100                                      10795599
107956              SET  PS-EOF-CURSOR-YES  TO  TRUE                    10795699
107957         WHEN SQLWARN0 NOT = SPACES                               10795799
107958         WHEN SQLCODE < +0                                        10795899
107959         WHEN SQLCODE > +0                                        10795999
107960             MOVE '6005-FETCH-CURSOR-EFC' TO DP013-PARAGRAPH      10796099
107961             MOVE 'FETCH CURSOR FOR ALL EFC       '               10796199
107962                               TO DP013-MESSAGE-TEXT (1)          10796299
107963             MOVE SQLCA        TO DP013-SQLCA                     10796399
107964             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10796499
107965             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10796599
107966             SET DP013-DB2-ABEND                                  10796699
107967                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10796799
107968             PERFORM DP013-0000-PROCESS-ABEND                     10796899
107969     END-EVALUATE.                                                10796999
107970                                                                  10797099
107971                                                                  10797199
107972*----------------------------------------------------------------*10797299
107973* FETCH CURSOR - DC & EFC                                        *10797399
107974*----------------------------------------------------------------*10797499
107975 6005-FETCH-CURSOR-DC-EFC.                                        10797599
107976                                                                  10797699
107977     EXEC SQL                                                     10797799
107978          FETCH DC_EFC_LOC_CSR                                    10797899
107979           INTO :XLT00010-LOC-NBR                                 10797999
107980     END-EXEC.                                                    10798099
107981                                                                  10798199
107982     EVALUATE TRUE                                                10798299
107983         WHEN SQLCODE = +0                                        10798399
107984              PERFORM 5020-PROCESS-CSR-ADD                        10798499
107986         WHEN SQLCODE = +100                                      10798699
107987              SET  PS-EOF-CURSOR-YES  TO  TRUE                    10798799
107988         WHEN SQLWARN0 NOT = SPACES                               10798899
107989         WHEN SQLCODE < +0                                        10798999
107990         WHEN SQLCODE > +0                                        10799099
107991             MOVE '6005-FETCH-CURSOR-DC-EFC'                      10799199
107992                                          TO DP013-PARAGRAPH      10799299
107993             MOVE 'FETCH CURSOR FOR ALL DC AND EFC'               10799399
107994                               TO DP013-MESSAGE-TEXT (1)          10799499
107995             MOVE SQLCA        TO DP013-SQLCA                     10799599
107996             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10799699
107997             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10799799
107998             SET DP013-DB2-ABEND                                  10799899
107999                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10799999
108000             PERFORM DP013-0000-PROCESS-ABEND                     10800099
108001     END-EVALUATE.                                                10800199
108002                                                                  10800299
108003                                                                  10800399
108004*----------------------------------------------------------------*10800499
108005* CLOSE CURSOR - DC                                              *10800599
108006*----------------------------------------------------------------*10800699
108007 6010-CLOSE-CURSOR-DC.                                            10800799
108008                                                                  10800899
108009     EXEC SQL                                                     10800999
108010          CLOSE DC_LOC_CSR                                        10801099
108011     END-EXEC.                                                    10801199
108012                                                                  10801299
108013     EVALUATE TRUE                                                10801399
108014         WHEN SQLCODE = +0                                        10801499
108015              CONTINUE                                            10801599
108016         WHEN SQLWARN0 NOT = SPACES                               10801699
108017         WHEN SQLCODE < +0                                        10801799
108018         WHEN SQLCODE > +0                                        10801899
108019             MOVE '6010-CLOSE-CURSOR-DC' TO DP013-PARAGRAPH       10801999
108020             MOVE 'CLOSE CURSOR FOR ALL DC        '               10802099
108021                               TO DP013-MESSAGE-TEXT (1)          10802199
108022             MOVE SQLCA        TO DP013-SQLCA                     10802299
108023             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10802399
108024             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10802499
108025             SET DP013-DB2-ABEND                                  10802599
108026                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10802699
108027             PERFORM DP013-0000-PROCESS-ABEND                     10802799
108028     END-EVALUATE.                                                10802899
108029                                                                  10802999
108030                                                                  10803099
108031*----------------------------------------------------------------*10803199
108032* CLOSE CURSOR - EFC                                             *10803299
108033*----------------------------------------------------------------*10803399
108034 6010-CLOSE-CURSOR-EFC.                                           10803499
108035                                                                  10803599
108036     EXEC SQL                                                     10803699
108037          CLOSE EFC_LOC_CSR                                       10803799
108038     END-EXEC.                                                    10803899
108039                                                                  10803999
108040     EVALUATE TRUE                                                10804099
108041         WHEN SQLCODE = +0                                        10804199
108042              CONTINUE                                            10804299
108043         WHEN SQLWARN0 NOT = SPACES                               10804399
108044         WHEN SQLCODE < +0                                        10804499
108045         WHEN SQLCODE > +0                                        10804599
108046             MOVE '6010-CLOSE-CURSOR-EFC' TO DP013-PARAGRAPH      10804699
108047             MOVE 'CLOSE CURSOR FOR ALL EFC       '               10804799
108048                               TO DP013-MESSAGE-TEXT (1)          10804899
108049             MOVE SQLCA        TO DP013-SQLCA                     10804999
108050             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10805099
108051             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10805199
108052             SET DP013-DB2-ABEND                                  10805299
108053                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10805399
108054             PERFORM DP013-0000-PROCESS-ABEND                     10805499
108055     END-EVALUATE.                                                10805599
108056                                                                  10805699
108057                                                                  10805799
108058*----------------------------------------------------------------*10805899
108059* CLOSE CURSOR - DC & EFC                                        *10805999
108060*----------------------------------------------------------------*10806099
108061 6010-CLOSE-CURSOR-DC-EFC.                                        10806199
108062                                                                  10806299
108063     EXEC SQL                                                     10806399
108064          CLOSE DC_EFC_LOC_CSR                                    10806499
108065     END-EXEC.                                                    10806599
108066                                                                  10806699
108067     EVALUATE TRUE                                                10806799
108068         WHEN SQLCODE = +0                                        10806899
108069              CONTINUE                                            10806999
108070         WHEN SQLWARN0 NOT = SPACES                               10807099
108071         WHEN SQLCODE < +0                                        10807199
108072         WHEN SQLCODE > +0                                        10807299
108073             MOVE '6010-CLOSE-CURSOR-DC-EFC'                      10807399
108074                                          TO DP013-PARAGRAPH      10807499
108075             MOVE 'CLOSE CURSOR FOR ALL DC AND EFC'               10807599
108076                               TO DP013-MESSAGE-TEXT (1)          10807699
108077             MOVE SQLCA        TO DP013-SQLCA                     10807799
108078             MOVE 'XLT_LOC'   TO DP013-DB2-TABLE-NAME (1)         10807899
108079             MOVE 'TKRPRPM'   TO DP013-DB2-TABLE-NAME (2)         10807999
108080             SET DP013-DB2-ABEND                                  10808099
108081                 DP013-XCTL-DISPLAY-RESTART TO TRUE               10808199
108082             PERFORM DP013-0000-PROCESS-ABEND                     10808299
108083     END-EVALUATE.                                                10808399
108084                                                                  10808499
108085                                                                  10808599
108086*----------------------------------------------------------------*10808699
108087* PROCESS TABLE INSERTS - FROM CURSOR                            *10808799
108088*----------------------------------------------------------------*10808899
108089 5020-PROCESS-CSR-ADD.                                            10808999
108090                                                                  10809099
108091     MOVE  XLT00010-LOC-NBR                                       10809199
108092       TO  KRPRPM-LOC-ID                                          10809299
108093     MOVE  PV-INP-INTFC-SYS-CDE                                   10809399
108094       TO  KRPRPM-INTFC-SYS-CDE                                   10809499
108095     MOVE  ASC-PARM-CODE                                          10809599
108096       TO  KRPRPM-SYS-PRC-FUNC-CDE                                10809699
108097     MOVE  PV-INP-FUNC-PRC-STAT-CDE                               10809799
108098       TO  KRPRPM-FUNC-PRC-STAT-CDE                               10809899
108099     MOVE  PV-INP-FUNC-BEG-TMST                                   10809999
108100       TO  KRPRPM-FUNC-BEG-TMST                                   10810099
108101     MOVE  PV-INP-FUNC-END-TMST                                   10810199
108102       TO  KRPRPM-FUNC-END-TMST                                   10810299
108103                                                                  10810399
108104     IF  PV-INP-FUNC-QTY  >  0  OR                                10810499
108105         PV-INP-FUNC-QTY  <  0                                    10810599
108106         MOVE  PV-INP-FUNC-QTY                                    10810699
108107           TO  KRPRPM-FUNC-QTY                                    10810799
108108         MOVE  +0                                                 10810899
108109           TO ASC-PM-FUNC-QTY-NULL                                10810999
108110     ELSE                                                         10811099
108111         INITIALIZE  KRPRPM-FUNC-QTY                              10811199
108112         MOVE  -1  TO  ASC-PM-FUNC-QTY-NULL                       10811299
108113     END-IF                                                       10811399
108114                                                                  10811499
108115     IF  PV-INP-FUNC-PCT  >  0                                    10811599
108116         MOVE  PV-INP-FUNC-PCT                                    10811699
108117           TO  KRPRPM-FUNC-PCT                                    10811799
108118         MOVE  +0                                                 10811899
108119           TO   ASC-PM-FUNC-PCT-NULL                              10811999
108120     ELSE                                                         10812099
108121         INITIALIZE  KRPRPM-FUNC-PCT                              10812199
108122         MOVE  -1  TO  ASC-PM-FUNC-PCT-NULL                       10812299
108123     END-IF                                                       10812399
108124                                                                  10812499
108125     IF  PV-INP-FUNC-TXT  >  SPACES                               10812599
108126         MOVE  PV-INP-FUNC-TXT                                    10812699
108127           TO  KRPRPM-FUNC-TXT                                    10812799
108128         MOVE  +0                                                 10812899
108129           TO  ASC-PM-FUNC-TXT-NULL                               10812999
108130     ELSE                                                         10813099
108131         INITIALIZE  KRPRPM-FUNC-TXT                              10813199
108132         MOVE  -1  TO  ASC-PM-FUNC-TXT-NULL                       10813299
108133     END-IF                                                       10813399
108134                                                                  10813499
108136     MOVE  PV-INP-FUNC-WD-QTY                                     10813699
108137       TO  KRPRPM-FUNC-WD-QTY                                     10813799
108138     MOVE  PV-INP-FUNC-DPTH-QTY                                   10813899
108139       TO  KRPRPM-FUNC-DPTH-QTY                                   10813999
108140     MOVE  PV-INP-FUNC-HT-QTY                                     10814099
108141       TO  KRPRPM-FUNC-HT-QTY                                     10814199
108142     MOVE  PV-INP-FUNC-WT-QTY                                     10814299
108143       TO  KRPRPM-FUNC-WT-QTY                                     10814399
108144                                                                  10814499
108145                                                                  10814599
108146     PERFORM 6100-INSERT-TKRPRPM                                  10814699
108147                                                                  10814799
108148     IF PS-NO-ERROR                                               10814899
108149         IF ASC-TKRPRPM-INSERTED                                  10814999
108150             MOVE PC-TSYMSG-00034  TO DP020-MSG-NUMBER            10815099
108151             SET DP020-MSG-INFORMATIONAL TO TRUE                  10815199
108152         END-IF                                                   10815299
108153     END-IF.                                                      10815399
108154                                                                  10815499
108155*----------------------------------------------------------------*10815599
108156* INSERT A ROW INTO THE CONTROL DC DOOR TABLE                    *10815604
108160*----------------------------------------------------------------*10816004
108200 6100-INSERT-TKRPRPM.                                             10820004
108310         EXEC SQL                                                 10831004
108400                 INSERT INTO TKRPRPM                              10840004
108500                 (                                                10850004
108600                  LOC_ID                                          10860008
108610                 ,INTFC_SYS_CDE                                   10861009
108620                 ,SYS_PRC_FUNC_CDE                                10862009
108630                 ,FUNC_PRC_STAT_CDE                               10863009
108640                 ,FUNC_BEG_TMST                                   10864009
108650                 ,FUNC_END_TMST                                   10865009
108660                 ,FUNC_QTY                                        10866009
108670                 ,FUNC_PCT                                        10867009
108680                 ,FUNC_TXT                                        10868009
108690                 ,FUNC_WD_QTY                                     10869009
108691                 ,FUNC_DPTH_QTY                                   10869109
108700                 ,FUNC_HT_QTY                                     10870008
108800                 ,FUNC_WT_QTY                                     10880008
108900                 )                                                10890004
109000                 VALUES                                           10900004
109100                 (                                                10910004
109200                  :KRPRPM-LOC-ID                                  10920011
109210                 ,:KRPRPM-INTFC-SYS-CDE                           10921012
109300                 ,:KRPRPM-SYS-PRC-FUNC-CDE                        10930011
109400                 ,:KRPRPM-FUNC-PRC-STAT-CDE                       10940011
109410                 ,:KRPRPM-FUNC-BEG-TMST                           10941099
109411                          :ASC-PM-FUNC-BEG-TMST-NULL              10941199
109420                 ,:KRPRPM-FUNC-END-TMST                           10942099
109421                          :ASC-PM-FUNC-END-TMST-NULL              10942199
109430                 ,:KRPRPM-FUNC-QTY :ASC-PM-FUNC-QTY-NULL          10943099
109440                 ,:KRPRPM-FUNC-PCT :ASC-PM-FUNC-PCT-NULL          10944099
109450                 ,:KRPRPM-FUNC-TXT :ASC-PM-FUNC-TXT-NULL          10945099
109460                 ,:KRPRPM-FUNC-WD-QTY                             10946011
109470                 ,:KRPRPM-FUNC-DPTH-QTY                           10947011
109480                 ,:KRPRPM-FUNC-HT-QTY                             10948011
109490                 ,:KRPRPM-FUNC-WT-QTY                             10949011
109500                 )                                                10950004
109600         END-EXEC.                                                10960004
109700                                                                  10970004
109800         EVALUATE TRUE                                            10980004
109900             WHEN SQLCODE = +0                                    10990004
110000                 SET ASC-TKRPRPM-INSERTED TO TRUE                 11000004
110400             WHEN SQLCODE = -803                                  11040004
110600                 MOVE PC-TSYMSG-03709         TO DP020-MSG-NUMBER 11060004
110700                 SET DP020-MSG-FATAL                              11070004
110800                     PS-ERROR                 TO TRUE             11080004
110900                 MOVE DP015-RED               TO AOPERC           11090029
111000                 MOVE DP015-REVERSE           TO AOPERH           11100029
111100                 MOVE -1                      TO AOPERL           11110029
111200                 SET DP030-SET-CURSOR-APPL-1  TO TRUE             11120004
111300             WHEN SQLWARN0 NOT = SPACES                           11130004
111400             WHEN SQLCODE < +0                                    11140004
111500             WHEN SQLCODE > +0                                    11150004
111600                 MOVE '6100-INSERT-TKRPRPM' TO DP013-PARAGRAPH    11160004
111700                 MOVE 'ERROR INSERTING ROW TO TKRPRPM'            11170004
111800                                   TO DP013-MESSAGE-TEXT (1)      11180004
111900                 MOVE SQLCA        TO DP013-SQLCA                 11190004
112000                 MOVE 'TKRPRPM'    TO DP013-DB2-TABLE-NAME (1)    11200004
112100                 SET DP013-DB2-ABEND                              11210004
112200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11220004
112300                 PERFORM DP013-0000-PROCESS-ABEND                 11230004
112400         END-EVALUATE.                                            11240004
112500                                                                  11250004
112600******************************************************************11260004
112700** UPDATE A ROW ON THE PARM CODE TABLE - TKRPRPM                  11270004
112800******************************************************************11280004
112900 7100-UPDATE-TKRPRPM.                                             11290004
112920     MOVE  ASC-PM-LOC-ID                                          11292007
112921       TO  KRPRPM-LOC-ID                                          11292107
112940     MOVE  ASC-PM-INTFC-SYS-CDE                                   11294007
112941       TO  KRPRPM-INTFC-SYS-CDE                                   11294107
112960     MOVE  ASC-PARM-CODE                                          11296028
112961       TO  KRPRPM-SYS-PRC-FUNC-CDE                                11296107
112980     MOVE  ASC-PM-FUNC-PRC-STAT-CDE                               11298007
112981       TO  KRPRPM-FUNC-PRC-STAT-CDE                               11298107
112991     MOVE  ASC-PM-FUNC-BEG-TMST                                   11299107
112992       TO  KRPRPM-FUNC-BEG-TMST                                   11299207
112994     MOVE  ASC-PM-FUNC-END-TMST                                   11299407
112995       TO  KRPRPM-FUNC-END-TMST                                   11299507
112996                                                                  11299699
112997     IF  ASC-PM-FUNC-QTY  >  0 OR                                 11299799
112998         ASC-PM-FUNC-QTY  <  0                                    11299899
112999         MOVE  ASC-PM-FUNC-QTY-N                                  11299999
113000           TO  KRPRPM-FUNC-QTY                                    11300099
113001         MOVE  +0                                                 11300199
113002           TO  ASC-PM-FUNC-QTY-NULL                               11300299
113003     ELSE                                                         11300399
113004         INITIALIZE  KRPRPM-FUNC-QTY                              11300499
113005         MOVE  -1  TO  ASC-PM-FUNC-QTY-NULL                       11300599
113006     END-IF                                                       11300699
113007                                                                  11300799
113008     IF  ASC-PM-FUNC-PCT  >  0                                    11300899
113009         MOVE  ASC-PM-FUNC-PCT-N                                  11300999
113010           TO  KRPRPM-FUNC-PCT                                    11301099
113011         MOVE  +0                                                 11301199
113012           TO  ASC-PM-FUNC-PCT-NULL                               11301299
113013     ELSE                                                         11301399
113014         INITIALIZE  KRPRPM-FUNC-PCT                              11301499
113015         MOVE  -1  TO  ASC-PM-FUNC-PCT-NULL                       11301599
113016     END-IF                                                       11301699
113017                                                                  11301799
113018     IF  ASC-PM-FUNC-TXT  >  SPACES                               11301899
113019         MOVE  ASC-PM-FUNC-TXT                                    11301999
113020           TO  KRPRPM-FUNC-TXT                                    11302099
113021         MOVE  +0                                                 11302199
113022           TO  ASC-PM-FUNC-TXT-NULL                               11302299
113023     ELSE                                                         11302399
113024         INITIALIZE  KRPRPM-FUNC-TXT                              11302499
113025         MOVE  -1  TO  ASC-PM-FUNC-TXT-NULL                       11302599
113026     END-IF                                                       11302699
113027                                                                  11302799
113029     MOVE  ASC-PM-FUNC-WD-QTY-N                                   11302999
113030       TO  KRPRPM-FUNC-WD-QTY                                     11303007
113031     MOVE  ASC-PM-FUNC-DPTH-QTY-N                                 11303199
113032       TO  KRPRPM-FUNC-DPTH-QTY                                   11303207
113033     MOVE  ASC-PM-FUNC-HT-QTY-N                                   11303399
113034       TO  KRPRPM-FUNC-HT-QTY                                     11303407
113035     MOVE  ASC-PM-FUNC-WT-QTY-N                                   11303599
113040       TO  KRPRPM-FUNC-WT-QTY                                     11304007
113300                                                                  11330004
113400     PERFORM                                                      11340004
113500         WITH TEST AFTER                                          11350004
113600         VARYING PV-RETRY-COUNTER                                 11360004
113700         FROM 1 BY 1                                              11370004
113800         UNTIL ((PV-RETRY-COUNTER > PC-MAX-RETRIES)               11380004
113900         OR     (SQLCODE = ZERO)                                  11390004
114000         OR     (SQLCODE = +100))                                 11400004
114100                                                                  11410004
114200         EXEC SQL                                                 11420004
114300             UPDATE TKRPRPM                                       11430004
114400               SET                                                11440004
114610                  FUNC_PRC_STAT_CDE  = :KRPRPM-FUNC-PRC-STAT-CDE  11461013
114630                 ,FUNC_BEG_TMST      = :KRPRPM-FUNC-BEG-TMST      11463013
114640                                       :ASC-PM-FUNC-BEG-TMST-NULL 11464099
114650                 ,FUNC_END_TMST      = :KRPRPM-FUNC-END-TMST      11465013
114660                                       :ASC-PM-FUNC-END-TMST-NULL 11466099
114670                 ,FUNC_QTY           = :KRPRPM-FUNC-QTY           11467013
114680                                       :ASC-PM-FUNC-QTY-NULL      11468099
114690                 ,FUNC_PCT           = :KRPRPM-FUNC-PCT           11469013
114691                                       :ASC-PM-FUNC-PCT-NULL      11469199
114692                 ,FUNC_TXT           = :KRPRPM-FUNC-TXT           11469213
114693                                       :ASC-PM-FUNC-TXT-NULL      11469399
114694                 ,FUNC_WD_QTY        = :KRPRPM-FUNC-WD-QTY        11469413
114696                 ,FUNC_DPTH_QTY      = :KRPRPM-FUNC-DPTH-QTY      11469613
114698                 ,FUNC_HT_QTY        = :KRPRPM-FUNC-HT-QTY        11469813
114700                 ,FUNC_WT_QTY        = :KRPRPM-FUNC-WT-QTY        11470013
114701            WHERE LOC_ID             = :KRPRPM-LOC-ID             11470107
114710              AND INTFC_SYS_CDE      = :KRPRPM-INTFC-SYS-CDE      11471007
114720              AND SYS_PRC_FUNC_CDE   = :KRPRPM-SYS-PRC-FUNC-CDE   11472099
114800         END-EXEC                                                 11480004
114900                                                                  11490004
115000         EVALUATE TRUE                                            11500004
115100             WHEN SQLCODE = +0                                    11510004
115200                 SET ASC-TKRPRPM-UPDATED TO TRUE                  11520004
115300             WHEN SQLWARN0 NOT = SPACES                           11530004
115400             WHEN SQLCODE < +0                                    11540004
115500             WHEN SQLCODE > +0                                    11550004
115600                 MOVE '7100-UPDATE-TKRPRPM' TO DP013-PARAGRAPH    11560004
115700                 MOVE 'ERROR UPDATING THE DC DOOR TABLE'          11570004
115800                                   TO DP013-MESSAGE-TEXT (1)      11580004
115900                 MOVE SQLCA        TO DP013-SQLCA                 11590004
116000                 MOVE 'TKRPRPM'    TO DP013-DB2-TABLE-NAME (1)    11600004
116100                 SET DP013-DB2-ABEND                              11610004
116200                     DP013-XCTL-DISPLAY-RESTART TO TRUE           11620004
116300                 PERFORM DP013-0000-PROCESS-ABEND                 11630004
116400         END-EVALUATE                                             11640004
116500     END-PERFORM.                                                 11650004
116600                                                                  11660004
116700     IF PV-RETRY-COUNTER > PC-MAX-RETRIES                         11670004
116800         MOVE '7100-UPDATE-TKRPRPM' TO DP013-PARAGRAPH            11680004
116900         MOVE 'MAXIMUM RETRIES EXCEEDED ATTEMPTING TO SELECT'     11690004
117000                                       TO DP013-MESSAGE-TEXT (1)  11700004
117100         MOVE SQLCA          TO DP013-SQLCA                       11710004
117200         MOVE 'TKRPRPM'      TO DP013-DB2-TABLE-NAME (1)          11720004
117300         SET DP013-DB2-ABEND                                      11730004
117400             DP013-XCTL-DISPLAY-RESTART TO TRUE                   11740004
117500         PERFORM DP013-0000-PROCESS-ABEND                         11750004
117600     END-IF.                                                      11760004
117700     MOVE +0 TO PV-RETRY-COUNTER.                                 11770004
117800                                                                  11780004
117900*----------------------------------------------------------------*11790004
118000* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *11800004
118100*----------------------------------------------------------------*11810004
118200 9100-READ-SEL-QUEUE.                                             11820004
118300     EXEC CICS                                                    11830004
118400         READQ TS                                                 11840004
118500             QUEUE (ASC-SEL-QUEUE-NAME)                           11850004
118600             INTO  (CN019-SELECT-RECORD)                          11860004
118700             ITEM  (ASC-SEL-ITEM)                                 11870004
118800             RESP  (PV-CICS-RESPONSE)                             11880004
118900     END-EXEC.                                                    11890004
119000                                                                  11900004
119100     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       11910004
119200         CONTINUE                                                 11920004
119300     ELSE                                                         11930004
119400         SET DP013-LOGIC-ABEND                                    11940004
119500             DP013-NO-ROLLBACK     TO TRUE                        11950004
119600         MOVE '9100-READ-SEL-QUEUE' TO DP013-PARAGRAPH            11960004
119700         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   11970004
119800                                   TO DP013-MESSAGE-TEXT (1)      11980004
119900         PERFORM DP013-0000-PROCESS-ABEND                         11990004
120000     END-IF.                                                      12000004
120100                                                                  12010004
120110*----------------------------------------------------------------*12011075
120120* READ AN ITEM FROM THE SELECTED ITEMS TEMP STORAGE QUEUE.       *12012075
120130*----------------------------------------------------------------*12013075
120140 9100A-READ-SEL-QUEUE.                                            12014076
120150     EXEC CICS                                                    12015075
120160         READQ TS                                                 12016075
120170             QUEUE (ASC-SEL-QUEUE-NAME)                           12017075
120180             INTO  (CN021-SELECT-RECORD)                          12018075
120190             ITEM  (ASC-SEL-ITEM)                                 12019075
120191             RESP  (PV-CICS-RESPONSE)                             12019175
120192     END-EXEC.                                                    12019275
120193                                                                  12019375
120194     IF  PV-CICS-RESPONSE = DFHRESP(NORMAL)                       12019475
120195         CONTINUE                                                 12019575
120196     ELSE                                                         12019675
120197         SET DP013-LOGIC-ABEND                                    12019775
120198             DP013-NO-ROLLBACK     TO TRUE                        12019875
120199         MOVE '9100A-READ-SEL-QUEUE' TO DP013-PARAGRAPH           12019976
120200         MOVE 'ATTEMPTING TO READ THE LIST SELECTIONS TS QUEUE'   12020075
120201                                   TO DP013-MESSAGE-TEXT (1)      12020175
120202         PERFORM DP013-0000-PROCESS-ABEND                         12020275
120203     END-IF.                                                      12020375
120204                                                                  12020475
120210*----------------------------------------------------------------*12021004
120300* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *12030004
120400*----------------------------------------------------------------*12040004
120500 9200-REWRITE-SEL-QUEUE.                                          12050004
120600     EXEC CICS                                                    12060004
120700          WRITEQ TS                                               12070004
120800              QUEUE  (ASC-SEL-QUEUE-NAME)                         12080004
120900              FROM   (CN019-SELECT-RECORD)                        12090004
121000              ITEM   (ASC-SEL-ITEM)                               12100004
121100              RESP   (PV-CICS-RESPONSE)                           12110004
121200              REWRITE                                             12120004
121300     END-EXEC.                                                    12130004
121400                                                                  12140004
121500     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   12150004
121600         SET DP013-CICS-ABEND                                     12160004
121700             DP013-NO-ROLLBACK     TO TRUE                        12170004
121800         MOVE '9200-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH        12180004
121900         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   12190004
122000                                   TO DP013-MESSAGE-TEXT (1)      12200004
122100         PERFORM DP013-0000-PROCESS-ABEND                         12210004
122200     END-IF.                                                      12220004
122300                                                                  12230004
122310*----------------------------------------------------------------*12231075
122320* UPDATE AN ITEM IN THE SELECTED ITEMS TEMP STORAGE QUEUE.       *12232075
122330*----------------------------------------------------------------*12233075
122340 9200A-REWRITE-SEL-QUEUE.                                         12234076
122350     EXEC CICS                                                    12235075
122360          WRITEQ TS                                               12236075
122370              QUEUE  (ASC-SEL-QUEUE-NAME)                         12237075
122380              FROM   (CN021-SELECT-RECORD)                        12238075
122390              ITEM   (ASC-SEL-ITEM)                               12239075
122391              RESP   (PV-CICS-RESPONSE)                           12239175
122392              REWRITE                                             12239275
122393     END-EXEC.                                                    12239375
122394                                                                  12239475
122395     IF  PV-CICS-RESPONSE NOT = DFHRESP(NORMAL)                   12239575
122396         SET DP013-CICS-ABEND                                     12239675
122397             DP013-NO-ROLLBACK     TO TRUE                        12239775
122398         MOVE '9200A-REWRITE-SEL-QUEUE'  TO DP013-PARAGRAPH       12239876
122399         MOVE 'ATTEMPTING TO REWRITE THE LIST SELECTIONS QUEUE'   12239975
122400                                   TO DP013-MESSAGE-TEXT (1)      12240075
122401         PERFORM DP013-0000-PROCESS-ABEND                         12240175
122402     END-IF.                                                      12240275
122403                                                                  12240375
122410     COPY DPPD013.                                                12241004
122500*----------------------------------------------------------------*12250004
122600*    ABEND PROCESSOR MODULE                                      *12260004
122700*----------------------------------------------------------------*12270004
