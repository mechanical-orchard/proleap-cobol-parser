000100*************************                                         00010000
000200 IDENTIFICATION DIVISION.                                         00020000
000300*************************                                         00030000
000400 PROGRAM-ID.      DPKUT007.                                       00040000
000500 AUTHOR.          MICHAEL N TYE, CAP GEMINI AMERICA.              00050000
000600 INSTALLATION.    KOHLS DEPARTMENT STORES.                        00060000
000700 DATE-WRITTEN.    AUGUST 12, 1988.                                00070000
000800 DATE-COMPILED.                                                   00080000
000900                                                                  00090000
001000*             THIS PROGRAM USES THE OUTPUT (AFTER BEING           00100000
001100*             SORTED BY FILE NAME), FROM PROGRAM PROCXREF         00110000
001200*             (DDNAME SORTOUT) AS INPUT TO CREATE A FILE          00120000
001300*             TO BE USED IN PROGRAM DPKUT005.                     00130000
001400                                                                  00140000
001500 ENVIRONMENT DIVISION.                                            00150000
001600 CONFIGURATION SECTION.                                           00160000
001700 SOURCE-COMPUTER. IBM-3090.                                       00170000
001800 OBJECT-COMPUTER. IBM-3090.                                       00180000
001900                                                                  00190000
002000 INPUT-OUTPUT SECTION.                                            00200000
002100 FILE-CONTROL.                                                    00210000
002200     SELECT PROCXREF-SORTED-FILE                                  00220004
002210         ASSIGN TO INP01.                                         00221004
002211     SELECT FILE-LIST-FILE                                        00221104
002212         ASSIGN TO SMDELIN                                        00221204
002220         FILE STATUS IS PV-FL-FILE-STATUS.                        00222004
002300     SELECT PROCXREF-EDITED-FILE                                  00230004
002301         ASSIGN TO OUT01.                                         00230104
002400                                                                  00240016
002500***************                                                   00250000
002600 DATA DIVISION.                                                   00260000
002700***************                                                   00270000
002800 FILE SECTION.                                                    00280000
002810                                                                  00281016
002900 FD  PROCXREF-SORTED-FILE                                         00290000
002910     RECORDING MODE F                                             00291016
002920     LABEL RECORDS ARE STANDARD                                   00292016
003000     BLOCK CONTAINS 0 RECORDS                                     00300016
003100     RECORD CONTAINS 143 CHARACTERS                               00310016
003400     DATA RECORD IS PROCXREF-SORTED-REC.                          00340016
003410                                                                  00341016
003500 01  PROCXREF-SORTED-REC     PIC X(143).                          00350000
003600                                                                  00360000
003620 FD  FILE-LIST-FILE                                               00362003
003630     RECORDING MODE IS F                                          00363003
003640     LABEL RECORDS ARE STANDARD                                   00364003
003650     BLOCK CONTAINS 0 RECORDS                                     00365003
003660     RECORD CONTAINS 80 CHARACTERS                                00366003
003670     DATA RECORD IS FL-FILE-LIST-RECORD.                          00367003
003680                                                                  00368003
003690 01  FL-FILE-LIST-RECORD         PIC X(80).                       00369003
003691                                                                  00369103
003700 FD  PROCXREF-EDITED-FILE                                         00370000
003710     RECORDING MODE F                                             00371016
003720     LABEL RECORDS ARE STANDARD                                   00372016
003800     BLOCK CONTAINS 0 RECORDS                                     00380016
003900     RECORD CONTAINS 143 CHARACTERS                               00390016
004200     DATA RECORD IS PROCXREF-EDITED-REC.                          00420016
004210                                                                  00421016
004300 01  PROCXREF-EDITED-REC     PIC X(143).                          00430000
004400                                                                  00440000
004600 WORKING-STORAGE SECTION.                                         00460000
004710                                                                  00471001
004720*                                                                 00472001
004730*  PARAMETER LIST FOR THE DYNAMIC ALLOCATION ROUTINE              00473001
004740*                                                                 00474001
004750     COPY DPWS023.                                                00475001
004760                                                                  00476001
004770 01  ABEND-CODE                  PIC S9(4)    VALUE ZEROS         00477001
004780                                              COMP SYNC.          00478001
004790     88  AC-NO-ERROR                          VALUE ZEROS.        00479001
004800**   PROCXREF-SORTED-FILE LAYOUT (INPUT)    **                    00480000
004900**      AND                                 **                    00490000
005000**   PROCXREF-EDITED-FILE LAYOUT (OUTPUT)   **                    00500000
005100                                                                  00510000
005200 01  PROCXRFI-RECORD.                                             00520000
005300     05  PROCXRFI-FILE-NAME.                                      00530000
005400         10  PROCXRFI-FILE-NAME-PREFIX                            00540000
005500                                 PIC X(06)      VALUE SPACES.     00550000
005600         10  FILLER              PIC X(38)      VALUE SPACES.     00560000
005700     05  PROCXRFI-FILE-TYPE      PIC X          VALUE SPACES.     00570000
005800         88  PROCXRFI-INPUT-FILE                VALUE 'I'.        00580000
005900         88  PROCXRFI-OUTPUT-FILE               VALUE 'O'.        00590000
006000         88  PROCXRFI-SYSTEM-FILE               VALUE 'S'.        00600000
006100         88  PROCXRFI-TEMPORARY-FILE            VALUE 'T'.        00610000
006200     05  PROCXRFI-PROC-NAME      PIC X(08)      VALUE SPACES.     00620000
006300     05  PROCXRFI-PROGRAM-NAME   PIC X(08)      VALUE SPACES.     00630000
006310         88  PROCXRFI-PN-SMARTDEL               VALUE 'SMARTDEL'. 00631001
006400     05  PROCXRFI-STEP-NAME      PIC X(08)      VALUE SPACES.     00640000
006500     05  PROCXRFI-GDG-NUM        PIC X(04)      VALUE SPACES.     00650000
006600         88  PROCXRFI-NEW-GDG                   VALUE '+1  '.     00660000
006700     05  PROCXRFI-DISPOSITION.                                    00670000
006800         10  PROCXRFI-DISP1      PIC X(03)      VALUE SPACES.     00680000
006900         10  PROCXRFI-DISP2      PIC X(03)      VALUE SPACES.     00690000
007000         10  PROCXRFI-DISP3      PIC X(03)      VALUE SPACES.     00700000
007100     05  PROCXRFI-MEDIA          PIC X(08)      VALUE SPACES.     00710000
007200         88  PROCXRFI-CARTRIDGE                 VALUE 'CART'.     00720000
007300         88  PROCXRFI-DISK                      VALUE 'SYSDA'.    00730000
007400         88  PROCXRFI-TAPE                      VALUE 'TAPE'.     00740000
007500     05  PROCXRFI-EXPDT-RETPD    PIC X(05)      VALUE SPACES.     00750000
007600         88  PROCXRFI-NO-EXPDT                  VALUE '99000'.    00760000
007700         88  PROCXRFI-RETPD-5-DAYS              VALUE '5    '.    00770000
007800         88  PROCXRFI-RETPD-30-DAYS             VALUE '30   '.    00780000
007900     05  PROCXRFI-SPACE-ALLOC    PIC X(25)      VALUE SPACES.     00790000
008000     05  PROCXRFI-DCB.                                            00800000
008100         10  PROCXRFI-DSORG      PIC X(02)      VALUE SPACES.     00810000
008200             88  PROCXRFI-DSORG-UNSPECIFIED     VALUE SPACES.     00820000
008300             88  PROCXRFI-PDS                   VALUE 'PO'.       00830000
008400             88  PROCXRFI-SEQUENTIAL            VALUE 'PS'.       00840000
008500         10  PROCXRFI-RECFM      PIC X(03)      VALUE SPACES.     00850000
008600         10  PROCXRFI-LRECL      PIC X(05)      VALUE SPACES.     00860000
008700         10  PROCXRFI-LRECL-TBL-ALPHA  REDEFINES  PROCXRFI-LRECL. 00870000
008800             15  PROCXRFI-LRECL-TBL-ELEM-ALPHA  OCCURS 5 TIMES    00880000
008900                                 INDEXED BY IX-RCL    PIC X.      00890000
009000         10  PROCXRFI-LRECL-TBL-NUMER  REDEFINES  PROCXRFI-LRECL. 00900000
009100             15  PROCXRFI-LRECL-TBL-ELEM-NUMER  OCCURS 5 TIMES    00910000
009200                                 PIC 9.                           00920000
009300         10  PROCXRFI-BLKSIZE    PIC X(05)      VALUE SPACES.     00930000
009400     05  PROCXRFI-DDNAME         PIC X(08)      VALUE SPACES.     00940000
009410         88  PROCXRFI-DD-SMARTDEL-SMDELIN       VALUE 'SMDELIN '. 00941006
009500                                                                  00950000
009600     EJECT                                                        00960000
009700                                                                  00970000
009800 01  PROGRAM-SWITCHES.                                            00980000
010100     05  PS-VALID-FILE-NAME-SW   PIC X        VALUE 'N'.          01010004
010200         88  PS-VALID-FILE-NAME               VALUE 'Y'.          01020004
010210         88  PS-INVALID-FILE-NAME             VALUE 'N'.          01021011
010300     05  PS-END-OF-PROCXREF-FILE-IND                              01030004
010310                                 PIC X(1)     VALUE 'N'.          01031004
010400         88  PS-NOT-END-OF-PROCXREF-FILE      VALUE 'N'.          01040004
010401         88  PS-END-OF-PROCXREF-FILE          VALUE 'Y'.          01040104
010402     05  PS-END-OF-FILE-LIST-FILE-IND                             01040204
010403                                 PIC X(1)     VALUE 'N'.          01040304
010404         88  PS-NOT-END-OF-FILE-LIST-FILE     VALUE 'N'.          01040404
010405         88  PS-END-OF-FILE-LIST-FILE         VALUE 'Y'.          01040504
010406     05  PS-FILE-LIST-FILE-ALLOC-IND                              01040604
010407                                 PIC X(1)     VALUE 'N'.          01040704
010408         88  PS-FILE-LIST-ALLOCATED           VALUE 'Y'.          01040804
010409         88  PS-FILE-LIST-NOT-ALLOCATED       VALUE 'N'.          01040904
010410                                                                  01041004
010411 01  PC-PROGRAM-CONSTANTS.                                        01041104
010412     05  PC-CURRENT-PROGRAM-NAME PIC X(8)     VALUE 'DPKUT007'.   01041204
010413     05  PC-PROD-CONTROL-PDS-DSN PIC X(12)    VALUE               01041304
010420         'PKMO.CONTROL'.                                          01042001
010421     05  PC-FILE-EXPAND-DDNAME   PIC X(8)     VALUE 'SMDELIN '.   01042103
010422     05  PC-SMDELIN-FILE-DISP    PIC X(9)     VALUE 'OLDDELDEL'.  01042215
010430                                                                  01043003
010440 01  PV-PROGRAM-VARIABLES.                                        01044003
010450     05  PV-CURRENT-PROCXREF-RECORD                               01045015
010451                                 PIC X(143)   VALUE SPACES.       01045115
010452     05  PV-FL-FILE-STATUS       PIC X(2)     VALUE '00'.         01045215
010453         88  PV-FL-FS-SUCCESSFUL-COMPLETION   VALUE '00'.         01045315
010454         88  PV-FL-FS-END-OF-FILE             VALUE '10'.         01045415
010460     05  PV-PDS-MEMBER-AREA      PIC X(8)     VALUE SPACES.       01046003
010470     05  PV-FILE-LIST-RECORD     PIC X(80)    VALUE SPACES.       01047004
010500                                                                  01050000
010600     EJECT                                                        01060000
010700                                                                  01070000
010800 01  WORK-AREA.                                                   01080000
010900     05  SUB1                    PIC 9(04)      VALUE ZEROES.     01090000
011000     05  WS-FILE-NAME-TABLE      PIC X(44)      VALUE SPACES.     01100000
011100     05  WS-FILE-NAME-TBL-ALPHA  REDEFINES  WS-FILE-NAME-TABLE.   01110000
011200         10  WS-FILE-NAME-CHAR  OCCURS 44 TIMES INDEXED BY IX-FNT 01120000
011300                                 PIC X.                           01130000
011400     05  WS-FILE-NAME-TBL-NUMER  REDEFINES  WS-FILE-NAME-TABLE.   01140000
011500         10  WS-FILE-NAME-NUM   OCCURS 44 TIMES                   01150000
011600                                 PIC 9.                           01160000
011700     05  WS-VARIABLES.                                            01170000
011800         10  WS-AMPERSAND        PIC X          VALUE '&'.        01180000
011900         10  WS-COMMA            PIC X          VALUE ','.        01190000
012000         10  WS-LEFT-PAREN       PIC X          VALUE '('.        01200000
012100         10  WS-PERIOD           PIC X          VALUE '.'.        01210000
012110         10  WS-RIGHT-PAREN      PIC X          VALUE ')'.        01211003
012200         10  WS-TEMPORARY        PIC X(11)      VALUE             01220000
012300                                                '<TEMPORARY>'.    01230000
012600                                                                  01260000
012700********************                                              01270000
012800 PROCEDURE DIVISION.                                              01280000
012900********************                                              01290000
013100                                                                  01310000
013200     OPEN INPUT     PROCXREF-SORTED-FILE                          01320000
013300          OUTPUT    PROCXREF-EDITED-FILE.                         01330000
013400                                                                  01340000
013410     READ PROCXREF-SORTED-FILE                                    01341004
013411         INTO PROCXRFI-RECORD                                     01341104
013420         AT END                                                   01342002
013430             SET PS-END-OF-PROCXREF-FILE TO TRUE                  01343004
013440     END-READ.                                                    01344003
013500                                                                  01350000
013600     PERFORM A100-PROCESS-PROCXREF-FILE                           01360002
013700         UNTIL PS-END-OF-PROCXREF-FILE.                           01370004
014600                                                                  01460000
014700     CLOSE          PROCXREF-SORTED-FILE                          01470000
014800                    PROCXREF-EDITED-FILE.                         01480000
014900                                                                  01490000
015000                                                                  01500000
015100     STOP RUN.                                                    01510000
015200                                                                  01520000
015600******************************************************************01560000
015700*** A100 THIS PARAGRAPH PROCESSES THE INPUT FILE FROM "PROCXREF"  01570000
015800***      BY EDITING THE DSN.  IF THE DSN PASSES THE EDITS, THE    01580000
015900***      ENTIRE RECORD IS WRITTEN TO THE OUTPUT FILE.  IT ALSO    01590003
015930***      REMOVES THE QUOTES AROUND THE DATASET NAME, IF FOUND.    01593003
016000******************************************************************01600000
016100 A100-PROCESS-PROCXREF-FILE.                                      01610000
016330     IF (PROCXRFI-FILE-NAME = WS-TEMPORARY)                       01633003
016331         SET PS-INVALID-FILE-NAME TO TRUE                         01633103
016332     ELSE                                                         01633203
016340         SET PS-VALID-FILE-NAME   TO TRUE                         01634003
016370         MOVE PROCXRFI-FILE-NAME  TO WS-FILE-NAME-TABLE           01637003
016390         IF ( WS-FILE-NAME-CHAR (1)  =  WS-AMPERSAND )  OR        01639003
016391            ( WS-FILE-NAME-CHAR (2)  =  WS-COMMA )      OR        01639103
016392            ( WS-FILE-NAME-CHAR (2)  =  SPACE )         OR        01639203
016393            ( WS-FILE-NAME-CHAR (3)  =  WS-COMMA )                01639303
016394             SET PS-INVALID-FILE-NAME                             01639403
016395                                  TO TRUE                         01639502
016396         ELSE                                                     01639603
016397             IF WS-FILE-NAME-CHAR (1)  =  QUOTE                   01639703
016398                 PERFORM X110-REMOVE-DSNAME-QUOTES                01639803
016399                     VARYING IX-FNT FROM 1 BY 1                   01639903
016400                     UNTIL IX-FNT > LENGTH OF WS-FILE-NAME-TABLE  01640003
016401                 MOVE WS-FILE-NAME-TABLE                          01640103
016402                                  TO PROCXRFI-FILE-NAME           01640202
016403             END-IF                                               01640303
016404         END-IF                                                   01640403
016406     END-IF.                                                      01640602
016407                                                                  01640702
016408     IF ((PROCXRFI-PN-SMARTDEL)                                   01640802
016409             AND (PROCXRFI-DD-SMARTDEL-SMDELIN))                  01640906
016410         EVALUATE TRUE                                            01641002
016411             WHEN PS-INVALID-FILE-NAME                            01641102
016412                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '   01641203
016413                           'FILE NAME USED FOR SMARTDEL SMDELIN ' 01641303
016414                           'FILE'                                 01641403
016415                 DISPLAY 'FILE NAME APPEARS AS: '                 01641503
016416                           PROCXRFI-FILE-NAME                     01641603
016417             WHEN ((PROCXRFI-FILE-NAME(1:LENGTH OF                01641703
016418                                   PC-PROD-CONTROL-PDS-DSN) =     01641802
016419                                          PC-PROD-CONTROL-PDS-DSN)01641903
016420                     AND (PROCXRFI-FILE-NAME(((LENGTH OF          01642003
016421                          PC-PROD-CONTROL-PDS-DSN) + 1):1) =      01642103
016422                                          WS-LEFT-PAREN))         01642212
016423                 MOVE PROCXRFI-FILE-NAME(((LENGTH OF              01642303
016424                     PC-PROD-CONTROL-PDS-DSN) + 1 + 1):           01642413
016425                     ((LENGTH OF PROCXRFI-FILE-NAME) -            01642514
016426                     ((LENGTH OF PC-PROD-CONTROL-PDS-DSN) + 1)))  01642614
016427                           TO PV-PDS-MEMBER-AREA                  01642715
016428                 MOVE PROCXRFI-RECORD TO                          01642815
016429                           PV-CURRENT-PROCXREF-RECORD             01642915
016430                 PERFORM X120-CREATE-FILES-FOR-SMARTDEL           01643002
016431                 MOVE PV-CURRENT-PROCXREF-RECORD TO               01643115
016432                           PROCXRFI-RECORD                        01643215
016433             WHEN OTHER                                           01643302
016434                 DISPLAY PC-CURRENT-PROGRAM-NAME  ' - INVALID '   01643403
016435                           'FILE NAME USED FOR SMARTDEL SMDELIN ' 01643503
016436                           'FILE'                                 01643603
016437                 DISPLAY 'FILE NAME APPEARS AS: '                 01643703
016438                           PROCXRFI-FILE-NAME                     01643803
016439         END-EVALUATE                                             01643902
016440     END-IF.                                                      01644002
016441                                                                  01644102
016442     IF (PS-VALID-FILE-NAME)                                      01644202
016443         WRITE PROCXREF-EDITED-REC                                01644305
016444             FROM PROCXRFI-RECORD                                 01644405
016450     END-IF.                                                      01645002
016500                                                                  01650000
016510     READ PROCXREF-SORTED-FILE                                    01651004
016511         INTO PROCXRFI-RECORD                                     01651104
016520         AT END                                                   01652002
016521             SET PS-END-OF-PROCXREF-FILE TO TRUE                  01652104
016522     END-READ.                                                    01652203
017300                                                                  01730000
017400*A100-END.                                                        01740003
017700                                                                  01770002
022000******************************************************************02200000
022100*** X110 THIS PARAGRAPH REMOVES THE QUOTES AROUND THE DATASET NAME02210000
022200***      IF THEY ARE FOUND.                                       02220000
022300******************************************************************02230000
022400 X110-REMOVE-DSNAME-QUOTES.                                       02240000
022600     IF ( IX-FNT  >  1 )  AND                                     02260000
022700        ( WS-FILE-NAME-CHAR (IX-FNT + 1)  =  QUOTE )              02270000
022800         MOVE SPACE               TO WS-FILE-NAME-CHAR (IX-FNT)   02280000
022900                                  WS-FILE-NAME-CHAR (IX-FNT + 1)  02290000
023000         SET IX-FNT               TO LENGTH OF WS-FILE-NAME-TABLE 02300003
023100     ELSE                                                         02310000
023200         MOVE WS-FILE-NAME-CHAR (IX-FNT + 1)                      02320000
023300                                  TO WS-FILE-NAME-CHAR (IX-FNT)   02330000
023400     END-IF.                                                      02340000
023600*X110-END.                                                        02360003
023900                                                                  02390001
023901******************************************************************02390103
023902*** X120 EXPAND ANY STANDARD-NAMED FILE CONTAINING A LIST OF FILES02390203
023903***      FOR DELETION IN SMART DELETE INTO INDIVIDUAL CROSS-      02390303
023904***      REFERENCE FILE REFERENCES.                               02390403
023905******************************************************************02390503
023910 X120-CREATE-FILES-FOR-SMARTDEL.                                  02391001
023911     INITIALIZE DP023-DYNALC-PARMS.                               02391101
023912     MOVE PC-FILE-EXPAND-DDNAME TO DP023-DDNAME.                  02391203
023913     MOVE PROCXRFI-FILE-NAME(1:LENGTH OF PC-PROD-CONTROL-PDS-DSN) 02391303
023915               TO DP023-DSNAME.                                   02391503
023916     SET DP023-DISP-SHARE TO TRUE.                                02391601
023917     SET DP023-FREE-CLOSE-YES TO TRUE.                            02391701
023918     INITIALIZE DP023-MEMBER-NAME.                                02391803
023919     UNSTRING PV-PDS-MEMBER-AREA                                  02391903
023920         DELIMITED BY WS-RIGHT-PAREN                              02392003
023921         INTO DP023-MEMBER-NAME                                   02392103
023922         ON OVERFLOW                                              02392203
023923              CONTINUE                                            02392303
023924     END-UNSTRING.                                                02392403
023925     SET DP023-MEMDISP-READ TO TRUE.                              02392501
023926     SET DP023-DISABLE-DISPLAY-ABEND TO TRUE.                     02392601
023927                                                                  02392704
023928     PERFORM DP023-0000-DYNALC.                                   02392801
023929                                                                  02392904
023931     EVALUATE TRUE                                                02393104
023932         WHEN DP023-LASTRC = ZERO                                 02393204
023933             SET PS-FILE-LIST-ALLOCATED TO TRUE                   02393304
023935         WHEN DP023-LASTRC = DP023-RC-DATASET-DOESNT-EXIST        02393504
023936             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - PDS '           02393604
023937                       PC-PROD-CONTROL-PDS-DSN  ' DOES NOT '      02393704
023938                       'EXIST'                                    02393804
023944         WHEN DP023-LASTRC = DP023-RC-MEMBER-DOESNT-EXIST         02394404
023945             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - SMDELIN '       02394504
023946                       'FILE LIST CONTROL MEMBER '                02394604
023947                       DP023-MEMBER-NAME  ' DOES NOT EXIST'       02394709
023955         WHEN OTHER                                               02395504
023956             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - ATTEMPT '       02395604
023957                      'TO ALLOCATE SMDELIN DD FAILED WITH '       02395704
023958                      'RC=' DP023-RC (DP023-SUB)  ' - '           02395804
023959                      DP023-DESC (DP023-SUB)                      02395904
023960             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - CONTROL '       02396004
023961                       'MEMBER = '  DP023-MEMBER-NAME             02396104
023966     END-EVALUATE.                                                02396604
023967                                                                  02396704
023968     IF PS-FILE-LIST-ALLOCATED                                    02396804
023969         OPEN INPUT  FILE-LIST-FILE                               02396904
023970         IF PV-FL-FS-SUCCESSFUL-COMPLETION                        02397004
023971             SET PS-NOT-END-OF-FILE-LIST-FILE TO TRUE             02397105
023972             READ FILE-LIST-FILE                                  02397204
023973                 INTO PV-FILE-LIST-RECORD                         02397304
023974                 AT END                                           02397404
023975                     SET PS-END-OF-FILE-LIST-FILE TO TRUE         02397504
023976             END-READ                                             02397604
023977             PERFORM X130-CREATE-FILE-FOR-SMARTDEL                02397704
023978                 UNTIL PS-END-OF-FILE-LIST-FILE                   02397805
023979         ELSE                                                     02397904
023980             DISPLAY PC-CURRENT-PROGRAM-NAME  ' - FILE STATUS '   02398004
023981                       'ERROR '  PV-FL-FILE-STATUS  ' ON DD '     02398104
023982                       PC-FILE-EXPAND-DDNAME  ' FOR CONTROL '     02398204
023983                       'MEMBER '  DP023-MEMBER-NAME               02398304
023984         END-IF                                                   02398404
023985     END-IF.                                                      02398504
023986                                                                  02398604
023987     IF PS-FILE-LIST-ALLOCATED                                    02398704
023988         CLOSE FILE-LIST-FILE                                     02398804
023989     END-IF.                                                      02398904
023990*X120-END.                                                        02399003
023991                                                                  02399104
023992******************************************************************02399216
023993*** X130 PREPARE/WRITE AN INDIVIDUAL RECORD FOR CROSS-REFERENCE   02399316
023994***      FOR A SMART DELETE LIST OF FILES REFERENCE.              02399416
023996******************************************************************02399616
023997 X130-CREATE-FILE-FOR-SMARTDEL.                                   02399705
023998     MOVE PV-FILE-LIST-RECORD TO PROCXRFI-FILE-NAME.              02399810
023999     MOVE PC-SMDELIN-FILE-DISP TO PROCXRFI-DISPOSITION.           02399915
024000                                                                  02400005
024001     WRITE PROCXREF-EDITED-REC                                    02400105
024002         FROM PROCXRFI-RECORD.                                    02400205
024003                                                                  02400305
024004     READ FILE-LIST-FILE                                          02400404
024005         INTO PV-FILE-LIST-RECORD                                 02400504
024006         AT END                                                   02400604
024007             SET PS-END-OF-FILE-LIST-FILE TO TRUE                 02400704
024008     END-READ.                                                    02400804
024009*X130-END.                                                        02400904
024010                                                                  02401001
024020*                                                                 02402001
024100*  DYNAMIC ALLOCATION ROUTINE                                     02410001
024200*                                                                 02420001
024300     COPY DPPD023.                                                02430001
