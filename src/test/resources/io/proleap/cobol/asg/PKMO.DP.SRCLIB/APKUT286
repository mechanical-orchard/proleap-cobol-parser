000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKUT286.                                        00020000
000300 AUTHOR.         NANCY EILBES.                                    00030000
000400 DATE-WRITTEN.   MAY 2022.                                        00040003
000500 DATE-COMPILED.                                                   00050000
000600*----------------------------------------------------------------*00060003
000700*    COBOL 2                                                     *00070003
000800*     REFORMATS JOURNALIZED BY PO EXTRACT TO TEXT FORMAT         *00080003
000900*                                                                *00090003
001000* INPUT:                                                         *00100003
001100*  1. JOURNALIZED BY PO FILE       COPYBOOK APRD008              *00110003
001200*                                                                *00120003
001300* OUTPUT:                                                        *00130003
001400*  1. JOURNALIZED TEXT FILE                                      *00140003
001500*                                                                *00150003
001600*----------------------------------------------------------------*00160003
001601* CHANGE LOG:                                                    *00160103
001602* DATE  05/09/2022                                               *00160203
001603*     CHANGE MADE: INITIAL IMPLEMENTATION.                       *00160303
001604*     MADE BY: NANCY EILBES            WR/IR #: CHG0269842       *00160403
001605*----------------------------------------------------------------*00160503
001700   EJECT                                                          00170000
001800 ENVIRONMENT DIVISION.                                            00180000
001900 CONFIGURATION SECTION.                                           00190000
002000 SOURCE-COMPUTER.    IBM-3090.                                    00200000
002100 OBJECT-COMPUTER.    IBM-3090.                                    00210000
002200                                                                  00220000
002300 INPUT-OUTPUT SECTION.                                            00230000
002400 FILE-CONTROL.                                                    00240000
002500     SELECT IN-FILE       ASSIGN TO UT-S-INP01.                   00250000
002600     SELECT OUT-FILE      ASSIGN TO UT-S-OUT01.                   00260000
002700                                                                  00270000
002800 DATA DIVISION.                                                   00280000
002900 FILE SECTION.                                                    00290000
003000                                                                  00300000
003100 FD  IN-FILE                                                      00310000
003200     RECORDING MODE IS F                                          00320000
003300     LABEL RECORDS ARE STANDARD                                   00330000
003400     BLOCK CONTAINS 0 RECORDS                                     00340000
003500     DATA RECORD IS JRNLIZED-IN-REC.                              00350000
003600 01  IN-REC.                                                      00360000
003700     05  FILLER                       PIC  X(50).                 00370000
003800                                                                  00380000
003900 FD  OUT-FILE                                                     00390000
004000     RECORDING MODE IS F                                          00400000
004100     LABEL RECORDS ARE STANDARD                                   00410000
004200     BLOCK CONTAINS 0 RECORDS                                     00420000
004300     DATA RECORD IS JRNLIZED-OUT-REC.                             00430000
004400 01  OUT-REC.                                                     00440000
004500     05  FILLER                       PIC  X(80).                 00450000
004600                                                                  00460000
004700 EJECT                                                            00470000
004800 WORKING-STORAGE SECTION.                                         00480000
004900                                                                  00490000
005000 01  EOF-SW                           PIC X     VALUE 'N'.        00500000
005100     88  IN-EOF                                 VALUE 'Y'.        00510000
005200 01  TEXT-RECORD.                                                 00520000
005301     05  OUT-PO-NUMBER                PIC 9(8).                   00530100
005302     05  FILLER                       PIC X(1)  VALUE SPACES.     00530200
005303     05  OUT-POST-TYPE                PIC X(2).                   00530300
005304     05  FILLER                       PIC X(1)  VALUE SPACES.     00530400
005305     05  OUT-TOTAL-COST               PIC ---------.99.           00530500
005306     05  FILLER                       PIC X(1)  VALUE SPACES.     00530600
005307     05  OUT-PO-TYP-CDE               PIC X(2).                   00530700
005308     05  FILLER                       PIC X(1)  VALUE SPACES.     00530800
005309     05  OUT-COST-CHG-IND             PIC X(2).                   00530902
005310     05  FILLER                       PIC X(1)  VALUE SPACES.     00531002
005311                                                                  00531100
005312     COPY APRD008.                                                00531200
005313                                                                  00531300
005314 EJECT                                                            00531400
005315 PROCEDURE DIVISION.                                              00531500
005316 A100-MAIN.                                                       00531600
005317                                                                  00531700
005318     PERFORM B100-INITIALIZE.                                     00531800
005319                                                                  00531900
005320     PERFORM B200-PROCESS                                         00532000
005321         UNTIL IN-EOF.                                            00532100
005322                                                                  00532200
005330     GOBACK.                                                      00533000
005340 EJECT                                                            00534000
005350*----------------------------------------------------------------*00535000
005360*    INITIALIZATION PROCESSING                                   *00536000
005370*    CALLED FROM A100-MAIN                                       *00537000
005380*----------------------------------------------------------------*00538000
005390 B100-INITIALIZE.                                                 00539000
005400                                                                  00540000
005500     OPEN INPUT  IN-FILE                                          00550000
005600          OUTPUT OUT-FILE.                                        00560000
005700                                                                  00570000
005800     PERFORM R100-READ-INPUT.                                     00580000
005900                                                                  00590000
006000 B200-PROCESS.                                                    00600000
006100                                                                  00610000
006200     MOVE AP008-PO-NBR          TO  OUT-PO-NUMBER.                00620000
006400     MOVE SPACES                TO  OUT-POST-TYPE.                00640000
006500     MOVE AP008-COST-AMT        TO  OUT-TOTAL-COST.               00650000
006600     MOVE AP008-PO-TYP-CDE      TO  OUT-PO-TYP-CDE.               00660000
006620     MOVE AP008-COST-CHANGES    TO  OUT-COST-CHG-IND.             00662002
006700                                                                  00670000
006800     PERFORM W100-WRITE-OUTPUT.                                   00680000
006900                                                                  00690000
007000     PERFORM R100-READ-INPUT.                                     00700000
007100                                                                  00710000
007200 R100-READ-INPUT.                                                 00720000
007300                                                                  00730000
007400                                                                  00740000
007500     READ IN-FILE INTO AP008-VERIFIED-RECEIPT-FILE                00750000
007600         AT END SET IN-EOF TO TRUE.                               00760000
007700                                                                  00770000
007800                                                                  00780000
007900 W100-WRITE-OUTPUT.                                               00790000
008000                                                                  00800000
008100     WRITE OUT-REC FROM TEXT-RECORD.                              00810000
008200                                                                  00820000
