00001 ****************************************************************  10/20/93
00002 ** PAYMENT TERMS FORMATTING                                    *  POPD001 
00003 ****************************************************************     LV014
00004                                                                      CL**3
00005      INITIALIZE PO020-PAYT-TERM-ID-DESC.                             CL**4
00006                                                                      CL**3
00007      MULTIPLY PAYTRM-DISCOUNT-PCT BY +100 GIVING                     CL*14
00008                                       PO020-NUM-DISCOUNT-PCT.        CL*14
00009                                                                      CL*14
00010      MOVE PO020-NUM-DISCOUNT-PCT   TO PO020-EDIT-DISCOUNT-PCT.       CL*14
00011      MOVE PAYTRM-DISCOUNT-DAYS-QTY TO PO020-EDIT-DISCOUNT-DAYS.      CL**3
00012      MOVE PAYTRM-DUE-DAY-QTY       TO PO020-EDIT-DUE-DAYS.           CL**3
00013      MOVE PAYTRM-OTHER-TXT         TO PO020-OTHER-TEXT.              CL**7
00014                                                                      CL**3
00015      IF PO020-OTHER-TEXT > SPACES                                    CL**7
00016          MOVE PO020-OTHER-TEXT     TO PO020-PAYT-TERM-ID-DESC        CL**8
00017      ELSE                                                            CL**3
00018          IF PAYTRM-DISCOUNT-PCT > ZEROES                             CL*14
00019              IF PO020-EDIT-DISCOUNT-DAYS > SPACES                    CL*12
00020                IF PO020-EDIT-DUE-DAYS > SPACES                       CL*12
00021                   IF PAYTRM-DUE-DAY-FR-DTE-TXT > SPACES              CL**3
00022                       STRING PO020-EDIT-DISCOUNT-PCT ' % '           CL**3
00023                              PO020-EDIT-DISCOUNT-DAYS ' DAYS NET '   CL**3
00024                              PO020-EDIT-DUE-DAYS ' '                 CL**3
00025                              DELIMITED BY SIZE                       CL**3
00026                              PAYTRM-DUE-DAY-FR-DTE-TXT               CL**3
00027                              DELIMITED BY ' '                        CL**3
00028                              INTO PO020-PAYT-TERM-ID-DESC            CL**3
00029                   ELSE                                               CL**3
00030                       STRING PO020-EDIT-DISCOUNT-PCT ' % '           CL**3
00031                              PO020-EDIT-DISCOUNT-DAYS ' DAYS NET '   CL**3
00032                              PO020-EDIT-DUE-DAYS ' '                 CL**3
00033                              DELIMITED BY SIZE                       CL**3
00034                              INTO PO020-PAYT-TERM-ID-DESC            CL**3
00035                   END-IF                                             CL**3
00036                ELSE                                                  CL**6
00037                   IF PAYTRM-DUE-DAY-FR-DTE-TXT > SPACES              CL**5
00038                        STRING PO020-EDIT-DISCOUNT-PCT ' % '          CL**3
00039                               PO020-EDIT-DISCOUNT-DAYS ' DAYS '      CL**3
00040                               DELIMITED BY SIZE                      CL**3
00041                               PAYTRM-DUE-DAY-FR-DTE-TXT              CL**3
00042                               DELIMITED BY ' '                       CL**3
00043                               INTO PO020-PAYT-TERM-ID-DESC           CL**3
00044                   ELSE                                               CL**5
00045                        STRING PO020-EDIT-DISCOUNT-PCT ' % '          CL**3
00046                               PO020-EDIT-DISCOUNT-DAYS ' DAYS '      CL**3
00047                               DELIMITED BY SIZE                      CL**3
00048                               INTO PO020-PAYT-TERM-ID-DESC           CL**3
00049                   END-IF                                             CL**5
00050                END-IF                                                CL**3
00051              END-IF                                                  CL**6
00052          ELSE                                                        CL**3
00053              IF PO020-EDIT-DUE-DAYS > SPACES                         CL*12
00054                 IF PAYTRM-DUE-DAY-FR-DTE-TXT > SPACES                CL**3
00055                     STRING 'NET '                                    CL**3
00056                            PO020-EDIT-DUE-DAYS ' '                   CL**3
00057                            DELIMITED BY SIZE                         CL**3
00058                            PAYTRM-DUE-DAY-FR-DTE-TXT                 CL**3
00059                            DELIMITED BY ' '                          CL**3
00060                            INTO PO020-PAYT-TERM-ID-DESC              CL**3
00061                 ELSE                                                 CL**3
00062                     STRING 'NET '                                    CL**3
00063                            PO020-EDIT-DUE-DAYS                       CL**3
00064                            DELIMITED BY SIZE                         CL**3
00065                            INTO PO020-PAYT-TERM-ID-DESC              CL**3
00066                 END-IF                                               CL**3
00067              ELSE                                                    CL**3
00068                  MOVE PAYTRM-DUE-DAY-FR-DTE-TXT TO                   CL**3
00069                                         PO020-PAYT-TERM-ID-DESC      CL**3
00070              END-IF                                                  CL**3
00071          END-IF                                                      CL**3
00072      END-IF.                                                         CL**3
00073                                                                      CL**3
00074      MOVE PO020-PAYT-TERM-ID-DESC        TO ASC-PAYT-TERM-ID-DESC.   CL**3
00075                                                                      CL**3
