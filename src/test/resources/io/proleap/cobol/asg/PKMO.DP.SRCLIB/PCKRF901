000100 IDENTIFICATION DIVISION.                                         00010000
000200******************************************************************00020000
000300 PROGRAM-ID.             PCKRF901.                                00030000
000400 AUTHOR.                 PAUL JORGENSEN.                          00040000
000500 INSTALLATION.           KOHLS.                                   00050000
000600 DATE-WRITTEN.           NOVEMBER 2005.                           00060000
000700 DATE-COMPILED.                                                   00070000
000800******************************************************************00080000
000900* THIS PROGRAM ALLOWS THE UPDATE OF LINE LOCATION AND/OR OPER SET.00090000
001000* THIS ALSO ALLOWS DISPLAY OF CURRENT LINE LOCATION.              00100000
001100******************************************************************00110000
001200*  CHANGED 06/13/13 BY C. PARMLEY          PR#5148B              *00120024
001300*   CHANGE MAP TO DISPLAY RFID CARTON WHEN THE SSCC VENDOR       *00130024
001400*   NUMBER IS ENTERED. (WHEN APPROPRIATE)                        *00140024
001500*----------------------------------------------------------------*00150059
001600*   NEW LOGIC ADDED TO GO THE RFID SUBROUTINE TO CHECK IF        *00160026
001700*   CARTON IS RFID. NEW 'RFID CRT' WILL DISPLAY ON THE           *00170026
001800*   SCREEN WHEN APPLICABLE. PROJECT #5148B. TO DO THIS THE       *00180026
001900*   LOCATION NEEDED TO BE EXTRACTED FROM THE TSULBXF TABLE       *00190026
002000*   FOR THE CALL TO SUBROUTINE FOR SML LABELS.                   *00200026
002100*   CHANGES CAN BE FOUND WITH CLP 06/13/13 PR#5148B START/END    *00210026
002200*   AROUND THEM.                                                 *00220026
002300*   MADE BY: CHERI PARMLEY           WR/IR #: CRQ0055296         *00230061
002400*----------------------------------------------------------------*00240028
002500*  CHANGED 10/15/13 BY C. PARMLEY          PR#5148D              *00250028
002600*   IN 2540- WHEN VENDOR TAGGING AND DC TAGGING ITS NOW 'NO'     *00260038
002700*   FOR RFID. SO WILL NOT DISPLAY 'RFID CRT' ON SCREEN.          *00270039
002800*                                                                *00280039
002900*   NEW LOGIC ADDED AFTER PERFORM OF 2540- WHICH WILL FURTHER    *00290039
003000*   CHECK IF AUDIT PASSED OR FAILED AND SET FLAG. IF FLAG SET    *00300039
003100*   AND AUDIT FAILED THEN 'RFIDQ' WILL DISPLAY ON SCREEN         *00310039
003200*   ON LINE #8 AFTER 'NEW STR'. ELSE IF RFID WILL GET 'RFID CRT' *00320039
003300*   DISPLAYED.                                                   *00330039
003400*                                                                *00340039
003500*   TAGGED WITH CLP 10/15/13                                     *00350038
003600*----------------------------------------------------------------*00360062
003700*07/12/2017 JIM ARENDT   CHG0176459                              *00370063
003800*ADDED CODE TO PROGRAM FOR THE 'RFID TAG YOUR STORE/ SHORT-TERM  *00380063
003900*SOLUTION' PROJECT.                                              *00390063
004000******************************************************************00400001
004100 ENVIRONMENT DIVISION.                                            00410000
004200 DATA DIVISION.                                                   00420000
004300******************************************************************00430000
004400 WORKING-STORAGE SECTION.                                         00440000
004500******************************************************************00450000
004600 01  DK-DB2-KEYS.                                                 00460000
004700     05  DK-PO-NBR                  PIC S9(9) COMP VALUE ZERO.    00470000
004800     05  DK-REC-SEQ-NBR             PIC S9(9) COMP VALUE ZERO.    00480000
004900     05  DK-PO-LNE-NBR              PIC S9(9) COMP VALUE ZERO.    00490000
005000     05  DK-OPER-UNT-ID             PIC S9(4) COMP VALUE ZERO.    00500000
005100     05  DK-TRN-NBR                 PIC S9(8) COMP VALUE ZERO.    00510000
005200     05  DK-OPER-SET-ID             PIC S9(4) COMP VALUE +0.      00520000
005300     05  DK-SHIPT-UNT-ID            PIC S9(18)V COMP-3            00530000
005400                                               VALUE ZERO.        00540000
005500     05  DK-CARTON-ID               PIC S9(18) COMP-3 VALUE ZERO. 00550000
005600                                                                  00560000
005700 01  PC-PROGRAM-CONSTANTS.                                        00570000
005800     05  PC-TRANID                  PIC X(04)  VALUE 'G901'.      00580000
005900     05  PC-LOGON-TRAN-ID           PIC X(04)  VALUE 'Z028'.      00590000
006000                                                                  00600000
006100     05  PC-CURRENT-PROGRAM-NAME    PIC X(08)  VALUE 'PCKRF901'.  00610000
006200     05  PC-DC-RF-APPL-PGM          PIC X(08)  VALUE 'MPKCS027'.  00620000
006300     05  PC-CHECK-IN-PGM            PIC X(08)  VALUE 'SUKRF502'.  00630000
006400     05  PC-HELP-SCREEN             PIC X(08)  VALUE 'PCKRF278'.  00640000
006500*CLP 06/13/13 PR#5148B START                                      00650024
006600     05  PC-PROG-NAME-RFID          PIC X(08)  VALUE 'SUKUT149'.  00660024
006700*CLP 06/13/13 PR#5148B END                                        00670024
006800                                                                  00680000
006900     05  PC-DEFAULT-TIMESTAMP            PIC  X(26)               00690000
007000                          VALUE  '9999-09-09-09.09.09.999999'.    00700000
007100     05  PC-DEFAULT-DATE                 PIC  X(26)  VALUE        00710000
007200                                 '9999-00-00-00.00.00.000000'.    00720000
007300                                                                  00730000
007400     05  PC-0                            PIC  X(01)  VALUE '0'.   00740000
007500     05  PC-4                            PIC  X(01)  VALUE '4'.   00750000
007600     05  PC-11                           PIC S9(04)  VALUE 11.    00760000
007700     05  PC-18                           PIC S9(04)  VALUE 18.    00770000
007800     05  PC-19                           PIC S9(04)  VALUE 19.    00780000
007900     05  PC-20                           PIC S9(04)  VALUE 20     00790000
008000                                                     COMP SYNC.   00800000
008100     05  PC-MAX-RETRIES                  PIC S9(04) VALUE  +3     00810000
008200                                                     COMP.        00820000
008300     05  PC-A                       PIC X(01)   VALUE 'A'.        00830000
008400     05  PC-P                       PIC X(01)   VALUE 'P'.        00840000
008500     05  PC-G                       PIC X(01)   VALUE 'G'.        00850000
008600     05  PC-S                       PIC X(01)   VALUE 'S'.        00860000
008700     05  PC-Y                       PIC X(01)   VALUE 'Y'.        00870000
008800                                                                  00880000
008900* ERROR MESSAGES                                                 *00890000
009000 01  PM-PROGRAM-MESSAGES.                                         00900000
009100     05  PM-VERIFIED-RCVR-MSG-1     PIC X(19) VALUE               00910000
009200                                           ' RECEIVER VERIFIED '. 00920000
009300     05  PM-VERIFIED-RCVR-MSG-2     PIC X(19) VALUE               00930000
009400                                           '   CANNOT UPDATE   '. 00940000
009500     05  PM-VERIFIED-RCVR-MSG-3     PIC X(19) VALUE               00950000
009600                                           ' ANOTHER DCS RCVR  '. 00960000
009700     05  PM-UNRECOGNIZED-PF-KEY-MSG PIC X(19) VALUE               00970000
009800                                           'UNRECOGNIZED PF KEY'. 00980000
009900     05  PM-ENTER-THROUGH-MENU-MSG  PIC X(19) VALUE               00990000
010000                                           'ENTER THROUGH MENU '. 01000000
010100     05  PM-TRANS-UNAVAILABLE-MSG   PIC X(19) VALUE               01010000
010200                                           'TRANS NOT AVAILABLE'. 01020000
010300     05  PM-CICS-ABEND-MSG          PIC X(19)  VALUE              01030000
010400                                           'CICS PROGRAM ABEND '. 01040000
010500     05  PM-CICS-ABEND-MSG-2        PIC X(19)  VALUE              01050000
010600                                           'CALL HELP DESK     '. 01060000
010700     05  PM-DATABASE-ERROR          PIC  X(19)  VALUE             01070000
010800                                           'DATABASE ER-CALL DP'. 01080000
010900     05  PM-DATABASE-BUSY           PIC  X(19)  VALUE             01090000
011000                                           'DB BUSY - TRY AGAIN'. 01100000
011100     05  PM-NO-DATA-1               PIC  X(19)  VALUE             01110000
011200                                           'SSCC OR PO-RCVR    '. 01120000
011300     05  PM-NO-DATA-2               PIC  X(19)  VALUE             01130000
011400                                           'REQUIRED - RETRY   '. 01140000
011500     05  PM-MUST-BE-NUM             PIC  X(19)  VALUE             01150000
011600                                           'MUST BE NUMERIC    '. 01160000
011700     05  PM-INVALID-DATA            PIC  X(19)  VALUE             01170000
011800                                           'INVALID DATA       '. 01180000
011900     05  PM-RCVR-NOT-FOUND          PIC  X(19)  VALUE             01190000
012000                                           'RECEIVER NOT FOUND '. 01200000
012100     05  PM-CARTON-NOT-FOUND        PIC  X(19)  VALUE             01210000
012200                                           'CARTON NOT FOUND   '. 01220000
012300     05  PM-OPER-SET-NOT-FOUND      PIC  X(19)  VALUE             01230000
012400                                           'OPER SET ID NOTFND '. 01240000
012500     05  PM-F2-CONFIRM              PIC  X(19)  VALUE             01250000
012600                                           'F2-CONFIRM         '. 01260000
012700     05  PM-F4-UPDATE               PIC  X(19)  VALUE             01270000
012800                                           'F4-UPDATE          '. 01280000
012900     05  PM-NEW-LOC-SPACES          PIC  X(19)  VALUE             01290000
013000                                           'NEW LOC TO BE BLANK'. 01300000
013100     05  PM-OPER-SET-SPACES         PIC  X(19)  VALUE             01310000
013200                                           'CAN NOT BE SPACES  '. 01320000
013300     05  PM-WORK-ORDER-COMPLETE     PIC  X(19)  VALUE             01330000
013400                                           'WORK ORDER COMPLETE'. 01340000
013500     05  PM-RECEIVER-NOT-ARRIVED    PIC  X(19)  VALUE             01350000
013600                                           'RECEIVER STATUS    '. 01360000
013700     05  PM-CANNOT-UPDATE-OPSET     PIC  X(19)  VALUE             01370000
013800                                           'CANNOT UPDATE OPSET'. 01380000
013900     05  PM-OPER-SET-INVALID        PIC  X(19)  VALUE             01390000
014000                                           'OPER SET INVALID   '. 01400000
014100     05  PM-CANNOT-UPDATE-LOC-1     PIC  X(19)  VALUE             01410000
014200                                           'CANNOT UPDATE LOC, '. 01420000
014300     05  PM-CANNOT-UPDATE-LOC-2     PIC  X(19)  VALUE             01430000
014400                                           'NO WRK ORD / INSTR '. 01440000
014500     05  PM-UPDATE-SUCCESSFUL       PIC  X(19)  VALUE             01450000
014600                                           'UPDATE SUCCESSFUL  '. 01460000
014700*CLP 06/13/13 PR#5148B START                                      01470024
014800     05  PM-RFID-CARTON             PIC  X(08)  VALUE             01480024
014900                                           'RFID CRT'.            01490024
015000     05  PM-RFID-CARTON-FAIL        PIC  X(08)  VALUE             01500035
015100                                           'RFIDQ   '.            01510035
015200*CLP 06/13/13 PR#5148B END                                        01520024
015300                                                                  01530000
015400 01  PS-PROGRAM-SWITCHES.                                         01540000
015500     05  PS-ERROR-SW                  PIC  X(01)  VALUE 'N'.      01550000
015600         88  PS-ERRORS-YES                        VALUE 'Y'.      01560000
015700         88  PS-ERRORS-NO                         VALUE 'N'.      01570000
015800     05  PS-VALID-INPUT-SW            PIC  X(01)  VALUE 'Y'.      01580000
015900         88  PS-VALID-INPUT                       VALUE 'Y'.      01590000
016000         88  PS-INVALID-INPUT                     VALUE 'N'.      01600000
016100     05  PS-INITIALIZE-SCREEN-SW      PIC  X(01)  VALUE 'N'.      01610000
016200         88  PS-INITIALIZE-SCREEN                 VALUE 'Y'.      01620000
016300         88  PS-PROCESS-SCREEN                    VALUE 'N'.      01630000
016400     05 PS-USE-PO-RCVR-SW             PIC  X(01)  VALUE  ' '.     01640000
016500         88  PS-USE-PO-RCVR-YES                   VALUE  'Y'.     01650000
016600         88  PS-USE-PO-RCVR-NO                    VALUE  'N'.     01660000
016700     05 PS-USE-SSCC-SW                PIC  X(01)  VALUE  ' '.     01670000
016800         88  PS-USE-SSCC-YES                      VALUE  'Y'.     01680000
016900         88  PS-USE-SSCC-NO                       VALUE  'N'.     01690000
017000     05 PS-SCANNED-DATA-SW            PIC  X(01)  VALUE  ' '.     01700000
017100         88  PS-SCANNED-DATA-YES                  VALUE  'Y'.     01710000
017200         88  PS-SCANNED-DATA-NO                   VALUE  'N'.     01720000
017300     05 PS-PREPACK-SW                 PIC  X(01)  VALUE  ' '.     01730000
017400         88  PS-PREPACK-YES                       VALUE  'Y'.     01740000
017500         88  PS-PREPACK-NO                        VALUE  'N'.     01750000
017600     05 PS-OPER-SET-SW                PIC  X(01)  VALUE  ' '.     01760000
017700         88  PS-OPER-SET-FOUND-YES                VALUE  'Y'.     01770000
017800         88  PS-OPER-SET-FOUND-NO                 VALUE  'N'.     01780000
017900     05 PS-MULTIPLE-SHIPMENTS-SW      PIC  X(01)  VALUE  ' '.     01790000
018000         88  PS-MULTIPLE-SHIPMENTS-YES            VALUE  'Y'.     01800000
018100         88  PS-MULTIPLE-SHIPMENTS-NO             VALUE  'N'.     01810000
018200     05  PS-TWKORIN-CURSOR-SW         PIC  X(01)  VALUE  'N'.     01820000
018300         88  PS-EOF-TWKORIN-CSR-NO                VALUE  'N'.     01830000
018400         88  PS-EOF-TWKORIN-CSR-YES               VALUE  'Y'.     01840000
018500     05  PS-TOSOPFA-CURSOR-SW         PIC  X(01)  VALUE  'N'.     01850000
018600         88  PS-EOF-TOSOPFA-CSR                   VALUE  'Y'.     01860000
018700     05  PS-INSTRUCTION-SW            PIC  X(01)  VALUE  'N'.     01870000
018800         88  PS-FIRST-INSTRUCTION                 VALUE  'Y'.     01880000
018900     05  PS-TRECITM-CURSOR-SW         PIC  X(01)  VALUE  'N'.     01890000
019000         88  PS-EOF-TRECITM-CSR                   VALUE  'Y'.     01900000
019100         88  PS-NOT-EOF-TRECITM-CSR               VALUE  'N'.     01910000
019200     05  PS-UCC128-SW                 PIC  X(01)  VALUE  'N'.     01920000
019300         88  PS-UCC128-YES                        VALUE  'Y'.     01930000
019400         88  PS-UCC128-NO                         VALUE  'N'.     01940000
019500     05  PS-AUTOCY-DIRECTIVE-MODE      PIC X(01)     VALUE SPACES.01950000
019600         88  PS-ALL-CARTONS-DIRECTIVES-MODE          VALUE 'A'.   01960000
019700         88  PS-EXCEPTION-DIRECTIVES-MODE            VALUE 'E'.   01970000
019800         88  PS-NO-DIRECTIVES-MODE                   VALUE 'N'.   01980000
019900* CLP 06/13/13 PR5148B START                                      01990024
020000     05  PS-RFID-ON-LABEL-SW             PIC  X(01)  VALUE 'N'.   02000024
020100         88  PS-RFID-ON-LABEL-YES                    VALUE 'Y'.   02010024
020200         88  PS-RFID-ON-LABEL-NO                     VALUE 'N'.   02020024
020300* CLP 06/13/13 PR5148B END                                        02030024
020400     05  PS-RFID-FAILED-SW               PIC  X(01)  VALUE 'N'.   02040035
020500         88  PS-RFID-FAILED-YES                      VALUE 'Y'.   02050035
020600         88  PS-RFID-FAILED-NO                       VALUE 'N'.   02060035
020700                                                                  02070000
020800  01 PT-INDEXES.                                                  02080000
020900     05  PT-TABLE-ENTRIES           PIC 9(5)  VALUE ZEROES.       02090000
021000     05  PT-PREPK-TABLE-ENTRIES     PIC 9(5)  VALUE ZEROES.       02100000
021100                                                                  02110000
021200 01  PT-PURCHASE-ORDER-TABLE.                                     02120000
021300     05  PT-PURCHASE-ORDER-INFO OCCURS 500 TIMES                  02130000
021400                      INDEXED BY PT-PO-IDX.                       02140000
021500         10  PT-PURCHASE-ORDER      PIC  S9(9) COMP VALUE ZEROES. 02150000
021600         10  PT-RCVR-NBR            PIC  S9(9) COMP VALUE ZEROES. 02160000
021700         10  PT-DEPT                PIC   X(3) VALUE SPACE.       02170000
021800         10  PT-PKGNG-CDE           PIC   X(1) VALUE SPACE.       02180000
021900             88  PT-PREPK-PO              VALUE 'M', 'I'.         02190000
022000         10  PT-UPC-NBR            PIC  S9(15)V COMP-3 VALUE ZERO.02200000
022100         10  PT-LNE-NBR             PIC  S9(9) COMP  VALUE ZEROES.02210000
022200         10  PT-LNE-SW              PIC   X(1)       VALUE SPACE. 02220000
022300             88  PT-SINGLE-LINE             VALUE 'S'.            02230000
022400             88  PT-MULTI-LINE              VALUE 'M'.            02240000
022500             88  PT-NO-LINE                 VALUE ' '.            02250000
022600         10  PT-PREPK-ID            PIC  S9(4) COMP VALUE ZEROES. 02260000
022700         10  PT-PREPK-SW            PIC   X(1) VALUE SPACE.       02270000
022800             88  PT-SINGLE-PREPK           VALUE 'S'.             02280000
022900             88  PT-MULTI-PREPK            VALUE 'M'.             02290000
023000             88  PT-NO-PREPK               VALUE ' '.             02300000
023100         10  PT-NBR-UNITS           PIC   9(09)  VALUE ZEROES.    02310000
023200         10  PT-NBR-PACKS           PIC   9(09)  VALUE ZEROES.    02320000
023300                                                                  02330000
023400 01  PT-PREPK-LINE-TABLE.                                         02340000
023500     05  PT-PREPK-LINE-INFO    OCCURS 1000 TIMES                  02350000
023600                      INDEXED BY PT-PREPK-IDX.                    02360000
023700         10  PT-PREPK-LNE-NBR         PIC  9(9) VALUE ZEROES.     02370000
023800         10  PT-PREPK-LNE-RATIO       PIC  9(4) VALUE ZEROES.     02380000
023900         10  PT-PREPK-NBR-UNITS       PIC  9(9) VALUE ZEROES.     02390000
024000         10  PT-PREPK-MULTIPLE        PIC  9(4) VALUE ZEROES.     02400000
024100         10  PT-PREPK-REMAINDER       PIC  9(9) VALUE ZEROES.     02410000
024200                                                                  02420000
024300                                                                  02430000
024400*----------------------------------------------------------------*02440000
024500*  PROGRAM VARIABLES                                             *02450000
024600*----------------------------------------------------------------*02460000
024700 01  PV-PROGRAM-VARIABLES.                                        02470000
024800     05  PV-TRANSACTION-STATUS     PIC X.                         02480000
024900         88  PV-INITIALIZE-SCREEN           VALUE 'S'.            02490000
025000         88  PV-PROCESS-SCREEN              VALUE 'R'.            02500000
025100     05  PV-USERID                 PIC X(8).                      02510000
025200     05  PV-ERROR-MSG.                                            02520000
025300         10  FILLER                PIC X(4) VALUE 'PO= '.         02530000
025400         10  PV-ERROR-PO           PIC Z(8)9.                     02540000
025500         10  FILLER                PIC X(6) VALUE ' RCVR='.       02550000
025600         10  PV-ERROR-SEQ          PIC Z(8)9.                     02560000
025700*        10  FILLER                PIC X(6) VALUE ' OPER='.       02570000
025800*        10  PV-ERROR-OPER-UNT-ID  PIC Z(3)9.                     02580000
025900     05  PV-PGM-MSG                PIC X(9).                      02590063
026000     05  PV-PGM-MSG-REDEF  REDEFINES  PV-PGM-MSG.                 02600063
026100         10  PV-PGM-MSG-A          PIC X(5).                      02610063
026200         10  PV-PGM-MSG-B          PIC X(4).                      02620063
026300     05  PV-RETRY-COUNTER          PIC S9(04) VALUE +0            02630000
026400                                                 COMP SYNC.       02640000
026500     05  PV-LNE-NBR-N              PIC  9(03).                    02650000
026600     05  PV-OPER-SET-N             PIC  9(04).                    02660000
026700     05  FILLER REDEFINES PV-OPER-SET-N.                          02670000
026800         10  FILLER                PIC  X.                        02680000
026900         10  PV-OPER-SET-X         PIC  X(03).                    02690000
027000     05  PV-UNITS-Z                PIC  ZZZZZ9.                   02700000
027100     05  PV-CARTONS-Z              PIC  ZZZZZ9.                   02710000
027200     05  PV-WO-INSTR-SEQ-NBR-N     PIC  9(04).                    02720000
027300     05  PV-OPER-UNT-ID            PIC  9(04).                    02730000
027400     05  PV-SYSID                  PIC  X(04)  VALUE SPACE.       02740000
027500     05  PV-DB2-TIMESTAMP          PIC  X(26).                    02750000
027600     05  PV-DB2-TIMESTAMP-R REDEFINES PV-DB2-TIMESTAMP.           02760000
027700         10  PV-DB2-TMST-DATE      PIC  X(10).                    02770000
027800         10  FILLER                PIC  X(16).                    02780000
027900     05  PV-DB2-TIMESTAMP1         PIC  X(26).                    02790000
028000     05  PV-DB2-TIMESTAMP2.                                       02800000
028100         20  PV-CENTURY            PIC  X(02).                    02810000
028200         20  PV-YEAR               PIC  X(02).                    02820000
028300         20  FILLER                PIC  X(01).                    02830000
028400         20  PV-MONTH              PIC  X(02).                    02840000
028500         20  FILLER                PIC  X(01).                    02850000
028600         20  PV-DAY                PIC  X(02).                    02860000
028700         20  FILLER                PIC  X(01).                    02870000
028800         20  PV-HOUR               PIC  X(02).                    02880000
028900         20  FILLER                PIC  X(01).                    02890000
029000         20  PV-MINUTE             PIC  X(02).                    02900000
029100         20  FILLER                PIC  X(01).                    02910000
029200         20  PV-SECONDS            PIC  X(02).                    02920000
029300         20  PV-REST               PIC  X(07).                    02930000
029400     05  PV-DB2-REFORMAT-DATE-TIME.                               02940000
029500         10  PV-DB2-DATE-MM              PIC  X(02).              02950000
029600         10  FILLER                      PIC  X(01) VALUE '/'.    02960000
029700         10  PV-DB2-DATE-DD              PIC  X(02).              02970000
029800         10  FILLER                      PIC  X(01) VALUE '/'.    02980000
029900         10  PV-DB2-DATE-YY              PIC  X(02).              02990000
030000         10  FILLER                      PIC  X(01) VALUE ' '.    03000000
030100         10  PV-DB2-TIME-HH              PIC  X(02).              03010000
030200         10  FILLER                      PIC  X(01)  VALUE ':'.   03020000
030300         10  PV-DB2-TIME-MM              PIC  X(02).              03030000
030400         10  FILLER                      PIC  X(01)  VALUE ':'.   03040000
030500         10  PV-DB2-TIME-SS              PIC  X(02).              03050000
030600     05  PV-TS-ITEM                      PIC S9(04)  VALUE ZERO   03060000
030700                                                     COMP.        03070000
030800     05  PV-SIGN-ON-INFO-LENGTH          PIC S9(04)  VALUE ZERO   03080000
030900                                                     COMP SYNC.   03090000
031000     05  PV-COUNT                        PIC S9(04)  VALUE ZEROS  03100000
031100                                                     COMP SYNC.   03110000
031200     05  PV-WRITE-LENGTH                 PIC  9(04)  VALUE  80    03120000
031300                                                     COMP SYNC.   03130000
031400     05  PV-RBA                          PIC S9(08)  VALUE +0     03140000
031500                                                     COMP SYNC.   03150000
031600     05  PV-UNITS                        PIC S9(9)   VALUE ZERO   03160000
031700                                                     COMP SYNC.   03170000
031800     05  PV-9999-9                       PIC  9(04)  VALUE 0000.  03180000
031900     05  PV-9999-X REDEFINES PV-9999-9.                           03190000
032000         10  PV-9999-1-2                 PIC  X(02).              03200000
032100         10  PV-9999-3-4                 PIC  X(02).              03210000
032200                                                                  03220000
032300     05  PV-SUB                          PIC S9(4) COMP           03230000
032400                                                VALUE ZERO.       03240000
032500     05  PV-NULL-IND                  PIC S9(4)   VALUE ZERO      03250000
032600                                                     COMP SYNC.   03260000
032700     05  PV-NULL-IND-1                PIC S9(04)  VALUE +0        03270000
032800                                                    COMP.         03280000
032900     05  PV-COMMAREA-LENGTH           PIC S9(04)  VALUE +0        03290000
033000                                                     COMP SYNC.   03300000
033100     05  PV-MESSAGE-AREA              PIC  X(19)  VALUE SPACE.    03310000
033200     05  PV-CICS-RESPONSE             PIC S9(09)  VALUE ZEROS     03320000
033300                                                     COMP SYNC.   03330000
033400     05  PV-TRANSFER-PROGRAM          PIC  X(08)  VALUE SPACE.    03340000
033500     05  PV-DISPLAY-NUMBER            PIC 9(04) VALUE ZEROES.     03350000
033600 01  PV-LOG-MSG.                                                  03360000
033700     05  FILLER                       PIC X(12) VALUE             03370000
033800         ' G901 ERROR '.                                          03380000
033900     05  FILLER                       PIC X(09) VALUE             03390000
034000         'SQLCODE= '.                                             03400000
034100     05  PV-SQLCODE                   PIC -9(03).                 03410000
034200     05  FILLER                       PIC X(06) VALUE             03420000
034300         ' ERR= '.                                                03430000
034400     05  PV-ERROR-NBR                 PIC 9(03) VALUE ZERO.       03440000
034500     05  FILLER                       PIC X(07) VALUE             03450000
034600         ' FAST= '.                                               03460000
034700     05  PV-DISPLAY-FAST              PIC X(12) VALUE ZEROES.     03470000
034800     05  FILLER                       PIC X(05) VALUE             03480000
034900         ' PO= '.                                                 03490000
035000     05  PV-DISPLAY-PO                PIC 9(09) VALUE ZEROES.     03500000
035100     05  FILLER                       PIC X(07) VALUE             03510000
035200         ' RCVR= '.                                               03520000
035300     05  PV-DISPLAY-RCVR              PIC 9(04) VALUE ZEROES.     03530000
035400     05  FILLER                       PIC X(07) VALUE             03540000
035500         ' LINE= '.                                               03550000
035600     05  PV-DISPLAY-PO-LNE-NBR        PIC 9(04) VALUE ZEROES.     03560000
035700     05  FILLER                       PIC X(06) VALUE             03570000
035800         ' STR= '.                                                03580000
035900     05  PV-DISPLAY-STORE             PIC 9(04) VALUE ZEROES.     03590000
036000     05  PV-DIRV-RSN-CDE              PIC X(03) VALUE SPACES.     03600000
036100         88  PV-DIRV-RSN-PUSH                   VALUES            03610000
036200             'AUN' 'AUP' 'BRC' 'RLC' 'RLF' 'RLO'.                 03620000
036300         88  PV-DIRV-RSN-SORT                   VALUES            03630000
036400             'AU%' 'AUQ' 'AUR' 'AUU' 'RCL' 'RFD'.                 03640000
036500                                                                  03650000
036600 01  PV-EDITING-FIELDS.                                           03660000
036700     05  PV-BARCODE.                                              03670000
036800         10  FILLER                      PIC  X(02).              03680000
036900         10  PV-BCD-SCAN-LAST-18.                                 03690000
037000             15  FILLER                  PIC  X.                  03700000
037100             15  PV-BCD-SCAN-LAST-17     PIC  X(17).              03710000
037200     05  FILLER REDEFINES PV-BARCODE.                             03720000
037300         10  FILLER                      PIC  X.                  03730000
037400         10  PV-BCD-SCAN-18-OF-19.                                03740000
037500             15  PV-BCD-LAST-17          PIC  X(17).              03750000
037600             15  FILLER                  PIC  X(01).              03760000
037700         10  FILLER                      PIC  X(01).              03770000
037800     05  PV-BARCODE-N                    PIC  9(18).              03780000
037900     05  PV-KEYED-PO-NBR.                                         03790000
038000         10  PV-KEYED-PO-NBR-1-7         PIC  X(07).              03800000
038100         10  FILLER                      PIC  X(01).              03810000
038200     05  PV-PO-RCVR                      PIC  9(11).              03820000
038300     05  FILLER REDEFINES PV-PO-RCVR.                             03830000
038400         10  PV-PO-N                     PIC  9(08).              03840000
038500         10  PV-RCVR-N                   PIC  9(03).              03850000
038600     05  PV-SCAN-COUNT                  PIC S9(09)  VALUE +0      03860000
038700                                                    COMP-3.       03870000
038800     05  PV-INVOICED-COUNT            PIC S9(09) VALUE +0         03880000
038900                                                 COMP-3.          03890000
039000     05  PV-AP-VERIFIED-COUNT           PIC S9(09) VALUE +0       03900000
039100                                                   COMP-3.        03910000
039200*                                                                 03920000
039300 01  TS-TEMP-STORAGE-QUEUE-INFO.                                  03930000
039400     05  TS-INFO-QUEUE-NAME.                                      03940000
039500         10  TS-INFO-QUEUE-TERMINAL      PIC  X(04)  VALUE SPACE. 03950000
039600         10  FILLER                      PIC  X(04)  VALUE 'INFO'.03960000
039700                                                                  03970000
039800 01  CA-COMMAREA.                                                 03980000
039900* COMMAREA FROM MPKCS027 OR SUKRF502                              03990000
040000     COPY PCWS056.                                                04000000
040100                                                                  04010000
040200* MPKCS027 COMMAREA                                               04020000
040300     COPY MPWS026.                                                04030000
040400                                                                  04040000
040500* SUKRF502 COMMAREA                                               04050000
040600     COPY SUWS001.                                                04060000
040700                                                                  04070000
040800***************************************************************** 04080000
040900*   RCWS071 - COPYBOOK IS USED FOR THE MODULE TO TRACK DC ASSOC * 04090000
041000*             FUNCTIONS                                        .* 04100000
041100***************************************************************** 04110000
041200     COPY RCWS071.                                                04120000
041300                                                                  04130000
041400*  RF SCREEN ERROR MESSAGES                                       04140000
041500     COPY PCWS034.                                                04150000
041600                                                                  04160000
041700*  TEMPORARY STORAGE QUEUE LAYOUT FOR LOGON/UNIT RELATED          04170000
041800*  INFORMATION CAPTURED BY THE NAVIGATOR AT LOGON TIME            04180000
041900     COPY DPWS026.                                                04190000
042000                                                                  04200000
042100*  MAP LAYOUT                                                     04210000
042200     COPY PCKM901.                                                04220000
042300                                                                  04230000
042400* CLP 06/13/13 PR5148B START                                      04240024
042500*---------------------------------------------------------------* 04250024
042600*  RECORD LAYOUTS FOR RFID DETERMINATION MODULE                   04260024
042700*---------------------------------------------------------------* 04270024
042800     COPY SUWS093.                                                04280024
042900* CLP 06/13/13 PR5148B END                                        04290024
043000                                                                  04300001
043100* HELP SCREEN WORK AREA                                           04310000
043200     COPY PCWS188.                                                04320000
043300                                                                  04330000
043400* HELP SCREEN COMMAREA                                            04340000
043500     COPY PCWS192.                                                04350000
043600                                                                  04360000
043700* NUMERIC EDIT LAYOUT                                             04370000
043800     COPY DPWS010I.                                               04380000
043900                                                                  04390000
044000*  KOHL'S STANDARD ATTRIBUTE AND PRINTER CONTROL CHARACTER LIST   04400000
044100     COPY DPWS015.                                                04410000
044200                                                                  04420000
044300*  KOHL'S STANDARD ATTENTION IDENTIFIER LIST                      04430000
044400     COPY DFHAID.                                                 04440000
044500                                                                  04450000
044600*  LAYOUT FOR THE ABEND MODULE COMMUNICATIONS AREA.               04460000
044700     COPY DPWS013.                                                04470000
044800                                                                  04480000
044900*----------------------------------------------------------------*04490000
045000*  PACK SLIP                                                      04500000
045100*----------------------------------------------------------------*04510000
045200     EXEC SQL                                                     04520000
045300         INCLUDE TPKSLIP                                          04530000
045400     END-EXEC.                                                    04540000
045500                                                                  04550000
045600*----------------------------------------------------------------*04560000
045700*  INBOUND TRIP                                                   04570000
045800*----------------------------------------------------------------*04580000
045900     EXEC SQL                                                     04590000
046000         INCLUDE TVHTRIP                                          04600000
046100     END-EXEC.                                                    04610000
046200                                                                  04620000
046300*----------------------------------------------------------------*04630000
046400*  SHIPPING UNIT LOCATION                                         04640000
046500*----------------------------------------------------------------*04650000
046600     EXEC SQL                                                     04660000
046700         INCLUDE TSHUNLO                                          04670000
046800     END-EXEC.                                                    04680000
046900                                                                  04690000
047000*----------------------------------------------------------------*04700000
047100*  RECEIVER                                                       04710000
047200*----------------------------------------------------------------*04720000
047300     EXEC SQL                                                     04730000
047400         INCLUDE TRECEIV                                          04740000
047500     END-EXEC.                                                    04750000
047600*----------------------------------------------------------------*04760000
047700*  RECEIPT ITEM                                                   04770000
047800*----------------------------------------------------------------*04780000
047900     EXEC SQL                                                     04790000
048000         INCLUDE TRECITM                                          04800000
048100     END-EXEC.                                                    04810000
048200*----------------------------------------------------------------*04820000
048300*  RECEIPT DISTRIBUTION                                           04830000
048400*----------------------------------------------------------------*04840000
048500     EXEC SQL                                                     04850000
048600         INCLUDE TRECDIS                                          04860000
048700     END-EXEC.                                                    04870000
048800*----------------------------------------------------------------*04880000
048900*  PURCHASE ORDER                                                 04890000
049000*----------------------------------------------------------------*04900000
049100     EXEC SQL                                                     04910000
049200         INCLUDE TPURCHS                                          04920000
049300     END-EXEC.                                                    04930000
049400*----------------------------------------------------------------*04940000
049500*  PURCHASE ORDER ITEM                                            04950000
049600*----------------------------------------------------------------*04960000
049700     EXEC SQL                                                     04970000
049800         INCLUDE TPURITM                                          04980000
049900     END-EXEC.                                                    04990000
050000*----------------------------------------------------------------*05000000
050100*  TROUBLE NOTIFICATION                                           05010000
050200*----------------------------------------------------------------*05020000
050300     EXEC SQL                                                     05030000
050400         INCLUDE TTRBNTF                                          05040000
050500     END-EXEC.                                                    05050000
050600*----------------------------------------------------------------*05060000
050700*  TROUBLE REASON CODES                                           05070000
050800*----------------------------------------------------------------*05080000
050900     EXEC SQL                                                     05090000
051000         INCLUDE TTRBRSN                                          05100000
051100     END-EXEC.                                                    05110000
051200*----------------------------------------------------------------*05120000
051300*  TROUBLE REPORTING CONTROL                                      05130000
051400*----------------------------------------------------------------*05140000
051500     EXEC SQL                                                     05150000
051600         INCLUDE TTRBRCN                                          05160000
051700     END-EXEC.                                                    05170000
051800*----------------------------------------------------------------*05180000
051900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE INBOUND EDI PACKSLI05190000
052000*  VENDOR SHIPMENT UNIT ASSOCIATION TABLE                         05200000
052100*----------------------------------------------------------------*05210000
052200     EXEC SQL                                                     05220000
052300         INCLUDE TINPKSU                                          05230000
052400     END-EXEC.                                                    05240000
052500*----------------------------------------------------------------*05250000
052600*  WORK ORDER                                                     05260000
052700*----------------------------------------------------------------*05270000
052800     EXEC SQL                                                     05280000
052900         INCLUDE TWRKORD                                          05290000
053000     END-EXEC.                                                    05300000
053100*----------------------------------------------------------------*05310000
053200*  WORK ORDER INSTRUCTION                                         05320000
053300*----------------------------------------------------------------*05330000
053400     EXEC SQL                                                     05340000
053500          INCLUDE TWKORIN                                         05350000
053600     END-EXEC.                                                    05360000
053700*---------------------------------------------------------------* 05370000
053800*  OPERATION SET                                                  05380000
053900*---------------------------------------------------------------* 05390000
054000     EXEC SQL                                                     05400000
054100          INCLUDE TOPRSET                                         05410000
054200     END-EXEC.                                                    05420000
054300*----------------------------------------------------------------*05430000
054400*  OPERATION SET/OPERATION/FACILITY                               05440000
054500*----------------------------------------------------------------*05450000
054600     EXEC SQL                                                     05460000
054700          INCLUDE TOSOPFA                                         05470000
054800     END-EXEC.                                                    05480000
054900                                                                  05490000
055000*----------------------------------------------------------------*05500000
055100*  SHIPMENT UNIT/UPC ASSOCIATION                                  05510000
055200*----------------------------------------------------------------*05520000
055300     EXEC SQL                                                     05530000
055400         INCLUDE TSHUUPC                                          05540000
055500     END-EXEC.                                                    05550000
055600                                                                  05560000
055700*----------------------------------------------------------------*05570000
055800*  XLT_LOC - LOGISTICS LOCATION TABLE                             05580000
055900*----------------------------------------------------------------*05590000
056000     EXEC SQL                                                     05600000
056100         INCLUDE XLT00010                                         05610000
056200     END-EXEC.                                                    05620000
056300                                                                  05630000
056400*---------------------------------------------------------------* 05640000
056500*    DB2 AREA FOR SHIPMENT PO TABLE                             * 05650000
056600*---------------------------------------------------------------* 05660000
056700     EXEC SQL                                                     05670000
056800          INCLUDE TSHPTPO                                         05680000
056900     END-EXEC.                                                    05690000
057000                                                                  05700000
057100*---------------------------------------------------------------* 05710000
057200*    DB2 AREA FOR SHIPMENT TABLE                                * 05720000
057300*---------------------------------------------------------------* 05730000
057400     EXEC SQL                                                     05740000
057500          INCLUDE TSHIPMT                                         05750000
057600     END-EXEC.                                                    05760000
057700/                                                                 05770000
057800*---------------------------------------------------------------* 05780000
057900*    DB2 AREA SUT_CART_DIRV_TRKG                                * 05790000
058000*---------------------------------------------------------------* 05800000
058100     EXEC SQL                                                     05810000
058200          INCLUDE SUT00102                                        05820000
058300     END-EXEC.                                                    05830000
058400/                                                                 05840000
058500*---------------------------------------------------------------* 05850000
058600*    DB2 AREA TSULBXF                                           * 05860000
058700*---------------------------------------------------------------* 05870000
058800     EXEC SQL                                                     05880000
058900          INCLUDE TSULBXF                                         05890000
059000     END-EXEC.                                                    05900000
059100/                                                                 05910000
059200*CLP 10/15/2013 - BEGIN - PR5148D                                 05920028
059300*---------------------------------------------------------------* 05930028
059400*    DB2 AREA SUT_PO_AUD_REQ                                    * 05940028
059500*---------------------------------------------------------------* 05950028
059600     EXEC SQL                                                     05960028
059700          INCLUDE SUT00015                                        05970029
059800     END-EXEC.                                                    05980028
059900/                                                                 05990028
060000*---------------------------------------------------------------* 06000031
060100*    DB2 AREA SUT_PO_AUD_EXC                                    * 06010031
060200*---------------------------------------------------------------* 06020031
060300     EXEC SQL                                                     06030031
060400          INCLUDE SUT00014                                        06040031
060500     END-EXEC.                                                    06050031
060600/                                                                 06060031
060700*CLP 10/15/2013 - END   - PR5148D                                 06070038
060800***************************************************************** 06080000
060900*  DCLGEN LAYOUT AND COBOL DECLARATION FOR THE PARM TABLE TO      06090000
061000*  CHECK IF DC IS MANIFESTING                                     06100000
061100***************************************************************** 06110000
061200     EXEC SQL                                                     06120000
061300         INCLUDE TKRPRPM                                          06130000
061400     END-EXEC.                                                    06140000
061500/                                                                 06150000
061600*----------------------------------------------------------------*06160000
061700     EXEC SQL                                                     06170000
061800          DECLARE TWKORIN-CSR CURSOR FOR                          06180000
061900             SELECT  STRT_TMST,                                   06190000
062000                     STOP_TMST,                                   06200000
062100                     PRC_FCLTY_AREA_ID,                           06210000
062200                     SCREEN_SEQ_NBR,                              06220000
062300                     LNE_LOC_CDE,                                 06230000
062400                     WO_INSTR_SEQ_NBR                             06240000
062500               FROM  TWKORIN                                      06250000
062600              WHERE  (ORD_NBR            =  :DK-PO-NBR            06260000
062700                AND   RCVR_SEQ_NBR       =  :DK-REC-SEQ-NBR       06270000
062800                AND   ORD_LNE_NBR        =  :DK-PO-LNE-NBR        06280000
062900                AND   WORK_ORD_SEQ_NBR   =  1                     06290000
063000                AND   OPER_UNT_ID        =  :RECEIV-OPER-UNT-ID   06300000
063100                AND   FCLTY_ID           =  :RECEIV-FCLTY-ID      06310000
063200                AND   VER_STATUS_CDE     =  'A')                  06320000
063300           ORDER BY  SCREEN_SEQ_NBR                               06330000
063400           WITH UR                                                06340000
063500     END-EXEC.                                                    06350000
063600*---------------------------------------------------------------* 06360000
063700*  CURSOR TO LIST COLUMNS FOR A OPERATION SET                   * 06370000
063800*---------------------------------------------------------------* 06380000
063900     EXEC SQL                                                     06390000
064000          DECLARE TOSOPFA-CSR CURSOR FOR                          06400000
064100           SELECT OPER_SET_ID                                     06410000
064200                 ,OPER_ID                                         06420000
064300                 ,OPER_UNT_ID                                     06430000
064400                 ,FCLTY_ID                                        06440000
064500                 ,FCLTY_AREA_ID                                   06450000
064600                 ,PRC_FCLTY_AREA_ID                               06460000
064700                 ,SCRN_SEQ_NBR                                    06470000
064800           FROM   TOSOPFA                                         06480000
064900           WHERE  OPER_SET_ID    = :DK-OPER-SET-ID                06490000
065000             AND  OPER_UNT_ID    = :RECEIV-CURR-OPER-UNT-ID       06500000
065100             AND  VER_STATUS_CDE = 'A'                            06510000
065200           ORDER BY SCRN_SEQ_NBR                                  06520000
065300     END-EXEC.                                                    06530000
065400                                                                  06540000
065500******************************************************************06550000
065600     EXEC SQL                                                     06560000
065700          DECLARE TRECITM-CSR CURSOR FOR                          06570000
065800           SELECT PKSL_ITM_QTY                                    06580000
065900                , DTL_CK_ITM_QTY                                  06590000
066000             FROM TRECITM                                         06600000
066100            WHERE ORD_NBR          =  :DK-PO-NBR                  06610000
066200              AND REC_SEQ_NBR      =  :DK-REC-SEQ-NBR             06620000
066300              AND STATUS_CDE        IN ('IP','CM')                06630000
066400              AND VER_STATUS_CDE   = 'A'                          06640000
066500            WITH UR                                               06650000
066600     END-EXEC.                                                    06660000
066700*                                                                 06670000
066800******************************************************************06680000
066900*  DB2 AREA FOR COMMUNICATIONS.                                   06690000
067000******************************************************************06700000
067100     EXEC SQL                                                     06710000
067200         INCLUDE SQLCA                                            06720000
067300     END-EXEC.                                                    06730000
067400                                                                  06740000
067500*                                                                 06750000
067600******************************************************************06760000
067700 LINKAGE SECTION.                                                 06770000
067800 01  DFHCOMMAREA.                                                 06780000
067900     05  FILLER                         OCCURS  1 TO 4072 TIMES   06790000
068000                                      DEPENDING ON EIBCALEN.      06800000
068100         10  FILLER                   PIC X.                      06810000
068200/                                                                 06820000
068300******************************************************************06830000
068400 PROCEDURE DIVISION.                                              06840000
068500******************************************************************06850000
068600 0000-PROGRAM-MAINLINE.                                           06860000
068700                                                                  06870000
068800     MOVE DFHCOMMAREA   TO CA-COMMAREA.                           06880063
068900     PERFORM 0010-MPKCS027-SUKRF502.                              06890063
069000                                                                  06900063
069100     EVALUATE TRUE                                                06910063
069200         WHEN EIBCALEN = ZERO                                     06920063
069300             MOVE PM-ENTER-THROUGH-MENU-MSG TO PV-MESSAGE-AREA    06930063
069400             PERFORM 8110-RETURN-WITH-MSG                         06940063
069500                                                                  06950063
069600****************************************************************  06960063
069700* DPKRF278 IS THE PGM FOR THE HELP SCREEN.                        06970063
069800****************************************************************  06980063
069900         WHEN EIBTRNID = 'Z278'                                   06990063
070000             MOVE DFHCOMMAREA           TO PC192-COMMAREA         07000063
070100             MOVE PC192-HOST-SAVE-AREA  TO CA-COMMAREA            07010063
070200             PERFORM 0010-MPKCS027-SUKRF502                       07020063
070300             SET PS-PROCESS-SCREEN      TO TRUE                   07030063
070400             MOVE PC192-HOST-SAVE-MAP   TO PC901AO                07040063
070500             PERFORM 0020-LOAD-MAP-DATA                           07050063
070600             PERFORM 8000-SEND-MAP                                07060063
070700             PERFORM 8100-RETURN-TRANID                           07070063
070800                                                                  07080063
070900         WHEN PV-INITIALIZE-SCREEN                                07090063
071000         WHEN EIBAID = DFHCLEAR                                   07100063
071100             SET MP026-PROCESS-SCREEN                             07110063
071200                 SU001-PROCESS-SCREEN TO TRUE                     07120063
071300             PERFORM 1000-INITIALIZE                              07130063
071400             PERFORM 1300-FIND-SYSTEM-ID                          07140063
071500*            PERFORM 1400-FIND-LOGON-INFO                         07150063
071600             IF PC056-FROM-SUKRF002-WITH-DATA                     07160063
071700                 PERFORM 2000-PROCESS-SCREEN-FIELDS               07170063
071800                 IF PS-ERRORS-NO                                  07180063
071900                    IF PC056-RCVR-VERIFIED                        07190063
072000                       MOVE PM-VERIFIED-RCVR-MSG-1 TO AMSGLN1O    07200063
072100                       MOVE PM-VERIFIED-RCVR-MSG-2 TO AMSGLN2O    07210063
072200                    ELSE                                          07220063
072300                    IF PC056-SIGNON-OPER-UNT NOT =                07230063
072400                       PC056-OPER-UNT-ID                          07240063
072500                       MOVE PM-VERIFIED-RCVR-MSG-3 TO AMSGLN1O    07250063
072600                       MOVE PM-VERIFIED-RCVR-MSG-2 TO AMSGLN2O    07260063
072700                       MOVE DP015-PRO-NOR-MDT      TO ANEWOPSTA   07270063
072800                                                      ANEWLOCA    07280063
072900                    ELSE                                          07290063
073000                       MOVE PM-F4-UPDATE                          07300063
073100                                       TO AMSGLN1O                07310063
073200                       MOVE  SPACES    TO AMSGLN2O                07320063
073300                    END-IF                                        07330063
073400                    END-IF                                        07340063
073500                     IF ALOCO > SPACES  OR                        07350063
073600                        PC056-RCVR-VERIFIED                       07360063
073700                         MOVE -1     TO ABARCODEL                 07370063
073800                     ELSE                                         07380063
073900                         MOVE -1     TO ANEWLOCL                  07390063
074000                     END-IF                                       07400063
074100                     SET PC056-UPDATE-PENDING-YES                 07410063
074200                                     TO TRUE                      07420063
074300                 END-IF                                           07430063
074400             ELSE                                                 07440063
074500                 MOVE -1             TO ABARCODEL                 07450063
074600                 SET PC056-UPDATE-PENDING-NO                      07460063
074700                                     TO TRUE                      07470063
074800             END-IF                                               07480063
074900             PERFORM 8000-SEND-MAP                                07490063
075000             PERFORM 8100-RETURN-TRANID                           07500063
075100                                                                  07510063
075200         WHEN EIBAID = DFHPF3                                     07520063
075300             PERFORM 8200-XCTL                                    07530063
075400                                                                  07540063
075500         WHEN EIBAID = DFHENTER                                   07550063
075600             PERFORM 2000-PROCESS-SCREEN-FIELDS                   07560063
075700             IF PS-ERRORS-NO                                      07570063
075800                 IF PC056-RCVR-VERIFIED                           07580063
075900                    MOVE PM-VERIFIED-RCVR-MSG-1 TO AMSGLN1O       07590063
076000                    MOVE PM-VERIFIED-RCVR-MSG-2 TO AMSGLN2O       07600063
076100                 ELSE                                             07610063
076200                 IF PC056-SIGNON-OPER-UNT NOT =                   07620063
076300                    PC056-OPER-UNT-ID                             07630063
076400                    MOVE PM-VERIFIED-RCVR-MSG-3 TO AMSGLN1O       07640063
076500                    MOVE PM-VERIFIED-RCVR-MSG-2 TO AMSGLN2O       07650063
076600                    MOVE DP015-PRO-NOR-MDT      TO ANEWOPSTA      07660063
076700                                                   ANEWLOCA       07670063
076800                 ELSE                                             07680063
076900                    MOVE PM-F4-UPDATE TO AMSGLN1O                 07690063
077000                    MOVE SPACES       TO AMSGLN2O                 07700063
077100                 END-IF                                           07710063
077200                 END-IF                                           07720063
077300                 IF ALOCO > SPACES  OR                            07730063
077400                     PC056-RCVR-VERIFIED                          07740063
077500                     MOVE -1       TO ABARCODEL                   07750063
077600                 ELSE                                             07760063
077700                     MOVE -1       TO ANEWLOCL                    07770063
077800                 END-IF                                           07780063
077900                 SET PC056-UPDATE-PENDING-YES                     07790063
078000                                   TO TRUE                        07800063
078100             END-IF                                               07810063
078200             PERFORM 8010-SEND-DATA-ONLY                          07820063
078300             PERFORM 8100-RETURN-TRANID                           07830063
078400                                                                  07840063
078500         WHEN EIBAID = DFHPF1                                     07850063
078600             PERFORM 8020-RECEIVE-MAP                             07860063
078700             MOVE PC901AO  TO PC192-HOST-SAVE-MAP                 07870063
078800             PERFORM 1200-HELP-SCREEN                             07880063
078900                                                                  07890063
079000         WHEN EIBAID = DFHPF2                                     07900063
079100             IF PC056-RCVR-VERIFIED                               07910063
079200                 PERFORM 8020-RECEIVE-MAP                         07920063
079300                 MOVE -1  TO ABARCODEL                            07930063
079400                 MOVE PM-VERIFIED-RCVR-MSG-1      TO AMSGLN1O     07940063
079500                 MOVE PM-VERIFIED-RCVR-MSG-2      TO AMSGLN2O     07950063
079600                 PERFORM 8010-SEND-DATA-ONLY                      07960063
079700                 PERFORM 8100-RETURN-TRANID                       07970063
079800              ELSE                                                07980063
079900              IF PC056-SIGNON-OPER-UNT NOT =                      07990063
080000                 PC056-OPER-UNT-ID                                08000063
080100                 MOVE PM-VERIFIED-RCVR-MSG-3 TO AMSGLN1O          08010063
080200                 MOVE PM-VERIFIED-RCVR-MSG-2 TO AMSGLN2O          08020063
080300                 MOVE DP015-PRO-NOR-MDT      TO ANEWOPSTA         08030063
080400                                                ANEWLOCA          08040063
080500                 PERFORM 8010-SEND-DATA-ONLY                      08050063
080600                 PERFORM 8100-RETURN-TRANID                       08060063
080700             ELSE                                                 08070063
080800             IF PC056-UPDATE-CONFIRM-F2                           08080063
080900                 PERFORM 2000-PROCESS-SCREEN-FIELDS               08090063
081000                 IF PS-ERRORS-NO                                  08100063
081100                     PERFORM 4000-CHECK-FOR-UPDATES               08110063
081200                 END-IF                                           08120063
081300                 SET  PC056-UPDATE-PENDING-YES  TO  TRUE          08130063
081400                 PERFORM 8010-SEND-DATA-ONLY                      08140063
081500                 PERFORM 8100-RETURN-TRANID                       08150063
081600             ELSE                                                 08160063
081700                 PERFORM 8020-RECEIVE-MAP                         08170063
081800                 MOVE -1  TO ABARCODEL                            08180063
081900                 MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO AMSGLN1O     08190063
082000                 MOVE SPACES                      TO AMSGLN2O     08200063
082100                 PERFORM 8010-SEND-DATA-ONLY                      08210063
082200                 PERFORM 8100-RETURN-TRANID                       08220063
082300             END-IF                                               08230063
082400             END-IF                                               08240063
082500             END-IF                                               08250063
082600                                                                  08260063
082700         WHEN EIBAID = DFHPF4                                     08270063
082800             IF PC056-RCVR-VERIFIED                               08280063
082900                 PERFORM 8020-RECEIVE-MAP                         08290063
083000                 MOVE -1  TO ABARCODEL                            08300063
083100                 MOVE PM-VERIFIED-RCVR-MSG-1      TO AMSGLN1O     08310063
083200                 MOVE PM-VERIFIED-RCVR-MSG-2      TO AMSGLN2O     08320063
083300                 PERFORM 8010-SEND-DATA-ONLY                      08330063
083400                 PERFORM 8100-RETURN-TRANID                       08340063
083500              ELSE                                                08350063
083600              IF PC056-SIGNON-OPER-UNT NOT =                      08360063
083700                 PC056-OPER-UNT-ID                                08370063
083800                 MOVE PM-VERIFIED-RCVR-MSG-3 TO AMSGLN1O          08380063
083900                 MOVE PM-VERIFIED-RCVR-MSG-2 TO AMSGLN2O          08390063
084000                 MOVE DP015-PRO-NOR-MDT      TO ANEWOPSTA         08400063
084100                                                ANEWLOCA          08410063
084200                 PERFORM 8010-SEND-DATA-ONLY                      08420063
084300                 PERFORM 8100-RETURN-TRANID                       08430063
084400             ELSE                                                 08440063
084500             IF PC056-UPDATE-PENDING-YES                          08450063
084600                 PERFORM 2000-PROCESS-SCREEN-FIELDS               08460063
084700                 IF PS-ERRORS-NO                                  08470063
084800                     PERFORM 4000-CHECK-FOR-UPDATES               08480063
084900                 END-IF                                           08490063
085000                 PERFORM 8010-SEND-DATA-ONLY                      08500063
085100                 PERFORM 8100-RETURN-TRANID                       08510063
085200             ELSE                                                 08520063
085300                 PERFORM 8020-RECEIVE-MAP                         08530063
085400                 MOVE -1  TO ABARCODEL                            08540063
085500                 MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO AMSGLN1O     08550063
085600                 MOVE SPACES                      TO AMSGLN2O     08560063
085700                 PERFORM 8010-SEND-DATA-ONLY                      08570063
085800                 PERFORM 8100-RETURN-TRANID                       08580063
085900             END-IF                                               08590063
086000             END-IF                                               08600063
086100             END-IF                                               08610063
086200                                                                  08620063
086300         WHEN OTHER                                               08630063
086400             PERFORM 8020-RECEIVE-MAP                             08640063
086500             MOVE -1  TO ABARCODEL                                08650063
086600             MOVE PM-UNRECOGNIZED-PF-KEY-MSG  TO AMSGLN1O         08660063
086700             MOVE SPACES                      TO AMSGLN2O         08670063
086800             PERFORM 8010-SEND-DATA-ONLY                          08680063
086900             PERFORM 8100-RETURN-TRANID                           08690063
087000     END-EVALUATE.                                                08700063
087100                                                                  08710063
087200     GOBACK.                                                      08720063
087300                                                                  08730063
087400 0010-MPKCS027-SUKRF502.                                          08740063
087500     IF PC056-LAST-PROGRAM = PC-DC-RF-APPL-PGM                    08750063
087600         MOVE PC056-HOST-SAVE-AREA                                08760063
087700                        TO MP026-COMMAREA                         08770063
087800         MOVE MP026-TRANSACTION-STATUS                            08780063
087900                        TO PV-TRANSACTION-STATUS                  08790063
088000         MOVE MP026-USERID                                        08800063
088100                        TO PV-USERID                              08810063
088200     END-IF.                                                      08820063
088300     IF PC056-LAST-PROGRAM = PC-CHECK-IN-PGM                      08830063
088400         MOVE PC056-HOST-SAVE-AREA                                08840063
088500                        TO SU001-COMMON-DATA                      08850063
088600         MOVE SU001-TRANSACTION-STATUS                            08860063
088700                        TO PV-TRANSACTION-STATUS                  08870063
088800         MOVE SU001-USER-ID                                       08880063
088900                        TO PV-USERID                              08890063
089000*                                                                 08900063
089100* DMH - 03/22/2006 - BEGIN                                        08910063
089200         MOVE SU001-CURR-OPER-UNT-ID                              08920063
089300                        TO PC056-SIGNON-OPER-UNT                  08930063
089400* DMH - 03/22/2006 - END                                          08940063
089500*                                                                 08950063
089600         IF PC056-FROM-SUKRF002-WITH-DATA                         08960063
089700             MOVE PC056-PO                                        08970063
089800                        TO PV-PO-N                                08980063
089900             MOVE PC056-RCVR-SEQ-NBR                              08990063
090000                        TO PV-RCVR-N                              09000063
090100             MOVE PV-PO-N                                         09010063
090200                        TO APONBRI                                09020063
090300             MOVE 8     TO APONBRL                                09030063
090400             MOVE PV-RCVR-N                                       09040063
090500                        TO ARCVRI                                 09050063
090600             MOVE 3     TO ARCVRL                                 09060063
090700         END-IF                                                   09070063
090800     END-IF.                                                      09080063
090900                                                                  09090063
091000 0020-LOAD-MAP-DATA.                                              09100063
091100     IF PC056-PO > ZERO                                           09110063
091200         MOVE PC056-PO  TO PV-PO-N                                09120063
091300         MOVE PV-PO-N   TO APONBRO                                09130063
091400         MOVE DP015-UNP-ALP-NOR-MDT                               09140063
091500                        TO APONBRA                                09150063
091600     END-IF                                                       09160063
091700     IF PC056-RCVR-SEQ-NBR > ZERO                                 09170063
091800         MOVE PC056-RCVR-SEQ-NBR                                  09180063
091900                        TO PV-RCVR-N                              09190063
092000         MOVE PV-RCVR-N TO ARCVRO                                 09200063
092100         MOVE DP015-UNP-ALP-NOR-MDT                               09210063
092200                        TO ARCVRA                                 09220063
092300     END-IF.                                                      09230063
092400     IF PC056-CARTON-CNT NUMERIC                                  09240063
092500         IF PC056-CARTON-CNT > ZERO                               09250063
092600             MOVE PC056-CARTON-CNT                                09260063
092700                         TO PV-CARTONS-Z                          09270063
092800             MOVE PV-CARTONS-Z                                    09280063
092900                         TO ACRTNSO                               09290063
093000             MOVE DP015-ASK-NOR-MDT                               09300063
093100                         TO ACRTNSA                               09310063
093200         END-IF                                                   09320063
093300     END-IF                                                       09330063
093400     IF PC056-UNIT-COUNT NUMERIC                                  09340063
093500         IF PC056-UNIT-COUNT > ZERO                               09350063
093600             MOVE PC056-UNIT-COUNT                                09360063
093700                         TO PV-UNITS-Z                            09370063
093800             MOVE PV-UNITS-Z                                      09380063
093900                         TO AUNITSO                               09390063
094000             MOVE DP015-ASK-NOR-MDT                               09400063
094100                         TO AUNITSA                               09410063
094200         END-IF                                                   09420063
094300     END-IF.                                                      09430063
094400     IF PC056-RCVR-VERIFIED                                       09440063
094500         MOVE -1         TO ABARCODEL                             09450063
094600         MOVE DP015-PRO-NOR-MDT                                   09460063
094700                         TO ANEWOPSTA                             09470063
094800                            ANEWLOCA                              09480063
094900     ELSE                                                         09490063
095000     IF PC056-CURR-LINE-LOC > SPACES                              09500063
095100         MOVE PC056-CURR-LINE-LOC                                 09510063
095200                         TO ALOCO                                 09520063
095300         MOVE DP015-ASK-NOR-MDT                                   09530063
095400                         TO ALOCA                                 09540063
095500         MOVE -1         TO ABARCODEL                             09550063
095600     ELSE                                                         09560063
095700         MOVE -1         TO ANEWLOCL                              09570063
095800     END-IF                                                       09580063
095900     END-IF.                                                      09590063
096000                                                                  09600063
096100     IF PC056-CURR-OPER-SET-X NUMERIC                             09610063
096200         IF PC056-CURR-OPER-SET-X > ZERO                          09620063
096300             MOVE PC056-CURR-OPER-SET-X                           09630063
096400                         TO AOPERSETO                             09640063
096500             MOVE DP015-ASK-NOR-MDT                               09650063
096600                         TO AOPERSETA                             09660063
096700         END-IF                                                   09670063
096800     END-IF.                                                      09680063
096900     IF PC056-OPER-SET-DESC > SPACES                              09690063
097000         MOVE PC056-OPER-SET-DESC                                 09700063
097100                         TO AOPSTDSO                              09710063
097200     END-IF                                                       09720063
097300     IF PC056-NEW-OPER-SET-PROT-YES                               09730063
097400         MOVE DP015-PRO-NOR-MDT                                   09740063
097500                         TO ANEWOPSTA                             09750063
097600     END-IF                                                       09760063
097700     IF PC056-RCVR-VERIFIED                                       09770063
097800         MOVE DP015-PRO-NOR-MDT                                   09780063
097900                         TO ANEWLOCA                              09790063
098000     END-IF                                                       09800063
098100     IF PC056-NEW-STORE-IND > SPACES                              09810063
098200         MOVE PC056-NEW-STORE-IND                                 09820063
098300                         TO ANEWSTRO                              09830063
098400         MOVE DP015-ASK-NOR-MDT                                   09840063
098500                         TO ANEWSTRA                              09850063
098600     END-IF.                                                      09860063
098700     IF PC056-PICTURE-AD > SPACES                                 09870063
098800         MOVE PC056-PICTURE-AD                                    09880063
098900                         TO APICTADO                              09890063
099000         MOVE DP015-ASK-NOR-MDT                                   09900063
099100                         TO APICTADA                              09910063
099200     END-IF.                                                      09920063
099300     IF PC056-SEASONAL-SET > SPACES                               09930063
099400         MOVE PC056-SEASONAL-SET                                  09940063
099500                         TO ASEASETO                              09950063
099600         MOVE DP015-ASK-NOR-MDT                                   09960063
099700                         TO ASEASETA                              09970063
099800     END-IF.                                                      09980063
099900     IF PC056-TRBL-DESCR > SPACES                                 09990063
100000         MOVE PC056-TRBL-DESCR                                    10000063
100100                         TO ATRBLO                                10010063
100200         MOVE DP015-ASK-NOR-MDT                                   10020063
100300                         TO ATRBLA                                10030063
100400     END-IF.                                                      10040063
100500     IF PC056-UPDATE-PENDING-YES                                  10050063
100600         MOVE PM-F4-UPDATE                                        10060063
100700                         TO AMSGLN1O                              10070063
100800         MOVE DP015-ASK-NOR-MDT                                   10080063
100900                         TO AMSGLN1A                              10090063
101000     END-IF.                                                      10100063
101100     IF PC056-UPDATE-CONFIRM-F2                                   10110063
101200         MOVE PM-F2-CONFIRM                                       10120063
101300                         TO AMSGLN1O                              10130063
101400         MOVE DP015-ASK-NOR-MDT                                   10140063
101500                         TO AMSGLN1A                              10150063
101600     END-IF.                                                      10160063
101700                                                                  10170063
101800 1000-INITIALIZE.                                                 10180063
101900                                                                  10190063
102000     EXEC CICS                                                    10200063
102100         ASSIGN USERID  (SU001-USER-ID)                           10210063
102200           RESP    (PV-CICS-RESPONSE)                             10220063
102300     END-EXEC                                                     10230063
102400     EXEC CICS                                                    10240063
102500         ASSIGN USERID  (MP026-USERID)                            10250063
102600           RESP    (PV-CICS-RESPONSE)                             10260063
102700     END-EXEC                                                     10270063
102800                                                                  10280063
102900     EVALUATE TRUE                                                10290063
103000         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10300063
103100             CONTINUE                                             10310063
103200         WHEN OTHER                                               10320063
103300             MOVE '1000-INITIALIZE'   TO DP013-PARAGRAPH          10330063
103400             MOVE 'PCKRF901 - UNABLE TO ASSIGN USER-ID'           10340063
103500                                      TO DP013-MESSAGE-TEXT (1)   10350063
103600             PERFORM 7000-ABEND                                   10360063
103700     END-EVALUATE.                                                10370063
103800                                                                  10380063
103900 1200-HELP-SCREEN.                                                10390063
104000     MOVE 'DPKRF278'                  TO PV-TRANSFER-PROGRAM      10400063
104100     MOVE 'PCKRF901'                  TO PC192-PROGRAM-NAME       10410063
104200     COPY PCPD188.                                                10420063
104300     MOVE PC188-DISPLAY-DATE          TO PC192-DISPLAY-DATE.      10430063
104400     IF MP026-LAST-PROGRAM = PC-DC-RF-APPL-PGM                    10440063
104500         MOVE MP026-COMMAREA          TO PC056-HOST-SAVE-AREA     10450063
104600     ELSE                                                         10460063
104700         MOVE SU001-COMMON-DATA       TO PC056-HOST-SAVE-AREA     10470063
104800     END-IF                                                       10480063
104900     MOVE CA-COMMAREA                 TO PC192-HOST-SAVE-AREA     10490063
105000     PERFORM 8220-XCTL-TO-HELP.                                   10500063
105100                                                                  10510063
105200******************************************************************10520063
105300* DETERMINE IF WE ARE RUNNING IN A SINGLE CICS REGION (CICST1),   10530063
105400* OR IF WE ARE RUNNING IN A SPLIT CICS REGION (CICSP1 AND CICSP4).10540063
105500* PV-SYSID WILL BE SPACES IF WE ARE RUNNING IN A SINGLE REGION.   10550063
105600******************************************************************10560063
105700 1300-FIND-SYSTEM-ID.                                             10570063
105800     EXEC CICS                                                    10580063
105900         INQUIRE                                                  10590063
106000             TRANSACTION   (PC-LOGON-TRAN-ID)                     10600063
106100             REMOTESYSTEM  (PV-SYSID)                             10610063
106200             RESP          (PV-CICS-RESPONSE)                     10620063
106300     END-EXEC.                                                    10630063
106400                                                                  10640063
106500     EVALUATE TRUE                                                10650063
106600         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 10660063
106700             CONTINUE                                             10670063
106800         WHEN OTHER                                               10680063
106900             MOVE '1300-FIND-SYSTEM-ID'                           10690063
107000                 TO DP013-PARAGRAPH                               10700063
107100             MOVE 'UNABLE TO DETERMINE SYSTEM ID'                 10710063
107200                 TO DP013-MESSAGE-TEXT (1)                        10720063
107300*            SET DP013-CICS-ABEND      TO  TRUE                   10730063
107400*            SET DP013-NO-ROLLBACK     TO  TRUE                   10740063
107500             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               10750063
107600             MOVE 'CICS ERR/HELP DESK ' TO AMSGLN1O               10760063
107700             PERFORM 7000-ABEND                                   10770063
107800     END-EVALUATE.                                                10780063
107900                                                                  10790063
108000******************************************************************10800063
108100*  FIND THE LOCATION OF THE TERMINAL OR PC AND THE USERID OF THE  10810063
108200*  PERSON THAT IS CURRENTLY LOGGED ON.  IF WE ARE RUNNING IN      10820063
108300*  CICST1, PV-SYSID WILL BE SPACES BECAUSE THE TERMINAL AND       10830063
108400*  APPLICATION REGIONS ARE BOTH CICST1.  IF WE ARE IN PRODUCTION, 10840063
108500*  PV-SYSID WILL NOT BE SPACES BECAUSE OF THE SPLIT REGION        10850063
108600*  PROCESSING.  IN PRODUCTION, THE APPLICATION REGION IS CICSP4,  10860063
108700*  WHILE THE TERMINAL REGION (WHERE WE NEED TO GET OUR REQUESTED  10870063
108800*  INFORMATION) IS CICSP1.                                        10880063
108900******************************************************************10890063
109000*1400-FIND-LOGON-INFO.                                            10900063
109100*    MOVE LENGTH OF DP026-SIGN-ON-INFO                            10910063
109200*                   TO  PV-SIGN-ON-INFO-LENGTH.                   10920063
109300*    MOVE EIBTRMID  TO  TS-INFO-QUEUE-TERMINAL.                   10930063
109400*    MOVE +1        TO  PV-TS-ITEM.                               10940063
109500                                                                  10950063
109600*    IF PV-SYSID = SPACES                                         10960063
109700*        EXEC CICS                                                10970063
109800*            READQ TS                                             10980063
109900*                QUEUE  (TS-INFO-QUEUE-NAME)                      10990063
110000*                ITEM   (PV-TS-ITEM)                              11000063
110100*                INTO   (DP026-SIGN-ON-INFO)                      11010063
110200*                RESP   (PV-CICS-RESPONSE)                        11020063
110300*        END-EXEC                                                 11030063
110400*    ELSE                                                         11040063
110500*        EXEC CICS                                                11050063
110600*            READQ TS                                             11060063
110700*                QUEUE   (TS-INFO-QUEUE-NAME)                     11070063
110800*                SYSID   (PV-SYSID)                               11080063
110900*                ITEM    (PV-TS-ITEM)                             11090063
111000*                INTO    (DP026-SIGN-ON-INFO)                     11100063
111100*                LENGTH  (PV-SIGN-ON-INFO-LENGTH)                 11110063
111200*                RESP    (PV-CICS-RESPONSE)                       11120063
111300*        END-EXEC                                                 11130063
111400*    END-IF.                                                      11140063
111500                                                                  11150063
111600*    EVALUATE TRUE                                                11160063
111700*        WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 11170063
111800*            MOVE DP026-LOCATION-NBR  TO  PC038-CURR-OPER-UNT     11180063
111900*        WHEN OTHER                                               11190063
112000*            MOVE '1400-FIND-LOGON-INFO'                          11200063
112100*                TO DP013-PARAGRAPH                               11210063
112200*            MOVE 'UNABLE TO READ LOGON TSQ'                      11220063
112300*                TO DP013-MESSAGE-TEXT (1)                        11230063
112400***          SET DP013-CICS-ABEND     TO TRUE                     11240063
112500***          SET DP013-NO-ROLLBACK    TO TRUE                     11250063
112600***          PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               11260063
112700*            MOVE 'SYSTEM ERR/HELP DES' TO AMSGLN1O               11270063
112800*            PERFORM 7000-ABEND                                   11280063
112900***          PERFORM 8010-SEND-DATA-ONLY                          11290063
113000***          PERFORM 8110-RETURN-WITH-MSG                         11300063
113100*    END-EVALUATE.                                                11310063
113200                                                                  11320063
113300*                                                                 11330063
113400 2000-PROCESS-SCREEN-FIELDS.                                      11340063
113500                                                                  11350063
113600     IF NOT PC056-FROM-SUKRF002-WITH-DATA                         11360063
113700         PERFORM 8020-RECEIVE-MAP                                 11370063
113800     END-IF                                                       11380063
113900                                                                  11390063
114000     MOVE DP015-UNP-ALP-NOR-MDT TO ABARCODEA                      11400063
114100                                   APONBRA                        11410063
114200                                   ARCVRA                         11420063
114300                                   ANEWLOCA                       11430063
114400                                   ANEWOPSTA                      11440063
114500     MOVE DP015-ASK-NOR-MDT     TO AMSGLN1A                       11450063
114600                                   AMSGLN2A                       11460063
114700     MOVE SPACES                TO AMSGLN1O                       11470063
114800                                   AMSGLN2O                       11480063
114900     SET PC056-NEW-OPER-SET-PROT-NO                               11490063
115000         PS-VALID-INPUT         TO TRUE                           11500063
115100     PERFORM 2100-EDIT-INPUT.                                     11510063
115200                                                                  11520063
115300     IF PS-VALID-INPUT                                            11530063
115400         SET PS-ERRORS-NO                                         11540063
115500             PS-OPER-SET-FOUND-NO TO TRUE                         11550063
115600         PERFORM 3000-GET-DISPLAY-DATA                            11560063
115700         IF PS-OPER-SET-FOUND-YES                                 11570063
115800             PERFORM 2600-OPER-SET-PROTECT-CHK                    11580063
115900     END-IF.                                                      11590063
116000                                                                  11600063
116100 2100-EDIT-INPUT.                                                 11610063
116200     IF PC056-FROM-SUKRF002-WITH-DATA                             11620063
116300         CONTINUE                                                 11630063
116400     ELSE                                                         11640063
116500     IF ABARCODEI > SPACES                                        11650063
116600       OR (APONBRI > SPACES AND ARCVRI > SPACES)                  11660063
116700         CONTINUE                                                 11670063
116800     ELSE                                                         11680063
116900         SET PS-ERRORS-YES                                        11690063
117000             PS-INVALID-INPUT       TO TRUE                       11700063
117100         MOVE DP015-UNP-ALP-BRT-MDT TO ABARCODEA                  11710063
117200                                       APONBRA                    11720063
117300                                       ARCVRA                     11730063
117400         MOVE -1                    TO ABARCODEL                  11740063
117500         MOVE PM-NO-DATA-1          TO AMSGLN1O                   11750063
117600         MOVE PM-NO-DATA-2          TO AMSGLN2O                   11760063
117700     END-IF.                                                      11770063
117800     IF PS-ERRORS-NO                                              11780063
117900         IF ABARCODEL > 0                                         11790063
118000           AND ABARCODEI NOT = SPACES                             11800063
118100             PERFORM 2200-EDIT-BARCODE                            11810063
118200         ELSE                                                     11820063
118300             PERFORM 2300-EDIT-KEYED-PO-RCVR                      11830063
118400         END-IF                                                   11840063
118500     END-IF.                                                      11850063
118600     IF PS-ERRORS-NO                                              11860063
118700         IF PS-USE-SSCC-YES                                       11870063
118800             PERFORM 2400-CHECK-CARTON-ID                         11880063
118900             IF PS-ERRORS-NO                                      11890063
119000                 PERFORM 2500-CHECK-TRECEIV                       11900063
119100* CLP 06/13/13 PR5148B START                                      11910063
119200                 PERFORM 2529-GET-LOCATION                        11920063
119300                 PERFORM 2530-CHECK-RFID                          11930063
119400* CLP 06/13/13 PR5148B END                                        11940063
119500             END-IF                                               11950063
119600         ELSE                                                     11960063
119700             IF PS-USE-PO-RCVR-YES                                11970063
119800                 PERFORM 2500-CHECK-TRECEIV                       11980063
119900             ELSE                                                 11990063
120000                 SET PS-ERRORS-YES                                12000063
120100                     PS-INVALID-INPUT       TO TRUE               12010063
120200                 MOVE DP015-UNP-ALP-BRT-MDT TO ABARCODEA          12020063
120300                                               APONBRA            12030063
120400                                               ARCVRA             12040063
120500                 MOVE -1                    TO ABARCODEL          12050063
120600                 MOVE PM-INVALID-DATA       TO AMSGLN1O           12060063
120700             END-IF                                               12070063
120800         END-IF                                                   12080063
120900     END-IF.                                                      12090063
121000                                                                  12100063
121100******************************************************************12110063
121200* EDIT THE BARCODE ID SCANNED OR ENTERED.                         12120063
121300******************************************************************12130063
121400 2200-EDIT-BARCODE.                                               12140063
121500     MOVE ABARCODEI                   TO PV-BARCODE               12150063
121600     SET PS-USE-PO-RCVR-NO                                        12160063
121700         PS-SCANNED-DATA-NO                                       12170063
121800         PS-USE-SSCC-NO               TO TRUE.                    12180063
121900     MOVE 0                           TO PV-COUNT.                12190063
122000     INSPECT PV-BARCODE TALLYING PV-COUNT FOR CHARACTERS          12200063
122100                 BEFORE INITIAL SPACE.                            12210063
122200     EVALUATE TRUE                                                12220063
122300         WHEN PV-COUNT = PC-11                                    12230063
122400             MOVE PV-BARCODE           TO DP010I-UNEDITED-FIELD   12240063
122500             MOVE 17                   TO DP010I-MAXIMUM-DIGITS   12250063
122600             MOVE 0                    TO DP010I-MAXIMUM-DECIMALS 12260063
122700             SET DP010I-NEGATIVE-NOT-ALLOWED                      12270063
122800                                       TO TRUE                    12280063
122910             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12291063
122920                         USING DP010I-NUMERIC-EDIT-AREA           12292063
123000             IF  DP010I-ERROR-DETECTED                            12300063
123100                 SET PS-ERRORS-YES                                12310063
123200                     PS-INVALID-INPUT        TO TRUE              12320063
123300                 MOVE DP015-UNP-ALP-BRT-MDT  TO ABARCODEA         12330063
123400                 MOVE -1                     TO ABARCODEL         12340063
123500                 MOVE PM-MUST-BE-NUM         TO AMSGLN1O          12350063
123600             ELSE                                                 12360063
123700                 IF DP010I-NUM-FIELD-17-DIG-0-DEC = ZERO          12370063
123800                     SET PS-ERRORS-YES                            12380063
123900                         PS-INVALID-INPUT    TO TRUE              12390063
124000                     MOVE DP015-UNP-ALP-BRT-MDT                   12400063
124100                                             TO ABARCODEA         12410063
124200                     MOVE -1                 TO ABARCODEL         12420063
124300                     MOVE PC034-MUST-BE-GT-0-MSG                  12430063
124400                                             TO AMSGLN1O          12440063
124500                 ELSE                                             12450063
124600                     MOVE DP010I-NUM-FIELD-17-DIG-0-DEC           12460063
124700                                             TO PV-PO-RCVR        12470063
124800                     MOVE PV-PO-N            TO APONBRO           12480063
124900                                                DK-PO-NBR         12490063
125000                     MOVE PV-RCVR-N          TO ARCVRO            12500063
125100                                                DK-REC-SEQ-NBR    12510063
125200                     MOVE SPACES             TO ABARCODEO         12520063
125300                     MOVE ZERO               TO ABARCODEL         12530063
125400                     SET PS-USE-PO-RCVR-YES  TO TRUE              12540063
125500                 END-IF                                           12550063
125600             END-IF                                               12560063
125700         WHEN PV-COUNT = 0                                        12570063
125800             CONTINUE                                             12580063
125900         WHEN PV-COUNT < 18                                       12590063
126000             SET PS-ERRORS-YES                                    12600063
126100                 PS-INVALID-INPUT            TO TRUE              12610063
126200             MOVE DP015-UNP-ALP-BRT-MDT      TO ABARCODEA         12620063
126300             MOVE -1                         TO ABARCODEL         12630063
126400             MOVE PC034-MORE-DIGITS-REQD     TO AMSGLN1O          12640063
126500         WHEN OTHER                                               12650063
126600             SET PS-SCANNED-DATA-NO TO TRUE                       12660063
126700             IF PV-COUNT = 18                                     12670063
126800                 MOVE PV-BCD-LAST-17   TO DP010I-UNEDITED-FIELD   12680063
126900                 MOVE 17               TO DP010I-MAXIMUM-DIGITS   12690063
127000             ELSE                                                 12700063
127100                 MOVE PV-BCD-SCAN-LAST-17                         12710063
127200                                       TO DP010I-UNEDITED-FIELD   12720063
127300                 MOVE 17               TO DP010I-MAXIMUM-DIGITS   12730063
127400                 SET PS-SCANNED-DATA-YES                          12740063
127500                                       TO TRUE                    12750063
127600             END-IF                                               12760063
127700             MOVE 0                    TO DP010I-MAXIMUM-DECIMALS 12770063
127800             SET DP010I-NEGATIVE-NOT-ALLOWED                      12780063
127900                                       TO TRUE                    12790063
128010             CALL DP010I-NUMERIC-EDIT-ROUTINE                     12801063
128020                         USING DP010I-NUMERIC-EDIT-AREA           12802063
128100             IF  DP010I-ERROR-DETECTED                            12810063
128200                 SET PS-ERRORS-YES                                12820063
128300                     PS-INVALID-INPUT        TO TRUE              12830063
128400                 MOVE DP015-UNP-ALP-BRT-MDT  TO ABARCODEA         12840063
128500                 MOVE -1                     TO ABARCODEL         12850063
128600                 MOVE PM-MUST-BE-NUM         TO AMSGLN1O          12860063
128700             ELSE                                                 12870063
128800                 IF DP010I-NUM-FIELD-17-DIG-0-DEC = ZERO          12880063
128900                     SET PS-ERRORS-YES                            12890063
129000                         PS-INVALID-INPUT    TO TRUE              12900063
129100                     MOVE DP015-UNP-ALP-BRT-MDT                   12910063
129200                                             TO ABARCODEA         12920063
129300                     MOVE -1                 TO ABARCODEL         12930063
129400                     MOVE PC034-MUST-BE-GT-0-MSG                  12940063
129500                                             TO AMSGLN1O          12950063
129600                 ELSE                                             12960063
129700                     COMPUTE PC056-CARTON ROUNDED  =              12970063
129800                             DP010I-NUM-FIELD-17-DIG-0-DEC * 1    12980063
129900                     COMPUTE PV-BARCODE-N ROUNDED  =              12990063
130000                             DP010I-NUM-FIELD-17-DIG-0-DEC * 1    13000063
130100                     EVALUATE TRUE                                13010063
130200                        WHEN PV-COUNT = PC-20                     13020063
130300                            MOVE PV-BCD-SCAN-LAST-18              13030063
130400                                             TO PV-BARCODE-N      13040063
130500                            MOVE PV-BARCODE-N                     13050063
130600                                             TO DK-CARTON-ID      13060063
130700                            MOVE PV-BARCODE-N                     13070063
130800                                             TO PC056-CARTON      13080063
130900                        WHEN PV-COUNT = PC-19                     13090063
131000                            MOVE PV-BCD-SCAN-18-OF-19             13100063
131100                                             TO PV-BARCODE-N      13110063
131200                            MOVE PV-BARCODE-N                     13120063
131300                                             TO DK-CARTON-ID      13130063
131400                            MOVE PV-BARCODE-N                     13140063
131500                                             TO PC056-CARTON      13150063
131600                        WHEN PV-COUNT = PC-18                     13160063
131700                            MOVE PV-BARCODE  TO PV-BARCODE-N      13170063
131800                            MOVE PV-BARCODE-N                     13180063
131900                                             TO DK-CARTON-ID      13190063
132000                            MOVE PV-BARCODE-N                     13200063
132100                                             TO PC056-CARTON      13210063
132200                     END-EVALUATE                                 13220063
132300                     SET PS-USE-SSCC-YES     TO TRUE              13230063
132400*                    MOVE PV-BARCODE-N       TO ABARCODEO         13240063
132500                 END-IF                                           13250063
132600             END-IF                                               13260063
132700     END-EVALUATE.                                                13270063
132800                                                                  13280063
132900 2300-EDIT-KEYED-PO-RCVR.                                         13290063
133000     MOVE APONBRI                            TO PV-KEYED-PO-NBR   13300063
133100     SET PS-USE-PO-RCVR-NO                   TO TRUE.             13310063
133200     MOVE 0                           TO PV-COUNT.                13320063
133300     INSPECT PV-KEYED-PO-NBR TALLYING PV-COUNT FOR      CHARACTERS13330063
133400                             BEFORE INITIAL SPACE.                13340063
133500     EVALUATE TRUE                                                13350063
133600         WHEN PV-COUNT = 8                                        13360063
133700             IF PV-KEYED-PO-NBR NOT NUMERIC                       13370063
133800                 SET PS-ERRORS-YES                                13380063
133900                     PS-INVALID-INPUT        TO TRUE              13390063
134000                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBRA           13400063
134100                 MOVE -1                     TO APONBRL           13410063
134200                 MOVE PM-MUST-BE-NUM         TO AMSGLN1O          13420063
134300             ELSE                                                 13430063
134400                 MOVE PV-KEYED-PO-NBR        TO PV-PO-N           13440063
134500             END-IF                                               13450063
134600         WHEN PV-COUNT = 7                                        13460063
134700             IF PV-KEYED-PO-NBR-1-7 NOT NUMERIC                   13470063
134800                 SET PS-ERRORS-YES                                13480063
134900                     PS-INVALID-INPUT        TO TRUE              13490063
135000                 MOVE DP015-UNP-ALP-BRT-MDT  TO APONBRA           13500063
135100                 MOVE -1                     TO APONBRL           13510063
135200                 MOVE PM-MUST-BE-NUM         TO AMSGLN1O          13520063
135300             ELSE                                                 13530063
135400                 MOVE PV-KEYED-PO-NBR-1-7    TO PV-PO-N           13540063
135500             END-IF                                               13550063
135600         WHEN PV-COUNT < 7                                        13560063
135700             SET PS-ERRORS-YES                                    13570063
135800                 PS-INVALID-INPUT            TO TRUE              13580063
135900             MOVE DP015-UNP-ALP-BRT-MDT      TO APONBRA           13590063
136000             MOVE -1                         TO APONBRL           13600063
136100             MOVE PC034-MORE-DIGITS-REQD     TO AMSGLN1O          13610063
136200     END-EVALUATE.                                                13620063
136300                                                                  13630063
136400     MOVE ARCVRI               TO DP010I-UNEDITED-FIELD           13640063
136500     MOVE 4                    TO DP010I-MAXIMUM-DIGITS           13650063
136600     MOVE 0                    TO DP010I-MAXIMUM-DECIMALS         13660063
136700     SET DP010I-NEGATIVE-NOT-ALLOWED                              13670063
136800                               TO TRUE                            13680063
136910     CALL DP010I-NUMERIC-EDIT-ROUTINE                             13691063
136920                         USING DP010I-NUMERIC-EDIT-AREA           13692063
137000     IF DP010I-ERROR-DETECTED                                     13700063
137100         SET PS-ERRORS-YES                                        13710063
137200             PS-INVALID-INPUT        TO TRUE                      13720063
137300         MOVE DP015-UNP-ALP-BRT-MDT  TO ARCVRA                    13730063
137400         MOVE -1                     TO ARCVRL                    13740063
137500         MOVE PM-MUST-BE-NUM         TO AMSGLN1O                  13750063
137600     ELSE                                                         13760063
137700         IF DP010I-NUMERIC-FIELD = ZERO                           13770063
137800             SET PS-ERRORS-YES                                    13780063
137900                 PS-INVALID-INPUT    TO TRUE                      13790063
138000             MOVE DP015-UNP-ALP-BRT-MDT                           13800063
138100                                     TO ARCVRA                    13810063
138200             MOVE -1                 TO ARCVRL                    13820063
138300             MOVE PC034-MUST-BE-GT-0-MSG                          13830063
138400                                     TO AMSGLN1O                  13840063
138500         END-IF                                                   13850063
138600     END-IF.                                                      13860063
138700                                                                  13870063
138800     IF PS-ERRORS-NO                                              13880063
138900         SET PS-USE-PO-RCVR-YES              TO TRUE              13890063
139000         MOVE PV-PO-N                        TO DK-PO-NBR         13900063
139100         MOVE PV-PO-N                        TO PC056-PO          13910063
139200         MOVE DP010I-NUMERIC-FIELD           TO DK-REC-SEQ-NBR    13920063
139300         MOVE DP010I-NUMERIC-FIELD           TO PC056-RCVR-SEQ-NBR13930063
139400     END-IF.                                                      13940063
139500                                                                  13950063
139600 2400-CHECK-CARTON-ID.                                            13960063
139700     EXEC SQL                                                     13970063
139800         SELECT B.PO_NBR                                          13980063
139900               ,A.REC_SEQ_NBR                                     13990063
140000         INTO   :DK-PO-NBR                                        14000063
140100               ,:DK-REC-SEQ-NBR                                   14010063
140200         FROM   TPKSLIP A                                         14020063
140300               ,TINPKSU B                                         14030063
140400         WHERE  B.SHIPT_UNT_ID  = :DK-CARTON-ID                   14040063
140500           AND  B.PO_NBR        = A.PO_NBR                        14050063
140600           AND  B.SEQ_NBR       = A.SEQ_NBR                       14060063
140700           AND  A.VER_STAT_CDE  = 'A'                             14070063
140800           AND  A.PKSL_STAT_CDE = 'AC'                            14080063
140900     END-EXEC.                                                    14090063
141000     EVALUATE SQLCODE                                             14100063
141100         WHEN ZERO                                                14110063
141200             MOVE DK-PO-NBR      TO PV-PO-N                       14120063
141300             MOVE DK-REC-SEQ-NBR TO PV-RCVR-N                     14130063
141400             MOVE PV-PO-N        TO APONBRO                       14140063
141500             MOVE PV-RCVR-N      TO ARCVRO                        14150063
141600         WHEN +100                                                14160063
141700             SET PS-ERRORS-YES                                    14170063
141800                 PS-INVALID-INPUT       TO TRUE                   14180063
141900             MOVE DP015-UNP-ALP-BRT-MDT TO ABARCODEA              14190063
142000             MOVE PM-CARTON-NOT-FOUND   TO AMSGLN1O               14200063
142100             MOVE -1                    TO ABARCODEL              14210063
142200         WHEN OTHER                                               14220063
142300             MOVE '2400-CHECK-CARTON-ID ' TO DP013-PARAGRAPH      14230063
142400             STRING 'CARTON ID = ' DELIMITED BY SIZE              14240063
142500                     PV-BARCODE-N  DELIMITED BY SIZE              14250063
142600                                     INTO DP013-MESSAGE-TEXT (1)  14260063
142700             MOVE SQLCA                TO DP013-SQLCA             14270063
142800             MOVE 'TPKSLIP'            TO DP013-DB2-TABLE-NAME (1)14280063
142900             MOVE 'TINPKSU'            TO DP013-DB2-TABLE-NAME (2)14290063
143000             PERFORM 7000-ABEND                                   14300063
143100     END-EVALUATE.                                                14310063
143200                                                                  14320063
143300 2500-CHECK-TRECEIV.                                              14330063
143400     EXEC SQL                                                     14340063
143500         SELECT  OPER_UNT_ID                                      14350063
143600               , FCLTY_ID                                         14360063
143700               , STATUS_CDE                                       14370063
143800               , REC_TYP_CDE                                      14380063
143900               , PACK_BY_ST_IND                                   14390063
144000               , REC_TMST                                         14400063
144100               , EXPTED_CART_CNT                                  14410063
144200               , ACTL_CART_CNT                                    14420063
144300               , CURR_OPER_UNT_ID                                 14430063
144400               , PKGNG_CDE                                        14440063
144500         INTO   :RECEIV-OPER-UNT-ID                               14450063
144600               ,:RECEIV-FCLTY-ID                                  14460063
144700               ,:RECEIV-STATUS-CDE                                14470063
144800               ,:RECEIV-REC-TYP-CDE                               14480063
144900               ,:RECEIV-PACK-BY-ST-IND                            14490063
145000               ,:RECEIV-REC-TMST                                  14500063
145100               ,:RECEIV-EXPTED-CART-CNT                           14510063
145200               ,:RECEIV-ACTL-CART-CNT                             14520063
145300               ,:RECEIV-CURR-OPER-UNT-ID                          14530063
145400               ,:RECEIV-PKGNG-CDE                                 14540063
145500         FROM   TRECEIV                                           14550063
145600         WHERE  ORD_NBR        = :DK-PO-NBR                       14560063
145700           AND  REC_SEQ_NBR    = :DK-REC-SEQ-NBR                  14570063
145800     END-EXEC.                                                    14580063
145900                                                                  14590063
146000     EVALUATE SQLCODE                                             14600063
146100         WHEN ZERO                                                14610063
146200             MOVE RECEIV-STATUS-CDE     TO  PC056-RCVR-STATUS     14620063
146300             MOVE RECEIV-CURR-OPER-UNT-ID                         14630063
146400                                        TO PC056-OPER-UNT-ID      14640063
146500*                                                                 14650063
146600             SET  PS-UCC128-NO  TO  TRUE                          14660063
146700             MOVE  ZEROES        TO  PV-SCAN-COUNT                14670063
146800             PERFORM 2510-CHECK-IF-UCC128                         14680063
146900             IF  PS-UCC128-YES  AND                               14690063
147000                 VHTRIP-TRIP-ID  >  0                             14700063
147100                 PERFORM 2520-GET-SCN-COUNT                       14710063
147200             END-IF                                               14720063
147300                                                                  14730063
147400*                                                                 14740063
147500             IF RECEIV-ACTL-CART-CNT > ZERO                       14750063
147600                 MOVE RECEIV-ACTL-CART-CNT                        14760063
147700                                        TO PV-CARTONS-Z           14770063
147800                                           PC056-CARTON-CNT       14780063
147900             ELSE                                                 14790063
148000             IF  PV-SCAN-COUNT  >  ZERO                           14800063
148100                 MOVE  PV-SCAN-COUNT    TO PV-CARTONS-Z           14810063
148200                                           PC056-CARTON-CNT       14820063
148300             ELSE                                                 14830063
148400                 MOVE RECEIV-EXPTED-CART-CNT                      14840063
148500                                        TO PV-CARTONS-Z           14850063
148600                                           PC056-CARTON-CNT       14860063
148700             END-IF                                               14870063
148800             END-IF                                               14880063
148900             MOVE PV-CARTONS-Z          TO ACRTNSO                14890063
149000         WHEN +100                                                14900063
149100             SET PS-ERRORS-YES                                    14910063
149200                 PS-INVALID-INPUT       TO TRUE                   14920063
149300             MOVE DP015-UNP-ALP-BRT-MDT TO APONBRA                14930063
149400                                           ARCVRA                 14940063
149500             MOVE PM-RCVR-NOT-FOUND     TO AMSGLN1O               14950063
149600             MOVE -1                    TO APONBRL                14960063
149700         WHEN OTHER                                               14970063
149800             MOVE DK-PO-NBR             TO PV-PO-N                14980063
149900             MOVE DK-REC-SEQ-NBR        TO PV-RCVR-N              14990063
150000             MOVE '2500-CHECK-TRECEIV ' TO DP013-PARAGRAPH        15000063
150100             STRING 'PO NUMBER = ' DELIMITED BY SIZE              15010063
150200                     PV-PO-N       DELIMITED BY SIZE              15020063
150300                                     INTO DP013-MESSAGE-TEXT (1)  15030063
150400             STRING 'RECEIVER  = ' DELIMITED BY SIZE              15040063
150500                     PV-RCVR-N     DELIMITED BY SIZE              15050063
150600                                     INTO DP013-MESSAGE-TEXT (2)  15060063
150700             MOVE SQLCA                TO DP013-SQLCA             15070063
150800             MOVE 'TRECEIV'            TO DP013-DB2-TABLE-NAME (1)15080063
150900             PERFORM 7000-ABEND                                   15090063
151000     END-EVALUATE.                                                15100063
151100                                                                  15110063
151200*----------------------------------------------------------------*15120063
151300* CHECK TO SEE IF PO/RCVR IS UCC128                               15130063
151400*----------------------------------------------------------------*15140063
151500 2510-CHECK-IF-UCC128.                                            15150063
151600      EXEC SQL                                                    15160063
151700          SELECT B.PO_NBR                                         15170063
151800          INTO  :INPKSU-PO-NBR                                    15180063
151900          FROM   TINPKSU A                                        15190063
152000             ,   TPKSLIP B                                        15200063
152100         WHERE B.PO_NBR       = :DK-PO-NBR                        15210063
152200           AND B.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   15220063
152300           AND A.PO_NBR       = B.PO_NBR                          15230063
152400           AND A.SEQ_NBR      = B.SEQ_NBR                         15240063
152500         FETCH FIRST 1 ROW ONLY                                   15250063
152600      END-EXEC.                                                   15260063
152700                                                                  15270063
152800       EVALUATE TRUE                                              15280063
152900         WHEN SQLCODE = +0                                        15290063
153000             SET PS-UCC128-YES   TO TRUE                          15300063
153100             PERFORM 2515-GET-TRIP                                15310063
153200         WHEN SQLCODE = +100                                      15320063
153300             SET PS-UCC128-NO    TO TRUE                          15330063
153400         WHEN OTHER                                               15340063
153500             MOVE DK-PO-NBR              TO PV-PO-N               15350063
153600             MOVE DK-REC-SEQ-NBR         TO PV-RCVR-N             15360063
153700             MOVE '2510-CHECK-IF-UCC128' TO DP013-PARAGRAPH       15370063
153800             STRING 'PO NUMBER = '                                15380063
153900                     PV-PO-N '-'                                  15390063
154000                     PV-RCVR-N     DELIMITED BY SIZE              15400063
154100                                     INTO DP013-MESSAGE-TEXT (1)  15410063
154200             MOVE SQLCA                TO DP013-SQLCA             15420063
154300             MOVE 'TINPKSU'            TO DP013-DB2-TABLE-NAME (1)15430063
154400             MOVE 'TPKSLIP'            TO DP013-DB2-TABLE-NAME (2)15440063
154500             PERFORM 7000-ABEND                                   15450063
154600      END-EVALUATE.                                               15460063
154700                                                                  15470063
154800*----------------------------------------------------------------*15480063
154900* GET TRIP                                                        15490063
155000*----------------------------------------------------------------*15500063
155100 2515-GET-TRIP.                                                   15510063
155200                                                                  15520063
155300      EXEC SQL                                                    15530063
155400           SELECT DISTINCT                                        15540063
155500                   A.TRIP_ID                                      15550063
155600             INTO  :VHTRIP-TRIP-ID                                15560063
155700             FROM  TVHTRIP A                                      15570063
155800                 , TSHIPMT B                                      15580063
155900                 , TSHPTPO C                                      15590063
156000             WHERE A.TRIP_ID           = B.TRIP_ID                15600063
156100               AND C.SHIPT_ID          = B.SHIPT_ID               15610063
156200               AND C.PO_NBR            = :DK-PO-NBR               15620063
156300               AND C.REC_SEQ_NBR       = :DK-REC-SEQ-NBR          15630063
156400      END-EXEC.                                                   15640063
156500                                                                  15650063
156600     EVALUATE TRUE                                                15660063
156700         WHEN SQLCODE = +0                                        15670063
156800              CONTINUE                                            15680063
156900         WHEN SQLCODE = +100                                      15690063
157000             MOVE ZEROES                 TO VHTRIP-TRIP-ID        15700063
157100         WHEN OTHER                                               15710063
157200             MOVE DK-PO-NBR              TO PV-PO-N               15720063
157300             MOVE DK-REC-SEQ-NBR         TO PV-RCVR-N             15730063
157400             MOVE '2515-GET-TRIP'        TO DP013-PARAGRAPH       15740063
157500             STRING 'PO NUMBER = '                                15750063
157600                     PV-PO-N '-'                                  15760063
157700                     PV-RCVR-N     DELIMITED BY SIZE              15770063
157800                                     INTO DP013-MESSAGE-TEXT (1)  15780063
157900             MOVE SQLCA                TO DP013-SQLCA             15790063
158000             MOVE 'TPKSLIP'            TO DP013-DB2-TABLE-NAME (1)15800063
158100             MOVE 'TINPKSU'            TO DP013-DB2-TABLE-NAME (2)15810063
158200             MOVE 'TSHUNLO'            TO DP013-DB2-TABLE-NAME (3)15820063
158300             PERFORM 7000-ABEND                                   15830063
158400      END-EVALUATE.                                               15840063
158500                                                                  15850063
158600*----------------------------------------------------------------*15860063
158700* GET COUNT OF SCANNED CARTONS                                    15870063
158800*----------------------------------------------------------------*15880063
158900 2520-GET-SCN-COUNT.                                              15890063
159000     MOVE ZEROES TO PV-SCAN-COUNT.                                15900063
159100                                                                  15910063
159200     EXEC SQL                                                     15920063
159300         SELECT COUNT(*)                                          15930063
159400         INTO  :PV-SCAN-COUNT                                     15940063
159500         FROM  TPKSLIP A,                                         15950063
159600               TINPKSU B,                                         15960063
159700               TSHUNLO C                                          15970063
159800         WHERE A.PO_NBR       = :DK-PO-NBR                        15980063
159900           AND A.REC_SEQ_NBR  = :DK-REC-SEQ-NBR                   15990063
160000           AND A.PO_NBR       = B.PO_NBR                          16000063
160100           AND A.SEQ_NBR      = B.SEQ_NBR                         16010063
160200           AND B.SHIPT_UNT_ID = C.SHIPT_UNT_ID                    16020063
160300           AND C.TRIP_ID      = :VHTRIP-TRIP-ID                   16030063
160400           AND A.VER_STAT_CDE = 'A'                               16040063
160500     END-EXEC.                                                    16050063
160600                                                                  16060063
160700     EVALUATE TRUE                                                16070063
160800         WHEN SQLCODE = +0                                        16080063
160900              CONTINUE                                            16090063
161000         WHEN SQLCODE = +100                                      16100063
161100             MOVE ZEROES            TO PV-SCAN-COUNT              16110063
161200         WHEN OTHER                                               16120063
161300             MOVE DK-PO-NBR              TO PV-PO-N               16130063
161400             MOVE DK-REC-SEQ-NBR         TO PV-RCVR-N             16140063
161500             MOVE '2520-GET-SCN-COUNT'   TO DP013-PARAGRAPH       16150063
161600             STRING 'PO NUMBER = '                                16160063
161700                     PV-PO-N '-'                                  16170063
161800                     PV-RCVR-N     DELIMITED BY SIZE              16180063
161900                                     INTO DP013-MESSAGE-TEXT (1)  16190063
162000             MOVE SQLCA                TO DP013-SQLCA             16200063
162100             MOVE 'TPKSLIP'            TO DP013-DB2-TABLE-NAME (1)16210063
162200             MOVE 'TINPKSU'            TO DP013-DB2-TABLE-NAME (2)16220063
162300             MOVE 'TSHUNLO'            TO DP013-DB2-TABLE-NAME (3)16230063
162400             PERFORM 7000-ABEND                                   16240063
162500      END-EVALUATE.                                               16250063
162600                                                                  16260063
162700* CLP 06/13/13 PR5148B START                                      16270063
162800*----------------------------------------------------------------*16280063
162900* GET STORE # FOR RFID SUBROUTINE                                 16290063
163000*----------------------------------------------------------------*16300063
163100 2529-GET-LOCATION.                                               16310063
163200                                                                  16320063
163300     INITIALIZE DCLTSULBXF.                                       16330063
163400                                                                  16340063
163500     EXEC SQL                                                     16350063
163600         SELECT  XF.DEST_OPER_UNT_ID                              16360063
163700                ,XF.CART_LBL_TYP_CDE                              16370063
163800         INTO  :SULBXF-DEST-OPER-UNT-ID                           16380063
163900              ,:SULBXF-CART-LBL-TYP-CDE                           16390063
164000         FROM   TSULBXF XF                                        16400063
164100         WHERE  XF.SHIPT_UNT_ID = :DK-CARTON-ID                   16410063
164200           AND  XF.STAT_CDE     = 'A'                             16420063
164300     END-EXEC                                                     16430063
164400                                                                  16440063
164500     EVALUATE SQLCODE                                             16450063
164600         WHEN ZERO                                                16460063
164700             CONTINUE                                             16470063
164800         WHEN +100                                                16480063
164900             MOVE ZEROES TO SULBXF-DEST-OPER-UNT-ID               16490063
165000         WHEN OTHER                                               16500063
165100             MOVE DK-PO-NBR            TO PV-PO-N                 16510063
165200             MOVE DK-OPER-SET-ID       TO PV-OPER-SET-N           16520063
165300             MOVE KRPRPM-LOC-ID                                   16530063
165400                                       TO PV-OPER-UNT-ID          16540063
165500             MOVE '2529-GET-LOCATION'                             16550063
165600                                       TO DP013-PARAGRAPH         16560063
165700             STRING 'PO NUMBER   = ' DELIMITED BY SIZE            16570063
165800                     PV-PO-N         DELIMITED BY SIZE            16580063
165900                                     INTO DP013-MESSAGE-TEXT (1)  16590063
166000             STRING 'OPER UNT  = '  DELIMITED BY SIZE             16600063
166100                     PV-OPER-UNT-ID DELIMITED BY SIZE             16610063
166200                                     INTO DP013-MESSAGE-TEXT (2)  16620063
166300             MOVE SQLCA                TO DP013-SQLCA             16630063
166400             MOVE 'TSULBXF'            TO DP013-DB2-TABLE-NAME (1)16640063
166500             PERFORM 7000-ABEND                                   16650063
166600     END-EVALUATE.                                                16660063
166700                                                                  16670063
166800****************************************************************  16680063
166900* CHECK SUKUT149 ROUTINE TO SEE IF ITS A VALID RFID CARTON       *16690063
167000******************************************************************16700063
167100 2530-CHECK-RFID.                                                 16710063
167200     INITIALIZE SU093-ITEM-COMMAREA.                              16720063
167300     SET SU093-RFID-KOHL-DPT-IN-STR-NO TO TRUE.                   16730063
167400     SET SU093-RFID-KOHL-DEPT-SUBCL-NO TO TRUE.                   16740063
167500     SET SU093-VNDR-DPT-RFID-COMPLI-NO TO TRUE.                   16750063
167600     SET SU093-VNDR-DPT-RFID-TAGS-NO   TO TRUE.                   16760063
167700     SET SU093-DC-DEPT-TAGS-NO         TO TRUE.                   16770063
167800     SET SU093-DC-USE-RFID-CART-LBL-NO TO TRUE.                   16780063
167900     SET SU093-RFID-DC-AUTO-CONVEYR-NO TO TRUE.                   16790063
168000     SET SU093-DPT-STR-P2L-FIRST-NO    TO TRUE.                   16800063
168100     MOVE SPACE TO RFIDCTNO.                                      16810063
168200                                                                  16820063
168300     SET SU093-CHECK-IN                 TO TRUE.                  16830063
168400     MOVE SPACES                        TO PV-PGM-MSG.            16840063
168500                                                                  16850063
168600     IF SULBXF-CART-LBL-TYP-CDE = PC-P                            16860063
168700*****IF RECEIV-PKGNG-CDE = 'B'                                    16870063
168800***** IT'S P2L                                                    16880063
168900         SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE               16890063
169000         SET SU093-CHECK-BY-DEPT-IN-STR-NO  TO TRUE               16900063
169100         SET SU093-RFID-STR-CHK-NEEDED-NO   TO TRUE               16910063
169200         SET SU093-CHECK-BY-DC              TO TRUE               16920063
169300         MOVE PV-BARCODE-N              TO SU093-KEY-CARTON-ID    16930063
169400         MOVE RECEIV-OPER-UNT-ID        TO SU093-KEY-OPER-UNT-ID  16940063
169500     ELSE                                                         16950063
169600         SET SU093-CHECK-BY-DEPT-SUBCLS-YES TO TRUE               16960063
169700         SET SU093-CHECK-BY-DEPT-IN-STR-YES TO TRUE               16970063
169800         SET SU093-RFID-STR-CHK-NEEDED-YES  TO TRUE               16980063
169900         SET SU093-CHECK-BY-DC              TO TRUE               16990063
170000         MOVE PV-BARCODE-N             TO SU093-KEY-CARTON-ID     17000063
170100         MOVE RECEIV-OPER-UNT-ID       TO SU093-KEY-OPER-UNT-ID   17010063
170200         MOVE SULBXF-DEST-OPER-UNT-ID  TO SU093-KEY-DEST-LOC      17020063
170300     END-IF.                                                      17030063
170400                                                                  17040063
170500     CALL SU093-RFID-PGM       USING DFHEIBLK                     17050063
170600                                     SU093-COMMAREA               17060063
170700                                     SU093-ITEM-COMMAREA.         17070063
170800                                                                  17080063
170900     EVALUATE TRUE                                                17090063
171000       WHEN SU093-SUCCESSFUL                                      17100063
171100           IF SU093-RFID-IND = 'Y'                                17110063
171200              PERFORM 2540-SET-RFID-FOR-PRINT                     17120063
171300*CLP 10/15/13 START                                               17130063
171400              IF PS-RFID-ON-LABEL-YES                             17140063
171500                  IF PS-RFID-FAILED-YES                           17150063
171600                      MOVE PM-RFID-CARTON-FAIL TO PV-PGM-MSG-A    17160063
171700**                    MOVE PM-RFID-CARTON-FAIL TO RFIDCTNO        17170063
171800**                    MOVE DP015-PRO-BRT-MDT   TO RFIDCTNA        17180063
171900                      IF SU093-PRINT-RFID-EAS                     17190063
172000                      OR SU093-PRINT-EAS                          17200063
172100                         MOVE '/EAS'          TO PV-PGM-MSG-B     17210063
172200                      ELSE                                        17220063
172300                         MOVE 'CRT'           TO PV-PGM-MSG-B     17230063
172400                      END-IF                                      17240063
172500                  ELSE                                            17250063
172600                     EVALUATE TRUE                                17260063
172700                       WHEN SU093-PRINT-RFID-EAS                  17270063
172800                          MOVE ' EAS/'         TO PV-PGM-MSG-A    17280063
172900                          MOVE 'RFID'          TO PV-PGM-MSG-B    17290063
173000                       WHEN SU093-PRINT-RFID                      17300063
173100                          MOVE 'RFID '         TO PV-PGM-MSG-A    17310063
173200                          MOVE 'CRT'           TO PV-PGM-MSG-B    17320063
173300                       WHEN SU093-PRINT-EAS                       17330063
173400                          MOVE ' EAS '         TO PV-PGM-MSG-A    17340063
173500                          MOVE 'CRT'           TO PV-PGM-MSG-B    17350063
173600                     END-EVALUATE                                 17360063
173700                  END-IF                                          17370063
173800              ELSE                                                17380063
173900                  IF SU093-PRINT-EAS                              17390063
174000                  OR SU093-PRINT-RFID-EAS                         17400063
174100                     MOVE ' EAS'          TO PV-PGM-MSG-A         17410063
174200                     MOVE 'CRT'           TO PV-PGM-MSG-B         17420063
174300                  ELSE                                            17430063
174400                     IF SU093-PRINT-EAS                           17440063
174500                        MOVE 'RFID '         TO PV-PGM-MSG-A      17450063
174600                        MOVE 'CRT'           TO PV-PGM-MSG-B      17460063
174700                     END-IF                                       17470063
174800                  END-IF                                          17480063
174900              END-IF                                              17490063
175000                                                                  17500063
175100              IF SU093-RFID-IND = 'Y'                             17510063
175200                 MOVE PV-PGM-MSG          TO RFIDCTNO             17520063
175300                 MOVE DP015-PRO-BRT-MDT   TO RFIDCTNA             17530063
175400              END-IF                                              17540063
175500*CLP 10/15/13 END                                                 17550063
175600           END-IF                                                 17560063
175700       WHEN OTHER                                                 17570063
175800           CONTINUE                                               17580063
175900     END-EVALUATE.                                                17590063
176000                                                                  17600063
176100                                                                  17610063
176200 2540-SET-RFID-FOR-PRINT.                                         17620063
176300* **************************************************************  17630063
176400* ONCE COMING BACK FROM ROUTINE AND YOU KNOW ITS RFID YOU      *  17640063
176500* STILL NEED TO CHECK THE FOLLOWING SWITCHES TO DETERMINE IF   *  17650063
176600* RFID IS PRINTED ON THE LABEL                                 *  17660063
176700* **************************************************************  17670063
176800                                                                  17680063
176900     SET PS-RFID-ON-LABEL-NO TO TRUE.                             17690063
177000                                                                  17700063
177100     IF SU093-VNDR-DPT-RFID-COMPLI-YES                            17710063
177200*       MEANS NO RFID ON LABELS                                   17720063
177300        SET PS-RFID-ON-LABEL-NO TO TRUE                           17730063
177400     ELSE                                                         17740063
177500        IF SU093-VNDR-DPT-RFID-TAGS-YES AND                       17750063
177600            SU093-DC-DEPT-TAGS-NO                                 17760063
177700*           MEANS NO RFID ON LABELS                               17770063
177800            SET PS-RFID-ON-LABEL-NO  TO TRUE                      17780063
177900        ELSE                                                      17790063
178000            IF SU093-VNDR-DPT-RFID-TAGS-NO AND                    17800063
178100              SU093-DC-DEPT-TAGS-YES                              17810063
178200*             MEANS YES TO RFID ON LABELS                         17820063
178300              SET PS-RFID-ON-LABEL-YES TO TRUE                    17830063
178400            ELSE                                                  17840063
178500              IF SU093-VNDR-DPT-RFID-TAGS-NO AND                  17850063
178600                 SU093-DC-DEPT-TAGS-NO                            17860063
178700*                MEANS NO RFID ON LABELS                          17870063
178800                 SET PS-RFID-ON-LABEL-NO TO TRUE                  17880063
178900              ELSE                                                17890063
179000                  IF SU093-VNDR-DPT-RFID-TAGS-YES AND             17900063
179100                     SU093-DC-DEPT-TAGS-YES                       17910063
179200**CLP 10/15/13       MEANS NO TO RFID ON LABELS                   17920063
179300                     SET PS-RFID-ON-LABEL-NO TO TRUE              17930063
179400                  END-IF                                          17940063
179500              END-IF                                              17950063
179600            END-IF                                                17960063
179700        END-IF                                                    17970063
179800     END-IF.                                                      17980063
179900* CLP 06/13/13 PR5148B END                                        17990063
180000                                                                  18000063
180100* CLP 10/15/13 PR5148D START                                      18010063
180200                                                                  18020063
180300     IF NOT SU093-VNDR-DPT-RFID-COMPLI-YES                        18030063
180400         PERFORM 2550-CHECK-AUDITS                                18040063
180500     END-IF.                                                      18050063
180600                                                                  18060063
180700*----------------------------------------------------------------*18070063
180800* BASED ON VENDOR TAGGING AND IF FAILED AUDIT 'RFIDQ' WILL       *18080063
180900* DISPLAY ON LABEL OR IF 100% FOR PO RFID AUDIT - FOR MANUALS    *18090063
181000*----------------------------------------------------------------*18100063
181100 2550-CHECK-AUDITS.                                               18110063
181200                                                                  18120063
181300     EXEC SQL                                                     18130063
181400        SELECT  A.AUD_STAT_CDE                                    18140063
181500            INTO :SUT00015-AUD-STAT-CDE                           18150063
181600            FROM  SUT_PO_AUD_REQ A                                18160063
181700        WHERE A.PO_NBR        = :DK-PO-NBR                        18170063
181800          AND A.RCVR_SEQ_NBR  = :DK-REC-SEQ-NBR                   18180063
181900          AND A.OPER_UNT_ID   = :RECEIV-OPER-UNT-ID               18190063
182000          AND A.INBND_TRIP_ID = :VHTRIP-TRIP-ID                   18200063
182100          AND A.PO_PREPK_ID   < 0                                 18210063
182200     END-EXEC.                                                    18220063
182300                                                                  18230063
182400     EVALUATE SQLCODE                                             18240063
182500         WHEN ZERO                                                18250063
182600             IF SU093-VNDR-DPT-RFID-TAGS-YES                      18260063
182700                IF SUT00015-AUD-STAT-CDE = 'F'                    18270063
182800*                  RFID AUDIT FAILED (FOR ALL CARTONS ON          18280063
182900*                                     SAME AUDIT #)               18290063
183000*                  MEANS YES TO RFID ON LABELS                    18300063
183100                   SET PS-RFID-ON-LABEL-YES TO TRUE               18310063
183200                   SET PS-RFID-FAILED-YES   TO TRUE               18320063
183300                ELSE                                              18330063
183400*                  RFID AUDIT PASSED OR UNKNOWN AUDIT             18340063
183500*                  MEANS NO RFID ON LABELS                        18350063
183600                   SET PS-RFID-ON-LABEL-NO TO TRUE                18360063
183700                   SET PS-RFID-FAILED-NO    TO TRUE               18370063
183800                END-IF                                            18380063
183900             END-IF                                               18390063
184000         WHEN +100                                                18400063
184100             CONTINUE                                             18410063
184200         WHEN OTHER                                               18420063
184300             MOVE DK-PO-NBR             TO PV-PO-N                18430063
184400             MOVE DK-REC-SEQ-NBR        TO PV-RCVR-N              18440063
184500             MOVE '2550-CHECK-AUDITS'                             18450063
184600                                        TO DP013-PARAGRAPH        18460063
184700             STRING 'PO NUMBER = ' DELIMITED BY SIZE              18470063
184800                     PV-PO-N       DELIMITED BY SIZE              18480063
184900                                     INTO DP013-MESSAGE-TEXT (1)  18490063
185000             STRING 'RECEIVER  = ' DELIMITED BY SIZE              18500063
185100                     PV-RCVR-N     DELIMITED BY SIZE              18510063
185200                                     INTO DP013-MESSAGE-TEXT (2)  18520063
185300             MOVE SQLCA                TO DP013-SQLCA             18530063
185400             MOVE 'SUT_PO_AUD_REQ'     TO DP013-DB2-TABLE-NAME (1)18540063
185500             PERFORM 7000-ABEND                                   18550063
185600     END-EVALUATE.                                                18560063
185700                                                                  18570063
185800     EXEC SQL                                                     18580063
185900        SELECT  A.PO_NBR                                          18590063
186000            INTO :SUT00014-PO-NBR                                 18600063
186100            FROM  SUT_PO_AUD_EXC A                                18610063
186200        WHERE A.PO_NBR        = :DK-PO-NBR                        18620063
186300          AND A.OPER_UNT_ID   = :RECEIV-OPER-UNT-ID               18630063
186400          AND A.PO_PREPK_ID   < 0                                 18640063
186500          AND A.AUD_TYP_CDE   = 'A'                               18650063
186600     END-EXEC.                                                    18660063
186700                                                                  18670063
186800     EVALUATE SQLCODE                                             18680063
186900         WHEN ZERO                                                18690063
187000             IF SU093-VNDR-DPT-RFID-TAGS-YES                      18700063
187100*                100% PO RFID AUDIT - FOR MANUALS                 18710063
187200*                MEANS YES TO RFID ON LABELS                      18720063
187300                 SET PS-RFID-ON-LABEL-YES TO TRUE                 18730063
187400                 SET PS-RFID-FAILED-YES   TO TRUE                 18740063
187500             END-IF                                               18750063
187600         WHEN +100                                                18760063
187700             CONTINUE                                             18770063
187800         WHEN OTHER                                               18780063
187900             MOVE DK-PO-NBR             TO PV-PO-N                18790063
188000             MOVE DK-REC-SEQ-NBR        TO PV-RCVR-N              18800063
188100             MOVE '2550-CHECK-AUDITS'                             18810063
188200                                        TO DP013-PARAGRAPH        18820063
188300             STRING 'PO NUMBER = ' DELIMITED BY SIZE              18830063
188400                     PV-PO-N       DELIMITED BY SIZE              18840063
188500                                     INTO DP013-MESSAGE-TEXT (1)  18850063
188600             STRING 'RECEIVER  = ' DELIMITED BY SIZE              18860063
188700                     PV-RCVR-N     DELIMITED BY SIZE              18870063
188800                                     INTO DP013-MESSAGE-TEXT (2)  18880063
188900             MOVE SQLCA                TO DP013-SQLCA             18890063
189000             MOVE 'SUT_PO_AUD_EXC'     TO DP013-DB2-TABLE-NAME (1)18900063
189100             PERFORM 7000-ABEND                                   18910063
189200     END-EVALUATE.                                                18920063
189300* CLP 10/15/13 PR5148B END                                        18930063
189400*----------------------------------------------------------------018940063
189500*                                                                *18950063
189600*----------------------------------------------------------------*18960063
189700 2600-OPER-SET-PROTECT-CHK.                                       18970063
189800     PERFORM 2610-CHECK-MULT-SHIPMENTS                            18980063
189900* * * VERIFIED RECEIPT                                            18990063
190000     IF RECEIV-STATUS-CDE      = 'VE'                             19000063
190100* * * EXPENSE RECEIPT                                             19010063
190200       OR RECEIV-REC-TYP-CDE   = 'EX'                             19020063
190300* * * WORK ORDER COMPLETE                                         19030063
190400       OR WRKORD-STAT-CDE      = 'CM'                             19040063
190500* * * DIRECT STORE SHIPMENT                                       19050063
190600       OR XLT00010-LOC-TYP-CDE = 'DS'                             19060063
190700* * * MULTIPLE SHIPMENTS                                          19070063
190800       OR PS-MULTIPLE-SHIPMENTS-YES                               19080063
190900         MOVE DP015-PRO-NOR-MDT TO ANEWOPSTA                      19090063
191000         SET PC056-NEW-OPER-SET-PROT-YES                          19100063
191100                                TO TRUE                           19110063
191200     END-IF.                                                      19120063
191300                                                                  19130063
191400     IF PC056-RCVR-VERIFIED                                       19140063
191500         MOVE DP015-PRO-NOR-MDT                                   19150063
191600                         TO ANEWLOCA                              19160063
191700     END-IF.                                                      19170063
191800                                                                  19180063
191900                                                                  19190063
192000*----------------------------------------------------------------*19200063
192100*                                                                *19210063
192200*----------------------------------------------------------------*19220063
192300 2610-CHECK-MULT-SHIPMENTS.                                       19230063
192400     SET PS-MULTIPLE-SHIPMENTS-NO TO TRUE                         19240063
192500     EXEC SQL                                                     19250063
192600          SELECT  B.SHIPT_ID                                      19260063
192700            INTO :SHIPMT-SHIPT-ID                                 19270063
192800            FROM  TSHPTPO A                                       19280063
192900                 ,TSHIPMT B                                       19290063
193000        WHERE A.PO_NBR      = :DK-PO-NBR                          19300063
193100          AND A.REC_SEQ_NBR = :DK-REC-SEQ-NBR                     19310063
193200          AND A.SHIPT_ID    = B.SHIPT_ID                          19320063
193300     END-EXEC.                                                    19330063
193400                                                                  19340063
193500     EVALUATE SQLCODE                                             19350063
193600         WHEN ZERO                                                19360063
193700         WHEN +100                                                19370063
193800             CONTINUE                                             19380063
193900         WHEN -811                                                19390063
194000             SET PS-MULTIPLE-SHIPMENTS-YES                        19400063
194100                                        TO TRUE                   19410063
194200         WHEN OTHER                                               19420063
194300             MOVE DK-PO-NBR             TO PV-PO-N                19430063
194400             MOVE DK-REC-SEQ-NBR        TO PV-RCVR-N              19440063
194500             MOVE '2610-CHECK-MULT-SHIPMENTS'                     19450063
194600                                        TO DP013-PARAGRAPH        19460063
194700             STRING 'PO NUMBER = ' DELIMITED BY SIZE              19470063
194800                     PV-PO-N       DELIMITED BY SIZE              19480063
194900                                     INTO DP013-MESSAGE-TEXT (1)  19490063
195000             STRING 'RECEIVER  = ' DELIMITED BY SIZE              19500063
195100                     PV-RCVR-N     DELIMITED BY SIZE              19510063
195200                                     INTO DP013-MESSAGE-TEXT (2)  19520063
195300             MOVE SQLCA                TO DP013-SQLCA             19530063
195400             MOVE 'XLT_LOC'            TO DP013-DB2-TABLE-NAME (1)19540063
195500             PERFORM 7000-ABEND                                   19550063
195600     END-EVALUATE.                                                19560063
195700                                                                  19570063
195800 3000-GET-DISPLAY-DATA.                                           19580063
195900     PERFORM 3100-GET-TPURCHS-DATA.                               19590063
196000     PERFORM 3200-CHECK-FOR-PICTURE-AD.                           19600063
196100     PERFORM 3300-GET-TRBL-SHT-DESC.                              19610063
196200     PERFORM 3400-GET-CURRENT-OPER-SET.                           19620063
196300     IF AOPERSETO > SPACES                                        19630063
196400         PERFORM 3500-GET-CURRENT-LOCATION                        19640063
196500     END-IF.                                                      19650063
196600                                                                  19660063
196700* DMH BEGIN - 3/13/06                                             19670063
196800*    PERFORM 3600-GET-UNITS.                                      19680063
196900     PERFORM 3650-GET-PIECES-INFO.                                19690063
197000* DMH END - 3/13/06                                               19700063
197100* GB 2/27/09 BEG                                                  19710063
197200     IF PS-USE-PO-RCVR-NO                                         19720063
197300         PERFORM 3660-CHECK-DIRCTIVE-PARM                         19730063
197400         IF PS-ALL-CARTONS-DIRECTIVES-MODE  OR                    19740063
197500            PS-EXCEPTION-DIRECTIVES-MODE                          19750063
197600            PERFORM 3670-CHECK-CURRENT-DIRECTIVE                  19760063
197700         END-IF                                                   19770063
197800     ELSE                                                         19780063
197900           MOVE SPACES TO ADIRLOCO                                19790063
198000     END-IF.                                                      19800063
198100* GB 2/27/09 END                                                  19810063
198200* RD 3/06/09 BEG                                                  19820063
198300     PERFORM 3690-KOHLS-SML-BRCDE.                                19830063
198400* RD 3/06/09 END                                                  19840063
198500* * * OPER SET DESCRIPTION INITIALIZED IN 3400-                   19850063
198600     MOVE ZERO              TO PV-OPER-SET-N                      19860063
198700     IF ANEWOPSTI > SPACES                                        19870063
198800         PERFORM 4102-START-OPER-SET-UPD                          19880063
198900         IF PS-ERRORS-YES                                         19890063
199000             CONTINUE                                             19900063
199100         ELSE                                                     19910063
199200             PERFORM 3700-GET-OPER-SET-DESC                       19920063
199300         END-IF                                                   19930063
199400     ELSE                                                         19940063
199500         IF XLT00010-LOC-TYP-CDE = 'DS'                           19950063
199600           OR RECEIV-REC-TYP-CDE = 'EX'                           19960063
199700           OR PS-OPER-SET-FOUND-NO                                19970063
199800            CONTINUE                                              19980063
199900         ELSE                                                     19990063
200000             MOVE AOPERSETI     TO PV-OPER-SET-X                  20000063
200100             MOVE PV-OPER-SET-N TO DK-OPER-SET-ID                 20010063
200200             PERFORM 3700-GET-OPER-SET-DESC                       20020063
200300         END-IF                                                   20030063
200400     END-IF.                                                      20040063
200500                                                                  20050063
200600 3100-GET-TPURCHS-DATA.                                           20060063
200700                                                                  20070063
200800     EXEC SQL                                                     20080063
200900         SELECT  NEW_STR_PO_IND                                   20090063
201000               , SEASET_SHRT_NM                                   20100063
201100         INTO   :PURCHS-NEW-STR-PO-IND                            20110063
201200               ,:PURCHS-SEASET-SHRT-NM                            20120063
201300         FROM   TPURCHS                                           20130063
201400         WHERE  PO_NBR         = :DK-PO-NBR                       20140063
201500           AND  VER_STATUS_CDE = 'A'                              20150063
201600     END-EXEC.                                                    20160063
201700                                                                  20170063
201800     EVALUATE SQLCODE                                             20180063
201900         WHEN ZERO                                                20190063
202000             MOVE PURCHS-NEW-STR-PO-IND TO ANEWSTRO               20200063
202100                                           PC056-NEW-STORE-IND    20210063
202200             MOVE PURCHS-SEASET-SHRT-NM TO ASEASETO               20220063
202300                                           PC056-SEASONAL-SET     20230063
202400         WHEN OTHER                                               20240063
202500             MOVE DK-PO-NBR             TO PV-PO-N                20250063
202600             MOVE '3100-GET-TPURCHS DATA' TO DP013-PARAGRAPH      20260063
202700             STRING 'PO NUMBER = ' DELIMITED BY SIZE              20270063
202800                     PV-PO-N       DELIMITED BY SIZE              20280063
202900                                     INTO DP013-MESSAGE-TEXT (1)  20290063
203000             MOVE SQLCA                TO DP013-SQLCA             20300063
203100             MOVE 'TPURCHS'            TO DP013-DB2-TABLE-NAME (1)20310063
203200             PERFORM 7000-ABEND                                   20320063
203300     END-EVALUATE.                                                20330063
203400                                                                  20340063
203500 3200-CHECK-FOR-PICTURE-AD.                                       20350063
203600     MOVE 0 TO PV-COUNT.                                          20360063
203700     EXEC SQL                                                     20370063
203800         SELECT COUNT (*)                                         20380063
203900         INTO  :PV-COUNT                                          20390063
204000         FROM   TRECITM A                                         20400063
204100               ,TPURITM B                                         20410063
204200         WHERE  A.ORD_NBR        = :DK-PO-NBR                     20420063
204300           AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                20430063
204400           AND  A.ORD_NBR        = B.PO_NBR                       20440063
204500           AND  A.ORD_LNE_NBR    = B.PO_LNE_NBR                   20450063
204600           AND  A.PO_VER_NBR     = B.VER_NBR                      20460063
204700           AND  A.VER_STATUS_CDE = 'A'                            20470063
204800           AND  B.VER_STATUS_CDE = 'A'                            20480063
204900           AND  A.STATUS_CDE    IN ('IP','CM')                    20490063
205000           AND  A.OPER_UNT_ID    = :RECEIV-OPER-UNT-ID            20500063
205100           AND  B.PIC_ITM_IND    = 'Y'                            20510063
205200     END-EXEC.                                                    20520063
205300                                                                  20530063
205400     EVALUATE SQLCODE                                             20540063
205500         WHEN ZERO                                                20550063
205600             IF PV-COUNT > 0                                      20560063
205700                 MOVE 'Y'              TO APICTADO                20570063
205800                                          PC056-PICTURE-AD        20580063
205900             ELSE                                                 20590063
206000                 MOVE SPACE            TO APICTADO                20600063
206100             END-IF                                               20610063
206200         WHEN OTHER                                               20620063
206300             MOVE DK-PO-NBR            TO PV-PO-N                 20630063
206400             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               20640063
206500             MOVE '3200-CHECK-FOR-PICTURE-AD'                     20650063
206600                                       TO DP013-PARAGRAPH         20660063
206700             STRING 'PO NUMBER = ' DELIMITED BY SIZE              20670063
206800                     PV-PO-N       DELIMITED BY SIZE              20680063
206900                                     INTO DP013-MESSAGE-TEXT (1)  20690063
207000             STRING 'RECIEVER  = ' DELIMITED BY SIZE              20700063
207100                     PV-RCVR-N     DELIMITED BY SIZE              20710063
207200                                     INTO DP013-MESSAGE-TEXT (2)  20720063
207300             MOVE SQLCA                TO DP013-SQLCA             20730063
207400             MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)20740063
207500             MOVE 'TPURCHS'            TO DP013-DB2-TABLE-NAME (2)20750063
207600             PERFORM 7000-ABEND                                   20760063
207700     END-EVALUATE.                                                20770063
207800                                                                  20780063
207900 3300-GET-TRBL-SHT-DESC.                                          20790063
208000     EXEC SQL                                                     20800063
208100         SELECT  B.TRBL_SHT_DESC                                  20810063
208200         INTO   :TRBRSN-TRBL-SHT-DESC                             20820063
208300         FROM   TTRBNTF A                                         20830063
208400               ,TTRBRSN B                                         20840063
208500          WHERE  A.PO_NBR           =  :DK-PO-NBR                 20850063
208600          AND    A.REC_SEQ_NBR      =  :DK-REC-SEQ-NBR            20860063
208700          AND    B.TRBL_RSN_CDE     =  A.TRBL_RSN_CDE             20870063
208800          AND  ((A.RESOLVED_IND    IN  ('N','I','R')              20880063
208900          AND    B.NOTIF_IND        =  'T')                       20890063
209000           OR    B.TRBL_RSN_CDE     =  803)                       20900063
209100     END-EXEC.                                                    20910063
209200                                                                  20920063
209300     EVALUATE SQLCODE                                             20930063
209400         WHEN ZERO                                                20940063
209500         WHEN -811                                                20950063
209600             MOVE TRBRSN-TRBL-SHT-DESC TO ATRBLO                  20960063
209700                                          PC056-TRBL-DESCR        20970063
209800         WHEN +100                                                20980063
209900             PERFORM 3310-GET-TRBL-SHT-DESC                       20990063
210000         WHEN OTHER                                               21000063
210100             MOVE DK-PO-NBR            TO PV-PO-N                 21010063
210200             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               21020063
210300             MOVE '3300-GET-TRBL-SHT-DESC'                        21030063
210400                                       TO DP013-PARAGRAPH         21040063
210500             STRING 'PO NUMBER = ' DELIMITED BY SIZE              21050063
210600                     PV-PO-N       DELIMITED BY SIZE              21060063
210700                                     INTO DP013-MESSAGE-TEXT (1)  21070063
210800             STRING 'RECIEVER  = ' DELIMITED BY SIZE              21080063
210900                     PV-RCVR-N     DELIMITED BY SIZE              21090063
211000                                     INTO DP013-MESSAGE-TEXT (2)  21100063
211100             MOVE SQLCA                TO DP013-SQLCA             21110063
211200             MOVE 'TTRBNTF'            TO DP013-DB2-TABLE-NAME (1)21120063
211300             MOVE 'TTRBRSN'            TO DP013-DB2-TABLE-NAME (2)21130063
211400             PERFORM 7000-ABEND                                   21140063
211500     END-EVALUATE.                                                21150063
211600 3310-GET-TRBL-SHT-DESC.                                          21160063
211700     EXEC SQL                                                     21170063
211800         SELECT  B.TRBL_SHT_DESC                                  21180063
211900         INTO   :TRBRSN-TRBL-SHT-DESC                             21190063
212000         FROM   TTRBNTF A                                         21200063
212100               ,TTRBRSN B                                         21210063
212200         WHERE  A.PO_NBR         = :DK-PO-NBR                     21220063
212300           AND  A.REC_SEQ_NBR    = :DK-REC-SEQ-NBR                21230063
212400           AND  A.TRBL_RSN_CDE   = B.TRBL_RSN_CDE                 21240063
212500           AND  A.TRBL_RSN_CDE  IN (373,374,379,383,384,          21250063
212600                                    385,386,407,425,426)          21260063
212700           AND  A.NOTIF_TMST     =                                21270063
212800              (SELECT MAX(C.NOTIF_TMST)                           21280063
212900                 FROM TTRBNTF C                                   21290063
213000                WHERE C.PO_NBR        = :DK-PO-NBR                21300063
213100                  AND C.REC_SEQ_NBR   = :DK-REC-SEQ-NBR           21310063
213200                  AND C.RESOLVED_IND IN ('N','I'))                21320063
213300     END-EXEC.                                                    21330063
213400                                                                  21340063
213500     EVALUATE SQLCODE                                             21350063
213600         WHEN ZERO                                                21360063
213700             MOVE TRBRSN-TRBL-SHT-DESC TO ATRBLO                  21370063
213800                                          PC056-TRBL-DESCR        21380063
213900         WHEN +100                                                21390063
214000             MOVE SPACES               TO ATRBLO                  21400063
214100                                          PC056-TRBL-DESCR        21410063
214200         WHEN OTHER                                               21420063
214300             MOVE DK-PO-NBR            TO PV-PO-N                 21430063
214400             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               21440063
214500             MOVE '3310-GET-TRBL-SHT-DESC'                        21450063
214600                                       TO DP013-PARAGRAPH         21460063
214700             STRING 'PO NUMBER = ' DELIMITED BY SIZE              21470063
214800                     PV-PO-N       DELIMITED BY SIZE              21480063
214900                                     INTO DP013-MESSAGE-TEXT (1)  21490063
215000             STRING 'RECIEVER  = ' DELIMITED BY SIZE              21500063
215100                     PV-RCVR-N     DELIMITED BY SIZE              21510063
215200                                     INTO DP013-MESSAGE-TEXT (2)  21520063
215300             MOVE SQLCA                TO DP013-SQLCA             21530063
215400             MOVE 'TTRBNTF'            TO DP013-DB2-TABLE-NAME (1)21540063
215500             MOVE 'TTRBRSN'            TO DP013-DB2-TABLE-NAME (2)21550063
215600             MOVE 'TTRBRCN'            TO DP013-DB2-TABLE-NAME (3)21560063
215700             PERFORM 7000-ABEND                                   21570063
215800     END-EVALUATE.                                                21580063
215900                                                                  21590063
216000 3400-GET-CURRENT-OPER-SET.                                       21600063
216100     MOVE SPACES                       TO AOPSTDSO                21610063
216200                                          ALOCO                   21620063
216300                                          PC056-CURR-LINE-LOC.    21630063
216400* * * PERFORM 3410- EVERY TIME BECAUSE XLT00010-LOC-TYP-CDE       21640063
216500* * * IS USED LATER TO SEE IF OPER SET DESC NEEDS TO BE FOUND     21650063
216600     PERFORM 3410-CHECK-DIRECT-STORE                              21660063
216700     IF XLT00010-LOC-TYP-CDE = 'DS'                               21670063
216800         MOVE 'DIRECT STORE SHIP'      TO AOPSTDSO                21680063
216900                                          PC056-OPER-SET-DESC     21690063
217000         MOVE SPACES                   TO AOPERSETO               21700063
217100                                          PC056-CURR-OPER-SET-X   21710063
217200         SET PS-OPER-SET-FOUND-YES     TO TRUE                    21720063
217300     ELSE                                                         21730063
217400         IF RECEIV-REC-TYP-CDE = 'EX'                             21740063
217500             MOVE 'EXPENSE RECEIPT'    TO AOPSTDSO                21750063
217600                                          PC056-OPER-SET-DESC     21760063
217700             MOVE SPACES               TO AOPERSETO               21770063
217800                                          PC056-CURR-OPER-SET-X   21780063
217900         SET PS-OPER-SET-FOUND-YES     TO TRUE                    21790063
218000         ELSE                                                     21800063
218100             PERFORM 3420-GET-OPER-SET-ID                         21810063
218200         END-IF                                                   21820063
218300     END-IF.                                                      21830063
218400                                                                  21840063
218500 3410-CHECK-DIRECT-STORE.                                         21850063
218600     EXEC SQL                                                     21860063
218700         SELECT  LOC_TYP_CDE                                      21870063
218800         INTO   :XLT00010-LOC-TYP-CDE                             21880063
218900         FROM   XLT_LOC                                           21890063
219000         WHERE  LOC_NBR        = :RECEIV-OPER-UNT-ID              21900063
219100     END-EXEC.                                                    21910063
219200                                                                  21920063
219300     EVALUATE SQLCODE                                             21930063
219400         WHEN ZERO                                                21940063
219500             CONTINUE                                             21950063
219600         WHEN +100                                                21960063
219700             MOVE SPACES               TO XLT00010-LOC-TYP-CDE    21970063
219800         WHEN OTHER                                               21980063
219900             MOVE RECEIV-OPER-UNT-ID   TO PV-DISPLAY-NUMBER       21990063
220000             MOVE '3410-CHECK-DIRECT-STORE'                       22000063
220100                                       TO DP013-PARAGRAPH         22010063
220200             STRING 'OPER-UNT-ID= '    DELIMITED BY SIZE          22020063
220300                     PV-DISPLAY-NUMBER DELIMITED BY SIZE          22030063
220400                                     INTO DP013-MESSAGE-TEXT (1)  22040063
220500             MOVE SQLCA                TO DP013-SQLCA             22050063
220600             MOVE 'XLT_LOC'            TO DP013-DB2-TABLE-NAME (1)22060063
220700             PERFORM 7000-ABEND                                   22070063
220800     END-EVALUATE.                                                22080063
220900                                                                  22090063
221000 3420-GET-OPER-SET-ID.                                            22100063
221100     EXEC SQL                                                     22110063
221200          SELECT OPER_SET_ID                                      22120063
221300                ,STAT_CDE                                         22130063
221400                ,WORK_ORD_SEQ_NBR                                 22140063
221500            INTO :WRKORD-OPER-SET-ID                              22150063
221600                ,:WRKORD-STAT-CDE                                 22160063
221700                ,:WRKORD-WORK-ORD-SEQ-NBR                         22170063
221800            FROM TWRKORD                                          22180063
221900             WHERE  ORD_NBR        = :DK-PO-NBR                   22190063
222000               AND  RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR              22200063
222100               AND  ORD_LNE_NBR    = 0                            22210063
222200               AND  VER_STATUS_CDE = 'A'                          22220063
222300               AND  FCLTY_ID       = 1                            22230063
222400       END-EXEC.                                                  22240063
222500                                                                  22250063
222600     EVALUATE SQLCODE                                             22260063
222700         WHEN ZERO                                                22270063
222800             MOVE WRKORD-OPER-SET-ID   TO PV-OPER-SET-N           22280063
222900             MOVE PV-OPER-SET-X        TO AOPERSETO               22290063
223000                                          PC056-CURR-OPER-SET     22300063
223100             SET PS-OPER-SET-FOUND-YES TO TRUE                    22310063
223200         WHEN +100                                                22320063
223300             MOVE SPACES                TO AOPERSETO              22330063
223400                                           WRKORD-STAT-CDE        22340063
223500             SET PS-ERRORS-YES          TO TRUE                   22350063
223600             MOVE DP015-ASK-BRT-MDT     TO AOPERSETA              22360063
223700             MOVE -1                    TO ABARCODEL              22370063
223800             MOVE PM-OPER-SET-NOT-FOUND TO AMSGLN1O               22380063
223900         WHEN -811                                                22390063
224000             PERFORM 3422-GET-OPER-SET-ID                         22400063
224100         WHEN OTHER                                               22410063
224200             MOVE DK-PO-NBR            TO PV-PO-N                 22420063
224300             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               22430063
224400             MOVE '3420-GET-OPER-SET-ID'                          22440063
224500                                       TO DP013-PARAGRAPH         22450063
224600             STRING 'PO NUMBER = ' DELIMITED BY SIZE              22460063
224700                     PV-PO-N       DELIMITED BY SIZE              22470063
224800                                     INTO DP013-MESSAGE-TEXT (1)  22480063
224900             STRING 'RECIEVER  = ' DELIMITED BY SIZE              22490063
225000                     PV-RCVR-N     DELIMITED BY SIZE              22500063
225100                                     INTO DP013-MESSAGE-TEXT (2)  22510063
225200             MOVE SQLCA                TO DP013-SQLCA             22520063
225300             MOVE 'TWRKORD'            TO DP013-DB2-TABLE-NAME (1)22530063
225400             PERFORM 7000-ABEND                                   22540063
225500     END-EVALUATE.                                                22550063
225600 3422-GET-OPER-SET-ID.                                            22560063
225700     EXEC SQL                                                     22570063
225800          SELECT OPER_SET_ID                                      22580063
225900                ,STAT_CDE                                         22590063
226000                ,WORK_ORD_SEQ_NBR                                 22600063
226100            INTO :WRKORD-OPER-SET-ID                              22610063
226200                ,:WRKORD-STAT-CDE                                 22620063
226300                ,:WRKORD-WORK-ORD-SEQ-NBR                         22630063
226400            FROM TWRKORD                                          22640063
226500             WHERE  ORD_NBR        = :DK-PO-NBR                   22650063
226600               AND  RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR              22660063
226700               AND  ORD_LNE_NBR    = 0                            22670063
226800               AND  VER_STATUS_CDE = 'A'                          22680063
226900               AND  FCLTY_ID       = 1                            22690063
227000               AND  OPER_UNT_ID    = :RECEIV-CURR-OPER-UNT-ID     22700063
227100       END-EXEC.                                                  22710063
227200                                                                  22720063
227300     EVALUATE SQLCODE                                             22730063
227400         WHEN ZERO                                                22740063
227500             MOVE WRKORD-OPER-SET-ID   TO PV-OPER-SET-N           22750063
227600             MOVE PV-OPER-SET-X        TO AOPERSETO               22760063
227700                                          PC056-CURR-OPER-SET     22770063
227800             SET PS-OPER-SET-FOUND-YES TO TRUE                    22780063
227900         WHEN +100                                                22790063
228000             SET PS-ERRORS-YES          TO TRUE                   22800063
228100             MOVE SPACES                TO AOPERSETO              22810063
228200                                           WRKORD-STAT-CDE        22820063
228300             MOVE DP015-ASK-BRT-MDT     TO AOPERSETA              22830063
228400             MOVE -1                    TO ABARCODEL              22840063
228500             MOVE PM-OPER-SET-NOT-FOUND TO AMSGLN1O               22850063
228600         WHEN OTHER                                               22860063
228700             MOVE DK-PO-NBR            TO PV-PO-N                 22870063
228800             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               22880063
228900             MOVE RECEIV-OPER-UNT-ID   TO PV-OPER-UNT-ID          22890063
229000             MOVE '3422-GET-OPER-SET-ID'                          22900063
229100                                       TO DP013-PARAGRAPH         22910063
229200             STRING 'PO NUMBER = '  DELIMITED BY SIZE             22920063
229300                     PV-PO-N        DELIMITED BY SIZE             22930063
229400                                     INTO DP013-MESSAGE-TEXT (1)  22940063
229500             STRING 'RECIEVER  = '  DELIMITED BY SIZE             22950063
229600                     PV-RCVR-N      DELIMITED BY SIZE             22960063
229700                                     INTO DP013-MESSAGE-TEXT (2)  22970063
229800             STRING 'OPER UNT  = '  DELIMITED BY SIZE             22980063
229900                     PV-OPER-UNT-ID DELIMITED BY SIZE             22990063
230000                                     INTO DP013-MESSAGE-TEXT (2)  23000063
230100             MOVE SQLCA                TO DP013-SQLCA             23010063
230200             MOVE 'TWRKORD'            TO DP013-DB2-TABLE-NAME (1)23020063
230300             PERFORM 7000-ABEND                                   23030063
230400     END-EVALUATE.                                                23040063
230500                                                                  23050063
230600 3500-GET-CURRENT-LOCATION.                                       23060063
230700     MOVE SPACES TO ALOCO                                         23070063
230800                    PC056-CURR-LINE-LOC.                          23080063
230900     EVALUATE TRUE                                                23090063
231000         WHEN PS-USE-PO-RCVR-YES                                  23100063
231100         WHEN RECEIV-PACK-BY-ST-IND = 'Y'                         23110063
231200              MOVE ZERO TO DK-PO-LNE-NBR                          23120063
231300         WHEN RECEIV-PKGNG-CDE = 'B'                              23130063
231400         WHEN RECEIV-PKGNG-CDE = 'C'                              23140063
231500             SET PS-PREPACK-NO    TO TRUE                         23150063
231600             PERFORM 3510-GET-TSHUUPC-LNE-NBR                     23160063
231700         WHEN RECEIV-PKGNG-CDE = 'I'                              23170063
231800         WHEN RECEIV-PKGNG-CDE = 'M'                              23180063
231900         WHEN RECEIV-PKGNG-CDE = 'S'                              23190063
232000             SET PS-PREPACK-YES   TO TRUE                         23200063
232100             PERFORM 3510-GET-TSHUUPC-LNE-NBR                     23210063
232200             IF SQLCODE = ZERO OR -811                            23220063
232300                 PERFORM 3520-GET-DRIVER-LNE-NBR                  23230063
232400             END-IF                                               23240063
232500     END-EVALUATE.                                                23250063
232600     PERFORM 3540-OPEN-TWKORIN-CSR.                               23260063
232700     PERFORM 3530-FETCH-TWKORIN-LOOP.                             23270063
232800     IF PS-ERRORS-NO                                              23280063
232900         MOVE PC056-CURR-LINE-LOC TO ALOCO                        23290063
233000     ELSE                                                         23300063
233100         MOVE SPACES              TO ALOCO                        23310063
233200         MOVE SPACES              TO PC056-CURR-LINE-LOC          23320063
233300     END-IF.                                                      23330063
233400 3510-GET-TSHUUPC-LNE-NBR.                                        23340063
233500     EXEC SQL                                                     23350063
233600          SELECT  TRN_LNE_NBR                                     23360063
233700           INTO  :SHUUPC-TRN-LNE-NBR                              23370063
233800           FROM   TSHUUPC                                         23380063
233900          WHERE  SHIPT_UNT_ID   = :DK-CARTON-ID                   23390063
234000            AND  TRN_NBR        = :DK-PO-NBR                      23400063
234100     END-EXEC.                                                    23410063
234200     EVALUATE SQLCODE                                             23420063
234300         WHEN ZERO                                                23430063
234400         WHEN -811                                                23440063
234500             MOVE SHUUPC-TRN-LNE-NBR   TO DK-PO-LNE-NBR           23450063
234600         WHEN +100                                                23460063
234700             MOVE ZERO                 TO DK-PO-LNE-NBR           23470063
234800         WHEN OTHER                                               23480063
234900              MOVE DK-PO-NBR        TO PV-PO-N                    23490063
235000              MOVE DK-CARTON-ID     TO PV-BARCODE-N               23500063
235100              MOVE '3510-GET-TSHUUPC-LNE-NBR'                     23510063
235200                                    TO DP013-PARAGRAPH            23520063
235300              STRING 'PO NUMBER = '  DELIMITED BY SIZE            23530063
235400                      PV-PO-N        DELIMITED BY SIZE            23540063
235500                                  INTO DP013-MESSAGE-TEXT (1)     23550063
235600              STRING 'CARTON ID = '  DELIMITED BY SIZE            23560063
235700                      PV-BARCODE-N   DELIMITED BY SIZE            23570063
235800                                  INTO DP013-MESSAGE-TEXT (2)     23580063
235900              MOVE SQLCA            TO DP013-SQLCA                23590063
236000              MOVE 'TSHUUPC'        TO DP013-DB2-TABLE-NAME (1)   23600063
236100              PERFORM 7000-ABEND                                  23610063
236200     END-EVALUATE.                                                23620063
236300 3520-GET-DRIVER-LNE-NBR.                                         23630063
236400     EXEC SQL                                                     23640063
236500          SELECT A.ORD_LNE_NBR                                    23650063
236600          INTO  :RECITM-ORD-LNE-NBR                               23660063
236700          FROM   TRECITM A                                        23670063
236800          WHERE  A.ORD_NBR           = :DK-PO-NBR                 23680063
236900            AND  A.REC_SEQ_NBR       = :DK-REC-SEQ-NBR            23690063
237000            AND  A.VER_STATUS_CDE    = 'A'                        23700063
237100            AND  A.PREPK_DRV_LNE_CDE = 'A'                        23710063
237200            AND  A.PREPK_ID =                                     23720063
237300               (SELECT B.PREPK_ID                                 23730063
237400                  FROM TRECITM B                                  23740063
237500                 WHERE  A.ORD_NBR     = B.ORD_NBR                 23750063
237600                   AND  A.REC_SEQ_NBR = B.REC_SEQ_NBR             23760063
237700                   AND  B.ORD_LNE_NBR = :DK-PO-LNE-NBR)           23770063
237800     END-EXEC.                                                    23780063
237900                                                                  23790063
238000     EVALUATE SQLCODE                                             23800063
238100         WHEN ZERO                                                23810063
238200             MOVE RECITM-ORD-LNE-NBR   TO DK-PO-LNE-NBR           23820063
238300         WHEN +100                                                23830063
238400             MOVE ZERO                 TO DK-PO-LNE-NBR           23840063
238500         WHEN OTHER                                               23850063
238600             MOVE DK-PO-NBR            TO PV-PO-N                 23860063
238700             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               23870063
238800             MOVE DK-PO-LNE-NBR        TO PV-LNE-NBR-N            23880063
238900             MOVE '3520-GET-DRIVER-LNE-NBR'                       23890063
239000                                       TO DP013-PARAGRAPH         23900063
239100             STRING 'PO NUMBER = '  DELIMITED BY SIZE             23910063
239200                     PV-PO-N        DELIMITED BY SIZE             23920063
239300                                     INTO DP013-MESSAGE-TEXT (1)  23930063
239400             STRING 'RECIEVER  = '  DELIMITED BY SIZE             23940063
239500                     PV-RCVR-N      DELIMITED BY SIZE             23950063
239600                                     INTO DP013-MESSAGE-TEXT (2)  23960063
239700             STRING 'LINE NBR  = '  DELIMITED BY SIZE             23970063
239800                     PV-LNE-NBR-N   DELIMITED BY SIZE             23980063
239900                                     INTO DP013-MESSAGE-TEXT (3)  23990063
240000             MOVE SQLCA                TO DP013-SQLCA             24000063
240100             MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)24010063
240200             PERFORM 7000-ABEND                                   24020063
240300     END-EVALUATE.                                                24030063
240400                                                                  24040063
240500 3530-FETCH-TWKORIN-LOOP.                                         24050063
240600     MOVE 'N' TO PS-TWKORIN-CURSOR-SW.                            24060063
240700     PERFORM 3532-FETCH-TWKORIN.                                  24070063
240800     IF  PS-EOF-TWKORIN-CSR-YES                                   24080063
240900       OR WKORIN-STRT-TMST > PC-DEFAULT-TIMESTAMP                 24090063
241000         PERFORM 3550-CLOSE-TWKORIN                               24100063
241100         MOVE ZERO            TO DK-PO-LNE-NBR                    24110063
241200         SET  PS-EOF-TWKORIN-CSR-NO  TO  TRUE                     24120063
241300         PERFORM 3540-OPEN-TWKORIN-CSR                            24130063
241400         PERFORM 3532-FETCH-TWKORIN                               24140063
241500         IF  WKORIN-STRT-TMST > PC-DEFAULT-TIMESTAMP              24150063
241600             MOVE WKORIN-LNE-LOC-CDE                              24160063
241700                              TO PC056-CURR-LINE-LOC              24170063
241800             MOVE 'N'         TO PS-TWKORIN-CURSOR-SW             24180063
241900             PERFORM 3550-CLOSE-TWKORIN                           24190063
242000         ELSE                                                     24200063
242100             MOVE WKORIN-LNE-LOC-CDE                              24210063
242200                              TO PC056-CURR-LINE-LOC              24220063
242300             PERFORM 3532-FETCH-TWKORIN                           24230063
242400                 UNTIL PS-EOF-TWKORIN-CSR-YES                     24240063
242500             PERFORM 3550-CLOSE-TWKORIN                           24250063
242600         END-IF                                                   24260063
242700     ELSE                                                         24270063
242800         MOVE WKORIN-LNE-LOC-CDE TO                               24280063
242900                  PC056-CURR-LINE-LOC                             24290063
243000         PERFORM 3532-FETCH-TWKORIN                               24300063
243100             UNTIL PS-EOF-TWKORIN-CSR-YES                         24310063
243200         PERFORM 3550-CLOSE-TWKORIN                               24320063
243300     END-IF.                                                      24330063
243400 3532-FETCH-TWKORIN.                                              24340063
243500     EXEC SQL                                                     24350063
243600          FETCH TWKORIN-CSR                                       24360063
243700             INTO  :WKORIN-STRT-TMST,                             24370063
243800                   :WKORIN-STOP-TMST,                             24380063
243900                   :WKORIN-PRC-FCLTY-AREA-ID,                     24390063
244000                   :WKORIN-SCREEN-SEQ-NBR,                        24400063
244100                   :WKORIN-LNE-LOC-CDE,                           24410063
244200                   :WKORIN-WO-INSTR-SEQ-NBR                       24420063
244300     END-EXEC.                                                    24430063
244400     EVALUATE TRUE                                                24440063
244500         WHEN SQLCODE = +0                                        24450063
244600              PERFORM 3534-CHECK-DATES                            24460063
244700         WHEN SQLCODE = +100                                      24470063
244800              SET PS-EOF-TWKORIN-CSR-YES TO TRUE                  24480063
244900         WHEN OTHER                                               24490063
245000             MOVE DK-PO-NBR            TO PV-PO-N                 24500063
245100             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               24510063
245200             MOVE DK-PO-LNE-NBR        TO PV-LNE-NBR-N            24520063
245300             MOVE '3532-FETCH-TWKORIN' TO DP013-PARAGRAPH         24530063
245400             STRING 'PO NUMBER = ' DELIMITED BY SIZE              24540063
245500                     PV-PO-N       DELIMITED BY SIZE              24550063
245600                                     INTO DP013-MESSAGE-TEXT (1)  24560063
245700             STRING 'RECEIVER  = ' DELIMITED BY SIZE              24570063
245800                     PV-RCVR-N     DELIMITED BY SIZE              24580063
245900                                     INTO DP013-MESSAGE-TEXT (2)  24590063
246000             STRING 'LINE NBR  = '  DELIMITED BY SIZE             24600063
246100                     PV-LNE-NBR-N   DELIMITED BY SIZE             24610063
246200                                     INTO DP013-MESSAGE-TEXT (3)  24620063
246300             MOVE SQLCA                TO DP013-SQLCA             24630063
246400             MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)24640063
246500             PERFORM 7000-ABEND                                   24650063
246600     END-EVALUATE.                                                24660063
246700                                                                  24670063
246800 3534-CHECK-DATES.                                                24680063
246900     IF  WKORIN-STRT-TMST LESS THAN PC-DEFAULT-TIMESTAMP          24690063
247000         IF  WKORIN-STOP-TMST LESS THAN PC-DEFAULT-TIMESTAMP      24700063
247100             MOVE WKORIN-LNE-LOC-CDE TO                           24710063
247200                      PC056-CURR-LINE-LOC                         24720063
247300         ELSE                                                     24730063
247400             MOVE WKORIN-LNE-LOC-CDE TO                           24740063
247500                      PC056-CURR-LINE-LOC                         24750063
247600             SET PS-EOF-TWKORIN-CSR-YES TO TRUE                   24760063
247700         END-IF                                                   24770063
247800     ELSE                                                         24780063
247900         SET PS-EOF-TWKORIN-CSR-YES TO TRUE                       24790063
248000     END-IF.                                                      24800063
248100                                                                  24810063
248200 3540-OPEN-TWKORIN-CSR.                                           24820063
248300     EXEC SQL                                                     24830063
248400         OPEN TWKORIN-CSR                                         24840063
248500     END-EXEC.                                                    24850063
248600     EVALUATE TRUE                                                24860063
248700         WHEN SQLCODE = ZEROS                                     24870063
248800              CONTINUE                                            24880063
248900         WHEN OTHER                                               24890063
249000             MOVE '3540-OPEN-TWKORIN-CSR' TO DP013-PARAGRAPH      24900063
249100             MOVE 'OPEN TWKORIN CSR'   TO DP013-MESSAGE-TEXT (1)  24910063
249200             MOVE SQLCA                TO DP013-SQLCA             24920063
249300             MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)24930063
249400             PERFORM 7000-ABEND                                   24940063
249500     END-EVALUATE.                                                24950063
249600 3550-CLOSE-TWKORIN.                                              24960063
249700     EXEC SQL                                                     24970063
249800         CLOSE TWKORIN-CSR                                        24980063
249900     END-EXEC.                                                    24990063
250000     EVALUATE TRUE                                                25000063
250100         WHEN SQLCODE = ZEROS                                     25010063
250200              CONTINUE                                            25020063
250300         WHEN OTHER                                               25030063
250400             MOVE '3550-CLOSE-TWKORIN' TO DP013-PARAGRAPH         25040063
250500             MOVE 'CLOSE TWKORIN CSR'  TO DP013-MESSAGE-TEXT (1)  25050063
250600             MOVE SQLCA                TO DP013-SQLCA             25060063
250700             MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)25070063
250800             PERFORM 7000-ABEND                                   25080063
250900     END-EVALUATE.                                                25090063
251000*                                                                 25100063
251100* DMH - BEGIN - 3/13/06                                           25110063
251200*3600-GET-UNITS.                                                  25120063
251300*    PERFORM 3610-OPEN-TRECITM-CSR.                               25130063
251400*    PERFORM 3620-FETCH-TRECITM-CSR                               25140063
251500*    IF PS-NOT-EOF-TRECITM-CSR                                    25150063
251600*        PERFORM                                                  25160063
251700*          UNTIL PS-EOF-TRECITM-CSR                               25170063
251800*               IF RECITM-DTL-CK-ITM-QTY > 0                      25180063
251900*                   ADD RECITM-DTL-CK-ITM-QTY TO PV-UNITS         25190063
252000*               ELSE                                              25200063
252100*                   ADD RECITM-PKSL-ITM-QTY   TO PV-UNITS         25210063
252200*               END-IF                                            25220063
252300*               PERFORM 3620-FETCH-TRECITM-CSR                    25230063
252400*        END-PERFORM                                              25240063
252500*        MOVE PV-UNITS                        TO PV-UNITS-Z       25250063
252600*                                                PC056-UNIT-COUNT 25260063
252700*        MOVE PV-UNITS-Z                      TO AUNITSO          25270063
252800*    END-IF.                                                      25280063
252900*    PERFORM 3630-CLOSE-TRECITM-CSR.                              25290063
253000*                                                                 25300063
253100*3610-OPEN-TRECITM-CSR.                                           25310063
253200*    EXEC SQL                                                     25320063
253300*        OPEN TRECITM-CSR                                         25330063
253400*    END-EXEC.                                                    25340063
253500*    EVALUATE TRUE                                                25350063
253600*        WHEN SQLCODE = ZEROS                                     25360063
253700*             SET PS-NOT-EOF-TRECITM-CSR  TO TRUE                 25370063
253800*        WHEN OTHER                                               25380063
253900*            MOVE '3610-OPEN-TRECITM-CSR' TO DP013-PARAGRAPH      25390063
254000*            MOVE 'OPEN TRECITM CSR'   TO DP013-MESSAGE-TEXT (1)  25400063
254100*            MOVE SQLCA                TO DP013-SQLCA             25410063
254200*            MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)25420063
254300*            PERFORM 7000-ABEND                                   25430063
254400*    END-EVALUATE.                                                25440063
254500*3620-FETCH-TRECITM-CSR.                                          25450063
254600*    EXEC SQL                                                     25460063
254700*         FETCH TRECITM-CSR                                       25470063
254800*          INTO :RECITM-PKSL-ITM-QTY                              25480063
254900*              ,:RECITM-DTL-CK-ITM-QTY                            25490063
255000*    END-EXEC.                                                    25500063
255100*    EVALUATE TRUE                                                25510063
255200*        WHEN SQLCODE = +0                                        25520063
255300*             CONTINUE                                            25530063
255400*        WHEN SQLCODE = +100                                      25540063
255500*             SET PS-EOF-TRECITM-CSR TO TRUE                      25550063
255600*        WHEN OTHER                                               25560063
255700*            MOVE DK-PO-NBR            TO PV-PO-N                 25570063
255800*            MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               25580063
255900*            MOVE '3620-FETCH-TRECITM-CSR'                        25590063
256000*                                      TO DP013-PARAGRAPH         25600063
256100*            STRING 'PO NUMBER = ' DELIMITED BY SIZE              25610063
256200*                    PV-PO-N       DELIMITED BY SIZE              25620063
256300*                                    INTO DP013-MESSAGE-TEXT (1)  25630063
256400*            STRING 'RECEIVER  = ' DELIMITED BY SIZE              25640063
256500*                    PV-RCVR-N     DELIMITED BY SIZE              25650063
256600*                                    INTO DP013-MESSAGE-TEXT (2)  25660063
256700*            MOVE SQLCA                TO DP013-SQLCA             25670063
256800*            MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)25680063
256900*            PERFORM 7000-ABEND                                   25690063
257000*    END-EVALUATE.                                                25700063
257100*3630-CLOSE-TRECITM-CSR.                                          25710063
257200*    EXEC SQL                                                     25720063
257300*        CLOSE TRECITM-CSR                                        25730063
257400*    END-EXEC.                                                    25740063
257500*    EVALUATE TRUE                                                25750063
257600*        WHEN SQLCODE = ZEROS                                     25760063
257700*             CONTINUE                                            25770063
257800*        WHEN OTHER                                               25780063
257900*            MOVE '3630-CLOSE-TRECITM-CSR'                        25790063
258000*                                      TO DP013-PARAGRAPH         25800063
258100*            MOVE 'CLOSE TRECITM CSR'  TO DP013-MESSAGE-TEXT (1)  25810063
258200*            MOVE SQLCA                TO DP013-SQLCA             25820063
258300*            MOVE 'TRECITM'            TO DP013-DB2-TABLE-NAME (1)25830063
258400*            PERFORM 7000-ABEND                                   25840063
258500*    END-EVALUATE.                                                25850063
258600*                                                                 25860063
258700* DMH - END - 3/13/06                                             25870063
258800                                                                  25880063
258900*----------------------------------------------------------------*25890063
259000* GET PIECES INFORMATION                                          25900063
259100*----------------------------------------------------------------*25910063
259200 3650-GET-PIECES-INFO.                                            25920063
259300     MOVE  ZEROES  TO PV-INVOICED-COUNT                           25930063
259400                      PV-AP-VERIFIED-COUNT.                       25940063
259500                                                                  25950063
259600     EXEC SQL                                                     25960063
259700         SELECT  SUM(EXPTED_ITM_QTY)                              25970063
259800                ,SUM(AP_VERIFY_ITM_QTY)                           25980063
259900           INTO :PV-INVOICED-COUNT    :PV-NULL-IND-1              25990063
260000               ,:PV-AP-VERIFIED-COUNT :PV-NULL-IND-1              26000063
260100           FROM  TRECDIS                                          26010063
260200         WHERE ORD_NBR        = :DK-PO-NBR                        26020063
260300           AND REC_SEQ_NBR    = :DK-REC-SEQ-NBR                   26030063
260500       END-EXEC.                                                  26050063
260600                                                                  26060063
260700       EVALUATE TRUE                                              26070063
260800         WHEN SQLCODE = +0                                        26080063
260900              IF RECEIV-STATUS-CDE      = 'VE'                    26090063
261000                 MOVE PV-AP-VERIFIED-COUNT TO PV-UNITS-Z          26100063
261100                                            PC056-UNIT-COUNT      26110063
261200              ELSE                                                26120063
261300                 MOVE PV-INVOICED-COUNT    TO PV-UNITS-Z          26130063
261400                                            PC056-UNIT-COUNT      26140063
261500              END-IF                                              26150063
261600              MOVE PV-UNITS-Z              TO AUNITSO             26160063
261700         WHEN OTHER                                               26170063
261800             MOVE DK-PO-NBR              TO PV-PO-N               26180063
261900             MOVE DK-REC-SEQ-NBR         TO PV-RCVR-N             26190063
262000             MOVE '3650-GET-PIECES-INFO' TO DP013-PARAGRAPH       26200063
262100             STRING 'PO NUMBER = '                                26210063
262200                     PV-PO-N '-'                                  26220063
262300                     PV-RCVR-N     DELIMITED BY SIZE              26230063
262400                                     INTO DP013-MESSAGE-TEXT (1)  26240063
262500             MOVE SQLCA                TO DP013-SQLCA             26250063
262600             MOVE 'TRECDIS'            TO DP013-DB2-TABLE-NAME (1)26260063
262700             PERFORM 7000-ABEND                                   26270063
262800      END-EVALUATE.                                               26280063
262900/                                                                 26290063
263000 3660-CHECK-DIRCTIVE-PARM.                                        26300063
263100                                                                  26310063
263200     EXEC SQL                                                     26320063
263300         SELECT FUNC_TXT                                          26330063
263400           INTO :PS-AUTOCY-DIRECTIVE-MODE                         26340063
263500           FROM TKRPRPM                                           26350063
263600          WHERE INTFC_SYS_CDE        = 'KHL'                      26360063
263700            AND SYS_PRC_FUNC_CDE     = 'ACAUDT'                   26370063
263800            AND FUNC_PRC_STAT_CDE    = 'AC'                       26380063
263900            AND FUNC_BEG_TMST       <=  CURRENT TIMESTAMP         26390063
264000            AND FUNC_END_TMST       >=  CURRENT TIMESTAMP         26400063
264100            AND LOC_ID               =  :PC056-SIGNON-OPER-UNT    26410063
264200     END-EXEC                                                     26420063
264300                                                                  26430063
264400     EVALUATE SQLCODE                                             26440063
264500         WHEN ZERO                                                26450063
264600             CONTINUE                                             26460063
264700         WHEN +100                                                26470063
264800             SET PS-NO-DIRECTIVES-MODE  TO TRUE                   26480063
264900         WHEN OTHER                                               26490063
265000             MOVE DK-PO-NBR            TO PV-PO-N                 26500063
265100             MOVE DK-OPER-SET-ID       TO PV-OPER-SET-N           26510063
265200             MOVE KRPRPM-LOC-ID                                   26520063
265300                                       TO PV-OPER-UNT-ID          26530063
265400             MOVE '3660-CHECK-DIRCTIVE-PARM '                     26540063
265500                                       TO DP013-PARAGRAPH         26550063
265600             STRING 'PO NUMBER   = ' DELIMITED BY SIZE            26560063
265700                     PV-PO-N         DELIMITED BY SIZE            26570063
265800                                     INTO DP013-MESSAGE-TEXT (1)  26580063
265900             STRING 'OPER UNT  = '  DELIMITED BY SIZE             26590063
266000                     PV-OPER-UNT-ID DELIMITED BY SIZE             26600063
266100                                     INTO DP013-MESSAGE-TEXT (2)  26610063
266200             MOVE SQLCA                TO DP013-SQLCA             26620063
266300             MOVE 'TKRPRPM'            TO DP013-DB2-TABLE-NAME (1)26630063
266400             PERFORM 7000-ABEND                                   26640063
266500     END-EVALUATE.                                                26650063
266600/                                                                 26660063
266700 3670-CHECK-CURRENT-DIRECTIVE.                                    26670063
266800                                                                  26680063
266900     INITIALIZE DCLSUT00102.                                      26690063
267000                                                                  26700063
267100     EXEC SQL                                                     26710063
267200         SELECT DT1.DIRV_RSN_CDE                                  26720063
267300         INTO  :SUT00102-DIRV-RSN-CDE                             26730063
267400         FROM   SUT_CART_DIRV_TRKG  DT1                           26740063
267500         JOIN   TSULBXF              XF                           26750063
267600           ON   XF.BRCDE_NBR     =  DT1.BRCDE_NBR                 26760063
267700          AND   XF.SHIPT_UNT_ID  =  :DK-CARTON-ID                 26770063
267800         WHERE  DT1.CRE_TMST =                                    26780063
267900                   (                                              26790063
268000                    SELECT MAX(DT2.CRE_TMST)                      26800063
268100                    FROM   SUT_CART_DIRV_TRKG  DT2                26810063
268200                    WHERE  DT2.BRCDE_NBR     =  DT1.BRCDE_NBR     26820063
268300                   )                                              26830063
268400     END-EXEC                                                     26840063
268500                                                                  26850063
268600     EVALUATE SQLCODE                                             26860063
268700         WHEN ZERO                                                26870063
268800             PERFORM 3680-EVALUATE-DIRECTIVE                      26880063
268900         WHEN +100                                                26890063
269000             MOVE 'NODIR' TO ADIRLOCO                             26900063
269100         WHEN OTHER                                               26910063
269200             MOVE DK-PO-NBR            TO PV-PO-N                 26920063
269300             MOVE DK-OPER-SET-ID       TO PV-OPER-SET-N           26930063
269400             MOVE KRPRPM-LOC-ID                                   26940063
269500                                       TO PV-OPER-UNT-ID          26950063
269600             MOVE '3670-CHECK-CURRENT-DIRECTIVE'                  26960063
269700                                       TO DP013-PARAGRAPH         26970063
269800             STRING 'PO NUMBER   = ' DELIMITED BY SIZE            26980063
269900                     PV-PO-N         DELIMITED BY SIZE            26990063
270000                                     INTO DP013-MESSAGE-TEXT (1)  27000063
270100             STRING 'OPER UNT  = '  DELIMITED BY SIZE             27010063
270200                     PV-OPER-UNT-ID DELIMITED BY SIZE             27020063
270300                                     INTO DP013-MESSAGE-TEXT (2)  27030063
270400             MOVE SQLCA                TO DP013-SQLCA             27040063
270500             MOVE 'SUT_CART_DIRV_TRKG' TO DP013-DB2-TABLE-NAME (1)27050063
270600             MOVE 'TSULBXF'            TO DP013-DB2-TABLE-NAME (2)27060063
270700             PERFORM 7000-ABEND                                   27070063
270800     END-EVALUATE.                                                27080063
270900/                                                                 27090063
271000 3680-EVALUATE-DIRECTIVE.                                         27100063
271100                                                                  27110063
271200     MOVE SUT00102-DIRV-RSN-CDE TO PV-DIRV-RSN-CDE.               27120063
271300                                                                  27130063
271400     EVALUATE TRUE                                                27140063
271500       WHEN PV-DIRV-RSN-PUSH                                      27150063
271600           MOVE 'PUSH ' TO ADIRLOCO                               27160063
271700       WHEN PV-DIRV-RSN-SORT                                      27170063
271800           MOVE 'SORT ' TO ADIRLOCO                               27180063
271900     END-EVALUATE.                                                27190063
272000/                                                                 27200063
272100 3690-KOHLS-SML-BRCDE.                                            27210063
272200                                                                  27220063
272300     INITIALIZE DCLTSULBXF.                                       27230063
272400                                                                  27240063
272500     EXEC SQL                                                     27250063
272600         SELECT  XF.BRCDE_NBR                                     27260063
272700                ,XF.CART_LBL_TYP_CDE                              27270063
272800*CLP 06/13/13 PR#5418B START                                      27280063
272900                ,XF.DEST_OPER_UNT_ID                              27290063
273000*CLP 06/13/13 PR#5418B END                                        27300063
273100         INTO  :SULBXF-BRCDE-NBR                                  27310063
273200              ,:SULBXF-CART-LBL-TYP-CDE                           27320063
273300*CLP 06/13/13 PR#5418B START                                      27330063
273400              ,:SULBXF-DEST-OPER-UNT-ID                           27340063
273500*CLP 06/13/13 PR#5418B END                                        27350063
273600         FROM   TSULBXF XF                                        27360063
273700         WHERE  XF.SHIPT_UNT_ID = :DK-CARTON-ID                   27370063
273800           AND  XF.STAT_CDE     = 'A'                             27380063
273900     END-EXEC                                                     27390063
274000                                                                  27400063
274100     EVALUATE SQLCODE                                             27410063
274200         WHEN ZERO                                                27420063
274300             IF ( SULBXF-CART-LBL-TYP-CDE = 'P' )                 27430063
274400                 MOVE SULBXF-BRCDE-NBR(04:19) TO ASMLCDEO         27440063
274500             ELSE                                                 27450063
274600                 MOVE SULBXF-BRCDE-NBR(3:19)  TO ASMLCDEO         27460063
274700             END-IF                                               27470063
274800         WHEN +100                                                27480063
274900             MOVE SPACES TO ASMLCDEO                              27490063
275000         WHEN OTHER                                               27500063
275100             MOVE DK-PO-NBR            TO PV-PO-N                 27510063
275200             MOVE DK-OPER-SET-ID       TO PV-OPER-SET-N           27520063
275300             MOVE KRPRPM-LOC-ID                                   27530063
275400                                       TO PV-OPER-UNT-ID          27540063
275500             MOVE '3690-KOHLS-SML-BRCDE'                          27550063
275600                                       TO DP013-PARAGRAPH         27560063
275700             STRING 'PO NUMBER   = ' DELIMITED BY SIZE            27570063
275800                     PV-PO-N         DELIMITED BY SIZE            27580063
275900                                     INTO DP013-MESSAGE-TEXT (1)  27590063
276000             STRING 'OPER UNT  = '  DELIMITED BY SIZE             27600063
276100                     PV-OPER-UNT-ID DELIMITED BY SIZE             27610063
276200                                     INTO DP013-MESSAGE-TEXT (2)  27620063
276300             MOVE SQLCA                TO DP013-SQLCA             27630063
276400             MOVE 'TSULBXF'            TO DP013-DB2-TABLE-NAME (1)27640063
276500             PERFORM 7000-ABEND                                   27650063
276600     END-EVALUATE.                                                27660063
276700/                                                                 27670063
276800 3700-GET-OPER-SET-DESC.                                          27680063
276900     EXEC SQL                                                     27690063
277000          SELECT OPER_SET_DESC                                    27700063
277100            INTO :OPRSET-OPER-SET-DESC                            27710063
277200            FROM TOPRSET                                          27720063
277300             WHERE  OPER_SET_ID    = :DK-OPER-SET-ID              27730063
277400               AND  OPER_UNT_ID    = :RECEIV-CURR-OPER-UNT-ID     27740063
277500       END-EXEC.                                                  27750063
277600                                                                  27760063
277700     EVALUATE SQLCODE                                             27770063
277800         WHEN ZERO                                                27780063
277900             MOVE OPRSET-OPER-SET-DESC TO AOPSTDSO                27790063
278000                                          PC056-OPER-SET-DESC     27800063
278100         WHEN +100                                                27810063
278200             MOVE 'OPER SET DESC NOT FOUND'                       27820063
278300                                       TO AOPSTDSO                27830063
278400         WHEN OTHER                                               27840063
278500             MOVE DK-PO-NBR            TO PV-PO-N                 27850063
278600             MOVE DK-OPER-SET-ID       TO PV-OPER-SET-N           27860063
278700             MOVE RECEIV-CURR-OPER-UNT-ID                         27870063
278800                                       TO PV-OPER-UNT-ID          27880063
278900             MOVE '3410-GET-CURRENT-OPER-SET'                     27890063
279000                                       TO DP013-PARAGRAPH         27900063
279100             STRING 'OPER SET ID = ' DELIMITED BY SIZE            27910063
279200                     PV-OPER-SET-N   DELIMITED BY SIZE            27920063
279300                                     INTO DP013-MESSAGE-TEXT (1)  27930063
279400             STRING 'OPER UNT  = '  DELIMITED BY SIZE             27940063
279500                     PV-OPER-UNT-ID DELIMITED BY SIZE             27950063
279600                                     INTO DP013-MESSAGE-TEXT (2)  27960063
279700             MOVE SQLCA                TO DP013-SQLCA             27970063
279800             MOVE 'TOPRSET'            TO DP013-DB2-TABLE-NAME (1)27980063
279900             PERFORM 7000-ABEND                                   27990063
280000     END-EVALUATE.                                                28000063
280100                                                                  28010063
280200 4000-CHECK-FOR-UPDATES.                                          28020063
280300     IF (ANEWLOCL = ZERO OR ANEWLOCI = SPACES)                    28030063
280400       AND ALOCI > SPACES                                         28040063
280500             MOVE PM-NEW-LOC-SPACES                               28050063
280600                                TO AMSGLN2O                       28060063
280700     END-IF.                                                      28070063
280800     IF PC056-UPDATE-PENDING-YES                                  28080063
280900         MOVE PM-F2-CONFIRM     TO AMSGLN1O                       28090063
281000         SET PC056-UPDATE-CONFIRM-F2                              28100063
281100                                TO TRUE                           28110063
281200         MOVE DP015-PRO-NOR-MDT TO ABARCODEA                      28120063
281300                                   APONBRA                        28130063
281400                                   ARCVRA                         28140063
281500         MOVE -1                TO ANEWLOCL                       28150063
281600     ELSE                                                         28160063
281700         SET PC056-UPDATE-PENDING-NO                              28170063
281800                                TO TRUE                           28180063
281900     END-IF.                                                      28190063
282000                                                                  28200063
282100     IF AMSGLN1O = PM-F2-CONFIRM                                  28210063
282200         IF ANEWOPSTI > SPACES                                    28220063
282300             PERFORM 4102-START-OPER-SET-UPD                      28230063
282400             IF PS-ERRORS-YES                                     28240063
282500                 SET PC056-UPDATE-PENDING-NO                      28250063
282600                                TO TRUE                           28260063
282700                 MOVE DP015-UNP-ALP-NOR-MDT                       28270063
282800                                TO ABARCODEA                      28280063
282900                                   APONBRA                        28290063
283000                                   ARCVRA                         28300063
283100             END-IF                                               28310063
283200         ELSE                                                     28320063
283300             MOVE -1 TO ANEWLOCL                                  28330063
283400         END-IF                                                   28340063
283500     ELSE                                                         28350063
283600         IF ANEWOPSTI > SPACES                                    28360063
283700             PERFORM 4100-OPER-SET-UPDATE                         28370063
283800         END-IF                                                   28380063
283900         IF ANEWLOCI = LOW-VALUES                                 28390063
284000             MOVE SPACES            TO ANEWLOCI                   28400063
284100         END-IF                                                   28410063
284200         IF ANEWLOCI NOT = ALOCI                                  28420063
284300             PERFORM 4300-LINE-LOC-UPDATE                         28430063
284400         END-IF                                                   28440063
284500     END-IF.                                                      28450063
284600                                                                  28460063
284700 4100-OPER-SET-UPDATE.                                            28470063
284800     PERFORM 4102-START-OPER-SET-UPD                              28480063
284900     IF PS-ERRORS-NO                                              28490063
285000* * * IF NEW OPER SET = CURR OPER SET, DISCONTINUE UPDATE         28500063
285100         MOVE DP010I-NUMERIC-FIELD   TO PV-OPER-SET-N             28510063
285200         IF PV-OPER-SET-X = AOPERSETI                             28520063
285300             CONTINUE                                             28530063
285400         ELSE                                                     28540063
285500             PERFORM 4110-CONTINUE-OPER-SET-UPD                   28550063
285600         END-IF                                                   28560063
285700     END-IF.                                                      28570063
285800                                                                  28580063
285900 4102-START-OPER-SET-UPD.                                         28590063
286000     IF ANEWOPSTI = SPACES                                        28600063
286100       AND AOPERSETI NOT = SPACES                                 28610063
286200         SET PS-ERRORS-YES                                        28620063
286300             PS-INVALID-INPUT        TO TRUE                      28630063
286400         MOVE DP015-UNP-ALP-BRT-MDT  TO ANEWOPSTA                 28640063
286500         MOVE -1                     TO ANEWOPSTL                 28650063
286600         MOVE PM-OPER-SET-SPACES     TO AMSGLN1O                  28660063
286700     END-IF.                                                      28670063
286800     MOVE ANEWOPSTI                  TO DP010I-UNEDITED-FIELD     28680063
286900     MOVE 3                          TO DP010I-MAXIMUM-DIGITS     28690063
287000     MOVE 0                          TO DP010I-MAXIMUM-DECIMALS   28700063
287100     SET DP010I-NEGATIVE-NOT-ALLOWED                              28710063
287200                                     TO TRUE                      28720063
287310     CALL DP010I-NUMERIC-EDIT-ROUTINE                             28731063
287320                         USING DP010I-NUMERIC-EDIT-AREA           28732063
287400     IF  DP010I-ERROR-DETECTED                                    28740063
287500         SET PS-ERRORS-YES                                        28750063
287600             PS-INVALID-INPUT        TO TRUE                      28760063
287700         MOVE DP015-UNP-ALP-BRT-MDT  TO ANEWOPSTA                 28770063
287800         MOVE -1                     TO ANEWOPSTL                 28780063
287900         MOVE PM-MUST-BE-NUM         TO AMSGLN1O                  28790063
288000     ELSE                                                         28800063
288100         IF DP010I-NUMERIC-FIELD = ZERO                           28810063
288200             SET PS-ERRORS-YES                                    28820063
288300                 PS-INVALID-INPUT    TO TRUE                      28830063
288400             MOVE DP015-UNP-ALP-BRT-MDT                           28840063
288500                                     TO ANEWOPSTA                 28850063
288600             MOVE -1                 TO ANEWOPSTL                 28860063
288700             MOVE PC034-MUST-BE-GT-0-MSG                          28870063
288800                                     TO AMSGLN1O                  28880063
288900         END-IF                                                   28890063
289000     END-IF.                                                      28900063
289100     IF PS-ERRORS-NO                                              28910063
289200         MOVE DP010I-NUMERIC-FIELD   TO DK-OPER-SET-ID            28920063
289300         PERFORM 4104-VALIDATE-OPER-SET                           28930063
289400     END-IF.                                                      28940063
289500                                                                  28950063
289600 4104-VALIDATE-OPER-SET.                                          28960063
289700     EXEC SQL                                                     28970063
289800        SELECT  OPER_SET_DESC                                     28980063
289900          INTO :OPRSET-OPER-SET-DESC                              28990063
290000          FROM  TOPRSET                                           29000063
290100         WHERE  OPER_SET_ID    = :DK-OPER-SET-ID                  29010063
290200           AND  VER_STATUS_CDE = 'A'                              29020063
290300           AND  OPER_UNT_ID    = :RECEIV-CURR-OPER-UNT-ID         29030063
290400           AND  FCLTY_ID       = :RECEIV-FCLTY-ID                 29040063
290500     END-EXEC.                                                    29050063
290600                                                                  29060063
290700     EVALUATE SQLCODE                                             29070063
290800         WHEN ZERO                                                29080063
290900             CONTINUE                                             29090063
291000         WHEN +100                                                29100063
291100             SET PS-ERRORS-YES                                    29110063
291200                 PS-INVALID-INPUT    TO TRUE                      29120063
291300             MOVE DP015-UNP-ALP-BRT-MDT                           29130063
291400                                     TO ANEWOPSTA                 29140063
291500             MOVE -1                 TO ANEWOPSTL                 29150063
291600             MOVE PM-OPER-SET-INVALID                             29160063
291700                                     TO AMSGLN1O                  29170063
291800         WHEN OTHER                                               29180063
291900             MOVE DK-OPER-SET-ID       TO PV-OPER-SET-N           29190063
292000             MOVE RECEIV-CURR-OPER-UNT-ID                         29200063
292100                                       TO PV-RCVR-N               29210063
292200             MOVE '4104-VALIDATE-OPER-SET'                        29220063
292300                                       TO DP013-PARAGRAPH         29230063
292400             STRING 'OPER SET  = ' DELIMITED BY SIZE              29240063
292500                     PV-OPER-SET-N DELIMITED BY SIZE              29250063
292600                                     INTO DP013-MESSAGE-TEXT (1)  29260063
292700             STRING 'RCVR CURR OPER = '                           29270063
292800                                   DELIMITED BY SIZE              29280063
292900                     PV-RCVR-N     DELIMITED BY SIZE              29290063
293000                                     INTO DP013-MESSAGE-TEXT (2)  29300063
293100             MOVE SQLCA                TO DP013-SQLCA             29310063
293200             MOVE 'TOPRSET'            TO DP013-DB2-TABLE-NAME (1)29320063
293300             PERFORM 7000-ABEND                                   29330063
293400     END-EVALUATE.                                                29340063
293500                                                                  29350063
293600 4110-CONTINUE-OPER-SET-UPD.                                      29360063
293700     IF WRKORD-STAT-CDE = 'CM'                                    29370063
293800         SET PS-ERRORS-YES      TO TRUE                           29380063
293900         MOVE PM-WORK-ORDER-COMPLETE                              29390063
294000                                TO AMSGLN1O                       29400063
294100         MOVE PM-CANNOT-UPDATE-OPSET                              29410063
294200                                TO AMSGLN2O                       29420063
294300     END-IF.                                                      29430063
294400     IF PS-ERRORS-NO                                              29440063
294500         IF RECEIV-REC-TMST = PC-DEFAULT-TIMESTAMP                29450063
294600         SET PS-ERRORS-YES      TO TRUE                           29460063
294700         MOVE PM-RECEIVER-NOT-ARRIVED                             29470063
294800                                TO AMSGLN1O                       29480063
294900         MOVE PM-CANNOT-UPDATE-OPSET                              29490063
295000                                TO AMSGLN2O                       29500063
295100     END-IF.                                                      29510063
295200     IF PS-ERRORS-NO                                              29520063
295300         MOVE PV-OPER-SET-N     TO WRKORD-OPER-SET-ID             29530063
295400         PERFORM 4120-UPDATE-TWRKORD                              29540063
295500     END-IF.                                                      29550063
295600     IF PS-ERRORS-NO                                              29560063
295700         PERFORM 4130-DELETE-TWKORIN                              29570063
295800     END-IF.                                                      29580063
295900     IF PS-ERRORS-NO                                              29590063
296000         PERFORM 4200-NEW-WORK-ORDER-INSTR                        29600063
296100     END-IF.                                                      29610063
296200     IF PS-ERRORS-NO                                              29620063
296300         PERFORM 5000-CALL-PO-RCVR-TRKING-MOD                     29630063
296400         MOVE PM-UPDATE-SUCCESSFUL                                29640063
296500                                TO AMSGLN1O                       29650063
296600         MOVE SPACES            TO AMSGLN2O                       29660063
296700         MOVE -1                TO ABARCODEL                      29670063
296800         MOVE DP015-UNP-ALP-NOR-MDT                               29680063
296900                                TO ABARCODEA                      29690063
297000                                   APONBRA                        29700063
297100                                   ARCVRA                         29710063
297200     END-IF.                                                      29720063
297300                                                                  29730063
297400 4120-UPDATE-TWRKORD.                                             29740063
297500     EXEC SQL                                                     29750063
297600       UPDATE TWRKORD                                             29760063
297700          SET OPER_SET_ID    = :WRKORD-OPER-SET-ID                29770063
297800       WHERE  ORD_NBR        = :DK-PO-NBR                         29780063
297900         AND  RCVR_SEQ_NBR   = :DK-REC-SEQ-NBR                    29790063
298000         AND  VER_STATUS_CDE = 'A'                                29800063
298100     END-EXEC                                                     29810063
298200     EVALUATE SQLCODE                                             29820063
298300         WHEN ZERO                                                29830063
298400             MOVE WRKORD-OPER-SET-ID                              29840063
298500                            TO PC056-NEW-OPER-SET                 29850063
298600                               DK-OPER-SET-ID                     29860063
298700             MOVE PV-OPER-SET-X                                   29870063
298800                            TO AOPERSETI                          29880063
298900             MOVE SPACES    TO ANEWOPSTI                          29890063
299000         WHEN OTHER                                               29900063
299100             MOVE DK-PO-NBR            TO PV-PO-N                 29910063
299200             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               29920063
299300             MOVE '4120-UPDATE-TWRKORD'                           29930063
299400                                       TO DP013-PARAGRAPH         29940063
299500             STRING 'PO NUMBER = ' DELIMITED BY SIZE              29950063
299600                     PV-PO-N       DELIMITED BY SIZE              29960063
299700                                     INTO DP013-MESSAGE-TEXT (1)  29970063
299800             STRING 'RECEIVER  = ' DELIMITED BY SIZE              29980063
299900                     PV-RCVR-N     DELIMITED BY SIZE              29990063
300000                                     INTO DP013-MESSAGE-TEXT (2)  30000063
300100             MOVE SQLCA                TO DP013-SQLCA             30010063
300200             MOVE 'TWRDORD'            TO DP013-DB2-TABLE-NAME (1)30020063
300300             PERFORM 7000-ABEND                                   30030063
300400     END-EVALUATE.                                                30040063
300500                                                                  30050063
300600 4130-DELETE-TWKORIN.                                             30060063
300700     EXEC SQL                                                     30070063
300800       DELETE FROM TWKORIN                                        30080063
300900       WHERE  ORD_NBR          = :DK-PO-NBR                       30090063
301000         AND  RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR                  30100063
301100         AND  ORD_LNE_NBR      = 0                                30110063
301200         AND  WORK_ORD_SEQ_NBR = 1                                30120063
301300     END-EXEC.                                                    30130063
301400     EVALUATE SQLCODE                                             30140063
301500         WHEN ZERO                                                30150063
301600         WHEN +100                                                30160063
301700             CONTINUE                                             30170063
301800         WHEN OTHER                                               30180063
301900             MOVE DK-PO-NBR            TO PV-PO-N                 30190063
302000             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               30200063
302100             MOVE '4130-DELETE-TWKORIN'                           30210063
302200                                       TO DP013-PARAGRAPH         30220063
302300             STRING 'PO NUMBER = ' DELIMITED BY SIZE              30230063
302400                     PV-PO-N       DELIMITED BY SIZE              30240063
302500                                     INTO DP013-MESSAGE-TEXT (1)  30250063
302600             STRING 'RECEIVER  = ' DELIMITED BY SIZE              30260063
302700                     PV-RCVR-N     DELIMITED BY SIZE              30270063
302800                                     INTO DP013-MESSAGE-TEXT (2)  30280063
302900             MOVE SQLCA                TO DP013-SQLCA             30290063
303000             MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)30300063
303100             PERFORM 7000-ABEND                                   30310063
303200     END-EVALUATE.                                                30320063
303300                                                                  30330063
303400 4200-NEW-WORK-ORDER-INSTR.                                       30340063
303500     MOVE +0                     TO PV-WO-INSTR-SEQ-NBR-N         30350063
303600     MOVE 'N'                    TO PS-TOSOPFA-CURSOR-SW.         30360063
303700     MOVE 'Y'                    TO PS-INSTRUCTION-SW.            30370063
303800     PERFORM 4210-OPEN-TOSOPFA-CSR                                30380063
303900     PERFORM 4250-FETCH-TOSOPFA-CSR                               30390063
304000     PERFORM UNTIL PS-EOF-TOSOPFA-CSR                             30400063
304100         PERFORM 4220-BUILD-WORK-ORDER-INSTR                      30410063
304200         PERFORM 4250-FETCH-TOSOPFA-CSR                           30420063
304300     END-PERFORM                                                  30430063
304400     PERFORM 4260-CLOSE-TOSOPFA-CSR.                              30440063
304500 4210-OPEN-TOSOPFA-CSR.                                           30450063
304600     EXEC SQL                                                     30460063
304700          OPEN TOSOPFA-CSR                                        30470063
304800     END-EXEC.                                                    30480063
304900     EVALUATE SQLCODE                                             30490063
305000         WHEN ZERO                                                30500063
305100              CONTINUE                                            30510063
305200         WHEN OTHER                                               30520063
305300             MOVE '4210-OPEN-TOSOPFA'  TO DP013-PARAGRAPH         30530063
305400             MOVE 'OPEN TOSOPFA CSR'   TO DP013-MESSAGE-TEXT (1)  30540063
305500             MOVE SQLCA                TO DP013-SQLCA             30550063
305600             MOVE 'TOSOPFA'            TO DP013-DB2-TABLE-NAME (1)30560063
305700             PERFORM 7000-ABEND                                   30570063
305800     END-EVALUATE.                                                30580063
305900 4220-BUILD-WORK-ORDER-INSTR.                                     30590063
306000     INITIALIZE DCLTWKORIN.                                       30600063
306100     MOVE DK-PO-NBR                TO WKORIN-ORD-NBR.             30610063
306200     MOVE DK-REC-SEQ-NBR           TO WKORIN-RCVR-SEQ-NBR.        30620063
306300     MOVE +1                       TO WKORIN-WORK-ORD-SEQ-NBR.    30630063
306400     ADD +1                        TO PV-WO-INSTR-SEQ-NBR-N       30640063
306500     MOVE PV-WO-INSTR-SEQ-NBR-N    TO WKORIN-WO-INSTR-SEQ-NBR.    30650063
306600     MOVE 'A'                      TO WKORIN-VER-STATUS-CDE.      30660063
306700     MOVE RECEIV-OPER-UNT-ID       TO WKORIN-OPER-UNT-ID.         30670063
306800     MOVE RECEIV-FCLTY-ID          TO WKORIN-FCLTY-ID.            30680063
306900     MOVE OSOPFA-OPER-ID           TO WKORIN-OPER-ID.             30690063
307000     MOVE OSOPFA-FCLTY-AREA-ID     TO WKORIN-FCLTY-AREA-ID.       30700063
307100     MOVE OSOPFA-PRC-FCLTY-AREA-ID TO WKORIN-PRC-FCLTY-AREA-ID.   30710063
307200     MOVE OSOPFA-SCRN-SEQ-NBR      TO WKORIN-SCREEN-SEQ-NBR.      30720063
307300     IF  PS-FIRST-INSTRUCTION                                     30730063
307400         MOVE 'N'                  TO PS-INSTRUCTION-SW           30740063
307500         MOVE RECEIV-EXPTED-CART-CNT                              30750063
307600                                   TO WKORIN-EXPTED-CART-CNT      30760063
307700         MOVE RECEIV-ACTL-CART-CNT TO WKORIN-ACTL-CART-CNT        30770063
307800     END-IF.                                                      30780063
307900     MOVE 'N'                      TO WKORIN-ALLOC-IND            30790063
308000                                      WKORIN-REPACK-IND.          30800063
308100     MOVE '9999-09-09-09.09.09.999999' TO WKORIN-STRT-TMST        30810063
308200                                          WKORIN-STOP-TMST.       30820063
308300                                                                  30830063
308400     PERFORM 4230-INACTIVATE-TWKORIN.                             30840063
308500     PERFORM 4240-INSERT-TWKORIN.                                 30850063
308600                                                                  30860063
308700 4230-INACTIVATE-TWKORIN.                                         30870063
308800                                                                  30880063
308900     EXEC SQL                                                     30890063
309000          UPDATE TWKORIN                                          30900063
309100             SET VER_STATUS_CDE      =  'I'                       30910063
309200           WHERE ORD_NBR             =  :WKORIN-ORD-NBR           30920063
309300             AND RCVR_SEQ_NBR        =  :WKORIN-RCVR-SEQ-NBR      30930063
309400             AND ORD_LNE_NBR         =  :WKORIN-ORD-LNE-NBR       30940063
309500             AND WORK_ORD_SEQ_NBR    =  :WKORIN-WORK-ORD-SEQ-NBR  30950063
309600             AND WO_INSTR_SEQ_NBR    =  :WKORIN-WO-INSTR-SEQ-NBR  30960063
309700             AND VER_STATUS_CDE      =  'A'                       30970063
309800     END-EXEC.                                                    30980063
309900                                                                  30990063
310000     EVALUATE SQLCODE                                             31000063
310100         WHEN ZERO                                                31010063
310200         WHEN +100                                                31020063
310300              CONTINUE                                            31030063
310400         WHEN OTHER                                               31040063
310500              MOVE '4230-INACTIVATE-TWKORIN' TO DP013-PARAGRAPH   31050063
310600              MOVE '"LOGICAL" DELETE; SET STATUS TO I'            31060063
310700                                       TO DP013-MESSAGE-TEXT (1)  31070063
310800              MOVE DK-PO-NBR       TO PV-ERROR-PO                 31080063
310900              MOVE DK-REC-SEQ-NBR  TO PV-ERROR-SEQ                31090063
311000              MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)      31100063
311100              MOVE SQLCA           TO DP013-SQLCA                 31110063
311200              MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)    31120063
311300              PERFORM 7000-ABEND                                  31130063
311400     END-EVALUATE.                                                31140063
311500                                                                  31150063
311600 4240-INSERT-TWKORIN.                                             31160063
311700                                                                  31170063
311800     EXEC SQL                                                     31180063
311900          INSERT INTO TWKORIN                                     31190063
312000                 ( ORD_NBR                                        31200063
312100                  ,RCVR_SEQ_NBR                                   31210063
312200                  ,ORD_LNE_NBR                                    31220063
312300                  ,WORK_ORD_SEQ_NBR                               31230063
312400                  ,OPER_UNT_ID                                    31240063
312500                  ,FCLTY_ID                                       31250063
312600                  ,WO_INSTR_SEQ_NBR                               31260063
312700                  ,CRE_TMST                                       31270063
312800                  ,VER_STATUS_CDE                                 31280063
312900                  ,CRE_UID_ID                                     31290063
313000                  ,OPER_ID                                        31300063
313100                  ,FCLTY_AREA_ID                                  31310063
313200                  ,PRC_FCLTY_AREA_ID                              31320063
313300                  ,EXPTED_CART_CNT                                31330063
313400                  ,ACTL_CART_CNT                                  31340063
313500                  ,ALLOC_IND                                      31350063
313600                  ,REPACK_IND                                     31360063
313700                  ,STRT_TMST                                      31370063
313800                  ,STOP_TMST                                      31380063
313900                  ,SCREEN_SEQ_NBR                                 31390063
314000                  ,LNE_LOC_CDE                                    31400063
314100                  ,REC_SEL_IND )                                  31410063
314200          VALUES ( :WKORIN-ORD-NBR                                31420063
314300                  ,:WKORIN-RCVR-SEQ-NBR                           31430063
314400                  ,:WKORIN-ORD-LNE-NBR                            31440063
314500                  ,:WKORIN-WORK-ORD-SEQ-NBR                       31450063
314600                  ,:WKORIN-OPER-UNT-ID                            31460063
314700                  ,:WKORIN-FCLTY-ID                               31470063
314800                  ,:WKORIN-WO-INSTR-SEQ-NBR                       31480063
314900                  ,CURRENT TIMESTAMP                              31490063
315000                  ,:WKORIN-VER-STATUS-CDE                         31500063
315100                  ,:PV-USERID                                     31510063
315200                  ,:WKORIN-OPER-ID                                31520063
315300                  ,:WKORIN-FCLTY-AREA-ID                          31530063
315400                  ,:WKORIN-PRC-FCLTY-AREA-ID                      31540063
315500                  ,:WKORIN-EXPTED-CART-CNT                        31550063
315600                  ,:WKORIN-ACTL-CART-CNT                          31560063
315700                  ,:WKORIN-ALLOC-IND                              31570063
315800                  ,:WKORIN-REPACK-IND                             31580063
315900                  ,:WKORIN-STRT-TMST                              31590063
316000                  ,:WKORIN-STOP-TMST                              31600063
316100                  ,:WKORIN-SCREEN-SEQ-NBR                         31610063
316200                  ,:WKORIN-LNE-LOC-CDE                            31620063
316300                  ,:WKORIN-REC-SEL-IND )                          31630063
316400     END-EXEC.                                                    31640063
316500                                                                  31650063
316600     EVALUATE SQLCODE                                             31660063
316700         WHEN ZERO                                                31670063
316800             CONTINUE                                             31680063
316900         WHEN OTHER                                               31690063
317000             MOVE '4240-INSERT-TWKORIN' TO DP013-PARAGRAPH        31700063
317100             MOVE 'INSERT ON WORK ORDER INSTRUCTION TABLE'        31710063
317200                                 TO DP013-MESSAGE-TEXT (1)        31720063
317300             MOVE SQLCA          TO DP013-SQLCA                   31730063
317400             MOVE DK-PO-NBR       TO PV-ERROR-PO                  31740063
317500             MOVE DK-REC-SEQ-NBR  TO PV-ERROR-SEQ                 31750063
317600             MOVE PV-ERROR-MSG    TO DP013-MESSAGE-TEXT (2)       31760063
317700             MOVE 'TWKORIN'       TO DP013-DB2-TABLE-NAME (1)     31770063
317800             PERFORM 7000-ABEND                                   31780063
317900     END-EVALUATE.                                                31790063
318000                                                                  31800063
318100 4250-FETCH-TOSOPFA-CSR.                                          31810063
318200     EXEC SQL                                                     31820063
318300          FETCH TOSOPFA-CSR                                       31830063
318400          INTO :OSOPFA-OPER-SET-ID                                31840063
318500              ,:OSOPFA-OPER-ID                                    31850063
318600              ,:OSOPFA-OPER-UNT-ID                                31860063
318700              ,:OSOPFA-FCLTY-ID                                   31870063
318800              ,:OSOPFA-FCLTY-AREA-ID                              31880063
318900              ,:OSOPFA-PRC-FCLTY-AREA-ID                          31890063
319000              ,:OSOPFA-SCRN-SEQ-NBR                               31900063
319100     END-EXEC.                                                    31910063
319200     EVALUATE TRUE                                                31920063
319300         WHEN SQLCODE = +0                                        31930063
319400              CONTINUE                                            31940063
319500         WHEN SQLCODE = +100                                      31950063
319600              SET PS-EOF-TOSOPFA-CSR TO TRUE                      31960063
319700         WHEN OTHER                                               31970063
319800             MOVE DK-OPER-SET-ID       TO PV-OPER-SET-N           31980063
319900             MOVE RECEIV-CURR-OPER-UNT-ID                         31990063
320000                                       TO PV-RCVR-N               32000063
320100             MOVE '4250-FETCH-TOSOPFA-CSR'                        32010063
320200                                       TO DP013-PARAGRAPH         32020063
320300             STRING 'OPER SET  = ' DELIMITED BY SIZE              32030063
320400                     PV-OPER-SET-N DELIMITED BY SIZE              32040063
320500                                     INTO DP013-MESSAGE-TEXT (1)  32050063
320600             STRING 'RECEIVER  = ' DELIMITED BY SIZE              32060063
320700                     PV-RCVR-N     DELIMITED BY SIZE              32070063
320800                                     INTO DP013-MESSAGE-TEXT (2)  32080063
320900             MOVE SQLCA                TO DP013-SQLCA             32090063
321000             MOVE 'TOSOPFA'            TO DP013-DB2-TABLE-NAME (1)32100063
321100             PERFORM 7000-ABEND                                   32110063
321200     END-EVALUATE.                                                32120063
321300 4260-CLOSE-TOSOPFA-CSR.                                          32130063
321400     EXEC SQL                                                     32140063
321500          CLOSE TOSOPFA-CSR                                       32150063
321600     END-EXEC.                                                    32160063
321700     EVALUATE TRUE                                                32170063
321800         WHEN SQLCODE = ZEROS                                     32180063
321900              CONTINUE                                            32190063
322000         WHEN OTHER                                               32200063
322100             MOVE '4260-CLOSE-TOSOPFA' TO DP013-PARAGRAPH         32210063
322200             MOVE 'CLOSE TOSOPFA CSR'  TO DP013-MESSAGE-TEXT (1)  32220063
322300             MOVE SQLCA                TO DP013-SQLCA             32230063
322400             MOVE 'TOSOPFA'            TO DP013-DB2-TABLE-NAME (1)32240063
322500             PERFORM 7000-ABEND                                   32250063
322600     END-EVALUATE.                                                32260063
322700                                                                  32270063
322800 4300-LINE-LOC-UPDATE.                                            32280063
322900     EXEC SQL                                                     32290063
323000         UPDATE TWKORIN                                           32300063
323100            SET LNE_LOC_CDE = :ANEWLOCI                           32310063
323200          WHERE ORD_NBR          = :DK-PO-NBR                     32320063
323300            AND RCVR_SEQ_NBR     = :DK-REC-SEQ-NBR                32330063
323400            AND ORD_LNE_NBR      = 0                              32340063
323500            AND WORK_ORD_SEQ_NBR = 1                              32350063
323600            AND WO_INSTR_SEQ_NBR = :WKORIN-WO-INSTR-SEQ-NBR       32360063
323700            AND VER_STATUS_CDE   = 'A'                            32370063
323800     END-EXEC.                                                    32380063
323900     EVALUATE SQLCODE                                             32390063
324000         WHEN ZERO                                                32400063
324100             MOVE ANEWLOCI TO PC056-NEW-LINE-LOC                  32410063
324200                              ALOCI                               32420063
324300             MOVE SPACES   TO ANEWLOCI                            32430063
324400             MOVE PM-UPDATE-SUCCESSFUL                            32440063
324500                           TO AMSGLN1O                            32450063
324600             MOVE SPACES   TO AMSGLN2O                            32460063
324700             MOVE -1       TO ABARCODEL                           32470063
324800             MOVE DP015-UNP-ALP-NOR-MDT                           32480063
324900                           TO ABARCODEA                           32490063
325000                              APONBRA                             32500063
325100                              ARCVRA                              32510063
325200         WHEN +100                                                32520063
325300             MOVE SPACES   TO ANEWLOCI                            32530063
325400             MOVE PM-CANNOT-UPDATE-LOC-1                          32540063
325500                           TO AMSGLN1O                            32550063
325600             MOVE PM-CANNOT-UPDATE-LOC-2                          32560063
325700                           TO AMSGLN2O                            32570063
325800             MOVE -1       TO ABARCODEL                           32580063
325900             MOVE DP015-UNP-ALP-NOR-MDT                           32590063
326000                           TO ABARCODEA                           32600063
326100                              APONBRA                             32610063
326200                              ARCVRA                              32620063
326300         WHEN OTHER                                               32630063
326400             MOVE DK-PO-NBR            TO PV-PO-N                 32640063
326500             MOVE DK-REC-SEQ-NBR       TO PV-RCVR-N               32650063
326600             MOVE WKORIN-WO-INSTR-SEQ-NBR                         32660063
326700                                       TO PV-WO-INSTR-SEQ-NBR-N   32670063
326800             MOVE '4300-LINE-LOC-UPDATE'                          32680063
326900                                       TO DP013-PARAGRAPH         32690063
327000             STRING 'PO NUMBER = ' DELIMITED BY SIZE              32700063
327100                     PV-PO-N       DELIMITED BY SIZE              32710063
327200                                     INTO DP013-MESSAGE-TEXT (1)  32720063
327300             STRING 'RECEIVER  = ' DELIMITED BY SIZE              32730063
327400                     PV-RCVR-N     DELIMITED BY SIZE              32740063
327500                                     INTO DP013-MESSAGE-TEXT (2)  32750063
327600             STRING 'INSTR NBR = ' DELIMITED BY SIZE              32760063
327700                     PV-WO-INSTR-SEQ-NBR-N                        32770063
327800                                   DELIMITED BY SIZE              32780063
327900                                     INTO DP013-MESSAGE-TEXT (3)  32790063
328000             MOVE SQLCA                TO DP013-SQLCA             32800063
328100             MOVE 'TWKORIN'            TO DP013-DB2-TABLE-NAME (1)32810063
328200             PERFORM 7000-ABEND                                   32820063
328300     END-EVALUATE.                                                32830063
328400                                                                  32840063
328500 5000-CALL-PO-RCVR-TRKING-MOD.                                    32850063
328600     INITIALIZE RC071-FIELDS                                      32860063
328700     MOVE '0E'                      TO RC071-DC-FUNCTION-CODE.    32870063
328800     MOVE DK-PO-NBR                 TO RC071-PO-NBR               32880063
328900     MOVE DK-REC-SEQ-NBR            TO RC071-PO-RCVR              32890063
329000     MOVE ZEROES                    TO RC071-PO-LINE              32900063
329100                                       RC071-PREPK-ID             32910063
329200     MOVE RECEIV-OPER-UNT-ID        TO RC071-SIGNON-LOCATION      32920063
329300     MOVE PV-USERID                 TO RC071-USER-ID              32930063
329400     MOVE PC-CURRENT-PROGRAM-NAME   TO RC071-CALLING-PROGRAM      32940063
329500                                                                  32950063
329600     CALL RC071-PO-RCVR-TRACKING USING  DFHEIBLK                  32960063
329700                                        RC071-COMMAREA            32970063
329800                                        RC071-FIELDS.             32980063
329900     IF RC071-SUCCESSFUL                                          32990063
330000         CONTINUE                                                 33000063
330100     ELSE                                                         33010063
330200         MOVE '5000-CALL-PO-RCVR-TRKING-MOD'                      33020063
330300                                   TO DP013-PARAGRAPH             33030063
330400         STRING                                                   33040063
330500               'CALL TO RCKUT137 NOT SUCCESSFUL '                 33050063
330600               'RETURN CODE = '                                   33060063
330700               RC071-SUCCESS-IND                                  33070063
330800                                DELIMITED BY SIZE                 33080063
330900                                 INTO DP013-MESSAGE-TEXT (2)      33090063
331000         MOVE DK-PO-NBR            TO PV-ERROR-PO                 33100063
331100         MOVE DK-REC-SEQ-NBR       TO PV-ERROR-SEQ                33110063
331200         MOVE PV-ERROR-MSG         TO DP013-MESSAGE-TEXT (3)      33120063
331300         PERFORM 7000-ABEND                                       33130063
331400      END-IF.                                                     33140063
331500                                                                  33150063
331600                                                                  33160063
331700* * * SEND ABEND MESSAGE, GET ABEND PANEL TO CICS LOG,            33170063
331800* * * AND END THE PROGRAM.                                        33180063
331900 7000-ABEND.                                                      33190063
332000     MOVE PM-CICS-ABEND-MSG      TO AMSGLN1O                      33200063
332100     MOVE PM-CICS-ABEND-MSG-2    TO AMSGLN2O                      33210063
332200     MOVE DP015-UNP-ALP-BRT-MDT  TO AMSGLN1A                      33220063
332300     MOVE DP015-UNP-ALP-BRT-MDT  TO AMSGLN2A                      33230063
332400     PERFORM 8010-SEND-DATA-ONLY                                  33240063
332500     SET DP013-DB2-ABEND         TO TRUE                          33250063
332600     PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                       33260063
332700     PERFORM 8100-RETURN-TRANID.                                  33270063
332800                                                                  33280063
332900*----------------------------------------------------------------*33290063
333000 8000-SEND-MAP.                                                   33300063
333100                                                                  33310063
333200     EXEC CICS                                                    33320063
333300         SEND MAP       ('PC901A')                                33330063
333400              MAPSET    ('PCKM901')                               33340063
333500              ERASE                                               33350063
333600              CURSOR                                              33360063
333700              RESP      (PV-CICS-RESPONSE)                        33370063
333800     END-EXEC.                                                    33380063
333900                                                                  33390063
334000     EVALUATE TRUE                                                33400063
334100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33410063
334200             CONTINUE                                             33420063
334300         WHEN OTHER                                               33430063
334400             MOVE '8000-SEND-MAP'     TO DP013-PARAGRAPH          33440063
334500             MOVE 'PCKRF901 - UNABLE TO SEND MAP'                 33450063
334600                                      TO DP013-MESSAGE-TEXT (1)   33460063
334700             SET DP013-CICS-ABEND                                 33470063
334800                 DP013-ROLLBACK       TO TRUE                     33480063
334900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               33490063
335000     END-EVALUATE.                                                33500063
335100                                                                  33510063
335200 8010-SEND-DATA-ONLY.                                             33520063
335300                                                                  33530063
335400*    MOVE -1                          TO ABARCODEL                33540063
335500     EXEC CICS                                                    33550063
335600         SEND MAP       ('PC901A')                                33560063
335700              MAPSET    ('PCKM901')                               33570063
335800              CURSOR                                              33580063
335900              DATAONLY                                            33590063
336000              RESP      (PV-CICS-RESPONSE)                        33600063
336100     END-EXEC.                                                    33610063
336200                                                                  33620063
336300     EVALUATE TRUE                                                33630063
336400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33640063
336500             CONTINUE                                             33650063
336600         WHEN OTHER                                               33660063
336700             MOVE '8010-SEND-DATA-ONLY'                           33670063
336800                                      TO DP013-PARAGRAPH          33680063
336900             MOVE 'PCKRF901 - UNABLE TO SEND DATA'                33690063
337000                                      TO DP013-MESSAGE-TEXT (1)   33700063
337100             SET DP013-CICS-ABEND                                 33710063
337200                 DP013-ROLLBACK       TO TRUE                     33720063
337300             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               33730063
337400     END-EVALUATE.                                                33740063
337500                                                                  33750063
337600 8020-RECEIVE-MAP.                                                33760063
337700                                                                  33770063
337800     EXEC CICS                                                    33780063
337900         RECEIVE MAP    ('PC901A')                                33790063
338000                 MAPSET ('PCKM901')                               33800063
338100                 RESP   (PV-CICS-RESPONSE)                        33810063
338200     END-EXEC.                                                    33820063
338300                                                                  33830063
338400     EVALUATE TRUE                                                33840063
338500         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 33850063
338600             CONTINUE                                             33860063
338700         WHEN PV-CICS-RESPONSE = DFHRESP (MAPFAIL)                33870063
338800             CONTINUE                                             33880063
338900         WHEN OTHER                                               33890063
339000            MOVE '8020-RECEIVE-MAP'      TO DP013-PARAGRAPH       33900063
339100            MOVE 'PCKRF901 - UNABLE TO RECEIVE MAP'               33910063
339200                                         TO DP013-MESSAGE-TEXT (1)33920063
339300            SET DP013-LOGIC-ABEND        TO TRUE                  33930063
339400            SET DP013-ROLLBACK           TO TRUE                  33940063
339500            PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG                33950063
339600     END-EVALUATE.                                                33960063
339700                                                                  33970063
339800 8100-RETURN-TRANID.                                              33980063
339900     IF MP026-LAST-PROGRAM = PC-DC-RF-APPL-PGM                    33990063
340000         MOVE MP026-COMMAREA          TO PC056-HOST-SAVE-AREA     34000063
340100     ELSE                                                         34010063
340200         MOVE SU001-COMMON-DATA       TO PC056-HOST-SAVE-AREA     34020063
340300     END-IF                                                       34030063
340400                                                                  34040063
340500     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH       34050063
340600     EXEC CICS                                                    34060063
340700         RETURN TRANSID  (PC-TRANID)                              34070063
340800                COMMAREA (CA-COMMAREA)                            34080063
340900                LENGTH   (PV-COMMAREA-LENGTH)                     34090063
341000                RESP     (PV-CICS-RESPONSE)                       34100063
341100     END-EXEC.                                                    34110063
341200                                                                  34120063
341300     EVALUATE TRUE                                                34130063
341400         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 34140063
341500             CONTINUE                                             34150063
341600         WHEN OTHER                                               34160063
341700             MOVE '8100-RETURN-TRANIND' TO DP013-PARAGRAPH        34170063
341800             MOVE 'PCKRF901 - UNABLE TO RETURN TO TRANID'         34180063
341900                 TO DP013-MESSAGE-TEXT (1)                        34190063
342000             SET DP013-CICS-ABEND       TO TRUE                   34200063
342100             SET DP013-ROLLBACK         TO TRUE                   34210063
342200             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               34220063
342300     END-EVALUATE.                                                34230063
342400                                                                  34240063
342500 8110-RETURN-WITH-MSG.                                            34250063
342600                                                                  34260063
342700     EXEC CICS                                                    34270063
342800         SEND FROM (PV-MESSAGE-AREA)                              34280063
342900              LENGTH (19)                                         34290063
343000              ERASE                                               34300063
343100     END-EXEC.                                                    34310063
343200                                                                  34320063
343300     EXEC CICS                                                    34330063
343400         RETURN                                                   34340063
343500     END-EXEC.                                                    34350063
343600                                                                  34360063
343700 8200-XCTL.                                                       34370063
343800     SET MP026-INITIALIZE-SCREEN                                  34380063
343900         SU001-INITIALIZE-SCREEN      TO TRUE                     34390063
344000     IF PC056-LAST-PROGRAM = PC-DC-RF-APPL-PGM                    34400063
344100         MOVE PC-DC-RF-APPL-PGM       TO PV-TRANSFER-PROGRAM      34410063
344200         MOVE PC-CURRENT-PROGRAM-NAME TO MP026-LAST-PROGRAM       34420063
344300         MOVE MP026-COMMAREA          TO PC056-HOST-SAVE-AREA     34430063
344400     ELSE                                                         34440063
344500         MOVE PC-CHECK-IN-PGM         TO PV-TRANSFER-PROGRAM      34450063
344600         MOVE PC-CURRENT-PROGRAM-NAME TO SU001-LAST-PROGRAM       34460063
344700         MOVE SU001-COMMON-DATA       TO PC056-HOST-SAVE-AREA     34470063
344800     END-IF                                                       34480063
344900     MOVE LENGTH OF CA-COMMAREA       TO PV-COMMAREA-LENGTH.      34490063
345000                                                                  34500063
345100     EXEC CICS                                                    34510063
345200         XCTL  PROGRAM   (PV-TRANSFER-PROGRAM)                    34520063
345300               COMMAREA  (CA-COMMAREA)                            34530063
345400               LENGTH    (PV-COMMAREA-LENGTH)                     34540063
345500               RESP      (PV-CICS-RESPONSE)                       34550063
345600     END-EXEC.                                                    34560063
345700                                                                  34570063
345800     EVALUATE TRUE                                                34580063
345900         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 34590063
346000             CONTINUE                                             34600063
346100         WHEN OTHER                                               34610063
346200             MOVE '8200-XCTL'                                     34620063
346300                                      TO DP013-PARAGRAPH          34630063
346400             MOVE 'PCKRF901 - UNABLE TO XCTL TO PROGRAM: '        34640063
346500                                      TO DP013-MESSAGE-TEXT (1)   34650063
346600             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   34660063
346700             SET DP013-CICS-ABEND                                 34670063
346800                 DP013-ROLLBACK       TO TRUE                     34680063
346900             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               34690063
347000             MOVE PM-TRANS-UNAVAILABLE-MSG                        34700063
347100                                      TO AMSGLN1O                 34710063
347200             MOVE -1                  TO ABARCODEL                34720063
347300             SET MP026-PROCESS-SCREEN TO TRUE                     34730063
347400             PERFORM 8000-SEND-MAP                                34740063
347500             PERFORM 8100-RETURN-TRANID                           34750063
347600     END-EVALUATE.                                                34760063
347700                                                                  34770063
347800 8220-XCTL-TO-HELP.                                               34780063
347900                                                                  34790063
348000     MOVE LENGTH OF PC192-COMMAREA    TO PV-COMMAREA-LENGTH       34800063
348100                                                                  34810063
348200     EXEC CICS                                                    34820063
348300         XCTL                                                     34830063
348400             PROGRAM   (PV-TRANSFER-PROGRAM)                      34840063
348500             COMMAREA  (PC192-COMMAREA)                           34850063
348600             LENGTH    (PV-COMMAREA-LENGTH)                       34860063
348700             RESP      (PV-CICS-RESPONSE)                         34870063
348800     END-EXEC.                                                    34880063
348900                                                                  34890063
349000     EVALUATE TRUE                                                34900063
349100         WHEN PV-CICS-RESPONSE = DFHRESP (NORMAL)                 34910063
349200              CONTINUE                                            34920063
349300         WHEN OTHER                                               34930063
349400             MOVE '8220-XCTL-TO-HELP' TO DP013-PARAGRAPH          34940063
349500             MOVE 'PCKRF901 - UNABLE TO XCTL TO PROGRAM: '        34950063
349600                                      TO DP013-MESSAGE-TEXT (1)   34960063
349700             MOVE PV-TRANSFER-PROGRAM TO DP013-MESSAGE-TEXT (2)   34970063
349800             SET DP013-CICS-ABEND                                 34980063
349900                 DP013-ROLLBACK       TO TRUE                     34990063
350000             PERFORM 9999-WRITE-MESSAGE-TO-CICS-LOG               35000063
350100             MOVE PM-TRANS-UNAVAILABLE-MSG                        35010063
350200                                      TO AMSGLN1O                 35020063
350300             SET MP026-PROCESS-SCREEN TO TRUE                     35030063
350400             MOVE -1                  TO ABARCODEL                35040063
350500             PERFORM 8000-SEND-MAP                                35050063
350600             PERFORM 8100-RETURN-TRANID                           35060063
350700     END-EVALUATE.                                                35070063
350800*                                                                 35080063
350900/                                                                 35090063
351000                                                                  35100063
351100 9999-WRITE-MESSAGE-TO-CICS-LOG.                                  35110063
351200                                                                  35120063
351300     MOVE PC-CURRENT-PROGRAM-NAME     TO DP013-PROGRAM.           35130063
351400     MOVE DFHEIBLK                    TO DP013-DFHEIBLK.          35140063
351500     INITIALIZE DP013-SRC-TASK-NUMBER                             35150063
351600                DP013-STACK.                                      35160063
351700     SET DP013-LINK-RETURN            TO TRUE.                    35170063
351800                                                                  35180063
351900     EXEC CICS                                                    35190063
352000         LINK                                                     35200063
352100             PROGRAM   (DP013-NAME)                               35210063
352200             COMMAREA  (DP013-PARAMETERS)                         35220063
352300             LENGTH    (DP013-LENGTH)                             35230063
352400     END-EXEC.                                                    35240063
352500                                                                  35250063
352600*----------------------------------------------------------------*35260063
352700*    ABEND PROCESSOR MODULE                                      *35270063
352800*----------------------------------------------------------------*35280063
352900                                                                  35290063
353000     COPY DPPD014.                                                35300063
353100                                                                  35310063
