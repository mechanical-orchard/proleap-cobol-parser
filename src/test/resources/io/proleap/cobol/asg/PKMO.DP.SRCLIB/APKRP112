000100 IDENTIFICATION DIVISION.                                         00010000
000200 PROGRAM-ID.     APKRP112.                                        00020000
000300 AUTHOR.         PAUL KEBER - STRATAGEM                           00030000
000400 DATE-WRITTEN.   11/14/1995.                                      00040000
000500 DATE-COMPILED.                                                   00050000
000600*************************************************************     00060000
000700*    COBOL 2                                                *     00070000
000800*                                                           *     00080000
000900*    UNJOURNALIZED RECEIPT ANALYSIS REPORT                  *     00090000
001000*                                                           *     00100000
001100*   PROGRAM OVERVIEW:                                       *     00110000
001200*                                                           *     00120000
001300*     THIS PROGRAM CREATES THE UNJOURNALIZED RECEIPT        *     00130000
001400*   ANALYSIS REPORT FROM A REPORT FILE PRODUCED IN APKUT107 *     00140000
001500*   AND A DATE FILE PRODUCED IN APKUT106.                   *     00150000
001600*     THE REPORT WILL BE IN ASCENDING DEPT NUMBER, VENDOR,  *     00160000
001700*   PO NUMBER SEQUENCE.  A REPORT LINE WILL BE CREATED      *     00170000
001800*   FOR EACH PO WHICH HAS UNJOURNALIZED RECEIPTS WITHIN     *     00180000
001900*   A START AND END DATE RANGE AND WHICH HAVE BEEN VERIFIED.*     00190000
002000*                                                           *     00200000
002100*   INPUT:                                                  *     00210000
002200*  1) UNJRNLZD-RECEIPT-DATA-FILE              (APRD107)     *     00220000
002300*  2) UNJRNLZD-RECEIPT-DATE-FILE              (APRD108)     *     00230000
002400*                                                           *     00240000
002500*   OUTPUT:                                                 *     00250000
002600*                                                           *     00260000
002700*  1) RPT01-FILE                              (DPWS133O)    *     00270000
002800*                                                           *     00280000
002900*************************************************************     00290000
003000*  CHANGE LOG:                                              *     00300000
003100*                                                           *     00310000
003200*  06/20/96  DARYL WOELFEL                                  *     00320000
003300*            COPIED PROGRAM APKRP108 TO APKRP112.  MODIFIED *     00330000
003400*            REPORT TO MAKE DEPT NUMBER A PAGE HEADING AND  *     00340000
003500*            PAGE BREAK ON DEPT NUMBER.                     *     00350000
003600*                                                           *     00360000
003700*  11/15/02  MIKE BESKE                        WR# 24091    *     00370000
003800*            RECOMPILED PROGRAM TO PICK UP CHANGES TO THE   *     00380000
003900*            COPYBOOK APRD107.                              *     00390000
004000*                                                           *     00400000
004100* 02/04/2003                                                *     00410000
004200*    CHANGE MADE: ARKPO PHASE3 PROJECT.                     *     00420000
004300*    UPDATED THE FILES IN THE PROG COMMENT BLOCK.           *     00430000
004400*    INCREASED THE PO PRINT FIELD TO Z(9) AND ADJUSTED THE  *     00440000
004500*    PRINT HEADERS TO MATCH ACCORDINGLY.                    *     00450000
004600* MADE BY:  MIKE BESKE                          WR#: 23500  *     00460000
004700*                                                           *     00470000
004710* 10/28/2005                                                *     00471005
004711*    INCREASED SIZE OF UNJRNLZD-RECEIPT-DATA-FILE TO 95     *     00471102
004712*    CHARACTERS TO ALLOW FOR THE NEW TOTAL GROSS COST       *     00471204
004713*    FIELD. THIS INPUT FILE IS DEFINED BY APRD107.          *     00471304
004740* MADE BY: MICHELE RINDFLEISCH                  WR#: 28546  *     00474001
004800*************************************************************     00480000
004900/                                                                 00490000
005000 ENVIRONMENT DIVISION.                                            00500000
005100 CONFIGURATION SECTION.                                           00510000
005200 INPUT-OUTPUT SECTION.                                            00520000
005300 FILE-CONTROL.                                                    00530000
005400                                                                  00540000
005500     SELECT UNJRNLZD-RECEIPT-DATA-FILE  ASSIGN TO UT-S-INP01.     00550000
005600     SELECT UNJRNLZD-RECEIPT-DATE-FILE  ASSIGN TO UT-S-INP02.     00560000
005700     SELECT RPT01-FILE                  ASSIGN TO UT-S-RPT01.     00570000
005800                                                                  00580000
005900 DATA DIVISION.                                                   00590000
006000 FILE SECTION.                                                    00600000
006100 FD  UNJRNLZD-RECEIPT-DATA-FILE                                   00610000
006200     RECORDING MODE IS F                                          00620000
006300     LABEL RECORDS ARE STANDARD                                   00630000
006400     BLOCK CONTAINS 0 RECORDS                                     00640000
006500     DATA RECORD IS UNJRNLZD-RECEIPT-DATA-RECORD.                 00650000
006600 01  UNJRNLZD-RECEIPT-DATA-RECORD PIC X(95).                      00660001
006700                                                                  00670000
006800 FD  UNJRNLZD-RECEIPT-DATE-FILE                                   00680000
006900     RECORDING MODE IS F                                          00690000
007000     LABEL RECORDS ARE STANDARD                                   00700000
007100     BLOCK CONTAINS 0 RECORDS                                     00710000
007200     DATA RECORD IS UNJRNLZD-RECEIPT-DATE-RECORD.                 00720000
007300 01  UNJRNLZD-RECEIPT-DATE-RECORD PIC X(41).                      00730000
007400                                                                  00740000
007500 FD  RPT01-FILE                                                   00750000
007600     RECORDING MODE IS F                                          00760000
007700     LABEL RECORDS ARE STANDARD                                   00770000
007800     BLOCK CONTAINS 0 RECORDS                                     00780000
007900     DATA RECORD IS RPT01-RECORD.                                 00790000
008000 01  RPT01-RECORD                PIC  X(132).                     00800000
008100                                                                  00810000
008200 EJECT                                                            00820000
008300 WORKING-STORAGE SECTION.                                         00830000
008400                                                                  00840000
008500 01  PROGRAM-WORKAREA.                                            00850000
008600     05  FILLER                  PIC  X(30)           VALUE       00860000
008700         '** BEGINING OF APKRP112 W/S **'.                        00870000
008800                                                                  00880000
008900     05  PW-CURRENT-PARAGRAPH    PIC  X(30)           VALUE SPACE.00890000
009000     05  PW-PROGRAM-NAME         PIC  X(08)           VALUE       00900000
009100         'APKRP112'.                                              00910000
009200                                                                  00920000
009300 01  PRINT-FIELDS.                                                00930000
009400     05  PR-MAX-LINES            PIC S9(05)   COMP-3  VALUE +64.  00940000
009500     05  PR-LINE-COUNT           PIC S9(05)   COMP-3  VALUE +99.  00950000
009600     05  PR-PAGE-COUNT           PIC S9(05)   COMP-3  VALUE +0.   00960000
009700     05  PR-DETAIL-CC            PIC S9(01)   COMP-3  VALUE +0.   00970000
009800     05  PR-CC                   PIC S9(01)   COMP-3  VALUE +0.   00980000
009900     05  PR-LINE                 PIC  X(132)  VALUE SPACES.       00990000
010000                                                                  01000000
010100 01  PROGRAM-SWITCHES-SUBSCRIPTS.                                 01010000
010200     05  PS-END-OF-RECEIPT-RECS-SW                                01020000
010300                                 PIC  X(01)   VALUE 'N'.          01030000
010400         88  END-OF-RECEIPT-RECS              VALUE 'Y'.          01040000
010500                                                                  01050000
010600 01  PW-CURRENT-DATE.                                             01060000
010700     05  PW-CURRENT-YEAR         PIC  9(02).                      01070000
010800     05  PW-CURRENT-MONTH        PIC  9(02).                      01080000
010900     05  PW-CURRENT-DAY          PIC  9(02).                      01090000
011000                                                                  01100000
011100 01  PW-CURRENT-TIME.                                             01110000
011200     05  PW-CURRENT-HOUR         PIC  9(02).                      01120000
011300     05  PW-CURRENT-MINUTE       PIC  9(02).                      01130000
011400     05  FILLER                  PIC  9(02)           VALUE 00.   01140000
011500                                                                  01150000
011600 01  PR-END-DATE.                                                 01160000
011700     05  PR-END-MONTH            PIC  9(02)   VALUE ZERO.         01170000
011800     05  FILLER                  PIC  X(01)   VALUE '/'.          01180000
011900     05  PR-END-DAY              PIC  9(02)   VALUE ZERO.         01190000
012000     05  FILLER                  PIC  X(01)   VALUE '/'.          01200000
012100     05  PR-END-YEAR             PIC  9(04)   VALUE ZERO.         01210000
012200                                                                  01220000
012300 01  PR-START-DATE.                                               01230000
012400     05  PR-START-MONTH          PIC  9(02)   VALUE ZERO.         01240000
012500     05  FILLER                  PIC  X(01)   VALUE '/'.          01250000
012600     05  PR-START-DAY            PIC  9(02)   VALUE ZERO.         01260000
012700     05  FILLER                  PIC  X(01)   VALUE '/'.          01270000
012800     05  PR-START-YEAR           PIC  9(04)   VALUE ZERO.         01280000
012900                                                                  01290000
013000 01  PW-END-DATE.                                                 01300000
013100     05  PW-END-YEAR             PIC  9(04)   VALUE ZERO.         01310000
013200     05  FILLER                  PIC  X(01)   VALUE '-'.          01320000
013300     05  PW-END-MONTH            PIC  9(02)   VALUE ZERO.         01330000
013400     05  FILLER                  PIC  X(01)   VALUE '-'.          01340000
013500     05  PW-END-DAY              PIC  9(02)   VALUE ZERO.         01350000
013600                                                                  01360000
013700 01  PW-START-DATE.                                               01370000
013800     05  PW-START-YEAR           PIC  9(04)   VALUE ZERO.         01380000
013900     05  FILLER                  PIC  X(01)   VALUE '-'.          01390000
014000     05  PW-START-MONTH          PIC  9(02)   VALUE ZERO.         01400000
014100     05  FILLER                  PIC  X(01)   VALUE '-'.          01410000
014200     05  PW-START-DAY            PIC  9(02)   VALUE ZERO.         01420000
014300                                                                  01430000
014400 EJECT                                                            01440000
014500*  INPUT RECORD AREA                                              01450000
014600     COPY APRD107.                                                01460000
014700                                                                  01470000
014800 EJECT                                                            01480000
014900*  UNJOURNALIZED RECEIPT DATE FILE                                01490000
015000     COPY APRD108.                                                01500000
015100                                                                  01510000
015200 EJECT                                                            01520000
015300*  PRINT AREA                                                     01530000
015400     COPY DPWS133O.                                               01540000
015500                                                                  01550000
015600 01  HDR-LINE2.                                                   01560000
015700     05  FILLER                  PIC  X(40)   VALUE SPACES.       01570000
015800     05  HL2-TITLE               PIC  X(52)   VALUE               01580000
015900         '        UNJOURNALIZED RECEIPT ANALYSIS REPORT       '.  01590000
016000     05  FILLER                  PIC  X(40)   VALUE SPACES.       01600000
016100                                                                  01610000
016200 01  HDR-LINE3.                                                   01620000
016300     05  FILLER                  PIC  X(50)   VALUE SPACES.       01630000
016400     05  FILLER                  PIC  X(07)   VALUE 'DATES: '.    01640000
016500     05  HL3-START-DATE          PIC  X(10)   VALUE SPACES.       01650000
016600     05  FILLER                  PIC  X(06)   VALUE ' THRU '.     01660000
016700     05  HL3-END-DATE            PIC  X(10)   VALUE SPACES.       01670000
016800     05  FILLER                  PIC  X(49)   VALUE SPACES.       01680000
016900                                                                  01690000
017000 01  DEPT-HEADER.                                                 01700000
017100     05  FILLER                  PIC  X(07)    VALUE 'DEPT:  '.   01710000
017200     05  DH-DEPT                 PIC  X(03)    VALUE SPACES.      01720000
017300     05  FILLER                  PIC  X(122)   VALUE SPACES.      01730000
017400                                                                  01740000
017500 01  HDR-LINE4.                                                   01750000
017600     05  FILLER                  PIC  X(33)    VALUE SPACES.      01760000
017700     05  FILLER                  PIC  X(06)    VALUE 'VENDOR'.    01770000
017800     05  FILLER                  PIC  X(11)    VALUE SPACES.      01780000
017900     05  FILLER                  PIC  X(02)    VALUE 'PO'.        01790000
018000     05  FILLER                  PIC  X(40)    VALUE SPACES.      01800000
018100     05  FILLER                  PIC  X(40)    VALUE              01810000
018200         'VERIFIED    UNJOURNALIZED  UNJOURNALIZED'.              01820000
018300                                                                  01830000
018400 01  HDR-LINE5.                                                   01840000
018500     05  FILLER                  PIC  X(11)    VALUE              01850000
018600         'VENDOR NAME'.                                           01860000
018700     05  FILLER                  PIC  X(22)    VALUE SPACES.      01870000
018800     05  FILLER                  PIC  X(35)    VALUE              01880000
018900         'NUMBER         NUMBER       PO COST'.                   01890000
019000     05  FILLER                  PIC  X(06)    VALUE SPACES.      01900000
019100     05  FILLER                  PIC  X(38)    VALUE              01910000
019200         'VERIFIED COST   EXCEPTN AMT        NIR'.                01920000
019300     05  FILLER                  PIC  X(09)    VALUE SPACES.      01930000
019400     05  FILLER                  PIC  X(11)    VALUE              01940000
019500         'RECEIVERS  '.                                           01950000
019600                                                                  01960000
019700 01  HDR-LINE6.                                                   01970000
019800     05  FILLER                  PIC  X(49)    VALUE              01980000
019900         '------------------------------  ---------      --'.     01990000
020000     05  FILLER                  PIC  X(41)    VALUE              02000000
020100         '-------  --------------  --------------  '.             02010000
020200     05  FILLER                  PIC  X(42)    VALUE              02020000
020300         '------------  -------------  -------------'.            02030000
020400                                                                  02040000
020500 01  DETAIL-LINE                 PIC  X(132)   VALUE SPACES.      02050000
020600                                                                  02060000
020700 01  PO-DETAIL-LINE              REDEFINES  DETAIL-LINE.          02070000
020800     05  PDL-VENDOR-NAME         PIC  X(30).                      02080000
020900     05  FILLER                  PIC  X(02).                      02090000
021000     05  PDL-VENDOR-NUMBER       PIC  X(09).                      02100000
021100     05  FILLER                  PIC  X(03).                      02110000
021200     05  FILLER                  PIC  X(03).                      02120000
021300     05  PDL-PO-NBR              PIC  Z(09).                      02130000
021400     05  FILLER                  PIC  X(02).                      02140000
021500     05  PDL-PO-COST             PIC  ZZZ,ZZZ,ZZ9.99.             02150000
021600     05  FILLER                  PIC  X(02).                      02160000
021700     05  PDL-VERIFIED-COST       PIC  ZZZ,ZZZ,ZZ9.99.             02170000
021800     05  FILLER                  PIC  X(02).                      02180000
021900     05  PDL-VER-EXCEPT-AMT      PIC  Z,ZZZ,ZZ9.99-.              02190000
022000     05  FILLER                  PIC  X(01).                      02200000
022100     05  PDL-UNJRNLZD-NIR        PIC  ZZ,ZZZ,ZZ9.99.              02210000
022200     05  FILLER                  PIC  X(02).                      02220000
022300     05  PDL-UNJRNLZD-RECEIVERS  PIC  ZZ,ZZZ,ZZ9.99.              02230000
022400                                                                  02240000
022500 01  EOR-END-OF-REPORT.                                           02250000
022600     05  FILLER                  PIC  X(52)  VALUE SPACES.        02260000
022700     05  FILLER                  PIC  X(80)  VALUE                02270000
022800         '*****  END OF REPORT *****'.                            02280000
022900                                                                  02290000
023000 EJECT                                                            02300000
023100*  ABEND AREA                                                     02310000
023200                                                                  02320000
023300 01  ABEND-CODE                  PIC S9(04)  COMP  VALUE ZERO.    02330000
023400     88  AC-MISSING-DATE-REC                 VALUE +4001.         02340000
023500                                                                  02350000
023600 01  ABEND-AREAS.                                                 02360000
023700     05  AA-ABEND-LIT            PIC  X(40)  VALUE                02370000
023800             '*****       ABEND'.                                 02380000
023900     05  AA-PROGRAM-LIT          PIC  X(40)  VALUE                02390000
024000             '*****   PROGRAM: '.                                 02400000
024100     05  AA-PARAGRAPH-LIT        PIC  X(40)  VALUE                02410000
024200             '***** PARAGRAPH: '.                                 02420000
024300     05  AA-ABEND-OPERATION      PIC  X(50)  VALUE SPACES.        02430000
024400     05  AA-MESSAGE-LINE.                                         02440000
024500         10  FILLER              PIC  X(06)  VALUE '*****'.       02450000
024600         10  AA-MESSAGE          PIC  X(127) VALUE SPACES.        02460000
024700                                                                  02470000
024800 01  FILLER                      PIC  X(25)  VALUE                02480000
024900     '** END OF APKRP112 W/S **'.                                 02490000
025000                                                                  02500000
025100 EJECT                                                            02510000
025200 PROCEDURE DIVISION.                                              02520000
025300                                                                  02530000
025400***************************************************************** 02540000
025500*  MAIN PARAGRAPH                                                 02550000
025600***************************************************************** 02560000
025700 0000-MAIN.                                                       02570000
025800                                                                  02580000
025900     MOVE '0000-MAIN'            TO   PW-CURRENT-PARAGRAPH.       02590000
026000                                                                  02600000
026100     PERFORM 1000-BEGIN-PROGRAM.                                  02610000
026200                                                                  02620000
026300     PERFORM 2000-PROCESS-INPUT                                   02630000
026400         UNTIL END-OF-RECEIPT-RECS.                               02640000
026500                                                                  02650000
026600     PERFORM 3000-END-PROGRAM.                                    02660000
026700                                                                  02670000
026800     GOBACK.                                                      02680000
026900                                                                  02690000
027000 EJECT                                                            02700000
027100***************************************************************** 02710000
027200*  BEGIN PROGRAM STUFF                                            02720000
027300*                                                                 02730000
027400*  CALLED FROM 0000-MAIN                                          02740000
027500***************************************************************** 02750000
027600 1000-BEGIN-PROGRAM.                                              02760000
027700                                                                  02770000
027800     MOVE '1000-BEGIN-PROGRAM'   TO   PW-CURRENT-PARAGRAPH.       02780000
027900                                                                  02790000
028000     OPEN INPUT  UNJRNLZD-RECEIPT-DATA-FILE                       02800000
028100          INPUT  UNJRNLZD-RECEIPT-DATE-FILE                       02810000
028200          OUTPUT RPT01-FILE.                                      02820000
028300                                                                  02830000
028400     ACCEPT PW-CURRENT-DATE      FROM DATE.                       02840000
028500     MOVE PW-CURRENT-MONTH       TO   DP133O-RUN-MONTH.           02850000
028600     MOVE PW-CURRENT-DAY         TO   DP133O-RUN-DAY.             02860000
028700     MOVE PW-CURRENT-YEAR        TO   DP133O-RUN-YEAR.            02870000
028800                                                                  02880000
028900     ACCEPT PW-CURRENT-TIME      FROM TIME.                       02890000
029000     MOVE PW-CURRENT-HOUR        TO   DP133O-RUN-HOUR.            02900000
029100     MOVE PW-CURRENT-MINUTE      TO   DP133O-RUN-MINUTE.          02910000
029200                                                                  02920000
029300     MOVE PW-PROGRAM-NAME        TO   DP133O-PROGRAM-NAME.        02930000
029400     MOVE 1                      TO   DP133O-REPORT-NUMBER.       02940000
029500                                                                  02950000
029600     PERFORM 8100-READ-RECEIPT-DATE-FILE.                         02960000
029700                                                                  02970000
029800     MOVE AP108-START-DATE       TO   PW-START-DATE.              02980000
029900     MOVE PW-START-YEAR          TO   PR-START-YEAR.              02990000
030000     MOVE PW-START-MONTH         TO   PR-START-MONTH.             03000000
030100     MOVE PW-START-DAY           TO   PR-START-DAY.               03010000
030200     MOVE PR-START-DATE          TO   HL3-START-DATE.             03020000
030300                                                                  03030000
030400     MOVE AP108-END-DATE         TO   PW-END-DATE.                03040000
030500     MOVE PW-END-YEAR            TO   PR-END-YEAR.                03050000
030600     MOVE PW-END-MONTH           TO   PR-END-MONTH.               03060000
030700     MOVE PW-END-DAY             TO   PR-END-DAY.                 03070000
030800     MOVE PR-END-DATE            TO   HL3-END-DATE.               03080000
030900                                                                  03090000
031000     MOVE SPACE                  TO   DETAIL-LINE.                03100000
031100                                                                  03110000
031200     PERFORM 8000-READ-RECEIPT-DATA-FILE.                         03120000
031300                                                                  03130000
031400 EJECT                                                            03140000
031500***************************************************************** 03150000
031600*  MAIN PROGRAM LOOP, ENSURES WE WILL GET THE REPORT PRINTED      03160000
031700*  EVEN IF NO INPUT.                                              03170000
031800*                                                                 03180000
031900*  CALLED FROM 0000-MAIN                                          03190000
032000***************************************************************** 03200000
032100 2000-PROCESS-INPUT.                                              03210000
032200                                                                  03220000
032300     MOVE '2000-PROCESS-INPUT'   TO   PW-CURRENT-PARAGRAPH.       03230000
032400                                                                  03240000
032500*  PROCESS INPUT RECORD                                           03250000
032600                                                                  03260000
032700     MOVE AP107-VENDOR-NAME       TO  PDL-VENDOR-NAME.            03270000
032800     MOVE AP107-VENDOR-NUMBER     TO  PDL-VENDOR-NUMBER.          03280000
032900                                                                  03290000
033000     MOVE AP107-PO-NBR            TO  PDL-PO-NBR.                 03300000
033100     MOVE AP107-PO-COST           TO  PDL-PO-COST.                03310000
033200     MOVE AP107-VERIFIED-COST     TO  PDL-VERIFIED-COST.          03320000
033300     MOVE AP107-VER-EXCEPTION-AMT TO  PDL-VER-EXCEPT-AMT.         03330000
033400     MOVE AP107-UNJRNLZD-NIR      TO  PDL-UNJRNLZD-NIR.           03340000
033500     MOVE AP107-UNJRNLZD-RECEIVER TO  PDL-UNJRNLZD-RECEIVERS.     03350000
033600                                                                  03360000
033700*  WRITE REPORT & CLEAR DETAIL                                    03370000
033800                                                                  03380000
033900     PERFORM 9100-WRITE-DETAIL.                                   03390000
034000                                                                  03400000
034100     MOVE SPACE                  TO   DETAIL-LINE.                03410000
034200     MOVE 1                      TO   PR-DETAIL-CC.               03420000
034300                                                                  03430000
034400     PERFORM 8000-READ-RECEIPT-DATA-FILE.                         03440000
034500                                                                  03450000
034600 EJECT                                                            03460000
034700***************************************************************** 03470000
034800*                                                                 03480000
034900*  CALLED FROM 0000-MAIN                                          03490000
035000***************************************************************** 03500000
035100 3000-END-PROGRAM.                                                03510000
035200                                                                  03520000
035300     MOVE '3000-END-PROGRAM'     TO   PW-CURRENT-PARAGRAPH.       03530000
035400                                                                  03540000
035500     PERFORM 9300-WRITE-END-OF-RPT.                               03550000
035600                                                                  03560000
035700     CLOSE       UNJRNLZD-RECEIPT-DATA-FILE                       03570000
035800                 UNJRNLZD-RECEIPT-DATE-FILE                       03580000
035900                 RPT01-FILE.                                      03590000
036000                                                                  03600000
036100 EJECT                                                            03610000
036200***************************************************************** 03620000
036300*  THIS ROUTINE READS THE REPORT DATA FILE FROM APKUT107          03630000
036400*                                                                 03640000
036500*  CALLED FROM 1000-BEGIN-PROGRAM                                 03650000
036600*  CALLED FROM 2000-PROCESS-INPUT                                 03660000
036700***************************************************************** 03670000
036800 8000-READ-RECEIPT-DATA-FILE.                                     03680000
036900                                                                  03690000
037000     MOVE '8000-READ-RECEIPT-DATA-FILE'                           03700000
037100                                 TO   PW-CURRENT-PARAGRAPH.       03710000
037200                                                                  03720000
037300     READ UNJRNLZD-RECEIPT-DATA-FILE INTO AP107-RECORD            03730000
037400         AT END                                                   03740000
037500             SET END-OF-RECEIPT-RECS TO TRUE.                     03750000
037600                                                                  03760000
037700 EJECT                                                            03770000
037800***************************************************************** 03780000
037900*  THIS ROUTINE READS THE REPORT DATE FILE FROM APKUT106          03790000
038000*                                                                 03800000
038100*  CALLED FROM 1000-BEGIN-PROGRAM                                 03810000
038200***************************************************************** 03820000
038300 8100-READ-RECEIPT-DATE-FILE.                                     03830000
038400                                                                  03840000
038500     MOVE '8100-READ-RECEIPT-DATE-FILE'                           03850000
038600                                 TO   PW-CURRENT-PARAGRAPH.       03860000
038700                                                                  03870000
038800     READ UNJRNLZD-RECEIPT-DATE-FILE INTO AP108-RECORD            03880000
038900         AT END                                                   03890000
039000             MOVE 'EMPTY UNJOURNALIZED RECEIPT DATES FILE'        03900000
039100                                         TO AA-MESSAGE            03910000
039200             SET AC-MISSING-DATE-REC     TO TRUE                  03920000
039300             PERFORM 9999-ABEND.                                  03930000
039400                                                                  03940000
039500 EJECT                                                            03950000
039600***************************************************************** 03960000
039700*  THIS IS THE ACTUAL WRITE TO THE REPORT FILE.  IT USES PR-CC    03970000
039800*  TO DETERMINE THE HORIZONTAL SPACING.                           03980000
039900*                                                                 03990000
040000*  CALLED FROM 9100-WRITE-DETAIL                                  04000000
040100*  CALLED FROM 9200-WRITE-HEADING                                 04010000
040200***************************************************************** 04020000
040300 9000-WRITE-REPORT.                                               04030000
040400                                                                  04040000
040500     MOVE '9000-WRITE-REPORT'    TO   PW-CURRENT-PARAGRAPH.       04050000
040600                                                                  04060000
040700     IF PR-CC = 0                                                 04070000
040800         MOVE 1                  TO   PR-CC                       04080000
040900         WRITE RPT01-RECORD FROM PR-LINE                          04090000
041000             AFTER ADVANCING PAGE                                 04100000
041100     ELSE                                                         04110000
041200         WRITE RPT01-RECORD FROM PR-LINE                          04120000
041300             AFTER ADVANCING PR-CC                                04130000
041400     END-IF.                                                      04140000
041500                                                                  04150000
041600*  BUMP LINE COUNT                                                04160000
041700                                                                  04170000
041800     ADD PR-CC                   TO   PR-LINE-COUNT.              04180000
041900                                                                  04190000
042000 EJECT                                                            04200000
042100***************************************************************** 04210000
042200*  REPORT DETAIL FOR EACH OF THE REPORTS.  THIS ROUTINE CHECKS    04220000
042300*  FOR PAGE OVERFLOW AND PERFORMS A HEADING ROUTINE IF NECESSARY  04230000
042400*                                                                 04240000
042500***************************************************************** 04250000
042600 9100-WRITE-DETAIL.                                               04260000
042700                                                                  04270000
042800     MOVE '9100-WRITE-DETAIL'    TO   PW-CURRENT-PARAGRAPH.       04280000
042900                                                                  04290000
043000*  CHECK FOR PAGE OVERFLOW.                                       04300000
043100*                                                                 04310000
043200                                                                  04320000
043300     IF ((PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES)           04330000
043400       OR (AP107-DEPT NOT = DH-DEPT)                              04340000
043500         PERFORM 9200-WRITE-HEADING                               04350000
043600         MOVE 1                  TO   PR-DETAIL-CC                04360000
043700     END-IF.                                                      04370000
043800                                                                  04380000
043900*  MOVE TO PRINT AREA & WRITE REPORT LINE                         04390000
044000                                                                  04400000
044100     MOVE PR-DETAIL-CC           TO   PR-CC.                      04410000
044200     MOVE DETAIL-LINE            TO   PR-LINE.                    04420000
044300     PERFORM 9000-WRITE-REPORT.                                   04430000
044400                                                                  04440000
044500 EJECT                                                            04450000
044600***************************************************************** 04460000
044700*  REPORT AND COLUMN HEADINGS                                     04470000
044800*                                                                 04480000
044900*  CALLED FROM 9100-WRITE-DETAIL                                  04490000
045000***************************************************************** 04500000
045100 9200-WRITE-HEADING.                                              04510000
045200                                                                  04520000
045300     MOVE '9200-WRITE-HEADING'   TO   PW-CURRENT-PARAGRAPH.       04530000
045400                                                                  04540000
045500*  BUMP PAGE COUNT                                                04550000
045600                                                                  04560000
045700     ADD 1                       TO   PR-PAGE-COUNT.              04570000
045800     MOVE PR-PAGE-COUNT          TO   DP133O-PAGE-NUMBER.         04580000
045900                                                                  04590000
046000*  CLEAR LINE COUNT                                               04600000
046100                                                                  04610000
046200     MOVE 0                      TO   PR-LINE-COUNT.              04620000
046300                                                                  04630000
046400*  HEADING LINE 1 (STANDARD)                                      04640000
046500                                                                  04650000
046600     MOVE 0                      TO   PR-CC.                      04660000
046700     MOVE DP133O-STANDRD-HEADER-133-COLS                          04670000
046800                                 TO   PR-LINE.                    04680000
046900     PERFORM 9000-WRITE-REPORT.                                   04690000
047000                                                                  04700000
047100*  HEADING LINE 2 (REPORT TITLE)                                  04710000
047200                                                                  04720000
047300     MOVE 1                      TO   PR-CC.                      04730000
047400     MOVE HDR-LINE2              TO   PR-LINE.                    04740000
047500     PERFORM 9000-WRITE-REPORT.                                   04750000
047600                                                                  04760000
047700*  HEADING LINE 3 (REPORT DATES)                                  04770000
047800                                                                  04780000
047900     MOVE 1                      TO   PR-CC.                      04790000
048000     MOVE HDR-LINE3              TO   PR-LINE.                    04800000
048100     PERFORM 9000-WRITE-REPORT.                                   04810000
048200                                                                  04820000
048300*  DEPT HEADING                                                   04830000
048400                                                                  04840000
048500     MOVE 1                      TO   PR-CC.                      04850000
048600     MOVE AP107-DEPT             TO   DH-DEPT.                    04860000
048700     MOVE DEPT-HEADER            TO   PR-LINE.                    04870000
048800     PERFORM 9000-WRITE-REPORT.                                   04880000
048900                                                                  04890000
049000*  HEADING LINE 4 - 6 (DETAIL LINES HEADING)                      04900000
049100                                                                  04910000
049200     MOVE 2                      TO   PR-CC.                      04920000
049300     MOVE HDR-LINE4              TO   PR-LINE.                    04930000
049400     PERFORM 9000-WRITE-REPORT.                                   04940000
049500                                                                  04950000
049600     MOVE 1                      TO   PR-CC.                      04960000
049700     MOVE HDR-LINE5              TO   PR-LINE.                    04970000
049800     PERFORM 9000-WRITE-REPORT.                                   04980000
049900                                                                  04990000
050000     MOVE 1                      TO   PR-CC.                      05000000
050100     MOVE HDR-LINE6              TO   PR-LINE.                    05010000
050200     PERFORM 9000-WRITE-REPORT.                                   05020000
050300                                                                  05030000
050400 EJECT                                                            05040000
050500***************************************************************** 05050000
050600*  END OF REPORT LINES FOR THE REPORT                             05060000
050700*                                                                 05070000
050800*  CALLED FROM 3000-END-PROGRAM                                   05080000
050900***************************************************************** 05090000
051000 9300-WRITE-END-OF-RPT.                                           05100000
051100                                                                  05110000
051200     MOVE '9300-WRITE-END-OF-RPT' TO PW-CURRENT-PARAGRAPH.        05120000
051300                                                                  05130000
051400*  DO HEADING IF NOT DONE YET                                     05140000
051500                                                                  05150000
051600     IF (PR-DETAIL-CC + PR-LINE-COUNT) > PR-MAX-LINES             05160000
051700         PERFORM 9200-WRITE-HEADING                               05170000
051800     END-IF.                                                      05180000
051900                                                                  05190000
052000*  END OF REPORT LITERAL                                          05200000
052100                                                                  05210000
052200     MOVE 2                      TO   PR-CC.                      05220000
052300     MOVE EOR-END-OF-REPORT      TO   PR-LINE.                    05230000
052400     PERFORM 9000-WRITE-REPORT.                                   05240000
052500                                                                  05250000
052600 EJECT                                                            05260000
052700***************************************************************** 05270000
052800*  ABEND ROUTINE                                                  05280000
052900***************************************************************** 05290000
053000 9999-ABEND.                                                      05300000
053100                                                                  05310000
053200     DISPLAY '*** PROGRAM   = ' PW-PROGRAM-NAME.                  05320000
053300     DISPLAY '*** PARAGRAPH = ' PW-CURRENT-PARAGRAPH.             05330000
053400     DISPLAY '*** MESSAGE   = ' AA-MESSAGE-LINE.                  05340000
053500                                                                  05350000
053600     CALL 'ILBOABN0'            USING ABEND-CODE.                 05360000
053700                                                                  05370000
