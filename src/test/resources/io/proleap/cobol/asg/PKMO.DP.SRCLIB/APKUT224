000100 IDENTIFICATION DIVISION.                                         00010017
000200 PROGRAM-ID.     APKUT224.                                        00020017
000300 AUTHOR.         KEVIN CATLIN.                                    00030017
000400 DATE-WRITTEN.   SEPTEMBER, 2001.                                 00040017
000500*----------------------------------------------------------------*00050017
000600*             AUDIT EDI IMPORT LANDED COST INVOICES              *00060017
000700*----------------------------------------------------------------*00070017
000800*    COBOL 2 WITH SQL                                            *00080017
000900*----------------------------------------------------------------*00090017
001000*                                                                *00100017
001100*    THE PURPOSE OF THIS PROGRAM IS TO AUDIT THE FILE OF         *00110017
001200*    INVOICES THAT HAVE PASSED THE EDITS IN THE EDIT PROGRAM     *00120017
001300*    APKUT220 TO ENSURE THAT THEY ARE NOT DUPLICATES.  A         *00130017
001400*    LIMITED GROUP OF THE VARIOUS CHARGE TYPES WILL ALSO BE      *00140017
001500*    AUDITED TO ENSURE THAT THE CHARGE AMOUNTS FALL WITHIN       *00150017
001600*    ACCEPTABLE LIMITS.  DUPLICATE INVOICES WILL BE REJECTED,    *00160017
001700*    A REPORT RECORD WILL BE CREATED, AND THE INVOICE WILL NOT   *00170017
001800*    BE WRITTEN TO THE INVOICE LOAD FILE.  INVOICES WITH A       *00180017
001900*    CHARGE AMOUNT OUTSIDE OF TOLERANCE WILL BE WRITTEN TO THE   *00190017
002000*    INVOICE LOAD FILE, BUT THE INVOICE WILL BE GIVEN A          *00200017
002100*    'PENDING' STATUS, WHICH WILL PREVENT THE INVOICE FROM       *00210017
002200*    BEING PAID UNTIL IT IS REVIEWED AND APPROVED.  REPORT       *00220017
002300*    RECORDS WILL ALSO BE WRITTEN FOR THE INVOICES IN PENDING    *00230017
002400*    STATUS -- THESE WILL BE REPORTED SEPARATELY FROM THE        *00240017
002500*    REJECTED INVOICES.                                          *00250017
002600*                                                                *00260017
002700*----------------------------------------------------------------*00270017
002800*                                                                *00280017
002900* DB2 TABLES:                              DCLGENS:              *00290017
003000*  1. AP-INVOICE TABLE                      TINVOIC              *00300017
003100*  2. AP-ADJUSTMENT JOURNAL TABLE           TADJRNL              *00310017
003200*  3. TR-PO TRACKING CONTAINER TRACKING     TIMCNTK              *00320017
003300*  4. TR-PO TRACKING CONTAINER PO           TIMCNPO              *00330017
003400*  5. EXPENSE INVOICE TABLE                 TEXINVC              *00340017
003401*  6. EXTERNAL ENTITY TABLE                 TEXTENT               00340117
003402*  7. ACCOUNTS PAYABLE CONTROL TABLE        TAPCNTL               00340217
003403*  8. VENDOR CAPABILITY RATE TYPE TABLE     TRT00048              00340317
003404*  9. IMPORT RATES TABLE                    TRT00050              00340417
003405* 10. VENDOR CAPABILITY TABLE               VNT00001              00340517
003406* 11. RATE TYPE HISTORY TABLE               TRT00049              00340617
003407*                                                                *00340717
003408* INPUT:                                                         *00340817
003409*                                                                *00340917
003410*  1. EDI IMPORT AUDIT FILE                 APRD019              *00341017
003420*                                                                *00342017
003430* OUTPUT:                                                        *00343017
003440*                                                                *00344017
003450*  1. IMPORT EXP INVOICE LOAD FILE          APRD016              *00345017
003460*  2. EDI IMPORT REJECT FILE                APRD018              *00346017
003470*  3. SURCHARGE REPORT FILE                 APRD079              *00347017
003480*                                                                *00348017
003490*----------------------------------------------------------------*00349017
003500* CHANGE LOG:                                                    *00350017
003600*   09/05/2001                                                   *00360017
003700*      INITIAL VERSION.                                          *00370017
003800*   MADE BY:  KEVIN CATLIN                   WR# 20530           *00380017
003900*                                                                *00390017
004000*   05/22/2002                                                   *00400017
004100*      INCREASED THE MAXIMUM CHARGE AMOUNT FOR 'ENT' CHARGE      *00410017
004200*      FROM $80 TO $90 IN PARA C200-.                            *00420017
004300*   MADE BY:  MIKE BESKE                     WR# 23743           *00430017
004400*                                                                *00440017
004500*   06/16/2002                                                   *00450017
004600*      ARK PO PROJECT PHASE 1.  RECOMPILE FROM PRODUCTION.       *00460017
004700*   MADE BY: KEVIN CATLIN                    WR# 23500           *00470017
004800*                                                                *00480017
004900*   06/17/2002                                                   *00490017
005000*      REMOVED TABLE TPAYREQ.  MODIFIED SQL ACCESSING TINVOIC    *00500017
005100*      TO USE NEW INDEXES: PO_NBR/INVC_ID OR INVC_ID/            *00510017
005200*      RMIT_VND_NBR.                                             *00520017
005300*   MADE BY: NANCY EILBES                    WR# 23500           *00530017
005400*                                                                *00540017
005500*   09/19/2002                                                   *00550017
005600*      INCREASED THE DRAYAGE AND DECONSOLIDATION CHARGES FOR LOS *00560017
005700*      ANGELES.                                                  *00570017
005800*   MADE BY:  MIKE BESKE                     WR# 23757           *00580017
005900*                                                                *00590017
006000*   10/30/2002                                                   *00600017
006100*      RECOMPILED PROGRAM TO PICK UP NEW VERSION OF COPYBOOK     *00610017
006200*      APWS010.                                                  *00620017
006300*   MADE BY:  L SCHALLHORN                   IR# PM00503558      *00630017
006400*                                                                *00640017
006500*   04/10/2003                                                   *00650017
006600*      ADDED -811 CHECK TO S300- PARAGRAPH TO ALLOW FOR EXIST-   *00660017
006700*      ENCE OF MORE THAN ONE ROW.                                *00670017
006800*   MADE BY:  MIKE BESKE                     IR# PM00539228      *00680017
006900*                                                                *00690017
007000*   DATE  05/22/2003                                             *00700017
007100*       CHANGE MADE:  EDI 210 HANDLING OF MIAMI DECONSOLIDATOR   *00710017
007200*       AND OVERSEAS CONSOLIDATOR.  ADD NEW ENTRY TO DRAYAGE     *00720017
007300*       RATES/DRAYAGE TABLE.  MODIFIED DECONSOL RATES/DECONSOL   *00730017
007400*       TABLE TO ADD A RATE BASIS CODE TO EACH ENTRY.  BASIS     *00740017
007500*       CODE WILL BE 'SKU' FOR ALL VENDORS EXCEPT HUDD, WHICH    *00750017
007600*       IS 'CTN'.  ADDED ADDITIONAL COMPUTATION FOR HUDD IN      *00760017
007700*       PARAGRAPH D200 TO DETERMINE DECONSOLIDATION CHARGES.     *00770017
007800*       MADE BY: KEVIN CATLIN            WR/IR #: WR24632        *00780017
007900*                                                                *00790017
008000*   DATE  07/01/2003                                             *00800017
008100*       CHANGE MADE:  CHANGE DRAYAGE RATE FOR GALE/TRIANGLE      *00810017
008200*       FROM $165.00 TO $157.50.                                 *00820017
008300*       MADE BY: KEVIN CATLIN            WR/IR #: WR25288        *00830017
008400*                                                                *00840017
008500*   DATE  07/31/2003                                             *00850017
008600*       CHANGE MADE:  EDI 210 HANDLING OF WEST COAST DECON-      *00860017
008700*       SOLIDATORS.  ADDED ADDITIONAL OUT FILE FOR REPORTING ON  *00870017
008800*       FUEL SURCHARGES.  ADDED VENDOR TO INTERNAL               *00880017
008900*       DECONSOLIDATION RATE TABLE.  ADDED NEW INTERNAL TABLE    *00890017
009000*       TO HANDLE RATES FOR DECONSOLIDATION SCAC CODES FOUND ON  *00900017
009100*       TRANSPORTATION TABLES FOR VALIDATION.  WHEN VALIDATING   *00910017
009200*       DRAYAGE FOR VENDORS THAT DRAY TO MORE THAN ONE LOCATION, *00920017
009300*       TABLES TIMCNPO AND TIMCNTK WILL BE CHECKED FOR           *00930017
009400*       DECONSOLIDATION SCAC.  IF FOUND, THIS SCAC WILL          *00940017
009500*       DETERMINE WHAT THE RATE SHOULD BE.  IF NOT FOUND, THE    *00950017
009600*       INVOICE WILL BE PUT IN PENDING REVIEW STATUS.  LOGIC FOR *00960017
009700*       THIS NEW VALIDATION WAS ADDED IN D100, D200, AND S400.   *00970017
009800*       ADDED COPYBOOK APRD079 FOR FUEL SURCHARGE REPORT.  FUEL  *00980017
009900*       SURCHARGE WILL BE EDITED SEPARATELY, WRITTEN TO NEW      *00990017
010000*       REPORT FILE, AND THEN ROLLED INTO DRAYAGE AMOUNT BEFORE  *01000017
010100*       WRITING OUT TO LOAD FILE.  FUEL SURCHARGE LOGIC ADDED    *01010017
010200*       IN B200, C200, E200, E300, AND W300.                     *01020017
010300*       MADE BY: KEVIN CATLIN         WR/IR #: WR24931/WR24933   *01030017
010400*                                                                *01040017
010500*   DATE  07/31/2003                                             *01050017
010600*       CHANGE MADE:  CHANGE DECONSOLIDATION RATE FOR NYK        *01060017
010700*       LOGISTICS DOMESTIC FROM $0.52/CARTON TO $0.51/CARTON.    *01070017
010800*       MADE BY: KEVIN CATLIN            WR/IR #: WR24931        *01080017
010900*                                                                *01090017
011000*   DATE  08/26/2003                                             *01100017
011100*       CHANGE MADE:  CHANGE LIMIT ON PO-INVC TABLE TO 2000 FROM *01110017
011200*       1000 DUE TO TABLE OVERFLOW.                              *01120017
011300*       MADE BY: L SCHALLHORN            WR/IR #: P000579832     *01130017
011400*                                                                *01140017
011500*   DATE  01/15/2004                                             *01150017
011600*       CHANGE MADE:  ADDED SECOND DECONSOLIDATION RATE TABLE    *01160017
011700*       TO HOLD RATES FOR PRE-LABELED CARTONS.  ADDED LOGIC      *01170017
011800*       IN D200 TO CHECK, BASED ON PO, WHICH RATE TABLE TO USE   *01180017
011900*       WHEN VALIDATING THE DECON RATE.  ADDED NEW PARAGRAPH TO  *01190017
012000*       DETERMINE IF THE PO BEING PROCESSED WAS LABELED OVERSEAS *01200017
012100*       OR BY THE DECONSOLIDATOR.                                *01210017
012200*       ALSO REMOVED IDS AND TRIANGLE NORTHWEST FROM THE DECON   *01220017
012300*       TABLES, AS WE NO LONGER DO BUSINESS WITH THESE VENDORS   *01230017
012400*       (000595330 AND 0092007796, RESPECTIVELY).                *01240017
012500*       ALSO CHANGED RATES FOR PACER TO DRAY GOODS TO NYK AND    *01250017
012600*       SBDC, INCREASING EACH BY $5.00.                          *01260017
012700*       MADE BY: NANCY EILBES            WR/IR #: WR26155        *01270017
012800*                                                                *01280017
012900*   DATE  04/14/2004                                             *01290017
013000*       CHANGE MADE:  ADDED PARAGRAPH D333-VALIDATE-DECONSOL     *01300017
013100*       AS A TEMPORARY OVERRIDE TO THE AUDITS IN D200.  THIS     *01310017
013200*       AUDIT WILL ACCEPT EITHER THE LABELED OR UNLABELED RATE   *01320017
013300*       WITHOUT CHECKING IF THE FACTORY IS CERTIFIED.  WHEN WE   *01330017
013400*       ARE READY TO RETURN TO THE ORIGINAL EDIT, THIS PARAGRAPH *01340017
013500*       CAN BE DELETED AND THE PERFORM CHANGED BACK TO D200.     *01350017
013600*       MADE BY: NANCY EILBES            WR/IR #: WR26155        *01360017
013700*                                                                *01370017
013800*   DATE  08/26/2004                                             *01380017
013900*       CHANGE MADE:  CHANGED THE DRAYAGE RATE FOR HUDD FROM     *01390017
014000*       180.00 TO 215.00.                                        *01400017
014100*       MADE BY: L SCHALLHORN            WR/IR #: WR27386        *01410017
014200*                                                                *01420017
014300*   DATE  04/22/2005                                             *01430017
014400*       CHANGE MADE:  CORRECTED CODE TO NOT ADD FUEL-SURCHG-TOT  *01440017
014500*       INTO ALL "DRA" CHARGE RECS PER PO/INVC.  IT WILL ONLY    *01450017
014600*       ADD THAT AMOUNT INTO THE FIRST "DRA" CHARGE REC.  PARA   *01460017
014700*       E200- WAS MODIFIED BY SETTING THE NO-FUEL-SURCHG TO TRUE *01470017
014800*       ONCE THE FUEL-SURCHG-TOT WAS ADDED TO THE FIRST "DRA".   *01480017
014900*       MADE BY: MIKE BESKE              WR/IR #: P000756697     *01490017
015000*                                                                *01500017
015100*   DATE  05/23/2005                                             *01510017
015200*       CHANGE MADE: ADDED THE VENDORS IDS/TRIANGLE MIAMI,       *01520017
015300*       (000595330), AMERICAN PORT SERVICE (001019611), AND      *01530017
015400*       GALE TRIANGLE DALLAS (001025197) IN THE DRAYAGE-RATES,   *01540017
015500*       DECON-UNLABELED-RATES, AND DECON-LABELED-RATES TABLES    *01550017
015600*       ALONG WITH INCREASING THE SIZE OF THE TABLES FROM 5 TO   *01560017
015700*       10.  INCREASED THE DRAYAGE RATE FOR TRIANGLE TRANSPORT   *01570017
015800*       (009022104) AND GALE TRIANGLE (009068065).  INCREASED    *01580017
015900*       THE UNLABELED AND LABELED DECONSOLIDATION RATES FOR      *01590017
016000*       TRIANGLE TRANSPORT, GALE TRIANGLE, HUDD DISTRIBUTION,    *01600017
016100*       (000763425), AND NYK LOGISTICS (000786178).  EDITED THE  *01610017
016200*       PARAGRAPH E200- SO THAT THE CONTAINER ID IS MOVED TO     *01620017
016300*       THE AP016-IMPORT-BOL-ID FIELD BEFORE THE BILL OF LADING  *01630017
016400*       ID.                                                      *01640017
016500*       MADE BY: KRYSTEN LEARY           WR/IR #: WR28623        *01650017
016600*                                                                *01660017
016700*   DATE  06/14/2005                                             *01670017
016800*       CHANGE MADE: ADJUSTED THE LABELED AND UNLABELED          *01680017
016900*       DECONSOLIDATION RATES FOR NYK LOGISTICS (000786178).     *01690017
017000*       MADE BY: KRYSTEN LEARY           WR/IR #: WR28623        *01700017
017100*                                                                *01710017
017200*   DATE  06/23/2005                                             *01720017
017300*       CHANGE MADE: RESET IMCNTK-DCONSLR-SCAC-ID WHEN           *01730017
017400*       DECONS-SCAC-FND IS TRUE SO THAT VALID SCAC CODES PRINT   *01740017
017500*       ON THE 210 SURCHARGE REPORT. LINE 118300 WAS ADDED.      *01750017
017600*       MADE BY: BRONAUGH                WR/IR #: P00774182      *01760017
017700*                                                                *01770017
017800*   DATE  09/26/2005                                             *01780017
017900*       CHANGE MADE: CHANGED THE ENTRY RATE FEE ('ENT') FROM     *01790017
018000*       90.00 TO 84.00 IN PARAGRAPH C200-.                       *01800017
018100*       MADE BY: KRYSTEN LEARY           WR/IR #: WR29472        *01810017
018200*                                                                *01820017
018300*   DATE  09/29/2005                                             *01830017
018400*       CHANGE MADE: ADDED THE VENDOR HUDD WEST COAST            *01840017
018500*       (001027924) TO THE DRAYAGE-RATES, DECON-UNLABELED-RATES, *01850017
018600*       AND DECON-LABELED-RATES TABLES.                          *01860017
018700*       MADE BY: KRYSTEN LEARY           WR/IR #: WR29394        *01870017
018800*                                                                *01880017
018900*   DATE  07/20/2006                                             *01890017
019000*       CHANGE MADE: CHANGE 210 RATE FOR THE FOLLOWING VENDORS   *01900017
019100*       009068065, 001025197, 00786178,                          *01910017
019200*       MADE BY: GREG WISIALOWSKI        WR/IR #: WR30437        *01920017
019300*                                                                *01930017
019400*   DATE  08/28/2006                                             *01940017
019500*       CHANGE MADE: ADDED THE VENDOR GILBERT COMPANY            *01950017
019600*       (001035244) TO THE DRAYAGE-RATE, DECON-UNLABELED-RATES   *01960017
019700*       AND DECON-LABELED-RATES TABLES.                          *01970017
019800*       MADE BY: KRYSTEN LEARY           WR/IR #: WR31042        *01980017
019900*                                                                *01990017
020000*   DATE  08/28/2006                                             *02000017
020100*       CHANGE MADE: ADDED THE VENDOR GALE TRIANGE - MIAMI       *02010017
020200*       (001035274) TO THE DRAYAGE-RATES, DECON-UNLABELED-RATES  *02020017
020300*       AND DECON-LABELED-RATES TABLES.                          *02030017
020400*       MADE BY: KRYSTEN LEARY           WR/IR #: WR30888        *02040017
020500*                                                                *02050017
020600*   DATE  01/12/2007                                             *02060017
020700*       CHANGE MADE: ADDED THE VENDOR UPS SUPPLY CHAIN SOLUTIONS *02070017
020800*       (001037111) TO THE DRAYAGE-RATES TABLE.                  *02080017
020900*       MADE BY: KRYSTEN LEARY           WR/IR #: WR31470        *02090017
021000*                                                                *02100017
021100*   DATE  01/12/2007                                             *02110017
021200*       CHANGE MADE: ADDED THE VENDOR CALIFORNIA INTERMODAL      *02120017
021300*       ASSOCIATES (001037782) TO THE DRAYAGE-RATES TABLE.       *02130017
021400*       ALSO INCREASED THE SIZE OF THE TABLE FROM 10 TO 15.      *02140017
021500*       REMOVED ALL CODE RELATING TO PACER GLOBAL LOGISTICS      *02150017
021600*       (000750349) SINCE UPS SUPPLY CHAIN SOLUTIONS AND         *02160017
021700*       CALIFORNIA INTERMODAL ASSOCIASTES ARE REPLACING PACER.   *02170017
021800*       SUCH CODE INCLUDED PARAGRAPHS D200-VALIDATE-DRAY-PROV,   *02180017
021900*       S400-GET-DECONS-INFO, AND PORTIONS OF                    *02190017
022000*       E300-FORMAT-SURCHG-REC.                                  *02200017
022100*       MADE BY: KRYSTEN LEARY           WR/IR #: WR31469        *02210017
022200*                                                                *02220017
022300*   DATE  01/22/2007                                             *02230017
022400*       CHANGE MADE: ADDED THE VENDOR GALE TRIANGLE - SOUTH EAST *02240017
022500*       (001038202) TO THE DRAYAGE-RATES, DECON-UNLABELED-RATES, *02250017
022600*       AND DECON-LABELED-RATES TABLES.  ALSO INCREASED THE SIZE *02260017
022700*       OF THE DECON-UNLABELED-RATES AND DECON-LABELED-RATES     *02270017
022800*       TABLES FROM 10 TO 15.                                    *02280017
022900*       MADE BY: KRYSTEN LEARY           WR/IR #: WR31493        *02290017
023000*                                                                *02300017
023100*   DATE  02/14/2007                                             *02310017
023200*       CHANGE MADE:  CHANGE LIMIT ON PO-INVC TABLE TO 2000 FROM *02320017
023300*       5000 DUE TO TABLE OVERFLOW.  ADDED PC-PO-INVC-TBL-MAX TO *02330017
023400*       REPLACE THE HARDCODED LIMIT OF 2000.  THIS WILL AID IN   *02340017
023500*       ANY FUTURE INCREASES TO THE PO-INVC-TABLE.               *02350017
023600*       MADE BY: MIKE BESKE              WR/IR #: P000982838     *02360017
023700*                                                                *02370017
023800*   DATE  03/08/2007                                             *02380017
023900*       CHANGE MADE:  INCREASED THE UNLABELED DCON RATE FOR      *02390017
024000*       AMERICAN PORT SERVICE FROM .33 TO .38 PER CARTON.        *02400017
024100*       MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR32117        *02410017
024200*                                                                *02420017
024300*   DATE  03/08/2007                                             *02430017
024400*       CHANGE MADE:  CHANGED THE DRAYAGE RATE FOR GALE/TRIANGLE *02440017
024500*       FROM 198.00 TO 178.00.  DECREASED THE UNLABELED DCON     *02450017
024600*       RATE FOR GILBERT COMPANY FROM .65 TO .20 PER CARTON.     *02460017
024700*       MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR32208        *02470017
024800*                                                                *02480017
024900*   DATE  03/11/2007                                             *02490017
025000*       CHANGE MADE:  MBDC PROJECT - RECOMPILE                   *02500017
025100*       MADE BY: GREG WISIALOWSKI        WR/IR #: WR21578        *02510017
025200*                                                                *02520017
025300*   DATE  06/08/2007                                             *02530017
025400*       CHANGE MADE:  INCREASED DECON RATES FOR APS LABELED      *02540017
025500*                     FROM .28 TO .31 AND UNLABELED .31 TO .41   *02550017
025600*                     CHANGED VENDOR 001037111 TO 001029555      *02560017
025700*                     CHANGED ENTRY FEE FOR 84 TO 76             *02570017
025800*       MADE BY: GREG WISIALOWSKI        WR/IR #: WR32840        *02580017
025900*                                                                *02590017
026000*   DATE  01/31/2008                                             *02600017
026100*       CHANGE MADE:  DECREASED DECONSOLIDATION CHARGE PER       *02610017
026200*       CONTAINER FOR PT MIAMI (WHICH IS GALE TRIANGLE VENDOR    *02620017
026300*       001035274) AS FOLLOWS: LABELED FROM .37 TO .28 PER       *02630017
026400*       CARTON AND UNLABELED FROM .47 TO .38 PER CARTON.         *02640017
026500*       MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR34159        *02650017
026600*                                                                *02660017
026700*   DATE  01/31/2008                                             *02670017
026800*       CHANGE MADE: THE EXISTING CODE FOR PROCESSING A VENDOR   *02680017
026900*       AS A PROVIDER WITH NO LABELED NOR UNLABELED RATES WAS    *02690017
027000*       MODIFIED AS FOLLOWS:                                     *02700017
027100*          1) ADDED THE VENDOR TOTAL TRANSPORTATION SERVICES -   *02710017
027200*             (001051034) TO THE DRAY-SCAC-TABLE - SCAC = TTPV,  *02720017
027300*             SCAC RATE = 173.00                                 *02730017
027400*          2) UNCOMMENTED EXISTING CODE TO PROCESS THE           *02740017
027500*             DRAYAGE PROVIDER                                   *02750017
027600*          3) COMMENTED OUT THE TWO SCAC (NLAI, SBD1) THAT       *02760017
027700*             ARE NOT NEEDED, BUT WERE NOT REMOVED PREVIOUSLY.   *02770017
027800*             THE ORIGINAL COMMENTING OUT OF THE EXISTING CODE   *02780017
027900*             HAD PREVENTED THEM FROM BEING PROCESSED. NOW       *02790017
028000*             THAT THE TABLE WILL ONCE AGAIN BE USED, THESE      *02800017
028100*             TWO NEED TO BE KEPT FROM BEING REFERENCED.         *02810017
028200*          4) MODIFIED DRAY-SCAC-ENTRIES TO 1 OCCURENCE.         *02820017
028300*       MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR33727        *02830017
028400*                                                                *02840017
028500*   DATE  04/03/2008                                             *02850017
028600*       CHANGE MADE:  DECREASED THE DRAYAGE RATE FOR             *02860017
028700*       CALIFORNIA INTERMODAL ASSOCIATES (001037782) FROM        *02870017
028800*       $160.00 TO $156.00.                                      *02880017
028900*       INCREASED DRAYAGE RATE FOR GALE/TRIANGLE (009068065)     *02890017
029000*       FROM $178.00 TO $213.00.                                 *02900017
029100*       MADE BY: MICHELE RINDFLEISCH     WR/IR #: WR34257        *02910017
029200*                                                                *02920017
029300*   DATE  06/03/2008                                             *02930017
029400*       CHANGE MADE:  INCREASED DECON RATES FOR GALE MIAMI       *02940017
029500*                     FROM .28 TO .285                           *02950017
029600*       MADE BY: GREG WISIALOWSKI        WR/IR #: WR34822        *02960017
029700*                                                                *02970017
029800*   DATE  06/13/2008                                             *02980017
029900*       CHANGE MADE:  ADD TEXINVC TO CHECK FOR DUPE PO/CONTAIN   *02990017
030000*                     AND REPORT ERROR IF FOUND                  *03000017
030100*       MADE BY: GREG WISIALOWSKI        WR/IR #: WR33680        *03010017
030200*                                                                *03020017
030300*   DATE  10/21/2008                                             *03030017
030400*       CHANGE MADE:  ADD SOUTHERN COUNTIES EXPRESS (001053905)  *03040017
030500*                     TO DRAYAGE COMPONENT                       *03050017
030600*          1) ADDED THE VENDOR SOUTHERN COUNTIES EXPRESS     -   *03060017
030700*             (001053905) TO THE DRAY-SCAC-TABLE - SCAC = NALI,  *03070017
030800*             SCAC RATE = 207.00                                 *03080017
030900*                            THE DRAY-SCAC-TABLE - SCAC = GLTN,  *03090017
031000*             SCAC RATE = 225.00                                 *03100017
031100*          2) MODIFIED DRAY-SCAC-ENTRIES TO 3 OCCURENCE.         *03110017
031200*       MADE BY: GREG WISIALOWSKI        WR/IR #: WR34923        *03120017
031300*                                                                *03130017
031400*   DATE  11/11/2008                                             *03140017
031500*       CHANGE MADE:  CHANGED SCAC CODE FROM NALI TO NLAI        *03150017
031600*       MADE BY: GREG WISIALOWSKI    WR/IR #: INC000000592879    *03160017
031700*                                                                *03170017
031800*   DATE  01/19/2009                                             *03180017
031900*       CHANGE MADE:  CHANGED DECONSOLIDATION RATES FOR GALE     *03190017
032000*       TRIANGLE MIAMI (001035274).                              *03200017
032100*       MADE BY: NANCY EILBES        WR/IR #: WR35844            *03210017
032200*                                                                *03220017
032300*   DATE  03/16/2009                                             *03230017
032400*       CHANGE MADE:  ADD TEXINVC TO CHECK FOR DUPLICATE         *03240017
032500*       PO/CONTAINER AND REPORT ERROR IF FOUND.  CHANGED         *03250017
032600*       PARAGRAPH B200 AND ADDED PARAGRAPH S600 FOR THIS CHECK.  *03260017
032700*       MADE BY: KEVIN CATLIN            WR/IR #: WR33680        *03270017
032800*                                                                *03280017
032900*   DATE  03/16/2009                                             *03290017
033000*       CHANGE MADE:  MODIFY PROGRAM TO ALLOW FOR THREE          *03300017
033100*       DECONSOLIDATION RATES, THREE DRAYAGE RATES, AND THREE    *03310017
033200*       DRAY SCAC RATES.  CONSOLIDATED INTERNAL TABLES TO ONE    *03320017
033300*       FOR DECONSOLIDATION, ONE FOR DRAYAGE, AND ONE FOR DRAY   *03330017
033400*       SCAC.  REMOVED TABLES TEXTENT, TPURCHS, AND TPLNSHP AS   *03340017
033500*       THEY ARE NOT NEEDED.  REMOVED PARAGRAPH D333 AND S500    *03350017
033600*       AND ANY REFERENCES WITHIN THE PROGRAM.  MODIFIED         *03360017
033700*       VALIDATION PARAGRAPHS D100, D200, AND D200 TO ACCOUNT    *03370017
033800*       FOR CONSOLIDATION OF INTERNAL TABLES.                    *03380017
033900*       MADE BY: KEVIN CATLIN            WR/IR #: WR35487        *03390017
034000*                                                                *03400017
034100*  DATE  03/17/2009                                              *03410017
034200*     CHANGE MADE:  MODIFIED CHECK FOR DUPLICATE PO/CONTAINER TO *03420017
034300*     ALSO INCLUDE THE VENDOR ID - INVOICES WERE REJECTING FOR   *03430017
034400*     DECONSOLIDATION VENDORS WHERE THE DRAYAGE IS INVOICED BY   *03440017
034500*     A SEPARATE DRAYAGE-ONLY PROVIDER.                          *03450017
034600*     MADE BY: NANCY EILBES            WR/IR #: INC000000739121  *03460017
034700*                                                                *03470017
034800*  DATE  05/18/2009                                              *03480017
034900*      CHANGE MADE:  MODIFIED DECONSOLIDATION RATES FOR GALE/    *03490017
035000*      TRIANGLE AND NYK LOGISTICS.  MODIFIED DRAYAGE RATES FOR   *03500017
035100*      SOUTHERN COUNTIES FOR BOTH SCAC CODES THEY SERVICE.       *03510017
035200*      MADE BY: NANCY EILBES            WR/IR #: WR36320         *03520017
035300*                                                                *03530017
035400*  DATE  06/05/2009                                              *03540017
035500*      CHANGE MADE:  MODIFIED ENTRY FEE RATE FROM $76 TO $88.50. *03550017
035600*      MADE BY: NANCY EILBES            WR/IR #: WR36763         *03560017
035700*                                                                *03570017
035800*  DATE  07/13/2009                                              *03580017
035900*      CHANGE MADE:  MODIFIED DECONSOLIDATION AND DRAYAGE RATES  *03590017
036000*      FOR GILBERT COMPANY.                                      *03600017
036100*      MADE BY: NANCY EILBES            WR/IR #: WR36815         *03610017
036200*                                                                *03620017
036300*  DATE  07/27/2009                                              *03630017
036400*      CHANGE MADE:  MODIFIED DECONSOLIDATION RATE 1 ONLY FOR    *03640017
036500*      VENDOR 001035274 PERFORMANCE TEAM-MIAMI.                  *03650017
036600*      MADE BY: NANCY EILBES            WR/IR #: WR37050         *03660017
036700*                                                                 03670017
036800*  DATE  10/20/2009                                              *03680017
036900*      CHANGE MADE:  RECOMPILE FOR 310 EDI PROJECT.              *03690017
037000*      COPYBOOK APRD016 WENT FROM 335 TO 361 BYTES.              *03700017
037100*      MADE BY: PAUL STROEDE            WR/IR #: WR23145         *03710017
037200*                                                                *03720017
037300*  DATE  10/26/2009                                              *03730017
037400*      CHANGE MADE:  MODIFIED DECONSOLIDATION RATES FOR GALE/    *03740017
037500*      TRIANGLE AND NYK LOGISTICS.  MODIFIED DRAYAGE RATES FOR   *03750017
037600*      SOUTHERN COUNTIES FOR BOTH SCAC CODES THEY SERVICE.       *03760017
037700*      MADE BY: MIKE BESKE              WR/IR #: WR37540         *03770017
037800*                                                                 03780017
037900*  DATE  01/12/2010                                              *03790017
038000*      CHANGE MADE:  REMOVED HARDCODING FOR VENDOR RATES.        *03800017
038100*      IMPLEMENTED RATE LOOKUPS USING NEW LOGISTICS RATES TABLES.*03810017
038200*      MADE BY: PAUL STROEDE            WR/IR #: WR23145         *03820017
038300*                                                                *03830017
038400*  DATE  01/18/2010                                              *03840017
038500*      CHANGE MADE:  UPDATED CODE IN PARAGRAPH D100 TO LOOK UP   *03850017
038600*      THE VENDOR SCAC FROM TEXTENT WHEN THE IMCNTK-DECON-SCAC   *03860017
038700*      EQUALS SPACES.                                            *03870017
038800*      MADE BY: PAUL STROEDE            WR/IR #: INC000001115974 *03880017
038900*                                                                *03890017
038910*  DATE  05/25/2010                                              *03891017
038920*      CHANGE MADE:  RECOMPILE FOR CHANGES TO APWS010 COPYBOOK   *03892017
038930*      MADE BY: PAUL STROEDE            WR/IR #: PKE000000003991 *03893017
038940*                                                                *03894017
038950*  DATE  09/30/2010                                              *03895017
038960*      CHANGE MADE:  MODIFIED WHERE CONDITION IN SELECT OF RATES *03896017
038970*      FOR EXPEDITORS, PARAGRAPH S950.  REPLACED CHECK OF END    *03897017
038980*      DATE NOT NULL OR WITHIN THE PAST YEAR WITH A CHECK FOR    *03898017
038990*      THE INVOICE DATE BEING BETWEEN THE BEGIN AND END DATES.   *03899017
039000*      MADE BY: NANCY EILBES            WR/IR #: INC000001417304 *03900017
039001*                                                                *03900117
039002*  DATE  04/23/2013                                              *03900217
039003*      CHANGE MADE:  MODIFIED DUPLICATE CHECK ON TADJRNL TO USE  *03900317
039004*      A 'LIKE' CONDITION ON THE INVOICE ID RATHER THAN AN EQUAL *03900417
039005*      CONDITION, AND ADDED PO NBR AND INVOICE DATE AS CRITERIA  *03900517
039006*      AS WELL.  THE PROGRAM THAT CONVERTS THE LOAD FROM AN      *03900617
039007*      INVOICE TO AN ADJUSTMENT ADDS A SUFFIX TO INVOICE ID      *03900717
039008*      SO THIS LOOKUP WAS NO LONGER FINDING A MATCH WHEN IT      *03900817
039009*      SHOULD HAVE.                                              *03900917
039010*      MADE BY: NANCY EILBES            WR/IR #: CHG0052260      *03901017
039011*                                                                *03901117
039012*  DATE  07/06/2015                                               03901217
039013*      CHANGE MADE: UPDATED TO HANDLE THE NEW MPF MANAGEMENT FEE *03901317
039014*      FOR GROUPED PO INVOICES WITH CHARGE CODE AS 'BSS'.        *03901417
039015*      MADE BY: MEENAKSHI MITTAL        WR/IR #: CHG0112172      *03901517
039016*                                                                 03901617
039017*  DATE  10/21/2015                                              *03901717
039018*      CHANGE MADE:  RECOMPILE FOR CHANGES TO APRD018 COPYBOOK   *03901817
039019*      MADE BY: MEENAKSHI MITTAL        WR/IR #: CHG0126130      *03901917
039020*                                                                 03902017
039021*  DATE  06/07/2016                                              *03902117
039022*      CHANGE MADE:  REMOVED EXCESSIVE DISPLAYS                  *03902217
039023*      MADE BY: NANCY EILBES            WR/IR #: CHG0143455      *03902317
039024*                                                                *03902419
039025* DATE  11/02/2020                                               *03902519
039026*    CHANGE MADE: RECOMPILED TO INCLUDE CHANGES TO COPYBOOK      *03902619
039027*    APWS010.                                                    *03902719
039028*    MADE BY: NANCY EILBES            WR/IR #: CHG0250510        *03902819
039029*                                                                *03902917
039025* DATE  05/10/2023                                               *03903020
039026*    CHANGE MADE: RECOMPILED FOR UPDATED COPYBOOK APWS010        *03903120
039028*    MADE BY: JEAN KURK               WR/IR #: CHG0288104        *03903320
039030*----------------------------------------------------------------*03903417
039031                                                                  03903517
039032 ENVIRONMENT DIVISION.                                            03903617
039033 CONFIGURATION SECTION.                                           03903717
039034 SOURCE-COMPUTER.    IBM-3090.                                    03903817
039035 OBJECT-COMPUTER.    IBM-3090.                                    03903917
039036                                                                  03904017
039037 INPUT-OUTPUT SECTION.                                            03904117
039038 FILE-CONTROL.                                                    03904217
039039                                                                  03904317
039040     SELECT EDI-IMP-INVC-AUD-FILE       ASSIGN TO INP01.          03904417
039041     SELECT IMP-EXP-INVC-LOAD-FILE      ASSIGN TO OUT01.          03904517
039042     SELECT REJ-PEND-INVC-FILE          ASSIGN TO OUT02.          03904617
039043     SELECT SURCHG-RPT-FILE             ASSIGN TO OUT03.          03904717
039044                                                                  03904817
039045 DATA DIVISION.                                                   03904917
039050 FILE SECTION.                                                    03905017
039060                                                                  03906017
039070 FD  EDI-IMP-INVC-AUD-FILE                                        03907017
039080     RECORDING MODE IS F                                          03908017
039090     LABEL RECORDS ARE STANDARD                                   03909017
039100     BLOCK CONTAINS 0 RECORDS                                     03910017
039200     DATA RECORD IS EDI-IMP-INVC-AUD-REC.                         03920017
039300 01  EDI-IMP-INVC-AUD-REC        PIC  X(360).                     03930017
039400                                                                  03940017
039500 FD  IMP-EXP-INVC-LOAD-FILE                                       03950017
039600     RECORDING MODE IS F                                          03960017
039700     LABEL RECORDS ARE STANDARD                                   03970017
039800     BLOCK CONTAINS 0 RECORDS                                     03980017
039900     DATA RECORD IS IMP-EXP-INVC-LOAD-REC.                        03990017
040000 01  IMP-EXP-INVC-LOAD-REC       PIC  X(476).                     04000017
040100                                                                  04010017
040200 FD  REJ-PEND-INVC-FILE                                           04020017
040300     RECORDING MODE IS F                                          04030017
040400     LABEL RECORDS ARE STANDARD                                   04040017
040500     BLOCK CONTAINS 0 RECORDS                                     04050017
040600     DATA RECORD IS REJ-PEND-INVC-REC.                            04060017
040700 01  REJ-PEND-INVC-REC           PIC  X(750).                     04070017
040800                                                                  04080017
040900 FD  SURCHG-RPT-FILE                                              04090017
041000     RECORDING MODE IS F                                          04100017
041100     LABEL RECORDS ARE STANDARD                                   04110017
041200     BLOCK CONTAINS 0 RECORDS                                     04120017
041300     DATA RECORD IS SURCHG-RPT-REC.                               04130017
041400 01  SURCHG-RPT-REC              PIC  X(270).                     04140017
041500                                                                  04150017
041600 EJECT                                                            04160017
041700                                                                  04170017
041800 WORKING-STORAGE SECTION.                                         04180017
041900                                                                  04190017
042000 01  PROGRAM-CONSTANTS.                                           04200017
042100     05  PC-PROGRAM-NAME         PIC  X(08)     VALUE 'APKUT224'. 04210017
042200     05  PC-BEG-TMST             PIC  X(16)                       04220017
042300                                   VALUE '-00.00.00.000000'.      04230017
042400     05  PC-END-TMST             PIC  X(16)                       04240017
042500                                   VALUE '-23.59.59.999999'.      04250017
042600     05  PC-PERCENTS             PIC X(16)  VALUE ALL '%'.        04260017
042700                                                                  04270017
042800 01  PV-PROCESS-COUNTERS.                                         04280017
042900     05  PV-FILE-REC-COUNT       PIC  9(08)     VALUE ZEROS.      04290017
043000     05  PV-INVC-WRITTEN-COUNT   PIC  9(08)     VALUE ZEROS.      04300017
043100     05  PV-PEND-WRITTEN-COUNT   PIC  9(08)     VALUE ZEROS.      04310017
043200     05  PV-REJ-WRITTEN-COUNT    PIC  9(08)     VALUE ZEROS.      04320017
043300     05  PV-SURCHG-WRIT-COUNT    PIC  9(08)     VALUE ZEROS.      04330017
043400                                                                  04340017
043500 01  PV-INVC-DTE                 PIC X(10).                       04350017
043600 01  PV-INVC-DTE-RED REDEFINES PV-INVC-DTE.                       04360017
043700     05  PV-INVC-DTE-CC          PIC X(2).                        04370017
043800     05  PV-INVC-DTE-YY          PIC X(2).                        04380017
043900     05  PV-DASH-1               PIC X(1).                        04390017
044000     05  PV-INVC-DTE-MM          PIC X(2).                        04400017
044100     05  PV-DASH-2               PIC X(1).                        04410017
044200     05  PV-INVC-DTE-DD          PIC X(2).                        04420017
044300                                                                  04430017
044400 01  PROGRAM-SWITCHES.                                            04440017
044500     05  SW-END-OF-FILE          PIC  X         VALUE 'N'.        04450017
044600         88  NOT-END-OF-FILE                    VALUE 'N'.        04460017
044700         88  END-OF-FILE                        VALUE 'Y'.        04470017
044800     05  SW-RECORD-STATUS        PIC  X         VALUE 'N'.        04480017
044900         88  NORMAL-REC                         VALUE 'N'.        04490017
045000         88  PENDING-REC                        VALUE 'P'.        04500017
045100         88  REJECT-REC                         VALUE 'R'.        04510017
045200     05  SW-DECONS-SCAC          PIC  X         VALUE 'N'.        04520017
045300         88  DECONS-SCAC-NOT-FND                VALUE 'N'.        04530017
045400         88  DECONS-SCAC-FND                    VALUE 'Y'.        04540017
045500     05  SW-DRAY-SCAC-VERIFY     PIC  X         VALUE 'N'.        04550017
045600         88  DRAY-SCAC-NOT-VERIFIED             VALUE 'N'.        04560017
045700         88  DRAY-SCAC-VERIFIED                 VALUE 'Y'.        04570017
045800     05  SW-END-OF-RATE-CSR      PIC  X         VALUE 'N'.        04580017
045900         88  NOT-END-OF-RATE-CSR                VALUE 'N'.        04590017
046000         88  END-OF-RATE-CSR                    VALUE 'Y'.        04600017
046100     05  SW-FIRST-VENDOR         PIC  X         VALUE 'N'.        04610017
046200         88  NOT-FIRST-VENDOR                   VALUE 'N'.        04620017
046300         88  FIRST-VENDOR                       VALUE 'Y'.        04630017
046400     05  SW-RATE-FOUND           PIC  X         VALUE 'N'.        04640017
046500         88  RATE-NOT-FOUND                     VALUE 'N'.        04650017
046600         88  RATE-FOUND                         VALUE 'Y'.        04660017
046700     05  SW-SCAC-FOUND           PIC  X         VALUE 'N'.        04670017
046800         88  SCAC-NOT-FOUND                     VALUE 'N'.        04680017
046900         88  SCAC-FOUND                         VALUE 'Y'.        04690017
047000     05  PS-MPF-FEE-EXCEED-SW    PIC  X         VALUE ' '.        04700017
047100         88  PS-MPF-FEE-EXCEEDED                VALUE 'Y'.        04710017
047200                                                                  04720017
047210 01  SURCHG-SWITCHES.                                             04721017
047220     05  SW-FUEL-SURCHG          PIC  X         VALUE 'N'.        04722017
047230         88  NO-FUEL-SURCHG                     VALUE 'N'.        04723017
047240         88  FUEL-SURCHG-FND                    VALUE 'Y'.        04724017
047250     05  SW-SURCHG-REC           PIC  X         VALUE 'N'.        04725017
047260         88  NO-SURCHG-REC                      VALUE 'N'.        04726017
047270         88  SURCHG-REC                         VALUE 'Y'.        04727017
047280     05  SW-CONTNR-PU-DTE        PIC  X         VALUE 'N'.        04728017
047290         88  NO-CONTNR-PU-DTE-FND               VALUE 'N'.        04729017
047300         88  CONTNR-PU-DTE-FND                  VALUE 'Y'.        04730017
047400                                                                  04740017
047500 01  PROGRAM-EXCEEDED-SWITCHES.                                   04750017
047600     05  PS-ENTRY-FEE-EXCEED-SW      PIC X(01)  VALUE ' '.        04760017
047700         88  PS-ENTRY-EXCEEDED                  VALUE 'Y'.        04770017
047800     05  PS-EXAM-FEE-EXCEED-SW       PIC X(01)  VALUE ' '.        04780017
047900         88  PS-EXAM-EXCEEDED                   VALUE 'Y'.        04790017
048000     05  PS-MISC-FEE-EXCEED-SW       PIC X(01)  VALUE ' '.        04800017
048100         88  PS-MISC-EXCEEDED                   VALUE 'Y'.        04810017
048200     05  PS-REGULATORY-EXCEED-SW     PIC X(01)  VALUE ' '.        04820017
048300         88  PS-REGULATORY-EXCEEDED             VALUE 'Y'.        04830017
048400     05  PS-DRAYAGE-EXCEED-SW        PIC X(01)  VALUE ' '.        04840017
048500         88  PS-DRAYAGE-EXCEEDED                VALUE 'Y'.        04850017
048600     05  PS-DECONSOLID-EXCEED-SW     PIC X(01)  VALUE ' '.        04860017
048700         88  PS-DECONSOLID-EXCEEDED             VALUE 'Y'.        04870017
048800                                                                  04880017
048900 01  HOLD-FIELDS.                                                 04890017
049000     05  HOLD-VENDOR-NBR         PIC X(09)      VALUE SPACES.     04900017
049100     05  HOLD-INVOICE-ID         PIC X(22)      VALUE SPACES.     04910017
049200                                                                  04920017
049300 01  PROGRAM-VARIABLES.                                           04930017
049400     05  PV-DUMMY-NBR            PIC S9(9) COMP VALUE 0.          04940017
049500     05  PV-PO-NBR               PIC S9(9) COMP VALUE ZEROES.     04950017
049600     05  PV-VENDOR-NBR           PIC X(09)      VALUE SPACES.     04960017
049700         88 DRAYAGE-PROVIDER             VALUES '001051034'.      04970017
049800         88 DRAYAGE-PROVIDER-2           VALUES '001053905'.      04980017
049900****                              TOTAL TRANSPORTATION SERVICES   04990017
050000*        88 DRAYAGE-PROVIDER             VALUES '000750349'.      05000017
050100****                                     PACER GLOBAL LOGISTICS   05010017
050200     05  PV-ONE                  PIC X(01)      VALUE SPACES.     05020017
050300     05  PV-CONTNR-PU-DTE        PIC X(10)      VALUE SPACES.     05030017
050400     05  PV-DECON-NULL-IND       PIC S9(04)     COMP.             05040017
050500     05  PV-RATE-TYP-CDE         PIC X(04)      VALUE SPACES.     05050017
050600                                                                  05060017
050700 01  WORKING-VARIABLES.                                           05070017
050800     05  WS-HOLD-PRC-BEG-DTE     PIC X(26)      VALUE SPACES.     05080017
050900     05  WS-HOLD-PRC-END-DTE     PIC X(26)      VALUE SPACES.     05090017
051000     05  WS-FRMT-BEG-DTE         PIC X(08)      VALUE SPACES.     05100017
051100     05  WS-FRMT-END-DTE         PIC X(08)      VALUE SPACES.     05110017
051200     05  WS-INVC-FOR-LIKE-COND   PIC X(16)      VALUE SPACES.     05120017
051300     05  WS-ONE-YEAR-AGO-DTE     PIC X(26)      VALUE SPACES.     05130017
051400     05  WS-ONE-YEAR-AGO-TMST    REDEFINES WS-ONE-YEAR-AGO-DTE.   05140017
051410         10  WS-YEAR-AGO-DTE     PIC X(10).                       05141017
051420         10  WS-YEAR-AGO-TMST    PIC X(16).                       05142017
051430     05  WS-HOLD-TMST-BEG-DTE    PIC X(26).                       05143017
051431     05  WS-HOLD-BEG-DTE     REDEFINES WS-HOLD-TMST-BEG-DTE.      05143117
051432         10  WS-BEG-DTE-CCYY     PIC X(04).                       05143217
051433         10  FILLER              PIC X(01).                       05143317
051434         10  WS-BEG-DTE-MM       PIC X(02).                       05143417
051435         10  FILLER              PIC X(01).                       05143517
051436         10  WS-BEG-DTE-DD       PIC X(02).                       05143617
051437         10  FILLER              PIC X(16).                       05143717
051438     05  WS-HOLD-TMST-END-DTE    PIC X(26).                       05143817
051439     05  WS-HOLD-END-DTE     REDEFINES WS-HOLD-TMST-END-DTE.      05143917
051440         10  WS-END-DTE-CCYY     PIC X(04).                       05144017
051441         10  FILLER              PIC X(01).                       05144117
051442         10  WS-END-DTE-MM       PIC X(02).                       05144217
051443         10  FILLER              PIC X(01).                       05144317
051444         10  WS-END-DTE-DD       PIC X(02).                       05144417
051445         10  FILLER              PIC X(16).                       05144517
051446                                                                  05144617
051447*    05  WS-VENDOR-NBR           PIC X(09).                       05144717
051448                                                                  05144817
051449     05  WS-ERROR-CODE-AREA.                                      05144917
051450         10  WS-ERR-TABLE        OCCURS 10 TIMES                  05145017
051451                                   INDEXED BY WS-ERR-IDX.         05145117
051452             15  WS-ERR-CDE          PIC 9(02).                   05145217
051453                                                                  05145317
051454 01  CALC-FIELDS.                                                 05145417
051455     05  DRAY-PERCENT            PIC V99        VALUE .05.        05145517
051456***  05  DRAY-RESULT             PIC 9(4)V99    VALUE ZEROES.     05145617
051457     05  UPPER-DRAY-LIMIT        PIC 9(4)V99    VALUE ZEROES.     05145717
051458     05  LOWER-DRAY-LIMIT        PIC 9(4)V99    VALUE ZEROES.     05145817
051459***  05  DECONSOL-AMT            PIC 9(4)V99    VALUE ZEROES.     05145917
051460     05  EXPECTED-DECONSOL-RATE  PIC 9(5)V99    VALUE ZEROES.     05146017
051470     05  UPPER-DECON-LIMIT       PIC 9(5)V99    VALUE ZEROES.     05147017
051480     05  LOWER-DECON-LIMIT       PIC 9(5)V99    VALUE ZEROES.     05148017
051490     05  FUEL-SURCHG-TOT         PIC S9(07)V99  COMP-3 VALUE 0.   05149017
051500                                                                  05150017
051600 01  PC-PO-INVC-TBL-MAX          PIC S9(09) COMP SYNC             05160017
051700                                            VALUE +5000.          05170017
051800                                                                  05180017
051900 01  TABLE-AREA.                                                  05190017
052000     05  PO-INVC-TABLE.                                           05200017
052100         10  PO-INVC-ENTRIES   OCCURS 5000 TIMES                  05210017
052200                               INDEXED BY IDX1.                   05220017
052300             15  TBL-PO-NBR      PIC 9(09).                       05230017
052400             15  TBL-INVC-ID     PIC X(22).                       05240017
052500                                                                  05250017
052600     05  DRAYAGE-TABLE.                                           05260017
052700         10  DRAY-VENDORS     OCCURS 30 TIMES                     05270017
052800                              INDEXED BY IDX2.                    05280017
052900             15  TBL-DRAY-VND         PIC  X(9).                  05290017
053000             15  TBL-DRAY-SCAC        PIC  X(04).                 05300017
053100             15  DRAY-ENTRIES     OCCURS 30 TIMES                 05310017
053200                              INDEXED BY IDX2A.                   05320017
053300                 20  TBL-DRAY-POE-CDE        PIC  X(5).           05330017
053400                 20  TBL-DRAY-RATE           PIC  999V99.         05340017
053500                 20  TBL-DRAY-BEG-DTE        PIC  X(10).          05350017
053600                 20  TBL-DRAY-END-DTE        PIC  X(10).          05360017
053700                                                                  05370017
053800     05  DECONSOL-TABLE.                                          05380017
053900         10  DEC-VENDORS      OCCURS 30 TIMES                     05390017
054000                              INDEXED BY IDX3.                    05400017
054100             15  TBL-DEC-VND         PIC  X(9).                   05410017
054200             15  DEC-ENTRIES      OCCURS 30 TIMES                 05420017
054300                              INDEXED BY IDX3A.                   05430017
054400                 20  TBL-DEC-POE-CDE         PIC  X(5).           05440017
054500                 20  TBL-DEC-RATE-CDE        PIC  X(3).           05450017
054600                 20  TBL-DEC-RATE            PIC  9V999.          05460017
054700                 20  TBL-DEC-BEG-DTE         PIC  X(10).          05470017
054800                 20  TBL-DEC-END-DTE         PIC  X(10).          05480017
054900                                                                  05490017
055000                                                                  05500017
055100 EJECT                                                            05510017
055200*----------------------------------------------------------------*05520017
055300* WORKING STORAGE ERROR CODE VALUE ROUTINE                        05530017
055400*----------------------------------------------------------------*05540017
055500     COPY APWS010.                                                05550017
055600                                                                  05560017
055700*----------------------------------------------------------------*05570017
055800*    COPYBOOK FOR EDI IMPORT INVOICE AUDIT FILE                   05580017
055900*----------------------------------------------------------------*05590017
056000     COPY APRD019.                                                05600017
056100                                                                  05610017
056200*----------------------------------------------------------------*05620017
056300*    COPYBOOK FOR IMPORT EXPENSE INVOICE LOAD FILE                05630017
056400*----------------------------------------------------------------*05640017
056500     COPY APRD016.                                                05650017
056600                                                                  05660017
056700*----------------------------------------------------------------*05670017
056800*    COPYBOOK FOR REJECTED/PENDING INVOICE FILE                   05680017
056900*----------------------------------------------------------------*05690017
057000     COPY APRD018.                                                05700017
057100                                                                  05710017
057200*----------------------------------------------------------------*05720017
057300*    COPYBOOK FOR SURCHARGE REPORT FILE                           05730017
057400*----------------------------------------------------------------*05740017
057500     COPY APRD079.                                                05750017
057600                                                                  05760017
057700*----------------------------------------------------------------*05770017
057800*    SQL COMMUNICATIONS AREA DCLGEN                               05780017
057900*----------------------------------------------------------------*05790017
058000     EXEC SQL                                                     05800017
058100         INCLUDE SQLCA                                            05810017
058200     END-EXEC.                                                    05820017
058300                                                                  05830017
058400*----------------------------------------------------------------*05840017
058500*    AP-INVOICE TABLE                                             05850017
058600*----------------------------------------------------------------*05860017
058700     EXEC SQL                                                     05870017
058800         INCLUDE TINVOIC                                          05880017
058900     END-EXEC.                                                    05890017
059000                                                                  05900017
059100*----------------------------------------------------------------*05910017
059200*    AP-ADJUSTMENT JOURNAL TABLE                                  05920017
059300*----------------------------------------------------------------*05930017
059400     EXEC SQL                                                     05940017
059500         INCLUDE TADJRNL                                          05950017
059600     END-EXEC.                                                    05960017
059700                                                                  05970017
059800*----------------------------------------------------------------*05980017
059900*    TR-PO TRACKING CONTAINER TRACKING                            05990017
060000*----------------------------------------------------------------*06000017
060100     EXEC SQL                                                     06010017
060200         INCLUDE TIMCNTK                                          06020017
060300     END-EXEC.                                                    06030017
060400                                                                  06040017
060500*----------------------------------------------------------------*06050017
060600*    TR-PO TRACKING CONTAINER PO                                  06060017
060700*----------------------------------------------------------------*06070017
060800     EXEC SQL                                                     06080017
060900         INCLUDE TIMCNPO                                          06090017
061000     END-EXEC.                                                    06100017
061100                                                                  06110017
061200*----------------------------------------------------------------*06120017
061300*    EXPENSE INVOICE TABLE                                        06130017
061400*----------------------------------------------------------------*06140017
061500     EXEC SQL                                                     06150017
061600         INCLUDE TEXINVC                                          06160017
061700     END-EXEC.                                                    06170017
061800                                                                  06180017
061900*----------------------------------------------------------------*06190017
062000*    LOGISTICS RATE TABLE                                         06200017
062100*----------------------------------------------------------------*06210017
062200     EXEC SQL                                                     06220017
062300         INCLUDE TRT00050                                         06230017
062400     END-EXEC.                                                    06240017
062500                                                                  06250017
062600*----------------------------------------------------------------*06260017
062700*    LOGISTICS RATE TYPE / VENDOR CAPABILITY TABLE                06270017
062800*----------------------------------------------------------------*06280017
062900     EXEC SQL                                                     06290017
063000         INCLUDE TRT00048                                         06300017
063100     END-EXEC.                                                    06310017
063200                                                                  06320017
063300*----------------------------------------------------------------*06330017
063400*    LOGISTICS RATE TYPE HISTORY TABLE                            06340017
063500*----------------------------------------------------------------*06350017
063600     EXEC SQL                                                     06360017
063700         INCLUDE TRT00049                                         06370017
063800     END-EXEC.                                                    06380017
063900                                                                  06390017
064000*----------------------------------------------------------------*06400017
064100*    EXTERNAL ENTITY TABLE                                        06410017
064200*----------------------------------------------------------------*06420017
064300     EXEC SQL                                                     06430017
064400         INCLUDE TEXTENT                                          06440017
064500     END-EXEC.                                                    06450017
064600                                                                  06460017
064700*----------------------------------------------------------------*06470017
064800*    VENDOR CAPABILITY TABLE                                      06480017
064900*----------------------------------------------------------------*06490017
065000     EXEC SQL                                                     06500017
065100         INCLUDE VNT00001                                         06510017
065200     END-EXEC.                                                    06520017
065300                                                                  06530017
065400*----------------------------------------------------------------*06540017
065500*    ACCOUNTS PAYABLE CONTROL TABLE                               06550017
065600*----------------------------------------------------------------*06560017
065700     EXEC SQL                                                     06570017
065800         INCLUDE TAPCNTL                                          06580017
065900     END-EXEC.                                                    06590017
066000                                                                  06600017
066100*----------------------------------------------------------------*06610017
066200*    DB2 AREA FOR SYSDUMMY1                                       06620017
066300*----------------------------------------------------------------*06630017
066400     EXEC SQL                                                     06640017
066500          INCLUDE SYSDUMMY                                        06650017
066600     END-EXEC.                                                    06660017
066700                                                                  06670017
066800*----------------------------------------------------------------*06680017
066900*    ABEND DATA AREAS                                             06690017
067000*----------------------------------------------------------------*06700017
067100 01  ABEND-CODE                    PIC S9(4)    VALUE ZEROES      06710017
067200                                   COMP         SYNC.             06720017
067300                                                                  06730017
067400     88  AC-ANY-ERROR                           VALUE  +4001      06740017
067500                                                THRU   +4019.     06750017
067600     88  AC-INVALID-KEY-WRITE                   VALUE  +4001.     06760017
067700     88  AC-INVALID-KEY-READ                    VALUE  +4002.     06770017
067800     88  AC-INVALID-CONTROL-CARD                VALUE  +4003.     06780017
067900     88  AC-OPEN-ERROR                          VALUE  +4005.     06790017
068000     88  AC-CLOSE-ERROR                         VALUE  +4006.     06800017
068100     88  AC-INVALID-DATA                        VALUE  +4008.     06810017
068200     88  AC-DB2-ERROR                           VALUE  +4013.     06820017
068300     88  AC-UNSUCCESSFUL-SELECT                 VALUE  +4015.     06830017
068400     88  AC-MAX-RETRIES-EXCEEDED                VALUE  +4016.     06840017
068500                                                                  06850017
068600 01  ABEND-AREAS.                                                 06860017
068700     05  AA-ABEND-LIT              PIC  X(40)   VALUE             06870017
068800             '*****       ABEND'.                                 06880017
068900     05  AA-PROGRAM-LIT            PIC  X(40)   VALUE             06890017
069000             '*****   PROGRAM: APKUT224'.                         06900017
069100     05  AA-PARAGRAPH-LIT.                                        06910017
069200         10  FILLER                PIC  X(17)   VALUE             06920017
069300             '***** PARAGRAPH: '.                                 06930017
069400         10  AA-PARAGRAPH-NAME     PIC  X(35)   VALUE SPACES.     06940017
069500     05  AA-MESSAGE-LINE-1.                                       06950017
069600         10  FILLER                PIC  X(06)   VALUE '*****'.    06960017
069700         10  AA-MESSAGE-1          PIC  X(80)   VALUE SPACES.     06970017
069800     05  AA-MESSAGE-LINE-2.                                       06980017
069900         10  FILLER                PIC  X(06)   VALUE '*****'.    06990017
070000         10  AA-MESSAGE-2          PIC  X(80)   VALUE SPACES.     07000017
070100     05  AA-DB2-ERROR-LIT          PIC  X(40)   VALUE             07010017
070200             '*****    DB2 ERROR'.                                07020017
070300     05  AA-DB2-OPERATION-LIT.                                    07030017
070400         10  FILLER                PIC  X(17)   VALUE             07040017
070500             '***** OPERATION: '.                                 07050017
070600         10  AA-DB2-OPERATION.                                    07060017
070700             15  AA-DB2-OP-1       PIC  X(25)   VALUE SPACES.     07070017
070800             15  AA-DB2-OP-2       PIC  X(25)   VALUE SPACES.     07080017
070900     05  AA-DB2-TABLE-1            PIC  X(08)   VALUE SPACES.     07090017
071000     05  AA-DB2-TABLE-2            PIC  X(08)   VALUE SPACES.     07100017
071100     05  AA-DB2-TABLE-3            PIC  X(08)   VALUE SPACES.     07110017
071200                                                                  07120017
071300                                                                  07130017
071400*----------------------------------------------------------------*07140017
071500*    SQLCA FORMATTED MESSAGE AREA                                 07150017
071600*----------------------------------------------------------------*07160017
071700     COPY DPWS004.                                                07170017
071800                                                                  07180017
071900*----------------------------------------------------------------*07190017
072000* RATES CURSOR                                                    07200017
072100*----------------------------------------------------------------*07210017
072200     EXEC SQL                                                     07220017
072300       DECLARE RATE-CSR CURSOR FOR                                07230017
072400       SELECT A.TRANS_RT_AMT                                      07240017
072500            , A.EFF_RT_BEG_DTE                                    07250017
072600            , A.EFF_RT_END_DTE                                    07260017
072700            , A.POE_STD_EDI_CDE                                   07270017
072800            , A.VND_NBR                                           07280017
072900            , A.DCONSLR_SCAC_ID                                   07290017
073000            , B.SCAC_CDE                                          07300017
073100       FROM TRT_VND_TRANS_RT A                                    07310017
073200          , TEXTENT B                                             07320017
073300          , VNT_VND_CPBL C                                        07330017
073400          , TRT_TRANS_CPBL_RT_TYP D                               07340017
073500          , TRT_TRANS_RT_TYP_HIST E                               07350017
073600       WHERE A.VND_NBR = B.DUN_NBR                                07360017
073700         AND B.ENT_ID = C.ENT_ID                                  07370017
073800         AND C.VND_CPBL_CDE = :VNT00001-VND-CPBL-CDE              07380017
073900         AND C.VND_CPBL_CDE = D.VND_CPBL_CDE                      07390017
074000         AND D.TRANS_RT_TYP_CDE = A.TRANS_RT_TYP_CDE              07400017
074100         AND D.TRANS_RT_TYP_CDE = E.TRANS_RT_TYP_CDE              07410017
074200         AND E.TRANS_RT_TYP_BEG_DTE <= :WS-HOLD-PRC-BEG-DTE       07420017
074300         AND E.TRANS_RT_TYP_END_DTE >= :WS-HOLD-PRC-END-DTE       07430017
074400         AND (A.EFF_RT_END_DTE >= :WS-ONE-YEAR-AGO-DTE            07440017
074500          OR A.EFF_RT_END_DTE IS NULL)                            07450017
074600       ORDER BY A.VND_NBR, A.DCONSLR_SCAC_ID, A.TRANS_RT_TYP_CDE  07460017
074700              , A.EFF_RT_END_DTE DESC                             07470017
074800     END-EXEC.                                                    07480017
074900                                                                  07490017
075000 01  FILLER                      PIC  X(25)     VALUE             07500017
075100     '** END OF APKUT224 W/S **'.                                 07510017
075200                                                                  07520017
075300*-------------------*                                             07530017
075400 PROCEDURE DIVISION.                                              07540017
075500*-------------------*                                             07550017
075600 A100-MAINLINE.                                                   07560017
075700                                                                  07570017
075800     PERFORM B100-INITIALIZE.                                     07580017
075900                                                                  07590017
076000     PERFORM B200-PROCESS-AUDIT-REC                               07600017
076100         UNTIL END-OF-FILE.                                       07610017
076200                                                                  07620017
076300     PERFORM B300-END-OF-PROGRAM.                                 07630017
076400                                                                  07640017
076500     GOBACK.                                                      07650017
076600                                                                  07660017
076700                                                                  07670017
076800*----------------------------------------------------------------*07680017
076900*    INITIALIZATION PROCESSING                                   *07690017
077000*                                                                *07700017
077100*    - OPEN FILE.                                                *07710017
077200*    - INTIALIZE LAYOUTS.                                        *07720017
077300*    - READ AND PROCESS INPUT FILE.                              *07730017
077400*----------------------------------------------------------------*07740017
077500 B100-INITIALIZE.                                                 07750017
077600                                                                  07760017
077700     DISPLAY '**------  APKUT224  (PROCESSING MSGS)  ------**'.   07770017
077800                                                                  07780017
077900     OPEN  INPUT EDI-IMP-INVC-AUD-FILE                            07790017
078000          OUTPUT IMP-EXP-INVC-LOAD-FILE                           07800017
078100                 REJ-PEND-INVC-FILE                               07810017
078200                 SURCHG-RPT-FILE.                                 07820017
078300                                                                  07830017
078400     INITIALIZE DCLTINVOIC                                        07840017
078500                DCLTADJRNL                                        07850017
078600                DCLTIMCNTK                                        07860017
078700                DCLTIMCNPO                                        07870017
078800                DCLTEXINVC                                        07880017
078900                DCLTRT00050                                       07890017
079000                DCLTRT00048                                       07900017
079100                DCLVNT00001                                       07910017
079200                DCLTEXTENT                                        07920017
079300                DCLTAPCNTL                                        07930017
079400                AP019-IMPORT-EXP-AUDIT-RECORD                     07940017
079500                AP018-REJECT-IMPORT-INVOICE                       07950017
079600                AP016-INVOICE-LOAD-RECORD                         07960017
079700                AP079-SURCHG-RPT-RECORD.                          07970017
079800                                                                  07980017
079900     PERFORM VARYING IDX1 FROM 1 BY 1                             07990017
080000        UNTIL IDX1 > PC-PO-INVC-TBL-MAX                           08000017
080100        MOVE ZEROES      TO TBL-PO-NBR(IDX1)                      08010017
080200        MOVE HIGH-VALUES TO TBL-INVC-ID(IDX1)                     08020017
080300     END-PERFORM.                                                 08030017
080400                                                                  08040017
080500     PERFORM VARYING IDX2 FROM 1 BY 1                             08050017
080600        UNTIL IDX2 > 30                                           08060017
080700        MOVE HIGH-VALUES TO TBL-DRAY-VND(IDX2)                    08070017
080800        MOVE SPACES      TO TBL-DRAY-SCAC(IDX2)                   08080017
080900        PERFORM VARYING IDX2A FROM 1 BY 1                         08090017
081000           UNTIL IDX2A > 30                                       08100017
081100           MOVE HIGH-VALUES TO TBL-DRAY-POE-CDE(IDX2, IDX2A)      08110017
081200           MOVE ZEROES      TO TBL-DRAY-RATE(IDX2, IDX2A)         08120017
081300           MOVE SPACES      TO TBL-DRAY-BEG-DTE(IDX2, IDX2A)      08130017
081400           MOVE SPACES      TO TBL-DRAY-END-DTE(IDX2, IDX2A)      08140017
081500        END-PERFORM                                               08150017
081600     END-PERFORM.                                                 08160017
081700                                                                  08170017
081800     PERFORM VARYING IDX3 FROM 1 BY 1                             08180017
081900        UNTIL IDX3 > 30                                           08190017
082000        MOVE HIGH-VALUES TO TBL-DEC-VND(IDX3)                     08200017
082100        PERFORM VARYING IDX3A FROM 1 BY 1                         08210017
082200           UNTIL IDX3A > 30                                       08220017
082300           MOVE HIGH-VALUES TO TBL-DEC-POE-CDE(IDX3, IDX3A)       08230017
082400           MOVE HIGH-VALUES TO TBL-DEC-RATE-CDE(IDX3, IDX3A)      08240017
082500           MOVE ZEROES      TO TBL-DEC-RATE(IDX3, IDX3A)          08250017
082600           MOVE SPACES      TO TBL-DEC-BEG-DTE(IDX3, IDX3A)       08260017
082700           MOVE SPACES      TO TBL-DEC-END-DTE(IDX3, IDX3A)       08270017
082800        END-PERFORM                                               08280017
082900     END-PERFORM.                                                 08290017
083000                                                                  08300017
083100     PERFORM I300-INITIALIZE-ERR-TBL.                             08310017
083200                                                                  08320017
083300     PERFORM S700-SELECT-CNTL-DATE.                               08330017
083400     STRING APCNTL-BTCH-PRC-DTE DELIMITED BY SPACE                08340017
083500            PC-BEG-TMST DELIMITED BY SPACE                        08350017
083600       INTO WS-HOLD-PRC-BEG-DTE.                                  08360017
083700                                                                  08370017
083800     MOVE PC-BEG-TMST TO WS-YEAR-AGO-TMST.                        08380017
083900                                                                  08390017
084000     STRING APCNTL-BTCH-PRC-DTE DELIMITED BY SPACE                08400017
084100            PC-END-TMST DELIMITED BY SPACE                        08410017
084200       INTO WS-HOLD-PRC-END-DTE.                                  08420017
084300                                                                  08430017
084400     PERFORM L100-LOAD-DRAY-RATES.                                08440017
084500     PERFORM L200-LOAD-DECON-RATES.                               08450017
084600     PERFORM R100-READ-FILE.                                      08460017
084700                                                                  08470017
084800     IF END-OF-FILE                                               08480017
084900        DISPLAY 'EMPTY INPUT FILE.  NO RECORDS TO PROCESS.'       08490017
085000     END-IF.                                                      08500017
085100                                                                  08510017
085200*----------------------------------------------------------------*08520017
085300*    PROCESS AUDIT RECORD                                        *08530017
085400*                                                                *08540017
085500*    - PROCESS MULTIPLE SELECT STATEMENTS                        *08550017
085600*    - WRITE RECORD TO FILE                                      *08560017
085700*    - FETCH NEXT RECORD                                         *08570017
085800*----------------------------------------------------------------*08580017
085900 B200-PROCESS-AUDIT-REC.                                          08590017
086000                                                                  08600017
086100     IF (AP019-VENDOR-NBR = HOLD-VENDOR-NBR) AND                  08610017
086200        (AP019-INVOICE-NBR = HOLD-INVOICE-ID)                     08620017
086300        SET REJECT-REC                                            08630017
086400            DUPL-VND-INV-TRANS-ERR TO TRUE                        08640017
086500        MOVE WS010-ERROR-CODES TO                                 08650017
086600                  WS-ERR-CDE(WS-ERR-IDX)                          08660017
086700        IF WS-ERR-IDX NOT = 10                                    08670017
086800           SET WS-ERR-IDX UP BY 1                                 08680017
086900        END-IF                                                    08690017
087000     ELSE                                                         08700017
087100        MOVE AP019-VENDOR-NBR  TO HOLD-VENDOR-NBR                 08710017
087200                                  PV-VENDOR-NBR                   08720017
087300        MOVE AP019-INVOICE-NBR TO HOLD-INVOICE-ID                 08730017
087400     END-IF.                                                      08740017
087500                                                                  08750017
087600     IF NORMAL-REC                                                08760017
087700        PERFORM C100-SEARCH-PO-INVC-TABLE                         08770017
087800     END-IF.                                                      08780017
087900                                                                  08790017
088000     IF NORMAL-REC                                                08800017
088100        PERFORM S100-CHECK-TINVOIC-VENDOR                         08810017
088200     END-IF.                                                      08820017
088300                                                                  08830017
088400     IF NORMAL-REC                                                08840017
088500        PERFORM S200-CHECK-TINVOIC-PO                             08850017
088510        PERFORM S250-CHECK-TINVOIC-POBKR                          08851017
088520     END-IF.                                                      08852017
088530                                                                  08853017
088540     IF NORMAL-REC AND AP019-CONTAINER-ID > SPACES                08854017
088550        PERFORM S600-CHECK-PO-CONTAINER                           08855017
088560     END-IF.                                                      08856017
088570                                                                  08857017
088580     IF NORMAL-REC                                                08858017
088590        PERFORM S300-CHECK-TADJRNL                                08859017
088591        IF AP019-CUSTOMER-REF-NBR = SPACES                        08859118
088592           CONTINUE                                               08859218
088593        ELSE                                                      08859318
088600           PERFORM S350-CHECK-TADJRNL-BRK                         08860018
088700        END-IF                                                    08870018
088710     END-IF.                                                      08871018
088800                                                                  08880017
088900     IF NORMAL-REC                                                08890017
089000        PERFORM C200-VALIDATE-CHG-AMT                             08900017
089100     END-IF.                                                      08910017
089200                                                                  08920017
089300     IF REJECT-REC OR PENDING-REC                                 08930017
089400        PERFORM E100-FORMAT-REJ-PND-REC                           08940017
089500     END-IF.                                                      08950017
089600                                                                  08960017
089700     IF NORMAL-REC OR PENDING-REC                                 08970017
089800        PERFORM E200-FORMAT-INVC-LOAD-REC                         08980017
089900     END-IF.                                                      08990017
090000                                                                  09000017
090100     IF NORMAL-REC OR PENDING-REC                                 09010017
090200        IF SURCHG-REC                                             09020017
090300           PERFORM E300-FORMAT-SURCHG-REC                         09030017
090400        END-IF                                                    09040017
090500     END-IF.                                                      09050017
090600                                                                  09060017
090700     PERFORM R100-READ-FILE.                                      09070017
090800                                                                  09080017
090900     SET NORMAL-REC TO TRUE.                                      09090017
091000                                                                  09100017
091100     PERFORM I300-INITIALIZE-ERR-TBL.                             09110017
091200                                                                  09120017
091300     INITIALIZE PROGRAM-EXCEEDED-SWITCHES                         09130017
091400                EXPECTED-DECONSOL-RATE                            09140017
091500                FUEL-SURCHG-TOT                                   09150017
091600                SURCHG-SWITCHES                                   09160017
091700                WS010-ERROR-CODES.                                09170017
091800                                                                  09180017
091900                                                                  09190017
092000*----------------------------------------------------------------*09200017
092100*    END OF PROGRAM                                              *09210017
092200*                                                                *09220017
092300*    - CLOSE THE FILES.                                          *09230017
092400*    - DISPLAY INFORMATIONAL STATS.                              *09240017
092500*----------------------------------------------------------------*09250017
092600 B300-END-OF-PROGRAM.                                             09260017
092700                                                                  09270017
092800     CLOSE EDI-IMP-INVC-AUD-FILE                                  09280017
092900           IMP-EXP-INVC-LOAD-FILE                                 09290017
093000           REJ-PEND-INVC-FILE                                     09300017
093100           SURCHG-RPT-FILE.                                       09310017
093200                                                                  09320017
093300     DISPLAY '*************************************************'. 09330017
093400     DISPLAY '*************************************************'. 09340017
093500     DISPLAY '** TOTAL RECS READ       = ' PV-FILE-REC-COUNT.     09350017
093600     DISPLAY '** INVOICE RECS WRITTEN  = ' PV-INVC-WRITTEN-COUNT. 09360017
093700     DISPLAY '** PEND RECS WRITTEN     = ' PV-PEND-WRITTEN-COUNT. 09370017
093800     DISPLAY '** REJECT RECS WRITTEN   = ' PV-REJ-WRITTEN-COUNT.  09380017
093900     DISPLAY '** SURCHG RECS WRITTEN   = ' PV-SURCHG-WRIT-COUNT.  09390017
094000     DISPLAY '*************************************************'. 09400017
094100     DISPLAY '**         END OF APKUT224 PROCESSING          **'. 09410017
094200     DISPLAY '*************************************************'. 09420017
094300     DISPLAY ' '.                                                 09430017
094400                                                                  09440017
094500                                                                  09450017
094600*----------------------------------------------------------------*09460017
094700*    SEARCH TABLE FOR MATCHING ENTRY.                            *09470017
094800*----------------------------------------------------------------*09480017
094900 C100-SEARCH-PO-INVC-TABLE.                                       09490017
095000                                                                  09500017
095100     SET IDX1 TO 1.                                               09510017
095200                                                                  09520017
095300     SEARCH PO-INVC-ENTRIES                                       09530017
095400        AT END CONTINUE                                           09540017
095500        WHEN (TBL-PO-NBR(IDX1)  = AP019-PO-NBR)                   09550017
095600         AND (TBL-INVC-ID(IDX1) = AP019-INVOICE-NBR)              09560017
095700             SET REJECT-REC                                       09570017
095800                 DUPL-PO-INV-TRANS-ERR TO TRUE                    09580017
095900             MOVE WS010-ERROR-CODES TO                            09590017
096000                       WS-ERR-CDE(WS-ERR-IDX)                     09600017
096100             IF WS-ERR-IDX NOT = 10                               09610017
096200                SET WS-ERR-IDX UP BY 1                            09620017
096300             END-IF                                               09630017
096400     END-SEARCH.                                                  09640017
096500                                                                  09650017
096600     IF NOT DUPL-PO-INV-TRANS-ERR                                 09660017
096700        SET IDX1 TO 1                                             09670017
096800        SEARCH PO-INVC-ENTRIES                                    09680017
096900           AT END                                                 09690017
097000                DISPLAY '*** INTERNAL INVOICE TABLE OVERFLOW ***' 09700017
097100                DISPLAY '*** TABLE EXCEEDED THE          ***'     09710017
097200                DISPLAY '*** PC-PO-INVC-TBL-MAX LIMIT    ***'     09720017
097300                MOVE 'C100-SEARCH-PO-INVC-TABLE'                  09730017
097400                                TO AA-PARAGRAPH-NAME              09740017
097500                PERFORM Z998-ABEND                                09750017
097600           WHEN (TBL-PO-NBR(IDX1)  = ZEROES) AND                  09760017
097700                (TBL-INVC-ID(IDX1) = HIGH-VALUES)                 09770017
097800                MOVE AP019-PO-NBR      TO TBL-PO-NBR(IDX1)        09780017
097900                MOVE AP019-INVOICE-NBR TO TBL-INVC-ID(IDX1)       09790017
098000        END-SEARCH                                                09800017
098100     END-IF.                                                      09810017
098200                                                                  09820017
098300                                                                  09830017
098400*----------------------------------------------------------------*09840017
098500*    VALIDATE CHARGE AMOUNTS.                                    *09850017
098600*----------------------------------------------------------------*09860017
098700 C200-VALIDATE-CHG-AMT.                                           09870017
098800                                                                  09880017
098900     PERFORM VARYING AP019-IDX FROM 1 BY 1                        09890017
099000         UNTIL AP019-CHARGE-CDE (AP019-IDX) = SPACES              09900017
099100                                                                  09910017
099200         EVALUATE TRUE                                            09920017
099300             WHEN AP019-CHARGE-CDE (AP019-IDX) = 'DRA'            09930017
099400                  PERFORM D100-VALIDATE-DRAYAGE                   09940017
099500             WHEN AP019-CHARGE-CDE (AP019-IDX) = 'DDF'            09950017
099600                  PERFORM D200-VALIDATE-DECONSOL                  09960017
099700             WHEN AP019-CHARGE-CDE (AP019-IDX) = 'ENT'            09970017
099800              MOVE AP019-CHARGE-CDE (AP019-IDX) TO PV-RATE-TYP-CDE09980017
099900              PERFORM S950-SELECT-BROKER-RATE                     09990017
100000              IF RATE-FOUND                                       10000017
100100                 IF AP019-CHARGE-AMT(AP019-IDX) >                 10010017
100200                    TRT00050-TRANS-RT-AMT                         10020017
100300                    SET PS-ENTRY-EXCEEDED                         10030017
100400                        CHRG-THRESHHOLD-EXCP                      10040017
100500                        PENDING-REC TO TRUE                       10050017
100600                    MOVE WS010-ERROR-CODES TO                     10060017
100700                              WS-ERR-CDE(WS-ERR-IDX)              10070017
100800                    IF WS-ERR-IDX NOT = 10                        10080017
100900                       SET WS-ERR-IDX UP BY 1                     10090017
101000                    END-IF                                        10100017
101100                 END-IF                                           10110017
101200              ELSE                                                10120017
101300                 SET PS-ENTRY-EXCEEDED                            10130017
101400                     CHRG-THRESHHOLD-EXCP                         10140017
101500                     PENDING-REC TO TRUE                          10150017
101600                 MOVE WS010-ERROR-CODES TO                        10160017
101700                           WS-ERR-CDE(WS-ERR-IDX)                 10170017
101800                 IF WS-ERR-IDX NOT = 10                           10180017
101900                    SET WS-ERR-IDX UP BY 1                        10190017
102000                 END-IF                                           10200017
102100              END-IF                                              10210017
102200             WHEN AP019-CHARGE-CDE (AP019-IDX) = 'CTX'            10220017
102300              MOVE AP019-CHARGE-CDE (AP019-IDX) TO PV-RATE-TYP-CDE10230017
102400              PERFORM S950-SELECT-BROKER-RATE                     10240017
102500              IF RATE-FOUND                                       10250017
102600                 IF AP019-CHARGE-AMT(AP019-IDX) >                 10260017
102700                    TRT00050-TRANS-RT-AMT                         10270017
102800                    SET PS-EXAM-EXCEEDED                          10280017
102900                        CHRG-THRESHHOLD-EXCP                      10290017
103000                        PENDING-REC TO TRUE                       10300017
103100                    MOVE WS010-ERROR-CODES TO                     10310017
103200                              WS-ERR-CDE(WS-ERR-IDX)              10320017
103300                    IF WS-ERR-IDX NOT = 10                        10330017
103400                       SET WS-ERR-IDX UP BY 1                     10340017
103500                    END-IF                                        10350017
103600                 END-IF                                           10360017
103700              ELSE                                                10370017
103800                 SET PS-EXAM-EXCEEDED                             10380017
103900                     CHRG-THRESHHOLD-EXCP                         10390017
104000                     PENDING-REC TO TRUE                          10400017
104100                     MOVE WS010-ERROR-CODES TO                    10410017
104200                               WS-ERR-CDE(WS-ERR-IDX)             10420017
104300                     IF WS-ERR-IDX NOT = 10                       10430017
104400                        SET WS-ERR-IDX UP BY 1                    10440017
104500                     END-IF                                       10450017
104600              END-IF                                              10460017
104700             WHEN AP019-CHARGE-CDE (AP019-IDX) = 'REE'            10470017
104800              MOVE AP019-CHARGE-CDE (AP019-IDX) TO PV-RATE-TYP-CDE10480017
104900              PERFORM S950-SELECT-BROKER-RATE                     10490017
105000              IF RATE-FOUND                                       10500017
105100                 IF AP019-CHARGE-AMT(AP019-IDX) >                 10510017
105200                    TRT00050-TRANS-RT-AMT                         10520017
105300                    SET PS-REGULATORY-EXCEEDED                    10530017
105400                        CHRG-THRESHHOLD-EXCP                      10540017
105500                        PENDING-REC TO TRUE                       10550017
105600                    MOVE WS010-ERROR-CODES TO                     10560017
105700                              WS-ERR-CDE(WS-ERR-IDX)              10570017
105800                    IF WS-ERR-IDX NOT = 10                        10580017
105900                       SET WS-ERR-IDX UP BY 1                     10590017
106000                    END-IF                                        10600017
106100                 END-IF                                           10610017
106200              ELSE                                                10620017
106300                 SET PS-REGULATORY-EXCEEDED                       10630017
106400                     CHRG-THRESHHOLD-EXCP                         10640017
106500                     PENDING-REC TO TRUE                          10650017
106600                     MOVE WS010-ERROR-CODES TO                    10660017
106700                               WS-ERR-CDE(WS-ERR-IDX)             10670017
106800                     IF WS-ERR-IDX NOT = 10                       10680017
106900                        SET WS-ERR-IDX UP BY 1                    10690017
107000                     END-IF                                       10700017
107100              END-IF                                              10710017
107200             WHEN AP019-CHARGE-CDE (AP019-IDX) = '405'            10720017
107300                  SET FUEL-SURCHG-FND                             10730017
107400                      SURCHG-REC TO TRUE                          10740017
107500                  ADD AP019-CHARGE-AMT (AP019-IDX) TO             10750017
107600                                      FUEL-SURCHG-TOT             10760017
107700             WHEN AP019-CHARGE-CDE (AP019-IDX) = 'MIS'            10770017
107800               OR AP019-CHARGE-CDE (AP019-IDX) = '690'            10780017
107900                  SET PS-MISC-EXCEEDED                            10790017
108000                      MISC-CHRG-EXCP                              10800017
108100                      PENDING-REC TO TRUE                         10810017
108200                      MOVE WS010-ERROR-CODES TO                   10820017
108300                                WS-ERR-CDE(WS-ERR-IDX)            10830017
108400                      IF WS-ERR-IDX NOT = 10                      10840017
108500                         SET WS-ERR-IDX UP BY 1                   10850017
108600                      END-IF                                      10860017
108700             WHEN AP019-CHARGE-CDE (AP019-IDX) = 'BSS'            10870017
108800                  MOVE AP019-CHARGE-CDE (AP019-IDX) TO            10880017
108900                                                PV-RATE-TYP-CDE   10890017
109000                  PERFORM S950-SELECT-BROKER-RATE                 10900017
109100                  IF RATE-FOUND                                   10910017
109200                     IF AP019-CHARGE-AMT(AP019-IDX) >             10920017
109300                        TRT00050-TRANS-RT-AMT                     10930017
109400                        SET PS-MPF-FEE-EXCEEDED                   10940017
109500                            CHRG-THRESHHOLD-EXCP                  10950017
109600                            PENDING-REC TO TRUE                   10960017
109610                        MOVE WS010-ERROR-CODES TO                 10961017
109620                                          WS-ERR-CDE(WS-ERR-IDX)  10962017
109630                        IF WS-ERR-IDX NOT = 10                    10963017
109640                           SET WS-ERR-IDX UP BY 1                 10964017
109650                        END-IF                                    10965017
109660                     END-IF                                       10966017
109670                  ELSE                                            10967017
109680                     SET PS-MPF-FEE-EXCEEDED                      10968017
109690                         CHRG-THRESHHOLD-EXCP                     10969017
109700                         PENDING-REC TO TRUE                      10970017
109800                     MOVE WS010-ERROR-CODES TO                    10980017
109900                                      WS-ERR-CDE(WS-ERR-IDX)      10990017
110000                     IF WS-ERR-IDX NOT = 10                       11000017
110100                        SET WS-ERR-IDX UP BY 1                    11010017
110200                     END-IF                                       11020017
110300                  END-IF                                          11030017
110400         END-EVALUATE                                             11040017
110410                                                                  11041017
110420     END-PERFORM.                                                 11042017
110430                                                                  11043017
110440*----------------------------------------------------------------*11044017
110450*    VALIDATE DRAYAGE AMOUNT - UP TO 3 RATES AVAILABLE.          *11045017
110460*----------------------------------------------------------------*11046017
110470 D100-VALIDATE-DRAYAGE.                                           11047017
110480                                                                  11048017
110490     SET IDX2 TO 1.                                               11049017
110500     SET IDX2A TO 1.                                              11050017
110600     SET RATE-NOT-FOUND TO TRUE.                                  11060017
110700                                                                  11070017
110800     INITIALIZE DCLTIMCNPO                                        11080017
110900                DCLTIMCNTK.                                       11090017
111000                                                                  11100017
111100     IF AP019-CONTAINER-ID NOT = SPACES                           11110017
111200         MOVE AP019-CONTAINER-ID TO IMCNPO-CONTNR-ID              11120017
111300         MOVE AP019-PO-NBR       TO IMCNPO-PO-NBR                 11130017
111400         PERFORM S400-GET-DECONS-INFO                             11140017
111500     ELSE                                                         11150017
111600         SET DECONS-SCAC-NOT-FND                                  11160017
111700             NO-CONTNR-PU-DTE-FND TO TRUE                         11170017
111800     END-IF                                                       11180017
111900                                                                  11190017
112000     IF DECONS-SCAC-NOT-FND OR IMCNTK-DCONSLR-SCAC-ID = SPACES    11200017
112100        PERFORM S900-SELECT-VENDOR-SCAC                           11210017
112200        MOVE EXTENT-SCAC-CDE TO IMCNTK-DCONSLR-SCAC-ID            11220017
112300     END-IF.                                                      11230017
112400                                                                  11240017
112500     SEARCH DRAY-VENDORS                                          11250017
112600        AT END                                                    11260017
112700           SET PS-DRAYAGE-EXCEEDED                                11270017
112800               DRAY-SCAC-TOLERANCE-ERR                            11280017
112900               PENDING-REC TO TRUE                                11290017
113000           MOVE WS010-ERROR-CODES TO WS-ERR-CDE(WS-ERR-IDX)       11300017
113100           IF WS-ERR-IDX NOT = 10                                 11310017
113200              SET WS-ERR-IDX UP BY 1                              11320017
113300           END-IF                                                 11330017
113400*              DISPLAY 'DRAYAGE RATE NOT FOUND'                   11340017
113500*              DISPLAY 'AP019-INVOICE-NBR: ' AP019-INVOICE-NBR    11350017
113600*              DISPLAY 'AP019-VENDOR-NBR: ' AP019-VENDOR-NBR      11360017
113700*              DISPLAY 'DECON SCAC ' IMCNTK-DCONSLR-SCAC-ID       11370017
113800        WHEN TBL-DRAY-VND(IDX2) = AP019-VENDOR-NBR AND            11380017
113900             TBL-DRAY-SCAC(IDX2) = IMCNTK-DCONSLR-SCAC-ID         11390017
114000           PERFORM VARYING IDX2A FROM 1 BY 1                      11400017
114100             UNTIL IDX2A > 30 OR                                  11410017
114200             TBL-DRAY-RATE(IDX2, IDX2A) = ZEROES OR               11420017
114300             RATE-FOUND                                           11430017
114400             IF AP019-INVC-DTE >= TBL-DRAY-BEG-DTE(IDX2, IDX2A)   11440017
114500             AND AP019-INVC-DTE <= TBL-DRAY-END-DTE(IDX2, IDX2A)  11450017
114600                ADD 1.00 TO TBL-DRAY-RATE(IDX2, IDX2A)            11460017
114700                                       GIVING UPPER-DRAY-LIMIT    11470017
114800                SUBTRACT 1.00 FROM TBL-DRAY-RATE(IDX2, IDX2A)     11480017
114900                                       GIVING LOWER-DRAY-LIMIT    11490017
115000                IF (AP019-TOTAL-DRAYAGE-AMT > UPPER-DRAY-LIMIT    11500017
115100                OR AP019-TOTAL-DRAYAGE-AMT < LOWER-DRAY-LIMIT)    11510017
115200                   CONTINUE                                       11520017
115300                ELSE                                              11530017
115400                   SET RATE-FOUND TO TRUE                         11540017
115500                END-IF                                            11550017
115600             END-IF                                               11560017
115700           END-PERFORM                                            11570017
115800     END-SEARCH.                                                  11580017
115900                                                                  11590017
116000     IF RATE-NOT-FOUND                                            11600017
116100        SET PS-DRAYAGE-EXCEEDED                                   11610017
116200            DRAY-SCAC-TOLERANCE-ERR                               11620017
116300            PENDING-REC TO TRUE                                   11630017
116400            MOVE WS010-ERROR-CODES TO WS-ERR-CDE(WS-ERR-IDX)      11640017
116500            IF WS-ERR-IDX NOT = 10                                11650017
116600               SET WS-ERR-IDX UP BY 1                             11660017
116700            END-IF                                                11670017
116800*           DISPLAY 'PS-DRAYAGE RATE EXCEEDED'                    11680017
116900*           DISPLAY 'AP019-INVOICE-NBR: ' AP019-INVOICE-NBR       11690017
117000*           DISPLAY 'DECON SCAC ' IMCNTK-DCONSLR-SCAC-ID          11700017
117100*           DISPLAY 'TOTAL-DRAYAGE-AMT: '                         11710017
117200*                                    AP019-TOTAL-DRAYAGE-AMT      11720017
117300     END-IF.                                                      11730017
117400                                                                  11740017
117500*----------------------------------------------------------------*11750017
117600*    VALIDATE DECONSOLIDATION AMOUNT - UP TO 3 RATES AVAILABLE.  *11760017
117700*----------------------------------------------------------------*11770017
117800 D200-VALIDATE-DECONSOL.                                          11780017
117900                                                                  11790017
118000      SET IDX3 TO 1.                                              11800017
118100      SET IDX3A TO 1.                                             11810017
118200      SET RATE-NOT-FOUND TO TRUE.                                 11820017
118300      SEARCH DEC-VENDORS                                          11830017
118400        AT END                                                    11840017
118500           SET PS-DECONSOLID-EXCEEDED                             11850017
118600               CHRG-THRESHHOLD-EXCP                               11860017
118700               PENDING-REC TO TRUE                                11870017
118800               MOVE WS010-ERROR-CODES TO WS-ERR-CDE(WS-ERR-IDX)   11880017
118900               IF WS-ERR-IDX NOT = 10                             11890017
119000                  SET WS-ERR-IDX UP BY 1                          11900017
119100               END-IF                                             11910017
119200*              DISPLAY 'DECON RATE NOT FOUND'                     11920017
119300*              DISPLAY 'AP019-INVOICE-NBR: ' AP019-INVOICE-NBR    11930017
119400*              DISPLAY 'AP019-VENDOR-NBR: ' AP019-VENDOR-NBR      11940017
119500        WHEN TBL-DEC-VND(IDX3) = AP019-VENDOR-NBR                 11950017
119600           PERFORM VARYING IDX3A FROM 1 BY 1                      11960017
119700             UNTIL IDX3A > 30 OR                                  11970017
119800             TBL-DEC-RATE(IDX3, IDX3A) = ZEROES OR                11980017
119900             RATE-FOUND                                           11990017
120000           IF AP019-INVC-DTE >= TBL-DEC-BEG-DTE(IDX3, IDX3A)      12000017
120100           AND AP019-INVC-DTE <= TBL-DEC-END-DTE(IDX3, IDX3A)     12010017
120200            COMPUTE EXPECTED-DECONSOL-RATE ROUNDED =              12020017
120300                    (AP019-PO-QTY * TBL-DEC-RATE(IDX3, IDX3A))    12030017
120400            ADD .01 TO AP019-CHARGE-AMT(AP019-IDX)                12040017
120500                          GIVING UPPER-DECON-LIMIT                12050017
120600            SUBTRACT .01 FROM AP019-CHARGE-AMT(AP019-IDX)         12060017
120700                          GIVING LOWER-DECON-LIMIT                12070017
120800            IF (EXPECTED-DECONSOL-RATE > UPPER-DECON-LIMIT        12080017
120900            OR EXPECTED-DECONSOL-RATE < LOWER-DECON-LIMIT)        12090017
121000               CONTINUE                                           12100017
121100            ELSE                                                  12110017
121200               SET RATE-FOUND TO TRUE                             12120017
121300            END-IF                                                12130017
121400           END-IF                                                 12140017
121500           END-PERFORM                                            12150017
121600      END-SEARCH.                                                 12160017
121700                                                                  12170017
121800      IF RATE-NOT-FOUND                                           12180017
121900         SET PS-DECONSOLID-EXCEEDED                               12190017
122000             CHRG-THRESHHOLD-EXCP                                 12200017
122100             PENDING-REC TO TRUE                                  12210017
122200             MOVE WS010-ERROR-CODES TO WS-ERR-CDE(WS-ERR-IDX)     12220017
122300             IF WS-ERR-IDX NOT = 10                               12230017
122400                SET WS-ERR-IDX UP BY 1                            12240017
122500             END-IF                                               12250017
122600      END-IF.                                                     12260017
122700                                                                  12270017
122800*----------------------------------------------------------------*12280017
122900*    FORMATS THE REJECTION OR PENDING RECORD BEFORE WRITING.     *12290017
123000*----------------------------------------------------------------*12300017
123100 E100-FORMAT-REJ-PND-REC.                                         12310017
123200                                                                  12320017
123300     EVALUATE TRUE                                                12330017
123400         WHEN REJECT-REC                                          12340017
123500              SET CHRG-IDX TO 1                                   12350017
123600              PERFORM F200-MOVE-CHARGES                           12360017
123700                 VARYING AP019-IDX FROM 1 BY 1                    12370017
123800                 UNTIL AP019-IDX > 20 OR                          12380017
123900                    AP019-CHARGE-CDE(AP019-IDX) = SPACE           12390017
124000              SET AP018-REJECT-REPORT TO TRUE                     12400017
124100         WHEN PENDING-REC                                         12410017
124200              SET CHRG-IDX TO 1                                   12420017
124300              PERFORM F100-CHECK-FOR-EXCEED-CHARGES               12430017
124400                 VARYING AP019-IDX FROM 1 BY 1                    12440017
124500                 UNTIL AP019-IDX > 20 OR                          12450017
124600                    AP019-CHARGE-CDE(AP019-IDX) = SPACE           12460017
124700              SET AP018-PENDING-REPORT TO TRUE                    12470017
124800     END-EVALUATE.                                                12480017
124900                                                                  12490017
125000     MOVE AP019-PO-NBR               TO AP018-PO-NBR.             12500017
125100     MOVE AP019-INVOICE-NBR          TO AP018-INVOICE-NBR.        12510017
125200     MOVE AP019-VENDOR-NBR           TO AP018-VENDOR-NBR.         12520017
125300     MOVE AP019-INVC-DTE             TO AP018-INVC-DTE.           12530017
125400     MOVE AP019-NET-INVC-AMT         TO AP018-NET-INVC-AMT.       12540017
125500     MOVE AP019-VENDOR-NAME          TO AP018-VENDOR-NAME.        12550017
125600     MOVE AP019-PO-QTY               TO AP018-PO-QTY.             12560017
125700     MOVE AP019-PO-WEIGHT            TO AP018-PO-WEIGHT.          12570017
125800     MOVE AP019-PO-UOM-CDE           TO AP018-PO-UOM-CDE.         12580017
125900     MOVE AP019-TOTAL-DRAYAGE-AMT    TO AP018-TOTAL-DRAYAGE-AMT.  12590017
126000     MOVE AP019-TOTAL-DECONSOL-AMT   TO AP018-TOTAL-DECONSOL-AMT. 12600017
126100     MOVE EXPECTED-DECONSOL-RATE     TO AP018-CALCD-DDF-AMT.      12610017
126200                                                                  12620017
126300     PERFORM VARYING WS-ERR-IDX FROM 1 BY 1                       12630017
126400       UNTIL WS-ERR-IDX > 10                                      12640017
126500          OR WS-ERR-CDE(WS-ERR-IDX) = SPACES                      12650017
126600        SET AP018-IDX TO WS-ERR-IDX                               12660017
126700        MOVE WS-ERR-CDE(WS-ERR-IDX) TO AP018-ERR-CDE(AP018-IDX)   12670017
126800     END-PERFORM.                                                 12680017
126900                                                                  12690017
127000     EVALUATE TRUE                                                12700017
127100         WHEN AP019-ENTRY-NBR NOT EQUAL TO SPACES                 12710017
127200              MOVE AP019-ENTRY-NBR TO AP018-REFERENCE-ID-NBR      12720017
127300              SET  AP018-ENTRY-NBR TO TRUE                        12730017
127400         WHEN AP019-BOL-ID NOT EQUAL TO SPACES                    12740017
127500              MOVE AP019-BOL-ID TO AP018-REFERENCE-ID-NBR         12750017
127600              SET  AP018-BOL-NBR TO TRUE                          12760017
127700         WHEN AP019-CONTAINER-ID NOT EQUAL TO SPACES              12770017
127800              MOVE AP019-CONTAINER-ID TO AP018-REFERENCE-ID-NBR   12780017
127900              SET  AP018-CONTAINER-ID TO TRUE                     12790017
128000     END-EVALUATE.                                                12800017
128100                                                                  12810017
128200*** ENSURE THAT CONTAINER ID IS MOVED TO FIELD, SO THAT CONTAINER 12820017
128300*** ID SPECIFIC ERRORS WILL HAVE VALID CONTAINER ID ON REPORT     12830017
128400     PERFORM VARYING WS-ERR-IDX FROM 1 BY 1                       12840017
128500       UNTIL WS-ERR-IDX > 10                                      12850017
128600          OR WS-ERR-CDE(WS-ERR-IDX) = SPACES                      12860017
128700        IF (WS-ERR-CDE(WS-ERR-IDX) = 49 OR                        12870017
128800           WS-ERR-CDE(WS-ERR-IDX) = 51)                           12880017
128900           MOVE AP019-CONTAINER-ID TO AP018-REFERENCE-ID-NBR      12890017
129000           SET  AP018-CONTAINER-ID TO TRUE                        12900017
129100           MOVE IMCNTK-DCONSLR-SCAC-ID TO AP018-DECON-SCAC-CDE    12910017
129200        END-IF                                                    12920017
129300     END-PERFORM.                                                 12930017
129400                                                                  12940017
129500     PERFORM W100-WRITE-REJ-PEND-FILE.                            12950017
129600                                                                  12960017
129700                                                                  12970017
129800*----------------------------------------------------------------*12980017
129900*    FORMATS THE INVOICE LOAD RECORD BEFORE WRITING TO FILE.     *12990017
130000*----------------------------------------------------------------*13000017
130100 E200-FORMAT-INVC-LOAD-REC.                                       13010017
130200                                                                  13020017
130300     EVALUATE TRUE                                                13030017
130400         WHEN PENDING-REC                                         13040017
130500              MOVE 'PR' TO AP016-STATUS-CDE                       13050017
130600         WHEN NORMAL-REC                                          13060017
130700              MOVE 'EN' TO AP016-STATUS-CDE                       13070017
130800     END-EVALUATE.                                                13080017
130900                                                                  13090017
131000     MOVE AP019-VENDOR-NBR           TO AP016-REMIT-TO-DUN-NBR.   13100017
131100     MOVE AP019-PO-NBR               TO AP016-PO-NBR.             13110017
131200     MOVE AP019-INVOICE-NBR          TO AP016-INVC-ID.            13120017
131300     MOVE PV-INVC-DTE                TO AP016-INVC-DTE.           13130017
131400     MOVE 'N'                        TO AP016-HOLD-IND.           13140017
131500     MOVE 'EE'                       TO AP016-ENTR-MTHD-CDE.      13150017
131600     MOVE AP019-NET-INVC-AMT         TO AP016-INVC-NET-COST-AMT.  13160017
131700     MOVE AP019-TERMS-TYP-CDE        TO AP016-TERM-TYP-CDE.       13170017
131800     MOVE AP019-TERMS-BASIS-DTE-CDE  TO AP016-TERM-BASIS-DTE-CDE. 13180017
131900     MOVE AP019-NET-DAYS-DUE         TO AP016-NET-DUE-DAY-QTY.    13190017
132000     MOVE AP019-ENTRY-NBR            TO AP016-IMPRT-ENTR-NBR.     13200017
132100     MOVE AP019-BOL-ID               TO AP016-IMPRT-BOL-ID.       13210017
132200     MOVE AP019-CONTAINER-ID         TO AP016-CONTAINER-NBR.      13220017
132300     MOVE AP019-CUSTOMER-REF-NBR     TO AP016-BKR-REF-NBR.        13230017
132400                                                                  13240017
132500*** FUEL SURCHARGES WILL BE ROLLED INTO THE DRAYAGE CHARGE BEFORE 13250017
132600*** INVOICE IS LOADED ONTO OUR TABLES                             13260017
132700     SET TALCHRG-INDEX TO 1.                                      13270017
132800     PERFORM VARYING AP019-IDX FROM 1 BY 1                        13280017
132900         UNTIL (AP019-IDX > 20)                                   13290017
133000            OR (AP019-CHARGE-CDE(AP019-IDX) = SPACES)             13300017
133100          IF AP019-FUEL-SURCHG-CDE(AP019-IDX)                     13310017
133200             CONTINUE                                             13320017
133300          ELSE                                                    13330017
133400             MOVE 'C'   TO AP016-ALW-CHRG-TYP-CDE(TALCHRG-INDEX)  13340017
133500             MOVE AP019-CHARGE-AMT(AP019-IDX)                     13350017
133600                            TO AP016-ALW-CHRG-AMT(TALCHRG-INDEX)  13360017
133700             IF AP019-CHARGE-CDE(AP019-IDX) = 'DRA' AND           13370017
133800                FUEL-SURCHG-FND                                   13380017
133900                SET NO-FUEL-SURCHG TO TRUE                        13390017
134000                ADD FUEL-SURCHG-TOT                               13400017
134100                            TO AP016-ALW-CHRG-AMT(TALCHRG-INDEX)  13410017
134200             END-IF                                               13420017
134300             IF AP019-MISC-CHRG-CDES(AP019-IDX)                   13430017
134400                MOVE 'MIS'  TO AP016-ALW-CHRG-CDE(TALCHRG-INDEX)  13440017
134500             ELSE                                                 13450017
134600                MOVE AP019-CHARGE-CDE(AP019-IDX)                  13460017
134700                            TO AP016-ALW-CHRG-CDE(TALCHRG-INDEX)  13470017
134800             END-IF                                               13480017
134900             SET TALCHRG-INDEX UP BY 1                            13490017
135000          END-IF                                                  13500017
135100     END-PERFORM.                                                 13510017
135200                                                                  13520017
135300     PERFORM W200-WRITE-LOAD-FILE.                                13530017
135400                                                                  13540017
135500                                                                  13550017
135600*----------------------------------------------------------------*13560017
135700*   FORMATS THE SURCHARGE REPORT RECORD BEFORE WRITING TO FILE.  *13570017
135800*----------------------------------------------------------------*13580017
135900 E300-FORMAT-SURCHG-REC.                                          13590017
136000                                                                  13600017
136100     EVALUATE TRUE                                                13610017
136200         WHEN NORMAL-REC                                          13620017
136300              MOVE SPACE TO AP079-PEND-RVW                        13630017
136400         WHEN PENDING-REC                                         13640017
136500              MOVE 'Y' TO AP079-PEND-RVW                          13650017
136600     END-EVALUATE                                                 13660017
136700                                                                  13670017
136800     MOVE AP019-VENDOR-NBR           TO AP079-VENDOR-NBR.         13680017
136900     MOVE AP019-VENDOR-NAME          TO AP079-VENDOR-NAME.        13690017
137000     MOVE AP019-PO-NBR               TO AP079-PO-NBR.             13700017
137100     MOVE AP019-INVOICE-NBR          TO AP079-INVOICE-NBR.        13710017
137200                                                                  13720017
137300     IF AP019-CONTAINER-ID = SPACES                               13730017
137400         MOVE SPACES TO AP079-CONTAINER-ID                        13740017
137500                        AP079-CONTNR-PU-DTE                       13750017
137600                        AP079-DECON-SCAC-ID                       13760017
137700     ELSE                                                         13770017
137800         MOVE AP019-CONTAINER-ID TO AP079-CONTAINER-ID            13780017
137900         IF CONTNR-PU-DTE-FND                                     13790017
138000             MOVE PV-CONTNR-PU-DTE TO AP079-CONTNR-PU-DTE         13800017
138100         ELSE                                                     13810017
138200             MOVE SPACES TO AP079-CONTNR-PU-DTE                   13820017
138300         END-IF                                                   13830017
138400         IF DECONS-SCAC-FND                                       13840017
138500             MOVE IMCNTK-DCONSLR-SCAC-ID TO AP079-DECON-SCAC-ID   13850017
138600             MOVE SPACES TO IMCNTK-DCONSLR-SCAC-ID                13860017
138700         ELSE                                                     13870017
138800             MOVE SPACES TO AP079-DECON-SCAC-ID                   13880017
138900         END-IF                                                   13890017
139000     END-IF.                                                      13900017
139100                                                                  13910017
139200     SET AP079-IDX TO 1.                                          13920017
139300     PERFORM VARYING AP019-IDX FROM 1 BY 1                        13930017
139400         UNTIL (AP019-IDX > 20)                                   13940017
139500            OR (AP019-CHARGE-CDE(AP019-IDX) = SPACES)             13950017
139600              MOVE AP019-CHARGE-AMT(AP019-IDX)                    13960017
139700                             TO AP079-CHARGE-AMT(AP079-IDX)       13970017
139800              MOVE AP019-CHARGE-CDE(AP019-IDX)                    13980017
139900                             TO AP079-CHARGE-CDE(AP079-IDX)       13990017
140000              SET AP079-IDX UP BY 1                               14000017
140100     END-PERFORM.                                                 14010017
140200                                                                  14020017
140300     PERFORM W300-WRITE-SURCHG-FILE.                              14030017
140400                                                                  14040017
140500                                                                  14050017
140600*----------------------------------------------------------------*14060017
140700*    CHECK FOR WHICH EXCEEDED CHARGE SWITCHES WERE SET TO TRUE.  *14070017
140800*----------------------------------------------------------------*14080017
140900 F100-CHECK-FOR-EXCEED-CHARGES.                                   14090017
141000                                                                  14100017
141100     IF (AP019-CHARGE-CDE(AP019-IDX) = 'ENT') AND                 14110017
141200        (PS-ENTRY-EXCEEDED)                                       14120017
141300        PERFORM F200-MOVE-CHARGES                                 14130017
141400     END-IF.                                                      14140017
141500                                                                  14150017
141600     IF (AP019-CHARGE-CDE(AP019-IDX) = 'CTX') AND                 14160017
141700        (PS-EXAM-EXCEEDED)                                        14170017
141800        PERFORM F200-MOVE-CHARGES                                 14180017
141900     END-IF.                                                      14190017
142000                                                                  14200017
142100     IF (AP019-CHARGE-CDE(AP019-IDX) = 'MIS' OR '690') AND        14210017
142200        (PS-MISC-EXCEEDED)                                        14220017
142300        PERFORM F200-MOVE-CHARGES                                 14230017
142400     END-IF.                                                      14240017
142500                                                                  14250017
142600     IF (AP019-CHARGE-CDE(AP019-IDX) = 'REE') AND                 14260017
142700        (PS-REGULATORY-EXCEEDED)                                  14270017
142800        PERFORM F200-MOVE-CHARGES                                 14280017
142900     END-IF.                                                      14290017
143000                                                                  14300017
143100     IF (AP019-CHARGE-CDE(AP019-IDX) = 'DRA') AND                 14310017
143200        (PS-DRAYAGE-EXCEEDED OR DRAY-SCAC-TOLERANCE-ERR OR        14320017
143300         DRAY-LOC-NOT-FOUND-ERR OR DRAY-SCAC-RATE-UNKNOWN-ERR)    14330017
143400        PERFORM F200-MOVE-CHARGES                                 14340017
143500     END-IF.                                                      14350017
143600                                                                  14360017
143700     IF (AP019-CHARGE-CDE(AP019-IDX) = 'DDF') AND                 14370017
143800        (PS-DECONSOLID-EXCEEDED)                                  14380017
143900        PERFORM F200-MOVE-CHARGES                                 14390017
144000     END-IF.                                                      14400017
144100                                                                  14410017
144200     IF (AP019-CHARGE-CDE(AP019-IDX) = 'BSS') AND                 14420017
144300        (PS-MPF-FEE-EXCEEDED)                                     14430017
144400        PERFORM F200-MOVE-CHARGES                                 14440017
144500     END-IF.                                                      14450017
144600                                                                  14460017
144700                                                                  14470017
144800*----------------------------------------------------------------*14480017
144900*    MOVE CHARGES FROM THE AUDIT RECORD TO THE REJECT RECORD     *14490017
145000*----------------------------------------------------------------*14500017
145100 F200-MOVE-CHARGES.                                               14510017
145200                                                                  14520017
145300     MOVE AP019-CHARGE-AMT(AP019-IDX)                             14530017
145400                                    TO AP018-CHARGE-AMT(CHRG-IDX) 14540017
145500     MOVE AP019-CHARGE-CDE(AP019-IDX)                             14550017
145600                                    TO AP018-CHARGE-CDE(CHRG-IDX).14560017
145700     SET CHRG-IDX UP BY 1.                                        14570017
145800                                                                  14580017
145900*----------------------------------------------------------------*14590017
146000*    INSERT RATE TO INTERNAL TABLE                                14600017
146100*----------------------------------------------------------------*14610017
146200 I100-INSERT-DRAY-RATES.                                          14620017
146300                                                                  14630017
146400     MOVE SPACES TO WS-HOLD-BEG-DTE                               14640017
146500                    WS-HOLD-END-DTE                               14650017
146600                    WS-FRMT-BEG-DTE                               14660017
146700                    WS-FRMT-END-DTE.                              14670017
146800                                                                  14680017
146900     IF TRT00050-VND-NBR = TBL-DRAY-VND(IDX2) AND                 14690017
147000        TRT00050-DCONSLR-SCAC-ID = TBL-DRAY-SCAC(IDX2)            14700017
147100        SET IDX2A UP BY +1                                        14710017
147200        MOVE TRT00050-POE-STD-EDI-CDE                             14720017
147300                               TO TBL-DRAY-POE-CDE(IDX2, IDX2A)   14730017
147400        MOVE TRT00050-TRANS-RT-AMT TO TBL-DRAY-RATE(IDX2, IDX2A)  14740017
147500        MOVE TRT00050-EFF-RT-BEG-DTE TO WS-HOLD-BEG-DTE           14750017
147600        STRING WS-BEG-DTE-CCYY  DELIMITED BY SPACE                14760017
147700               WS-BEG-DTE-MM    DELIMITED BY SPACE                14770017
147800               WS-BEG-DTE-DD    DELIMITED BY SPACE                14780017
147900          INTO WS-FRMT-BEG-DTE                                    14790017
148000        MOVE WS-FRMT-BEG-DTE TO TBL-DRAY-BEG-DTE(IDX2, IDX2A)     14800017
148100        MOVE TRT00050-EFF-RT-END-DTE TO WS-HOLD-END-DTE           14810017
148200        STRING WS-END-DTE-CCYY  DELIMITED BY SPACE                14820017
148300               WS-END-DTE-MM    DELIMITED BY SPACE                14830017
148400               WS-END-DTE-DD    DELIMITED BY SPACE                14840017
148500          INTO WS-FRMT-END-DTE                                    14850017
148600        MOVE WS-FRMT-END-DTE TO TBL-DRAY-END-DTE(IDX2, IDX2A)     14860017
148700     ELSE                                                         14870017
148800        IF NOT-FIRST-VENDOR                                       14880017
148900           SET IDX2 UP BY +1                                      14890017
149000        END-IF                                                    14900017
149100        SET IDX2A TO +1                                           14910017
149200        MOVE TRT00050-VND-NBR TO TBL-DRAY-VND(IDX2)               14920017
149300        MOVE TRT00050-DCONSLR-SCAC-ID TO TBL-DRAY-SCAC(IDX2)      14930017
149400        MOVE TRT00050-POE-STD-EDI-CDE                             14940017
149500                               TO TBL-DRAY-POE-CDE(IDX2, IDX2A)   14950017
149600        MOVE TRT00050-TRANS-RT-AMT TO TBL-DRAY-RATE(IDX2, IDX2A)  14960017
149700        MOVE TRT00050-EFF-RT-BEG-DTE TO WS-HOLD-BEG-DTE           14970017
149800        STRING WS-BEG-DTE-CCYY  DELIMITED BY SPACE                14980017
149900               WS-BEG-DTE-MM    DELIMITED BY SPACE                14990017
150000               WS-BEG-DTE-DD    DELIMITED BY SPACE                15000017
150100          INTO WS-FRMT-BEG-DTE                                    15010017
150200        MOVE WS-FRMT-BEG-DTE TO TBL-DRAY-BEG-DTE(IDX2, IDX2A)     15020017
150300        MOVE TRT00050-EFF-RT-END-DTE TO WS-HOLD-END-DTE           15030017
150400        STRING WS-END-DTE-CCYY  DELIMITED BY SPACE                15040017
150500               WS-END-DTE-MM    DELIMITED BY SPACE                15050017
150600               WS-END-DTE-DD    DELIMITED BY SPACE                15060017
150700          INTO WS-FRMT-END-DTE                                    15070017
150800        MOVE WS-FRMT-END-DTE TO TBL-DRAY-END-DTE(IDX2, IDX2A)     15080017
150900        SET NOT-FIRST-VENDOR TO TRUE                              15090017
151000     END-IF.                                                      15100017
151100                                                                  15110017
151200*----------------------------------------------------------------*15120017
151300*    INSERT RATE TO INTERNAL TABLE                                15130017
151400*----------------------------------------------------------------*15140017
151500 I200-INSERT-DCN-RATES.                                           15150017
151600                                                                  15160017
151700     MOVE SPACES TO WS-HOLD-BEG-DTE                               15170017
151800                    WS-HOLD-END-DTE                               15180017
151900                    WS-FRMT-BEG-DTE                               15190017
152000                    WS-FRMT-END-DTE.                              15200017
152100                                                                  15210017
152200     IF TRT00050-VND-NBR = TBL-DEC-VND(IDX3)                      15220017
152300        SET IDX3A UP BY +1                                        15230017
152400        MOVE TRT00050-POE-STD-EDI-CDE                             15240017
152500                               TO TBL-DEC-POE-CDE(IDX3, IDX3A)    15250017
152600        MOVE TRT00050-TRANS-RT-AMT TO TBL-DEC-RATE(IDX3, IDX3A)   15260017
152700        MOVE TRT00050-EFF-RT-BEG-DTE TO WS-HOLD-BEG-DTE           15270017
152800        STRING WS-BEG-DTE-CCYY  DELIMITED BY SPACE                15280017
152900               WS-BEG-DTE-MM    DELIMITED BY SPACE                15290017
153000               WS-BEG-DTE-DD    DELIMITED BY SPACE                15300017
153100          INTO WS-FRMT-BEG-DTE                                    15310017
153200        MOVE WS-FRMT-BEG-DTE TO TBL-DEC-BEG-DTE(IDX3, IDX3A)      15320017
153300        MOVE TRT00050-EFF-RT-END-DTE TO WS-HOLD-END-DTE           15330017
153400        STRING WS-END-DTE-CCYY  DELIMITED BY SPACE                15340017
153500               WS-END-DTE-MM    DELIMITED BY SPACE                15350017
153600               WS-END-DTE-DD    DELIMITED BY SPACE                15360017
153700          INTO WS-FRMT-END-DTE                                    15370017
153800        MOVE WS-FRMT-END-DTE TO TBL-DEC-END-DTE(IDX3, IDX3A)      15380017
153900     ELSE                                                         15390017
154000        IF NOT-FIRST-VENDOR                                       15400017
154100           SET IDX3 UP BY +1                                      15410017
154200        END-IF                                                    15420017
154300        SET IDX3A TO +1                                           15430017
154400        MOVE TRT00050-VND-NBR TO TBL-DEC-VND(IDX3)                15440017
154500        MOVE TRT00050-POE-STD-EDI-CDE                             15450017
154600                               TO TBL-DEC-POE-CDE(IDX3, IDX3A)    15460017
154700        MOVE TRT00050-TRANS-RT-AMT TO TBL-DEC-RATE(IDX3, IDX3A)   15470017
154800        MOVE TRT00050-EFF-RT-BEG-DTE TO WS-HOLD-BEG-DTE           15480017
154900        STRING WS-BEG-DTE-CCYY  DELIMITED BY SPACE                15490017
155000               WS-BEG-DTE-MM    DELIMITED BY SPACE                15500017
155100               WS-BEG-DTE-DD    DELIMITED BY SPACE                15510017
155200          INTO WS-FRMT-BEG-DTE                                    15520017
155300        MOVE WS-FRMT-BEG-DTE TO TBL-DEC-BEG-DTE(IDX3, IDX3A)      15530017
155400        MOVE TRT00050-EFF-RT-END-DTE TO WS-HOLD-END-DTE           15540017
155500        STRING WS-END-DTE-CCYY  DELIMITED BY SPACE                15550017
155600               WS-END-DTE-MM    DELIMITED BY SPACE                15560017
155700               WS-END-DTE-DD    DELIMITED BY SPACE                15570017
155800          INTO WS-FRMT-END-DTE                                    15580017
155900        MOVE WS-FRMT-END-DTE TO TBL-DEC-END-DTE(IDX3, IDX3A)      15590017
156000        SET NOT-FIRST-VENDOR TO TRUE                              15600017
156100     END-IF.                                                      15610017
156200                                                                  15620017
156300*----------------------------------------------------------------*15630017
156400*    INITIALIZE ERROR CODE TABLE.                                 15640017
156500*----------------------------------------------------------------*15650017
156600 I300-INITIALIZE-ERR-TBL.                                         15660017
156700                                                                  15670017
156800     PERFORM VARYING WS-ERR-IDX FROM 1 BY 1                       15680017
156900        UNTIL WS-ERR-IDX > 10                                     15690017
157000        MOVE ZEROES TO WS-ERR-CDE(WS-ERR-IDX)                     15700017
157100     END-PERFORM.                                                 15710017
157200                                                                  15720017
157300     SET WS-ERR-IDX TO +1.                                        15730017
157400                                                                  15740017
157500*----------------------------------------------------------------*15750017
157600*    LOAD DRAYAGE RATES.                                          15760017
157700*----------------------------------------------------------------*15770017
157800 L100-LOAD-DRAY-RATES.                                            15780017
157900                                                                  15790017
158000      SET NOT-END-OF-RATE-CSR TO TRUE.                            15800017
158100      SET FIRST-VENDOR TO TRUE.                                   15810017
158200      MOVE 'DRA' TO VNT00001-VND-CPBL-CDE.                        15820017
158300      SET IDX2 TO +1.                                             15830017
158400      SET IDX2A TO +1.                                            15840017
158500                                                                  15850017
158600      PERFORM X100-OPEN-RATE-CSR.                                 15860017
158700      PERFORM UNTIL END-OF-RATE-CSR                               15870017
158800         PERFORM S800-FETCH-RATE-CSR                              15880017
158900         IF NOT-END-OF-RATE-CSR                                   15890017
159000            PERFORM I100-INSERT-DRAY-RATES                        15900017
159100         END-IF                                                   15910017
159200      END-PERFORM.                                                15920017
159300      PERFORM X200-CLOSE-RATE-CSR.                                15930017
159400                                                                  15940017
159500*----------------------------------------------------------------*15950017
159600*    LOAD DECON RATES.                                            15960017
159700*----------------------------------------------------------------*15970017
159800 L200-LOAD-DECON-RATES.                                           15980017
159900                                                                  15990017
160000      SET NOT-END-OF-RATE-CSR TO TRUE.                            16000017
160100      SET FIRST-VENDOR TO TRUE.                                   16010017
160200      MOVE 'DCN' TO VNT00001-VND-CPBL-CDE.                        16020017
160300      SET IDX3 TO +1.                                             16030017
160310      SET IDX3A TO +1.                                            16031017
160320                                                                  16032017
160330      PERFORM X100-OPEN-RATE-CSR.                                 16033017
160340      PERFORM UNTIL END-OF-RATE-CSR                               16034017
160350         PERFORM S800-FETCH-RATE-CSR                              16035017
160360         IF NOT-END-OF-RATE-CSR                                   16036017
160370            PERFORM I200-INSERT-DCN-RATES                         16037017
160380         END-IF                                                   16038017
160381      END-PERFORM.                                                16038117
160382      PERFORM X200-CLOSE-RATE-CSR.                                16038217
160383                                                                  16038317
160384*----------------------------------------------------------------*16038417
160385*    READS PAYMENT-DAYS-FILE INTO COPYBOOK.                      *16038517
160386*----------------------------------------------------------------*16038617
160387 R100-READ-FILE.                                                  16038717
160388                                                                  16038817
160389     READ EDI-IMP-INVC-AUD-FILE INTO AP019-IMPORT-EXP-AUDIT-RECORD16038917
160390         AT END                                                   16039017
160400             SET END-OF-FILE TO TRUE                              16040017
160500         NOT AT END                                               16050017
160600*            MOVE AP019-VENDOR-NBR  TO WS-VENDOR-NBR              16060017
160700             MOVE AP019-INVC-DTE-CC TO PV-INVC-DTE-CC             16070017
160800             MOVE AP019-INVC-DTE-YY TO PV-INVC-DTE-YY             16080017
160900             MOVE AP019-INVC-DTE-MM TO PV-INVC-DTE-MM             16090017
161000             MOVE AP019-INVC-DTE-DD TO PV-INVC-DTE-DD             16100017
161100             MOVE '-'               TO PV-DASH-1                  16110017
161200                                       PV-DASH-2                  16120017
161210             ADD +1 TO PV-FILE-REC-COUNT.                         16121017
161220                                                                  16122017
161230                                                                  16123017
161240*----------------------------------------------------------------*16124017
161250*    CHECKS FOR DUPLICATE VENDOR/INVOICE ON TINVOIC TABLE.       *16125017
161260*----------------------------------------------------------------*16126017
161270 S100-CHECK-TINVOIC-VENDOR.                                       16127017
161280                                                                  16128017
161290     EXEC SQL                                                     16129017
161300         SELECT '1'                                               16130017
161400           INTO  :PV-ONE                                          16140017
161500           FROM SYSIBM.SYSDUMMY1 X                                16150017
161600          WHERE EXISTS                                            16160017
161700               (SELECT 1                                          16170017
161800                  FROM TINVOIC A                                  16180017
161900                 WHERE A.INVC_ID     = :AP019-INVOICE-NBR         16190017
162000                   AND A.RMIT_VND_ID = :AP019-VENDOR-NBR          16200017
162100                   AND X.IBMREQD = X.IBMREQD)                     16210017
162200     END-EXEC.                                                    16220017
162300                                                                  16230017
162400     EVALUATE TRUE                                                16240017
162500         WHEN SQLCODE = ZERO                                      16250017
162600            SET DUPL-VND-INV-DB-ERR                               16260017
162700                REJECT-REC TO TRUE                                16270017
162800            MOVE WS010-ERROR-CODES TO                             16280017
162900                      WS-ERR-CDE(WS-ERR-IDX)                      16290017
163000            IF WS-ERR-IDX NOT = 10                                16300017
163100               SET WS-ERR-IDX UP BY 1                             16310017
163200            END-IF                                                16320017
163300                                                                  16330017
163400         WHEN SQLCODE = +100                                      16340017
163500            CONTINUE                                              16350017
163600                                                                  16360017
163700         WHEN SQLWARN0 NOT = SPACES                               16370017
163800         WHEN SQLCODE NOT  = ZERO                                 16380017
163900            MOVE 'S100-CHECK-TINVOIC-VENDOR'                      16390017
164000                                TO AA-PARAGRAPH-NAME              16400017
164100            MOVE 'UNSUCCESSFUL EXISTENCE CHECK'                   16410017
164200                                TO AA-DB2-OPERATION               16420017
164300            MOVE 'TINVOIC'      TO AA-DB2-TABLE-1                 16430017
164400            MOVE SPACES         TO AA-DB2-TABLE-2                 16440017
164500            PERFORM Z999-DB2-ABEND                                16450017
164600     END-EVALUATE.                                                16460017
164700                                                                  16470017
164800                                                                  16480017
164900*----------------------------------------------------------------*16490017
165000*    CHECKS FOR DUPLICATE PO/INVOICE ON TINVOIC TABLE.           *16500017
165100*----------------------------------------------------------------*16510017
165200 S200-CHECK-TINVOIC-PO.                                           16520017
165300                                                                  16530017
165400     MOVE AP019-PO-NBR TO PV-PO-NBR.                              16540017
165500                                                                  16550017
165600     EXEC SQL                                                     16560017
165700         SELECT '1'                                               16570017
165800           INTO  :PV-ONE                                          16580017
165900           FROM SYSIBM.SYSDUMMY1 X                                16590017
166000          WHERE EXISTS                                            16600017
166100               (SELECT 1                                          16610017
166200                  FROM TINVOIC A                                  16620017
166300                 WHERE A.PO_NBR  = :PV-PO-NBR                     16630017
166400                   AND A.INVC_ID = :AP019-INVOICE-NBR             16640017
166500                   AND X.IBMREQD = X.IBMREQD)                     16650017
166600     END-EXEC.                                                    16660017
166700                                                                  16670017
166800     EVALUATE TRUE                                                16680017
166900         WHEN SQLCODE = ZERO                                      16690017
167000            SET DUPL-PO-INV-DB-ERR                                16700017
167100                REJECT-REC TO TRUE                                16710017
167200            MOVE WS010-ERROR-CODES TO                             16720017
167300                      WS-ERR-CDE(WS-ERR-IDX)                      16730017
167400            IF WS-ERR-IDX NOT = 10                                16740017
167410               SET WS-ERR-IDX UP BY 1                             16741017
167420            END-IF                                                16742017
167430                                                                  16743017
167440         WHEN SQLCODE = +100                                      16744017
167450            CONTINUE                                              16745017
167460                                                                  16746017
167470         WHEN SQLWARN0 NOT = SPACES                               16747017
167480         WHEN SQLCODE NOT  = ZERO                                 16748017
167490            MOVE 'S200-CHECK-TINVOIC-PO'                          16749017
167500                                TO AA-PARAGRAPH-NAME              16750017
167600            MOVE 'UNSUCCESSFUL EXISTENCE CHECK'                   16760017
167700                                TO AA-DB2-OPERATION               16770017
167800            MOVE 'TINVOIC'      TO AA-DB2-TABLE-1                 16780017
167900            MOVE SPACES         TO AA-DB2-TABLE-2                 16790017
168000            PERFORM Z999-DB2-ABEND                                16800017
168100     END-EVALUATE.                                                16810017
168200                                                                  16820017
168210*----------------------------------------------------------------*16821017
168220*    CHECKS FOR DUPLICATE PO/INVOICE ON TINVOIC TABLE            *16822017
168221*       USING THE BRK REF NBR AS INVOICE NBR                     *16822117
168222*----------------------------------------------------------------*16822217
168223 S250-CHECK-TINVOIC-POBKR.                                        16822317
168224                                                                  16822417
168225     EXEC SQL                                                     16822517
168226        SELECT '1'                                                16822617
168227          INTO  :PV-ONE                                           16822717
168228          FROM SYSIBM.SYSDUMMY1 X                                 16822817
168229        WHERE EXISTS                                              16822917
168230            (SELECT 1                                             16823017
168240               FROM TINVOIC                                       16824017
168250               WHERE PO_NBR  = :PV-PO-NBR                         16825017
168260                 AND INVC_ID = :AP019-CUSTOMER-REF-NBR            16826017
168270                 AND X.IBMREQD = X.IBMREQD)                       16827017
168280     END-EXEC                                                     16828017
168290                                                                  16829017
168300     EVALUATE TRUE                                                16830017
168400        WHEN SQLCODE = ZERO                                       16840017
168500           SET  DUPL-PO-BRK-DB-ERR TO TRUE                        16850017
168510           MOVE WS010-ERROR-CODES  TO WS-ERR-CDE(WS-ERR-IDX)      16851017
168520           IF WS-ERR-IDX NOT < 10                                 16852017
168530              SET WS-ERR-IDX UP BY 1                              16853017
168540           END-IF                                                 16854017
168550        WHEN SQLCODE = +100                                       16855017
168560           CONTINUE                                               16856017
168570        WHEN SQLWARN0 NOT = SPACES                                16857017
168580        WHEN SQLCODE  NOT = +100                                  16858017
168590           MOVE 'S250-CHECK-TINVOIC-POBKR'                        16859017
168600                               TO AA-PARAGRAPH-NAME               16860017
168601           MOVE 'UNSUCCESSFUL EXISTENCE CHECK'                    16860117
168602                               TO AA-DB2-OPERATION                16860217
168603           MOVE 'TINVOIC'      TO AA-DB2-TABLE-1                  16860317
168604           MOVE SPACES         TO AA-DB2-TABLE-2                  16860417
168605           PERFORM Z999-DB2-ABEND                                 16860517
168606     END-EVALUATE.                                                16860617
168607                                                                  16860717
168608*----------------------------------------------------------------*16860817
168609*    CHECKS FOR DUPLICATE VENDOR/INVOICE ON TADJRNL TABLE.       *16860917
168610*----------------------------------------------------------------*16861017
168611 S300-CHECK-TADJRNL.                                              16861117
168612                                                                  16861217
168613     STRING AP019-INVOICE-NBR   DELIMITED BY SPACE                16861317
168614            PC-PERCENTS         DELIMITED BY SIZE                 16861417
168615            INTO WS-INVC-FOR-LIKE-COND.                           16861517
168616     MOVE AP019-PO-NBR TO PV-PO-NBR.                              16861617
168617     DISPLAY 'S300-CHECK-TADJRNL'.                                16861717
168618     DISPLAY 'VENDOR ID = '  AP019-VENDOR-NBR.                    16861817
168619     DISPLAY 'DOC CHECK = '  WS-INVC-FOR-LIKE-COND.               16861917
168620     DISPLAY 'PO NBR = '  AP019-PO-NBR.                           16862017
168621     DISPLAY 'DOC DT = '  PV-INVC-DTE.                            16862117
168630                                                                  16863017
168640     EXEC SQL                                                     16864017
168650         SELECT '1'                                               16865017
168660           INTO  :PV-ONE                                          16866017
168670           FROM SYSIBM.SYSDUMMY1 X                                16867017
168680          WHERE EXISTS                                            16868017
168690               (SELECT 1                                          16869017
168700                  FROM TADJRNL A                                  16870017
168800                 WHERE A.VND_NBR = :AP019-VENDOR-NBR              16880017
168900                   AND A.DOC_NBR LIKE :WS-INVC-FOR-LIKE-COND      16890017
169000                   AND A.PO_NBR  = :PV-PO-NBR                     16900017
169100                   AND A.DOC_DTE = :PV-INVC-DTE                   16910017
169200                   AND X.IBMREQD = X.IBMREQD)                     16920017
169300     END-EXEC.                                                    16930017
169400                                                                  16940017
169500     EVALUATE TRUE                                                16950017
169600         WHEN SQLCODE = ZERO                                      16960017
169700            SET DUPL-VND-INV-ADJ-ERR                              16970017
169800                REJECT-REC TO TRUE                                16980017
169900            MOVE WS010-ERROR-CODES TO                             16990017
170000                      WS-ERR-CDE(WS-ERR-IDX)                      17000017
170100            IF WS-ERR-IDX NOT = 10                                17010017
170200               SET WS-ERR-IDX UP BY 1                             17020017
170300            END-IF                                                17030017
170400                                                                  17040017
170500         WHEN SQLCODE = +100                                      17050017
170600            CONTINUE                                              17060017
170700                                                                  17070017
170800         WHEN SQLWARN0 NOT = SPACES                               17080017
170900         WHEN SQLCODE NOT  = ZERO                                 17090017
171000            MOVE 'S300-CHECK-TADJRNL'                             17100017
171100                                TO AA-PARAGRAPH-NAME              17110017
171110            MOVE 'UNSUCCESSFUL EXISTENCE CHECK'                   17111017
171120                                TO AA-DB2-OPERATION               17112017
171130            MOVE 'TADJRNL'      TO AA-DB2-TABLE-1                 17113017
171140            MOVE SPACES         TO AA-DB2-TABLE-2                 17114017
171150            PERFORM Z999-DB2-ABEND                                17115017
171160     END-EVALUATE.                                                17116017
171170                                                                  17117017
171180*----------------------------------------------------------------*17118017
171190*    CHECKS FOR DUPLICATE VENDOR/INVOICE ON TADJRNL TABLE        *17119017
171200*            USING THE BROKER REFERENCE # AS DOC #.              *17120017
171300*----------------------------------------------------------------*17130017
171400 S350-CHECK-TADJRNL-BRK.                                          17140017
171410                                                                  17141017
171420     STRING AP019-CUSTOMER-REF-NBR DELIMITED BY SPACE             17142017
171430            PC-PERCENTS         DELIMITED BY SIZE                 17143017
171440            INTO WS-INVC-FOR-LIKE-COND.                           17144017
171441     DISPLAY 'S350-CHECK-TADJRNL-BRK'.                            17144117
171442     DISPLAY 'VENDOR ID = '  AP019-VENDOR-NBR.                    17144217
171443     DISPLAY 'DOC CHECK = '  WS-INVC-FOR-LIKE-COND.               17144317
171444     DISPLAY 'PO NBR = '  AP019-PO-NBR.                           17144417
171445     DISPLAY 'DOC DT = '  PV-INVC-DTE.                            17144517
171450                                                                  17145017
171460     EXEC SQL                                                     17146017
171470         SELECT '1'                                               17147017
171480           INTO  :PV-ONE                                          17148017
171490           FROM SYSIBM.SYSDUMMY1 X                                17149017
171500          WHERE EXISTS                                            17150017
171600               (SELECT 1                                          17160017
171700                  FROM TADJRNL A                                  17170017
171800                 WHERE A.VND_NBR = :AP019-VENDOR-NBR              17180017
171900                   AND A.DOC_NBR LIKE :WS-INVC-FOR-LIKE-COND      17190017
171910                   AND A.PO_NBR  = :PV-PO-NBR                     17191017
171920                   AND A.DOC_DTE = :PV-INVC-DTE                   17192017
171930                   AND X.IBMREQD = X.IBMREQD)                     17193017
171940     END-EXEC.                                                    17194017
171950                                                                  17195017
171960     EVALUATE TRUE                                                17196017
171970         WHEN SQLCODE = ZERO                                      17197017
171980            SET DUPL-VND-INV-ADJ-ERR                              17198017
171990                REJECT-REC TO TRUE                                17199017
172000            MOVE WS010-ERROR-CODES TO WS-ERR-CDE(WS-ERR-IDX)      17200017
172001            IF WS-ERR-IDX < 10                                    17200117
172002               SET WS-ERR-IDX UP BY 1                             17200217
172003            END-IF                                                17200317
172004         WHEN SQLCODE = +100                                      17200417
172005            CONTINUE                                              17200517
172006         WHEN SQLWARN0 NOT = SPACES                               17200617
172007         WHEN SQLCODE NOT  = ZERO                                 17200717
172008            MOVE 'S350-CHECK-TADJRNL-BRK'                         17200817
172009                                TO AA-PARAGRAPH-NAME              17200917
172010            MOVE 'UNSUCCESSFUL EXISTENCE CHECK'                   17201017
172020                                TO AA-DB2-OPERATION               17202017
172021            MOVE 'TADJRNL'      TO AA-DB2-TABLE-1                 17202117
172022            MOVE SPACES         TO AA-DB2-TABLE-2                 17202217
172023            PERFORM Z999-DB2-ABEND                                17202317
172024     END-EVALUATE.                                                17202417
172025                                                                  17202517
172026                                                                  17202617
172027                                                                  17202717
172028*----------------------------------------------------------------*17202817
172029* SELECTS DECONSOLIDATION SCAC CODE AND CONTAINER PICKUP DATE    *17202917
172030* FOR PO/CONTAINER ID COMBINATION                                *17203017
172031*----------------------------------------------------------------*17203117
172032 S400-GET-DECONS-INFO.                                            17203217
172033                                                                  17203317
172034     EXEC SQL                                                     17203417
172035         SELECT A.DCONSLR_SCAC_ID                                 17203517
172036              , DATE(A.CONTNR_PU_TMST)                            17203617
172037           INTO :IMCNTK-DCONSLR-SCAC-ID                           17203717
172038              , :PV-CONTNR-PU-DTE                                 17203817
172039           FROM TIMCNTK A                                         17203917
172040              , TIMCNPO B                                         17204017
172050          WHERE B.PO_NBR         = :IMCNPO-PO-NBR                 17205017
172060            AND B.CONTNR_ID      = :IMCNPO-CONTNR-ID              17206017
172070            AND A.CONTNR_ID      = B.CONTNR_ID                    17207017
172080            AND A.CONTNR_SEQ_NBR = B.CONTNR_SEQ_NBR               17208017
172090     END-EXEC.                                                    17209017
172100                                                                  17210017
172200     EVALUATE TRUE                                                17220017
172300        WHEN SQLCODE = ZERO                                       17230017
172400        WHEN SQLCODE = -811                                       17240017
172500            SET DECONS-SCAC-FND                                   17250017
172600                CONTNR-PU-DTE-FND TO TRUE                         17260017
172700                                                                  17270017
172800        WHEN SQLCODE = +100                                       17280017
172900            SET DECONS-SCAC-NOT-FND                               17290017
173000                NO-CONTNR-PU-DTE-FND TO TRUE                      17300017
173100                                                                  17310017
173200        WHEN SQLWARN0 NOT = SPACES                                17320017
173300        WHEN SQLCODE  NOT = ZERO                                  17330017
173400            MOVE 'S400-GET-DECONS-INFO'                           17340017
173500                                TO AA-PARAGRAPH-NAME              17350017
173600            MOVE 'UNSUCCESSFUL SELECT'                            17360017
173700                                TO AA-DB2-OPERATION               17370017
173800            MOVE 'TIMCNTK'      TO AA-DB2-TABLE-1                 17380017
173900            MOVE 'TIMCNPO'      TO AA-DB2-TABLE-2                 17390017
174000            PERFORM Z999-DB2-ABEND                                17400017
174100     END-EVALUATE.                                                17410017
174200                                                                  17420017
174300*----------------------------------------------------------------*17430017
174400*    CHECKS FOR DUPLICATE PO/CONTAINER ON TEXINVC TABLE.         *17440017
174500*----------------------------------------------------------------*17450017
174600 S600-CHECK-PO-CONTAINER.                                         17460017
174700                                                                  17470017
174800     MOVE AP019-PO-NBR TO PV-PO-NBR.                              17480017
174900                                                                  17490017
175000     EXEC SQL                                                     17500017
175100         SELECT '1'                                               17510017
175200           INTO  :PV-ONE                                          17520017
175300           FROM SYSIBM.SYSDUMMY1 X                                17530017
175400          WHERE EXISTS                                            17540017
175500               (SELECT 1                                          17550017
175600                  FROM TEXINVC A                                  17560017
175700                     , TINVOIC B                                  17570017
175800                 WHERE A.PO_NBR  = :PV-PO-NBR                     17580017
175900                   AND A.PO_NBR  = B.PO_NBR                       17590017
176000                   AND A.INVC_ID = B.INVC_ID                      17600017
176100                   AND (A.IMPRT_BOL_ID = :AP019-CONTAINER-ID      17610017
176200                    OR A.INVC_CONTNR_ID = :AP019-CONTAINER-ID)    17620017
176300                   AND B.RMIT_VND_ID  = :AP019-VENDOR-NBR         17630017
176400                   AND X.IBMREQD = X.IBMREQD)                     17640017
176500     END-EXEC.                                                    17650017
176600                                                                  17660017
176700     EVALUATE TRUE                                                17670017
176800         WHEN SQLCODE = ZERO                                      17680017
176900            SET PO-CONTNR-DUP-INV-ERR                             17690017
177000                REJECT-REC TO TRUE                                17700017
177100            MOVE WS010-ERROR-CODES TO                             17710017
177200                      WS-ERR-CDE(WS-ERR-IDX)                      17720017
177300            IF WS-ERR-IDX NOT = 10                                17730017
177400               SET WS-ERR-IDX UP BY 1                             17740017
177500            END-IF                                                17750017
177600                                                                  17760017
177700         WHEN SQLCODE = +100                                      17770017
177800            CONTINUE                                              17780017
177900                                                                  17790017
178000         WHEN SQLWARN0 NOT = SPACES                               17800017
178100         WHEN SQLCODE NOT  = ZERO                                 17810017
178200            MOVE 'S600-CHECK-PO-CONTAINER'                        17820017
178300                                TO AA-PARAGRAPH-NAME              17830017
178400            MOVE 'UNSUCCESSFUL EXISTENCE CHECK'                   17840017
178500                                TO AA-DB2-OPERATION               17850017
178600            MOVE 'TEXINVC'      TO AA-DB2-TABLE-1                 17860017
178700            MOVE SPACES         TO AA-DB2-TABLE-2                 17870017
178800            PERFORM Z999-DB2-ABEND                                17880017
178900     END-EVALUATE.                                                17890017
179000                                                                  17900017
179100*----------------------------------------------------------------*17910017
179200*    SELECT BATCH CONTROL DATE                                    17920017
179300*----------------------------------------------------------------*17930017
179400 S700-SELECT-CNTL-DATE.                                           17940017
179500                                                                  17950017
179600     EXEC SQL                                                     17960017
179700         SELECT BTCH_PRC_DTE                                      17970017
179800              , BTCH_PRC_DTE - 365 DAYS                           17980017
179900           INTO :APCNTL-BTCH-PRC-DTE                              17990017
180000              , :WS-YEAR-AGO-DTE                                  18000017
180100           FROM TAPCNTL                                           18010017
180200     END-EXEC.                                                    18020017
180300                                                                  18030017
180400     EVALUATE TRUE                                                18040017
180500         WHEN SQLCODE = ZERO                                      18050017
180600            CONTINUE                                              18060017
180700                                                                  18070017
180800         WHEN SQLCODE NOT  = ZERO                                 18080017
180900            MOVE 'S700-SELECT-CNTL-DATE'                          18090017
180910                                TO AA-PARAGRAPH-NAME              18091017
180920            MOVE 'UNSUCCESSFUL FETCH'                             18092017
180930                                TO AA-DB2-OPERATION               18093017
180940            MOVE 'TAPCNTL'      TO AA-DB2-TABLE-1                 18094017
180950            MOVE SPACES         TO AA-DB2-TABLE-2                 18095017
180960            PERFORM Z999-DB2-ABEND                                18096017
180970     END-EVALUATE.                                                18097017
180980                                                                  18098017
180990*----------------------------------------------------------------*18099017
181000*    FETCH THE RATE CURSOR                                        18100017
181001*----------------------------------------------------------------*18100117
181002 S800-FETCH-RATE-CSR.                                             18100217
181003                                                                  18100317
181004     EXEC SQL                                                     18100417
181005         FETCH RATE-CSR                                           18100517
181006           INTO :TRT00050-TRANS-RT-AMT                            18100617
181007              , :TRT00050-EFF-RT-BEG-DTE                          18100717
181008              , :TRT00050-EFF-RT-END-DTE                          18100817
181009              , :TRT00050-POE-STD-EDI-CDE                         18100917
181010              , :TRT00050-VND-NBR                                 18101017
181011              , :TRT00050-DCONSLR-SCAC-ID :PV-DECON-NULL-IND      18101117
181012              , :EXTENT-SCAC-CDE                                  18101217
181013     END-EXEC.                                                    18101317
181014                                                                  18101417
181015     EVALUATE TRUE                                                18101517
181016         WHEN SQLCODE = ZERO                                      18101617
181017            CONTINUE                                              18101717
181018         WHEN SQLCODE = +100                                      18101817
181019            SET END-OF-RATE-CSR TO TRUE                           18101917
181020                                                                  18102017
181030         WHEN SQLWARN0 NOT = SPACES                               18103017
181031         WHEN SQLCODE NOT  = ZERO                                 18103117
181032            MOVE 'S800-FETCH-RATE-CSR'                            18103217
181033                                TO AA-PARAGRAPH-NAME              18103317
181034            MOVE 'UNSUCCESSFUL FETCH'                             18103417
181035                                TO AA-DB2-OPERATION               18103517
181036            MOVE 'TRT00050'     TO AA-DB2-TABLE-1                 18103617
181037            MOVE SPACES         TO AA-DB2-TABLE-2                 18103717
181038            PERFORM Z999-DB2-ABEND                                18103817
181039     END-EVALUATE.                                                18103917
181040                                                                  18104017
181050*----------------------------------------------------------------*18105017
181051*    SELECT THE VENDOR SCAC ID                                    18105117
181052*----------------------------------------------------------------*18105217
181053 S900-SELECT-VENDOR-SCAC.                                         18105317
181054                                                                  18105417
181055     EXEC SQL                                                     18105517
181056         SELECT A.SCAC_CDE                                        18105617
181057           INTO :EXTENT-SCAC-CDE                                  18105717
181058           FROM TEXTENT A                                         18105817
181059          WHERE DUN_NBR = :AP019-VENDOR-NBR                       18105917
181060     END-EXEC.                                                    18106017
181070                                                                  18107017
181080     EVALUATE TRUE                                                18108017
181090         WHEN SQLCODE = ZERO                                      18109017
181091            CONTINUE                                              18109117
181092         WHEN SQLCODE = +100                                      18109217
181093            SET SCAC-NOT-FOUND TO TRUE                            18109317
181094                                                                  18109417
181095         WHEN SQLWARN0 NOT = SPACES                               18109517
181096         WHEN SQLCODE NOT  = ZERO                                 18109617
181097            MOVE 'S900-SELECT-VENDOR-SCAC'                        18109717
181098                                TO AA-PARAGRAPH-NAME              18109817
181099            MOVE 'UNSUCCESSFUL SELECT'                            18109917
181100                                TO AA-DB2-OPERATION               18110017
181101            MOVE 'TEXTENT'      TO AA-DB2-TABLE-1                 18110117
181102            MOVE SPACES         TO AA-DB2-TABLE-2                 18110217
181103            PERFORM Z999-DB2-ABEND                                18110317
181104     END-EVALUATE.                                                18110417
181105                                                                  18110517
181106*----------------------------------------------------------------*18110617
181107*    SELECT THE BROKER RATE                                       18110717
181108*----------------------------------------------------------------*18110817
181109 S950-SELECT-BROKER-RATE.                                         18110917
181110                                                                  18111017
181111     EXEC SQL                                                     18111117
181112        SELECT TRANS_RT_AMT                                       18111217
181113          INTO  :TRT00050-TRANS-RT-AMT                            18111317
181114          FROM TRT_VND_TRANS_RT A                                 18111417
181115          WHERE A.VND_NBR = :AP019-VENDOR-NBR                     18111517
181116            AND A.TRANS_RT_TYP_CDE = :PV-RATE-TYP-CDE             18111617
181117            AND :PV-INVC-DTE BETWEEN DATE(A.EFF_RT_BEG_DTE)       18111717
181118                                 AND DATE(A.EFF_RT_END_DTE)       18111817
181119*** ORIGINAL CRITERIA BELOW:                                      18111917
181120***         AND (A.EFF_RT_END_DTE >= :WS-ONE-YEAR-AGO-DTE         18112017
181130***          OR A.EFF_RT_END_DTE IS NULL)                         18113017
181131*** TEMPORARY CHANGE FOR 09/30/2010 RUN BELOW:                    18113117
181132***         AND (A.EFF_RT_END_DTE = '9999-09-09-00.00.00.000000'  18113217
181133***          OR A.EFF_RT_END_DTE IS NULL)                         18113317
181134            AND A.DCONSLR_SCAC_ID IS NULL                         18113417
181135            AND A.POE_STD_EDI_CDE IS NULL                         18113517
181136            AND A.FOB_STD_EDI_CDE IS NULL                         18113617
181137            AND A.EDI_CONTNR_SZ_TYP_CDE IS NULL                   18113717
181138            AND A.CMDTY_TYP_GRP_CDE IS NULL                       18113817
181139     END-EXEC                                                     18113917
181140                                                                  18114017
181141        EVALUATE TRUE                                             18114117
181142            WHEN SQLCODE = ZERO                                   18114217
181143               SET RATE-FOUND TO TRUE                             18114317
181144                                                                  18114417
181145            WHEN SQLCODE = +100                                   18114517
181146               SET RATE-NOT-FOUND TO TRUE                         18114617
181147                                                                  18114717
181148            WHEN SQLWARN0 NOT = SPACES                            18114817
181149            WHEN SQLCODE NOT  = ZERO                              18114917
181150               MOVE 'S950-SELECT-BROKER-RATE'                     18115017
181151                                   TO AA-PARAGRAPH-NAME           18115117
181152               MOVE 'UNSUCCESSFUL RATE LOOKUP'                    18115217
181153                                   TO AA-DB2-OPERATION            18115317
181154               MOVE 'TRT00050'     TO AA-DB2-TABLE-1              18115417
181155               MOVE PV-RATE-TYP-CDE TO AA-DB2-TABLE-2             18115517
181156               PERFORM Z999-DB2-ABEND                             18115617
181157        END-EVALUATE.                                             18115717
181158                                                                  18115817
181159*----------------------------------------------------------------*18115917
181160*    WRITE RECORD TO REJECTED/PENDING FILE.                      *18116017
181170*----------------------------------------------------------------*18117017
181180 W100-WRITE-REJ-PEND-FILE.                                        18118017
181190                                                                  18119017
181200     WRITE REJ-PEND-INVC-REC FROM AP018-REJECT-IMPORT-INVOICE.    18120017
181210                                                                  18121017
181220     EVALUATE TRUE                                                18122017
181230        WHEN REJECT-REC                                           18123017
181240           ADD +1 TO PV-REJ-WRITTEN-COUNT                         18124017
181250        WHEN PENDING-REC                                          18125017
181260           ADD +1 TO PV-PEND-WRITTEN-COUNT                        18126017
181270     END-EVALUATE.                                                18127017
181280                                                                  18128017
181290     INITIALIZE AP018-REJECT-IMPORT-INVOICE.                      18129017
181300                                                                  18130017
181400                                                                  18140017
181500*----------------------------------------------------------------*18150017
181600*    WRITE RECORD TO LOAD FILE.                                  *18160017
181700*----------------------------------------------------------------*18170017
181800 W200-WRITE-LOAD-FILE.                                            18180017
181900                                                                  18190017
182000     WRITE IMP-EXP-INVC-LOAD-REC FROM AP016-INVOICE-LOAD-RECORD.  18200017
182100                                                                  18210017
182200     ADD +1 TO PV-INVC-WRITTEN-COUNT.                             18220017
182300                                                                  18230017
182400     INITIALIZE AP016-INVOICE-LOAD-RECORD.                        18240017
182500                                                                  18250017
182600                                                                  18260017
182700*----------------------------------------------------------------*18270017
182800*    WRITE RECORD TO SURCHARGE REPORT FILE.                      *18280017
182900*----------------------------------------------------------------*18290017
183000 W300-WRITE-SURCHG-FILE.                                          18300017
183100                                                                  18310017
183200     WRITE SURCHG-RPT-REC  FROM  AP079-SURCHG-RPT-RECORD.         18320017
183300                                                                  18330017
183400     ADD +1 TO PV-SURCHG-WRIT-COUNT.                              18340017
183500                                                                  18350017
183600     INITIALIZE AP079-SURCHG-RPT-RECORD.                          18360017
183700                                                                  18370017
183800*--------------------------------------------------------------*  18380017
183900* OPEN THE RATE-CSR                                               18390017
184000*--------------------------------------------------------------*  18400017
184100 X100-OPEN-RATE-CSR.                                              18410017
184200                                                                  18420017
184300     EXEC SQL                                                     18430017
184400         OPEN RATE-CSR                                            18440017
184500     END-EXEC.                                                    18450017
184600                                                                  18460017
184700     EVALUATE TRUE                                                18470017
184800        WHEN SQLCODE = ZERO                                       18480017
184900          CONTINUE                                                18490017
185000        WHEN OTHER                                                18500017
185010          MOVE 'X100-OPEN-RATE-CSR'       TO AA-PARAGRAPH-NAME    18501017
185020          MOVE 'UNSUCCESSFUL OPEN'        TO AA-DB2-OPERATION     18502017
185030          MOVE 'TRT00050'                 TO AA-DB2-TABLE-1       18503017
185040          MOVE SPACES                     TO AA-DB2-TABLE-2       18504017
185050     END-EVALUATE.                                                18505017
185060                                                                  18506017
185070*--------------------------------------------------------------*  18507017
185080* CLOSE THE RATE-CSR                                              18508017
185090*--------------------------------------------------------------*  18509017
185091 X200-CLOSE-RATE-CSR.                                             18509117
185092                                                                  18509217
185093     EXEC SQL                                                     18509317
185094         CLOSE RATE-CSR                                           18509417
185095     END-EXEC.                                                    18509517
185096                                                                  18509617
185097     EVALUATE TRUE                                                18509717
185098        WHEN SQLCODE = ZERO                                       18509817
185099          CONTINUE                                                18509917
185100        WHEN OTHER                                                18510017
185101          MOVE 'X200-CLOSE-RATE-CSR'      TO AA-PARAGRAPH-NAME    18510117
185102          MOVE 'UNSUCCESSFUL CLOSE'       TO AA-DB2-OPERATION     18510217
185103          MOVE 'TRT00050'                 TO AA-DB2-TABLE-1       18510317
185104          MOVE SPACES                     TO AA-DB2-TABLE-2       18510417
185105     END-EVALUATE.                                                18510517
185106                                                                  18510617
185107                                                                  18510717
185108*----------------------------------------------------------------*18510817
185109*    ABEND ROUTINE                                               *18510917
185110*----------------------------------------------------------------*18511017
185111 Z998-ABEND.                                                      18511117
185112                                                                  18511217
185113     CLOSE EDI-IMP-INVC-AUD-FILE                                  18511317
185114           IMP-EXP-INVC-LOAD-FILE                                 18511417
185115           REJ-PEND-INVC-FILE                                     18511517
185116           SURCHG-RPT-FILE.                                       18511617
185117                                                                  18511717
185118     DISPLAY AA-ABEND-LIT.                                        18511817
185119     DISPLAY AA-PROGRAM-LIT.                                      18511917
185120     DISPLAY AA-PARAGRAPH-LIT.                                    18512017
185130     DISPLAY AA-MESSAGE-LINE-1.                                   18513017
185140     DISPLAY AA-MESSAGE-LINE-2.                                   18514017
185150                                                                  18515017
185160     CALL 'ILBOABN0' USING ABEND-CODE.                            18516017
185170                                                                  18517017
185180                                                                  18518017
185190*----------------------------------------------------------------*18519017
185200*    DB2 ABEND ROUTINE                                           *18520017
185300*----------------------------------------------------------------*18530017
185400 Z999-DB2-ABEND.                                                  18540017
185500                                                                  18550017
185600     CLOSE EDI-IMP-INVC-AUD-FILE                                  18560017
185700           IMP-EXP-INVC-LOAD-FILE                                 18570017
185800           REJ-PEND-INVC-FILE                                     18580017
185900           SURCHG-RPT-FILE.                                       18590017
186000                                                                  18600017
186100     DISPLAY 'VND_NBR = ' AP019-VENDOR-NBR.                       18610017
186200     DISPLAY 'PO_NBR  = ' PV-PO-NBR.                              18620017
186300     DISPLAY 'DOC_NBR = ' AP019-INVOICE-NBR.                      18630017
186400     DISPLAY AA-ABEND-LIT.                                        18640017
186500     DISPLAY AA-MESSAGE-LINE-1.                                   18650017
186600     DISPLAY AA-MESSAGE-LINE-2.                                   18660017
186700     DISPLAY AA-DB2-ERROR-LIT.                                    18670017
186800     DISPLAY AA-PROGRAM-LIT.                                      18680017
186900     DISPLAY AA-PARAGRAPH-LIT.                                    18690017
187000     DISPLAY AA-DB2-OPERATION-LIT.                                18700017
187100     DISPLAY AA-DB2-TABLE-1.                                      18710017
187200     DISPLAY AA-DB2-TABLE-2.                                      18720017
187300     DISPLAY AA-DB2-TABLE-3.                                      18730017
187400     SET AC-DB2-ERROR TO TRUE.                                    18740017
187500                                                                  18750017
187600     COPY DPPD004.                                                18760017
187700                                                                  18770017
187800     CALL 'ILBOABN0' USING ABEND-CODE.                            18780017
187900                                                                  18790017
